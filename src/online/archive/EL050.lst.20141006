* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53******************************************************************
    54 ENVIRONMENT DIVISION.
    55
    56 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   3
* EL050.cbl
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60
    61 77  FILLER   PIC X(32) VALUE '********************************'.
    62 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    63 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    64
    65 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    66 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    67                                   USAGE POINTER.
    68 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    69 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    71                                   USAGE IS POINTER.
    72 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    77                                   USAGE IS POINTER.
    78
    79 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83*    COPY ELC50WS.
    84*****************************************************************
    85*                                                               *
    86*                            ELC50WS.                           *
    87*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    88*                            VMOD=2.061.                        *
    89*                                                               *
    90*   THIS IS THE WORKING STORAGE FOR EL050                       *
    91*                                   EL517                       *
    92*****************************************************************
    93******************************************************************
    94*                   C H A N G E   L O G
    95*
    96* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    97*-----------------------------------------------------------------
    98*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    99* EFFECTIVE    NUMBER
   100*-----------------------------------------------------------------
   101* 123102                   PEMA  ADD DCC PROCESSING
   102* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   103* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   104* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   105* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   106* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   107* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   108* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   109* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   110* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   111* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   112* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   113* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   114* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   115* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   4
* EL050.cbl
   116* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   117* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   118* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   119* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   120* 030309  CR2009021700001  PEMA  ADD ER-2883
   121* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   122* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   123* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   124* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   125* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   126* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   127* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   128* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   129* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   130* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   131* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   132* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   133* 061412  CR2011022800001  AJRA  NAPERSOFT
   134* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   135* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   136* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   137* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   138* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   139* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   140* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   141* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   142* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   143* 091114  IR2014091000001  TANA  ADD ERROR 2898
   144*-----------------------------------------------------------------
   145
   146 01  WORK-AREAS.
   147
   148*****************************************************************
   149*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   150*****************************************************************
   151
   152     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   153     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   154     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   155     12  WS-NAME-EDIT-WORK-AREA.
   156         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   157         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   158             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   159         16  WS-WORK-NAME.
   160             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   161             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   162             20  FILLER           PIC X(10)     VALUE SPACES.
   163         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   164             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   165
   166*****************************************************************
   167*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   168*****************************************************************
   169
   170     12  WS-ERRESC-KEY.
   171         16 WS-ERRESC-SEARCH-KEY.
   172             20  WS-ERRESC-COMPANY-CD PIC  X.
   173             20  WS-ERRESC-CARRIER    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   5
* EL050.cbl
   174             20  WS-ERRESC-GROUP      PIC X(6).
   175             20  WS-ERRESC-STATE      PIC XX.
   176             20  WS-ERRESC-ACCOUNT    PIC X(10).
   177         16 WS-ERRESC-RESIDUAL-KEY.
   178             20  WS-ERRESC-AGENT      PIC X(10).
   179             20  WS-ERRESC-RES-STATE  PIC XX.
   180             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   181*                                          YYYYMMDD
   182     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   183     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   184
   185*RESIDENT STATE TAX MASTER(ERRESS)
   186*
   187     12  WS-ERRESS-KEY.
   188         16  WS-ERRESS-COMPANY-CD      PIC  X.
   189         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   190         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   191         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   192*                                          YYYYMMDD
   193
   194     12  WS-CONTRACT-DATE              PIC 9(8).
   195*                                          YYYYMMDD
   196     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   197     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   198         16 WS-YEAR-YY                 PIC   9999.
   199         16 FILLER                     PIC 9(4).
   200*                                          YYYYMMDD
   201     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   202     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   203     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   204     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   205
   206     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   207         88  DPRB-1ST-TIME                      VALUE ' '.
   208
   209*****************************************************************
   210*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   211*****************************************************************
   212
   213     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   214     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   215     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   216     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   217     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   219     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   220     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   221     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   222     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   223     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   224         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   225         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   226     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   227         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   228         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   229     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   230
   231     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   6
* EL050.cbl
   232     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   233
   234     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   235     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   248     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   249     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   270     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   271     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   272     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   273     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   282     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   283     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   284     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   285     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   286     12  WS-2671-SW               PIC X         VALUE SPACE.
   287     12  WS-2672-SW               PIC X         VALUE SPACE.
   288     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   289         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   7
* EL050.cbl
   290     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   291         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   292     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   293
   294     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   295         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   296         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   297         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   298         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   299
   300     12  WS-CREDIT-EDIT-CONTROLS.
   301         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   302         16  WS-MIN-AGE           PIC 99                VALUE  0.
   303         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   304         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   305         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   306         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   307
   308     12  WS-AGE-FIELDS.
   309         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   310         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   311         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   312         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   313
   314     12  WS-SAVE-ALLOWABLE-BENEFIT.
   315         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   316         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   317         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   318         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   319         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   320         16  FILLER                      PIC XX.
   321
   322     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   323     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   324     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   325     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   326     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   327     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   328     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   329     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   330     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   331     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   332
   333     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   334     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   335     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   336     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   337     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   338     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   339     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   340     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   341         88  WS-REDUCING              VALUE 'R'.
   342         88  WS-LEVEL                 VALUE 'L' 'P'.
   343     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   344
   345     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   346     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   347     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   8
* EL050.cbl
   348     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   349     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   350     12  ws-ah-max-bens           pic 99        value zeros.
   351     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   352     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   353     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   354     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   355
   356     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   357     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   358     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   359     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   360     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   361     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   362     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   364     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   365     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   366     12  WS-ACCT-SIG-SW.
   367         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   368         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   369     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   371     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   372     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   373     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   376     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-INITIALS.
   379         16  WS-INIT-1            PIC X         VALUE SPACES.
   380         16  WS-INIT-2            PIC X         VALUE SPACES.
   381
   382     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   383     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   384     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   385     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   386     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   387*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   388     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   389     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   390     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   395     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   396     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   398     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   399     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   400     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   401     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   402     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   404     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   405     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page   9
* EL050.cbl
   406     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   407     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410******** FLA
   411     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   413     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   415     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   416********
   417     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   418     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   419     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   420     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   421     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   422     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   423     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   424     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   425     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   426     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   427
   428     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   429         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   430                                         '0' THRU '9'.
   431
   432     12  NUMBER-OF-MONTHS.
   433         16  SK-MO OCCURS 12 TIMES PIC X.
   434
   435     12  WS-WORK-DATE.
   436         16  WS-YEAR            PIC 99    VALUE 00.
   437         16  WS-MONTH           PIC 99    VALUE 00.
   438         16  WS-DAY             PIC 99    VALUE 00.
   439
   440     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   441     12  WS-WORK-CRIT-DEV       REDEFINES
   442         WS-WORK-LF-CRIT-PER    PIC X(03).
   443
   444     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   445     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   446
   447     12  WS-WORK-DATE-FROM.
   448         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   449         16  FILLER             PIC X  VALUE SPACE.
   450         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   451         16  FILLER             PIC X         VALUE SPACE.
   452         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   453
   454     12  WS-WORK-DATE-THRU.
   455         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   456         16  FILLER             PIC X         VALUE SPACE.
   457         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X         VALUE SPACE.
   459         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   460
   461     12  WS-LF-INPUT-CD.
   462         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   463         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  10
* EL050.cbl
   464
   465     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   466     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   467         16  WS-AH-INPUT-CD-1   PIC X.
   468         16  WS-AH-INPUT-CD-2-3 PIC XX.
   469
   470     12  WS-SWITCHES.
   471         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   472         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   473             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   474         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   475             88  BANK-ACCT-FOUND          VALUE 'Y'.
   476         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   477             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   478         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   479             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   480         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   481             88  COMP-MASTER-FOUND        VALUE 'Y'.
   482         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   484         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   486         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   487             88  STAT-MASTER-FOUND        VALUE 'Y'.
   488         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   489             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   490         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   491             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   492         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   493             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   494         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   495             88  FORM-MASTER-FOUND        VALUE 'Y'.
   496         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   497             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   498         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   499             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   500         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   501             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   502         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   503             88  NO-BENEFIT-FOUND         VALUE 'N'.
   504         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   505             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   506         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   507             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   508         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   509             88  AH-BENEFIT-FOUND         VALUE ' '.
   510             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   511         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   512             88  LF-BENEFIT-FOUND         VALUE ' '.
   513             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   514         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   515             88  NO-STATE-RECORD          VALUE '1'.
   516         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   517             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   518         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   519             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   520         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   521             88  CERT-WAS-FOUND           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  11
* EL050.cbl
   522             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   523         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   524             88  BROWSE-STARTED           VALUE 'Y'.
   525         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   526             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   527         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   528             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   529         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   530             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   531         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   532             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   533         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   534             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   535         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   536             88  APP-CERT-USED            VALUE 'Y' 'A'.
   537         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   538             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   539             88  FIRST-TIME-THROUGH       VALUE '1'.
   540             88  CTBL-NOT-FOUND           VALUE '2'.
   541
   542         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   543             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   544
   545         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   546             88  DLO-ERROR-FOUND          VALUE 'Y'.
   547
   548********FLA
   549     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   550     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   551********
   552     12  RC-SW-1                  PIC X           VALUE '0'.
   553     12  RC-SW-2                  PIC X           VALUE '0'.
   554     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   555     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   556     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   557     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   558     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   564     12  LIT-SPACES               PIC X           VALUE SPACES.
   565     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   566     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   567     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   568     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   569     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   570     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   571     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   572         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   573         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   574     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   575         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   576
   577 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   578     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   579     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  12
* EL050.cbl
   580 01  WS-CRI-SSN-WORK-AREA.
   581     05  WS-CRI-SOC-SEC-NO.
   582         10  WS-SS-REPT-CD       PIC X(5).
   583         10  WS-SS-LAST-NAME     PIC X(5).
   584         10  WS-SS-INITIAL       PIC X.
   585
   586     05  WS-CRI-REPORT-CODE.
   587         10  FILLER              PIC X(5).
   588         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   589
   590     05  WS-CRI-LAST-NAME.
   591         10  WS-CRI-NAME-MOVE    PIC X(5).
   592         10  FILLER              PIC X(10).
   593
   594 01  WS-NUM-TABLE                PIC X(26)  VALUE
   595     '12345678012345070923456789'.
   596 01  FILLER REDEFINES WS-NUM-TABLE.
   597     05  WS-NUM OCCURS 26        PIC 9.
   598 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   599 01  V1                          PIC S999 COMP-3.
   600 01  V2                          PIC S999 COMP-3.
   601 01  V3                          PIC S999 COMP-3.
   602 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   603 01  FILLER REDEFINES WS-WORK-VIN.
   604     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   605 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   606 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   607 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   608 01  WS-HEX-WORK.
   609     05  FILLER                  PIC X  VALUE LOW-VALUES.
   610     05  WS-HEX-BYTE             PIC X.
   611 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   612 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   613 01  WS-WORK-HIN-ROW-B.
   614     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   615
   616 01  ws-benefit-cd-chg-sw      pic x value spaces.
   617     88  benefit-code-chg           value 'Y'.
   618 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   619 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   620     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   621 01  WS-ROW-D-TABLE.
   622     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   623
   624 01  WS-HIN-TABLE-B.
   625     05  F                       PIC XX VALUE 'A2'.
   626     05  F                       PIC XX VALUE 'B3'.
   627     05  F                       PIC XX VALUE 'C4'.
   628     05  F                       PIC XX VALUE 'D5'.
   629     05  F                       PIC XX VALUE 'E6'.
   630     05  F                       PIC XX VALUE 'F7'.
   631     05  F                       PIC XX VALUE 'G8'.
   632     05  F                       PIC XX VALUE 'H9'.
   633     05  F                       PIC XX VALUE 'I1'.
   634     05  F                       PIC XX VALUE 'J2'.
   635     05  F                       PIC XX VALUE 'K3'.
   636     05  F                       PIC XX VALUE 'L4'.
   637     05  F                       PIC XX VALUE 'M5'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  13
* EL050.cbl
   638     05  F                       PIC XX VALUE 'N6'.
   639     05  F                       PIC XX VALUE 'O0'.
   640     05  F                       PIC XX VALUE 'P7'.
   641     05  F                       PIC XX VALUE 'Q0'.
   642     05  F                       PIC XX VALUE 'R8'.
   643     05  F                       PIC XX VALUE 'S9'.
   644     05  F                       PIC XX VALUE 'T2'.
   645     05  F                       PIC XX VALUE 'U3'.
   646     05  F                       PIC XX VALUE 'V4'.
   647     05  F                       PIC XX VALUE 'W5'.
   648     05  F                       PIC XX VALUE 'X6'.
   649     05  F                       PIC XX VALUE 'Y7'.
   650     05  F                       PIC XX VALUE 'Z8'.
   651 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   652     05  WS-VAL-IN               PIC X.
   653     05  WS-VAL-OUT              PIC 9.
   654 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   655 01  WS-COMPARE-BINARY-DATES.
   656     05  WS-971231                PIC XX VALUE X'92FF'.
   657     05  WS-931231                PIC XX VALUE X'8CFF'.
   658     05  WS-791231                PIC XX VALUE X'77FF'.
   659     05  WS-771001                PIC XX VALUE X'74A1'.
   660     05  WS-820301                PIC XX VALUE X'7B41'.
   661     05  WS-831031                PIC XX VALUE X'7DBF'.
   662     05  WS-831231                PIC XX VALUE X'7DFF'.
   663     05  WS-810831                PIC XX VALUE X'7A7F'.
   664     05  WS-830901                PIC XX VALUE X'7D81'.
   665
   666 01  FILE-ACCESS-IDS.
   667     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   668     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   669     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   670     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   671     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   672     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   673     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   674     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   675     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   676     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   677     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   678     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   679     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   680     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   681     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   682     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   683     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   684 01  DD-IU-SW                    PIC X   VALUE ' '.
   685     88  DD-IU-PRESENT                 VALUE 'Y'.
   686
   687 01  ACCESS-KEYS.
   688     12  ELMSTR-KEY.
   689         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   690         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   691     12  W-CLAIM-KEY.
   692         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   693         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   694
   695     12  ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  14
* EL050.cbl
   696         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   697         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   698         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   699         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   700
   701     12  ELCERT-KEY.
   702         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  CERT-CARRIER         PIC X       VALUE SPACE.
   704         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   705         16  CERT-STATE           PIC XX      VALUE SPACES.
   706         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   707         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   708         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   709
   710     12  ELCERT2-KEY.
   711         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   712         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   713
   714     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   715
   716     12  ELCERT-SAVE.
   717         16  FILLER                      PIC XX    VALUE SPACES.
   718
   719         16  WCS-CONTROL-PRIMARY.
   720             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   721             20  WCS-CARRIER             PIC X     VALUE SPACE.
   722             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   723             20  WCS-STATE               PIC XX    VALUE SPACES.
   724             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   725             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   726             20  WCS-CERT-NO.
   727                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   728                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   729
   730         16  CS-CONTROL-BY-NAME.
   731             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   732             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   733             20  CS-INSURED-INITIALS.
   734                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   735                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-SSN.
   738             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   739             20  CS-SOC-SEC-NO.
   740                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   741                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   742                 24  CS-SSN-LN3.
   743                     28 CS-INSURED-INITIALS-A2   PIC XX
   744                                     VALUE SPACES.
   745                     28 CS-PART-LAST-NAME-A2     PIC X
   746                                     VALUE SPACE.
   747
   748         16  CS-CONTROL-BY-CERT-NO.
   749             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   750             20  CS-CERT-NO-A4           PIC X(11)
   751                                     VALUE SPACES.
   752
   753         16  CS-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  15
* EL050.cbl
   754             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   755             20  CS-MEMBER-NO.
   756                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   757                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   758                 24  CS-MEMB-LN4.
   759                     28 CS-INSURED-INITIALS-A5   PIC XX
   760                                      VALUE SPACES.
   761                     28 CS-PART-LAST-NAME-A5     PIC XX
   762                                      VALUE SPACES.
   763
   764         16  FILLER              PIC X(360) VALUE SPACES.
   765
   766     12  ERACCT-KEY.
   767         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   768         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   769         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   770         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   771         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   772         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   773
   774     12  ERCOMP-KEY.
   775         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  COMP-CARRIER         PIC X     VALUE SPACES.
   777         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   778         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   779         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   780         16  COMP-TYPE            PIC X     VALUE SPACES.
   781
   782     12  ERLOFC-KEY.
   783         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   784         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   785         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   786         16  LOFC-STATE           PIC XX    VALUE SPACES.
   787         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   788         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   789
   790     12  WS-ELCRTT-KEY.
   791         16  WS-ELCRTT-PRIMARY       PIC X(33).
   792         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   793
   794     12  ERBXRF-KEY.
   795         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   796         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   797         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   798         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   799
   800     12  ERAGTC-KEY.
   801         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   802         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   803         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   804         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   805         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   806         16  AGTC-TYPE            PIC X     VALUE SPACES.
   807
   808     12  ERPLAN-KEY.
   809         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   810         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   811         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  16
* EL050.cbl
   812         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   813         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   814         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   815         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   816         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   817
   818     12  ERFORM-KEY.
   819         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   821         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   822         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   823
   824     12  ERREIN-KEY.
   825         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   826         16  REIN-TYPE            PIC X     VALUE SPACES.
   827         16  REIN-TABLE-CO.
   828             20  REIN-CODE-1      PIC X     VALUE SPACE.
   829             20  REIN-CODE-2      PIC X     VALUE SPACE.
   830             20  REIN-CODE-3      PIC X     VALUE SPACE.
   831         16  FILLER               PIC X(3)  VALUE SPACES.
   832
   833     12  ERCTBL-KEY.
   834         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   835         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   836         16  CTBL-CNTRL-2.
   837             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   838             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   839
   840     12  ELCRTO-KEY.
   841         16  ELCRTO-COMPANY-CD       PIC X.
   842         16  ELCRTO-CARRIER          PIC X.
   843         16  ELCRTO-GROUPING         PIC X(6).
   844         16  ELCRTO-STATE            PIC XX.
   845         16  ELCRTO-ACCOUNT          PIC X(10).
   846         16  ELCRTO-CERT-EFF-DT      PIC XX.
   847         16  ELCRTO-CERT-NO.
   848             20  ELCRTO-CERT-PRIME   PIC X(10).
   849             20  ELCRTO-CERT-SFX     PIC X.
   850         16  ELCRTO-RECORD-TYPE      PIC X.
   851         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   852
   853
   854     12  WS-ACCESS.
   855         16  FILLER               PIC XX    VALUE SPACES.
   856         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   857
   858     12  WS-CARR-ACCESS.
   859         16  FILLER               PIC X(3)  VALUE SPACES.
   860         16  WS-CARR              PIC X     VALUE SPACE.
   861*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   862*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   863     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   864         88  WS-DMD-LF-RATING   VALUE 'Y'.
   865         88  WS-DMD-AH-RATING   VALUE 'Y'.
   866         88  WS-DMD-NO-RATING   VALUE 'N'.
   867
   868     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   869         88  WS-LF-CASH            VALUE 'MJ' 'MS'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  17
* EL050.cbl
   870                                         'NJ' 'NL'
   871                                         'PJ' 'PL'
   872                                         'SJ' 'SL'.
   873     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   874         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   875                                         'NI' 'NJ' 'NL' 'NU'
   876                                         'PJ' 'PL' 'PI' 'PU'
   877                                         'SI' 'SJ' 'SL' 'SU'
   878                                         'MX' 'MY' 'MZ'.
   879 01  ERPDEF-KEY-SAVE             PIC X(18).
   880 01  ERPDEF-KEY.
   881     12  ERPDEF-COMPANY-CD       PIC X.
   882     12  ERPDEF-STATE            PIC XX.
   883     12  ERPDEF-PROD-CD          PIC XXX.
   884     12  F                       PIC X(7).
   885     12  ERPDEF-BEN-TYPE         PIC X.
   886     12  ERPDEF-BEN-CODE         PIC XX.
   887     12  ERPDEF-EXP-DT           PIC XX.
   888
   889 01  ELSTAT-KEY-SAVE             PIC X(20).
   890 01  ELSTAT-KEY.
   891     12  ELSTAT-COMPANY-ID       PIC XXX.
   892     12  ELSTAT-CARRIER          PIC X.
   893     12  ELSTAT-GROUP            PIC X(6).
   894     12  ELSTAT-STATE            PIC XX.
   895     12  ELSTAT-EXP-DT           PIC 9(8).
   896 01  WS-ERROR-VALUES.
   897     12  ER-1570                     PIC S9(4)   VALUE +1570.
   898     12  ER-1571                     PIC S9(4)   VALUE +1571.
   899     12  er-1572                     pic s9(4)   value +1572.
   900     12  er-1573                     pic s9(4)   value +1573.
   901     12  er-1574                     pic s9(4)   value +1574.
   902     12  ER-1575                     PIC S9(4)   VALUE +1575.
   903     12  er-1576                     pic s9(4)   value +1576.
   904     12  ER-1891                     PIC S9(4)   VALUE +1891.
   905     12  ER-1892                     PIC S9(4)   VALUE +1892.
   906     12  ER-1893                     PIC S9(4)   VALUE +1893.
   907     12  ER-1894                     PIC S9(4)   VALUE +1894.
   908     12  ER-1895                     PIC S9(4)   VALUE +1895.
   909     12  ER-1896                     PIC S9(4)   VALUE +1896.
   910     12  ER-1897                     PIC S9(4)   VALUE +1897.
   911     12  ER-1898                     PIC S9(4)   VALUE +1898.
   912     12  ER-1899                     PIC S9(4)   VALUE +1899.
   913     12  ER-1900                     PIC S9(4)   VALUE +1900.
   914     12  ER-1901                     PIC S9(4)   VALUE +1901.
   915     12  ER-1902                     PIC S9(4)   VALUE +1902.
   916     12  ER-1903                     PIC S9(4)   VALUE +1903.
   917     12  ER-1904                     PIC S9(4)   VALUE +1904.
   918     12  ER-1905                     PIC S9(4)   VALUE +1905.
   919     12  ER-1906                     PIC S9(4)   VALUE +1906.
   920     12  ER-1907                     PIC S9(4)   VALUE +1907.
   921     12  ER-1909                     PIC S9(4)   VALUE +1909.
   922     12  ER-1910                     PIC S9(4)   VALUE +1910.
   923     12  ER-1911                     PIC S9(4)   VALUE +1911.
   924     12  ER-1912                     PIC S9(4)   VALUE +1912.
   925     12  ER-1913                     PIC S9(4)   VALUE +1913.
   926     12  ER-1914                     PIC S9(4)   VALUE +1914.
   927     12  ER-1915                     PIC S9(4)   VALUE +1915.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  18
* EL050.cbl
   928     12  ER-1916                     PIC S9(4)   VALUE +1916.
   929     12  ER-1917                     PIC S9(4)   VALUE +1917.
   930     12  ER-1918                     PIC S9(4)   VALUE +1918.
   931     12  ER-1919                     PIC S9(4)   VALUE +1919.
   932     12  ER-1920                     PIC S9(4)   VALUE +1920.
   933     12  ER-1921                     PIC S9(4)   VALUE +1921.
   934     12  ER-1922                     PIC S9(4)   VALUE +1922.
   935     12  ER-1923                     PIC S9(4)   VALUE +1923.
   936     12  ER-1924                     PIC S9(4)   VALUE +1924.
   937     12  ER-1925                     PIC S9(4)   VALUE +1925.
   938     12  ER-1926                     PIC S9(4)   VALUE +1926.
   939     12  ER-1927                     PIC S9(4)   VALUE +1927.
   940     12  ER-2393                     PIC S9(4)   VALUE +2393.
   941     12  ER-2600                     PIC S9(4)   VALUE +2600.
   942     12  ER-2601                     PIC S9(4)   VALUE +2601.
   943     12  ER-2602                     PIC S9(4)   VALUE +2602.
   944     12  ER-2603                     PIC S9(4)   VALUE +2603.
   945     12  ER-2604                     PIC S9(4)   VALUE +2604.
   946     12  ER-2605                     PIC S9(4)   VALUE +2605.
   947     12  ER-2606                     PIC S9(4)   VALUE +2606.
   948     12  ER-2607                     PIC S9(4)   VALUE +2607.
   949     12  ER-2608                     PIC S9(4)   VALUE +2608.
   950     12  ER-2609                     PIC S9(4)   VALUE +2609.
   951     12  ER-2610                     PIC S9(4)   VALUE +2610.
   952     12  ER-2611                     PIC S9(4)   VALUE +2611.
   953     12  ER-2612                     PIC S9(4)   VALUE +2612.
   954     12  ER-2613                     PIC S9(4)   VALUE +2613.
   955     12  ER-2614                     PIC S9(4)   VALUE +2614.
   956     12  ER-2615                     PIC S9(4)   VALUE +2615.
   957     12  ER-2616                     PIC S9(4)   VALUE +2616.
   958     12  ER-2617                     PIC S9(4)   VALUE +2617.
   959     12  ER-2618                     PIC S9(4)   VALUE +2618.
   960     12  ER-2619                     PIC S9(4)   VALUE +2619.
   961     12  ER-2620                     PIC S9(4)   VALUE +2620.
   962     12  ER-2621                     PIC S9(4)   VALUE +2621.
   963     12  ER-2622                     PIC S9(4)   VALUE +2622.
   964     12  ER-2623                     PIC S9(4)   VALUE +2623.
   965     12  ER-2624                     PIC S9(4)   VALUE +2624.
   966     12  ER-2625                     PIC S9(4)   VALUE +2625.
   967     12  ER-2626                     PIC S9(4)   VALUE +2626.
   968     12  ER-2627                     PIC S9(4)   VALUE +2627.
   969     12  ER-2628                     PIC S9(4)   VALUE +2628.
   970     12  ER-2629                     PIC S9(4)   VALUE +2629.
   971     12  ER-2630                     PIC S9(4)   VALUE +2630.
   972     12  ER-2631                     PIC S9(4)   VALUE +2631.
   973     12  ER-2632                     PIC S9(4)   VALUE +2632.
   974     12  ER-2633                     PIC S9(4)   VALUE +2633.
   975     12  ER-2634                     PIC S9(4)   VALUE +2634.
   976     12  ER-2635                     PIC S9(4)   VALUE +2635.
   977     12  ER-2636                     PIC S9(4)   VALUE +2636.
   978     12  ER-2637                     PIC S9(4)   VALUE +2637.
   979     12  ER-2638                     PIC S9(4)   VALUE +2638.
   980     12  ER-2639                     PIC S9(4)   VALUE +2639.
   981     12  ER-2640                     PIC S9(4)   VALUE +2640.
   982     12  ER-2641                     PIC S9(4)   VALUE +2641.
   983     12  ER-2642                     PIC S9(4)   VALUE +2642.
   984     12  ER-2643                     PIC S9(4)   VALUE +2643.
   985     12  ER-2644                     PIC S9(4)   VALUE +2644.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  19
* EL050.cbl
   986     12  ER-2645                     PIC S9(4)   VALUE +2645.
   987     12  ER-2646                     PIC S9(4)   VALUE +2646.
   988     12  ER-2647                     PIC S9(4)   VALUE +2647.
   989     12  ER-2648                     PIC S9(4)   VALUE +2648.
   990     12  ER-2649                     PIC S9(4)   VALUE +2649.
   991     12  ER-2650                     PIC S9(4)   VALUE +2650.
   992     12  ER-2651                     PIC S9(4)   VALUE +2651.
   993     12  ER-2652                     PIC S9(4)   VALUE +2652.
   994     12  ER-2653                     PIC S9(4)   VALUE +2653.
   995     12  ER-2654                     PIC S9(4)   VALUE +2654.
   996     12  ER-2655                     PIC S9(4)   VALUE +2655.
   997     12  ER-2656                     PIC S9(4)   VALUE +2656.
   998     12  ER-2657                     PIC S9(4)   VALUE +2657.
   999     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1000     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1001     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1002     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1003     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1004     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1005     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1006     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1007     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1008     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1009     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1010     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1011     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1012     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1013     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1014     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1015     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1016     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1017     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1018     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1019     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1020     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1021     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1022     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1023     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1024     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1025     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1026     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1027     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1028     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1029     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1030     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1031     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1032     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1033     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1034     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1035     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1036     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1037     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1038     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1039     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1040     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1041     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1042     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1043     12  ER-2702                     PIC S9(4)   VALUE +2702.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  20
* EL050.cbl
  1044     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1045     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1046     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1047     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1048     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1049     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1050     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1051     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1052     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1053     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1054     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1055     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1056     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1057     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1058     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1059     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1060     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1061     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1062     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1063     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1064     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1065     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1066     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1067     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1068     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1069     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1070     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1071     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1072     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1073     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1074     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1075     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1076     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1077     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1078     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1079     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1080     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1081     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1082     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1083     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1084     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1085     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1086     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1087     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1088     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1089     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1090     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1091     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1092     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1093     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1094     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1095     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1096     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1097     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1098     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1099     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1100     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1101     12  ER-2770                     PIC S9(4)   VALUE +2770.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  21
* EL050.cbl
  1102     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1103     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1104     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1105     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1106     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1107     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1108     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1109     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1110     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1111     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1112     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1113     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1114     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1115     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1116     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1117     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1118     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1119     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1120     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1121     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1122     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1123     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1124     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1125     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1126     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1127     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1128     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1129     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1130     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1131     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1132     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1133     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1134     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1135     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1136     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1137     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1138     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1139     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1140     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1141     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1142     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1143     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1144     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1145     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1146     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1147     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1148     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1149     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1150     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1151     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1152     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1153     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1154     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1155     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1156     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1157     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1158     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1159     12  ER-3825                     PIC S9(4)   VALUE +3825.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  22
* EL050.cbl
  1160     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1161     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1162     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1163     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1164     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1165     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1166     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1167     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1168     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1169     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1170     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1171     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1172     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1173     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1174     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1175     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1176     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1177     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1178     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1179     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1180     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1181     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1182     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1183     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1184     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1185     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1186     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1187     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1188     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1189     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1190     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1191     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1192     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1193     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1194     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1195     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1196     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1197     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1198     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1199     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1200     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1201     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1202     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1203     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1204     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1205     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1206     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1207     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1208     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1209     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1210     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1211     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1212     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1213     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1214     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1215     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1216     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1217     12  ER-8098                     PIC S9(4)   VALUE +8098.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  23
* EL050.cbl
  1218     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1219     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1220     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1221     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1222     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1223     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1224     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1225     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1226     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1227     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1228     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1229     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1230     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1231     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1232     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1233     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1234     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1235     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1236     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1237     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1238     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1239     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1240     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1241     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1242     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1243     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1244     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1245     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1246******************************************************************
  1247***************   END OF ELC50WS     ****************************
  1248******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  24
* EL050.cbl
  1251 01  WORKING-STORAGE-WORK-AREAS.
  1252     12  WS-RESPONSE             PIC S9(8)  COMP.
  1253         88  WS-RESP-NORMAL           VALUE +00.
  1254         88  WS-RESP-ERROR            VALUE +01.
  1255         88  WS-RESP-NOTFND           VALUE +13.
  1256         88  WS-RESP-DUPREC           VALUE +14.
  1257         88  WS-RESP-ENDFILE          VALUE +20.
  1258     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1259     12  WORK-AREAS.
  1260         16  WK-CONV-GREG.
  1261             24  WCG-CENT             PIC XX.
  1262             24  WCG-REST             PIC X(4).
  1263         16  WORK-GREGORIAN-DATE.
  1264             24  WK-GREG-CENT         PIC XX.
  1265             24  WK-GREG-DATE-YYMMDD.
  1266                 28  WK-GREG-YYMM     PIC X(4).
  1267                 28  WK-GREG-DD       PIC XX.
  1268
  1269         16  WORK-SELECT-DATE.
  1270             24  WK-SELECT-CENT            PIC XX.
  1271             24  WK-SELECT-DATE-YYMMDD.
  1272                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1273                 28  FILLER                PIC XX.
  1274
  1275         16  WK-FORM-NO.
  1276             24  WK-FORM-BANK-ID       PIC X(5).
  1277             24  WK-FORM-UNDRWRTR      PIC X(1).
  1278             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1279
  1280         16  WK-MEMBER-NO.
  1281             24  WK-MEMBER-1-6        PIC X(6).
  1282             24  WK-MEMBER-7-12       PIC X(6).
  1283
  1284         16  WK-FULL-CERT-NO.
  1285             24  WK-CERT-POS-1-2      PIC X(2).
  1286             24  WK-CERT-POS-3        PIC X(1).
  1287             24  WK-CERT-POS-4        PIC X(1).
  1288             24  WK-CERT-POS-5-6      PIC X(2).
  1289             24  WK-CERT-POS-7        PIC X(1).
  1290             24  WK-CERT-POS-8-11     PIC X(4).
  1291
  1292         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1293             88  VALID-RATE-CODE        VALUE 'Y'.
  1294             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1295
  1296         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1297         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1298         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1299         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1300         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1301         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1302         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1303         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1304         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1305         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1306
  1307* DLO001
  1308 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  25
* EL050.cbl
  1309     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1310     12  DMPF-RETURN-CODE          PIC XX.
  1311         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1312         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1313         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1314         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1315         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1316         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1317
  1318* DLO002
  1319 01  WS-DLO-INTERNAL-POLICY-FORM.
  1320     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1321     12  DIPF-RETURN-CODE          PIC XX.
  1322         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1323         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1324         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1325         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1326         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1327         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1328
  1329* DLO003
  1330 01  WS-DLO-VALID-BANK-ID.
  1331     12  DVBI-BANK-ID              PIC X(5).
  1332     12  DVBI-BANK-ID-TYPE         PIC X.
  1333         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1334         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1335         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1336         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1337         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1338     12  DVBI-RETURN-CODE          PIC XX.
  1339         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1340         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1341         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1342         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1343         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1344         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1345         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1346         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1347         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1348
  1349* DLO007
  1350 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1351     12  DCUA-RES-STATE            PIC XX.
  1352     12  DCUA-BEN-TYPE             PIC XX.
  1353     12  DCUA-SYS-IDENT            PIC X.
  1354         88  DCUA-CLAIM                        VALUE 'C'.
  1355         88  DCUA-PREMIUM                      VALUE 'P'.
  1356     12  DCUA-COVERAGE-RULE        PIC X.
  1357     12  DCUA-CLIENT-ID            PIC X(10).
  1358     12  DCUA-EFF-DATE             PIC X(8).
  1359     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1360     12  DCUA-RETURN-CODE          PIC XX.
  1361         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1362     12  DCUA-CERT-NUMBER          PIC X(11).
  1363     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1364     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1365
  1366* DLO011
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  26
* EL050.cbl
  1367 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1368     12  DPRB-RATE-CODE            PIC X(4).
  1369     12  DPRB-COVERAGE-CATEG       PIC X.
  1370     12  DPRB-RETURN-CODE          PIC XX.
  1371         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1372         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1373         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1374         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1375         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1376         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1377         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1378         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1379         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1380     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1381     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1382     12  DPRB-BEN-TYPE             PIC XX.
  1383
  1384* DLO017
  1385 01  WS-DLO-VALID-RATE-CODE.
  1386     12  DVRC-RATE-CODE            PIC X(4).
  1387     12  DVRC-RETURN-CODE          PIC XX.
  1388         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1389         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1390         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1391         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1392         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1393         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1394
  1395* DLO019
  1396 01  WS-DLO-ORIG-COV-CAT.
  1397     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1398     12  DOCC-RETURN-CODE          PIC XX.
  1399     12  DOCC-ORIG-COV-CAT         PIC X.
  1400     12  DOCC-UNDERWITER           PIC XX.
  1401     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1402     12  DOCC-FILLER               PIC X(6).
  1403
  1404* DLO021
  1405 01  WS-DLO-VALID-LOAN-OFFICER.
  1406     12  DVLO-LOAN-OFFICER.
  1407         16  DVLO-BILL-TYPE        PIC X.
  1408         16  DVLO-BILL-SOURCE      PIC X.
  1409         16  DVLO-BATCH-TYPE       PIC X.
  1410     12  DVLO-RETURN-CODE          PIC XX.
  1411         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1413         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1414         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1415         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1416         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1417
  1418* DLO022
  1419 01  WS-DLO-VALID-STATE-CODE.
  1420     12  DVSC-STATE-CODE           PIC XX.
  1421     12  DVSC-RETURN-CODE          PIC XX.
  1422         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1423
  1424* DLO023
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  27
* EL050.cbl
  1425 01  WS-DLO-VALID-CODE-VALUES.
  1426     12  DVCV-SYSTEM-ID            PIC XX.
  1427         88  DVCV-CLAIMS                       VALUE 'CL'.
  1428         88  DVCV-CREDIT                       VALUE 'CR'.
  1429     12  DVCV-RECORD-TYPE          PIC XX.
  1430         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1431         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1432         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1433         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1434         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1435         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1436         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1437         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1438     12  DVCV-RECORD-KEY           PIC X(6).
  1439     12  DVCV-RETURN-CODE          PIC XX.
  1440         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1441         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1442         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1443         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1444         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1445         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1446         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1447     12  DVCV-CODE-DESC            PIC X(60).
  1448     12  DVCV-GEN-DESC-1           PIC X(20).
  1449     12  DVCV-GEN-DESC-2           PIC X(20).
  1450     12  DVCV-GEN-DESC-3           PIC X(20).
  1451
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  28
* EL050.cbl
  1453*    COPY ERCBXRF.
  1454******************************************************************
  1455*                                                                *
  1456*                                                                *
  1457*                            ERCBXRF                             *
  1458*                                                                *
  1459*   ONLINE CREDIT SYSTEM                                         *
  1460*                                                                *
  1461*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1462*                                                                *
  1463*   FILE TYPE = VSAM,KSDS                                        *
  1464*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1465*                                                                *
  1466*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1467*       ALTERNATE PATH = NONE                                    *
  1468*                                                                *
  1469*   LOG = NO                                                     *
  1470*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1471*                                                                *
  1472******************************************************************
  1473
  1474 01  BANK-CROSS-REFERENCE.
  1475     12  BK-RECORD-ID                PIC XX.
  1476         88  VALID-BK-ID             VALUE 'BK'.
  1477
  1478     12  BK-CONTROL-PRIMARY.
  1479         16  BK-COMPANY-CD           PIC X.
  1480         16  BK-CARRIER              PIC X.
  1481         16  BK-GROUPING             PIC X(6).
  1482         16  BK-BANK-NO              PIC X(10).
  1483
  1484     12  BK-MAINT-INFORMATION.
  1485         16  BK-LAST-MAINT-DT        PIC XX.
  1486         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1487         16  BK-LAST-MAINT-USER      PIC X(4).
  1488         16  FILLER                  PIC X(9).
  1489
  1490     12  FILLER                      PIC X(37).
  1491
  1492     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1493
  1494     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1495                            DEPENDING ON BK-BANK-POINTER-CNT.
  1496         16  BK-AM-ACCOUNT           PIC X(10).
  1497         16  BK-AM-EXP-DT            PIC XX.
  1498         16  BK-AM-EFF-DT            PIC XX.
  1499         16  BK-AM-STATE             PIC XX.
  1500         16  FILLER                  PIC X(20).
  1501
  1502******************************************************************
  1503
  1504*    COPY ERCCOMP.
  1505******************************************************************
  1506*                                                                *
  1507*                                                                *
  1508*                            ERCCOMP                             *
  1509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1510*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  29
* EL050.cbl
  1511*                                                                *
  1512*   ONLINE CREDIT SYSTEM                                         *
  1513*                                                                *
  1514*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1515*                                                                *
  1516*   FILE TYPE = VSAM,KSDS                                        *
  1517*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1518*                                                                *
  1519*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1520*       ALTERNATE PATH = NONE                                    *
  1521*                                                                *
  1522*   LOG = NO                                                     *
  1523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1524*                                                                *
  1525******************************************************************
  1526*                   C H A N G E   L O G
  1527*
  1528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1529*-----------------------------------------------------------------
  1530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1531* EFFECTIVE    NUMBER
  1532*-----------------------------------------------------------------
  1533* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1534* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1535* 092205    2005050300006  PEMA  ADD LEASE FEE
  1536* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1537* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1538* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1539* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1540* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1541* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1542******************************************************************
  1543
  1544 01  COMPENSATION-MASTER.
  1545     12  CO-RECORD-ID                          PIC XX.
  1546         88  VALID-CO-ID                          VALUE 'CO'.
  1547
  1548     12  CO-CONTROL-PRIMARY.
  1549         16  CO-COMPANY-CD                     PIC X.
  1550         16  CO-CONTROL.
  1551             20  CO-CTL-1.
  1552                 24  CO-CARR-GROUP.
  1553                     28  CO-CARRIER            PIC X.
  1554                     28  CO-GROUPING.
  1555                         32  CO-GROUP-PREFIX   PIC XXX.
  1556                         32  CO-GROUP-PRIME    PIC XXX.
  1557                 24  CO-RESP-NO.
  1558                     28  CO-RESP-PREFIX        PIC X(4).
  1559                     28  CO-RESP-PRIME         PIC X(6).
  1560             20  CO-CTL-2.
  1561                 24  CO-ACCOUNT.
  1562                     28  CO-ACCT-PREFIX        PIC X(4).
  1563                     28  CO-ACCT-PRIME         PIC X(6).
  1564         16  CO-TYPE                           PIC X.
  1565             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1566             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1567             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1568
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  30
* EL050.cbl
  1569     12  CO-MAINT-INFORMATION.
  1570         16  CO-LAST-MAINT-DT                  PIC XX.
  1571         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1572         16  CO-LAST-MAINT-USER                PIC X(4).
  1573     12  FILLER                                PIC XX.
  1574     12  CO-STMT-TYPE                          PIC XXX.
  1575     12  CO-COMP-TYPE                          PIC X.
  1576         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1577     12  CO-STMT-OWNER                         PIC X(4).
  1578     12  CO-BALANCE-CONTROL                    PIC X.
  1579         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1580         88  CO-NO-BALANCE                        VALUE 'N'.
  1581
  1582     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1583         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1584         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1585         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1586
  1587     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1588         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1589         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1590
  1591     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1592     12  CO-GA-DIRECT-DEP                      PIC X.
  1593     12  CO-FUTURE-SPACE                       PIC X.
  1594         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1595
  1596     12  CO-ACCT-NAME                          PIC X(30).
  1597     12  CO-MAIL-NAME                          PIC X(30).
  1598     12  CO-ADDR-1                             PIC X(30).
  1599     12  CO-ADDR-2                             PIC X(30).
  1600     12  CO-ADDR-3.
  1601         16  CO-ADDR-CITY                      PIC X(27).
  1602         16  CO-ADDR-STATE                     PIC XX.
  1603     12  CO-CSO-1099                           PIC X.
  1604     12  CO-ZIP.
  1605         16  CO-ZIP-PRIME.
  1606             20  CO-ZIP-PRI-1ST                PIC X.
  1607                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1608             20  FILLER                        PIC X(4).
  1609         16  CO-ZIP-PLUS4                      PIC X(4).
  1610     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1611         16  CO-CAN-POSTAL-1                   PIC XXX.
  1612         16  CO-CAN-POSTAL-2                   PIC XXX.
  1613         16  FILLER                            PIC XXX.
  1614     12  CO-SOC-SEC                            PIC X(13).
  1615     12  CO-TELEPHONE.
  1616         16  CO-AREA-CODE                      PIC XXX.
  1617         16  CO-PREFIX                         PIC XXX.
  1618         16  CO-PHONE                          PIC X(4).
  1619
  1620     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1621
  1622     12  CO-AR-BAL-LEVEL                       PIC X.
  1623         88  CO-AR-REF-LVL                        VALUE '1'.
  1624         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1625         88  CO-AR-BILL-LVL                       VALUE '2'.
  1626         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  31
* EL050.cbl
  1627         88  CO-AR-FR-LVL                         VALUE '4'.
  1628
  1629     12  CO-AR-NORMAL-PRINT                    PIC X.
  1630         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1631         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1632
  1633     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1634
  1635     12  CO-AR-REPORTING                       PIC X.
  1636         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1637         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1638
  1639     12  CO-AR-PULL-CHECK                      PIC X.
  1640         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1641         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1642
  1643     12  CO-AR-BALANCE-PRINT                   PIC X.
  1644         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1645
  1646     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1647         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1648         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1649         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1650
  1651     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1652
  1653     12  CO-USER-CODE                          PIC X.
  1654     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1655
  1656******************************************************************
  1657*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1658*    THE LAST MONTH END RUN.
  1659******************************************************************
  1660
  1661     12  CO-LAST-ACTIVITY-DATE.
  1662         16  CO-ACT-YEAR                       PIC 99.
  1663         16  CO-ACT-MONTH                      PIC 99.
  1664         16  CO-ACT-DAY                        PIC 99.
  1665
  1666     12  CO-LAST-STMT-DT.
  1667         16  CO-LAST-STMT-YEAR                 PIC 99.
  1668         16  CO-LAST-STMT-MONTH                PIC 99.
  1669         16  CO-LAST-STMT-DAY                  PIC 99.
  1670
  1671     12  CO-MO-END-TOTALS.
  1672         16  CO-MONTHLY-TOTALS.
  1673             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1674             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1675             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1676             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1677             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1678
  1679         16  CO-AGING-TOTALS.
  1680             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1681             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1682             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1683             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1684
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  32
* EL050.cbl
  1685         16  CO-YTD-TOTALS.
  1686             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1687             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1688
  1689         16  CO-OVER-UNDER-TOTALS.
  1690             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1691             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1692
  1693     12  CO-MISCELLANEOUS-TOTALS.
  1694         16  CO-FICA-TOTALS.
  1695             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1696             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1697
  1698         16  CO-CLAIM-TOTALS.
  1699             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1700             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1701
  1702******************************************************************
  1703*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1704*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1705******************************************************************
  1706
  1707     12  CO-CURRENT-TOTALS.
  1708         16  CO-CURRENT-LAST-STMT-DT.
  1709             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1710             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1711             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1712
  1713         16  CO-CURRENT-MONTHLY-TOTALS.
  1714             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1716             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1717             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1718             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1719
  1720         16  CO-CURRENT-AGING-TOTALS.
  1721             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1722             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1723             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1724             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1725
  1726         16  CO-CURRENT-YTD-TOTALS.
  1727             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1728             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1729
  1730     12  CO-PAID-COMM-TOTALS.
  1731         16  CO-YTD-PAID-COMMS.
  1732             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1733             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1734
  1735     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1736         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1737         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1738
  1739     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1740         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1741         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1742         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  33
* EL050.cbl
  1743         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1744         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1745         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1746         88  CO-FINAL-LETTER                  VALUE 'F'.
  1747         88  CO-RECONCILING                   VALUE 'R'.
  1748         88  CO-PHONE-CALL                    VALUE 'P'.
  1749         88  CO-LEGAL                         VALUE 'L'.
  1750         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1751         88  CO-WRITE-OFF                     VALUE 'W'.
  1752         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1753
  1754     12  CO-CSR-CODE                       PIC X(4).
  1755
  1756     12  CO-GA-STATUS-INFO.
  1757         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1758         16  CO-GA-TERMINATION-DT          PIC XX.
  1759         16  CO-GA-STATUS-CODE             PIC X.
  1760             88  CO-GA-ACTIVE                 VALUE 'A'.
  1761             88  CO-GA-INACTIVE               VALUE 'I'.
  1762             88  CO-GA-PENDING                VALUE 'P'.
  1763         16  CO-GA-COMMENTS.
  1764             20  CO-GA-COMMENT-1           PIC X(40).
  1765             20  CO-GA-COMMENT-2           PIC X(40).
  1766             20  CO-GA-COMMENT-3           PIC X(40).
  1767             20  CO-GA-COMMENT-4           PIC X(40).
  1768
  1769     12  CO-RPTCD2                         PIC X(10).
  1770     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1771         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1772         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-TYPE-AGENT                     PIC X(01).
  1775         88  CO-CORPORATION                   VALUE 'C'.
  1776         88  CO-PARTNERSHIP                   VALUE 'P'.
  1777         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1778         88  CO-TRUST                         VALUE 'T'.
  1779         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1780
  1781     12  CO-FAXNO.
  1782         16  CO-FAX-AREA-CODE                  PIC XXX.
  1783         16  CO-FAX-PREFIX                     PIC XXX.
  1784         16  CO-FAX-PHONE                      PIC X(4).
  1785
  1786     12  CO-BANK-INFORMATION.
  1787         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1788         16  CO-BANK-TRANSIT-NON REDEFINES
  1789             CO-BANK-TRANSIT-NO                PIC 9(8).
  1790
  1791         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1792     12  CO-MISC-DEDUCT-INFO REDEFINES
  1793                  CO-BANK-INFORMATION.
  1794         16  CO-MD-GL-ACCT                     PIC X(10).
  1795         16  CO-MD-DIV                         PIC XX.
  1796         16  CO-MD-CENTER                      PIC X(4).
  1797         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1798         16  CO-CREATE-AP-CHECK                PIC X.
  1799         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1800         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  34
* EL050.cbl
  1801     12  CO-ACH-STATUS                         PIC X.
  1802         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1803         88  CO-ACH-PENDING                        VALUE 'P'.
  1804
  1805     12  CO-BILL-SW                            PIC X.
  1806     12  CO-CONTROL-NAME                       PIC X(30).
  1807     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1808     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1809     12  CO-CLP-STATE                          PIC XX.
  1810     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1811     12  CO-SPP-REFUND-EDIT                    PIC X.
  1812
  1813******************************************************************
  1814
  1815*    COPY ERCAGTC.
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*                            ERCAGTC                             *
  1820*                            VMOD=2.001                          *
  1821*                                                                *
  1822*   ONLINE CREDIT SYSTEM                                         *
  1823*                                                                *
  1824*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1825*                                                                *
  1826*   FILE TYPE = VSAM,KSDS                                        *
  1827*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1828*                                                                *
  1829*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1830*       ALTERNATE PATH = NONE                                    *
  1831*                                                                *
  1832*   LOG = NO                                                     *
  1833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1834*                                                                *
  1835******************************************************************
  1836*                   C H A N G E   L O G
  1837*
  1838* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1839*-----------------------------------------------------------------
  1840*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1841* EFFECTIVE    NUMBER
  1842*-----------------------------------------------------------------
  1843* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1844* 111004                         NEW FILE AND COPYBOOK
  1845* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1846******************************************************************
  1847 01  AGENT-COMMISSIONS.
  1848     12  AG-RECORD-ID                          PIC XX.
  1849         88  VALID-CO-ID                          VALUE 'AG'.
  1850     12  AG-CONTROL-PRIMARY.
  1851         16  AG-COMPANY-CD                     PIC X.
  1852         16  AG-CONTROL.
  1853             20  AG-CTL-1.
  1854                 24  AG-CARR-GROUP.
  1855                     28  AG-CARRIER            PIC X.
  1856                     28  AG-GROUPING           PIC X(6).
  1857                 24  AG-BANK                   PIC X(10).
  1858             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  35
* EL050.cbl
  1859                 24  AG-EXP-DT                 PIC XX.
  1860         16  AG-TYPE                           PIC X.
  1861             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1862             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1863     12  AG-MAINT-INFORMATION.
  1864         16  AG-LAST-MAINT-DT                  PIC XX.
  1865         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1866         16  AG-LAST-MAINT-USER                PIC X(4).
  1867         16  FILLER                            PIC X(10).
  1868     12  AG-EFF-DT                             PIC XX.
  1869     12  AG-COMM-STRUCTURE.
  1870         16  AG-AGT-COMMS OCCURS 10.
  1871             20  AG-AGT                PIC X(10).
  1872             20  AG-COM-TYP            PIC X.
  1873             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1874             20  AG-RECALC-LV-INDIC    PIC X.
  1875             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1876             20  AG-LRCALC-LV-INDIC    PIC X.
  1877             20  FILLER                PIC X(05).
  1878     12  FILLER                  PIC X(145).
  1879******************************************************************
  1880*    COPY ERCRESS.
  1881******************************************************************
  1882*                                                                *
  1883*                            ERCRESS                             *
  1884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1885*                            VMOD=2.002                          *
  1886*                                                                *
  1887*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1888*                                                                *
  1889*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1890*   VSAM RESIDENT STATE TAX MASTER                              *
  1891*                                                                *
  1892*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1893*                                                                *
  1894*   FILE TYPE = VSAM,KSDS                                        *
  1895*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1896*                                                                *
  1897*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1898*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1899*                                                                *
  1900*   LOG = NO                                                     *
  1901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1902*                                                                *
  1903*                                                                *
  1904******************************************************************
  1905
  1906 01  RESIDENT-STATE-TAX-MASTER.
  1907
  1908     10  ERRESS-PRIMARY-KEY.
  1909         15  RES-COMPANY-CD        PIC X.
  1910         15  RES-RESIDENT-STATE    PIC XX.
  1911         15  RES-COVERAGE-CATEGORY PIC X.
  1912         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1913*                                      YYYYMMDD
  1914*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1915
  1916     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  36
* EL050.cbl
  1917
  1918         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1919         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1920         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1921         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1922
  1923     10 RES-RECALC-SW              PIC   X.
  1924         88 RECALC                VALUE 'Y'.
  1925         88 NO-RECALC             VALUE 'N'.
  1926     10  RES-MAINT-BY              PIC X(4).
  1927     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1928     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1929*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  37
* EL050.cbl
  1931*    COPY ERCRESC.
  1932******************************************************************
  1933*                                                                *
  1934*                            ERCRESC                             *
  1935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1936*                            VMOD=2.003                          *
  1937*                                                                *
  1938*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1939*                                                                *
  1940*   FILE TYPE = VSAM,KSDS                                        *
  1941*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1942*                                                                *
  1943*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1944*       ALTERNATE PATH1 = NONE                                   *
  1945*                                                                *
  1946*   LOG = NO                                                     *
  1947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1948*                                                                *
  1949******************************************************************
  1950
  1951 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1952
  1953     10  ERRESC-RECORD-KEY.
  1954         15  RESC-COMPANY-CD           PIC   X.
  1955         15  RESC-CARRIER              PIC   X.
  1956         15  RESC-GROUP                PIC   X(6).
  1957         15  RESC-STATE                PIC   XX.
  1958         15  RESC-ACCOUNT              PIC   X(10).
  1959         15  RESC-AGENT                PIC   X(10).
  1960         15  RESC-RESIDENT-STATE       PIC   XX.
  1961         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1962*                                           YYYYMMDD
  1963     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1964
  1965     10  RESC-COMM-RECORD-DATA.
  1966         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1967             20 RESC-COVERAGE-CAT      PIC    X.
  1968             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1969             20 RESC-COMMISSION-TAB REDEFINES
  1970                RESC-COMMISSION-PER    PIC  XXX.
  1971
  1972     10  RESC-MAINT-BY                 PIC X(4).
  1973     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1974     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1975*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  38
* EL050.cbl
  1977*    COPY ERCPLAN.
  1978******************************************************************
  1979*                                                                *
  1980*                                                                *
  1981*                            ERCPLAN                             *
  1982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1983*                            VMOD=2.003                          *
  1984*                                                                *
  1985*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1986*                                                                *
  1987*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1988*   PLAN MASTER                                                  *
  1989*                                                                *
  1990*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1991*                                                                *
  1992*   FILE TYPE = VSAM,KSDS                                        *
  1993*   RECORD SIZE = 420   RECFORM = FIX                            *
  1994*                                                                *
  1995*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1996*       ALTERNATE PATH1 = N/A                                    *
  1997*                                                                *
  1998*   LOG = NO                                                     *
  1999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2000*                                                                *
  2001*                                                                *
  2002******************************************************************
  2003
  2004 01  PLAN-MASTER.
  2005     12  PL-RECORD-ID                      PIC XX.
  2006         88  VALID-PL-ID                      VALUE 'PL'.
  2007
  2008     12  PL-CONTROL-PRIMARY.
  2009         16  PL-COMPANY-CD                 PIC X.
  2010         16  PL-MSTR-CNTRL.
  2011             20  PL-CONTROL-A.
  2012                 24  PL-CARRIER            PIC X.
  2013                 24  PL-GROUPING           PIC X(6).
  2014                 24  PL-STATE              PIC XX.
  2015                 24  PL-ACCOUNT            PIC X(10).
  2016             20  PL-BENEFIT-TYPE           PIC X.
  2017             20  PL-BENEFIT-CODE           PIC XX.
  2018             20  PL-REVISION-NO            PIC X(3).
  2019
  2020     12  PL-CONTROL-BY-VAR-GRP.
  2021         16  PL-COMPANY-CD-A1              PIC X.
  2022         16  PL-VG-CARRIER                 PIC X.
  2023         16  PL-VG-GROUPING                PIC X(6).
  2024         16  PL-VG-STATE                   PIC XX.
  2025         16  PL-VG-ACCOUNT                 PIC X(10).
  2026         16  PL-BENEFIT-TYPE-A1            PIC X.
  2027         16  PL-BENEFIT-CODE-A1            PIC XX.
  2028         16  PL-REVISION-NO-A1             PIC 999.
  2029
  2030     12  PL-MAINT-INFORMATION.
  2031         16  PL-LAST-MAINT-DT              PIC XX.
  2032         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2033         16  PL-LAST-MAINT-USER            PIC X(4).
  2034         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  39
* EL050.cbl
  2035
  2036     12  PL-LIABILITY-LIMITS.
  2037         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2038         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2039             20  PL-LM-AGE                 PIC S99        COMP-3.
  2040             20  PL-LM-DUR                 PIC S999       COMP-3.
  2041             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2042             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2043
  2044     12  FILLER                            PIC X(30).
  2045
  2046     12  PL-GL-ACCOUNT-NOS.
  2047         16  PL-PREMIUM-GL                 PIC X(8).
  2048         16  PL-COMM-GL                    PIC X(8).
  2049         16  PL-CLAIM-GL                   PIC X(8).
  2050     12  FILLER                            PIC X(24).
  2051     12  PL-TOLERANCES.
  2052         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2053         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2054         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2055         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2056         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2057         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2058     12  PL-OVER-SHORT.
  2059         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2060         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2061     12  FILLER                            PIC X(24).
  2062     12  PLAN-MISC.
  2063         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2064         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2065         16  PL-IG                         PIC X.
  2066         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2067         16  PL-POLICY-FORM                PIC X(12).
  2068         16  PL-EDIT-FOR-FORM              PIC X(01).
  2069         16  PL-DEV-CODE                   PIC XXX.
  2070         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2071         16  PL-CALC-METHOD                PIC X.
  2072         16  PL-BENEFIT-GROUP              PIC X(05).
  2073         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2074
  2075         16  FILLER                        PIC X(99).
  2076******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  40
* EL050.cbl
  2078*    COPY ELCCERT.
  2079******************************************************************
  2080*                                                                *
  2081*                            ELCCERT.                            *
  2082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2083*                            VMOD=2.013                          *
  2084*                                                                *
  2085*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2086*                                                                *
  2087*   FILE TYPE = VSAM,KSDS                                        *
  2088*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2089*                                                                *
  2090*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2091*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2092*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2093*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2094*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2095*                                                                *
  2096*   LOG = YES                                                    *
  2097*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2098******************************************************************
  2099*                   C H A N G E   L O G
  2100*
  2101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2102*-----------------------------------------------------------------
  2103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2104* EFFECTIVE    NUMBER
  2105*-----------------------------------------------------------------
  2106* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2108* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2109* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2110* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2111* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2113* 032612  CR2011110200001  PEMA  AHL CHANGES
  2114* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2115******************************************************************
  2116
  2117 01  CERTIFICATE-MASTER.
  2118     12  CM-RECORD-ID                      PIC XX.
  2119         88  VALID-CM-ID                      VALUE 'CM'.
  2120
  2121     12  CM-CONTROL-PRIMARY.
  2122         16  CM-COMPANY-CD                 PIC X.
  2123         16  CM-CARRIER                    PIC X.
  2124         16  CM-GROUPING.
  2125             20  CM-GROUPING-PREFIX        PIC X(3).
  2126             20  CM-GROUPING-PRIME         PIC X(3).
  2127         16  CM-STATE                      PIC XX.
  2128         16  CM-ACCOUNT.
  2129             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2130             20  CM-ACCOUNT-PRIME          PIC X(6).
  2131         16  CM-CERT-EFF-DT                PIC XX.
  2132         16  CM-CERT-NO.
  2133             20  CM-CERT-PRIME             PIC X(10).
  2134             20  CM-CERT-SFX               PIC X.
  2135
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  41
* EL050.cbl
  2136     12  CM-CONTROL-BY-NAME.
  2137         16  CM-COMPANY-CD-A1              PIC X.
  2138         16  CM-INSURED-LAST-NAME          PIC X(15).
  2139         16  CM-INSURED-INITIALS.
  2140             20  CM-INSURED-INITIAL1       PIC X.
  2141             20  CM-INSURED-INITIAL2       PIC X.
  2142
  2143     12  CM-CONTROL-BY-SSN.
  2144         16  CM-COMPANY-CD-A2              PIC X.
  2145         16  CM-SOC-SEC-NO.
  2146             20  CM-SSN-STATE              PIC XX.
  2147             20  CM-SSN-ACCOUNT            PIC X(6).
  2148             20  CM-SSN-LN3.
  2149                 25  CM-INSURED-INITIALS-A2.
  2150                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2151                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2152                 25 CM-PART-LAST-NAME-A2         PIC X.
  2153
  2154     12  CM-CONTROL-BY-CERT-NO.
  2155         16  CM-COMPANY-CD-A4              PIC X.
  2156         16  CM-CERT-NO-A4                 PIC X(11).
  2157
  2158     12  CM-CONTROL-BY-MEMB.
  2159         16  CM-COMPANY-CD-A5              PIC X.
  2160         16  CM-MEMBER-NO.
  2161             20  CM-MEMB-STATE             PIC XX.
  2162             20  CM-MEMB-ACCOUNT           PIC X(6).
  2163             20  CM-MEMB-LN4.
  2164                 25  CM-INSURED-INITIALS-A5.
  2165                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2166                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2167                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2168
  2169     12  CM-INSURED-PROFILE-DATA.
  2170         16  CM-INSURED-FIRST-NAME.
  2171             20  CM-INSURED-1ST-INIT       PIC X.
  2172             20  FILLER                    PIC X(9).
  2173         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2174         16  CM-INSURED-SEX                PIC X.
  2175             88  CM-SEX-MALE                  VALUE 'M'.
  2176             88  CM-SEX-FEMAL                 VALUE 'F'.
  2177         16  CM-INSURED-JOINT-AGE          PIC 99.
  2178         16  CM-JOINT-INSURED-NAME.
  2179             20  CM-JT-LAST-NAME           PIC X(15).
  2180             20  CM-JT-FIRST-NAME.
  2181                 24  CM-JT-1ST-INIT        PIC X.
  2182                 24  FILLER                PIC X(9).
  2183             20  CM-JT-INITIAL             PIC X.
  2184
  2185     12  CM-LIFE-DATA.
  2186         16  CM-LF-BENEFIT-CD              PIC XX.
  2187         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2188         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2189         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2190         16  CM-LF-DEV-CODE                PIC XXX.
  2191         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2192         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2193         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  42
* EL050.cbl
  2194         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2195         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2196         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2197         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2198         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2199         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2200         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2201         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2202         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2203         16  cm-temp-epiq                  pic xx.
  2204             88  EPIQ-CLASS                  value 'EQ'.
  2205*        16  FILLER                        PIC XX.
  2206
  2207     12  CM-AH-DATA.
  2208         16  CM-AH-BENEFIT-CD              PIC XX.
  2209         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2210         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2211         16  CM-AH-DEV-CODE                PIC XXX.
  2212         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2213         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2214         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2215         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2216         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2217         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2218         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2219         16  CM-AH-PAID-THRU-DT            PIC XX.
  2220             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2221         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2222         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2223         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2224         16  FILLER                        PIC X.
  2225
  2226     12  CM-LOAN-INFORMATION.
  2227         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2228         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2229                                           PIC S9(5)V99  COMP-3.
  2230         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2231         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2232         16  CM-PAY-FREQUENCY              PIC S99.
  2233         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2234         16  CM-RATE-CLASS                 PIC XX.
  2235         16  CM-BENEFICIARY                PIC X(25).
  2236         16  CM-POLICY-FORM-NO             PIC X(12).
  2237         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2238         16  CM-LAST-ADD-ON-DT             PIC XX.
  2239         16  CM-DEDUCTIBLE-AMOUNTS.
  2240             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2241             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2242         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2243             20  CM-RESIDENT-STATE         PIC XX.
  2244             20  CM-RATE-CODE              PIC X(4).
  2245             20  FILLER                    PIC XX.
  2246         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2247             20  CM-LOAN-OFFICER           PIC X(5).
  2248             20  FILLER                    PIC XXX.
  2249         16  CM-CSR-CODE                   PIC XXX.
  2250         16  CM-UNDERWRITING-CODE          PIC X.
  2251             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  43
* EL050.cbl
  2252         16  CM-POST-CARD-IND              PIC X.
  2253         16  CM-NH-INTERFACE-SW            PIC X.
  2254         16  CM-PREMIUM-TYPE               PIC X.
  2255             88  CM-SING-PRM                  VALUE '1'.
  2256             88  CM-O-B-COVERAGE              VALUE '2'.
  2257             88  CM-OPEN-END                  VALUE '3'.
  2258         16  CM-IND-GRP-TYPE               PIC X.
  2259             88  CM-INDIVIDUAL                VALUE 'I'.
  2260             88  CM-GROUP                     VALUE 'G'.
  2261         16  CM-SKIP-CODE                  PIC X.
  2262             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2263             88  SKIP-JULY                    VALUE '1'.
  2264             88  SKIP-AUGUST                  VALUE '2'.
  2265             88  SKIP-SEPTEMBER               VALUE '3'.
  2266             88  SKIP-JULY-AUG                VALUE '4'.
  2267             88  SKIP-AUG-SEPT                VALUE '5'.
  2268             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2269             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2270             88  SKIP-JUNE                    VALUE '8'.
  2271             88  SKIP-JUNE-JULY               VALUE '9'.
  2272             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2273             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2274         16  CM-PAYMENT-MODE               PIC X.
  2275             88  PAY-MONTHLY                  VALUE SPACE.
  2276             88  PAY-WEEKLY                   VALUE '1'.
  2277             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2278             88  PAY-BI-WEEKLY                VALUE '3'.
  2279             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2280         16  CM-LOAN-NUMBER                PIC X(8).
  2281         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2282         16  CM-OLD-LOF                    PIC XXX.
  2283*        16  CM-LOAN-OFFICER               PIC XXX.
  2284         16  CM-REIN-TABLE                 PIC XXX.
  2285         16  CM-SPECIAL-REIN-CODE          PIC X.
  2286         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2287         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2288         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2289
  2290     12  CM-STATUS-DATA.
  2291         16  CM-ENTRY-STATUS               PIC X.
  2292         16  CM-ENTRY-DT                   PIC XX.
  2293
  2294         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2295         16  CM-LF-CANCEL-DT               PIC XX.
  2296         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2297
  2298         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2299         16  CM-LF-DEATH-DT                PIC XX.
  2300         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2301
  2302         16  CM-LF-CURRENT-STATUS          PIC X.
  2303             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2304                                                'M' '4' '5' '9'.
  2305             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2306             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2307             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2308             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2309             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  44
* EL050.cbl
  2310             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2311             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2312             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2313             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2314             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2315             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2316             88  CM-LF-DECLINED               VALUE 'D'.
  2317             88  CM-LF-VOIDED                 VALUE 'V'.
  2318
  2319         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2320         16  CM-AH-CANCEL-DT               PIC XX.
  2321         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2322
  2323         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2324         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2325         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2326
  2327         16  CM-AH-CURRENT-STATUS          PIC X.
  2328             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2329                                                'M' '4' '5' '9'.
  2330             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2331             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2332             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2333             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2334             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2335             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2336             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2337             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2338             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2339             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2340             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2341             88  CM-AH-DECLINED               VALUE 'D'.
  2342             88  CM-AH-VOIDED                 VALUE 'V'.
  2343
  2344         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2345             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2346             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2347             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2348         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2349
  2350         16  CM-ENTRY-BATCH                PIC X(6).
  2351         16  CM-LF-EXIT-BATCH              PIC X(6).
  2352         16  CM-AH-EXIT-BATCH              PIC X(6).
  2353         16  CM-LAST-MONTH-END             PIC XX.
  2354
  2355     12  CM-NOTE-SW                        PIC X.
  2356         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2357         88  CERT-NOTES-PRESENT               VALUE '1'.
  2358         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2359         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2360         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2361         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2362         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2363         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2364     12  CM-COMP-EXCP-SW                   PIC X.
  2365         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2366         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2367     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  45
* EL050.cbl
  2368         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2369         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2370
  2371*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2372     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2373     12  FILLER                            PIC X.
  2374
  2375*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2376     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2377     12  FILLER                            PIC X.
  2378*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2379     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2380
  2381     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2382         88  CERT-ADDED-BATCH                 VALUE ' '.
  2383         88  CERT-ADDED-ONLINE                VALUE '1'.
  2384         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2385         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2386         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2387     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2388         88  CERT-AS-LOADED                   VALUE ' '.
  2389         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2390         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2391         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2392         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2393         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2394         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2395         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2396
  2397     12  CM-ACCOUNT-COMM-PCTS.
  2398         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2399         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2400
  2401     12  CM-USER-FIELD                     PIC X.
  2402     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2403     12  CM-CLP-STATE                      PIC XX.
  2404     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2405     12  CM-USER-RESERVED                  PIC XXX.
  2406     12  FILLER REDEFINES CM-USER-RESERVED.
  2407         16  CM-AH-CLASS-CD                PIC XX.
  2408         16  F                             PIC X.
  2409******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  46
* EL050.cbl
  2411*    COPY ERCMAIL.
  2412******************************************************************
  2413*                                                                *
  2414*                                                                *
  2415*                            ERCMAIL                             *
  2416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2417*                            VMOD=2.003                          *
  2418*                                                                *
  2419*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2420*                                                                *
  2421*   FILE TYPE = VSAM,KSDS                                        *
  2422*   RECORD SIZE = 374   RECFORM = FIX                            *
  2423*                                                                *
  2424*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2425*   ALTERNATE PATH    = NOT USED                                 *
  2426*                                                                *
  2427*   LOG = YES                                                    *
  2428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2429******************************************************************
  2430*                   C H A N G E   L O G
  2431*
  2432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2433*-----------------------------------------------------------------
  2434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2435* EFFECTIVE    NUMBER
  2436*-----------------------------------------------------------------
  2437* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2438* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2439* 111108                   PEMA  ADD CRED BENE ADDR2
  2440******************************************************************
  2441
  2442 01  MAILING-DATA.
  2443     12  MA-RECORD-ID                      PIC XX.
  2444         88  VALID-MA-ID                       VALUE 'MA'.
  2445
  2446     12  MA-CONTROL-PRIMARY.
  2447         16  MA-COMPANY-CD                 PIC X.
  2448         16  MA-CARRIER                    PIC X.
  2449         16  MA-GROUPING.
  2450             20  MA-GROUPING-PREFIX        PIC XXX.
  2451             20  MA-GROUPING-PRIME         PIC XXX.
  2452         16  MA-STATE                      PIC XX.
  2453         16  MA-ACCOUNT.
  2454             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2455             20  MA-ACCOUNT-PRIME          PIC X(6).
  2456         16  MA-CERT-EFF-DT                PIC XX.
  2457         16  MA-CERT-NO.
  2458             20  MA-CERT-PRIME             PIC X(10).
  2459             20  MA-CERT-SFX               PIC X.
  2460
  2461     12  FILLER                            PIC XX.
  2462
  2463     12  MA-ACCESS-CONTROL.
  2464         16  MA-SOURCE-SYSTEM              PIC XX.
  2465             88  MA-FROM-CREDIT                VALUE 'CR'.
  2466             88  MA-FROM-VSI                   VALUE 'VS'.
  2467             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2468             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  47
* EL050.cbl
  2469         16  MA-RECORD-ADD-DT              PIC XX.
  2470         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2471         16  MA-LAST-MAINT-DT              PIC XX.
  2472         16  MA-LAST-MAINT-BY              PIC XXXX.
  2473         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2474
  2475     12  MA-PROFILE-INFO.
  2476         16  MA-QUALIFY-CODE-1             PIC XX.
  2477         16  MA-QUALIFY-CODE-2             PIC XX.
  2478         16  MA-QUALIFY-CODE-3             PIC XX.
  2479         16  MA-QUALIFY-CODE-4             PIC XX.
  2480         16  MA-QUALIFY-CODE-5             PIC XX.
  2481
  2482         16  MA-INSURED-LAST-NAME          PIC X(15).
  2483         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2484         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2485         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2486         16  MA-INSURED-BIRTH-DT           PIC XX.
  2487         16  MA-INSURED-SEX                PIC X.
  2488             88  MA-SEX-MALE                   VALUE 'M'.
  2489             88  MA-SEX-FEMALE                 VALUE 'F'.
  2490         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2491
  2492         16  MA-ADDRESS-CORRECTED          PIC X.
  2493         16  MA-JOINT-BIRTH-DT             PIC XX.
  2494*        16  FILLER                        PIC X(12).
  2495
  2496         16  MA-ADDRESS-LINE-1             PIC X(30).
  2497         16  MA-ADDRESS-LINE-2             PIC X(30).
  2498         16  MA-CITY-STATE.
  2499             20  MA-CITY                   PIC X(28).
  2500             20  MA-ADDR-STATE             PIC XX.
  2501         16  MA-ZIP.
  2502             20  MA-ZIP-CODE.
  2503                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2504                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2505                 24  FILLER                PIC X(4).
  2506             20  MA-ZIP-PLUS4              PIC X(4).
  2507         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2508             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2509             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2510             20  FILLER                    PIC X(3).
  2511
  2512         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2513
  2514         16  FILLER                        PIC XXX.
  2515*        16  FILLER                        PIC X(10).
  2516
  2517     12  MA-CRED-BENE-INFO.
  2518         16  MA-CRED-BENE-NAME                 PIC X(25).
  2519         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2520         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2521         16  MA-CRED-BENE-CTYST.
  2522             20  MA-CRED-BENE-CITY             PIC X(28).
  2523             20  MA-CRED-BENE-STATE            PIC XX.
  2524         16  MA-CRED-BENE-ZIP.
  2525             20  MA-CB-ZIP-CODE.
  2526                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  48
* EL050.cbl
  2527                     88  MA-CB-CANADIAN-POST-CODE
  2528                                           VALUE 'A' THRU 'Z'.
  2529                 24  FILLER                    PIC X(4).
  2530             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2531         16  MA-CB-CANADIAN-POSTAL-CODE
  2532                            REDEFINES MA-CRED-BENE-ZIP.
  2533             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2534             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2535             20  FILLER                        PIC X(3).
  2536     12  MA-POST-CARD-MAIL-DATA.
  2537         16  MA-MAIL-DATA OCCURS 7.
  2538             20  MA-MAIL-TYPE              PIC X.
  2539                 88  MA-12MO-MAILING           VALUE '1'.
  2540                 88  MA-EXP-MAILING            VALUE '2'.
  2541             20  MA-MAIL-STATUS            PIC X.
  2542                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2543                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2544                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2545             20  MA-MAIL-DATE              PIC XX.
  2546     12  FILLER                            PIC XX.
  2547     12  FILLER                            PIC XX.
  2548*    12  FILLER                            PIC X(30).
  2549******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  49
* EL050.cbl
  2551*    COPY ERCPNDM.
  2552******************************************************************
  2553*                                                                *
  2554*                                                                *
  2555*                            ERCPNDM                             *
  2556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2557*                            VMOD=2.003                          *
  2558*                                                                *
  2559*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2560*                                                                *
  2561*   FILE TYPE = VSAM,KSDS                                        *
  2562*   RECORD SIZE = 374   RECFORM = FIX                            *
  2563*                                                                *
  2564*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2565*   ALTERNATE PATH    = NOT USED                                 *
  2566*                                                                *
  2567*   LOG = YES                                                    *
  2568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2569******************************************************************
  2570*                   C H A N G E   L O G
  2571*
  2572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2573*-----------------------------------------------------------------
  2574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2575* EFFECTIVE    NUMBER
  2576*-----------------------------------------------------------------
  2577* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2578* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2579* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2580******************************************************************
  2581
  2582 01  PENDING-MAILING-DATA.
  2583     12  PM-RECORD-ID                      PIC XX.
  2584         88  VALID-MA-ID                       VALUE 'PM'.
  2585
  2586     12  PM-CONTROL-PRIMARY.
  2587         16  PM-COMPANY-CD                 PIC X.
  2588         16  PM-ENTRY-BATCH                PIC X(6).
  2589         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2590         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2591
  2592     12  FILLER                            PIC X(14).
  2593
  2594     12  PM-ACCESS-CONTROL.
  2595         16  PM-SOURCE-SYSTEM              PIC XX.
  2596             88  PM-FROM-CREDIT                VALUE 'CR'.
  2597             88  PM-FROM-VSI                   VALUE 'VS'.
  2598             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2599             88  PM-FROM-OTHER                 VALUE 'OT'.
  2600         16  PM-RECORD-ADD-DT              PIC XX.
  2601         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2602         16  PM-LAST-MAINT-DT              PIC XX.
  2603         16  PM-LAST-MAINT-BY              PIC XXXX.
  2604         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2605
  2606     12  PM-PROFILE-INFO.
  2607         16  PM-QUALIFY-CODE-1             PIC XX.
  2608         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  50
* EL050.cbl
  2609         16  PM-QUALIFY-CODE-3             PIC XX.
  2610         16  PM-QUALIFY-CODE-4             PIC XX.
  2611         16  PM-QUALIFY-CODE-5             PIC XX.
  2612
  2613         16  PM-INSURED-LAST-NAME          PIC X(15).
  2614         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2615         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2616         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2617         16  PM-INSURED-BIRTH-DT           PIC XX.
  2618         16  PM-INSURED-SEX                PIC X.
  2619             88  PM-SEX-MALE                   VALUE 'M'.
  2620             88  PM-SEX-FEMALE                 VALUE 'F'.
  2621         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2622
  2623         16  PM-ADDRESS-CORRECTED          PIC X.
  2624         16  PM-JOINT-BIRTH-DT             PIC XX.
  2625*        16  FILLER                        PIC X(12).
  2626
  2627         16  PM-ADDRESS-LINE-1             PIC X(30).
  2628         16  PM-ADDRESS-LINE-2             PIC X(30).
  2629         16  PM-CITY-STATE.
  2630             20  PM-CITY                   PIC X(28).
  2631             20  PM-STATE                  PIC XX.
  2632         16  PM-ZIP.
  2633             20  PM-ZIP-CODE.
  2634                 24  PM-ZIP-1              PIC X.
  2635                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2636                 24  FILLER                PIC X(4).
  2637             20  PM-ZIP-PLUS4              PIC X(4).
  2638         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2639             20  PM-CAN-POST1              PIC XXX.
  2640             20  PM-CAN-POST2              PIC XXX.
  2641             20  FILLER                    PIC XXX.
  2642
  2643         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2644
  2645         16  FILLER                        PIC X(03).
  2646
  2647     12  PM-CRED-BENE-INFO.
  2648         16  PM-CRED-BENE-NAME             PIC X(25).
  2649         16  PM-CRED-BENE-ADDR             PIC X(30).
  2650         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2651         16  PM-CRED-BENE-CTYST.
  2652             20  PM-CRED-BENE-CITY         PIC X(28).
  2653             20  PM-CRED-BENE-STATE        PIC XX.
  2654         16  PM-CRED-BENE-ZIP.
  2655             20  PM-CB-ZIP-CODE.
  2656                 24  PM-CB-ZIP-1           PIC X.
  2657                     88  PM-CB-CANADIAN-POST-CODE
  2658                                  VALUE 'A' THRU 'Z'.
  2659                 24  FILLER                PIC X(4).
  2660             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2661         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2662             20  PM-CB-CAN-POST1           PIC XXX.
  2663             20  PM-CB-CAN-POST2           PIC XXX.
  2664             20  FILLER                    PIC XXX.
  2665     12  PM-POST-CARD-MAIL-DATA.
  2666         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  51
* EL050.cbl
  2667             20  PM-MAIL-TYPE              PIC X.
  2668                 88  PM-12MO-MAILING           VALUE '1'.
  2669                 88  PM-EXP-MAILING            VALUE '2'.
  2670             20  PM-MAIL-STATUS            PIC X.
  2671                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2672                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2673                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2674             20  PM-MAIL-DATE              PIC XX.
  2675     12  FILLER                            PIC XX.
  2676     12  FILLER                            PIC X(12).
  2677*    12  FILLER                            PIC X(30).
  2678
  2679******************************************************************
  2680*                                COPY ERCLOFC.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ERCLOFC                             *
  2685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2686*                            VMOD=2.003                          *
  2687*                                                                *
  2688*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2689*                                                                *
  2690*   FILE TYPE = VSAM,KSDS                                        *
  2691*   RECORD SIZE = 670   RECFORM = FIX                            *
  2692*                                                                *
  2693*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2694*                                                                *
  2695*   LOG = YES                                                    *
  2696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2697*                                                                *
  2698******************************************************************
  2699
  2700 01  LOAN-OFFICER-MASTER.
  2701     12  LO-RECORD-ID                PIC XX.
  2702         88  VALID-LO-ID                VALUE 'LO'.
  2703
  2704     12  LO-CONTROL-PRIMARY.
  2705         16  LO-COMPANY-CD           PIC X.
  2706         16  LO-CARRIER              PIC X.
  2707         16  LO-GROUPING.
  2708             20  LO-GROUPING-PREFIX  PIC XXX.
  2709             20  LO-GROUPING-PRIME   PIC XXX.
  2710         16  LO-STATE                PIC XX.
  2711         16  LO-ACCOUNT.
  2712             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2713             20  LO-ACCOUNT-PRIME    PIC X(6).
  2714         16  LO-OFFICER-CODE         PIC X(5).
  2715
  2716     12  LO-OFFICER-NAME             PIC X(30).
  2717
  2718     12  LO-LAST-MAINT-DT            PIC XX.
  2719     12  LO-LAST-USER                PIC X(4).
  2720     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2721
  2722     12  LO-COMP-CONTROL             PIC X.
  2723             88  LO-SHOW-COMP           VALUE 'Y'.
  2724             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  52
* EL050.cbl
  2725     12  LO-DETAIL-CONTROL           PIC X.
  2726             88  LO-PRINT-DETAIL        VALUE 'D'.
  2727             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2728
  2729     12  LO-SV-CARRIER               PIC X.
  2730     12  LO-SV-GROUPING              PIC X(6).
  2731     12  LO-SV-STATE                 PIC XX.
  2732
  2733     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2734     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2735
  2736     12  LO-OFFICER-INFO.
  2737         16  FILLER OCCURS 12 TIMES.
  2738             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2739             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2740             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2741             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2742             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2743             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2744             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2745             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2746     12  FILLER                      PIC X(198).
  2747******************************************************************
  2748*                                COPY ERCPDEF.
  2749******************************************************************
  2750*                                                                *
  2751*                                                                *
  2752*                            ERCPDEF.                            *
  2753*                                                                *
  2754*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2755*                                                                *
  2756*    FILE TYPE = VSAM,KSDS                                       *
  2757*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2758*                                                                *
  2759*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2760*                                                                *
  2761*    LOG = YES                                                   *
  2762*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2763******************************************************************
  2764*                   C H A N G E   L O G
  2765*
  2766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2767*-----------------------------------------------------------------
  2768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2769* EFFECTIVE    NUMBER
  2770*-----------------------------------------------------------------
  2771* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2772* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2773******************************************************************
  2774 01  PRODUCT-MASTER.
  2775    12  PD-RECORD-ID                 PIC X(02).
  2776        88  VALID-PD-ID                  VALUE 'PD'.
  2777    12  PD-CONTROL-PRIMARY.
  2778        16  PD-COMPANY-CD            PIC X.
  2779        16  PD-STATE                 PIC XX.
  2780        16  PD-PRODUCT-CD            PIC XXX.
  2781        16  PD-FILLER                PIC X(7).
  2782        16  PD-BEN-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  53
* EL050.cbl
  2783        16  PD-BEN-CODE              PIC XX.
  2784        16  PD-PROD-EXP-DT           PIC XX.
  2785    12  FILLER                       PIC X(50).
  2786    12  PD-PRODUCT-DATA OCCURS 8.
  2787        16  PD-PROD-CODE             PIC X.
  2788            88  PD-PROD-LIFE           VALUE 'L'.
  2789            88  PD-PROD-PROP           VALUE 'P'.
  2790            88  PD-PROD-AH             VALUE 'A'.
  2791            88  PD-PROD-IU             VALUE 'I'.
  2792            88  PD-PROD-GAP            VALUE 'G'.
  2793            88  PD-PROD-FAML           VALUE 'F'.
  2794        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2795        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2796        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2797        16  PD-MAX-TERM              PIC S999        COMP-3.
  2798        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2799        16  FILLER                   PIC X.
  2800        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2801        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2802        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2803        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2804        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2805        16  PD-REC-CRIT-PERIOD       PIC 99.
  2806        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2807            20  PD-RECURRING-YN      PIC X.
  2808            20  FILLER               PIC X.
  2809        16  PD-RTW-MOS               PIC 99.
  2810        16  PD-MAX-EXTENSION         PIC 99.
  2811        16  FILLER                   PIC XX.
  2812    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2813    12  PD-TERM-LIMITS OCCURS 15.
  2814        16  PD-LOW-TERM              PIC S999        COMP-3.
  2815        16  PD-HI-TERM               PIC S999        COMP-3.
  2816*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2817    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2818        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2819        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2820    12  PD-EARN-FACTORS.
  2821        16  FILLER OCCURS 15.
  2822            20  FILLER OCCURS 15.
  2823                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2824    12  PD-PRODUCT-DESC              PIC X(80).
  2825    12  PD-TRUNCATED                 PIC X.
  2826    12  FILLER                       PIC X(59).
  2827    12  PD-MAINT-INFORMATION.
  2828        16  PD-LAST-MAINT-DT         PIC X(02).
  2829        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2830        16  PD-LAST-MAINT-BY         PIC X(04).
  2831*                                COPY ELCSTATE.
  2832******************************************************************
  2833*                                                                *
  2834*                                                                *
  2835*                            ELCSTATE.                           *
  2836*                                                                *
  2837*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2838*                                                                *
  2839*   FILE TYPE = VSAM,KSDS                                        *
  2840*   RECORD SIZE = 250  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  54
* EL050.cbl
  2841*                                                                *
  2842*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2843*       ALTERNATE INDEX = NONE                                   *
  2844*                                                                *
  2845*   LOG = YES                                                    *
  2846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2847******************************************************************
  2848*                   C H A N G E   L O G
  2849*
  2850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2851*-----------------------------------------------------------------
  2852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2853* EFFECTIVE    NUMBER
  2854*-----------------------------------------------------------------
  2855* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2856******************************************************************
  2857*
  2858 01  STATE-FILE.
  2859     12  SF-RECORD-ID                       PIC XX.
  2860         88  VALID-CF-ID                        VALUE 'SF'.
  2861     12  SF-CONTROL-PRIMARY.
  2862         16  SF-COMPANY-ID                  PIC XXX.
  2863         16  SF-CARRIER-CODE                PIC X.
  2864         16  SF-GROUPING                    PIC X(6).
  2865         16  SF-STATE-CODE                  PIC XX.
  2866         16  SF-EXPIRE-DATE                 PIC 9(8).
  2867****************************************************************
  2868*             STATE CONTROLS
  2869****************************************************************
  2870     12  SF-LAST-MAINT-DT                   PIC XX.
  2871     12  SF-LAST-MAINT-BY                   PIC X(4).
  2872     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2873     12  SF-STATE-RT-CONTROLS.
  2874         16  SF-ST-RT-CALC                  PIC X.
  2875     12  SF-ST-TAX-CONTROLS.
  2876         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2877         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2878         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2879     12  SF-ST-REFUND-OPTIONS.
  2880         16  SF-ST-RF-LR-CALC               PIC X.
  2881         16  SF-ST-RF-LL-CALC               PIC X.
  2882         16  SF-ST-RF-LN-CALC               PIC X.
  2883         16  SF-ST-RF-AH-CALC               PIC X.
  2884         16  SF-ST-RF-CP-CALC               PIC X.
  2885     12  SF-ST-UNEARN-PREM-OPTIONS.
  2886         16  SF-ST-LUEP-R78                 PIC X.
  2887         16  SF-ST-LUEP-PRO                 PIC X.
  2888         16  SF-ST-LUEP-ST                  PIC X.
  2889         16  SF-ST-LUEP-DOM                 PIC X.
  2890         16  SF-ST-AUEP-R78                 PIC X.
  2891         16  SF-ST-AUEP-PRO                 PIC X.
  2892         16  SF-ST-AUEP-ST                  PIC X.
  2893         16  SF-ST-AUEP-DOM                 PIC X.
  2894         16  SF-ST-CUEP-R78                 PIC X.
  2895         16  SF-ST-CUEP-PRO                 PIC X.
  2896         16  SF-ST-CUEP-ST                  PIC X.
  2897         16  SF-ST-CUEP-DOM                 PIC X.
  2898     12  SF-ST-EARN-PREM-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  55
* EL050.cbl
  2899         16  SF-ST-LEP-R78                  PIC X.
  2900         16  SF-ST-LEP-PRO                  PIC X.
  2901         16  SF-ST-LEP-ST                   PIC X.
  2902         16  SF-ST-LEP-DOM                  PIC X.
  2903         16  SF-ST-AEP-R78                  PIC X.
  2904         16  SF-ST-AEP-PRO                  PIC X.
  2905         16  SF-ST-AEP-ST                   PIC X.
  2906         16  SF-ST-AEP-DOM                  PIC X.
  2907         16  SF-ST-CEP-R78                  PIC X.
  2908         16  SF-ST-CEP-PRO                  PIC X.
  2909         16  SF-ST-CEP-ST                   PIC X.
  2910         16  SF-ST-CEP-DOM                  PIC X.
  2911     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  56
* EL050.cbl
  2913*    COPY ELCCRTT.
  2914******************************************************************
  2915*                                                                *
  2916*                            ELCCRTT.                            *
  2917*                                                                *
  2918*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2919*                                                                *
  2920*   FILE TYPE = VSAM,KSDS                                        *
  2921*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2922*                                                                *
  2923*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2924*                                                                *
  2925*   LOG = YES                                                    *
  2926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2927******************************************************************
  2928*                   C H A N G E   L O G
  2929*
  2930* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2931*-----------------------------------------------------------------
  2932*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2933* EFFECTIVE    NUMBER
  2934*-----------------------------------------------------------------
  2935* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2936* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2937* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2938* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2939* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2940* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2941* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2942******************************************************************
  2943
  2944 01  CERTIFICATE-TRAILERS.
  2945     12  CS-RECORD-ID                      PIC XX.
  2946         88  VALID-CS-ID                      VALUE 'CS'.
  2947
  2948     12  CS-CONTROL-PRIMARY.
  2949         16  CS-COMPANY-CD                 PIC X.
  2950         16  CS-CARRIER                    PIC X.
  2951         16  CS-GROUPING                   PIC X(6).
  2952         16  CS-STATE                      PIC XX.
  2953         16  CS-ACCOUNT                    PIC X(10).
  2954         16  CS-CERT-EFF-DT                PIC XX.
  2955         16  CS-CERT-NO.
  2956             20  CS-CERT-PRIME             PIC X(10).
  2957             20  CS-CERT-SFX               PIC X.
  2958         16  CS-TRAILER-TYPE               PIC X.
  2959             88  COMM-TRLR           VALUE 'A'.
  2960             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2961             88  CERT-DATA-TRLR      VALUE 'C'.
  2962
  2963     12  CS-DATA-AREA                      PIC X(516).
  2964
  2965     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2966         16  CS-BANK-COMMISSION-AREA.
  2967             20  CS-BANK-COMMS       OCCURS 10.
  2968                 24  CS-AGT                PIC X(10).
  2969                 24  CS-COM-TYP            PIC X.
  2970                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  57
* EL050.cbl
  2971                 24  CS-RECALC-LV-INDIC    PIC X.
  2972                 24  FILLER                PIC X(10).
  2973         16  FILLER                        PIC X(256).
  2974
  2975     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2976****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2977         16  CS-MB-CLAIM-DATA OCCURS 24.
  2978             20  CS-CLAIM-NO               PIC X(7).
  2979             20  CS-CLAIM-TYPE             PIC X.
  2980                 88  CS-AH-CLM               VALUE 'A'.
  2981                 88  CS-IU-CLM               VALUE 'I'.
  2982                 88  CS-GP-CLM               VALUE 'G'.
  2983                 88  CS-LF-CLM               VALUE 'L'.
  2984                 88  CS-PR-CLM               VALUE 'P'.
  2985                 88  CS-FL-CLM               VALUE 'F'.
  2986             20  CS-INSURED-TYPE           PIC X.
  2987                 88  CS-PRIM-INSURED          VALUE 'P'.
  2988                 88  CS-CO-BORROWER           VALUE 'C'.
  2989             20  CS-BENEFIT-PERIOD         PIC 99.
  2990             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2991             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2992             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2993         16  FILLER                        PIC X(12).
  2994     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2995         16  CS-VIN-NUMBER                 PIC X(17).
  2996         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2997         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2998         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2999         16  FILLER                        PIC X(496).
  3000*    COPY ELCCRTO.
  3001******************************************************************
  3002*                                                                *
  3003*                            ELCCRTO.                            *
  3004*                                                                *
  3005*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3006*                                                                *
  3007*   FILE TYPE = VSAM,KSDS                                        *
  3008*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3009*                                                                *
  3010*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3011*                                                                *
  3012*   LOG = YES                                                    *
  3013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3014******************************************************************
  3015*                   C H A N G E   L O G
  3016*
  3017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3018*-----------------------------------------------------------------
  3019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3020* EFFECTIVE    NUMBER
  3021*-----------------------------------------------------------------
  3022* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3023* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3024* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3025* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3026* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3027******************************************************************
  3028 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  58
* EL050.cbl
  3029     12  OC-RECORD-ID                      PIC XX.
  3030         88  VALID-OC-ID                      VALUE 'OC'.
  3031     12  OC-CONTROL-PRIMARY.
  3032         16  OC-COMPANY-CD                 PIC X.
  3033         16  OC-CARRIER                    PIC X.
  3034         16  OC-GROUPING                   PIC X(6).
  3035         16  OC-STATE                      PIC XX.
  3036         16  OC-ACCOUNT                    PIC X(10).
  3037         16  OC-CERT-EFF-DT                PIC XX.
  3038         16  OC-CERT-NO.
  3039             20  OC-CERT-PRIME             PIC X(10).
  3040             20  OC-CERT-SFX               PIC X.
  3041         16  OC-RECORD-TYPE                PIC X.
  3042         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3043     12  OC-LAST-MAINT-DT                  PIC XX.
  3044     12  OC-LAST-MAINT-BY                  PIC X(4).
  3045     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3046     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3047     12  FILLER                            PIC X(49).
  3048     12  OC-ORIG-REC.
  3049         16  OC-INS-LAST-NAME              PIC X(15).
  3050         16  OC-INS-FIRST-NAME             PIC X(10).
  3051         16  OC-INS-MIDDLE-INIT            PIC X.
  3052         16  OC-INS-AGE                    PIC S999     COMP-3.
  3053         16  OC-JNT-LAST-NAME              PIC X(15).
  3054         16  OC-JNT-FIRST-NAME             PIC X(10).
  3055         16  OC-JNT-MIDDLE-INIT            PIC X.
  3056         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3057         16  OC-LF-BENCD                   PIC XX.
  3058         16  OC-LF-TERM                    PIC S999      COMP-3.
  3059         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3060         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3061         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3062         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3063         16  OC-LF-EXP-DT                  PIC XX.
  3064         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3065         16  OC-LF-CANCEL-DT               PIC XX.
  3066         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3067         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3068         16  OC-AH-BENCD                   PIC XX.
  3069         16  OC-AH-TERM                    PIC S999      COMP-3.
  3070         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3071         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3072         16  OC-AH-EXP-DT                  PIC XX.
  3073         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3074         16  OC-AH-CP                      PIC 99.
  3075         16  OC-AH-CANCEL-DT               PIC XX.
  3076         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3077         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3078         16  OC-CRED-BENE-NAME             PIC X(25).
  3079         16  OC-1ST-PMT-DT                 PIC XX.
  3080         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3081         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3082         16  OC-ISSUE-TRAN-IND             PIC X.
  3083         16  OC-CANCEL-TRAN-IND            PIC X.
  3084         16  FILLER                        PIC X(211).
  3085
  3086     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  59
* EL050.cbl
  3087******************************************************************
  3088
  3089*    COPY ELCDATE.
  3090******************************************************************
  3091*                                                                *
  3092*                                                                *
  3093*                            ELCDATE.                            *
  3094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3095*                            VMOD=2.003
  3096*                                                                *
  3097*                                                                *
  3098*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3099*                 LENGTH = 200                                   *
  3100******************************************************************
  3101
  3102 01  DATE-CONVERSION-DATA.
  3103     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3104     12  DC-OPTION-CODE                PIC X.
  3105         88  BIN-TO-GREG                VALUE ' '.
  3106         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3107         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3108         88  YMD-GREG-TO-BIN            VALUE '3'.
  3109         88  MDY-GREG-TO-BIN            VALUE '4'.
  3110         88  JULIAN-TO-BIN              VALUE '5'.
  3111         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3112         88  FIND-CENTURY               VALUE '7'.
  3113         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3114         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3115         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3116         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3117         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3118         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3119         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3120         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3121         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3122         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3123         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3124         88  BIN-3-TO-GREG              VALUE 'I'.
  3125         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3126         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3127         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3128         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3129         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3130         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3131         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3132         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3133         88  THREE-CHARACTER-BIN
  3134                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3135         88  GREGORIAN-TO-BIN
  3136                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3137         88  BIN-TO-GREGORIAN
  3138                  VALUES ' ' '1' 'I' '8' 'G'.
  3139         88  JULIAN-TO-BINARY
  3140                  VALUES '5' 'C' 'E' 'F'.
  3141     12  DC-ERROR-CODE                 PIC X.
  3142         88  NO-CONVERSION-ERROR        VALUE ' '.
  3143         88  DATE-CONVERSION-ERROR
  3144                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  60
* EL050.cbl
  3145         88  DATE-IS-ZERO               VALUE '1'.
  3146         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3147         88  DATE-IS-INVALID            VALUE '3'.
  3148         88  DATE1-GREATER-DATE2        VALUE '4'.
  3149         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3150         88  DATE-INVALID-OPTION        VALUE '9'.
  3151         88  INVALID-CENTURY            VALUE 'A'.
  3152         88  ONLY-CENTURY               VALUE 'B'.
  3153         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3154         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3155     12  DC-END-OF-MONTH               PIC X.
  3156         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3157     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3158         88  USE-NORMAL-PROCESS         VALUE ' '.
  3159         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3160         88  ADJUST-UP-100-YRS          VALUE '2'.
  3161     12  FILLER                        PIC X.
  3162     12  DC-CONVERSION-DATES.
  3163         16  DC-BIN-DATE-1             PIC XX.
  3164         16  DC-BIN-DATE-2             PIC XX.
  3165         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3166         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3167                       DC-GREG-DATE-1-EDIT.
  3168             20  DC-EDIT1-MONTH        PIC 99.
  3169             20  SLASH1-1              PIC X.
  3170             20  DC-EDIT1-DAY          PIC 99.
  3171             20  SLASH1-2              PIC X.
  3172             20  DC-EDIT1-YEAR         PIC 99.
  3173         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3174         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3175                     DC-GREG-DATE-2-EDIT.
  3176             20  DC-EDIT2-MONTH        PIC 99.
  3177             20  SLASH2-1              PIC X.
  3178             20  DC-EDIT2-DAY          PIC 99.
  3179             20  SLASH2-2              PIC X.
  3180             20  DC-EDIT2-YEAR         PIC 99.
  3181         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3182         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3183                     DC-GREG-DATE-1-YMD.
  3184             20  DC-YMD-YEAR           PIC 99.
  3185             20  DC-YMD-MONTH          PIC 99.
  3186             20  DC-YMD-DAY            PIC 99.
  3187         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3188         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3189                      DC-GREG-DATE-1-MDY.
  3190             20  DC-MDY-MONTH          PIC 99.
  3191             20  DC-MDY-DAY            PIC 99.
  3192             20  DC-MDY-YEAR           PIC 99.
  3193         16  DC-GREG-DATE-1-ALPHA.
  3194             20  DC-ALPHA-MONTH        PIC X(10).
  3195             20  DC-ALPHA-DAY          PIC 99.
  3196             20  FILLER                PIC XX.
  3197             20  DC-ALPHA-CENTURY.
  3198                 24 DC-ALPHA-CEN-N     PIC 99.
  3199             20  DC-ALPHA-YEAR         PIC 99.
  3200         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3201         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3202         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  61
* EL050.cbl
  3203         16  DC-JULIAN-DATE            PIC 9(05).
  3204         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3205                                       PIC 9(05).
  3206         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3207             20  DC-JULIAN-YEAR        PIC 99.
  3208             20  DC-JULIAN-DAYS        PIC 999.
  3209         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3210         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3211         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3212     12  DATE-CONVERSION-VARIBLES.
  3213         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3214         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3215             20  FILLER                PIC 9(3).
  3216             20  HOLD-CEN-1-CCYY.
  3217                 24  HOLD-CEN-1-CC     PIC 99.
  3218                 24  HOLD-CEN-1-YY     PIC 99.
  3219             20  HOLD-CEN-1-MO         PIC 99.
  3220             20  HOLD-CEN-1-DA         PIC 99.
  3221         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3222             20  HOLD-CEN-1-R-MO       PIC 99.
  3223             20  HOLD-CEN-1-R-DA       PIC 99.
  3224             20  HOLD-CEN-1-R-CCYY.
  3225                 24  HOLD-CEN-1-R-CC   PIC 99.
  3226                 24  HOLD-CEN-1-R-YY   PIC 99.
  3227             20  FILLER                PIC 9(3).
  3228         16  HOLD-CENTURY-1-X.
  3229             20  FILLER                PIC X(3)  VALUE SPACES.
  3230             20  HOLD-CEN-1-X-CCYY.
  3231                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3232                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3233             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3234             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3235         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3236             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3237             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3238             20  HOLD-CEN-1-R-X-CCYY.
  3239                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3240                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3241             20  FILLER                PIC XXX.
  3242         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3243         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3244         16  DC-JULIAN-DATE-1          PIC 9(07).
  3245         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3246             20  DC-JULIAN-1-CCYY.
  3247                 24  DC-JULIAN-1-CC    PIC 99.
  3248                 24  DC-JULIAN-1-YR    PIC 99.
  3249             20  DC-JULIAN-DA-1        PIC 999.
  3250         16  DC-JULIAN-DATE-2          PIC 9(07).
  3251         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3252             20  DC-JULIAN-2-CCYY.
  3253                 24  DC-JULIAN-2-CC    PIC 99.
  3254                 24  DC-JULIAN-2-YR    PIC 99.
  3255             20  DC-JULIAN-DA-2        PIC 999.
  3256         16  DC-GREG-DATE-A-EDIT.
  3257             20  DC-EDITA-MONTH        PIC 99.
  3258             20  SLASHA-1              PIC X VALUE '/'.
  3259             20  DC-EDITA-DAY          PIC 99.
  3260             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  62
* EL050.cbl
  3261             20  DC-EDITA-CCYY.
  3262                 24  DC-EDITA-CENT     PIC 99.
  3263                 24  DC-EDITA-YEAR     PIC 99.
  3264         16  DC-GREG-DATE-B-EDIT.
  3265             20  DC-EDITB-MONTH        PIC 99.
  3266             20  SLASHB-1              PIC X VALUE '/'.
  3267             20  DC-EDITB-DAY          PIC 99.
  3268             20  SLASHB-2              PIC X VALUE '/'.
  3269             20  DC-EDITB-CCYY.
  3270                 24  DC-EDITB-CENT     PIC 99.
  3271                 24  DC-EDITB-YEAR     PIC 99.
  3272         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3273         16  DC-GREG-DATE-CYMD-R REDEFINES
  3274                              DC-GREG-DATE-CYMD.
  3275             20  DC-CYMD-CEN           PIC 99.
  3276             20  DC-CYMD-YEAR          PIC 99.
  3277             20  DC-CYMD-MONTH         PIC 99.
  3278             20  DC-CYMD-DAY           PIC 99.
  3279         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3280         16  DC-GREG-DATE-MDCY-R REDEFINES
  3281                              DC-GREG-DATE-MDCY.
  3282             20  DC-MDCY-MONTH         PIC 99.
  3283             20  DC-MDCY-DAY           PIC 99.
  3284             20  DC-MDCY-CEN           PIC 99.
  3285             20  DC-MDCY-YEAR          PIC 99.
  3286    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3287        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3288    12  DC-EL310-DATE                  PIC X(21).
  3289    12  FILLER                         PIC X(28).
  3290
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  63
* EL050.cbl
  3292*    COPY ELCCALC.
  3293******************************************************************
  3294*                                                                *
  3295*                           ELCCALC.                            *
  3296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3297*                            VMOD=2.025                          *
  3298*                                                                *
  3299*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3300*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3301*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3302*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3303*                                                                *
  3304*  PASSED TO ELRTRM                                              *
  3305*  -----------------                                             *
  3306*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3307*  ORIGINAL TERM                                                 *
  3308*  BEGINNING DATE                                                *
  3309*  ENDING DATE                                                   *
  3310*  COMPANY I.D.                                                  *
  3311*  ACCOUNT MASTER USER FIELD                                     *
  3312*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3313*  FREE LOOK DAYS                                                *
  3314*                                                                *
  3315*  RETURNED FROM ELRTRM                                          *
  3316*  ---------------------                                         *
  3317*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3318*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3319*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3320*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3321*----------------------------------------------------------------*
  3322*  PASSED TO ELRAMT                                              *
  3323*  ----------------                                              *
  3324*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3325*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3326*  ORIGINAL AMOUNT                                               *
  3327*  ALTERNATE BENEFIT (BALLON)                                    *
  3328*  A.P.R. - NET PAY ONLY                                         *
  3329*  METHOD
  3330*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3331*  COMPANY I.D.                                                  *
  3332*  BENEFIT TYPE                                                  *
  3333*                                                                *
  3334*  RETURNED FROM ELRAMT                                          *
  3335*  --------------------                                          *
  3336*  REMAINING AMOUNT 1 - CURRENT                                  *
  3337*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3338*  REMAINING AMOUNT FACTOR
  3339*----------------------------------------------------------------*
  3340*  PASSED TO ELRESV                                              *
  3341*  -----------------                                             *
  3342*  CERTIFICATE EFFECTIVE DATE                                    *
  3343*  VALUATION DATE                                                *
  3344*  PAID THRU DATE                                                *
  3345*  BENEFIT                                                       *
  3346*  INCURRED DATE                                                 *
  3347*  REPORTED DATE                                                 *
  3348*  ISSUE AGE                                                     *
  3349*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  64
* EL050.cbl
  3350*  CDT PERCENT                                                   *
  3351*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3352* *CLAIM TYPE (LIFE, A/H)                                        *
  3353* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3354* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3355*                                                                *
  3356*  RETURNED FROM ELRESV                                          *
  3357*  --------------------                                          *
  3358*  CDT TABLE USED                                                *
  3359*  CDT FACTOR USED                                               *
  3360*  PAY TO CURRENT RESERVE                                        *
  3361*  I.B.N.R. - A/H ONLY                                           *
  3362*  FUTURE (ACCRUED) AH ONLY                                      *
  3363*----------------------------------------------------------------*
  3364*  PASSED TO ELRATE                                              *
  3365*  ----------------                                              *
  3366*  CERT ISSUE DATE                                               *
  3367*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3368*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3369*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3370*  STATE CODE (CLIENT DEFINED)                                   *
  3371*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3372*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3373*  DEVIATION CODE                                                *
  3374*  ISSUE AGE                                                     *
  3375*  ORIGINAL BENEFIT AMOUNT                                       *
  3376*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3377*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3378*  BENEFIT KIND (LIFE OR A/H)                                    *
  3379*  A.P.R.                                                        *
  3380*  METHOD
  3381*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3382*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3383*  COMPANY I.D. (3 CHARACTER)                                    *
  3384*  BENEFIT CODE                                                  *
  3385*  BENEFIT OVERRIDE CODE                                         *
  3386*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3387*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3388*  JOINT INDICATOR (CSL ONLY)                                    *
  3389*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3390*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3391*                                                                *
  3392*  RETURNED FROM ELRATE                                          *
  3393*  --------------------                                          *
  3394*  CALCULATED PREMIUM                                            *
  3395*  PREMIUM RATE                                                  *
  3396*  MORTALITY CODE                                                *
  3397*  MAX ATTAINED AGE                                              *
  3398*  MAX AGE                                                       *
  3399*  MAX TERM                                                      *
  3400*  MAX MONTHLY BENEFIT                                           *
  3401*  MAX TOTAL BENIFIT                                             *
  3402*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRFND                                              *
  3405*  ----------------                                              *
  3406*  CERT ISSUE DATE                                               *
  3407*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  65
* EL050.cbl
  3408*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3409*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3410*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3411*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3412*  STATE CODE (CLIENT DEFINED)                                   *
  3413*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3414*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3415*  DEVIATION CODE                                                *
  3416*  ISSUE AGE                                                     *
  3417*  ORIGINAL BENEFIT AMOUNT                                       *
  3418*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3419*  PROCESS TYPE (CANCEL)                                         *
  3420*  BENEFIT KIND (LIFE OR A/H)                                    *
  3421*  A.P.R.                                                        *
  3422*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3423*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3424*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3425*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3426*  COMPANY I.D. (3 CHARACTER)                                    *
  3427*  BENEFIT CODE                                                  *
  3428*  BENEFIT OVERRIDE CODE                                         *
  3429*                                                                *
  3430*  RETURNED FROM ELRFND                                          *
  3431*  --------------------                                          *
  3432*  CALCULATED REFUND                                             *
  3433*----------------------------------------------------------------*
  3434*  PASSED TO ELEARN                                              *
  3435*  ----------------                                              *
  3436*  CERT ISSUE DATE                                               *
  3437*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3438*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3439*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3440*  STATE CODE (CLIENT DEFINED)                                   *
  3441*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3442*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3443*  DEVIATION CODE                                                *
  3444*  ISSUE AGE                                                     *
  3445*  ORIGINAL BENEFIT AMOUNT                                       *
  3446*  BENEFIT KIND (LIFE OR A/H)                                    *
  3447*  A.P.R.                                                        *
  3448*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3449*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3450*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3451*  COMPANY I.D. (3 CHARACTER)                                    *
  3452*  BENEFIT CODE                                                  *
  3453*  BENEFIT OVERRIDE CODE                                         *
  3454*                                                                *
  3455*  RETURNED FROM ELEARN                                          *
  3456*  --------------------                                          *
  3457*  INDICATED  EARNINGS                                           *
  3458*----------------------------------------------------------------*
  3459*                 LENGTH = 450                                   *
  3460*                                                                *
  3461******************************************************************
  3462******************************************************************
  3463*                   C H A N G E   L O G
  3464*
  3465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  66
* EL050.cbl
  3466*-----------------------------------------------------------------
  3467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3468* EFFECTIVE    NUMBER
  3469*-----------------------------------------------------------------
  3470* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3471* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3472* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3473* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3474* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3475* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3476* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3477* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3478* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3479******************************************************************
  3480
  3481 01  CALCULATION-PASS-AREA.
  3482     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3483                                     COMP.
  3484
  3485     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3486       88  NO-CP-ERROR                             VALUE ZERO.
  3487       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3488                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3489       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3490       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3491       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3492       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3493       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3494       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3495       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3496       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3497       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3498       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3499       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3500       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3501       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3502       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3503       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3504       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3505       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3506
  3507     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3508       88  NO-CP-ERROR-2                           VALUE ZERO.
  3509***********************  INPUT AREAS ****************************
  3510
  3511     12  CP-CALCULATION-AREA.
  3512         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3513         16  CP-CERT-EFF-DT        PIC XX.
  3514         16  CP-VALUATION-DT       PIC XX.
  3515         16  CP-PAID-THRU-DT       PIC XX.
  3516         16  CP-BENEFIT-TYPE       PIC X.
  3517           88  CP-AH                               VALUE 'A' 'D'
  3518                                                   'I' 'U'.
  3519           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3520           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3521         16  CP-INCURRED-DT        PIC XX.
  3522         16  CP-REPORTED-DT        PIC XX.
  3523         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  67
* EL050.cbl
  3524         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3525         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-CDT-METHOD         PIC X.
  3530           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3531           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3532           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3533         16  CP-CLAIM-TYPE         PIC X.
  3534           88  CP-AH-CLAIM                         VALUE 'A'.
  3535           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3536         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3537                                     COMP-3.
  3538         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3539                                     COMP-3.
  3540         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3543                                     COMP-3.
  3544         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3547                                     COMP-3.
  3548         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3549                                     COMP-3.
  3550         16  CP-REM-TERM-METHOD    PIC X.
  3551           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3552           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3553           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3554           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3555           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3556           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3557           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3558         16  CP-EARNING-METHOD     PIC X.
  3559           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3560           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3561           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3562           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3563           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3564           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3565           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3566           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3567           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3568           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3569           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3570           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3571           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3572           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3573         16  CP-PROCESS-TYPE       PIC X.
  3574           88  CP-CLAIM                            VALUE '1'.
  3575           88  CP-CANCEL                           VALUE '2'.
  3576           88  CP-ISSUE                            VALUE '3'.
  3577         16  CP-SPECIAL-CALC-CD    PIC X.
  3578           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3579           88  CP-1-MTH-INTEREST               VALUE ' '.
  3580           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3581           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  68
* EL050.cbl
  3582           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3583           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3584           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3585           88  CP-FARM-PLAN                    VALUE 'F'.
  3586           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3587           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3588           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3589           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3590           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3591           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3592           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3593           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3594           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3595           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3596                                                     'W' 'X'.
  3597           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3598           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3599           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3600           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3601           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3602           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3603           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3604           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3605           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3606           88  CP-CSL-METH-1                   VALUE '5'.
  3607           88  CP-CSL-METH-2                   VALUE '6'.
  3608           88  CP-CSL-METH-3                   VALUE '7'.
  3609           88  CP-CSL-METH-4                   VALUE '8'.
  3610
  3611         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3612                                     COMP-3.
  3613         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3614         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3615         16  CP-STATE              PIC XX          VALUE SPACE.
  3616         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3617         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3618           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3619               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3620         16  CP-R78-OPTION         PIC X.
  3621           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3622           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3623
  3624         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3625         16  CP-IBNR-RESERVE-SW    PIC X.
  3626         16  CP-CLAIM-STATUS       PIC X.
  3627         16  CP-RATE-FILE          PIC X.
  3628         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3629                                     COMP-3.
  3630
  3631         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3632         16  CP-AH-OVERRIDE-CODE   PIC X.
  3633
  3634         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3635                                     COMP-3.
  3636         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3637                                   PIC S9(5)V99 COMP-3.
  3638         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3639                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  69
* EL050.cbl
  3640         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3645                                  PIC S9(7)V99 COMP-3.
  3646
  3647         16  CP-PAID-FROM-DATE     PIC X(02).
  3648         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3649         16  CP-EXT-DAYS-CALC      PIC X.
  3650           88  CP-EXT-NO-CHG                   VALUE ' '.
  3651           88  CP-EXT-CHG-LF                   VALUE '1'.
  3652           88  CP-EXT-CHG-AH                   VALUE '2'.
  3653           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3654         16  CP-DOMICILE-STATE     PIC XX.
  3655         16  CP-CARRIER            PIC X.
  3656         16  CP-REIN-FLAG          PIC X.
  3657         16  CP-REM-TRM-CALC-OPTION PIC X.
  3658           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3659                      '2' '3' '4' '5'.
  3660           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3661           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3662           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3663           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3664           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3665           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3666           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3667           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3668         16  CP-SIG-SWITCH         PIC X.
  3669         16  CP-RATING-METHOD      PIC X.
  3670           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3671           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3672           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3673           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3674           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3675           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3676           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3677           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3678           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3679         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3680                                     COMP-3.
  3681         16  CP-BEN-CATEGORY       PIC X.
  3682         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3683         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3684                                   PIC S99V9(5) COMP-3.
  3685         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3686         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3687                                   PIC S99V9(5) COMP-3.
  3688         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3689         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3690         16  CP-EXPIRE-DT          PIC XX.
  3691         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3692         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3693         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3694         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3695         16  CP-DDF-SPEC-CALC      PIC X.
  3696             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3697             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  70
* EL050.cbl
  3698         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3699         16  CP-CANCEL-REASON      PIC X.
  3700         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3701         16  CP-PMT-MODE           PIC X.
  3702         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3703         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3704         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3705         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3706         16  FILLER                PIC X.
  3707
  3708***************    OUTPUT FROM ELRESV   ************************
  3709
  3710         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3711
  3712         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3719                                     COMP-3.
  3720         16  FILLER                PIC X(09).
  3721***************    OUTPUT FROM ELRTRM   *************************
  3722
  3723         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3726                                     COMP-3.
  3727         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3730                                     COMP-3.
  3731         16  FILLER                PIC X(12).
  3732
  3733***************    OUTPUT FROM ELRAMT   *************************
  3734
  3735         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3738                                     COMP-3.
  3739         16  FILLER                PIC X(12).
  3740
  3741***************    OUTPUT FROM ELRATE   *************************
  3742
  3743         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-MORTALITY-CODE     PIC X(4).
  3748         16  CP-RATE-EDIT-FLAG     PIC X.
  3749             88  CP-RATES-NEED-APR                  VALUE '1'.
  3750         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3753         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3754         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3755                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  71
* EL050.cbl
  3756         16  FILLER                PIC X(07).
  3757
  3758***************    OUTPUT FROM ELRFND   *************************
  3759
  3760         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-REFUND-TYPE-USED   PIC X.
  3763           88  CP-R-AS-R78                         VALUE '1'.
  3764           88  CP-R-AS-PRORATA                     VALUE '2'.
  3765           88  CP-R-AS-CALIF                       VALUE '3'.
  3766           88  CP-R-AS-TEXAS                       VALUE '4'.
  3767           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3768           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3769           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3770           88  CP-R-AS-MEAN                        VALUE '8'.
  3771           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3772           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3773           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3774           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3775           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3776           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3777         16  FILLER                PIC X(12).
  3778
  3779***************    OUTPUT FROM ELEARN   *************************
  3780
  3781         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3788                                     COMP-3.
  3789         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-EARNING-TYPE-USED  PIC X.
  3794           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3795           88  CP-E-AS-R78                         VALUE '1'.
  3796           88  CP-E-AS-PRORATA                     VALUE '2'.
  3797           88  CP-E-AS-TEXAS                       VALUE '4'.
  3798           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3799           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3800           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3801           88  CP-E-AS-MEAN                        VALUE '8'.
  3802           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3803         16  FILLER                PIC X(12).
  3804
  3805***************    OUTPUT FROM ELPMNT   *************************
  3806
  3807         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  FILLER                PIC X(12).
  3812
  3813***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  72
* EL050.cbl
  3814         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3819                                     COMP-3.
  3820         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3827             88  OPEN-RATE-FILE                   VALUE 'O'.
  3828             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3829             88  IO-ERROR                         VALUE 'E'.
  3830
  3831         16  CP-FIRST-PAY-DATE     PIC XX.
  3832
  3833         16  CP-JOINT-INDICATOR    PIC X.
  3834
  3835         16  CP-RESERVE-REMAINING-TERM
  3836                                   PIC S9(4)V9    VALUE ZERO
  3837                                     COMP-3.
  3838
  3839         16  CP-INSURED-BIRTH-DT   PIC XX.
  3840
  3841         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3842                                     COMP-3.
  3843
  3844         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3845                                     COMP-3.
  3846
  3847         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3848                                     COMP-3.
  3849
  3850         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3851                                     COMP-3.
  3852
  3853         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3854                                     COMP-3.
  3855
  3856         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3857                                     COMP-3.
  3858
  3859         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3860                                     COMP-3.
  3861
  3862         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3863             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3864
  3865         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3870         16  FILLER                PIC X(15).
  3871******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  73
* EL050.cbl
  3873******************************************************************
  3874*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3875*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3876*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3877*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3878*** MODIFICATION.                                              ***
  3879*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3880*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3881******************************************************************
  3882*    COPY ERCPNDB.
  3883******************************************************************
  3884*                                                                *
  3885*                                                                *
  3886*                            ERCPNDB.                            *
  3887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3888*                            VMOD=2.025                          *
  3889*                                                                *
  3890*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3891*                                                                *
  3892******************************************************************
  3893*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3894*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3895******************************************************************
  3896*                                                                *
  3897*                                                                *
  3898*   FILE TYPE = VSAM,KSDS                                        *
  3899*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3900*                                                                *
  3901*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3902*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3903*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3904*                                                 RKP=13,LEN=36  *
  3905*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3906*                                      AND CHG-SEQ.)             *
  3907*                                                RKP=49,LEN=11   *
  3908*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3909*                                      AND CHG-SEQ.)             *
  3910*                                                RKP=60,LEN=15   *
  3911*                                                                *
  3912*   LOG = NO                                                     *
  3913*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3914******************************************************************
  3915******************************************************************
  3916*                   C H A N G E   L O G
  3917*
  3918* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3919*-----------------------------------------------------------------
  3920*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3921* EFFECTIVE    NUMBER
  3922*-----------------------------------------------------------------
  3923* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3924* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3925* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3926* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3927* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3928* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3929* 032306                   PEMA  ADD BOW LOAN NUMBER
  3930* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  74
* EL050.cbl
  3931* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3932* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3933* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3934* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3935* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3936* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3937* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3938* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3939******************************************************************
  3940
  3941 01  PENDING-BUSINESS.
  3942     12  PB-RECORD-ID                     PIC XX.
  3943         88  VALID-PB-ID                        VALUE 'PB'.
  3944
  3945     12  PB-CONTROL-PRIMARY.
  3946         16  PB-COMPANY-CD                PIC X.
  3947         16  PB-ENTRY-BATCH               PIC X(6).
  3948         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3949         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3950
  3951     12  PB-CONTROL-BY-ACCOUNT.
  3952         16  PB-COMPANY-CD-A1             PIC X.
  3953         16  PB-CARRIER                   PIC X.
  3954         16  PB-GROUPING.
  3955             20  PB-GROUPING-PREFIX       PIC XXX.
  3956             20  PB-GROUPING-PRIME        PIC XXX.
  3957         16  PB-STATE                     PIC XX.
  3958         16  PB-ACCOUNT.
  3959             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3960             20  PB-ACCOUNT-PRIME         PIC X(6).
  3961         16  PB-CERT-EFF-DT               PIC XX.
  3962         16  PB-CERT-NO.
  3963             20  PB-CERT-PRIME            PIC X(10).
  3964             20  PB-CERT-SFX              PIC X.
  3965         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3966
  3967         16  PB-RECORD-TYPE               PIC X.
  3968             88  PB-MAILING-DATA                VALUE '0'.
  3969             88  PB-ISSUE                       VALUE '1'.
  3970             88  PB-CANCELLATION                VALUE '2'.
  3971             88  PB-BATCH-TRAILER               VALUE '9'.
  3972
  3973     12  PB-CONTROL-BY-ORIG-BATCH.
  3974         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3975         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3976         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3977         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3978
  3979     12  PB-CONTROL-BY-CSR.
  3980         16  PB-CSR-COMPANY-CD            PIC X.
  3981         16  PB-CSR-ID                    PIC X(4).
  3982         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3983         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3984         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3985******************************************************************
  3986*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3987******************************************************************
  3988
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  75
* EL050.cbl
  3989     12  PB-LAST-MAINT-DT                 PIC XX.
  3990     12  PB-LAST-MAINT-BY                 PIC X(4).
  3991     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3992
  3993     12  PB-RECORD-BODY                   PIC X(375).
  3994
  3995     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3996         16  PB-CERT-ORIGIN               PIC X.
  3997             88  CLASIC-CREATED-CERT         VALUE '1'.
  3998         16  PB-I-NAME.
  3999             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4000             20  PB-I-INSURED-FIRST-NAME.
  4001                 24  PB-I-INSURED-1ST-INIT PIC X.
  4002                 24  FILLER                PIC X(9).
  4003             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4004         16  PB-I-AGE                     PIC S99   COMP-3.
  4005         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4006         16  PB-I-BIRTHDAY                PIC XX.
  4007         16  PB-I-INSURED-SEX             PIC X.
  4008             88  PB-SEX-MALE     VALUE 'M'.
  4009             88  PB-SEX-FEMALE   VALUE 'F'.
  4010
  4011         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4012         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4013         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4014         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4015         16  PB-I-SKIP-CODE               PIC X.
  4016             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4017             88  PB-SKIP-JULY              VALUE '1'.
  4018             88  PB-SKIP-AUGUST            VALUE '2'.
  4019             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4020             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4021             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4022             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4023             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4024             88  PB-SKIP-JUNE              VALUE '8'.
  4025             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4026             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4027             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4028         16  PB-I-TERM-TYPE               PIC X.
  4029             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4030             88  PB-PAID-WEEKLY            VALUE 'W'.
  4031             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4032             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4033             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4034         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4035         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4036         16  PB-I-DATA-ENTRY-SW           PIC X.
  4037             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4038             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4039             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4040             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4041         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4042         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4043*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4044         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4045         16  FILLER                       PIC X.
  4046
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  76
* EL050.cbl
  4047         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4048             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4049             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4050                                                   '90' THRU '99'.
  4051         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4052                                          PIC XX.
  4053         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4054         16  PB-I-AMOUNT-FINANCED REDEFINES
  4055                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4056         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4057         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4058                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4059         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4060         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4061         16  PB-I-CLP-AMOUNT REDEFINES
  4062                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4063         16  PB-I-LF-CALC-FLAG            PIC X.
  4064             88 PB-COMP-LF-PREM               VALUE '?'.
  4065         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4066         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4067         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4068         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4069         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4070         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4071         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4072         16  PB-I-LF-ABBR                 PIC XXX.
  4073         16  PB-I-LF-INPUT-CD             PIC XX.
  4074
  4075         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4076             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4077             88  PB-INVALID-AH               VALUE '  ' '00'
  4078                                                   '90' THRU '99'.
  4079         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4080         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4081         16  PB-I-AH-CALC-FLAG            PIC X.
  4082             88 PB-COMP-AH-PREM                  VALUE '?'.
  4083         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4084         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4085         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4086         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4087         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4088         16  PB-I-AH-ABBR                 PIC XXX.
  4089         16  PB-I-AH-INPUT-CD             PIC XXX.
  4090
  4091         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4092         16  PB-I-REIN-TABLE              PIC XXX.
  4093         16  PB-I-BUSINESS-TYPE           PIC 99.
  4094         16  PB-I-INDV-GRP-CD             PIC X.
  4095         16  PB-I-MORT-CODE.
  4096             20  PB-I-TABLE               PIC X.
  4097             20  PB-I-INTEREST            PIC XX.
  4098             20  PB-I-MORT-TYP            PIC X.
  4099         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4100         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4101         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4102         16  PB-I-INDV-GRP-OVRD           PIC X.
  4103         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4104         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  77
* EL050.cbl
  4105             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4106         16  PB-I-RATE-CLASS              PIC XX.
  4107         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4108         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4109         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4110         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4111         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4112         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4113         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4114         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4115         16  PB-I-OB-FLAG                 PIC X.
  4116             88  PB-I-OB                      VALUE 'B'.
  4117             88  PB-I-SUMMARY                 VALUE 'Z'.
  4118         16  PB-I-ENTRY-STATUS            PIC X.
  4119             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4120                                              'M' '5' '9' '2'.
  4121             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4122             88  PB-I-POLICY-PENDING          VALUE '2'.
  4123             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4124             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4125             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4126             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4127             88  PB-I-REIN-ONLY               VALUE '9'.
  4128             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4129             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4130             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4131             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4132         16  PB-I-INT-CODE                PIC X.
  4133             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4134             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4135         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4136         16  PB-I-SOC-SEC-NO              PIC X(11).
  4137         16  PB-I-MEMBER-NO               PIC X(12).
  4138         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4139*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4140         16  PB-I-OLD-LOF                 PIC XXX.
  4141         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4142         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4143         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4144         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4145         16  PB-I-LIFE-INDICATOR          PIC X.
  4146             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4147         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4148         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4149                                          PIC S9(5)V99    COMP-3.
  4150         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4151             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4152             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4153         16  PB-I-1ST-PMT-DT              PIC XX.
  4154         16  PB-I-JOINT-INSURED.
  4155             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4156             20 PB-I-JOINT-FIRST-NAME.
  4157                24  PB-I-JOINT-FIRST-INIT PIC X.
  4158                24  FILLER                PIC X(9).
  4159             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4160*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4161         16  PB-I-BENEFICIARY-NAME.
  4162             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  78
* EL050.cbl
  4163             20  FILLER                   PIC X(15).
  4164         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4165         16  PB-I-REFERENCE               PIC X(12).
  4166         16  FILLER REDEFINES PB-I-REFERENCE.
  4167             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4168             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4169             20  PB-I-CLP-STATE           PIC XX.
  4170         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4171             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4172             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4173             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4174         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4175         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4176         16  PB-I-RESIDENT-STATE          PIC XX.
  4177         16  PB-I-RATE-CODE               PIC X(4).
  4178         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4179         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4180         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4181         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4182         16  PB-I-BANK-NOCHRGB            PIC 99.
  4183         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4184         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4185
  4186     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4187         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4188             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4189         16  PB-C-CANCEL-ORIGIN           PIC X.
  4190             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4191         16  PB-C-LF-CANCEL-DT            PIC XX.
  4192         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4193         16  PB-C-LF-CALC-REQ             PIC X.
  4194             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4195         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4196         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4197         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4198             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4199         16  PB-C-AH-CANCEL-DT            PIC XX.
  4200         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4201         16  PB-C-AH-CALC-REQ             PIC X.
  4202             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4203         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4204         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4205         16  PB-C-LAST-NAME               PIC X(15).
  4206         16  PB-C-REFUND-SW               PIC X.
  4207             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4208             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4209         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4210         16  PB-C-PAYEE-CODE              PIC X(6).
  4211         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4212         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4213         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4214         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4215         16  PB-C-REFERENCE               PIC X(12).
  4216         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4217         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4218         16  PB-C-POST-CARD-IND           PIC X.
  4219         16  PB-C-CANCEL-REASON           PIC X.
  4220         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  79
* EL050.cbl
  4221         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4222         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4223         16  FILLER                       PIC X(01).
  4224*        16  FILLER                       PIC X(18).
  4225         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4226*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4227         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4228         16  PB-CANCELED-CERT-DATA.
  4229             20  PB-CI-INSURED-NAME.
  4230                 24  PB-CI-LAST-NAME      PIC X(15).
  4231                 24  PB-CI-INITIALS       PIC XX.
  4232             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4233             20  PB-CI-INSURED-SEX        PIC X.
  4234             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4235             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4236             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4237             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4238             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4239             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4240             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4241             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4242             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4243             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4244             20  PB-CI-RATE-CLASS         PIC XX.
  4245             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4246             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4247             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4248             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4249             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4250             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4251             20  PB-CI-LF-ABBR            PIC X(3).
  4252             20  PB-CI-AH-ABBR            PIC X(3).
  4253             20  PB-CI-OB-FLAG            PIC X.
  4254                 88  PB-CI-OB                VALUE 'B'.
  4255             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4256                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4257                                           'M' '4' '5' '9' '2'.
  4258                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4259                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4260                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4261                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4262                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4263                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4264                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4265                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4266                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4267                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4268                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4269                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4270                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4271             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4272                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4273                                           'M' '4' '5' '9' '2'.
  4274                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4275                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4276                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4277                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4278                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  80
* EL050.cbl
  4279                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4280                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4281                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4282                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4283                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4284                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4285                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4286                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4287             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4288             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4289             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4290             20  PB-CI-MEMBER-NO          PIC X(12).
  4291             20  PB-CI-INT-CODE           PIC X.
  4292                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4293                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4294             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4295             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4296             20  PB-CI-COMP-EXCP-SW       PIC X.
  4297                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4298                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4299             20  PB-CI-ENTRY-STATUS       PIC X.
  4300             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4301             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4302             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4303             20  PB-CI-DEATH-DT           PIC XX.
  4304             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4305             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4306             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4307             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4308             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4309             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4310             20  PB-CI-ENTRY-DT              PIC XX.
  4311             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4312             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4313             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4314             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4315             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4316             20  PB-CI-OLD-LOF               PIC XXX.
  4317*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4318             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4319             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4320             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4321             20  PB-CI-INDV-GRP-CD           PIC X.
  4322             20  PB-CI-BENEFICIARY-NAME.
  4323                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4324                 24  FILLER                  PIC X(15).
  4325             20  PB-CI-NOTE-SW               PIC X.
  4326             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4327             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4328             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4329             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4330             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4331             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4332             20  PB-CI-FIRST-NAME            PIC X(10).
  4333             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4334
  4335         16  FILLER                       PIC X(13).
  4336*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  81
* EL050.cbl
  4337*        16  FILLER                       PIC X(46).
  4338
  4339     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4340         16  FILLER                       PIC X(10).
  4341         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4342         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4343         16  PB-M-INSURED-MID-INIT        PIC X.
  4344         16  PB-M-INSURED-AGE             PIC 99.
  4345         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4346         16  PB-M-INSURED-SEX             PIC X.
  4347         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4348         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4349         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4350         16  PB-M-INSURED-CITY-STATE.
  4351             20  PB-M-INSURED-CITY        PIC X(28).
  4352             20  PB-M-INSURED-STATE       PIC XX.
  4353         16  PB-M-INSURED-ZIP-CODE.
  4354             20  PB-M-INSURED-ZIP-PRIME.
  4355                 24  PB-M-INSURED-ZIP-1   PIC X.
  4356                     88  PB-M-CANADIAN-POST-CODE
  4357                                             VALUE 'A' THRU 'Z'.
  4358                 24  FILLER               PIC X(4).
  4359             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4360         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4361                                        PB-M-INSURED-ZIP-CODE.
  4362             20  PM-M-INS-CAN-POST1       PIC XXX.
  4363             20  PM-M-INS-CAN-POST2       PIC XXX.
  4364             20  FILLER                   PIC XXX.
  4365         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4366         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4367         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4368         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4369         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4370         16  PB-M-CRED-BENE-CITYST.
  4371             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4372             20  PB-M-CRED-BENE-STATE     PIC XX.
  4373         16  FILLER                       PIC X(92).
  4374
  4375     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4376         16  FILLER                       PIC X(10).
  4377         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4378         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4379         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4380         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4381         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4382         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4383         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4384         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4385         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4386         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4387         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4388         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4389         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4390         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4391         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4392         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4393         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4394         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  82
* EL050.cbl
  4395         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4396         16  PB-REFERENCE                 PIC X(12).
  4397         16  PB-B-RECEIVED-DT             PIC XX.
  4398         16  FILLER                       PIC X(234).
  4399
  4400     12  PB-RECORD-STATUS.
  4401         16  PB-CREDIT-SELECT-DT          PIC XX.
  4402         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4403         16  PB-BILLED-DT                 PIC XX.
  4404         16  PB-BILLING-STATUS            PIC X.
  4405             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4406             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4407             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4408         16  PB-RECORD-BILL               PIC X.
  4409             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4410             88  PB-RECORD-RETURNED           VALUE 'R'.
  4411             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4412             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4413             88  PB-OVERRIDE-AH               VALUE 'A'.
  4414             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4415         16  PB-BATCH-ENTRY               PIC X.
  4416             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4417             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4418             88  PB-REISSUED-CERT             VALUE 'E'.
  4419             88  PB-CASH-CERT                 VALUE 'C'.
  4420             88  PB-MONTHLY-CERT              VALUE 'M'.
  4421             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4422             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4423             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4424         16  PB-FORCE-CODE                PIC X.
  4425             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4426             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4427             88  PB-CANCEL-FORCE              VALUE '8'.
  4428             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4429             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4430             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4431             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4432             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4433             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4434             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4435         16  PB-FATAL-FLAG                PIC X.
  4436             88  PB-FATAL-ERRORS              VALUE 'X'.
  4437         16  PB-FORCE-ER-CD               PIC X.
  4438             88  PB-FORCE-ERRORS              VALUE 'F'.
  4439             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4440         16  PB-WARN-ER-CD                PIC X.
  4441             88  PB-WARNING-ERRORS            VALUE 'W'.
  4442         16  FILLER                       PIC X.
  4443         16  PB-OUT-BAL-CD                PIC X.
  4444             88  PB-OUT-OF-BAL                VALUE 'O'.
  4445         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4446         16  PB-AH-OVERRIDE-L1            PIC X.
  4447         16  PB-INPUT-DT                  PIC XX.
  4448         16  PB-INPUT-BY                  PIC X(4).
  4449         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4450         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4451         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4452         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  83
* EL050.cbl
  4453         16  PB-AH-EARNING-METHOD         PIC X.
  4454         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4455         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4456         16  PB-REIN-CD                   PIC XXX.
  4457         16  PB-LF-REFUND-TYPE            PIC X.
  4458         16  PB-AH-REFUND-TYPE            PIC X.
  4459         16  PB-ACCT-EFF-DT               PIC XX.
  4460         16  PB-ACCT-EXP-DT               PIC XX.
  4461         16  PB-COMPANY-ID                PIC X(3).
  4462         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4463         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4464         16  PB-SV-CARRIER                PIC X.
  4465         16  PB-SV-GROUPING               PIC X(6).
  4466         16  PB-SV-STATE                  PIC XX.
  4467         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4468         16  PB-GA-BILLING-INFO.
  4469             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4470                                          PIC XX.
  4471         16  PB-SV-REMIT-TO  REDEFINES
  4472             PB-GA-BILLING-INFO           PIC X(10).
  4473         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4474         16  PB-I-LOAN-OFFICER            PIC X(5).
  4475         16  PB-I-VIN                     PIC X(17).
  4476
  4477         16  FILLER                       PIC X(04).
  4478         16  IMNET-BYPASS-SW              PIC X.
  4479
  4480******************************************************************
  4481*                COMMON EDIT ERRORS                              *
  4482******************************************************************
  4483
  4484     12  PB-COMMON-ERRORS.
  4485         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4486                                           PIC S9(4)     COMP.
  4487
  4488******************************************************************
  4489
  4490* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4491*    COPY ELC50W1.
  4492******************************************************************
  4493*                                                                *
  4494*                                                                *
  4495*                             ELC50W1                            *
  4496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4497*                            VMOD=2.004                          *
  4498*                                                                *
  4499*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4500*                                                                *
  4501*                                                                *
  4502******************************************************************
  4503
  4504     12  WK-WORK-AREA.
  4505         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4506         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4507         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4508         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4509         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4510         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  84
* EL050.cbl
  4511         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4512         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4513         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4514         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4515         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4516         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4517         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4518         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4519         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4520         16  WK-CREDIT-EDIT-CONTROLS.
  4521             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4522             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4523             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4524             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4525             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4526             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4527         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4528         16  WK-SAVE-REIN-DATA.
  4529             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4530             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4531             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4532         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4533             88  ENTRY-FROM-EL6311       VALUE '6'.
  4534         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4535         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4536     12  WK-RECORD-ADDRESSES.
  4537         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4538         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4539         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4540         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4541         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4542         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4543         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4544         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4545     12  WK-OVER-SHORT-AREA.
  4546         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4547         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4548         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4549             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4550         16  FILLER                   PIC X(5) VALUE SPACES.
  4551
  4552*    COPY ELCEDITC.
  4553******************************************************************
  4554*                                                                *
  4555*                                                                *
  4556*                            ELCEDITC                            *
  4557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4558*                            VMOD=2.012                          *
  4559*                                                                *
  4560*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4561*                     EL6313, EL050 AND EL517.                   *
  4562*                                                                *
  4563******************************************************************
  4564******************************************************************
  4565*                   C H A N G E   L O G
  4566*
  4567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4568*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  85
* EL050.cbl
  4569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4570* EFFECTIVE    NUMBER
  4571*-----------------------------------------------------------------
  4572* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4573******************************************************************
  4574
  4575     12  EDIT-CRITERIA-DATA.
  4576         16  EC-CO-MONTH-END-DT       PIC XX.
  4577         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4578         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4579         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4580         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4581         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4582         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4583         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4584         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4585         16  EC-CO-REM-TERM-CALC      PIC X.
  4586               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4587               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4588               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4589               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4590
  4591         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4592               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4593               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4594               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4595               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4596               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4597               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4598               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4599               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4600               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4601               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4602
  4603         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4604               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4605               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4606               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4607               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4608               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4609               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4610               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4611               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4612
  4613         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4614                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4615                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4616
  4617         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4618                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4619                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4620                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4621                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4622                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4623                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4624                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4625                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4626
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  86
* EL050.cbl
  4627         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4628               88  EC-BR-REDUCING                   VALUE 'R'.
  4629               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4630
  4631         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4632         16  EC-BR-LF-DESC             PIC X(10).
  4633         16  EC-BR-AH-DESC             PIC X(10).
  4634         16  EC-BR-LF-COMMENT          PIC X(10).
  4635         16  EC-BR-AH-COMMENT          PIC X(10).
  4636
  4637         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4638               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4639               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4640               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4641               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4642
  4643         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4644               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4645               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4646               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4647               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4648
  4649         16  EC-BR-LF-REFUND-CALC      PIC X.
  4650                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4651                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4652                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4653                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4654                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4655                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4656                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4657
  4658         16  EC-BR-AH-REFUND-CALC      PIC X.
  4659                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4667
  4668         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4669                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4670                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4671                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4672
  4673         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4674                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4675                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4676                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4677
  4678         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4679         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4680         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4681         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4682
  4683         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4684         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  87
* EL050.cbl
  4685                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4686                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4687                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4688                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4689
  4690         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4691               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4692               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4693               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4694               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4695               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4696
  4697         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4698               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4699               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4700               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4701               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4702               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4703
  4704         16  EC-ST-LF-REFUND-CALC      PIC X.
  4705                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4706                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4707                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4708                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-ST-AH-REFUND-CALC      PIC X.
  4715                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4725         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4726         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4727         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4728         16  EC-AM-EXPIRATION-DT       PIC XX.
  4729         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4730         16  EC-AM-CLASS-CD            PIC XX.
  4731         16  EC-AM-LF-DEVIATION        PIC XXX.
  4732         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4733         16  EC-AM-AH-DEVIATION        PIC XXX.
  4734         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4735         16  EC-AM-PHONE-NO            PIC X(10).
  4736
  4737         16  EC-AM-LF-REFUND-CALC      PIC X.
  4738                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4739                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4740                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4741                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4742                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  88
* EL050.cbl
  4743                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4744                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4745
  4746         16  EC-AM-AH-REFUND-CALC      PIC X.
  4747                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4748                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4749                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4750                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4751                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4752                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4753                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4754
  4755         16  EC-AM-BEN-I-G-CD          PIC X.
  4756                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4757                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4758                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4759
  4760         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4761         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4762         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4763         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4764         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4765         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4766         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4767         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4768         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4769
  4770         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4771         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4772         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4773         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4774         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4775         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4776         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4777         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4778         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4779         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4780         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4781         16  EC-RT-LF-NSP-ST           PIC XX.
  4782         16  EC-RT-AH-NSP-ST           PIC XX.
  4783         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4784         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4785
  4786         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4787             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4788                                             'M' '5' '9' '2'.
  4789             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4790             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4791             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4792             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4793             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4794             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4795             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4796             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4797             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4798             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4799
  4800         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  89
* EL050.cbl
  4801             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4802                                             'M' '5' '9' '2'.
  4803             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4804             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4805             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4806             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4807             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4808             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4809             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4810             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4811             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4812             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4813
  4814         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4815         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4816         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4817         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4818         16  EC-CM-DEATH-DT            PIC XX.
  4819
  4820*DMD CUSTOM CODING FIELDS BELOW
  4821*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4822         16  EC-BR-DMD-RATING-SW       PIC X.
  4823                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4824                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4825                 88  NO-DMD-RATING               VALUE 'N'.
  4826
  4827         16  EC-NEW-CERT               PIC X(11).
  4828         16  EC-NEW-STATE              PIC XX.
  4829         16  FILLER                    PIC X.
  4830*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4831         16  OVER-SHORT-EDIT-FIELDS.
  4832             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4833             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4834             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4835             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4836             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4837             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4838             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4839             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4840             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4841         16  FILLER                    PIC X(71).
  4842******************************************************************
  4843
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  90
* EL050.cbl
  4845*    COPY ELCDIFRD.
  4846******************************************************************
  4847*                                                                *
  4848*                                                                *
  4849*                            ELCDIFRD.                           *
  4850*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4851*                            VMOD=2.004                          *
  4852*                                                                *
  4853*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4854*                                                                *
  4855******************************************************************
  4856*
  4857  01  WS-DIFFERENCE-CALCULATION.
  4858        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4859        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4860        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4861        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4862        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4863        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4864        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4865        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4866        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4867        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4868        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4869
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  91
* EL050.cbl
  4871****************************************************************
  4872*
  4873* Copyright (c) 2007 by Clerity Solutions, Inc.
  4874* All rights reserved.
  4875*
  4876****************************************************************
  4877 01  DFHEIV.
  4878   02  DFHEIV0               PIC X(35).
  4879   02  DFHEIV1               PIC X(08).
  4880   02  DFHEIV2               PIC X(08).
  4881   02  DFHEIV3               PIC X(08).
  4882   02  DFHEIV4               PIC X(06).
  4883   02  DFHEIV5               PIC X(04).
  4884   02  DFHEIV6               PIC X(04).
  4885   02  DFHEIV7               PIC X(02).
  4886   02  DFHEIV8               PIC X(02).
  4887   02  DFHEIV9               PIC X(01).
  4888   02  DFHEIV10              PIC S9(7) COMP-3.
  4889   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4890   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4891   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4892   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4893   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4894   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4895   02  DFHEIV17              PIC X(04).
  4896   02  DFHEIV18              PIC X(04).
  4897   02  DFHEIV19              PIC X(04).
  4898   02  DFHEIV20              USAGE IS POINTER.
  4899   02  DFHEIV21              USAGE IS POINTER.
  4900   02  DFHEIV22              USAGE IS POINTER.
  4901   02  DFHEIV23              USAGE IS POINTER.
  4902   02  DFHEIV24              USAGE IS POINTER.
  4903   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4904   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4905   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4906   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4907   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4908   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4909   02  FILLER                PIC X(02).
  4910   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4911   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4912   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4913   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4914   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4915 LINKAGE  SECTION.
  4916*****************************************************************
  4917*                                                               *
  4918* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4919* All rights reserved.                                          *
  4920*                                                               *
  4921*****************************************************************
  4922 01  dfheiblk.
  4923     02  eibtime          pic s9(7) comp-3.
  4924     02  eibdate          pic s9(7) comp-3.
  4925     02  eibtrnid         pic x(4).
  4926     02  eibtaskn         pic s9(7) comp-3.
  4927     02  eibtrmid         pic x(4).
  4928     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  92
* EL050.cbl
  4929     02  eibcposn         pic s9(4) comp.
  4930     02  eibcalen         pic s9(4) comp.
  4931     02  eibaid           pic x(1).
  4932     02  eibfiller1       pic x(1).
  4933     02  eibfn            pic x(2).
  4934     02  eibfiller2       pic x(2).
  4935     02  eibrcode         pic x(6).
  4936     02  eibfiller3       pic x(2).
  4937     02  eibds            pic x(8).
  4938     02  eibreqid         pic x(8).
  4939     02  eibrsrce         pic x(8).
  4940     02  eibsync          pic x(1).
  4941     02  eibfree          pic x(1).
  4942     02  eibrecv          pic x(1).
  4943     02  eibsend          pic x(1).
  4944     02  eibatt           pic x(1).
  4945     02  eibeoc           pic x(1).
  4946     02  eibfmh           pic x(1).
  4947     02  eibcompl         pic x(1).
  4948     02  eibsig           pic x(1).
  4949     02  eibconf          pic x(1).
  4950     02  eiberr           pic x(1).
  4951     02  eibrldbk         pic x(1).
  4952     02  eiberrcd         pic x(4).
  4953     02  eibsynrb         pic x(1).
  4954     02  eibnodat         pic x(1).
  4955     02  eibfiller5       pic x(2).
  4956     02  eibresp          pic 9(09) comp.
  4957     02  eibresp2         pic 9(09) comp.
  4958     02  dfheigdj         pic s9(4) comp.
  4959     02  dfheigdk         pic s9(4) comp.
  4960
  4961 01  DFHCOMMAREA                   PIC X(1036).
  4962
  4963*01 PARMLIST .
  4964*    02  FILLER                    PIC S9(8)   COMP.
  4965*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4966*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4967*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4968*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4969*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4970*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4971*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4972
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  93
* EL050.cbl
  4974*    COPY ELCCNTL.
  4975******************************************************************
  4976*                                                                *
  4977*                                                                *
  4978*                            ELCCNTL.                            *
  4979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4980*                            VMOD=2.059                          *
  4981*                                                                *
  4982*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4983*                                                                *
  4984*   FILE TYPE = VSAM,KSDS                                        *
  4985*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4986*                                                                *
  4987*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4988*       ALTERNATE INDEX = NONE                                   *
  4989*                                                                *
  4990*   LOG = YES                                                    *
  4991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4992******************************************************************
  4993*                   C H A N G E   L O G
  4994*
  4995* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4996*-----------------------------------------------------------------
  4997*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4998* EFFECTIVE    NUMBER
  4999*-----------------------------------------------------------------
  5000* 082503                   PEMA  ADD BENEFIT GROUP
  5001* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5002* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5003* 092705    2005050300006  PEMA  ADD SPP LEASES
  5004* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5005* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5006* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5007* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5008* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5009* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5010* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5011* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5012* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5013* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5014******************************************************************
  5015*
  5016 01  CONTROL-FILE.
  5017     12  CF-RECORD-ID                       PIC XX.
  5018         88  VALID-CF-ID                        VALUE 'CF'.
  5019
  5020     12  CF-CONTROL-PRIMARY.
  5021         16  CF-COMPANY-ID                  PIC XXX.
  5022         16  CF-RECORD-TYPE                 PIC X.
  5023             88  CF-COMPANY-MASTER              VALUE '1'.
  5024             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5025             88  CF-STATE-MASTER                VALUE '3'.
  5026             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5027             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5028             88  CF-CARRIER-MASTER              VALUE '6'.
  5029             88  CF-MORTALITY-MASTER            VALUE '7'.
  5030             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5031             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  94
* EL050.cbl
  5032             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5033             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5034             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5035             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5036             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5037             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5038             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5039             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5040             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5041         16  CF-ACCESS-CD-GENL              PIC X(4).
  5042         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5043             20  CF-PROCESSOR               PIC X(4).
  5044         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5045             20  CF-STATE-CODE              PIC XX.
  5046             20  FILLER                     PIC XX.
  5047         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5048             20  FILLER                     PIC XX.
  5049             20  CF-HI-BEN-IN-REC           PIC XX.
  5050         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5051             20  FILLER                     PIC XXX.
  5052             20  CF-CARRIER-CNTL            PIC X.
  5053         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5054             20  FILLER                     PIC XX.
  5055             20  CF-HI-TYPE-IN-REC          PIC 99.
  5056         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5057             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5058                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5059             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5060             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5061         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5062             20  FILLER                     PIC X.
  5063             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5064         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5065             20  FILLER                     PIC XX.
  5066             20  CF-MORTGAGE-PLAN           PIC XX.
  5067         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5068
  5069     12  CF-LAST-MAINT-DT                   PIC XX.
  5070     12  CF-LAST-MAINT-BY                   PIC X(4).
  5071     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5072
  5073     12  CF-RECORD-BODY                     PIC X(728).
  5074
  5075
  5076****************************************************************
  5077*             COMPANY MASTER RECORD                            *
  5078****************************************************************
  5079
  5080     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5081         16  CF-COMPANY-ADDRESS.
  5082             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5083             20  CF-CL-IN-CARE-OF           PIC X(30).
  5084             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5085             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5086             20  CF-CL-CITY-STATE           PIC X(30).
  5087             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5088             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5089         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  95
* EL050.cbl
  5090         16  CF-COMPANY-PASSWORD            PIC X(8).
  5091         16  CF-SECURITY-OPTION             PIC X.
  5092             88  ALL-SECURITY                   VALUE '1'.
  5093             88  COMPANY-VERIFY                 VALUE '2'.
  5094             88  PROCESSOR-VERIFY               VALUE '3'.
  5095             88  NO-SECURITY                    VALUE '4'.
  5096             88  ALL-BUT-TERM                   VALUE '5'.
  5097         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5098             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5099         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5100             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5101         16  CF-INFORCE-LOCATION            PIC X.
  5102             88  CERTS-ARE-ONLINE               VALUE '1'.
  5103             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5104             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5105         16  CF-LOWER-CASE-LETTERS          PIC X.
  5106         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5107             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5108             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5109             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5110             88  CF-ACCNT-CNTL                  VALUE '3'.
  5111             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5112
  5113         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5114         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5115
  5116         16  CF-LGX-CREDIT-USER             PIC X.
  5117             88  CO-IS-NOT-USER                 VALUE 'N'.
  5118             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5119
  5120         16 CF-CREDIT-CALC-CODES.
  5121             20  CF-CR-REM-TERM-CALC PIC X.
  5122               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5123               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5124               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5125               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5126               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5127               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5128               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5129             20  CF-CR-R78-METHOD           PIC X.
  5130               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5131               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5132
  5133         16  CF-CLAIM-CONTROL-COUNTS.
  5134             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5135                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5136
  5137             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5138                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5139
  5140             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5141                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5142
  5143             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5144                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5145
  5146         16  CF-CURRENT-MONTH-END           PIC XX.
  5147
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  96
* EL050.cbl
  5148         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5149             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5150             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5151             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5152             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5153                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5154                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5155             20  CF-CO-PREM-REJECT-SW       PIC X.
  5156                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5157                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5158             20  CF-CO-REF-REJECT-SW        PIC X.
  5159                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5160                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5161
  5162         16  CF-CO-REPORTING-DT             PIC XX.
  5163         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5164         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5165           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5166           88  CF-CO-MONTH-END                  VALUE '1'.
  5167
  5168         16  CF-LGX-CLAIM-USER              PIC X.
  5169             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5170             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5171
  5172         16  CF-CREDIT-EDIT-CONTROLS.
  5173             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5174             20  CF-MIN-AGE                 PIC 99.
  5175             20  CF-DEFAULT-AGE             PIC 99.
  5176             20  CF-MIN-TERM                PIC S999      COMP-3.
  5177             20  CF-MAX-TERM                PIC S999      COMP-3.
  5178             20  CF-DEFAULT-SEX             PIC X.
  5179             20  CF-JOINT-AGE-INPUT         PIC X.
  5180                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5181             20  CF-BIRTH-DATE-INPUT        PIC X.
  5182                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5183             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5184                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5185                 88  CF-ZERO-CARRIER            VALUE '1'.
  5186                 88  CF-ZERO-GROUPING           VALUE '2'.
  5187                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5188             20  CF-EDIT-SW                 PIC X.
  5189                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5190             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5191             20  CF-CR-PR-METHOD            PIC X.
  5192               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5193               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5194             20  FILLER                     PIC X.
  5195
  5196         16  CF-CREDIT-MISC-CONTROLS.
  5197             20  CF-REIN-TABLE-SW           PIC X.
  5198                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5199             20  CF-COMP-TABLE-SW           PIC X.
  5200                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5201             20  CF-EXPERIENCE-RETENTION-AGE
  5202                                            PIC S9        COMP-3.
  5203             20  CF-CONVERSION-DT           PIC XX.
  5204             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5205             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  97
* EL050.cbl
  5206                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5207                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5208
  5209             20  CF-CR-CHECK-NO-CONTROL.
  5210                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5211                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5212                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5213                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5214                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5215                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5216
  5217                 24  CF-CR-CHECK-COUNT       REDEFINES
  5218                     CF-CR-CHECK-COUNTER      PIC X(4).
  5219
  5220                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5221                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5222
  5223                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5224                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5225                 24  CF-MAIL-PROCESSING       PIC X.
  5226                     88  MAIL-PROCESSING          VALUE 'Y'.
  5227
  5228         16  CF-MISC-SYSTEM-CONTROL.
  5229             20  CF-SYSTEM-C                 PIC X.
  5230                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5231             20  CF-SYSTEM-D                 PIC X.
  5232                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5233             20  CF-SOC-SEC-NO-SW            PIC X.
  5234                 88  SOC-SEC-NO-USED             VALUE '1'.
  5235             20  CF-MEMBER-NO-SW             PIC X.
  5236                 88  MEMBER-NO-USED              VALUE '1'.
  5237             20  CF-TAX-ID-NUMBER            PIC X(11).
  5238             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5239             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5240                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5241                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5242                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5243                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5244             20  CF-SYSTEM-E                 PIC X.
  5245                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5246
  5247         16  CF-LGX-LIFE-USER               PIC X.
  5248             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5249             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5250
  5251         16  CF-CR-MONTH-END-DT             PIC XX.
  5252
  5253         16  CF-FILE-MAINT-DATES.
  5254             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5255                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5256             20  CF-LAST-BATCH       REDEFINES
  5257                 CF-LAST-BATCH-NO               PIC X(4).
  5258             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5259             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5260             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5261             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5262             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5263             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  98
* EL050.cbl
  5264             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5265             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5266             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5267             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5268
  5269         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5270         16  FILLER                         PIC X.
  5271
  5272         16  CF-ALT-MORT-CODE               PIC X(4).
  5273         16  CF-MEMBER-CAPTION              PIC X(10).
  5274
  5275         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5276             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5277             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5278             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5279             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5280             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5281
  5282         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5283
  5284         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5285         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5286         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5287         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5288
  5289         16  CF-AH-OVERRIDE-L1              PIC X.
  5290         16  CF-AH-OVERRIDE-L2              PIC XX.
  5291         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5292         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5293
  5294         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5295         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5296
  5297         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5298         16  CF-AR-LAST-EL860-DT            PIC XX.
  5299         16  CF-MP-MONTH-END-DT             PIC XX.
  5300
  5301         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5302         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5303             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5304
  5305         16  CF-AR-MONTH-END-DT             PIC XX.
  5306
  5307         16  CF-CRDTCRD-USER                PIC X.
  5308             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5309             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5310
  5311         16  CF-CC-MONTH-END-DT             PIC XX.
  5312
  5313         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5314
  5315         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5316             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5317             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5318             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5319         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5320         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5321         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page  99
* EL050.cbl
  5322         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5323             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5324             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5325         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5326         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5327         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5328             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5329         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5330
  5331         16  CF-CL-ZIP-CODE.
  5332             20  CF-CL-ZIP-PRIME.
  5333                 24  CF-CL-ZIP-1ST          PIC X.
  5334                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5335                 24  FILLER                 PIC X(4).
  5336             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5337         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5338             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5339             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5340             20  FILLER                     PIC XXX.
  5341
  5342         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5343         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5344         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5345         16  CF-CO-OPTION-START-DATE        PIC XX.
  5346         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5347           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5348                                                      '3' '4'.
  5349           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5350           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5351           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5352           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5353           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5354           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5355
  5356         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5357
  5358         16  CF-PAYMENT-APPROVAL-LEVELS.
  5359             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5360             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5361             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5362             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5363             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5364             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5365
  5366         16  CF-END-USER-REPORTING-USER     PIC X.
  5367             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5368             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5369
  5370         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5371             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5372             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5373
  5374         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5375
  5376         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5377         16  FILLER                         PIC X.
  5378
  5379         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 100
* EL050.cbl
  5380             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5381             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5382             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5383
  5384         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5385
  5386         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5387             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5388             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5389
  5390         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5391             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5392             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5393
  5394         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5395
  5396         16  CF-CO-ACH-ID-CODE              PIC  X.
  5397             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5398             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5399             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5400         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5401         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5402         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5403         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5404         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5405         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5406         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5407         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5408         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5409                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5410         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5411                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5412
  5413         16  CF-CO-OVER-SHORT.
  5414             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5415             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5416
  5417*         16  FILLER                         PIC X(102).
  5418         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5419             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-AH-APPROVAL-DAYS.
  5423             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5424             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5425             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5426             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5427
  5428         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5429
  5430         16  CF-APPROV-LEV-5.
  5431             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5432             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5433             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5434
  5435         16  FILLER                         PIC X(68).
  5436****************************************************************
  5437*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 101
* EL050.cbl
  5438****************************************************************
  5439
  5440     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5441         16  CF-PROCESSOR-NAME              PIC X(30).
  5442         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5443         16  CF-PROCESSOR-TITLE             PIC X(26).
  5444         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5445                 88  MESSAGE-YES                VALUE 'Y'.
  5446                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5447
  5448*****************************************************
  5449****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5450****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5451****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5452****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5453*****************************************************
  5454
  5455         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5456             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5457             20  CF-APPLICATION-FORCE       PIC X.
  5458             20  CF-INDIVIDUAL-APP.
  5459                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5460                     28  CF-BROWSE-APP      PIC X.
  5461                     28  CF-UPDATE-APP      PIC X.
  5462
  5463         16  CF-CURRENT-TERM-ON             PIC X(4).
  5464         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5465             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5466             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5467             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5468             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5469             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5470             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5471             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5472         16  CF-PROCESSOR-CARRIER           PIC X.
  5473             88  NO-CARRIER-SECURITY            VALUE ' '.
  5474         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5475             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5476         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5477             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5478         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5479             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5480
  5481         16  CF-PROC-SYS-ACCESS-SW.
  5482             20  CF-PROC-CREDIT-CLAIMS-SW.
  5483                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5484                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5485                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5486                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5487             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5488                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5489                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5490             20  CF-PROC-LIFE-GNRLDGR-SW.
  5491                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5492                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5493                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5494                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5495             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 102
* EL050.cbl
  5496                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5497                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5498         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5499             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5500             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5501         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5502
  5503         16  CF-APPROVAL-LEVEL                  PIC X.
  5504             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5505             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5506             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5507             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5508             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5509
  5510         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5511
  5512         16  CF-LANGUAGE-TYPE                   PIC X.
  5513             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5514             88  CF-LANG-IS-FR                      VALUE 'F'.
  5515
  5516         16  CF-CSR-IND                         PIC X.
  5517         16  FILLER                             PIC X(239).
  5518
  5519****************************************************************
  5520*             PROCESSOR/REMINDERS RECORD                       *
  5521****************************************************************
  5522
  5523     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5524         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5525             20  CF-START-REMIND-DT         PIC XX.
  5526             20  CF-END-REMIND-DT           PIC XX.
  5527             20  CF-REMINDER-TEXT           PIC X(50).
  5528         16  FILLER                         PIC X(296).
  5529
  5530
  5531****************************************************************
  5532*             STATE MASTER RECORD                              *
  5533****************************************************************
  5534
  5535     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5536         16  CF-STATE-ABBREVIATION          PIC XX.
  5537         16  CF-STATE-NAME                  PIC X(25).
  5538         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5539         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5540             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5541             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5542             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5543             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5544                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5545                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5546             20  CF-ST-PREM-REJECT-SW       PIC X.
  5547                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5548                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5549             20  CF-ST-REF-REJECT-SW        PIC X.
  5550                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5551                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5552         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5553         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 103
* EL050.cbl
  5554         16  CF-ST-REFUND-RULES.
  5555             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5556             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5557             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5558         16  CF-ST-FST-PMT-EXTENSION.
  5559             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5560             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5561                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5562                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5563                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5564                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5565         16  CF-ST-STATE-CALL.
  5566             20  CF-ST-CALL-UNEARNED        PIC X.
  5567             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5568             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5569         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5570             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5571             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5572         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5573         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5574         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5575         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5576         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5577         16  FILLER                         PIC X.
  5578         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5579             20  CF-ST-BENEFIT-CD           PIC XX.
  5580             20  CF-ST-BENEFIT-KIND         PIC X.
  5581                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5582                 88  CF-ST-AH-KIND              VALUE 'A'.
  5583             20  CF-ST-REM-TERM-CALC        PIC X.
  5584                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5585                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5586                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5587                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5588                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5589                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5590                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5591                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5592
  5593             20  CF-ST-REFUND-CALC          PIC X.
  5594                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5595                 88  ST-REFD-BY-R78             VALUE '1'.
  5596                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5597                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5598                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5599                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5600                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5601                 88  ST-REFD-UTAH               VALUE '7'.
  5602                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5603                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5604                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5605
  5606             20  CF-ST-EARNING-CALC         PIC X.
  5607                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5608                 88  ST-EARN-BY-R78             VALUE '1'.
  5609                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5610                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5611                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 104
* EL050.cbl
  5612                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5613                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5614                 88  ST-EARN-MEAN               VALUE '8'.
  5615                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5616
  5617             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5618                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5619                 88  ST-OVRD-BY-R78             VALUE '1'.
  5620                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5621                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5622                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5623                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5624                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5625                 88  ST-OVRD-MEAN               VALUE '8'.
  5626                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5627             20  FILLER                     PIC X.
  5628
  5629         16  CF-ST-COMMISSION-CAPS.
  5630             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5631             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5632             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5633             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5634         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5635                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5636
  5637         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5638
  5639         16  CF-ST-STATUTORY-INTEREST.
  5640             20  CF-ST-STAT-DATE-FROM       PIC X.
  5641                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5642                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5643             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5644             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5645             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5646             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5647             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5648
  5649         16  CF-ST-OVER-SHORT.
  5650             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5651             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5652
  5653         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5654
  5655         16  CF-ST-RT-CALC                  PIC X.
  5656
  5657         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5658         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5659         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5660         16  CF-ST-RF-LR-CALC               PIC X.
  5661         16  CF-ST-RF-LL-CALC               PIC X.
  5662         16  CF-ST-RF-LN-CALC               PIC X.
  5663         16  CF-ST-RF-AH-CALC               PIC X.
  5664         16  CF-ST-RF-CP-CALC               PIC X.
  5665*        16  FILLER                         PIC X(206).
  5666*CIDMOD         16  FILLER                         PIC X(192).
  5667         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5668             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5669         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 105
* EL050.cbl
  5670         16  CF-ST-VFY-2ND-BENE             PIC X.
  5671         16  CF-ST-CAUSAL-STATE             PIC X.
  5672         16  FILLER                         PIC X(185).
  5673
  5674****************************************************************
  5675*             BENEFIT MASTER RECORD                            *
  5676****************************************************************
  5677
  5678     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5679         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5680             20  CF-BENEFIT-CODE            PIC XX.
  5681             20  CF-BENEFIT-NUMERIC  REDEFINES
  5682                 CF-BENEFIT-CODE            PIC XX.
  5683             20  CF-BENEFIT-ALPHA           PIC XXX.
  5684             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5685             20  CF-BENEFIT-COMMENT         PIC X(10).
  5686
  5687             20  CF-LF-COVERAGE-TYPE        PIC X.
  5688                 88  CF-REDUCING                VALUE 'R'.
  5689                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5690
  5691             20  CF-SPECIAL-CALC-CD         PIC X.
  5692                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5693                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5694                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5695                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5696                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5697                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5698                 88  CF-FARM-PLAN               VALUE 'F'.
  5699                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5700                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5701                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5702                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5703                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5704                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5705                 88  CF-PRUDENTIAL              VALUE 'P'.
  5706                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5707                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5708                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5709                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5710                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5711                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5712
  5713             20  CF-JOINT-INDICATOR         PIC X.
  5714                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5715
  5716*            20  FILLER                     PIC X(12).
  5717             20  cf-maximum-benefits        pic s999 comp-3.
  5718             20  FILLER                     PIC X(09).
  5719             20  CF-BENEFIT-CATEGORY        PIC X.
  5720             20  CF-LOAN-TYPE               PIC X(8).
  5721
  5722             20  CF-CO-REM-TERM-CALC        PIC X.
  5723                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5724                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5725                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5726                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5727                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 106
* EL050.cbl
  5728
  5729             20  CF-CO-EARNINGS-CALC        PIC X.
  5730                 88  CO-EARN-BY-R78             VALUE '1'.
  5731                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5732                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5733                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5734                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5735                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5736                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5737                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5738
  5739             20  CF-CO-REFUND-CALC          PIC X.
  5740                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5741                 88  CO-REFD-BY-R78             VALUE '1'.
  5742                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5743                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5744                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5745                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5746                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5747                 88  CO-REFD-MEAN               VALUE '8'.
  5748                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5749                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5750                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5751
  5752             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5753                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5754                 88  CO-OVRD-BY-R78             VALUE '1'.
  5755                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5756                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5757                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5758                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5759                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5760                 88  CO-OVRD-MEAN               VALUE '8'.
  5761                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5762
  5763             20  CF-CO-BEN-I-G-CD           PIC X.
  5764                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5765                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5766                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5767
  5768         16  FILLER                         PIC X(304).
  5769
  5770
  5771****************************************************************
  5772*             CARRIER MASTER RECORD                            *
  5773****************************************************************
  5774
  5775     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5776         16  CF-ADDRESS-DATA.
  5777             20  CF-MAIL-TO-NAME            PIC X(30).
  5778             20  CF-IN-CARE-OF              PIC X(30).
  5779             20  CF-ADDRESS-LINE-1          PIC X(30).
  5780             20  CF-ADDRESS-LINE-2          PIC X(30).
  5781             20  CF-CITY-STATE              PIC X(30).
  5782             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5783             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5784
  5785         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 107
* EL050.cbl
  5786             20  CF-CLAIM-NO-METHOD         PIC X.
  5787                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5788                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5789                 88  CLAIM-NO-SEQ               VALUE '3'.
  5790                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5791             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5792                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5793                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5794                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5795
  5796         16  CF-CHECK-NO-CONTROL.
  5797             20  CF-CHECK-NO-METHOD         PIC X.
  5798                 88  CHECK-NO-MANUAL            VALUE '1'.
  5799                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5800                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5801                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5802             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5803                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5804
  5805         16  CF-DOMICILE-STATE              PIC XX.
  5806
  5807         16  CF-EXPENSE-CONTROLS.
  5808             20  CF-EXPENSE-METHOD          PIC X.
  5809                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5810                 88  DOLLARS-PER-PMT            VALUE '2'.
  5811                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5812                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5813             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5814             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5815
  5816         16  CF-CORRESPONDENCE-CONTROL.
  5817             20  CF-LETTER-RESEND-OPT       PIC X.
  5818                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5819                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5820             20  FILLER                     PIC X(4).
  5821
  5822         16  CF-RESERVE-CONTROLS.
  5823             20  CF-MANUAL-SW               PIC X.
  5824                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5825             20  CF-FUTURE-SW               PIC X.
  5826                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5827             20  CF-PTC-SW                  PIC X.
  5828                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5829             20  CF-IBNR-SW                 PIC X.
  5830                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5831             20  CF-PTC-LF-SW               PIC X.
  5832                 88  CF-LF-PTC-USED             VALUE '1'.
  5833             20  CF-CDT-ACCESS-METHOD       PIC X.
  5834                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5835                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5836                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5837             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5838
  5839         16  CF-CLAIM-CALC-METHOD           PIC X.
  5840             88  360-PLUS-MONTHS                VALUE '1'.
  5841             88  365-PLUS-MONTHS                VALUE '2'.
  5842             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5843             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 108
* EL050.cbl
  5844             88  365-DAILY                      VALUE '5'.
  5845
  5846         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5847         16  FILLER                         PIC X(11).
  5848
  5849         16  CF-LIMIT-AMOUNTS.
  5850             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5851             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5852             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5853             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5854             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5855             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5856             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5857             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5858             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5859             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5860
  5861         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5862         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5863         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5864
  5865         16  CF-ZIP-CODE.
  5866             20  CF-ZIP-PRIME.
  5867                 24  CF-ZIP-1ST             PIC X.
  5868                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5869                 24  FILLER                 PIC X(4).
  5870             20  CF-ZIP-PLUS4               PIC X(4).
  5871         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5872             20  CF-CAN-POSTAL-1            PIC XXX.
  5873             20  CF-CAN-POSTAL-2            PIC XXX.
  5874             20  FILLER                     PIC XXX.
  5875
  5876         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5877         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5878         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5879
  5880         16  CF-RATING-SWITCH               PIC X.
  5881             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5882             88  CF-NO-RATING                   VALUE 'N'.
  5883
  5884         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5885
  5886         16  CF-CARRIER-OVER-SHORT.
  5887             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5888             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5889
  5890         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5891         16  CF-SECPAY-SWITCH               PIC X.
  5892             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5893             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5894         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5895         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5896         16  FILLER                         PIC X(444).
  5897*        16  FILLER                         PIC X(452).
  5898
  5899
  5900****************************************************************
  5901*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 109
* EL050.cbl
  5902****************************************************************
  5903
  5904     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5905         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5906                                INDEXED BY CF-MORT-NDX.
  5907             20  CF-MORT-TABLE              PIC X(5).
  5908             20  CF-MORT-TABLE-TYPE         PIC X.
  5909                 88  CF-MORT-JOINT              VALUE 'J'.
  5910                 88  CF-MORT-SINGLE             VALUE 'S'.
  5911                 88  CF-MORT-COMBINED           VALUE 'C'.
  5912                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5913                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5914             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5915             20  CF-MORT-AGE-METHOD         PIC XX.
  5916                 88  CF-AGE-LAST                VALUE 'AL'.
  5917                 88  CF-AGE-NEAR                VALUE 'AN'.
  5918             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5919             20  CF-MORT-ADJUSTMENT-DIRECTION
  5920                                            PIC X.
  5921                 88  CF-MINUS                   VALUE '-'.
  5922                 88  CF-PLUS                    VALUE '+'.
  5923             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5924             20  CF-MORT-JOINT-CODE         PIC X.
  5925                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5926             20  CF-MORT-PC-Q               PIC X.
  5927                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5928             20  CF-MORT-TABLE-CODE         PIC X(4).
  5929             20  CF-MORT-COMMENTS           PIC X(15).
  5930             20  FILLER                     PIC X(14).
  5931
  5932         16  FILLER                         PIC X(251).
  5933
  5934
  5935****************************************************************
  5936*             BUSSINESS TYPE MASTER RECORD                     *
  5937****************************************************************
  5938
  5939     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5940* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5941* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5942* AND RECORD 05 IS TYPES 81-99
  5943         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5944             20  CF-BUSINESS-TITLE          PIC  X(19).
  5945             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5946                                            PIC S9V9(4) COMP-3.
  5947             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5948             20  FILLER                     PIC  X.
  5949         16  FILLER                         PIC  X(248).
  5950
  5951
  5952****************************************************************
  5953*             TERMINAL MASTER RECORD                           *
  5954****************************************************************
  5955
  5956     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5957
  5958         16  CF-COMPANY-TERMINALS.
  5959             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 110
* EL050.cbl
  5960                                  PIC X(4).
  5961         16  FILLER               PIC X(248).
  5962
  5963
  5964****************************************************************
  5965*             LIFE EDIT MASTER RECORD                          *
  5966****************************************************************
  5967
  5968     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5969         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5970             20  CF-LIFE-CODE-IN            PIC XX.
  5971             20  CF-LIFE-CODE-OUT           PIC XX.
  5972         16  FILLER                         PIC X(248).
  5973
  5974
  5975****************************************************************
  5976*             AH EDIT MASTER RECORD                            *
  5977****************************************************************
  5978
  5979     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5980         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5981             20  CF-AH-CODE-IN              PIC XXX.
  5982             20  CF-AH-CODE-OUT             PIC XX.
  5983         16  FILLER                         PIC X(248).
  5984
  5985
  5986****************************************************************
  5987*             CREDIBILITY TABLES                               *
  5988****************************************************************
  5989
  5990     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5991         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5992                             INDEXED BY CF-CRDB-NDX.
  5993             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5994             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5995             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5996         16  FILLER                         PIC  X(332).
  5997
  5998
  5999****************************************************************
  6000*             REPORT CUSTOMIZATION RECORD                      *
  6001****************************************************************
  6002
  6003     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6004         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6005             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6006             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6007             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6008**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6009****       A T-TRANSFER.                                   ****
  6010             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6011
  6012         16  FILLER                         PIC XX.
  6013
  6014         16  CF-CARRIER-CNTL-OPT.
  6015             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6016                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6017                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 111
* EL050.cbl
  6018             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6019                                            PIC X.
  6020         16  CF-GROUP-CNTL-OPT.
  6021             20  CF-GROUP-OPT-SEQ           PIC 9.
  6022                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6023                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6024             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6025                                            PIC X(6).
  6026         16  CF-STATE-CNTL-OPT.
  6027             20  CF-STATE-OPT-SEQ           PIC 9.
  6028                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6029                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6030             20  CF-STATE-SELECT OCCURS 3 TIMES
  6031                                            PIC XX.
  6032         16  CF-ACCOUNT-CNTL-OPT.
  6033             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6034                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6035                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6036             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6037                                            PIC X(10).
  6038         16  CF-BUS-TYP-CNTL-OPT.
  6039             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6040                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6041                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6042             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6043                                            PIC XX.
  6044         16  CF-LF-TYP-CNTL-OPT.
  6045             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6046                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6047                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6048             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6049                                            PIC XX.
  6050         16  CF-AH-TYP-CNTL-OPT.
  6051             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6052                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6053                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6054             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6055                                            PIC XX.
  6056         16  CF-REPTCD1-CNTL-OPT.
  6057             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6058                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6059                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6060             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6061                                            PIC X(10).
  6062         16  CF-REPTCD2-CNTL-OPT.
  6063             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6064                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6065                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6066             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6067                                            PIC X(10).
  6068         16  CF-USER1-CNTL-OPT.
  6069             20  CF-USER1-OPT-SEQ           PIC 9.
  6070                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6071                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6072             20  CF-USER1-SELECT OCCURS 3 TIMES
  6073                                            PIC X(10).
  6074         16  CF-USER2-CNTL-OPT.
  6075             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 112
* EL050.cbl
  6076                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6077                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6078             20  CF-USER2-SELECT OCCURS 3 TIMES
  6079                                            PIC X(10).
  6080         16  CF-USER3-CNTL-OPT.
  6081             20  CF-USER3-OPT-SEQ           PIC 9.
  6082                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6083                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6084             20  CF-USER3-SELECT OCCURS 3 TIMES
  6085                                            PIC X(10).
  6086         16  CF-USER4-CNTL-OPT.
  6087             20  CF-USER4-OPT-SEQ           PIC 9.
  6088                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6089                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6090             20  CF-USER4-SELECT OCCURS 3 TIMES
  6091                                            PIC X(10).
  6092         16  CF-USER5-CNTL-OPT.
  6093             20  CF-USER5-OPT-SEQ           PIC 9.
  6094                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6095                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6096             20  CF-USER5-SELECT OCCURS 3 TIMES
  6097                                            PIC X(10).
  6098         16  CF-REINS-CNTL-OPT.
  6099             20  CF-REINS-OPT-SEQ           PIC 9.
  6100                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6101                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6102             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6103                 24  CF-REINS-PRIME         PIC XXX.
  6104                 24  CF-REINS-SUB           PIC XXX.
  6105
  6106         16  CF-AGENT-CNTL-OPT.
  6107             20  CF-AGENT-OPT-SEQ           PIC 9.
  6108                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6109                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6110             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6111                                            PIC X(10).
  6112
  6113         16  FILLER                         PIC X(43).
  6114
  6115         16  CF-LOSS-RATIO-SELECT.
  6116             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6117             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6118         16  CF-ENTRY-DATE-SELECT.
  6119             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6120             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6121         16  CF-EFFECTIVE-DATE-SELECT.
  6122             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6123             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6124
  6125         16  CF-EXCEPTION-LIST-IND          PIC X.
  6126             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6127
  6128         16  FILLER                         PIC X(318).
  6129
  6130****************************************************************
  6131*                  EXCEPTION REPORTING RECORD                  *
  6132****************************************************************
  6133
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 113
* EL050.cbl
  6134     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6135         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6136             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6137
  6138         16  CF-COMBINED-LIFE-AH-OPT.
  6139             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6140             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6141             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6142             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6143
  6144         16  CF-LIFE-OPT.
  6145             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6146             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6147             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6148             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6149             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6150             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6151             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6152             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6153             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6154             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6155
  6156         16  CF-AH-OPT.
  6157             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6158             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6159             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6160             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6161             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6162             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6163             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6164             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6165             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6166             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6167
  6168         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6169             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6170             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6171             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6172
  6173         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6174
  6175         16  FILLER                         PIC X(673).
  6176
  6177
  6178****************************************************************
  6179*             MORTGAGE SYSTEM PLAN RECORD                      *
  6180****************************************************************
  6181
  6182     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6183         16  CF-PLAN-TYPE                   PIC X.
  6184             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6185             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6186             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6187         16  CF-PLAN-ABBREV                 PIC XXX.
  6188         16  CF-PLAN-DESCRIPT               PIC X(10).
  6189         16  CF-PLAN-NOTES                  PIC X(20).
  6190         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6191         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 114
* EL050.cbl
  6192             20  CF-PLAN-TERM-DATA.
  6193                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6194                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6195             20  CF-PLAN-AGE-DATA.
  6196                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6197                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6198                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6199             20  CF-PLAN-BENEFIT-DATA.
  6200                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6201                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6202                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6203                                            PIC S9(7)V99  COMP-3.
  6204         16  CF-PLAN-POLICY-FORMS.
  6205             20  CF-POLICY-FORM             PIC X(12).
  6206             20  CF-MASTER-APPLICATION      PIC X(12).
  6207             20  CF-MASTER-POLICY           PIC X(12).
  6208         16  CF-PLAN-RATING.
  6209             20  CF-RATE-CODE               PIC X(5).
  6210             20  CF-SEX-RATING              PIC X.
  6211                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6212                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6213             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6214             20  CF-SUB-STD-TYPE            PIC X.
  6215                 88  CF-PCT-OF-PREM            VALUE '1'.
  6216                 88  CF-PCT-OF-BENE            VALUE '2'.
  6217         16  CF-PLAN-PREM-TOLERANCES.
  6218             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6219             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6220         16  CF-PLAN-PYMT-TOLERANCES.
  6221             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6222             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6223         16  CF-PLAN-MISC-DATA.
  6224             20  FILLER                     PIC X.
  6225             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6226             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6227         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6228         16  CF-PLAN-IND-GRP                PIC X.
  6229             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6230                                                     '1'.
  6231             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6232                                                     '2'.
  6233         16  CF-MIB-SEARCH-SW               PIC X.
  6234             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6235             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6236             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6237             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6238         16  CF-ALPHA-SEARCH-SW             PIC X.
  6239             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6240             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6241             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6242             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6243             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6244             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6245             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6246             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6247             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6248             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6249                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 115
* EL050.cbl
  6250                                                     'X' 'Y' 'Z'.
  6251         16  CF-EFF-DT-RULE-SW              PIC X.
  6252             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6253             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6254             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6255             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6256             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6257         16  FILLER                         PIC X(4).
  6258         16  CF-HEALTH-QUESTIONS            PIC X.
  6259             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6260         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6261         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6262         16  CF-PLAN-SNGL-JNT               PIC X.
  6263             88  CF-COMBINED-PLAN              VALUE 'C'.
  6264             88  CF-JNT-PLAN                   VALUE 'J'.
  6265             88  CF-SNGL-PLAN                  VALUE 'S'.
  6266         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6267         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6268         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6269         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6270         16  CF-RERATE-CNTL                 PIC  X.
  6271             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6272             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6273             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6274             88  CF-AUTO-RECALC                 VALUE '4'.
  6275         16  CF-BENEFIT-TYPE                PIC  X.
  6276             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6277             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6278         16  CF-POLICY-FEE                  PIC S999V99
  6279                                                    COMP-3.
  6280         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6281         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6282         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6283         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6284         16  FILLER                         PIC  X(32).
  6285         16  CF-TERMINATION-FORM            PIC  X(04).
  6286         16  FILLER                         PIC  X(08).
  6287         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6288                                                       COMP-3.
  6289         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6290         16  CF-ISSUE-LETTER                PIC  X(4).
  6291         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6292         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6293             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6294             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6295         16  CF-MP-REFUND-CALC              PIC X.
  6296             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6297             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6298             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6299             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6300             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6301             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6302             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6303             88  CF-MP-REFD-MEAN                VALUE '8'.
  6304         16  CF-ALT-RATE-CODE               PIC  X(5).
  6305
  6306
  6307         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 116
* EL050.cbl
  6308****************************************************************
  6309*             MORTGAGE COMPANY MASTER RECORD                   *
  6310****************************************************************
  6311
  6312     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6313         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6314         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6315             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6316             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6317             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6318             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6319             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6320
  6321         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6322         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6323         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6324         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6325         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6326
  6327         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6328             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6329         16  CF-MP-RECON-USE-IND            PIC X(1).
  6330             88  CF-MP-USE-RECON             VALUE 'Y'.
  6331         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6332             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6333         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6334             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6335             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6336         16  FILLER                         PIC X(1).
  6337         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6338             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6339         16  CF-MORTG-MIB-VERSION           PIC X.
  6340             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6341             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6342             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6343         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6344             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6345                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6346             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6347                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6348             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6349                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6350             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6351                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6352             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6353                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6354             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6355                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6356         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6357         16  FILLER                         PIC X(7).
  6358         16  CF-MORTG-DESTINATION-SYMBOL.
  6359             20  CF-MORTG-MIB-COMM          PIC X(5).
  6360             20  CF-MORTG-MIB-TERM          PIC X(5).
  6361         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6362             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6363         16  FILLER                         PIC X(03).
  6364         16  CF-MP-CHECK-NO-CONTROL.
  6365             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 117
* EL050.cbl
  6366                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6367                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6368                                                ' ' LOW-VALUES.
  6369                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6370                                               VALUE '3'.
  6371         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6372         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6373         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6374             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6375                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6376             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6377                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6378             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6379                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6380             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6381                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6382             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6383                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6384             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6385                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6386         16  CF-MORTG-BILLING-AREA.
  6387             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6388                                            PIC X.
  6389         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6390         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6391         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6392         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6393             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6394             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6395         16  FILLER                         PIC X.
  6396         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6397             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6398             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6399         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6400         16  FILLER                         PIC X(8).
  6401         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6402         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6403         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6404         16  CF-ACH-COMPANY-ID.
  6405             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6406                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6407                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6408                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6409             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6410         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6411             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6412         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6413             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6414             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6415         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6416         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6417         16  FILLER                         PIC X(536).
  6418
  6419****************************************************************
  6420*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6421****************************************************************
  6422
  6423     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 118
* EL050.cbl
  6424         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6425             20  CF-FEMALE-HEIGHT.
  6426                 24  CF-FEMALE-FT           PIC 99.
  6427                 24  CF-FEMALE-IN           PIC 99.
  6428             20  CF-FEMALE-MIN-WT           PIC 999.
  6429             20  CF-FEMALE-MAX-WT           PIC 999.
  6430         16  FILLER                         PIC X(428).
  6431
  6432     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6433         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6434             20  CF-MALE-HEIGHT.
  6435                 24  CF-MALE-FT             PIC 99.
  6436                 24  CF-MALE-IN             PIC 99.
  6437             20  CF-MALE-MIN-WT             PIC 999.
  6438             20  CF-MALE-MAX-WT             PIC 999.
  6439         16  FILLER                         PIC X(428).
  6440******************************************************************
  6441*             AUTOMATIC ACTIVITY RECORD                          *
  6442******************************************************************
  6443     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6444         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6445             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6446             20  CF-SYS-LETTER-ID           PIC X(04).
  6447             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6448             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6449             20  CF-SYS-RESET-SW            PIC X(01).
  6450             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6451             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6452
  6453         16  FILLER                         PIC X(50).
  6454
  6455         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6456             20  CF-USER-ACTIVE-SW          PIC X(01).
  6457             20  CF-USER-LETTER-ID          PIC X(04).
  6458             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6459             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6460             20  CF-USER-RESET-SW           PIC X(01).
  6461             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6462             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6463             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6464
  6465         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 119
* EL050.cbl
  6467*    COPY ERCACCT.
  6468******************************************************************
  6469*                                                                *
  6470*                                                                *
  6471*                            ERCACCT                             *
  6472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6473*                            VMOD=2.031                          *
  6474*                                                                *
  6475*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6476*                                                                *
  6477*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6478*   VSAM ACCOUNT MASTER FILES.                                   *
  6479*                                                                *
  6480*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6481*                                                                *
  6482*   FILE TYPE = VSAM,KSDS                                        *
  6483*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6484*                                                                *
  6485*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6486*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6487*                                                                *
  6488*   LOG = NO                                                     *
  6489*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6490*                                                                *
  6491*                                                                *
  6492******************************************************************
  6493*                   C H A N G E   L O G
  6494*
  6495* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6496*-----------------------------------------------------------------
  6497*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6498* EFFECTIVE    NUMBER
  6499*-----------------------------------------------------------------
  6500* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6501* 092705    2005050300006  PEMA  ADD SPP LEASES
  6502* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6503* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6504* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6505* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6506* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6507******************************************************************
  6508
  6509 01  ACCOUNT-MASTER.
  6510     12  AM-RECORD-ID                      PIC XX.
  6511         88  VALID-AM-ID                      VALUE 'AM'.
  6512
  6513     12  AM-CONTROL-PRIMARY.
  6514         16  AM-COMPANY-CD                 PIC X.
  6515         16  AM-MSTR-CNTRL.
  6516             20  AM-CONTROL-A.
  6517                 24  AM-CARRIER            PIC X.
  6518                 24  AM-GROUPING.
  6519                     28 AM-GROUPING-PREFIX PIC XXX.
  6520                     28 AM-GROUPING-PRIME  PIC XXX.
  6521                 24  AM-STATE              PIC XX.
  6522                 24  AM-ACCOUNT.
  6523                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6524                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 120
* EL050.cbl
  6525             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6526                                           PIC X(19).
  6527             20  AM-CNTRL-B.
  6528                 24  AM-EXPIRATION-DT      PIC XX.
  6529                 24  FILLER                PIC X(4).
  6530             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6531                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6532
  6533     12  AM-CONTROL-BY-VAR-GRP.
  6534         16  AM-COMPANY-CD-A1              PIC X.
  6535         16  AM-VG-CARRIER                 PIC X.
  6536         16  AM-VG-GROUPING                PIC X(6).
  6537         16  AM-VG-STATE                   PIC XX.
  6538         16  AM-VG-ACCOUNT                 PIC X(10).
  6539         16  AM-VG-DATE.
  6540             20  AM-VG-EXPIRATION-DT       PIC XX.
  6541             20  FILLER                    PIC X(4).
  6542         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6543                                           PIC 9(11)      COMP-3.
  6544     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6545         16  FILLER                        PIC X(10).
  6546         16  AM-VG-KEY3.
  6547             20  AM-VG3-ACCOUNT            PIC X(10).
  6548             20  AM-VG3-EXP-DT             PIC XX.
  6549         16  FILLER                        PIC X(4).
  6550     12  AM-MAINT-INFORMATION.
  6551         16  AM-LAST-MAINT-DT              PIC XX.
  6552         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6553         16  AM-LAST-MAINT-USER            PIC X(4).
  6554         16  FILLER                        PIC XX.
  6555
  6556     12  AM-EFFECTIVE-DT                   PIC XX.
  6557     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6558
  6559     12  AM-PREV-DATES  COMP-3.
  6560         16  AM-PREV-EXP-DT                PIC 9(11).
  6561         16  AM-PREV-EFF-DT                PIC 9(11).
  6562
  6563     12  AM-REPORT-CODE-1                  PIC X(10).
  6564     12  AM-REPORT-CODE-2                  PIC X(10).
  6565
  6566     12  AM-CITY-CODE                      PIC X(4).
  6567     12  AM-COUNTY-PARISH                  PIC X(6).
  6568
  6569     12  AM-NAME                           PIC X(30).
  6570     12  AM-PERSON                         PIC X(30).
  6571     12  AM-ADDRS                          PIC X(30).
  6572     12  AM-CITY.
  6573         16  AM-ADDR-CITY                  PIC X(28).
  6574         16  AM-ADDR-STATE                 PIC XX.
  6575     12  AM-ZIP.
  6576         16  AM-ZIP-PRIME.
  6577             20  AM-ZIP-PRI-1ST            PIC X.
  6578                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6579             20  FILLER                    PIC X(4).
  6580         16  AM-ZIP-PLUS4                  PIC X(4).
  6581     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6582         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 121
* EL050.cbl
  6583         16  AM-CAN-POSTAL-2               PIC XXX.
  6584         16  FILLER                        PIC XXX.
  6585     12  AM-TEL-NO.
  6586         16  AM-AREA-CODE                  PIC 999.
  6587         16  AM-TEL-PRE                    PIC 999.
  6588         16  AM-TEL-NBR                    PIC 9(4).
  6589     12  AM-TEL-LOC                        PIC X.
  6590         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6591         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6592
  6593     12  AM-COMM-STRUCTURE.
  6594         16  AM-DEFN-1.
  6595             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6596                 24  AM-AGT.
  6597                     28  AM-AGT-PREFIX     PIC X(4).
  6598                     28  AM-AGT-PRIME      PIC X(6).
  6599                 24  AM-COM-TYP            PIC X.
  6600                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6601                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6602                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6603                 24  AM-RECALC-LV-INDIC    PIC X.
  6604                 24  AM-RETRO-LV-INDIC     PIC X.
  6605                 24  AM-GL-CODES           PIC X.
  6606                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6607                 24  FILLER                PIC X(01).
  6608         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6609             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6610                 24  FILLER                PIC X(11).
  6611                 24  AM-L-COMA             PIC XXX.
  6612                 24  AM-J-COMA             PIC XXX.
  6613                 24  AM-A-COMA             PIC XXX.
  6614                 24  FILLER                PIC X(6).
  6615
  6616     12  AM-COMM-CHANGE-STATUS             PIC X.
  6617         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6618
  6619     12  AM-CSR-CODE                       PIC X(4).
  6620
  6621     12  AM-BILLING-STATUS                 PIC X.
  6622         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6623         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6624     12  AM-AUTO-REFUND-SW                 PIC X.
  6625         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6626         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6627     12  AM-GPCD                           PIC 99.
  6628     12  AM-IG                             PIC X.
  6629         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6630         88  AM-HAS-GROUP                     VALUE '2'.
  6631     12  AM-STATUS                         PIC X.
  6632         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6633         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6634         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6635         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6636         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6637         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6638     12  AM-REMIT-TO                       PIC 99.
  6639     12  AM-ID-NO                          PIC X(11).
  6640
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 122
* EL050.cbl
  6641     12  AM-CAL-TABLE                      PIC XX.
  6642     12  AM-LF-DEVIATION                   PIC XXX.
  6643     12  AM-AH-DEVIATION                   PIC XXX.
  6644     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6645     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6646     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6647     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6648     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6649     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6650
  6651     12  AM-USER-FIELDS.
  6652         16  AM-FLD-1                      PIC XX.
  6653         16  AM-FLD-2                      PIC XX.
  6654         16  AM-FLD-3                      PIC XX.
  6655         16  AM-FLD-4                      PIC XX.
  6656         16  AM-FLD-5                      PIC XX.
  6657
  6658     12  AM-1ST-PROD-DATE.
  6659         16  AM-1ST-PROD-YR                PIC XX.
  6660         16  AM-1ST-PROD-MO                PIC XX.
  6661         16  AM-1ST-PROD-DA                PIC XX.
  6662     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6663     12  AM-CERTS-PURGED-DATE.
  6664         16  AM-PUR-YR                     PIC XX.
  6665         16  AM-PUR-MO                     PIC XX.
  6666         16  AM-PUR-DA                     PIC XX.
  6667     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6668     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6669     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6670     12  AM-INACTIVE-DATE.
  6671         16  AM-INA-MO                     PIC 99.
  6672         16  AM-INA-DA                     PIC 99.
  6673         16  AM-INA-YR                     PIC 99.
  6674     12  AM-AR-HI-CERT-DATE                PIC XX.
  6675
  6676     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6677     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6678
  6679     12  AM-OB-PAYMENT-MODE                PIC X.
  6680         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6681         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6682         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6683         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6684
  6685     12  AM-AH-ONLY-INDICATOR              PIC X.
  6686         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6687         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6688
  6689     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6690
  6691     12  AM-OVER-SHORT.
  6692         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6693         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6694
  6695     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6696     12  AM-DCC-CLP-STATE                  PIC XX.
  6697
  6698     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 123
* EL050.cbl
  6699     12  AM-RECALC-REIN                    PIC X.
  6700
  6701     12  AM-REI-TABLE                      PIC XXX.
  6702     12  AM-REI-ET-LF                      PIC X.
  6703     12  AM-REI-ET-AH                      PIC X.
  6704     12  AM-REI-PE-LF                      PIC X.
  6705     12  AM-REI-PE-AH                      PIC X.
  6706     12  AM-REI-PRT-ST                     PIC X.
  6707     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6708     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6709     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6710     12  AM-REI-GROUP-A                    PIC X(6).
  6711     12  AM-REI-MORT                       PIC X(4).
  6712     12  AM-REI-PRT-OW                     PIC X.
  6713     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6714     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6715     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6716     12  AM-REI-GROUP-B                    PIC X(6).
  6717
  6718     12  AM-TRUST-TYPE                     PIC X(2).
  6719
  6720     12  AM-EMPLOYER-STMT-USED             PIC X.
  6721     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6722
  6723     12  AM-STD-AH-TYPE                    PIC XX.
  6724     12  AM-EARN-METHODS.
  6725         16  AM-EARN-METHOD-R              PIC X.
  6726             88 AM-REF-RL-R78                 VALUE 'R'.
  6727             88 AM-REF-RL-PR                  VALUE 'P'.
  6728             88 AM-REF-RL-MEAN                VALUE 'M'.
  6729             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6730         16  AM-EARN-METHOD-L              PIC X.
  6731             88 AM-REF-LL-R78                 VALUE 'R'.
  6732             88 AM-REF-LL-PR                  VALUE 'P'.
  6733             88 AM-REF-LL-MEAN                VALUE 'M'.
  6734             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6735         16  AM-EARN-METHOD-A              PIC X.
  6736             88 AM-REF-AH-R78                 VALUE 'R'.
  6737             88 AM-REF-AH-PR                  VALUE 'P'.
  6738             88 AM-REF-AH-MEAN                VALUE 'M'.
  6739             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6740             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6741             88 AM-REF-AH-NET                 VALUE 'N'.
  6742
  6743     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6744     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6745     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6746
  6747     12  AM-RET-Y-N                        PIC X.
  6748     12  AM-RET-P-E                        PIC X.
  6749     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6750     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6751     12  AM-RET-GRP                        PIC X(6).
  6752     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6753         16  AM-POOL-PRIME                 PIC XXX.
  6754         16  AM-POOL-SUB                   PIC XXX.
  6755     12  AM-RETRO-EARNINGS.
  6756         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 124
* EL050.cbl
  6757         16  AM-RET-EARN-L                 PIC X.
  6758         16  AM-RET-EARN-A                 PIC X.
  6759     12  AM-RET-ST-TAX-USE                 PIC X.
  6760         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6761         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6762     12  AM-RETRO-BEG-EARNINGS.
  6763         16  AM-RET-BEG-EARN-R             PIC X.
  6764         16  AM-RET-BEG-EARN-L             PIC X.
  6765         16  AM-RET-BEG-EARN-A             PIC X.
  6766     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6767     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6768
  6769     12  AM-USER-SELECT-OPTIONS.
  6770         16  AM-USER-SELECT-1              PIC X(10).
  6771         16  AM-USER-SELECT-2              PIC X(10).
  6772         16  AM-USER-SELECT-3              PIC X(10).
  6773         16  AM-USER-SELECT-4              PIC X(10).
  6774         16  AM-USER-SELECT-5              PIC X(10).
  6775
  6776     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6777
  6778     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6779
  6780     12  AM-RPT045A-SWITCH                 PIC X.
  6781         88  RPT045A-OFF                   VALUE 'N'.
  6782
  6783     12  AM-INSURANCE-LIMITS.
  6784         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6785         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6786
  6787     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6788         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6789
  6790     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6791         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6792         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6793
  6794     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6795
  6796     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6797     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6798     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6799     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6800     12  AM-DCC-UEF-STATE                  PIC XX.
  6801     12  FILLER                            PIC XXX.
  6802     12  AM-REPORT-CODE-3                  PIC X(10).
  6803*    12  FILLER                            PIC X(22).
  6804
  6805     12  AM-RESERVE-DATE.
  6806         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6807         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6808         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6809
  6810     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6811     12  AM-NOTIFICATION-TYPES.
  6812         16  AM-NOTIF-OF-LETTERS           PIC X.
  6813         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6814         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 125
* EL050.cbl
  6815         16  AM-NOTIF-OF-STATUS            PIC X.
  6816
  6817     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6818         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6819         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6820         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6821         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6822
  6823     12  AM-BENEFIT-CONTROLS.
  6824         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6825             20  AM-BENEFIT-CODE           PIC XX.
  6826             20  AM-BENEFIT-TYPE           PIC X.
  6827             20  AM-BENEFIT-REVISION       PIC XXX.
  6828             20  AM-BENEFIT-REM-TERM       PIC X.
  6829             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6830             20  FILLER                    PIC XX.
  6831         16  FILLER                        PIC X(80).
  6832
  6833     12  AM-TRANSFER-DATA.
  6834         16  AM-TRANSFERRED-FROM.
  6835             20  AM-TRNFROM-CARRIER        PIC X.
  6836             20  AM-TRNFROM-GROUPING.
  6837                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6838                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6839             20  AM-TRNFROM-STATE          PIC XX.
  6840             20  AM-TRNFROM-ACCOUNT.
  6841                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6842                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6843             20  AM-TRNFROM-DTE            PIC XX.
  6844         16  AM-TRANSFERRED-TO.
  6845             20  AM-TRNTO-CARRIER          PIC X.
  6846             20  AM-TRNTO-GROUPING.
  6847                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6848                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6849             20  AM-TRNTO-STATE            PIC XX.
  6850             20  AM-TRNTO-ACCOUNT.
  6851                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6852                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6853             20  AM-TRNTO-DTE              PIC XX.
  6854         16  FILLER                        PIC X(10).
  6855
  6856     12  AM-SAVED-REMIT-TO                 PIC 99.
  6857
  6858     12  AM-COMM-STRUCTURE-SAVED.
  6859         16  AM-DEFN-1-SAVED.
  6860             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6861                 24  AM-AGT-SV             PIC X(10).
  6862                 24  AM-COM-TYP-SV         PIC X.
  6863                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6864                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6865                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6866                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6867                 24  FILLER                PIC X.
  6868                 24  AM-GL-CODES-SV        PIC X.
  6869                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6870                 24  FILLER                PIC X.
  6871         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6872             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 126
* EL050.cbl
  6873                 24  FILLER                PIC X(11).
  6874                 24  AM-L-COMA-SV          PIC XXX.
  6875                 24  AM-J-COMA-SV          PIC XXX.
  6876                 24  AM-A-COMA-SV          PIC XXX.
  6877                 24  FILLER                PIC X(6).
  6878
  6879     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6880         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6881            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6882            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6883            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6884
  6885     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6886     12  FILLER                            PIC X(120).
  6887
  6888     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6889         16  AM-CONTROL-NAME               PIC X(30).
  6890         16  AM-EXECUTIVE-ONE.
  6891             20  AM-EXEC1-NAME             PIC X(15).
  6892             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6893                                                          COMP-3.
  6894             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6895                                                          COMP-3.
  6896         16  AM-EXECUTIVE-TWO.
  6897             20  AM-EXEC2-NAME             PIC X(15).
  6898             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6899                                                          COMP-3.
  6900             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6901                                                          COMP-3.
  6902
  6903     12  AM-RETRO-ADDITIONAL-DATA.
  6904         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6905         16  AM-RETRO-PREM-P-E             PIC X.
  6906         16  AM-RETRO-CLMS-P-I             PIC X.
  6907         16  AM-RETRO-RET-BRACKET-LF.
  6908             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6909                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6910                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6911             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6912                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6913                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6914             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6915                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6916                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6917         16  AM-RETRO-RET-BRACKET-AH.
  6918             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6919                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6920                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6921                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6922             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6923                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6924                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6925             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6926                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6927                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6928
  6929     12  AM-COMMENTS.
  6930         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 127
* EL050.cbl
  6931
  6932     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6933         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6934         16  AM-FLI-BILLING-CODE           PIC X.
  6935         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6936         16  AM-FLI-UNITED-IDENT           PIC X.
  6937         16  AM-FLI-INTEREST-LOST-DATA.
  6938             20  AM-FLI-BANK-NO            PIC X(5).
  6939             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6940             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6941             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6942         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6943             20  AM-FLI-AGT                PIC X(9).
  6944             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6945             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6946         16  FILLER                        PIC X(102).
  6947
  6948     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6949         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6950             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6951             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6952             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6953             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6954             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6955         16  FILLER                          PIC X(10).
  6956******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 128
* EL050.cbl
  6958*    COPY ERCREIN.
  6959******************************************************************
  6960*                                                                *
  6961*                            ERCREIN                             *
  6962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6963*                            VMOD=2.010                          *
  6964*                                                                *
  6965*   ONLINE CREDIT SYSTEM                                         *
  6966*                                                                *
  6967*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6968*                                                                *
  6969*   FILE TYPE = VSAM,KSDS                                        *
  6970*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6971*                                                                *
  6972*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6973*       ALTERNATE PATH = NONE                                    *
  6974*                                                                *
  6975*   LOG = NO                                                     *
  6976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6977*                                                                *
  6978******************************************************************
  6979*                   C H A N G E   L O G
  6980*
  6981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6982*-----------------------------------------------------------------
  6983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6984* EFFECTIVE    NUMBER
  6985*-----------------------------------------------------------------
  6986* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6987* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6988******************************************************************
  6989 01  REINSURANCE-RECORD.
  6990     12  RE-RECORD-ID                      PIC XX.
  6991         88  VALID-RE-ID                      VALUE 'RE'.
  6992
  6993     12  RE-CONTROL-PRIMARY.
  6994         16  RE-COMPANY-CD                 PIC X.
  6995         16  RE-KEY.
  6996             20  RE-CODE                   PIC X.
  6997                 88  RE-TABLE-RECORD          VALUE 'A'.
  6998                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6999             20  RE-TABLE                  PIC XXX.
  7000             20  FILLER                    PIC XXX.
  7001         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7002             20  FILLER                    PIC X.
  7003             20  RE-COMPANY.
  7004                 24  RE-COMP-PRIME         PIC XXX.
  7005                 24  RE-COMP-SUB           PIC XXX.
  7006
  7007     12  RE-MAINT-INFORMATION.
  7008         16  RE-LAST-MAINT-DT              PIC XX.
  7009         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7010         16  RE-LAST-MAINT-USER            PIC X(4).
  7011         16  FILLER                        PIC X(10).
  7012
  7013     12  RE-TABLE-DATA.
  7014         16  RE-100-COMP                   PIC 99.
  7015
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 129
* EL050.cbl
  7016         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7017             20  RE-REI-COMP-NO.
  7018                 24  RE-REI-COMP           PIC XXX.
  7019                 24  RE-REI-COMP-SUB       PIC XXX.
  7020             20  RE-LF-QC                  PIC X.
  7021             20  RE-AH-QC                  PIC X.
  7022             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7023             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7024             20  RE-LFAGE-LO               PIC 99.
  7025             20  RE-LFAGE-HI               PIC 99.
  7026             20  RE-AHAGE-LO               PIC 99.
  7027             20  RE-AHAGE-HI               PIC 99.
  7028             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7029             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7030             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7031             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7032             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7033             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7034             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7035             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7036             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7037             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7038             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7039             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7040             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7041             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7042             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7043             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7044             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7045             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7046             20  RE-LF-BEN-CODE            PIC X.
  7047             20  RE-AH-BEN-CODE            PIC X.
  7048             20  RE-INTERACTIVE            PIC X.
  7049             20  RE-REMAINING              PIC X.
  7050             20  RE-LF-RUNOFF-SW           PIC X.
  7051             20  RE-AH-RUNOFF-SW           PIC X.
  7052             20  FILLER                    PIC X(19).
  7053
  7054         16  RE-COMP-INFO-END              PIC X(6).
  7055         16  RE-NSP-ST-CD-LF               PIC XX.
  7056         16  RE-NSP-ST-CD-AH               PIC XX.
  7057         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7058             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7059
  7060         16  FILLER                        PIC X(27).
  7061
  7062     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7063         16  RE-NAME                       PIC X(30).
  7064         16  RE-LF-PE                      PIC X.
  7065         16  RE-AH-PE                      PIC X.
  7066         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7067         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7068         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7069         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7070         16  RE-PRT-ST                     PIC X.
  7071         16  RE-PRT-OW                     PIC X.
  7072         16  RE-MORT-CODE                  PIC X(4).
  7073         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 130
* EL050.cbl
  7074         16  RE-ZERO-LF-FEE                PIC X.
  7075         16  RE-ZERO-AH-FEE                PIC X.
  7076         16  RE-CEDE-NAME                  PIC X(30).
  7077         16  RE-LF-COMM                    PIC X.
  7078         16  RE-AH-COMM                    PIC X.
  7079         16  RE-LF-TAX                     PIC X.
  7080         16  RE-AH-TAX                     PIC X.
  7081         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7082         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7083         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7084
  7085         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7086             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7087
  7088         16  RE-LF-CEDING-FEE-BRACKETS.
  7089             20  RE-LF-FEE-METHOD          PIC X.
  7090                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7091                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7092                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7093                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7094             20  RE-LF-FEE-BASIS           PIC X.
  7095                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7096                 88  RE-LF-NET-CEDED               VALUE '2'.
  7097                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7098                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7099                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7100                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7101                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7102                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7103             20  FILLER                    PIC XXX.
  7104             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7105                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7106                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7107
  7108         16  RE-AH-CEDING-FEE-BRACKETS.
  7109             20  RE-AH-FEE-METHOD          PIC X.
  7110                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7111                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7112                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7113                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7114             20  RE-AH-FEE-BASIS           PIC X.
  7115                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7116                 88  RE-AH-NET-CEDED               VALUE '2'.
  7117                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7118                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7119                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7120                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7121                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7122                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7123             20  FILLER                    PIC XXX.
  7124             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7125                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7126                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7127
  7128         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7129
  7130         16  RE-OLD-CEDING-STMT            PIC X.
  7131
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 131
* EL050.cbl
  7132         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7133         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7134         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7135         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7136         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7137         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7138         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7139         16  RE-MORT-SW                    PIC X.
  7140         16  RE-CEDING-TYPE-FLAG           PIC X.
  7141             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7142             88  RE-CEDED                          VALUE 'C'.
  7143             88  RE-ASSUMED                        VALUE 'A'.
  7144             88  RE-PHANTOM                        VALUE 'P'.
  7145
  7146         16  RE-CEDING-STMT-OPT-A          PIC X.
  7147             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7148         16  RE-CEDING-STMT-OPT-B          PIC X.
  7149             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7150         16  RE-CEDING-STMT-OPT-C          PIC X.
  7151             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7152         16  RE-CEDING-STMT-OPT-D          PIC X.
  7153             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7154         16  RE-CEDING-STMT-OPT-E          PIC X.
  7155             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7156
  7157         16  RE-PRT-CRSV                   PIC X.
  7158
  7159         16  RE-GL-CENTER                  PIC X(4).
  7160
  7161         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7162
  7163         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7164
  7165         16  RE-EARN-STOP-CODE             PIC X.
  7166             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7167             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7168
  7169         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7170             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7171
  7172         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7173         16  FILLER                        PIC X(2281).
  7174
  7175         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7176
  7177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 132
* EL050.cbl
  7179*    COPY ERCCTBL.
  7180******************************************************************
  7181*                                                                *
  7182*                                                                *
  7183*                            ERCCTBL                             *
  7184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7185*                            VMOD=2.003
  7186*                                                                *
  7187*   ONLINE CREDIT SYSTEM                                         *
  7188*                                                                *
  7189*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7190*                                                                *
  7191*   FILE TYPE = VSAM,KSDS                                        *
  7192*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7193*                                                                *
  7194*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7195*       ALTERNATE PATH = NONE                                    *
  7196*                                                                *
  7197*   LOG = NO                                                     *
  7198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7199*                                                                *
  7200*                                                                *
  7201******************************************************************
  7202
  7203 01  COMM-TABLE-RECORD.
  7204     12  CT-RECORD-ID                      PIC XX.
  7205         88  VALID-CT-ID                      VALUE 'CT'.
  7206
  7207     12  CT-CONTROL-PRIMARY.
  7208         16  CT-COMPANY-CD                 PIC X.
  7209         16  CT-TABLE                      PIC XXX.
  7210         16  CT-CNTRL-2.
  7211             20  CT-BEN-TYPE               PIC X.
  7212             20  CT-BEN-CODE               PIC XX.
  7213
  7214     12  CT-MAINT-INFORMATION.
  7215         16  CT-LAST-MAINT-DT              PIC XX.
  7216         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7217         16  CT-LAST-MAINT-USER            PIC X(4).
  7218         16  FILLER                        PIC X(31).
  7219
  7220     12  CT-LIMITS.
  7221         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7222
  7223         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7224
  7225         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7226
  7227     12  CT-RATES.
  7228         16  CT-RTX          OCCURS 27 TIMES.
  7229             20  CT-RT                     PIC SV9(5)     COMP-3.
  7230             20  CT-RT-R   REDEFINES
  7231                 CT-RT                     PIC XXX.
  7232
  7233     12  FILLER                            PIC  X(42).
  7234
  7235******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 133
* EL050.cbl
  7237*    COPY ERCFORM.
  7238******************************************************************
  7239*                                                                *
  7240*                                                                *
  7241*                            ERCFORM.                            *
  7242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7243*                            VMOD=2.003                          *
  7244*                                                                *
  7245*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7246*                                                                *
  7247*    FILE TYPE = VSAM,KSDS                                       *
  7248*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7249*                                                                *
  7250*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7251*                                                                *
  7252*    LOG = YES                                                   *
  7253*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7254******************************************************************
  7255 01  FORM-MASTER.
  7256    12  FO-RECORD-ID                 PIC X(02).
  7257        88  VALID-FO-ID                  VALUE 'FO'.
  7258
  7259    12  FO-CONTROL-PRIMARY.
  7260        16  FO-COMPANY-CD            PIC X(01).
  7261        16  FO-STATE                 PIC X(02).
  7262        16  FO-FORM-ID               PIC X(12).
  7263        16  FO-FORM-EXP-DT           PIC X(02).
  7264
  7265    12  FO-POLICY-FORM-DATA.
  7266        16  FO-IND-GRP-CD            PIC X(01).
  7267        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7268        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7269        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7270        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7271        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7272        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7273        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7274        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7275        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7276        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7277        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7278        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7279        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7280        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7281        16  FO-APP-CERT-USE-CD       PIC X(01).
  7282
  7283    12  FILLER                       PIC X(29).
  7284
  7285    12  FO-FORM-PLAN-TABLE.
  7286        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7287            20  FO-PLAN-TYPE         PIC X(01).
  7288            20  FO-PLAN-ID           PIC X(02).
  7289            20  FO-PLAN-TERM         PIC 9(03).
  7290            20  FO-PLAN-REFUND-METHOD
  7291                                     PIC X.
  7292
  7293    12  FILLER                       PIC X(30).
  7294
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 134
* EL050.cbl
  7295    12  FO-COMMENTS-AREA.
  7296        16  FO-COMMENT-LINE-1        PIC X(78).
  7297
  7298    12  FILLER                       PIC X(20).
  7299
  7300    12  FO-MAINT-INFORMATION.
  7301        16  FO-LAST-MAINT-DT         PIC X(02).
  7302        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7303        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 135
* EL050.cbl
  7305*    COPY ELCMSTR.
  7306******************************************************************
  7307*                                                                *
  7308*                            ELCMSTR.                            *
  7309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7310*                            VMOD=2.012                          *
  7311*                                                                *
  7312*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7313*                                                                *
  7314*   FILE TYPE = VSAM,KSDS                                        *
  7315*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7316*                                                                *
  7317*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7318*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7319*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7320*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7321*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7322*                                                 RKP=75,LEN=21  *
  7323*                                                                *
  7324*   **** NOTE ****                                               *
  7325*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7326*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7327*                                                                *
  7328*   LOG = YES                                                    *
  7329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7330******************************************************************
  7331*                   C H A N G E   L O G
  7332*
  7333* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7334*-----------------------------------------------------------------
  7335*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7336* EFFECTIVE    NUMBER
  7337*-----------------------------------------------------------------
  7338* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7339* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7340* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7341* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7342* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7343******************************************************************
  7344 01  CLAIM-MASTER.
  7345     12  CL-RECORD-ID                PIC XX.
  7346         88  VALID-CL-ID         VALUE 'CL'.
  7347
  7348     12  CL-CONTROL-PRIMARY.
  7349         16  CL-COMPANY-CD           PIC X.
  7350         16  CL-CARRIER              PIC X.
  7351         16  CL-CLAIM-NO             PIC X(7).
  7352         16  CL-CERT-NO.
  7353             20  CL-CERT-PRIME       PIC X(10).
  7354             20  CL-CERT-SFX         PIC X.
  7355
  7356     12  CL-CONTROL-BY-NAME.
  7357         16  CL-COMPANY-CD-A1        PIC X.
  7358         16  CL-INSURED-LAST-NAME    PIC X(15).
  7359         16  CL-INSURED-NAME.
  7360             20  CL-INSURED-1ST-NAME PIC X(12).
  7361             20  CL-INSURED-MID-INIT PIC X.
  7362
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 136
* EL050.cbl
  7363     12  CL-CONTROL-BY-SSN.
  7364         16  CL-COMPANY-CD-A2        PIC X.
  7365         16  CL-SOC-SEC-NO.
  7366             20  CL-SSN-STATE        PIC XX.
  7367             20  CL-SSN-ACCOUNT      PIC X(6).
  7368             20  CL-SSN-LN3          PIC X(3).
  7369
  7370     12  CL-CONTROL-BY-CERT-NO.
  7371         16  CL-COMPANY-CD-A4        PIC X.
  7372         16  CL-CERT-NO-A4.
  7373             20  CL-CERT-A4-PRIME    PIC X(10).
  7374             20  CL-CERT-A4-SFX      PIC X.
  7375
  7376     12  CL-CONTROL-BY-CCN.
  7377         16  CL-COMPANY-CD-A5        PIC X.
  7378         16  CL-CCN-A5.
  7379             20  CL-CCN.
  7380                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7381                 24  CL-CCN-PRIME-A5 PIC X(12).
  7382             20  CL-CCN-FILLER-A5    PIC X(4).
  7383
  7384     12  CL-INSURED-PROFILE-DATA.
  7385         16  CL-INSURED-BIRTH-DT     PIC XX.
  7386         16  CL-INSURED-SEX-CD       PIC X.
  7387             88  INSURED-IS-MALE        VALUE 'M'.
  7388             88  INSURED-IS-FEMALE      VALUE 'F'.
  7389             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7390         16  CL-INSURED-OCC-CD       PIC X(6).
  7391         16  FILLER                  PIC X(5).
  7392
  7393     12  CL-PROCESSING-INFO.
  7394         16  CL-PROCESSOR-ID         PIC X(4).
  7395         16  CL-CLAIM-STATUS         PIC X.
  7396             88  CLAIM-IS-OPEN          VALUE 'O'.
  7397             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7398         16  CL-CLAIM-TYPE           PIC X.
  7399*            88  AH-CLAIM               VALUE 'A'.
  7400*            88  LIFE-CLAIM             VALUE 'L'.
  7401*            88  PROPERTY-CLAIM         VALUE 'P'.
  7402*            88  IUI-CLAIM              VALUE 'I'.
  7403*            88  GAP-CLAIM              VALUE 'G'.
  7404*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7405         16  CL-CLAIM-PREM-TYPE      PIC X.
  7406             88  SINGLE-PREMIUM         VALUE '1'.
  7407             88  O-B-COVERAGE           VALUE '2'.
  7408             88  OPEN-END-COVERAGE      VALUE '3'.
  7409         16  CL-INCURRED-DT          PIC XX.
  7410         16  CL-REPORTED-DT          PIC XX.
  7411         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7412         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7413         16  CL-LAST-PMT-DT          PIC XX.
  7414         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7415         16  CL-PAID-THRU-DT         PIC XX.
  7416         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7417         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7418         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7419         16  CL-PMT-CALC-METHOD      PIC X.
  7420             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 137
* EL050.cbl
  7421             88  CL-365-DAY-YR          VALUE '2'.
  7422             88  CL-FULL-MONTHS         VALUE '3'.
  7423         16  CL-CAUSE-CD             PIC X(6).
  7424
  7425         16  CL-PRIME-CERT-NO.
  7426             20  CL-PRIME-CERT-PRIME PIC X(10).
  7427             20  CL-PRIME-CERT-SFX   PIC X.
  7428
  7429         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7430             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7431             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7432
  7433         16  CL-MICROFILM-NO         PIC X(10).
  7434         16  FILLER REDEFINES CL-MICROFILM-NO.
  7435             20  CL-BENEFIT-PERIOD   PIC 99.
  7436             20  FILLER              PIC X(8).
  7437         16  CL-PROG-FORM-TYPE       PIC X.
  7438         16  CL-LAST-ADD-ON-DT       PIC XX.
  7439
  7440         16  CL-LAST-REOPEN-DT       PIC XX.
  7441         16  CL-LAST-CLOSE-DT        PIC XX.
  7442         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7443             88  FINAL-PAID             VALUE '1'.
  7444             88  CLAIM-DENIED           VALUE '2'.
  7445             88  AUTO-CLOSE             VALUE '3'.
  7446             88  MANUAL-CLOSE           VALUE '4'.
  7447             88  BENEFITS-CHANGED       VALUE 'C'.
  7448             88  SETUP-ERRORS           VALUE 'E'.
  7449         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7450         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7451         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7452             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7453         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7454         16  FILLER                  PIC X.
  7455
  7456     12  CL-CERTIFICATE-DATA.
  7457         16  CL-CERT-ORIGIN          PIC X.
  7458             88  CERT-WAS-ONLINE        VALUE '1'.
  7459             88  CERT-WAS-CREATED       VALUE '2'.
  7460             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7461         16  CL-CERT-KEY-DATA.
  7462             20  CL-CERT-CARRIER     PIC X.
  7463             20  CL-CERT-GROUPING    PIC X(6).
  7464             20  CL-CERT-STATE       PIC XX.
  7465             20  CL-CERT-ACCOUNT.
  7466                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7467                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7468             20  CL-CERT-EFF-DT      PIC XX.
  7469
  7470     12  CL-STATUS-CONTROLS.
  7471         16  CL-PRIORITY-CD          PIC X.
  7472             88  CONFIDENTIAL-DATA      VALUE '8'.
  7473             88  HIGHEST-PRIORITY       VALUE '9'.
  7474         16  CL-SUPV-ATTN-CD         PIC X.
  7475             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7476             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7477         16  CL-PURGED-DT            PIC XX.
  7478         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 138
* EL050.cbl
  7479         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7480         16  CL-NEXT-RESEND-DT       PIC XX.
  7481         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7482         16  CL-CRITICAL-PERIOD      PIC 99.
  7483*        16  FILLER                  PIC XX.
  7484         16  CL-LAST-MAINT-DT        PIC XX.
  7485         16  CL-LAST-MAINT-USER      PIC X(4).
  7486         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7487         16  CL-LAST-MAINT-TYPE      PIC X.
  7488             88  CLAIM-SET-UP           VALUE ' '.
  7489             88  PAYMENT-MADE           VALUE '1'.
  7490             88  LETTER-SENT            VALUE '2'.
  7491             88  MASTER-WAS-ALTERED     VALUE '3'.
  7492             88  MASTER-WAS-RESTORED    VALUE '4'.
  7493             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7494             88  FILE-CONVERTED         VALUE '6'.
  7495             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7496             88  ERROR-CORRECTION       VALUE 'E'.
  7497         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7498         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7499         16  CL-BENEFICIARY          PIC X(10).
  7500         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7501         16  CL-DENIAL-TYPE          PIC X.
  7502             88  CL-TYPE-DENIAL          VALUE '1'.
  7503             88  CL-TYPE-RESCISSION      VALUE '2'.
  7504             88  CL-TYPE-REFORMATION     VALUE '3'.
  7505             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7506             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7507         16  filler                  pic x(5).
  7508*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7509*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7510*        16  CL-RTW-DT               PIC XX.
  7511
  7512     12  CL-TRAILER-CONTROLS.
  7513         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7514             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7515             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7516             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7517         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7518         16  FILLER                  PIC XX.
  7519         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7520         16  CL-ADDRESS-TRAILER-CNT.
  7521             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7522                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7523             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7524                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7525             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7526                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7527             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7528                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7529             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7530                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7531             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7532                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7533             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7534                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7535
  7536     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 139
* EL050.cbl
  7537         16  CL-CV-REFNO-PRIME       PIC X(18).
  7538         16  CL-CV-REFNO-SFX         PIC XX.
  7539
  7540     12  CL-FILE-LOCATION            PIC X(4).
  7541
  7542     12  CL-PROCESS-ERRORS.
  7543         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7544             88  NO-FATAL-ERRORS        VALUE ZERO.
  7545         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7546             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7547
  7548     12  CL-PRODUCT-CD               PIC X.
  7549
  7550     12  CL-CURRENT-KEY-DATA.
  7551         16  CL-CURRENT-CARRIER      PIC X.
  7552         16  CL-CURRENT-GROUPING     PIC X(6).
  7553         16  CL-CURRENT-STATE        PIC XX.
  7554         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7555
  7556     12  CL-ASSOCIATES               PIC X.
  7557         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7558         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7559         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7560         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7561
  7562     12  CL-ACTIVITY-CODE            PIC 99.
  7563     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7564     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7565
  7566     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7567     12  CL-LAG-REPORT-CODE          PIC 9.
  7568     12  CL-LOAN-TYPE                PIC XX.
  7569     12  CL-LEGAL-STATE              PIC XX.
  7570
  7571     12  CL-YESNOSW                  PIC X.
  7572     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7573         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7574         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7575         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7576     12  cl-insured-type             pic x.
  7577         88  cl-claim-on-primary         value 'P'.
  7578         88  cl-claim-on-co-borrower     value 'C'.
  7579     12  cl-benefit-expiration-dt    PIC XX.
  7580
  7581 01  PLAN-RECORDS.
  7582     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7583     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7584
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 140
* EL050.cbl
  7586 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7587                          ACCOUNT-MASTER REINSURANCE-RECORD
  7588                          COMM-TABLE-RECORD FORM-MASTER
  7589                          CLAIM-MASTER PLAN-RECORDS.
  7590 0000-DFHEXIT SECTION.
  7591     MOVE '9#                    $   ' TO DFHEIV0.
  7592     MOVE 'EL050' TO DFHEIV1.
  7593     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7594
  7595     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7596
  7597
  7598* EXEC CICS  HANDLE CONDITION
  7599*           ERROR    (9300-ABEND)
  7600*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7601*    END-EXEC.
  7602*    MOVE '"$.J                  ! " #00007593' TO DFHEIV0
  7603     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7605     MOVE X'2220233030303037353933' TO DFHEIV0(25:11)
  7606     CALL 'kxdfhei1' USING DFHEIV0
  7607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7608
  7609
  7610 0000-COPY-PROCEDURE-DIV.
  7611*                          COPY ELC50PD.
  7612******************************************************************
  7613*                                                                *
  7614*                            ELC50PD                             *
  7615*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7616*                            VMOD=2.188                          *
  7617*                                                                *
  7618******************************************************************
  7619*                   C H A N G E   L O G
  7620*
  7621* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7622*-----------------------------------------------------------------
  7623*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7624* EFFECTIVE    NUMBER
  7625*-----------------------------------------------------------------
  7626* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7627* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7628* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7629*                             2709 AND 2718
  7630* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7631* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7632* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7633* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7634* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7635*                                IS OPEN OR CNC DT < PD THRU
  7636* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7637* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7638* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7639* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7640* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7641* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7642* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7643* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 141
* EL050.cbl
  7644* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7645* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7646* 020906                   PEMA  EXPAND LOAN OFFICER
  7647* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7648* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7649* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7650* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7651* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7652* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7653* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7654* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7655* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7656* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7657* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7658* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7659* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7660* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7661* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7662* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7663* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7664* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7665* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7666* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7667* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7668* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7669* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7670* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7671* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7672*                                UPDATE VIN ON CERT TRAILER
  7673* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7674* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7675* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7676* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7677* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7678* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7679* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7680* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7681* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7682* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7683* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7684* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7685* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7686* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7687* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7688* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7689* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7690* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7691* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7692* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7693* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7694* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7695* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7696* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7697* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7698* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7699* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7700* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7701* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 142
* EL050.cbl
  7702* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7703* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7704* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7705* 032912  CR2011110200001  PEMA  AHL CHANGES
  7706* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7707* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7708* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7709* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7710* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7711* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7712* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7713* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7714* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7715* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7716* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7717* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7718* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7719* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7720* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7721* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7722* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7723* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7724* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7725* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7726* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7727* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7728* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7729* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7730* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7731* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7732* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7733*                                CERT #, ADD 2898 FORCIBLE ERROR
  7734******************************************************************
  7735************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7736******************************************************************
  7737
  7738     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7739
  7740     MOVE SPACES                 TO PB-FATAL-FLAG
  7741                                    PB-FORCE-ER-CD
  7742                                    PB-WARN-ER-CD
  7743                                    PB-OUT-BAL-CD.
  7744
  7745     MOVE SPACE                  TO WS-IG-OVRD-AH
  7746                                    WS-IG-OVRD-LF
  7747                                    WS-IG-OVRD-AM
  7748                                    WS-IG-OVRD
  7749                                    WS-IG-OVRD-AH-PL
  7750                                    WS-IG-OVRD-LF-PL
  7751                                    WS-IG-OVRD-AH-BEN
  7752                                    WS-IG-OVRD-LF-BEN.
  7753
  7754******************************************************************
  7755*************       INITIALIZE COMMON ERRORS       ***************
  7756******************************************************************
  7757
  7758     MOVE +0                     TO PB-NO-OF-ERRORS.
  7759     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 143
* EL050.cbl
  7760
  7761******************************************************************
  7762
  7763     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7764     SET JULIAN-TO-BIN           TO TRUE.
  7765*    MOVE 5                      TO DC-OPTION-CODE.
  7766     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7767     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7768
  7769     MOVE ZERO                   TO  SUB4.
  7770
  7771 0040-INITIALIZE-GA-BILL-DT.
  7772
  7773     ADD +1                      TO  SUB4.
  7774
  7775     IF  SUB4 GREATER THAN +5
  7776         GO TO 0050-CHECK-CNTL-FOUND.
  7777
  7778     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7779         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7780
  7781     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7782
  7783 0050-CHECK-CNTL-FOUND.
  7784
  7785     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7786        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7787                                         WS-AH-REM-TERM-CALC
  7788                                         EC-CO-REM-TERM-CALC
  7789        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7790        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7791        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7792                                         WS-TOL-AH-CLAIM
  7793        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7794                                         WS-TOL-AH-PREM
  7795                                         EC-CO-TOL-PREM
  7796        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7797                                         WS-TOL-AH-REFUND
  7798                                         EC-CO-TOL-REFUND
  7799        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7800                                         WS-AH-REFUND-OVS-AMT
  7801                                         EC-CO-OVR-SHT-AMT
  7802        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7803                                         WS-TOL-AH-PREM-PCT
  7804                                         EC-CO-TOL-PREM-PCT
  7805        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7806                                         WS-TOL-AH-REFUND-PCT
  7807                                         EC-CO-TOL-REFUND-PCT
  7808        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7809                                         WS-AH-REFUND-OVS-PCT
  7810                                         EC-CO-OVR-SHT-PCT
  7811        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7812        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7813        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7814        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7815        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7816        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7817        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 144
* EL050.cbl
  7818        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7819        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7820        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7821        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7822        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7823                                         EC-CO-MONTH-END-DT
  7824        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7825          GO TO 0100-READ-ACCT.
  7826
  7827     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7828     MOVE SPACES                 TO CNTL-ACCESS.
  7829     MOVE '1'                    TO CNTL-REC-TYPE.
  7830     MOVE +0                     TO CNTL-SEQ-NO.
  7831
  7832     MOVE '1' TO RC-SW-1.
  7833     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7834     IF NOT CF-COMPANY-MASTER
  7835         MOVE ZEROS             TO WK-CO-TOL-PREM
  7836                                   WK-CO-TOL-CLAIM
  7837                                   WK-CO-TOL-REFUND
  7838                                   WK-REFUND-OVS-AMT
  7839                                   WK-REFUND-OVS-PCT
  7840                                   WK-CO-TOL-PREM-PCT
  7841                                   WK-CO-TOL-REFUND-PCT
  7842                                   WK-DEFAULT-APR
  7843                                   WK-CO-MAX-CAP
  7844        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7845                                   WK-CR-R78-METHOD
  7846                                   WK-CO-REF-REJECT-SW
  7847                                   WK-CO-PREM-REJECT-SW
  7848                                   WK-REM-TRM-CALC-OPTION
  7849                                   WK-BIRTH-DATE-INPUT
  7850                                   WK-JOINT-AGE-INPUT
  7851        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7852        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7853        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7854        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7855          GO TO 0099-COMPANY-NOT-FOUND.
  7856
  7857     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7858        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7859     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7860        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7861     IF CF-CO-TOL-CAP NOT NUMERIC
  7862        MOVE +0                    TO CF-CO-TOL-CAP.
  7863     IF CF-DEFAULT-APR NOT NUMERIC
  7864        MOVE +0                    TO CF-DEFAULT-APR.
  7865
  7866     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7867     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7868     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7869     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7870     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7871     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7872     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7873     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7874     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7875     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 145
* EL050.cbl
  7876     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7877     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7878
  7879     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7880          CF-CO-OVR-SHT-AMT > +0
  7881        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7882
  7883     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7884          CF-CO-OVR-SHT-PCT > +0
  7885        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7886
  7887     IF CF-VALID-REM-TRM-OPTION
  7888         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7889     ELSE
  7890         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7891
  7892     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7893     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7894     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7895     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7896
  7897     GO TO 0050-CHECK-CNTL-FOUND.
  7898
  7899 0099-COMPANY-NOT-FOUND.
  7900
  7901     MOVE ER-2616                TO WS-ERROR.
  7902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7903
  7904 0100-READ-ACCT.
  7905
  7906     MOVE SPACES                 TO DATE-RANGE-SW.
  7907
  7908     IF WK-ACCT-ADDR = ZEROS
  7909        GO TO 0102-ACCT-GETMAIN.
  7910
  7911     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7912     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7913     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7914
  7915     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7916        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7917        GO TO 0105-READ-ACCT
  7918     END-IF
  7919
  7920     IF PB-CARRIER NOT = SPACES
  7921        IF PB-CARRIER NOT = AM-VG-CARRIER
  7922           GO TO 0105-READ-ACCT.
  7923
  7924     IF PB-STATE NOT = SPACES
  7925        IF PB-STATE NOT = AM-VG-STATE
  7926           GO TO 0105-READ-ACCT.
  7927
  7928     IF PB-GROUPING NOT = SPACES
  7929        IF PB-GROUPING NOT = AM-VG-GROUPING
  7930           GO TO 0105-READ-ACCT.
  7931
  7932     MOVE 'X'                 TO DATE-RANGE-SW.
  7933
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 146
* EL050.cbl
  7934     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7935        MOVE 'X'                 TO DATE-RANGE-SW
  7936        GO TO 0105-READ-ACCT.
  7937
  7938     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7939        GO TO 0105-READ-ACCT.
  7940
  7941     GO TO 0180-ACCOUNT-FOUND.
  7942
  7943 0102-ACCT-GETMAIN.
  7944     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7945     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7946
  7947 0105-READ-ACCT.
  7948     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7949     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7950     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7951     MOVE PB-STATE               TO ACCT-STATE.
  7952     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7953     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7954
  7955     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7956
  7957     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7958
  7959 0110-FIND-ACCT-TOLERANCES-LOOP.
  7960     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7961
  7962     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7963        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7964        GO TO 0199-ACCT-NOT-FOUND
  7965     END-IF
  7966     IF PB-CARRIER NOT = SPACES
  7967        IF PB-CARRIER NOT = AM-VG-CARRIER
  7968           GO TO 0199-ACCT-NOT-FOUND.
  7969
  7970     IF PB-STATE NOT = SPACES
  7971        IF PB-STATE NOT = AM-VG-STATE
  7972           GO TO 0199-ACCT-NOT-FOUND.
  7973
  7974     IF PB-GROUPING NOT = SPACES
  7975        IF PB-GROUPING NOT = AM-VG-GROUPING
  7976           GO TO 0199-ACCT-NOT-FOUND.
  7977
  7978     MOVE 'X'                    TO DATE-RANGE-SW.
  7979
  7980     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7981        MOVE 'X'                 TO DATE-RANGE-SW
  7982        GO TO 0199-ACCT-NOT-FOUND.
  7983
  7984     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7985        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7986
  7987 0180-ACCOUNT-FOUND.
  7988     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7989     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7990     MOVE AM-STATE               TO PB-SV-STATE.
  7991     MOVE AM-GROUPING            TO PB-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 147
* EL050.cbl
  7992
  7993     IF AM-CANCEL-FEE  NOT NUMERIC
  7994        MOVE ZEROS TO AM-CANCEL-FEE.
  7995
  7996     IF AM-MAX-MON-BEN NOT NUMERIC
  7997        MOVE ZEROS TO AM-MAX-MON-BEN.
  7998
  7999     IF AM-MAX-TOT-BEN NOT NUMERIC
  8000        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8001
  8002     IF AM-CLP-TOL-PCT NOT NUMERIC
  8003        MOVE +0                  TO AM-CLP-TOL-PCT
  8004     END-IF
  8005     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8006        MOVE +0                  TO AM-SPP-LEASE-COMM
  8007     END-IF
  8008     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8009        MOVE ER-2611             TO   WS-ERROR
  8010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8011
  8012     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8013        MOVE ER-2621             TO   WS-ERROR
  8014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8015
  8016     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8017        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8018        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8019        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8020         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8021
  8022     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8023     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8024     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8025     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8026     IF AM-CLP-TOL-PCT NOT = ZEROS
  8027        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8028     END-IF
  8029     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8030        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8031     END-IF
  8032*    IF PB-COMPANY-ID = 'DCC'
  8033*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8034*                                   WS-ADMIN-FEES
  8035*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8036*          (SUB5 > +10)
  8037*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8038*             AND (AM-A-COM (SUB5) NUMERIC)
  8039*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8040*                + (AM-A-COM (SUB5) * 1000)
  8041*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8042*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8043*                + (AM-A-COM (SUB5) * 1000)
  8044*             END-IF
  8045*             IF AM-COM-TYP (SUB5) = 'N'
  8046*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8047*                + (AM-A-COM (SUB5) * 1000)
  8048*             END-IF
  8049*          END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 148
* EL050.cbl
  8050*       END-PERFORM
  8051*    END-IF
  8052     IF (PB-COMPANY-ID = 'DCC')
  8053        AND (PB-ISSUE)
  8054        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8055                                    ws-cred-union-fees
  8056        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8057           (SUB5 > +10)
  8058           MOVE +0 TO WS-WK-RATE
  8059           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8060                                   'O' OR 'S')
  8061              IF (AM-A-COM (SUB5) NUMERIC)
  8062                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8063                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8064              ELSE
  8065                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8066                 IF PB-ISSUE
  8067                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8068                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8069                 ELSE
  8070                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8071                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8072                 END-IF
  8073                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8074                 MOVE ZEROS             TO WS-SUB1
  8075                                           WS-COMMISSION
  8076                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8077                 MOVE '0530'               TO CTBL-SW
  8078                 MOVE ' '                  TO WS-CTBL-READ-SW
  8079                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8080                 IF FIRST-TIME-THROUGH
  8081                    MOVE 'AA'              TO CTBL-BEN-CODE
  8082                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8083                 END-IF
  8084                 IF CTBL-TABLE-FOUND
  8085                    IF PB-ISSUE
  8086                       COMPUTE WS-COMM-CK-AMT =
  8087                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8088                    ELSE
  8089                       COMPUTE WS-COMM-CK-AMT =
  8090                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8091                    END-IF
  8092                    PERFORM 8800-GET-COMP-RATE
  8093                              THRU 8800-EXIT
  8094                 END-IF
  8095              END-IF
  8096              if am-com-typ (sub5) = 'O' or 'S'
  8097                 compute ws-cred-union-fees rounded =
  8098                    ws-cred-union-fees +
  8099                    (pb-i-ah-premium-amt * ws-wk-rate)
  8100              else
  8101                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8102                + (WS-WK-RATE * 1000)
  8103              end-if
  8104           END-IF
  8105        END-PERFORM
  8106     END-IF
  8107     IF PB-COMPANY-ID EQUAL 'CRI'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 149
* EL050.cbl
  8108         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8109
  8110     IF PB-COMPANY-ID EQUAL 'NCL'
  8111         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8112     END-IF
  8113
  8114     GO TO 0200-READ-CERT.
  8115
  8116 0199-ACCT-NOT-FOUND.
  8117
  8118     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8119
  8120     IF DATE-RANGE-SW NOT = SPACES
  8121        MOVE ER-2601             TO WS-ERROR
  8122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8123     ELSE
  8124        MOVE ER-2619             TO WS-ERROR
  8125        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8126
  8127     GO TO 9990-RETURN.
  8128
  8129 0200-READ-CERT.
  8130
  8131     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8132     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8133     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8134     MOVE PB-SV-STATE            TO CERT-STATE.
  8135     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8136     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8137     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8138
  8139     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8140
  8141     IF CERT-WAS-NOT-FOUND
  8142        GO TO 0299-CERT-NOT-FOUND.
  8143
  8144     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8145        MOVE ER-2759             TO WS-ERROR
  8146        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8147        GO TO 0298-UNLOCK-RETURN.
  8148
  8149     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8150         MOVE ER-2758            TO WS-ERROR
  8151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8152         GO TO 0298-UNLOCK-RETURN.
  8153
  8154     IF PB-ISSUE
  8155        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8156           IF CERT-WAS-CREATED-FOR-CLAIM
  8157              NEXT SENTENCE
  8158            ELSE
  8159              MOVE ER-2626       TO WS-ERROR
  8160              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8161              GO TO 0298-UNLOCK-RETURN.
  8162
  8163     IF NOT PB-CANCELLATION
  8164        GO TO 0300-CONTINUE-EDIT.
  8165
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 150
* EL050.cbl
  8166     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8167     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8168     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8169     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8170     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8171     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8172
  8173     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8174     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8175     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8176     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8177     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8178     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8179     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8180     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8181     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8182
  8183     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8184     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8185     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8186     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8187     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8188     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8189     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8190
  8191     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8192     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8193
  8194     MOVE CM-CREDIT-INTERFACE-SW-1
  8195                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8196     MOVE CM-CREDIT-INTERFACE-SW-2
  8197                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8198
  8199     IF CM-O-B-COVERAGE
  8200         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8201
  8202     IF CM-LIVES NOT NUMERIC
  8203         MOVE ZERO                TO CM-LIVES.
  8204
  8205     IF CM-BILLED NOT NUMERIC
  8206         MOVE ZERO                TO CM-BILLED.
  8207
  8208     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8209         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8210         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8211         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8212         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8213         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8214         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8215         MOVE CM-LIVES             TO PB-CI-LIVES
  8216*The next line causes a problem with my change  I dont think it is
  8217*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8218
  8219     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8220     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8221     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8222     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8223     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 151
* EL050.cbl
  8224     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8225
  8226     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8227     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8228     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8229     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8230
  8231     IF CM-LIFE-COMM-PCT NUMERIC
  8232         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8233     ELSE
  8234         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8235
  8236     IF CM-AH-COMM-PCT NUMERIC
  8237         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8238     ELSE
  8239         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8240
  8241     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8242
  8243     IF CM-LOAN-APR       NOT NUMERIC
  8244           MOVE ZERO               TO CM-LOAN-APR.
  8245
  8246     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8247           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8248
  8249     IF CM-LOAN-TERM      NOT NUMERIC
  8250           MOVE ZERO               TO CM-LOAN-TERM.
  8251
  8252     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8253           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8254
  8255     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8256           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8257
  8258     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8259     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8260     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8261     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8262     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8263     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8264     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8265     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8266     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8267     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8268     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8269     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8270
  8271     IF CM-STATE = CM-SSN-STATE
  8272         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8273
  8274     IF CM-STATE NOT = CM-MEMB-STATE
  8275         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8276
  8277     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8278
  8279     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8280        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8281        IF CM-ADDL-CLP NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 152
* EL050.cbl
  8282           MOVE +0               TO CM-ADDL-CLP
  8283        END-IF
  8284        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8285        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8286           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8287        END-IF
  8288     END-IF
  8289     IF PB-COMPANY-ID = 'DCC'
  8290        MOVE +0                  TO WS-ADMIN-FEES
  8291                                    WS-CSO-ADMIN-FEE
  8292                                    WS-COMM-AND-MFEE
  8293                                    WS-1ST-YR-ALLOW
  8294        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8295           (SUB5 > +10)
  8296           MOVE +0 TO WS-WK-RATE
  8297           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8298              IF (AM-A-COM (SUB5) NUMERIC)
  8299                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8300                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8301              ELSE
  8302                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8303                 IF PB-ISSUE
  8304                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8305                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8306                 ELSE
  8307                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8308                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8309                 END-IF
  8310                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8311                 MOVE ZEROS             TO WS-SUB1
  8312                                           WS-COMMISSION
  8313                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8314                 MOVE '0530'               TO CTBL-SW
  8315                 MOVE ' '                  TO WS-CTBL-READ-SW
  8316                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8317                 IF FIRST-TIME-THROUGH
  8318                    MOVE 'AA'              TO CTBL-BEN-CODE
  8319                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8320                 END-IF
  8321                 IF CTBL-TABLE-FOUND
  8322                    IF PB-ISSUE
  8323                       COMPUTE WS-COMM-CK-AMT =
  8324                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8325                    ELSE
  8326                       COMPUTE WS-COMM-CK-AMT =
  8327                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8328                    END-IF
  8329                    PERFORM 8800-GET-COMP-RATE
  8330                              THRU 8800-EXIT
  8331                 END-IF
  8332              END-IF
  8333              IF AM-COM-TYP (SUB5) = 'I'
  8334                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8335                   + (WS-WK-RATE * 1000)
  8336              END-IF
  8337              IF AM-COM-TYP (SUB5) = 'N'
  8338                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8339                   + (WS-WK-RATE * 1000)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 153
* EL050.cbl
  8340              END-IF
  8341              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8342                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8343                   + (WS-WK-RATE * 1000)
  8344              END-IF
  8345              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8346                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8347                   + (WS-WK-RATE * 1000)
  8348              END-IF
  8349           END-IF
  8350        END-PERFORM
  8351     END-IF
  8352     GO TO 0300-CONTINUE-EDIT.
  8353
  8354 0298-UNLOCK-RETURN.
  8355      PERFORM 9250-UNLOCK-RETURN
  8356      GO TO 9990-RETURN.
  8357
  8358 0299-CERT-NOT-FOUND.
  8359
  8360     MOVE '1'                     TO CERT-STATUS-SW.
  8361
  8362     IF PB-COMPANY-ID = 'UCL'
  8363         IF WS-ERROR = ER-2799
  8364             GO TO 3000-CONTINUE-EDIT.
  8365
  8366     IF NOT PB-CANCELLATION
  8367         GO TO 0300-CONTINUE-EDIT.
  8368
  8369     MOVE ER-2726                  TO  WS-ERROR.
  8370     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8371     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8372     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8373                                    PB-CI-LF-TERM
  8374                                    PB-C-LF-REM-TERM
  8375                                    PB-CI-AH-TERM
  8376                                    PB-C-AH-REM-TERM
  8377                                    PB-CI-LF-BENEFIT-CD
  8378                                    PB-CI-LF-BENEFIT-AMT
  8379                                    PB-CI-LF-ALT-BENEFIT-AMT
  8380                                    PB-CI-LF-PREMIUM-AMT
  8381                                    PB-CI-LF-ALT-PREMIUM-AMT
  8382                                    PB-CI-AH-BENEFIT-CD
  8383                                    PB-CI-AH-BENEFIT-AMT
  8384                                    PB-CI-AH-PREMIUM-AMT
  8385                                    PB-CI-PAY-FREQUENCY
  8386                                    PB-CI-LOAN-APR
  8387                                    PB-CI-LOAN-TERM
  8388                                    PB-CI-LIFE-COMMISSION
  8389                                    PB-CI-AH-COMMISSION
  8390                                    PB-CI-CURR-SEQ
  8391                                    PB-CI-AH-CANCEL-AMT
  8392                                    PB-CI-LF-CANCEL-AMT
  8393                                    PB-CI-RATE-DEV-PCT-LF
  8394                                    PB-CI-RATE-DEV-PCT-AH
  8395                                    PB-CI-EXTENTION-DAYS
  8396                                    PB-CI-TERM-IN-DAYS
  8397                                    PB-CI-LIVES
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 154
* EL050.cbl
  8398                                    PB-CI-LF-CRIT-PER
  8399                                    PB-CI-AH-CRIT-PER
  8400                                    PB-CI-ADDL-CLP
  8401                                    PB-CI-DDF-IU-RATE-UP.
  8402
  8403     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8404                                    PB-CI-AH-SETTLEMENT-DT
  8405                                    PB-CI-DEATH-DT
  8406                                    PB-CI-LF-PRIOR-CANCEL-DT
  8407                                    PB-CI-AH-PRIOR-CANCEL-DT
  8408                                    PB-CI-ENTRY-DT
  8409                                    PB-CI-LF-EXPIRE-DT
  8410                                    PB-CI-AH-EXPIRE-DT
  8411                                    PB-CI-LOAN-1ST-PMT-DT.
  8412
  8413     IF ACCOUNT-MAST-FOUND
  8414        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8415        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8416
  8417
  8418 0300-CONTINUE-EDIT.
  8419
  8420     IF PB-ISSUE
  8421        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8422            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8423
  8424     IF PB-ISSUE
  8425        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8426            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8427
  8428     IF PB-ISSUE
  8429       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8430          (AM-NO-AH-ONLY)
  8431           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8432               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8433                   MOVE ER-2679 TO WS-ERROR
  8434                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8435
  8436     IF PB-ISSUE
  8437        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8438        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8439        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8440     ELSE
  8441        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8442        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8443        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8444
  8445     MOVE 'N'                    TO PLAN-MASTER-SW
  8446                                    PLAN-MASTER-LIFE-SW
  8447                                    FORM-MASTER-SW
  8448                                    WS-APP-CERT-SW.
  8449
  8450     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8451                                    WS-PL-TOL-LF-REFUND
  8452                                    WS-PL-REF-OVS-AMT
  8453                                    WS-PL-TOL-LF-PREM-PCT
  8454                                    WS-PL-TOL-LF-REFUND-PCT
  8455                                    WS-PL-REF-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 155
* EL050.cbl
  8456                                    WS-PL-TOL-LF-CLAIM.
  8457
  8458     IF PB-COMPANY-ID = 'NCL'
  8459       IF PB-ISSUE
  8460         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8461             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8462             IF FORM-MASTER-FOUND
  8463                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8464
  8465     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8466        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8467
  8468********************** MON CODE **********************
  8469     IF PB-COMPANY-ID = 'MON'
  8470     IF PB-ISSUE
  8471     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8472        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8473             PB-I-LOAN-APR = ZERO)
  8474               MOVE 14.0         TO PB-I-LOAN-APR.
  8475******************************************************
  8476
  8477     IF PB-COMPANY-ID = 'NCL'
  8478       IF PB-ISSUE
  8479           IF FORM-MASTER-FOUND
  8480             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8481                AM-DISMBR-COVERAGE
  8482                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8483                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8484                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8485                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8486                                           PB-I-LIFE-BENEFIT-CD.
  8487
  8488     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8489
  8490     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8491         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8492         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8493         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8494         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8495         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8496           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8497             GO TO 0301-LIFE-BENEFIT-SEARCH
  8498         ELSE
  8499             NEXT SENTENCE
  8500     ELSE
  8501         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8502
  8503     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8504     MOVE '4'                    TO CNTL-REC-TYPE.
  8505     MOVE +0                     TO CNTL-SEQ-NO.
  8506     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8507
  8508     MOVE '1' TO RC-SW-2.
  8509     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8510
  8511     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8512        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8513         GO TO 0305-BENEFIT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 156
* EL050.cbl
  8514
  8515     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8516
  8517 0301-LIFE-BENEFIT-SEARCH.
  8518
  8519     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8520
  8521     IF NO-BENEFIT-FOUND
  8522        GO TO 0305-BENEFIT-NOT-FOUND.
  8523
  8524     IF WS-BEN-CD = '99'
  8525        GO TO 0305-BENEFIT-NOT-FOUND.
  8526
  8527     IF PB-COMPANY-ID = 'NCL'
  8528         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8529             GO TO 0304-LIFE-BENEFIT-FOUND.
  8530
  8531     MOVE +1                     TO SUB5.
  8532     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8533
  8534* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8535* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8536     IF PB-COMPANY-ID = 'DMD'
  8537         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8538
  8539 0302-EDIT-ACCT-LF-BENEFITS.
  8540
  8541     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8542        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8543           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8544                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8545           GO TO 03XX-GET-LIFE-ERPLAN.
  8546
  8547     IF SUB5 LESS THAN +20
  8548        ADD +1                   TO SUB5
  8549        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8550
  8551     MOVE +1                     TO SUB5.
  8552
  8553     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8554        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8555
  8556 0303-EDIT-DMD-EXTRA-BENEFITS.
  8557
  8558     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8559        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8560           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8561                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8562           GO TO 03XX-GET-LIFE-ERPLAN.
  8563
  8564     IF SUB5 LESS THAN +30
  8565        ADD +1                   TO SUB5
  8566        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8567
  8568     MOVE +1                     TO SUB5.
  8569
  8570 03XX-EDIT-FOR-NINETY-LF.
  8571
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 157
* EL050.cbl
  8572***************************************************************
  8573*                                                             *
  8574*    NINETY BENEFIT PLAN TYPES:                               *
  8575*                                                             *
  8576*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8577*      92 = ALL GROUP REDUCING BENEFITS                       *
  8578*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8579*      94 = ALL GROUP LEVEL BENEFITS                          *
  8580*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8581*           BENEFIT CONTROLS.                                 *
  8582*      99 = ALL BENEFITS                                      *
  8583*                                                             *
  8584***************************************************************
  8585
  8586     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8587                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8588
  8589     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8590       AND
  8591        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8592        GO TO 03XX-GET-LIFE-ERPLAN.
  8593
  8594     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8595       AND
  8596        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8597        IF CF-REDUCING (SUB3)
  8598           IF (PB-I-INDV-GRP-OVRD = 'I')
  8599              OR
  8600           ((AM-IG = '1') AND
  8601           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8602              OR
  8603           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8604           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8605           (AM-IG NOT = '2'))
  8606              GO TO 03XX-GET-LIFE-ERPLAN.
  8607
  8608     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8609       AND
  8610        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8611        IF CF-REDUCING (SUB3)
  8612           IF (PB-I-INDV-GRP-OVRD = 'G')
  8613              OR
  8614           ((AM-IG = '2') AND
  8615           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8616              OR
  8617           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8618           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8619           (AM-IG NOT = '1'))
  8620              GO TO 03XX-GET-LIFE-ERPLAN.
  8621
  8622     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8623       AND
  8624        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8625        IF CF-LEVEL    (SUB3)
  8626           IF (PB-I-INDV-GRP-OVRD = 'I')
  8627              OR
  8628           ((AM-IG = '1') AND
  8629           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 158
* EL050.cbl
  8630              OR
  8631           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8632           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8633            (AM-IG NOT = '2'))
  8634              GO TO 03XX-GET-LIFE-ERPLAN.
  8635
  8636     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8637       AND
  8638        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8639        IF CF-LEVEL    (SUB3)
  8640           IF (PB-I-INDV-GRP-OVRD = 'G')
  8641              OR
  8642           ((AM-IG = '2') AND
  8643           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8644              OR
  8645           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8646           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8647           (AM-IG NOT = '1'))
  8648              GO TO 03XX-GET-LIFE-ERPLAN.
  8649
  8650     IF SUB5 LESS THAN +20
  8651        ADD +1                   TO SUB5
  8652        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8653
  8654     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8655
  8656     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8657        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8658
  8659     MOVE +1                     TO SUB5.
  8660
  8661 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8662
  8663     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8664                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8665
  8666     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8667       AND
  8668        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8669        GO TO 03XX-GET-LIFE-ERPLAN.
  8670
  8671     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8672       AND
  8673        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8674        IF CF-REDUCING (SUB3)
  8675           IF (PB-I-INDV-GRP-OVRD = 'I')
  8676              OR
  8677           ((AM-IG = '1') AND
  8678           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8679              OR
  8680           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8681           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8682           (AM-IG NOT = '2'))
  8683              GO TO 03XX-GET-LIFE-ERPLAN.
  8684
  8685     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8686       AND
  8687        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 159
* EL050.cbl
  8688        IF CF-REDUCING (SUB3)
  8689           IF (PB-I-INDV-GRP-OVRD = 'G')
  8690              OR
  8691           ((AM-IG = '2') AND
  8692           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8693              OR
  8694           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8695           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8696           (AM-IG NOT = '1'))
  8697              GO TO 03XX-GET-LIFE-ERPLAN.
  8698
  8699     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8700       AND
  8701        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8702        IF CF-LEVEL    (SUB3)
  8703           IF (PB-I-INDV-GRP-OVRD = 'I')
  8704              OR
  8705           ((AM-IG = '1') AND
  8706           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8707              OR
  8708           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8709           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8710            (AM-IG NOT = '2'))
  8711              GO TO 03XX-GET-LIFE-ERPLAN.
  8712
  8713     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8714       AND
  8715        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8716        IF CF-LEVEL    (SUB3)
  8717           IF (PB-I-INDV-GRP-OVRD = 'G')
  8718              OR
  8719           ((AM-IG = '2') AND
  8720           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8721              OR
  8722           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8723           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8724           (AM-IG NOT = '1'))
  8725              GO TO 03XX-GET-LIFE-ERPLAN.
  8726
  8727     IF SUB5 LESS THAN +30
  8728        ADD +1                   TO SUB5
  8729        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8730
  8731     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8732
  8733 03XX-EDIT-FOR-NINETY-LF-CONT.
  8734
  8735     MOVE +99                    TO SUB5.
  8736
  8737     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8738        IF PB-ISSUE
  8739           MOVE ER-1924          TO  WS-ERROR
  8740           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8741
  8742     GO TO 0304-LIFE-BENEFIT-FOUND.
  8743
  8744 03XX-GET-LIFE-ERPLAN.
  8745
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 160
* EL050.cbl
  8746     IF WK-PLAN-ADDR EQUAL +0
  8747        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8748
  8749     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8750     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8751     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8752     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8753     MOVE 'Y'                    TO PLAN-MASTER-SW
  8754                                    PLAN-MASTER-LIFE-SW.
  8755     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8756
  8757 03XX-ERPLAN-LIFE-GETMAIN.
  8758
  8759     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8760     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8761
  8762 03XX-ERPLAN-LIFE-READ.
  8763
  8764     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8765     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8766     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8767     MOVE PB-SV-STATE            TO PLAN-STATE.
  8768     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8769     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8770     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8771     MOVE WS-SAVE-BENEFIT-REVISION
  8772                                 TO PLAN-REVISION-NO.
  8773
  8774     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8775     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8776
  8777     IF PB-COMPANY-ID = 'NCL'
  8778       IF NOT LF-PLAN-MASTER-FOUND
  8779         IF NOT PB-POLICY-IS-DECLINED  AND
  8780            NOT PB-POLICY-IS-VOIDED
  8781             MOVE  ER-1921         TO  WS-ERROR
  8782             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8783             GO TO 0304-LIFE-BENEFIT-FOUND.
  8784
  8785     IF NOT LF-PLAN-MASTER-FOUND
  8786        GO TO 0304-LIFE-BENEFIT-FOUND.
  8787
  8788 XXXX-CHECK-LF-PLAN-KEY.
  8789
  8790     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8791        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8792        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8793        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8794        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8795        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8796        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8797        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8798        MOVE 'N'                 TO PLAN-MASTER-SW
  8799          GO TO 03XX-ERPLAN-LIFE-READ.
  8800
  8801     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8802
  8803     IF  PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 161
* EL050.cbl
  8804         GO TO  0303-LF-ACCT-BEN-FOUND.
  8805
  8806     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8807        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8808           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8809           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8810              MOVE ER-2644             TO WS-ERROR
  8811              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8812           ELSE
  8813              NEXT SENTENCE
  8814        ELSE
  8815           IF PB-COMPANY-ID NOT = 'NCL'
  8816              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8817                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8818
  8819 0303-LF-ACCT-BEN-FOUND.
  8820
  8821     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8822
  8823     IF PL-DEV-CODE NOT = SPACES
  8824        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8825
  8826     IF PL-DEV-PCT NUMERIC AND
  8827        PL-DEV-PCT NOT = ZEROS
  8828        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8829
  8830     IF PL-TOL-PREM-AMT GREATER THAN +0
  8831        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8832
  8833     IF PL-TOL-REF-AMT GREATER THAN +0
  8834        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8835
  8836     IF PL-TOL-PREM-PCT GREATER THAN +0
  8837        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8838
  8839     IF PL-TOL-REF-PCT GREATER THAN +0
  8840        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8841
  8842     IF PL-TOL-CLM-AMT GREATER THAN +0
  8843        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8844
  8845     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8846                          PL-OVER-SHORT-AMT > +0
  8847        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8848
  8849     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8850                          PL-OVER-SHORT-PCT > +0
  8851        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8852
  8853     IF PL-SALES-TAX NUMERIC AND
  8854                          PL-SALES-TAX > +0
  8855         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8856
  8857     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8858        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8859                                    WS-IG-OVRD-AM.
  8860
  8861 0304-LIFE-BENEFIT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 162
* EL050.cbl
  8862
  8863     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8864
  8865     IF PB-ISSUE
  8866        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8867     ELSE
  8868        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8869
  8870     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8871     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8872     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8873     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8874     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8875                                         WS-LF-REFUND-CALC.
  8876     if (ws-lf-earnings-calc = '5')
  8877        and (pb-i-loan-apr = zeros)
  8878        and (benefit-code-chg)
  8879        move +99.9999 to pb-i-loan-apr
  8880     end-if
  8881
  8882     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8883        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8884
  8885     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8886        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8887     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8888
  8889     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8890     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8891     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8892     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8893     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8894     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8895
  8896     IF PB-COMPANY-ID = 'NCL'  AND
  8897        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8898         NEXT SENTENCE
  8899     ELSE
  8900         IF SUB5 NOT GREATER THAN +20
  8901            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8902               MOVE WS-SAVE-BENEFIT-REM-TERM
  8903                                      TO WS-AM-LF-BENE-REM-TERM
  8904                                         EC-BR-LF-REM-TERM-CALC.
  8905
  8906     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8907     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8908
  8909     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8910
  8911 0305-BENEFIT-NOT-FOUND.
  8912
  8913     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8914     MOVE ER-2604                TO WS-ERROR.
  8915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8916
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 163
* EL050.cbl
  8918
  8919 0310-FIND-AH-BENEFIT-RECORD.
  8920
  8921     MOVE 'N'                    TO PLAN-MASTER-SW
  8922                                    PLAN-MASTER-AH-SW.
  8923
  8924     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8925                                    WS-PL-TOL-AH-REFUND
  8926                                    WS-AH-PL-REF-OVS-AMT
  8927                                    WS-PL-TOL-AH-PREM-PCT
  8928                                    WS-PL-TOL-AH-REFUND-PCT
  8929                                    WS-AH-PL-REF-OVS-PCT
  8930                                    WS-PL-TOL-AH-CLAIM.
  8931     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8932
  8933
  8934     if pb-issue
  8935        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8936           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8937        end-if
  8938        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8939           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8940           GO TO 0399-BENEFIT-NOT-FOUND
  8941        end-if
  8942     end-if
  8943
  8944     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8945        GO TO 0400-FIND-CARRIER.
  8946
  8947     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8948
  8949     IF WK-AH-BEN-ADDR NOT = ZEROS
  8950         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8951         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8952         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8953         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8954           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8955             GO TO 0311-AH-BENEFIT-SEARCH
  8956         ELSE
  8957             NEXT SENTENCE
  8958     ELSE
  8959         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8960
  8961     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8962     MOVE '5'                    TO CNTL-REC-TYPE.
  8963     MOVE +0                     TO CNTL-SEQ-NO.
  8964     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8965
  8966     MOVE '2' TO RC-SW-2.
  8967     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8968
  8969     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8970        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8971          GO TO 0399-BENEFIT-NOT-FOUND.
  8972
  8973     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8974
  8975 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 164
* EL050.cbl
  8976
  8977     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8978
  8979     IF NO-BENEFIT-FOUND
  8980         GO TO 0399-BENEFIT-NOT-FOUND.
  8981
  8982     IF WS-BEN-CD = '99'
  8983        GO TO 0399-BENEFIT-NOT-FOUND.
  8984
  8985     IF PB-COMPANY-ID  =  'NCL'
  8986         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8987             GO TO 0314-A-H-BENEFIT-FOUND.
  8988
  8989     MOVE +1                     TO SUB5.
  8990     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8991
  8992* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8993* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8994     IF PB-COMPANY-ID = 'DMD'
  8995         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8996
  8997 0312-EDIT-ACCT-AH-BENEFITS.
  8998
  8999     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9000        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9001           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9002                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9003           GO TO 03XX-GET-AH-ERPLAN.
  9004
  9005     IF SUB5 LESS THAN +20
  9006        ADD +1                   TO SUB5
  9007        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9008
  9009     MOVE +1                     TO SUB5.
  9010
  9011     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9012        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9013
  9014 0313-EDIT-DMD-EXTRA-BENEFITS.
  9015
  9016     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9017        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9018           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9019                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9020           GO TO 03XX-GET-AH-ERPLAN.
  9021
  9022     IF SUB5 LESS THAN +30
  9023        ADD +1                   TO SUB5
  9024        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9025
  9026     MOVE +1                     TO SUB5.
  9027
  9028 03XX-EDIT-FOR-NINETY-AH.
  9029
  9030***************************************************************
  9031*                                                             *
  9032*    NINETY BENEFIT PLAN TYPES:                               *
  9033*                                                             *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 165
* EL050.cbl
  9034*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9035*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9036*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9037*           BENEFIT CONTROLS.                                 *
  9038*      99 = ALL BENEFITS.                                     *
  9039*                                                             *
  9040***************************************************************
  9041
  9042     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9043                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9044
  9045     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9046       AND
  9047        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9048        GO TO 03XX-GET-AH-ERPLAN.
  9049
  9050     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9051       AND
  9052        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9053           IF (PB-I-INDV-GRP-OVRD = 'I')
  9054              OR
  9055           ((AM-IG = '1') AND
  9056           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9057              OR
  9058           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9059           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9060           (AM-IG NOT = '2'))
  9061              GO TO 03XX-GET-AH-ERPLAN.
  9062
  9063     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9064       AND
  9065        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9066           IF (PB-I-INDV-GRP-OVRD = 'G')
  9067              OR
  9068           ((AM-IG = '2') AND
  9069           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9070              OR
  9071           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9072           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9073           (AM-IG NOT = '1'))
  9074              GO TO 03XX-GET-AH-ERPLAN.
  9075
  9076     IF SUB5 LESS THAN +20
  9077        ADD +1                   TO SUB5
  9078        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9079
  9080     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9081        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9082
  9083     MOVE +1                    TO SUB5.
  9084
  9085 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9086
  9087     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9088                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9089
  9090     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9091       AND
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 166
* EL050.cbl
  9092        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9093        GO TO 03XX-GET-AH-ERPLAN.
  9094
  9095     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9096       AND
  9097        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9098           IF (PB-I-INDV-GRP-OVRD = 'I')
  9099              OR
  9100           ((AM-IG = '1') AND
  9101           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9102              OR
  9103           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9104           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9105           (AM-IG NOT = '2'))
  9106              GO TO 03XX-GET-AH-ERPLAN.
  9107
  9108     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9109       AND
  9110        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9111           IF (PB-I-INDV-GRP-OVRD = 'G')
  9112              OR
  9113           ((AM-IG = '2') AND
  9114           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9115              OR
  9116           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9117           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9118           (AM-IG NOT = '1'))
  9119              GO TO 03XX-GET-AH-ERPLAN.
  9120
  9121     IF SUB5 LESS THAN +30
  9122        ADD +1                   TO SUB5
  9123        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9124
  9125 03XX-EDIT-FOR-NINETY-AH-CONT.
  9126
  9127     MOVE +99                    TO SUB5.
  9128
  9129     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9130
  9131     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9132        IF PB-ISSUE
  9133           MOVE ER-1925          TO  WS-ERROR
  9134           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9135
  9136     GO TO 0314-A-H-BENEFIT-FOUND.
  9137
  9138 03XX-GET-AH-ERPLAN.
  9139
  9140     IF WK-PLAN-ADDR EQUAL +0
  9141         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9142
  9143     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9144     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9145     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9146     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9147     MOVE 'Y'                    TO PLAN-MASTER-SW
  9148                                    PLAN-MASTER-AH-SW.
  9149*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 167
* EL050.cbl
  9150     GO TO 03XX-ERPLAN-AH-READ.
  9151
  9152 03XX-ERPLAN-AH-GETMAIN.
  9153
  9154     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9155     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9156
  9157 03XX-ERPLAN-AH-READ.
  9158
  9159     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9160     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9161     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9162     MOVE PB-SV-STATE            TO PLAN-STATE.
  9163     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9164     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9165     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9166     MOVE WS-SAVE-BENEFIT-REVISION
  9167                                 TO PLAN-REVISION-NO.
  9168
  9169     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9170     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9171
  9172     IF PB-COMPANY-ID = 'NCL'
  9173       IF NOT AH-PLAN-MASTER-FOUND
  9174         IF NOT PB-POLICY-IS-DECLINED  AND
  9175            NOT PB-POLICY-IS-VOIDED
  9176             MOVE  ER-1922         TO  WS-ERROR
  9177             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9178             GO TO 0314-A-H-BENEFIT-FOUND.
  9179
  9180     IF NOT AH-PLAN-MASTER-FOUND
  9181        GO TO 0314-A-H-BENEFIT-FOUND.
  9182
  9183 XXXX-CHECK-AH-PLAN-KEY.
  9184
  9185     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9186        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9187        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9188        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9189        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9190        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9191        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9192        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9193        MOVE 'N'                 TO PLAN-MASTER-SW
  9194          GO TO 03XX-ERPLAN-AH-READ.
  9195
  9196     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9197
  9198     IF  PB-CANCELLATION
  9199         GO TO  0313-AH-ACCT-BEN-FOUND.
  9200
  9201     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9202       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9203          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9204          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9205             MOVE ER-2644             TO WS-ERROR
  9206             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9207          ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 168
* EL050.cbl
  9208             NEXT SENTENCE
  9209       ELSE
  9210          IF PB-COMPANY-ID NOT = 'NCL'
  9211             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9212                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9213
  9214 0313-AH-ACCT-BEN-FOUND.
  9215
  9216     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9217
  9218     IF PL-DEV-CODE NOT = SPACES
  9219        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9220
  9221     IF PL-DEV-PCT NUMERIC AND
  9222        PL-DEV-PCT NOT = ZEROS
  9223        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9224
  9225     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9226        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9227
  9228     IF PL-TOL-REF-AMT NOT EQUAL +0
  9229        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9230
  9231     IF PL-TOL-PREM-PCT GREATER THAN +0
  9232        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9233
  9234     IF PL-TOL-REF-PCT GREATER THAN +0
  9235        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9236
  9237     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9238        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9239
  9240     IF PL-OVER-SHORT-AMT NUMERIC AND
  9241                          PL-OVER-SHORT-AMT > +0
  9242        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9243
  9244     IF PL-OVER-SHORT-PCT NUMERIC AND
  9245                          PL-OVER-SHORT-PCT > +0
  9246        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9247
  9248     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9249        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9250        IF WS-IG-OVRD-AM EQUAL SPACES
  9251            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9252
  9253 0314-A-H-BENEFIT-FOUND.
  9254
  9255     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9256
  9257     IF PB-ISSUE
  9258        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9259       ELSE
  9260        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9261
  9262     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9263     if cf-maximum-benefits (sub3) numeric
  9264        move cf-maximum-benefits (sub3)
  9265                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 169
* EL050.cbl
  9266     else
  9267        move zeros               to ws-ah-max-bens
  9268     end-if
  9269     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9270     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9271     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9272                                         WS-AH-REFUND-CALC.
  9273
  9274     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9275        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9276
  9277     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9278        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9279     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9280
  9281     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9282     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9283     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9284     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9285     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9286     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9287
  9288     IF PB-COMPANY-ID = 'NCL'  AND
  9289        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9290         NEXT SENTENCE
  9291     ELSE
  9292         IF SUB5 NOT GREATER THAN +20
  9293            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9294                MOVE WS-SAVE-BENEFIT-REM-TERM
  9295                                      TO WS-AM-AH-BENE-REM-TERM
  9296                                         EC-BR-AH-REM-TERM-CALC.
  9297
  9298     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9299     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9300
  9301     GO TO 0400-FIND-CARRIER.
  9302
  9303 0399-BENEFIT-NOT-FOUND.
  9304
  9305     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9306     MOVE ER-2605                TO WS-ERROR.
  9307     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9308
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 170
* EL050.cbl
  9310
  9311 0400-FIND-CARRIER.
  9312
  9313     MOVE PB-SV-CARRIER          TO WS-CARR.
  9314
  9315     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9316     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9317     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9318     MOVE '6'                    TO CNTL-REC-TYPE.
  9319
  9320*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9321     MOVE SPACE                  TO WS-DMD-RATING-SW
  9322                                    EC-BR-DMD-RATING-SW.
  9323
  9324     MOVE '2'                    TO RC-SW-1.
  9325     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9326
  9327     IF NOT CF-CARRIER-MASTER
  9328        GO TO 0400-CARRIER-NOT-FOUND.
  9329
  9330 0400-BUILD-CARR-TOL.
  9331
  9332     IF CF-CR-TOL-PREM NUMERIC AND
  9333        CF-CR-TOL-PREM GREATER THAN +0
  9334        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9335                                    WS-TOL-AH-PREM.
  9336
  9337     IF CF-CR-TOL-REFUND NUMERIC AND
  9338        CF-CR-TOL-REFUND GREATER THAN +0
  9339        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9340                                    WS-TOL-AH-REFUND.
  9341
  9342     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9343        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9344        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9345                                    WS-AH-REFUND-OVS-AMT.
  9346
  9347     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9348        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9349        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9350                                    WS-AH-REFUND-OVS-PCT.
  9351
  9352     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9353        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9354        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9355                                    WS-TOL-AH-PREM-PCT.
  9356
  9357     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9358        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9359        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9360                                     WS-TOL-AH-REFUND-PCT.
  9361
  9362     IF CF-COMPANY-ID EQUAL 'DMD'
  9363         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9364                                    EC-BR-DMD-RATING-SW.
  9365
  9366     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9367     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 171
* EL050.cbl
  9368        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9369     END-IF
  9370     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9371        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9372     END-IF
  9373     IF WS-TOL-CLP-PCT = ZEROS
  9374        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9375     END-IF
  9376
  9377     IF WS-SPP-LEASE-COMM = ZEROS
  9378        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9379     END-IF
  9380     GO TO 0400-FIND-ERPDEF.
  9381
  9382 0400-CARRIER-NOT-FOUND.
  9383
  9384     MOVE ER-2602                TO WS-ERROR.
  9385     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9386
  9387 0400-FIND-ERPDEF.
  9388     IF PB-COMPANY-ID = 'DCC'
  9389        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9390        CONTINUE
  9391     ELSE
  9392        GO TO 0400-FIND-ERCOMP
  9393     END-IF
  9394     MOVE ' '                    TO PDEF-MASTER-SW
  9395     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9396     MOVE PB-STATE               TO ERPDEF-STATE
  9397     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9398     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9399     IF PB-ISSUE
  9400        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9401     ELSE
  9402        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9403     END-IF
  9404     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9405     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9406     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9407     IF PDEF-MASTER-FOUND
  9408        MOVE 'N'                 TO PDEF-MASTER-SW
  9409        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9410        IF PDEF-MASTER-FOUND
  9411           IF (ERPDEF-KEY-SAVE (1:16) =
  9412                        PD-CONTROL-PRIMARY (1:16))
  9413              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9414              CONTINUE
  9415           ELSE
  9416              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9417              IF (ERPDEF-KEY-SAVE (1:16) =
  9418                        PD-CONTROL-PRIMARY (1:16))
  9419                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9420                 CONTINUE
  9421              ELSE
  9422                 MOVE 'N'        TO PDEF-MASTER-SW
  9423              END-IF
  9424           END-IF
  9425        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 172
* EL050.cbl
  9426        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9427     END-IF
  9428     IF PDEF-MASTER-FOUND
  9429        IF PD-TRUNCATED = 'Y'
  9430           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9431        END-IF
  9432     END-IF
  9433     .
  9434 0400-FIND-ERCOMP.
  9435     IF PB-COMPANY-ID = 'DCC'
  9436        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9437           (WS-SUB1 > +10)
  9438           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9439                 OR 'A' OR 'N'
  9440              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9441              MOVE PB-CARRIER    TO COMP-CARRIER
  9442              MOVE PB-GROUPING   TO COMP-GROUPING
  9443              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9444              MOVE AM-AGT (WS-SUB1)
  9445                                 TO COMP-FIN-RESP
  9446              MOVE 'G'           TO COMP-TYPE
  9447              PERFORM 8582-READ-COMPENSATION-MASTER
  9448                                 THRU 8582-EXIT
  9449              IF COMP-MASTER-FOUND
  9450                 IF CO-GA-INACTIVE
  9451                    MOVE ER-2763 TO WS-ERROR
  9452                    PERFORM 9900-ERROR-FORMAT
  9453                                 THRU 9900-EXIT
  9454                    MOVE +11     TO WS-SUB1
  9455                 END-IF
  9456                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9457                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9458                    MOVE ER-2788 TO WS-ERROR
  9459                    PERFORM 9900-ERROR-FORMAT
  9460                                 THRU 9900-EXIT
  9461                    MOVE +11     TO WS-SUB1
  9462                 END-IF
  9463              END-IF
  9464           END-IF
  9465        END-PERFORM
  9466     END-IF
  9467     IF PB-COMPANY-ID = 'DCC'
  9468        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9469           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9470                                    WS-CLP-STATE
  9471        ELSE
  9472           MOVE SPACES           TO PB-I-CLP-STATE
  9473                                    WS-CLP-STATE
  9474        END-IF
  9475     END-IF
  9476
  9477     IF (PB-COMPANY-ID = 'DCC')
  9478        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9479        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9480        CONTINUE
  9481     ELSE
  9482        GO TO 0400-FIND-STATE-RECORD
  9483     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 173
* EL050.cbl
  9484     MOVE SPACES                 TO WS-CLP-STATE
  9485     MOVE +0                     TO WS-BANK-FEE
  9486                                    WS-BANK-LFEE
  9487                                    WS-BANK-NOCHRGB
  9488
  9489     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9490     IF (PB-ISSUE)
  9491        AND (PB-I-BANK-NUMBER NOT =
  9492            SPACES AND ZEROS AND LOW-VALUES)
  9493        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9494     ELSE
  9495        IF (PB-CANCELLATION)
  9496           AND (PB-CI-BANK-NUMBER NOT =
  9497                SPACES AND ZEROS AND LOW-VALUES)
  9498           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9499        END-IF
  9500     END-IF
  9501     IF COMP-FIN-RESP NOT = LOW-VALUES
  9502        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9503        MOVE PB-CARRIER          TO COMP-CARRIER
  9504        MOVE PB-GROUPING         TO COMP-GROUPING
  9505        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9506        MOVE 'B'                 TO COMP-TYPE
  9507        PERFORM 8582-READ-COMPENSATION-MASTER
  9508                                 THRU 8582-EXIT
  9509        IF COMP-MASTER-FOUND
  9510           IF CO-MAX-BANK-FEE NOT NUMERIC
  9511              MOVE +0            TO CO-MAX-BANK-FEE
  9512           END-IF
  9513           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9514              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9515           END-IF
  9516           IF CO-GA-INACTIVE
  9517              MOVE ER-2763       TO WS-ERROR
  9518              PERFORM 9900-ERROR-FORMAT
  9519                                 THRU 9900-EXIT
  9520           END-IF
  9521           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9522              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9523              MOVE ER-2788 TO WS-ERROR
  9524              PERFORM 9900-ERROR-FORMAT
  9525                                 THRU 9900-EXIT
  9526              MOVE +11     TO WS-SUB1
  9527           END-IF
  9528           IF WS-AH-BEN-CATEGORY = 'G'
  9529              MOVE CO-MAX-BANK-FEE
  9530                                 TO WS-BANK-FEE
  9531                                    PB-I-BANK-FEE
  9532           ELSE
  9533              MOVE CO-MAX-BANK-FEE-LEASE
  9534                                 TO WS-BANK-LFEE
  9535                                    PB-I-BANK-FEE
  9536           END-IF
  9537           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9538              AND (WS-AH-REFUND-CALC = 'G'))
  9539                        OR
  9540              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9541              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 174
* EL050.cbl
  9542              CONTINUE
  9543           ELSE
  9544              MOVE ER-2789 TO WS-ERROR
  9545              PERFORM 9900-ERROR-FORMAT
  9546                                 THRU 9900-EXIT
  9547           END-IF
  9548           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9549                                    PB-I-CLP-STATE
  9550           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9551           MOVE CO-CARRIER       TO BXRF-CARRIER
  9552           MOVE CO-GROUPING      TO BXRF-GROUPING
  9553           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9554           MOVE BXRF-MAX-REC-LENGTH
  9555                                 TO BXRF-REC-LENGTH
  9556           PERFORM 8584-READ-BANK-CROSS-REF
  9557                                 THRU 8584-EXIT
  9558           IF BXRF-MASTER-FOUND
  9559              MOVE ' '           TO BANK-ACCT-SW
  9560              MOVE BK-BANK-POINTER-CNT
  9561                                 TO BK-BANK-POINTER-CNT
  9562              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9563                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9564                 OR (BANK-ACCT-FOUND)
  9565                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9566                    AND (BK-AM-EXP-DT (WS-SUB1)
  9567                                 > PB-CERT-EFF-DT)
  9568                    AND (BK-AM-EFF-DT (WS-SUB1)
  9569                                 NOT > PB-CERT-EFF-DT)
  9570                    SET BANK-ACCT-FOUND TO TRUE
  9571                 END-IF
  9572              END-PERFORM
  9573              IF NOT BANK-ACCT-FOUND
  9574                 MOVE ZEROS      TO WS-BANK-FEE
  9575                                    WS-BANK-LFEE
  9576                 MOVE ER-2869    TO WS-ERROR
  9577                 PERFORM 9900-ERROR-FORMAT
  9578                                 THRU 9900-EXIT
  9579              ELSE
  9580                 PERFORM 5000-PROCESS-REPS
  9581                                 THRU 5000-EXIT
  9582                 IF AGENT-MASTER-FOUND
  9583                    MOVE +0      TO WS-BANK-FEE
  9584                                    WS-BANK-LFEE
  9585*                   MOVE AG-SPP-FEES (1)
  9586*                                TO PB-I-BANK-FEE
  9587*                                   WS-BANK-FEE
  9588                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9589                       (WS-SUB1 > +10)
  9590                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9591                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9592                       END-IF
  9593                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9594                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9595                       END-IF
  9596                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9597                          AG-SPP-FEES (WS-SUB1)
  9598                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9599                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 175
* EL050.cbl
  9600                    END-PERFORM
  9601                    IF WS-AH-BEN-CATEGORY = 'G'
  9602                       MOVE WS-BANK-FEE
  9603                                 TO PB-I-BANK-FEE
  9604                    ELSE
  9605                       MOVE WS-BANK-LFEE
  9606                                 TO PB-I-BANK-FEE
  9607                    END-IF
  9608                 END-IF
  9609              END-IF
  9610           END-IF
  9611        ELSE
  9612           MOVE ER-2879          TO WS-ERROR
  9613           PERFORM 9900-ERROR-FORMAT
  9614                                 THRU 9900-EXIT
  9615        END-IF
  9616     ELSE
  9617        MOVE ER-2879             TO WS-ERROR
  9618        PERFORM 9900-ERROR-FORMAT
  9619                                 THRU 9900-EXIT
  9620     END-IF
  9621     IF WS-AH-BEN-CATEGORY = 'G'
  9622        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9623        + WS-BANK-FEE
  9624     ELSE
  9625        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9626        + WS-BANK-LFEE
  9627     END-IF
  9628     .
  9629 0400-FIND-STATE-RECORD.
  9630
  9631     IF WK-STATE-ADDR NOT = ZEROS
  9632         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9633         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9634         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9635         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9636         IF PB-SV-STATE = CF-STATE-CODE
  9637             GO TO 0405-CONTINUE-EDIT
  9638         ELSE
  9639             NEXT SENTENCE
  9640     ELSE
  9641         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9642
  9643     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9644     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9645     MOVE '3'                    TO CNTL-REC-TYPE.
  9646     MOVE +0                     TO CNTL-SEQ-NO.
  9647
  9648     MOVE '3'                    TO RC-SW-2.
  9649     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9650
  9651     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9652        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9653        PB-SV-STATE   NOT = CF-STATE-CODE)
  9654        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9655                                    WS-TOL-AH-CLAIM
  9656                                    WS-MINIMUM-REFUND
  9657                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 176
* EL050.cbl
  9658                                    WS-TOL-AH-PREM
  9659                                    WS-TOL-LF-REFUND
  9660                                    WS-TOL-AH-REFUND
  9661                                    EC-ST-TOL-PREM-PCT
  9662                                    WS-TOL-LF-PREM-PCT
  9663                                    WS-TOL-AH-PREM-PCT
  9664                                    EC-ST-TOL-REFUND-PCT
  9665                                    WS-TOL-LF-REFUND-PCT
  9666                                    WS-TOL-AH-REFUND-PCT
  9667                                    EC-ST-TOL-PREM
  9668                                    EC-ST-TOL-REFUND
  9669                                    EC-ST-FST-PMT-DAYS-MAX
  9670                                    WS-FREE-LOOK-PERIOD
  9671                                    WS-ST-LF-PREM-TAX
  9672                                    WS-ST-AH-PREM-TAX-I
  9673                                    WS-ST-AH-PREM-TAX-G
  9674                                    WS-BANK-FEE
  9675                                    WS-BANK-LFEE
  9676                                    WS-TOL-CLP-PCT
  9677                                    WS-SPP-LEASE-COMM
  9678        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9679                                    EC-ST-FST-PMT-DAYS-CHG
  9680                                    WS-LF-REM-TERM-CALC
  9681                                    WS-LF-REFUND-CALC
  9682                                    EC-ST-LF-REM-TERM-CALC
  9683                                    EC-ST-LF-REFUND-CALC
  9684                                    WS-AH-REM-TERM-CALC
  9685                                    WS-AH-REFUND-CALC
  9686                                    WS-LF-BEN-CATEGORY
  9687                                    WS-AH-BEN-CATEGORY
  9688                                    WS-CLP-STATE
  9689                                    WS-ST-REFUND-CLAIM-FLAG
  9690                                    WS-ST-CAUSAL-STATE
  9691                                    EC-ST-AH-REM-TERM-CALC
  9692                                    EC-ST-AH-REFUND-CALC
  9693          GO TO 0499-STATE-NOT-FOUND.
  9694
  9695     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9696
  9697 0405-CONTINUE-EDIT.
  9698
  9699     if pb-company-id = 'AHL'
  9700        continue
  9701     else
  9702        IF PB-CERT-PRIME NOT NUMERIC
  9703           MOVE ER-2722          TO WS-ERROR
  9704           PERFORM 9900-ERROR-FORMAT
  9705                                 THRU 9900-EXIT
  9706        end-if
  9707     END-IF
  9708*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9709*       MOVE +0                  TO SUB3
  9710*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9711*       IF SUB3 > +0
  9712*          MOVE ER-2722          TO WS-ERROR
  9713*          PERFORM 9900-ERROR-FORMAT
  9714*                                THRU 9900-EXIT
  9715*       END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 177
* EL050.cbl
  9716*    END-IF
  9717*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9718*       IF PB-CERT-PRIME NOT NUMERIC
  9719*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9720*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9721*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9722*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9723*
  9724*          MOVE ER-2722          TO WS-ERROR
  9725*          PERFORM 9900-ERROR-FORMAT
  9726*                                THRU 9900-EXIT
  9727*       END-IF
  9728*    END-IF
  9729
  9730     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9731
  9732     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9733        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9734                                    WS-TOL-AH-CLAIM.
  9735
  9736     IF CF-ST-REFUND-MIN NOT NUMERIC
  9737        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9738
  9739     IF CF-ST-REFUND-MIN NOT = ZEROS
  9740        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9741
  9742     IF CF-ST-TOL-PREM  NOT = ZEROS
  9743        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9744                                    WS-TOL-AH-PREM
  9745        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9746
  9747     IF CF-ST-TOL-REFUND NOT = ZEROS
  9748        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9749                                    WS-TOL-AH-REFUND
  9750        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9751
  9752     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9753        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9754        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9755                                    WS-AH-REFUND-OVS-AMT
  9756                                    EC-ST-OVR-SHT-AMT.
  9757
  9758     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9759        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9760        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9761                                    WS-TOL-LF-PREM-PCT
  9762                                    WS-TOL-AH-PREM-PCT.
  9763
  9764     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9765        CF-ST-TOL-REF-PCT GREATER THAN +0
  9766        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9767                                    WS-TOL-LF-REFUND-PCT
  9768                                    WS-TOL-AH-REFUND-PCT.
  9769
  9770     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9771        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9772        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9773                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 178
* EL050.cbl
  9774                                    EC-ST-OVR-SHT-PCT.
  9775
  9776     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9777     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9778
  9779     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9780          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9781
  9782     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9783     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9784     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9785
  9786     IF CF-ST-LF-PREM-TAX NUMERIC
  9787        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9788     END-IF
  9789     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9790        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9791     END-IF
  9792     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9793        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9794     END-IF
  9795
  9796     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9797         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9798     END-IF.
  9799
  9800     IF CF-ST-CAUSAL-STATE > SPACES
  9801         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9802     END-IF.
  9803
  9804     IF WS-LF-BENEFIT-CD = ZEROS
  9805        GO TO 0410-CHECK-AH.
  9806
  9807     IF CF-ST-RT-CALC NOT = SPACES
  9808        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9809                                    EC-ST-LF-REM-TERM-CALC
  9810     END-IF
  9811
  9812     IF WS-LF-COVERAGE-TYPE = 'R'
  9813        IF WS-LF-EARNINGS-CALC = '5'
  9814           IF CF-ST-RF-LN-CALC > '0'
  9815              MOVE CF-ST-RF-LN-CALC
  9816                                 TO WS-LF-REFUND-CALC
  9817                                    EC-ST-LF-REFUND-CALC
  9818           END-IF
  9819        ELSE
  9820           IF CF-ST-RF-LR-CALC > '0'
  9821              MOVE CF-ST-RF-LR-CALC
  9822                                 TO WS-LF-REFUND-CALC
  9823                                    EC-ST-LF-REFUND-CALC
  9824           END-IF
  9825        END-IF
  9826     ELSE
  9827        IF CF-ST-RF-LL-CALC > '0'
  9828           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9829                                    EC-ST-LF-REFUND-CALC
  9830        END-IF
  9831     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 179
* EL050.cbl
  9832
  9833     IF CF-ST-RT-CALC NOT = SPACES
  9834        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9835                                    EC-ST-LF-REM-TERM-CALC
  9836     END-IF
  9837
  9838     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9839     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9840
  9841     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9842
  9843     IF NO-BENEFIT-FOUND
  9844        GO TO 0410-CHECK-AH.
  9845
  9846     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9847        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9848                                 TO EC-ST-LF-REM-TERM-CALC
  9849                                    WS-LF-REM-TERM-CALC
  9850     END-IF
  9851
  9852     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9853        MOVE CF-ST-REFUND-CALC (SUB3)
  9854                                 TO WS-LF-REFUND-CALC
  9855                                    EC-ST-LF-REFUND-CALC
  9856     END-IF
  9857*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9858
  9859     .
  9860 0410-CHECK-AH.
  9861
  9862     IF WS-AH-BENEFIT-CD = ZEROS
  9863        GO TO 0500-SET-ACCOUNT.
  9864
  9865     IF CF-ST-RT-CALC NOT = SPACES
  9866        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9867                                    EC-ST-AH-REM-TERM-CALC
  9868     END-IF
  9869
  9870     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9871        IF CF-ST-RF-CP-CALC > '0'
  9872           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9873                                    EC-ST-AH-REFUND-CALC
  9874        END-IF
  9875     ELSE
  9876        IF CF-ST-RF-AH-CALC > '0'
  9877           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9878                                    EC-ST-AH-REFUND-CALC
  9879        END-IF
  9880     END-IF
  9881     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9882     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9883
  9884     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9885
  9886     IF NO-BENEFIT-FOUND
  9887        GO TO 0500-SET-ACCOUNT.
  9888
  9889     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 180
* EL050.cbl
  9890        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9891                                 TO WS-AH-REM-TERM-CALC
  9892                                    EC-ST-AH-REM-TERM-CALC
  9893     END-IF
  9894
  9895     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9896        MOVE CF-ST-REFUND-CALC (SUB3)
  9897                                 TO WS-AH-REFUND-CALC
  9898                                    EC-ST-AH-REFUND-CALC
  9899     END-IF
  9900
  9901*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9902
  9903     GO TO 0500-SET-ACCOUNT.
  9904
  9905 0499-STATE-NOT-FOUND.
  9906
  9907     MOVE ER-2603                TO WS-ERROR.
  9908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9909
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 181
* EL050.cbl
  9911
  9912 0500-SET-ACCOUNT.
  9913*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9914     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9915        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9916        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9917        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9918        MOVE '3'                 TO CNTL-REC-TYPE
  9919        MOVE +0                  TO CNTL-SEQ-NO
  9920
  9921        MOVE '3'                 TO RC-SW-2
  9922        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9923
  9924        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9925           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9926           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9927           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9928                                    WS-ST-AH-PREM-TAX-I
  9929                                    WS-ST-AH-PREM-TAX-G
  9930        ELSE
  9931           IF CF-ST-LF-PREM-TAX NUMERIC
  9932              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9933           END-IF
  9934           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9935              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9936           END-IF
  9937           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9938              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9939           END-IF
  9940        END-IF
  9941        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9942     END-IF
  9943*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9944*  FOR DCC ONLY
  9945     IF PB-COMPANY-ID = 'DCC'
  9946
  9947     MOVE ' '                    TO STAT-MASTER-SW
  9948     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9949     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9950     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9951     MOVE PB-STATE               TO ELSTAT-STATE
  9952     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9953        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9954     END-IF
  9955
  9956     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9957     SET BIN-TO-GREG             TO TRUE
  9958     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9959     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9960     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9961
  9962     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9963     IF STAT-MASTER-FOUND
  9964        MOVE 'N'                 TO STAT-MASTER-SW
  9965        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9966        IF STAT-MASTER-FOUND
  9967           IF (ELSTAT-KEY-SAVE (1:12) =
  9968                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 182
* EL050.cbl
  9969              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9970                 MOVE 'F'        TO STAT-MASTER-SW
  9971              ELSE
  9972                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9973                 IF (STAT-MASTER-FOUND)
  9974                    AND (ELSTAT-KEY-SAVE (1:12) =
  9975                        SF-CONTROL-PRIMARY (1:12))
  9976                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9977                    MOVE 'F'     TO STAT-MASTER-SW
  9978                 END-IF
  9979              END-IF
  9980           END-IF
  9981        END-IF
  9982     END-IF
  9983
  9984     IF STAT-MASTER-SW = 'F'
  9985        IF SF-ST-LF-PREM-TAX NUMERIC
  9986           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9987        END-IF
  9988        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9989           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9990        END-IF
  9991        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9992           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9993        END-IF
  9994     END-IF
  9995
  9996     END-IF
  9997     IF (PB-COMPANY-ID = 'DCC')
  9998        AND (PB-ISSUE)
  9999        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10000        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10001        AND (AM-GPCD = 06)
 10002        MOVE 'Y'                 TO WS-GOOD-HIN
 10003        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10004           MOVE PB-I-VIN         TO WS-WORK-VIN
 10005           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10006              (V1 > 16)
 10007              IF WS-WORK-VIN (V1:1) NUMERIC
 10008                 MOVE WS-WORK-VIN-N (V1)
 10009                                 TO WS-ROW-B-VAL (V1)
 10010              ELSE
 10011                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10012                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10013                    OR (V2 > 26)
 10014                 END-PERFORM
 10015                 IF V2 < 27
 10016                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10017                 ELSE
 10018                    MOVE 'N'     TO WS-GOOD-HIN
 10019                 END-IF
 10020              END-IF
 10021              COMPUTE WS-ROW-D-VAL (V1) =
 10022                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10023              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10024                 WS-ROW-D-VAL (V1)
 10025           END-PERFORM
 10026           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 183
* EL050.cbl
 10027           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10028             REMAINDER WS-VIN-REMAINDER
 10029           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10030              CONTINUE
 10031           ELSE
 10032              MOVE 'N'           TO WS-GOOD-HIN
 10033           END-IF
 10034        ELSE
 10035           MOVE 'N'              TO WS-GOOD-HIN
 10036        END-IF
 10037        IF WS-GOOD-HIN NOT = 'Y'
 10038           MOVE ER-3826           TO WS-ERROR
 10039           PERFORM 9900-ERROR-FORMAT
 10040                                 THRU 9900-EXIT
 10041        END-IF
 10042     END-IF
 10043     IF (PB-COMPANY-ID = 'DCC')
 10044        AND (PB-ISSUE)
 10045        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10046        AND (AM-GPCD NOT = 06)
 10047        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10048          MOVE PB-I-VIN          TO WS-WORK-VIN
 10049          MOVE +8                TO V2
 10050          MOVE ZEROS             TO WS-VIN-TOTAL
 10051          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10052           (V1 > 17)
 10053             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10054                MOVE ER-3825     TO WS-ERROR
 10055                PERFORM 9900-ERROR-FORMAT
 10056                                 THRU 9900-EXIT
 10057             ELSE
 10058                IF V1 = 8
 10059                   MOVE 10       TO V2
 10060                END-IF
 10061                IF V1 = 9
 10062                   MOVE 0        TO V2
 10063                END-IF
 10064                IF V1 = 10
 10065                   MOVE 9        TO V2
 10066                END-IF
 10067                IF WS-WORK-VIN (V1:1) NUMERIC
 10068                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10069                    + (WS-WORK-VIN-N (V1) * V2)
 10070                ELSE
 10071                   MOVE WS-WORK-VIN (V1:1)
 10072                                 TO WS-HEX-BYTE
 10073                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10074                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10075                    + (WS-NUM (V3) * V2)
 10076                END-IF
 10077                COMPUTE V2 = V2 - 1
 10078             END-IF
 10079          END-PERFORM
 10080          MOVE ZEROS TO WS-VIN-REMAINDER
 10081          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10082             REMAINDER WS-VIN-REMAINDER
 10083          IF ((WS-WORK-VIN (9:1) = 'X')
 10084             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 184
* EL050.cbl
 10085                     OR
 10086             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10087             CONTINUE
 10088          ELSE
 10089             MOVE ER-3826        TO WS-ERROR
 10090             PERFORM 9900-ERROR-FORMAT
 10091                                 THRU 9900-EXIT
 10092          END-IF
 10093        ELSE
 10094          MOVE ER-3826           TO WS-ERROR
 10095          PERFORM 9900-ERROR-FORMAT
 10096                                 THRU 9900-EXIT
 10097        END-IF
 10098     END-IF
 10099******************************************************************
 10100******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10101******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10102******* METHODS.
 10103******************************************************************
 10104     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10105        IF PB-CANCELLATION
 10106           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10107              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10108                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10109                IF FORM-MASTER-FOUND
 10110                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10111******************************************************************
 10112
 10113     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10114     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10115
 10116     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10117     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10118     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10119     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10120
 10121
 10122     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10123     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10124     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10125
 10126     IF AM-LF-OB-RATE NOT NUMERIC
 10127         MOVE ZERO               TO AM-LF-OB-RATE.
 10128
 10129     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10130         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10131
 10132     IF AM-AH-OB-RATE NOT NUMERIC
 10133         MOVE ZERO               TO AM-AH-OB-RATE.
 10134
 10135     IF WS-LF-JOINT-INDICATOR = 'J'
 10136         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10137     ELSE
 10138         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10139
 10140     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10141
 10142     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 185
* EL050.cbl
 10143         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10144
 10145     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10146         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10147                                       WS-IG-OVRD
 10148     ELSE
 10149         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10150             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10151                                       WS-IG-OVRD
 10152         ELSE
 10153             MOVE AM-IG             TO WS-IG-OVRD-AH
 10154                                       WS-IG-OVRD.
 10155
 10156     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10157         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10158                                       WS-IG-OVRD
 10159     ELSE
 10160         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10161             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10162                                       WS-IG-OVRD
 10163         ELSE
 10164             MOVE AM-IG             TO WS-IG-OVRD-LF
 10165                                       WS-IG-OVRD.
 10166
 10167     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10168     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10169     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10170     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10171     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10172
 10173     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10174     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10175     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10176     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10177
 10178     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10179     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10180     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10181     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10182     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10183     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10184     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10185
 10186     IF WS-ACCT-AH-DEV-PCT > +0
 10187        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10188     ELSE
 10189        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10190
 10191     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10192        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10193     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10194        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10195
 10196        IF AM-EARN-METHOD-L = 'S'
 10197            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10198                                        WS-LF-REFUND-CALC.
 10199
 10200        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 186
* EL050.cbl
 10201            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10202                                        WS-LF-REFUND-CALC.
 10203
 10204     IF WS-LF-COVERAGE-TYPE = 'R'
 10205         IF AM-EARN-METHOD-R = 'R'
 10206            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10207                                    WS-LF-REFUND-CALC.
 10208     IF WS-LF-COVERAGE-TYPE = 'R'
 10209         IF AM-EARN-METHOD-R = 'P'
 10210            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10211                                    WS-LF-REFUND-CALC.
 10212     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10213         IF AM-EARN-METHOD-L = 'R'
 10214            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10215                                    WS-LF-REFUND-CALC.
 10216     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10217         IF AM-EARN-METHOD-L = 'P'
 10218            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10219                                    WS-LF-REFUND-CALC.
 10220     IF WS-LF-COVERAGE-TYPE = 'R'
 10221         IF AM-EARN-METHOD-R = 'A'
 10222            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10223                                    WS-LF-REFUND-CALC.
 10224     IF WS-LF-COVERAGE-TYPE = 'R'
 10225         IF AM-EARN-METHOD-R = 'M'
 10226            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10227                                    WS-LF-REFUND-CALC.
 10228     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10229         IF AM-EARN-METHOD-L = 'A'
 10230            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10231                                    WS-LF-REFUND-CALC.
 10232     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10233         IF AM-EARN-METHOD-L = 'M'
 10234            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10235                                    WS-LF-REFUND-CALC.
 10236
 10237     IF AM-EARN-METHOD-A = 'R'
 10238        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10239                                    WS-AH-REFUND-CALC.
 10240     IF AM-EARN-METHOD-A = 'P'
 10241        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10242                                    WS-AH-REFUND-CALC.
 10243     IF AM-EARN-METHOD-A = 'C'
 10244        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10245                                    WS-AH-REFUND-CALC.
 10246     IF AM-EARN-METHOD-A = 'A'
 10247        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10248                                    WS-AH-REFUND-CALC.
 10249     IF AM-EARN-METHOD-A = 'M'
 10250        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10251                                    WS-AH-REFUND-CALC.
 10252     IF AM-EARN-METHOD-A = 'N'
 10253        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10254                                    WS-AH-REFUND-CALC.
 10255     IF AM-EARN-METHOD-A = 'S'
 10256        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10257                                    WS-AH-REFUND-CALC.
 10258
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 187
* EL050.cbl
 10259     IF AM-TOL-PREM NOT = ZEROS
 10260        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10261                                    WS-TOL-AH-PREM.
 10262
 10263     IF AM-OVR-SHT-AMT NUMERIC AND
 10264                  AM-OVR-SHT-AMT > 0
 10265        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10266                                    EC-AM-LF-OVR-SHT-AMT
 10267                                    WS-AH-REFUND-OVS-AMT
 10268                                    EC-AM-AH-OVR-SHT-AMT.
 10269
 10270     IF AM-OVR-SHT-PCT NUMERIC AND
 10271                    AM-OVR-SHT-PCT > 0
 10272        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10273                                    EC-AM-LF-OVR-SHT-PCT
 10274                                    WS-AH-REFUND-OVS-PCT
 10275                                    EC-AM-AH-OVR-SHT-PCT.
 10276
 10277     IF AM-TOL-REF-PCT NUMERIC AND
 10278                  AM-TOL-REF-PCT > 0
 10279        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10280                                    WS-TOL-AH-REFUND-PCT.
 10281
 10282     IF AM-TOL-REF  NOT = ZEROS  AND
 10283                  AM-TOL-REF NUMERIC
 10284        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10285                                    EC-AM-LF-TOL-REFUND
 10286                                    WS-TOL-AH-REFUND
 10287                                    EC-AM-AH-TOL-REFUND.
 10288
 10289     IF AM-TOL-CLM  NOT = ZEROS
 10290        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10291                                    WS-TOL-AH-CLAIM.
 10292
 10293     IF AM-CLP-TOL-PCT NOT NUMERIC
 10294        MOVE +0                  TO AM-CLP-TOL-PCT
 10295     END-IF
 10296
 10297     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10298        MOVE +0                  TO AM-SPP-LEASE-COMM
 10299     END-IF
 10300     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10301        MOVE WS-PL-TOL-LF-PREM-PCT
 10302                                 TO WS-TOL-LF-PREM-PCT.
 10303
 10304     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10305        MOVE WS-PL-TOL-AH-PREM-PCT
 10306                                 TO WS-TOL-AH-PREM-PCT.
 10307
 10308     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10309        MOVE WS-PL-TOL-LF-REFUND-PCT
 10310                                 TO WS-TOL-LF-REFUND-PCT.
 10311
 10312     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10313        MOVE WS-PL-TOL-AH-REFUND-PCT
 10314                                 TO WS-TOL-AH-REFUND-PCT.
 10315
 10316     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 188
* EL050.cbl
 10317        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10318
 10319     IF WS-PL-REF-OVS-PCT > +0
 10320        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10321
 10322     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10323        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10324     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10325        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10326     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10327        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10328     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10329        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10330     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10331        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10332     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10333        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10334
 10335     IF WS-AH-PL-REF-OVS-AMT > +0
 10336        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10337
 10338     IF WS-AH-PL-REF-OVS-PCT > +0
 10339        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10340
 10341     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10342     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10343
 10344     IF PB-CANCELLATION
 10345        GO TO 3000-CONTINUE-EDIT.
 10346
 10347     MOVE +1 TO SUB1.
 10348     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10349     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10350
 10351     IF CF-COMPANY-ID = 'DMD'
 10352       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10353         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10354        ELSE
 10355         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10356
 10357  0525-FIND-ACCT-COMM.
 10358     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10359        NEXT SENTENCE
 10360      ELSE
 10361         ADD +1 TO SUB1
 10362         IF SUB1 LESS +11
 10363            GO TO 0525-FIND-ACCT-COMM
 10364          ELSE
 10365             GO TO 0560-EDIT-CONTINUE.
 10366
 10367     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10368     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10369                                    PB-I-LIFE-COMMISSION.
 10370***  IF PB-COMPANY-ID = 'CRI'
 10371     IF PB-PREM-ACCTNG-ONLY
 10372         GO TO 0560-EDIT-CONTINUE.
 10373
 10374     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 189
* EL050.cbl
 10375     MOVE ' '    TO WS-CTBL-READ-SW.
 10376
 10377
 10378 0530-GET-AH-COMP.
 10379     IF NO-AH-COVERAGE  OR
 10380        NO-AH-BENEFIT-MATCH
 10381           GO TO 0540-NEXT-READ-STEP.
 10382
 10383     IF AM-A-COM (SUB1) NUMERIC
 10384        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10385         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10386         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10387         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10388         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10389     ELSE
 10390          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10391          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10392          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10393          MOVE ZEROS             TO WS-SUB1
 10394                                    WS-COMMISSION
 10395          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10396          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10397          IF WS-COMMISSION > ZEROS
 10398             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10399             GO TO 0540-NEXT-READ-STEP
 10400          END-IF
 10401          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10402          IF CTBL-TABLE-FOUND
 10403             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10404                                        PB-I-AH-TERM
 10405             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10406             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10407             GO TO 0540-NEXT-READ-STEP
 10408          ELSE
 10409             IF FIRST-TIME-THROUGH
 10410                 GO TO 0530-GET-AH-COMP
 10411             ELSE
 10412                 MOVE ER-2609                TO WS-ERROR
 10413                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10414
 10415 0540-NEXT-READ-STEP.
 10416     MOVE '0540' TO CTBL-SW.
 10417     MOVE ' '    TO WS-CTBL-READ-SW.
 10418
 10419 0540-GET-LF-COMP.
 10420     IF NO-LIFE-COVERAGE  OR
 10421        NO-LF-BENEFIT-MATCH
 10422           GO TO 0560-EDIT-CONTINUE.
 10423
 10424     IF WS-LF-JOINT-INDICATOR = 'J'
 10425        IF AM-J-COM (SUB1) NUMERIC
 10426           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10427           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10428           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10429           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10430           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10431        ELSE
 10432           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 190
* EL050.cbl
 10433           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10434           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10435           MOVE ZEROS                TO WS-SUB1
 10436                                        WS-COMMISSION
 10437           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10438           IF WS-COMMISSION > ZEROS
 10439              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10440              GO TO 0560-EDIT-CONTINUE
 10441           END-IF
 10442           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10443           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10444           IF CTBL-TABLE-FOUND
 10445              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10446              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10447              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10448              GO TO 0560-EDIT-CONTINUE
 10449           ELSE
 10450              IF FIRST-TIME-THROUGH
 10451                  GO TO 0540-GET-LF-COMP
 10452              ELSE
 10453                  MOVE ER-2609                TO WS-ERROR
 10454                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10455                  GO TO 0560-EDIT-CONTINUE.
 10456
 10457     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10458        IF AM-L-COM (SUB1) NUMERIC
 10459           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10460           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10461           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10462           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10463           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10464        ELSE
 10465           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10466           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10467           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10468           MOVE ZEROS                TO WS-SUB1
 10469                                        WS-COMMISSION
 10470           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10471           IF WS-COMMISSION IS GREATER THAN ZEROS
 10472              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10473              GO TO 0560-EDIT-CONTINUE
 10474           END-IF
 10475           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10476           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10477           IF CTBL-TABLE-FOUND
 10478              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10479              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10480              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10481              GO TO 0560-EDIT-CONTINUE
 10482           ELSE
 10483              IF FIRST-TIME-THROUGH
 10484                  GO TO 0540-GET-LF-COMP
 10485              ELSE
 10486                  MOVE ER-2609                TO WS-ERROR
 10487                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10488
 10489*    GO TO 0560-EDIT-CONTINUE.
 10490
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 191
* EL050.cbl
 10491 0560-EDIT-CONTINUE.
 10492     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10493                                    WS-AH-PMF-COMM
 10494*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10495*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10496     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10497        (SUB1 > +10)
 10498        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10499           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10500           MOVE '0530'           TO CTBL-SW
 10501           MOVE ' '              TO WS-CTBL-READ-SW
 10502           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10503           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10504           MOVE '0540'           TO CTBL-SW
 10505           MOVE ' '              TO WS-CTBL-READ-SW
 10506           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10507        END-IF
 10508     END-PERFORM
 10509     GO TO 0564-EDIT-CONTINUE
 10510     .
 10511 0561-CHECK-AH.
 10512     IF (NO-AH-COVERAGE)
 10513        OR (NO-AH-BENEFIT-MATCH)
 10514        CONTINUE
 10515     ELSE
 10516        IF (AM-A-COM (SUB1) NUMERIC)
 10517           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10518           IF (AM-COM-TYP (SUB1) = 'A')
 10519              AND (WS-AH-PMF-COMM = ZEROS)
 10520              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10521           END-IF
 10522           CONTINUE
 10523        ELSE
 10524           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10525           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10526           MOVE PB-AH-OVERRIDE-L1
 10527                                 TO CTBL-BEN-TYPE
 10528           MOVE ZEROS            TO WS-SUB1
 10529                                    WS-COMMISSION
 10530           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10531           PERFORM 8300-READ-CTBL-TABLE
 10532                                 THRU 8300-EXIT
 10533           IF CTBL-TABLE-FOUND
 10534              IF (AM-COM-TYP (SUB1) = 'A')
 10535                 AND (WS-AH-PMF-COMM = ZEROS)
 10536                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10537                                        PB-I-AH-TERM
 10538                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10539                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10540              END-IF
 10541              CONTINUE
 10542           ELSE
 10543              IF FIRST-TIME-THROUGH
 10544                 GO TO 0561-CHECK-AH
 10545              ELSE
 10546                 MOVE ER-2609    TO WS-ERROR
 10547                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10548              END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 192
* EL050.cbl
 10549           END-IF
 10550        END-IF
 10551     END-IF
 10552     .
 10553 0561-EXIT.
 10554     EXIT.
 10555 0563-CHECK-LF.
 10556     IF (NO-LIFE-COVERAGE)
 10557        OR (NO-LF-BENEFIT-MATCH)
 10558        CONTINUE
 10559     ELSE
 10560        IF WS-LF-JOINT-INDICATOR = 'J'
 10561           IF AM-J-COM (SUB1) NUMERIC
 10562              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10563              IF (AM-COM-TYP (SUB1) = 'A')
 10564                 AND (WS-LF-PMF-COMM = ZEROS)
 10565                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10566              END-IF
 10567              CONTINUE
 10568           ELSE
 10569              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10570              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10571              MOVE PB-LIFE-OVERRIDE-L1
 10572                                 TO CTBL-BEN-TYPE
 10573              MOVE ZEROS         TO WS-SUB1
 10574                                    WS-COMMISSION
 10575              MOVE AM-J-COMA (SUB1)
 10576                                 TO CTBL-TABLE
 10577              PERFORM 8300-READ-CTBL-TABLE
 10578                                 THRU 8300-EXIT
 10579              IF CTBL-TABLE-FOUND
 10580                 IF (AM-COM-TYP (SUB1) = 'A')
 10581                    AND (WS-LF-PMF-COMM = ZEROS)
 10582                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10583                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10584                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10585                 END-IF
 10586                 CONTINUE
 10587              ELSE
 10588                 IF FIRST-TIME-THROUGH
 10589                    GO TO 0563-CHECK-LF
 10590                 ELSE
 10591                    MOVE ER-2609 TO WS-ERROR
 10592                    PERFORM 9900-ERROR-FORMAT
 10593                                 THRU 9900-EXIT
 10594*                   GO TO 0560-EDIT-CONTINUE
 10595                 END-IF
 10596              END-IF
 10597           END-IF
 10598        ELSE
 10599           IF AM-L-COM (SUB1) NUMERIC
 10600              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10601              IF (AM-COM-TYP (SUB1) = 'A')
 10602                 AND (WS-LF-PMF-COMM = ZEROS)
 10603                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10604              END-IF
 10605              CONTINUE
 10606           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 193
* EL050.cbl
 10607              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10608              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10609              MOVE PB-LIFE-OVERRIDE-L1
 10610                                 TO CTBL-BEN-TYPE
 10611              MOVE ZEROS         TO WS-SUB1
 10612                                    WS-COMMISSION
 10613              MOVE AM-L-COMA (SUB1)
 10614                                 TO CTBL-TABLE
 10615              PERFORM 8300-READ-CTBL-TABLE
 10616                                 THRU 8300-EXIT
 10617              IF CTBL-TABLE-FOUND
 10618                 CONTINUE
 10619              ELSE
 10620                 IF FIRST-TIME-THROUGH
 10621                    GO TO 0563-CHECK-LF
 10622                 ELSE
 10623                    MOVE ER-2609 TO WS-ERROR
 10624                    PERFORM 9900-ERROR-FORMAT
 10625                                 THRU 9900-EXIT
 10626                 END-IF
 10627              END-IF
 10628           END-IF
 10629        END-IF
 10630     END-IF
 10631     .
 10632 0563-EXIT.
 10633     EXIT.
 10634 0564-EDIT-CONTINUE.
 10635
 10636     IF  PB-COMPANY-ID EQUAL 'DMD'
 10637         IF PB-I-NUM-BILLED EQUAL ZEROS
 10638            MOVE ER-8148       TO WS-ERROR
 10639            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10640
 10641*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10642*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10643*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10644*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10645*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10646*         IF NO-CONVERSION-ERROR
 10647*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10648*         ELSE
 10649*             IF PB-COMPANY-ID EQUAL 'HAN'
 10650*                 MOVE ZEROS     TO PB-I-AGE.
 10651     IF PB-I-BIRTHDAY > LOW-VALUES
 10652        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10653        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10654        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10655        PERFORM 8500-DATE-CONVERT
 10656                                 THRU 8500-EXIT
 10657        IF NO-CONVERSION-ERROR
 10658           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10659           IF PB-I-AGE > ZEROS
 10660              IF WS-WORK-AGE NOT = PB-I-AGE
 10661                 MOVE ER-9501    TO WS-ERROR
 10662                 PERFORM 9900-ERROR-FORMAT
 10663                                 THRU 9900-EXIT
 10664              END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 194
* EL050.cbl
 10665           ELSE
 10666              MOVE WS-WORK-AGE   TO PB-I-AGE
 10667           END-IF
 10668        END-IF
 10669     END-IF
 10670     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10671                                   WS-INS-AGE-SET
 10672     IF PB-I-AGE = ZEROS
 10673        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10674           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10675                                   WS-INS-AGE-SET
 10676           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10677
 10678     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10679                                   WS-AH-EDIT-AGE.
 10680
 10681     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10682        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10683        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10684        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10685        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10686        IF NO-CONVERSION-ERROR
 10687           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10688           IF PB-I-JOINT-AGE > 0
 10689              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10690                 MOVE ER-9503    TO WS-ERROR
 10691                 PERFORM 9900-ERROR-FORMAT
 10692                                 THRU 9900-EXIT
 10693              END-IF
 10694           ELSE
 10695              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10696           END-IF
 10697        ELSE
 10698           MOVE ZEROS            TO PB-I-JOINT-AGE
 10699        END-IF
 10700     END-IF
 10701     IF PB-I-JOINT-AGE NOT NUMERIC
 10702        MOVE ZERO               TO PB-I-JOINT-AGE.
 10703
 10704     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10705                                   WS-JNT-AGE-SET
 10706     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10707        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10708           (WS-AH-JOINT-INDICATOR = 'J')
 10709           IF PB-I-JOINT-AGE = ZEROS
 10710               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10711                                          WS-JNT-AGE-SET
 10712               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10713           END-IF
 10714        END-IF
 10715     END-IF
 10716
 10717     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10718     IF WS-LF-JOINT-INDICATOR = 'J'
 10719        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10720        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10721            IF  PB-I-JOINT-AGE = ZERO
 10722                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 195
* EL050.cbl
 10723                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10724            ELSE
 10725                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10726                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10727                    IF PB-COMPANY-ID NOT = 'LBL'
 10728                        MOVE ER-2685    TO WS-ERROR
 10729                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10730
 10731     IF WS-AH-JOINT-INDICATOR = 'J'
 10732        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10733            IF  PB-I-JOINT-AGE = ZERO
 10734                MOVE ER-2686       TO WS-ERROR
 10735                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10736            ELSE
 10737                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10738                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10739                                           WS-EDIT-AGE
 10740                    IF PB-COMPANY-ID NOT = 'LBL'
 10741                        MOVE ER-2685    TO WS-ERROR
 10742                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10743
 10744******************************************************************
 10745*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10746******************************************************************
 10747
 10748     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10749        (WS-AH-SPECIAL-CALC-CD = 'O')
 10750        NEXT SENTENCE
 10751     ELSE
 10752        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10753          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10754           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10755            WS-AH-JOINT-INDICATOR = 'J')  AND
 10756           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10757            MOVE ER-2627             TO WS-ERROR
 10758            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10759
 10760     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10761        (WS-AH-SPECIAL-CALC-CD = 'O')
 10762         NEXT SENTENCE
 10763     ELSE
 10764         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10765            WS-AH-JOINT-INDICATOR = 'J'
 10766             IF PB-I-JOINT-INSURED = SPACES
 10767                 IF PB-COMPANY-ID NOT = 'JAL'
 10768                     MOVE ER-2696    TO WS-ERROR
 10769                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10770
 10771     IF PB-COMPANY-ID NOT = 'BOA'
 10772        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10773           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10774           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10775               PB-I-JOINT-INSURED NOT = SPACES)
 10776                MOVE ER-2691         TO WS-ERROR
 10777                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10778
 10779     IF PB-COMPANY-ID = 'BOA'
 10780        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 196
* EL050.cbl
 10781           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10782            IF PB-I-JOINT-AGE NOT = ZEROS
 10783                MOVE ER-2691         TO WS-ERROR
 10784                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10785
 10786     IF PB-COMPANY-ID = 'CRI'
 10787        IF PB-I-SIG-SW = 'J'
 10788           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10789              WS-AH-JOINT-INDICATOR NOT = 'J'
 10790              MOVE ER-2675       TO WS-ERROR
 10791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10792
 10793     IF PB-COMPANY-ID = 'CRI'
 10794        IF PB-I-SIG-SW = 'S'
 10795           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10796              WS-AH-JOINT-INDICATOR = 'J'
 10797              MOVE ER-2676       TO WS-ERROR
 10798              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10799
 10800     IF PB-COMPANY-ID = 'CVL'
 10801         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10802            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10803              MOVE ER-2783           TO WS-ERROR
 10804              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10805     IF (WS-LF-JOINT-INDICATOR = 'J')
 10806        AND (WS-AH-JOINT-INDICATOR = 'J')
 10807        AND (PB-I-LF-TERM > 120)
 10808        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10809        MOVE ER-2783             TO WS-ERROR
 10810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10811     END-IF
 10812     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10813
 10814     IF PB-I-INDV-GRP-OVRD = 'I'
 10815        MOVE ER-2666             TO WS-ERROR
 10816        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10817        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10818
 10819     IF PB-I-INDV-GRP-OVRD = 'G'
 10820        MOVE ER-2666             TO WS-ERROR
 10821        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10822        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10823
 10824     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10825        NEXT SENTENCE
 10826     ELSE
 10827        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10828
 10829     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10830        IF WS-ERROR = ER-2666
 10831           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10832           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10833
 10834     IF PB-COMPANY-ID = 'CID'
 10835        IF PB-STATE = 'UT' OR 'MO'
 10836           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10837                 OR '76' OR '77')
 10838                      OR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 197
* EL050.cbl
 10839               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10840                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10841                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10842                   OR '2K' OR '2L'))
 10843              AND PB-I-INDV-GRP-CD = 'I'
 10844              MOVE ER-2721             TO WS-ERROR
 10845              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10846           END-IF
 10847        END-IF
 10848     END-IF
 10849
 10850     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10851     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10852        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10853     ELSE
 10854        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10855     END-IF
 10856
 10857*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10858*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10859     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10860                                    ACCOUNT-AH-CK-SW.
 10861
 10862     IF PB-REISSUED-CERT       OR
 10863        PB-REIN-ONLY-CERT      OR
 10864        PB-POLICY-IS-DECLINED  OR
 10865        PB-POLICY-IS-VOIDED
 10866*       OR PB-MONTHLY-CERT
 10867         GO TO 3000-CONTINUE-EDIT.
 10868
 10869     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10870        IF WS-EDIT-AGE           > +65
 10871           MOVE ER-2709          TO WS-ERROR
 10872           PERFORM 9900-ERROR-FORMAT
 10873                                 THRU 9900-EXIT
 10874        ELSE
 10875           IF WS-EDIT-AGE        > +55
 10876              MOVE ER-2718       TO WS-ERROR
 10877              PERFORM 9900-ERROR-FORMAT
 10878                                 THRU 9900-EXIT
 10879           END-IF
 10880        END-IF
 10881     IF PB-COMPANY-ID = 'DCC'
 10882        IF WS-EDIT-AGE           > +65
 10883           MOVE ER-2709          TO WS-ERROR
 10884           PERFORM 9900-ERROR-FORMAT
 10885                                 THRU 9900-EXIT
 10886        END-IF
 10887     END-IF
 10888     .
 10889
 10890 0565-LIFE-PLAN-LIMIT-EDITS.
 10891
 10892     IF NOT LF-PLAN-MASTER-FOUND
 10893        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10894                                    EC-AM-LF-MAX-TOT-BEN
 10895        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10896
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 198
* EL050.cbl
 10897     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10898
 10899     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10900         IF PL-LM-AGE (1) = ZEROS
 10901             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10902
 10903     IF NO-LF-BENEFIT-MATCH          OR
 10904        WS-LF-BENEFIT-CD = ZEROS     OR
 10905        WS-LF-SPECIAL-CALC-CD = 'M'
 10906        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10907
 10908     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10909     MOVE +1                     TO SUB2.
 10910
 10911     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10912        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10913           MOVE +5   TO SUB2
 10914           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10915              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10916              (PL-LM-AGE (SUB2) EQUAL +0)
 10917              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10918              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10919
 10920     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10921
 10922     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10923                               + PB-I-LF-ALT-BENEFIT-AMT.
 10924
 10925 0568-CHECK-LIFE-ATT-AGE.
 10926
 10927     IF PL-ATT-AGE NUMERIC AND
 10928        PL-ATT-AGE > +0
 10929        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10930     END-IF
 10931*    IF PL-ATT-AGE NUMERIC AND
 10932*       PL-ATT-AGE > +0
 10933*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10934*       IF PB-I-BIRTHDAY > LOW-VALUES
 10935*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10936*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10937*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10938*          SET BIN-PLUS-ELAPSED  TO TRUE
 10939*          PERFORM 8500-DATE-CONVERT
 10940*                                THRU 8500-EXIT
 10941*          IF NO-CONVERSION-ERROR
 10942*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10943*             MOVE ER-2669       TO WS-ERROR
 10944*             PERFORM 9900-ERROR-FORMAT
 10945*                                THRU 9900-EXIT
 10946*          END-IF
 10947*       ELSE
 10948*          IF WS-ATT-AGE >= PL-ATT-AGE
 10949*             MOVE ER-2669       TO WS-ERROR
 10950*             PERFORM 9900-ERROR-FORMAT
 10951*                                THRU 9900-EXIT
 10952*          END-IF
 10953*       END-IF
 10954*    END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 199
* EL050.cbl
 10955     .
 10956 0570-CHECK-LIFE-LIMITS.
 10957
 10958     IF PB-COMPANY-ID EQUAL 'CRI'
 10959        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10960           IF SUB2 GREATER THAN +4
 10961              MOVE ER-2637 TO WS-ERROR
 10962              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10963              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10964
 10965     IF PB-COMPANY-ID  =  'NCL'
 10966        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10967            SUB2 GREATER THAN +8
 10968             MOVE 'U'         TO PB-BATCH-ENTRY
 10969             MOVE ER-2637     TO WS-ERROR
 10970             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10971             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10972
 10973     IF SUB2 > +8
 10974        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10975           AND (PB-I-SIG-SW = 'Y')
 10976           CONTINUE
 10977        ELSE
 10978           MOVE ER-2637          TO WS-ERROR
 10979           PERFORM 9900-ERROR-FORMAT
 10980                                 THRU 9900-EXIT
 10981        END-IF
 10982        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10983     END-IF
 10984     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10985     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10986     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10987
 10988     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10989        ADD +1  TO SUB2
 10990        GO TO 0570-CHECK-LIFE-LIMITS.
 10991
 10992     IF PB-COMPANY-ID = 'NCL'
 10993         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10994
 10995     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10996        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10997        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10998           AND (PB-I-SIG-SW = 'Y')
 10999           CONTINUE
 11000        ELSE
 11001           MOVE ER-2637          TO WS-ERROR
 11002           PERFORM 9900-ERROR-FORMAT
 11003                                 THRU 9900-EXIT
 11004        END-IF
 11005     END-IF
 11006     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11007
 11008
 11009 0570-CHECK-NCL-LIFE-LIMITS.
 11010
 11011     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11012        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 200
* EL050.cbl
 11013         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11014
 11015     IF APP-CERT-USED
 11016         IF SUB2  LESS THAN  +5
 11017             MOVE +5          TO SUB2
 11018             GO TO 0570-CHECK-LIFE-LIMITS.
 11019
 11020     MOVE ER-2637             TO WS-ERROR.
 11021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11022
 11023     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11024
 11025 0575-CHECK-NCL-SIG-SWITCH.
 11026
 11027     IF NOT APP-CERT-USED
 11028         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11029
 11030     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11031        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11032        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11033        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11034         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11035
 11036     IF SUB2 GREATER THAN +4
 11037         IF PL-LM-AGE (5) = ZEROS  AND
 11038            PL-LM-AGE (6) = ZEROS  AND
 11039            PL-LM-AGE (7) = ZEROS  AND
 11040            PL-LM-AGE (8) = ZEROS
 11041             MOVE  ER-1927        TO WS-ERROR
 11042             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11043             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11044         ELSE
 11045             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11046                 MOVE  ER-1920    TO WS-ERROR
 11047                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11048
 11049     IF PB-I-SIG-SW  = 'Y'
 11050       IF NOT PB-I-POLICY-ACCEPTED  AND
 11051          NOT PB-I-POLICY-DECLINED
 11052           MOVE 'U'               TO PB-BATCH-ENTRY
 11053           MOVE  ER-1926          TO WS-ERROR
 11054           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11055
 11056
 11057 0580-AH-PLAN-LIMIT-EDITS.
 11058
 11059     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11060        IF PB-I-AH-BENEFIT-AMT > +1250
 11061           MOVE ER-2702          TO WS-ERROR
 11062           PERFORM 9900-ERROR-FORMAT
 11063                                 THRU 9900-EXIT
 11064        END-IF
 11065     END-IF
 11066
 11067     IF (PB-COMPANY-ID = 'DCC')
 11068        AND (PB-MONTHLY-CERT)
 11069        IF PB-I-AH-BENEFIT-AMT > +3000
 11070           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 201
* EL050.cbl
 11071           PERFORM 9900-ERROR-FORMAT
 11072                                 THRU 9900-EXIT
 11073        END-IF
 11074     END-IF
 11075     IF NOT AH-PLAN-MASTER-FOUND
 11076        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11077        GO TO 3000-CONTINUE-EDIT.
 11078
 11079     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11080
 11081     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11082         IF PL-LM-AGE (1) = ZEROS
 11083             GO TO 3000-CONTINUE-EDIT.
 11084
 11085     IF NO-AH-BENEFIT-MATCH          OR
 11086        WS-AH-BENEFIT-CD = ZEROS     OR
 11087        WS-AH-SPECIAL-CALC-CD = 'M'
 11088        GO TO 3000-CONTINUE-EDIT.
 11089
 11090     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11091     MOVE +1                     TO SUB2.
 11092
 11093     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11094        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11095           MOVE +5 TO SUB2
 11096           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11097              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11098              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11099              (PL-LM-AGE (SUB2) EQUAL +0)
 11100              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11101              GO TO 3000-CONTINUE-EDIT.
 11102
 11103     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11104
 11105 0590-CHECK-AH-ATT-AGE.
 11106
 11107     IF PL-ATT-AGE NUMERIC AND
 11108        PL-ATT-AGE GREATER THAN +0
 11109        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11110     END-IF
 11111*       IF WS-ATT-AGE >= PL-ATT-AGE
 11112*          MOVE ER-3054          TO WS-ERROR
 11113*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11114     .
 11115 0597-CHECK-AH-LIMITS.
 11116
 11117     IF PB-COMPANY-ID EQUAL 'CRI'
 11118        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11119           IF SUB2 GREATER THAN +4
 11120              MOVE ER-2638       TO WS-ERROR
 11121              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11122              GO TO 3000-CONTINUE-EDIT.
 11123
 11124     IF PB-COMPANY-ID  =  'NCL'
 11125        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11126            SUB2 GREATER THAN +8
 11127             MOVE 'U'            TO PB-BATCH-ENTRY
 11128             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 202
* EL050.cbl
 11129             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11130             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11131
 11132     IF SUB2 > +8
 11133        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11134           AND (PB-I-SIG-SW = 'Y')
 11135           CONTINUE
 11136        ELSE
 11137           MOVE ER-2638          TO WS-ERROR
 11138           PERFORM 9900-ERROR-FORMAT
 11139                                 THRU 9900-EXIT
 11140        END-IF
 11141        GO TO 3000-CONTINUE-EDIT
 11142     END-IF
 11143
 11144     IF PB-COMPANY-ID = 'CRI'
 11145        IF WS-ERROR = ER-2638
 11146           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11147
 11148     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11149     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11150     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11151     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11152
 11153     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11154        ADD +1                   TO SUB2
 11155        GO TO 0597-CHECK-AH-LIMITS.
 11156
 11157     IF PB-COMPANY-ID = 'NCL'
 11158         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11159
 11160     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11161        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11162        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11163                                 > PL-LM-AMT (SUB2))
 11164        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11165           AND (PB-I-SIG-SW = 'Y')
 11166           CONTINUE
 11167        ELSE
 11168           MOVE ER-2638          TO WS-ERROR
 11169           PERFORM 9900-ERROR-FORMAT
 11170                                 THRU 9900-EXIT
 11171        END-IF
 11172     END-IF
 11173
 11174     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11175         IF  WS-ERROR    EQUAL    ER-2638
 11176             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11177                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11178                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11179                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11180                MOVE  ER-1910    TO  WS-ERROR
 11181                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11182
 11183     IF PB-COMPANY-ID = 'CRI'
 11184        IF WS-ERROR = ER-2638
 11185            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11186            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 203
* EL050.cbl
 11187            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11188
 11189     GO TO 3000-CONTINUE-EDIT.
 11190
 11191 0597-CHECK-NCL-AH-LIMITS.
 11192
 11193     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11194        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11195        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11196                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11197         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11198
 11199     IF APP-CERT-USED
 11200         IF SUB2  LESS THAN  +5
 11201             MOVE +5             TO SUB2
 11202             GO TO 0597-CHECK-AH-LIMITS.
 11203
 11204     MOVE ER-2638                TO WS-ERROR.
 11205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11206
 11207     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11208
 11209 0599-CHECK-NCL-SIG-SWITCH.
 11210
 11211     IF NOT APP-CERT-USED
 11212         GO TO 3000-CONTINUE-EDIT.
 11213
 11214     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11215        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11216        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11217        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11218         GO TO 3000-CONTINUE-EDIT.
 11219
 11220     IF SUB2 GREATER THAN +4
 11221         IF PL-LM-AGE (5) = ZEROS  AND
 11222            PL-LM-AGE (6) = ZEROS  AND
 11223            PL-LM-AGE (7) = ZEROS  AND
 11224            PL-LM-AGE (8) = ZEROS
 11225             MOVE  ER-1927        TO WS-ERROR
 11226             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11227             GO TO 3000-CONTINUE-EDIT
 11228         ELSE
 11229             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11230                 MOVE  ER-1920    TO WS-ERROR
 11231                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11232
 11233     IF PB-I-SIG-SW  = 'Y'
 11234       IF NOT PB-I-POLICY-ACCEPTED  AND
 11235          NOT PB-I-POLICY-DECLINED
 11236           MOVE 'U'               TO PB-BATCH-ENTRY
 11237           MOVE  ER-1926          TO WS-ERROR
 11238           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11239
 11240******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 204
* EL050.cbl
 11242
 11243 3000-CONTINUE-EDIT.
 11244
 11245     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11246     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11247     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11248     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11249     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11250
 11251     IF BROWSE-STARTED
 11252        PERFORM 9990-RETURN THRU 9990-EXIT
 11253        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11254
 11255     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11256        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11257        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11258        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11259*       MOVE 1                   TO DC-OPTION-CODE
 11260        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11261        IF DATE-CONVERSION-ERROR
 11262           MOVE ER-2622          TO WS-ERROR
 11263           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11264        ELSE
 11265           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11266              MOVE ER-2623       TO WS-ERROR
 11267              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11268           ELSE
 11269              MOVE ER-2622       TO WS-ERROR
 11270              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11271
 11272     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11273     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11274     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11275*    MOVE 1                      TO DC-OPTION-CODE.
 11276     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11277     IF DATE-CONVERSION-ERROR
 11278        GO TO 3005-EDIT-CONTINUE
 11279     ELSE
 11280        IF DC-ELAPSED-DAYS GREATER +180
 11281           MOVE ER-2613          TO WS-ERROR
 11282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11283        ELSE
 11284           IF DC-ELAPSED-DAYS GREATER +90
 11285              MOVE ER-2612       TO WS-ERROR
 11286              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11287           ELSE
 11288             IF DC-ELAPSED-DAYS GREATER +60
 11289                MOVE ER-2614     TO WS-ERROR
 11290                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11291
 11292 3005-EDIT-CONTINUE.
 11293
 11294     IF PB-CANCELLATION
 11295         GO TO 3700-EDIT-CANCEL.
 11296
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 205
* EL050.cbl
 11298******************************************************************
 11299*                  E D I T   I S S U E                           *
 11300******************************************************************
 11301
 11302 3020-EDIT-ISSUE.
 11303
 11304      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11305      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11306      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11307      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11308      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11309
 11310     IF PB-ISSUE-FORCE
 11311        OR PB-ISSUE-DATE-FORCED
 11312        OR PB-FORCE-OFF
 11313        OR PB-OVERCHARGE-FORCE
 11314        CONTINUE
 11315     ELSE
 11316        MOVE ER-2670             TO WS-ERROR
 11317        PERFORM 9900-ERROR-FORMAT
 11318                                 THRU 9900-EXIT
 11319     END-IF
 11320     .
 11321 3022-SET-POLICY-STATUS.
 11322
 11323     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11324
 11325     IF (PB-REISSUED-CERT)
 11326             OR
 11327        ((PB-COMPANY-ID NOT = 'DCC')
 11328         AND (PB-MONTHLY-CERT))
 11329         MOVE '5'                TO PB-I-ENTRY-STATUS
 11330         MOVE 'E'                TO PB-BATCH-ENTRY
 11331     END-IF
 11332
 11333     IF PB-COMPANY-ID = 'DCC'
 11334        IF PB-MONTHLY-CERT
 11335           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11336        END-IF
 11337        IF PB-CASH-CERT
 11338           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11339        END-IF
 11340     END-IF
 11341     IF PB-POLICY-IS-DECLINED
 11342         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11343     IF PB-POLICY-IS-VOIDED
 11344         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11345     IF PB-NEEDS-UNDERWRITING
 11346         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11347     IF PB-REIN-ONLY-CERT
 11348         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11349     IF PB-PREM-ACCTNG-ONLY
 11350         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11351
 11352     MOVE SPACE                  TO PB-I-OB-FLAG.
 11353
 11354     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11355         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 206
* EL050.cbl
 11356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11358
 11359     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11360        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11361           MOVE 'Z'             TO PB-I-OB-FLAG.
 11362
 11363     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11364        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11365           MOVE 'Z'             TO PB-I-OB-FLAG.
 11366
 11367     IF ACCOUNT-MAST-FOUND
 11368         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11369         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11370         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11371         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11372         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11373         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11374         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11375     END-IF
 11376
 11377     IF ACCOUNT-MAST-FOUND
 11378        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11379         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11380
 11381     IF (ACCOUNT-MAST-FOUND)
 11382        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11383        IF PB-REISSUED-CERT
 11384           CONTINUE
 11385        ELSE
 11386           MOVE ER-2608          TO WS-ERROR
 11387           PERFORM 9900-ERROR-FORMAT
 11388                                 THRU 9900-EXIT
 11389         END-IF
 11390     END-IF
 11391
 11392     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11393        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11394        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11395
 11396**********   DMD CUSTOM CODE FOLLOWS  **********
 11397 3024-EDIT-DMD-FIELDS.
 11398     IF PB-COMPANY-ID NOT = 'DMD'
 11399        GO TO 3025-EDIT-REINSURANCE.
 11400
 11401*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11402*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11403*** ERROR IF THEY ARE NOT EQUAL.
 11404
 11405     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11406     SET BIN-TO-GREG               TO TRUE.
 11407     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11408     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11409**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11410
 11411     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11412     SET BIN-TO-GREG               TO TRUE.
 11413     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 207
* EL050.cbl
 11414     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11415**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11416
 11417     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11418        MOVE ER-8116               TO WS-ERROR
 11419        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11420
 11421     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11422
 11423     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11424                                      WK-FULL-CERT-NO.
 11425     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11426
 11427     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11428
 11429     IF PB-VALID-LIFE
 11430        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11431     ELSE
 11432        IF PB-VALID-AH
 11433          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11434
 11435
 11436     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11437     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11438     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11439                                      DCUA-UNDRWRTR-CODE
 11440                                      DCUA-UNDRWRTR-GROUP-CODE
 11441                                      DCUA-RETURN-CODE.
 11442
 11443****************************************************************
 11444*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11445***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11446***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11447***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11448***   TO THIS RECORD.                                        ***
 11449****************************************************************
 11450     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11451     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11452     IF DCUA-SUCCESSFUL-PROCESS
 11453        GO TO 3024-EDIT-DL7-CONT.
 11454
 11455     IF DCUA-RETURN-CODE EQUAL '01'
 11456        MOVE ER-8110               TO WS-ERROR
 11457        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11459        GO TO 3024-EDIT-DL7-CONT.
 11460
 11461     IF DCUA-RETURN-CODE EQUAL '02'
 11462        MOVE ER-8111               TO WS-ERROR
 11463        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11465        GO TO 3024-EDIT-DL7-CONT.
 11466
 11467     IF DCUA-RETURN-CODE EQUAL '03'
 11468        MOVE ER-8074               TO WS-ERROR
 11469        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11471        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 208
* EL050.cbl
 11472
 11473     IF DCUA-RETURN-CODE EQUAL '04'
 11474        MOVE ER-8075               TO WS-ERROR
 11475        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11477        GO TO 3024-EDIT-DL7-CONT.
 11478
 11479     IF DCUA-RETURN-CODE EQUAL '05'
 11480        MOVE ER-8076               TO WS-ERROR
 11481        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11483        GO TO 3024-EDIT-DL7-CONT.
 11484
 11485     IF DCUA-RETURN-CODE EQUAL '06'
 11486        MOVE ER-8077               TO WS-ERROR
 11487        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11488        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11489        GO TO 3024-EDIT-DL7-CONT.
 11490
 11491     IF DCUA-RETURN-CODE EQUAL '07'
 11492        MOVE ER-8078               TO WS-ERROR
 11493        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11495        GO TO 3024-EDIT-DL7-CONT.
 11496
 11497     IF DCUA-RETURN-CODE EQUAL 'E1'
 11498        MOVE ER-8079               TO WS-ERROR
 11499        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11501        GO TO 3024-EDIT-DL7-CONT.
 11502
 11503     IF DCUA-RETURN-CODE EQUAL 'E2'
 11504        MOVE ER-8080               TO WS-ERROR
 11505        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507        GO TO 3024-EDIT-DL7-CONT.
 11508
 11509     IF DCUA-RETURN-CODE EQUAL 'E3'
 11510        MOVE ER-8098               TO WS-ERROR
 11511        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11513        GO TO 3024-EDIT-DL7-CONT.
 11514
 11515     IF DCUA-RETURN-CODE EQUAL 'C1'
 11516        MOVE ER-8099               TO WS-ERROR
 11517        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11519        GO TO 3024-EDIT-DL7-CONT.
 11520
 11521     IF DCUA-RETURN-CODE EQUAL 'U1'
 11522        MOVE ER-8109               TO WS-ERROR
 11523        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11525        GO TO 3024-EDIT-DL7-CONT.
 11526
 11527     IF DCUA-RETURN-CODE EQUAL 'N1'
 11528        MOVE ER-8112               TO WS-ERROR
 11529        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 209
* EL050.cbl
 11530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11531        GO TO 3024-EDIT-DL7-CONT.
 11532
 11533     IF DCUA-RETURN-CODE EQUAL 'N2'
 11534        MOVE ER-8113               TO WS-ERROR
 11535        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537        GO TO 3024-EDIT-DL7-CONT.
 11538
 11539     IF DCUA-RETURN-CODE EQUAL 'N3'
 11540        MOVE ER-8114               TO WS-ERROR
 11541        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11543        GO TO 3024-EDIT-DL7-CONT.
 11544
 11545     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11546     MOVE ER-8097                  TO WS-ERROR.
 11547     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11548     GO TO 3024-EDIT-DL7-CONT.
 11549
 11550 3024-EDIT-DL7-CONT.
 11551
 11552     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11553     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11554     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11555        NEXT SENTENCE
 11556     ELSE
 11557        MOVE ER-9263               TO WS-ERROR
 11558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11559
 11560******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11561******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11562     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11563        NEXT SENTENCE
 11564     ELSE
 11565        MOVE ER-8039               TO WS-ERROR
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11567
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 210
* EL050.cbl
 11569****************************************************************
 11570*** VALIDATE STATE  : DLO022                                 ***
 11571****************************************************************
 11572     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11573     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11574
 11575     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11576     IF DVSC-SUCCESSFUL-EDIT
 11577        GO TO 3024-EDIT-DL22-CONT.
 11578
 11579     IF DVSC-RETURN-CODE EQUAL '01'
 11580        MOVE ER-8300               TO WS-ERROR
 11581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        GO TO 3024-EDIT-DL22-CONT.
 11583
 11584     IF DVSC-RETURN-CODE EQUAL '02'
 11585        MOVE ER-8301               TO WS-ERROR
 11586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587        GO TO 3024-EDIT-DL22-CONT.
 11588
 11589     IF DVSC-RETURN-CODE EQUAL '03'
 11590        MOVE ER-8302               TO WS-ERROR
 11591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11592        GO TO 3024-EDIT-DL22-CONT.
 11593
 11594     IF DVSC-RETURN-CODE EQUAL 'N1'
 11595        MOVE ER-8304               TO WS-ERROR
 11596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11597        GO TO 3024-EDIT-DL22-CONT.
 11598
 11599     MOVE ER-8303                  TO WS-ERROR
 11600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11601
 11602 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 211
* EL050.cbl
 11604****************************************************************
 11605*** VALIDATE LOAN OFFICER : DLO021                           ***
 11606****************************************************************
 11607
 11608     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11609     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11610     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11611     IF DVLO-SUCCESSFUL-EDIT
 11612        GO TO 3024-EDIT-DL21-CONT.
 11613
 11614     IF DVLO-RETURN-CODE EQUAL '01'
 11615        MOVE ER-8081               TO WS-ERROR
 11616        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11617        GO TO 3024-EDIT-DL21-CONT.
 11618
 11619     IF DVLO-RETURN-CODE EQUAL '02'
 11620        MOVE ER-8082               TO WS-ERROR
 11621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11622        GO TO 3024-EDIT-DL21-CONT.
 11623
 11624     IF DVLO-RETURN-CODE EQUAL '03'
 11625        MOVE ER-8083               TO WS-ERROR
 11626        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11627        GO TO 3024-EDIT-DL21-CONT.
 11628
 11629     IF DVLO-RETURN-CODE EQUAL '04'
 11630        MOVE ER-8084               TO WS-ERROR
 11631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11632        GO TO 3024-EDIT-DL21-CONT.
 11633
 11634     IF DVLO-RETURN-CODE EQUAL '05'
 11635        MOVE ER-8085               TO WS-ERROR
 11636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11637        GO TO 3024-EDIT-DL21-CONT.
 11638
 11639     MOVE ER-7825                  TO WS-ERROR
 11640     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11641     GO TO 3024-EDIT-DL21-CONT.
 11642
 11643 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 212
* EL050.cbl
 11645
 11646****************************************************************
 11647*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11648****************************************************************
 11649
 11650     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11651     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11652     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11653     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11654     IF DIPF-SUCCESSFUL-EDIT
 11655        GO TO 3024-EDIT-DL02-CONT.
 11656
 11657     IF DIPF-RETURN-CODE EQUAL '01'
 11658        MOVE ER-8086               TO WS-ERROR
 11659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11660        GO TO 3024-EDIT-DL02-CONT.
 11661
 11662     IF DIPF-RETURN-CODE EQUAL '02'
 11663        MOVE ER-8087               TO WS-ERROR
 11664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11665        GO TO 3024-EDIT-DL02-CONT.
 11666
 11667     IF DIPF-RETURN-CODE EQUAL '03'
 11668        MOVE ER-8088               TO WS-ERROR
 11669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11670        GO TO 3024-EDIT-DL02-CONT.
 11671
 11672     MOVE ER-8095                  TO WS-ERROR
 11673     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11674     GO TO 3024-EDIT-DL02-CONT.
 11675
 11676 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 213
* EL050.cbl
 11678
 11679****************************************************************
 11680*** VALIDATE BANK ID : DLO003                                ***
 11681****************************************************************
 11682
 11683     MOVE WK-GREG-CENT           TO WCG-CENT.
 11684     MOVE WK-GREG-YYMM           TO WCG-REST.
 11685     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11686        MOVE ER-8040               TO WS-ERROR
 11687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11688
 11689     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11690     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11691     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11692     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11693     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11694     IF DVBI-SUCCESSFUL-EDIT
 11695        GO TO 3024-EDIT-DL03-CONT.
 11696
 11697     IF DVBI-RETURN-CODE EQUAL '01'
 11698        MOVE ER-8089               TO WS-ERROR
 11699        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11700        GO TO 3024-EDIT-DL03-CONT.
 11701
 11702     IF DVBI-RETURN-CODE EQUAL '02'
 11703        MOVE ER-8090               TO WS-ERROR
 11704        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11705        GO TO 3024-EDIT-DL03-CONT.
 11706
 11707     IF DVBI-RETURN-CODE EQUAL '03'
 11708        MOVE ER-8091               TO WS-ERROR
 11709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11710        GO TO 3024-EDIT-DL03-CONT.
 11711
 11712     IF DVBI-RETURN-CODE EQUAL '04'
 11713        MOVE ER-8092               TO WS-ERROR
 11714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11715        GO TO 3024-EDIT-DL03-CONT.
 11716
 11717     IF DVBI-RETURN-CODE EQUAL '05'
 11718        MOVE ER-8093               TO WS-ERROR
 11719        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11720        GO TO 3024-EDIT-DL03-CONT.
 11721
 11722     IF DVBI-RETURN-CODE EQUAL '06'
 11723        MOVE ER-8094               TO WS-ERROR
 11724        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11725        GO TO 3024-EDIT-DL03-CONT.
 11726
 11727     MOVE ER-8096                  TO WS-ERROR
 11728     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11729     GO TO 3024-EDIT-DL03-CONT.
 11730
 11731 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 214
* EL050.cbl
 11733
 11734     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11735        NEXT SENTENCE
 11736     ELSE
 11737        MOVE ER-8042               TO WS-ERROR
 11738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11739
 11740     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11741     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11742     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11743
 11744     IF DMPF-RETURN-CODE = '01'
 11745        MOVE ER-8067               TO WS-ERROR
 11746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747        GO TO 3024-EDIT-DL01-CONT.
 11748
 11749     IF DMPF-RETURN-CODE = '02'
 11750        MOVE ER-8068               TO WS-ERROR
 11751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752        GO TO 3024-EDIT-DL01-CONT.
 11753
 11754     IF DMPF-RETURN-CODE = '03'
 11755        MOVE ER-8069               TO WS-ERROR
 11756        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11757        GO TO 3024-EDIT-DL01-CONT.
 11758
 11759     IF DMPF-RETURN-CODE = 'E1'
 11760        MOVE ER-8070               TO WS-ERROR
 11761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11762        GO TO 3024-EDIT-DL01-CONT.
 11763
 11764     IF DMPF-RETURN-CODE = 'N1'
 11765        MOVE ER-8071               TO WS-ERROR
 11766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11767        GO TO 3024-EDIT-DL01-CONT.
 11768
 11769     IF DMPF-RETURN-CODE NOT = 'OK'
 11770        MOVE ER-8072               TO WS-ERROR
 11771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11772
 11773 3024-EDIT-DL01-CONT.
 11774******************************************************************
 11775***  VALIDATES RATE CODES : DLO017                             ***
 11776******************************************************************
 11777
 11778      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11779      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11780      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11781      IF DVRC-SUCCESSFUL-EDIT
 11782        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11783        GO TO 3024-CHECK-VALID-RATE.
 11784
 11785      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11786
 11787      IF DVRC-RETURN-CODE EQUAL '01'
 11788         MOVE ER-7817                   TO WS-ERROR
 11789         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11790         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 215
* EL050.cbl
 11791
 11792      IF DVRC-RETURN-CODE EQUAL '02'
 11793         MOVE ER-7818                   TO WS-ERROR
 11794         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11795         GO TO 3025-EDIT-REINSURANCE.
 11796
 11797      IF DVRC-RETURN-CODE EQUAL '03'
 11798         MOVE ER-7819                   TO WS-ERROR
 11799         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11800         GO TO 3025-EDIT-REINSURANCE.
 11801
 11802       MOVE ER-7820                     TO WS-ERROR.
 11803       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11804       GO TO 3025-EDIT-REINSURANCE.
 11805
 11806******************************************************************
 11807***  GET PREMIUM RATES : DLO011                                ***
 11808******************************************************************
 11809
 11810 3024-CHECK-VALID-RATE.
 11811
 11812     IF VALID-RATE-CODE
 11813        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11814        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11815        MOVE SPACES                TO DPRB-RETURN-CODE
 11816        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11817     ELSE
 11818         GO TO 3025-EDIT-REINSURANCE.
 11819
 11820      IF DPRB-SUCCESSFUL-PROCESS
 11821         IF PB-VALID-LIFE
 11822             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11823             GO TO 3025-EDIT-REINSURANCE
 11824         ELSE
 11825             IF PB-VALID-AH
 11826                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11827                 GO TO 3025-EDIT-REINSURANCE.
 11828
 11829      IF DPRB-RETURN-CODE EQUAL '01'
 11830         MOVE ER-7812                   TO WS-ERROR
 11831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11832         GO TO 3025-EDIT-REINSURANCE.
 11833
 11834      IF DPRB-RETURN-CODE EQUAL '02'
 11835         MOVE ER-7813                   TO WS-ERROR
 11836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11837         GO TO 3025-EDIT-REINSURANCE.
 11838
 11839      IF DPRB-RETURN-CODE EQUAL '03'
 11840         MOVE ER-7814                   TO WS-ERROR
 11841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11842         GO TO 3025-EDIT-REINSURANCE.
 11843
 11844      IF DPRB-RETURN-CODE EQUAL '04'
 11845         IF NOT DPRB-1ST-TIME
 11846            MOVE ER-7815                   TO WS-ERROR
 11847            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11848            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 216
* EL050.cbl
 11849          ELSE
 11850         IF PB-VALID-LIFE
 11851            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11852          ELSE
 11853            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11854         END-IF
 11855         MOVE SPACES                TO DOCC-RETURN-CODE
 11856         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11857         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11858         IF DOCC-RETURN-CODE = 'OK'
 11859             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11860             GO TO 3024-CHECK-VALID-RATE
 11861           ELSE
 11862             MOVE ER-7823               TO WS-ERROR
 11863             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11864             GO TO 3025-EDIT-REINSURANCE.
 11865
 11866       MOVE ER-7816                     TO WS-ERROR.
 11867       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11868       GO TO 3025-EDIT-REINSURANCE.
 11869
 11870**********   DMD CUSTOM CODE ABOVE    **********
 11871
 11872 3025-EDIT-REINSURANCE.
 11873     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11874         GO TO 3027-EDIT-CONTINUE.
 11875
 11876     MOVE LOW-VALUES               TO ERREIN-KEY.
 11877     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11878     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11879                                      REIN-CODE-2
 11880                                      REIN-CODE-3.
 11881     MOVE 'A'                      TO REIN-TYPE.
 11882
 11883     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11884
 11885     MOVE '3026' TO REIN-SW.
 11886     MOVE ' '                   TO WS-REIN-READ-SW.
 11887
 11888     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11889     IF REIN-TABLE-NOT-FOUND
 11890         GO TO 3026-NO-SPEC-TABLE.
 11891
 11892     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11893     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11894                                   WS-NSP-ST-CD-LF.
 11895     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11896                                   WS-NSP-ST-CD-AH.
 11897
 11898     GO TO 3040-EDIT-CONTINUE.
 11899
 11900 3026-NO-SPEC-TABLE.
 11901
 11902     MOVE ER-2664                TO WS-ERROR.
 11903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11904     GO TO 3040-EDIT-CONTINUE.
 11905
 11906 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 217
* EL050.cbl
 11907
 11908     IF PB-I-REIN-TABLE = SPACES
 11909       GO TO 3040-EDIT-CONTINUE.
 11910
 11911     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11912          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11913          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11914           GO TO 3040-EDIT-CONTINUE.
 11915
 11916     MOVE LOW-VALUES            TO ERREIN-KEY.
 11917     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11918     MOVE 'A'                   TO REIN-TYPE.
 11919     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11920
 11921     MOVE '3028'                TO REIN-SW.
 11922     MOVE ' '                   TO WS-REIN-READ-SW.
 11923
 11924     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11925     IF REIN-TABLE-NOT-FOUND
 11926         GO TO 3028-NO-REIN-TABLE.
 11927
 11928     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11929     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11930                                   WS-NSP-ST-CD-LF.
 11931     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11932                                   WS-NSP-ST-CD-AH.
 11933
 11934     GO TO 3040-EDIT-CONTINUE.
 11935
 11936 3028-NO-REIN-TABLE.
 11937
 11938     MOVE ER-2615                TO WS-ERROR.
 11939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11940     GO TO 3040-EDIT-CONTINUE.
 11941
 11942 3040-EDIT-CONTINUE.
 11943
 11944     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11945         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11946
 11947     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11948         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11949
 11950     IF (NOT PB-REISSUED-CERT)
 11951        AND (NOT PB-MONTHLY-CERT)
 11952        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11953            MOVE '001'           TO PB-I-LF-TERM
 11954            MOVE 'M'             TO PB-I-INSURED-SEX.
 11955
 11956     IF (NOT PB-REISSUED-CERT)
 11957        AND (NOT PB-MONTHLY-CERT)
 11958        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11959            MOVE '001'           TO PB-I-AH-TERM
 11960            MOVE 'M'             TO PB-I-INSURED-SEX.
 11961
 11962 3040-EDIT-1ST-PMT-DT.
 11963     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11964     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 218
* EL050.cbl
 11965         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11966
 11967******************************************************************
 11968*                                                                *
 11969*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11970*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11971*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11972*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11973*                                                                *
 11974******************************************************************
 11975
 11976     IF PB-EFF-DT-PROCESSING
 11977        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11978                                    PB-I-LF-EXPIRE-DT
 11979                                    PB-I-AH-EXPIRE-DT
 11980        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11981        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11982        MOVE ZERO                TO DC-ELAPSED-DAYS
 11983        MOVE +1                  TO DC-ELAPSED-MONTHS
 11984        SET BIN-PLUS-ELAPSED     TO TRUE
 11985*       MOVE 6                   TO DC-OPTION-CODE
 11986        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11987        IF NO-CONVERSION-ERROR
 11988           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11989
 11990******************************************************************
 11991*                                                                *
 11992*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11993*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11994*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11995*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11996*                                                                *
 11997******************************************************************
 11998
 11999     IF PB-EXT-DAYS-PROCESSING
 12000          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12001                                         PB-I-LF-EXPIRE-DT
 12002                                         PB-I-AH-EXPIRE-DT
 12003          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12004          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12005          MOVE +1                     TO DC-ELAPSED-MONTHS
 12006          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12007          SET BIN-PLUS-ELAPSED        TO TRUE
 12008*         MOVE 6                      TO DC-OPTION-CODE
 12009          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12010          IF NO-CONVERSION-ERROR
 12011             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12012
 12013******************************************************************
 12014*                                                                *
 12015*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12016*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12017*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12018*        (EXPIRE DATE - (TERM -1))  *  -1.
 12019*                                                                *
 12020******************************************************************
 12021
 12022     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 219
* EL050.cbl
 12023        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12024           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12025              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12026              MOVE PB-I-AH-TERM      TO WS-TERM
 12027           ELSE
 12028              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12029              MOVE PB-I-LF-TERM      TO WS-TERM
 12030        ELSE
 12031           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12032              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12033              MOVE PB-I-LF-TERM      TO WS-TERM
 12034           ELSE
 12035              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12036              MOVE PB-I-AH-TERM      TO WS-TERM.
 12037
 12038     IF PB-EXPIRE-DT-PROCESSING
 12039        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12040        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12041        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12042        MOVE ZERO                TO DC-ELAPSED-DAYS
 12043                                    DC-ODD-DAYS-OVER
 12044          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12045          SET BIN-PLUS-ELAPSED    TO TRUE
 12046*         MOVE 6                  TO DC-OPTION-CODE
 12047          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12048          IF NO-CONVERSION-ERROR
 12049             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12050
 12051******************************************************************
 12052*                                                                *
 12053*            1ST PAYMENT DATE PROCESSING                         *
 12054*                                                                *
 12055******************************************************************
 12056
 12057     IF PB-1ST-PMT-DT-PROCESSING
 12058        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12059                                    PB-I-AH-EXPIRE-DT
 12060        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12061
 12062     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12063         NEXT SENTENCE
 12064     ELSE
 12065         MOVE ER-2680                 TO WS-ERROR
 12066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12067         GO TO 3060-ORIG-TERM-CHECK.
 12068
 12069     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12070     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12071     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12072*    MOVE 1                      TO DC-OPTION-CODE.
 12073     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12074                                    DC-ELAPSED-DAYS
 12075                                    DC-ODD-DAYS-OVER.
 12076
 12077     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12078
 12079     IF DATE-CONVERSION-ERROR
 12080        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 220
* EL050.cbl
 12081
 12082     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12083     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12084        AND (WS-LF-COVERAGE-TYPE = 'L')
 12085        IF (DC-ELAPSED-MONTHS > 1)
 12086                      OR
 12087           ((DC-ELAPSED-MONTHS = 1)
 12088           AND (DC-ODD-DAYS-OVER > 0))
 12089           MOVE ER-2882          TO WS-ERROR
 12090           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12091        END-IF
 12092     END-IF
 12093     if dc-elapsed-months > 0
 12094        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12095        + dc-odd-days-over
 12096     end-if
 12097     IF PB-EXT-DAYS-PROCESSING
 12098        CONTINUE
 12099     ELSE
 12100        IF DC-ELAPSED-MONTHS = +0
 12101           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12102        ELSE
 12103           IF (WS-LF-EARNINGS-CALC = '4')
 12104              AND (DC-ELAPSED-MONTHS > ZERO)
 12105              AND (DC-ELAPSED-DAYS > ZERO)
 12106              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12107           ELSE
 12108              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12109                                 THRU 6499-EXIT
 12110              MOVE WS-ODD-DAYS-OVER
 12111                                 TO PB-I-EXTENTION-DAYS
 12112           END-IF
 12113        END-IF
 12114     END-IF
 12115******************************************************************
 12116*                                                                *
 12117*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12118*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12119*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12120*            AND ANY ODD DAYS.                                   *
 12121*                                                                *
 12122******************************************************************
 12123
 12124     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12125                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12126     IF WS-LF-EARNINGS-CALC NOT = '4'
 12127        IF DC-ELAPSED-DAYS > ZEROS
 12128           MOVE ER-2681          TO WS-ERROR
 12129           PERFORM 9900-ERROR-FORMAT
 12130                                 THRU 9900-EXIT
 12131        END-IF
 12132     END-IF
 12133
 12134     IF WS-LF-EARNINGS-CALC NOT = '4'
 12135        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12136           MOVE ER-2681          TO WS-ERROR
 12137           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12138
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 221
* EL050.cbl
 12139     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12140        (PB-I-LF-TERM NOT = ZERO) AND
 12141         NOT NO-LIFE-COVERAGE
 12142          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12143          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12144          IF WS-LF-EARNINGS-CALC = '4'
 12145             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12146             PB-I-PAY-FREQUENCY
 12147          END-IF
 12148          MOVE ZERO              TO DC-ELAPSED-DAYS
 12149                                    DC-ODD-DAYS-OVER
 12150          MOVE 1                 TO DC-END-OF-MONTH
 12151          SET BIN-PLUS-ELAPSED        TO TRUE
 12152*         MOVE 6                 TO DC-OPTION-CODE
 12153          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12154          IF NO-CONVERSION-ERROR
 12155             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12156             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12157                (WS-LF-SPECIAL-CALC-CD = 'L')
 12158                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12159                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12160                  MOVE +1             TO DC-ELAPSED-MONTHS
 12161                  SET BIN-PLUS-ELAPSED  TO TRUE
 12162*                 MOVE 6              TO DC-OPTION-CODE
 12163                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12164                  IF NO-CONVERSION-ERROR
 12165                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12166
 12167* okay, i had to move the new att age edit down here because the
 12168* expiration date could get recalculated and i need the exp date
 12169     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12170        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12171        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12172        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12173           AND ZEROS
 12174           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12175           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12176           SET ELAPSED-BETWEEN-BIN TO TRUE
 12177           PERFORM 8500-DATE-CONVERT
 12178                                 THRU 8500-EXIT
 12179           IF NO-CONVERSION-ERROR
 12180              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12181                 MOVE ER-2669       TO WS-ERROR
 12182*                PERFORM 9900-ERROR-FORMAT
 12183*                                THRU 9900-EXIT
 12184              END-IF
 12185           END-IF
 12186        ELSE
 12187           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12188           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12189              MOVE ER-2669       TO WS-ERROR
 12190*             PERFORM 9900-ERROR-FORMAT
 12191*                                THRU 9900-EXIT
 12192           ELSE
 12193              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12194                 MOVE ER-1570    TO WS-ERROR
 12195                 PERFORM 9900-ERROR-FORMAT
 12196                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 222
* EL050.cbl
 12197              END-IF
 12198           END-IF
 12199        END-IF
 12200        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12201           AND ZEROS
 12202           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12203           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12204           SET ELAPSED-BETWEEN-BIN TO TRUE
 12205           PERFORM 8500-DATE-CONVERT
 12206                                 THRU 8500-EXIT
 12207           IF NO-CONVERSION-ERROR
 12208              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12209                 MOVE ER-2669       TO WS-ERROR
 12210*                PERFORM 9900-ERROR-FORMAT
 12211*                                THRU 9900-EXIT
 12212              END-IF
 12213           END-IF
 12214        ELSE
 12215           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12216             (PB-I-LF-TERM / 12)
 12217           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12218              MOVE ER-2669       TO WS-ERROR
 12219*             PERFORM 9900-ERROR-FORMAT
 12220*                                THRU 9900-EXIT
 12221           ELSE
 12222              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12223                 MOVE ER-1571    TO WS-ERROR
 12224                 PERFORM 9900-ERROR-FORMAT
 12225                                 THRU 9900-EXIT
 12226              END-IF
 12227           END-IF
 12228        END-IF
 12229        IF WS-ERROR = ER-2669
 12230           PERFORM 9900-ERROR-FORMAT
 12231                                 THRU 9900-EXIT
 12232        END-IF
 12233     END-IF
 12234     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12235        (PB-I-AH-TERM NOT = ZERO) AND
 12236         NOT NO-AH-COVERAGE
 12237          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12238             AND (PB-COMPANY-ID = 'DCC')
 12239             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12240             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12241          ELSE
 12242             IF WS-LF-EARNINGS-CALC = '4'
 12243                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12244                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12245                PB-I-PAY-FREQUENCY
 12246             ELSE
 12247                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12248                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12249             END-IF
 12250          END-IF
 12251          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12252                                         DC-ODD-DAYS-OVER
 12253          MOVE 1                      TO DC-END-OF-MONTH
 12254          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 223
* EL050.cbl
 12255*         MOVE 6                      TO DC-OPTION-CODE
 12256          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12257          IF NO-CONVERSION-ERROR
 12258             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12259     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12260        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12261        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12262        IF PB-I-BIRTHDAY > LOW-VALUES
 12263           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12264           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12265           SET ELAPSED-BETWEEN-BIN TO TRUE
 12266           PERFORM 8500-DATE-CONVERT
 12267                                 THRU 8500-EXIT
 12268           IF NO-CONVERSION-ERROR
 12269              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12270                 MOVE ER-3054       TO WS-ERROR
 12271*                PERFORM 9900-ERROR-FORMAT
 12272*                                THRU 9900-EXIT
 12273              END-IF
 12274           END-IF
 12275        ELSE
 12276           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12277           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12278              MOVE ER-3054       TO WS-ERROR
 12279*             PERFORM 9900-ERROR-FORMAT
 12280*                                THRU 9900-EXIT
 12281           END-IF
 12282        END-IF
 12283        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12284           AND ZEROS
 12285           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12286           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12287           SET ELAPSED-BETWEEN-BIN TO TRUE
 12288           PERFORM 8500-DATE-CONVERT
 12289                                 THRU 8500-EXIT
 12290           IF NO-CONVERSION-ERROR
 12291              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12292                 MOVE ER-3054       TO WS-ERROR
 12293*                PERFORM 9900-ERROR-FORMAT
 12294*                                THRU 9900-EXIT
 12295              END-IF
 12296           END-IF
 12297        ELSE
 12298           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12299             (PB-I-AH-TERM / 12)
 12300           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12301              MOVE ER-3054       TO WS-ERROR
 12302*             PERFORM 9900-ERROR-FORMAT
 12303*                                THRU 9900-EXIT
 12304           END-IF
 12305        END-IF
 12306        IF WS-ERROR = ER-3054
 12307           PERFORM 9900-ERROR-FORMAT
 12308                                 THRU 9900-EXIT
 12309        END-IF
 12310     END-IF
 12311     MOVE SPACE                       TO DC-END-OF-MONTH.
 12312
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 224
* EL050.cbl
 12313     IF PB-COMPANY-ID = 'NCB'
 12314        GO TO 3040-EDIT-EXTENSION-DAYS.
 12315
 12316     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12317       AND
 12318        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12319        NEXT SENTENCE
 12320     ELSE
 12321        GO TO 3040-EDIT-EXTENSION-DAYS.
 12322
 12323     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12324        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12325        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12326     ELSE
 12327        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12328        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12329
 12330     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12331*    MOVE '1'      TO DC-OPTION-CODE
 12332     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12333     IF (NO-CONVERSION-ERROR)
 12334        AND (DC-ELAPSED-MONTHS > +1)
 12335        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12336        MOVE ER-2668   TO WS-ERROR
 12337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12338
 12339 3040-EDIT-EXTENSION-DAYS.
 12340
 12341     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12342        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12343         GO TO 3050-EDIT-TERM-IN-DAYS
 12344     ELSE
 12345         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12346
 12347     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12348         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12349     ELSE
 12350        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12351           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12352           MOVE ER-2681         TO WS-ERROR
 12353           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12354
 12355     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12356        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12357        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12358         GO TO 3060-ORIG-TERM-CHECK.
 12359
 12360     GO TO 3060-ORIG-TERM-CHECK.
 12361
 12362 3050-EDIT-TERM-IN-DAYS.
 12363
 12364     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12365
 12366     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12367         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12368     ELSE
 12369         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12370            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 225
* EL050.cbl
 12371            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12372
 12373     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12374                                       REMAINDER WS-WORK-TERM.
 12375     IF WS-WORK-TERM GREATER THAN ZERO
 12376         ADD +1 TO PB-I-LF-TERM.
 12377
 12378     IF NOT NO-AH-COVERAGE
 12379         MOVE ER-2684            TO WS-ERROR
 12380         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12381
 12382
 12383 3060-ORIG-TERM-CHECK.
 12384
 12385******************************************************************
 12386*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12387******************************************************************
 12388
 12389     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12390        NEXT SENTENCE
 12391     ELSE
 12392        IF NOT NO-LIFE-COVERAGE
 12393           IF PB-I-LF-TERM NUMERIC
 12394              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12395              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12396              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12397                  NEXT SENTENCE
 12398           ELSE
 12399              MOVE ER-2647       TO WS-ERROR
 12400              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12401
 12402     IF NOT NO-AH-COVERAGE
 12403         IF PB-I-AH-TERM NUMERIC
 12404            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12405            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12406            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12407             NEXT SENTENCE
 12408          ELSE
 12409              MOVE ER-2658       TO WS-ERROR
 12410              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12411
 12412     IF PB-COMPANY-ID = 'NCB'
 12413        GO TO 3070-LOAN-TERM-CHECK.
 12414
 12415     IF POLICY-HAS-AH
 12416       AND
 12417        POLICY-HAS-LIFE
 12418       AND
 12419        PB-I-LF-TERM NUMERIC
 12420       AND
 12421        PB-I-AH-TERM NUMERIC
 12422        NEXT SENTENCE
 12423     ELSE
 12424        GO TO 3070-LOAN-TERM-CHECK.
 12425
 12426     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12427     IF WS-TEX-FACT-2 LESS THAN +0
 12428        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 226
* EL050.cbl
 12429
 12430     IF WS-TEX-FACT-2 GREATER THAN +1
 12431        MOVE ER-2668             TO WS-ERROR
 12432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12433
 12434 3070-LOAN-TERM-CHECK.
 12435
 12436     IF (WS-LF-BENEFIT-CD = ZERO)
 12437         OR (NO-LF-BENEFIT-MATCH)
 12438            GO TO 3125-EDIT-PMT-FREQ.
 12439*    IF PB-COMPANY-ID NOT = 'DCC'
 12440*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12441*          AND 'V' AND 'W' AND 'X'
 12442*          GO TO 3125-EDIT-PMT-FREQ
 12443*       END-IF
 12444*    ELSE
 12445*       IF WS-AH-DCC-TRUNC = 'T'
 12446*          CONTINUE
 12447*       ELSE
 12448*          GO TO 3125-EDIT-PMT-FREQ
 12449*       END-IF
 12450*    END-IF
 12451     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12452                    OR
 12453        ((PB-COMPANY-ID = 'DCC')
 12454        AND (WS-AH-DCC-TRUNC = 'T'))
 12455        CONTINUE
 12456     ELSE
 12457        GO TO 3125-EDIT-PMT-FREQ
 12458     END-IF
 12459     IF PB-I-LOAN-TERM NOT NUMERIC
 12460         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12461
 12462     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12463        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12464*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12465        PB-I-LOAN-TERM NOT GREATER THAN +360
 12466         NEXT SENTENCE
 12467     ELSE
 12468         MOVE ER-2648            TO WS-ERROR
 12469         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12470
 12471     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12472        MOVE ER-3058             TO WS-ERROR
 12473        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12474     end-if
 12475
 12476     IF WS-STATE-ABBREVIATION = 'NC'
 12477        IF PB-I-LOAN-TERM > +59
 12478           CONTINUE
 12479        ELSE
 12480           MOVE ER-2792          TO WS-ERROR
 12481           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12482        END-IF
 12483     END-IF
 12484
 12485     .
 12486 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 227
* EL050.cbl
 12487     IF (WS-LF-BENEFIT-CD = ZERO)
 12488         OR (NO-LF-BENEFIT-MATCH)
 12489            GO TO 3127-EDIT-LOAN-OFFICER.
 12490     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12491                    OR
 12492        ((PB-COMPANY-ID = 'DCC')
 12493        AND (WS-AH-DCC-TRUNC = 'T'))
 12494                    OR
 12495         (PB-COMPANY-ID = 'AHL')
 12496        CONTINUE
 12497     ELSE
 12498        IF (PB-I-LOAN-TERM > ZEROS)
 12499           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12500           MOVE ER-1575          TO WS-ERROR
 12501           PERFORM 9900-ERROR-FORMAT
 12502                                 THRU 9900-EXIT
 12503        END-IF
 12504     END-IF
 12505     IF WS-LF-EARNINGS-CALC NOT = '4'
 12506         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12507            MOVE ER-2653         TO WS-ERROR
 12508            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12509            GO TO 3127-EDIT-LOAN-OFFICER
 12510         ELSE
 12511            GO TO 3127-EDIT-LOAN-OFFICER.
 12512
 12513     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12514         MOVE ER-2655            TO WS-ERROR
 12515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12516         GO TO 3127-EDIT-LOAN-OFFICER.
 12517
 12518     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12519         MOVE ER-2654            TO WS-ERROR
 12520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12521         GO TO 3127-EDIT-LOAN-OFFICER.
 12522
 12523     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12524         GIVING WS-TEX-FACT-2
 12525             REMAINDER WS-TEX-FACT-3.
 12526
 12527*    IF WS-TEX-FACT-3 NOT = ZERO
 12528*       MOVE ER-2654             TO WS-ERROR
 12529*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12530
 12531
 12532 3127-EDIT-LOAN-OFFICER.
 12533
 12534     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12535        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12536           MOVE ER-2690          TO WS-ERROR
 12537           PERFORM 9900-ERROR-FORMAT
 12538                                 THRU 9900-EXIT
 12539        ELSE
 12540           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12541           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12542           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12543           MOVE PB-SV-STATE      TO LOFC-STATE
 12544           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 228
* EL050.cbl
 12545           MOVE PB-I-LOAN-OFFICER
 12546                                 TO LOFC-CODE
 12547           PERFORM 8586-READ-LOAN-OFFICER
 12548                                 THRU 8586-EXIT
 12549           IF (NOT LOFC-MASTER-FOUND)
 12550              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12551              MOVE ER-3006       TO WS-ERROR
 12552              PERFORM 9900-ERROR-FORMAT
 12553                                 THRU 9900-EXIT
 12554           END-IF
 12555        END-IF
 12556     END-IF
 12557     .
 12558 3129-EDIT-APR.
 12559
 12560     IF (WS-LF-BENEFIT-CD = ZERO)
 12561        OR (NO-LF-BENEFIT-MATCH)
 12562        IF PB-COMPANY-ID NOT = 'DCC'
 12563           GO TO 3130-EDIT-AGE
 12564*       ELSE
 12565*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12566*             GO TO 3130-EDIT-AGE
 12567*          END-IF
 12568        END-IF
 12569     END-IF
 12570
 12571     IF (WS-STATE-ABBREVIATION = 'OH')
 12572         AND (PB-I-RATE-CLASS NOT = 'L ')
 12573         AND (PB-I-LF-TERM GREATER THAN 60)
 12574         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12575         GO TO 3129-APR-CONT.
 12576
 12577     IF (WS-STATE-ABBREVIATION = 'RI')
 12578         AND (PB-I-LF-TERM GREATER THAN 60)
 12579         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12580         GO TO 3129-APR-CONT.
 12581
 12582     IF (WS-STATE-ABBREVIATION = 'UT')
 12583         AND (PB-I-LF-TERM GREATER THAN 62)
 12584         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12585         AND (PB-CERT-EFF-DT LESS WS-830901)
 12586         GO TO 3129-APR-CONT.
 12587
 12588     IF PB-COMPANY-ID = 'LAP'
 12589        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12590           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12591              MOVE ER-2656         TO WS-ERROR
 12592              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593              GO TO 3130-EDIT-AGE.
 12594
 12595     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12596        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12597        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12598        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12599        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12600        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12601         GO TO 3130-EDIT-AGE.
 12602
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 229
* EL050.cbl
 12603 3129-APR-CONT.
 12604     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12605         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12606         GO TO 3130-EDIT-AGE.
 12607
 12608     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12609         WS-AH-BENEFIT-CD (1:1) = 'S')
 12610        AND (PB-COMPANY-ID = 'DCC')
 12611        AND (PB-I-LOAN-APR = ZERO)
 12612        MOVE ER-2657             TO WS-ERROR
 12613        PERFORM 9900-ERROR-FORMAT
 12614                                 THRU 9900-EXIT
 12615        GO TO 3130-EDIT-AGE
 12616     END-IF
 12617*    IF PB-I-LOAN-APR = ZERO
 12618*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12619*    END-IF
 12620
 12621     if pb-i-loan-apr = +99.9999
 12622        move er-2656             to ws-error
 12623        PERFORM 9900-ERROR-FORMAT
 12624                                 THRU 9900-EXIT
 12625        GO TO 3130-EDIT-AGE
 12626     end-if
 12627*    IF PB-I-LOAN-APR = ZERO
 12628*       MOVE ER-2656             TO WS-ERROR
 12629*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12630*       GO TO 3130-EDIT-AGE.
 12631
 12632*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12633     if pb-i-loan-apr not = +99.9999
 12634        IF PB-I-LOAN-APR > +30.000
 12635           MOVE ER-2657          TO WS-ERROR
 12636           PERFORM 9900-ERROR-FORMAT
 12637                                 THRU 9900-EXIT
 12638        end-if
 12639     end-if
 12640     .
 12641 3130-EDIT-AGE.
 12642
 12643******************************************************************
 12644*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12645******************************************************************
 12646
 12647     IF NOT NO-LIFE-COVERAGE
 12648        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12649           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12650               MOVE ER-2628             TO WS-ERROR
 12651               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12652
 12653     IF NOT NO-AH-COVERAGE
 12654        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12655           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12656               MOVE ER-2628         TO WS-ERROR
 12657               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12658
 12659 3133-SEX-CODE.
 12660     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 230
* EL050.cbl
 12661         IF WS-DEFAULT-SEX = 'M'
 12662             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12663          ELSE
 12664             IF WS-DEFAULT-SEX = 'F'
 12665             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12666
 12667     IF PB-I-INSURED-SEX = '1'
 12668         MOVE 'M' TO PB-I-INSURED-SEX.
 12669
 12670     IF PB-I-INSURED-SEX = '2'
 12671         MOVE 'F' TO PB-I-INSURED-SEX.
 12672
 12673 3134-SIG-SW-EDIT.
 12674     IF PB-I-SIG-SW = SPACE
 12675         MOVE 'N'                TO  PB-I-SIG-SW.
 12676
 12677     IF PB-COMPANY-ID = 'NCL'
 12678         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12679             NEXT SENTENCE
 12680         ELSE
 12681             MOVE ER-1923        TO  WS-ERROR
 12682             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12683     ELSE
 12684     IF PB-COMPANY-ID = 'CRI'
 12685         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12686             NEXT SENTENCE
 12687         ELSE
 12688             MOVE ER-2606        TO  WS-ERROR
 12689             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12690     ELSE
 12691     IF PB-COMPANY-ID = 'TMS'
 12692         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12693             NEXT SENTENCE
 12694         ELSE
 12695             MOVE ER-2689        TO  WS-ERROR
 12696             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12697     ELSE
 12698         IF PB-I-SIG-SW = 'Y' OR 'N'
 12699             NEXT SENTENCE
 12700         ELSE
 12701             MOVE ER-2651        TO  WS-ERROR
 12702             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12703
 12704     IF PB-COMPANY-ID = 'FLA'
 12705         IF (WS-EDIT-AGE GREATER 54  OR
 12706             WS-AH-EDIT-AGE GREATER 54)  AND
 12707            PB-I-SIG-SW = 'N'
 12708            MOVE ER-2651         TO  WS-ERROR
 12709            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12710
 12711 3135-NAME-EDIT.
 12712
 12713     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12714        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12715        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12716           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12717                                 TO PB-I-JOINT-FIRST-NAME
 12718        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 231
* EL050.cbl
 12719     END-IF
 12720     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12721        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12722        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12723           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12724                                 TO PB-I-JOINT-LAST-NAME
 12725        END-PERFORM
 12726     END-IF
 12727     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12728        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12729        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12730           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12731                                 TO PB-I-INSURED-FIRST-NAME
 12732        END-PERFORM
 12733     END-IF
 12734     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12735        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12736        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12737           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12738                                 TO PB-I-INSURED-LAST-NAME
 12739        END-PERFORM
 12740     END-IF
 12741     IF PB-I-INSURED-LAST-NAME = SPACES
 12742       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12743       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12744           MOVE ER-2660    TO WS-ERROR
 12745           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12746
 12747 3136-EDIT-SEX.
 12748
 12749******************************************************************
 12750*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12751******************************************************************
 12752
 12753     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12754        (WS-AH-SPECIAL-CALC-CD = 'O')
 12755        NEXT SENTENCE
 12756     ELSE
 12757        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12758           NEXT SENTENCE
 12759        ELSE
 12760           MOVE ER-2629            TO WS-ERROR
 12761           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12762
 12763 3137-EDIT-EFF-DATE.
 12764
 12765     IF PB-REISSUED-CERT       OR
 12766        PB-POLICY-IS-DECLINED  OR
 12767        PB-POLICY-IS-VOIDED
 12768         GO TO 3139-EDIT-COVERAGE-CODES.
 12769
 12770     MOVE SPACE                  TO WS-2671-SW
 12771                                    WS-2672-SW.
 12772
 12773     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12774         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12775             MOVE ER-2703        TO WS-ERROR
 12776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 232
* EL050.cbl
 12777             GO TO 3139-EDIT-COVERAGE-CODES.
 12778
 12779     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12780         GO TO 3139-EDIT-COVERAGE-CODES.
 12781
 12782     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12783     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12784*    MOVE '1'                    TO DC-OPTION-CODE.
 12785     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12786     MOVE +0                     TO DC-ELAPSED-MONTHS
 12787                                    DC-ELAPSED-DAYS.
 12788     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12789
 12790     IF DATE-CONVERSION-ERROR
 12791         GO TO 3139-EDIT-COVERAGE-CODES.
 12792
 12793     IF DC-ELAPSED-DAYS GREATER +180
 12794         MOVE ER-2672            TO WS-ERROR
 12795         MOVE 'Y'                TO WS-2672-SW
 12796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12797     END-IF
 12798
 12799     IF WS-ERROR = ER-2671  AND
 12800        PB-COMPANY-ID  = 'LBL'
 12801        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12802        MOVE SPACE               TO WS-2671-SW
 12803        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12804
 12805     IF PB-ISSUE-DATE-FORCED  AND
 12806      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12807         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12808         MOVE ER-2673            TO WS-ERROR
 12809         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12810         MOVE SPACE              TO WS-2671-SW
 12811                                    WS-2672-SW.
 12812
 12813     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12814         IF PB-ISSUE-DATE-FORCED
 12815             MOVE ER-2600          TO  WS-ERROR
 12816             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12817         ELSE
 12818             MOVE ER-2692          TO  WS-ERROR
 12819             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12820
 12821
 12822 3139-EDIT-COVERAGE-CODES.
 12823
 12824     if pb-company-id not = 'AHL'
 12825        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12826           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12827           MOVE ER-2787          TO WS-ERROR
 12828           PERFORM 9900-ERROR-FORMAT
 12829                                 THRU 9900-EXIT
 12830        END-IF
 12831     end-if
 12832     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12833        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12834                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 233
* EL050.cbl
 12835           MOVE ER-2719          TO WS-ERROR
 12836           PERFORM 9900-ERROR-FORMAT
 12837                                 THRU 9900-EXIT
 12838        END-IF
 12839     END-IF
 12840
 12841     IF PB-POLICY-IS-DECLINED  OR
 12842        PB-POLICY-IS-VOIDED
 12843         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12844
 12845     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12846        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12847         MOVE ER-2630                TO WS-ERROR
 12848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12849
 12850     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12851        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12852        PB-I-LF-PREMIUM-AMT = ZERO
 12853         GO TO 3140-CHECK-AH-FOR-ZERO.
 12854
 12855     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12856        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12857        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12858         GO TO 3140-CHECK-AH-FOR-ZERO.
 12859
 12860     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12861        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12862        MOVE ER-2631             TO WS-ERROR
 12863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12864     END-IF
 12865
 12866
 12867******************************************************************
 12868*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12869******************************************************************
 12870
 12871     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12872        NEXT SENTENCE
 12873     ELSE
 12874        IF PB-I-LF-BENEFIT-AMT = ZERO
 12875           MOVE ER-2632             TO WS-ERROR
 12876           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12877
 12878
 12879******************************************************************
 12880*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12881******************************************************************
 12882
 12883     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12884        CONTINUE
 12885     ELSE
 12886        IF PB-I-LF-PREMIUM-AMT = ZERO
 12887           IF (NOT PB-COMP-LF-PREM)
 12888              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12889              and (ws-lf-ben-category not = 'C')
 12890              MOVE ER-2633       TO WS-ERROR
 12891              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12892           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 234
* EL050.cbl
 12893        END-IF
 12894     END-IF
 12895     .
 12896 3140-CHECK-AH-FOR-ZERO.
 12897
 12898     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12899        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12900        PB-I-AH-PREMIUM-AMT = ZERO
 12901         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12902
 12903     IF PB-COMPANY-ID = 'CSL'  AND
 12904        PB-I-AH-BENEFIT-CD = ZERO  AND
 12905        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12906        PB-I-AH-PREMIUM-AMT = ZERO
 12907         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12908
 12909     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12910        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12911        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12912         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12913
 12914     IF PB-I-AH-BENEFIT-CD = ZERO
 12915         MOVE ER-2634            TO WS-ERROR
 12916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12917
 12918******************************************************************
 12919*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12920******************************************************************
 12921
 12922     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12923        NEXT SENTENCE
 12924     ELSE
 12925        IF PB-I-AH-BENEFIT-AMT = ZERO
 12926           MOVE ER-2635             TO WS-ERROR
 12927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12928
 12929******************************************************************
 12930*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12931******************************************************************
 12932
 12933     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12934        NEXT SENTENCE
 12935     ELSE
 12936        IF PB-I-AH-PREMIUM-AMT = ZERO
 12937            IF NOT PB-COMP-AH-PREM
 12938                MOVE ER-2636    TO WS-ERROR
 12939                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12940
 12941
 12942 3140-EDIT-MAX-AMT-SIZES.
 12943* CUSTOM CODE FOR CLIENT    'DMD'
 12944     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12945                                     WS-RES-MUNI-TAX
 12946                                     PB-I-STATE-TAX
 12947                                     PB-I-MUNI-TAX.
 12948
 12949     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12950
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 235
* EL050.cbl
 12951     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12952        GO TO 3150-RATE-OUTSTAND-BAL.
 12953
 12954     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12955        GO TO 3150-RATE-OUTSTAND-BAL.
 12956
 12957     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12958        GO TO 3150-RATE-OUTSTAND-BAL.
 12959
 12960     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12961                             OR 'RIC')
 12962        GO TO 3150-RATE-OUTSTAND-BAL.
 12963
 12964     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12965        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12966            GO TO 3150-RATE-OUTSTAND-BAL
 12967        ELSE
 12968           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12969               GO TO 3150-RATE-OUTSTAND-BAL.
 12970
 12971     IF NOT PB-NO-MONTHS-SKIPPED
 12972        GO TO 3150-RATE-OUTSTAND-BAL.
 12973
 12974     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12975        GO TO 3150-RATE-OUTSTAND-BAL.
 12976
 12977     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12978        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12979           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12980             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12981           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12982           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12983              MOVE ER-2693     TO WS-ERROR
 12984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12985              GO TO 3150-RATE-OUTSTAND-BAL
 12986           ELSE
 12987              GO TO 3150-RATE-OUTSTAND-BAL.
 12988
 12989 3150-RATE-OUTSTAND-BAL.
 12990
 12991* DMD RATING TEST
 12992     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12993         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12994         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12995         MOVE ER-2687                 TO WS-ERROR
 12996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12997         MOVE 'B'                     TO PB-I-OB-FLAG
 12998         GO TO 3260-EDIT-CONTINUE.
 12999
 13000     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13001         IF  WS-ERROR    EQUAL    ER-2693
 13002             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13003                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13004                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13005                 MOVE  +0            TO  WS-ERROR.
 13006
 13007     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13008         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 236
* EL050.cbl
 13009             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13010                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13011                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13012                 MOVE  +0            TO  WS-ERROR.
 13013
 13014     IF PLAN-MASTER-AH-SW = 'Y'
 13015        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13016            IF  WS-ERROR    EQUAL    ER-2693
 13017              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13018                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13019                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13020                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13021                 MOVE  ER-1910           TO  WS-ERROR
 13022                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13023
 13024     IF PLAN-MASTER-AH-SW = 'Y'
 13025        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13026            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13027               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13028               MOVE  ER-1910           TO  WS-ERROR
 13029               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13030
 13031     IF PLAN-MASTER-AH-SW = 'Y'
 13032        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13033            IF  WS-ERROR    EQUAL    ER-2693
 13034                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13035                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13036                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13037                 MOVE  +0       TO  WS-ERROR.
 13038
 13039     IF WS-ERROR = ER-2693
 13040        IF PB-COMPANY-ID = 'JAL' AND
 13041           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13042           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13043           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13044
 13045     IF WS-ERROR = ER-2693
 13046        IF PB-COMPANY-ID = 'NCL'  AND
 13047           PB-I-AH-BENEFIT-CD = 'OA'
 13048           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13049           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13050
 13051     IF WS-ERROR = ER-2693
 13052        IF PB-COMPANY-ID = 'CNL' AND
 13053           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13054           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13055           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13056
 13057     IF WS-ERROR = ER-2693
 13058        IF PB-COMPANY-ID = 'HER'
 13059           IF WS-LEVEL
 13060              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13061              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13062
 13063     IF ((LF-BENEFIT-FOUND) AND
 13064         (NOT NO-LIFE-COVERAGE)  AND
 13065         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13066       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 237
* EL050.cbl
 13067             (NOT NO-AH-COVERAGE)    AND
 13068             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13069         NEXT SENTENCE
 13070     ELSE
 13071         GO TO 3215-EDIT-RATES.
 13072
 13073     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13074        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13075           MOVE ER-2674          TO WS-ERROR
 13076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13077           GO TO 3215-EDIT-RATES.
 13078
 13079     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13080        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13081           MOVE ER-2674          TO WS-ERROR
 13082           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13083           GO TO 3215-EDIT-RATES.
 13084
 13085     MOVE 'B'                    TO PB-I-OB-FLAG.
 13086
 13087     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13088         NEXT SENTENCE
 13089     ELSE
 13090         IF NOT NO-LIFE-COVERAGE
 13091             IF WS-ACCT-LF-OB-RT = ZERO
 13092                MOVE ER-2641    TO WS-ERROR
 13093                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13094
 13095     IF PB-COMPANY-ID = 'CRI'
 13096       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13097         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13098         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13099         IF WS-ERROR = ER-2675
 13100            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13101            MOVE ER-2687              TO WS-ERROR
 13102            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103         ELSE
 13104            MOVE ER-2687              TO WS-ERROR
 13105            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13106
 13107
 13108     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13109         NEXT SENTENCE
 13110     ELSE
 13111       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13112            NEXT SENTENCE
 13113       ELSE
 13114         IF NOT NO-AH-COVERAGE
 13115             IF WS-ACCT-AH-OB-RT = ZERO
 13116                MOVE ER-2642    TO WS-ERROR
 13117                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13118
 13119     IF PB-COMPANY-ID = 'CRI'
 13120       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13121         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13122         IF WS-ERROR = ER-2676
 13123            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13124            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 238
* EL050.cbl
 13125            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13126         ELSE
 13127            MOVE ER-2687              TO WS-ERROR
 13128            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13129
 13130     IF PB-COMPANY-ID NOT = 'GIC'
 13131         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13132            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13133     ELSE
 13134         IF PB-I-LF-PREM-CALC = ZEROS
 13135             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13136                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13137
 13138     IF PB-COMPANY-ID NOT = 'GIC'
 13139         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13140            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13141     ELSE
 13142         IF PB-I-AH-PREM-CALC = ZEROS
 13143             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13144                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13145
 13146     MOVE ZEROS TO PB-I-MORT-CODE.
 13147
 13148     GO TO 3260-EDIT-CONTINUE.
 13149
 13150
 13151 3215-EDIT-RATES.
 13152     IF ACCOUNT-MAST-FOUND
 13153         NEXT SENTENCE
 13154     ELSE
 13155         GO TO 3999-END-EDIT.
 13156
 13157 3220-CHECK-LF-RATES.
 13158
 13159     IF PB-COMPANY-ID = 'DCC'
 13160        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13161        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13162        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13163           AND (NOT WS-LF-CASH))
 13164                           OR
 13165           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13166           AND (NOT WS-AH-CASH)))
 13167                       AND
 13168           (PB-I-ENTRY-STATUS NOT = '5')
 13169           MOVE 'M'              TO PB-BATCH-ENTRY
 13170                                    PB-I-ENTRY-STATUS
 13171        END-IF
 13172     END-IF
 13173     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13174                                    PB-I-AH-PREM-CALC
 13175                                    PB-I-LF-ALT-PREM-CALC
 13176                                    PB-I-LF-ALT-RATE
 13177                                    PB-I-LF-REI-RATE
 13178                                    PB-I-LF-ALT-REI-RATE
 13179                                    PB-I-AH-REI-RATE
 13180                                    PB-I-TOT-FEES-CALC.
 13181
 13182     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 239
* EL050.cbl
 13183        NEXT SENTENCE
 13184     ELSE
 13185        MOVE ZEROS               TO PB-I-LF-RATE
 13186                                    PB-I-AH-RATE.
 13187
 13188     IF PB-I-TOT-FEES NOT NUMERIC
 13189        MOVE ZEROS               TO PB-I-TOT-FEES
 13190     END-IF
 13191     IF PB-I-LIVES NOT NUMERIC
 13192         MOVE ZERO               TO PB-I-LIVES.
 13193
 13194     IF PB-I-NUM-BILLED NOT NUMERIC
 13195         MOVE ZERO               TO PB-I-NUM-BILLED.
 13196
 13197     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13198        MOVE +0                  TO PB-I-LF-PREM-TAX
 13199     END-IF
 13200
 13201     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13202        MOVE +0                  TO PB-I-AH-PREM-TAX
 13203     END-IF
 13204
 13205     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13206        PB-I-PAY-FREQUENCY = ZEROS
 13207            MOVE 12 TO CP-PAY-FREQUENCY
 13208     ELSE
 13209            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13210
 13211     IF PB-I-STATE-TAX NOT NUMERIC
 13212         MOVE ZEROS               TO PB-I-STATE-TAX.
 13213
 13214     IF PB-I-MUNI-TAX NOT NUMERIC
 13215         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13216
 13217     MOVE SPACES                 TO CP-BEN-CATEGORY
 13218     IF PB-COMPANY-ID  = 'CSL'  AND
 13219        PB-I-LF-TERM NOT = ZERO
 13220        COMPUTE WS-PAYMENT-AMT =
 13221             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13222        COMPUTE WS-CSL-AMT1 =
 13223             PB-I-LF-TERM * AM-MAX-MON-BEN
 13224        COMPUTE WS-CSL-AMT2 =
 13225             WS-PAYMENT-AMT * PB-I-LF-TERM
 13226        IF CP-PAY-FREQUENCY NOT = 12
 13227           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13228           MOVE '8' TO WS-CSL-CALC-CD
 13229        ELSE
 13230           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13231              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13232               AM-MAX-TOT-BEN
 13233               MOVE '6' TO WS-CSL-CALC-CD
 13234           ELSE
 13235              IF (WS-CSL-AMT1  GREATER THAN
 13236                 AM-MAX-TOT-BEN) AND
 13237                 (WS-CSL-AMT2  GREATER THAN
 13238                 AM-MAX-TOT-BEN)
 13239                 MOVE '7' TO WS-CSL-CALC-CD
 13240              ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 240
* EL050.cbl
 13241                 MOVE '5' TO WS-CSL-CALC-CD.
 13242
 13243     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13244         NEXT SENTENCE
 13245     ELSE
 13246         GO TO 3300-CHECK-AH-RATES.
 13247
 13248*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13249
 13250     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13251        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13252              OR
 13253           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13254           MOVE ER-2618          TO WS-ERROR
 13255           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13256           GO TO 3300-CHECK-AH-RATES.
 13257
 13258     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13259           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13260                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13261
 13262     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13263         MOVE ER-2687             TO WS-ERROR
 13264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13265         MOVE 'Z000'              TO PB-I-MORT-CODE
 13266         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13267         GO TO 3300-CHECK-AH-RATES.
 13268
 13269     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13270        IF PB-I-LIVES = ZERO
 13271           MOVE ER-2688          TO WS-ERROR
 13272           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13273
 13274     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13275
 13276     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13277     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13278     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13279     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13280     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13281     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13282     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13283     MOVE '3'                    TO CP-PROCESS-TYPE.
 13284     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13285     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13286
 13287******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13288     IF PB-COMPANY-ID EQUAL 'CDL'
 13289         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13290            CP-EARN-AS-NET-PAY)
 13291             IF PB-CERT-EFF-DT GREATER  WS-931231
 13292                 MOVE '1'        TO CP-EARNING-METHOD.
 13293*******
 13294
 13295     MOVE PB-SV-STATE            TO CP-STATE.
 13296     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13297     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13298     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 241
* EL050.cbl
 13299     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13300     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13301                                    CP-RATING-BENEFIT-AMT.
 13302     IF CP-STATE-STD-ABBRV = 'OR'
 13303         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13304                                         PB-I-LF-ALT-BENEFIT-AMT.
 13305     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13306     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13307     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13308     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13309     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13310     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13311     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13312     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13313     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13314                                    CP-REMAINING-TERM
 13315                                    CP-LOAN-TERM.
 13316
 13317     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13318         NEXT SENTENCE
 13319     ELSE
 13320         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13321             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13322                                           PB-I-LF-PREMIUM-AMT.
 13323
 13324     IF PB-COMPANY-ID EQUAL 'CSL'
 13325        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13326           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13327                                         PB-I-LF-PREMIUM-AMT.
 13328
 13329     IF PB-COMPANY-ID EQUAL 'NCB'
 13330         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13331            CP-EARN-AS-NET-PAY
 13332             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13333                 PB-I-LF-PREMIUM-AMT.
 13334
 13335     IF (CP-TRUNCATED-LIFE)
 13336        or ((pb-company-id = 'AHL')
 13337           and (pb-i-loan-term > pb-i-lf-term))
 13338        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13339
 13340     IF PB-COMPANY-ID EQUAL 'CRI'
 13341        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13342
 13343     IF CP-TERM-IS-DAYS
 13344         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13345     ELSE
 13346         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13347     IF PB-COMPANY-ID = 'DCC'
 13348        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13349        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13350        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13351        IF WS-LF-BEN-CATEGORY = 'D'
 13352           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13353           MOVE PB-I-LIFE-COMMISSION
 13354                                 TO CP-DCC-ACT-COMM
 13355           MOVE WS-LF-BEN-CATEGORY
 13356                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 242
* EL050.cbl
 13357        END-IF
 13358        IF (CP-BENEFIT-CD (1:1) = 'P')
 13359           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13360           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13361           add pb-i-ah-premium-amt to cp-original-premium
 13362        END-IF
 13363     END-IF
 13364     IF PB-COMPANY-ID = 'CSL'
 13365         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13366         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13367         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13368
 13369     IF PB-COMPANY-ID = 'CSL'
 13370        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13371
 13372     IF (CP-SPECIAL-CALC-CD = 'H')
 13373        OR (PB-COMPANY-ID = 'DCC')
 13374         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13375                                    TO CP-ALTERNATE-BENEFIT
 13376         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13377
 13378     IF (PB-COMPANY-ID = 'CID')
 13379        AND (WS-LF-EARNINGS-CALC = 'B')
 13380        AND (CP-STATE-STD-ABBRV = 'MN')
 13381        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13382                                 TO CP-ALTERNATE-BENEFIT
 13383        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13384     END-IF
 13385     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13386     MOVE 'R'                   TO CP-RATE-FILE.
 13387     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13388
 13389     IF CP-ERROR-RATE-NOT-FOUND
 13390        MOVE ER-2641            TO WS-ERROR
 13391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13392        GO TO 3300-CHECK-AH-RATES.
 13393
 13394     IF PB-COMPANY-ID EQUAL 'CRI'
 13395        IF CP-ERROR-NO-LIMITS-CRI
 13396           IF NOT ACCOUNT-LIFE-CHECKED
 13397              MOVE ER-2607      TO WS-ERROR
 13398              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13399
 13400******************************************************************
 13401*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13402*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13403******************************************************************
 13404
 13405* CALC LIFE AGE AT EXPIRATION.
 13406
 13407     COMPUTE WS-AGE-AT-EXPIRE =
 13408          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13409
 13410*    IF PB-STATE = 'CO' OR 'UT'
 13411*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13412*        MOVE 'F'            TO PB-FATAL-FLAG
 13413*        MOVE ER-2709        TO WS-ERROR
 13414*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 243
* EL050.cbl
 13415*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13416
 13417*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13418*        MOVE 'X'            TO PB-FATAL-FLAG
 13419*        MOVE ER-2718        TO WS-ERROR
 13420*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13421*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13422
 13423* CALC A & H AGE AT EXPIRATION.
 13424
 13425     COMPUTE WS-AGE-AT-EXPIRE =
 13426          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13427
 13428*    IF PB-STATE = 'CO' OR 'UT'
 13429*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13430*        MOVE 'F'            TO PB-FATAL-FLAG
 13431*        MOVE ER-2709        TO WS-ERROR
 13432*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13433*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13434
 13435*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13436*        MOVE 'X'            TO PB-FATAL-FLAG
 13437*        MOVE ER-2718        TO WS-ERROR
 13438*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13439*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13440
 13441     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13442        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13443
 13444     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13445        and (not pb-monthly-cert)
 13446        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13447     end-if
 13448
 13449     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13450        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13451
 13452     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13453         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13454         MOVE ER-2639        TO WS-ERROR
 13455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13456
 13457
 13458******************************************************************
 13459*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13460******************************************************************
 13461
 13462 PREMIUM-EDITING-IS-BYPASSED.
 13463     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13464        AND (CP-R-MAX-ATT-AGE > +0)
 13465        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13466        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13467           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13468           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13469           MOVE '1'              TO DC-OPTION-CODE
 13470           PERFORM 8500-DATE-CONVERT
 13471                                 THRU 8500-EXIT
 13472           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 244
* EL050.cbl
 13473              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13474                 MOVE ER-2661       TO WS-ERROR
 13475*                PERFORM 9900-ERROR-FORMAT
 13476*                                THRU 9900-EXIT
 13477              END-IF
 13478           END-IF
 13479        ELSE
 13480           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13481           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13482              MOVE ER-2661       TO WS-ERROR
 13483*             PERFORM 9900-ERROR-FORMAT
 13484*                                THRU 9900-EXIT
 13485           ELSE
 13486              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13487                 MOVE ER-1570    TO WS-ERROR
 13488                 PERFORM 9900-ERROR-FORMAT
 13489                                 THRU 9900-EXIT
 13490              END-IF
 13491           END-IF
 13492        END-IF
 13493        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13494           MOVE PB-I-JOINT-BIRTHDAY
 13495                                 TO DC-BIN-DATE-1
 13496           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13497           MOVE '1'              TO DC-OPTION-CODE
 13498           PERFORM 8500-DATE-CONVERT
 13499                                 THRU 8500-EXIT
 13500           IF NO-CONVERSION-ERROR
 13501              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13502                 MOVE ER-2661       TO WS-ERROR
 13503*                PERFORM 9900-ERROR-FORMAT
 13504*                                THRU 9900-EXIT
 13505              END-IF
 13506           ELSE
 13507              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13508           END-IF
 13509        ELSE
 13510           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13511             (PB-I-LF-TERM / 12)
 13512           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13513              MOVE ER-2661       TO WS-ERROR
 13514*             PERFORM 9900-ERROR-FORMAT
 13515*                                THRU 9900-EXIT
 13516           ELSE
 13517              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13518                 MOVE ER-1571    TO WS-ERROR
 13519                 PERFORM 9900-ERROR-FORMAT
 13520                                 THRU 9900-EXIT
 13521              END-IF
 13522           END-IF
 13523        END-IF
 13524        IF WS-ERROR = ER-2661
 13525           PERFORM 9900-ERROR-FORMAT
 13526                                 THRU 9900-EXIT
 13527        END-IF
 13528     END-IF
 13529*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13530*       MOVE ER-2661             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 245
* EL050.cbl
 13531*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13532
 13533     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13534        MOVE ER-2662             TO WS-ERROR
 13535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13536
 13537     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13538        MOVE ER-2677             TO WS-ERROR
 13539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13540
 13541     IF CP-ERROR-LOAN-TERM
 13542        MOVE ER-2648             TO WS-ERROR
 13543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13544
 13545 3221-CHECK-ERROR-RATE-OPEN.
 13546
 13547     IF CP-ERROR-RATE-FILE-NOTOPEN
 13548         GO TO 3990-FILES-NOT-OPEN.
 13549
 13550     IF PB-COMPANY-ID NOT = 'DMD'
 13551        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13552     END-IF
 13553     .
 13554 3221-CONTINUE.
 13555     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13556                                    WS-DCC-AH-RATE
 13557     IF PB-COMPANY-ID = 'DCC'
 13558        IF WS-LF-BEN-CATEGORY = 'D'
 13559           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13560              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13561        END-IF
 13562     END-IF
 13563     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13564*   X'A4FF' = 12/31/2009
 13565     IF (PB-COMPANY-ID = 'CID')
 13566        AND (WS-LF-EARNINGS-CALC = 'B')
 13567        AND (CP-STATE-STD-ABBRV = 'MN')
 13568        AND (PB-CERT-EFF-DT > X'A4FF')
 13569        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13570     END-IF
 13571     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13572
 13573     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13574     IF (PB-COMPANY-ID = 'DCC')
 13575        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13576        AND (PB-I-POLICY-IS-MONTHLY)
 13577        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13578        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13579     END-IF
 13580     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13581     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13582     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13583     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13584     IF (PB-COMPANY-ID = 'DCC')
 13585        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13586        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13587        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13588        MOVE ER-2786             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 246
* EL050.cbl
 13589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13590     END-IF
 13591
 13592     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13593
 13594******************************************************************
 13595*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13596******************************************************************
 13597     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13598        and ((not pb-monthly-cert)
 13599        or (ws-lf-ben-category = 'C'))
 13600        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13601
 13602     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13603        GO TO 3225-CHECK-ALT-LIFE-RATE
 13604     ELSE
 13605       IF PB-I-LF-RATE = ZERO
 13606          MOVE ER-2641          TO WS-ERROR
 13607          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13608
 13609 3225-CHECK-ALT-LIFE-RATE.
 13610
 13611     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13612        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13613        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13614         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13615
 13616     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13617         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13618             AND PB-COMPANY-ID NOT = 'DCC')
 13619                   OR
 13620              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13621              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13622              AND PB-COMPANY-ID NOT = 'DCC')
 13623             MOVE ER-2720        TO  WS-ERROR
 13624             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13625             GO TO 3225-RATING-CONT
 13626         ELSE
 13627             GO TO 3225-RATING-CONT.
 13628     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13629        AND (AM-GPCD = 01 OR 06 OR 15)
 13630        MOVE ER-2798             TO WS-ERROR
 13631        PERFORM 9900-ERROR-FORMAT
 13632                                 THRU 9900-EXIT
 13633*       GO TO 3225-RATING-CONT
 13634     END-IF
 13635     IF (PB-COMPANY-ID = 'CID')
 13636        AND (WS-LF-EARNINGS-CALC = 'B')
 13637        AND (CP-STATE-STD-ABBRV = 'MN')
 13638        AND (PB-CERT-EFF-DT > X'A4FF')
 13639        GO TO 3225-RATING-CONT
 13640     END-IF
 13641     IF PB-COMPANY-ID = 'DCC'
 13642        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13643           AND (PB-I-POLICY-IS-MONTHLY)
 13644           GO TO 3225-RATING-CONT
 13645        END-IF
 13646     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 247
* EL050.cbl
 13647
 13648     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13649        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13650        CP-EARN-AS-REG-BALLOON
 13651        NEXT SENTENCE
 13652     ELSE
 13653        MOVE '2'                 TO CP-EARNING-METHOD.
 13654
 13655 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13656
 13657     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13658
 13659     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13660        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13661        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13662         NEXT SENTENCE
 13663     ELSE
 13664         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13665
 13666     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13667     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13668     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13669                                     CP-RATING-BENEFIT-AMT.
 13670     IF CP-STATE-STD-ABBRV = 'OR'
 13671         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13672                                         PB-I-LF-ALT-BENEFIT-AMT.
 13673     IF PB-COMPANY-ID = 'DCC'
 13674        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13675     END-IF
 13676     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13677     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13678     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13679                                    CP-REMAINING-TERM
 13680                                    CP-LOAN-TERM.
 13681     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13682        ADD +1                   TO CP-ORIGINAL-TERM
 13683                                    CP-REMAINING-TERM
 13684                                    CP-LOAN-TERM.
 13685
 13686     MOVE 'R'                   TO CP-RATE-FILE.
 13687     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13688
 13689     IF CP-ERROR-RATE-NOT-FOUND
 13690         MOVE ER-2641            TO WS-ERROR
 13691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13692         GO TO 3300-CHECK-AH-RATES.
 13693
 13694     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13695     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13696
 13697     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13698         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13699
 13700     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13701                               + PB-I-LF-ALT-BENEFIT-AMT.
 13702
 13703     IF ACCOUNT-LIFE-CHECKED  OR
 13704        PB-POLICY-IS-VOIDED   OR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 248
* EL050.cbl
 13705        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13706        and (not pb-monthly-cert))
 13707        GO TO 3225-CONTINUE.
 13708
 13709     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13710        GO TO 3225-CONTINUE.
 13711
 13712     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13713                             EC-RT-LF-MAX-TOT-BEN
 13714        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13715        MOVE ER-2639       TO WS-ERROR
 13716        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13717
 13718 3225-CONTINUE.
 13719     IF PB-I-LF-ALT-RATE = ZERO
 13720         MOVE ER-2659            TO WS-ERROR
 13721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13722
 13723     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13724        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13725        MOVE ER-2698             TO WS-ERROR
 13726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13727
 13728 3225-RATING-CONT.
 13729
 13730     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13731        and (not pb-monthly-cert)
 13732         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13733         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13734         IF (PB-COMPANY-ID = 'DCC')
 13735            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13736            CONTINUE
 13737         ELSE
 13738            MOVE ER-2687         TO WS-ERROR
 13739            PERFORM 9900-ERROR-FORMAT
 13740                                 THRU 9900-EXIT
 13741         END-IF
 13742         GO TO 3290-EDIT-LF-REIN-RATE
 13743     END-IF
 13744
 13745* DMD RATING TEST
 13746     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13747         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13748         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13749         MOVE ER-2687                 TO WS-ERROR
 13750         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13751         GO TO 3290-EDIT-LF-REIN-RATE.
 13752
 13753 3230-CLIENT-MORT-CD-SPECIALS.
 13754
 13755     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13756     SET BIN-TO-GREG          TO TRUE.
 13757*    MOVE ' '                 TO DC-OPTION-CODE.
 13758     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13759     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13760
 13761 C-POS-3230-MORT-CD.
 13762     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 249
* EL050.cbl
 13763        PB-SV-CARRIER = '2'
 13764         NEXT SENTENCE
 13765     ELSE
 13766         GO TO C-POS-3240-MORT-CD.
 13767
 13768     IF PB-SV-GROUPING = '030'
 13769        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13770         MOVE '2350' TO PB-I-MORT-CODE
 13771      ELSE
 13772         MOVE '3300' TO PB-I-MORT-CODE.
 13773
 13774
 13775 C-POS-3240-MORT-CD.
 13776     IF PB-COMPANY-ID = 'POS' AND
 13777        PB-SV-CARRIER = '1'
 13778         NEXT SENTENCE
 13779     ELSE
 13780         GO TO 3230-CONTINUE.
 13781
 13782     IF PB-SV-STATE = '45' OR '47'
 13783        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13784         MOVE '5200' TO PB-I-MORT-CODE
 13785     ELSE
 13786         MOVE '8300' TO PB-I-MORT-CODE.
 13787
 13788 3230-CONTINUE.
 13789
 13790     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13791        GO TO 3240-CONTINUE
 13792     END-IF
 13793
 13794     IF PB-CERT-EFF-DT > WS-971231
 13795        GO TO 3240-CONTINUE
 13796     END-IF
 13797
 13798     IF LF-BENEFIT-FOUND AND
 13799        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13800         MOVE 'F250'       TO PB-I-MORT-CODE
 13801     ELSE
 13802         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13803             MOVE '7250'   TO PB-I-MORT-CODE
 13804         ELSE
 13805             MOVE '4251'   TO PB-I-MORT-CODE
 13806         END-IF
 13807     END-IF
 13808
 13809     .
 13810 3240-CONTINUE.
 13811
 13812     IF PB-COMPANY-ID NOT = 'GNL'
 13813         GO TO 3256-CONTINUE.
 13814
 13815     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13816         MOVE 'A300' TO PB-I-MORT-CODE
 13817     ELSE
 13818         MOVE '8350' TO PB-I-MORT-CODE.
 13819
 13820 3256-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 250
* EL050.cbl
 13821     IF PB-COMPANY-ID NOT = 'ABL'
 13822         GO TO 3260-EDIT-CONTINUE.
 13823
 13824     IF PB-I-LF-TERM GREATER THAN 59
 13825         MOVE 'F550' TO PB-I-MORT-CODE
 13826     ELSE
 13827         MOVE 'E550' TO PB-I-MORT-CODE.
 13828
 13829 3260-EDIT-CONTINUE.
 13830     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13831
 13832 3290-EDIT-LF-REIN-RATE.
 13833     IF LF-REIN-NSP-NOT-USED
 13834         GO TO 3290-RATING-CONT.
 13835
 13836     IF PB-COMPANY-ID = 'DCC'
 13837        GO TO 3290-RATING-CONT.
 13838     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13839     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13840     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13841     MOVE '3'                   TO CP-PROCESS-TYPE.
 13842     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13843
 13844******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13845     IF PB-COMPANY-ID EQUAL 'CDL'
 13846         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13847            CP-EARN-AS-NET-PAY)
 13848             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13849*            MOVE SPACE          TO DC-OPTION-CODE
 13850             SET BIN-TO-GREG     TO TRUE
 13851             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13852***  Y2K PROJ 7744
 13853             IF DC-GREG-DATE-CYMD GREATER 19931231
 13854                 MOVE '1'        TO CP-EARNING-METHOD.
 13855***  Y2K PROJ 7744
 13856*******
 13857
 13858     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13859     MOVE PB-SV-STATE           TO CP-STATE.
 13860     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13861     MOVE ZERO                  TO CP-DEVIATION-CODE
 13862                                   CP-RATE-DEV-PCT.
 13863     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13864     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13865                                   CP-RATING-BENEFIT-AMT.
 13866
 13867************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13868     IF PB-COMPANY-ID EQUAL 'NCB'
 13869         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13870            CP-EARN-AS-NET-PAY
 13871             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13872                 PB-I-LF-PREMIUM-AMT.
 13873************
 13874
 13875     IF CP-STATE-STD-ABBRV = 'OR'
 13876         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13877                                         PB-I-LF-ALT-BENEFIT-AMT.
 13878     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 251
* EL050.cbl
 13879     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13880     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13881     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13882     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13883     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13884     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13885     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13886                                   CP-REMAINING-TERM
 13887                                   CP-LOAN-TERM.
 13888     IF CP-TRUNCATED-LIFE
 13889        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13890
 13891     IF CP-TERM-IS-DAYS
 13892         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13893     ELSE
 13894         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13895
 13896     IF PB-COMPANY-ID = 'DCC'
 13897        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13898     END-IF
 13899     IF PB-COMPANY-ID NOT = 'TIC'
 13900          MOVE ZERO          TO CP-CLASS-CODE.
 13901
 13902     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13903
 13904     MOVE 'R'                   TO CP-RATE-FILE.
 13905     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13906
 13907     IF CP-ERROR-RATE-NOT-FOUND
 13908        IF PB-I-OB
 13909           MOVE ER-2625      TO WS-ERROR
 13910           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13911           GO TO 3299-EDIT-CONTINUE
 13912        ELSE
 13913           MOVE ER-2643      TO WS-ERROR
 13914           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13915           GO TO 3299-EDIT-CONTINUE.
 13916
 13917     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13918
 13919     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13920     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13921
 13922     IF PB-I-LF-REI-RATE = ZERO
 13923         MOVE ER-2643        TO WS-ERROR
 13924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13925
 13926 3290-CHECK-ALT-REIN-RATE.
 13927
 13928     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13929        GO TO 3290-RATING-CONT.
 13930
 13931     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13932     MOVE '2'                    TO CP-EARNING-METHOD.
 13933     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13934     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13935     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13936     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 252
* EL050.cbl
 13937                                     CP-RATING-BENEFIT-AMT.
 13938     IF CP-STATE-STD-ABBRV = 'OR'
 13939         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13940                                         PB-I-LF-ALT-BENEFIT-AMT.
 13941     IF PB-COMPANY-ID = 'DCC'
 13942        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13943     END-IF
 13944     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13945     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13946     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13947                                    CP-REMAINING-TERM
 13948                                    CP-LOAN-TERM.
 13949     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13950        ADD +1                   TO CP-ORIGINAL-TERM
 13951                                    CP-REMAINING-TERM
 13952                                    CP-LOAN-TERM.
 13953
 13954     MOVE 'R'                   TO CP-RATE-FILE.
 13955     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13956
 13957     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13958
 13959     IF PB-I-LF-ALT-REI-RATE = ZERO
 13960         MOVE ER-2643            TO WS-ERROR
 13961         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13962
 13963 3290-RATING-CONT.
 13964
 13965     IF PB-I-OB
 13966*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13967        GO TO 3300-CHECK-AH-RATES.
 13968
 13969 3299-EDIT-CONTINUE.
 13970
 13971     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13972         NEXT SENTENCE
 13973     ELSE
 13974         MOVE ER-2620           TO WS-ERROR
 13975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13976
 13977 3300-CHECK-AH-RATES.
 13978     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13979         NEXT SENTENCE
 13980     ELSE
 13981         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13982
 13983     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 13984        and (not pb-monthly-cert))
 13985                  or
 13986        ((CF-COMPANY-ID = 'DMD') AND
 13987                (NO-DMD-RATING))
 13988         IF (PB-COMPANY-ID = 'DCC')
 13989            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13990            CONTINUE
 13991         ELSE
 13992            MOVE ER-2687         TO WS-ERROR
 13993            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13994         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 253
* EL050.cbl
 13995         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13996         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13997     END-IF
 13998
 13999     IF PB-I-OB
 14000        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14001
 14002     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14003         MOVE ER-2687             TO WS-ERROR
 14004         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14005         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14006         GO TO 3999-END-EDIT.
 14007
 14008*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14009     if pb-company-id = 'AHL'
 14010        go to 3300-skip-crit-per
 14011     end-if
 14012     if (pb-i-ah-crit-per not = zeros)
 14013        and (ws-ah-special-calc-cd not = 'C')
 14014        MOVE ER-1572             TO WS-ERROR
 14015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14016        go to 3300-skip-crit-per
 14017     END-IF
 14018     if (pb-company-id = 'DCC')
 14019        and (am-dcc-product-code not = spaces)
 14020        go to 3300-skip-crit-per
 14021     end-if
 14022     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14023        IF PB-I-AH-CRIT-PER = ZERO
 14024           move ws-ah-max-bens   to pb-i-ah-crit-per
 14025*          MOVE ER-2618       TO WS-ERROR
 14026*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14027*          GO TO 3999-END-EDIT
 14028        END-IF
 14029     END-IF
 14030     if (ws-ah-special-calc-cd = 'C')
 14031        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14032        MOVE ER-1576             TO WS-ERROR
 14033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14034     end-if
 14035
 14036     .
 14037 3300-skip-crit-per.
 14038     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14039     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14040     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14041     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14042     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14043     MOVE PB-SV-STATE            TO CP-STATE.
 14044     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14045     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14046     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14047*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14048     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14049     MOVE '3'                    TO CP-PROCESS-TYPE.
 14050     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14051     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14052                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 254
* EL050.cbl
 14053     IF PB-COMPANY-ID = 'CID'
 14054               OR
 14055        CP-STATE-STD-ABBRV = 'OR'
 14056         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14057                                         PB-I-AH-TERM.
 14058     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14059        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14060           AND (PB-I-POLICY-IS-MONTHLY)
 14061           MOVE PB-I-LF-BENEFIT-AMT
 14062                                 TO CP-NET-BENEFIT-AMT
 14063           move pb-i-ah-premium-amt to cp-original-premium
 14064           add pb-i-lf-premium-amt to cp-original-premium
 14065        END-IF
 14066     END-IF
 14067     MOVE SPACES                 TO CP-BEN-CATEGORY
 14068     IF PB-COMPANY-ID = 'DCC'
 14069        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14070        EVALUATE TRUE
 14071           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14072              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14073              MOVE PB-I-LF-BENEFIT-AMT
 14074                                 TO CP-RATING-BENEFIT-AMT
 14075              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14076           WHEN WS-AH-BEN-CATEGORY = 'G'
 14077              MOVE PB-I-UNPAID-CASH-PRICE
 14078                                 TO CP-RATING-BENEFIT-AMT
 14079           WHEN WS-AH-BEN-CATEGORY = 'D'
 14080              MOVE WS-AH-PMF-COMM
 14081                                 TO CP-DCC-PMF-COMM
 14082              MOVE PB-I-AH-COMMISSION
 14083                                 TO CP-DCC-ACT-COMM
 14084        END-EVALUATE
 14085     END-IF
 14086     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14087     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14088     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14089     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14090     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14091     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14092     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14093                                    CP-REMAINING-TERM
 14094                                    WS-WORK-TERM.
 14095     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14096
 14097     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14098     SET BIN-TO-GREG             TO TRUE.
 14099*    MOVE ' '                    TO DC-OPTION-CODE.
 14100     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14101     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14102
 14103     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14104     IF NOT VALID-SKIP-CODE
 14105         MOVE ER-2683            TO WS-ERROR
 14106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14107         GO TO 3320-RATE-CONTINUE.
 14108
 14109     IF PB-NO-MONTHS-SKIPPED
 14110         GO TO 3320-RATE-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 255
* EL050.cbl
 14111
 14112     MOVE SPACE TO NUMBER-OF-MONTHS.
 14113
 14114     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14115         MOVE 'S'                TO SK-MO (6).
 14116     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14117         MOVE 'S'                TO SK-MO (7).
 14118     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14119         MOVE 'S'                TO SK-MO (8).
 14120     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14121         MOVE 'S'                TO SK-MO (9).
 14122     IF PB-I-SKIP-CODE = 'A'
 14123         MOVE 'S'                TO SK-MO (10).
 14124
 14125     MOVE 1                      TO SUB2.
 14126     MOVE PB-I-AH-TERM           TO SUB3.
 14127     MOVE WS-MONTH               TO SUB1.
 14128     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14129     GO TO 3320-RATE-CONTINUE.
 14130
 14131 3310-GET-SKIP-MO.
 14132     IF SUB1 = 13
 14133         MOVE 1                  TO SUB1.
 14134
 14135     IF SK-MO (SUB1) = 'S'
 14136         SUBTRACT 1 FROM WS-WORK-TERM.
 14137
 14138     ADD 1 TO SUB2
 14139              SUB1.
 14140
 14141 3320-RATE-CONTINUE.
 14142
 14143     IF WS-WORK-TERM = ZERO
 14144         MOVE 1                  TO WS-WORK-TERM.
 14145
 14146     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14147                                    CP-LOAN-TERM.
 14148
 14149     IF PB-COMPANY-ID EQUAL 'DMD'
 14150         NEXT SENTENCE
 14151     ELSE
 14152         MOVE ZERO               TO PB-I-AH-RATE
 14153                                    PB-I-AH-REI-RATE.
 14154
 14155
 14156     IF PB-COMPANY-ID EQUAL 'CRI'
 14157        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14158
 14159     IF PB-COMPANY-ID = 'CSL'
 14160         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14161         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14162         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14163         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14164
 14165     IF PB-COMPANY-ID = 'DCC'
 14166        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14167           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14168              PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 256
* EL050.cbl
 14169        END-IF
 14170        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14171                                 TO CP-ALTERNATE-BENEFIT
 14172        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14173        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14174        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14175     END-IF
 14176     IF (PB-COMPANY-ID = 'CID')
 14177        AND (WS-LF-EARNINGS-CALC = 'B')
 14178        AND (CP-STATE-STD-ABBRV = 'MN')
 14179        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14180     ELSE
 14181        MOVE ' '                 TO CP-AH-BALLOON-SW
 14182     END-IF
 14183     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14184     MOVE 'R'                   TO CP-RATE-FILE.
 14185     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14186
 14187     IF (CP-ERROR-RATE-NOT-FOUND)
 14188        and (not pb-monthly-cert)
 14189        IF PB-I-OB
 14190           MOVE ER-2624          TO WS-ERROR
 14191           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14192           GO TO 3340-CALCULATE-PREMIUM-AMT
 14193        ELSE
 14194          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14195              NEXT SENTENCE
 14196          ELSE
 14197           MOVE ER-2642          TO WS-ERROR
 14198           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14199           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14200
 14201     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14202        CP-ERROR-DIV-BY-ZERO
 14203           MOVE ER-3782          TO WS-ERROR
 14204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14205
 14206     IF PB-COMPANY-ID EQUAL 'CRI'
 14207        IF CP-ERROR-NO-LIMITS-CRI
 14208           IF NOT ACCOUNT-AH-CHECKED
 14209              MOVE ER-2607          TO WS-ERROR
 14210              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14211
 14212     IF ACCOUNT-AH-CHECKED
 14213        NEXT SENTENCE
 14214     ELSE
 14215       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14216          MOVE ER-2640           TO WS-ERROR
 14217          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14218
 14219     IF PB-COMPANY-ID = 'CRI'
 14220         IF WS-ERROR = ER-2640
 14221             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14222     IF ACCOUNT-AH-CHECKED
 14223        CONTINUE
 14224     ELSE
 14225        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14226           AND (CP-R-MAX-ATT-AGE > +0)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 257
* EL050.cbl
 14227           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14228           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14229              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14230              MOVE PB-I-AH-EXPIRE-DT
 14231                                 TO DC-BIN-DATE-2
 14232              MOVE '1'           TO DC-OPTION-CODE
 14233              PERFORM 8500-DATE-CONVERT
 14234                                 THRU 8500-EXIT
 14235              IF NO-CONVERSION-ERROR
 14236                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14237                    MOVE ER-2661       TO WS-ERROR
 14238*                   PERFORM 9900-ERROR-FORMAT
 14239*                                THRU 9900-EXIT
 14240                 END-IF
 14241              END-IF
 14242           ELSE
 14243              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14244              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14245                 MOVE ER-2661    TO WS-ERROR
 14246*                PERFORM 9900-ERROR-FORMAT
 14247*                                THRU 9900-EXIT
 14248              ELSE
 14249                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14250                    MOVE ER-1570 TO WS-ERROR
 14251                    PERFORM 9900-ERROR-FORMAT
 14252                                 THRU 9900-EXIT
 14253                 END-IF
 14254              END-IF
 14255           END-IF
 14256           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14257              MOVE PB-I-JOINT-BIRTHDAY
 14258                                    TO DC-BIN-DATE-1
 14259              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14260              MOVE '1'              TO DC-OPTION-CODE
 14261              PERFORM 8500-DATE-CONVERT
 14262                                    THRU 8500-EXIT
 14263              IF NO-CONVERSION-ERROR
 14264                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14265                    MOVE ER-2661       TO WS-ERROR
 14266*                   PERFORM 9900-ERROR-FORMAT
 14267*                                   THRU 9900-EXIT
 14268                 END-IF
 14269              END-IF
 14270           ELSE
 14271              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14272                (PB-I-AH-TERM / 12)
 14273              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14274                 MOVE ER-2661       TO WS-ERROR
 14275*                PERFORM 9900-ERROR-FORMAT
 14276*                                   THRU 9900-EXIT
 14277              ELSE
 14278                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14279                    MOVE ER-1571 TO WS-ERROR
 14280                    PERFORM 9900-ERROR-FORMAT
 14281                                 THRU 9900-EXIT
 14282                 END-IF
 14283              END-IF
 14284           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 258
* EL050.cbl
 14285           IF WS-ERROR = ER-2661
 14286              PERFORM 9900-ERROR-FORMAT
 14287                                    THRU 9900-EXIT
 14288           END-IF
 14289        END-IF
 14290     END-IF
 14291*    IF ACCOUNT-AH-CHECKED
 14292*       NEXT SENTENCE
 14293*    ELSE
 14294*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14295*          MOVE ER-2661          TO WS-ERROR
 14296*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14297
 14298     IF ACCOUNT-AH-CHECKED
 14299        NEXT SENTENCE
 14300     ELSE
 14301        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14302           MOVE ER-2663          TO WS-ERROR
 14303           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14304
 14305     IF ACCOUNT-AH-CHECKED OR
 14306        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14307         PB-POLICY-IS-VOIDED
 14308        NEXT SENTENCE
 14309     ELSE
 14310        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14311           MOVE ER-2667            TO WS-ERROR
 14312           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14313
 14314     IF PB-COMPANY-ID = 'CRI'
 14315         IF WS-ERROR = ER-2667
 14316             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14317
 14318     IF ACCOUNT-AH-CHECKED
 14319        NEXT SENTENCE
 14320     ELSE
 14321        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14322           MOVE ER-2678            TO WS-ERROR
 14323           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14324
 14325     IF CP-ERROR-RATE-FILE-NOTOPEN
 14326         GO TO 3990-FILES-NOT-OPEN.
 14327
 14328 3321-CONTINUE.
 14329     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14330     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14331     IF (PB-COMPANY-ID = 'DCC')
 14332        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14333        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14334                                    PB-I-LF-ALT-PREM-CALC
 14335        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14336        IF WS-AH-BEN-CATEGORY = 'G'
 14337           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14338           + PB-I-ADDL-CLP)
 14339           * (1 + WS-TOL-CLP-PCT)
 14340*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14341        ELSE
 14342           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 259
* EL050.cbl
 14343           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14344*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14345        END-IF
 14346        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14347                                 TO PB-I-AH-PREM-CALC
 14348        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14349           MOVE ER-8152          TO WS-ERROR
 14350           PERFORM 9900-ERROR-FORMAT
 14351                                 THRU 9900-EXIT
 14352        ELSE
 14353           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14354                 PB-I-ADDL-CLP)
 14355              MOVE ER-8148       TO WS-ERROR
 14356              PERFORM 9900-ERROR-FORMAT
 14357                                 THRU 9900-EXIT
 14358           END-IF
 14359        END-IF
 14360     END-IF
 14361     IF (PB-COMPANY-ID = 'DCC')
 14362        AND (PB-I-POLICY-IS-MONTHLY)
 14363        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14364        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14365        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14366           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14367        END-IF
 14368     END-IF
 14369     IF (PB-COMPANY-ID = 'DCC')
 14370        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14371        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14372        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14373        MOVE ER-2786             TO WS-ERROR
 14374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14375     END-IF
 14376     MOVE +0                     TO PB-I-AH-CLP
 14377     IF PB-COMPANY-ID = 'DCC'
 14378        evaluate true
 14379           when WS-AH-BEN-CATEGORY = 'D'
 14380              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14381                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14382           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14383              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14384           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14385              COMPUTE PB-I-AH-CLP ROUNDED =
 14386                 PB-I-AH-PREMIUM-AMT * (1 - pb-i-ah-commission)
 14387                    - ws-cred-union-fees
 14388        end-evaluate
 14389     END-IF
 14390     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14391
 14392     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14393         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14394
 14395     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14396         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14397
 14398     if (ws-ah-special-calc-cd = 'E')
 14399        and (pb-monthly-cert)
 14400        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 260
* EL050.cbl
 14401     end-if
 14402     IF PB-COMPANY-ID = 'CRI'
 14403         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14404            PB-I-PAYMENT-AMOUNT = ZERO
 14405             NEXT SENTENCE
 14406         ELSE
 14407             COMPUTE PB-I-AH-PREM-CALC =
 14408                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14409                 (CP-PREMIUM-RATE / 100)
 14410             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14411                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14412                                             PB-I-RATE-DEV-PCT-AH.
 14413
 14414     IF (PB-I-AH-RATE  = ZERO)
 14415        and (not pb-monthly-cert)
 14416       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14417           NEXT SENTENCE
 14418       ELSE
 14419         MOVE ER-2642            TO WS-ERROR
 14420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14421
 14422     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14423     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14424     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14425     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14426     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14427     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14428
 14429     IF (PB-COMPANY-ID = 'DCC')
 14430        AND (WS-AH-BEN-CATEGORY = 'G')
 14431        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14432        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14433        IF CP-DEVIATION-CODE NOT = '000'
 14434           MOVE '000'            TO CP-DEVIATION-CODE
 14435           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14436           IF NO-CP-ERROR
 14437              COMPUTE PB-I-DDF-IU-RATE-UP =
 14438              PB-I-AH-CLP - CP-CALC-PREMIUM
 14439           ELSE
 14440              MOVE ER-3057        TO WS-ERROR
 14441              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14442           END-IF
 14443        END-IF
 14444     END-IF
 14445     .
 14446 3335-EDIT-AH-REIN-NSP-RATE.
 14447     IF PB-COMPANY-ID = 'DCC'
 14448        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14449              COMPUTE PB-I-AH-CLP ROUNDED =
 14450                 PB-I-AH-PREMIUM-AMT * (1 - pb-i-ah-commission)
 14451                    - ws-cred-union-fees
 14452        end-if
 14453     END-IF
 14454     IF AH-REIN-NSP-NOT-USED
 14455         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14456
 14457     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14458     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 261
* EL050.cbl
 14459         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14460     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14461     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14462     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14463     MOVE PB-SV-STATE            TO CP-STATE.
 14464     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14465     MOVE ZERO                   TO CP-DEVIATION-CODE
 14466                                    CP-RATE-DEV-PCT.
 14467*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14468     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14469     MOVE '3'                    TO CP-PROCESS-TYPE.
 14470     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14471     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14472                                    CP-RATING-BENEFIT-AMT.
 14473     IF CP-STATE-STD-ABBRV = 'OR'
 14474         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14475                                         PB-I-AH-TERM.
 14476     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14477     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14478     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14479     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14480     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14481     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14482                                    CP-REMAINING-TERM
 14483                                    WS-WORK-TERM.
 14484     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14485     IF PB-COMPANY-ID = 'DCC'
 14486        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14487     END-IF
 14488     IF  PB-COMPANY-ID = 'TIC'
 14489         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14490            MOVE ZERO TO CP-CLASS-CODE.
 14491
 14492     IF PB-COMPANY-ID NOT = 'TIC'
 14493          MOVE ZERO          TO CP-CLASS-CODE.
 14494
 14495     MOVE ZERO               TO CP-DEVIATION-CODE.
 14496
 14497     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14498
 14499     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14500
 14501     MOVE 'R'                   TO CP-RATE-FILE.
 14502     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14503
 14504     IF CP-ERROR-RATE-NOT-FOUND
 14505         MOVE ER-2645        TO WS-ERROR
 14506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14507         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14508
 14509     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14510
 14511     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14512     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14513
 14514     IF PB-I-AH-REI-RATE = ZERO
 14515         MOVE ER-2645        TO WS-ERROR
 14516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 262
* EL050.cbl
 14517
 14518
 14519 3340-CALCULATE-PREMIUM-AMT.
 14520
 14521     IF PB-COMPANY-ID = 'NCL'
 14522         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14523             WS-AH-SPECIAL-CALC-CD = 'O')
 14524             GO TO 3999-END-EDIT.
 14525
 14526     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14527                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14528                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14529                         OR 'AHL'
 14530         NEXT SENTENCE
 14531     ELSE
 14532         IF WS-STATE-ABBREVIATION = 'CT'
 14533             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14534                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14535                 COMPUTE PB-I-LF-PREM-CALC =
 14536                                     PB-I-LF-PREM-CALC * .90
 14537                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14538                                     PB-I-LF-ALT-PREM-CALC * .90
 14539                 COMPUTE PB-I-AH-PREM-CALC =
 14540                                     PB-I-AH-PREM-CALC * .90.
 14541
 14542     IF PB-COMP-LF-PREM
 14543        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14544        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14545
 14546     IF PB-COMP-AH-PREM
 14547        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14548
 14549 3340-CHECK-DCC-TOT-FEES.
 14550     IF (PB-COMPANY-ID = 'DCC')
 14551        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14552        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14553        AND (PB-I-POLICY-IS-MONTHLY)
 14554        CONTINUE
 14555     ELSE
 14556        GO TO 3340-EDIT-LF-AH-TOL
 14557     END-IF
 14558     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14559     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14560     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14561        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14562           PB-I-RATE-DEV-PCT-LF
 14563     END-IF
 14564     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14565        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14566           PB-I-RATE-DEV-PCT-AH
 14567     END-IF
 14568     MOVE 'N'                    TO CP-BEN-CATEGORY
 14569     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14570
 14571     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14572     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14573     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14574     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 263
* EL050.cbl
 14575     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14576     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14577     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14578     MOVE '3'                    TO CP-PROCESS-TYPE.
 14579     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14580     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14581
 14582     MOVE PB-SV-STATE            TO CP-STATE.
 14583     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14584     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14585     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14586     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14587     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14588                                    CP-RATING-BENEFIT-AMT.
 14589     IF CP-STATE-STD-ABBRV = 'OR'
 14590         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14591                                         PB-I-LF-ALT-BENEFIT-AMT.
 14592     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14593     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14594     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14595     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14596     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14597     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14598     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14599     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14600     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14601                                    CP-REMAINING-TERM
 14602                                    CP-LOAN-TERM.
 14603     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14604        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14605           PB-I-LF-PREMIUM-AMT
 14606     end-if
 14607
 14608     IF CP-TRUNCATED-LIFE
 14609        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14610
 14611     IF CP-TERM-IS-DAYS
 14612         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14613     ELSE
 14614         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14615
 14616     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14617     IF CP-SPECIAL-CALC-CD = 'H'
 14618         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14619                                    TO CP-ALTERNATE-BENEFIT
 14620         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14621     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14622     MOVE 'R'                    TO CP-RATE-FILE
 14623     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14624     IF NOT CP-ERROR-RATE-NOT-FOUND
 14625        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14626        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14627           AND (CP-BENEFIT-CD (1:1) = 'S')
 14628           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14629                                    PB-I-LF-PREMIUM-AMT
 14630        END-IF
 14631     ELSE
 14632        MOVE +0                  TO PB-I-TOT-FEES-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 264
* EL050.cbl
 14633     END-IF
 14634     .
 14635 3340-EDIT-LF-AH-TOL.
 14636
 14637***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14638***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14639***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14640***
 14641     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14642         PB-I-AH-PREMIUM-AMT
 14643          GIVING WS-CALC-WORK.
 14644
 14645     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14646        AND WS-CALC-WORK NOT = ZERO
 14647         MOVE ER-2649            TO WS-ERROR
 14648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14649
 14650     SUBTRACT PB-I-LF-PREM-CALC
 14651             FROM PB-I-LF-PREMIUM-AMT
 14652                 GIVING WS-UNSIGN-WRK1.
 14653
 14654     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14655             FROM PB-I-LF-ALT-PREMIUM-AMT
 14656                 GIVING WS-UNSIGN-WRK4.
 14657
 14658     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14659                                + WS-UNSIGN-WRK4.
 14660
 14661     SUBTRACT PB-I-AH-PREM-CALC
 14662             FROM PB-I-AH-PREMIUM-AMT
 14663                 GIVING WS-UNSIGN-WRK2.
 14664
 14665******************************************************************
 14666*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14667******************************************************************
 14668
 14669     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14670         MOVE ZERO TO WS-UNSIGN-WRK1.
 14671
 14672     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14673         MOVE ZERO TO WS-UNSIGN-WRK2.
 14674
 14675     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14676             GIVING WS-UNSIGN-WRK3.
 14677
 14678 3342-CONTINUE.
 14679
 14680     IF (PB-I-LF-RATE = ZERO  AND
 14681         PB-I-AH-RATE = ZERO)
 14682         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14683            WS-AH-SPECIAL-CALC-CD = 'O'
 14684              NEXT SENTENCE
 14685         ELSE
 14686             GO TO 3345-EDIT-CONTINUE.
 14687
 14688     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14689         NEXT SENTENCE
 14690     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 265
* EL050.cbl
 14691     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14692        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14693           IF (PB-REISSUED-CERT         OR
 14694               PB-POLICY-IS-DECLINED    OR
 14695               PB-POLICY-IS-VOIDED)
 14696              NEXT SENTENCE
 14697           ELSE
 14698              IF WS-PREM-REJECT-SW = SPACE
 14699                 MOVE ER-2652    TO WS-ERROR
 14700                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14701                 GO TO 3344-CHECK-AH
 14702              ELSE
 14703                 MOVE ER-2650    TO WS-ERROR
 14704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14705                 GO TO 3344-CHECK-AH.
 14706
 14707***
 14708***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14709***
 14710
 14711     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14712         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14713            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14714             (1 + WS-TOL-LF-PREM-PCT)
 14715         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14716            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14717             (1 - WS-TOL-LF-PREM-PCT)
 14718     ELSE
 14719         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14720         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14721
 14722***
 14723***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14724***
 14725
 14726     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14727         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14728          WS-TOL-LF-PREM.
 14729
 14730     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14731         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14732          WS-TOL-LF-PREM.
 14733
 14734     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14735        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14736
 14737     IF PB-REISSUED-CERT
 14738        or PB-POLICY-IS-DECLINED
 14739        or PB-POLICY-IS-VOIDED
 14740        continue
 14741     ELSE
 14742        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14743              > WS-TOL-LF-HIGH-PREM-AMT)
 14744           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14745              < WS-TOL-LF-LOW-PREM-AMT))
 14746                      or
 14747           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14748              > WS-TOL-LF-HIGH-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 266
* EL050.cbl
 14749           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14750              < WS-TOL-LF-LOW-PREM-PCT))
 14751           IF WS-PREM-REJECT-SW = SPACE
 14752              MOVE ER-2652       TO WS-ERROR
 14753              PERFORM 9900-ERROR-FORMAT
 14754                                 THRU 9900-EXIT
 14755           ELSE
 14756              MOVE ER-2650       TO WS-ERROR
 14757              PERFORM 9900-ERROR-FORMAT
 14758                                 THRU 9900-EXIT
 14759           end-if
 14760        end-if
 14761     end-if
 14762
 14763*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14764*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14765*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14766*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14767
 14768     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14769        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14770                      OR
 14771           ((PB-COMPANY-ID = 'DCC')
 14772           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14773           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14774           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14775        END-IF
 14776     END-IF
 14777
 14778     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14779        IF WS-COMP-MAX-CAP GREATER THAN +0
 14780           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14781              IF (PB-REISSUED-CERT         OR
 14782                  PB-POLICY-IS-DECLINED    OR
 14783                  PB-POLICY-IS-VOIDED)
 14784                 NEXT SENTENCE
 14785              ELSE
 14786                  MOVE ER-2646   TO  WS-ERROR
 14787                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14788
 14789 3344-CVL-TOLERANCE-CHECK.
 14790
 14791      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14792          GO TO 3344-CHECK-AH.
 14793
 14794      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14795          GO TO 3344-CHECK-AH.
 14796
 14797      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14798                                     WS-UNSIGN-WRK6.
 14799
 14800      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14801          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14802                                 + PB-I-LF-PREMIUM-AMT
 14803                                 - PB-I-LF-PREM-CALC.
 14804
 14805      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14806          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 267
* EL050.cbl
 14807                                 + PB-I-LF-ALT-PREMIUM-AMT
 14808                                 - PB-I-LF-ALT-PREM-CALC.
 14809
 14810      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14811          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14812              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14813                 MOVE ER-2652    TO  WS-ERROR
 14814                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14815              ELSE
 14816                 MOVE ER-2650    TO  WS-ERROR
 14817                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14818
 14819      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14820          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14821              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14822                 MOVE ER-2652    TO  WS-ERROR
 14823                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14824              ELSE
 14825                 MOVE ER-2650    TO  WS-ERROR
 14826                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14827
 14828 3344-CHECK-AH.
 14829
 14830****************************************************************
 14831***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14832***
 14833
 14834     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14835         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14836             (1 + WS-TOL-AH-PREM-PCT)
 14837         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14838             (1 - WS-TOL-AH-PREM-PCT)
 14839     ELSE
 14840         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14841         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14842
 14843***
 14844***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14845***
 14846
 14847     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14848         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14849
 14850     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14851         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14852
 14853     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14854        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14855
 14856     IF (PB-REISSUED-CERT)
 14857        OR (PB-POLICY-IS-DECLINED)
 14858        OR (PB-POLICY-IS-VOIDED)
 14859        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14860        CONTINUE
 14861     ELSE
 14862        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14863              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14864                          or
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 268
* EL050.cbl
 14865           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14866              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14867           IF WS-PREM-REJECT-SW = SPACE
 14868              MOVE ER-3052       TO WS-ERROR
 14869              PERFORM 9900-ERROR-FORMAT
 14870                                 THRU 9900-EXIT
 14871           ELSE
 14872              MOVE ER-3050       TO WS-ERROR
 14873              PERFORM 9900-ERROR-FORMAT
 14874                                 THRU 9900-EXIT
 14875           END-IF
 14876        END-IF
 14877     END-IF
 14878     if (pb-company-id = 'DCC')
 14879        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14880        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14881        and (pb-i-policy-is-monthly)
 14882        compute ws-tol-ah-high-prem-amt =
 14883           pb-i-tot-fees-calc + ws-tol-ah-prem
 14884        compute ws-tol-ah-low-prem-amt =
 14885           pb-i-tot-fees-calc - ws-tol-ah-prem
 14886        if ws-tol-ah-prem-pct > zeros
 14887           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14888              (1 + ws-tol-ah-prem-pct)
 14889           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14890              (1 - ws-tol-ah-prem-pct)
 14891        else
 14892           move +9999999.99      to ws-tol-ah-high-prem-pct
 14893           move +0               to ws-tol-ah-low-prem-pct
 14894        end-if
 14895        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14896            or
 14897           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14898                          or
 14899           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14900           or
 14901           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14902            move er-3049         to ws-error
 14903           perform 9900-error-format
 14904                                 thru 9900-exit
 14905
 14906        end-if
 14907     end-if
 14908     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14909         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14910             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14911             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14912
 14913     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14914        IF WS-COMP-MAX-CAP GREATER THAN +0
 14915           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14916              IF (PB-REISSUED-CERT         OR
 14917                  PB-POLICY-IS-DECLINED    OR
 14918                  PB-POLICY-IS-VOIDED)
 14919                 NEXT SENTENCE
 14920              ELSE
 14921                  MOVE ER-2646   TO  WS-ERROR
 14922                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 269
* EL050.cbl
 14923
 14924     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14925        (WS-COMP-MAX-CAP EQUAL +0)
 14926           GO TO 3345-EDIT-CONTINUE.
 14927
 14928     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14929        GREATER THAN WS-COMP-MAX-CAP
 14930           MOVE ER-2646          TO  WS-ERROR
 14931           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14932
 14933 3345-EDIT-CONTINUE.
 14934
 14935*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14936*       IF PB-ENTRY-BATCH   NUMERIC
 14937*          IF PB-ISSUE
 14938*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14939*          ELSE
 14940*              IF PB-CANCELLATION
 14941*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14942
 14943*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14944*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14945*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14946*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14947*        ELSE
 14948*            MOVE  ER-1909            TO  WS-ERROR
 14949*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14950
 14951     IF PB-I-POLICY-ACCEPTED
 14952        IF PB-POLICY-IS-DECLINED  OR
 14953           PB-REISSUED-CERT  OR
 14954           PB-REIN-ONLY-CERT  OR
 14955           PB-POLICY-IS-VOIDED
 14956            MOVE  ER-1891         TO  WS-ERROR
 14957            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14958        ELSE
 14959            MOVE SPACE            TO  PB-BATCH-ENTRY
 14960            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14961
 14962     IF PB-I-POLICY-DECLINED
 14963        IF PB-REISSUED-CERT  OR
 14964           PB-REIN-ONLY-CERT  OR
 14965           PB-POLICY-IS-VOIDED
 14966            MOVE  ER-1906         TO  WS-ERROR
 14967            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14968        ELSE
 14969            MOVE  'D'             TO  PB-BATCH-ENTRY
 14970                                      PB-I-ENTRY-STATUS.
 14971
 14972     IF PB-I-NEEDS-UNDERWRITING
 14973        IF PB-POLICY-IS-DECLINED OR
 14974           PB-REISSUED-CERT  OR
 14975           PB-REIN-ONLY-CERT  OR
 14976           PB-POLICY-IS-VOIDED
 14977            MOVE  ER-1907         TO  WS-ERROR
 14978            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14979        ELSE
 14980            MOVE 'U'              TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 270
* EL050.cbl
 14981                                      PB-I-ENTRY-STATUS.
 14982
 14983     IF PB-NEEDS-UNDERWRITING
 14984        MOVE  ER-1901             TO  WS-ERROR
 14985        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14986     IF PB-COMPANY-ID = 'DCC'
 14987        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14988        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14989        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14990           AND (NOT WS-LF-CASH))
 14991                           OR
 14992           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14993           AND (NOT WS-AH-CASH)))
 14994                       AND
 14995           (PB-I-ENTRY-STATUS NOT = '5')
 14996           MOVE 'M'              TO PB-BATCH-ENTRY
 14997                                    PB-I-ENTRY-STATUS
 14998        END-IF
 14999     END-IF
 15000     IF  PB-COMPANY-ID NOT = 'NCL'
 15001         GO TO 3999-END-EDIT.
 15002
 15003     IF PB-REISSUED-CERT  OR
 15004        PB-POLICY-IS-DECLINED  OR
 15005        PB-POLICY-IS-VOIDED  OR
 15006        PB-I-OB
 15007         GO TO 3999-END-EDIT.
 15008
 15009     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15010         MOVE  ER-2644            TO  WS-ERROR
 15011         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15012         GO TO 3999-END-EDIT.
 15013
 15014     MOVE 'N'                     TO  FORM-MASTER-SW.
 15015     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15016
 15017     IF NOT FORM-MASTER-FOUND
 15018         GO TO 3999-END-EDIT.
 15019
 15020     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15021                                      FORM-MASTER-AH-SW.
 15022
 15023     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15024         MOVE  +1                 TO SUB6
 15025         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15026
 15027     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15028         MOVE  +1                 TO SUB6
 15029         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15030
 15031     IF LF-FORM-MASTER-FOUND  OR
 15032        AH-FORM-MASTER-FOUND
 15033         GO TO 3360-CHECK-FORM-LIMITS
 15034     ELSE
 15035         GO TO 3999-END-EDIT.
 15036
 15037******************************************************************
 15038*                  3350-GET-ERFORM                               *
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 271
* EL050.cbl
 15039*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15040*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15041******************************************************************
 15042
 15043 3350-GET-ERFORM.
 15044
 15045     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15046         GO TO  3350-ERFORM-GETMAIN.
 15047
 15048     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15049     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15050     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15051     MOVE 'Y'                     TO FORM-MASTER-SW.
 15052
 15053     IF PB-CANCELLATION
 15054         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15055            PB-SV-STATE          EQUAL   FO-STATE       AND
 15056            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15057              GO TO 3350-EXIT
 15058         ELSE
 15059             NEXT SENTENCE
 15060     ELSE
 15061         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15062            PB-SV-STATE          EQUAL   FO-STATE       AND
 15063            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15064              GO TO 3350-EXIT.
 15065
 15066 3350-ERFORM-GETMAIN.
 15067
 15068     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15069     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15070
 15071 3350-ERFORM-READ.
 15072
 15073     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15074     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15075     IF PB-CANCELLATION
 15076         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15077     ELSE
 15078         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15079     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15080
 15081     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15082
 15083     IF FORM-MASTER-FOUND
 15084       IF PB-CANCELLATION
 15085          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15086             PB-SV-STATE          EQUAL   FO-STATE       AND
 15087             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15088              GO  TO 3350-EXIT
 15089          ELSE
 15090              NEXT SENTENCE
 15091       ELSE
 15092          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15093             PB-SV-STATE          EQUAL   FO-STATE       AND
 15094             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15095              GO  TO 3350-EXIT.
 15096
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 272
* EL050.cbl
 15097     MOVE  'N'                    TO  FORM-MASTER-SW.
 15098     MOVE  ER-1895                TO  WS-ERROR.
 15099     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15100
 15101 3350-EXIT.
 15102      EXIT.
 15103
 15104******************************************************************
 15105*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15106*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15107*   VALID FOR THE POLICY FORM USED.                              *
 15108******************************************************************
 15109
 15110 3355-EDIT-FORM-LF-BENEFITS.
 15111
 15112     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15113        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15114         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15115         GO TO   3355-EXIT.
 15116
 15117     IF  SUB6    LESS THAN   +40
 15118         ADD  +1      TO  SUB6
 15119         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15120
 15121     MOVE  ER-1896         TO  WS-ERROR.
 15122     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15123
 15124 3355-EXIT.
 15125      EXIT.
 15126
 15127******************************************************************
 15128*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15129*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15130*   VALID FOR THE POLICY FORM USED.                              *
 15131******************************************************************
 15132
 15133 3356-EDIT-FORM-AH-BENEFITS.
 15134
 15135     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15136        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15137         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15138         GO TO  3356-EXIT.
 15139
 15140      IF  SUB6    LESS THAN     +40
 15141          ADD  +1      TO  SUB6
 15142          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15143
 15144     MOVE  ER-1897         TO  WS-ERROR.
 15145     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15146
 15147 3356-EXIT.
 15148      EXIT.
 15149
 15150******************************************************************
 15151*                  3357-BENEFIT-SEARCH                           *
 15152*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15153*   CANCELLATIONS ONLY.                                          *
 15154******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 273
* EL050.cbl
 15155 3357-BENEFIT-SEARCH.
 15156     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15157         MOVE +1                          TO SUB6
 15158         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15159
 15160     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15161         MOVE +1                          TO SUB6
 15162         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15163
 15164 3357-EXIT.
 15165     EXIT.
 15166
 15167******************************************************************
 15168*                  3358-BENEFIT-LIFE-SEARCH                      *
 15169*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15170*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15171*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15172******************************************************************
 15173 3358-BENEFIT-LIFE-SEARCH.
 15174     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15175       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15176         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15177           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15178              IF FO-PLAN-REFUND-METHOD (SUB6)
 15179                     IS GREATER THAN SPACES
 15180                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15181                                          WS-LF-REFUND-CALC
 15182                 GO TO 3358-EXIT.
 15183
 15184     IF SUB6 LESS THAN +40
 15185         ADD +1                 TO SUB6
 15186         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15187
 15188 3358-EXIT.
 15189     EXIT.
 15190******************************************************************
 15191*                  3359-BENEFIT-AH-SEARCH                        *
 15192*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15193*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15194*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15195******************************************************************
 15196 3359-BENEFIT-AH-SEARCH.
 15197     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15198       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15199         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15200           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15201              IF FO-PLAN-REFUND-METHOD (SUB6)
 15202                      IS GREATER THAN SPACES
 15203                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15204                                          WS-AH-REFUND-CALC
 15205                 GO TO 3359-EXIT.
 15206
 15207     IF SUB6 LESS THAN +40
 15208         ADD +1                 TO SUB6
 15209         GO TO 3359-BENEFIT-AH-SEARCH.
 15210
 15211 3359-EXIT.
 15212     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 274
* EL050.cbl
 15213
 15214******************************************************************
 15215*                  3360-CHECK-FORM-LIMITS                        *
 15216*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15217*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15218******************************************************************
 15219
 15220 3360-CHECK-FORM-LIMITS.
 15221
 15222     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15223         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15224
 15225     IF NOT LF-FORM-MASTER-FOUND
 15226         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15227
 15228 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15229
 15230     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15231       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15232        WS-LF-JOINT-INDICATOR = 'J'  AND
 15233        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15234         IF PB-COMPANY-ID = 'NCL'
 15235            MOVE  ER-1911          TO  WS-ERROR
 15236            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15237         ELSE
 15238            MOVE  ER-1892          TO  WS-ERROR
 15239            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15240
 15241 3360-CHECK-FORM-LF-ATT-AGE.
 15242
 15243     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15244
 15245     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15246         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15247         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15248            IF PB-COMPANY-ID = 'NCL'
 15249                MOVE  ER-1913      TO  WS-ERROR
 15250                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15251            ELSE
 15252                MOVE  ER-1894      TO  WS-ERROR
 15253                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15254
 15255 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15256
 15257     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15258         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15259         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15260            IF PB-COMPANY-ID = 'NCL'
 15261                MOVE  ER-1914      TO  WS-ERROR
 15262                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15263            ELSE
 15264                MOVE  ER-1899      TO  WS-ERROR
 15265                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15266
 15267 3360-CHECK-FORM-LF-TERM-BAMT.
 15268
 15269     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15270         FO-LF-MAX-TERM   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 275
* EL050.cbl
 15271         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15272           IF  PB-COMPANY-ID = 'NCL'
 15273               MOVE  ER-1916       TO  WS-ERROR
 15274               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15275           ELSE
 15276               MOVE  ER-1902       TO  WS-ERROR
 15277               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15278
 15279     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15280                                    PB-I-LF-ALT-BENEFIT-AMT.
 15281
 15282     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15283         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15284         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15285             IF  PB-COMPANY-ID = 'NCL'
 15286                 MOVE  ER-1918     TO  WS-ERROR
 15287                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15288             ELSE
 15289                 MOVE  ER-1904     TO  WS-ERROR
 15290                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15291
 15292******************************************************************
 15293*                  3360-CHECK-FORM-AH-LIMITS                     *
 15294*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15295*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15296******************************************************************
 15297
 15298 3360-CHECK-FORM-AH-LIMITS.
 15299
 15300     IF NOT AH-FORM-MASTER-FOUND
 15301         GO TO 3999-END-EDIT.
 15302
 15303 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15304
 15305     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15306       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15307        WS-AH-JOINT-INDICATOR = 'J'  AND
 15308        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15309         IF PB-COMPANY-ID = 'NCL'
 15310            MOVE  ER-1912          TO  WS-ERROR
 15311            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15312         ELSE
 15313            MOVE  ER-1893          TO  WS-ERROR
 15314            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15315
 15316 3360-CHECK-FORM-AH-ATT-AGE.
 15317
 15318     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15319
 15320     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15321         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15322         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15323            IF PB-COMPANY-ID = 'NCL'
 15324                MOVE  ER-1913      TO  WS-ERROR
 15325                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15326            ELSE
 15327                MOVE  ER-1894      TO  WS-ERROR
 15328                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 276
* EL050.cbl
 15329
 15330 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15331
 15332     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15333         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15334         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15335            IF PB-COMPANY-ID = 'NCL'
 15336                MOVE  ER-1915      TO  WS-ERROR
 15337                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15338            ELSE
 15339                MOVE  ER-1900      TO  WS-ERROR
 15340                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15341
 15342 3360-CHECK-FORM-AH-TERM-BAMT.
 15343
 15344     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15345         FO-AH-MAX-TERM    GREATER THAN  +0
 15346         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15347             IF  PB-COMPANY-ID = 'NCL'
 15348                 MOVE  ER-1917     TO  WS-ERROR
 15349                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15350             ELSE
 15351                  MOVE  ER-1903    TO  WS-ERROR
 15352                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15353
 15354     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15355         FO-MAX-AH-AMT    GREATER THAN  +0
 15356         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15357             IF  PB-COMPANY-ID = 'NCL'
 15358                 MOVE  ER-1919     TO  WS-ERROR
 15359                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15360             ELSE
 15361                 MOVE  ER-1905     TO  WS-ERROR
 15362                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15363
 15364     GO TO 3999-END-EDIT.
 15365
 15366******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 277
* EL050.cbl
 15368******************************************************************
 15369*                  E D I T   C A N C E L                         *
 15370******************************************************************
 15371
 15372 3700-EDIT-CANCEL.
 15373     IF PB-COMPANY-ID = 'DMD'
 15374         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15375                                         WS-RES-MUNI-TAX
 15376                                         PB-CI-STATE-TAX
 15377                                         PB-CI-MUNI-TAX
 15378         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15379
 15380*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15381*       IF PB-ENTRY-BATCH  NUMERIC
 15382*          IF PB-CANCELLATION
 15383*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15384*          ELSE
 15385*             IF PB-ISSUE
 15386*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15387
 15388     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15389        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15390     END-IF
 15391*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15392*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15393
 15394     IF CM-ENTRY-STATUS = 'V'
 15395        MOVE ER-2780             TO WS-ERROR
 15396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15397        GO TO 3999-END-EDIT.
 15398
 15399     IF CM-ENTRY-STATUS = 'D'
 15400        MOVE ER-2781             TO WS-ERROR
 15401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15402        GO TO 3999-END-EDIT.
 15403
 15404     IF CM-ENTRY-STATUS = 'U'
 15405        MOVE ER-2782             TO WS-ERROR
 15406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15407
 15408***************************************************************
 15409*                                                             *
 15410*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15411*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15412*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15413*   OF ANOTHER COVERAGE.                                      *
 15414*                                                             *
 15415***************************************************************
 15416
 15417     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15418                                    PB-C-AH-CANCEL-VOID-SW.
 15419
 15420     IF PB-C-LF-CANCEL-AMT = ZERO
 15421        NEXT SENTENCE
 15422     ELSE
 15423        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15424           AND
 15425           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 278
* EL050.cbl
 15426               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15427               MOVE ER-2745           TO WS-ERROR
 15428               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15429
 15430     IF PB-C-AH-CANCEL-AMT = ZERO
 15431        NEXT SENTENCE
 15432     ELSE
 15433        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15434           AND
 15435           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15436               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15437               MOVE ER-2745           TO WS-ERROR
 15438               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15439
 15440     IF WS-LF-EARNINGS-CALC = '4'
 15441        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15442
 15443     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15444     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15445     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15446     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15447     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15448     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15449
 15450     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15451                                      PB-C-AH-REF-CALC.
 15452     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15453
 15454******************************************************************
 15455*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15456*             TO VALIDATE COVERAGE.                              *
 15457******************************************************************
 15458
 15459     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15460        PB-C-LF-CANCEL-AMT = ZEROS
 15461          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15462      ELSE
 15463          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15464
 15465     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15466        PB-C-AH-CANCEL-AMT = ZEROS
 15467          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15468      ELSE
 15469          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15470
 15471     EVALUATE TRUE
 15472         WHEN PB-CANCEL-FORCE             OR
 15473              PB-CANCEL-DATE-FORCED       OR
 15474              PB-FORCE-OFF
 15475                  IF PB-COMPANY-ID = 'ACE'
 15476                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15477                  END-IF
 15478         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15479               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15480              (PB-COMPANY-ID = 'ACE' )
 15481                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15482         WHEN OTHER
 15483              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 279
* EL050.cbl
 15484                 MOVE ER-2794              TO WS-ERROR
 15485              ELSE
 15486                 MOVE ER-2749              TO WS-ERROR
 15487              END-IF
 15488              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15489     END-EVALUATE.
 15490
 15491
 15492*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15493*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15494*            MOVE  ER-1909            TO  WS-ERROR
 15495*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15496*        ELSE
 15497*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15498
 15499     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15500     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15501        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15502     ELSE
 15503        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15504     END-IF
 15505     .
 15506 3705-EDIT-CANCEL-DT.
 15507
 15508     IF LF-COVERAGE-CANCELLED
 15509        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15510         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15511         MOVE WS-CURRENT-MONTH-END
 15512                                 TO DC-BIN-DATE-2
 15513         SET ELAPSED-BETWEEN-BIN TO TRUE
 15514*        MOVE 1                  TO DC-OPTION-CODE
 15515         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15516         IF DATE-CONVERSION-ERROR
 15517            NEXT SENTENCE
 15518          ELSE
 15519             IF DC-ELAPSED-DAYS GREATER +180
 15520                IF PB-CANCEL-DATE-FORCED  OR
 15521                   PB-CANCEL-DATE-FORCED-NO-FEE
 15522                      MOVE ER-2751  TO WS-ERROR
 15523                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15524                 ELSE
 15525                   MOVE ER-2752  TO WS-ERROR
 15526                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15527
 15528     IF AH-COVERAGE-CANCELLED
 15529        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15530         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15531         MOVE WS-CURRENT-MONTH-END
 15532                                 TO DC-BIN-DATE-2
 15533         SET ELAPSED-BETWEEN-BIN TO TRUE
 15534*        MOVE 1                  TO DC-OPTION-CODE
 15535         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15536         IF DATE-CONVERSION-ERROR
 15537            NEXT SENTENCE
 15538          ELSE
 15539             IF DC-ELAPSED-DAYS GREATER +180
 15540                IF PB-CANCEL-DATE-FORCED OR
 15541                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 280
* EL050.cbl
 15542                      MOVE ER-2751  TO WS-ERROR
 15543                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15544                 ELSE
 15545                   MOVE ER-2752  TO WS-ERROR
 15546                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15547
 15548     IF WS-ERROR = ER-2752
 15549        AND (PB-COMPANY-ID = 'ABL'
 15550         OR  PB-COMPANY-ID = 'FGL'
 15551         OR  PB-COMPANY-ID = 'IST'
 15552         OR  PB-COMPANY-ID = 'JHL'
 15553         OR  PB-COMPANY-ID = 'LAP'
 15554         OR  PB-COMPANY-ID = 'LBL'
 15555         OR  PB-COMPANY-ID = 'NCB'
 15556         OR  PB-COMPANY-ID = 'NLI'
 15557         OR  PB-COMPANY-ID = 'OFI'
 15558         OR  PB-COMPANY-ID = 'PLI'
 15559         OR  PB-COMPANY-ID = 'TAO'
 15560         OR  PB-COMPANY-ID = 'TIC'
 15561         OR  PB-COMPANY-ID = 'HER'
 15562         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15563         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15564            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15565            MOVE ER-2762     TO WS-ERROR
 15566            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15567
 15568     IF LF-COVERAGE-CANCELLED
 15569        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15570        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15571             MOVE ER-2733         TO WS-ERROR
 15572             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15573
 15574     IF AH-COVERAGE-CANCELLED
 15575        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15576        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15577              MOVE ER-2733        TO WS-ERROR
 15578              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15579
 15580     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15581        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15582        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15583           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15584            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15585              IF PB-COMPANY-ID NOT = 'LAP'
 15586               MOVE ER-2704            TO WS-ERROR
 15587               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15588
 15589     IF CERT-WAS-NOT-FOUND
 15590         GO TO 3999-END-EDIT.
 15591
 15592     IF PB-COMPANY-ID EQUAL 'CDC'
 15593        IF LF-COVERAGE-CANCELLED
 15594           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15595            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15596            MOVE PB-C-LF-CANCEL-DT
 15597                                 TO DC-BIN-DATE-2
 15598            SET ELAPSED-BETWEEN-BIN TO TRUE
 15599*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 281
* EL050.cbl
 15600            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15601            IF DATE-CONVERSION-ERROR
 15602               NEXT SENTENCE
 15603             ELSE
 15604                IF DC-ELAPSED-DAYS GREATER +60
 15605                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15606
 15607     IF PB-COMPANY-ID EQUAL 'CDC'
 15608        IF AH-COVERAGE-CANCELLED
 15609           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15610            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15611            MOVE PB-C-AH-CANCEL-DT
 15612                                 TO DC-BIN-DATE-2
 15613            MOVE +0              TO DC-ELAPSED-DAYS
 15614                                    DC-ELAPSED-MONTHS
 15615            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15616*           MOVE 1               TO DC-OPTION-CODE
 15617            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15618            IF DATE-CONVERSION-ERROR
 15619               NEXT SENTENCE
 15620             ELSE
 15621                IF DC-ELAPSED-DAYS GREATER +60
 15622                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15623
 15624     MOVE +0                     TO DC-ELAPSED-DAYS
 15625                                    DC-ELAPSED-MONTHS.
 15626
 15627     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15628        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15629          MOVE 'Z'                TO PB-CI-OB-FLAG
 15630          MOVE ER-2767            TO WS-ERROR
 15631          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15632          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15633          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15634          GO TO 3775-OVER-REF-CHK
 15635        ELSE
 15636          MOVE ZEROS              TO PB-CI-LIVES
 15637                                     PB-C-LIVES
 15638          IF PB-CI-OB-FLAG NOT = 'B'
 15639             MOVE SPACE           TO PB-CI-OB-FLAG.
 15640
 15641     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15642         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15643     ELSE
 15644         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15645
 15646     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15647        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15648            MOVE ER-2760         TO WS-ERROR
 15649            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15650
 15651     IF LF-COVERAGE-CANCELLED
 15652        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15653         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15654            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15655               MOVE ER-2774       TO WS-ERROR
 15656               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15657
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 282
* EL050.cbl
 15658     IF AH-COVERAGE-CANCELLED
 15659        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15660         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15661            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15662               MOVE ER-2775       TO WS-ERROR
 15663               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15664
 15665     IF LF-COVERAGE-CANCELLED
 15666        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15667         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15668            MOVE ER-2776         TO WS-ERROR
 15669            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15670
 15671     IF AH-COVERAGE-CANCELLED
 15672        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15673         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15674            MOVE ER-2777         TO WS-ERROR
 15675            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15676
 15677     IF LF-COVERAGE-CANCELLED
 15678        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15679        if pb-ci-lf-expire-dt = low-values or spaces
 15680           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15681           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15682           MOVE PB-CI-EXTENTION-DAYS
 15683                                 TO DC-ELAPSED-DAYS
 15684           SET BIN-PLUS-ELAPSED  TO TRUE
 15685           PERFORM 8500-DATE-CONVERT
 15686                                 THRU 8500-EXIT
 15687           IF DATE-CONVERSION-ERROR
 15688              move low-values    to dc-bin-date-2
 15689           end-if
 15690        else
 15691           move pb-ci-lf-expire-dt
 15692                                 to dc-bin-date-2
 15693        end-if
 15694        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15695           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15696                             OR  'FIA'
 15697              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15698           ELSE
 15699              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15700              MOVE ER-2731       TO WS-ERROR
 15701              PERFORM 9900-ERROR-FORMAT
 15702                                 THRU 9900-EXIT
 15703           end-if
 15704        end-if
 15705     end-if
 15706*    IF LF-COVERAGE-CANCELLED
 15707*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15708*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15709*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15710*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15711*        SET BIN-PLUS-ELAPSED      TO TRUE
 15712*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15713*        IF DATE-CONVERSION-ERROR
 15714*           NEXT SENTENCE
 15715*         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 283
* EL050.cbl
 15716*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15717*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15718*                            OR  'FIA'
 15719*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15720*              ELSE
 15721*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15722*               MOVE ER-2731       TO WS-ERROR
 15723*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15724     .
 15725 3705-EDIT-AH-CANCEL-DT.
 15726     IF AH-COVERAGE-CANCELLED
 15727        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15728        if pb-ci-AH-expire-dt = low-values or spaces
 15729           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15730           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15731           MOVE PB-CI-EXTENTION-DAYS
 15732                                 TO DC-ELAPSED-DAYS
 15733           SET BIN-PLUS-ELAPSED  TO TRUE
 15734           PERFORM 8500-DATE-CONVERT
 15735                                 THRU 8500-EXIT
 15736           IF DATE-CONVERSION-ERROR
 15737              move low-values    to dc-bin-date-2
 15738           end-if
 15739        else
 15740           move pb-ci-ah-expire-dt
 15741                                 to dc-bin-date-2
 15742        end-if
 15743        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15744           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15745                             OR  'FIA'
 15746              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15747           ELSE
 15748              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15749              MOVE ER-2771       TO WS-ERROR
 15750              PERFORM 9900-ERROR-FORMAT
 15751                                 THRU 9900-EXIT
 15752           end-if
 15753        end-if
 15754     end-if
 15755*    IF AH-COVERAGE-CANCELLED
 15756*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15757*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15758*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15759*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15760**       MOVE 6                    TO DC-OPTION-CODE
 15761*        SET BIN-PLUS-ELAPSED      TO TRUE
 15762*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15763*        IF DATE-CONVERSION-ERROR
 15764*           NEXT SENTENCE
 15765*         ELSE
 15766*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15767*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15768*                             OR 'FIA'
 15769*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15770*             ELSE
 15771*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15772*              MOVE ER-2771       TO WS-ERROR
 15773*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 284
* EL050.cbl
 15774     .
 15775 3705-EDIT-CONTINUED.
 15776
 15777*    IF LF-COVERAGE-CANCELLED
 15778*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15779*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15780*            MOVE ER-2727         TO WS-ERROR
 15781*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15782*
 15783*    IF AH-COVERAGE-CANCELLED
 15784*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15785*        IF PB-COMPANY-ID = 'ACE'
 15786*           MOVE ER-2727        TO WS-ERROR
 15787*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15788*        ELSE
 15789*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15790*              MOVE ER-2727     TO WS-ERROR
 15791*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15792
 15793     IF PB-COMPANY-ID = 'ACE'
 15794       IF AH-COVERAGE-CANCELLED
 15795         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15796           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15797              MOVE ER-2732      TO WS-ERROR
 15798              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15799
 15800     IF PB-COMPANY-ID      EQUAL   'HER'
 15801        IF WS-ERROR        EQUAL   ER-2727
 15802            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15803            MOVE  ER-2725          TO  WS-ERROR
 15804            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15805
 15806     IF PB-C-CLAIM-CREATED-CANCEL
 15807            MOVE ER-2748         TO WS-ERROR
 15808            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15809
 15810     IF PB-C-LAST-NAME NOT = SPACES
 15811         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15812            MOVE ER-2747         TO WS-ERROR
 15813            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15814
 15815 3710-EDIT-LUMP-SUM-PRIOR.
 15816
 15817     IF AH-COVERAGE-CANCELLED
 15818         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15819             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15820                MOVE ER-2735    TO WS-ERROR
 15821                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15822
 15823     IF LF-COVERAGE-CANCELLED
 15824         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15825             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15826                MOVE ER-2735    TO WS-ERROR
 15827                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15828
 15829 3710-EDIT-PRIOR-DEATH.
 15830
 15831*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 285
* EL050.cbl
 15832*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15833*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15834*           (NOT PB-CI-OB)
 15835*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15836*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15837*                   MOVE ER-2732  TO WS-ERROR
 15838*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15839*
 15840*    IF AH-COVERAGE-CANCELLED
 15841*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15842*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15843*           (NOT PB-CI-OB)
 15844*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15845*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15846*                   MOVE ER-2732  TO WS-ERROR
 15847*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15848
 15849     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15850         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15851            (NOT PB-COMP-LF-CANCEL)
 15852             NEXT SENTENCE
 15853         ELSE
 15854           IF PB-C-LF-CANCEL-VOIDED
 15855              NEXT SENTENCE
 15856           ELSE
 15857              MOVE ER-2753      TO WS-ERROR
 15858              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15859
 15860     IF CANCEL-FUTURE-DT
 15861         GO TO 3999-END-EDIT.
 15862
 15863 3715-GET-REMAIN-TERM-LF.
 15864
 15865     IF NO-LF-BENEFIT-MATCH  OR
 15866        WS-LF-BENEFIT-CD = ZEROS
 15867        GO TO 3730-GET-AH-REMAIN-TERM.
 15868
 15869     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15870     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15871     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15872     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15873     MOVE PB-SV-STATE            TO CP-STATE.
 15874     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15875     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15876     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15877     MOVE '2'                    TO CP-PROCESS-TYPE.
 15878     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15879     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15880     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15881     IF (PB-COMPANY-ID = 'CID')
 15882        AND (CP-STATE-STD-ABBRV = 'WI')
 15883        MOVE '7'                 TO CP-REM-TERM-METHOD
 15884        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15885     ELSE
 15886        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15887        MOVE WS-REM-TRM-CALC-OPTION
 15888                                 TO CP-REM-TRM-CALC-OPTION
 15889     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 286
* EL050.cbl
 15890**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15891     IF (PB-COMPANY-ID = 'CID')
 15892        AND (CP-STATE-STD-ABBRV = 'MO')
 15893        AND (PB-CERT-EFF-DT >= X'9B41')
 15894        AND (PB-CERT-EFF-DT <= X'A2FB')
 15895        MOVE '7'                 TO CP-REM-TERM-METHOD
 15896        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15897     END-IF
 15898     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15899                                    CP-LOAN-TERM.
 15900     IF CP-TRUNCATED-LIFE
 15901        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15902
 15903     IF CP-TERM-IS-DAYS
 15904         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15905     ELSE
 15906         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15907
 15908     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15909
 15910     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15911
 15912     IF LF-COVERAGE-CANCELLED
 15913        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15914        NEXT SENTENCE
 15915      ELSE
 15916          GO TO 3730-GET-AH-REMAIN-TERM.
 15917
 15918 3720-GET-LF-REFUND.
 15919
 15920     IF PB-C-LF-CANCEL-VOIDED
 15921        GO TO 3730-GET-AH-REMAIN-TERM
 15922     end-if
 15923
 15924     IF PB-COMPANY-ID EQUAL 'BOA'
 15925         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15926         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15927         GO TO 3730-GET-AH-REMAIN-TERM.
 15928
 15929     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15930        (WS-AH-SPECIAL-CALC-CD = 'M')
 15931         MOVE ER-2767            TO WS-ERROR
 15932         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15933         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15934         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15935         GO TO 3780-UPDATE-CANCEL-CERT.
 15936
 15937*    if (ws-lf-earnings-calc = '6')
 15938*       or (pb-c-lf-refund-override = '6')
 15939*       move cp-remaining-term-1 to cp-remaining-term-2
 15940*    end-if
 15941     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15942
 15943     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15944     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15945     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15946     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15947     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 287
* EL050.cbl
 15948     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15949     IF (PB-COMPANY-ID = 'DCC')
 15950        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15951        IF PDEF-MASTER-FOUND
 15952           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15953              (V1 > +8)
 15954              OR (PD-PROD-CODE (V1) = 'L')
 15955           END-PERFORM
 15956           IF V1 < +9
 15957              MOVE PD-MAX-AMT (V1)
 15958                           TO CP-R-MAX-TOT-BEN
 15959                              EC-AM-LF-MAX-TOT-BEN
 15960           END-IF
 15961        ELSE
 15962        MOVE ' '                 TO PDEF-MASTER-SW
 15963        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15964        MOVE PB-STATE            TO ERPDEF-STATE
 15965        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15966        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15967        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15968        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15969        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15970        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15971        IF PDEF-MASTER-FOUND
 15972           MOVE 'N'              TO PDEF-MASTER-SW
 15973           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15974           IF PDEF-MASTER-FOUND
 15975              IF (ERPDEF-KEY-SAVE (1:16) =
 15976                           PD-CONTROL-PRIMARY (1:16))
 15977                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15978                 CONTINUE
 15979              ELSE
 15980                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15981                 IF (ERPDEF-KEY-SAVE (1:16) =
 15982                           PD-CONTROL-PRIMARY (1:16))
 15983                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15984                    CONTINUE
 15985                 ELSE
 15986                    MOVE 'N'     TO PDEF-MASTER-SW
 15987                 END-IF
 15988              END-IF
 15989
 15990              IF PDEF-MASTER-FOUND
 15991                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15992                    (V1 > +8)
 15993                    OR (PD-PROD-CODE (V1) = 'L')
 15994                 END-PERFORM
 15995                 IF V1 < +9
 15996                    MOVE PD-MAX-AMT (V1)
 15997                                 TO CP-R-MAX-TOT-BEN
 15998                                    EC-AM-LF-MAX-TOT-BEN
 15999                 END-IF
 16000              END-IF
 16001           END-IF
 16002           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16003        END-IF
 16004        END-IF
 16005     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 288
* EL050.cbl
 16006     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16007
 16008     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16009
 16010     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16011                                    PB-C-LF-REM-TERM.
 16012
 16013     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16014     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16015
 16016     IF PB-COMPANY-ID EQUAL 'FLC'
 16017        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16018           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16019           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16020                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16021                    - CM-LF-ITD-DEATH-AMT
 16022           IF PB-C-LF-REF-CALC LESS THAN +0
 16023              MOVE +0            TO PB-C-LF-REF-CALC
 16024              GO TO 3730-GET-AH-REMAIN-TERM
 16025           ELSE
 16026              GO TO 3730-GET-AH-REMAIN-TERM.
 16027
 16028     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16029                            OR '4' OR '5' OR '6' OR '8'
 16030                            OR '9' OR 'G'
 16031        MOVE PB-C-LF-REFUND-OVERRIDE
 16032                                 TO CP-EARNING-METHOD.
 16033
 16034     if pb-company-id = 'AHL'
 16035        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16036        if cp-class-code = spaces
 16037           move zeros            to cp-class-code
 16038        end-if
 16039     ELSE
 16040        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16041     END-IF
 16042*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16043     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16044     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16045                                    CP-RATING-BENEFIT-AMT.
 16046     IF CP-STATE-STD-ABBRV = 'OR'
 16047         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16048                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16049     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16050     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16051     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16052     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16053     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16054     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16055     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16056     IF WS-DEFAULT-APR NOT NUMERIC
 16057         MOVE ZEROS TO WS-DEFAULT-APR.
 16058****   N O T E   ****
 16059*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16060*      THE OH HARD CODING IN ELCRFNDP
 16061
 16062     IF PB-COMPANY-ID = 'CID'
 16063        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 289
* EL050.cbl
 16064           MOVE WS-LF-EARNINGS-CALC
 16065                                 TO CP-EARNING-METHOD
 16066        END-IF
 16067     END-IF
 16068
 16069****   N O T E   ****
 16070
 16071     IF CP-EARN-AS-NET-PAY
 16072         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16073            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16074                MOVE WS-DEFAULT-APR
 16075                                 TO  CP-LOAN-APR
 16076                MOVE ER-3780     TO  WS-ERROR
 16077                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16078            ELSE
 16079                MOVE ER-3781     TO  WS-ERROR
 16080                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16081*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16082     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16083
 16084     IF CP-REFUND-TYPE-USED NOT = SPACE
 16085         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16086
 16087     IF CP-ERROR-RATE-IS-ZERO OR
 16088        CP-ERROR-RATE-NOT-FOUND
 16089        MOVE ER-2740             TO WS-ERROR
 16090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16091
 16092     IF CP-ERROR-RATE-FILE-NOTOPEN
 16093        MOVE ER-2617             TO WS-ERROR
 16094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16095
 16096     IF PB-COMPANY-ID = 'DCC'
 16097        AND PB-CI-ENTRY-STATUS = 'M'
 16098        MOVE +0                  TO PB-C-LF-REF-CALC
 16099     ELSE
 16100        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16101     END-IF
 16102
 16103     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16104         GO TO 3730-GET-AH-REMAIN-TERM.
 16105
 16106*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16107*       ADD +1                   TO PB-C-LF-REM-TERM
 16108*                                   CP-REMAINING-TERM
 16109*                                   CP-ORIGINAL-TERM.
 16110
 16111     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16112     MOVE '2'                    TO CP-EARNING-METHOD
 16113                                    CP-RATING-METHOD.
 16114     IF PB-COMPANY-ID = 'CID'
 16115        IF (CP-STATE-STD-ABBRV = 'MN')
 16116           AND (PB-CERT-EFF-DT > X'A4FF')
 16117           AND (WS-LF-EARNINGS-CALC = 'B')
 16118           MOVE '5'              TO CP-EARNING-METHOD
 16119           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16120        END-IF
 16121     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 290
* EL050.cbl
 16122     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16123                                        CP-REMAINING-BENEFIT
 16124                                        CP-RATING-BENEFIT-AMT.
 16125     IF CP-STATE-STD-ABBRV = 'OR'
 16126         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16127                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16128     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16129     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16130
 16131     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16132
 16133     IF CP-ERROR-RATE-IS-ZERO OR
 16134        CP-ERROR-RATE-NOT-FOUND
 16135        MOVE ER-2740             TO WS-ERROR
 16136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16137
 16138     IF CP-ERROR-RATE-FILE-NOTOPEN
 16139        MOVE ER-2617             TO WS-ERROR
 16140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16141
 16142     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16143
 16144******************************************************************
 16145
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 291
* EL050.cbl
 16147 3730-GET-AH-REMAIN-TERM.
 16148     IF NO-AH-BENEFIT-MATCH  OR
 16149        WS-AH-BENEFIT-CD = ZEROS
 16150         GO TO 3770-CHECK-REFUNDS.
 16151
 16152     IF PB-CI-AH-LUMP-SUM-DISAB
 16153         IF  PB-C-AH-CANCEL-AMT = ZERO
 16154            IF NOT PB-COMP-AH-CANCEL
 16155             GO TO 3770-CHECK-REFUNDS.
 16156
 16157     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16158     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16159     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16160     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16161     MOVE PB-SV-STATE            TO CP-STATE.
 16162     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16163     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16164     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16165     MOVE '2'                    TO CP-PROCESS-TYPE.
 16166     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16167     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16168     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16169     IF (PB-COMPANY-ID = 'CID')
 16170        AND (CP-STATE-STD-ABBRV = 'WI')
 16171        MOVE '7'                 TO CP-REM-TERM-METHOD
 16172        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16173     ELSE
 16174        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16175        MOVE WS-REM-TRM-CALC-OPTION
 16176                                 TO CP-REM-TRM-CALC-OPTION
 16177     END-IF
 16178     IF (PB-COMPANY-ID = 'CID')
 16179        AND (CP-STATE-STD-ABBRV = 'MO')
 16180        AND (PB-CERT-EFF-DT >= X'9B41')
 16181        AND (PB-CERT-EFF-DT <= X'A2FB')
 16182        MOVE '7'                 TO CP-REM-TERM-METHOD
 16183        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16184     END-IF
 16185     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16186                                    CP-LOAN-TERM.
 16187     IF NOT CP-TERM-IS-DAYS
 16188         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16189
 16190     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16191
 16192     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16193
 16194     IF AH-COVERAGE-CANCELLED
 16195        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16196        NEXT SENTENCE
 16197      ELSE
 16198         GO TO 3770-CHECK-REFUNDS.
 16199
 16200 3740-GET-AH-REFUND.
 16201
 16202     IF PB-C-AH-CANCEL-VOIDED
 16203        GO TO 3780-UPDATE-CANCEL-CERT
 16204     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 292
* EL050.cbl
 16205
 16206     IF PB-COMPANY-ID = 'BOA'
 16207         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16208         GO TO 3770-CHECK-REFUNDS.
 16209
 16210     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16211*    MOVE ' '                    TO DC-OPTION-CODE
 16212     SET BIN-TO-GREG             TO TRUE
 16213     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16214     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16215                                    PB-C-AH-REM-TERM.
 16216     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16217     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16218
 16219     IF PB-COMPANY-ID EQUAL 'FLC'
 16220        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16221           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16222           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16223                    - CM-AH-ITD-AH-PMT)
 16224           IF PB-C-AH-REF-CALC LESS THAN +0
 16225              MOVE +0            TO PB-C-AH-REF-CALC
 16226              GO TO 3770-CHECK-REFUNDS
 16227           ELSE
 16228              GO TO 3770-CHECK-REFUNDS.
 16229
 16230     IF PB-COMPANY-ID = 'DCC'
 16231        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16232            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16233           MOVE 'S'              TO CP-EARNING-METHOD
 16234        END-IF
 16235     END-IF
 16236     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16237                            OR '4' OR '5' OR '6' OR '8'
 16238                            OR '9' OR 'G' OR 'S'
 16239        MOVE PB-C-AH-REFUND-OVERRIDE
 16240                                 TO CP-EARNING-METHOD.
 16241
 16242     if pb-company-id = 'AHL'
 16243        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16244        if cp-class-code = spaces
 16245           move zeros            to cp-class-code
 16246        end-if
 16247     ELSE
 16248        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16249     END-IF
 16250*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16251     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16252     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16253                                    CP-RATING-BENEFIT-AMT.
 16254     IF CP-STATE-STD-ABBRV = 'OR'
 16255         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16256                                         PB-CI-AH-TERM.
 16257     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16258     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16259     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16260     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16261     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16262     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 293
* EL050.cbl
 16263
 16264     IF CP-STATE-STD-ABBRV = 'OH'
 16265        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16266                                AND 'CID' AND 'DCC' AND 'AHL')
 16267           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16268              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16269              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16270              MOVE '6' TO CP-EARNING-METHOD
 16271           END-IF
 16272        END-IF
 16273        IF PB-COMPANY-ID = 'CID'
 16274           IF NO-LIFE-COVERAGE
 16275              IF CP-CRITICAL-PERIOD
 16276                 MOVE '2'       TO CP-EARNING-METHOD
 16277              ELSE
 16278                 MOVE '6'       TO CP-EARNING-METHOD
 16279              END-IF
 16280           ELSE
 16281              IF WS-LF-COVERAGE-TYPE = 'L'
 16282                 MOVE '2'       TO CP-EARNING-METHOD
 16283              ELSE
 16284                 IF (PB-CI-LF-TERM > +60) OR
 16285                    (WS-LF-EARNINGS-CALC = '5')
 16286                    IF CP-CRITICAL-PERIOD
 16287                       MOVE '2'  TO CP-EARNING-METHOD
 16288                    ELSE
 16289                       MOVE '6'  TO CP-EARNING-METHOD
 16290                    END-IF
 16291                 ELSE
 16292                    MOVE '1'     TO CP-EARNING-METHOD
 16293                 END-IF
 16294              END-IF
 16295           END-IF
 16296        END-IF
 16297     END-IF
 16298
 16299*    IF CP-STATE-STD-ABBRV = 'VA'
 16300*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16301*          IF CP-ORIGINAL-TERM GREATER 61
 16302*             MOVE '6' TO CP-EARNING-METHOD
 16303*          ELSE
 16304*             MOVE '1' TO CP-EARNING-METHOD.
 16305
 16306     IF WS-DEFAULT-APR NOT NUMERIC
 16307         MOVE ZEROS TO WS-DEFAULT-APR.
 16308     IF CP-EARN-AS-NET-PAY
 16309         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16310            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16311                MOVE WS-DEFAULT-APR
 16312                                 TO  CP-LOAN-APR
 16313                MOVE ER-3780     TO  WS-ERROR
 16314                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16315            ELSE
 16316                MOVE ER-3781     TO  WS-ERROR
 16317                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16318     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16319     IF PB-COMPANY-ID = 'DCC'
 16320        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 294
* EL050.cbl
 16321        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16322        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16323     END-IF
 16324     IF PB-COMPANY-ID = 'DCC'
 16325        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16326        AND (CP-EARNING-METHOD = 'D')
 16327        AND (CP-CANCEL-REASON NOT = 'R')
 16328        CONTINUE
 16329     ELSE
 16330        GO TO 3750-CONTINUE
 16331     END-IF
 16332     MOVE ' '                    TO DD-IU-SW
 16333     IF NOT PDEF-MASTER-FOUND
 16334        MOVE ' '                 TO PDEF-MASTER-SW
 16335        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16336        MOVE PB-STATE            TO ERPDEF-STATE
 16337        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16338        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16339        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16340        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16341        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16342        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16343        IF PDEF-MASTER-FOUND
 16344           MOVE 'N'              TO PDEF-MASTER-SW
 16345           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16346           IF PDEF-MASTER-FOUND
 16347              IF (ERPDEF-KEY-SAVE (1:16) =
 16348                           PD-CONTROL-PRIMARY (1:16))
 16349                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16350                 CONTINUE
 16351              ELSE
 16352                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16353                 IF (ERPDEF-KEY-SAVE (1:16) =
 16354                           PD-CONTROL-PRIMARY (1:16))
 16355                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16356                    CONTINUE
 16357                 ELSE
 16358                    MOVE ER-2740 TO WS-ERROR
 16359                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16360                    GO TO 3770-CHECK-REFUNDS
 16361                 END-IF
 16362              END-IF
 16363           END-IF
 16364           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16365        END-IF
 16366     END-IF
 16367     IF PDEF-MASTER-FOUND
 16368        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16369           (V1 > +8)
 16370           OR (PD-PROD-CODE (V1) = 'I')
 16371        END-PERFORM
 16372        IF V1 < +9
 16373           SET DD-IU-PRESENT        TO TRUE
 16374        END-IF
 16375        IF WS-AH-DCC-TRUNC = 'T'
 16376           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16377        ELSE
 16378           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 295
* EL050.cbl
 16379        END-IF
 16380        EVALUATE TRUE
 16381           WHEN WS-TERM > +168
 16382              MOVE 15               TO V1
 16383           WHEN WS-TERM > +156
 16384              MOVE 14               TO V1
 16385           WHEN WS-TERM > +144
 16386              MOVE 13               TO V1
 16387           WHEN WS-TERM > +132
 16388              MOVE 12               TO V1
 16389           WHEN WS-TERM > +120
 16390              MOVE 11               TO V1
 16391           WHEN WS-TERM > +108
 16392              MOVE 10               TO V1
 16393           WHEN WS-TERM > +96
 16394              MOVE 9                TO V1
 16395           WHEN WS-TERM > +84
 16396              MOVE 8                TO V1
 16397           WHEN WS-TERM > +72
 16398              MOVE 7                TO V1
 16399           WHEN WS-TERM > +60
 16400              MOVE 6                TO V1
 16401           WHEN WS-TERM > +48
 16402              MOVE 5                TO V1
 16403           WHEN WS-TERM > +36
 16404              MOVE 4                TO V1
 16405           WHEN WS-TERM > +24
 16406              MOVE 3                TO V1
 16407           WHEN WS-TERM > +12
 16408              MOVE 2                TO V1
 16409           WHEN OTHER
 16410              MOVE 1                TO V1
 16411        END-EVALUATE
 16412
 16413        EVALUATE TRUE
 16414*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16415*             < +13)
 16416*             AND (DD-IU-PRESENT)
 16417*             MOVE 2                TO V2
 16418*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16419*             MOVE 1                TO V2
 16420           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16421              MOVE 2                TO V2
 16422           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16423              MOVE 3                TO V2
 16424           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16425              MOVE 4                TO V2
 16426           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16427              MOVE 5                TO V2
 16428           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16429              MOVE 6                TO V2
 16430           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16431              MOVE 7                TO V2
 16432           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16433              MOVE 8                TO V2
 16434           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16435              MOVE 9                TO V2
 16436           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 296
* EL050.cbl
 16437              MOVE 10               TO V2
 16438           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16439              MOVE 11               TO V2
 16440           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16441              MOVE 12               TO V2
 16442           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16443              MOVE 13               TO V2
 16444           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16445              MOVE 14               TO V2
 16446           WHEN OTHER
 16447              MOVE 15               TO V2
 16448        END-EVALUATE
 16449
 16450        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16451                                 TO CP-DDF-LO-FACT
 16452        MOVE PD-UEP-FACTOR (V1 V2)
 16453                                 TO CP-DDF-HI-FACT
 16454
 16455        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16456        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16457        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16458           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16459        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16460        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16461        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16462           + PD-1ST-YR-ADMIN-ALLOW
 16463
 16464        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16465*       IF PI-CLP-YN = 'Y'
 16466*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16467*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16468*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16469*       END-IF
 16470
 16471        IF DD-IU-PRESENT
 16472           MOVE 'I'              TO CP-EARNING-METHOD
 16473        END-IF
 16474        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16475                                     CP-CLP-RATE-UP
 16476        IF CP-IU-RATE-UP NOT = ZEROS
 16477           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16478              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16479           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16480              / (1 - WS-WORK-FACT)
 16481        END-IF
 16482     END-IF
 16483     .
 16484 3750-CONTINUE.
 16485     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16486
 16487     IF CP-REFUND-TYPE-USED NOT = SPACE
 16488         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16489
 16490     IF CP-ERROR-RATE-IS-ZERO OR
 16491        CP-ERROR-RATE-NOT-FOUND
 16492        MOVE ER-2740             TO WS-ERROR
 16493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16494
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 297
* EL050.cbl
 16495     IF CP-ERROR-RATE-FILE-NOTOPEN
 16496        MOVE ER-2617             TO WS-ERROR
 16497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16498     IF PB-COMPANY-ID = 'DCC'
 16499        AND PB-CI-ENTRY-STATUS = 'M'
 16500        MOVE +0                  TO PB-C-AH-REF-CALC
 16501     ELSE
 16502        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16503     END-IF
 16504     IF PB-COMPANY-ID = 'DCC'
 16505        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16506        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16507        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16508        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16509        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16510        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16511        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16512        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16513*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16514     END-IF
 16515     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 298
* EL050.cbl
 16517
 16518 3770-CHECK-REFUNDS.
 16519
 16520     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16521        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16522           MOVE ER-2766          TO WS-ERROR
 16523           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16524           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16525           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16526              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16527
 16528     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16529        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16530           MOVE ER-2766          TO WS-ERROR
 16531           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16532           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16533           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16534              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16535
 16536     IF PB-COMP-LF-CANCEL
 16537        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16538        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16539           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16540              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16541
 16542     IF PB-COMP-AH-CANCEL
 16543        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16544        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16545           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16546              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16547
 16548     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16549             GIVING WS-UNSIGN-WRK1
 16550     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16551             GIVING WS-UNSIGN-WRK2.
 16552
 16553     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16554         MOVE ZERO TO WS-UNSIGN-WRK1.
 16555
 16556     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16557         MOVE ZERO TO WS-UNSIGN-WRK2.
 16558
 16559     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16560
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 299
* EL050.cbl
 16562
 16563 3772-CONTINUE.
 16564
 16565**********************************
 16566*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16567*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16568*** DOUBLES THE TOLERANCE AMOUNT.
 16569***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16570**********************************
 16571     IF PB-COMPANY-ID = 'MON'
 16572     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16573         IF WS-REF-REJECT-SW = SPACE
 16574             MOVE ER-2754        TO WS-ERROR
 16575             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16576           ELSE
 16577             MOVE ER-2736        TO WS-ERROR
 16578             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16579**********************************
 16580
 16581 3773-CONTINUE.
 16582
 16583     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16584        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16585           MOVE ER-2723          TO WS-ERROR
 16586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16587
 16588     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16589        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16590           MOVE ER-2724          TO WS-ERROR
 16591           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16592
 16593     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16594         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16595             (1 + WS-LF-REFUND-OVS-PCT)
 16596     ELSE
 16597         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16598
 16599     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16600         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16601             (1 - WS-TOL-LF-REFUND-PCT)
 16602     ELSE
 16603         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16604
 16605     IF (PB-COMPANY-ID = 'DCC')
 16606        AND (PB-CI-ENTRY-STATUS = 'M')
 16607        AND (PB-C-LF-CANCEL-AMT > +0)
 16608        MOVE ER-3843             TO WS-ERROR
 16609        PERFORM 9900-ERROR-FORMAT
 16610                                 THRU 9900-EXIT
 16611     END-IF
 16612     EVALUATE TRUE
 16613        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16614           CONTINUE
 16615        WHEN PB-C-LF-CANCEL-AMT = +0
 16616                 AND PB-C-LF-REF-CALC > +0
 16617           CONTINUE
 16618        WHEN WS-LF-REFUND-OVS-AMT = 0
 16619                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 300
* EL050.cbl
 16620           CONTINUE
 16621        WHEN OTHER
 16622           IF WS-TOL-LF-REFUND  = +0
 16623              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16624           END-IF
 16625           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16626                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16627                          (PB-C-LF-CANCEL-AMT))
 16628              CONTINUE
 16629           ELSE
 16630              IF WS-LF-REFUND-OVS-AMT = +0
 16631                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16632              END-IF
 16633              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16634                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16635                                       PB-C-LF-CANCEL-AMT)
 16636                 CONTINUE
 16637              ELSE
 16638                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16639                   MOVE ER-2754   TO  WS-ERROR
 16640                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16641                 ELSE
 16642                    MOVE ER-2736   TO  WS-ERROR
 16643                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16644                 END-IF
 16645              END-IF
 16646           END-IF
 16647     END-EVALUATE.
 16648
 16649     EVALUATE TRUE
 16650        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16651           CONTINUE
 16652        WHEN PB-C-LF-CANCEL-AMT = +0
 16653                 AND PB-C-LF-REF-CALC > +0
 16654           CONTINUE
 16655        WHEN OTHER
 16656           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16657               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16658              CONTINUE
 16659           ELSE
 16660              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16661               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16662                CONTINUE
 16663              ELSE
 16664                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16665                     MOVE ER-2754   TO  WS-ERROR
 16666                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16667                 ELSE
 16668                     MOVE ER-2736   TO  WS-ERROR
 16669                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16670                 END-IF
 16671              END-IF
 16672           END-IF
 16673     END-EVALUATE.
 16674
 16675     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16676         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16677             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 301
* EL050.cbl
 16678     ELSE
 16679         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16680
 16681     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16682         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16683             (1 - WS-TOL-AH-REFUND-PCT)
 16684     ELSE
 16685         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16686
 16687     IF (PB-COMPANY-ID = 'DCC')
 16688        AND (PB-CI-ENTRY-STATUS = 'M')
 16689        AND (PB-C-AH-CANCEL-AMT > +0)
 16690        MOVE ER-3843             TO WS-ERROR
 16691        PERFORM 9900-ERROR-FORMAT
 16692                                 THRU 9900-EXIT
 16693     END-IF
 16694     EVALUATE TRUE
 16695        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16696           CONTINUE
 16697*       WHEN PB-C-AH-REF-CALC = +0 AND
 16698*                  PB-C-AH-CANCEL-AMT > +0
 16699        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16700                   PB-C-AH-REF-CALC > +0
 16701           CONTINUE
 16702        WHEN WS-AH-REFUND-OVS-AMT = +0
 16703                AND WS-TOL-AH-REFUND = +0
 16704           CONTINUE
 16705        WHEN OTHER
 16706           IF WS-TOL-AH-REFUND = +0
 16707              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16708           END-IF
 16709           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16710               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16711                                         PB-C-AH-CANCEL-AMT)
 16712              CONTINUE
 16713           ELSE
 16714              IF WS-AH-REFUND-OVS-AMT = +0
 16715                 MOVE +9999999.99 TO
 16716                         WS-AH-REFUND-OVS-AMT
 16717              END-IF
 16718              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16719                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16720                                         PB-C-AH-CANCEL-AMT)
 16721                 CONTINUE
 16722              ELSE
 16723                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16724                    MOVE ER-2754   TO  WS-ERROR
 16725                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16726                 ELSE
 16727                    MOVE ER-2736   TO  WS-ERROR
 16728                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16729                 END-IF
 16730              END-IF
 16731           END-IF
 16732     END-EVALUATE.
 16733
 16734     EVALUATE TRUE
 16735        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 302
* EL050.cbl
 16736           CONTINUE
 16737*       WHEN PB-C-AH-REF-CALC > +0 AND
 16738*                  PB-C-AH-CANCEL-AMT = +0
 16739        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16740                   PB-C-AH-REF-CALC = +0
 16741           CONTINUE
 16742        WHEN OTHER
 16743           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16744               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16745              CONTINUE
 16746           ELSE
 16747              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16748                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16749                 CONTINUE
 16750              ELSE
 16751                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16752                     MOVE ER-2754   TO  WS-ERROR
 16753                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16754                 ELSE
 16755                     MOVE ER-2736   TO  WS-ERROR
 16756                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16757                 END-IF
 16758              END-IF
 16759           END-IF
 16760     END-EVALUATE.
 16761
 16762     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16763        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16764        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16765           AND  PB-C-LF-REF-CALC < +1.00
 16766           AND  PB-C-AH-REF-CALC < +1.00
 16767           CONTINUE
 16768        ELSE
 16769           IF (PB-COMPANY-ID = 'DCC')
 16770              AND (PB-CI-ENTRY-STATUS = 'M')
 16771              CONTINUE
 16772           ELSE
 16773              MOVE ER-2741       TO WS-ERROR
 16774              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16775           END-IF
 16776        END-IF
 16777     END-IF
 16778
 16779     IF (PB-C-LF-CANCEL-AMT = ZERO
 16780        AND WS-LF-BENEFIT-CD NOT = ZERO
 16781        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16782        AND PB-C-LF-REF-CALC NOT = ZERO)
 16783        OR
 16784        (PB-C-LF-CANCEL-AMT = ZERO
 16785        AND WS-LF-BENEFIT-CD NOT = ZERO
 16786        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16787             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16788                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16789                NEXT SENTENCE
 16790             ELSE
 16791                MOVE ER-2739        TO WS-ERROR
 16792                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16793
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 303
* EL050.cbl
 16794     IF (PB-C-AH-CANCEL-AMT = ZERO
 16795        AND WS-AH-BENEFIT-CD NOT = ZERO
 16796        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16797        AND PB-C-AH-REF-CALC NOT = ZERO)
 16798        OR
 16799        (PB-C-AH-CANCEL-AMT = ZERO
 16800        AND WS-AH-BENEFIT-CD NOT = ZERO
 16801        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16802             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16803                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16804                NEXT SENTENCE
 16805             ELSE
 16806                MOVE ER-2738        TO WS-ERROR
 16807                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16808
 16809 3775-OVER-REF-CHK.
 16810
 16811     IF PB-CI-ENTRY-STATUS = '5'
 16812        GO TO 3780-UPDATE-CANCEL-CERT.
 16813
 16814     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16815                              PB-CI-LF-ALT-PREMIUM-AMT.
 16816
 16817     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16818        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16819                                 PB-C-LF-REF-CALC
 16820      ELSE
 16821        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16822                                 PB-C-LF-CANCEL-AMT.
 16823
 16824     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16825        MOVE ER-2755             TO WS-ERROR
 16826        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16827
 16828     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16829
 16830     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16831        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16832                                 PB-C-AH-REF-CALC
 16833      ELSE
 16834        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16835                                 PB-C-AH-CANCEL-AMT.
 16836
 16837     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16838        MOVE ER-2778             TO WS-ERROR
 16839        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16840
 16841     IF PB-CI-OB-FLAG NOT = 'Z'
 16842        NEXT SENTENCE
 16843       ELSE
 16844         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16845            MOVE ER-2757           TO WS-ERROR
 16846            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16847
 16848 3780-UPDATE-CANCEL-CERT.
 16849
 16850     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16851        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 304
* EL050.cbl
 16852        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16853
 16854     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16855         MOVE ER-2729              TO WS-ERROR
 16856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16857
 16858     IF PB-CI-LF-BENEFIT-CD = ZERO
 16859         GO TO 3780-UPDATE-CONT-1.
 16860
 16861     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16862         GO TO 3780-UPDATE-CONT-1.
 16863
 16864     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16865       AND
 16866        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16867       AND
 16868        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16869       AND
 16870        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16871            NEXT SENTENCE
 16872       ELSE
 16873        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16874          AND
 16875***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16876***       AND
 16877           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16878            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16879               MOVE ER-2730      TO WS-ERROR
 16880               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16881               GO TO 3999-END-EDIT
 16882            ELSE
 16883               GO TO 3999-END-EDIT
 16884        ELSE
 16885            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16886               MOVE ER-2765           TO WS-ERROR
 16887               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16888               GO TO 3785-CHECK-NH.
 16889*              GO TO 3999-END-EDIT.
 16890
 16891 3780-UPDATE-CONT-1.
 16892     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16893
 16894     IF PB-CI-AH-BENEFIT-CD = ZERO
 16895         GO TO 3780-UPDATE-CONT-2.
 16896
 16897     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16898         GO TO 3780-UPDATE-CONT-2.
 16899
 16900     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16901
 16902     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16903       AND
 16904        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16905       AND
 16906        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16907       AND
 16908        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16909            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 305
* EL050.cbl
 16910       ELSE
 16911        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16912          AND
 16913***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16914***       AND
 16915           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16916           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16917            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16918               MOVE ER-2773      TO WS-ERROR
 16919               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16920               GO TO 3999-END-EDIT
 16921            ELSE
 16922               GO TO 3999-END-EDIT
 16923            END-IF
 16924           ELSE
 16925             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16926                IF MSTR-CERT-NO = W-CL-CERT-NO
 16927                   MOVE ER-2890 TO WS-ERROR
 16928                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16929                   GO TO 3999-END-EDIT
 16930                ELSE
 16931                   MOVE ER-2898 TO WS-ERROR
 16932                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16933                   GO TO 3999-END-EDIT
 16934                END-IF
 16935             ELSE
 16936                GO TO 3785-CHECK-NH
 16937             END-IF
 16938           END-IF
 16939          ELSE
 16940            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16941              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16942                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16943                   IF MSTR-CERT-NO = W-CL-CERT-NO
 16944                      MOVE ER-2890 TO WS-ERROR
 16945                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16946                      GO TO 3999-END-EDIT
 16947                   ELSE
 16948                      MOVE ER-2898 TO WS-ERROR
 16949                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16950                      GO TO 3999-END-EDIT
 16951                   END-IF
 16952                ELSE
 16953                   MOVE ER-2765 TO WS-ERROR
 16954                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16955                   GO TO 3785-CHECK-NH
 16956                END-IF
 16957              ELSE
 16958               MOVE ER-2765      TO WS-ERROR
 16959               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16960               GO TO 3785-CHECK-NH.
 16961*              GO TO 3999-END-EDIT.
 16962
 16963 3780-UPDATE-CONT-2.
 16964
 16965     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16966        AND WS-LF-BENEFIT-CD = ZERO
 16967           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 306
* EL050.cbl
 16968           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16969
 16970     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16971        AND WS-AH-BENEFIT-CD = ZERO
 16972           MOVE ER-2744           TO WS-ERROR
 16973           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16974
 16975     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16976        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16977        AND
 16978        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16979         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 16980           MOVE ER-2746           TO WS-ERROR
 16981           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16982
 16983     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16984       AND
 16985        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16986             MOVE ER-2737        TO WS-ERROR
 16987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16988
 16989     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16990       AND
 16991        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16992             MOVE ER-2737        TO WS-ERROR
 16993             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16994
 16995     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16996         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16997             OR 'CID' OR 'DCC' OR 'AHL'
 16998             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16999         ELSE
 17000             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17001                 MOVE ER-2768    TO WS-ERROR
 17002                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17003             ELSE
 17004                 MOVE ER-2756    TO WS-ERROR
 17005                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17006
 17007     IF CERT-PEND-ISSUE-RETURNED
 17008        MOVE ER-2772             TO WS-ERROR
 17009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17010 3785-CHECK-NH.
 17011     IF PB-STATE NOT = 'NH'
 17012        GO TO 3999-END-EDIT
 17013     END-IF
 17014
 17015     MOVE ER-2796                TO WS-ERROR
 17016     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17017     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17018        OR (CM-NH-INTERFACE-SW = 'Y')
 17019        MOVE ER-2793             TO WS-ERROR
 17020        PERFORM 9900-ERROR-FORMAT
 17021                                 THRU 9900-EXIT
 17022     END-IF
 17023     MOVE +0                     TO WS-PAYMENT-AMT
 17024     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17025        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 307
* EL050.cbl
 17026     END-IF
 17027     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17028        GO TO 3999-END-EDIT
 17029     END-IF
 17030     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17031     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17032     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17033        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17034     END-IF
 17035     MOVE '1'                    TO DC-OPTION-CODE
 17036     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17037     IF NO-CONVERSION-ERROR
 17038        IF DC-ELAPSED-DAYS < +16
 17039           GO TO 3999-END-EDIT
 17040        END-IF
 17041     END-IF
 17042     MOVE +0                     TO DC-ELAPSED-DAYS
 17043     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17044     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17045     MOVE '1'                    TO DC-OPTION-CODE
 17046     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17047     IF NO-CONVERSION-ERROR
 17048        IF DC-ELAPSED-DAYS > +30
 17049           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17050        ELSE
 17051           GO TO 3999-END-EDIT
 17052        END-IF
 17053     ELSE
 17054        GO TO 3999-END-EDIT
 17055     END-IF
 17056     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17057        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17058           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17059     IF WS-PAYMENT-AMT < 600.00
 17060        GO TO 3999-END-EDIT
 17061     END-IF
 17062     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17063
 17064     IF (ERMAIL-FOUND = ' ')
 17065         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17066         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17067        GO TO 3999-END-EDIT
 17068     END-IF
 17069     MOVE ER-2795                TO WS-ERROR
 17070     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17071
 17072     GO TO 3999-END-EDIT.
 17073******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 308
* EL050.cbl
 17075 3990-FILES-NOT-OPEN.
 17076
 17077     MOVE ER-2617                TO WS-ERROR.
 17078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17079     GO TO 9990-RETURN.
 17080
 17081 3999-END-EDIT.
 17082
 17083     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17084
 17085     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17086         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17087         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17088             PERFORM 9250-UNLOCK-RETURN
 17089             GO TO 9990-RETURN
 17090          ELSE
 17091             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17092             GO TO 9990-RETURN.
 17093
 17094     IF PB-CANCELLATION
 17095          GO TO 9990-RETURN.
 17096
 17097     IF CERT-WAS-NOT-FOUND
 17098        MOVE SPACES              TO CERTIFICATE-MASTER.
 17099
 17100     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17101
 17102     IF CERT-WAS-FOUND
 17103         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17104             PERFORM 9250-UNLOCK-RETURN
 17105          ELSE
 17106            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17107      ELSE
 17108         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17109
 17110     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17111        IF PB-COMPANY-ID = 'DCC' AND
 17112           (PB-CARRIER = '2' OR '4' OR '6')
 17113              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17114        END-IF
 17115     END-IF.
 17116
 17117     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17118         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17119     END-IF.
 17120     move ' '                    to ws-ins-age-defaulted
 17121     perform 8150-read-elcrtt    thru 8150-exit
 17122     if ws-ins-age-defaulted = 'Y'
 17123        move er-1573             to ws-error
 17124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17125     end-if
 17126
 17127     if ws-jnt-age-defaulted = 'Y'
 17128        move er-1574             to ws-error
 17129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17130     end-if
 17131
 17132     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 309
* EL050.cbl
 17133     IF ((PB-COMPANY-ID = 'DCC')
 17134        AND (WS-NO-SECURE-PAY))
 17135                  OR
 17136        (WS-LF-SPECIAL-CALC-CD = 'O'
 17137        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17138        SET SKIP-ADDR-EDIT       TO TRUE
 17139     END-IF
 17140     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17141        AND (NOT SKIP-ADDR-EDIT)
 17142        MOVE ER-2963             TO WS-ERROR
 17143        PERFORM 9900-ERROR-FORMAT
 17144                                 THRU 9900-EXIT
 17145        GO TO 9990-RETURN
 17146     END-IF
 17147     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17148     IF ERPNDM-FOUND NOT = 'X'
 17149        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17150           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17151           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17152           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17153           AND (NOT SKIP-ADDR-EDIT)
 17154           MOVE ER-2694          TO WS-ERROR
 17155           PERFORM 9900-ERROR-FORMAT
 17156                                 THRU 9900-EXIT
 17157        END-IF
 17158        MOVE ' '                 TO STATE-RECORD-ERROR
 17159        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17160        MOVE PM-STATE            TO CNTL-ACCESS
 17161        MOVE '3'                 TO CNTL-REC-TYPE
 17162        MOVE +0                  TO CNTL-SEQ-NO
 17163        MOVE '0'                 TO RC-SW-2
 17164        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17165        IF (NO-STATE-RECORD)
 17166           OR (CF-RECORD-TYPE NOT = '3')
 17167           OR (PM-STATE NOT = CF-STATE-CODE)
 17168           IF (PM-STATE = SPACES)
 17169              AND (SKIP-ADDR-EDIT)
 17170              CONTINUE
 17171           ELSE
 17172              MOVE ER-2963       TO WS-ERROR
 17173              PERFORM 9900-ERROR-FORMAT
 17174                                 THRU 9900-EXIT
 17175           END-IF
 17176        END-IF
 17177        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17178           MOVE ER-2883          TO WS-ERROR
 17179           PERFORM 9900-ERROR-FORMAT
 17180                                 THRU 9900-EXIT
 17181        END-IF
 17182        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17183           MOVE ' '                 TO STATE-RECORD-ERROR
 17184           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17185           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17186           MOVE '3'                 TO CNTL-REC-TYPE
 17187           MOVE +0                  TO CNTL-SEQ-NO
 17188           MOVE '0'                 TO RC-SW-2
 17189           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17190           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 310
* EL050.cbl
 17191              OR (CF-RECORD-TYPE NOT = '3')
 17192              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17193              MOVE ER-2964          TO WS-ERROR
 17194              PERFORM 9900-ERROR-FORMAT
 17195                                    THRU 9900-EXIT
 17196           END-IF
 17197        END-IF
 17198     ELSE
 17199        IF NOT SKIP-ADDR-EDIT
 17200           MOVE ER-2393          TO WS-ERROR
 17201           PERFORM 9900-ERROR-FORMAT
 17202                                 THRU 9900-EXIT
 17203        END-IF
 17204     END-IF
 17205
 17206     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17207
 17208     IF (ERMAIL-FOUND = ' ' AND
 17209        ERPNDM-FOUND = ' ')
 17210        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17211           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17212           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17213          OR
 17214           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17215          OR
 17216           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17217           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17218           GO TO 3999-UNLOCK-ERMAIL.
 17219
 17220     IF ERPNDM-FOUND = 'X'
 17221        GO TO 3999-UNLOCK-ERMAIL.
 17222
 17223     IF PM-INSURED-LAST-NAME      = SPACES
 17224        AND PM-INSURED-FIRST-NAME = SPACES
 17225        AND PM-ADDRESS-LINE-1     = SPACES
 17226        AND PM-ADDRESS-LINE-2     = SPACES
 17227        AND PM-CITY-STATE         = SPACES
 17228        AND PM-CRED-BENE-NAME     = SPACES
 17229        AND PM-CRED-BENE-ADDR     = SPACES
 17230        AND PM-CRED-BENE-CTYST    = SPACES
 17231        GO TO 3999-UNLOCK-ERMAIL
 17232     END-IF
 17233
 17234     MOVE SPACES                 TO MAILING-DATA.
 17235
 17236     MOVE 'MA'                   TO MA-RECORD-ID.
 17237     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17238     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17239     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17240     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17241     MOVE PB-SV-STATE            TO MA-STATE.
 17242     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17243     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17244
 17245     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17246     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17247
 17248     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 311
* EL050.cbl
 17249        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17250     ELSE
 17251        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17252        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17253        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17254
 17255     GO TO 9990-RETURN.
 17256
 17257 3999-UNLOCK-ERMAIL.
 17258     IF ERMAIL-FOUND = ' '
 17259        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17260
 17261     GO TO 9990-RETURN.
 17262******************************************************************
 17263
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 312
* EL050.cbl
 17265 4000-UPDATE-CANCELLED-CERT.
 17266     IF CERT-WAS-NOT-FOUND
 17267        GO TO 4299-EXIT.
 17268
 17269*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17270     IF PB-C-NH-INT-ON-REFS > ZEROS
 17271        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17272     END-IF
 17273     IF PB-C-REF-INTERFACE-SW = 'Y'
 17274        MOVE PB-C-REF-INTERFACE-SW
 17275                                 TO CM-NH-INTERFACE-SW
 17276     END-IF
 17277     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17278     IF ERMAIL-FOUND = 'X'
 17279        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17280        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17281        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17282        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17283           MOVE ER-2694          TO WS-ERROR
 17284           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17285     END-IF
 17286
 17287     IF PB-C-POST-CARD-IND = 'Y'
 17288        MOVE +8                  TO SUB
 17289*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17290        IF ERMAIL-FOUND = ' '
 17291           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17292              (SUB > +7)
 17293              OR (MA-MAIL-STATUS (SUB) = '1')
 17294           END-PERFORM
 17295        END-IF
 17296        IF (SUB > +7)
 17297           OR (ERMAIL-FOUND = 'X')
 17298           MOVE ER-3789          TO WS-ERROR
 17299           PERFORM 9900-ERROR-FORMAT
 17300                                 THRU 9900-EXIT
 17301        END-IF
 17302     ELSE
 17303        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17304     END-IF
 17305
 17306     IF ERMAIL-FOUND = ' '
 17307        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17308     END-IF.
 17309
 17310     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17311
 17312     IF PB-CI-OB-FLAG = 'Z'
 17313        GO TO 4150-SUMMARY-CERT-CANCEL.
 17314
 17315     IF PB-C-LF-CANCEL-VOIDED
 17316         PERFORM 4200-REVERSE-LF-CANCEL.
 17317     IF PB-C-AH-CANCEL-VOIDED
 17318         PERFORM 4200-REVERSE-AH-CANCEL.
 17319
 17320 4100-APPLY-LF-CANCEL.
 17321
 17322     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 313
* EL050.cbl
 17323
 17324 4100-CHECK-LF-ERRORS.
 17325
 17326     ADD +1                       TO WS-SUB.
 17327
 17328     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17329        IF LF-COVERAGE-CANCELLED
 17330           GO TO 4100-LF-CANCEL-CONT
 17331        ELSE
 17332           GO TO 4100-UPDATE-LF-COVERAGE.
 17333
 17334     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17335                                   ER-2729 OR
 17336                                   ER-2730 OR
 17337                                   ER-2731 OR
 17338                                   ER-2732 OR
 17339                                   ER-2737 OR
 17340                                   ER-2740 OR
 17341                                   ER-2743 OR
 17342                                   ER-2749 OR
 17343                                   ER-2750 OR
 17344                                   ER-2755 OR
 17345                                   ER-2757 OR
 17346                                   ER-2760 OR
 17347                                   ER-2772 OR
 17348                                   ER-2774 OR
 17349                                   ER-2776 OR
 17350                                   ER-2794
 17351        GO TO 4100-UPDATE-LF-COVERAGE.
 17352
 17353     GO TO 4100-CHECK-LF-ERRORS.
 17354
 17355 4100-UPDATE-LF-COVERAGE.
 17356
 17357     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17358     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17359     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17360        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17361     END-IF
 17362     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17363                                      TO CM-CREDIT-INTERFACE-SW-2.
 17364     IF CM-LF-CANCEL-DT = LOW-VALUE
 17365         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17366
 17367     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17368         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17369                                         CM-LF-STATUS-AT-CANCEL.
 17370
 17371     GO TO 4100-APPLY-AH-CANCEL.
 17372
 17373 4100-LF-CANCEL-CONT.
 17374     IF PB-C-LF-CANCEL-VOIDED
 17375         GO TO 4100-APPLY-AH-CANCEL.
 17376
 17377     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17378         GO TO 4100-APPLY-AH-CANCEL.
 17379
 17380     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 314
* EL050.cbl
 17381        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17382           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17383        ELSE
 17384           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17385
 17386     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17387     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17388
 17389     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17390         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17391
 17392     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17393        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17394         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17395         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17396
 17397     IF PB-RECORD-RETURNED
 17398        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17399      ELSE
 17400        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17401
 17402 4100-APPLY-AH-CANCEL.
 17403
 17404     MOVE +0                      TO WS-SUB.
 17405
 17406 4100-CHECK-AH-ERRORS.
 17407
 17408     ADD +1                       TO WS-SUB.
 17409
 17410     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17411        IF AH-COVERAGE-CANCELLED
 17412           GO TO 4100-AH-CANCEL-CONT
 17413        ELSE
 17414           GO TO 4100-UPDATE-AH-COVERAGE.
 17415
 17416     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17417                                   ER-2729 OR
 17418                                   ER-2732 OR
 17419                                   ER-2737 OR
 17420                                   ER-2740 OR
 17421                                   ER-2744 OR
 17422                                   ER-2749 OR
 17423                                   ER-2750 OR
 17424                                   ER-2755 OR
 17425                                   ER-2757 OR
 17426                                   ER-2760 OR
 17427                                   ER-2771 OR
 17428                                   ER-2772 OR
 17429                                   ER-2773 OR
 17430                                   ER-2775 OR
 17431                                   ER-2777 OR
 17432                                   ER-2778 OR
 17433                                   ER-2794
 17434        GO TO 4100-UPDATE-AH-COVERAGE.
 17435
 17436     GO TO 4100-CHECK-AH-ERRORS.
 17437
 17438 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 315
* EL050.cbl
 17439
 17440     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17441     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17442     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17443     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17444                                      TO CM-CREDIT-INTERFACE-SW-2.
 17445     IF CM-AH-CANCEL-DT = LOW-VALUE
 17446         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17447
 17448     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17449         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17450                                         CM-AH-STATUS-AT-CANCEL.
 17451
 17452     IF LF-COVERAGE-CANCELLED
 17453         IF PB-RECORD-RETURNED
 17454              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17455          ELSE
 17456              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17457
 17458     GO TO 4299-EXIT.
 17459
 17460 4100-AH-CANCEL-CONT.
 17461     IF PB-C-AH-CANCEL-VOIDED
 17462         GO TO 4299-EXIT.
 17463
 17464     if cm-credit-interface-sw-2 = ' '
 17465        if pb-fatal-errors or pb-unforced-errors
 17466           move '4'              to cm-credit-interface-sw-2
 17467        else
 17468           move '1'              to cm-credit-interface-sw-2
 17469        end-if
 17470     end-if
 17471     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17472         GO TO 4299-EXIT.
 17473
 17474     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17475        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17476           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17477        ELSE
 17478           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17479
 17480     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17481     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17482
 17483     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17484         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17485
 17486     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17487         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17488         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17489
 17490     IF PB-RECORD-RETURNED
 17491        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17492      ELSE
 17493        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17494
 17495     GO TO 4299-EXIT.
 17496
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 316
* EL050.cbl
 17497 4150-SUMMARY-CERT-CANCEL.
 17498     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17499
 17500     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17501        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17502                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17503     ELSE
 17504        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17505                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17506
 17507     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17508        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17509                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17510     ELSE
 17511        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17512                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17513
 17514     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17515        NEXT SENTENCE
 17516     ELSE
 17517        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17518
 17519     GO TO 4299-EXIT.
 17520
 17521 4200-REVERSE-LF-CANCEL.
 17522     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17523
 17524     IF CM-LF-CANCEL-APPLIED
 17525        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17526        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17527        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17528
 17529     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17530
 17531     IF PB-RECORD-RETURNED
 17532        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17533       ELSE
 17534        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17535
 17536 4200-REVERSE-LF-EXIT.
 17537       EXIT.
 17538
 17539 4200-REVERSE-AH-CANCEL.
 17540     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17541
 17542     IF CM-AH-CANCEL-APPLIED
 17543        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17544        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17545        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17546
 17547     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17548
 17549     IF PB-RECORD-RETURNED
 17550        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17551       ELSE
 17552        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17553
 17554 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 317
* EL050.cbl
 17555       EXIT.
 17556
 17557 4299-EXIT.
 17558       EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 318
* EL050.cbl
 17560
 17561 4500-UPDATE-NEW-CERT.
 17562     IF CERT-WAS-FOUND
 17563         NEXT SENTENCE
 17564       ELSE
 17565         GO TO 4520-BUILD-NEW-KEY.
 17566
 17567     IF  CLASIC-CREATED-CERT
 17568         GO TO 4999-EXIT.
 17569
 17570     IF  CERT-WAS-CREATED-FOR-CLAIM
 17571         GO TO 4520-BUILD-NEW-KEY.
 17572
 17573     IF CERT-ADDED-BATCH
 17574        IF CM-RECORD-ID = 'CM'
 17575            GO TO 4999-EXIT.
 17576
 17577 4520-BUILD-NEW-KEY.
 17578* BUILD CONTROL PRIMARY
 17579
 17580     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17581                                       CM-COMPANY-CD-A1
 17582                                       CM-COMPANY-CD-A2
 17583                                       CM-COMPANY-CD-A4
 17584                                       CM-COMPANY-CD-A5.
 17585
 17586     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17587     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17588     MOVE PB-SV-STATE               TO CM-STATE.
 17589     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17590     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17591     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17592     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17593
 17594     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17595
 17596     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17597     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17598     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17599     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17600
 17601     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17602        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17603
 17604     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17605         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17606         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17607         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17608         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17609     ELSE
 17610         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17611
 17612     IF PB-COMPANY-ID   EQUAL  'CRI'
 17613         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17614         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17615         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17616         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17617         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 319
* EL050.cbl
 17618
 17619     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17620        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17621         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17622
 17623     IF PB-COMPANY-ID  = 'LBL'
 17624        IF PB-I-JOINT-COVERAGE
 17625            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17626                                           PB-I-MEMBER-NO
 17627            GO TO 4550-CONT-CERT-PROCESS.
 17628
 17629     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17630        NEXT SENTENCE
 17631     ELSE
 17632        GO TO 4540-BUILD-MEMBER-NO.
 17633
 17634******************************************************************
 17635*                                                                *
 17636*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17637*    FOR 'MON'.                                                  *
 17638*                                                                *
 17639******************************************************************
 17640
 17641     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17642     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17643     MOVE +1                     TO WS-SUB1
 17644                                    WS-SUB2.
 17645
 17646 4530-EDIT-MEMB-NAME.
 17647
 17648     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17649        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17650        ADD +1                       TO WS-SUB2.
 17651
 17652     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17653        ADD +1                       TO WS-SUB1
 17654        GO TO 4530-EDIT-MEMB-NAME.
 17655
 17656     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17657     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17658     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17659*    MOVE SPACE                      TO DC-OPTION-CODE.
 17660     SET  BIN-TO-GREG                TO TRUE.
 17661     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17662     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17663
 17664     GO TO 4550-CONT-CERT-PROCESS.
 17665
 17666******************************************************************
 17667*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17668******************************************************************
 17669
 17670 4540-BUILD-MEMBER-NO.
 17671
 17672     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17673         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17674         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17675         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 320
* EL050.cbl
 17676         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17677     ELSE
 17678         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17679
 17680     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17681        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17682         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17683
 17684 4550-CONT-CERT-PROCESS.
 17685
 17686*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17687*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17688*    ELSE
 17689*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17690
 17691     IF CERT-WAS-CREATED-FOR-CLAIM
 17692        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17693        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17694
 17695     IF CERT-AND-CLAIM-ONLINE
 17696        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17697        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17698
 17699     MOVE 'CM'                     TO CM-RECORD-ID.
 17700     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17701
 17702     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17703        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17704        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17705     ELSE
 17706        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17707        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17708
 17709     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17710     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17711     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17712     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17713     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17714     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17715     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17716                                      CM-LF-ITD-CANCEL-AMT
 17717                                      CM-LF-ITD-DEATH-AMT
 17718                                      CM-AH-ITD-AH-PMT
 17719                                      CM-AH-ITD-LUMP-PMT
 17720                                      CM-AH-ITD-CANCEL-AMT
 17721                                      CM-LF-NSP-PREMIUM-AMT
 17722                                      CM-AH-NSP-PREMIUM-AMT.
 17723*                                     CM-CLAIM-DEDUCT-WITHHELD
 17724*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17725     if pb-i-loan-apr = +99.9999
 17726        move zeros                 to cm-loan-apr
 17727     else
 17728        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17729     end-if
 17730     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17731     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17732     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17733     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 321
* EL050.cbl
 17734     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17735     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17736     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17737     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17738     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17739     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17740     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17741
 17742     IF PB-I-LIVES NOT NUMERIC
 17743         MOVE ZERO                 TO PB-I-LIVES.
 17744
 17745     IF PB-I-NUM-BILLED NOT NUMERIC
 17746         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17747
 17748     MOVE PB-I-LIVES               TO CM-LIVES.
 17749     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17750
 17751     IF PB-COMPANY-ID EQUAL  'DMD'
 17752         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17753         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17754
 17755     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17756     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17757     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17758     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17759     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17760     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17761
 17762     IF PB-I-LF-POLICY-FEE NUMERIC
 17763        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17764     ELSE
 17765        MOVE +0                    TO CM-LF-POLICY-FEE.
 17766
 17767     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17768        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17769        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17770     ELSE
 17771        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17772
 17773     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17774     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17775     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17776     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17777     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17778     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17779     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17780     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17781     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17782
 17783     IF PB-I-AH-POLICY-FEE NUMERIC
 17784        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17785     ELSE
 17786        MOVE +0                    TO CM-AH-POLICY-FEE.
 17787
 17788     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17789        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17790     ELSE
 17791        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 322
* EL050.cbl
 17792
 17793     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17794     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17795
 17796     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17797                                      CM-LF-DEATH-EXIT-DT
 17798                                      CM-AH-SETTLEMENT-EXIT-DT.
 17799
 17800*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17801*                       'TIH' OR 'OFL' OR 'FLA' OR
 17802*                       'TII' OR 'TMS' OR 'CRI' OR
 17803*                       'NCL'
 17804     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17805
 17806     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17807         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17808            MOVE '2'                TO CM-PREMIUM-TYPE.
 17809
 17810     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17811         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17812            MOVE '2'                TO CM-PREMIUM-TYPE.
 17813
 17814     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17815         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17816     ELSE
 17817         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17818         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17819
 17820     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17821     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17822     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17823     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17824     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17825     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17826     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17827     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17828
 17829     IF PB-NO-MONTHS-SKIPPED
 17830         MOVE SPACE                 TO CM-SKIP-CODE
 17831     ELSE
 17832         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17833
 17834     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17835     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17836                                       CM-LF-STATUS-AT-CANCEL.
 17837
 17838     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17839     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17840                                       CM-AH-STATUS-AT-CANCEL.
 17841
 17842     MOVE '1'                       TO CM-ENTRY-STATUS.
 17843
 17844     IF PB-REISSUED-CERT
 17845        MOVE '5'                    TO CM-ENTRY-STATUS.
 17846
 17847     IF PB-MONTHLY-CERT
 17848        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17849
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 323
* EL050.cbl
 17850     IF PB-CASH-CERT
 17851        MOVE 'C'                    TO CM-ENTRY-STATUS.
 17852
 17853     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17854     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17855     IF PB-POLICY-IS-DECLINED
 17856        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17857
 17858     IF PB-POLICY-IS-VOIDED
 17859        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17860
 17861     IF PB-NEEDS-UNDERWRITING
 17862        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17863
 17864     IF PB-REIN-ONLY-CERT
 17865        MOVE '9'                    TO CM-ENTRY-STATUS.
 17866
 17867     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17868         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17869     ELSE
 17870         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17871
 17872     IF PB-RECORD-RETURNED
 17873        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17874      ELSE
 17875        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17876
 17877     IF PB-I-MAIL-ADDRS-PRESENT
 17878        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17879
 17880     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17881                                       CM-ENTRY-DT.
 17882
 17883 4999-EXIT.
 17884     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 324
* EL050.cbl
 17886
 17887 5000-PROCESS-REPS.
 17888     MOVE ' '                    TO AGTC-MASTER-SW
 17889     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17890     MOVE CO-TYPE                TO AGTC-TYPE
 17891     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17892     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17893     IF (AGTC-MASTER-SW NOT = 'N')
 17894        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17895        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17896        PERFORM 8583-READ-ERAGTC-NEXT
 17897                                 THRU 8583-EXIT
 17898     END-IF
 17899     IF AGTC-MASTER-SW = 'N'
 17900        CONTINUE
 17901     ELSE
 17902        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17903           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17904              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17905              MOVE 'Y'           TO AGTC-MASTER-SW
 17906           END-IF
 17907        END-IF
 17908     END-IF
 17909     .
 17910 5000-EXIT.
 17911     EXIT.
 17912 6370-EDIT-INPUT-LF-CODE.
 17913     move ' ' to ws-benefit-cd-chg-sw
 17914     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17915        MOVE +1                  TO SUB
 17916        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17917        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17918        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17919        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17920        GO TO 6370-SEARCH-LOOP.
 17921
 17922     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17923
 17924     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17925     MOVE SPACES                 TO CNTL-ACCESS.
 17926*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17927     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17928     MOVE +0                     TO CNTL-SEQ-NO.
 17929     MOVE '4' TO RC-SW-2.
 17930     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17931
 17932     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17933        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17934        GO TO 6370-NO-LF-FOUND.
 17935
 17936     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17937     MOVE +1                     TO SUB.
 17938
 17939 6370-SEARCH-LOOP.
 17940     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17941         GO TO 6370-NO-LF-FOUND.
 17942
 17943     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 325
* EL050.cbl
 17944        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17945           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17946           set benefit-code-chg to true
 17947        end-if
 17948        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17949        GO TO 6370-HER-NET-PAY-CHECK.
 17950
 17951     ADD 1   TO SUB.
 17952*    IF SUB GREATER 120
 17953     IF SUB GREATER 200
 17954         GO TO 6370-NO-LF-FOUND.
 17955
 17956     GO TO 6370-SEARCH-LOOP.
 17957
 17958 6370-NO-LF-FOUND.
 17959
 17960     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17961        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17962        set benefit-code-chg to true
 17963     end-if
 17964     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17965
 17966 6370-HER-NET-PAY-CHECK.
 17967
 17968     IF PB-COMPANY-ID = 'CID'
 17969        IF PB-SV-STATE = 'CA' OR 'MN'
 17970           IF PB-I-LF-BENEFIT-CD = '02'
 17971              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17972           ELSE
 17973              IF PB-I-LF-BENEFIT-CD = '04'
 17974                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17975              END-IF
 17976           END-IF
 17977        END-IF
 17978     END-IF
 17979
 17980     IF PB-COMPANY-ID NOT = 'HER'
 17981         GO TO 6370-EXIT.
 17982
 17983     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17984         GO TO 6370-EXIT.
 17985
 17986     IF PB-I-LF-TERM NOT NUMERIC
 17987         MOVE ZEROS              TO PB-I-LF-TERM.
 17988
 17989     IF PB-I-LOAN-TERM NOT NUMERIC
 17990         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17991
 17992     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17993         GO TO 6370-EXIT.
 17994
 17995     IF PB-I-LF-BENEFIT-CD = '33'
 17996         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17997
 17998     IF PB-I-LF-BENEFIT-CD = '34'
 17999         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18000
 18001 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 326
* EL050.cbl
 18002     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 327
* EL050.cbl
 18004
 18005 6380-EDIT-INPUT-AH-CODE.
 18006     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18007        MOVE +1                  TO SUB
 18008        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18009        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18010        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18011        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18012        GO TO 6380-SEARCH-LOOP.
 18013
 18014     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18015
 18016     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18017     MOVE SPACES                 TO CNTL-ACCESS.
 18018     MOVE 'A'                    TO CNTL-REC-TYPE.
 18019*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18020     MOVE +0                     TO CNTL-SEQ-NO.
 18021     MOVE '5' TO RC-SW-2.
 18022     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18023
 18024     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18025        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18026        GO TO 6380-NO-AH-FOUND.
 18027
 18028     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18029     MOVE +1 TO SUB.
 18030
 18031 6380-SEARCH-LOOP.
 18032     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18033         GO TO 6380-NO-AH-FOUND.
 18034
 18035     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18036         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18037         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18038
 18039     ADD 1   TO SUB.
 18040     IF SUB GREATER THAN 96
 18041*    IF SUB GREATER THAN 300
 18042         GO TO 6380-NO-AH-FOUND.
 18043
 18044     GO TO 6380-SEARCH-LOOP.
 18045
 18046 6380-NO-AH-FOUND.
 18047
 18048     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18049
 18050     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18051         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18052     ELSE
 18053         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18054
 18055 6380-CSO-AH-ONLY-CHECKS.
 18056
 18057     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18058        NEXT SENTENCE
 18059      ELSE
 18060        GO TO 6380-EXIT.
 18061
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 328
* EL050.cbl
 18062     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18063         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18064
 18065
 18066     GO TO 6380-EXIT
 18067     .
 18068 6380-CSO-LIFE-WITH-AH-CHECKS.
 18069
 18070
 18071     .
 18072 6380-EXIT.
 18073     EXIT.
 18074
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 329
* EL050.cbl
 18076
 18077 6400-COMPUTE-EXTENSION-DAYS.
 18078
 18079******************************************************************
 18080*                                                                *
 18081*                   COMPUTE EXTENSION DAYS                       *
 18082*                                                                *
 18083*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18084*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18085*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18086*    THE EXTENSION DAYS.                                         *
 18087*                                                                *
 18088******************************************************************
 18089
 18090     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18091     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18092
 18093******************************************************************
 18094*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18095*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18096******************************************************************
 18097
 18098     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18099        COMPUTE WS-ODD-DAYS-OVER =
 18100               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18101     ELSE
 18102        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18103
 18104     IF WS-ODD-DAYS-OVER = ZEROS
 18105           GO TO 6499-EXIT
 18106     ELSE
 18107        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18108           IF WS-WDF-MONTH = 02
 18109              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18110              ADD 2       TO  WS-ODD-DAYS-OVER
 18111              GO TO 6499-EXIT
 18112           ELSE
 18113              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18114                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18115                 GO TO 6499-EXIT
 18116               ELSE
 18117                 GO TO 6499-EXIT
 18118        ELSE
 18119           GO TO 6499-EXIT.
 18120
 18121 6412-CHECK-TO-DAY.
 18122
 18123        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18124           IF WS-WDT-DAY = 28
 18125              ADD 2              TO WS-ODD-DAYS-OVER
 18126           ELSE
 18127              IF WS-WDT-DAY = 29
 18128                 ADD 1           TO WS-ODD-DAYS-OVER
 18129              ELSE
 18130                 NEXT SENTENCE
 18131        ELSE
 18132           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18133              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 330
* EL050.cbl
 18134
 18135     GO TO 6499-EXIT.
 18136
 18137
 18138 6415-CHECK-LEAP-YEAR.
 18139
 18140     IF DC-DAYS-IN-MONTH = 29
 18141        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18142
 18143 6415-EXIT.
 18144     EXIT.
 18145
 18146 6499-EXIT.
 18147      EXIT.
 18148
 18149 6500-END.
 18150     EXIT.
 18151
 18152
 18153******************************************************************
 18154************* PROCEDURE DIVISION FOR EL050 ***********************
 18155********************** ELC50PD END *******************************
 18156
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 331
* EL050.cbl
 18158
 18159**START***********************************************************
 18160*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18161*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18162******************************************************************
 18163*
 18164 6600-GET-STATE-MUNICIPAL-TAX.
 18165
 18166     IF PB-COMPANY-ID NOT = 'DMD'
 18167         GO TO 6640-EXIT.
 18168
 18169     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18170     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18171     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18172*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18173*
 18174***  Y2K PROJ 7744
 18175     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18176     SET BIN-TO-GREG          TO TRUE.
 18177     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18178
 18179     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18180
 18181     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18182     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18183
 18184
 18185* EXEC CICS HANDLE CONDITION
 18186*        INVREQ    (6610-START-BROWSE)
 18187*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18188*        NOTFND    (6630-END-OF-FILE)
 18189*    END-EXEC.
 18190*    MOVE '"$8JI                 ! # #00018172' TO DFHEIV0
 18191     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18193     MOVE X'2320233030303138313732' TO DFHEIV0(25:11)
 18194     CALL 'kxdfhei1' USING DFHEIV0
 18195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18196
 18197
 18198 6610-START-BROWSE.
 18199
 18200
 18201* EXEC CICS HANDLE CONDITION
 18202*        NOTFND    (6630-END-OF-FILE)
 18203*        DISABLED  (6630-ERRESS-PROBLEM)
 18204*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18205*        ENDFILE   (6630-END-OF-FILE)
 18206*    END-EXEC.
 18207*    MOVE '"$IcJ''                ! $ #00018180' TO DFHEIV0
 18208     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18209     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18210     MOVE X'2420233030303138313830' TO DFHEIV0(25:11)
 18211     CALL 'kxdfhei1' USING DFHEIV0
 18212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18213
 18214
 18215
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 332
* EL050.cbl
 18216* EXEC CICS STARTBR
 18217*        DATASET (FILE-ID-ERRESS)
 18218*        RIDFLD  (WS-ERRESS-KEY)
 18219*        GTEQ
 18220*    END-EXEC.
 18221     MOVE 0
 18222       TO DFHEIV11
 18223*    MOVE '&,         G          &   #00018187' TO DFHEIV0
 18224     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18225     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18226     MOVE X'2020233030303138313837' TO DFHEIV0(25:11)
 18227     CALL 'kxdfhei1' USING DFHEIV0,
 18228           FILE-ID-ERRESS,
 18229           WS-ERRESS-KEY,
 18230           DFHEIV99,
 18231           DFHEIV11,
 18232           DFHEIV99
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18234
 18235
 18236 6620-READ-NEXT-ERRESS-MASTER.
 18237
 18238
 18239* EXEC CICS HANDLE CONDITION
 18240*        NOTFND    (6630-END-OF-FILE)
 18241*        ENDFILE   (6630-END-OF-FILE)
 18242*        DISABLED  (6630-ERRESS-PROBLEM)
 18243*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18244*    END-EXEC.
 18245*    MOVE '"$I''cJ                ! % #00018195' TO DFHEIV0
 18246     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18248     MOVE X'2520233030303138313935' TO DFHEIV0(25:11)
 18249     CALL 'kxdfhei1' USING DFHEIV0
 18250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18251
 18252
 18253
 18254* EXEC CICS READNEXT
 18255*        DATASET (FILE-ID-ERRESS)
 18256*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18257*        RIDFLD  (WS-ERRESS-KEY)
 18258*    END-EXEC.
 18259     MOVE LENGTH OF
 18260      RESIDENT-STATE-TAX-MASTER
 18261       TO DFHEIV12
 18262     MOVE 0
 18263       TO DFHEIV11
 18264*    MOVE '&.IL                  )   #00018202' TO DFHEIV0
 18265     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18266     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18267     MOVE X'2020233030303138323032' TO DFHEIV0(25:11)
 18268     CALL 'kxdfhei1' USING DFHEIV0,
 18269           FILE-ID-ERRESS,
 18270           RESIDENT-STATE-TAX-MASTER,
 18271           DFHEIV12,
 18272           WS-ERRESS-KEY,
 18273           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 333
* EL050.cbl
 18274           DFHEIV11,
 18275           DFHEIV99,
 18276           DFHEIV99
 18277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18278
 18279
 18280     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18281
 18282* EXEC CICS ENDBR
 18283*            DATASET (FILE-ID-ERRESS)
 18284*       END-EXEC
 18285     MOVE 0
 18286       TO DFHEIV11
 18287*    MOVE '&2                    $   #00018209' TO DFHEIV0
 18288     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18289     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18290     MOVE X'2020233030303138323039' TO DFHEIV0(25:11)
 18291     CALL 'kxdfhei1' USING DFHEIV0,
 18292           FILE-ID-ERRESS,
 18293           DFHEIV11,
 18294           DFHEIV99
 18295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18296        GO TO 6630-END-OF-FILE.
 18297
 18298     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18299        NEXT SENTENCE
 18300      ELSE
 18301        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18302
 18303*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18304*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18305*
 18306     MOVE +2                     TO WS-SUB1.
 18307
 18308     IF PB-ISSUE
 18309     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18310        MOVE +1                  TO WS-SUB1.
 18311
 18312     IF PB-CANCELLATION
 18313     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18314        MOVE +1                  TO WS-SUB1.
 18315*
 18316*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18317*
 18318***  Y2K PROJ 7744
 18319     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18320***  Y2K PROJ 7744
 18321
 18322*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18323* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18324* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18325
 18326     ADD 1                    TO WS-YEAR-YY.
 18327
 18328     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18329         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18330                              TO WS-RES-STATE-TAX
 18331         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 334
* EL050.cbl
 18332                              TO WS-RES-MUNI-TAX
 18333     ELSE
 18334         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18335                              TO WS-RES-STATE-TAX
 18336         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18337                              TO WS-RES-MUNI-TAX.
 18338
 18339*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18340
 18341     IF PB-CANCELLATION
 18342         GO TO 6640-CANCEL-TAX.
 18343
 18344     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18345         COMPUTE PB-I-STATE-TAX ROUNDED =
 18346                                   PB-I-LF-PREMIUM-AMT
 18347                                 * WS-RES-STATE-TAX
 18348         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18349                                   PB-I-LF-PREMIUM-AMT
 18350                                 * WS-RES-MUNI-TAX
 18351     ELSE
 18352     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18353         COMPUTE PB-I-STATE-TAX ROUNDED =
 18354                                   PB-I-AH-PREMIUM-AMT
 18355                                 * WS-RES-STATE-TAX
 18356         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18357                                   PB-I-AH-PREMIUM-AMT
 18358                                 * WS-RES-MUNI-TAX.
 18359
 18360
 18361* EXEC CICS ENDBR
 18362*         DATASET (FILE-ID-ERRESS)
 18363*    END-EXEC.
 18364     MOVE 0
 18365       TO DFHEIV11
 18366*    MOVE '&2                    $   #00018276' TO DFHEIV0
 18367     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18368     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18369     MOVE X'2020233030303138323736' TO DFHEIV0(25:11)
 18370     CALL 'kxdfhei1' USING DFHEIV0,
 18371           FILE-ID-ERRESS,
 18372           DFHEIV11,
 18373           DFHEIV99
 18374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18375
 18376
 18377     GO TO 6640-EXIT.
 18378
 18379 6640-CANCEL-TAX.
 18380     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18381
 18382     IF PB-C-LF-CANCEL-AMT > ZEROS
 18383         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18384                                   PB-C-LF-CANCEL-AMT
 18385                                 * WS-RES-STATE-TAX
 18386         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18387                                   PB-C-LF-CANCEL-AMT
 18388                                *  WS-RES-MUNI-TAX
 18389     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 335
* EL050.cbl
 18390     IF PB-C-AH-CANCEL-AMT > ZEROS
 18391         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18392                                   PB-C-AH-CANCEL-AMT
 18393                                 * WS-RES-STATE-TAX
 18394         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18395                                   PB-C-AH-CANCEL-AMT
 18396                                *  WS-RES-MUNI-TAX.
 18397
 18398
 18399* EXEC CICS ENDBR
 18400*         DATASET (FILE-ID-ERRESS)
 18401*    END-EXEC.
 18402     MOVE 0
 18403       TO DFHEIV11
 18404*    MOVE '&2                    $   #00018301' TO DFHEIV0
 18405     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18406     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18407     MOVE X'2020233030303138333031' TO DFHEIV0(25:11)
 18408     CALL 'kxdfhei1' USING DFHEIV0,
 18409           FILE-ID-ERRESS,
 18410           DFHEIV11,
 18411           DFHEIV99
 18412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18413
 18414
 18415     GO TO 6640-EXIT.
 18416
 18417 6630-END-OF-FILE.
 18418     MOVE ER-8002              TO WS-ERROR.
 18419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18420
 18421     GO TO 6640-EXIT.
 18422
 18423 6630-ERRESS-PROBLEM.
 18424     MOVE ER-8044              TO WS-ERROR.
 18425     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18426
 18427 6640-EXIT.
 18428     EXIT.
 18429
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 336
* EL050.cbl
 18431 6650-GET-RES-STATE-COMM.
 18432
 18433     IF PB-COMPANY-ID NOT = 'DMD'
 18434         GO TO 6700-COMM-EXIT.
 18435
 18436     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18437     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18438     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18439     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18440     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18441     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18442     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18443
 18444*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18445*
 18446***  Y2K PROJ 7744
 18447     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18448     SET BIN-TO-GREG          TO TRUE.
 18449     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18450
 18451     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18452***  Y2K PROJ 7744
 18453
 18454     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18455
 18456
 18457* EXEC CICS HANDLE CONDITION
 18458*        INVREQ    (6660-START-BROWSE)
 18459*        DISABLED  (6690-ERRESC-PROBLEM)
 18460*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18461*        NOTFND    (6690-END-OF-FILE)
 18462*    END-EXEC.
 18463*    MOVE '"$8cJI                ! & #00018346' TO DFHEIV0
 18464     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18466     MOVE X'2620233030303138333436' TO DFHEIV0(25:11)
 18467     CALL 'kxdfhei1' USING DFHEIV0
 18468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18469
 18470
 18471
 18472* EXEC CICS RESETBR
 18473*        DATASET (FILE-ID-ERRESC)
 18474*        RIDFLD  (WS-ERRESC-KEY)
 18475*    END-EXEC.
 18476     MOVE 0
 18477       TO DFHEIV11
 18478*    MOVE '&4         G          &   #00018353' TO DFHEIV0
 18479     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18480     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18481     MOVE X'2020233030303138333533' TO DFHEIV0(25:11)
 18482     CALL 'kxdfhei1' USING DFHEIV0,
 18483           FILE-ID-ERRESC,
 18484           WS-ERRESC-KEY,
 18485           DFHEIV99,
 18486           DFHEIV11,
 18487           DFHEIV99
 18488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 337
* EL050.cbl
 18489
 18490
 18491 6660-START-BROWSE.
 18492
 18493
 18494* EXEC CICS HANDLE CONDITION
 18495*        NOTFND    (6690-END-OF-FILE)
 18496*        DISABLED  (6690-ERRESC-PROBLEM)
 18497*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18498*        ENDFILE   (6690-END-OF-FILE)
 18499*    END-EXEC.
 18500*    MOVE '"$IcJ''                ! '' #00018360' TO DFHEIV0
 18501     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18503     MOVE X'2720233030303138333630' TO DFHEIV0(25:11)
 18504     CALL 'kxdfhei1' USING DFHEIV0
 18505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18506
 18507
 18508
 18509* EXEC CICS STARTBR
 18510*        DATASET (FILE-ID-ERRESC)
 18511*        RIDFLD  (WS-ERRESC-KEY)
 18512*        GTEQ
 18513*    END-EXEC.
 18514     MOVE 0
 18515       TO DFHEIV11
 18516*    MOVE '&,         G          &   #00018367' TO DFHEIV0
 18517     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18518     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18519     MOVE X'2020233030303138333637' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0,
 18521           FILE-ID-ERRESC,
 18522           WS-ERRESC-KEY,
 18523           DFHEIV99,
 18524           DFHEIV11,
 18525           DFHEIV99
 18526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18527
 18528
 18529     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18530
 18531 6670-READ-NEXT-ERRESC-MASTER.
 18532
 18533
 18534* EXEC CICS HANDLE CONDITION
 18535*        NOTFND    (6690-END-OF-FILE)
 18536*        DISABLED  (6690-ERRESC-PROBLEM)
 18537*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18538*        ENDFILE   (6690-END-OF-FILE)
 18539*    END-EXEC.
 18540*    MOVE '"$IcJ''                ! ( #00018377' TO DFHEIV0
 18541     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18543     MOVE X'2820233030303138333737' TO DFHEIV0(25:11)
 18544     CALL 'kxdfhei1' USING DFHEIV0
 18545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18546
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 338
* EL050.cbl
 18547
 18548
 18549* EXEC CICS READNEXT
 18550*        DATASET (FILE-ID-ERRESC)
 18551*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18552*        RIDFLD  (ERRESC-RECORD-KEY)
 18553*    END-EXEC.
 18554     MOVE LENGTH OF
 18555      ACCOUNT-RESIDENT-ST-COMMISSION
 18556       TO DFHEIV12
 18557     MOVE 0
 18558       TO DFHEIV11
 18559*    MOVE '&.IL                  )   #00018384' TO DFHEIV0
 18560     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18561     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18562     MOVE X'2020233030303138333834' TO DFHEIV0(25:11)
 18563     CALL 'kxdfhei1' USING DFHEIV0,
 18564           FILE-ID-ERRESC,
 18565           ACCOUNT-RESIDENT-ST-COMMISSION,
 18566           DFHEIV12,
 18567           ERRESC-RECORD-KEY,
 18568           DFHEIV99,
 18569           DFHEIV11,
 18570           DFHEIV99,
 18571           DFHEIV99
 18572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18573
 18574
 18575     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18576        NEXT SENTENCE
 18577     ELSE
 18578
 18579* EXEC CICS ENDBR
 18580*            DATASET (FILE-ID-ERRESC)
 18581*       END-EXEC
 18582     MOVE 0
 18583       TO DFHEIV11
 18584*    MOVE '&2                    $   #00018393' TO DFHEIV0
 18585     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18587     MOVE X'2020233030303138333933' TO DFHEIV0(25:11)
 18588     CALL 'kxdfhei1' USING DFHEIV0,
 18589           FILE-ID-ERRESC,
 18590           DFHEIV11,
 18591           DFHEIV99
 18592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18593        GO TO 6690-END-OF-FILE.
 18594
 18595     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18596
 18597* EXEC CICS ENDBR
 18598*            DATASET (FILE-ID-ERRESC)
 18599*       END-EXEC
 18600     MOVE 0
 18601       TO DFHEIV11
 18602*    MOVE '&2                    $   #00018399' TO DFHEIV0
 18603     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18604     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 339
* EL050.cbl
 18605     MOVE X'2020233030303138333939' TO DFHEIV0(25:11)
 18606     CALL 'kxdfhei1' USING DFHEIV0,
 18607           FILE-ID-ERRESC,
 18608           DFHEIV11,
 18609           DFHEIV99
 18610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18611        GO TO 6690-END-OF-FILE.
 18612
 18613     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18614        NEXT SENTENCE
 18615      ELSE
 18616        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18617
 18618* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18619*
 18620     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18621
 18622     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18623
 18624     IF WS-SUB1 > ZERO
 18625         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18626             PERFORM 6680-SET-COMMISSION
 18627         ELSE
 18628             PERFORM 6680-SET-TABLE-CODE.
 18629
 18630
 18631* EXEC CICS ENDBR
 18632*         DATASET (FILE-ID-ERRESC)
 18633*    END-EXEC.
 18634     MOVE 0
 18635       TO DFHEIV11
 18636*    MOVE '&2                    $   #00018421' TO DFHEIV0
 18637     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18638     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18639     MOVE X'2020233030303138343231' TO DFHEIV0(25:11)
 18640     CALL 'kxdfhei1' USING DFHEIV0,
 18641           FILE-ID-ERRESC,
 18642           DFHEIV11,
 18643           DFHEIV99
 18644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18645
 18646
 18647     GO TO 6700-COMM-EXIT.
 18648
 18649 6680-SET-TABLE-CODE.
 18650     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18651        MOVE ZEROS             TO WS-SUB1
 18652     ELSE
 18653* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18654* TO COMPUTE AH COMMISSION.
 18655        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18656        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18657        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18658        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18659        PERFORM 6680-READ-CTBL-TABLE
 18660        IF WS-CTBL-READ-SW NOT = 'Y'
 18661           MOVE ZEROS          TO WS-SUB1.
 18662
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 340
* EL050.cbl
 18663 6680-READ-CTBL-TABLE.
 18664*
 18665* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18666* TO COMPUTE LIFE COMMISSION
 18667
 18668     IF CTBL-SW = '0540'
 18669        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18670        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18671        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18672
 18673     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18674
 18675     IF CTBL-TABLE-FOUND
 18676        IF CTBL-SW = '0530'
 18677             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18678                                    * PB-I-AH-TERM
 18679             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18680             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18681        ELSE
 18682             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18683             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18684             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18685     ELSE
 18686        IF FIRST-TIME-THROUGH
 18687            GO TO 6680-READ-CTBL-TABLE
 18688        ELSE
 18689            MOVE ZEROS         TO WS-SUB1.
 18690
 18691 6680-SET-COMMISSION.
 18692     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18693           MOVE ZEROS          TO WS-SUB1
 18694       ELSE
 18695           MOVE RESC-COMMISSION-PER (WS-SUB)
 18696                               TO WS-COMMISSION
 18697           IF CTBL-SW = '0530'
 18698               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18699           ELSE
 18700               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18701
 18702 6680-SEARCH-CATEGORY.
 18703     ADD +1                   TO WS-SUB.
 18704     IF WS-SUB > +12
 18705         GO TO 6680-EXIT.
 18706
 18707     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18708          MOVE WS-SUB         TO WS-SUB1
 18709          GO TO 6680-EXIT.
 18710
 18711     GO TO 6680-SEARCH-CATEGORY.
 18712
 18713 6680-EXIT.
 18714     EXIT.
 18715
 18716 6690-END-OF-FILE.
 18717     GO TO 6700-COMM-EXIT.
 18718
 18719 6690-ERRESC-PROBLEM.
 18720      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 341
* EL050.cbl
 18721      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18722
 18723      GO TO 6700-COMM-EXIT.
 18724
 18725 6700-COMM-EXIT.
 18726     EXIT.
 18727
 18728 7000-GET-RATE.
 18729
 18730* EXEC CICS LINK
 18731*        PROGRAM    ('ELRATE')
 18732*        COMMAREA   (CALCULATION-PASS-AREA)
 18733*        LENGTH     (CP-COMM-LENGTH)
 18734*    END-EXEC.
 18735     MOVE 'ELRATE' TO DFHEIV1
 18736*    MOVE '."C                   (   #00018507' TO DFHEIV0
 18737     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18739     MOVE X'2020233030303138353037' TO DFHEIV0(25:11)
 18740     CALL 'kxdfhei1' USING DFHEIV0,
 18741           DFHEIV1,
 18742           CALCULATION-PASS-AREA,
 18743           CP-COMM-LENGTH,
 18744           DFHEIV99,
 18745           DFHEIV99,
 18746           DFHEIV99,
 18747           DFHEIV99
 18748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18749
 18750
 18751 7000-EXIT.
 18752     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 342
* EL050.cbl
 18754 7100-FIND-BENEFIT-IN-STATE.
 18755     MOVE 'N'                    TO BEN-SEARCH-SW.
 18756
 18757     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18758         VARYING SUB3 FROM 1 BY 1 UNTIL
 18759            ((SUB3 GREATER 50) OR
 18760              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18761               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18762
 18763     IF SUB3 NOT = 51
 18764         MOVE 'Y'                TO BEN-SEARCH-SW.
 18765
 18766     GO TO 7199-EXIT.
 18767
 18768 7100-BENEFIT-DUMMY.
 18769
 18770 7100-DUMMY-EXIT.
 18771     EXIT.
 18772
 18773 7199-EXIT.
 18774     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 343
* EL050.cbl
 18776 7200-FIND-BENEFIT.
 18777     MOVE 'N'                    TO BEN-SEARCH-SW.
 18778
 18779     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18780         VARYING SUB3 FROM 1 BY 1 UNTIL
 18781            ((SUB3 GREATER 8) OR
 18782            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18783
 18784     IF SUB3 NOT = 9
 18785         MOVE 'Y'                TO BEN-SEARCH-SW.
 18786
 18787     GO TO 7200-EXIT.
 18788
 18789 7200-BENEFIT-DUMMY.
 18790
 18791 7200-DUMMY-EXIT.
 18792     EXIT.
 18793
 18794 7200-EXIT.
 18795     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 344
* EL050.cbl
 18797 7250-LOOK-FOR-RESCINDED-CLAIM.
 18798     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18799                                    W-CL-COMP-CD.
 18800     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18801                                    W-CL-CERT-NO.
 18802
 18803
 18804* EXEC CICS HANDLE CONDITION
 18805*        NOTFND  (7250-CONTINUE)
 18806*        ENDFILE (7250-CONTINUE)
 18807*    END-EXEC.
 18808*    MOVE '"$I''                  ! ) #00018565' TO DFHEIV0
 18809     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18811     MOVE X'2920233030303138353635' TO DFHEIV0(25:11)
 18812     CALL 'kxdfhei1' USING DFHEIV0
 18813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18814
 18815
 18816
 18817* EXEC CICS IGNORE CONDITION
 18818*        DUPKEY
 18819*    END-EXEC.
 18820*    MOVE '"*$                   !   #00018570' TO DFHEIV0
 18821     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18823     MOVE X'2020233030303138353730' TO DFHEIV0(25:11)
 18824     CALL 'kxdfhei1' USING DFHEIV0
 18825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18826
 18827
 18828
 18829* EXEC CICS STARTBR
 18830*        DATASET   (CLMS-ID)
 18831*        RIDFLD    (ELMSTR-KEY)
 18832*        GENERIC   EQUAL
 18833*        KEYLENGTH (ELMSTR-LENGTH)
 18834*    END-EXEC.
 18835     MOVE 0
 18836       TO DFHEIV11
 18837*    MOVE '&,   KG    E          &   #00018574' TO DFHEIV0
 18838     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18839     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18840     MOVE X'2020233030303138353734' TO DFHEIV0(25:11)
 18841     CALL 'kxdfhei1' USING DFHEIV0,
 18842           CLMS-ID,
 18843           ELMSTR-KEY,
 18844           ELMSTR-LENGTH,
 18845           DFHEIV11,
 18846           DFHEIV99
 18847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18848
 18849
 18850     MOVE 'Y'                    TO W-BROWSE-SW.
 18851
 18852 7250-NEXT-CLAIM.
 18853
 18854
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 345
* EL050.cbl
 18855* EXEC CICS READNEXT
 18856*        DATASET   (CLMS-ID)
 18857*        RIDFLD    (ELMSTR-KEY)
 18858*        SET       (ADDRESS OF CLAIM-MASTER)
 18859*    END-EXEC.
 18860     MOVE 0
 18861       TO DFHEIV11
 18862*    MOVE '&.S                   )   #00018585' TO DFHEIV0
 18863     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18864     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18865     MOVE X'2020233030303138353835' TO DFHEIV0(25:11)
 18866     CALL 'kxdfhei1' USING DFHEIV0,
 18867           CLMS-ID,
 18868           DFHEIV20,
 18869           DFHEIV99,
 18870           ELMSTR-KEY,
 18871           DFHEIV99,
 18872           DFHEIV11,
 18873           DFHEIV99,
 18874           DFHEIV99
 18875     SET ADDRESS OF CLAIM-MASTER TO
 18876         DFHEIV20
 18877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18878
 18879
 18880     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18881        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18882         GO TO 7250-CONTINUE
 18883     END-IF.
 18884
 18885     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18886        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18887        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18888        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18889        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18890         GO TO 7250-NEXT-CLAIM
 18891     END-IF.
 18892
 18893     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18894        OR (CL-CLAIM-TYPE = 'I')
 18895        OR (CL-CLAIM-TYPE = 'G')
 18896        OR (CL-CLAIM-TYPE = 'F')
 18897          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18898              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18899              GO TO 7250-CONTINUE
 18900          END-IF
 18901     END-IF.
 18902
 18903     GO TO 7250-NEXT-CLAIM.
 18904
 18905 7250-CONTINUE.
 18906
 18907     IF W-BROWSE-SW = 'Y'
 18908
 18909* EXEC CICS ENDBR
 18910*            DATASET   (CLMS-ID)
 18911*        END-EXEC
 18912     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 346
* EL050.cbl
 18913       TO DFHEIV11
 18914*    MOVE '&2                    $   #00018619' TO DFHEIV0
 18915     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18917     MOVE X'2020233030303138363139' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0,
 18919           CLMS-ID,
 18920           DFHEIV11,
 18921           DFHEIV99
 18922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18923         MOVE 'N' TO W-BROWSE-SW
 18924     END-IF.
 18925
 18926 7250-EXIT.
 18927     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 347
* EL050.cbl
 18929 7300-CHECK-FOR-OPEN-CLMS.
 18930
 18931*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18932*    MOVE SPACES                 TO CNTL-ACCESS.
 18933*    MOVE '1'                    TO CNTL-REC-TYPE.
 18934*    MOVE +0                     TO CNTL-SEQ-NO.
 18935
 18936*    MOVE '3'                    TO RC-SW-1.
 18937*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18938
 18939*    IF NOT CF-COMPANY-MASTER
 18940*         PERFORM 0099-COMPANY-NOT-FOUND
 18941*         GO TO 7300-EXIT.
 18942
 18943     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18944                                    W-CL-COMP-CD.
 18945     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18946                                    W-CL-CERT-NO.
 18947
 18948
 18949* EXEC CICS HANDLE CONDITION
 18950*        NOTFND  (7300-CONTINUE)
 18951*        ENDFILE (7300-CONTINUE)
 18952*    END-EXEC.
 18953*    MOVE '"$I''                  ! * #00018647' TO DFHEIV0
 18954     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18956     MOVE X'2A20233030303138363437' TO DFHEIV0(25:11)
 18957     CALL 'kxdfhei1' USING DFHEIV0
 18958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18959
 18960
 18961
 18962* EXEC CICS IGNORE CONDITION
 18963*        DUPKEY
 18964*    END-EXEC.
 18965*    MOVE '"*$                   !   #00018652' TO DFHEIV0
 18966     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18968     MOVE X'2020233030303138363532' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0
 18970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18971
 18972
 18973
 18974* EXEC CICS STARTBR
 18975*        DATASET   (CLMS-ID)
 18976*        RIDFLD    (ELMSTR-KEY)
 18977*        GENERIC   EQUAL
 18978*        KEYLENGTH (ELMSTR-LENGTH)
 18979*    END-EXEC.
 18980     MOVE 0
 18981       TO DFHEIV11
 18982*    MOVE '&,   KG    E          &   #00018656' TO DFHEIV0
 18983     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18984     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18985     MOVE X'2020233030303138363536' TO DFHEIV0(25:11)
 18986     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 348
* EL050.cbl
 18987           CLMS-ID,
 18988           ELMSTR-KEY,
 18989           ELMSTR-LENGTH,
 18990           DFHEIV11,
 18991           DFHEIV99
 18992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18993
 18994
 18995     MOVE 'Y'                    TO W-BROWSE-SW.
 18996
 18997 7300-NEXT-CLAIM.
 18998
 18999
 19000* EXEC CICS READNEXT
 19001*        DATASET   (CLMS-ID)
 19002*        RIDFLD    (ELMSTR-KEY)
 19003*        SET       (ADDRESS OF CLAIM-MASTER)
 19004*    END-EXEC.
 19005     MOVE 0
 19006       TO DFHEIV11
 19007*    MOVE '&.S                   )   #00018667' TO DFHEIV0
 19008     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19009     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19010     MOVE X'2020233030303138363637' TO DFHEIV0(25:11)
 19011     CALL 'kxdfhei1' USING DFHEIV0,
 19012           CLMS-ID,
 19013           DFHEIV20,
 19014           DFHEIV99,
 19015           ELMSTR-KEY,
 19016           DFHEIV99,
 19017           DFHEIV11,
 19018           DFHEIV99,
 19019           DFHEIV99
 19020     SET ADDRESS OF CLAIM-MASTER TO
 19021         DFHEIV20
 19022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19023
 19024
 19025     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19026        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19027         GO TO 7300-CONTINUE.
 19028
 19029     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19030        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19031        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19032        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19033        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19034         GO TO 7300-NEXT-CLAIM.
 19035
 19036*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19037     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19038        OR (CL-CLAIM-TYPE = 'I')
 19039        OR (CL-CLAIM-TYPE = 'G')
 19040        OR (CL-CLAIM-TYPE = 'F')
 19041        IF CLAIM-IS-OPEN
 19042           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19043             AND PB-C-AH-CANCEL-DT > SPACES
 19044              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 349
* EL050.cbl
 19045              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19046           END-IF
 19047           EVALUATE TRUE
 19048             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19049                 MOVE ER-2884      TO WS-ERROR
 19050             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19051                 MOVE ER-2887      TO WS-ERROR
 19052             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19053                 MOVE ER-2886      TO WS-ERROR
 19054             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19055                 MOVE ER-2888      TO WS-ERROR
 19056             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19057                 MOVE ER-2885      TO WS-ERROR
 19058             WHEN OTHER
 19059                 MOVE ER-2768      TO WS-ERROR
 19060           END-EVALUATE
 19061           IF PB-C-AH-CANCEL-VOIDED OR
 19062              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19063                NOT AH-COVERAGE-CANCELLED)
 19064               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19065               MOVE ER-2768      TO WS-ERROR
 19066           END-IF
 19067           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19068           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19069              PB-FORCE-CODE NOT EQUAL '8'
 19070               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19071           END-IF
 19072           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19073           GO TO 7300-NEXT-CLAIM
 19074        ELSE
 19075           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19076*****THIS IS A RESCISSION OR REFORMATION
 19077              IF AH-COVERAGE-CANCELLED
 19078                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19079                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19080                    MOVE 1                   TO DC-ELAPSED-DAYS
 19081                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19082                    SET BIN-PLUS-ELAPSED     TO TRUE
 19083                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19084                    IF NO-CONVERSION-ERROR
 19085                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19086                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19087                          MOVE ER-2897 TO WS-ERROR
 19088                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19089                          GO TO 7300-NEXT-CLAIM
 19090                       END-IF
 19091                    END-IF
 19092                 ELSE
 19093                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19094                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19095                         MOVE ER-2890 TO WS-ERROR
 19096                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19097                         GO TO 7300-NEXT-CLAIM
 19098                      ELSE
 19099                         MOVE ER-2898 TO WS-ERROR
 19100                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19101                         GO TO 7300-NEXT-CLAIM
 19102                      END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 350
* EL050.cbl
 19103                   END-IF
 19104                 END-IF
 19105              END-IF
 19106           ELSE
 19107              IF CL-DENIAL-TYPE = '1'  AND
 19108                 CL-TOTAL-PAID-AMT = 0
 19109                    GO TO 7300-NEXT-CLAIM
 19110              END-IF
 19111              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19112               AND PB-C-AH-CANCEL-DT > SPACES
 19113                 MOVE ER-2756        TO WS-ERROR
 19114                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19115                 GO TO 7300-NEXT-CLAIM
 19116              END-IF
 19117           END-IF
 19118        END-IF
 19119     ELSE
 19120*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19121        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19122           IF CLAIM-IS-OPEN
 19123              MOVE ER-2889      TO WS-ERROR
 19124              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19125              GO TO 7300-NEXT-CLAIM
 19126           ELSE
 19127              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19128*****THIS IS A RESCISSION OR REFORMATION
 19129                 IF (LF-COVERAGE-CANCELLED AND
 19130                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19131                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19132                         MOVE ER-2890 TO WS-ERROR
 19133                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19134                         GO TO 7300-NEXT-CLAIM
 19135                      ELSE
 19136                         MOVE ER-2898 TO WS-ERROR
 19137                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19138                         GO TO 7300-NEXT-CLAIM
 19139                      END-IF
 19140                 END-IF
 19141              ELSE
 19142                 IF CL-DENIAL-TYPE = '1'  AND
 19143                    CL-TOTAL-PAID-AMT = 0
 19144                       GO TO 7300-NEXT-CLAIM
 19145                 END-IF
 19146                 IF (AH-COVERAGE-CANCELLED AND
 19147                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19148                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19149                    (LF-COVERAGE-CANCELLED AND
 19150                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19151                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19152                       MOVE ER-2965 TO WS-ERROR
 19153                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19154                       GO TO 7300-NEXT-CLAIM
 19155                 END-IF
 19156                 IF LF-COVERAGE-CANCELLED
 19157                  IF CL-TOTAL-PAID-AMT > 0
 19158                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19159                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19160                        MOVE ER-2891 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 351
* EL050.cbl
 19161                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19162                        GO TO 7300-NEXT-CLAIM
 19163                      END-IF
 19164                    ELSE
 19165****only show this error if cert num matches exactly
 19166                      IF PB-CERT-NO = CL-CERT-NO
 19167                         MOVE ER-2892 TO WS-ERROR
 19168                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19169                         GO TO 7300-NEXT-CLAIM
 19170                      END-IF
 19171                    END-IF
 19172                  END-IF
 19173                 END-IF
 19174              END-IF
 19175           END-IF
 19176        END-IF
 19177     END-IF
 19178
 19179     GO TO 7300-NEXT-CLAIM.
 19180
 19181 7300-CONTINUE.
 19182
 19183     IF W-BROWSE-SW = 'Y'
 19184
 19185* EXEC CICS ENDBR
 19186*            DATASET   (CLMS-ID)
 19187*        END-EXEC.
 19188     MOVE 0
 19189       TO DFHEIV11
 19190*    MOVE '&2                    $   #00018832' TO DFHEIV0
 19191     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19192     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19193     MOVE X'2020233030303138383332' TO DFHEIV0(25:11)
 19194     CALL 'kxdfhei1' USING DFHEIV0,
 19195           CLMS-ID,
 19196           DFHEIV11,
 19197           DFHEIV99
 19198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19199
 19200
 19201 7300-EXIT.
 19202     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 352
* EL050.cbl
 19204
 19205 7400-GET-REMAIN-TERM.
 19206
 19207* EXEC CICS LINK
 19208*        PROGRAM    ('ELRTRM')
 19209*        COMMAREA   (CALCULATION-PASS-AREA)
 19210*        LENGTH     (CP-COMM-LENGTH)
 19211*    END-EXEC.
 19212     MOVE 'ELRTRM' TO DFHEIV1
 19213*    MOVE '."C                   (   #00018841' TO DFHEIV0
 19214     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19215     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19216     MOVE X'2020233030303138383431' TO DFHEIV0(25:11)
 19217     CALL 'kxdfhei1' USING DFHEIV0,
 19218           DFHEIV1,
 19219           CALCULATION-PASS-AREA,
 19220           CP-COMM-LENGTH,
 19221           DFHEIV99,
 19222           DFHEIV99,
 19223           DFHEIV99,
 19224           DFHEIV99
 19225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19226
 19227
 19228 7400-EXIT.
 19229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 353
* EL050.cbl
 19231
 19232 7500-GET-REMAIN-AMOUNT.
 19233
 19234* EXEC CICS LINK
 19235*        PROGRAM    ('ELRAMT')
 19236*        COMMAREA   (CALCULATION-PASS-AREA)
 19237*        LENGTH     (CP-COMM-LENGTH)
 19238*    END-EXEC.
 19239     MOVE 'ELRAMT' TO DFHEIV1
 19240*    MOVE '."C                   (   #00018852' TO DFHEIV0
 19241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19243     MOVE X'2020233030303138383532' TO DFHEIV0(25:11)
 19244     CALL 'kxdfhei1' USING DFHEIV0,
 19245           DFHEIV1,
 19246           CALCULATION-PASS-AREA,
 19247           CP-COMM-LENGTH,
 19248           DFHEIV99,
 19249           DFHEIV99,
 19250           DFHEIV99,
 19251           DFHEIV99
 19252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19253
 19254
 19255 7500-EXIT.
 19256     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 354
* EL050.cbl
 19258
 19259 7600-GET-REFUND.
 19260
 19261* EXEC CICS LINK
 19262*        PROGRAM    ('ELRFND')
 19263*        COMMAREA   (CALCULATION-PASS-AREA)
 19264*        LENGTH     (CP-COMM-LENGTH)
 19265*    END-EXEC.
 19266     MOVE 'ELRFND' TO DFHEIV1
 19267*    MOVE '."C                   (   #00018863' TO DFHEIV0
 19268     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19270     MOVE X'2020233030303138383633' TO DFHEIV0(25:11)
 19271     CALL 'kxdfhei1' USING DFHEIV0,
 19272           DFHEIV1,
 19273           CALCULATION-PASS-AREA,
 19274           CP-COMM-LENGTH,
 19275           DFHEIV99,
 19276           DFHEIV99,
 19277           DFHEIV99,
 19278           DFHEIV99
 19279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19280
 19281
 19282 7600-EXIT.
 19283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 355
* EL050.cbl
 19285 7700-CALL-DL1.
 19286
 19287* EXEC CICS LINK
 19288*        PROGRAM    ('DLO001')
 19289*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19290*        LENGTH     (DLO001-COMM-LENGTH)
 19291*    END-EXEC.
 19292     MOVE 'DLO001' TO DFHEIV1
 19293*    MOVE '."C                   (   #00018873' TO DFHEIV0
 19294     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303138383733' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           DFHEIV1,
 19299           WS-DLO-MASTER-POLICY-FORM,
 19300           DLO001-COMM-LENGTH,
 19301           DFHEIV99,
 19302           DFHEIV99,
 19303           DFHEIV99,
 19304           DFHEIV99
 19305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19306
 19307
 19308 7700-EXIT.
 19309     EXIT.
 19310
 19311 7710-CALL-DL2.
 19312
 19313* EXEC CICS LINK
 19314*        PROGRAM    ('DLO002')
 19315*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19316*        LENGTH     (DLO002-COMM-LENGTH)
 19317*    END-EXEC.
 19318     MOVE 'DLO002' TO DFHEIV1
 19319*    MOVE '."C                   (   #00018883' TO DFHEIV0
 19320     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19321     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19322     MOVE X'2020233030303138383833' TO DFHEIV0(25:11)
 19323     CALL 'kxdfhei1' USING DFHEIV0,
 19324           DFHEIV1,
 19325           WS-DLO-INTERNAL-POLICY-FORM,
 19326           DLO002-COMM-LENGTH,
 19327           DFHEIV99,
 19328           DFHEIV99,
 19329           DFHEIV99,
 19330           DFHEIV99
 19331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19332
 19333
 19334 7710-EXIT.
 19335     EXIT.
 19336
 19337 7720-CALL-DL3.
 19338
 19339* EXEC CICS LINK
 19340*        PROGRAM    ('DLO003')
 19341*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19342*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 356
* EL050.cbl
 19343*    END-EXEC.
 19344     MOVE 'DLO003' TO DFHEIV1
 19345*    MOVE '."C                   (   #00018893' TO DFHEIV0
 19346     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19347     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19348     MOVE X'2020233030303138383933' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0,
 19350           DFHEIV1,
 19351           WS-DLO-VALID-BANK-ID,
 19352           DLO003-COMM-LENGTH,
 19353           DFHEIV99,
 19354           DFHEIV99,
 19355           DFHEIV99,
 19356           DFHEIV99
 19357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19358
 19359
 19360 7720-EXIT.
 19361     EXIT.
 19362
 19363 7730-CALL-DL7.
 19364
 19365* EXEC CICS LINK
 19366*        PROGRAM    ('DLO007')
 19367*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19368*        LENGTH     (DLO007-COMM-LENGTH)
 19369*    END-EXEC.
 19370     MOVE 'DLO007' TO DFHEIV1
 19371*    MOVE '."C                   (   #00018903' TO DFHEIV0
 19372     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19373     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19374     MOVE X'2020233030303138393033' TO DFHEIV0(25:11)
 19375     CALL 'kxdfhei1' USING DFHEIV0,
 19376           DFHEIV1,
 19377           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19378           DLO007-COMM-LENGTH,
 19379           DFHEIV99,
 19380           DFHEIV99,
 19381           DFHEIV99,
 19382           DFHEIV99
 19383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19384
 19385
 19386 7730-EXIT.
 19387     EXIT.
 19388
 19389 7740-CALL-DL11.
 19390
 19391* EXEC CICS LINK
 19392*        PROGRAM    ('DLO011')
 19393*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19394*        LENGTH     (DLO011-COMM-LENGTH)
 19395*    END-EXEC.
 19396     MOVE 'DLO011' TO DFHEIV1
 19397*    MOVE '."C                   (   #00018913' TO DFHEIV0
 19398     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19400     MOVE X'2020233030303138393133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 357
* EL050.cbl
 19401     CALL 'kxdfhei1' USING DFHEIV0,
 19402           DFHEIV1,
 19403           WS-DLO-PREM-RATES-BEN-TYPE,
 19404           DLO011-COMM-LENGTH,
 19405           DFHEIV99,
 19406           DFHEIV99,
 19407           DFHEIV99,
 19408           DFHEIV99
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412 7740-EXIT.
 19413     EXIT.
 19414
 19415 7750-CALL-DL17.
 19416
 19417* EXEC CICS LINK
 19418*        PROGRAM    ('DLO017')
 19419*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19420*        LENGTH     (DLO017-COMM-LENGTH)
 19421*    END-EXEC.
 19422     MOVE 'DLO017' TO DFHEIV1
 19423*    MOVE '."C                   (   #00018923' TO DFHEIV0
 19424     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19426     MOVE X'2020233030303138393233' TO DFHEIV0(25:11)
 19427     CALL 'kxdfhei1' USING DFHEIV0,
 19428           DFHEIV1,
 19429           WS-DLO-VALID-RATE-CODE,
 19430           DLO017-COMM-LENGTH,
 19431           DFHEIV99,
 19432           DFHEIV99,
 19433           DFHEIV99,
 19434           DFHEIV99
 19435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19436
 19437
 19438 7750-EXIT.
 19439     EXIT.
 19440
 19441 7755-CALL-DL19.
 19442
 19443* EXEC CICS LINK
 19444*        PROGRAM    ('DLO019')
 19445*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19446*        LENGTH     (DLO019-COMM-LENGTH)
 19447*    END-EXEC.
 19448     MOVE 'DLO019' TO DFHEIV1
 19449*    MOVE '."C                   (   #00018933' TO DFHEIV0
 19450     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19452     MOVE X'2020233030303138393333' TO DFHEIV0(25:11)
 19453     CALL 'kxdfhei1' USING DFHEIV0,
 19454           DFHEIV1,
 19455           WS-DLO-ORIG-COV-CAT,
 19456           DLO019-COMM-LENGTH,
 19457           DFHEIV99,
 19458           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 358
* EL050.cbl
 19459           DFHEIV99,
 19460           DFHEIV99
 19461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19462
 19463
 19464 7755-EXIT.
 19465     EXIT.
 19466
 19467 7760-CALL-DL21.
 19468
 19469* EXEC CICS LINK
 19470*        PROGRAM    ('DLO021')
 19471*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19472*        LENGTH     (DLO021-COMM-LENGTH)
 19473*    END-EXEC.
 19474     MOVE 'DLO021' TO DFHEIV1
 19475*    MOVE '."C                   (   #00018943' TO DFHEIV0
 19476     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19478     MOVE X'2020233030303138393433' TO DFHEIV0(25:11)
 19479     CALL 'kxdfhei1' USING DFHEIV0,
 19480           DFHEIV1,
 19481           WS-DLO-VALID-LOAN-OFFICER,
 19482           DLO021-COMM-LENGTH,
 19483           DFHEIV99,
 19484           DFHEIV99,
 19485           DFHEIV99,
 19486           DFHEIV99
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
 19489
 19490 7760-EXIT.
 19491     EXIT.
 19492
 19493 7770-CALL-DL22.
 19494
 19495* EXEC CICS LINK
 19496*        PROGRAM    ('DLO022')
 19497*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19498*        LENGTH     (DLO022-COMM-LENGTH)
 19499*    END-EXEC.
 19500     MOVE 'DLO022' TO DFHEIV1
 19501*    MOVE '."C                   (   #00018953' TO DFHEIV0
 19502     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19504     MOVE X'2020233030303138393533' TO DFHEIV0(25:11)
 19505     CALL 'kxdfhei1' USING DFHEIV0,
 19506           DFHEIV1,
 19507           WS-DLO-VALID-STATE-CODE,
 19508           DLO022-COMM-LENGTH,
 19509           DFHEIV99,
 19510           DFHEIV99,
 19511           DFHEIV99,
 19512           DFHEIV99
 19513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19514
 19515
 19516 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 359
* EL050.cbl
 19517     EXIT.
 19518
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 360
* EL050.cbl
 19520
 19521 7800-REWRITE-CERT.
 19522******************************************************************
 19523*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19524*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19525******************************************************************
 19526
 19527     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19528        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19529        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19530        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19531
 19532* EXEC CICS REWRITE
 19533*                  DATASET (CERT-ID)
 19534*                  FROM    (CERTIFICATE-MASTER)
 19535*              END-EXEC
 19536     MOVE LENGTH OF
 19537      CERTIFICATE-MASTER
 19538       TO DFHEIV11
 19539*    MOVE '&& L                  %   #00018974' TO DFHEIV0
 19540     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19541     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19542     MOVE X'2020233030303138393734' TO DFHEIV0(25:11)
 19543     CALL 'kxdfhei1' USING DFHEIV0,
 19544           CERT-ID,
 19545           CERTIFICATE-MASTER,
 19546           DFHEIV11,
 19547           DFHEIV99
 19548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19549        GO TO 7800-EXIT.
 19550
 19551       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19552       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19553
 19554 7800-EXIT.
 19555      EXIT.
 19556
 19557 7900-DELETE-CERT.
 19558
 19559* EXEC CICS DELETE
 19560*        DATASET (CERT-ID)
 19561*    END-EXEC.
 19562*    MOVE '&(                    &   #00018987' TO DFHEIV0
 19563     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19565     MOVE X'2020233030303138393837' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0,
 19567           CERT-ID,
 19568           DFHEIV99,
 19569           DFHEIV99,
 19570           DFHEIV99,
 19571           DFHEIV99
 19572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19573
 19574
 19575 7900-EXIT.
 19576     EXIT.
 19577
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 361
* EL050.cbl
 19578 8000-WRITE-CERT.
 19579
 19580* EXEC CICS HANDLE CONDITION
 19581*        DUPKEY    (8000-FREE-MAIN)
 19582*    END-EXEC.
 19583*    MOVE '"$$                   ! + #00018995' TO DFHEIV0
 19584     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19586     MOVE X'2B20233030303138393935' TO DFHEIV0(25:11)
 19587     CALL 'kxdfhei1' USING DFHEIV0
 19588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19589
 19590
 19591
 19592* EXEC CICS WRITE
 19593*        DATASET     (CERT-ID)
 19594*        FROM        (CERTIFICATE-MASTER)
 19595*        RIDFLD      (ELCERT-KEY)
 19596*    END-EXEC.
 19597     MOVE LENGTH OF
 19598      CERTIFICATE-MASTER
 19599       TO DFHEIV11
 19600*    MOVE '&$ L                  ''   #00018999' TO DFHEIV0
 19601     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19602     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19603     MOVE X'2020233030303138393939' TO DFHEIV0(25:11)
 19604     CALL 'kxdfhei1' USING DFHEIV0,
 19605           CERT-ID,
 19606           CERTIFICATE-MASTER,
 19607           DFHEIV11,
 19608           ELCERT-KEY,
 19609           DFHEIV99,
 19610           DFHEIV99
 19611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19612
 19613
 19614 8000-FREE-MAIN.
 19615
 19616 8000-EXIT.
 19617      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 362
* EL050.cbl
 19619
 19620 8100-READ-ERPNDM.
 19621
 19622* EXEC CICS HANDLE CONDITION
 19623*         NOTFND     (8100-NOTFND)
 19624*         ENDFILE    (8100-NOTFND)
 19625*    END-EXEC.
 19626*    MOVE '"$I''                  ! , #00019012' TO DFHEIV0
 19627     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19629     MOVE X'2C20233030303139303132' TO DFHEIV0(25:11)
 19630     CALL 'kxdfhei1' USING DFHEIV0
 19631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19632
 19633
 19634     MOVE SPACES                 TO ERPNDM-FOUND.
 19635     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19636
 19637
 19638* EXEC CICS READ
 19639*         DATASET   (FILE-ERPNDM)
 19640*         RIDFLD    (PM-CONTROL-PRIMARY)
 19641*         INTO      (PENDING-MAILING-DATA)
 19642*    END-EXEC.
 19643     MOVE LENGTH OF
 19644      PENDING-MAILING-DATA
 19645       TO DFHEIV11
 19646*    MOVE '&"IL       E          (   #00019020' TO DFHEIV0
 19647     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19648     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19649     MOVE X'2020233030303139303230' TO DFHEIV0(25:11)
 19650     CALL 'kxdfhei1' USING DFHEIV0,
 19651           FILE-ERPNDM,
 19652           PENDING-MAILING-DATA,
 19653           DFHEIV11,
 19654           PM-CONTROL-PRIMARY,
 19655           DFHEIV99,
 19656           DFHEIV99,
 19657           DFHEIV99
 19658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19659
 19660
 19661     GO TO 8100-EXIT.
 19662
 19663 8100-NOTFND.
 19664
 19665     MOVE 'X'                    TO ERPNDM-FOUND.
 19666     MOVE ER-2694                TO WS-ERROR.
 19667     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19668     MOVE ER-2883                TO WS-ERROR
 19669     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19670     .
 19671 8100-EXIT.
 19672     EXIT.
 19673
 19674 8110-READ-ERMAIL.
 19675
 19676* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 363
* EL050.cbl
 19677*         NOTFND     (8110-NOTFND)
 19678*         ENDFILE    (8110-NOTFND)
 19679*    END-EXEC.
 19680*    MOVE '"$I''                  ! - #00019040' TO DFHEIV0
 19681     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19683     MOVE X'2D20233030303139303430' TO DFHEIV0(25:11)
 19684     CALL 'kxdfhei1' USING DFHEIV0
 19685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19686
 19687
 19688     MOVE SPACES                 TO ERMAIL-FOUND.
 19689     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19690     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19691     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19692     MOVE PB-SV-STATE            TO MA-STATE.
 19693
 19694
 19695* EXEC CICS READ
 19696*         UPDATE
 19697*         DATASET   (FILE-ERMAIL)
 19698*         RIDFLD    (MA-CONTROL-PRIMARY)
 19699*         INTO      (MAILING-DATA)
 19700*    END-EXEC.
 19701     MOVE LENGTH OF
 19702      MAILING-DATA
 19703       TO DFHEIV11
 19704*    MOVE '&"IL       EU         (   #00019051' TO DFHEIV0
 19705     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19706     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19707     MOVE X'2020233030303139303531' TO DFHEIV0(25:11)
 19708     CALL 'kxdfhei1' USING DFHEIV0,
 19709           FILE-ERMAIL,
 19710           MAILING-DATA,
 19711           DFHEIV11,
 19712           MA-CONTROL-PRIMARY,
 19713           DFHEIV99,
 19714           DFHEIV99,
 19715           DFHEIV99
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719     GO TO 8110-EXIT.
 19720
 19721 8110-NOTFND.
 19722     MOVE 'X'                    TO ERMAIL-FOUND.
 19723
 19724 8110-EXIT.
 19725     EXIT.
 19726
 19727 8120-REWRITE-ERMAIL.
 19728
 19729* EXEC CICS REWRITE
 19730*         DATASET    (FILE-ERMAIL)
 19731*         FROM       (MAILING-DATA)
 19732*    END-EXEC.
 19733     MOVE LENGTH OF
 19734      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 364
* EL050.cbl
 19735       TO DFHEIV11
 19736*    MOVE '&& L                  %   #00019067' TO DFHEIV0
 19737     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19738     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19739     MOVE X'2020233030303139303637' TO DFHEIV0(25:11)
 19740     CALL 'kxdfhei1' USING DFHEIV0,
 19741           FILE-ERMAIL,
 19742           MAILING-DATA,
 19743           DFHEIV11,
 19744           DFHEIV99
 19745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19746
 19747
 19748 8120-EXIT.
 19749     EXIT.
 19750
 19751 8130-WRITE-ERMAIL.
 19752
 19753* EXEC CICS HANDLE CONDITION
 19754*         DUPKEY   (8130-EXIT)
 19755*    END-EXEC.
 19756*    MOVE '"$$                   ! . #00019076' TO DFHEIV0
 19757     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19759     MOVE X'2E20233030303139303736' TO DFHEIV0(25:11)
 19760     CALL 'kxdfhei1' USING DFHEIV0
 19761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19762
 19763
 19764
 19765* EXEC CICS WRITE
 19766*         DATASET     (FILE-ERMAIL)
 19767*         RIDFLD      (MA-CONTROL-PRIMARY)
 19768*         FROM        (MAILING-DATA)
 19769*    END-EXEC.
 19770     MOVE LENGTH OF
 19771      MAILING-DATA
 19772       TO DFHEIV11
 19773*    MOVE '&$ L                  ''   #00019080' TO DFHEIV0
 19774     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19775     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19776     MOVE X'2020233030303139303830' TO DFHEIV0(25:11)
 19777     CALL 'kxdfhei1' USING DFHEIV0,
 19778           FILE-ERMAIL,
 19779           MAILING-DATA,
 19780           DFHEIV11,
 19781           MA-CONTROL-PRIMARY,
 19782           DFHEIV99,
 19783           DFHEIV99
 19784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19785
 19786
 19787 8130-EXIT.
 19788     EXIT.
 19789
 19790 8140-UNLOCK-ERMAIL.
 19791
 19792* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 365
* EL050.cbl
 19793*         DATASET   (FILE-ERMAIL)
 19794*    END-EXEC.
 19795*    MOVE '&*                    #   #00019090' TO DFHEIV0
 19796     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19797     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19798     MOVE X'2020233030303139303930' TO DFHEIV0(25:11)
 19799     CALL 'kxdfhei1' USING DFHEIV0,
 19800           FILE-ERMAIL,
 19801           DFHEIV99
 19802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19803
 19804
 19805 8140-EXIT.
 19806     EXIT.
 19807
 19808 8150-read-elcrtt.
 19809
 19810
 19811* EXEC CICS HANDLE CONDITION
 19812*        NOTFND   (8150-exit)
 19813*    END-EXEC
 19814*    MOVE '"$I                   ! / #00019099' TO DFHEIV0
 19815     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19817     MOVE X'2F20233030303139303939' TO DFHEIV0(25:11)
 19818     CALL 'kxdfhei1' USING DFHEIV0
 19819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19820
 19821     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19822     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19823
 19824
 19825* EXEC CICS READ
 19826*        DATASET  (CRTT-ID)
 19827*        RIDFLD   (WS-ELCRTT-KEY)
 19828*        INTO     (CERTIFICATE-TRAILERS)
 19829*    END-EXEC
 19830     MOVE LENGTH OF
 19831      CERTIFICATE-TRAILERS
 19832       TO DFHEIV11
 19833*    MOVE '&"IL       E          (   #00019106' TO DFHEIV0
 19834     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19836     MOVE X'2020233030303139313036' TO DFHEIV0(25:11)
 19837     CALL 'kxdfhei1' USING DFHEIV0,
 19838           CRTT-ID,
 19839           CERTIFICATE-TRAILERS,
 19840           DFHEIV11,
 19841           WS-ELCRTT-KEY,
 19842           DFHEIV99,
 19843           DFHEIV99,
 19844           DFHEIV99
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19846
 19847     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19848     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19849
 19850     .
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 366
* EL050.cbl
 19851 8150-exit.
 19852     exit.
 19853 8180-UPDATE-VIN-NUMBER.
 19854
 19855* EXEC CICS HANDLE CONDITION
 19856*        NOTFND   (8180-NOTFND)
 19857*    END-EXEC.
 19858*    MOVE '"$I                   ! 0 #00019119' TO DFHEIV0
 19859     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19861     MOVE X'3020233030303139313139' TO DFHEIV0(25:11)
 19862     CALL 'kxdfhei1' USING DFHEIV0
 19863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19864
 19865
 19866     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19867     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19868
 19869
 19870* EXEC CICS READ
 19871*        UPDATE
 19872*        DATASET  (CRTT-ID)
 19873*        RIDFLD   (WS-ELCRTT-KEY)
 19874*        INTO     (CERTIFICATE-TRAILERS)
 19875*    END-EXEC.
 19876     MOVE LENGTH OF
 19877      CERTIFICATE-TRAILERS
 19878       TO DFHEIV11
 19879*    MOVE '&"IL       EU         (   #00019126' TO DFHEIV0
 19880     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19882     MOVE X'2020233030303139313236' TO DFHEIV0(25:11)
 19883     CALL 'kxdfhei1' USING DFHEIV0,
 19884           CRTT-ID,
 19885           CERTIFICATE-TRAILERS,
 19886           DFHEIV11,
 19887           WS-ELCRTT-KEY,
 19888           DFHEIV99,
 19889           DFHEIV99,
 19890           DFHEIV99
 19891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19892
 19893
 19894     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19895         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19896
 19897* EXEC CICS REWRITE
 19898*           DATASET  (CRTT-ID)
 19899*           FROM     (CERTIFICATE-TRAILERS)
 19900*        END-EXEC
 19901     MOVE LENGTH OF
 19902      CERTIFICATE-TRAILERS
 19903       TO DFHEIV11
 19904*    MOVE '&& L                  %   #00019135' TO DFHEIV0
 19905     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19906     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19907     MOVE X'2020233030303139313335' TO DFHEIV0(25:11)
 19908     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 367
* EL050.cbl
 19909           CRTT-ID,
 19910           CERTIFICATE-TRAILERS,
 19911           DFHEIV11,
 19912           DFHEIV99
 19913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19914     ELSE
 19915
 19916* EXEC CICS UNLOCK
 19917*          DATASET  (CRTT-ID)
 19918*       END-EXEC
 19919*    MOVE '&*                    #   #00019140' TO DFHEIV0
 19920     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19921     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19922     MOVE X'2020233030303139313430' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0,
 19924           CRTT-ID,
 19925           DFHEIV99
 19926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19927     END-IF.
 19928
 19929     GO TO 8180-EXIT.
 19930
 19931 8180-NOTFND.
 19932
 19933     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19934     MOVE 'CS'         TO CS-RECORD-ID.
 19935     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19936     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19937     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19938     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19939
 19940* EXEC CICS WRITE
 19941*       DATASET  (CRTT-ID)
 19942*       RIDFLD   (WS-ELCRTT-KEY)
 19943*       FROM     (CERTIFICATE-TRAILERS)
 19944*    END-EXEC.
 19945     MOVE LENGTH OF
 19946      CERTIFICATE-TRAILERS
 19947       TO DFHEIV11
 19948*    MOVE '&$ L                  ''   #00019155' TO DFHEIV0
 19949     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19950     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19951     MOVE X'2020233030303139313535' TO DFHEIV0(25:11)
 19952     CALL 'kxdfhei1' USING DFHEIV0,
 19953           CRTT-ID,
 19954           CERTIFICATE-TRAILERS,
 19955           DFHEIV11,
 19956           WS-ELCRTT-KEY,
 19957           DFHEIV99,
 19958           DFHEIV99
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19960
 19961
 19962 8180-EXIT.
 19963     EXIT.
 19964
 19965 8190-UPDATE-REFUND-CLAIM-FLAG.
 19966
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 368
* EL050.cbl
 19967* EXEC CICS HANDLE CONDITION
 19968*        NOTFND   (8190-NOTFND)
 19969*    END-EXEC.
 19970*    MOVE '"$I                   ! 1 #00019165' TO DFHEIV0
 19971     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19973     MOVE X'3120233030303139313635' TO DFHEIV0(25:11)
 19974     CALL 'kxdfhei1' USING DFHEIV0
 19975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19976
 19977
 19978     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19979     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19980
 19981
 19982* EXEC CICS READ
 19983*        UPDATE
 19984*        DATASET  (CRTT-ID)
 19985*        RIDFLD   (WS-ELCRTT-KEY)
 19986*        INTO     (CERTIFICATE-TRAILERS)
 19987*    END-EXEC.
 19988     MOVE LENGTH OF
 19989      CERTIFICATE-TRAILERS
 19990       TO DFHEIV11
 19991*    MOVE '&"IL       EU         (   #00019172' TO DFHEIV0
 19992     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19993     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19994     MOVE X'2020233030303139313732' TO DFHEIV0(25:11)
 19995     CALL 'kxdfhei1' USING DFHEIV0,
 19996           CRTT-ID,
 19997           CERTIFICATE-TRAILERS,
 19998           DFHEIV11,
 19999           WS-ELCRTT-KEY,
 20000           DFHEIV99,
 20001           DFHEIV99,
 20002           DFHEIV99
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20007
 20008* EXEC CICS REWRITE
 20009*       DATASET  (CRTT-ID)
 20010*       FROM     (CERTIFICATE-TRAILERS)
 20011*    END-EXEC.
 20012     MOVE LENGTH OF
 20013      CERTIFICATE-TRAILERS
 20014       TO DFHEIV11
 20015*    MOVE '&& L                  %   #00019180' TO DFHEIV0
 20016     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20017     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20018     MOVE X'2020233030303139313830' TO DFHEIV0(25:11)
 20019     CALL 'kxdfhei1' USING DFHEIV0,
 20020           CRTT-ID,
 20021           CERTIFICATE-TRAILERS,
 20022           DFHEIV11,
 20023           DFHEIV99
 20024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 369
* EL050.cbl
 20025
 20026
 20027     GO TO 8190-EXIT.
 20028
 20029 8190-NOTFND.
 20030
 20031     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20032     MOVE 'CS'         TO CS-RECORD-ID.
 20033     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20034     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20035     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20036     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20037
 20038* EXEC CICS WRITE
 20039*       DATASET  (CRTT-ID)
 20040*       RIDFLD   (WS-ELCRTT-KEY)
 20041*       FROM     (CERTIFICATE-TRAILERS)
 20042*    END-EXEC.
 20043     MOVE LENGTH OF
 20044      CERTIFICATE-TRAILERS
 20045       TO DFHEIV11
 20046*    MOVE '&$ L                  ''   #00019195' TO DFHEIV0
 20047     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20048     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20049     MOVE X'2020233030303139313935' TO DFHEIV0(25:11)
 20050     CALL 'kxdfhei1' USING DFHEIV0,
 20051           CRTT-ID,
 20052           CERTIFICATE-TRAILERS,
 20053           DFHEIV11,
 20054           WS-ELCRTT-KEY,
 20055           DFHEIV99,
 20056           DFHEIV99
 20057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20058
 20059
 20060 8190-EXIT.
 20061     EXIT.
 20062
 20063 8195-UPDATE-AGE-FLAGS.
 20064
 20065* EXEC CICS HANDLE CONDITION
 20066*        NOTFND   (8195-NOTFND)
 20067*    END-EXEC.
 20068*    MOVE '"$I                   ! 2 #00019205' TO DFHEIV0
 20069     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20071     MOVE X'3220233030303139323035' TO DFHEIV0(25:11)
 20072     CALL 'kxdfhei1' USING DFHEIV0
 20073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20074
 20075
 20076     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20077     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20078
 20079
 20080* EXEC CICS READ
 20081*        UPDATE
 20082*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 370
* EL050.cbl
 20083*        RIDFLD   (WS-ELCRTT-KEY)
 20084*        INTO     (CERTIFICATE-TRAILERS)
 20085*    END-EXEC.
 20086     MOVE LENGTH OF
 20087      CERTIFICATE-TRAILERS
 20088       TO DFHEIV11
 20089*    MOVE '&"IL       EU         (   #00019212' TO DFHEIV0
 20090     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20091     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20092     MOVE X'2020233030303139323132' TO DFHEIV0(25:11)
 20093     CALL 'kxdfhei1' USING DFHEIV0,
 20094           CRTT-ID,
 20095           CERTIFICATE-TRAILERS,
 20096           DFHEIV11,
 20097           WS-ELCRTT-KEY,
 20098           DFHEIV99,
 20099           DFHEIV99,
 20100           DFHEIV99
 20101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20102
 20103
 20104     IF WS-INS-AGE-SET = 'Y'
 20105        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20106     END-IF
 20107     IF WS-JNT-AGE-SET = 'Y'
 20108        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20109     END-IF
 20110
 20111
 20112* EXEC CICS REWRITE
 20113*       DATASET  (CRTT-ID)
 20114*       FROM     (CERTIFICATE-TRAILERS)
 20115*    END-EXEC.
 20116     MOVE LENGTH OF
 20117      CERTIFICATE-TRAILERS
 20118       TO DFHEIV11
 20119*    MOVE '&& L                  %   #00019226' TO DFHEIV0
 20120     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20122     MOVE X'2020233030303139323236' TO DFHEIV0(25:11)
 20123     CALL 'kxdfhei1' USING DFHEIV0,
 20124           CRTT-ID,
 20125           CERTIFICATE-TRAILERS,
 20126           DFHEIV11,
 20127           DFHEIV99
 20128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20129
 20130
 20131     GO TO 8195-EXIT.
 20132
 20133 8195-NOTFND.
 20134
 20135     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20136     MOVE 'CS'         TO CS-RECORD-ID.
 20137     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20138     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20139     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20140     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 371
* EL050.cbl
 20141     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20142
 20143* EXEC CICS WRITE
 20144*       DATASET  (CRTT-ID)
 20145*       RIDFLD   (WS-ELCRTT-KEY)
 20146*       FROM     (CERTIFICATE-TRAILERS)
 20147*    END-EXEC.
 20148     MOVE LENGTH OF
 20149      CERTIFICATE-TRAILERS
 20150       TO DFHEIV11
 20151*    MOVE '&$ L                  ''   #00019242' TO DFHEIV0
 20152     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20154     MOVE X'2020233030303139323432' TO DFHEIV0(25:11)
 20155     CALL 'kxdfhei1' USING DFHEIV0,
 20156           CRTT-ID,
 20157           CERTIFICATE-TRAILERS,
 20158           DFHEIV11,
 20159           WS-ELCRTT-KEY,
 20160           DFHEIV99,
 20161           DFHEIV99
 20162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20163
 20164
 20165 8195-EXIT.
 20166     EXIT.
 20167
 20168 8200-READ-REIN-TABLE.
 20169
 20170* EXEC CICS HANDLE CONDITION
 20171*         NOTFND   (8200-NOTFND)
 20172*    END-EXEC.
 20173*    MOVE '"$I                   ! 3 #00019252' TO DFHEIV0
 20174     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20176     MOVE X'3320233030303139323532' TO DFHEIV0(25:11)
 20177     CALL 'kxdfhei1' USING DFHEIV0
 20178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20179
 20180
 20181
 20182* EXEC CICS READ
 20183*        DATASET     (REIN-ID)
 20184*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20185*        RIDFLD      (ERREIN-KEY)
 20186*    END-EXEC.
 20187*    MOVE '&"S        E          (   #00019256' TO DFHEIV0
 20188     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20190     MOVE X'2020233030303139323536' TO DFHEIV0(25:11)
 20191     CALL 'kxdfhei1' USING DFHEIV0,
 20192           REIN-ID,
 20193           DFHEIV20,
 20194           DFHEIV99,
 20195           ERREIN-KEY,
 20196           DFHEIV99,
 20197           DFHEIV99,
 20198           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 372
* EL050.cbl
 20199     SET ADDRESS OF REINSURANCE-RECORD TO
 20200         DFHEIV20
 20201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20202
 20203
 20204     GO TO 8200-EXIT.
 20205
 20206 8200-NOTFND.
 20207     MOVE 'N'             TO WS-REIN-READ-SW.
 20208
 20209 8200-EXIT.
 20210      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 373
* EL050.cbl
 20212
 20213 8300-READ-CTBL-TABLE.
 20214
 20215* EXEC CICS HANDLE CONDITION
 20216*        NOTFND    (8300-NOTFND)
 20217*        DISABLED  (8300-ERRESS-PROBLEM)
 20218*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20219*        ENDFILE   (8300-NOTFND)
 20220*    END-EXEC.
 20221*    MOVE '"$IcJ''                ! 4 #00019272' TO DFHEIV0
 20222     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20224     MOVE X'3420233030303139323732' TO DFHEIV0(25:11)
 20225     CALL 'kxdfhei1' USING DFHEIV0
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229
 20230* EXEC CICS READ
 20231*        DATASET     (CTBL-ID)
 20232*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20233*        RIDFLD      (ERCTBL-KEY)
 20234*    END-EXEC.
 20235*    MOVE '&"S        E          (   #00019279' TO DFHEIV0
 20236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20238     MOVE X'2020233030303139323739' TO DFHEIV0(25:11)
 20239     CALL 'kxdfhei1' USING DFHEIV0,
 20240           CTBL-ID,
 20241           DFHEIV20,
 20242           DFHEIV99,
 20243           ERCTBL-KEY,
 20244           DFHEIV99,
 20245           DFHEIV99,
 20246           DFHEIV99
 20247     SET ADDRESS OF COMM-TABLE-RECORD TO
 20248         DFHEIV20
 20249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20250
 20251
 20252     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20253
 20254     GO TO 8300-EXIT.
 20255
 20256 8300-NOTFND.
 20257
 20258     IF CTBL-SW = '0530'
 20259         MOVE 'AA'                     TO WS-AH-COMP-CD
 20260         MOVE '0550'                   TO CTBL-SW
 20261         MOVE '1'                      TO WS-CTBL-READ-SW
 20262         GO TO 8300-EXIT.
 20263
 20264     IF CTBL-SW = '0540'
 20265         MOVE 'AA'                     TO WS-LF-COMP-CD
 20266         MOVE '0550'                   TO CTBL-SW
 20267         MOVE '1'                      TO WS-CTBL-READ-SW
 20268         GO TO 8300-EXIT.
 20269
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 374
* EL050.cbl
 20270     IF CTBL-SW = '0550'
 20271         MOVE '2'                      TO WS-CTBL-READ-SW
 20272         GO TO 8300-EXIT.
 20273
 20274     GO TO 8300-EXIT.
 20275
 20276 8300-ERRESS-PROBLEM.
 20277
 20278      MOVE ER-8050              TO WS-ERROR.
 20279      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20280
 20281     GO TO 8300-EXIT.
 20282
 20283 8300-EXIT.
 20284      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 375
* EL050.cbl
 20286
 20287
 20288 8400-GETMAIN-ERFORM.
 20289
 20290
 20291* EXEC CICS   GETMAIN
 20292*        LENGTH  (500)
 20293*        SET     (ADDRESS OF FORM-MASTER)
 20294*    END-EXEC.
 20295     MOVE 500
 20296       TO DFHEIV11
 20297*    MOVE '," L                  $   #00019323' TO DFHEIV0
 20298     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20300     MOVE X'2020233030303139333233' TO DFHEIV0(25:11)
 20301     CALL 'kxdfhei1' USING DFHEIV0,
 20302           DFHEIV20,
 20303           DFHEIV11,
 20304           DFHEIV99
 20305     SET ADDRESS OF FORM-MASTER TO
 20306         DFHEIV20
 20307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20308
 20309
 20310     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20311
 20312 8400-EXIT.
 20313      EXIT.
 20314
 20315 8450-READ-FORM-MASTER.
 20316
 20317
 20318* EXEC CICS  HANDLE CONDITION
 20319*        NOTFND   (8450-FORM-NOT-FOUND)
 20320*        ENDFILE  (8450-FORM-NOT-FOUND)
 20321*    END-EXEC.
 20322*    MOVE '"$I''                  ! 5 #00019335' TO DFHEIV0
 20323     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20325     MOVE X'3520233030303139333335' TO DFHEIV0(25:11)
 20326     CALL 'kxdfhei1' USING DFHEIV0
 20327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20328
 20329
 20330
 20331* EXEC CICS   READ
 20332*        DATASET   (FORM-ID)
 20333*        RIDFLD    (ERFORM-KEY)
 20334*        INTO      (FORM-MASTER)
 20335*        GTEQ
 20336*    END-EXEC.
 20337     MOVE LENGTH OF
 20338      FORM-MASTER
 20339       TO DFHEIV11
 20340*    MOVE '&"IL       G          (   #00019340' TO DFHEIV0
 20341     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20343     MOVE X'2020233030303139333430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 376
* EL050.cbl
 20344     CALL 'kxdfhei1' USING DFHEIV0,
 20345           FORM-ID,
 20346           FORM-MASTER,
 20347           DFHEIV11,
 20348           ERFORM-KEY,
 20349           DFHEIV99,
 20350           DFHEIV99,
 20351           DFHEIV99
 20352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20353
 20354
 20355     MOVE  'Y'           TO  FORM-MASTER-SW.
 20356
 20357     GO TO  8450-EXIT.
 20358
 20359 8450-FORM-NOT-FOUND.
 20360
 20361     MOVE  'N'           TO  FORM-MASTER-SW.
 20362
 20363 8450-EXIT.
 20364      EXIT.
 20365
 20366 8500-DATE-CONVERT.
 20367
 20368* EXEC CICS LINK
 20369*        PROGRAM    ('ELDATCV')
 20370*        COMMAREA   (DATE-CONVERSION-DATA)
 20371*        LENGTH     (DC-COMM-LENGTH)
 20372*    END-EXEC.
 20373     MOVE 'ELDATCV' TO DFHEIV1
 20374*    MOVE '."C                   (   #00019359' TO DFHEIV0
 20375     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20377     MOVE X'2020233030303139333539' TO DFHEIV0(25:11)
 20378     CALL 'kxdfhei1' USING DFHEIV0,
 20379           DFHEIV1,
 20380           DATE-CONVERSION-DATA,
 20381           DC-COMM-LENGTH,
 20382           DFHEIV99,
 20383           DFHEIV99,
 20384           DFHEIV99,
 20385           DFHEIV99
 20386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20387
 20388
 20389 8500-EXIT.
 20390     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 377
* EL050.cbl
 20392
 20393 8555-RELOAD-CONTROL-FILE.
 20394     CONTINUE.
 20395
 20396 8555-EXIT.
 20397     EXIT.
 20398
 20399 8557-GETMAIN-ERPLAN.
 20400
 20401
 20402* EXEC CICS GETMAIN
 20403*        LENGTH    (840)
 20404*        SET       (ADDRESS OF PLAN-RECORDS)
 20405*    END-EXEC.
 20406     MOVE 840
 20407       TO DFHEIV11
 20408*    MOVE '," L                  $   #00019377' TO DFHEIV0
 20409     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20411     MOVE X'2020233030303139333737' TO DFHEIV0(25:11)
 20412     CALL 'kxdfhei1' USING DFHEIV0,
 20413           DFHEIV20,
 20414           DFHEIV11,
 20415           DFHEIV99
 20416     SET ADDRESS OF PLAN-RECORDS TO
 20417         DFHEIV20
 20418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20419
 20420
 20421     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20422
 20423 8557-EXIT.
 20424     EXIT.
 20425
 20426 8560-GETMAIN.
 20427
 20428* EXEC CICS GETMAIN
 20429*        LENGTH    (2000)
 20430*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20431*    END-EXEC.
 20432     MOVE 2000
 20433       TO DFHEIV11
 20434*    MOVE '," L                  $   #00019388' TO DFHEIV0
 20435     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20437     MOVE X'2020233030303139333838' TO DFHEIV0(25:11)
 20438     CALL 'kxdfhei1' USING DFHEIV0,
 20439           DFHEIV20,
 20440           DFHEIV11,
 20441           DFHEIV99
 20442     SET ADDRESS OF ACCOUNT-MASTER TO
 20443         DFHEIV20
 20444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20445
 20446
 20447     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20448
 20449 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 378
* EL050.cbl
 20450     EXIT.
 20451
 20452 8570-START-ACCOUNT-MASTER.
 20453
 20454* EXEC CICS HANDLE CONDITION
 20455*        NOTFND    (0199-ACCT-NOT-FOUND)
 20456*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20457*    END-EXEC.
 20458*    MOVE '"$I''                  ! 6 #00019399' TO DFHEIV0
 20459     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20461     MOVE X'3620233030303139333939' TO DFHEIV0(25:11)
 20462     CALL 'kxdfhei1' USING DFHEIV0
 20463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20464
 20465
 20466
 20467* EXEC CICS STARTBR
 20468*        DATASET    (ACCT-ID)
 20469*        RIDFLD     (ERACCT-KEY)
 20470*        GTEQ
 20471*    END-EXEC.
 20472     MOVE 0
 20473       TO DFHEIV11
 20474*    MOVE '&,         G          &   #00019404' TO DFHEIV0
 20475     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20476     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20477     MOVE X'2020233030303139343034' TO DFHEIV0(25:11)
 20478     CALL 'kxdfhei1' USING DFHEIV0,
 20479           ACCT-ID,
 20480           ERACCT-KEY,
 20481           DFHEIV99,
 20482           DFHEIV11,
 20483           DFHEIV99
 20484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20485
 20486
 20487 8570-EXIT.
 20488     EXIT.
 20489
 20490 8580-READ-ACCOUNT-MASTER.
 20491
 20492* EXEC CICS HANDLE CONDITION
 20493*        NOTFND    (0199-ACCT-NOT-FOUND)
 20494*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20495*    END-EXEC.
 20496*    MOVE '"$I''                  ! 7 #00019414' TO DFHEIV0
 20497     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20499     MOVE X'3720233030303139343134' TO DFHEIV0(25:11)
 20500     CALL 'kxdfhei1' USING DFHEIV0
 20501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20502
 20503
 20504
 20505* EXEC CICS READNEXT
 20506*        DATASET     (ACCT-ID)
 20507*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 379
* EL050.cbl
 20508*        RIDFLD      (ERACCT-KEY)
 20509*    END-EXEC.
 20510     MOVE LENGTH OF
 20511      ACCOUNT-MASTER
 20512       TO DFHEIV12
 20513     MOVE 0
 20514       TO DFHEIV11
 20515*    MOVE '&.IL                  )   #00019419' TO DFHEIV0
 20516     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20518     MOVE X'2020233030303139343139' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0,
 20520           ACCT-ID,
 20521           ACCOUNT-MASTER,
 20522           DFHEIV12,
 20523           ERACCT-KEY,
 20524           DFHEIV99,
 20525           DFHEIV11,
 20526           DFHEIV99,
 20527           DFHEIV99
 20528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20529
 20530
 20531 8580-EXIT.
 20532     EXIT.
 20533
 20534 8582-READ-COMPENSATION-MASTER.
 20535
 20536* EXEC CICS HANDLE CONDITION
 20537*        NOTFND    (8582-COMP-NOT-FOUND)
 20538*        ENDFILE   (8582-COMP-NOT-FOUND)
 20539*    END-EXEC.
 20540*    MOVE '"$I''                  ! 8 #00019429' TO DFHEIV0
 20541     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20543     MOVE X'3820233030303139343239' TO DFHEIV0(25:11)
 20544     CALL 'kxdfhei1' USING DFHEIV0
 20545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20546
 20547
 20548
 20549* EXEC CICS READ
 20550*        DATASET     (COMP-ID)
 20551*        INTO        (COMPENSATION-MASTER)
 20552*        RIDFLD      (ERCOMP-KEY)
 20553*    END-EXEC.
 20554     MOVE LENGTH OF
 20555      COMPENSATION-MASTER
 20556       TO DFHEIV11
 20557*    MOVE '&"IL       E          (   #00019434' TO DFHEIV0
 20558     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20560     MOVE X'2020233030303139343334' TO DFHEIV0(25:11)
 20561     CALL 'kxdfhei1' USING DFHEIV0,
 20562           COMP-ID,
 20563           COMPENSATION-MASTER,
 20564           DFHEIV11,
 20565           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 380
* EL050.cbl
 20566           DFHEIV99,
 20567           DFHEIV99,
 20568           DFHEIV99
 20569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20570
 20571
 20572     MOVE 'Y'                    TO COMP-MASTER-SW
 20573
 20574     GO TO 8582-EXIT
 20575     .
 20576 8582-COMP-NOT-FOUND.
 20577
 20578     MOVE 'N'                    TO COMP-MASTER-SW.
 20579
 20580 8582-EXIT.
 20581     EXIT.
 20582
 20583 8583-READ-ERAGTC.
 20584
 20585* EXEC CICS HANDLE CONDITION
 20586*        NOTFND    (8583-AGTC-NOT-FOUND)
 20587*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20588*    END-EXEC.
 20589*    MOVE '"$I''                  ! 9 #00019452' TO DFHEIV0
 20590     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20592     MOVE X'3920233030303139343532' TO DFHEIV0(25:11)
 20593     CALL 'kxdfhei1' USING DFHEIV0
 20594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20595
 20596
 20597
 20598* EXEC CICS STARTBR
 20599*        DATASET    (AGTC-ID)
 20600*        RIDFLD     (ERAGTC-KEY)
 20601*        GTEQ
 20602*    END-EXEC.
 20603     MOVE 0
 20604       TO DFHEIV11
 20605*    MOVE '&,         G          &   #00019457' TO DFHEIV0
 20606     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20608     MOVE X'2020233030303139343537' TO DFHEIV0(25:11)
 20609     CALL 'kxdfhei1' USING DFHEIV0,
 20610           AGTC-ID,
 20611           ERAGTC-KEY,
 20612           DFHEIV99,
 20613           DFHEIV11,
 20614           DFHEIV99
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618 8583-READ-ERAGTC-NEXT.
 20619
 20620* EXEC CICS READNEXT
 20621*        DATASET     (AGTC-ID)
 20622*        INTO        (AGENT-COMMISSIONS)
 20623*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 381
* EL050.cbl
 20624*    END-EXEC.
 20625     MOVE LENGTH OF
 20626      AGENT-COMMISSIONS
 20627       TO DFHEIV12
 20628     MOVE 0
 20629       TO DFHEIV11
 20630*    MOVE '&.IL                  )   #00019464' TO DFHEIV0
 20631     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20632     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20633     MOVE X'2020233030303139343634' TO DFHEIV0(25:11)
 20634     CALL 'kxdfhei1' USING DFHEIV0,
 20635           AGTC-ID,
 20636           AGENT-COMMISSIONS,
 20637           DFHEIV12,
 20638           ERAGTC-KEY,
 20639           DFHEIV99,
 20640           DFHEIV11,
 20641           DFHEIV99,
 20642           DFHEIV99
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20644
 20645
 20646*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20647
 20648     GO TO 8583-EXIT
 20649     .
 20650 8583-AGTC-NOT-FOUND.
 20651
 20652     MOVE 'N'                    TO AGTC-MASTER-SW.
 20653
 20654 8583-EXIT.
 20655     EXIT.
 20656
 20657 8584-READ-BANK-CROSS-REF.
 20658
 20659* EXEC CICS HANDLE CONDITION
 20660*        NOTFND    (8584-BXRF-NOT-FOUND)
 20661*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20662*    END-EXEC.
 20663*    MOVE '"$I''                  ! : #00019482' TO DFHEIV0
 20664     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20666     MOVE X'3A20233030303139343832' TO DFHEIV0(25:11)
 20667     CALL 'kxdfhei1' USING DFHEIV0
 20668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20669
 20670
 20671
 20672* EXEC CICS READ
 20673*        DATASET     (BXRF-ID)
 20674*        INTO        (BANK-CROSS-REFERENCE)
 20675*        RIDFLD      (ERBXRF-KEY)
 20676*        LENGTH      (BXRF-REC-LENGTH)
 20677*    END-EXEC.
 20678*    MOVE '&"IL       E          (   #00019487' TO DFHEIV0
 20679     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20680     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20681     MOVE X'2020233030303139343837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 382
* EL050.cbl
 20682     CALL 'kxdfhei1' USING DFHEIV0,
 20683           BXRF-ID,
 20684           BANK-CROSS-REFERENCE,
 20685           BXRF-REC-LENGTH,
 20686           ERBXRF-KEY,
 20687           DFHEIV99,
 20688           DFHEIV99,
 20689           DFHEIV99
 20690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20691
 20692
 20693     MOVE 'Y'                    TO BXRF-MASTER-SW
 20694
 20695     GO TO 8584-EXIT
 20696     .
 20697 8584-BXRF-NOT-FOUND.
 20698
 20699     MOVE 'N'                    TO BXRF-MASTER-SW.
 20700
 20701 8584-EXIT.
 20702     EXIT.
 20703
 20704 8585-READ-PLAN-MASTER.
 20705
 20706
 20707* EXEC CICS HANDLE CONDITION
 20708*        NOTFND    (8585-PLAN-NOT-FOUND)
 20709*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20710*    END-EXEC.
 20711*    MOVE '"$I''                  ! ; #00019507' TO DFHEIV0
 20712     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20714     MOVE X'3B20233030303139353037' TO DFHEIV0(25:11)
 20715     CALL 'kxdfhei1' USING DFHEIV0
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719
 20720* EXEC CICS READ
 20721*        DATASET     (PLAN-ID)
 20722*        INTO        (PLAN-MASTER)
 20723*        RIDFLD      (ERPLAN-KEY)
 20724*    END-EXEC.
 20725     MOVE LENGTH OF
 20726      PLAN-MASTER
 20727       TO DFHEIV11
 20728*    MOVE '&"IL       E          (   #00019512' TO DFHEIV0
 20729     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20731     MOVE X'2020233030303139353132' TO DFHEIV0(25:11)
 20732     CALL 'kxdfhei1' USING DFHEIV0,
 20733           PLAN-ID,
 20734           PLAN-MASTER,
 20735           DFHEIV11,
 20736           ERPLAN-KEY,
 20737           DFHEIV99,
 20738           DFHEIV99,
 20739           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 383
* EL050.cbl
 20740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20741
 20742
 20743     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20744
 20745     GO TO 8585-EXIT.
 20746
 20747 8585-PLAN-NOT-FOUND.
 20748
 20749     MOVE 'N'                    TO PLAN-MASTER-SW.
 20750
 20751 8585-EXIT.
 20752     EXIT.
 20753
 20754 8586-READ-LOAN-OFFICER.
 20755
 20756* EXEC CICS READ
 20757*        DATASET     (LOFC-ID)
 20758*        INTO        (LOAN-OFFICER-MASTER)
 20759*        RIDFLD      (ERLOFC-KEY)
 20760*        RESP        (WS-RESPONSE)
 20761*    END-EXEC
 20762     MOVE LENGTH OF
 20763      LOAN-OFFICER-MASTER
 20764       TO DFHEIV11
 20765*    MOVE '&"IL       E          (  N#00019530' TO DFHEIV0
 20766     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20768     MOVE X'204E233030303139353330' TO DFHEIV0(25:11)
 20769     CALL 'kxdfhei1' USING DFHEIV0,
 20770           LOFC-ID,
 20771           LOAN-OFFICER-MASTER,
 20772           DFHEIV11,
 20773           ERLOFC-KEY,
 20774           DFHEIV99,
 20775           DFHEIV99,
 20776           DFHEIV99
 20777     MOVE EIBRESP  TO WS-RESPONSE
 20778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20779
 20780     IF WS-RESP-NORMAL
 20781        MOVE 'Y'                 TO LOFC-MASTER-SW
 20782     ELSE
 20783        MOVE 'N'                 TO LOFC-MASTER-SW
 20784     END-IF
 20785     .
 20786 8586-EXIT.
 20787     EXIT.
 20788 8587-START-ERPDEF.
 20789
 20790* EXEC CICS STARTBR
 20791*       DATASET   (PDEF-ID)
 20792*       RIDFLD    (ERPDEF-KEY)
 20793*       GTEQ
 20794*       RESP      (WS-RESPONSE)
 20795*    END-EXEC
 20796     MOVE 0
 20797       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 384
* EL050.cbl
 20798*    MOVE '&,         G          &  N#00019546' TO DFHEIV0
 20799     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20800     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20801     MOVE X'204E233030303139353436' TO DFHEIV0(25:11)
 20802     CALL 'kxdfhei1' USING DFHEIV0,
 20803           PDEF-ID,
 20804           ERPDEF-KEY,
 20805           DFHEIV99,
 20806           DFHEIV11,
 20807           DFHEIV99
 20808     MOVE EIBRESP  TO WS-RESPONSE
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20810     IF WS-RESP-NORMAL
 20811        MOVE 'Y'                 TO PDEF-MASTER-SW
 20812     ELSE
 20813        MOVE 'N'                 TO PDEF-MASTER-SW
 20814     END-IF
 20815     .
 20816 8587-EXIT.
 20817     EXIT.
 20818 8588-READ-ERPDEF.
 20819
 20820* EXEC CICS READNEXT
 20821*       DATASET   (PDEF-ID)
 20822*       RIDFLD    (ERPDEF-KEY)
 20823*       INTO      (PRODUCT-MASTER)
 20824*       RESP      (WS-RESPONSE)
 20825*    END-EXEC
 20826     MOVE LENGTH OF
 20827      PRODUCT-MASTER
 20828       TO DFHEIV12
 20829     MOVE 0
 20830       TO DFHEIV11
 20831*    MOVE '&.IL                  )  N#00019561' TO DFHEIV0
 20832     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20833     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20834     MOVE X'204E233030303139353631' TO DFHEIV0(25:11)
 20835     CALL 'kxdfhei1' USING DFHEIV0,
 20836           PDEF-ID,
 20837           PRODUCT-MASTER,
 20838           DFHEIV12,
 20839           ERPDEF-KEY,
 20840           DFHEIV99,
 20841           DFHEIV11,
 20842           DFHEIV99,
 20843           DFHEIV99
 20844     MOVE EIBRESP  TO WS-RESPONSE
 20845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20846     IF WS-RESP-NORMAL
 20847        MOVE 'Y'                 TO PDEF-MASTER-SW
 20848     ELSE
 20849        MOVE 'N'                 TO PDEF-MASTER-SW
 20850     END-IF
 20851     .
 20852 8588-EXIT.
 20853     EXIT.
 20854 8589-ENDBR-ERPDEF.
 20855
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 385
* EL050.cbl
 20856* EXEC CICS ENDBR
 20857*       DATASET   (PDEF-ID)
 20858*    END-EXEC
 20859     MOVE 0
 20860       TO DFHEIV11
 20861*    MOVE '&2                    $   #00019576' TO DFHEIV0
 20862     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20863     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20864     MOVE X'2020233030303139353736' TO DFHEIV0(25:11)
 20865     CALL 'kxdfhei1' USING DFHEIV0,
 20866           PDEF-ID,
 20867           DFHEIV11,
 20868           DFHEIV99
 20869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20870     .
 20871 8589-EXIT.
 20872     EXIT.
 20873 8590-READ-CERT-MASTER.
 20874     IF PB-COMPANY-ID = 'UCL'
 20875         GO TO 8690-READ-CERT-MASTER-UCL.
 20876
 20877
 20878* EXEC CICS HANDLE CONDITION
 20879*         NOTFND    (0299-CERT-NOT-FOUND)
 20880*    END-EXEC.
 20881*    MOVE '"$I                   ! < #00019586' TO DFHEIV0
 20882     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20884     MOVE X'3C20233030303139353836' TO DFHEIV0(25:11)
 20885     CALL 'kxdfhei1' USING DFHEIV0
 20886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20887
 20888
 20889
 20890* EXEC CICS READ
 20891*        DATASET     (CERT-ID)
 20892*        INTO        (CERTIFICATE-MASTER)
 20893*        RIDFLD      (ELCERT-KEY)
 20894*        UPDATE
 20895*    END-EXEC.
 20896     MOVE LENGTH OF
 20897      CERTIFICATE-MASTER
 20898       TO DFHEIV11
 20899*    MOVE '&"IL       EU         (   #00019590' TO DFHEIV0
 20900     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20901     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20902     MOVE X'2020233030303139353930' TO DFHEIV0(25:11)
 20903     CALL 'kxdfhei1' USING DFHEIV0,
 20904           CERT-ID,
 20905           CERTIFICATE-MASTER,
 20906           DFHEIV11,
 20907           ELCERT-KEY,
 20908           DFHEIV99,
 20909           DFHEIV99,
 20910           DFHEIV99
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 386
* EL050.cbl
 20914 8590-EXIT.
 20915     EXIT.
 20916
 20917 8690-READ-CERT-MASTER-UCL.
 20918
 20919* EXEC CICS HANDLE CONDITION
 20920*         NOTFND    (8700-READ-CERT-MASTER)
 20921*    END-EXEC.
 20922*    MOVE '"$I                   ! = #00019601' TO DFHEIV0
 20923     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20925     MOVE X'3D20233030303139363031' TO DFHEIV0(25:11)
 20926     CALL 'kxdfhei1' USING DFHEIV0
 20927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20928
 20929
 20930 8690-READ-CERT-CONT.
 20931
 20932* EXEC CICS READ
 20933*        DATASET     (CERT-ID)
 20934*        INTO        (CERTIFICATE-MASTER)
 20935*        RIDFLD      (ELCERT-KEY)
 20936*        UPDATE
 20937*    END-EXEC.
 20938     MOVE LENGTH OF
 20939      CERTIFICATE-MASTER
 20940       TO DFHEIV11
 20941*    MOVE '&"IL       EU         (   #00019606' TO DFHEIV0
 20942     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20943     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20944     MOVE X'2020233030303139363036' TO DFHEIV0(25:11)
 20945     CALL 'kxdfhei1' USING DFHEIV0,
 20946           CERT-ID,
 20947           CERTIFICATE-MASTER,
 20948           DFHEIV11,
 20949           ELCERT-KEY,
 20950           DFHEIV99,
 20951           DFHEIV99,
 20952           DFHEIV99
 20953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20954
 20955
 20956     GO TO 8590-EXIT.
 20957
 20958 8700-READ-CERT-MASTER.
 20959     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20960     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20961
 20962* EXEC CICS HANDLE CONDITION
 20963*         DUPKEY    (8720-COMP-ACCOUNTS)
 20964*         ENDFILE   (8730-END-BROWSE)
 20965*         NOTFND    (8740-NOT-FOUND)
 20966*    END-EXEC.
 20967*    MOVE '"$$''I                 ! > #00019618' TO DFHEIV0
 20968     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20970     MOVE X'3E20233030303139363138' TO DFHEIV0(25:11)
 20971     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 387
* EL050.cbl
 20972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20973
 20974
 20975
 20976* EXEC CICS STARTBR
 20977*        DATASET     ('ELCERT5')
 20978*        RIDFLD      (ELCERT2-KEY)
 20979*        EQUAL
 20980*    END-EXEC.
 20981     MOVE 'ELCERT5' TO DFHEIV1
 20982     MOVE 0
 20983       TO DFHEIV11
 20984*    MOVE '&,         E          &   #00019624' TO DFHEIV0
 20985     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20986     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20987     MOVE X'2020233030303139363234' TO DFHEIV0(25:11)
 20988     CALL 'kxdfhei1' USING DFHEIV0,
 20989           DFHEIV1,
 20990           ELCERT2-KEY,
 20991           DFHEIV99,
 20992           DFHEIV11,
 20993           DFHEIV99
 20994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20995
 20996
 20997 8710-READ-NEXT.
 20998
 20999* EXEC CICS READNEXT
 21000*        DATASET     ('ELCERT5')
 21001*        INTO        (CERTIFICATE-MASTER)
 21002*        RIDFLD      (ELCERT2-KEY)
 21003*    END-EXEC.
 21004     MOVE LENGTH OF
 21005      CERTIFICATE-MASTER
 21006       TO DFHEIV12
 21007     MOVE 'ELCERT5' TO DFHEIV1
 21008     MOVE 0
 21009       TO DFHEIV11
 21010*    MOVE '&.IL                  )   #00019631' TO DFHEIV0
 21011     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21012     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21013     MOVE X'2020233030303139363331' TO DFHEIV0(25:11)
 21014     CALL 'kxdfhei1' USING DFHEIV0,
 21015           DFHEIV1,
 21016           CERTIFICATE-MASTER,
 21017           DFHEIV12,
 21018           ELCERT2-KEY,
 21019           DFHEIV99,
 21020           DFHEIV11,
 21021           DFHEIV99,
 21022           DFHEIV99
 21023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21024
 21025
 21026 8720-COMP-ACCOUNTS.
 21027
 21028* EXEC CICS ENTER
 21029*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 388
* EL050.cbl
 21030*         FROM (PB-C-LAST-NAME)
 21031*    END-EXEC.
 21032     MOVE 001
 21033       TO DFHEIV11
 21034*    MOVE ':$F                   %   #00019638' TO DFHEIV0
 21035     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21036     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21037     MOVE X'2020233030303139363338' TO DFHEIV0(25:11)
 21038     CALL 'kxdfhei1' USING DFHEIV0,
 21039           DFHEIV11,
 21040           PB-C-LAST-NAME,
 21041           DFHEIV99,
 21042           DFHEIV99
 21043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21044
 21045
 21046
 21047* EXEC CICS ENTER
 21048*         TRACEID (002)
 21049*         FROM (CM-INSURED-LAST-NAME)
 21050*    END-EXEC.
 21051     MOVE 002
 21052       TO DFHEIV11
 21053*    MOVE ':$F                   %   #00019643' TO DFHEIV0
 21054     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21055     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21056     MOVE X'2020233030303139363433' TO DFHEIV0(25:11)
 21057     CALL 'kxdfhei1' USING DFHEIV0,
 21058           DFHEIV11,
 21059           CM-INSURED-LAST-NAME,
 21060           DFHEIV99,
 21061           DFHEIV99
 21062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21063
 21064
 21065     IF PB-CERT-NO NOT = CM-CERT-NO
 21066         GO TO 8730-END-BROWSE.
 21067
 21068     IF PB-ACCOUNT = CM-ACCOUNT
 21069         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21070             MOVE ER-2799        TO WS-ERROR
 21071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21072             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21073             GO TO 8730-END-BROWSE.
 21074
 21075     GO TO 8710-READ-NEXT.
 21076
 21077 8730-END-BROWSE.
 21078
 21079* EXEC CICS ENDBR
 21080*         DATASET    ('ELCERT5')
 21081*    END-EXEC.
 21082     MOVE 'ELCERT5' TO DFHEIV1
 21083     MOVE 0
 21084       TO DFHEIV11
 21085*    MOVE '&2                    $   #00019661' TO DFHEIV0
 21086     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21087     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 389
* EL050.cbl
 21088     MOVE X'2020233030303139363631' TO DFHEIV0(25:11)
 21089     CALL 'kxdfhei1' USING DFHEIV0,
 21090           DFHEIV1,
 21091           DFHEIV11,
 21092           DFHEIV99
 21093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21094
 21095
 21096 8740-NOT-FOUND.
 21097     GO TO 0299-CERT-NOT-FOUND.
 21098
 21099 8750-START-ELSTAT.
 21100
 21101* EXEC CICS STARTBR
 21102*       DATASET   (STAT-ID)
 21103*       RIDFLD    (ELSTAT-KEY)
 21104*       GTEQ
 21105*       RESP      (WS-RESPONSE)
 21106*    END-EXEC
 21107     MOVE 0
 21108       TO DFHEIV11
 21109*    MOVE '&,         G          &  N#00019669' TO DFHEIV0
 21110     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21111     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21112     MOVE X'204E233030303139363639' TO DFHEIV0(25:11)
 21113     CALL 'kxdfhei1' USING DFHEIV0,
 21114           STAT-ID,
 21115           ELSTAT-KEY,
 21116           DFHEIV99,
 21117           DFHEIV11,
 21118           DFHEIV99
 21119     MOVE EIBRESP  TO WS-RESPONSE
 21120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21121     IF WS-RESP-NORMAL
 21122        MOVE 'Y'                 TO STAT-MASTER-SW
 21123     ELSE
 21124        MOVE 'N'                 TO STAT-MASTER-SW
 21125     END-IF
 21126     .
 21127 8750-EXIT.
 21128     EXIT.
 21129 8752-READ-ELSTAT.
 21130
 21131* EXEC CICS READNEXT
 21132*       DATASET   (STAT-ID)
 21133*       RIDFLD    (ELSTAT-KEY)
 21134*       INTO      (STATE-FILE)
 21135*       RESP      (WS-RESPONSE)
 21136*    END-EXEC
 21137     MOVE LENGTH OF
 21138      STATE-FILE
 21139       TO DFHEIV12
 21140     MOVE 0
 21141       TO DFHEIV11
 21142*    MOVE '&.IL                  )  N#00019684' TO DFHEIV0
 21143     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21144     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21145     MOVE X'204E233030303139363834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 390
* EL050.cbl
 21146     CALL 'kxdfhei1' USING DFHEIV0,
 21147           STAT-ID,
 21148           STATE-FILE,
 21149           DFHEIV12,
 21150           ELSTAT-KEY,
 21151           DFHEIV99,
 21152           DFHEIV11,
 21153           DFHEIV99,
 21154           DFHEIV99
 21155     MOVE EIBRESP  TO WS-RESPONSE
 21156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21157     IF WS-RESP-NORMAL
 21158        MOVE 'Y'                 TO STAT-MASTER-SW
 21159     ELSE
 21160        MOVE 'N'                 TO STAT-MASTER-SW
 21161     END-IF
 21162     .
 21163 8752-EXIT.
 21164     EXIT.
 21165 8800-GET-COMP-RATE.
 21166     MOVE +1 TO IB.
 21167     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21168         ADD +9 TO IB
 21169         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21170             ADD +9 TO IB
 21171             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21172                MOVE ZEROS       TO WS-WK-RATE
 21173                GO TO 8800-EXIT.
 21174
 21175     IF PB-I-AGE GREATER CT-AGE (1)
 21176         ADD +3 TO IB
 21177         IF PB-I-AGE GREATER CT-AGE (2)
 21178             ADD +3 TO IB
 21179             IF PB-I-AGE GREATER CT-AGE (3)
 21180                MOVE ZEROS       TO WS-WK-RATE
 21181                GO TO 8800-EXIT.
 21182
 21183     IF WS-WORK-TERM GREATER CT-TRM (1)
 21184         ADD +1 TO IB
 21185         IF WS-WORK-TERM GREATER CT-TRM (2)
 21186             ADD +1 TO IB
 21187             IF WS-WORK-TERM GREATER CT-TRM (3)
 21188                MOVE ZEROS       TO WS-WK-RATE
 21189                GO TO 8800-EXIT.
 21190
 21191     IF CT-RT (IB) NOT NUMERIC
 21192         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21193         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21194         GO TO 8800-GET-COMP-RATE.
 21195
 21196     MOVE CT-RT (IB) TO WS-WK-RATE.
 21197
 21198 8800-EXIT.
 21199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 391
* EL050.cbl
 21201 8900-ADDRESS-FILE.
 21202     IF ERACCT-FILE-ADDRESSED
 21203         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21204         GO TO 8900-ADDRESS-EXIT.
 21205
 21206     IF ELCNTL-FILE-ADDRESSED
 21207         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21208         GO TO 8900-ADDRESS-EXIT.
 21209
 21210     IF ERPLAN-FILE-ADDRESSED
 21211         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21212         GO TO 8900-ADDRESS-EXIT.
 21213
 21214     IF ERFORM-FILE-ADDRESSED
 21215         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21216         GO TO 8900-ADDRESS-EXIT.
 21217
 21218 8900-ADDRESS-EXIT.
 21219     EXIT.
 21220
 21221 9000-READ-CONTROL.
 21222
 21223* EXEC CICS HANDLE CONDITION
 21224*        NOTFND    (9000-NOTFND)
 21225*    END-EXEC.
 21226*    MOVE '"$I                   ! ? #00019755' TO DFHEIV0
 21227     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21229     MOVE X'3F20233030303139373535' TO DFHEIV0(25:11)
 21230     CALL 'kxdfhei1' USING DFHEIV0
 21231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21232
 21233
 21234
 21235* EXEC CICS READ
 21236*        DATASET     (CNTL-ID)
 21237*        SET         (ADDRESS OF CONTROL-FILE)
 21238*        RIDFLD      (ELCNTL-KEY)
 21239*        GTEQ
 21240*    END-EXEC.
 21241*    MOVE '&"S        G          (   #00019759' TO DFHEIV0
 21242     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21244     MOVE X'2020233030303139373539' TO DFHEIV0(25:11)
 21245     CALL 'kxdfhei1' USING DFHEIV0,
 21246           CNTL-ID,
 21247           DFHEIV20,
 21248           DFHEIV99,
 21249           ELCNTL-KEY,
 21250           DFHEIV99,
 21251           DFHEIV99,
 21252           DFHEIV99
 21253     SET ADDRESS OF CONTROL-FILE TO
 21254         DFHEIV20
 21255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21256
 21257
 21258     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 392
* EL050.cbl
 21259
 21260 9000-NOTFND.
 21261     IF RC-SW-1 = '1'
 21262        MOVE ER-2616              TO WS-ERROR
 21263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21264        GO TO 9000-EXIT.
 21265
 21266     IF RC-SW-1 = '2'
 21267        MOVE ER-2602              TO WS-ERROR
 21268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21269
 21270 9000-EXIT.
 21271      EXIT.
 21272
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 393
* EL050.cbl
 21274 9100-READ-CONTROL.
 21275
 21276* EXEC CICS HANDLE CONDITION
 21277*        NOTFND  (9100-NOTFND)
 21278*        ENDFILE (9100-NOTFND)
 21279*    END-EXEC.
 21280*    MOVE '"$I''                  ! @ #00019783' TO DFHEIV0
 21281     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21283     MOVE X'4020233030303139373833' TO DFHEIV0(25:11)
 21284     CALL 'kxdfhei1' USING DFHEIV0
 21285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21286
 21287
 21288
 21289* EXEC CICS READ
 21290*        DATASET     (CNTL-ID)
 21291*        INTO        (CONTROL-FILE)
 21292*        RIDFLD      (ELCNTL-KEY)
 21293*        GTEQ
 21294*    END-EXEC.
 21295     MOVE LENGTH OF
 21296      CONTROL-FILE
 21297       TO DFHEIV11
 21298*    MOVE '&"IL       G          (   #00019788' TO DFHEIV0
 21299     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21301     MOVE X'2020233030303139373838' TO DFHEIV0(25:11)
 21302     CALL 'kxdfhei1' USING DFHEIV0,
 21303           CNTL-ID,
 21304           CONTROL-FILE,
 21305           DFHEIV11,
 21306           ELCNTL-KEY,
 21307           DFHEIV99,
 21308           DFHEIV99,
 21309           DFHEIV99
 21310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21311
 21312
 21313     GO TO 9100-EXIT.
 21314
 21315 9100-NOTFND.
 21316     IF RC-SW-2 = '0'
 21317        MOVE '1'                  TO STATE-RECORD-ERROR
 21318        GO TO 9100-EXIT
 21319     END-IF
 21320     IF RC-SW-2 = '1'
 21321        MOVE '1'                  TO LF-BENEFIT-ERROR
 21322        MOVE ER-2604              TO WS-ERROR
 21323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21324        GO TO 9100-EXIT.
 21325
 21326     IF RC-SW-2 = '2'
 21327        MOVE '1'                  TO AH-BENEFIT-ERROR
 21328        MOVE ER-2605              TO WS-ERROR
 21329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21330        GO TO 9100-EXIT.
 21331
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 394
* EL050.cbl
 21332     IF RC-SW-2 = '3'
 21333         MOVE ER-2603           TO WS-ERROR
 21334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21335         GO TO 9100-EXIT.
 21336
 21337     IF RC-SW-2 = '4'
 21338         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21339         GO TO 9100-EXIT.
 21340
 21341     IF RC-SW-2 = '5'
 21342         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21343         IF WS-AH-INPUT-CD-1 = SPACE
 21344             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21345         ELSE
 21346             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21347
 21348 9100-EXIT.
 21349      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 395
* EL050.cbl
 21351 9200-CONTROL-GETMAIN.
 21352
 21353* EXEC CICS GETMAIN
 21354*         LENGTH   (750)
 21355*         SET      (ADDRESS OF CONTROL-FILE)
 21356*    END-EXEC.
 21357     MOVE 750
 21358       TO DFHEIV11
 21359*    MOVE '," L                  $   #00019834' TO DFHEIV0
 21360     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21361     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21362     MOVE X'2020233030303139383334' TO DFHEIV0(25:11)
 21363     CALL 'kxdfhei1' USING DFHEIV0,
 21364           DFHEIV20,
 21365           DFHEIV11,
 21366           DFHEIV99
 21367     SET ADDRESS OF CONTROL-FILE TO
 21368         DFHEIV20
 21369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21370
 21371
 21372     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21373
 21374 9200-EXIT.
 21375     EXIT.
 21376
 21377 9250-UNLOCK-RETURN.
 21378
 21379* EXEC CICS UNLOCK
 21380*        DATASET   (CERT-ID)
 21381*    END-EXEC.
 21382*    MOVE '&*                    #   #00019845' TO DFHEIV0
 21383     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21384     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21385     MOVE X'2020233030303139383435' TO DFHEIV0(25:11)
 21386     CALL 'kxdfhei1' USING DFHEIV0,
 21387           CERT-ID,
 21388           DFHEIV99
 21389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21390
 21391
 21392 9300-ABEND.
 21393     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21394
 21395
 21396* EXEC CICS LINK
 21397*        PROGRAM   ('EL004')
 21398*        COMMAREA  (WS-ERROR-LINE)
 21399*        LENGTH    (72)
 21400*    END-EXEC.
 21401     MOVE 'EL004' TO DFHEIV1
 21402     MOVE 72
 21403       TO DFHEIV11
 21404*    MOVE '."C                   (   #00019852' TO DFHEIV0
 21405     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21407     MOVE X'2020233030303139383532' TO DFHEIV0(25:11)
 21408     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 396
* EL050.cbl
 21409           DFHEIV1,
 21410           WS-ERROR-LINE,
 21411           DFHEIV11,
 21412           DFHEIV99,
 21413           DFHEIV99,
 21414           DFHEIV99,
 21415           DFHEIV99
 21416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21417
 21418
 21419     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21420
 21421
 21422* EXEC CICS ABEND
 21423*        ABCODE ('EL50')
 21424*    END-EXEC.
 21425     MOVE 'EL50' TO DFHEIV5
 21426*    MOVE '.,A                   "   #00019860' TO DFHEIV0
 21427     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21428     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21429     MOVE X'2020233030303139383630' TO DFHEIV0(25:11)
 21430     CALL 'kxdfhei1' USING DFHEIV0,
 21431           DFHEIV5
 21432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21433
 21434
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 397
* EL050.cbl
 21436
 21437******************************************************************
 21438*                                                                *
 21439*            E R R O R   F O R M A T   R O U T I N E             *
 21440*                                                                *
 21441******************************************************************
 21442
 21443 9900-ERROR-FORMAT.
 21444
 21445     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21446                    PB-COMMON-ERROR (2) OR
 21447                    PB-COMMON-ERROR (3) OR
 21448                    PB-COMMON-ERROR (4) OR
 21449                    PB-COMMON-ERROR (5) OR
 21450                    PB-COMMON-ERROR (6) OR
 21451                    PB-COMMON-ERROR (7) OR
 21452                    PB-COMMON-ERROR (8) OR
 21453                    PB-COMMON-ERROR (9) OR
 21454                    PB-COMMON-ERROR (10)
 21455        GO TO 9900-EXIT.
 21456
 21457     IF PB-NO-OF-ERRORS = +10
 21458        GO TO 9900-EXIT.
 21459
 21460     ADD +1  TO PB-NO-OF-ERRORS.
 21461     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21462                                       (PB-NO-OF-ERRORS).
 21463 9900-EXIT.
 21464     EXIT.
 21465
 21466 9990-RETURN.
 21467     IF BROWSE-STARTED
 21468
 21469* EXEC CICS ENDBR
 21470*            DATASET  (ACCT-ID)
 21471*       END-EXEC.
 21472     MOVE 0
 21473       TO DFHEIV11
 21474*    MOVE '&2                    $   #00019897' TO DFHEIV0
 21475     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21476     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21477     MOVE X'2020233030303139383937' TO DFHEIV0(25:11)
 21478     CALL 'kxdfhei1' USING DFHEIV0,
 21479           ACCT-ID,
 21480           DFHEIV11,
 21481           DFHEIV99
 21482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21483
 21484
 21485 9990-EXIT.
 21486     EXIT.
 21487
 21488
 21489****Check for CRTO record, add one if not found.
 21490 9991-CHECK-FOR-ELCRTO.
 21491
 21492* EXEC CICS HANDLE CONDITION
 21493*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 398
* EL050.cbl
 21494*         ENDFILE (9991-CRTO-NOT-FOUND)
 21495*     END-EXEC.
 21496*    MOVE '"$I''                  ! A #00019907' TO DFHEIV0
 21497     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21499     MOVE X'4120233030303139393037' TO DFHEIV0(25:11)
 21500     CALL 'kxdfhei1' USING DFHEIV0
 21501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21502
 21503     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21504     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21505     MOVE +0                     TO ELCRTO-SEQ-NO
 21506
 21507
 21508* EXEC CICS READ
 21509*       DATASET   ('ELCRTO')
 21510*       INTO      (ORIGINAL-CERTIFICATE)
 21511*       RIDFLD    (ELCRTO-KEY)
 21512*       GTEQ
 21513*       RESP      (WS-RESPONSE)
 21514*    END-EXEC
 21515     MOVE LENGTH OF
 21516      ORIGINAL-CERTIFICATE
 21517       TO DFHEIV11
 21518     MOVE 'ELCRTO' TO DFHEIV1
 21519*    MOVE '&"IL       G          (  N#00019915' TO DFHEIV0
 21520     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21522     MOVE X'204E233030303139393135' TO DFHEIV0(25:11)
 21523     CALL 'kxdfhei1' USING DFHEIV0,
 21524           DFHEIV1,
 21525           ORIGINAL-CERTIFICATE,
 21526           DFHEIV11,
 21527           ELCRTO-KEY,
 21528           DFHEIV99,
 21529           DFHEIV99,
 21530           DFHEIV99
 21531     MOVE EIBRESP  TO WS-RESPONSE
 21532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21533
 21534     IF WS-RESP-NORMAL
 21535        AND (OC-CONTROL-PRIMARY (1:33) =
 21536                 PB-CONTROL-BY-ACCOUNT (1:33))
 21537        AND (OC-RECORD-TYPE =  'I')
 21538           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21539               GO TO 9991-CHECK-INDICATORS
 21540           ELSE
 21541               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21542               GO TO 9991-CRTO-ADD-REC
 21543           END-IF
 21544     END-IF.
 21545
 21546 9991-CRTO-NOT-FOUND.
 21547
 21548     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21549     MOVE 'OC'                TO OC-RECORD-ID
 21550     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21551                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 399
* EL050.cbl
 21552     MOVE +4096               TO OC-KEY-SEQ-NO.
 21553
 21554 9991-CRTO-ADD-REC.
 21555
 21556     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21557     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21558     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21559     MOVE 'I'                 TO OC-RECORD-TYPE
 21560     IF PB-ISSUE
 21561         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21562         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21563         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21564         MOVE PB-I-AGE               TO OC-INS-AGE
 21565         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21566         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21567         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21568         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21569         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21570         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21571         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21572         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21573         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21574         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21575         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21576         IF PB-I-JOINT-COMMISSION > +0
 21577             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21578         ELSE
 21579             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21580         END-IF
 21581         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21582         MOVE +0                     TO OC-LF-CANCEL-AMT
 21583                                        OC-LF-ITD-CANCEL-AMT
 21584         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21585         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21586         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21587         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21588         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21589         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21590         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21591         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21592         MOVE +0                     TO OC-AH-CANCEL-AMT
 21593                                        OC-AH-ITD-CANCEL-AMT
 21594         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21595         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21596         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21597     ELSE
 21598         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21599         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21600         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21601         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21602         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21603         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21604         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21605         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21606         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21607          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21608             MOVE SPACES             TO OC-LF-BENCD
 21609             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 400
* EL050.cbl
 21610                                        OC-LF-BEN-AMT
 21611                                        OC-LF-PRM-AMT
 21612                                        OC-LF-ALT-BEN-AMT
 21613                                        OC-LF-ALT-PRM-AMT
 21614                                        OC-LF-COMM-PCT
 21615                                        OC-LF-CANCEL-AMT
 21616             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21617             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21618         ELSE
 21619             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21620             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21621             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21622             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21623             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21624             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21625             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21626             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21627             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21628             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21629         END-IF
 21630         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21631         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21632          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21633             MOVE SPACES             TO OC-AH-BENCD
 21634             MOVE ZEROS              TO OC-AH-TERM
 21635                                        OC-AH-BEN-AMT
 21636                                        OC-AH-PRM-AMT
 21637                                        OC-AH-COMM-PCT
 21638                                        OC-AH-CANCEL-AMT
 21639                                        OC-AH-CP
 21640             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21641             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21642         ELSE
 21643             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21644             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21645             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21646             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21647             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21648             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21649             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21650             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21651             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21652         END-IF
 21653         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21654         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21655         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21656         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21657     END-IF
 21658     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21659
 21660     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21661
 21662
 21663* EXEC CICS READ
 21664*         DATASET   (FILE-ERMAIL)
 21665*         RIDFLD    (MA-CONTROL-PRIMARY)
 21666*         INTO      (MAILING-DATA)
 21667*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 401
* EL050.cbl
 21668*    END-EXEC
 21669     MOVE LENGTH OF
 21670      MAILING-DATA
 21671       TO DFHEIV11
 21672*    MOVE '&"IL       E          (  N#00020051' TO DFHEIV0
 21673     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21674     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21675     MOVE X'204E233030303230303531' TO DFHEIV0(25:11)
 21676     CALL 'kxdfhei1' USING DFHEIV0,
 21677           FILE-ERMAIL,
 21678           MAILING-DATA,
 21679           DFHEIV11,
 21680           MA-CONTROL-PRIMARY,
 21681           DFHEIV99,
 21682           DFHEIV99,
 21683           DFHEIV99
 21684     MOVE EIBRESP  TO WS-RESPONSE
 21685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21686
 21687     IF WS-RESP-NORMAL
 21688         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21689     END-IF.
 21690
 21691     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21692     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21693
 21694
 21695* EXEC CICS READ
 21696*         DATASET  (CRTT-ID)
 21697*         RIDFLD   (WS-ELCRTT-KEY)
 21698*         INTO     (CERTIFICATE-TRAILERS)
 21699*         RESP     (WS-RESPONSE)
 21700*    END-EXEC
 21701     MOVE LENGTH OF
 21702      CERTIFICATE-TRAILERS
 21703       TO DFHEIV11
 21704*    MOVE '&"IL       E          (  N#00020065' TO DFHEIV0
 21705     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21706     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21707     MOVE X'204E233030303230303635' TO DFHEIV0(25:11)
 21708     CALL 'kxdfhei1' USING DFHEIV0,
 21709           CRTT-ID,
 21710           CERTIFICATE-TRAILERS,
 21711           DFHEIV11,
 21712           WS-ELCRTT-KEY,
 21713           DFHEIV99,
 21714           DFHEIV99,
 21715           DFHEIV99
 21716     MOVE EIBRESP  TO WS-RESPONSE
 21717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21718
 21719     IF WS-RESP-NORMAL
 21720         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21721         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21722     END-IF.
 21723
 21724
 21725* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 402
* EL050.cbl
 21726*       DATASET   ('ELCRTO')
 21727*       FROM      (ORIGINAL-CERTIFICATE)
 21728*       RIDFLD    (OC-CONTROL-PRIMARY)
 21729*       RESP      (WS-RESPONSE)
 21730*    END-EXEC.
 21731     MOVE LENGTH OF
 21732      ORIGINAL-CERTIFICATE
 21733       TO DFHEIV11
 21734     MOVE 'ELCRTO' TO DFHEIV1
 21735*    MOVE '&$ L                  ''  N#00020077' TO DFHEIV0
 21736     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21738     MOVE X'204E233030303230303737' TO DFHEIV0(25:11)
 21739     CALL 'kxdfhei1' USING DFHEIV0,
 21740           DFHEIV1,
 21741           ORIGINAL-CERTIFICATE,
 21742           DFHEIV11,
 21743           OC-CONTROL-PRIMARY,
 21744           DFHEIV99,
 21745           DFHEIV99
 21746     MOVE EIBRESP  TO WS-RESPONSE
 21747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21748
 21749
 21750     GO TO 9991-EXIT.
 21751
 21752 9991-CHECK-INDICATORS.
 21753
 21754     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21755         GO TO 9991-EXIT
 21756     END-IF.
 21757
 21758     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21759         GO TO 9991-EXIT
 21760     END-IF.
 21761
 21762
 21763* EXEC CICS READ
 21764*       DATASET   ('ELCRTO')
 21765*       INTO      (ORIGINAL-CERTIFICATE)
 21766*       RIDFLD    (OC-CONTROL-PRIMARY)
 21767*       UPDATE
 21768*       RESP      (WS-RESPONSE)
 21769*    END-EXEC
 21770     MOVE LENGTH OF
 21771      ORIGINAL-CERTIFICATE
 21772       TO DFHEIV11
 21773     MOVE 'ELCRTO' TO DFHEIV1
 21774*    MOVE '&"IL       EU         (  N#00020096' TO DFHEIV0
 21775     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21776     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21777     MOVE X'204E233030303230303936' TO DFHEIV0(25:11)
 21778     CALL 'kxdfhei1' USING DFHEIV0,
 21779           DFHEIV1,
 21780           ORIGINAL-CERTIFICATE,
 21781           DFHEIV11,
 21782           OC-CONTROL-PRIMARY,
 21783           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 403
* EL050.cbl
 21784           DFHEIV99,
 21785           DFHEIV99
 21786     MOVE EIBRESP  TO WS-RESPONSE
 21787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21788     IF WS-RESP-NORMAL
 21789        IF PB-ISSUE
 21790          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21791          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21792          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21793          MOVE PB-I-AGE               TO OC-INS-AGE
 21794          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21795          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21796          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21797          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21798          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21799          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21800          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21801          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21802          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21803          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21804          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21805          IF PB-I-JOINT-COMMISSION > +0
 21806              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21807          ELSE
 21808              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21809          END-IF
 21810          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21811          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21812          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21813          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21814          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21815          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21816          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21817          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21818          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21819
 21820          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21821
 21822* EXEC CICS READ
 21823*             DATASET   (FILE-ERMAIL)
 21824*             RIDFLD    (MA-CONTROL-PRIMARY)
 21825*             INTO      (MAILING-DATA)
 21826*             RESP      (WS-RESPONSE)
 21827*         END-EXEC
 21828     MOVE LENGTH OF
 21829      MAILING-DATA
 21830       TO DFHEIV11
 21831*    MOVE '&"IL       E          (  N#00020136' TO DFHEIV0
 21832     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21834     MOVE X'204E233030303230313336' TO DFHEIV0(25:11)
 21835     CALL 'kxdfhei1' USING DFHEIV0,
 21836           FILE-ERMAIL,
 21837           MAILING-DATA,
 21838           DFHEIV11,
 21839           MA-CONTROL-PRIMARY,
 21840           DFHEIV99,
 21841           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 404
* EL050.cbl
 21842           DFHEIV99
 21843     MOVE EIBRESP  TO WS-RESPONSE
 21844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21845          IF WS-RESP-NORMAL
 21846             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21847          END-IF
 21848
 21849          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21850          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21851
 21852* EXEC CICS READ
 21853*             DATASET  (CRTT-ID)
 21854*             RIDFLD   (WS-ELCRTT-KEY)
 21855*             INTO     (CERTIFICATE-TRAILERS)
 21856*             RESP     (WS-RESPONSE)
 21857*         END-EXEC
 21858     MOVE LENGTH OF
 21859      CERTIFICATE-TRAILERS
 21860       TO DFHEIV11
 21861*    MOVE '&"IL       E          (  N#00020148' TO DFHEIV0
 21862     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21863     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21864     MOVE X'204E233030303230313438' TO DFHEIV0(25:11)
 21865     CALL 'kxdfhei1' USING DFHEIV0,
 21866           CRTT-ID,
 21867           CERTIFICATE-TRAILERS,
 21868           DFHEIV11,
 21869           WS-ELCRTT-KEY,
 21870           DFHEIV99,
 21871           DFHEIV99,
 21872           DFHEIV99
 21873     MOVE EIBRESP  TO WS-RESPONSE
 21874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21875          IF WS-RESP-NORMAL
 21876             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21877                               OC-INS-AGE-DEFAULT-FLAG
 21878             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21879                               OC-JNT-AGE-DEFAULT-FLAG
 21880          END-IF
 21881
 21882        ELSE
 21883          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21884             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21885             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21886             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21887          END-IF
 21888          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21889             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21890             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21891             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21892          END-IF
 21893          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21894        END-IF
 21895
 21896* EXEC CICS REWRITE
 21897*          DATASET   ('ELCRTO')
 21898*          FROM      (ORIGINAL-CERTIFICATE)
 21899*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 405
* EL050.cbl
 21900*       END-EXEC
 21901     MOVE LENGTH OF
 21902      ORIGINAL-CERTIFICATE
 21903       TO DFHEIV11
 21904     MOVE 'ELCRTO' TO DFHEIV1
 21905*    MOVE '&& L                  %  N#00020174' TO DFHEIV0
 21906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21908     MOVE X'204E233030303230313734' TO DFHEIV0(25:11)
 21909     CALL 'kxdfhei1' USING DFHEIV0,
 21910           DFHEIV1,
 21911           ORIGINAL-CERTIFICATE,
 21912           DFHEIV11,
 21913           DFHEIV99
 21914     MOVE EIBRESP  TO WS-RESPONSE
 21915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21916     END-IF.
 21917
 21918 9991-EXIT.
 21919     EXIT.
 21920
 21921
 21922 9999-RETURN.
 21923     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21924
 21925
 21926* EXEC CICS RETURN
 21927*    END-EXEC.
 21928*    MOVE '.(                    ''   #00020188' TO DFHEIV0
 21929     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21930     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21931     MOVE X'2020233030303230313838' TO DFHEIV0(25:11)
 21932     CALL 'kxdfhei1' USING DFHEIV0,
 21933           DFHEIV99,
 21934           DFHEIV99,
 21935           DFHEIV99,
 21936           DFHEIV99,
 21937           DFHEIV99,
 21938           DFHEIV99
 21939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21940
 21941
 21942
 21943* GOBACK.
 21944     MOVE '9%                    "   ' TO DFHEIV0
 21945     MOVE 'EL050' TO DFHEIV1
 21946     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21947     GOBACK.
 21948
 21949 9999-DFHBACK SECTION.
 21950     MOVE '9%                    "   ' TO DFHEIV0
 21951     MOVE 'EL050' TO DFHEIV1
 21952     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21953     GOBACK.
 21954 9999-DFHEXIT.
 21955     IF DFHEIGDJ EQUAL 0001
 21956         NEXT SENTENCE
 21957     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 406
* EL050.cbl
 21958         GO TO 9300-ABEND,
 21959               3990-FILES-NOT-OPEN
 21960         DEPENDING ON DFHEIGDI
 21961     ELSE IF DFHEIGDJ EQUAL 3
 21962         GO TO 6610-START-BROWSE,
 21963               6630-ERRESS-PROBLEM,
 21964               6630-END-OF-FILE
 21965         DEPENDING ON DFHEIGDI
 21966     ELSE IF DFHEIGDJ EQUAL 4
 21967         GO TO 6630-END-OF-FILE,
 21968               6630-ERRESS-PROBLEM,
 21969               6630-ERRESS-PROBLEM,
 21970               6630-END-OF-FILE
 21971         DEPENDING ON DFHEIGDI
 21972     ELSE IF DFHEIGDJ EQUAL 5
 21973         GO TO 6630-END-OF-FILE,
 21974               6630-END-OF-FILE,
 21975               6630-ERRESS-PROBLEM,
 21976               6630-ERRESS-PROBLEM
 21977         DEPENDING ON DFHEIGDI
 21978     ELSE IF DFHEIGDJ EQUAL 6
 21979         GO TO 6660-START-BROWSE,
 21980               6690-ERRESC-PROBLEM,
 21981               6690-ERRESC-PROBLEM,
 21982               6690-END-OF-FILE
 21983         DEPENDING ON DFHEIGDI
 21984     ELSE IF DFHEIGDJ EQUAL 7
 21985         GO TO 6690-END-OF-FILE,
 21986               6690-ERRESC-PROBLEM,
 21987               6690-ERRESC-PROBLEM,
 21988               6690-END-OF-FILE
 21989         DEPENDING ON DFHEIGDI
 21990     ELSE IF DFHEIGDJ EQUAL 8
 21991         GO TO 6690-END-OF-FILE,
 21992               6690-ERRESC-PROBLEM,
 21993               6690-ERRESC-PROBLEM,
 21994               6690-END-OF-FILE
 21995         DEPENDING ON DFHEIGDI
 21996     ELSE IF DFHEIGDJ EQUAL 9
 21997         GO TO 7250-CONTINUE,
 21998               7250-CONTINUE
 21999         DEPENDING ON DFHEIGDI
 22000     ELSE IF DFHEIGDJ EQUAL 10
 22001         GO TO 7300-CONTINUE,
 22002               7300-CONTINUE
 22003         DEPENDING ON DFHEIGDI
 22004     ELSE IF DFHEIGDJ EQUAL 11
 22005         GO TO 8000-FREE-MAIN
 22006         DEPENDING ON DFHEIGDI
 22007     ELSE IF DFHEIGDJ EQUAL 12
 22008         GO TO 8100-NOTFND,
 22009               8100-NOTFND
 22010         DEPENDING ON DFHEIGDI
 22011     ELSE IF DFHEIGDJ EQUAL 13
 22012         GO TO 8110-NOTFND,
 22013               8110-NOTFND
 22014         DEPENDING ON DFHEIGDI
 22015     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 407
* EL050.cbl
 22016         GO TO 8130-EXIT
 22017         DEPENDING ON DFHEIGDI
 22018     ELSE IF DFHEIGDJ EQUAL 15
 22019         GO TO 8150-exit
 22020         DEPENDING ON DFHEIGDI
 22021     ELSE IF DFHEIGDJ EQUAL 16
 22022         GO TO 8180-NOTFND
 22023         DEPENDING ON DFHEIGDI
 22024     ELSE IF DFHEIGDJ EQUAL 17
 22025         GO TO 8190-NOTFND
 22026         DEPENDING ON DFHEIGDI
 22027     ELSE IF DFHEIGDJ EQUAL 18
 22028         GO TO 8195-NOTFND
 22029         DEPENDING ON DFHEIGDI
 22030     ELSE IF DFHEIGDJ EQUAL 19
 22031         GO TO 8200-NOTFND
 22032         DEPENDING ON DFHEIGDI
 22033     ELSE IF DFHEIGDJ EQUAL 20
 22034         GO TO 8300-NOTFND,
 22035               8300-ERRESS-PROBLEM,
 22036               8300-ERRESS-PROBLEM,
 22037               8300-NOTFND
 22038         DEPENDING ON DFHEIGDI
 22039     ELSE IF DFHEIGDJ EQUAL 21
 22040         GO TO 8450-FORM-NOT-FOUND,
 22041               8450-FORM-NOT-FOUND
 22042         DEPENDING ON DFHEIGDI
 22043     ELSE IF DFHEIGDJ EQUAL 22
 22044         GO TO 0199-ACCT-NOT-FOUND,
 22045               0199-ACCT-NOT-FOUND
 22046         DEPENDING ON DFHEIGDI
 22047     ELSE IF DFHEIGDJ EQUAL 23
 22048         GO TO 0199-ACCT-NOT-FOUND,
 22049               0199-ACCT-NOT-FOUND
 22050         DEPENDING ON DFHEIGDI
 22051     ELSE IF DFHEIGDJ EQUAL 24
 22052         GO TO 8582-COMP-NOT-FOUND,
 22053               8582-COMP-NOT-FOUND
 22054         DEPENDING ON DFHEIGDI
 22055     ELSE IF DFHEIGDJ EQUAL 25
 22056         GO TO 8583-AGTC-NOT-FOUND,
 22057               8583-AGTC-NOT-FOUND
 22058         DEPENDING ON DFHEIGDI
 22059     ELSE IF DFHEIGDJ EQUAL 26
 22060         GO TO 8584-BXRF-NOT-FOUND,
 22061               8584-BXRF-NOT-FOUND
 22062         DEPENDING ON DFHEIGDI
 22063     ELSE IF DFHEIGDJ EQUAL 27
 22064         GO TO 8585-PLAN-NOT-FOUND,
 22065               8585-PLAN-NOT-FOUND
 22066         DEPENDING ON DFHEIGDI
 22067     ELSE IF DFHEIGDJ EQUAL 28
 22068         GO TO 0299-CERT-NOT-FOUND
 22069         DEPENDING ON DFHEIGDI
 22070     ELSE IF DFHEIGDJ EQUAL 29
 22071         GO TO 8700-READ-CERT-MASTER
 22072         DEPENDING ON DFHEIGDI
 22073     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 02-Oct-14 15:56 Page 408
* EL050.cbl
 22074         GO TO 8720-COMP-ACCOUNTS,
 22075               8730-END-BROWSE,
 22076               8740-NOT-FOUND
 22077         DEPENDING ON DFHEIGDI
 22078     ELSE IF DFHEIGDJ EQUAL 31
 22079         GO TO 9000-NOTFND
 22080         DEPENDING ON DFHEIGDI
 22081     ELSE IF DFHEIGDJ EQUAL 32
 22082         GO TO 9100-NOTFND,
 22083               9100-NOTFND
 22084         DEPENDING ON DFHEIGDI
 22085     ELSE IF DFHEIGDJ EQUAL 33
 22086         GO TO 9991-CRTO-NOT-FOUND,
 22087               9991-CRTO-NOT-FOUND
 22088         DEPENDING ON DFHEIGDI.
 22089     MOVE '9%                    "   ' TO DFHEIV0
 22090     MOVE 'EL050' TO DFHEIV1
 22091     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22092     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40040     Code:       89077
