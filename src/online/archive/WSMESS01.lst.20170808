* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   1
* WSMESS01.cbl
* Options: int("WSMESS01.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("WSMESS01.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"WSMESS01.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "WSMESS01.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. WSMESS01.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 19-Jul-17 11:24.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   2
* WSMESS01.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*  Returns premium calc based on info passed to me.              *
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 020617   2017020300002   PEMA  New Program
    27******************************************************************
    28 ENVIRONMENT DIVISION.
    29 data division.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32) VALUE '********************************'.
    33 77  FILLER  PIC X(32) VALUE '   WSMESS01 WORKING STORAGE     '.
    34 77  FILLER  PIC X(32) VALUE '********************************'.
    35*
    36* program buffers
    37*
    38 77  ws-seq-num                  pic s9(8) comp value 0.
    39 77  ws-flags                    pic s9(8) comp value 0.
    40 77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
    41 77  ws-comp-id                  pic xxx value spaces.
    42 77  WS-SAVE-ACCOUNT             PIC X(10)  VALUE SPACES.
    43 77  WS-BIN-ORIG-EFF-DT          PIC XX  VALUE LOW-VALUES.
    44 77  WS-ORIG-EFF-DT              PIC X(10)  VALUE SPACES.
    45 77  WS-EFF-DATE                 PIC X(10)  VALUE SPACES.
    46 77  WS-EXP-DATE                 PIC X(10)  VALUE SPACES.
    47 77  X1                          PIC S999 COMP-3 VALUE +0.
    48 77  S1                          PIC S999 COMP-3 VALUE +0.
    49 77  S2                          PIC S999 COMP-3 VALUE +0.
    50 77  S3                          PIC S999 COMP-3 VALUE +0.
    51 77  b1                          pic s999 comp-3 value +0.
    52 77  WS-BUILD-SW                 PIC X.
    53     88  TIME-TO-BUILD              VALUE 'Y'.
    54 77  WS-SAVE-ERACCT              PIC X(2000).
    55 77  WS-DIS-RESP                 PIC 9(05) VALUE ZEROS.
    56 77  WS-PERFORM-SW               PIC X VALUE SPACES.
    57     88  GET-RATES                   VALUE 'R'.
    58     88  GET-ACT-ACCTS               VALUE 'A'.
    59 77  ws-bin-current-dt           pic xx  value low-values.
    60 77  ws-bin-eff-dt               pic xx  value low-values.
    61 77  ws-bin-exp-dt               pic xx  value low-values.
    62 77  ws-bin-1st-pmt-dt           pic xx  value low-values.
    63 77  ws-bin-pri-birth-dt         pic xx  value low-values.
    64 77  ws-bin-cob-birth-dt         pic xx  value low-values.
    65 77  WS-DISP-AMT                 PIC Z,ZZZ,Z99.99.
    66 77  ws-disp-rate                pic z9.99999.
    67 77  WS-ERACCT-SW                PIC X VALUE ' '.
    68     88  END-OF-ERACCT                 VALUE 'Y'.
    69 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    70     88  END-OF-ERCTBL                 VALUE 'Y'.
    71 77  WS-STATUS                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   3
* WSMESS01.cbl
    72 77  ws-socket-sw                pic x value ' '.
    73     88  end-of-socket              value 'Y'.
    74 77  rec-cnt                     pic 9(5) value zeros.
    75 77  ws-stop-sw                  pic x value ' '.
    76     88  i-say-stop                 value 'Y'.
    77 77  ws-browse-sw                pic x value ' '.
    78     88  browse-started            value 'Y'.
    79 77  ws-contract-sw              pic x  value ' '.
    80     88  contract-no-assigned      value 'Y'.
    81 77  ws-error-sw                 pic x value ' '.
    82     88  error-in-one-coverage     value 'Y'.
    83 77  ws-connect-sw               pic x value ' '.
    84     88  connected-to-db           value 'Y'.
    85 77  client-id                   pic xxx.
    86 01  P pointer.
    87 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    88 01  var-ptr pointer.
    89 01  env-var-len                 pic 9(4)  binary.
    90 01  rc                          pic 9(9)  binary.
    91 01  WS-KIXSYS.
    92     05  WS-KIX-FIL1             PIC X(10).
    93     05  WS-KIX-APPS             PIC X(10).
    94     05  WS-KIX-ENV              PIC X(10).
    95     05  WS-KIX-MYENV            PIC X(10).
    96     05  WS-KIX-SYS              PIC X(10).
*   97 EXEC SQL
*   98    INCLUDE SQLDA
*   99 END-EXEC
   100 01 SQLDA sync.
   101    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   102    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   103    05 SQLN                  PIC S9(4) COMP-5 value 0.
   104    05 SQLD                  PIC S9(4) COMP-5 value 0.
   105    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   106       10 SQLTYPE            PIC S9(4) COMP-5.
   107       10 SQLLEN             PIC S9(4) COMP-5.
   108$IF P64 SET
   109X      *> For 64-bit environments, ensure that SQLDATA is
   110X      *> aligned on an 8-byte boundary.
   111X      10 FILLER             PIC S9(9) COMP-5.
   112$END
   113       10 SQLDATA            USAGE POINTER.
   114       10 SQLIND             USAGE POINTER.
   115       10 SQLNAME.
   116          15 SQLNAMEL        PIC S9(4) COMP-5.
   117          15 SQLNAMEC        PIC X(30).
   118
   119* Values for SQLTYPE
   120
   121 78  ESQL-DATE-CHAR              VALUE 384.
   122 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   123 78  ESQL-DATE-REC               VALUE 386.
   124 78  ESQL-DATE-REC-NULL          VALUE 387.
   125 78  ESQL-TIME-CHAR              VALUE 388.
   126 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   127 78  ESQL-TIME-REC               VALUE 390.
   128 78  ESQL-TIME-REC-NULL          VALUE 391.
   129 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   4
* WSMESS01.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   131 78  ESQL-TIMESTAMP-REC          VALUE 394.
   132 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   133 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   134 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   135 78  ESQL-TS-OFFSET-REC          VALUE 398.
   136 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   137 78  ESQL-LONGVARBINARY          VALUE 404.
   138 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   139 78  ESQL-LONGVARCHAR            VALUE 408.
   140 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   141 78  ESQL-BINARY                 VALUE 444.
   142 78  ESQL-BINARY-NULL            VALUE 445.
   143 78  ESQL-VARBINARY              VALUE 446.
   144 78  ESQL-VARBINARY-NULL         VALUE 447.
   145 78  ESQL-VARCHAR                VALUE 448.
   146 78  ESQL-VARCHAR-NULL           VALUE 449.
   147
   148 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   149 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   150
   151 78  ESQL-CHAR                   VALUE 452.
   152 78  ESQL-CHAR-NULL              VALUE 453.
   153
   154 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   155 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   156
   157 78  ESQL-DOUBLE                 VALUE 480.
   158 78  ESQL-DOUBLE-NULL            VALUE 481.
   159 78  ESQL-REAL                   VALUE 482.
   160 78  ESQL-REAL-NULL              VALUE 483.
   161 78  ESQL-DECIMAL                VALUE 484.
   162 78  ESQL-DECIMAL-NULL           VALUE 485.
   163 78  ESQL-INTEGER                VALUE 496.
   164 78  ESQL-INTEGER-NULL           VALUE 497.
   165 78  ESQL-SMALLINT               VALUE 500.
   166 78  ESQL-SMALLINT-NULL          VALUE 501.
   167 78  ESQL-TINYINT                VALUE 502.
   168 78  ESQL-TINYINT-NULL           VALUE 503.
*  169 EXEC SQL
*  170    INCLUDE SQLCA
*  171 END-EXEC
   172 01 SQLCA.
   173     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   174     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   175     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   176     05  SQLERRM.
   177         49  SQLERRML    PIC S9(4) COMP-5.
   178         49  SQLERRMC    PIC X(70).
   179     05  SQLERRP         PIC X(8).
   180     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   181     05  SQLWARN.
   182         10  SQLWARN0    PIC X.
   183         10  SQLWARN1    PIC X.
   184         10  SQLWARN2    PIC X.
   185         10  SQLWARN3    PIC X.
   186         10  SQLWARN4    PIC X.
   187         10  SQLWARN5    PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   5
* WSMESS01.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN6    PIC X.
   189         10  SQLWARN7    PIC X.
   190     05  SQLEXT.
   191         10  SQLWARN8    PIC X.
   192         10  SQLWARN9    PIC X.
   193         10  SQLWARN10   PIC X.
   194         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   195     05  SQLSTATE    PIC X(5).
   196 EXEC SQL
   197    BEGIN DECLARE SECTION
   198 END-EXEC
   199 01  ws-dealer-state             pic xx.
   200 01  ws-dealer-id                pic x(10).
   201 01  ws-contract-eff-dt          pic x(10).
   202 01  ws-contract-no              pic x(10) value spaces.
   203 01  ws-contract-suffix          pic x     value spaces.
   204 01  ws-key-stuff.
   205     05  ws-ks-contract-no       pic x(10) value spaces.
   206     05  ws-batch-no             pic x(6) value zeros.
   207     05  ws-batch-no-n redefines
   208         ws-batch-no             pic 9(6).
   209     05  ws-check-key            pic 9(7).
   210     05  ws-check-no             pic x(7).
   211     05  ws-compid               pic xxx.
   212     05  ws-carrier              pic x.
   213     05  ws-grouping             pic x(6).
   214     05  ws-state                pic xx.
   215     05  ws-account              pic x(10).
   216     05  ws-eff-date             pic x(10).
   217     05  ws-certificate          pic x(10).
   218     05  ws-cert-sfx             pic x.
   219     05  ws-seq-no               pic 999.
   220     05  ws-type                 pic 999.
   221 01  ws-status-code-a            pic x(7) value zeros.
   222 01  ws-status-code redefines
   223     ws-status-code-a            pic 9(7).
   224 01  ws-error-message            pic x(50) value spaces.
   225 01  ws-status-date              pic x(10).
   226 01  sqlcmd                      pic x(1024).
   227 01  svr                         pic x(32).
   228 01  usr                         pic x(32).
   229 01  pass                        pic x(32).
   230 01  usr-pass                    pic x(64).
   231 01  ws-disp-code                pic s9(11).
   232***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   233***                                                            ***
   234***  These indicators are used to determine if a variable      ***
   235***  is        null.           The indicator will be -1        ***
   236***  if the value        is null  and +0 if the value is       ***
   237***  something other than null.  Here is an example on how     ***
   238***  to use the indicator variables.                           ***
   239***                                                            ***
   240***     EXEC SQL                                               ***
   241***        fetch checkapp into                                 ***
   242***           :db-app-status :nu-app-status,                   ***
   243***           :db-app-by     :nu-app-by,                       ***
   244***           :db-app-date   :nu-app-date,                     ***
   245***           :db-app-batch  :nu-app-batch                     ***
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   6
* WSMESS01.cbl
   246***     END-EXEC                                               ***
   247***                                                            ***
   248***           OR This way on an update                         ***
   249***                                                            ***
   250***     EXEC SQL                                               ***
   251***        UPDATE                                              ***
   252***           CUC_Logic_Remittance                             ***
   253***        SET                                                 ***
   254***           LogicStatus     = :ws-status-code,               ***
   255***           LogicStatusDate = :ws-status-date,               ***
   256***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   257***        WHERE                                               ***
   258***           RemitId = :ws-remit-id                           ***
   259***     END-EXEC                                               ***
   260***                                                            ***
   261***    Also, when the table has a column with a data type of   ***
   262***  "BIT" and used as true/false move the 1 byte receiving    ***
   263***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   264***  then its false. I think true would be 256.                ***
   265***                                                            ***
   266***                                                            ***
   267***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   268 01  ws-bit                      pic x.
   269 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   270 01  indicator-vaiables-for-nulls.
   271     05  nu-app-status           pic s9(4) comp value +0.
   272     05  nu-app-by               pic s9(4) comp value +0.
   273     05  nu-app-date             pic s9(4) comp value +0.
   274     05  nu-app-batch            pic s9(4) comp value +0.
   275     05  nu-fincar               pic s9(4) comp value +0.
   276     05  nu-batchno              pic s9(4) comp value +0.
   277     05  nu-error-message        pic s9(4) comp value +0.
   278 01  sql-cert-records.
   279     05  sql-dlr-state           pic xx.
   280     05  sql-dlr-id              pic x(10).
   281     05  sql-eff-dt              pic x(10).
   282     05  sql-contr-no            pic x(10).
   283     05  sql-contr-suffix        pic x.
   284 EXEC SQL
   285    END DECLARE SECTION
   286 END-EXEC
   287 01  filler.
   288     05  ws-work-in pic x(10).
   289     05  ws-work-out pic x(10).
   290     05  ws-work-out-v2 redefines
   291         ws-work-out   pic 9(8)v99.
   292     05  ws-work-out-v0 redefines
   293         ws-work-out   pic 9(10).
   294     05  ws-work-out-v5 redefines
   295         ws-work-out   pic 9(5)v9(5).
   296 01  filler.
   297     05  ws-last-suffix          pic x value low-values.
   298     05  ws-tbl-last-suffix      pic x value low-values.
   299     05  filler.  *> Use X1 for this table.
   300         10  ws-codes            pic x(26) value
   301         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   302         10  ws-suffix-value redefines ws-codes
   303           occurs 26             pic x.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   7
* WSMESS01.cbl
   304 01  ws-work-date.
   305     05  ws-work-ccyy            pic x(4).
   306     05  ws-work-mm              pic xx.
   307     05  ws-work-dd              pic xx.
   308 01  ws-work-date-num redefines ws-work-date
   309                                 pic 9(8).
   310 01  raw-message001-area.
   311     05  raw-message-num         pic x(10).
   312     05  raw-state               pic xx.
   313     05  raw-acct-no             pic x(10).
   314     05  raw-vin                 pic x(17).
   315     05  raw-lf-ah               pic x.
   316     05  raw-ben-code            pic xx.
   317     05  raw-earn-meth           pic x.
   318     05  raw-pri-birth-date      pic x(10).
   319     05  raw-cob-birth-date      pic x(10).
   320     05  raw-benefit             pic x(9).
   321     05  raw-eff-date            pic x(10).
   322     05  raw-1st-pmt-dt          pic x(10).
   323     05  raw-premium             pic x(8).
   324     05  raw-loan-term           pic xxx.
   325     05  raw-ins-term            pic XXX.
   326     05  raw-apr                 pic x(8).
   327     05  raw-sin-jnt-ind         pic x.
   328     05  raw-dismemberment       pic x.
   329     05  raw-retro-elim          pic x.
   330     05  raw-waiting-days        pic xx.
   331     05  raw-crit-per            pic xx.
   332     05  raw-total-payments      pic x(9).
   333     05  raw-period-payment      pic x(8).
   334 01  ws-rate-work-area.
   335     05  ws-rate-state           pic xx.
   336     05  ws-rate-acct-no         pic x(10).
   337     05  ws-rate-vin             pic x(17).
   338     05  ws-rate-lf-ah           pic x.
   339     05  ws-rate-ben-code        pic xx.
   340     05  ws-rate-earn-meth       pic x.
   341     05  ws-rate-pri-birth-date  pic x(10).
   342     05  ws-rate-cob-birth-date  pic x(10).
   343     05  ws-rate-eff-date        pic x(10).
   344     05  ws-rate-1st-pmt-dt      pic x(10).
   345     05  ws-rate-benefit-type    pic x.
   346     05  ws-rate-benefit-cd      pic xx.
   347     05  ws-rate-benefit         pic 9(6)v99.
   348     05  ws-rate-tot-pmts        pic 9(6)v99.
   349     05  ws-rate-premium         pic 9(5)v99.
   350     05  ws-rate-apr             pic 99v9(5).
   351     05  ws-rate-loan-term       pic 999  value zeros.
   352     05  ws-rate-ins-term        pic 999  value zeros.
   353     05  ws-issue-age            pic 999  value zeros.
   354     05  ws-cob-age              pic 999  value zeros.
   355     05  ws-rate-age             pic 999  value zeros.
   356     05  ws-max-benefit          pic 9(7)v99 value zeros.
   357     05  ws-rate-crit-per        pic 99.
   358     05  ws-rate-sin-jnt-ind     pic x.
   359     05  ws-rate-dismemberment   pic x.
   360     05  ws-rate-retro-elim      pic x.
   361     05  ws-rate-waiting-days    pic 99.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   8
* WSMESS01.cbl
   362     05  ws-rate-payment         pic 9(5)v99.
   363     05  ws-calc-tot-pmts        pic 9(7)v99 value zeros.
   364 01  WS-AM-KEY.
   365     05  WS-AM-COMPANY-CD        PIC X.
   366     05  WS-AM-CARRIER           PIC X.
   367     05  WS-AM-GROUP             PIC X(6).
   368     05  WS-AM-STATE             PIC XX.
   369     05  WS-AM-ACCOUNT           PIC X(10).
   370     05  WS-AM-EXP-DT            PIC XX.
   371     05  FILLER                  PIC X(4).
   372 01  ws-cm5-compare-key          pic x(12).
   373 01  WS-CM5-KEY.
   374     05  WS-CM5-COMPANY-CD       PIC X.
   375     05  WS-CM5-CERT-NO          PIC X(11).
   376 01  ws-cm-compare-key           pic x(33).
   377 01  WS-CM-KEY.
   378     05  WS-CM-COMPANY-CD        PIC X.
   379     05  WS-CM-CARRIER           PIC X.
   380     05  WS-CM-GROUP             PIC X(6).
   381     05  WS-CM-STATE             PIC XX.
   382     05  WS-CM-ACCOUNT           PIC X(10).
   383     05  WS-CM-EFF-DT            PIC XX.
   384     05  WS-CM-CERT-NO.
   385         10  ws-cm-cert-ten      pic x(10).
   386         10  ws-cm-cert-suffix   pic x.
   387 01  WS-CS-KEY.
   388     05  WS-CS-COMPANY-CD        PIC X.
   389     05  WS-CS-CARRIER           PIC X.
   390     05  WS-CS-GROUP             PIC X(6).
   391     05  WS-CS-STATE             PIC XX.
   392     05  WS-CS-ACCOUNT           PIC X(10).
   393     05  WS-CS-EFF-DT            PIC XX.
   394     05  WS-CS-CERT-NO           PIC X(11).
   395     05  WS-CS-TRLR-TYPE         PIC X.
   396 01  WS-AM-ALT-KEY.
   397     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   398     05  WS-AM-ALT-EXP-DT        PIC XX.
   399 01  WS-CF-KEY-SAVE              PIC X(10).
   400 01  WS-CF-KEY.
   401     05  WS-CF-COMPANY-ID        PIC XXX.
   402     05  WS-CF-RECORD-TYPE       PIC X.
   403     05  WS-CF-ACCESS            PIC X(4).
   404     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   405 01  filler.
   406     05  ws-errors-table.
   407         10  filler              pic x(50) value
   408         '0000Transaction successfully completed'.
   409         10  filler              pic x(50) value
   410         '0101Problem with amounts'.
   411         10  filler              pic x(50) value
   412         '0102Problem with dates'.
   413         10  filler              pic x(50) value
   414         '0103Issue age outside limits'.
   415         10  filler              pic x(50) value
   416         '0104Attained age outside limits'.
   417         10  filler              pic x(50) value
   418         '0105Term is not valid must be gt 0 and lt 361'.
   419         10  filler              pic x(50) value
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   9
* WSMESS01.cbl
   420         '0106Term is outside limits'.
   421         10  filler              pic x(50) value
   422         '0107Amount is outside limits'.
   423         10  filler              pic x(50) value
   424         '0108Loan term must be ge insurance term'.
   425         10  filler              pic x(50) value
   426         '0109Total benefit is outside limits'.
   427         10  filler              pic x(50) value
   428         '0110Rates found were zero'.
   429         10  filler              pic x(50) value
   430         '0111Rate table was not found'.
   431         10  filler              pic x(50) value
   432         '0112Rate file not open'.
   433         10  filler              pic x(50) value
   434         '0113Premium is out of tolerence'.
   435         10  filler              pic x(50) value
   436         '0114Duplicate contract and VIN on Logic'.
   437         10  filler              pic x(50) value
   438         '0115Problem with loan or insurance term'.
   439         10  filler              pic x(50) value
   440         '0116Total of payments incorrect '.
   441     05  filler redefines ws-errors-table occurs 17.
   442         10  ws-table-error-no   pic x(4).
   443         10  ws-table-error-mess pic x(46).
   444 01  ws-return-string.
   445     05  ws-return-error-no      pic x(4).
   446     05  ws-sc1                  pic x.
   447     05  ws-return-error-mess    pic x(46).
   448     05  ws-sc2                  pic x.
   449     05  ws-return-contract-no   pic x(11).
   450     05  ws-sc3                  pic x.
   451     05  ws-return-max-ben       pic z,zzz,z99.99.
   452     05  ws-sc4                  pic x.
   453     05  ws-return-prem          pic z,zzz,z99.99.
   454     05  ws-sc5                  pic x.
   455     05  ws-return-rate          pic z9.99999.
   456     05  ws-sc6                  pic x.
   457     05  ws-return-exp-dt        pic x(10).
   458     05  ws-sc7                  pic x.
   459     05  ws-return-benefit-cd    pic xx.
   460 01  ws-mess001-length           pic s9(4) comp value +1024.
   461 01  WS-MESS001-PASS-AREA        PIC X(1024).
   462 01  WS-CID-NO                   PIC X(8).
   463 01  WS-DISP-RESP                PIC 9(5).
   464 01  WS-RESPONSE                 PIC S9(8)   COMP.
   465     88  RESP-NORMAL                  VALUE +00.
   466     88  RESP-NOTFND                  VALUE +13.
   467     88  resp-duprec                  value +14.
   468     88  resp-dupkey                  value +15.
   469     88  RESP-NOTOPEN                 VALUE +19.
   470     88  RESP-ENDFILE                 VALUE +20.
   471*                                 COPY ERCACCT.
   472******************************************************************
   473*                                                                *
   474*                                                                *
   475*                            ERCACCT                             *
   476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   477*                            VMOD=2.031                          *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  10
* WSMESS01.cbl
   478*                                                                *
   479*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   480*                                                                *
   481*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   482*   VSAM ACCOUNT MASTER FILES.                                   *
   483*                                                                *
   484*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   485*                                                                *
   486*   FILE TYPE = VSAM,KSDS                                        *
   487*   RECORD SIZE = 2000  RECFORM = FIX                            *
   488*                                                                *
   489*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   490*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   491*                                                                *
   492*   LOG = NO                                                     *
   493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   494*                                                                *
   495*                                                                *
   496******************************************************************
   497*                   C H A N G E   L O G
   498*
   499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   500*-----------------------------------------------------------------
   501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   502* EFFECTIVE    NUMBER
   503*-----------------------------------------------------------------
   504* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   505* 092705    2005050300006  PEMA  ADD SPP LEASES
   506* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   507* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   508* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   509* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   510* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   511* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   512******************************************************************
   513
   514 01  ACCOUNT-MASTER.
   515     12  AM-RECORD-ID                      PIC XX.
   516         88  VALID-AM-ID                      VALUE 'AM'.
   517
   518     12  AM-CONTROL-PRIMARY.
   519         16  AM-COMPANY-CD                 PIC X.
   520         16  AM-MSTR-CNTRL.
   521             20  AM-CONTROL-A.
   522                 24  AM-CARRIER            PIC X.
   523                 24  AM-GROUPING.
   524                     28 AM-GROUPING-PREFIX PIC XXX.
   525                     28 AM-GROUPING-PRIME  PIC XXX.
   526                 24  AM-STATE              PIC XX.
   527                 24  AM-ACCOUNT.
   528                     28  AM-ACCOUNT-PREFIX PIC X(4).
   529                     28  AM-ACCOUNT-PRIME  PIC X(6).
   530             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   531                                           PIC X(19).
   532             20  AM-CNTRL-B.
   533                 24  AM-EXPIRATION-DT      PIC XX.
   534                 24  FILLER                PIC X(4).
   535             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  11
* WSMESS01.cbl
   536                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   537
   538     12  AM-CONTROL-BY-VAR-GRP.
   539         16  AM-COMPANY-CD-A1              PIC X.
   540         16  AM-VG-CARRIER                 PIC X.
   541         16  AM-VG-GROUPING                PIC X(6).
   542         16  AM-VG-STATE                   PIC XX.
   543         16  AM-VG-ACCOUNT                 PIC X(10).
   544         16  AM-VG-DATE.
   545             20  AM-VG-EXPIRATION-DT       PIC XX.
   546             20  FILLER                    PIC X(4).
   547         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   548                                           PIC 9(11)      COMP-3.
   549     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   550         16  FILLER                        PIC X(10).
   551         16  AM-VG-KEY3.
   552             20  AM-VG3-ACCOUNT            PIC X(10).
   553             20  AM-VG3-EXP-DT             PIC XX.
   554         16  FILLER                        PIC X(4).
   555     12  AM-MAINT-INFORMATION.
   556         16  AM-LAST-MAINT-DT              PIC XX.
   557         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   558         16  AM-LAST-MAINT-USER            PIC X(4).
   559         16  FILLER                        PIC XX.
   560
   561     12  AM-EFFECTIVE-DT                   PIC XX.
   562     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   563
   564     12  AM-PREV-DATES  COMP-3.
   565         16  AM-PREV-EXP-DT                PIC 9(11).
   566         16  AM-PREV-EFF-DT                PIC 9(11).
   567
   568     12  AM-REPORT-CODE-1                  PIC X(10).
   569     12  AM-REPORT-CODE-2                  PIC X(10).
   570
   571     12  AM-CITY-CODE                      PIC X(4).
   572     12  AM-COUNTY-PARISH                  PIC X(6).
   573
   574     12  AM-NAME                           PIC X(30).
   575     12  AM-PERSON                         PIC X(30).
   576     12  AM-ADDRS                          PIC X(30).
   577     12  AM-CITY.
   578         16  AM-ADDR-CITY                  PIC X(28).
   579         16  AM-ADDR-STATE                 PIC XX.
   580     12  AM-ZIP.
   581         16  AM-ZIP-PRIME.
   582             20  AM-ZIP-PRI-1ST            PIC X.
   583                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   584             20  FILLER                    PIC X(4).
   585         16  AM-ZIP-PLUS4                  PIC X(4).
   586     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   587         16  AM-CAN-POSTAL-1               PIC XXX.
   588         16  AM-CAN-POSTAL-2               PIC XXX.
   589         16  FILLER                        PIC XXX.
   590     12  AM-TEL-NO.
   591         16  AM-AREA-CODE                  PIC 999.
   592         16  AM-TEL-PRE                    PIC 999.
   593         16  AM-TEL-NBR                    PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  12
* WSMESS01.cbl
   594     12  AM-TEL-LOC                        PIC X.
   595         88  AM-TEL-AT-HOME                   VALUE 'H'.
   596         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   597
   598     12  AM-COMM-STRUCTURE.
   599         16  AM-DEFN-1.
   600             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   601                 24  AM-AGT.
   602                     28  AM-AGT-PREFIX     PIC X(4).
   603                     28  AM-AGT-PRIME      PIC X(6).
   604                 24  AM-COM-TYP            PIC X.
   605                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   606                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   607                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   608                 24  AM-RECALC-LV-INDIC    PIC X.
   609                 24  AM-RETRO-LV-INDIC     PIC X.
   610                 24  AM-GL-CODES           PIC X.
   611                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   612                 24  FILLER                PIC X(01).
   613         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   614             20  AM-COM-TBLS        OCCURS 10 TIMES.
   615                 24  FILLER                PIC X(11).
   616                 24  AM-L-COMA             PIC XXX.
   617                 24  AM-J-COMA             PIC XXX.
   618                 24  AM-A-COMA             PIC XXX.
   619                 24  FILLER                PIC X(6).
   620
   621     12  AM-COMM-CHANGE-STATUS             PIC X.
   622         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   623
   624     12  AM-CSR-CODE                       PIC X(4).
   625
   626     12  AM-BILLING-STATUS                 PIC X.
   627         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   628         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   629     12  AM-AUTO-REFUND-SW                 PIC X.
   630         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   631         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   632     12  AM-GPCD                           PIC 99.
   633     12  AM-IG                             PIC X.
   634         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   635         88  AM-HAS-GROUP                     VALUE '2'.
   636     12  AM-STATUS                         PIC X.
   637         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   638         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   639         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   640         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   641         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   642         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   643         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   644         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   645         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   646         88  AM-ACCOUNT-PENDING               VALUE '9'.
   647     12  AM-REMIT-TO                       PIC 99.
   648     12  AM-ID-NO                          PIC X(11).
   649
   650     12  AM-CAL-TABLE                      PIC XX.
   651     12  AM-LF-DEVIATION                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  13
* WSMESS01.cbl
   652     12  AM-AH-DEVIATION                   PIC XXX.
   653     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   654     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   655     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   656     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   657     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   658     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   659
   660     12  AM-USER-FIELDS.
   661         16  AM-FLD-1                      PIC XX.
   662         16  AM-FLD-2                      PIC XX.
   663         16  AM-FLD-3                      PIC XX.
   664         16  AM-FLD-4                      PIC XX.
   665         16  AM-FLD-5                      PIC XX.
   666
   667     12  AM-1ST-PROD-DATE.
   668         16  AM-1ST-PROD-YR                PIC XX.
   669         16  AM-1ST-PROD-MO                PIC XX.
   670         16  AM-1ST-PROD-DA                PIC XX.
   671     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   672     12  AM-CERTS-PURGED-DATE.
   673         16  AM-PUR-YR                     PIC XX.
   674         16  AM-PUR-MO                     PIC XX.
   675         16  AM-PUR-DA                     PIC XX.
   676     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   677     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   678     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   679     12  AM-INACTIVE-DATE.
   680         16  AM-INA-MO                     PIC 99.
   681         16  AM-INA-DA                     PIC 99.
   682         16  AM-INA-YR                     PIC 99.
   683     12  AM-AR-HI-CERT-DATE                PIC XX.
   684
   685     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   686     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   687
   688     12  AM-OB-PAYMENT-MODE                PIC X.
   689         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   690         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   691         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   692         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   693
   694     12  AM-AH-ONLY-INDICATOR              PIC X.
   695         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   696         88  AM-NO-AH-ONLY                    VALUE 'N'.
   697
   698     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   699
   700     12  AM-OVER-SHORT.
   701         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   702         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   703
   704     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   705     12  AM-DCC-CLP-STATE                  PIC XX.
   706
   707     12  AM-RECALC-COMM                    PIC X.
   708     12  AM-RECALC-REIN                    PIC X.
   709
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  14
* WSMESS01.cbl
   710     12  AM-REI-TABLE                      PIC XXX.
   711     12  AM-REI-ET-LF                      PIC X.
   712     12  AM-REI-ET-AH                      PIC X.
   713     12  AM-REI-PE-LF                      PIC X.
   714     12  AM-REI-PE-AH                      PIC X.
   715     12  AM-REI-PRT-ST                     PIC X.
   716     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   717     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   718     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   719     12  AM-REI-GROUP-A                    PIC X(6).
   720     12  AM-REI-MORT                       PIC X(4).
   721     12  AM-REI-PRT-OW                     PIC X.
   722     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   723     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   724     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   725     12  AM-REI-GROUP-B                    PIC X(6).
   726
   727     12  AM-TRUST-TYPE                     PIC X(2).
   728
   729     12  AM-EMPLOYER-STMT-USED             PIC X.
   730     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   731
   732     12  AM-STD-AH-TYPE                    PIC XX.
   733     12  AM-EARN-METHODS.
   734         16  AM-EARN-METHOD-R              PIC X.
   735             88 AM-REF-RL-R78                 VALUE 'R'.
   736             88 AM-REF-RL-PR                  VALUE 'P'.
   737             88 AM-REF-RL-MEAN                VALUE 'M'.
   738             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   739         16  AM-EARN-METHOD-L              PIC X.
   740             88 AM-REF-LL-R78                 VALUE 'R'.
   741             88 AM-REF-LL-PR                  VALUE 'P'.
   742             88 AM-REF-LL-MEAN                VALUE 'M'.
   743             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   744         16  AM-EARN-METHOD-A              PIC X.
   745             88 AM-REF-AH-R78                 VALUE 'R'.
   746             88 AM-REF-AH-PR                  VALUE 'P'.
   747             88 AM-REF-AH-MEAN                VALUE 'M'.
   748             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   749             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   750             88 AM-REF-AH-NET                 VALUE 'N'.
   751
   752     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   753     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   754     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   755
   756     12  AM-RET-Y-N                        PIC X.
   757     12  AM-RET-P-E                        PIC X.
   758     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   759     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   760     12  AM-RET-GRP                        PIC X(6).
   761     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   762         16  AM-POOL-PRIME                 PIC XXX.
   763         16  AM-POOL-SUB                   PIC XXX.
   764     12  AM-RETRO-EARNINGS.
   765         16  AM-RET-EARN-R                 PIC X.
   766         16  AM-RET-EARN-L                 PIC X.
   767         16  AM-RET-EARN-A                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  15
* WSMESS01.cbl
   768     12  AM-RET-ST-TAX-USE                 PIC X.
   769         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   770         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   771     12  AM-RETRO-BEG-EARNINGS.
   772         16  AM-RET-BEG-EARN-R             PIC X.
   773         16  AM-RET-BEG-EARN-L             PIC X.
   774         16  AM-RET-BEG-EARN-A             PIC X.
   775     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   776     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   777
   778     12  AM-USER-SELECT-OPTIONS.
   779         16  AM-USER-SELECT-1              PIC X(10).
   780         16  AM-USER-SELECT-2              PIC X(10).
   781         16  AM-USER-SELECT-3              PIC X(10).
   782         16  AM-USER-SELECT-4              PIC X(10).
   783         16  AM-USER-SELECT-5              PIC X(10).
   784
   785     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   786
   787     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   788
   789     12  AM-RPT045A-SWITCH                 PIC X.
   790         88  RPT045A-OFF                   VALUE 'N'.
   791
   792     12  AM-INSURANCE-LIMITS.
   793         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   794         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   795
   796     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   797         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   798
   799     12  AM-DISMBR-COVERAGE-SW             PIC X.
   800         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   801         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   802
   803     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   804
   805     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   806     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   807     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   808     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   809     12  AM-DCC-UEF-STATE                  PIC XX.
   810     12  FILLER                            PIC XXX.
   811     12  AM-REPORT-CODE-3                  PIC X(10).
   812*    12  FILLER                            PIC X(22).
   813
   814     12  AM-RESERVE-DATE.
   815         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   816         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   817         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   818
   819     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   820     12  AM-NOTIFICATION-TYPES.
   821         16  AM-NOTIF-OF-LETTERS           PIC X.
   822         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   823         16  AM-NOTIF-OF-REPORTS           PIC X.
   824         16  AM-NOTIF-OF-STATUS            PIC X.
   825
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  16
* WSMESS01.cbl
   826     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   827         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   828         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   829         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   830         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   831
   832     12  AM-BENEFIT-CONTROLS.
   833         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   834             20  AM-BENEFIT-CODE           PIC XX.
   835             20  AM-BENEFIT-TYPE           PIC X.
   836             20  AM-BENEFIT-REVISION       PIC XXX.
   837             20  AM-BENEFIT-REM-TERM       PIC X.
   838             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   839             20  FILLER                    PIC XX.
   840         16  FILLER                        PIC X(80).
   841
   842     12  AM-TRANSFER-DATA.
   843         16  AM-TRANSFERRED-FROM.
   844             20  AM-TRNFROM-CARRIER        PIC X.
   845             20  AM-TRNFROM-GROUPING.
   846                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   847                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   848             20  AM-TRNFROM-STATE          PIC XX.
   849             20  AM-TRNFROM-ACCOUNT.
   850                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   851                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   852             20  AM-TRNFROM-DTE            PIC XX.
   853         16  AM-TRANSFERRED-TO.
   854             20  AM-TRNTO-CARRIER          PIC X.
   855             20  AM-TRNTO-GROUPING.
   856                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   857                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   858             20  AM-TRNTO-STATE            PIC XX.
   859             20  AM-TRNTO-ACCOUNT.
   860                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   861                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   862             20  AM-TRNTO-DTE              PIC XX.
   863         16  FILLER                        PIC X(10).
   864
   865     12  AM-SAVED-REMIT-TO                 PIC 99.
   866
   867     12  AM-COMM-STRUCTURE-SAVED.
   868         16  AM-DEFN-1-SAVED.
   869             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   870                 24  AM-AGT-SV             PIC X(10).
   871                 24  AM-COM-TYP-SV         PIC X.
   872                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   873                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   874                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   875                 24  AM-RECALC-LV-INDIC-SV PIC X.
   876                 24  FILLER                PIC X.
   877                 24  AM-GL-CODES-SV        PIC X.
   878                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   879                 24  FILLER                PIC X.
   880         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   881             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   882                 24  FILLER                PIC X(11).
   883                 24  AM-L-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  17
* WSMESS01.cbl
   884                 24  AM-J-COMA-SV          PIC XXX.
   885                 24  AM-A-COMA-SV          PIC XXX.
   886                 24  FILLER                PIC X(6).
   887
   888     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   889         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   890            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   891            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   892            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   893
   894     12  AM-ORIG-DEALER-NO                 PIC X(10).
   895     12  FILLER                            PIC X(120).
   896
   897     12  AM-ACCOUNT-EXECUTIVE-DATA.
   898         16  AM-CONTROL-NAME               PIC X(30).
   899         16  AM-EXECUTIVE-ONE.
   900             20  AM-EXEC1-NAME             PIC X(15).
   901             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   902                                                          COMP-3.
   903             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   904                                                          COMP-3.
   905         16  AM-EXECUTIVE-TWO.
   906             20  AM-EXEC2-NAME             PIC X(15).
   907             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   908                                                          COMP-3.
   909             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   910                                                          COMP-3.
   911
   912     12  AM-RETRO-ADDITIONAL-DATA.
   913         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   914         16  AM-RETRO-PREM-P-E             PIC X.
   915         16  AM-RETRO-CLMS-P-I             PIC X.
   916         16  AM-RETRO-RET-BRACKET-LF.
   917             20  AM-RETRO-RET-METHOD-LF    PIC X.
   918                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   919                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   920             20  AM-RETRO-RET-BASIS-LF     PIC X.
   921                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   922                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   923             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   924                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   925                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   926         16  AM-RETRO-RET-BRACKET-AH.
   927             20  AM-RETRO-RET-METHOD-AH    PIC X.
   928                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   929                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   930                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   931             20  AM-RETRO-RET-BASIS-AH     PIC X.
   932                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   933                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   934             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   935                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   936                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   937
   938     12  AM-COMMENTS.
   939         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   940
   941     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  18
* WSMESS01.cbl
   942         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   943         16  AM-FLI-BILLING-CODE           PIC X.
   944         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   945         16  AM-FLI-UNITED-IDENT           PIC X.
   946         16  AM-FLI-INTEREST-LOST-DATA.
   947             20  AM-FLI-BANK-NO            PIC X(5).
   948             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   949             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   950             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   951         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   952             20  AM-FLI-AGT                PIC X(9).
   953             20  AM-FLI-AGT-COMM-ACC       PIC X.
   954             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   955         16  FILLER                        PIC X(102).
   956
   957     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   958         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   959             20  AM-BENEFIT-DMD-CODE         PIC XX.
   960             20  AM-BENEFIT-DMD-TYPE         PIC X.
   961             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   962             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   963             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   964         16  FILLER                          PIC X(10).
   965******************************************************************
   966*                                 COPY ELCCERT.
   967******************************************************************
   968*                                                                *
   969*                            ELCCERT.                            *
   970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   971*                            VMOD=2.013                          *
   972*                                                                *
   973*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   974*                                                                *
   975*   FILE TYPE = VSAM,KSDS                                        *
   976*   RECORD SIZE = 450  RECFORM = FIXED                           *
   977*                                                                *
   978*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   979*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   980*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   981*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   982*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   983*                                                                *
   984*   LOG = YES                                                    *
   985*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   986******************************************************************
   987*                   C H A N G E   L O G
   988*
   989* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   990*-----------------------------------------------------------------
   991*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   992* EFFECTIVE    NUMBER
   993*-----------------------------------------------------------------
   994* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   995* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   996* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   997* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   998* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   999* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  19
* WSMESS01.cbl
  1000* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1001* 032612  CR2011110200001  PEMA  AHL CHANGES
  1002* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1003* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1004******************************************************************
  1005
  1006 01  CERTIFICATE-MASTER.
  1007     12  CM-RECORD-ID                      PIC XX.
  1008         88  VALID-CM-ID                      VALUE 'CM'.
  1009
  1010     12  CM-CONTROL-PRIMARY.
  1011         16  CM-COMPANY-CD                 PIC X.
  1012         16  CM-CARRIER                    PIC X.
  1013         16  CM-GROUPING.
  1014             20  CM-GROUPING-PREFIX        PIC X(3).
  1015             20  CM-GROUPING-PRIME         PIC X(3).
  1016         16  CM-STATE                      PIC XX.
  1017         16  CM-ACCOUNT.
  1018             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1019             20  CM-ACCOUNT-PRIME          PIC X(6).
  1020         16  CM-CERT-EFF-DT                PIC XX.
  1021         16  CM-CERT-NO.
  1022             20  CM-CERT-PRIME             PIC X(10).
  1023             20  CM-CERT-SFX               PIC X.
  1024
  1025     12  CM-CONTROL-BY-NAME.
  1026         16  CM-COMPANY-CD-A1              PIC X.
  1027         16  CM-INSURED-LAST-NAME          PIC X(15).
  1028         16  CM-INSURED-INITIALS.
  1029             20  CM-INSURED-INITIAL1       PIC X.
  1030             20  CM-INSURED-INITIAL2       PIC X.
  1031
  1032     12  CM-CONTROL-BY-SSN.
  1033         16  CM-COMPANY-CD-A2              PIC X.
  1034         16  CM-SOC-SEC-NO.
  1035             20  CM-SSN-STATE              PIC XX.
  1036             20  CM-SSN-ACCOUNT            PIC X(6).
  1037             20  CM-SSN-LN3.
  1038                 25  CM-INSURED-INITIALS-A2.
  1039                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1040                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1041                 25 CM-PART-LAST-NAME-A2         PIC X.
  1042
  1043     12  CM-CONTROL-BY-CERT-NO.
  1044         16  CM-COMPANY-CD-A4              PIC X.
  1045         16  CM-CERT-NO-A4                 PIC X(11).
  1046
  1047     12  CM-CONTROL-BY-MEMB.
  1048         16  CM-COMPANY-CD-A5              PIC X.
  1049         16  CM-MEMBER-NO.
  1050             20  CM-MEMB-STATE             PIC XX.
  1051             20  CM-MEMB-ACCOUNT           PIC X(6).
  1052             20  CM-MEMB-LN4.
  1053                 25  CM-INSURED-INITIALS-A5.
  1054                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1055                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1056                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1057
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  20
* WSMESS01.cbl
  1058     12  CM-INSURED-PROFILE-DATA.
  1059         16  CM-INSURED-FIRST-NAME.
  1060             20  CM-INSURED-1ST-INIT       PIC X.
  1061             20  FILLER                    PIC X(9).
  1062         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1063         16  CM-INSURED-SEX                PIC X.
  1064             88  CM-SEX-MALE                  VALUE 'M'.
  1065             88  CM-SEX-FEMAL                 VALUE 'F'.
  1066         16  CM-INSURED-JOINT-AGE          PIC 99.
  1067         16  CM-JOINT-INSURED-NAME.
  1068             20  CM-JT-LAST-NAME           PIC X(15).
  1069             20  CM-JT-FIRST-NAME.
  1070                 24  CM-JT-1ST-INIT        PIC X.
  1071                 24  FILLER                PIC X(9).
  1072             20  CM-JT-INITIAL             PIC X.
  1073
  1074     12  CM-LIFE-DATA.
  1075         16  CM-LF-BENEFIT-CD              PIC XX.
  1076         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1077         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1078         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1079         16  CM-LF-DEV-CODE                PIC XXX.
  1080         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1081         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1082         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1083         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1084         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1085         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1086         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1087         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1088         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1089         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1090         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1091         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1092         16  cm-temp-epiq                  pic xx.
  1093             88  EPIQ-CLASS                  value 'EQ'.
  1094*        16  FILLER                        PIC XX.
  1095
  1096     12  CM-AH-DATA.
  1097         16  CM-AH-BENEFIT-CD              PIC XX.
  1098         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1099         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1100         16  CM-AH-DEV-CODE                PIC XXX.
  1101         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1102         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1103         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1104         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1105         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1106         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1107         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1108         16  CM-AH-PAID-THRU-DT            PIC XX.
  1109             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1110         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1111         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1112         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1113         16  FILLER                        PIC X.
  1114
  1115     12  CM-LOAN-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  21
* WSMESS01.cbl
  1116         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1117         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1118                                           PIC S9(5)V99  COMP-3.
  1119         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1120         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1121         16  CM-PAY-FREQUENCY              PIC S99.
  1122         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1123         16  CM-RATE-CLASS                 PIC XX.
  1124         16  CM-BENEFICIARY                PIC X(25).
  1125         16  CM-POLICY-FORM-NO             PIC X(12).
  1126         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1127         16  CM-LAST-ADD-ON-DT             PIC XX.
  1128         16  CM-DEDUCTIBLE-AMOUNTS.
  1129             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1130             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1131         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1132             20  CM-RESIDENT-STATE         PIC XX.
  1133             20  CM-RATE-CODE              PIC X(4).
  1134             20  FILLER                    PIC XX.
  1135         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1136             20  CM-LOAN-OFFICER           PIC X(5).
  1137             20  FILLER                    PIC XXX.
  1138         16  CM-CSR-CODE                   PIC XXX.
  1139         16  CM-UNDERWRITING-CODE          PIC X.
  1140             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1141         16  CM-POST-CARD-IND              PIC X.
  1142         16  CM-NH-INTERFACE-SW            PIC X.
  1143         16  CM-PREMIUM-TYPE               PIC X.
  1144             88  CM-SING-PRM                  VALUE '1'.
  1145             88  CM-O-B-COVERAGE              VALUE '2'.
  1146             88  CM-OPEN-END                  VALUE '3'.
  1147         16  CM-IND-GRP-TYPE               PIC X.
  1148             88  CM-INDIVIDUAL                VALUE 'I'.
  1149             88  CM-GROUP                     VALUE 'G'.
  1150         16  CM-SKIP-CODE                  PIC X.
  1151             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1152             88  SKIP-JULY                    VALUE '1'.
  1153             88  SKIP-AUGUST                  VALUE '2'.
  1154             88  SKIP-SEPTEMBER               VALUE '3'.
  1155             88  SKIP-JULY-AUG                VALUE '4'.
  1156             88  SKIP-AUG-SEPT                VALUE '5'.
  1157             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1158             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1159             88  SKIP-JUNE                    VALUE '8'.
  1160             88  SKIP-JUNE-JULY               VALUE '9'.
  1161             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1162             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1163         16  CM-PAYMENT-MODE               PIC X.
  1164             88  PAY-MONTHLY                  VALUE SPACE.
  1165             88  PAY-WEEKLY                   VALUE '1'.
  1166             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1167             88  PAY-BI-WEEKLY                VALUE '3'.
  1168             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1169         16  CM-LOAN-NUMBER                PIC X(8).
  1170         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1171         16  CM-OLD-LOF                    PIC XXX.
  1172*        16  CM-LOAN-OFFICER               PIC XXX.
  1173         16  CM-REIN-TABLE                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  22
* WSMESS01.cbl
  1174         16  CM-SPECIAL-REIN-CODE          PIC X.
  1175         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1176         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1177         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1178
  1179     12  CM-STATUS-DATA.
  1180         16  CM-ENTRY-STATUS               PIC X.
  1181         16  CM-ENTRY-DT                   PIC XX.
  1182
  1183         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1184         16  CM-LF-CANCEL-DT               PIC XX.
  1185         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1186
  1187         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1188         16  CM-LF-DEATH-DT                PIC XX.
  1189         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1190
  1191         16  CM-LF-CURRENT-STATUS          PIC X.
  1192             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1193                                                'M' '4' '5' '9'.
  1194             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1195             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1196             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1197             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1198             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1199             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1200             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1201             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1202             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1203             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1204             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1205             88  CM-LF-DECLINED               VALUE 'D'.
  1206             88  CM-LF-VOIDED                 VALUE 'V'.
  1207
  1208         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1209         16  CM-AH-CANCEL-DT               PIC XX.
  1210         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1211
  1212         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1213         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1214         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1215
  1216         16  CM-AH-CURRENT-STATUS          PIC X.
  1217             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1218                                                'M' '4' '5' '9'.
  1219             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1220             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1221             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1222             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1223             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1224             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1225             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1226             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1227             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1228             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1229             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1230             88  CM-AH-DECLINED               VALUE 'D'.
  1231             88  CM-AH-VOIDED                 VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  23
* WSMESS01.cbl
  1232
  1233         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1234             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1235             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1236             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1237         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1238
  1239         16  CM-ENTRY-BATCH                PIC X(6).
  1240         16  CM-LF-EXIT-BATCH              PIC X(6).
  1241         16  CM-AH-EXIT-BATCH              PIC X(6).
  1242         16  CM-LAST-MONTH-END             PIC XX.
  1243
  1244     12  CM-NOTE-SW                        PIC X.
  1245         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1246         88  CERT-NOTES-PRESENT               VALUE '1'.
  1247         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1248         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1249         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1250         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1251         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1252         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1253     12  CM-COMP-EXCP-SW                   PIC X.
  1254         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1255         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1256     12  CM-INSURED-ADDRESS-SW             PIC X.
  1257         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1258         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1259
  1260*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1261     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1262     12  FILLER                            PIC X.
  1263
  1264*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1265     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1266     12  FILLER                            PIC X.
  1267*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1268     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1269
  1270     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1271         88  CERT-ADDED-BATCH                 VALUE ' '.
  1272         88  CERT-ADDED-ONLINE                VALUE '1'.
  1273         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1274         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1275         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1276     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1277         88  CERT-AS-LOADED                   VALUE ' '.
  1278         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1279         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1280         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1281         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1282         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1283         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1284         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1285
  1286     12  CM-ACCOUNT-COMM-PCTS.
  1287         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1288         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1289
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  24
* WSMESS01.cbl
  1290     12  CM-USER-FIELD                     PIC X.
  1291     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1292     12  CM-CLP-STATE                      PIC XX.
  1293     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1294     12  CM-USER-RESERVED                  PIC XXX.
  1295     12  FILLER REDEFINES CM-USER-RESERVED.
  1296         16  CM-AH-CLASS-CD                PIC XX.
  1297         16  F                             PIC X.
  1298******************************************************************
  1299*                                 COPY ELCCRTT.
  1300******************************************************************
  1301*                                                                *
  1302*                            ELCCRTT.                            *
  1303*                                                                *
  1304*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1305*                                                                *
  1306*   FILE TYPE = VSAM,KSDS                                        *
  1307*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1308*                                                                *
  1309*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1310*                                                                *
  1311*   LOG = YES                                                    *
  1312*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1313******************************************************************
  1314*                   C H A N G E   L O G
  1315*
  1316* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1317*-----------------------------------------------------------------
  1318*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1319* EFFECTIVE    NUMBER
  1320*-----------------------------------------------------------------
  1321* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1322* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1323* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1324* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1325* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1326* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1327* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1328* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1329* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1330******************************************************************
  1331
  1332 01  CERTIFICATE-TRAILERS.
  1333     12  CS-RECORD-ID                      PIC XX.
  1334         88  VALID-CS-ID                      VALUE 'CS'.
  1335
  1336     12  CS-CONTROL-PRIMARY.
  1337         16  CS-COMPANY-CD                 PIC X.
  1338         16  CS-CARRIER                    PIC X.
  1339         16  CS-GROUPING                   PIC X(6).
  1340         16  CS-STATE                      PIC XX.
  1341         16  CS-ACCOUNT                    PIC X(10).
  1342         16  CS-CERT-EFF-DT                PIC XX.
  1343         16  CS-CERT-NO.
  1344             20  CS-CERT-PRIME             PIC X(10).
  1345             20  CS-CERT-SFX               PIC X.
  1346         16  CS-TRAILER-TYPE               PIC X.
  1347             88  COMM-TRLR           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  25
* WSMESS01.cbl
  1348             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1349             88  CERT-DATA-TRLR      VALUE 'C'.
  1350
  1351     12  CS-DATA-AREA                      PIC X(516).
  1352
  1353     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1354         16  CS-BANK-COMMISSION-AREA.
  1355             20  CS-BANK-COMMS       OCCURS 10.
  1356                 24  CS-AGT                PIC X(10).
  1357                 24  CS-COM-TYP            PIC X.
  1358                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1359                 24  CS-RECALC-LV-INDIC    PIC X.
  1360                 24  FILLER                PIC X(10).
  1361         16  FILLER                        PIC X(256).
  1362
  1363     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1364****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1365         16  CS-MB-CLAIM-DATA OCCURS 24.
  1366             20  CS-CLAIM-NO               PIC X(7).
  1367             20  CS-CLAIM-TYPE             PIC X.
  1368                 88  CS-AH-CLM               VALUE 'A'.
  1369                 88  CS-IU-CLM               VALUE 'I'.
  1370                 88  CS-GP-CLM               VALUE 'G'.
  1371                 88  CS-LF-CLM               VALUE 'L'.
  1372                 88  CS-PR-CLM               VALUE 'P'.
  1373                 88  CS-FL-CLM               VALUE 'F'.
  1374             20  CS-INSURED-TYPE           PIC X.
  1375                 88  CS-PRIM-INSURED          VALUE 'P'.
  1376                 88  CS-CO-BORROWER           VALUE 'C'.
  1377             20  CS-BENEFIT-PERIOD         PIC 99.
  1378             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1379             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1380             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1381         16  FILLER                        PIC X(12).
  1382     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1383         16  CS-VIN-NUMBER                 PIC X(17).
  1384         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1385         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1386         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1387         16  cs-agent-name.
  1388             20  cs-agent-fname            pic x(20).
  1389             20  cs-agent-mi               pic x.
  1390             20  cs-agent-lname            pic x(25).
  1391         16  cs-license-no                 pic x(15).
  1392         16  cs-npn-number                 pic x(10).
  1393         16  cs-agent-edit-status          pic x.
  1394             88  cs-ae-refer-to-manager      value 'M'.
  1395             88  cs-ae-cover-sheet           value 'C'.
  1396             88  cs-ae-sig-form              value 'S'.
  1397             88  cs-ae-verified              value 'V'.
  1398             88  cs-unidentified-signature   value 'U'.
  1399             88  cs-cert-returned            value 'R'.
  1400             88  cs-accept-no-commission     value 'N'.
  1401         16  cs-year                       pic 9999.
  1402         16  cs-make                       pic x(20).
  1403         16  cs-model                      pic x(20).
  1404         16  cs-future                     pic x(20).
  1405         16  cs-vehicle-odometer           pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  26
* WSMESS01.cbl
  1406         16  FILLER                        PIC X(356). *> was 420
  1407*        16  FILLER                        PIC X(496).
  1408*                                 COPY ELCCNTL.
  1409******************************************************************
  1410*                                                                *
  1411*                                                                *
  1412*                            ELCCNTL.                            *
  1413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1414*                            VMOD=2.059                          *
  1415*                                                                *
  1416*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1417*                                                                *
  1418*   FILE TYPE = VSAM,KSDS                                        *
  1419*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1420*                                                                *
  1421*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1422*       ALTERNATE INDEX = NONE                                   *
  1423*                                                                *
  1424*   LOG = YES                                                    *
  1425*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1426******************************************************************
  1427*                   C H A N G E   L O G
  1428*
  1429* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1430*-----------------------------------------------------------------
  1431*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1432* EFFECTIVE    NUMBER
  1433*-----------------------------------------------------------------
  1434* 082503                   PEMA  ADD BENEFIT GROUP
  1435* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1436* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1437* 092705    2005050300006  PEMA  ADD SPP LEASES
  1438* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1439* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1440* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1441* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1442* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1443* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1444* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1445* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1446* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1447* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1448******************************************************************
  1449*
  1450 01  CONTROL-FILE.
  1451     12  CF-RECORD-ID                       PIC XX.
  1452         88  VALID-CF-ID                        VALUE 'CF'.
  1453
  1454     12  CF-CONTROL-PRIMARY.
  1455         16  CF-COMPANY-ID                  PIC XXX.
  1456         16  CF-RECORD-TYPE                 PIC X.
  1457             88  CF-COMPANY-MASTER              VALUE '1'.
  1458             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1459             88  CF-STATE-MASTER                VALUE '3'.
  1460             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1461             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1462             88  CF-CARRIER-MASTER              VALUE '6'.
  1463             88  CF-MORTALITY-MASTER            VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  27
* WSMESS01.cbl
  1464             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1465             88  CF-TERMINAL-MASTER             VALUE '9'.
  1466             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1467             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1468             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1469             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1470             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1471             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1472             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1473             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1474             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1475         16  CF-ACCESS-CD-GENL              PIC X(4).
  1476         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1477             20  CF-PROCESSOR               PIC X(4).
  1478         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1479             20  CF-STATE-CODE              PIC XX.
  1480             20  FILLER                     PIC XX.
  1481         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1482             20  FILLER                     PIC XX.
  1483             20  CF-HI-BEN-IN-REC           PIC XX.
  1484         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1485             20  FILLER                     PIC XXX.
  1486             20  CF-CARRIER-CNTL            PIC X.
  1487         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1488             20  FILLER                     PIC XX.
  1489             20  CF-HI-TYPE-IN-REC          PIC 99.
  1490         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1491             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1492                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1493             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1494             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1495         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1496             20  FILLER                     PIC X.
  1497             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1498         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1499             20  FILLER                     PIC XX.
  1500             20  CF-MORTGAGE-PLAN           PIC XX.
  1501         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1502
  1503     12  CF-LAST-MAINT-DT                   PIC XX.
  1504     12  CF-LAST-MAINT-BY                   PIC X(4).
  1505     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1506
  1507     12  CF-RECORD-BODY                     PIC X(728).
  1508
  1509
  1510****************************************************************
  1511*             COMPANY MASTER RECORD                            *
  1512****************************************************************
  1513
  1514     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1515         16  CF-COMPANY-ADDRESS.
  1516             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1517             20  CF-CL-IN-CARE-OF           PIC X(30).
  1518             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1519             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1520             20  CF-CL-CITY-STATE           PIC X(30).
  1521             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  28
* WSMESS01.cbl
  1522             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1523         16  CF-COMPANY-CD                  PIC X.
  1524         16  CF-COMPANY-PASSWORD            PIC X(8).
  1525         16  CF-SECURITY-OPTION             PIC X.
  1526             88  ALL-SECURITY                   VALUE '1'.
  1527             88  COMPANY-VERIFY                 VALUE '2'.
  1528             88  PROCESSOR-VERIFY               VALUE '3'.
  1529             88  NO-SECURITY                    VALUE '4'.
  1530             88  ALL-BUT-TERM                   VALUE '5'.
  1531         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1532             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1533         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1534             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1535         16  CF-INFORCE-LOCATION            PIC X.
  1536             88  CERTS-ARE-ONLINE               VALUE '1'.
  1537             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1538             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1539         16  CF-LOWER-CASE-LETTERS          PIC X.
  1540         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1541             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1542             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1543             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1544             88  CF-ACCNT-CNTL                  VALUE '3'.
  1545             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1546
  1547         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1548         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1549
  1550         16  CF-LGX-CREDIT-USER             PIC X.
  1551             88  CO-IS-NOT-USER                 VALUE 'N'.
  1552             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1553
  1554         16 CF-CREDIT-CALC-CODES.
  1555             20  CF-CR-REM-TERM-CALC PIC X.
  1556               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1557               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1558               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1559               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1560               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1561               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1562               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1563             20  CF-CR-R78-METHOD           PIC X.
  1564               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1565               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1566
  1567         16  CF-CLAIM-CONTROL-COUNTS.
  1568             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1569                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1570
  1571             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1572                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1573
  1574             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1575                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1576
  1577             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1578                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1579
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  29
* WSMESS01.cbl
  1580         16  CF-CURRENT-MONTH-END           PIC XX.
  1581
  1582         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1583             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1584             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1585             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1586             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1587                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1588                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1589             20  CF-CO-PREM-REJECT-SW       PIC X.
  1590                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1591                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1592             20  CF-CO-REF-REJECT-SW        PIC X.
  1593                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1594                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1595
  1596         16  CF-CO-REPORTING-DT             PIC XX.
  1597         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1598         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1599           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1600           88  CF-CO-MONTH-END                  VALUE '1'.
  1601
  1602         16  CF-LGX-CLAIM-USER              PIC X.
  1603             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1604             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1605
  1606         16  CF-CREDIT-EDIT-CONTROLS.
  1607             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1608             20  CF-MIN-AGE                 PIC 99.
  1609             20  CF-DEFAULT-AGE             PIC 99.
  1610             20  CF-MIN-TERM                PIC S999      COMP-3.
  1611             20  CF-MAX-TERM                PIC S999      COMP-3.
  1612             20  CF-DEFAULT-SEX             PIC X.
  1613             20  CF-JOINT-AGE-INPUT         PIC X.
  1614                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1615             20  CF-BIRTH-DATE-INPUT        PIC X.
  1616                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1617             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1618                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1619                 88  CF-ZERO-CARRIER            VALUE '1'.
  1620                 88  CF-ZERO-GROUPING           VALUE '2'.
  1621                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1622             20  CF-EDIT-SW                 PIC X.
  1623                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1624             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1625             20  CF-CR-PR-METHOD            PIC X.
  1626               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1627               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1628             20  FILLER                     PIC X.
  1629
  1630         16  CF-CREDIT-MISC-CONTROLS.
  1631             20  CF-REIN-TABLE-SW           PIC X.
  1632                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1633             20  CF-COMP-TABLE-SW           PIC X.
  1634                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1635             20  CF-EXPERIENCE-RETENTION-AGE
  1636                                            PIC S9        COMP-3.
  1637             20  CF-CONVERSION-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  30
* WSMESS01.cbl
  1638             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1639             20  CF-RUN-FREQUENCY-SW        PIC X.
  1640                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1641                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1642
  1643             20  CF-CR-CHECK-NO-CONTROL.
  1644                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1645                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1646                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1647                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1648                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1649                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1650
  1651                 24  CF-CR-CHECK-COUNT       REDEFINES
  1652                     CF-CR-CHECK-COUNTER      PIC X(4).
  1653
  1654                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1655                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1656
  1657                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1658                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1659                 24  CF-MAIL-PROCESSING       PIC X.
  1660                     88  MAIL-PROCESSING          VALUE 'Y'.
  1661
  1662         16  CF-MISC-SYSTEM-CONTROL.
  1663             20  CF-SYSTEM-C                 PIC X.
  1664                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1665             20  CF-SYSTEM-D                 PIC X.
  1666                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1667             20  CF-SOC-SEC-NO-SW            PIC X.
  1668                 88  SOC-SEC-NO-USED             VALUE '1'.
  1669             20  CF-MEMBER-NO-SW             PIC X.
  1670                 88  MEMBER-NO-USED              VALUE '1'.
  1671             20  CF-TAX-ID-NUMBER            PIC X(11).
  1672             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1673             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1674                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1675                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1676                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1677                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1678             20  CF-SYSTEM-E                 PIC X.
  1679                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1680
  1681         16  CF-LGX-LIFE-USER               PIC X.
  1682             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1683             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1684
  1685         16  CF-CR-MONTH-END-DT             PIC XX.
  1686
  1687         16  CF-FILE-MAINT-DATES.
  1688             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1689                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1690             20  CF-LAST-BATCH       REDEFINES
  1691                 CF-LAST-BATCH-NO               PIC X(4).
  1692             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1693             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1694             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1695             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  31
* WSMESS01.cbl
  1696             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1697             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1698             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1699             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1700             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1701             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1702
  1703         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1704         16  FILLER                         PIC X.
  1705
  1706         16  CF-ALT-MORT-CODE               PIC X(4).
  1707         16  CF-MEMBER-CAPTION              PIC X(10).
  1708
  1709         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1710             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1711             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1712             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1713             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1714             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1715
  1716         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1717
  1718         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1719         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1720         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1721         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1722
  1723         16  CF-AH-OVERRIDE-L1              PIC X.
  1724         16  CF-AH-OVERRIDE-L2              PIC XX.
  1725         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1726         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1727
  1728         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1729         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1730
  1731         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1732         16  CF-AR-LAST-EL860-DT            PIC XX.
  1733         16  CF-MP-MONTH-END-DT             PIC XX.
  1734
  1735         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1736         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1737             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1738
  1739         16  CF-AR-MONTH-END-DT             PIC XX.
  1740
  1741         16  CF-CRDTCRD-USER                PIC X.
  1742             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1743             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1744
  1745         16  CF-CC-MONTH-END-DT             PIC XX.
  1746
  1747         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1748
  1749         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1750             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1751             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1752             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1753         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  32
* WSMESS01.cbl
  1754         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1755         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1756         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1757             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1758             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1759         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1760         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1761         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1762             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1763         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1764
  1765         16  CF-CL-ZIP-CODE.
  1766             20  CF-CL-ZIP-PRIME.
  1767                 24  CF-CL-ZIP-1ST          PIC X.
  1768                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1769                 24  FILLER                 PIC X(4).
  1770             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1771         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1772             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1773             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1774             20  FILLER                     PIC XXX.
  1775
  1776         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1777         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1778         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1779         16  CF-CO-OPTION-START-DATE        PIC XX.
  1780         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1781           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1782                                                      '3' '4'.
  1783           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1784           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1785           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1786           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1787           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1788           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1789
  1790         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1791
  1792         16  CF-PAYMENT-APPROVAL-LEVELS.
  1793             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1794             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1795             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1796             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1797             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1798             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1799
  1800         16  CF-END-USER-REPORTING-USER     PIC X.
  1801             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1802             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1803
  1804         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1805             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1806             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1807
  1808         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1809
  1810         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1811         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  33
* WSMESS01.cbl
  1812
  1813         16  CF-CREDIT-ARCHIVE-CNTL.
  1814             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1815             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1816             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1817
  1818         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1819
  1820         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1821             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1822             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1823
  1824         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1825             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1826             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1827
  1828         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1829
  1830         16  CF-CO-ACH-ID-CODE              PIC  X.
  1831             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1832             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1833             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1834         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1835         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1836         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1837         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1838         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1839         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1840         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1841         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1842         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1843                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1844         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1845                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1846
  1847         16  CF-CO-OVER-SHORT.
  1848             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1849             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1850
  1851*         16  FILLER                         PIC X(102).
  1852         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1853             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1854             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1855
  1856         16  CF-AH-APPROVAL-DAYS.
  1857             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1858             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1859             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1860             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1861
  1862         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1863
  1864         16  CF-APPROV-LEV-5.
  1865             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1866             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1867             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1868
  1869         16  FILLER                         PIC X(68).
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  34
* WSMESS01.cbl
  1870****************************************************************
  1871*             PROCESSOR/USER RECORD                            *
  1872****************************************************************
  1873
  1874     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1875         16  CF-PROCESSOR-NAME              PIC X(30).
  1876         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1877         16  CF-PROCESSOR-TITLE             PIC X(26).
  1878         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1879                 88  MESSAGE-YES                VALUE 'Y'.
  1880                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1881
  1882*****************************************************
  1883****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1884****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1885****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1886****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1887*****************************************************
  1888
  1889         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1890             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1891             20  CF-APPLICATION-FORCE       PIC X.
  1892             20  CF-INDIVIDUAL-APP.
  1893                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1894                     28  CF-BROWSE-APP      PIC X.
  1895                     28  CF-UPDATE-APP      PIC X.
  1896
  1897         16  CF-CURRENT-TERM-ON             PIC X(4).
  1898         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1899             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1900             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1901             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1902             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1903             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1904             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1905             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1906         16  CF-PROCESSOR-CARRIER           PIC X.
  1907             88  NO-CARRIER-SECURITY            VALUE ' '.
  1908         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1909             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1910         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1911             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1912         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1913             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1914
  1915         16  CF-PROC-SYS-ACCESS-SW.
  1916             20  CF-PROC-CREDIT-CLAIMS-SW.
  1917                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1918                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1919                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1920                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1921             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1922                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1923                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1924             20  CF-PROC-LIFE-GNRLDGR-SW.
  1925                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1926                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1927                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  35
* WSMESS01.cbl
  1928                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1929             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1930                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1931                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1932         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1933             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1934             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1935         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1936
  1937         16  CF-APPROVAL-LEVEL                  PIC X.
  1938             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1939             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1940             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1941             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1942             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1943
  1944         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1945
  1946         16  CF-LANGUAGE-TYPE                   PIC X.
  1947             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1948             88  CF-LANG-IS-FR                      VALUE 'F'.
  1949
  1950         16  CF-CSR-IND                         PIC X.
  1951         16  FILLER                             PIC X(239).
  1952
  1953****************************************************************
  1954*             PROCESSOR/REMINDERS RECORD                       *
  1955****************************************************************
  1956
  1957     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1958         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1959             20  CF-START-REMIND-DT         PIC XX.
  1960             20  CF-END-REMIND-DT           PIC XX.
  1961             20  CF-REMINDER-TEXT           PIC X(50).
  1962         16  FILLER                         PIC X(296).
  1963
  1964
  1965****************************************************************
  1966*             STATE MASTER RECORD                              *
  1967****************************************************************
  1968
  1969     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1970         16  CF-STATE-ABBREVIATION          PIC XX.
  1971         16  CF-STATE-NAME                  PIC X(25).
  1972         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1973         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1974             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1975             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1976             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1977             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1978                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1979                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1980             20  CF-ST-PREM-REJECT-SW       PIC X.
  1981                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1982                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1983             20  CF-ST-REF-REJECT-SW        PIC X.
  1984                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1985                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  36
* WSMESS01.cbl
  1986         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1987         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1988         16  CF-ST-REFUND-RULES.
  1989             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1990             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1991             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1992         16  CF-ST-FST-PMT-EXTENSION.
  1993             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1994             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1995                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1996                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1997                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1998                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1999         16  CF-ST-STATE-CALL.
  2000             20  CF-ST-CALL-UNEARNED        PIC X.
  2001             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2002             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2003         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2004             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2005             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2006         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2007         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2008         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2009         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2010         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2011         16  FILLER                         PIC X.
  2012         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2013             20  CF-ST-BENEFIT-CD           PIC XX.
  2014             20  CF-ST-BENEFIT-KIND         PIC X.
  2015                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2016                 88  CF-ST-AH-KIND              VALUE 'A'.
  2017             20  CF-ST-REM-TERM-CALC        PIC X.
  2018                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2019                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2020                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2021                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2022                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2023                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2024                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2025                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2026
  2027             20  CF-ST-REFUND-CALC          PIC X.
  2028                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2029                 88  ST-REFD-BY-R78             VALUE '1'.
  2030                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2031                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2032                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2033                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2034                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2035                 88  ST-REFD-UTAH               VALUE '7'.
  2036                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2037                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2038                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2039
  2040             20  CF-ST-EARNING-CALC         PIC X.
  2041                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2042                 88  ST-EARN-BY-R78             VALUE '1'.
  2043                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  37
* WSMESS01.cbl
  2044                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2045                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2046                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2047                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2048                 88  ST-EARN-MEAN               VALUE '8'.
  2049                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2050
  2051             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2052                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2053                 88  ST-OVRD-BY-R78             VALUE '1'.
  2054                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2055                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2056                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2057                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2058                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2059                 88  ST-OVRD-MEAN               VALUE '8'.
  2060                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2061             20  cf-st-extra-periods        pic 9.
  2062*            20  FILLER                     PIC X.
  2063
  2064         16  CF-ST-COMMISSION-CAPS.
  2065             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2066             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2067             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2068             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2069         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2070                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2071
  2072         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2073
  2074         16  CF-ST-STATUTORY-INTEREST.
  2075             20  CF-ST-STAT-DATE-FROM       PIC X.
  2076                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2077                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2078             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2079             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2080             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2081             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2082             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2083
  2084         16  CF-ST-OVER-SHORT.
  2085             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2086             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2087
  2088         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2089
  2090         16  CF-ST-RT-CALC                  PIC X.
  2091
  2092         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2093         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2094         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2095         16  CF-ST-RF-LR-CALC               PIC X.
  2096         16  CF-ST-RF-LL-CALC               PIC X.
  2097         16  CF-ST-RF-LN-CALC               PIC X.
  2098         16  CF-ST-RF-AH-CALC               PIC X.
  2099         16  CF-ST-RF-CP-CALC               PIC X.
  2100*        16  FILLER                         PIC X(206).
  2101*CIDMOD         16  FILLER                         PIC X(192).
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  38
* WSMESS01.cbl
  2102         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2103             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2104         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2105         16  CF-ST-VFY-2ND-BENE             PIC X.
  2106         16  CF-ST-CAUSAL-STATE             PIC X.
  2107         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2108         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2109         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2110             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2111         16  CF-ST-NET-ONLY-STATE           PIC X.
  2112             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2113         16  FILLER                         PIC X(181).
  2114
  2115****************************************************************
  2116*             BENEFIT MASTER RECORD                            *
  2117****************************************************************
  2118
  2119     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2120         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2121             20  CF-BENEFIT-CODE            PIC XX.
  2122             20  CF-BENEFIT-NUMERIC  REDEFINES
  2123                 CF-BENEFIT-CODE            PIC XX.
  2124             20  CF-BENEFIT-ALPHA           PIC XXX.
  2125             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2126             20  CF-BENEFIT-COMMENT         PIC X(10).
  2127
  2128             20  CF-LF-COVERAGE-TYPE        PIC X.
  2129                 88  CF-REDUCING                VALUE 'R'.
  2130                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2131
  2132             20  CF-SPECIAL-CALC-CD         PIC X.
  2133                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2134                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2135                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2136                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2137                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2138                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2139                 88  CF-FARM-PLAN               VALUE 'F'.
  2140                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2141                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2142                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2143                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2144                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2145                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2146                 88  CF-PRUDENTIAL              VALUE 'P'.
  2147                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2148                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2149                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2150                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2151                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2152                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2153
  2154             20  CF-JOINT-INDICATOR         PIC X.
  2155                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2156
  2157*            20  FILLER                     PIC X(12).
  2158             20  cf-maximum-benefits        pic s999 comp-3.
  2159             20  FILLER                     PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  39
* WSMESS01.cbl
  2160             20  CF-BENEFIT-CATEGORY        PIC X.
  2161             20  CF-LOAN-TYPE               PIC X(8).
  2162
  2163             20  CF-CO-REM-TERM-CALC        PIC X.
  2164                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2165                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2166                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2167                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2168                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2169
  2170             20  CF-CO-EARNINGS-CALC        PIC X.
  2171                 88  CO-EARN-BY-R78             VALUE '1'.
  2172                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2173                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2174                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2175                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2176                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2177                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2178                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2179
  2180             20  CF-CO-REFUND-CALC          PIC X.
  2181                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2182                 88  CO-REFD-BY-R78             VALUE '1'.
  2183                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2184                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2185                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2186                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2187                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2188                 88  CO-REFD-MEAN               VALUE '8'.
  2189                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2190                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2191                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2192
  2193             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2194                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2195                 88  CO-OVRD-BY-R78             VALUE '1'.
  2196                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2197                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2198                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2199                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2200                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2201                 88  CO-OVRD-MEAN               VALUE '8'.
  2202                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2203
  2204             20  CF-CO-BEN-I-G-CD           PIC X.
  2205                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2206                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2207                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2208
  2209         16  FILLER                         PIC X(304).
  2210
  2211
  2212****************************************************************
  2213*             CARRIER MASTER RECORD                            *
  2214****************************************************************
  2215
  2216     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2217         16  CF-ADDRESS-DATA.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  40
* WSMESS01.cbl
  2218             20  CF-MAIL-TO-NAME            PIC X(30).
  2219             20  CF-IN-CARE-OF              PIC X(30).
  2220             20  CF-ADDRESS-LINE-1          PIC X(30).
  2221             20  CF-ADDRESS-LINE-2          PIC X(30).
  2222             20  CF-CITY-STATE              PIC X(30).
  2223             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2224             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2225
  2226         16  CF-CLAIM-NO-CONTROL.
  2227             20  CF-CLAIM-NO-METHOD         PIC X.
  2228                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2229                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2230                 88  CLAIM-NO-SEQ               VALUE '3'.
  2231                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2232             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2233                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2234                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2235                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2236
  2237         16  CF-CHECK-NO-CONTROL.
  2238             20  CF-CHECK-NO-METHOD         PIC X.
  2239                 88  CHECK-NO-MANUAL            VALUE '1'.
  2240                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2241                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2242                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2243             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2244                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2245
  2246         16  CF-DOMICILE-STATE              PIC XX.
  2247
  2248         16  CF-EXPENSE-CONTROLS.
  2249             20  CF-EXPENSE-METHOD          PIC X.
  2250                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2251                 88  DOLLARS-PER-PMT            VALUE '2'.
  2252                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2253                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2254             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2255             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2256
  2257         16  CF-CORRESPONDENCE-CONTROL.
  2258             20  CF-LETTER-RESEND-OPT       PIC X.
  2259                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2260                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2261             20  FILLER                     PIC X(4).
  2262
  2263         16  CF-RESERVE-CONTROLS.
  2264             20  CF-MANUAL-SW               PIC X.
  2265                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2266             20  CF-FUTURE-SW               PIC X.
  2267                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2268             20  CF-PTC-SW                  PIC X.
  2269                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2270             20  CF-IBNR-SW                 PIC X.
  2271                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2272             20  CF-PTC-LF-SW               PIC X.
  2273                 88  CF-LF-PTC-USED             VALUE '1'.
  2274             20  CF-CDT-ACCESS-METHOD       PIC X.
  2275                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  41
* WSMESS01.cbl
  2276                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2277                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2278             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2279
  2280         16  CF-CLAIM-CALC-METHOD           PIC X.
  2281             88  360-PLUS-MONTHS                VALUE '1'.
  2282             88  365-PLUS-MONTHS                VALUE '2'.
  2283             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2284             88  360-DAILY                      VALUE '4'.
  2285             88  365-DAILY                      VALUE '5'.
  2286
  2287         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2288         16  FILLER                         PIC X(11).
  2289
  2290         16  CF-LIMIT-AMOUNTS.
  2291             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2292             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2293             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2294             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2295             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2296             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2297             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2298             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2299             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2300             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2301
  2302         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2303         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2304         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2305
  2306         16  CF-ZIP-CODE.
  2307             20  CF-ZIP-PRIME.
  2308                 24  CF-ZIP-1ST             PIC X.
  2309                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2310                 24  FILLER                 PIC X(4).
  2311             20  CF-ZIP-PLUS4               PIC X(4).
  2312         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2313             20  CF-CAN-POSTAL-1            PIC XXX.
  2314             20  CF-CAN-POSTAL-2            PIC XXX.
  2315             20  FILLER                     PIC XXX.
  2316
  2317         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2318         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2319         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2320
  2321         16  CF-RATING-SWITCH               PIC X.
  2322             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2323             88  CF-NO-RATING                   VALUE 'N'.
  2324
  2325         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2326
  2327         16  CF-CARRIER-OVER-SHORT.
  2328             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2329             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2330
  2331         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2332         16  CF-SECPAY-SWITCH               PIC X.
  2333             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  42
* WSMESS01.cbl
  2334             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2335         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2336         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2337         16  FILLER                         PIC X(444).
  2338*        16  FILLER                         PIC X(452).
  2339
  2340
  2341****************************************************************
  2342*             MORTALITY MASTER RECORD                          *
  2343****************************************************************
  2344
  2345     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2346         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2347                                INDEXED BY CF-MORT-NDX.
  2348             20  CF-MORT-TABLE              PIC X(5).
  2349             20  CF-MORT-TABLE-TYPE         PIC X.
  2350                 88  CF-MORT-JOINT              VALUE 'J'.
  2351                 88  CF-MORT-SINGLE             VALUE 'S'.
  2352                 88  CF-MORT-COMBINED           VALUE 'C'.
  2353                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2354                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2355             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2356             20  CF-MORT-AGE-METHOD         PIC XX.
  2357                 88  CF-AGE-LAST                VALUE 'AL'.
  2358                 88  CF-AGE-NEAR                VALUE 'AN'.
  2359             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2360             20  CF-MORT-ADJUSTMENT-DIRECTION
  2361                                            PIC X.
  2362                 88  CF-MINUS                   VALUE '-'.
  2363                 88  CF-PLUS                    VALUE '+'.
  2364             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2365             20  CF-MORT-JOINT-CODE         PIC X.
  2366                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2367             20  CF-MORT-PC-Q               PIC X.
  2368                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2369             20  CF-MORT-TABLE-CODE         PIC X(4).
  2370             20  CF-MORT-COMMENTS           PIC X(15).
  2371             20  FILLER                     PIC X(14).
  2372
  2373         16  FILLER                         PIC X(251).
  2374
  2375
  2376****************************************************************
  2377*             BUSSINESS TYPE MASTER RECORD                     *
  2378****************************************************************
  2379
  2380     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2381* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2382* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2383* AND RECORD 05 IS TYPES 81-99
  2384         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2385             20  CF-BUSINESS-TITLE          PIC  X(19).
  2386             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2387                                            PIC S9V9(4) COMP-3.
  2388             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2389             20  FILLER                     PIC  X.
  2390         16  FILLER                         PIC  X(248).
  2391
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  43
* WSMESS01.cbl
  2392
  2393****************************************************************
  2394*             TERMINAL MASTER RECORD                           *
  2395****************************************************************
  2396
  2397     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2398
  2399         16  CF-COMPANY-TERMINALS.
  2400             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2401                                  PIC X(4).
  2402         16  FILLER               PIC X(248).
  2403
  2404
  2405****************************************************************
  2406*             LIFE EDIT MASTER RECORD                          *
  2407****************************************************************
  2408
  2409     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2410         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2411             20  CF-LIFE-CODE-IN            PIC XX.
  2412             20  CF-LIFE-CODE-OUT           PIC XX.
  2413         16  FILLER                         PIC X(248).
  2414
  2415
  2416****************************************************************
  2417*             AH EDIT MASTER RECORD                            *
  2418****************************************************************
  2419
  2420     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2421         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2422             20  CF-AH-CODE-IN              PIC XXX.
  2423             20  CF-AH-CODE-OUT             PIC XX.
  2424         16  FILLER                         PIC X(248).
  2425
  2426
  2427****************************************************************
  2428*             CREDIBILITY TABLES                               *
  2429****************************************************************
  2430
  2431     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2432         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2433                             INDEXED BY CF-CRDB-NDX.
  2434             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2435             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2436             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2437         16  FILLER                         PIC  X(332).
  2438
  2439
  2440****************************************************************
  2441*             REPORT CUSTOMIZATION RECORD                      *
  2442****************************************************************
  2443
  2444     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2445         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2446             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2447             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2448             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2449**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  44
* WSMESS01.cbl
  2450****       A T-TRANSFER.                                   ****
  2451             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2452
  2453         16  FILLER                         PIC XX.
  2454
  2455         16  CF-CARRIER-CNTL-OPT.
  2456             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2457                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2458                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2459             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2460                                            PIC X.
  2461         16  CF-GROUP-CNTL-OPT.
  2462             20  CF-GROUP-OPT-SEQ           PIC 9.
  2463                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2464                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2465             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2466                                            PIC X(6).
  2467         16  CF-STATE-CNTL-OPT.
  2468             20  CF-STATE-OPT-SEQ           PIC 9.
  2469                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2470                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2471             20  CF-STATE-SELECT OCCURS 3 TIMES
  2472                                            PIC XX.
  2473         16  CF-ACCOUNT-CNTL-OPT.
  2474             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2475                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2476                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2477             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2478                                            PIC X(10).
  2479         16  CF-BUS-TYP-CNTL-OPT.
  2480             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2481                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2482                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2483             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2484                                            PIC XX.
  2485         16  CF-LF-TYP-CNTL-OPT.
  2486             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2487                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2488                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2489             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2490                                            PIC XX.
  2491         16  CF-AH-TYP-CNTL-OPT.
  2492             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2493                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2494                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2495             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2496                                            PIC XX.
  2497         16  CF-REPTCD1-CNTL-OPT.
  2498             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2499                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2500                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2501             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2502                                            PIC X(10).
  2503         16  CF-REPTCD2-CNTL-OPT.
  2504             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2505                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2506                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2507             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  45
* WSMESS01.cbl
  2508                                            PIC X(10).
  2509         16  CF-USER1-CNTL-OPT.
  2510             20  CF-USER1-OPT-SEQ           PIC 9.
  2511                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2512                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2513             20  CF-USER1-SELECT OCCURS 3 TIMES
  2514                                            PIC X(10).
  2515         16  CF-USER2-CNTL-OPT.
  2516             20  CF-USER2-OPT-SEQ           PIC 9.
  2517                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2518                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2519             20  CF-USER2-SELECT OCCURS 3 TIMES
  2520                                            PIC X(10).
  2521         16  CF-USER3-CNTL-OPT.
  2522             20  CF-USER3-OPT-SEQ           PIC 9.
  2523                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2524                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2525             20  CF-USER3-SELECT OCCURS 3 TIMES
  2526                                            PIC X(10).
  2527         16  CF-USER4-CNTL-OPT.
  2528             20  CF-USER4-OPT-SEQ           PIC 9.
  2529                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2530                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2531             20  CF-USER4-SELECT OCCURS 3 TIMES
  2532                                            PIC X(10).
  2533         16  CF-USER5-CNTL-OPT.
  2534             20  CF-USER5-OPT-SEQ           PIC 9.
  2535                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2536                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2537             20  CF-USER5-SELECT OCCURS 3 TIMES
  2538                                            PIC X(10).
  2539         16  CF-REINS-CNTL-OPT.
  2540             20  CF-REINS-OPT-SEQ           PIC 9.
  2541                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2542                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2543             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2544                 24  CF-REINS-PRIME         PIC XXX.
  2545                 24  CF-REINS-SUB           PIC XXX.
  2546
  2547         16  CF-AGENT-CNTL-OPT.
  2548             20  CF-AGENT-OPT-SEQ           PIC 9.
  2549                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2550                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2551             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2552                                            PIC X(10).
  2553
  2554         16  FILLER                         PIC X(43).
  2555
  2556         16  CF-LOSS-RATIO-SELECT.
  2557             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2558             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2559         16  CF-ENTRY-DATE-SELECT.
  2560             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2561             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2562         16  CF-EFFECTIVE-DATE-SELECT.
  2563             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2564             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2565
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  46
* WSMESS01.cbl
  2566         16  CF-EXCEPTION-LIST-IND          PIC X.
  2567             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2568
  2569         16  FILLER                         PIC X(318).
  2570
  2571****************************************************************
  2572*                  EXCEPTION REPORTING RECORD                  *
  2573****************************************************************
  2574
  2575     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2576         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2577             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2578
  2579         16  CF-COMBINED-LIFE-AH-OPT.
  2580             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2581             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2582             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2583             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2584
  2585         16  CF-LIFE-OPT.
  2586             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2587             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2588             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2589             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2590             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2591             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2592             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2593             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2594             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2595             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2596
  2597         16  CF-AH-OPT.
  2598             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2599             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2600             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2601             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2602             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2603             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2604             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2605             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2606             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2607             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2608
  2609         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2610             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2611             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2612             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2613
  2614         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2615
  2616         16  FILLER                         PIC X(673).
  2617
  2618
  2619****************************************************************
  2620*             MORTGAGE SYSTEM PLAN RECORD                      *
  2621****************************************************************
  2622
  2623     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  47
* WSMESS01.cbl
  2624         16  CF-PLAN-TYPE                   PIC X.
  2625             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2626             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2627             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2628         16  CF-PLAN-ABBREV                 PIC XXX.
  2629         16  CF-PLAN-DESCRIPT               PIC X(10).
  2630         16  CF-PLAN-NOTES                  PIC X(20).
  2631         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2632         16  CF-PLAN-UNDERWRITING.
  2633             20  CF-PLAN-TERM-DATA.
  2634                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2635                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2636             20  CF-PLAN-AGE-DATA.
  2637                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2638                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2639                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2640             20  CF-PLAN-BENEFIT-DATA.
  2641                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2642                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2643                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2644                                            PIC S9(7)V99  COMP-3.
  2645         16  CF-PLAN-POLICY-FORMS.
  2646             20  CF-POLICY-FORM             PIC X(12).
  2647             20  CF-MASTER-APPLICATION      PIC X(12).
  2648             20  CF-MASTER-POLICY           PIC X(12).
  2649         16  CF-PLAN-RATING.
  2650             20  CF-RATE-CODE               PIC X(5).
  2651             20  CF-SEX-RATING              PIC X.
  2652                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2653                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2654             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2655             20  CF-SUB-STD-TYPE            PIC X.
  2656                 88  CF-PCT-OF-PREM            VALUE '1'.
  2657                 88  CF-PCT-OF-BENE            VALUE '2'.
  2658         16  CF-PLAN-PREM-TOLERANCES.
  2659             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2660             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2661         16  CF-PLAN-PYMT-TOLERANCES.
  2662             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2663             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2664         16  CF-PLAN-MISC-DATA.
  2665             20  FILLER                     PIC X.
  2666             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2667             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2668         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2669         16  CF-PLAN-IND-GRP                PIC X.
  2670             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2671                                                     '1'.
  2672             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2673                                                     '2'.
  2674         16  CF-MIB-SEARCH-SW               PIC X.
  2675             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2676             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2677             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2678             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2679         16  CF-ALPHA-SEARCH-SW             PIC X.
  2680             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2681             88  CF-MIB-ALPHA-NONE             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  48
* WSMESS01.cbl
  2682             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2683             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2684             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2685             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2686             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2687             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2688             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2689             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2690                                                     'A' 'B' 'C'
  2691                                                     'X' 'Y' 'Z'.
  2692         16  CF-EFF-DT-RULE-SW              PIC X.
  2693             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2694             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2695             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2696             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2697             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2698         16  FILLER                         PIC X(4).
  2699         16  CF-HEALTH-QUESTIONS            PIC X.
  2700             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2701         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2702         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2703         16  CF-PLAN-SNGL-JNT               PIC X.
  2704             88  CF-COMBINED-PLAN              VALUE 'C'.
  2705             88  CF-JNT-PLAN                   VALUE 'J'.
  2706             88  CF-SNGL-PLAN                  VALUE 'S'.
  2707         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2708         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2709         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2710         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2711         16  CF-RERATE-CNTL                 PIC  X.
  2712             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2713             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2714             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2715             88  CF-AUTO-RECALC                 VALUE '4'.
  2716         16  CF-BENEFIT-TYPE                PIC  X.
  2717             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2718             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2719         16  CF-POLICY-FEE                  PIC S999V99
  2720                                                    COMP-3.
  2721         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2722         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2723         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2724         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2725         16  FILLER                         PIC  X(32).
  2726         16  CF-TERMINATION-FORM            PIC  X(04).
  2727         16  FILLER                         PIC  X(08).
  2728         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2729                                                       COMP-3.
  2730         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2731         16  CF-ISSUE-LETTER                PIC  X(4).
  2732         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2733         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2734             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2735             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2736         16  CF-MP-REFUND-CALC              PIC X.
  2737             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2738             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2739             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  49
* WSMESS01.cbl
  2740             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2741             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2742             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2743             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2744             88  CF-MP-REFD-MEAN                VALUE '8'.
  2745         16  CF-ALT-RATE-CODE               PIC  X(5).
  2746
  2747
  2748         16  FILLER                         PIC X(498).
  2749****************************************************************
  2750*             MORTGAGE COMPANY MASTER RECORD                   *
  2751****************************************************************
  2752
  2753     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2754         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2755         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2756             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2757             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2758             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2759             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2760             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2761
  2762         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2763         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2764         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2765         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2766         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2767
  2768         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2769             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2770         16  CF-MP-RECON-USE-IND            PIC X(1).
  2771             88  CF-MP-USE-RECON             VALUE 'Y'.
  2772         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2773             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2774         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2775             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2776             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2777         16  FILLER                         PIC X(1).
  2778         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2779             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2780         16  CF-MORTG-MIB-VERSION           PIC X.
  2781             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2782             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2783             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2784         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2785             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2786                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2787             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2788                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2789             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2790                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2791             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2792                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2793             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2794                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2795             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2796                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2797         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  50
* WSMESS01.cbl
  2798         16  FILLER                         PIC X(7).
  2799         16  CF-MORTG-DESTINATION-SYMBOL.
  2800             20  CF-MORTG-MIB-COMM          PIC X(5).
  2801             20  CF-MORTG-MIB-TERM          PIC X(5).
  2802         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2803             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2804         16  FILLER                         PIC X(03).
  2805         16  CF-MP-CHECK-NO-CONTROL.
  2806             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2807                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2808                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2809                                                ' ' LOW-VALUES.
  2810                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2811                                               VALUE '3'.
  2812         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2813         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2814         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2815             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2816                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2817             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2818                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2819             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2820                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2821             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2822                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2823             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2824                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2825             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2826                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2827         16  CF-MORTG-BILLING-AREA.
  2828             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2829                                            PIC X.
  2830         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2831         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2832         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2833         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2834             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2835             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2836         16  FILLER                         PIC X.
  2837         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2838             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2839             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2840         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2841         16  FILLER                         PIC X(8).
  2842         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2843         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2844         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2845         16  CF-ACH-COMPANY-ID.
  2846             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2847                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2848                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2849                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2850             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2851         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2852             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2853         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2854             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2855             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  51
* WSMESS01.cbl
  2856         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2857         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2858         16  FILLER                         PIC X(536).
  2859
  2860****************************************************************
  2861*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2862****************************************************************
  2863
  2864     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2865         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2866             20  CF-FEMALE-HEIGHT.
  2867                 24  CF-FEMALE-FT           PIC 99.
  2868                 24  CF-FEMALE-IN           PIC 99.
  2869             20  CF-FEMALE-MIN-WT           PIC 999.
  2870             20  CF-FEMALE-MAX-WT           PIC 999.
  2871         16  FILLER                         PIC X(428).
  2872
  2873     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2874         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2875             20  CF-MALE-HEIGHT.
  2876                 24  CF-MALE-FT             PIC 99.
  2877                 24  CF-MALE-IN             PIC 99.
  2878             20  CF-MALE-MIN-WT             PIC 999.
  2879             20  CF-MALE-MAX-WT             PIC 999.
  2880         16  FILLER                         PIC X(428).
  2881******************************************************************
  2882*             AUTOMATIC ACTIVITY RECORD                          *
  2883******************************************************************
  2884     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2885         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2886             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2887             20  CF-SYS-LETTER-ID           PIC X(04).
  2888             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2889             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2890             20  CF-SYS-RESET-SW            PIC X(01).
  2891             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2892             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2893
  2894         16  FILLER                         PIC X(50).
  2895
  2896         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2897             20  CF-USER-ACTIVE-SW          PIC X(01).
  2898             20  CF-USER-LETTER-ID          PIC X(04).
  2899             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2900             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2901             20  CF-USER-RESET-SW           PIC X(01).
  2902             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2903             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2904             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2905
  2906         16  FILLER                         PIC X(246).
  2907*                                 COPY ELCFUNDT.
  2908*****************************************************************
  2909*                                                               *
  2910*                            ELCFUNDT.                          *
  2911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
  2912*                            VMOD=2.001                         *
  2913*                                                               *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  52
* WSMESS01.cbl
  2914*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
  2915*                                                               *
  2916*****************************************************************
  2917
  2918
  2919 01  FUNCTION-DATE.
  2920     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
  2921     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
  2922         10  WS-FN-CCYR            PIC 9(4).
  2923         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
  2924             15  WS-FN-CC          PIC 99.
  2925             15  WS-FN-YR          PIC 99.
  2926         10  WS-FN-MO              PIC 99.
  2927         10  WS-FN-DA              PIC 99.
  2928     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
  2929     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
  2930     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
  2931     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
  2932     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
  2933         88  WS-BEHIND-GMT                     VALUE '-'.
  2934         88  WS-AFTER-GMT                      VALUE '+'.
  2935         88  WS-NO-GMT                         VALUE ZERO.
  2936     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
  2937     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
  2938*                                 COPY ELCDATE.
  2939******************************************************************
  2940*                                                                *
  2941*                                                                *
  2942*                            ELCDATE.                            *
  2943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2944*                            VMOD=2.003
  2945*                                                                *
  2946*                                                                *
  2947*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2948*                 LENGTH = 200                                   *
  2949******************************************************************
  2950
  2951 01  DATE-CONVERSION-DATA.
  2952     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2953     12  DC-OPTION-CODE                PIC X.
  2954         88  BIN-TO-GREG                VALUE ' '.
  2955         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2956         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2957         88  YMD-GREG-TO-BIN            VALUE '3'.
  2958         88  MDY-GREG-TO-BIN            VALUE '4'.
  2959         88  JULIAN-TO-BIN              VALUE '5'.
  2960         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2961         88  FIND-CENTURY               VALUE '7'.
  2962         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2963         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2964         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2965         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2966         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2967         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2968         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2969         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2970         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2971         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  53
* WSMESS01.cbl
  2972         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2973         88  BIN-3-TO-GREG              VALUE 'I'.
  2974         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2975         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2976         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2977         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2978         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2979         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2980         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2981         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2982         88  THREE-CHARACTER-BIN
  2983                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2984         88  GREGORIAN-TO-BIN
  2985                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2986         88  BIN-TO-GREGORIAN
  2987                  VALUES ' ' '1' 'I' '8' 'G'.
  2988         88  JULIAN-TO-BINARY
  2989                  VALUES '5' 'C' 'E' 'F'.
  2990     12  DC-ERROR-CODE                 PIC X.
  2991         88  NO-CONVERSION-ERROR        VALUE ' '.
  2992         88  DATE-CONVERSION-ERROR
  2993                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2994         88  DATE-IS-ZERO               VALUE '1'.
  2995         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2996         88  DATE-IS-INVALID            VALUE '3'.
  2997         88  DATE1-GREATER-DATE2        VALUE '4'.
  2998         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2999         88  DATE-INVALID-OPTION        VALUE '9'.
  3000         88  INVALID-CENTURY            VALUE 'A'.
  3001         88  ONLY-CENTURY               VALUE 'B'.
  3002         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3003         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3004     12  DC-END-OF-MONTH               PIC X.
  3005         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3006     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3007         88  USE-NORMAL-PROCESS         VALUE ' '.
  3008         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3009         88  ADJUST-UP-100-YRS          VALUE '2'.
  3010     12  FILLER                        PIC X.
  3011     12  DC-CONVERSION-DATES.
  3012         16  DC-BIN-DATE-1             PIC XX.
  3013         16  DC-BIN-DATE-2             PIC XX.
  3014         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3015         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3016                       DC-GREG-DATE-1-EDIT.
  3017             20  DC-EDIT1-MONTH        PIC 99.
  3018             20  SLASH1-1              PIC X.
  3019             20  DC-EDIT1-DAY          PIC 99.
  3020             20  SLASH1-2              PIC X.
  3021             20  DC-EDIT1-YEAR         PIC 99.
  3022         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3023         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3024                     DC-GREG-DATE-2-EDIT.
  3025             20  DC-EDIT2-MONTH        PIC 99.
  3026             20  SLASH2-1              PIC X.
  3027             20  DC-EDIT2-DAY          PIC 99.
  3028             20  SLASH2-2              PIC X.
  3029             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  54
* WSMESS01.cbl
  3030         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3031         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3032                     DC-GREG-DATE-1-YMD.
  3033             20  DC-YMD-YEAR           PIC 99.
  3034             20  DC-YMD-MONTH          PIC 99.
  3035             20  DC-YMD-DAY            PIC 99.
  3036         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3037         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3038                      DC-GREG-DATE-1-MDY.
  3039             20  DC-MDY-MONTH          PIC 99.
  3040             20  DC-MDY-DAY            PIC 99.
  3041             20  DC-MDY-YEAR           PIC 99.
  3042         16  DC-GREG-DATE-1-ALPHA.
  3043             20  DC-ALPHA-MONTH        PIC X(10).
  3044             20  DC-ALPHA-DAY          PIC 99.
  3045             20  FILLER                PIC XX.
  3046             20  DC-ALPHA-CENTURY.
  3047                 24 DC-ALPHA-CEN-N     PIC 99.
  3048             20  DC-ALPHA-YEAR         PIC 99.
  3049         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3050         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3051         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3052         16  DC-JULIAN-DATE            PIC 9(05).
  3053         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3054                                       PIC 9(05).
  3055         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3056             20  DC-JULIAN-YEAR        PIC 99.
  3057             20  DC-JULIAN-DAYS        PIC 999.
  3058         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3059         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3060         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3061     12  DATE-CONVERSION-VARIBLES.
  3062         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3063         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3064             20  FILLER                PIC 9(3).
  3065             20  HOLD-CEN-1-CCYY.
  3066                 24  HOLD-CEN-1-CC     PIC 99.
  3067                 24  HOLD-CEN-1-YY     PIC 99.
  3068             20  HOLD-CEN-1-MO         PIC 99.
  3069             20  HOLD-CEN-1-DA         PIC 99.
  3070         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3071             20  HOLD-CEN-1-R-MO       PIC 99.
  3072             20  HOLD-CEN-1-R-DA       PIC 99.
  3073             20  HOLD-CEN-1-R-CCYY.
  3074                 24  HOLD-CEN-1-R-CC   PIC 99.
  3075                 24  HOLD-CEN-1-R-YY   PIC 99.
  3076             20  FILLER                PIC 9(3).
  3077         16  HOLD-CENTURY-1-X.
  3078             20  FILLER                PIC X(3)  VALUE SPACES.
  3079             20  HOLD-CEN-1-X-CCYY.
  3080                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3081                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3082             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3083             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3084         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3085             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3086             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3087             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  55
* WSMESS01.cbl
  3088                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3089                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3090             20  FILLER                PIC XXX.
  3091         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3092         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3093         16  DC-JULIAN-DATE-1          PIC 9(07).
  3094         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3095             20  DC-JULIAN-1-CCYY.
  3096                 24  DC-JULIAN-1-CC    PIC 99.
  3097                 24  DC-JULIAN-1-YR    PIC 99.
  3098             20  DC-JULIAN-DA-1        PIC 999.
  3099         16  DC-JULIAN-DATE-2          PIC 9(07).
  3100         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3101             20  DC-JULIAN-2-CCYY.
  3102                 24  DC-JULIAN-2-CC    PIC 99.
  3103                 24  DC-JULIAN-2-YR    PIC 99.
  3104             20  DC-JULIAN-DA-2        PIC 999.
  3105         16  DC-GREG-DATE-A-EDIT.
  3106             20  DC-EDITA-MONTH        PIC 99.
  3107             20  SLASHA-1              PIC X VALUE '/'.
  3108             20  DC-EDITA-DAY          PIC 99.
  3109             20  SLASHA-2              PIC X VALUE '/'.
  3110             20  DC-EDITA-CCYY.
  3111                 24  DC-EDITA-CENT     PIC 99.
  3112                 24  DC-EDITA-YEAR     PIC 99.
  3113         16  DC-GREG-DATE-B-EDIT.
  3114             20  DC-EDITB-MONTH        PIC 99.
  3115             20  SLASHB-1              PIC X VALUE '/'.
  3116             20  DC-EDITB-DAY          PIC 99.
  3117             20  SLASHB-2              PIC X VALUE '/'.
  3118             20  DC-EDITB-CCYY.
  3119                 24  DC-EDITB-CENT     PIC 99.
  3120                 24  DC-EDITB-YEAR     PIC 99.
  3121         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3122         16  DC-GREG-DATE-CYMD-R REDEFINES
  3123                              DC-GREG-DATE-CYMD.
  3124             20  DC-CYMD-CEN           PIC 99.
  3125             20  DC-CYMD-YEAR          PIC 99.
  3126             20  DC-CYMD-MONTH         PIC 99.
  3127             20  DC-CYMD-DAY           PIC 99.
  3128         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3129         16  DC-GREG-DATE-MDCY-R REDEFINES
  3130                              DC-GREG-DATE-MDCY.
  3131             20  DC-MDCY-MONTH         PIC 99.
  3132             20  DC-MDCY-DAY           PIC 99.
  3133             20  DC-MDCY-CEN           PIC 99.
  3134             20  DC-MDCY-YEAR          PIC 99.
  3135    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3136        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3137    12  DC-EL310-DATE                  PIC X(21).
  3138    12  FILLER                         PIC X(28).
  3139*                                 COPY ELCCALC.
  3140******************************************************************
  3141*                                                                *
  3142*                           ELCCALC.                            *
  3143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3144*                            VMOD=2.025                          *
  3145*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  56
* WSMESS01.cbl
  3146*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3147*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3148*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3149*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3150*                                                                *
  3151*  PASSED TO ELRTRM                                              *
  3152*  -----------------                                             *
  3153*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3154*  ORIGINAL TERM                                                 *
  3155*  BEGINNING DATE                                                *
  3156*  ENDING DATE                                                   *
  3157*  COMPANY I.D.                                                  *
  3158*  ACCOUNT MASTER USER FIELD                                     *
  3159*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3160*  FREE LOOK DAYS                                                *
  3161*                                                                *
  3162*  RETURNED FROM ELRTRM                                          *
  3163*  ---------------------                                         *
  3164*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3165*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3166*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3167*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3168*----------------------------------------------------------------*
  3169*  PASSED TO ELRAMT                                              *
  3170*  ----------------                                              *
  3171*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3172*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3173*  ORIGINAL AMOUNT                                               *
  3174*  ALTERNATE BENEFIT (BALLON)                                    *
  3175*  A.P.R. - NET PAY ONLY                                         *
  3176*  METHOD
  3177*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3178*  COMPANY I.D.                                                  *
  3179*  BENEFIT TYPE                                                  *
  3180*                                                                *
  3181*  RETURNED FROM ELRAMT                                          *
  3182*  --------------------                                          *
  3183*  REMAINING AMOUNT 1 - CURRENT                                  *
  3184*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3185*  REMAINING AMOUNT FACTOR
  3186*----------------------------------------------------------------*
  3187*  PASSED TO ELRESV                                              *
  3188*  -----------------                                             *
  3189*  CERTIFICATE EFFECTIVE DATE                                    *
  3190*  VALUATION DATE                                                *
  3191*  PAID THRU DATE                                                *
  3192*  BENEFIT                                                       *
  3193*  INCURRED DATE                                                 *
  3194*  REPORTED DATE                                                 *
  3195*  ISSUE AGE                                                     *
  3196*  TERM                                                          *
  3197*  CDT PERCENT                                                   *
  3198*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3199* *CLAIM TYPE (LIFE, A/H)                                        *
  3200* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3201* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3202*                                                                *
  3203*  RETURNED FROM ELRESV                                          *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  57
* WSMESS01.cbl
  3204*  --------------------                                          *
  3205*  CDT TABLE USED                                                *
  3206*  CDT FACTOR USED                                               *
  3207*  PAY TO CURRENT RESERVE                                        *
  3208*  I.B.N.R. - A/H ONLY                                           *
  3209*  FUTURE (ACCRUED) AH ONLY                                      *
  3210*----------------------------------------------------------------*
  3211*  PASSED TO ELRATE                                              *
  3212*  ----------------                                              *
  3213*  CERT ISSUE DATE                                               *
  3214*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3215*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3216*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3217*  STATE CODE (CLIENT DEFINED)                                   *
  3218*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3219*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3220*  DEVIATION CODE                                                *
  3221*  ISSUE AGE                                                     *
  3222*  ORIGINAL BENEFIT AMOUNT                                       *
  3223*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3224*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3225*  BENEFIT KIND (LIFE OR A/H)                                    *
  3226*  A.P.R.                                                        *
  3227*  METHOD
  3228*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3229*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3230*  COMPANY I.D. (3 CHARACTER)                                    *
  3231*  BENEFIT CODE                                                  *
  3232*  BENEFIT OVERRIDE CODE                                         *
  3233*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3234*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3235*  JOINT INDICATOR (CSL ONLY)                                    *
  3236*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3237*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3238*                                                                *
  3239*  RETURNED FROM ELRATE                                          *
  3240*  --------------------                                          *
  3241*  CALCULATED PREMIUM                                            *
  3242*  PREMIUM RATE                                                  *
  3243*  MORTALITY CODE                                                *
  3244*  MAX ATTAINED AGE                                              *
  3245*  MAX AGE                                                       *
  3246*  MAX TERM                                                      *
  3247*  MAX MONTHLY BENEFIT                                           *
  3248*  MAX TOTAL BENIFIT                                             *
  3249*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3250*----------------------------------------------------------------*
  3251*  PASSED TO ELRFND                                              *
  3252*  ----------------                                              *
  3253*  CERT ISSUE DATE                                               *
  3254*  REFUND DATE                                                   *
  3255*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3256*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3257*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3258*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3259*  STATE CODE (CLIENT DEFINED)                                   *
  3260*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3261*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  58
* WSMESS01.cbl
  3262*  DEVIATION CODE                                                *
  3263*  ISSUE AGE                                                     *
  3264*  ORIGINAL BENEFIT AMOUNT                                       *
  3265*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3266*  PROCESS TYPE (CANCEL)                                         *
  3267*  BENEFIT KIND (LIFE OR A/H)                                    *
  3268*  A.P.R.                                                        *
  3269*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3270*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3271*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3272*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3273*  COMPANY I.D. (3 CHARACTER)                                    *
  3274*  BENEFIT CODE                                                  *
  3275*  BENEFIT OVERRIDE CODE                                         *
  3276*                                                                *
  3277*  RETURNED FROM ELRFND                                          *
  3278*  --------------------                                          *
  3279*  CALCULATED REFUND                                             *
  3280*----------------------------------------------------------------*
  3281*  PASSED TO ELEARN                                              *
  3282*  ----------------                                              *
  3283*  CERT ISSUE DATE                                               *
  3284*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3285*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3286*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3287*  STATE CODE (CLIENT DEFINED)                                   *
  3288*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3289*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3290*  DEVIATION CODE                                                *
  3291*  ISSUE AGE                                                     *
  3292*  ORIGINAL BENEFIT AMOUNT                                       *
  3293*  BENEFIT KIND (LIFE OR A/H)                                    *
  3294*  A.P.R.                                                        *
  3295*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3296*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3297*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3298*  COMPANY I.D. (3 CHARACTER)                                    *
  3299*  BENEFIT CODE                                                  *
  3300*  BENEFIT OVERRIDE CODE                                         *
  3301*                                                                *
  3302*  RETURNED FROM ELEARN                                          *
  3303*  --------------------                                          *
  3304*  INDICATED  EARNINGS                                           *
  3305*----------------------------------------------------------------*
  3306*                 LENGTH = 450                                   *
  3307*                                                                *
  3308******************************************************************
  3309******************************************************************
  3310*                   C H A N G E   L O G
  3311*
  3312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3313*-----------------------------------------------------------------
  3314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3315* EFFECTIVE    NUMBER
  3316*-----------------------------------------------------------------
  3317* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3318* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3319* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  59
* WSMESS01.cbl
  3320* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3321* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3322* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3323* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3324* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3325* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3326* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3327* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3328******************************************************************
  3329
  3330 01  CALCULATION-PASS-AREA.
  3331     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3332                                     COMP.
  3333
  3334     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3335       88  NO-CP-ERROR                             VALUE ZERO.
  3336       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3337                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3338       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3339       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3340       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3341       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3342       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3343       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3344       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3345       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3346       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3347       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3348       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3349       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3350       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3351       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3352       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3353       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3354       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3355
  3356     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3357       88  NO-CP-ERROR-2                           VALUE ZERO.
  3358***********************  INPUT AREAS ****************************
  3359
  3360     12  CP-CALCULATION-AREA.
  3361         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3362         16  CP-CERT-EFF-DT        PIC XX.
  3363         16  CP-VALUATION-DT       PIC XX.
  3364         16  CP-PAID-THRU-DT       PIC XX.
  3365         16  CP-BENEFIT-TYPE       PIC X.
  3366           88  CP-AH                               VALUE 'A' 'D'
  3367                                                   'I' 'U'.
  3368           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3369           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3370         16  CP-INCURRED-DT        PIC XX.
  3371         16  CP-REPORTED-DT        PIC XX.
  3372         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3373         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3374         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3375                                     COMP-3.
  3376         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3377                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  60
* WSMESS01.cbl
  3378         16  CP-CDT-METHOD         PIC X.
  3379           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3380           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3381           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3382         16  CP-CLAIM-TYPE         PIC X.
  3383           88  CP-AH-CLAIM                         VALUE 'A'.
  3384           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3385         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3386                                     COMP-3.
  3387         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3388                                     COMP-3.
  3389         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3390                                     COMP-3.
  3391         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3392                                     COMP-3.
  3393         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3394                                     COMP-3.
  3395         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3396                                     COMP-3.
  3397         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3398                                     COMP-3.
  3399         16  CP-REM-TERM-METHOD    PIC X.
  3400           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3401           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3402           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3403           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3404           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3405           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3406           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3407         16  CP-EARNING-METHOD     PIC X.
  3408           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3409           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3410           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3411           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3412           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3413           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3414           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3415           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3416           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3417           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3418           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3419           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3420           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3421           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3422         16  CP-PROCESS-TYPE       PIC X.
  3423           88  CP-CLAIM                            VALUE '1'.
  3424           88  CP-CANCEL                           VALUE '2'.
  3425           88  CP-ISSUE                            VALUE '3'.
  3426         16  CP-SPECIAL-CALC-CD    PIC X.
  3427           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3428           88  CP-1-MTH-INTEREST               VALUE ' '.
  3429           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3430           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3431           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3432           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3433           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3434           88  CP-FARM-PLAN                    VALUE 'F'.
  3435           88  CP-RATE-AS-STANDARD             VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  61
* WSMESS01.cbl
  3436           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3437           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3438           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3439           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3440           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3441           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3442           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3443           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3444           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3445                                                     'W' 'X'.
  3446           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3447           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3448           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3449           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3450           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3451           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3452           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3453           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3454           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3455           88  CP-CSL-METH-1                   VALUE '5'.
  3456           88  CP-CSL-METH-2                   VALUE '6'.
  3457           88  CP-CSL-METH-3                   VALUE '7'.
  3458           88  CP-CSL-METH-4                   VALUE '8'.
  3459
  3460         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3461                                     COMP-3.
  3462         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3463         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3464         16  CP-STATE              PIC XX          VALUE SPACE.
  3465         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3466         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3467           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3468               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3469         16  CP-R78-OPTION         PIC X.
  3470           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3471           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3472
  3473         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3474         16  CP-IBNR-RESERVE-SW    PIC X.
  3475         16  CP-CLAIM-STATUS       PIC X.
  3476         16  CP-RATE-FILE          PIC X.
  3477         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3478                                     COMP-3.
  3479
  3480         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3481         16  CP-AH-OVERRIDE-CODE   PIC X.
  3482
  3483         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3484                                     COMP-3.
  3485         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3486                                   PIC S9(5)V99 COMP-3.
  3487         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3488                                     COMP-3.
  3489         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3490                                     COMP-3.
  3491         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  62
* WSMESS01.cbl
  3494                                  PIC S9(7)V99 COMP-3.
  3495
  3496         16  CP-PAID-FROM-DATE     PIC X(02).
  3497         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3498         16  CP-EXT-DAYS-CALC      PIC X.
  3499           88  CP-EXT-NO-CHG                   VALUE ' '.
  3500           88  CP-EXT-CHG-LF                   VALUE '1'.
  3501           88  CP-EXT-CHG-AH                   VALUE '2'.
  3502           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3503         16  CP-DOMICILE-STATE     PIC XX.
  3504         16  CP-CARRIER            PIC X.
  3505         16  CP-REIN-FLAG          PIC X.
  3506         16  CP-REM-TRM-CALC-OPTION PIC X.
  3507           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3508                      '2' '3' '4' '5'.
  3509           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3510           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3511           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3512           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3513           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3514           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3515           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3516           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3517         16  CP-SIG-SWITCH         PIC X.
  3518         16  CP-RATING-METHOD      PIC X.
  3519           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3520           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3521           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3522           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3523           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3524           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3525           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3526           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3527           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3528         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3529                                     COMP-3.
  3530         16  CP-BEN-CATEGORY       PIC X.
  3531         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3532         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3533                                   PIC S99V9(5) COMP-3.
  3534         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3535         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3536                                   PIC S99V9(5) COMP-3.
  3537         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3538         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3539         16  CP-EXPIRE-DT          PIC XX.
  3540         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3541         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3542         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3543         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3544         16  CP-DDF-SPEC-CALC      PIC X.
  3545             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3546             88  CP-CALC-CLP              VALUE 'C'.
  3547         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3548         16  CP-CANCEL-REASON      PIC X.
  3549         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3550         16  CP-PMT-MODE           PIC X.
  3551         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  63
* WSMESS01.cbl
  3552         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3553         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3554         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3555         16  FILLER                PIC X.
  3556
  3557***************    OUTPUT FROM ELRESV   ************************
  3558
  3559         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3560
  3561         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3562                                     COMP-3.
  3563         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3564                                     COMP-3.
  3565         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3566                                     COMP-3.
  3567         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3568                                     COMP-3.
  3569         16  FILLER                PIC X(09).
  3570***************    OUTPUT FROM ELRTRM   *************************
  3571
  3572         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3573                                     COMP-3.
  3574         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3575                                     COMP-3.
  3576         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3577                                     COMP-3.
  3578         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3579                                     COMP-3.
  3580         16  FILLER                PIC X(12).
  3581
  3582***************    OUTPUT FROM ELRAMT   *************************
  3583
  3584         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3585                                     COMP-3.
  3586         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3587                                     COMP-3.
  3588         16  FILLER                PIC X(12).
  3589
  3590***************    OUTPUT FROM ELRATE   *************************
  3591
  3592         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3595                                     COMP-3.
  3596         16  CP-MORTALITY-CODE     PIC X(4).
  3597         16  CP-RATE-EDIT-FLAG     PIC X.
  3598             88  CP-RATES-NEED-APR                  VALUE '1'.
  3599         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3602         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3603         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3604                                   PIC S9(7)V99 COMP-3.
  3605         16  FILLER                PIC X(07).
  3606
  3607***************    OUTPUT FROM ELRFND   *************************
  3608
  3609         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  64
* WSMESS01.cbl
  3610                                     COMP-3.
  3611         16  CP-REFUND-TYPE-USED   PIC X.
  3612           88  CP-R-AS-R78                         VALUE '1'.
  3613           88  CP-R-AS-PRORATA                     VALUE '2'.
  3614           88  CP-R-AS-CALIF                       VALUE '3'.
  3615           88  CP-R-AS-TEXAS                       VALUE '4'.
  3616           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3617           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3618           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3619           88  CP-R-AS-MEAN                        VALUE '8'.
  3620           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3621           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3622           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3623           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3624           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3625           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3626         16  FILLER                PIC X(12).
  3627
  3628***************    OUTPUT FROM ELEARN   *************************
  3629
  3630         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3631                                     COMP-3.
  3632         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3633                                     COMP-3.
  3634         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3635                                     COMP-3.
  3636         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3637                                     COMP-3.
  3638         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3639                                     COMP-3.
  3640         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-EARNING-TYPE-USED  PIC X.
  3643           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3644           88  CP-E-AS-R78                         VALUE '1'.
  3645           88  CP-E-AS-PRORATA                     VALUE '2'.
  3646           88  CP-E-AS-TEXAS                       VALUE '4'.
  3647           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3648           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3649           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3650           88  CP-E-AS-MEAN                        VALUE '8'.
  3651           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3652         16  FILLER                PIC X(12).
  3653
  3654***************    OUTPUT FROM ELPMNT   *************************
  3655
  3656         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3659                                     COMP-3.
  3660         16  FILLER                PIC X(12).
  3661
  3662***************   MISC WORK AREAS    *****************************
  3663         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  65
* WSMESS01.cbl
  3668                                     COMP-3.
  3669         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3670                                     COMP-3.
  3671         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3676             88  OPEN-RATE-FILE                   VALUE 'O'.
  3677             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3678             88  IO-ERROR                         VALUE 'E'.
  3679
  3680         16  CP-FIRST-PAY-DATE     PIC XX.
  3681
  3682         16  CP-JOINT-INDICATOR    PIC X.
  3683
  3684         16  CP-RESERVE-REMAINING-TERM
  3685                                   PIC S9(4)V9    VALUE ZERO
  3686                                     COMP-3.
  3687
  3688         16  CP-INSURED-BIRTH-DT   PIC XX.
  3689
  3690         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3691                                     COMP-3.
  3692
  3693         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3694                                     COMP-3.
  3695
  3696         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3697                                     COMP-3.
  3698
  3699         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3700                                     COMP-3.
  3701
  3702         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3703                                     COMP-3.
  3704
  3705         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3706                                     COMP-3.
  3707
  3708         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3709                                     COMP-3.
  3710
  3711         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3712             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3713
  3714         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3719         16  cp-extra-periods      pic 9 value zeros.
  3720         16  cp-net-only-state     pic x value spaces.
  3721         16  FILLER                PIC X(13).
  3722******************************************************************
  3723****************************************************************
  3724*
  3725* Copyright (c) 2007-2013 Dell Inc.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  66
* WSMESS01.cbl
  3726* All rights reserved.
  3727*
  3728****************************************************************
  3729 01  DFHEIV.
  3730   02  DFHEIV0               PIC X(35).
  3731   02  DFHEIV1               PIC X(08).
  3732   02  DFHEIV2               PIC X(08).
  3733   02  DFHEIV3               PIC X(08).
  3734   02  DFHEIV4               PIC X(06).
  3735   02  DFHEIV5               PIC X(04).
  3736   02  DFHEIV6               PIC X(04).
  3737   02  DFHEIV7               PIC X(02).
  3738   02  DFHEIV8               PIC X(02).
  3739   02  DFHEIV9               PIC X(01).
  3740   02  DFHEIV10              PIC S9(7) COMP-3.
  3741   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3742   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3743   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3744   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3745   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3746   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3747   02  DFHEIV17              PIC X(04).
  3748   02  DFHEIV18              PIC X(04).
  3749   02  DFHEIV19              PIC X(04).
  3750   02  DFHEIV20              USAGE IS POINTER.
  3751   02  DFHEIV21              USAGE IS POINTER.
  3752   02  DFHEIV22              USAGE IS POINTER.
  3753   02  DFHEIV23              USAGE IS POINTER.
  3754   02  DFHEIV24              USAGE IS POINTER.
  3755   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3756   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3757   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3758   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3759   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3760   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3761   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3762   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3763   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3764   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3765   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3766   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3767   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3768   02  FILLER                PIC X(02).
  3769   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3770   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3771   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3772   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3773   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3774   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3775   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3776 LINKAGE  SECTION.
  3777*****************************************************************
  3778*                                                               *
  3779* Copyright (c) 2007-2013 Dell Inc.                             *
  3780* All rights reserved.                                          *
  3781*                                                               *
  3782*****************************************************************
  3783 01  dfheiblk.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  67
* WSMESS01.cbl
  3784     02  eibtime          pic s9(7) comp-3.
  3785     02  eibdate          pic s9(7) comp-3.
  3786     02  eibtrnid         pic x(4).
  3787     02  eibtaskn         pic s9(7) comp-3.
  3788     02  eibtrmid         pic x(4).
  3789     02  dfheigdi         pic s9(4) comp.
  3790     02  eibcposn         pic s9(4) comp.
  3791     02  eibcalen         pic s9(4) comp.
  3792     02  eibaid           pic x(1).
  3793     02  eibfiller1       pic x(1).
  3794     02  eibfn            pic x(2).
  3795     02  eibfiller2       pic x(2).
  3796     02  eibrcode         pic x(6).
  3797     02  eibfiller3       pic x(2).
  3798     02  eibds            pic x(8).
  3799     02  eibreqid         pic x(8).
  3800     02  eibrsrce         pic x(8).
  3801     02  eibsync          pic x(1).
  3802     02  eibfree          pic x(1).
  3803     02  eibrecv          pic x(1).
  3804     02  eibsend          pic x(1).
  3805     02  eibatt           pic x(1).
  3806     02  eibeoc           pic x(1).
  3807     02  eibfmh           pic x(1).
  3808     02  eibcompl         pic x(1).
  3809     02  eibsig           pic x(1).
  3810     02  eibconf          pic x(1).
  3811     02  eiberr           pic x(1).
  3812     02  eibrldbk         pic x(1).
  3813     02  eiberrcd         pic x(4).
  3814     02  eibsynrb         pic x(1).
  3815     02  eibnodat         pic x(1).
  3816     02  eibfiller5       pic x(2).
  3817     02  eibresp          pic s9(8) comp.
  3818     02  eibresp2         pic s9(8) comp.
  3819     02  dfheigdj         pic s9(4) comp.
  3820     02  dfheigdk         pic s9(4) comp.
  3821 01  DFHCOMMAREA                 pic x(1024).
  3822 01  var  pic x(30).
  3823 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3824 0000-DFHEXIT SECTION.
  3825     MOVE '9#                    $   ' TO DFHEIV0.
  3826     MOVE 'WSMESS01' TO DFHEIV1.
  3827     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3828     display ' Entering program WSMESS01 '
  3829     move dfhcommarea            to ws-mess001-pass-area
  3830     perform 0000-init           thru 0000-exit
  3831     display ' mess001 area ' ws-mess001-pass-area
  3832     perform 0100-process-message
  3833                                 thru 0100-exit
  3834     display ' raw after unstring ' raw-message001-area
  3835*    move ' returning string goes here ' to ws-return-string
  3836     go to 0300-RETURN-CICS
  3837     .
  3838 0000-init.
  3839     move 'CID'                  to client-id
  3840     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3841     move ws-fn-cymd             to dc-greg-date-cymd
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  68
* WSMESS01.cbl
  3842     move 'L'                    to dc-option-code
  3843     perform 9700-date-link      thru 9700-exit
  3844     if no-conversion-error
  3845        move dc-bin-date-1       to ws-bin-current-dt
  3846     else
  3847        display ' error current dt invalid ' dc-error-code
  3848     end-if
  3849     display ' current date/time '
  3850        ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  3851           ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  3852     set P to address of KIXSYS
  3853     CALL "getenv" using by value P returning var-ptr
  3854     if var-ptr = null then
  3855        display ' kixsys not set '
  3856     else
  3857        set address of var to var-ptr
  3858        move 0 to env-var-len
  3859        inspect var tallying env-var-len
  3860          for characters before X'00'
  3861        unstring var (1:env-var-len) delimited by '/'
  3862           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3863              WS-KIX-SYS
  3864        end-unstring
  3865     end-if
  3866     evaluate client-id
  3867        when 'DCC'
  3868           MOVE X'05'            TO WS-COMP-CD
  3869           MOVE 'DCC'            TO WS-COMP-ID
  3870        when 'CID'
  3871           MOVE X'04'            TO WS-COMP-CD
  3872           MOVE 'CID'            TO WS-COMP-ID
  3873        when 'AHL'
  3874           MOVE X'06'            TO WS-COMP-CD
  3875           MOVE 'AHL'            TO WS-COMP-ID
  3876        when other
  3877           move '0113;Invalid company id ' to ws-return-string
  3878           display ' Invalid company id ' client-id
  3879           go to 0300-RETURN-CICS
  3880     END-evaluate
  3881     .
  3882 0000-exit.
  3883     exit.
  3884 0020-edit-received.
  3885     if ws-rate-sin-jnt-ind = 'S' OR 'J'
  3886        continue
  3887     else
  3888        move 'S'                 to ws-rate-sin-jnt-ind
  3889     end-if
  3890     if ws-rate-dismemberment = 'Y'
  3891        continue
  3892     else
  3893        move 'N'                 to ws-rate-dismemberment
  3894     end-if
  3895     if ws-rate-lf-ah = 'A'
  3896        if ws-rate-retro-elim = 'R' or 'E'
  3897           continue
  3898        else
  3899           move 'R'              to ws-rate-retro-elim
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  69
* WSMESS01.cbl
  3900        end-if
  3901     else
  3902        move spaces              to ws-rate-retro-elim
  3903     end-if
  3904     if ws-rate-ins-term = zeros
  3905        move '0115;Problem with insurance term '
  3906                                 to ws-return-string
  3907        go to 0300-RETURN-CICS
  3908     end-if
  3909     if ws-rate-lf-ah = 'L'
  3910        move 'L'                 to ws-rate-benefit-type
  3911     else
  3912        move 'A'                 to ws-rate-benefit-type
  3913     end-if
  3914**==============================================================**
  3915**                                                              **
  3916**  Validate passed effective date. Probably should add edits   **
  3917**                                                              **
  3918**==============================================================**
  3919     move ws-rate-eff-date (7:4) to ws-work-date (1:4)
  3920     move ws-rate-eff-date (1:2) to ws-work-date (5:2)
  3921     move ws-rate-eff-date (4:2) to ws-work-date (7:2)
  3922     move ws-work-date-num       to dc-greg-date-cymd
  3923     move 'L'                    to dc-option-code
  3924     perform 9700-date-link      thru 9700-exit
  3925     if no-conversion-error
  3926        move dc-bin-date-1       to ws-bin-eff-dt
  3927     else
  3928        move '0102;Problem with Eff Date' to ws-return-string
  3929        go to 0300-RETURN-CICS
  3930     end-if
  3931     if ws-bin-eff-dt > ws-bin-current-dt
  3932        move '0102;Future Effective Date' to ws-return-string
  3933        go to 0300-RETURN-CICS
  3934     end-if
  3935**==============================================================**
  3936**                                                              **
  3937**  Validate passed 1st pmt date.   Probably should add edits   **
  3938**                                                              **
  3939**==============================================================**
  3940     move ws-rate-1st-pmt-dt (7:4)
  3941                                 to ws-work-date (1:4)
  3942     move ws-rate-1st-pmt-dt (1:2)
  3943                                 to ws-work-date (5:2)
  3944     move ws-rate-1st-pmt-dt (4:2)
  3945                                 to ws-work-date (7:2)
  3946     move ws-work-date-num       to dc-greg-date-cymd
  3947     move 'L'                    to dc-option-code
  3948     perform 9700-date-link      thru 9700-exit
  3949     if no-conversion-error
  3950        move dc-bin-date-1       to ws-bin-1st-pmt-dt
  3951     else
  3952        move low-values          to ws-bin-1st-pmt-dt
  3953        move '0102;Problem with 1st pmt Date'
  3954                                 to ws-return-string
  3955        go to 0300-RETURN-CICS
  3956     end-if
  3957     if ws-bin-1st-pmt-dt <= ws-bin-eff-dt
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  70
* WSMESS01.cbl
  3958        move low-values          to ws-bin-1st-pmt-dt
  3959        move '0102;1st Pmt Date not > Eff Dt '
  3960                                 to ws-return-string
  3961        go to 0300-RETURN-CICS
  3962     end-if
  3963**==============================================================**
  3964**                                                              **
  3965**  Only use the code below if there is a time they don't       **
  3966**  send the 1st pmt date.                                      **
  3967**                                                              **
  3968**==============================================================**
  3969     if ws-bin-1st-pmt-dt = low-values
  3970        move +1                  to dc-elapsed-months
  3971        move +0                  to dc-elapsed-days
  3972        move '6'                 to dc-option-code
  3973        perform 9700-date-link   thru 9700-exit
  3974        if no-conversion-error
  3975           move dc-bin-date-2    to ws-bin-1st-pmt-dt
  3976        else
  3977           move '0102;Problem with 1st pmt Date'
  3978                                 to ws-return-string
  3979           go to 0300-RETURN-CICS
  3980        end-if
  3981     end-if
  3982**==============================================================**
  3983**                                                              **
  3984**  Calculate the expiration date to be passed back.            **
  3985**                                                              **
  3986**==============================================================**
  3987     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  3988     compute dc-elapsed-months = ws-rate-ins-term - 1
  3989     move +0                     to dc-elapsed-days
  3990     move '6'                    to dc-option-code
  3991     perform 9700-date-link      thru 9700-exit
  3992     if no-conversion-error
  3993        move dc-bin-date-2       to ws-bin-exp-dt
  3994        move dc-greg-date-a-edit to ws-exp-date
  3995     else
  3996        move '0102;Problem with calculating exp date'
  3997                              to ws-return-string
  3998        go to 0300-RETURN-CICS
  3999     end-if
  4000**==============================================================**
  4001**                                                              **
  4002**  Validate primary borrower birth date.                       **
  4003**                                                              **
  4004**==============================================================**
  4005     move ws-rate-pri-birth-date (7:4)
  4006                                 to ws-work-date (1:4)
  4007     move ws-rate-pri-birth-date (1:2)
  4008                                 to ws-work-date (5:2)
  4009     move ws-rate-pri-birth-date (4:2)
  4010                                 to ws-work-date (7:2)
  4011     move ws-work-date-num       to dc-greg-date-cymd
  4012     move 'L'                    to dc-option-code
  4013     perform 9700-date-link      thru 9700-exit
  4014     if no-conversion-error
  4015        move dc-bin-date-1       to ws-bin-pri-birth-dt
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  71
* WSMESS01.cbl
  4016     else
  4017        move '0102;Problem with Pri Birth Date'
  4018                                 to ws-return-string
  4019        go to 0300-RETURN-CICS
  4020     end-if
  4021**==============================================================**
  4022**                                                              **
  4023**  Validate co borrowers birth date.                           **
  4024**                                                              **
  4025**==============================================================**
  4026     if ws-rate-cob-birth-date (7:4) = spaces
  4027        move zeros               to ws-rate-cob-birth-date
  4028     end-if
  4029     move ws-rate-cob-birth-date (7:4)
  4030                                 to ws-work-date (1:4)
  4031     move ws-rate-cob-birth-date (1:2)
  4032                                 to ws-work-date (5:2)
  4033     move ws-rate-cob-birth-date (4:2)
  4034                                 to ws-work-date (7:2)
  4035     move low-values             to ws-bin-cob-birth-dt
  4036     if ws-work-date-num not = zeros
  4037        move ws-work-date-num    to dc-greg-date-cymd
  4038        move 'L'                 to dc-option-code
  4039        perform 9700-date-link   thru 9700-exit
  4040        if no-conversion-error
  4041           move dc-bin-date-1    to ws-bin-cob-birth-dt
  4042        else
  4043           move '0102;Problem with Cob Birth Date'
  4044                                 to ws-return-string
  4045           go to 0300-RETURN-CICS
  4046        end-if
  4047     end-if
  4048**==============================================================**
  4049**                                                              **
  4050**  Calculate primary borrowers age.                            **
  4051**                                                              **
  4052**==============================================================**
  4053     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4054     move ws-bin-eff-dt          to dc-bin-date-2
  4055     move '1'                    to dc-option-code
  4056     perform 9700-date-link      thru 9700-exit
  4057     if no-conversion-error
  4058        compute ws-issue-age = dc-elapsed-months / +12
  4059        display ' issue age = 'ws-issue-age
  4060     else
  4061        move '0102;Problem with Pri Age calculation'
  4062                                 to ws-return-string
  4063        go to 0300-RETURN-CICS
  4064     end-if
  4065**==============================================================**
  4066**                                                              **
  4067**  Calculate co borrowers age.                                 **
  4068**                                                              **
  4069**==============================================================**
  4070     move zeros                  to ws-cob-age
  4071     if ws-bin-cob-birth-dt not = low-values
  4072        move ws-bin-cob-birth-dt to dc-bin-date-1
  4073        move ws-bin-eff-dt       to dc-bin-date-2
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  72
* WSMESS01.cbl
  4074        move '1'                 to dc-option-code
  4075        perform 9700-date-link   thru 9700-exit
  4076        if no-conversion-error
  4077           compute ws-cob-age = dc-elapsed-months / +12
  4078           display ' cob   age = 'ws-cob-age
  4079        else
  4080           move '0102;Problem with Cob Age calculation'
  4081                                 to ws-return-string
  4082           go to 0300-RETURN-CICS
  4083        end-if
  4084     end-if
  4085     move ws-issue-age           to ws-rate-age
  4086     if ws-cob-age > ws-rate-age
  4087        display ' Using Co borrower age ' ws-issue-age
  4088           ' ' ws-cob-age
  4089        move ws-cob-age          to ws-rate-age
  4090     end-if
  4091**==============================================================**
  4092**                                                              **
  4093**  Validate passed total of payments. loan term * payment      **
  4094**                                                              **
  4095**==============================================================**
  4096     if ws-rate-lf-ah = 'A'
  4097        GO TO 0020-EXIT
  4098     END-IF
  4099     compute ws-calc-tot-pmts =
  4100        ws-rate-loan-term * ws-rate-payment
  4101     display '    my tot pmts ' ws-calc-tot-pmts
  4102     display ' their tot pmts ' ws-rate-tot-pmts
  4103     if ws-calc-tot-pmts <> ws-rate-tot-pmts
  4104         move '0116;Total of payments incorrect '
  4105                                 to ws-return-string
  4106         go to 0300-RETURN-CICS
  4107     end-if
  4108     .
  4109 0020-exit.
  4110     exit.
  4111 0025-assign-ben-cd.
  4112**==============================================================**
  4113**                                                              **
  4114**     Eventually, depending on how well this project takes off **
  4115**  we should figure out a much better way to assign benefit    **
  4116**  codes. For now since we only have 1 or 2 accounts in TX it  **
  4117**  will be hard coded.                                         **
  4118**                                                              **
  4119**==============================================================**
  4120     if ws-rate-benefit-type = 'L'
  4121        if ws-rate-sin-jnt-ind = 'S'
  4122           move '01'             to ws-rate-benefit-cd
  4123        else
  4124           move '03'             to ws-rate-benefit-cd
  4125        end-if
  4126     else
  4127        if ws-rate-sin-jnt-ind = 'J'
  4128           if ws-rate-retro-elim = 'R'
  4129              if ws-rate-waiting-days = 14
  4130                 move '54'       to ws-rate-benefit-cd
  4131              else
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  73
* WSMESS01.cbl
  4132                 if ws-rate-waiting-days = 30
  4133                    move '55'    to ws-rate-benefit-cd
  4134                 end-if
  4135              end-if
  4136           else
  4137              if ws-rate-retro-elim = 'E'
  4138                 if ws-rate-waiting-days = 14
  4139                    move '56'    to ws-rate-benefit-cd
  4140                 else
  4141                    if ws-rate-waiting-days = 30
  4142                       move '57' to ws-rate-benefit-cd
  4143                    end-if
  4144                 end-if
  4145              end-if
  4146           end-if
  4147        else
  4148           if ws-rate-retro-elim = 'R'
  4149              if ws-rate-waiting-days = 14
  4150                 move '01'       to ws-rate-benefit-cd
  4151              else
  4152                 if ws-rate-waiting-days = 30
  4153                    move '04'    to ws-rate-benefit-cd
  4154                 end-if
  4155              end-if
  4156           else
  4157              if ws-rate-retro-elim = 'E'
  4158                 if ws-rate-waiting-days = 14
  4159                    move '05'    to ws-rate-benefit-cd
  4160                 else
  4161                    if ws-rate-waiting-days = 30
  4162                       move '02' to ws-rate-benefit-cd
  4163                    end-if
  4164                 end-if
  4165              end-if
  4166           end-if
  4167        end-if
  4168     end-if
  4169     .
  4170 0025-exit.
  4171     exit.
  4172 0030-get-rate.
  4173     perform 0050-get-account    thru 0050-exit
  4174*    move spaces                 to calculation-pass-area
  4175     move zeros                  to cp-r-max-mon-ben
  4176                                    cp-r-max-tot-ben
  4177                                    cp-rate-dev-pct
  4178                                    cp-original-premium
  4179                                    cp-critical-months
  4180                                    cp-term-or-ext-days
  4181     move am-cal-table           to cp-class-CODE
  4182     if ws-rate-benefit-type = 'L'
  4183        move am-lf-deviation     to cp-deviation-code
  4184     else
  4185        move am-ah-deviation     to cp-deviation-code
  4186     end-if
  4187     move ws-rate-state          to cp-state
  4188                                    cp-state-std-abbrv
  4189     move ws-rate-benefit-type   to cp-benefit-type
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  74
* WSMESS01.cbl
  4190     move ws-rate-benefit-cd     to cp-benefit-cd
  4191     move ws-rate-benefit        to cp-original-benefit
  4192                                    cp-rating-benefit-amt
  4193     move ws-rate-age            to cp-issue-age
  4194     move ws-comp-id             to cp-company-id
  4195     move ws-comp-cd             to cp-company-cd
  4196     move ws-rate-apr            to cp-loan-apr
  4197     if ws-rate-loan-term = zeros
  4198        move ws-rate-ins-term    to ws-rate-loan-term
  4199     end-if
  4200     move ws-rate-ins-term       to cp-original-term
  4201     move ws-rate-loan-term      to cp-loan-term
  4202     move 'L'                    to cp-life-override-code
  4203     move 'A'                    to cp-ah-override-code
  4204     move '3'                    to cp-process-type
  4205     move ws-rate-earn-meth      to cp-earning-method
  4206                                    cp-rating-method
  4207     move 'R'                    to cp-rate-file
  4208     move ws-bin-eff-dt          to cp-cert-eff-dt
  4209     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4210     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4211     if no-cp-error
  4212        if ((cp-calc-premium - ws-rate-premium) > 9.99)
  4213                        or
  4214           ((ws-rate-premium - cp-calc-premium) > 9.99)
  4215           move 'Z'              to cp-return-code
  4216        end-if
  4217     end-if
  4218**==============================================================**
  4219**                                                              **
  4220** The below code will change as we add more states and forms   **
  4221** to this process.                                             **
  4222**                                                              **
  4223**==============================================================**
  4224*    if ws-rate-benefit-type = 'L'
  4225*       move cp-original-benefit to ws-max-benefit
  4226*    else
  4227*       compute ws-max-benefit =
  4228*          cp-original-term * cp-original-benefit
  4229*    end-if
  4230     if ws-rate-benefit-type = 'L'
  4231        move cp-r-max-tot-ben    to ws-max-benefit
  4232     else
  4233        move cp-r-max-mon-ben    to ws-max-benefit
  4234     end-if
  4235     .
  4236 0030-exit.
  4237     exit.
  4238 0040-format-buffer.
  4239     move spaces                 to ws-return-string
  4240     perform 0045-format-error   thru 0045-exit
  4241     move ';'                    to ws-sc1
  4242                                    ws-sc2
  4243                                    ws-sc3
  4244                                    ws-sc4
  4245                                    ws-sc5
  4246                                    ws-sc6
  4247                                    ws-sc7
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  75
* WSMESS01.cbl
  4248     if no-cp-error
  4249        if ws-contract-suffix = spaces or low-values
  4250           move ws-contract-no   to ws-return-contract-no (2:10)
  4251        else
  4252           move ws-contract-no   to ws-return-contract-no (1:10)
  4253           move ws-contract-suffix
  4254                                 to ws-return-contract-no (11:1)
  4255        end-if
  4256        move cp-calc-premium     to ws-return-prem
  4257        move cp-premium-rate     to ws-return-rate
  4258        move ws-max-benefit      to ws-return-max-ben
  4259        move ws-exp-date         to ws-return-exp-dt
  4260        move ws-rate-benefit-cd  to ws-return-benefit-cd
  4261     else
  4262        set error-in-one-coverage to true
  4263        move spaces              to ws-contract-no
  4264                                    ws-contract-suffix
  4265     end-if
  4266     .
  4267 0040-exit.
  4268     exit.
  4269 0045-format-error.
  4270     evaluate true
  4271        when cp-return-code = '0'
  4272           move +1               to s1
  4273        when cp-return-code = '1'
  4274           move +2               to s1
  4275        when cp-return-code = '2'
  4276           move +3               to s1
  4277        when cp-return-code = 'A'
  4278           move +4               to s1
  4279        when cp-return-code = 'B'
  4280           move +5               to s1
  4281        when cp-return-code = '4'
  4282           move +6               to s1
  4283        when cp-return-code = '9'
  4284           move +7               to s1
  4285        when cp-return-code = '8'
  4286           move +8               to s1
  4287        when cp-return-code = 'H'
  4288           move +9               to s1
  4289        when cp-return-code = 'C'
  4290           move +10              to s1
  4291        when cp-return-code = '7'
  4292           move +11              to s1
  4293        when cp-return-code = '6'
  4294           move +12              to s1
  4295        when cp-return-code = 'D'
  4296           move +13              to s1
  4297        when cp-return-code = 'Z'
  4298           move +14              to s1
  4299           move cp-calc-premium  to ws-return-prem
  4300           move cp-premium-rate  to ws-return-rate
  4301           move ws-max-benefit   to ws-return-max-ben
  4302           move ws-exp-date      to ws-return-exp-dt
  4303           move ws-rate-benefit-cd to ws-return-benefit-cd
  4304        when cp-return-code = 'Y'
  4305           move +15              to s1
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  76
* WSMESS01.cbl
  4306           move cp-calc-premium  to ws-return-prem
  4307           move cp-premium-rate  to ws-return-rate
  4308           move ws-max-benefit   to ws-return-max-ben
  4309           move ws-exp-date      to ws-return-exp-dt
  4310           move ws-rate-benefit-cd to ws-return-benefit-cd
  4311     end-evaluate
  4312     move ws-table-error-no (s1) to ws-return-error-no
  4313     move ws-table-error-mess (s1)
  4314                                 to ws-return-error-mess
  4315     .
  4316 0045-exit.
  4317     exit.
  4318 0050-get-account.
  4319     move ws-comp-cd             to ws-am-company-cd
  4320     move '9'                    to ws-am-carrier
  4321     move '000000'               to ws-am-group
  4322     move ws-rate-state          to ws-am-state
  4323     move ws-rate-acct-no        to ws-am-account
  4324     move ws-bin-eff-dt          to ws-am-exp-dt
  4325
  4326* exec cics read
  4327*       dataset      ('ERACCT')
  4328*       ridfld       (ws-am-key)
  4329*       into         (account-master)
  4330*       GTEQ
  4331*       resp         (ws-response)
  4332*    end-exec
  4333     MOVE LENGTH OF
  4334      account-master
  4335       TO DFHEIV11
  4336     MOVE 'ERACCT' TO DFHEIV1
  4337*    MOVE '&"IL       G          (  N#00004228' TO DFHEIV0
  4338     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4340     MOVE X'204E233030303034323238' TO DFHEIV0(25:11)
  4341     CALL 'kxdfhei1' USING DFHEIV0,
  4342           DFHEIV1,
  4343           account-master,
  4344           DFHEIV11,
  4345           ws-am-key,
  4346           DFHEIV99,
  4347           DFHEIV99,
  4348           DFHEIV99
  4349     MOVE EIBRESP  TO ws-response
  4350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4351     if resp-normal
  4352        and (ws-comp-cd = am-company-cd)
  4353        and (ws-rate-state = am-state)
  4354        and (ws-rate-acct-no = am-account)
  4355        and (ws-bin-eff-dt >= am-effective-dt)
  4356        and (ws-bin-eff-dt < am-expiration-dt)
  4357        continue
  4358     else
  4359        move '0114;No account mstr found ' to ws-return-string
  4360        go to 0300-RETURN-CICS
  4361     end-if
  4362     .
  4363 0050-exit.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  77
* WSMESS01.cbl
  4364     exit.
  4365 0060-check-for-dup.
  4366**==============================================================**
  4367**                                                              **
  4368**    All i'm going to do here is check for a dup using         **
  4369**  the state, account, eff dt and last six of vin and a space  **
  4370**  in the cert suffix. If I do find one then I will have to    **
  4371**  find the last suffix and use the next available one in the  **
  4372**  suffix table.                                               **
  4373**                                                              **
  4374**==============================================================**
  4375     move +1                     to x1
  4376     move ' '                    to ws-browse-sw
  4377     move ws-comp-cd             to ws-cm-key
  4378     move '9'                    to ws-cm-carrier
  4379     move '000000'               to ws-cm-group
  4380     move ws-rate-state          to ws-cm-state
  4381     move ws-rate-acct-no        to ws-cm-account
  4382     move ws-bin-eff-dt          to ws-cm-eff-dt
  4383     string
  4384        '0000'
  4385        ws-rate-vin (12:6)
  4386        ' ' delimited by size into ws-cm-cert-no
  4387     end-string
  4388     move ws-cm-key              to ws-cm-compare-key
  4389     move ws-cm-cert-ten         to ws-contract-no
  4390     move low-values             to ws-last-suffix
  4391     display ' about to startbr ' ws-cm-key (2:19) ' '
  4392        ws-rate-eff-date  ' ' ws-cm-key (23:11)
  4393
  4394* exec cics startbr
  4395*       dataset      ('ELCERT')
  4396*       ridfld       (ws-cm-key)
  4397*       gteq
  4398*       resp         (ws-response)
  4399*    end-exec
  4400     MOVE 'ELCERT' TO DFHEIV1
  4401     MOVE 0
  4402       TO DFHEIV11
  4403*    MOVE '&,         G          &  N#00004277' TO DFHEIV0
  4404     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4405     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4406     MOVE X'204E233030303034323737' TO DFHEIV0(25:11)
  4407     CALL 'kxdfhei1' USING DFHEIV0,
  4408           DFHEIV1,
  4409           ws-cm-key,
  4410           DFHEIV99,
  4411           DFHEIV11,
  4412           DFHEIV99
  4413     MOVE EIBRESP  TO ws-response
  4414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4415     evaluate true
  4416        when resp-normal
  4417           set browse-started to true
  4418        when resp-notfnd or resp-endfile
  4419           set i-say-stop to true
  4420        when other
  4421           move ws-response to ws-disp-resp
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  78
* WSMESS01.cbl
  4422           string
  4423              '9999' ';'
  4424              'Bad elcert startbr ' ';'
  4425              ws-disp-resp delimited by size
  4426                                 into ws-return-string
  4427           end-string
  4428           display ' something went wrong with start br '
  4429              ws-response
  4430           go to 0300-RETURN-CICS
  4431     end-evaluate
  4432     perform until i-say-stop
  4433
  4434* exec cics readnext
  4435*          dataset      ('ELCERT')
  4436*          ridfld       (ws-cm-key)
  4437*          into         (certificate-master)
  4438*          resp         (ws-response)
  4439*       end-exec
  4440     MOVE LENGTH OF
  4441      certificate-master
  4442       TO DFHEIV12
  4443     MOVE 'ELCERT' TO DFHEIV1
  4444     MOVE 0
  4445       TO DFHEIV11
  4446*    MOVE '&.IL                  )  N#00004301' TO DFHEIV0
  4447     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4448     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4449     MOVE X'204E233030303034333031' TO DFHEIV0(25:11)
  4450     CALL 'kxdfhei1' USING DFHEIV0,
  4451           DFHEIV1,
  4452           certificate-master,
  4453           DFHEIV12,
  4454           ws-cm-key,
  4455           DFHEIV99,
  4456           DFHEIV11,
  4457           DFHEIV99,
  4458           DFHEIV99
  4459     MOVE EIBRESP  TO ws-response
  4460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4461        if resp-normal
  4462           if ws-cm-key (1:32) = ws-cm-compare-key (1:32)
  4463              move ws-cm-cert-suffix
  4464                                 to ws-last-suffix
  4465           else
  4466              set i-say-stop to true
  4467           end-if
  4468        else
  4469           set i-say-stop to true
  4470        end-if
  4471     end-perform
  4472     if browse-started
  4473
  4474* exec cics endbr
  4475*          dataset   ('ELCERT')
  4476*       END-EXEC
  4477     MOVE 'ELCERT' TO DFHEIV1
  4478     MOVE 0
  4479       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  79
* WSMESS01.cbl
  4480*    MOVE '&2                    $   #00004319' TO DFHEIV0
  4481     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4482     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4483     MOVE X'2020233030303034333139' TO DFHEIV0(25:11)
  4484     CALL 'kxdfhei1' USING DFHEIV0,
  4485           DFHEIV1,
  4486           DFHEIV11,
  4487           DFHEIV99
  4488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4489     end-if
  4490     if ws-last-suffix not = low-values
  4491        perform varying x1 from +1 by +1 until
  4492           (x1 > +26)
  4493           or (ws-last-suffix = ws-suffix-value (x1))
  4494        end-perform
  4495        if x1 < +27
  4496           move ws-suffix-value (x1 + 1)
  4497                                 to ws-contract-suffix
  4498        else
  4499           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4500           display ' more than 26 suffix codes ' ws-last-suffix
  4501           go to 0300-RETURN-CICS
  4502        end-if
  4503     end-if
  4504     .
  4505 0060-exit.
  4506     exit.
  4507 0070-open-cursor.
  4508*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  4509***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4510***                                                            ***
  4511***  The dates on the sql table have values in the time        ***
  4512***  so I convert it to a string and just use mm/dd/yyyy       ***
  4513***  to perform the comparison.                                ***
  4514***                                                            ***
  4515***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4516     if not connected-to-db
  4517        perform 6000-connect-to-db thru 6000-exit
  4518     end-if
  4519     move ws-rate-state          to ws-dealer-state
  4520     move ws-rate-acct-no        to ws-dealer-id
  4521     move ws-rate-eff-date       to ws-contract-eff-dt
  4522     move zeros                  to ws-ks-contract-no
  4523     move ws-rate-vin (12:6)     to ws-ks-contract-no (5:6)
  4524     EXEC SQL
  4525        DECLARE
  4526           contracts cursor for
  4527        SELECT
  4528           DlrState,
  4529           DlrId,
  4530           EffDt,
  4531           ContractNo,
  4532           ContractSuffix
  4533        FROM
  4534           PendingContracts
  4535        WHERE
  4536           DlrState     = :ws-dealer-state
  4537           and DlrId    = :ws-dealer-id
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  80
* WSMESS01.cbl
  4538           and EffDt    = :ws-contract-eff-dt
  4539           and ContractNo  = :ws-ks-contract-no
  4540        ORDER BY
  4541           dlrstate,
  4542           dlrid,
  4543           effdt,
  4544           contractno,
  4545           contractsuffix
  4546     end-exec
  4547     if sqlcode not = 0
  4548        display "Error: cannot declare cursor "
  4549        display ' sql retrun code ' sqlcode
  4550        display ' sql err mess    ' sqlerrmc
  4551        go to 0070-exit
  4552     end-if
  4553     EXEC SQL
  4554        open contracts
  4555     END-EXEC
  4556     if sqlcode not = 0
  4557        display "Error: cannot open cursor "
  4558        display ' sql retrun code ' sqlcode
  4559        display ' sql err mess    ' sqlerrmc
  4560        go to 0070-exit
  4561     end-if
  4562     .
  4563 0070-exit.
  4564     exit.
  4565 0080-process-input.
  4566     perform until sqlcode not = 0
  4567        EXEC SQL
  4568           fetch contracts into
  4569              :sql-dlr-state,
  4570              :sql-dlr-id,
  4571              :sql-eff-dt,
  4572              :sql-contr-no,
  4573              :sql-contr-suffix
  4574        END-EXEC
  4575        if sqlcode = 0
  4576           display ' got a hit ' sql-contr-no ' '
  4577              sql-contr-suffix
  4578           move sql-contr-suffix to ws-tbl-last-suffix
  4579        else
  4580           if sqlcode not = 0 and 100
  4581              display "Error: cannot fetch row "
  4582              display ' sql return code ' sqlcode
  4583              display ' sql err mess    ' sqlerrmc
  4584           end-if
  4585        end-if
  4586     end-perform
  4587     if ws-tbl-last-suffix = low-values
  4588        display ' tbl last suffix = LV '
  4589     else
  4590        if ws-tbl-last-suffix = spaces
  4591           display ' tbl last suffix = SPACES '
  4592        else
  4593           display ' tbl last suffix = ' ws-tbl-last-suffix
  4594        end-if
  4595     end-if
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  81
* WSMESS01.cbl
  4596     if ws-last-suffix = low-values
  4597        display ' last suffix = LV '
  4598     else
  4599        if ws-last-suffix = spaces
  4600           display ' last suffix = SPACES '
  4601        else
  4602           display ' last suffix = ' ws-last-suffix
  4603        end-if
  4604     end-if
  4605     if sqlcode = 100
  4606        display ' Normal end of record set '
  4607     end-if
  4608     if ws-tbl-last-suffix not = low-values
  4609        and (ws-tbl-last-suffix > ws-last-suffix)
  4610        perform varying x1 from +1 by +1 until
  4611           (x1 > +26)
  4612           or (ws-tbl-last-suffix = ws-suffix-value (x1))
  4613        end-perform
  4614        if x1 < +27
  4615           move ws-suffix-value (x1 + 1)
  4616                                 to ws-contract-suffix
  4617        else
  4618           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4619           display ' more than 26 suffix codes ' ws-last-suffix
  4620           go to 0300-RETURN-CICS
  4621        end-if
  4622     end-if
  4623     EXEC SQL
  4624         close contracts
  4625     END-EXEC
  4626     if sqlcode not = 0
  4627        display "Error: cannot close cursor "
  4628        display ' sql retrun code ' sqlcode
  4629        display ' sql err mess    ' sqlerrmc
  4630     end-if
  4631     .
  4632 0080-exit.
  4633     exit.
  4634 0100-process-message.
  4635     perform 0110-unstring       thru 0110-exit
  4636     perform 0120-format-message thru 0120-exit
  4637     perform 0020-edit-received  thru 0020-exit
  4638     perform 0025-assign-ben-cd  thru 0025-exit
  4639     perform 0030-get-rate       thru 0030-exit
  4640     if (contract-no-assigned)
  4641            or
  4642        (error-in-one-coverage)
  4643        continue
  4644     else
  4645        perform 0060-check-for-dup
  4646                                 thru 0060-exit
  4647        perform 0070-open-cursor thru 0070-exit
  4648        perform 0080-process-input
  4649                                 thru 0080-exit
  4650     end-if
  4651     perform 0040-format-buffer  thru 0040-exit
  4652     set contract-no-assigned to true
  4653     .
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  82
* WSMESS01.cbl
  4654 0100-exit.
  4655     exit.
  4656 0110-unstring.
  4657***____________________________________________________________***
  4658**|                                                            |**
  4659**|    Unstring the raw data into data elements                |**
  4660**|                                                            |**
  4661***____________________________________________________________***
  4662        unstring dfhcommarea
  4663           delimited by '|' into
  4664              raw-message-num
  4665              raw-state
  4666              raw-acct-no
  4667              raw-vin
  4668              raw-lf-ah
  4669              raw-ben-code
  4670              raw-earn-meth
  4671              raw-pri-birth-date
  4672              raw-cob-birth-date
  4673              raw-benefit
  4674              raw-eff-date
  4675              raw-1st-pmt-dt
  4676              raw-premium
  4677              raw-loan-term
  4678              raw-ins-term
  4679              raw-apr
  4680              raw-sin-jnt-ind
  4681              raw-dismemberment
  4682              raw-retro-elim
  4683              raw-waiting-days
  4684              raw-crit-per
  4685              raw-total-payments
  4686              raw-period-payment
  4687        end-unstring
  4688     display ' made 0110 ' raw-total-payments ' '
  4689     raw-period-payment
  4690     .
  4691 0110-exit.
  4692     exit.
  4693 0120-format-message.
  4694***____________________________________________________________***
  4695**|                                                            |**
  4696**|    Format each data element to be consistant with          |**
  4697**|  COBOL rate copybook model                                 |**
  4698**|                                                            |**
  4699***____________________________________________________________***
  4700     inspect
  4701        raw-acct-no replacing leading spaces by zeros
  4702     inspect
  4703        raw-loan-term replacing leading spaces by zeros
  4704     inspect
  4705        raw-ins-term replacing leading spaces by zeros
  4706     inspect
  4707        raw-waiting-days replacing leading spaces by zeros
  4708     inspect
  4709        raw-crit-per replacing leading spaces by zeros
  4710     inspect
  4711        raw-benefit replacing all spaces by zeros
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  83
* WSMESS01.cbl
  4712     inspect
  4713        raw-premium replacing all spaces by zeros
  4714     inspect
  4715        raw-apr replacing all spaces by zeros
  4716     inspect
  4717        raw-total-payments replacing all spaces by zeros
  4718     inspect
  4719        raw-period-payment replacing all spaces by zeros
  4720     move raw-benefit            to ws-work-in
  4721     perform 0130-format-amt     thru 0130-exit
  4722     move ws-work-out-v2         to ws-rate-benefit
  4723     display ' ben  in *' ws-work-in '*'
  4724     display ' ben  out *' ws-work-out '*'
  4725     move raw-total-payments     to ws-work-in
  4726     perform 0130-format-amt     thru 0130-exit
  4727     move ws-work-out-v2         to ws-rate-tot-pmts
  4728     display ' tot pmts  in *' ws-work-in '*'
  4729     display ' tot pmts  out *' ws-work-out '*'
  4730     move raw-premium            to ws-work-in
  4731     perform 0130-format-amt     thru 0130-exit
  4732     move ws-work-out-v2         to ws-rate-premium
  4733     display ' prem in *' ws-work-in '*'
  4734     display ' prem out *' ws-work-out '*'
  4735     move raw-period-payment     to ws-work-in
  4736     perform 0130-format-amt     thru 0130-exit
  4737     move ws-work-out-v2         to ws-rate-payment
  4738     display ' pmt  in *' ws-work-in '*'
  4739     display ' pmt  out *' ws-work-out '*'
  4740     move raw-loan-term          to ws-work-in
  4741     perform 0140-format-term    thru 0140-exit
  4742     move ws-work-out-v0         to ws-rate-loan-term
  4743     display ' ln term in *' ws-work-in '*'
  4744     display ' ln term out *' ws-work-out '*'
  4745     move raw-ins-term           to ws-work-in
  4746     perform 0140-format-term    thru 0140-exit
  4747     move ws-work-out-v0         to ws-rate-ins-term
  4748     display ' ins term in *' ws-work-in '*'
  4749     display ' ins term out *' ws-work-out '*'
  4750     move raw-waiting-days       to ws-work-in
  4751     perform 0140-format-term    thru 0140-exit
  4752     move ws-work-out-v0         to ws-rate-waiting-days
  4753     display ' wait day in *' ws-work-in '*'
  4754     display ' wait day out *' ws-work-out '*'
  4755     move raw-crit-per           to ws-work-in
  4756     perform 0140-format-term    thru 0140-exit
  4757     move ws-work-out-v0         to ws-rate-crit-per
  4758     display ' crit per in *' ws-work-in '*'
  4759     display ' crit per out *' ws-work-out '*'
  4760     move raw-apr                to ws-work-in
  4761     perform 0150-format-apr     thru 0150-exit
  4762     move ws-work-out-v5         to ws-rate-apr
  4763     display ' ins apr  in *' ws-work-in '*'
  4764     display ' ins apr  out *' ws-work-out '*'
  4765     move raw-state              to ws-rate-state
  4766     move raw-acct-no            to ws-rate-acct-no
  4767     move raw-vin                to ws-rate-vin
  4768     move raw-lf-ah              to ws-rate-lf-ah
  4769     move raw-ben-code           to ws-rate-ben-code
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  84
* WSMESS01.cbl
  4770     move raw-earn-meth          to ws-rate-earn-meth
  4771     move raw-pri-birth-date     to ws-rate-pri-birth-date
  4772     move raw-cob-birth-date     to ws-rate-cob-birth-date
  4773     move raw-eff-date           to ws-rate-eff-date
  4774     move raw-1st-pmt-dt         to ws-rate-1st-pmt-dt
  4775     move raw-sin-jnt-ind        to ws-rate-sin-jnt-ind
  4776     move raw-dismemberment      to ws-rate-dismemberment
  4777     move raw-retro-elim         to ws-rate-retro-elim
  4778     .
  4779 0120-exit.
  4780     exit.
  4781 0130-format-amt.
  4782     move zeros                  to ws-work-out
  4783     perform varying s2 from +10 by -1 until
  4784        (s2 < +1)
  4785        or (ws-work-in (s2:1) = '.')
  4786     end-perform
  4787     if s2 < +9
  4788        move ws-work-in (s2 + 1:2)
  4789                              to ws-work-out (9:2)
  4790        move +8               to s3
  4791        subtract +1 from s2
  4792        perform varying s2 from s2 by -1 until
  4793           (s2 < +1)
  4794           or (s3 = 0)
  4795           move ws-work-in (s2:1) to ws-work-out (s3:1)
  4796           subtract +1 from s3
  4797        end-perform
  4798     end-if
  4799     .
  4800 0130-exit.
  4801     exit.
  4802 0140-format-term.
  4803     move zeros                  to ws-work-out
  4804     perform varying s2 from +10 by -1 until
  4805        (s2 < +1)
  4806        or (ws-work-in (s2:1) numeric)
  4807     end-perform
  4808     if s2 > +0
  4809        move ws-work-in (s2:1)
  4810                              to ws-work-out (10:1)
  4811        move +9               to s3
  4812        subtract +1 from s2
  4813        perform varying s2 from s2 by -1 until
  4814           (s2 < +1)
  4815           or (s3 = 7)
  4816           move ws-work-in (s2:1) to ws-work-out (s3:1)
  4817           subtract +1 from s3
  4818        end-perform
  4819     end-if
  4820     .
  4821 0140-exit.
  4822     exit.
  4823 0150-format-apr.
  4824     move zeros                  to ws-work-out
  4825     perform varying s2 from +10 by -1 until
  4826        (s2 < +1)
  4827        or (ws-work-in (s2:1) = '.')
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  85
* WSMESS01.cbl
  4828     end-perform
  4829     if s2 < +5
  4830        move ws-work-in (s2 + 1:5)
  4831                              to ws-work-out (6:5)
  4832        move +5               to s3
  4833        subtract +1 from s2
  4834        perform varying s2 from s2 by -1 until
  4835           (s2 < +1)
  4836           or (s3 = 0)
  4837           move ws-work-in (s2:1) to ws-work-out (s3:1)
  4838           subtract +1 from s3
  4839        end-perform
  4840     end-if
  4841     .
  4842 0150-exit.
  4843     exit.
  4844 0300-RETURN-CICS.
  4845     move ws-return-string       to dfhcommarea
  4846
  4847* exec cics return end-exec
  4848*    MOVE '.(                    ''   #00004679' TO DFHEIV0
  4849     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4851     MOVE X'2020233030303034363739' TO DFHEIV0(25:11)
  4852     CALL 'kxdfhei1' USING DFHEIV0,
  4853           DFHEIV99,
  4854           DFHEIV99,
  4855           DFHEIV99,
  4856           DFHEIV99,
  4857           DFHEIV99,
  4858           DFHEIV99
  4859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4860
  4861* goback
  4862
  4863     MOVE '9%                    "   ' TO DFHEIV0
  4864     MOVE 'WSMESS01' TO DFHEIV1
  4865     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4866     goback
  4867     .
  4868 0300-exit.
  4869     exit.
  4870 6000-CONNECT-TO-DB.
  4871***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4872***                                                            ***
  4873***                                                            ***
  4874***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4875     MOVE 'NTSQLTST2_CrtManage'  TO SVR
  4876     move 'sa'                   to usr
  4877     move 'sql2008r2'            to pass
  4878     if ws-kix-myenv = 'cid1p'
  4879        MOVE 'NTCSO2_CrtManage'  TO SVR
  4880        move 'sa'                to usr
  4881        move 'ntcso2'            to pass
  4882     end-if
  4883     string
  4884         usr delimited space
  4885         "." delimited size
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  86
* WSMESS01.cbl
  4886         pass delimited space into usr-pass
  4887     end-string
  4888     display ' About to connect to ' svr ' ' usr-pass
  4889     EXEC SQL
  4890        CONNECT TO :svr USER :usr-pass
  4891     END-EXEC
  4892     if sqlcode not = 0
  4893        display "Error: cannot connect to " svr
  4894        display sqlcode
  4895        display sqlerrmc
  4896     else
  4897        display ' Successful Connect ' sqlcode
  4898        set connected-to-db to true
  4899     end-if
  4900     .
  4901 6000-EXIT.
  4902     EXIT.
  4903 7000-GET-RATE.
  4904
  4905* EXEC CICS LINK
  4906*       PROGRAM ('ELRATE')
  4907*       COMMAREA (CALCULATION-PASS-AREA)
  4908*       LENGTH   (CP-COMM-LENGTH)
  4909*    END-EXEC
  4910     MOVE 'ELRATE' TO DFHEIV1
  4911*    MOVE '."C                   (   #00004718' TO DFHEIV0
  4912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4914     MOVE X'2020233030303034373138' TO DFHEIV0(25:11)
  4915     CALL 'kxdfhei1' USING DFHEIV0,
  4916           DFHEIV1,
  4917           CALCULATION-PASS-AREA,
  4918           CP-COMM-LENGTH,
  4919           DFHEIV99,
  4920           DFHEIV99,
  4921           DFHEIV99,
  4922           DFHEIV99
  4923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4924     .
  4925 7000-EXIT.
  4926     EXIT.
  4927 9700-DATE-LINK.
  4928
  4929* EXEC CICS LINK
  4930*         PROGRAM  ('ELDATCV')
  4931*         COMMAREA (DATE-CONVERSION-DATA)
  4932*         LENGTH   (DC-COMM-LENGTH)
  4933*    END-EXEC.
  4934     MOVE 'ELDATCV' TO DFHEIV1
  4935*    MOVE '."C                   (   #00004727' TO DFHEIV0
  4936     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4938     MOVE X'2020233030303034373237' TO DFHEIV0(25:11)
  4939     CALL 'kxdfhei1' USING DFHEIV0,
  4940           DFHEIV1,
  4941           DATE-CONVERSION-DATA,
  4942           DC-COMM-LENGTH,
  4943           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  87
* WSMESS01.cbl
  4944           DFHEIV99,
  4945           DFHEIV99,
  4946           DFHEIV99
  4947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4948
  4949 9700-EXIT.
  4950      EXIT.
  4951
  4952 9999-DFHBACK SECTION.
  4953     MOVE '9%                    "   ' TO DFHEIV0
  4954     MOVE 'WSMESS01' TO DFHEIV1
  4955     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4956     GOBACK.
  4957 9999-DFHEXIT.
  4958     IF DFHEIGDJ EQUAL 0001
  4959         NEXT SENTENCE.
  4960     MOVE '9%                    "   ' TO DFHEIV0
  4961     MOVE 'WSMESS01' TO DFHEIV1
  4962     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4963     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      144564     Code:       11301
