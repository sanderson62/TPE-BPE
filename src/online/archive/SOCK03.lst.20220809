* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100418  CR2018073000001  PEMA  REWORD REFUND METHODS
    54* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    55* 052319  IR2019052300001  PEMA  VIN&BENE not being passed at time
    56* 062119  CR2019050800001  PEMA  Add option to search by VIN
    57* 080519  IR2019080200001  PEMA  Allow multiple quotes by VIN
    58* 080919  IR2019080900001  PEMA  Shorten allowed Linkage Section
    59* 041720  IR2020041700001  PEMA  Change to not drop cert suffix.
    60* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    61******************************************************************
    62 environment division.
    63 data division.
    64 working-storage section.
    65 01  DFH-START PIC X(04).
    66*
    67* program buffers
    68*
    69 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    70     88  ALREADY-SENT              VALUE 'Y'.
    71 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   3
* SOCK03.cbl
    72 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    73     88  ELCERT-FINISHED            VALUE 'Y'.
    74 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    75 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    76     88  ERACCT-FOUND               VALUE 'Y'.
    77 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    78 77 ws-send-msg-size           pic s9(8) comp value 4096.
    79 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    80 77 ws-recv-buf                pic x(4096).
    81 77 ws-send-buf                pic x(4096) VALUE SPACES.
    82 77 ws-recv-total              pic s9(8) comp value 0.
    83 77 ws-recv-left               pic s9(8) comp value 0.
    84 77 ws-seq-num                 pic s9(8) comp value 0.
    85 77 ws-flags                   pic s9(8) comp value 0.
    86 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    87 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    88 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    89 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    90 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    91 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    92 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    93 77  ws-cancel-reason            pic x   value spaces.
    94 77  P1                          PIC S999 COMP-3 VALUE +0.
    95 77  P2                          PIC S999 COMP-3 VALUE +0.
    96 77  C0                          PIC S999 COMP-3 VALUE +0.
    97 77  C1                          PIC S999 COMP-3 VALUE +0.
    98 77  C2                          PIC S999 COMP-3 VALUE +0.
    99 77  C3                          PIC S999 COMP-3 VALUE +0.
   100 77 S1                           PIC S999 COMP-3 VALUE +0.
   101 77 S2                           PIC S999 COMP-3 VALUE +0.
   102 77 L1                           PIC S999 COMP-3 VALUE +0.
   103 77 L2                           PIC S999 COMP-3 VALUE +0.
   104 77 F1                           PIC S999 COMP-3 VALUE +0.
   105 77 WS-BUILD-SW                  PIC X.
   106    88  TIME-TO-BUILD               VALUE 'Y'.
   107 77 WS-SAVE-ERACCT               PIC X(2000).
   108 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   109 77 WS-STOP-SW                   PIC X  VALUE ' '.
   110    88  TOLD-TO-STOP               VALUE 'Y'.
   111 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   112    88  GET-RATES                    VALUE 'R'.
   113    88  GET-ACT-ACCTS                VALUE 'A'.
   114 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   115 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   116 77 ws-disp-rate                 pic z9.99999.
   117 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   118     88  END-OF-ERCTBL                 VALUE 'Y'.
   119 77  WS-STATUS                   PIC X.
   120 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   121 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   122 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   123 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   124 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   125 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   126 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   127 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   128 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   129 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   4
* SOCK03.cbl
   130 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   131 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   132     88  WS-ELCERT-FULL             VALUE '1'.
   133     88  WS-ELCERT-NAME             VALUE '2'.
   134     88  WS-ELCERT-CERT-NO          VALUE '3'.
   135     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   136     88  WS-ELCERT-VIN              value '5'.
   137 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   138 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   139     88  I-SAY-TO-STOP      VALUE 'Y'.
   140 77  WS-HEX-0A                   PIC X.
   141 77  WS-CALL-TYPE                PIC X(6).
   142 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   143 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   144 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   145 77  DD-IU-SW                    PIC X   VALUE ' '.
   146     88  DD-IU-PRESENT                 VALUE 'Y'.
   147 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   148 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   149 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   150 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   151 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   152 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   153 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   154 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   155 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   156     88  PDEF-FOUND                              VALUE 'Y'.
   157 77  ws-epiq-sw                  pic x  value ' '.
   158     88  ws-epiq-request           value 'Y'.
   159 77  ws-epiq-max                 pic s999 value +0 comp-3.
   160 01  WS-STRING-DATA.
   161     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   162     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   163     05  WS-CARRIER              PIC X        VALUE SPACES.
   164     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   165     05  WS-STATE                PIC XX       VALUE SPACES.
   166     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   167     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   168     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   169     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   170     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   171     05  WS-MID-INIT             PIC X        VALUE SPACES.
   172     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   173     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   174     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   175     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   176     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   177     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   178     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   179     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   180     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   181     05  WS-LF-METHOD            PIC X(15)    VALUE SPACES.
   182     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   183     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   184     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   185     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   186     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   187     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   5
* SOCK03.cbl
   188     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   189     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   190     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   191     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   192     05  WS-AH-METHOD            PIC X(15)    VALUE SPACES.
   193     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   194     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   195     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   196     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   197     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   198     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   199     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   200     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   201     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   202     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   203     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   204     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   205     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   206     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   207     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   208     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   209     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   210     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   211     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   212     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   213     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   214     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   215 01  ws-work-date.
   216     05  ws-work-ccyy            pic x(4).
   217     05  ws-work-mm              pic xx.
   218     05  ws-work-dd              pic xx.
   219 01  ws-work-date-num redefines ws-work-date
   220                                 pic 9(8).
   221 01  FILLER.
   222     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   223     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   224     12  WS-STATE-ABBREVIATION   PIC XX.
   225     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   226     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   227     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   228     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   229     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   230     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   231     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   232     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   233     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   234     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   235     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   236     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   237     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   238     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   239     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   240     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   241     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   242     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   243     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   244     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   245     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   6
* SOCK03.cbl
   246     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   247     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   248     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   249     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   250     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   251         88  WS-REDUCING                         VALUE 'R'.
   252         88  WS-LEVEL                            VALUE 'L'  'P'.
   253 01  ELMSTR-KEY.
   254     12  ELMSTR-COMP-CD          PIC X.
   255     12  ELMSTR-CERT-NO          PIC X(11).
   256 01  CTBL-KEY-SAVE               PIC X(5).
   257 01  CTBL-KEY.
   258     05  CTBL-COMPANY-CD         PIC X.
   259     05  CTBL-TABLE              PIC XXX.
   260     05  CTBL-BEN-TYPE           PIC X.
   261     05  CTBL-BEN-CODE           PIC XX.
   262 01  ERPDEF-KEY-SAVE             PIC X(18).
   263 01  ERPDEF-KEY.
   264     12  ERPDEF-COMPANY-CD       PIC X.
   265     12  ERPDEF-STATE            PIC XX.
   266     12  ERPDEF-PROD-CD          PIC XXX.
   267     12  F                       PIC X(7).
   268     12  ERPDEF-BEN-TYPE         PIC X.
   269     12  ERPDEF-BEN-CODE         PIC XX.
   270     12  ERPDEF-EXP-DT           PIC XX.
   271 01  WS-AM3-KEY.
   272     12  WS-AM3-ACCOUNT          PIC X(10).
   273     12  WS-AM3-EXP-DT           PIC XX.
   274 01  WS-AM-KEY.
   275     12  WS-AM-COMPANY-CD        PIC X.
   276     12  WS-AM-CARRIER           PIC X.
   277     12  WS-AM-GROUPING          PIC X(6).
   278     12  WS-AM-STATE             PIC XX.
   279     12  WS-AM-ACCOUNT           PIC X(10).
   280     12  WS-AM-EXPIRATION-DT     PIC XX.
   281     12  WS-AM-FILLER            PIC XXXX.
   282 01  WS-CO-DATA.
   283     05  WS-CO-NUM               PIC X(10).
   284     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   285     05  WS-CO-NAME              PIC X(30).
   286     05  WS-CO-MAIL-NAME         PIC X(30).
   287     05  WS-CO-ADDR1             PIC X(30).
   288     05  WS-CO-ADDR2             PIC X(30).
   289     05  WS-CO-ADDR3             PIC X(30).
   290     05  WS-CO-ZIP               PIC X(9).
   291     05  WS-CO-PHONE             PIC X(10).
   292 01  WS-CF-KEY.
   293     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   294     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   295*        88  COMPANY-MASTER                      VALUE '1'.
   296*        88  STATE-MASTER                        VALUE '3'.
   297*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   298*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   299     12  WS-CF-ACCESS.
   300         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   301         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   302             20  FILLER          PIC  X(01).
   303             20  WS-CF-CARRIER   PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   7
* SOCK03.cbl
   304     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   305 01  WS-CS-KEY.
   306     05  WS-CS-COMPANY-CD        PIC X.
   307     05  WS-CS-CARRIER           PIC X.
   308     05  WS-CS-GROUP             PIC X(6).
   309     05  WS-CS-STATE             PIC XX.
   310     05  WS-CS-ACCOUNT           PIC X(10).
   311     05  WS-CS-EFF-DT            PIC XX.
   312     05  WS-CS-CERT-NO           PIC X(11).
   313     05  WS-CS-TRLR-TYPE         PIC X.
   314 01  WS-MA-KEY.
   315     05  WS-MA-COMPANY-CD        PIC X.
   316     05  WS-MA-CARRIER           PIC X.
   317     05  WS-MA-GROUP             PIC X(6).
   318     05  WS-MA-STATE             PIC XX.
   319     05  WS-MA-ACCOUNT           PIC X(10).
   320     05  WS-MA-EFF-DT            PIC XX.
   321     05  WS-MA-CERT-NO           PIC X(11).
   322 01  WS-CM-KEY.
   323     05  WS-CM-COMPANY-CD        PIC X.
   324     05  WS-CM-CARRIER           PIC X.
   325     05  WS-CM-GROUP             PIC X(6).
   326     05  WS-CM-STATE             PIC XX.
   327     05  WS-CM-ACCOUNT           PIC X(10).
   328     05  WS-CM-EFF-DT            PIC XX.
   329     05  WS-CM-CERT-NO           PIC X(11).
   330 01  WS-CM-KEY-A1.
   331     05  WS-CM-COMPANY-CD-A1     PIC X.
   332     05  WS-CM-LAST-NAME         PIC X(15).
   333     05  WS-CM-INITIALS          PIC XX.
   334 01  WS-CM-KEY-A4.
   335     05  WS-CM-COMPANY-CD-A4     PIC X.
   336     05  WS-CM-CERT-NO-A4        PIC X(11).
   337 01  WS-CID-NO                   PIC X(8).
   338 01  soc-client-in-data.
   339     05  CLIENT-CAR              PIC X.
   340     05  CLIENT-GRP              PIC X(6).
   341     05  CLIENT-STATE            PIC XX.
   342     05  CLIENT-ACCOUNT          PIC X(10).
   343     05  CLIENT-EFF-DT           PIC X(8).  *> ccyymmdd
   344     05  CLIENT-CERT-NO          PIC X(11).
   345     05  CLIENT-LAST-NAME        PIC X(15).
   346     05  CLIENT-FIRST-NAME       PIC X(10).
   347     05  CLIENT-VAL-DT           PIC X(8).  *> ccyymmdd
   348     05  CLIENT-CAN-REASON       PIC X.
   349     05  client-vin              pic x(17).
   350 01  WS-DISP-RESP                PIC 9(5).
   351 01  WS-RESPONSE                 PIC S9(8)   COMP.
   352     88  RESP-NORMAL                  VALUE +00.
   353     88  RESP-NOTFND                  VALUE +13.
   354     88  RESP-DUPKEY                  VALUE +15.
   355     88  RESP-NOTOPEN                 VALUE +19.
   356     88  RESP-ENDFILE                 VALUE +20.
   357*                                 COPY ELCCERT.
   358******************************************************************
   359*                                                                *
   360*                            ELCCERT.                            *
   361*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   8
* SOCK03.cbl
   362*                            VMOD=2.013                          *
   363*                                                                *
   364*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   365*                                                                *
   366*   FILE TYPE = VSAM,KSDS                                        *
   367*   RECORD SIZE = 450  RECFORM = FIXED                           *
   368*                                                                *
   369*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   370*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   371*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   372*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   373*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   374*                                                                *
   375*   LOG = YES                                                    *
   376*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   377******************************************************************
   378*                   C H A N G E   L O G
   379*
   380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   381*-----------------------------------------------------------------
   382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   383* EFFECTIVE    NUMBER
   384*-----------------------------------------------------------------
   385* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   386* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   387* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   388* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   389* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   390* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   391* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   392* 032612  CR2011110200001  PEMA  AHL CHANGES
   393* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   394* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   395* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   396******************************************************************
   397
   398 01  CERTIFICATE-MASTER.
   399     12  CM-RECORD-ID                      PIC XX.
   400         88  VALID-CM-ID                      VALUE 'CM'.
   401
   402     12  CM-CONTROL-PRIMARY.
   403         16  CM-COMPANY-CD                 PIC X.
   404         16  CM-CARRIER                    PIC X.
   405         16  CM-GROUPING.
   406             20  CM-GROUPING-PREFIX        PIC X(3).
   407             20  CM-GROUPING-PRIME         PIC X(3).
   408         16  CM-STATE                      PIC XX.
   409         16  CM-ACCOUNT.
   410             20  CM-ACCOUNT-PREFIX         PIC X(4).
   411             20  CM-ACCOUNT-PRIME          PIC X(6).
   412         16  CM-CERT-EFF-DT                PIC XX.
   413         16  CM-CERT-NO.
   414             20  CM-CERT-PRIME             PIC X(10).
   415             20  CM-CERT-SFX               PIC X.
   416
   417     12  CM-CONTROL-BY-NAME.
   418         16  CM-COMPANY-CD-A1              PIC X.
   419         16  CM-INSURED-LAST-NAME          PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page   9
* SOCK03.cbl
   420         16  CM-INSURED-INITIALS.
   421             20  CM-INSURED-INITIAL1       PIC X.
   422             20  CM-INSURED-INITIAL2       PIC X.
   423
   424     12  CM-CONTROL-BY-SSN.
   425         16  CM-COMPANY-CD-A2              PIC X.
   426         16  CM-SOC-SEC-NO.
   427             20  CM-SSN-STATE              PIC XX.
   428             20  CM-SSN-ACCOUNT            PIC X(6).
   429             20  CM-SSN-LN3.
   430                 25  CM-INSURED-INITIALS-A2.
   431                     30 CM-INSURED-INITIAL1-A2   PIC X.
   432                     30 CM-INSURED-INITIAL2-A2   PIC X.
   433                 25 CM-PART-LAST-NAME-A2         PIC X.
   434
   435     12  CM-CONTROL-BY-CERT-NO.
   436         16  CM-COMPANY-CD-A4              PIC X.
   437         16  CM-CERT-NO-A4                 PIC X(11).
   438
   439     12  CM-CONTROL-BY-MEMB.
   440         16  CM-COMPANY-CD-A5              PIC X.
   441         16  CM-MEMBER-NO.
   442             20  CM-MEMB-STATE             PIC XX.
   443             20  CM-MEMB-ACCOUNT           PIC X(6).
   444             20  CM-MEMB-LN4.
   445                 25  CM-INSURED-INITIALS-A5.
   446                     30 CM-INSURED-INITIAL1-A5   PIC X.
   447                     30 CM-INSURED-INITIAL2-A5   PIC X.
   448                 25 CM-PART-LAST-NAME-A5         PIC XX.
   449
   450     12  CM-INSURED-PROFILE-DATA.
   451         16  CM-INSURED-FIRST-NAME.
   452             20  CM-INSURED-1ST-INIT       PIC X.
   453             20  FILLER                    PIC X(9).
   454         16  CM-INSURED-ISSUE-AGE          PIC 99.
   455         16  CM-INSURED-SEX                PIC X.
   456             88  CM-SEX-MALE                  VALUE 'M'.
   457             88  CM-SEX-FEMAL                 VALUE 'F'.
   458         16  CM-INSURED-JOINT-AGE          PIC 99.
   459         16  CM-JOINT-INSURED-NAME.
   460             20  CM-JT-LAST-NAME           PIC X(15).
   461             20  CM-JT-FIRST-NAME.
   462                 24  CM-JT-1ST-INIT        PIC X.
   463                 24  FILLER                PIC X(9).
   464             20  CM-JT-INITIAL             PIC X.
   465
   466     12  CM-LIFE-DATA.
   467         16  CM-LF-BENEFIT-CD              PIC XX.
   468         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   469         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   470         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   471         16  CM-LF-DEV-CODE                PIC XXX.
   472         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   473         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   474         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   475         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   476         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   477         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  10
* SOCK03.cbl
   478         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   479         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   480         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   481         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   482         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   483         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   484         16  cm-temp-epiq                  pic xx.
   485             88  EPIQ-CLASS                  value 'EQ'.
   486*        16  FILLER                        PIC XX.
   487
   488     12  CM-AH-DATA.
   489         16  CM-AH-BENEFIT-CD              PIC XX.
   490         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   491         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   492         16  CM-AH-DEV-CODE                PIC XXX.
   493         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   494         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   495         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   496         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   497         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   498         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   499         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   500         16  CM-AH-PAID-THRU-DT            PIC XX.
   501             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   502         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   503         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   504         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   505         16  FILLER                        PIC X.
   506
   507     12  CM-LOAN-INFORMATION.
   508         16  CM-LIVES                      PIC S9(7)     COMP-3.
   509         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   510                                           PIC S9(5)V99  COMP-3.
   511         16  CM-BILLED                     PIC S9(7)     COMP-3.
   512         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   513         16  CM-PAY-FREQUENCY              PIC S99.
   514         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   515         16  CM-RATE-CLASS                 PIC XX.
   516         16  CM-BENEFICIARY                PIC X(25).
   517         16  CM-POLICY-FORM-NO             PIC X(12).
   518         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   519         16  CM-LAST-ADD-ON-DT             PIC XX.
   520         16  CM-DEDUCTIBLE-AMOUNTS.
   521             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   522             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   523         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   524             20  CM-RESIDENT-STATE         PIC XX.
   525             20  CM-RATE-CODE              PIC X(4).
   526             20  FILLER                    PIC XX.
   527         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   528             20  CM-LOAN-OFFICER           PIC X(5).
   529             20  FILLER                    PIC XXX.
   530         16  CM-CSR-CODE                   PIC XXX.
   531         16  CM-UNDERWRITING-CODE          PIC X.
   532             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   533         16  CM-POST-CARD-IND              PIC X.
   534         16  CM-REF-INTERFACE-SW           PIC X.
   535         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  11
* SOCK03.cbl
   536             88  CM-SING-PRM                  VALUE '1'.
   537             88  CM-O-B-COVERAGE              VALUE '2'.
   538             88  CM-OPEN-END                  VALUE '3'.
   539         16  CM-IND-GRP-TYPE               PIC X.
   540             88  CM-INDIVIDUAL                VALUE 'I'.
   541             88  CM-GROUP                     VALUE 'G'.
   542         16  CM-SKIP-CODE                  PIC X.
   543             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   544             88  SKIP-JULY                    VALUE '1'.
   545             88  SKIP-AUGUST                  VALUE '2'.
   546             88  SKIP-SEPTEMBER               VALUE '3'.
   547             88  SKIP-JULY-AUG                VALUE '4'.
   548             88  SKIP-AUG-SEPT                VALUE '5'.
   549             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   550             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   551             88  SKIP-JUNE                    VALUE '8'.
   552             88  SKIP-JUNE-JULY               VALUE '9'.
   553             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   554             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   555         16  CM-PAYMENT-MODE               PIC X.
   556             88  PAY-MONTHLY                  VALUE SPACE.
   557             88  PAY-WEEKLY                   VALUE '1'.
   558             88  PAY-SEMI-MONTHLY             VALUE '2'.
   559             88  PAY-BI-WEEKLY                VALUE '3'.
   560             88  PAY-SEMI-ANUALLY             VALUE '4'.
   561         16  CM-LOAN-NUMBER                PIC X(8).
   562         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   563         16  CM-OLD-LOF                    PIC XXX.
   564*        16  CM-LOAN-OFFICER               PIC XXX.
   565         16  CM-REIN-TABLE                 PIC XXX.
   566         16  CM-SPECIAL-REIN-CODE          PIC X.
   567         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   568         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   569         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   570
   571     12  CM-STATUS-DATA.
   572         16  CM-ENTRY-STATUS               PIC X.
   573         16  CM-ENTRY-DT                   PIC XX.
   574
   575         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   576         16  CM-LF-CANCEL-DT               PIC XX.
   577         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   578
   579         16  CM-LF-STATUS-AT-DEATH         PIC X.
   580         16  CM-LF-DEATH-DT                PIC XX.
   581         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   582
   583         16  CM-LF-CURRENT-STATUS          PIC X.
   584             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   585                                                'M' '4' '5' '9'.
   586             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   587             88  CM-LF-POLICY-PENDING         VALUE '2'.
   588             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   589             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   590             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   591             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   592             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   593             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  12
* SOCK03.cbl
   594             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   595             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   596             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   597             88  CM-LF-DECLINED               VALUE 'D'.
   598             88  CM-LF-VOIDED                 VALUE 'V'.
   599
   600         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   601         16  CM-AH-CANCEL-DT               PIC XX.
   602         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   603
   604         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   605         16  CM-AH-SETTLEMENT-DT           PIC XX.
   606         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   607
   608         16  CM-AH-CURRENT-STATUS          PIC X.
   609             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   610                                                'M' '4' '5' '9'.
   611             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   612             88  CM-AH-POLICY-PENDING         VALUE '2'.
   613             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   614             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   615             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   616             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   617             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   618             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   619             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   620             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   621             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   622             88  CM-AH-DECLINED               VALUE 'D'.
   623             88  CM-AH-VOIDED                 VALUE 'V'.
   624
   625         16  CM-CLAIM-INTERFACE-SW         PIC X.
   626             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   627             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   628             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   629         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   630
   631         16  CM-ENTRY-BATCH                PIC X(6).
   632         16  CM-LF-EXIT-BATCH              PIC X(6).
   633         16  CM-AH-EXIT-BATCH              PIC X(6).
   634         16  CM-LAST-MONTH-END             PIC XX.
   635
   636     12  CM-NOTE-SW                        PIC X.
   637         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   638         88  CERT-NOTES-PRESENT               VALUE '1'.
   639         88  BILLING-NOTES-PRESENT            VALUE '2'.
   640         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   641         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   642         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   643         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   644         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   645     12  CM-COMP-EXCP-SW                   PIC X.
   646         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   647         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   648     12  CM-INSURED-ADDRESS-SW             PIC X.
   649         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   650         88  INSURED-ADDR-PRESENT             VALUE '1'.
   651
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  13
* SOCK03.cbl
   652*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   653     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   654     12  FILLER                            PIC X.
   655
   656*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   657     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   658     12  FILLER                            PIC X.
   659*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   660     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   661
   662     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   663         88  CERT-ADDED-BATCH                 VALUE ' '.
   664         88  CERT-ADDED-ONLINE                VALUE '1'.
   665         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   666         88  CERT-PURGED-OFFLINE              VALUE '3'.
   667         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   668     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   669         88  CERT-AS-LOADED                   VALUE ' '.
   670         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   671         88  CERT-CLAIM-ONLINE                VALUE '2'.
   672         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   673         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   674         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   675         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   676         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   677
   678     12  CM-ACCOUNT-COMM-PCTS.
   679         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   680         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   681
   682     12  CM-USER-FIELD                     PIC X.
   683     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   684     12  CM-CLP-STATE                      PIC XX.
   685     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   686     12  CM-USER-RESERVED                  PIC XXX.
   687     12  FILLER REDEFINES CM-USER-RESERVED.
   688         16  CM-AH-CLASS-CD                PIC XX.
   689         16  F                             PIC X.
   690******************************************************************
   691*                                 COPY ELCMSTR.
   692******************************************************************
   693*                                                                *
   694*                            ELCMSTR.                            *
   695*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   696*                            VMOD=2.012                          *
   697*                                                                *
   698*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   699*                                                                *
   700*   FILE TYPE = VSAM,KSDS                                        *
   701*   RECORD SIZE = 350  RECFORM = FIXED                           *
   702*                                                                *
   703*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   704*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   705*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   706*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   707*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   708*                                                 RKP=75,LEN=21  *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  14
* SOCK03.cbl
   710*   **** NOTE ****                                               *
   711*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   712*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   713*                                                                *
   714*   LOG = YES                                                    *
   715*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   716******************************************************************
   717*                   C H A N G E   L O G
   718*
   719* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   720*-----------------------------------------------------------------
   721*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   722* EFFECTIVE    NUMBER
   723*-----------------------------------------------------------------
   724* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   725* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   726* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   727* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   728* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   729* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   730* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   731******************************************************************
   732 01  CLAIM-MASTER.
   733     12  CL-RECORD-ID                PIC XX.
   734         88  VALID-CL-ID         VALUE 'CL'.
   735
   736     12  CL-CONTROL-PRIMARY.
   737         16  CL-COMPANY-CD           PIC X.
   738         16  CL-CARRIER              PIC X.
   739         16  CL-CLAIM-NO             PIC X(7).
   740         16  CL-CERT-NO.
   741             20  CL-CERT-PRIME       PIC X(10).
   742             20  CL-CERT-SFX         PIC X.
   743
   744     12  CL-CONTROL-BY-NAME.
   745         16  CL-COMPANY-CD-A1        PIC X.
   746         16  CL-INSURED-LAST-NAME    PIC X(15).
   747         16  CL-INSURED-NAME.
   748             20  CL-INSURED-1ST-NAME PIC X(12).
   749             20  CL-INSURED-MID-INIT PIC X.
   750
   751     12  CL-CONTROL-BY-SSN.
   752         16  CL-COMPANY-CD-A2        PIC X.
   753         16  CL-SOC-SEC-NO.
   754             20  CL-SSN-STATE        PIC XX.
   755             20  CL-SSN-ACCOUNT      PIC X(6).
   756             20  CL-SSN-LN3          PIC X(3).
   757
   758     12  CL-CONTROL-BY-CERT-NO.
   759         16  CL-COMPANY-CD-A4        PIC X.
   760         16  CL-CERT-NO-A4.
   761             20  CL-CERT-A4-PRIME    PIC X(10).
   762             20  CL-CERT-A4-SFX      PIC X.
   763
   764     12  CL-CONTROL-BY-CCN.
   765         16  CL-COMPANY-CD-A5        PIC X.
   766         16  CL-CCN-A5.
   767             20  CL-CCN.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  15
* SOCK03.cbl
   768                 24  CL-CCN-PREFIX-A5 PIC X(4).
   769                 24  CL-CCN-PRIME-A5 PIC X(12).
   770             20  CL-CCN-FILLER-A5    PIC X(4).
   771
   772     12  CL-INSURED-PROFILE-DATA.
   773         16  CL-INSURED-BIRTH-DT     PIC XX.
   774         16  CL-INSURED-SEX-CD       PIC X.
   775             88  INSURED-IS-MALE        VALUE 'M'.
   776             88  INSURED-IS-FEMALE      VALUE 'F'.
   777             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   778         16  CL-INSURED-OCC-CD       PIC X(6).
   779         16  FILLER                  PIC X(5).
   780
   781     12  CL-PROCESSING-INFO.
   782         16  CL-PROCESSOR-ID         PIC X(4).
   783         16  CL-CLAIM-STATUS         PIC X.
   784             88  CLAIM-IS-OPEN          VALUE 'O'.
   785             88  CLAIM-IS-CLOSED        VALUE 'C'.
   786         16  CL-CLAIM-TYPE           PIC X.
   787*            88  AH-CLAIM               VALUE 'A'.
   788*            88  LIFE-CLAIM             VALUE 'L'.
   789*            88  PROPERTY-CLAIM         VALUE 'P'.
   790*            88  IUI-CLAIM              VALUE 'I'.
   791*            88  GAP-CLAIM              VALUE 'G'.
   792*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   793*            88  OTHER-CLAIM            VALUE 'O'.
   794         16  CL-CLAIM-PREM-TYPE      PIC X.
   795             88  SINGLE-PREMIUM         VALUE '1'.
   796             88  O-B-COVERAGE           VALUE '2'.
   797             88  OPEN-END-COVERAGE      VALUE '3'.
   798         16  CL-INCURRED-DT          PIC XX.
   799         16  CL-REPORTED-DT          PIC XX.
   800         16  CL-FILE-ESTABLISH-DT    PIC XX.
   801         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   802         16  CL-LAST-PMT-DT          PIC XX.
   803         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   804         16  CL-PAID-THRU-DT         PIC XX.
   805         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   806         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   807         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   808         16  CL-PMT-CALC-METHOD      PIC X.
   809             88  CL-360-DAY-YR          VALUE '1'.
   810             88  CL-365-DAY-YR          VALUE '2'.
   811             88  CL-FULL-MONTHS         VALUE '3'.
   812         16  CL-CAUSE-CD             PIC X(6).
   813
   814         16  CL-PRIME-CERT-NO.
   815             20  CL-PRIME-CERT-PRIME PIC X(10).
   816             20  CL-PRIME-CERT-SFX   PIC X.
   817
   818         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   819             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   820             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   821
   822         16  CL-MICROFILM-NO         PIC X(10).
   823         16  FILLER REDEFINES CL-MICROFILM-NO.
   824             20  CL-BENEFIT-PERIOD   PIC 99.
   825             20  FILLER              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  16
* SOCK03.cbl
   826         16  CL-PROG-FORM-TYPE       PIC X.
   827         16  CL-LAST-ADD-ON-DT       PIC XX.
   828
   829         16  CL-LAST-REOPEN-DT       PIC XX.
   830         16  CL-LAST-CLOSE-DT        PIC XX.
   831         16  CL-LAST-CLOSE-REASON    PIC X(01).
   832             88  FINAL-PAID             VALUE '1'.
   833             88  CLAIM-DENIED           VALUE '2'.
   834             88  AUTO-CLOSE             VALUE '3'.
   835             88  MANUAL-CLOSE           VALUE '4'.
   836             88  BENEFITS-CHANGED       VALUE 'C'.
   837             88  SETUP-ERRORS           VALUE 'E'.
   838         16  CL-ASSOC-CERT-SEQU      PIC S99.
   839         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   840         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   841             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   842         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   843         16  FILLER                  PIC X.
   844
   845     12  CL-CERTIFICATE-DATA.
   846         16  CL-CERT-ORIGIN          PIC X.
   847             88  CERT-WAS-ONLINE        VALUE '1'.
   848             88  CERT-WAS-CREATED       VALUE '2'.
   849             88  COVERAGE-WAS-ADDED     VALUE '3'.
   850         16  CL-CERT-KEY-DATA.
   851             20  CL-CERT-CARRIER     PIC X.
   852             20  CL-CERT-GROUPING    PIC X(6).
   853             20  CL-CERT-STATE       PIC XX.
   854             20  CL-CERT-ACCOUNT.
   855                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   856                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   857             20  CL-CERT-EFF-DT      PIC XX.
   858
   859     12  CL-STATUS-CONTROLS.
   860         16  CL-PRIORITY-CD          PIC X.
   861             88  CONFIDENTIAL-DATA      VALUE '8'.
   862             88  HIGHEST-PRIORITY       VALUE '9'.
   863         16  CL-SUPV-ATTN-CD         PIC X.
   864             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   865             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   866         16  CL-PURGED-DT            PIC XX.
   867         16  CL-RESTORED-DT          PIC XX.
   868         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   869         16  CL-NEXT-RESEND-DT       PIC XX.
   870         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   871         16  CL-CRITICAL-PERIOD      PIC 99.
   872*        16  FILLER                  PIC XX.
   873         16  CL-LAST-MAINT-DT        PIC XX.
   874         16  CL-LAST-MAINT-USER      PIC X(4).
   875         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   876         16  CL-LAST-MAINT-TYPE      PIC X.
   877             88  CLAIM-SET-UP           VALUE ' '.
   878             88  PAYMENT-MADE           VALUE '1'.
   879             88  LETTER-SENT            VALUE '2'.
   880             88  MASTER-WAS-ALTERED     VALUE '3'.
   881             88  MASTER-WAS-RESTORED    VALUE '4'.
   882             88  INCURRED-DATE-CHANGED  VALUE '5'.
   883             88  FILE-CONVERTED         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  17
* SOCK03.cbl
   884             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   885             88  ERROR-CORRECTION       VALUE 'E'.
   886         16  CL-RELATED-CLAIM-NO     PIC X(7).
   887         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   888         16  CL-BENEFICIARY          PIC X(10).
   889         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   890         16  CL-DENIAL-TYPE          PIC X.
   891             88  CL-TYPE-DENIAL          VALUE '1'.
   892             88  CL-TYPE-RESCISSION      VALUE '2'.
   893             88  CL-TYPE-REFORMATION     VALUE '3'.
   894             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   895             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   896         16  CL-NO-OF-EXTENSIONS     PIC 99.
   897         16  filler                  pic x(3).
   898*        16  CL-CRIT-PER-RECURRENT   PIC X.
   899*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   900*        16  CL-RTW-DT               PIC XX.
   901
   902     12  CL-TRAILER-CONTROLS.
   903         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   904             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   905             88  CL-LAST-TRL-AVAIL      VALUE +100.
   906             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   907         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   908         16  FILLER                  PIC XX.
   909         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   910         16  CL-ADDRESS-TRAILER-CNT.
   911             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   912                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   913             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   914                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   915             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   916                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   917             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   918                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   919             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   920                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   921             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   922                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   923             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   924                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   925
   926     12  CL-CV-REFERENCE-NO.
   927         16  CL-CV-REFNO-PRIME       PIC X(18).
   928         16  CL-CV-REFNO-SFX         PIC XX.
   929
   930     12  CL-FILE-LOCATION            PIC X(4).
   931
   932     12  CL-PROCESS-ERRORS.
   933         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   934             88  NO-FATAL-ERRORS        VALUE ZERO.
   935         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   936             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   937
   938     12  CL-PRODUCT-CD               PIC X.
   939
   940     12  CL-CURRENT-KEY-DATA.
   941         16  CL-CURRENT-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  18
* SOCK03.cbl
   942         16  CL-CURRENT-GROUPING     PIC X(6).
   943         16  CL-CURRENT-STATE        PIC XX.
   944         16  CL-CURRENT-ACCOUNT      PIC X(10).
   945
   946     12  CL-ASSOCIATES               PIC X.
   947         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   948         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   949         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   950         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   951
   952     12  CL-ACTIVITY-CODE            PIC 99.
   953     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   954     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   955
   956     12  CL-LAPSE-REPORT-CODE        PIC 9.
   957     12  CL-LAG-REPORT-CODE          PIC 9.
   958     12  CL-LOAN-TYPE                PIC XX.
   959     12  CL-LEGAL-STATE              PIC XX.
   960
   961     12  CL-YESNOSW                  PIC X.
   962     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   963         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   964         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   965         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   966     12  cl-insured-type             pic x.
   967         88  cl-claim-on-primary         value 'P'.
   968         88  cl-claim-on-co-borrower     value 'C'.
   969     12  cl-benefit-expiration-dt    PIC XX.
   970*                                 COPY ERCPDEF.
   971******************************************************************
   972*                                                                *
   973*                                                                *
   974*                            ERCPDEF.                            *
   975*                                                                *
   976*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   977*                                                                *
   978*    FILE TYPE = VSAM,KSDS                                       *
   979*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   980*                                                                *
   981*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   982*                                                                *
   983*    LOG = YES                                                   *
   984*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   985******************************************************************
   986*                   C H A N G E   L O G
   987*
   988* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   989*-----------------------------------------------------------------
   990*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   991* EFFECTIVE    NUMBER
   992*-----------------------------------------------------------------
   993* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   994* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   995* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   996* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   997******************************************************************
   998 01  PRODUCT-MASTER.
   999    12  PD-RECORD-ID                 PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  19
* SOCK03.cbl
  1000        88  VALID-PD-ID                  VALUE 'PD'.
  1001    12  PD-CONTROL-PRIMARY.
  1002        16  PD-COMPANY-CD            PIC X.
  1003        16  PD-STATE                 PIC XX.
  1004        16  PD-PRODUCT-CD            PIC XXX.
  1005        16  PD-FILLER                PIC X(7).
  1006        16  PD-BEN-TYPE              PIC X.
  1007        16  PD-BEN-CODE              PIC XX.
  1008        16  PD-PROD-EXP-DT           PIC XX.
  1009    12  FILLER                       PIC X(50).
  1010    12  PD-PRODUCT-DATA OCCURS 8.
  1011        16  PD-PROD-CODE             PIC X.
  1012            88  PD-PROD-LIFE           VALUE 'L'.
  1013            88  PD-PROD-PROP           VALUE 'P'.
  1014            88  PD-PROD-AH             VALUE 'A'.
  1015            88  PD-PROD-IU             VALUE 'I'.
  1016            88  PD-PROD-GAP            VALUE 'G'.
  1017            88  PD-PROD-FAML           VALUE 'F'.
  1018            88  PD-PROD-OTH            VALUE 'O'.
  1019        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1020        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1021        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1022        16  PD-MAX-TERM              PIC S999        COMP-3.
  1023        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1024        16  FILLER                   PIC X.
  1025        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1026        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1027        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1028        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1029        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1030        16  PD-REC-CRIT-PERIOD       PIC 99.
  1031        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1032            20  PD-RECURRING-YN      PIC X.
  1033            20  FILLER               PIC X.
  1034        16  PD-RTW-MOS               PIC 99.
  1035        16  PD-MAX-EXTENSION         PIC 99.
  1036        16  pd-ben-pct               pic sv999 comp-3.
  1037*       16  FILLER                   PIC XX.
  1038    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1039    12  PD-TERM-LIMITS OCCURS 15.
  1040        16  PD-LOW-TERM              PIC S999        COMP-3.
  1041        16  PD-HI-TERM               PIC S999        COMP-3.
  1042*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1043    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1044        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1045        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1046    12  PD-EARN-FACTORS.
  1047        16  FILLER OCCURS 15.
  1048            20  FILLER OCCURS 15.
  1049                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1050    12  PD-PRODUCT-DESC              PIC X(80).
  1051    12  PD-TRUNCATED                 PIC X.
  1052    12  FILLER                       PIC X(59).
  1053    12  PD-MAINT-INFORMATION.
  1054        16  PD-LAST-MAINT-DT         PIC X(02).
  1055        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1056        16  PD-LAST-MAINT-BY         PIC X(04).
  1057*                                 COPY ERCCTBL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  20
* SOCK03.cbl
  1058******************************************************************
  1059*                                                                *
  1060*                                                                *
  1061*                            ERCCTBL                             *
  1062*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1063*                            VMOD=2.003
  1064*                                                                *
  1065*   ONLINE CREDIT SYSTEM                                         *
  1066*                                                                *
  1067*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1068*                                                                *
  1069*   FILE TYPE = VSAM,KSDS                                        *
  1070*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1071*                                                                *
  1072*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1073*       ALTERNATE PATH = NONE                                    *
  1074*                                                                *
  1075*   LOG = NO                                                     *
  1076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1077*                                                                *
  1078*                                                                *
  1079******************************************************************
  1080
  1081 01  COMM-TABLE-RECORD.
  1082     12  CT-RECORD-ID                      PIC XX.
  1083         88  VALID-CT-ID                      VALUE 'CT'.
  1084
  1085     12  CT-CONTROL-PRIMARY.
  1086         16  CT-COMPANY-CD                 PIC X.
  1087         16  CT-TABLE                      PIC XXX.
  1088         16  CT-CNTRL-2.
  1089             20  CT-BEN-TYPE               PIC X.
  1090             20  CT-BEN-CODE               PIC XX.
  1091
  1092     12  CT-MAINT-INFORMATION.
  1093         16  CT-LAST-MAINT-DT              PIC XX.
  1094         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1095         16  CT-LAST-MAINT-USER            PIC X(4).
  1096         16  FILLER                        PIC X(31).
  1097
  1098     12  CT-LIMITS.
  1099         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1100
  1101         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1102
  1103         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1104
  1105     12  CT-RATES.
  1106         16  CT-RTX          OCCURS 27 TIMES.
  1107             20  CT-RT                     PIC SV9(5)     COMP-3.
  1108             20  CT-RT-R   REDEFINES
  1109                 CT-RT                     PIC XXX.
  1110
  1111     12  FILLER                            PIC  X(42).
  1112
  1113******************************************************************
  1114*                                 COPY ELCCNTL.
  1115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  21
* SOCK03.cbl
  1116*                                                                *
  1117*                                                                *
  1118*                            ELCCNTL.                            *
  1119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1120*                            VMOD=2.059                          *
  1121*                                                                *
  1122*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1123*                                                                *
  1124*   FILE TYPE = VSAM,KSDS                                        *
  1125*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1126*                                                                *
  1127*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1128*       ALTERNATE INDEX = NONE                                   *
  1129*                                                                *
  1130*   LOG = YES                                                    *
  1131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1132******************************************************************
  1133*                   C H A N G E   L O G
  1134*
  1135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1136*-----------------------------------------------------------------
  1137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1138* EFFECTIVE    NUMBER
  1139*-----------------------------------------------------------------
  1140* 082503                   PEMA  ADD BENEFIT GROUP
  1141* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1142* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1143* 092705    2005050300006  PEMA  ADD SPP LEASES
  1144* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1145* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1146* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1147* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1148* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1149* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1150* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1151* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1152* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1153* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1154* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1155******************************************************************
  1156*
  1157 01  CONTROL-FILE.
  1158     12  CF-RECORD-ID                       PIC XX.
  1159         88  VALID-CF-ID                        VALUE 'CF'.
  1160
  1161     12  CF-CONTROL-PRIMARY.
  1162         16  CF-COMPANY-ID                  PIC XXX.
  1163         16  CF-RECORD-TYPE                 PIC X.
  1164             88  CF-COMPANY-MASTER              VALUE '1'.
  1165             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1166             88  CF-STATE-MASTER                VALUE '3'.
  1167             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1168             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1169             88  CF-CARRIER-MASTER              VALUE '6'.
  1170             88  CF-MORTALITY-MASTER            VALUE '7'.
  1171             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1172             88  CF-TERMINAL-MASTER             VALUE '9'.
  1173             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  22
* SOCK03.cbl
  1174             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1175             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1176             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1177             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1178             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1179             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1180             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1181             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1182         16  CF-ACCESS-CD-GENL              PIC X(4).
  1183         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1184             20  CF-PROCESSOR               PIC X(4).
  1185         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1186             20  CF-STATE-CODE              PIC XX.
  1187             20  FILLER                     PIC XX.
  1188         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1189             20  FILLER                     PIC XX.
  1190             20  CF-HI-BEN-IN-REC           PIC XX.
  1191         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1192             20  FILLER                     PIC XXX.
  1193             20  CF-CARRIER-CNTL            PIC X.
  1194         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1195             20  FILLER                     PIC XX.
  1196             20  CF-HI-TYPE-IN-REC          PIC 99.
  1197         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1198             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1199                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1200             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1201             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1202         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1203             20  FILLER                     PIC X.
  1204             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1205         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1206             20  FILLER                     PIC XX.
  1207             20  CF-MORTGAGE-PLAN           PIC XX.
  1208         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1209
  1210     12  CF-LAST-MAINT-DT                   PIC XX.
  1211     12  CF-LAST-MAINT-BY                   PIC X(4).
  1212     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1213
  1214     12  CF-RECORD-BODY                     PIC X(728).
  1215
  1216
  1217****************************************************************
  1218*             COMPANY MASTER RECORD                            *
  1219****************************************************************
  1220
  1221     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1222         16  CF-COMPANY-ADDRESS.
  1223             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1224             20  CF-CL-IN-CARE-OF           PIC X(30).
  1225             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1226             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1227             20  CF-CL-CITY-STATE           PIC X(30).
  1228             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1229             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1230         16  CF-COMPANY-CD                  PIC X.
  1231         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  23
* SOCK03.cbl
  1232         16  CF-SECURITY-OPTION             PIC X.
  1233             88  ALL-SECURITY                   VALUE '1'.
  1234             88  COMPANY-VERIFY                 VALUE '2'.
  1235             88  PROCESSOR-VERIFY               VALUE '3'.
  1236             88  NO-SECURITY                    VALUE '4'.
  1237             88  ALL-BUT-TERM                   VALUE '5'.
  1238         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1239             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1240         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1241             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1242         16  CF-INFORCE-LOCATION            PIC X.
  1243             88  CERTS-ARE-ONLINE               VALUE '1'.
  1244             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1245             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1246         16  CF-LOWER-CASE-LETTERS          PIC X.
  1247         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1248             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1249             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1250             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1251             88  CF-ACCNT-CNTL                  VALUE '3'.
  1252             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1253
  1254         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1255         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1256
  1257         16  CF-LGX-CREDIT-USER             PIC X.
  1258             88  CO-IS-NOT-USER                 VALUE 'N'.
  1259             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1260
  1261         16 CF-CREDIT-CALC-CODES.
  1262             20  CF-CR-REM-TERM-CALC PIC X.
  1263               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1264               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1265               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1266               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1267               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1268               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1269               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1270             20  CF-CR-R78-METHOD           PIC X.
  1271               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1272               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1273
  1274         16  CF-CLAIM-CONTROL-COUNTS.
  1275             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1276                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1277
  1278             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1279                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1280
  1281             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1282                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1283
  1284             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1285                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1286
  1287         16  CF-CURRENT-MONTH-END           PIC XX.
  1288
  1289         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  24
* SOCK03.cbl
  1290             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1291             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1292             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1293             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1294                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1295                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1296             20  CF-CO-PREM-REJECT-SW       PIC X.
  1297                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1298                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1299             20  CF-CO-REF-REJECT-SW        PIC X.
  1300                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1301                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1302
  1303         16  CF-CO-REPORTING-DT             PIC XX.
  1304         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1305         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1306           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1307           88  CF-CO-MONTH-END                  VALUE '1'.
  1308
  1309         16  CF-LGX-CLAIM-USER              PIC X.
  1310             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1311             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1312
  1313         16  CF-CREDIT-EDIT-CONTROLS.
  1314             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1315             20  CF-MIN-AGE                 PIC 99.
  1316             20  CF-DEFAULT-AGE             PIC 99.
  1317             20  CF-MIN-TERM                PIC S999      COMP-3.
  1318             20  CF-MAX-TERM                PIC S999      COMP-3.
  1319             20  CF-DEFAULT-SEX             PIC X.
  1320             20  CF-JOINT-AGE-INPUT         PIC X.
  1321                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1322             20  CF-BIRTH-DATE-INPUT        PIC X.
  1323                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1324             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1325                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1326                 88  CF-ZERO-CARRIER            VALUE '1'.
  1327                 88  CF-ZERO-GROUPING           VALUE '2'.
  1328                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1329             20  CF-EDIT-SW                 PIC X.
  1330                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1331             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1332             20  CF-CR-PR-METHOD            PIC X.
  1333               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1334               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1335             20  FILLER                     PIC X.
  1336
  1337         16  CF-CREDIT-MISC-CONTROLS.
  1338             20  CF-REIN-TABLE-SW           PIC X.
  1339                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1340             20  CF-COMP-TABLE-SW           PIC X.
  1341                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1342             20  CF-EXPERIENCE-RETENTION-AGE
  1343                                            PIC S9        COMP-3.
  1344             20  CF-CONVERSION-DT           PIC XX.
  1345             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1346             20  CF-RUN-FREQUENCY-SW        PIC X.
  1347                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  25
* SOCK03.cbl
  1348                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1349
  1350             20  CF-CR-CHECK-NO-CONTROL.
  1351                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1352                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1353                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1354                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1355                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1356                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1357
  1358                 24  CF-CR-CHECK-COUNT       REDEFINES
  1359                     CF-CR-CHECK-COUNTER      PIC X(4).
  1360
  1361                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1362                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1363
  1364                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1365                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1366                 24  CF-MAIL-PROCESSING       PIC X.
  1367                     88  MAIL-PROCESSING          VALUE 'Y'.
  1368
  1369         16  CF-MISC-SYSTEM-CONTROL.
  1370             20  CF-SYSTEM-C                 PIC X.
  1371                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1372             20  CF-SYSTEM-D                 PIC X.
  1373                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1374             20  CF-SOC-SEC-NO-SW            PIC X.
  1375                 88  SOC-SEC-NO-USED             VALUE '1'.
  1376             20  CF-MEMBER-NO-SW             PIC X.
  1377                 88  MEMBER-NO-USED              VALUE '1'.
  1378             20  CF-TAX-ID-NUMBER            PIC X(11).
  1379             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1380             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1381                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1382                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1383                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1384                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1385             20  CF-SYSTEM-E                 PIC X.
  1386                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1387
  1388         16  CF-LGX-LIFE-USER               PIC X.
  1389             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1390             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1391
  1392         16  CF-CR-MONTH-END-DT             PIC XX.
  1393
  1394         16  CF-FILE-MAINT-DATES.
  1395             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1396                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1397             20  CF-LAST-BATCH       REDEFINES
  1398                 CF-LAST-BATCH-NO               PIC X(4).
  1399             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1400             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1401             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1402             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1403             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1404             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1405             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  26
* SOCK03.cbl
  1406             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1407             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1408             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1409
  1410         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1411         16  FILLER                         PIC X.
  1412
  1413         16  CF-ALT-MORT-CODE               PIC X(4).
  1414         16  CF-MEMBER-CAPTION              PIC X(10).
  1415
  1416         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1417             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1418             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1419             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1420             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1421             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1422
  1423         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1424
  1425         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1426         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1427         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1428         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1429
  1430         16  CF-AH-OVERRIDE-L1              PIC X.
  1431         16  CF-AH-OVERRIDE-L2              PIC XX.
  1432         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1433         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1434
  1435         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1436         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1437
  1438         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1439         16  CF-AR-LAST-EL860-DT            PIC XX.
  1440         16  CF-MP-MONTH-END-DT             PIC XX.
  1441
  1442         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1443         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1444             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1445
  1446         16  CF-AR-MONTH-END-DT             PIC XX.
  1447
  1448         16  CF-CRDTCRD-USER                PIC X.
  1449             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1450             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1451
  1452         16  CF-CC-MONTH-END-DT             PIC XX.
  1453
  1454         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1455
  1456         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1457             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1458             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1459             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1460         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1461         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1462         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1463         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  27
* SOCK03.cbl
  1464             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1465             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1466         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1467         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1468         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1469             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1470         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1471
  1472         16  CF-CL-ZIP-CODE.
  1473             20  CF-CL-ZIP-PRIME.
  1474                 24  CF-CL-ZIP-1ST          PIC X.
  1475                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1476                 24  FILLER                 PIC X(4).
  1477             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1478         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1479             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1480             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1481             20  FILLER                     PIC XXX.
  1482
  1483         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1484         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1485         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1486         16  CF-CO-OPTION-START-DATE        PIC XX.
  1487         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1488           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1489                                                      '3' '4'.
  1490           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1491           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1492           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1493           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1494           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1495           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1496
  1497         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1498
  1499         16  CF-PAYMENT-APPROVAL-LEVELS.
  1500             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1501             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1502             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1503             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1504             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1505             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1506
  1507         16  CF-END-USER-REPORTING-USER     PIC X.
  1508             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1509             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1510
  1511         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1512             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1513             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1514
  1515         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1516
  1517         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1518         16  FILLER                         PIC X.
  1519
  1520         16  CF-CREDIT-ARCHIVE-CNTL.
  1521             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  28
* SOCK03.cbl
  1522             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1523             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1524
  1525         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1526
  1527         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1528             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1529             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1530
  1531         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1532             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1533             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1534
  1535         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1536
  1537         16  CF-CO-ACH-ID-CODE              PIC  X.
  1538             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1539             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1540             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1541         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1542         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1543         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1544         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1545         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1546         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1547         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1548         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1549         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1550                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1551         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1552                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1553
  1554         16  CF-CO-OVER-SHORT.
  1555             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1556             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1557
  1558*         16  FILLER                         PIC X(102).
  1559         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1560             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1561             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1562
  1563         16  CF-AH-APPROVAL-DAYS.
  1564             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1565             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1566             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1567             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1568
  1569         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1570
  1571         16  CF-APPROV-LEV-5.
  1572             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1573             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1574             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1575
  1576         16  FILLER                         PIC X(68).
  1577****************************************************************
  1578*             PROCESSOR/USER RECORD                            *
  1579****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  29
* SOCK03.cbl
  1580
  1581     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1582         16  CF-PROCESSOR-NAME              PIC X(30).
  1583         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1584         16  CF-PROCESSOR-TITLE             PIC X(26).
  1585         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1586                 88  MESSAGE-YES                VALUE 'Y'.
  1587                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1588
  1589*****************************************************
  1590****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1591****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1592****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1593****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1594*****************************************************
  1595
  1596         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1597             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1598             20  CF-APPLICATION-FORCE       PIC X.
  1599             20  CF-INDIVIDUAL-APP.
  1600                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1601                     28  CF-BROWSE-APP      PIC X.
  1602                     28  CF-UPDATE-APP      PIC X.
  1603
  1604         16  CF-CURRENT-TERM-ON             PIC X(4).
  1605         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1606             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1607             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1608             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1609             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1610             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1611             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1612             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1613         16  CF-PROCESSOR-CARRIER           PIC X.
  1614             88  NO-CARRIER-SECURITY            VALUE ' '.
  1615         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1616             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1617         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1618             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1619         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1620             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1621
  1622         16  CF-PROC-SYS-ACCESS-SW.
  1623             20  CF-PROC-CREDIT-CLAIMS-SW.
  1624                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1625                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1626                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1627                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1628             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1629                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1630                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1631             20  CF-PROC-LIFE-GNRLDGR-SW.
  1632                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1633                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1634                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1635                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1636             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1637                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  30
* SOCK03.cbl
  1638                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1639         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1640             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1641             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1642         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1643
  1644         16  CF-APPROVAL-LEVEL                  PIC X.
  1645             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1646             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1647             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1648             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1649             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1650
  1651         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1652
  1653         16  CF-LANGUAGE-TYPE                   PIC X.
  1654             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1655             88  CF-LANG-IS-FR                      VALUE 'F'.
  1656
  1657         16  CF-CSR-IND                         PIC X.
  1658         16  FILLER                             PIC X(239).
  1659
  1660****************************************************************
  1661*             PROCESSOR/REMINDERS RECORD                       *
  1662****************************************************************
  1663
  1664     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1665         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1666             20  CF-START-REMIND-DT         PIC XX.
  1667             20  CF-END-REMIND-DT           PIC XX.
  1668             20  CF-REMINDER-TEXT           PIC X(50).
  1669         16  FILLER                         PIC X(296).
  1670
  1671
  1672****************************************************************
  1673*             STATE MASTER RECORD                              *
  1674****************************************************************
  1675
  1676     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1677         16  CF-STATE-ABBREVIATION          PIC XX.
  1678         16  CF-STATE-NAME                  PIC X(25).
  1679         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1680         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1681             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1682             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1683             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1684             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1685                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1686                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1687             20  CF-ST-PREM-REJECT-SW       PIC X.
  1688                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1689                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1690             20  CF-ST-REF-REJECT-SW        PIC X.
  1691                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1692                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1693         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1694         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1695         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  31
* SOCK03.cbl
  1696             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1697             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1698             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1699         16  CF-ST-FST-PMT-EXTENSION.
  1700             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1701             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1702                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1703                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1704                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1705                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1706         16  CF-ST-STATE-CALL.
  1707             20  CF-ST-CALL-UNEARNED        PIC X.
  1708             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1709             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1710         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1711             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1712             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1713         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1714         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1715         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1716         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1717         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1718         16  FILLER                         PIC X.
  1719         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1720             20  CF-ST-BENEFIT-CD           PIC XX.
  1721             20  CF-ST-BENEFIT-KIND         PIC X.
  1722                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1723                 88  CF-ST-AH-KIND              VALUE 'A'.
  1724             20  CF-ST-REM-TERM-CALC        PIC X.
  1725                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1726                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1727                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1728                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1729                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1730                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1731                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1732                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1733
  1734             20  CF-ST-REFUND-CALC          PIC X.
  1735                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1736                 88  ST-REFD-BY-R78             VALUE '1'.
  1737                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1738                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1739                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1740                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1741                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1742                 88  ST-REFD-UTAH               VALUE '7'.
  1743                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1744                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1745                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1746
  1747             20  CF-ST-EARNING-CALC         PIC X.
  1748                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1749                 88  ST-EARN-BY-R78             VALUE '1'.
  1750                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1751                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1752                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1753                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  32
* SOCK03.cbl
  1754                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1755                 88  ST-EARN-MEAN               VALUE '8'.
  1756                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1757
  1758             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1759                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1760                 88  ST-OVRD-BY-R78             VALUE '1'.
  1761                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1762                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1763                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1764                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1765                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1766                 88  ST-OVRD-MEAN               VALUE '8'.
  1767                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1768             20  cf-st-extra-periods        pic 9.
  1769*            20  FILLER                     PIC X.
  1770
  1771         16  CF-ST-COMMISSION-CAPS.
  1772             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1773             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1774             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1775             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1776         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1777                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1778                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1779                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1780
  1781         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1782
  1783         16  CF-ST-STATUTORY-INTEREST.
  1784             20  CF-ST-STAT-DATE-FROM       PIC X.
  1785                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1786                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1787             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1788             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1789             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1790             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1791             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1792
  1793         16  CF-ST-OVER-SHORT.
  1794             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1795             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1796
  1797         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1798
  1799         16  CF-ST-RT-CALC                  PIC X.
  1800
  1801         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1802         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1803         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1804         16  CF-ST-RF-LR-CALC               PIC X.
  1805         16  CF-ST-RF-LL-CALC               PIC X.
  1806         16  CF-ST-RF-LN-CALC               PIC X.
  1807         16  CF-ST-RF-AH-CALC               PIC X.
  1808         16  CF-ST-RF-CP-CALC               PIC X.
  1809*        16  FILLER                         PIC X(206).
  1810*CIDMOD         16  FILLER                         PIC X(192).
  1811         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  33
* SOCK03.cbl
  1812             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1813         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1814         16  CF-ST-VFY-2ND-BENE             PIC X.
  1815         16  CF-ST-CAUSAL-STATE             PIC X.
  1816         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1817         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1818         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1819             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1820         16  CF-ST-NET-ONLY-STATE           PIC X.
  1821             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1822         16  cf-commission-cap-required     pic x.
  1823         16  CF-ST-GA-COMMISSION-CAPS.
  1824             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1825             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1826             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1827             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1828         16  CF-ST-TOT-COMMISSION-CAPS.
  1829             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1830             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1831             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1832             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1833         16  FILLER                         PIC X(156).
  1834
  1835****************************************************************
  1836*             BENEFIT MASTER RECORD                            *
  1837****************************************************************
  1838
  1839     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1840         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1841             20  CF-BENEFIT-CODE            PIC XX.
  1842             20  CF-BENEFIT-NUMERIC  REDEFINES
  1843                 CF-BENEFIT-CODE            PIC XX.
  1844             20  CF-BENEFIT-ALPHA           PIC XXX.
  1845             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1846             20  CF-BENEFIT-COMMENT         PIC X(10).
  1847
  1848             20  CF-LF-COVERAGE-TYPE        PIC X.
  1849                 88  CF-REDUCING                VALUE 'R'.
  1850                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1851
  1852             20  CF-SPECIAL-CALC-CD         PIC X.
  1853                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1854                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1855                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1856                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1857                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1858                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1859                 88  CF-FARM-PLAN               VALUE 'F'.
  1860                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1861                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1862                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1863                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1864                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1865                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1866                 88  CF-PRUDENTIAL              VALUE 'P'.
  1867                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1868                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1869                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  34
* SOCK03.cbl
  1870                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1871                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1872                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1873
  1874             20  CF-JOINT-INDICATOR         PIC X.
  1875                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1876
  1877*            20  FILLER                     PIC X(12).
  1878             20  cf-maximum-benefits        pic s999 comp-3.
  1879             20  FILLER                     PIC X(09).
  1880             20  CF-BENEFIT-CATEGORY        PIC X.
  1881             20  CF-LOAN-TYPE               PIC X(8).
  1882
  1883             20  CF-CO-REM-TERM-CALC        PIC X.
  1884                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1885                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1886                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1887                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1888                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1889
  1890             20  CF-CO-EARNINGS-CALC        PIC X.
  1891                 88  CO-EARN-BY-R78             VALUE '1'.
  1892                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1893                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1894                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1895                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1896                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1897                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1898                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1899
  1900             20  CF-CO-REFUND-CALC          PIC X.
  1901                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1902                 88  CO-REFD-BY-R78             VALUE '1'.
  1903                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1904                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1905                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1906                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1907                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1908                 88  CO-REFD-MEAN               VALUE '8'.
  1909                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1910                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1911                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1912
  1913             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1914                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1915                 88  CO-OVRD-BY-R78             VALUE '1'.
  1916                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1917                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1918                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1919                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1920                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1921                 88  CO-OVRD-MEAN               VALUE '8'.
  1922                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1923
  1924             20  CF-CO-BEN-I-G-CD           PIC X.
  1925                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1926                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1927                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  35
* SOCK03.cbl
  1928
  1929         16  FILLER                         PIC X(304).
  1930
  1931
  1932****************************************************************
  1933*             CARRIER MASTER RECORD                            *
  1934****************************************************************
  1935
  1936     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1937         16  CF-ADDRESS-DATA.
  1938             20  CF-MAIL-TO-NAME            PIC X(30).
  1939             20  CF-IN-CARE-OF              PIC X(30).
  1940             20  CF-ADDRESS-LINE-1          PIC X(30).
  1941             20  CF-ADDRESS-LINE-2          PIC X(30).
  1942             20  CF-CITY-STATE              PIC X(30).
  1943             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1944             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1945
  1946         16  CF-CLAIM-NO-CONTROL.
  1947             20  CF-CLAIM-NO-METHOD         PIC X.
  1948                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1949                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1950                 88  CLAIM-NO-SEQ               VALUE '3'.
  1951                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1952             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1953                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1954                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1955                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1956
  1957         16  CF-CHECK-NO-CONTROL.
  1958             20  CF-CHECK-NO-METHOD         PIC X.
  1959                 88  CHECK-NO-MANUAL            VALUE '1'.
  1960                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1961                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1962                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1963             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1964                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1965
  1966         16  CF-DOMICILE-STATE              PIC XX.
  1967
  1968         16  CF-EXPENSE-CONTROLS.
  1969             20  CF-EXPENSE-METHOD          PIC X.
  1970                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1971                 88  DOLLARS-PER-PMT            VALUE '2'.
  1972                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1973                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1974             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1975             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1976
  1977         16  CF-CORRESPONDENCE-CONTROL.
  1978             20  CF-LETTER-RESEND-OPT       PIC X.
  1979                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1980                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1981             20  FILLER                     PIC X(4).
  1982
  1983         16  CF-RESERVE-CONTROLS.
  1984             20  CF-MANUAL-SW               PIC X.
  1985                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  36
* SOCK03.cbl
  1986             20  CF-FUTURE-SW               PIC X.
  1987                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1988             20  CF-PTC-SW                  PIC X.
  1989                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1990             20  CF-IBNR-SW                 PIC X.
  1991                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1992             20  CF-PTC-LF-SW               PIC X.
  1993                 88  CF-LF-PTC-USED             VALUE '1'.
  1994             20  CF-CDT-ACCESS-METHOD       PIC X.
  1995                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1996                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1997                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1998             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1999
  2000         16  CF-CLAIM-CALC-METHOD           PIC X.
  2001             88  360-PLUS-MONTHS                VALUE '1'.
  2002             88  365-PLUS-MONTHS                VALUE '2'.
  2003             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2004             88  360-DAILY                      VALUE '4'.
  2005             88  365-DAILY                      VALUE '5'.
  2006
  2007         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2008         16  FILLER                         PIC X(11).
  2009
  2010         16  CF-LIMIT-AMOUNTS.
  2011             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2012             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2013             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2014             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2015             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2016             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2017             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2018             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2019             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2020             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2021
  2022         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2023         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2024         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2025
  2026         16  CF-ZIP-CODE.
  2027             20  CF-ZIP-PRIME.
  2028                 24  CF-ZIP-1ST             PIC X.
  2029                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2030                 24  FILLER                 PIC X(4).
  2031             20  CF-ZIP-PLUS4               PIC X(4).
  2032         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2033             20  CF-CAN-POSTAL-1            PIC XXX.
  2034             20  CF-CAN-POSTAL-2            PIC XXX.
  2035             20  FILLER                     PIC XXX.
  2036
  2037         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2038         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2039         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2040
  2041         16  CF-RATING-SWITCH               PIC X.
  2042             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2043             88  CF-NO-RATING                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  37
* SOCK03.cbl
  2044
  2045         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2046
  2047         16  CF-CARRIER-OVER-SHORT.
  2048             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2049             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2050
  2051         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2052         16  CF-SECPAY-SWITCH               PIC X.
  2053             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2054             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2055         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2056         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2057         16  FILLER                         PIC X(444).
  2058*        16  FILLER                         PIC X(452).
  2059
  2060
  2061****************************************************************
  2062*             MORTALITY MASTER RECORD                          *
  2063****************************************************************
  2064
  2065     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2066         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2067                                INDEXED BY CF-MORT-NDX.
  2068             20  CF-MORT-TABLE              PIC X(5).
  2069             20  CF-MORT-TABLE-TYPE         PIC X.
  2070                 88  CF-MORT-JOINT              VALUE 'J'.
  2071                 88  CF-MORT-SINGLE             VALUE 'S'.
  2072                 88  CF-MORT-COMBINED           VALUE 'C'.
  2073                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2074                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2075             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2076             20  CF-MORT-AGE-METHOD         PIC XX.
  2077                 88  CF-AGE-LAST                VALUE 'AL'.
  2078                 88  CF-AGE-NEAR                VALUE 'AN'.
  2079             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2080             20  CF-MORT-ADJUSTMENT-DIRECTION
  2081                                            PIC X.
  2082                 88  CF-MINUS                   VALUE '-'.
  2083                 88  CF-PLUS                    VALUE '+'.
  2084             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2085             20  CF-MORT-JOINT-CODE         PIC X.
  2086                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2087             20  CF-MORT-PC-Q               PIC X.
  2088                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2089             20  CF-MORT-TABLE-CODE         PIC X(4).
  2090             20  CF-MORT-COMMENTS           PIC X(15).
  2091             20  FILLER                     PIC X(14).
  2092
  2093         16  FILLER                         PIC X(251).
  2094
  2095
  2096****************************************************************
  2097*             BUSSINESS TYPE MASTER RECORD                     *
  2098****************************************************************
  2099
  2100     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2101* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  38
* SOCK03.cbl
  2102* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2103* AND RECORD 05 IS TYPES 81-99
  2104         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2105             20  CF-BUSINESS-TITLE          PIC  X(19).
  2106             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2107                                            PIC S9V9(4) COMP-3.
  2108             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2109             20  FILLER                     PIC  X.
  2110         16  FILLER                         PIC  X(248).
  2111
  2112
  2113****************************************************************
  2114*             TERMINAL MASTER RECORD                           *
  2115****************************************************************
  2116
  2117     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2118
  2119         16  CF-COMPANY-TERMINALS.
  2120             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2121                                  PIC X(4).
  2122         16  FILLER               PIC X(248).
  2123
  2124
  2125****************************************************************
  2126*             LIFE EDIT MASTER RECORD                          *
  2127****************************************************************
  2128
  2129     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2130         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2131             20  CF-LIFE-CODE-IN            PIC XX.
  2132             20  CF-LIFE-CODE-OUT           PIC XX.
  2133         16  FILLER                         PIC X(248).
  2134
  2135
  2136****************************************************************
  2137*             AH EDIT MASTER RECORD                            *
  2138****************************************************************
  2139
  2140     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2141         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2142             20  CF-AH-CODE-IN              PIC XXX.
  2143             20  CF-AH-CODE-OUT             PIC XX.
  2144         16  FILLER                         PIC X(248).
  2145
  2146
  2147****************************************************************
  2148*             CREDIBILITY TABLES                               *
  2149****************************************************************
  2150
  2151     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2152         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2153                             INDEXED BY CF-CRDB-NDX.
  2154             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2155             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2156             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2157         16  FILLER                         PIC  X(332).
  2158
  2159
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  39
* SOCK03.cbl
  2160****************************************************************
  2161*             REPORT CUSTOMIZATION RECORD                      *
  2162****************************************************************
  2163
  2164     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2165         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2166             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2167             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2168             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2169**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2170****       A T-TRANSFER.                                   ****
  2171             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2172
  2173         16  FILLER                         PIC XX.
  2174
  2175         16  CF-CARRIER-CNTL-OPT.
  2176             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2177                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2178                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2179             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2180                                            PIC X.
  2181         16  CF-GROUP-CNTL-OPT.
  2182             20  CF-GROUP-OPT-SEQ           PIC 9.
  2183                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2184                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2185             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2186                                            PIC X(6).
  2187         16  CF-STATE-CNTL-OPT.
  2188             20  CF-STATE-OPT-SEQ           PIC 9.
  2189                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2190                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2191             20  CF-STATE-SELECT OCCURS 3 TIMES
  2192                                            PIC XX.
  2193         16  CF-ACCOUNT-CNTL-OPT.
  2194             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2195                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2196                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2197             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2198                                            PIC X(10).
  2199         16  CF-BUS-TYP-CNTL-OPT.
  2200             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2201                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2202                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2203             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2204                                            PIC XX.
  2205         16  CF-LF-TYP-CNTL-OPT.
  2206             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2207                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2208                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2209             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2210                                            PIC XX.
  2211         16  CF-AH-TYP-CNTL-OPT.
  2212             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2213                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2214                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2215             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2216                                            PIC XX.
  2217         16  CF-REPTCD1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  40
* SOCK03.cbl
  2218             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2219                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2220                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2221             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2222                                            PIC X(10).
  2223         16  CF-REPTCD2-CNTL-OPT.
  2224             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2225                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2226                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2227             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2228                                            PIC X(10).
  2229         16  CF-USER1-CNTL-OPT.
  2230             20  CF-USER1-OPT-SEQ           PIC 9.
  2231                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2232                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2233             20  CF-USER1-SELECT OCCURS 3 TIMES
  2234                                            PIC X(10).
  2235         16  CF-USER2-CNTL-OPT.
  2236             20  CF-USER2-OPT-SEQ           PIC 9.
  2237                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2238                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2239             20  CF-USER2-SELECT OCCURS 3 TIMES
  2240                                            PIC X(10).
  2241         16  CF-USER3-CNTL-OPT.
  2242             20  CF-USER3-OPT-SEQ           PIC 9.
  2243                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2244                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2245             20  CF-USER3-SELECT OCCURS 3 TIMES
  2246                                            PIC X(10).
  2247         16  CF-USER4-CNTL-OPT.
  2248             20  CF-USER4-OPT-SEQ           PIC 9.
  2249                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2250                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2251             20  CF-USER4-SELECT OCCURS 3 TIMES
  2252                                            PIC X(10).
  2253         16  CF-USER5-CNTL-OPT.
  2254             20  CF-USER5-OPT-SEQ           PIC 9.
  2255                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2256                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2257             20  CF-USER5-SELECT OCCURS 3 TIMES
  2258                                            PIC X(10).
  2259         16  CF-REINS-CNTL-OPT.
  2260             20  CF-REINS-OPT-SEQ           PIC 9.
  2261                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2262                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2263             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2264                 24  CF-REINS-PRIME         PIC XXX.
  2265                 24  CF-REINS-SUB           PIC XXX.
  2266
  2267         16  CF-AGENT-CNTL-OPT.
  2268             20  CF-AGENT-OPT-SEQ           PIC 9.
  2269                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2270                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2271             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2272                                            PIC X(10).
  2273
  2274         16  FILLER                         PIC X(43).
  2275
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  41
* SOCK03.cbl
  2276         16  CF-LOSS-RATIO-SELECT.
  2277             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2278             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2279         16  CF-ENTRY-DATE-SELECT.
  2280             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2281             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2282         16  CF-EFFECTIVE-DATE-SELECT.
  2283             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2284             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2285
  2286         16  CF-EXCEPTION-LIST-IND          PIC X.
  2287             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2288
  2289         16  FILLER                         PIC X(318).
  2290
  2291****************************************************************
  2292*                  EXCEPTION REPORTING RECORD                  *
  2293****************************************************************
  2294
  2295     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2296         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2297             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2298
  2299         16  CF-COMBINED-LIFE-AH-OPT.
  2300             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2301             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2302             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2303             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2304
  2305         16  CF-LIFE-OPT.
  2306             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2307             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2308             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2309             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2310             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2311             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2312             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2313             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2314             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2315             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2316
  2317         16  CF-AH-OPT.
  2318             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2319             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2320             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2321             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2322             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2323             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2324             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2325             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2326             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2327             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2328
  2329         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2330             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2331             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2332             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2333
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  42
* SOCK03.cbl
  2334         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2335
  2336         16  FILLER                         PIC X(673).
  2337
  2338
  2339****************************************************************
  2340*             MORTGAGE SYSTEM PLAN RECORD                      *
  2341****************************************************************
  2342
  2343     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2344         16  CF-PLAN-TYPE                   PIC X.
  2345             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2346             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2347             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2348         16  CF-PLAN-ABBREV                 PIC XXX.
  2349         16  CF-PLAN-DESCRIPT               PIC X(10).
  2350         16  CF-PLAN-NOTES                  PIC X(20).
  2351         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2352         16  CF-PLAN-UNDERWRITING.
  2353             20  CF-PLAN-TERM-DATA.
  2354                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2355                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2356             20  CF-PLAN-AGE-DATA.
  2357                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2358                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2359                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2360             20  CF-PLAN-BENEFIT-DATA.
  2361                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2362                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2363                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2364                                            PIC S9(7)V99  COMP-3.
  2365         16  CF-PLAN-POLICY-FORMS.
  2366             20  CF-POLICY-FORM             PIC X(12).
  2367             20  CF-MASTER-APPLICATION      PIC X(12).
  2368             20  CF-MASTER-POLICY           PIC X(12).
  2369         16  CF-PLAN-RATING.
  2370             20  CF-RATE-CODE               PIC X(5).
  2371             20  CF-SEX-RATING              PIC X.
  2372                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2373                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2374             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2375             20  CF-SUB-STD-TYPE            PIC X.
  2376                 88  CF-PCT-OF-PREM            VALUE '1'.
  2377                 88  CF-PCT-OF-BENE            VALUE '2'.
  2378         16  CF-PLAN-PREM-TOLERANCES.
  2379             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2380             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2381         16  CF-PLAN-PYMT-TOLERANCES.
  2382             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2383             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2384         16  CF-PLAN-MISC-DATA.
  2385             20  FILLER                     PIC X.
  2386             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2387             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2388         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2389         16  CF-PLAN-IND-GRP                PIC X.
  2390             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2391                                                     '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  43
* SOCK03.cbl
  2392             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2393                                                     '2'.
  2394         16  CF-MIB-SEARCH-SW               PIC X.
  2395             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2396             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2397             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2398             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2399         16  CF-ALPHA-SEARCH-SW             PIC X.
  2400             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2401             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2402             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2403             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2404             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2405             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2406             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2407             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2408             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2409             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2410                                                     'A' 'B' 'C'
  2411                                                     'X' 'Y' 'Z'.
  2412         16  CF-EFF-DT-RULE-SW              PIC X.
  2413             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2414             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2415             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2416             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2417             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2418         16  FILLER                         PIC X(4).
  2419         16  CF-HEALTH-QUESTIONS            PIC X.
  2420             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2421         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2422         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2423         16  CF-PLAN-SNGL-JNT               PIC X.
  2424             88  CF-COMBINED-PLAN              VALUE 'C'.
  2425             88  CF-JNT-PLAN                   VALUE 'J'.
  2426             88  CF-SNGL-PLAN                  VALUE 'S'.
  2427         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2428         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2429         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2430         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2431         16  CF-RERATE-CNTL                 PIC  X.
  2432             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2433             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2434             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2435             88  CF-AUTO-RECALC                 VALUE '4'.
  2436         16  CF-BENEFIT-TYPE                PIC  X.
  2437             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2438             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2439         16  CF-POLICY-FEE                  PIC S999V99
  2440                                                    COMP-3.
  2441         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2442         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2443         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2444         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2445         16  FILLER                         PIC  X(32).
  2446         16  CF-TERMINATION-FORM            PIC  X(04).
  2447         16  FILLER                         PIC  X(08).
  2448         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2449                                                       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  44
* SOCK03.cbl
  2450         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2451         16  CF-ISSUE-LETTER                PIC  X(4).
  2452         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2453         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2454             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2455             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2456         16  CF-MP-REFUND-CALC              PIC X.
  2457             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2458             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2459             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2460             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2461             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2462             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2463             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2464             88  CF-MP-REFD-MEAN                VALUE '8'.
  2465         16  CF-ALT-RATE-CODE               PIC  X(5).
  2466
  2467
  2468         16  FILLER                         PIC X(498).
  2469****************************************************************
  2470*             MORTGAGE COMPANY MASTER RECORD                   *
  2471****************************************************************
  2472
  2473     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2474         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2475         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2476             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2477             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2478             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2479             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2480             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2481
  2482         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2483         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2484         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2485         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2486         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2487
  2488         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2489             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2490         16  CF-MP-RECON-USE-IND            PIC X(1).
  2491             88  CF-MP-USE-RECON             VALUE 'Y'.
  2492         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2493             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2494         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2495             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2496             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2497         16  FILLER                         PIC X(1).
  2498         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2499             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2500         16  CF-MORTG-MIB-VERSION           PIC X.
  2501             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2502             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2503             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2504         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2505             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2506                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2507             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  45
* SOCK03.cbl
  2508                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2509             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2510                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2511             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2512                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2513             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2514                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2515             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2516                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2517         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2518         16  FILLER                         PIC X(7).
  2519         16  CF-MORTG-DESTINATION-SYMBOL.
  2520             20  CF-MORTG-MIB-COMM          PIC X(5).
  2521             20  CF-MORTG-MIB-TERM          PIC X(5).
  2522         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2523             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2524         16  FILLER                         PIC X(03).
  2525         16  CF-MP-CHECK-NO-CONTROL.
  2526             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2527                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2528                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2529                                                ' ' LOW-VALUES.
  2530                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2531                                               VALUE '3'.
  2532         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2533         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2534         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2535             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2536                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2537             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2538                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2539             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2540                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2541             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2542                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2543             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2544                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2545             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2546                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2547         16  CF-MORTG-BILLING-AREA.
  2548             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2549                                            PIC X.
  2550         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2551         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2552         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2553         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2554             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2555             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2556         16  FILLER                         PIC X.
  2557         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2558             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2559             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2560         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2561         16  FILLER                         PIC X(8).
  2562         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2563         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2564         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2565         16  CF-ACH-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  46
* SOCK03.cbl
  2566             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2567                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2568                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2569                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2570             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2571         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2572             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2573         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2574             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2575             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2576         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2577         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2578         16  FILLER                         PIC X(536).
  2579
  2580****************************************************************
  2581*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2582****************************************************************
  2583
  2584     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2585         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2586             20  CF-FEMALE-HEIGHT.
  2587                 24  CF-FEMALE-FT           PIC 99.
  2588                 24  CF-FEMALE-IN           PIC 99.
  2589             20  CF-FEMALE-MIN-WT           PIC 999.
  2590             20  CF-FEMALE-MAX-WT           PIC 999.
  2591         16  FILLER                         PIC X(428).
  2592
  2593     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2594         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2595             20  CF-MALE-HEIGHT.
  2596                 24  CF-MALE-FT             PIC 99.
  2597                 24  CF-MALE-IN             PIC 99.
  2598             20  CF-MALE-MIN-WT             PIC 999.
  2599             20  CF-MALE-MAX-WT             PIC 999.
  2600         16  FILLER                         PIC X(428).
  2601******************************************************************
  2602*             AUTOMATIC ACTIVITY RECORD                          *
  2603******************************************************************
  2604     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2605         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2606             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2607             20  CF-SYS-LETTER-ID           PIC X(04).
  2608             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2609             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2610             20  CF-SYS-RESET-SW            PIC X(01).
  2611             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2612             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2613
  2614         16  FILLER                         PIC X(50).
  2615
  2616         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2617             20  CF-USER-ACTIVE-SW          PIC X(01).
  2618             20  CF-USER-LETTER-ID          PIC X(04).
  2619             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2620             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2621             20  CF-USER-RESET-SW           PIC X(01).
  2622             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2623             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  47
* SOCK03.cbl
  2624             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2625
  2626         16  FILLER                         PIC X(246).
  2627*                                 COPY ERCACCT.
  2628******************************************************************
  2629*                                                                *
  2630*                                                                *
  2631*                            ERCACCT                             *
  2632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2633*                            VMOD=2.031                          *
  2634*                                                                *
  2635*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2636*                                                                *
  2637*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2638*   VSAM ACCOUNT MASTER FILES.                                   *
  2639*                                                                *
  2640*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2641*                                                                *
  2642*   FILE TYPE = VSAM,KSDS                                        *
  2643*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2644*                                                                *
  2645*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2646*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2647*                                                                *
  2648*   LOG = NO                                                     *
  2649*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2650*                                                                *
  2651*                                                                *
  2652******************************************************************
  2653*                   C H A N G E   L O G
  2654*
  2655* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2656*-----------------------------------------------------------------
  2657*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2658* EFFECTIVE    NUMBER
  2659*-----------------------------------------------------------------
  2660* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2661* 092705    2005050300006  PEMA  ADD SPP LEASES
  2662* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2663* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2664* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2665* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2666* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2667* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2668******************************************************************
  2669
  2670 01  ACCOUNT-MASTER.
  2671     12  AM-RECORD-ID                      PIC XX.
  2672         88  VALID-AM-ID                      VALUE 'AM'.
  2673
  2674     12  AM-CONTROL-PRIMARY.
  2675         16  AM-COMPANY-CD                 PIC X.
  2676         16  AM-MSTR-CNTRL.
  2677             20  AM-CONTROL-A.
  2678                 24  AM-CARRIER            PIC X.
  2679                 24  AM-GROUPING.
  2680                     28 AM-GROUPING-PREFIX PIC XXX.
  2681                     28 AM-GROUPING-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  48
* SOCK03.cbl
  2682                 24  AM-STATE              PIC XX.
  2683                 24  AM-ACCOUNT.
  2684                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2685                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2686             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2687                                           PIC X(19).
  2688             20  AM-CNTRL-B.
  2689                 24  AM-EXPIRATION-DT      PIC XX.
  2690                 24  FILLER                PIC X(4).
  2691             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2692                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2693
  2694     12  AM-CONTROL-BY-VAR-GRP.
  2695         16  AM-COMPANY-CD-A1              PIC X.
  2696         16  AM-VG-CARRIER                 PIC X.
  2697         16  AM-VG-GROUPING                PIC X(6).
  2698         16  AM-VG-STATE                   PIC XX.
  2699         16  AM-VG-ACCOUNT                 PIC X(10).
  2700         16  AM-VG-DATE.
  2701             20  AM-VG-EXPIRATION-DT       PIC XX.
  2702             20  FILLER                    PIC X(4).
  2703         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2704                                           PIC 9(11)      COMP-3.
  2705     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2706         16  FILLER                        PIC X(10).
  2707         16  AM-VG-KEY3.
  2708             20  AM-VG3-ACCOUNT            PIC X(10).
  2709             20  AM-VG3-EXP-DT             PIC XX.
  2710         16  FILLER                        PIC X(4).
  2711     12  AM-MAINT-INFORMATION.
  2712         16  AM-LAST-MAINT-DT              PIC XX.
  2713         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2714         16  AM-LAST-MAINT-USER            PIC X(4).
  2715         16  FILLER                        PIC XX.
  2716
  2717     12  AM-EFFECTIVE-DT                   PIC XX.
  2718     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2719
  2720     12  AM-PREV-DATES  COMP-3.
  2721         16  AM-PREV-EXP-DT                PIC 9(11).
  2722         16  AM-PREV-EFF-DT                PIC 9(11).
  2723
  2724     12  AM-REPORT-CODE-1                  PIC X(10).
  2725     12  AM-REPORT-CODE-2                  PIC X(10).
  2726
  2727     12  AM-CITY-CODE                      PIC X(4).
  2728     12  AM-COUNTY-PARISH                  PIC X(6).
  2729
  2730     12  AM-NAME                           PIC X(30).
  2731     12  AM-PERSON                         PIC X(30).
  2732     12  AM-ADDRS                          PIC X(30).
  2733     12  AM-CITY.
  2734         16  AM-ADDR-CITY                  PIC X(28).
  2735         16  AM-ADDR-STATE                 PIC XX.
  2736     12  AM-ZIP.
  2737         16  AM-ZIP-PRIME.
  2738             20  AM-ZIP-PRI-1ST            PIC X.
  2739                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  49
* SOCK03.cbl
  2740             20  FILLER                    PIC X(4).
  2741         16  AM-ZIP-PLUS4                  PIC X(4).
  2742     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2743         16  AM-CAN-POSTAL-1               PIC XXX.
  2744         16  AM-CAN-POSTAL-2               PIC XXX.
  2745         16  FILLER                        PIC XXX.
  2746     12  AM-TEL-NO.
  2747         16  AM-AREA-CODE                  PIC 999.
  2748         16  AM-TEL-PRE                    PIC 999.
  2749         16  AM-TEL-NBR                    PIC 9(4).
  2750     12  AM-TEL-LOC                        PIC X.
  2751         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2752         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2753
  2754     12  AM-COMM-STRUCTURE.
  2755         16  AM-DEFN-1.
  2756             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2757                 24  AM-AGT.
  2758                     28  AM-AGT-PREFIX     PIC X(4).
  2759                     28  AM-AGT-PRIME      PIC X(6).
  2760                 24  AM-COM-TYP            PIC X.
  2761                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2762                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2763                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2764                 24  AM-RECALC-LV-INDIC    PIC X.
  2765                 24  AM-RETRO-LV-INDIC     PIC X.
  2766                 24  AM-GL-CODES           PIC X.
  2767                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2768                 24  FILLER                PIC X(01).
  2769         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2770             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2771                 24  FILLER                PIC X(11).
  2772                 24  AM-L-COMA             PIC XXX.
  2773                 24  AM-J-COMA             PIC XXX.
  2774                 24  AM-A-COMA             PIC XXX.
  2775                 24  FILLER                PIC X(6).
  2776
  2777     12  AM-COMM-CHANGE-STATUS             PIC X.
  2778         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2779
  2780     12  AM-CSR-CODE                       PIC X(4).
  2781
  2782     12  AM-BILLING-STATUS                 PIC X.
  2783         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2784         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2785     12  AM-AUTO-REFUND-SW                 PIC X.
  2786         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2787         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2788     12  AM-GPCD                           PIC 99.
  2789     12  AM-IG                             PIC X.
  2790         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2791         88  AM-HAS-GROUP                     VALUE '2'.
  2792     12  AM-STATUS                         PIC X.
  2793         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2794         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2795         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2796         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2797         88  AM-ACCOUNT-FROZEN                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  50
* SOCK03.cbl
  2798         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2799         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2800         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2801         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2802         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2803     12  AM-REMIT-TO                       PIC 99.
  2804     12  AM-ID-NO                          PIC X(11).
  2805
  2806     12  AM-CAL-TABLE                      PIC XX.
  2807     12  AM-LF-DEVIATION                   PIC XXX.
  2808     12  AM-AH-DEVIATION                   PIC XXX.
  2809     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2810     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2811     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2812     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2813     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2814     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2815
  2816     12  AM-USER-FIELDS.
  2817         16  AM-FLD-1                      PIC XX.
  2818         16  AM-FLD-2                      PIC XX.
  2819         16  AM-FLD-3                      PIC XX.
  2820         16  AM-FLD-4                      PIC XX.
  2821         16  AM-FLD-5                      PIC XX.
  2822
  2823     12  AM-1ST-PROD-DATE.
  2824         16  AM-1ST-PROD-YR                PIC XX.
  2825         16  AM-1ST-PROD-MO                PIC XX.
  2826         16  AM-1ST-PROD-DA                PIC XX.
  2827     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2828     12  AM-CERTS-PURGED-DATE.
  2829         16  AM-PUR-YR                     PIC XX.
  2830         16  AM-PUR-MO                     PIC XX.
  2831         16  AM-PUR-DA                     PIC XX.
  2832     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2833     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2834     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2835     12  AM-INACTIVE-DATE.
  2836         16  AM-INA-MO                     PIC 99.
  2837         16  AM-INA-DA                     PIC 99.
  2838         16  AM-INA-YR                     PIC 99.
  2839     12  AM-AR-HI-CERT-DATE                PIC XX.
  2840
  2841     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2842     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2843
  2844     12  AM-OB-PAYMENT-MODE                PIC X.
  2845         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2846         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2847         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2848         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2849
  2850     12  AM-AH-ONLY-INDICATOR              PIC X.
  2851         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2852         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2853
  2854     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2855
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  51
* SOCK03.cbl
  2856     12  AM-OVER-SHORT.
  2857         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2858         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2859
  2860     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2861     12  AM-DCC-CLP-STATE                  PIC XX.
  2862
  2863     12  AM-RECALC-COMM                    PIC X.
  2864     12  AM-RECALC-REIN                    PIC X.
  2865
  2866     12  AM-REI-TABLE                      PIC XXX.
  2867     12  AM-REI-ET-LF                      PIC X.
  2868     12  AM-REI-ET-AH                      PIC X.
  2869     12  AM-REI-PE-LF                      PIC X.
  2870     12  AM-REI-PE-AH                      PIC X.
  2871     12  AM-REI-PRT-ST                     PIC X.
  2872     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2873     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2874     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2875     12  AM-REI-GROUP-A                    PIC X(6).
  2876     12  AM-REI-MORT                       PIC X(4).
  2877     12  AM-REI-PRT-OW                     PIC X.
  2878     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2879     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2880     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2881     12  AM-REI-GROUP-B                    PIC X(6).
  2882
  2883     12  AM-TRUST-TYPE                     PIC X(2).
  2884
  2885     12  AM-EMPLOYER-STMT-USED             PIC X.
  2886     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2887
  2888     12  AM-STD-AH-TYPE                    PIC XX.
  2889     12  AM-EARN-METHODS.
  2890         16  AM-EARN-METHOD-R              PIC X.
  2891             88 AM-REF-RL-R78                 VALUE 'R'.
  2892             88 AM-REF-RL-PR                  VALUE 'P'.
  2893             88 AM-REF-RL-MEAN                VALUE 'M'.
  2894             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2895         16  AM-EARN-METHOD-L              PIC X.
  2896             88 AM-REF-LL-R78                 VALUE 'R'.
  2897             88 AM-REF-LL-PR                  VALUE 'P'.
  2898             88 AM-REF-LL-MEAN                VALUE 'M'.
  2899             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2900         16  AM-EARN-METHOD-A              PIC X.
  2901             88 AM-REF-AH-R78                 VALUE 'R'.
  2902             88 AM-REF-AH-PR                  VALUE 'P'.
  2903             88 AM-REF-AH-MEAN                VALUE 'M'.
  2904             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2905             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2906             88 AM-REF-AH-NET                 VALUE 'N'.
  2907
  2908     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2909     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2910     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2911
  2912     12  AM-RET-Y-N                        PIC X.
  2913     12  AM-RET-P-E                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  52
* SOCK03.cbl
  2914     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2915     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2916     12  AM-RET-GRP                        PIC X(6).
  2917     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2918         16  AM-POOL-PRIME                 PIC XXX.
  2919         16  AM-POOL-SUB                   PIC XXX.
  2920     12  AM-RETRO-EARNINGS.
  2921         16  AM-RET-EARN-R                 PIC X.
  2922         16  AM-RET-EARN-L                 PIC X.
  2923         16  AM-RET-EARN-A                 PIC X.
  2924     12  AM-RET-ST-TAX-USE                 PIC X.
  2925         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2926         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2927     12  AM-RETRO-BEG-EARNINGS.
  2928         16  AM-RET-BEG-EARN-R             PIC X.
  2929         16  AM-RET-BEG-EARN-L             PIC X.
  2930         16  AM-RET-BEG-EARN-A             PIC X.
  2931     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2932     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2933
  2934     12  AM-USER-SELECT-OPTIONS.
  2935         16  AM-USER-SELECT-1              PIC X(10).
  2936         16  AM-USER-SELECT-2              PIC X(10).
  2937         16  AM-USER-SELECT-3              PIC X(10).
  2938         16  AM-USER-SELECT-4              PIC X(10).
  2939         16  AM-USER-SELECT-5              PIC X(10).
  2940
  2941     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2942
  2943     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2944
  2945     12  AM-RPT045A-SWITCH                 PIC X.
  2946         88  RPT045A-OFF                   VALUE 'N'.
  2947
  2948     12  AM-INSURANCE-LIMITS.
  2949         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2950         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2951
  2952     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2953         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2954
  2955     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2956         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2957         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2958
  2959     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2960
  2961     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2962     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2963     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2964     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2965     12  AM-DCC-UEF-STATE                  PIC XX.
  2966     12  FILLER                            PIC XXX.
  2967     12  AM-REPORT-CODE-3                  PIC X(10).
  2968*    12  FILLER                            PIC X(22).
  2969
  2970     12  AM-RESERVE-DATE.
  2971         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  53
* SOCK03.cbl
  2972         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2973         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2974
  2975     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2976     12  AM-NOTIFICATION-TYPES.
  2977         16  AM-NOTIF-OF-LETTERS           PIC X.
  2978         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2979         16  AM-NOTIF-OF-REPORTS           PIC X.
  2980         16  AM-NOTIF-OF-STATUS            PIC X.
  2981
  2982     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2983         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2984         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2985         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2986         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2987
  2988     12  AM-BENEFIT-CONTROLS.
  2989         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2990             20  AM-BENEFIT-CODE           PIC XX.
  2991             20  AM-BENEFIT-TYPE           PIC X.
  2992             20  AM-BENEFIT-REVISION       PIC XXX.
  2993             20  AM-BENEFIT-REM-TERM       PIC X.
  2994             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2995             20  FILLER                    PIC XX.
  2996         16  FILLER                        PIC X(80).
  2997
  2998     12  AM-TRANSFER-DATA.
  2999         16  AM-TRANSFERRED-FROM.
  3000             20  AM-TRNFROM-CARRIER        PIC X.
  3001             20  AM-TRNFROM-GROUPING.
  3002                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3003                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3004             20  AM-TRNFROM-STATE          PIC XX.
  3005             20  AM-TRNFROM-ACCOUNT.
  3006                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3007                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3008             20  AM-TRNFROM-DTE            PIC XX.
  3009         16  AM-TRANSFERRED-TO.
  3010             20  AM-TRNTO-CARRIER          PIC X.
  3011             20  AM-TRNTO-GROUPING.
  3012                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3013                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3014             20  AM-TRNTO-STATE            PIC XX.
  3015             20  AM-TRNTO-ACCOUNT.
  3016                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3017                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3018             20  AM-TRNTO-DTE              PIC XX.
  3019         16  FILLER                        PIC X(10).
  3020
  3021     12  AM-SAVED-REMIT-TO                 PIC 99.
  3022
  3023     12  AM-COMM-STRUCTURE-SAVED.
  3024         16  AM-DEFN-1-SAVED.
  3025             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3026                 24  AM-AGT-SV             PIC X(10).
  3027                 24  AM-COM-TYP-SV         PIC X.
  3028                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3029                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  54
* SOCK03.cbl
  3030                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3031                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3032                 24  FILLER                PIC X.
  3033                 24  AM-GL-CODES-SV        PIC X.
  3034                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3035                 24  FILLER                PIC X.
  3036         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3037             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3038                 24  FILLER                PIC X(11).
  3039                 24  AM-L-COMA-SV          PIC XXX.
  3040                 24  AM-J-COMA-SV          PIC XXX.
  3041                 24  AM-A-COMA-SV          PIC XXX.
  3042                 24  FILLER                PIC X(6).
  3043
  3044     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3045         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3046            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3047            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3048            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3049
  3050     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3051     12  FILLER                            PIC X(120).
  3052
  3053     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3054         16  AM-CONTROL-NAME               PIC X(30).
  3055         16  AM-EXECUTIVE-ONE.
  3056             20  AM-EXEC1-NAME             PIC X(15).
  3057             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3058                                                          COMP-3.
  3059             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3060                                                          COMP-3.
  3061         16  AM-EXECUTIVE-TWO.
  3062             20  AM-EXEC2-NAME             PIC X(15).
  3063             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3064                                                          COMP-3.
  3065             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3066                                                          COMP-3.
  3067
  3068     12  AM-RETRO-ADDITIONAL-DATA.
  3069         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3070         16  AM-RETRO-PREM-P-E             PIC X.
  3071         16  AM-RETRO-CLMS-P-I             PIC X.
  3072         16  AM-RETRO-RET-BRACKET-LF.
  3073             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3074                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3075                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3076             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3077                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3078                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3079             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3080                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3081                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3082         16  AM-RETRO-RET-BRACKET-AH.
  3083             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3084                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3085                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3086                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3087             20  AM-RETRO-RET-BASIS-AH     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  55
* SOCK03.cbl
  3088                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3089                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3090             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3091                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3092                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3093
  3094     12  AM-COMMENTS.
  3095         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3096
  3097     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3098         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3099         16  AM-FLI-BILLING-CODE           PIC X.
  3100         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3101         16  AM-FLI-UNITED-IDENT           PIC X.
  3102         16  AM-FLI-INTEREST-LOST-DATA.
  3103             20  AM-FLI-BANK-NO            PIC X(5).
  3104             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3105             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3106             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3107         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3108             20  AM-FLI-AGT                PIC X(9).
  3109             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3110             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3111         16  FILLER                        PIC X(102).
  3112
  3113     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3114         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3115             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3116             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3117             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3118             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3119             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3120         16  FILLER                          PIC X(10).
  3121******************************************************************
  3122*                                 COPY ERCMAIL.
  3123******************************************************************
  3124*                                                                *
  3125*                                                                *
  3126*                            ERCMAIL                             *
  3127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3128*                            VMOD=2.003                          *
  3129*                                                                *
  3130*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3131*                                                                *
  3132*   FILE TYPE = VSAM,KSDS                                        *
  3133*   RECORD SIZE = 374   RECFORM = FIX                            *
  3134*                                                                *
  3135*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3136*   ALTERNATE PATH    = NOT USED                                 *
  3137*                                                                *
  3138*   LOG = YES                                                    *
  3139*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3140******************************************************************
  3141*                   C H A N G E   L O G
  3142*
  3143* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3144*-----------------------------------------------------------------
  3145*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  56
* SOCK03.cbl
  3146* EFFECTIVE    NUMBER
  3147*-----------------------------------------------------------------
  3148* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3149* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3150* 111108                   PEMA  ADD CRED BENE ADDR2
  3151******************************************************************
  3152
  3153 01  MAILING-DATA.
  3154     12  MA-RECORD-ID                      PIC XX.
  3155         88  VALID-MA-ID                       VALUE 'MA'.
  3156
  3157     12  MA-CONTROL-PRIMARY.
  3158         16  MA-COMPANY-CD                 PIC X.
  3159         16  MA-CARRIER                    PIC X.
  3160         16  MA-GROUPING.
  3161             20  MA-GROUPING-PREFIX        PIC XXX.
  3162             20  MA-GROUPING-PRIME         PIC XXX.
  3163         16  MA-STATE                      PIC XX.
  3164         16  MA-ACCOUNT.
  3165             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3166             20  MA-ACCOUNT-PRIME          PIC X(6).
  3167         16  MA-CERT-EFF-DT                PIC XX.
  3168         16  MA-CERT-NO.
  3169             20  MA-CERT-PRIME             PIC X(10).
  3170             20  MA-CERT-SFX               PIC X.
  3171
  3172     12  FILLER                            PIC XX.
  3173
  3174     12  MA-ACCESS-CONTROL.
  3175         16  MA-SOURCE-SYSTEM              PIC XX.
  3176             88  MA-FROM-CREDIT                VALUE 'CR'.
  3177             88  MA-FROM-VSI                   VALUE 'VS'.
  3178             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3179             88  MA-FROM-OTHER                 VALUE 'OT'.
  3180         16  MA-RECORD-ADD-DT              PIC XX.
  3181         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3182         16  MA-LAST-MAINT-DT              PIC XX.
  3183         16  MA-LAST-MAINT-BY              PIC XXXX.
  3184         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3185
  3186     12  MA-PROFILE-INFO.
  3187         16  MA-QUALIFY-CODE-1             PIC XX.
  3188         16  MA-QUALIFY-CODE-2             PIC XX.
  3189         16  MA-QUALIFY-CODE-3             PIC XX.
  3190         16  MA-QUALIFY-CODE-4             PIC XX.
  3191         16  MA-QUALIFY-CODE-5             PIC XX.
  3192
  3193         16  MA-INSURED-LAST-NAME          PIC X(15).
  3194         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3195         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3196         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3197         16  MA-INSURED-BIRTH-DT           PIC XX.
  3198         16  MA-INSURED-SEX                PIC X.
  3199             88  MA-SEX-MALE                   VALUE 'M'.
  3200             88  MA-SEX-FEMALE                 VALUE 'F'.
  3201         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3202
  3203         16  MA-ADDRESS-CORRECTED          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  57
* SOCK03.cbl
  3204         16  MA-JOINT-BIRTH-DT             PIC XX.
  3205*        16  FILLER                        PIC X(12).
  3206
  3207         16  MA-ADDRESS-LINE-1             PIC X(30).
  3208         16  MA-ADDRESS-LINE-2             PIC X(30).
  3209         16  MA-CITY-STATE.
  3210             20  MA-CITY                   PIC X(28).
  3211             20  MA-ADDR-STATE             PIC XX.
  3212         16  MA-ZIP.
  3213             20  MA-ZIP-CODE.
  3214                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3215                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3216                 24  FILLER                PIC X(4).
  3217             20  MA-ZIP-PLUS4              PIC X(4).
  3218         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3219             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3220             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3221             20  FILLER                    PIC X(3).
  3222
  3223         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3224
  3225         16  FILLER                        PIC XXX.
  3226*        16  FILLER                        PIC X(10).
  3227
  3228     12  MA-CRED-BENE-INFO.
  3229         16  MA-CRED-BENE-NAME                 PIC X(25).
  3230         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3231         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3232         16  MA-CRED-BENE-CTYST.
  3233             20  MA-CRED-BENE-CITY             PIC X(28).
  3234             20  MA-CRED-BENE-STATE            PIC XX.
  3235         16  MA-CRED-BENE-ZIP.
  3236             20  MA-CB-ZIP-CODE.
  3237                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3238                     88  MA-CB-CANADIAN-POST-CODE
  3239                                           VALUE 'A' THRU 'Z'.
  3240                 24  FILLER                    PIC X(4).
  3241             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3242         16  MA-CB-CANADIAN-POSTAL-CODE
  3243                            REDEFINES MA-CRED-BENE-ZIP.
  3244             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3245             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3246             20  FILLER                        PIC X(3).
  3247     12  MA-POST-CARD-MAIL-DATA.
  3248         16  MA-MAIL-DATA OCCURS 7.
  3249             20  MA-MAIL-TYPE              PIC X.
  3250                 88  MA-12MO-MAILING           VALUE '1'.
  3251                 88  MA-EXP-MAILING            VALUE '2'.
  3252             20  MA-MAIL-STATUS            PIC X.
  3253                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3254                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3255                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3256             20  MA-MAIL-DATE              PIC XX.
  3257     12  FILLER                            PIC XX.
  3258     12  FILLER                            PIC XX.
  3259*    12  FILLER                            PIC X(30).
  3260******************************************************************
  3261*                                 COPY ELCCRTT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  58
* SOCK03.cbl
  3262******************************************************************
  3263*                                                                *
  3264*                            ELCCRTT.                            *
  3265*                                                                *
  3266*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3267*                                                                *
  3268*   FILE TYPE = VSAM,KSDS                                        *
  3269*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3270*                                                                *
  3271*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3272*                                                                *
  3273*   LOG = YES                                                    *
  3274*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3275******************************************************************
  3276*                   C H A N G E   L O G
  3277*
  3278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3279*-----------------------------------------------------------------
  3280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3281* EFFECTIVE    NUMBER
  3282*-----------------------------------------------------------------
  3283* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3284* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3285* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3286* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3287* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3288* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3289* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3290* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3291* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3292* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3293* 091318  CR2018073000001  PEMA  ADD Refund methods
  3294* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3295******************************************************************
  3296
  3297 01  CERTIFICATE-TRAILERS.
  3298     12  CS-RECORD-ID                      PIC XX.
  3299         88  VALID-CS-ID                      VALUE 'CS'.
  3300
  3301     12  CS-CONTROL-PRIMARY.
  3302         16  CS-COMPANY-CD                 PIC X.
  3303         16  CS-CARRIER                    PIC X.
  3304         16  CS-GROUPING                   PIC X(6).
  3305         16  CS-STATE                      PIC XX.
  3306         16  CS-ACCOUNT                    PIC X(10).
  3307         16  CS-CERT-EFF-DT                PIC XX.
  3308         16  CS-CERT-NO.
  3309             20  CS-CERT-PRIME             PIC X(10).
  3310             20  CS-CERT-SFX               PIC X.
  3311         16  CS-TRAILER-TYPE               PIC X.
  3312             88  COMM-TRLR           VALUE 'A'.
  3313             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3314             88  CERT-DATA-TRLR      VALUE 'C'.
  3315
  3316     12  CS-DATA-AREA                      PIC X(516).
  3317
  3318     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3319         16  CS-BANK-COMMISSION-AREA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  59
* SOCK03.cbl
  3320             20  CS-BANK-COMMS       OCCURS 10.
  3321                 24  CS-AGT                PIC X(10).
  3322                 24  CS-COM-TYP            PIC X.
  3323                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3324                 24  CS-RECALC-LV-INDIC    PIC X.
  3325                 24  FILLER                PIC X(10).
  3326         16  FILLER                        PIC X(256).
  3327
  3328     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3329****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3330         16  CS-MB-CLAIM-DATA OCCURS 24.
  3331             20  CS-CLAIM-NO               PIC X(7).
  3332             20  CS-CLAIM-TYPE             PIC X.
  3333                 88  CS-AH-CLM               VALUE 'A'.
  3334                 88  CS-IU-CLM               VALUE 'I'.
  3335                 88  CS-GP-CLM               VALUE 'G'.
  3336                 88  CS-LF-CLM               VALUE 'L'.
  3337                 88  CS-PR-CLM               VALUE 'P'.
  3338                 88  CS-FL-CLM               VALUE 'F'.
  3339                 88  CS-OT-CLM               VALUE 'O'.
  3340             20  CS-INSURED-TYPE           PIC X.
  3341                 88  CS-PRIM-INSURED          VALUE 'P'.
  3342                 88  CS-CO-BORROWER           VALUE 'C'.
  3343             20  CS-BENEFIT-PERIOD         PIC 99.
  3344             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3345             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3346             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3347         16  FILLER                        PIC X(12).
  3348     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3349         16  CS-VIN-NUMBER                 PIC X(17).
  3350         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3351         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3352         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3353         16  cs-agent-name.
  3354             20  cs-agent-fname            pic x(20).
  3355             20  cs-agent-mi               pic x.
  3356             20  cs-agent-lname            pic x(25).
  3357         16  cs-license-no                 pic x(15).
  3358         16  cs-npn-number                 pic x(10).
  3359         16  cs-agent-edit-status          pic x.
  3360             88  cs-ae-refer-to-manager      value 'M'.
  3361             88  cs-ae-cover-sheet           value 'C'.
  3362             88  cs-ae-sig-form              value 'S'.
  3363             88  cs-ae-verified              value 'V'.
  3364             88  cs-unidentified-signature   value 'U'.
  3365             88  cs-cert-returned            value 'R'.
  3366             88  cs-accept-no-commission     value 'N'.
  3367         16  cs-year                       pic 9999.
  3368         16  cs-make                       pic x(20).
  3369         16  cs-model                      pic x(20).
  3370         16  cs-future                     pic x(20).
  3371         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3372         16  cs-claim-verification-status  pic x.
  3373             88  cs-clm-ver-eligible         value 'A'.
  3374             88  cs-clm-ver-partial-elig     value 'B'.
  3375             88  cs-clm-ver-not-eligible     value 'C'.
  3376             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3377             88  cs-clm-ver-not-part-elig-rw value 'E'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  60
* SOCK03.cbl
  3378             88  cs-clm-ver-ND-CERT          value 'F'.
  3379             88  cs-clm-ver-spec-other       value 'G'.
  3380             88  cs-clam-ver-pratial-corrected
  3381                                             value 'H'.
  3382             88  cs-clm-ver-no-matches       value 'I'.
  3383             88  cs-clm-ver-not-elig-corrected
  3384                                             value 'J'.
  3385             88  cs-clm-ver-needs-review     value 'R'.
  3386             88  cs-clm-ver-sent-to-claims   value 'W'.
  3387         16  CS-LF-REFUND-METHOD           PIC X.
  3388         16  CS-AH-REFUND-METHOD           PIC X.
  3389         16  FILLER                        PIC X(353). *> was 420
  3390*        16  FILLER                        PIC X(496).
  3391*                                 COPY ELCDATE.
  3392******************************************************************
  3393*                                                                *
  3394*                                                                *
  3395*                            ELCDATE.                            *
  3396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3397*                            VMOD=2.003
  3398*                                                                *
  3399*                                                                *
  3400*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3401*                 LENGTH = 200                                   *
  3402******************************************************************
  3403
  3404 01  DATE-CONVERSION-DATA.
  3405     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3406     12  DC-OPTION-CODE                PIC X.
  3407         88  BIN-TO-GREG                VALUE ' '.
  3408         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3409         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3410         88  YMD-GREG-TO-BIN            VALUE '3'.
  3411         88  MDY-GREG-TO-BIN            VALUE '4'.
  3412         88  JULIAN-TO-BIN              VALUE '5'.
  3413         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3414         88  FIND-CENTURY               VALUE '7'.
  3415         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3416         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3417         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3418         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3419         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3420         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3421         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3422         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3423         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3424         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3425         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3426         88  BIN-3-TO-GREG              VALUE 'I'.
  3427         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3428         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3429         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3430         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3431         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3432         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3433         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3434         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3435         88  THREE-CHARACTER-BIN
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  61
* SOCK03.cbl
  3436                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3437         88  GREGORIAN-TO-BIN
  3438                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3439         88  BIN-TO-GREGORIAN
  3440                  VALUES ' ' '1' 'I' '8' 'G'.
  3441         88  JULIAN-TO-BINARY
  3442                  VALUES '5' 'C' 'E' 'F'.
  3443     12  DC-ERROR-CODE                 PIC X.
  3444         88  NO-CONVERSION-ERROR        VALUE ' '.
  3445         88  DATE-CONVERSION-ERROR
  3446                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3447         88  DATE-IS-ZERO               VALUE '1'.
  3448         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3449         88  DATE-IS-INVALID            VALUE '3'.
  3450         88  DATE1-GREATER-DATE2        VALUE '4'.
  3451         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3452         88  DATE-INVALID-OPTION        VALUE '9'.
  3453         88  INVALID-CENTURY            VALUE 'A'.
  3454         88  ONLY-CENTURY               VALUE 'B'.
  3455         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3456         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3457     12  DC-END-OF-MONTH               PIC X.
  3458         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3459     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3460         88  USE-NORMAL-PROCESS         VALUE ' '.
  3461         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3462         88  ADJUST-UP-100-YRS          VALUE '2'.
  3463     12  FILLER                        PIC X.
  3464     12  DC-CONVERSION-DATES.
  3465         16  DC-BIN-DATE-1             PIC XX.
  3466         16  DC-BIN-DATE-2             PIC XX.
  3467         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3468         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3469                       DC-GREG-DATE-1-EDIT.
  3470             20  DC-EDIT1-MONTH        PIC 99.
  3471             20  SLASH1-1              PIC X.
  3472             20  DC-EDIT1-DAY          PIC 99.
  3473             20  SLASH1-2              PIC X.
  3474             20  DC-EDIT1-YEAR         PIC 99.
  3475         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3476         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3477                     DC-GREG-DATE-2-EDIT.
  3478             20  DC-EDIT2-MONTH        PIC 99.
  3479             20  SLASH2-1              PIC X.
  3480             20  DC-EDIT2-DAY          PIC 99.
  3481             20  SLASH2-2              PIC X.
  3482             20  DC-EDIT2-YEAR         PIC 99.
  3483         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3484         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3485                     DC-GREG-DATE-1-YMD.
  3486             20  DC-YMD-YEAR           PIC 99.
  3487             20  DC-YMD-MONTH          PIC 99.
  3488             20  DC-YMD-DAY            PIC 99.
  3489         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3490         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3491                      DC-GREG-DATE-1-MDY.
  3492             20  DC-MDY-MONTH          PIC 99.
  3493             20  DC-MDY-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  62
* SOCK03.cbl
  3494             20  DC-MDY-YEAR           PIC 99.
  3495         16  DC-GREG-DATE-1-ALPHA.
  3496             20  DC-ALPHA-MONTH        PIC X(10).
  3497             20  DC-ALPHA-DAY          PIC 99.
  3498             20  FILLER                PIC XX.
  3499             20  DC-ALPHA-CENTURY.
  3500                 24 DC-ALPHA-CEN-N     PIC 99.
  3501             20  DC-ALPHA-YEAR         PIC 99.
  3502         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3503         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3504         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3505         16  DC-JULIAN-DATE            PIC 9(05).
  3506         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3507                                       PIC 9(05).
  3508         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3509             20  DC-JULIAN-YEAR        PIC 99.
  3510             20  DC-JULIAN-DAYS        PIC 999.
  3511         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3512         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3513         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3514     12  DATE-CONVERSION-VARIBLES.
  3515         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3516         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3517             20  FILLER                PIC 9(3).
  3518             20  HOLD-CEN-1-CCYY.
  3519                 24  HOLD-CEN-1-CC     PIC 99.
  3520                 24  HOLD-CEN-1-YY     PIC 99.
  3521             20  HOLD-CEN-1-MO         PIC 99.
  3522             20  HOLD-CEN-1-DA         PIC 99.
  3523         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3524             20  HOLD-CEN-1-R-MO       PIC 99.
  3525             20  HOLD-CEN-1-R-DA       PIC 99.
  3526             20  HOLD-CEN-1-R-CCYY.
  3527                 24  HOLD-CEN-1-R-CC   PIC 99.
  3528                 24  HOLD-CEN-1-R-YY   PIC 99.
  3529             20  FILLER                PIC 9(3).
  3530         16  HOLD-CENTURY-1-X.
  3531             20  FILLER                PIC X(3)  VALUE SPACES.
  3532             20  HOLD-CEN-1-X-CCYY.
  3533                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3534                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3535             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3536             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3537         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3538             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3539             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3540             20  HOLD-CEN-1-R-X-CCYY.
  3541                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3542                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3543             20  FILLER                PIC XXX.
  3544         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3545         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3546         16  DC-JULIAN-DATE-1          PIC 9(07).
  3547         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3548             20  DC-JULIAN-1-CCYY.
  3549                 24  DC-JULIAN-1-CC    PIC 99.
  3550                 24  DC-JULIAN-1-YR    PIC 99.
  3551             20  DC-JULIAN-DA-1        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  63
* SOCK03.cbl
  3552         16  DC-JULIAN-DATE-2          PIC 9(07).
  3553         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3554             20  DC-JULIAN-2-CCYY.
  3555                 24  DC-JULIAN-2-CC    PIC 99.
  3556                 24  DC-JULIAN-2-YR    PIC 99.
  3557             20  DC-JULIAN-DA-2        PIC 999.
  3558         16  DC-GREG-DATE-A-EDIT.
  3559             20  DC-EDITA-MONTH        PIC 99.
  3560             20  SLASHA-1              PIC X VALUE '/'.
  3561             20  DC-EDITA-DAY          PIC 99.
  3562             20  SLASHA-2              PIC X VALUE '/'.
  3563             20  DC-EDITA-CCYY.
  3564                 24  DC-EDITA-CENT     PIC 99.
  3565                 24  DC-EDITA-YEAR     PIC 99.
  3566         16  DC-GREG-DATE-B-EDIT.
  3567             20  DC-EDITB-MONTH        PIC 99.
  3568             20  SLASHB-1              PIC X VALUE '/'.
  3569             20  DC-EDITB-DAY          PIC 99.
  3570             20  SLASHB-2              PIC X VALUE '/'.
  3571             20  DC-EDITB-CCYY.
  3572                 24  DC-EDITB-CENT     PIC 99.
  3573                 24  DC-EDITB-YEAR     PIC 99.
  3574         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3575         16  DC-GREG-DATE-CYMD-R REDEFINES
  3576                              DC-GREG-DATE-CYMD.
  3577             20  DC-CYMD-CEN           PIC 99.
  3578             20  DC-CYMD-YEAR          PIC 99.
  3579             20  DC-CYMD-MONTH         PIC 99.
  3580             20  DC-CYMD-DAY           PIC 99.
  3581         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3582         16  DC-GREG-DATE-MDCY-R REDEFINES
  3583                              DC-GREG-DATE-MDCY.
  3584             20  DC-MDCY-MONTH         PIC 99.
  3585             20  DC-MDCY-DAY           PIC 99.
  3586             20  DC-MDCY-CEN           PIC 99.
  3587             20  DC-MDCY-YEAR          PIC 99.
  3588    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3589        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3590    12  DC-EL310-DATE                  PIC X(21).
  3591    12  FILLER                         PIC X(28).
  3592*                                 COPY ELCCALC.
  3593******************************************************************
  3594*                                                                *
  3595*                           ELCCALC.                            *
  3596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3597*                            VMOD=2.025                          *
  3598*                                                                *
  3599*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3600*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3601*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3602*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3603*                                                                *
  3604*  PASSED TO ELRTRM                                              *
  3605*  -----------------                                             *
  3606*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3607*  ORIGINAL TERM                                                 *
  3608*  BEGINNING DATE                                                *
  3609*  ENDING DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  64
* SOCK03.cbl
  3610*  COMPANY I.D.                                                  *
  3611*  ACCOUNT MASTER USER FIELD                                     *
  3612*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3613*  FREE LOOK DAYS                                                *
  3614*                                                                *
  3615*  RETURNED FROM ELRTRM                                          *
  3616*  ---------------------                                         *
  3617*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3618*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3619*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3620*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3621*----------------------------------------------------------------*
  3622*  PASSED TO ELRAMT                                              *
  3623*  ----------------                                              *
  3624*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3625*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3626*  ORIGINAL AMOUNT                                               *
  3627*  ALTERNATE BENEFIT (BALLON)                                    *
  3628*  A.P.R. - NET PAY ONLY                                         *
  3629*  METHOD
  3630*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3631*  COMPANY I.D.                                                  *
  3632*  BENEFIT TYPE                                                  *
  3633*                                                                *
  3634*  RETURNED FROM ELRAMT                                          *
  3635*  --------------------                                          *
  3636*  REMAINING AMOUNT 1 - CURRENT                                  *
  3637*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3638*  REMAINING AMOUNT FACTOR
  3639*----------------------------------------------------------------*
  3640*  PASSED TO ELRESV                                              *
  3641*  -----------------                                             *
  3642*  CERTIFICATE EFFECTIVE DATE                                    *
  3643*  VALUATION DATE                                                *
  3644*  PAID THRU DATE                                                *
  3645*  BENEFIT                                                       *
  3646*  INCURRED DATE                                                 *
  3647*  REPORTED DATE                                                 *
  3648*  ISSUE AGE                                                     *
  3649*  TERM                                                          *
  3650*  CDT PERCENT                                                   *
  3651*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3652* *CLAIM TYPE (LIFE, A/H)                                        *
  3653* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3654* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3655*                                                                *
  3656*  RETURNED FROM ELRESV                                          *
  3657*  --------------------                                          *
  3658*  CDT TABLE USED                                                *
  3659*  CDT FACTOR USED                                               *
  3660*  PAY TO CURRENT RESERVE                                        *
  3661*  I.B.N.R. - A/H ONLY                                           *
  3662*  FUTURE (ACCRUED) AH ONLY                                      *
  3663*----------------------------------------------------------------*
  3664*  PASSED TO ELRATE                                              *
  3665*  ----------------                                              *
  3666*  CERT ISSUE DATE                                               *
  3667*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  65
* SOCK03.cbl
  3668*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3669*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3670*  STATE CODE (CLIENT DEFINED)                                   *
  3671*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3672*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3673*  DEVIATION CODE                                                *
  3674*  ISSUE AGE                                                     *
  3675*  ORIGINAL BENEFIT AMOUNT                                       *
  3676*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3677*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3678*  BENEFIT KIND (LIFE OR A/H)                                    *
  3679*  A.P.R.                                                        *
  3680*  METHOD
  3681*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3682*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3683*  COMPANY I.D. (3 CHARACTER)                                    *
  3684*  BENEFIT CODE                                                  *
  3685*  BENEFIT OVERRIDE CODE                                         *
  3686*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3687*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3688*  JOINT INDICATOR (CSL ONLY)                                    *
  3689*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3690*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3691*                                                                *
  3692*  RETURNED FROM ELRATE                                          *
  3693*  --------------------                                          *
  3694*  CALCULATED PREMIUM                                            *
  3695*  PREMIUM RATE                                                  *
  3696*  MORTALITY CODE                                                *
  3697*  MAX ATTAINED AGE                                              *
  3698*  MAX AGE                                                       *
  3699*  MAX TERM                                                      *
  3700*  MAX MONTHLY BENEFIT                                           *
  3701*  MAX TOTAL BENIFIT                                             *
  3702*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3703*----------------------------------------------------------------*
  3704*  PASSED TO ELRFND                                              *
  3705*  ----------------                                              *
  3706*  CERT ISSUE DATE                                               *
  3707*  REFUND DATE                                                   *
  3708*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3709*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3710*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3711*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3712*  STATE CODE (CLIENT DEFINED)                                   *
  3713*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3714*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3715*  DEVIATION CODE                                                *
  3716*  ISSUE AGE                                                     *
  3717*  ORIGINAL BENEFIT AMOUNT                                       *
  3718*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3719*  PROCESS TYPE (CANCEL)                                         *
  3720*  BENEFIT KIND (LIFE OR A/H)                                    *
  3721*  A.P.R.                                                        *
  3722*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3723*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3724*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3725*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  66
* SOCK03.cbl
  3726*  COMPANY I.D. (3 CHARACTER)                                    *
  3727*  BENEFIT CODE                                                  *
  3728*  BENEFIT OVERRIDE CODE                                         *
  3729*                                                                *
  3730*  RETURNED FROM ELRFND                                          *
  3731*  --------------------                                          *
  3732*  CALCULATED REFUND                                             *
  3733*----------------------------------------------------------------*
  3734*  PASSED TO ELEARN                                              *
  3735*  ----------------                                              *
  3736*  CERT ISSUE DATE                                               *
  3737*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3738*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3739*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3740*  STATE CODE (CLIENT DEFINED)                                   *
  3741*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3742*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3743*  DEVIATION CODE                                                *
  3744*  ISSUE AGE                                                     *
  3745*  ORIGINAL BENEFIT AMOUNT                                       *
  3746*  BENEFIT KIND (LIFE OR A/H)                                    *
  3747*  A.P.R.                                                        *
  3748*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3749*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3750*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3751*  COMPANY I.D. (3 CHARACTER)                                    *
  3752*  BENEFIT CODE                                                  *
  3753*  BENEFIT OVERRIDE CODE                                         *
  3754*                                                                *
  3755*  RETURNED FROM ELEARN                                          *
  3756*  --------------------                                          *
  3757*  INDICATED  EARNINGS                                           *
  3758*----------------------------------------------------------------*
  3759*                 LENGTH = 450                                   *
  3760*                                                                *
  3761******************************************************************
  3762******************************************************************
  3763*                   C H A N G E   L O G
  3764*
  3765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3766*-----------------------------------------------------------------
  3767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3768* EFFECTIVE    NUMBER
  3769*-----------------------------------------------------------------
  3770* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3771* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3772* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3773* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3774* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3775* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3776* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3777* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3778* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3779* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3780* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3781* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  3782******************************************************************
  3783
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  67
* SOCK03.cbl
  3784 01  CALCULATION-PASS-AREA.
  3785     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3786                                     COMP.
  3787
  3788     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3789       88  NO-CP-ERROR                             VALUE ZERO.
  3790       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3791                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  3792       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3793       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3794       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3795       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3796       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3797       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3798       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3799       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3800       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3801       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3802       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3803       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3804       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3805       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3806       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3807       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3808       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3809       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  3810
  3811     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3812       88  NO-CP-ERROR-2                           VALUE ZERO.
  3813***********************  INPUT AREAS ****************************
  3814
  3815     12  CP-CALCULATION-AREA.
  3816         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3817         16  CP-CERT-EFF-DT        PIC XX.
  3818         16  CP-VALUATION-DT       PIC XX.
  3819         16  CP-PAID-THRU-DT       PIC XX.
  3820         16  CP-BENEFIT-TYPE       PIC X.
  3821           88  CP-AH                               VALUE 'A' 'D'
  3822                                                   'I' 'U'.
  3823           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3824           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3825         16  CP-INCURRED-DT        PIC XX.
  3826         16  CP-REPORTED-DT        PIC XX.
  3827         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3828         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3829         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3830                                     COMP-3.
  3831         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3832                                     COMP-3.
  3833         16  CP-CDT-METHOD         PIC X.
  3834           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3835           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3836           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3837         16  CP-CLAIM-TYPE         PIC X.
  3838           88  CP-AH-CLAIM                         VALUE 'A'.
  3839           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3840         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3841                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  68
* SOCK03.cbl
  3842         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3847                                     COMP-3.
  3848         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3851                                     COMP-3.
  3852         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3853                                     COMP-3.
  3854         16  CP-REM-TERM-METHOD    PIC X.
  3855           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3856           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3857           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3858           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3859           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3860           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3861           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3862         16  CP-EARNING-METHOD     PIC X.
  3863           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3864           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3865           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3866           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3867           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3868           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3869           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3870           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3871           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3872           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3873           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3874           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3875           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3876           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3877         16  CP-PROCESS-TYPE       PIC X.
  3878           88  CP-CLAIM                            VALUE '1'.
  3879           88  CP-CANCEL                           VALUE '2'.
  3880           88  CP-ISSUE                            VALUE '3'.
  3881         16  CP-SPECIAL-CALC-CD    PIC X.
  3882           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3883           88  CP-1-MTH-INTEREST               VALUE ' '.
  3884           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3885           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3886           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3887           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3888           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3889           88  CP-FARM-PLAN                    VALUE 'F'.
  3890           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3891           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3892           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3893           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3894           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3895           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3896           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3897           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3898           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3899           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  69
* SOCK03.cbl
  3900                                                     'W' 'X'.
  3901           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3902           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3903           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3904           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3905           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3906           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3907           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3908           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3909           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3910           88  CP-CSL-METH-1                   VALUE '5'.
  3911           88  CP-CSL-METH-2                   VALUE '6'.
  3912           88  CP-CSL-METH-3                   VALUE '7'.
  3913           88  CP-CSL-METH-4                   VALUE '8'.
  3914
  3915         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3916                                     COMP-3.
  3917         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3918         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3919         16  CP-STATE              PIC XX          VALUE SPACE.
  3920         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3921         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3922           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3923               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3924         16  CP-R78-OPTION         PIC X.
  3925           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3926           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3927
  3928         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3929         16  CP-IBNR-RESERVE-SW    PIC X.
  3930         16  CP-CLAIM-STATUS       PIC X.
  3931         16  CP-RATE-FILE          PIC X.
  3932         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3933                                     COMP-3.
  3934
  3935         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3936         16  CP-AH-OVERRIDE-CODE   PIC X.
  3937
  3938         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3941                                   PIC S9(5)V99 COMP-3.
  3942         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3945                                     COMP-3.
  3946         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3947                                     COMP-3.
  3948         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3949                                  PIC S9(7)V99 COMP-3.
  3950
  3951         16  CP-PAID-FROM-DATE     PIC X(02).
  3952         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3953         16  CP-EXT-DAYS-CALC      PIC X.
  3954           88  CP-EXT-NO-CHG                   VALUE ' '.
  3955           88  CP-EXT-CHG-LF                   VALUE '1'.
  3956           88  CP-EXT-CHG-AH                   VALUE '2'.
  3957           88  CP-EXT-CHG-LF-AH                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  70
* SOCK03.cbl
  3958         16  CP-DOMICILE-STATE     PIC XX.
  3959         16  CP-CARRIER            PIC X.
  3960         16  CP-REIN-FLAG          PIC X.
  3961         16  CP-REM-TRM-CALC-OPTION PIC X.
  3962           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3963                      '2' '3' '4' '5'.
  3964           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3965           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3966           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3967           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3968           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3969           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3970           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3971           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3972         16  CP-SIG-SWITCH         PIC X.
  3973         16  CP-RATING-METHOD      PIC X.
  3974           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3975           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3976           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3977           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3978           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3979           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3980           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3981           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3982           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3983         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3984                                     COMP-3.
  3985         16  CP-BEN-CATEGORY       PIC X.
  3986         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3987         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3988                                   PIC S99V9(5) COMP-3.
  3989         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3990         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3991                                   PIC S99V9(5) COMP-3.
  3992         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3993         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3994         16  CP-EXPIRE-DT          PIC XX.
  3995         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3996         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3997         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3998         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3999         16  CP-DDF-SPEC-CALC      PIC X.
  4000             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  4001             88  CP-CALC-CLP              VALUE 'C'.
  4002         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  4003         16  CP-CANCEL-REASON      PIC X.
  4004         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  4005         16  CP-PMT-MODE           PIC X.
  4006         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  4007         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  4008         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  4009         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  4010         16  FILLER                PIC X.
  4011
  4012***************    OUTPUT FROM ELRESV   ************************
  4013
  4014         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  4015
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  71
* SOCK03.cbl
  4016         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  4017                                     COMP-3.
  4018         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  4019                                     COMP-3.
  4020         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  4021                                     COMP-3.
  4022         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4023                                     COMP-3.
  4024         16  FILLER                PIC X(09).
  4025***************    OUTPUT FROM ELRTRM   *************************
  4026
  4027         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4028                                     COMP-3.
  4029         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4030                                     COMP-3.
  4031         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4032                                     COMP-3.
  4033         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  4034                                     COMP-3.
  4035         16  FILLER                PIC X(12).
  4036
  4037***************    OUTPUT FROM ELRAMT   *************************
  4038
  4039         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4040                                     COMP-3.
  4041         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4042                                     COMP-3.
  4043         16  FILLER                PIC X(12).
  4044
  4045***************    OUTPUT FROM ELRATE   *************************
  4046
  4047         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4048                                     COMP-3.
  4049         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4050                                     COMP-3.
  4051         16  CP-MORTALITY-CODE     PIC X(4).
  4052         16  CP-RATE-EDIT-FLAG     PIC X.
  4053             88  CP-RATES-NEED-APR                  VALUE '1'.
  4054         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4055                                     COMP-3.
  4056         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4057         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4058         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4059                                   PIC S9(7)V99 COMP-3.
  4060         16  FILLER                PIC X(07).
  4061
  4062***************    OUTPUT FROM ELRFND   *************************
  4063
  4064         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4065                                     COMP-3.
  4066         16  CP-REFUND-TYPE-USED   PIC X.
  4067           88  CP-R-AS-R78                         VALUE '1'.
  4068           88  CP-R-AS-PRORATA                     VALUE '2'.
  4069           88  CP-R-AS-CALIF                       VALUE '3'.
  4070           88  CP-R-AS-TEXAS                       VALUE '4'.
  4071           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4072           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4073           88  CP-R-AS-ANTICIPATION                VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  72
* SOCK03.cbl
  4074           88  CP-R-AS-MEAN                        VALUE '8'.
  4075           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4076           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4077           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4078           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4079           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4080           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4081         16  FILLER                PIC X(12).
  4082
  4083***************    OUTPUT FROM ELEARN   *************************
  4084
  4085         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4086                                     COMP-3.
  4087         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4088                                     COMP-3.
  4089         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4090                                     COMP-3.
  4091         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4092                                     COMP-3.
  4093         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4094                                     COMP-3.
  4095         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4096                                     COMP-3.
  4097         16  CP-EARNING-TYPE-USED  PIC X.
  4098           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4099           88  CP-E-AS-R78                         VALUE '1'.
  4100           88  CP-E-AS-PRORATA                     VALUE '2'.
  4101           88  CP-E-AS-TEXAS                       VALUE '4'.
  4102           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4103           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4104           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4105           88  CP-E-AS-MEAN                        VALUE '8'.
  4106           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4107         16  FILLER                PIC X(12).
  4108
  4109***************    OUTPUT FROM ELPMNT   *************************
  4110
  4111         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4112                                     COMP-3.
  4113         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4114                                     COMP-3.
  4115         16  FILLER                PIC X(12).
  4116
  4117***************   MISC WORK AREAS    *****************************
  4118         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4119                                     COMP-3.
  4120         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4121                                     COMP-3.
  4122         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4123                                     COMP-3.
  4124         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4125                                     COMP-3.
  4126         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4127                                     COMP-3.
  4128         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4129                                     COMP-3.
  4130         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4131             88  OPEN-RATE-FILE                   VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  73
* SOCK03.cbl
  4132             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4133             88  IO-ERROR                         VALUE 'E'.
  4134
  4135         16  CP-FIRST-PAY-DATE     PIC XX.
  4136
  4137         16  CP-JOINT-INDICATOR    PIC X.
  4138
  4139         16  CP-RESERVE-REMAINING-TERM
  4140                                   PIC S9(4)V9    VALUE ZERO
  4141                                     COMP-3.
  4142
  4143         16  CP-INSURED-BIRTH-DT   PIC XX.
  4144
  4145         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4146                                     COMP-3.
  4147
  4148         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4149                                     COMP-3.
  4150
  4151         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4152                                     COMP-3.
  4153
  4154         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4155                                     COMP-3.
  4156
  4157         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4158                                     COMP-3.
  4159
  4160         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4161                                     COMP-3.
  4162
  4163         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4164                                     COMP-3.
  4165
  4166         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4167             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4168
  4169         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4170                                     COMP-3.
  4171         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4172                                     COMP-3.
  4173         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4174         16  cp-extra-periods      pic 9 value zeros.
  4175         16  cp-net-only-state     pic x value spaces.
  4176         16  FILLER                PIC X(13).
  4177******************************************************************
  4178****************************************************************
  4179*
  4180* Copyright (c) 2007-2013 Dell Inc.
  4181* All rights reserved.
  4182*
  4183****************************************************************
  4184 01  DFHEIV.
  4185   02  DFHEIV0               PIC X(35).
  4186   02  DFHEIV1               PIC X(08).
  4187   02  DFHEIV2               PIC X(08).
  4188   02  DFHEIV3               PIC X(08).
  4189   02  DFHEIV4               PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  74
* SOCK03.cbl
  4190   02  DFHEIV5               PIC X(04).
  4191   02  DFHEIV6               PIC X(04).
  4192   02  DFHEIV7               PIC X(02).
  4193   02  DFHEIV8               PIC X(02).
  4194   02  DFHEIV9               PIC X(01).
  4195   02  DFHEIV10              PIC S9(7) COMP-3.
  4196   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4197   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4198   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4199   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4200   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4201   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4202   02  DFHEIV17              PIC X(04).
  4203   02  DFHEIV18              PIC X(04).
  4204   02  DFHEIV19              PIC X(04).
  4205   02  DFHEIV20              USAGE IS POINTER.
  4206   02  DFHEIV21              USAGE IS POINTER.
  4207   02  DFHEIV22              USAGE IS POINTER.
  4208   02  DFHEIV23              USAGE IS POINTER.
  4209   02  DFHEIV24              USAGE IS POINTER.
  4210   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4211   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4212   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4213   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4214   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4215   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4216   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4217   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4218   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4219   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4220   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4221   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4222   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4223   02  FILLER                PIC X(02).
  4224   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4225   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4226   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4227   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4228   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4229   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4230   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4231 LINKAGE  SECTION.
  4232*****************************************************************
  4233*                                                               *
  4234* Copyright (c) 2007-2013 Dell Inc.                             *
  4235* All rights reserved.                                          *
  4236*                                                               *
  4237*****************************************************************
  4238 01  dfheiblk.
  4239     02  eibtime          pic s9(7) comp-3.
  4240     02  eibdate          pic s9(7) comp-3.
  4241     02  eibtrnid         pic x(4).
  4242     02  eibtaskn         pic s9(7) comp-3.
  4243     02  eibtrmid         pic x(4).
  4244     02  dfheigdi         pic s9(4) comp.
  4245     02  eibcposn         pic s9(4) comp.
  4246     02  eibcalen         pic s9(4) comp.
  4247     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  75
* SOCK03.cbl
  4248     02  eibfiller1       pic x(1).
  4249     02  eibfn            pic x(2).
  4250     02  eibfiller2       pic x(2).
  4251     02  eibrcode         pic x(6).
  4252     02  eibfiller3       pic x(2).
  4253     02  eibds            pic x(8).
  4254     02  eibreqid         pic x(8).
  4255     02  eibrsrce         pic x(8).
  4256     02  eibsync          pic x(1).
  4257     02  eibfree          pic x(1).
  4258     02  eibrecv          pic x(1).
  4259     02  eibsend          pic x(1).
  4260     02  eibatt           pic x(1).
  4261     02  eibeoc           pic x(1).
  4262     02  eibfmh           pic x(1).
  4263     02  eibcompl         pic x(1).
  4264     02  eibsig           pic x(1).
  4265     02  eibconf          pic x(1).
  4266     02  eiberr           pic x(1).
  4267     02  eibrldbk         pic x(1).
  4268     02  eiberrcd         pic x(4).
  4269     02  eibsynrb         pic x(1).
  4270     02  eibnodat         pic x(1).
  4271     02  eibfiller5       pic x(2).
  4272     02  eibresp          pic s9(8) comp.
  4273     02  eibresp2         pic s9(8) comp.
  4274     02  dfheigdj         pic s9(4) comp.
  4275     02  dfheigdk         pic s9(4) comp.
  4276 01  DFHCOMMAREA.
  4277   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4278   05 LSTN-NAME                PIC X(8).
  4279   05 LSTN-SUBNAME             PIC X(8).
  4280**** client-in-data cannot be more than 36 characters ***
  4281   05 CLIENT-IN-DATA           pic x(36).
  4282   05 SOCKADDR-IN-PARM.
  4283     15 SIN-FAMILY             PIC 9(4) COMP.
  4284     15 SIN-PORT               PIC 9(4) COMP.
  4285     15 SIN-ADDRESS            PIC 9(8) COMP.
  4286     15 SIN-ZERO               PIC X(8).
  4287 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4288 0000-DFHEXIT SECTION.
  4289     MOVE '9#                    $   ' TO DFHEIV0.
  4290     MOVE 'SOCK03' TO DFHEIV1.
  4291     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4292     display '  BEGIN SOCK03 '
  4293     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4294     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4295     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4296        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4297        evaluate true
  4298           when client-in-data (8:3) = 'AHL'
  4299              MOVE X'06'         TO WS-COMP-CD
  4300              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4301                                    WS-COMP-ID
  4302           when CLIENT-IN-DATA (8:3) = 'DCC'
  4303              MOVE X'05'         TO WS-COMP-CD
  4304              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4305                                    WS-COMP-ID
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  76
* SOCK03.cbl
  4306           when CLIENT-IN-DATA (8:3) = 'VPP'
  4307              MOVE X'07'         TO WS-COMP-CD
  4308              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4309                                    WS-COMP-ID
  4310           when CLIENT-IN-DATA (8:3) = 'FNL'
  4311              MOVE X'08'         TO WS-COMP-CD
  4312              MOVE 'FNL'         TO WS-SEND-BUF (5:3)
  4313                                    WS-COMP-ID
  4314           when other
  4315              MOVE X'04'         TO WS-COMP-CD
  4316              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  4317                                    WS-COMP-ID
  4318        end-evaluate
  4319        move 'CSO'               to ws-send-buf (1:3)
  4320        move +25                 to ws-send-msg-size
  4321     END-IF
  4322     display 'SOCK03:sequence number  =', ws-seq-num.
  4323     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4324     call "send" using by value GIVE-TAKE-SOCKET,
  4325         by reference ws-send-buf,
  4326         by value ws-send-msg-size,
  4327         by value ws-flags.
  4328     if return-code <= zero
  4329         display 'SOCK03:send error ',
  4330         go to socket-error.
  4331     move low-values to ws-recv-buf.
  4332     set ws-recv-total to zero.
  4333     compute ws-recv-left = ws-recv-msg-size.
  4334     display 'SOCK03:About to recv '
  4335     call "recv" using by value GIVE-TAKE-SOCKET,
  4336         by reference ws-recv-buf
  4337         by value ws-recv-msg-size,
  4338         by value ws-flags.
  4339     if return-code < zero
  4340        display 'SOCK03:recv error ',
  4341        go to socket-error.
  4342     if return-code = zero
  4343        display 'SOCK03:client disconnected',
  4344        go to socket-error.
  4345*
  4346     display 'SOCK03:Good recv  '
  4347     display 'SOCK03:return code      = ', return-code
  4348     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:89)
  4349     move +4096                  to ws-send-msg-size
  4350*    move +750                   to ws-send-msg-size
  4351     move ws-recv-buf (1:89)     to soc-client-in-data
  4352     MOVE SPACES                 TO WS-ELCERT-SW
  4353     MOVE X'0A'                  TO WS-HEX-0A
  4354     if client-account = 'EPIQ000001'
  4355        set ws-epiq-request to true
  4356        move spaces              to client-account
  4357     end-if
  4358     move +0 to ws-epiq-max
  4359     if client-car = spaces
  4360        if client-state = 'KY'
  4361           move '8'              to client-car
  4362        else
  4363           move '9'              to client-car
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  77
* SOCK03.cbl
  4364        end-if
  4365     end-if
  4366     if client-grp = spaces
  4367        move '000000'            to client-grp
  4368     end-if
  4369     EVALUATE TRUE
  4370        WHEN (CLIENT-CAR NOT = SPACES)
  4371           AND (CLIENT-STATE NOT = SPACES)
  4372           AND (CLIENT-ACCOUNT NOT = SPACES)
  4373           AND (CLIENT-EFF-DT NOT = SPACES)
  4374           AND (CLIENT-CERT-NO NOT = SPACES)
  4375           SET WS-ELCERT-FULL    TO TRUE
  4376        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4377           SET WS-ELCERT-CERT-NO TO TRUE
  4378*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4379*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4380        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4381           AND (CLIENT-LAST-NAME NOT = SPACES)
  4382           SET WS-ELCERT-ACT-NAME TO TRUE
  4383        WHEN CLIENT-LAST-NAME NOT = SPACES
  4384           SET WS-ELCERT-NAME    TO TRUE
  4385        when (client-vin not = spaces)
  4386           and (client-state not = spaces)
  4387           and (client-account not = spaces)
  4388           set ws-elcert-vin to true
  4389*          display ' SETTING VIN '
  4390        WHEN OTHER
  4391           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4392           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4393           MOVE ZEROS            TO WS-RESP
  4394           PERFORM 0030-BUILD-BUFFER
  4395                                 THRU 0030-EXIT
  4396           PERFORM 0020-SEND-BUFFER
  4397                                 THRU 0020-EXIT
  4398           PERFORM 0025-CLOSE-SOCKET
  4399                                 THRU 0025-EXIT
  4400           GO TO 0010-RETURN
  4401     END-EVALUATE
  4402     IF CLIENT-CAN-REASON = 'R'
  4403        MOVE 'R'                 TO WS-CANCEL-REASON
  4404     ELSE
  4405        MOVE ' '                 TO WS-CANCEL-REASON
  4406     END-IF
  4407     IF WS-ELCERT-KEY-SW NOT = SPACES
  4408        PERFORM 0050-BEGIN-REFUND-PROCESS
  4409                                 THRU 0050-EXIT
  4410     END-IF
  4411     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4412     .
  4413 0010-RETURN.
  4414
  4415* exec cics return end-exec.
  4416*    MOVE '.(                    ''   #00004413' TO DFHEIV0
  4417     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4418     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4419     MOVE X'2020233030303034343133' TO DFHEIV0(25:11)
  4420     CALL 'kxdfhei1' USING DFHEIV0,
  4421           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  78
* SOCK03.cbl
  4422           DFHEIV99,
  4423           DFHEIV99,
  4424           DFHEIV99,
  4425           DFHEIV99,
  4426           DFHEIV99
  4427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4428
  4429
  4430* goback.
  4431     MOVE '9%                    "   ' TO DFHEIV0
  4432     MOVE 'SOCK03' TO DFHEIV1
  4433     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4434     goback.
  4435*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4436     .
  4437 0020-SEND-BUFFER.
  4438*    display 'SOCK03:sequence number  =', ws-seq-num.
  4439     display 'SOCK03:send buffer      =', ws-send-buf(1:500).
  4440     call "send" using by value GIVE-TAKE-SOCKET,
  4441         by reference ws-send-buf,
  4442         by value ws-send-msg-size,
  4443         by value ws-flags.
  4444     if return-code <= zero
  4445         display 'SOCK03:send error ' return-code,
  4446         go to socket-error.
  4447 0020-EXIT.
  4448     EXIT.
  4449 0025-CLOSE-SOCKET.
  4450*    display 'SOCK03:closing socket'.
  4451*    call "close" using by value GIVE-TAKE-SOCKET .
  4452*    display 'SOCK03:done'.
  4453     .
  4454 0025-EXIT.
  4455     EXIT.
  4456*
  4457* set up the receive buffer
  4458*
  4459     move low-values to ws-recv-buf.
  4460     set ws-recv-total to zero.
  4461     compute ws-recv-left = ws-recv-msg-size.
  4462*
  4463* receive data
  4464*
  4465 recv-1.
  4466     call "recv" using by value GIVE-TAKE-SOCKET,
  4467         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4468         by value ws-recv-left,
  4469         by value ws-flags.
  4470*
  4471* test what was received and decide what we should do
  4472*
  4473     if return-code < zero
  4474        display 'SOCK03:recv error ',
  4475        go to socket-error.
  4476     if return-code = zero
  4477        display 'SOCK03:client disconnected',
  4478        go to socket-error.
  4479*
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  79
* SOCK03.cbl
  4480* have we received all the data yet?
  4481*
  4482     compute ws-recv-total = ws-recv-total + return-code.
  4483     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4484*
  4485* not yet
  4486*
  4487     if ws-recv-left > 0 go to recv-1.
  4488*
  4489* received all the data
  4490*
  4491*    display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4492*
  4493* make sure what we received was what we sent
  4494*
  4495*    if ws-recv-buf <> ws-send-buf
  4496*        display "SOCK03:data doesn't match",
  4497*        go to socket-error.
  4498*
  4499* end of pass
  4500*
  4501*loop-end.
  4502*    if ws-seq-num = 5 go to socket-error.
  4503*    go to loop-1.
  4504*
  4505* program end
  4506*
  4507 socket-error.
  4508     if ws-seq-num <> 0
  4509         display "SOCK03:did not complete".
  4510*
  4511* flush the send buffer and deallocate
  4512*
  4513*    display 'SOCK03:closing socket'.
  4514*    call "close" using by value GIVE-TAKE-SOCKET .
  4515*
  4516* finised return to cics
  4517*
  4518 socket-fin.
  4519*    display 'SOCK03:closing socket'.
  4520*    call "close" using by value GIVE-TAKE-SOCKET .
  4521*    display 'SOCK03:done'.
  4522
  4523* exec cics return end-exec.
  4524*    MOVE '.(                    ''   #00004503' TO DFHEIV0
  4525     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4526     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4527     MOVE X'2020233030303034353033' TO DFHEIV0(25:11)
  4528     CALL 'kxdfhei1' USING DFHEIV0,
  4529           DFHEIV99,
  4530           DFHEIV99,
  4531           DFHEIV99,
  4532           DFHEIV99,
  4533           DFHEIV99,
  4534           DFHEIV99
  4535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4536
  4537
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  80
* SOCK03.cbl
  4538* goback.
  4539     MOVE '9%                    "   ' TO DFHEIV0
  4540     MOVE 'SOCK03' TO DFHEIV1
  4541     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4542     goback.
  4543 0030-BUILD-BUFFER.
  4544     MOVE SPACES                 TO WS-SEND-BUF
  4545     IF WS-CALL-TYPE = 'NEWBUS'
  4546        STRING
  4547           WS-COMMENT            ';'
  4548           WS-RESP               ';'
  4549           WS-CARRIER            ';'
  4550           WS-GROUPING           ';'
  4551           WS-STATE              ';'
  4552           WS-ACCOUNT            ';'
  4553           WS-CERT-EFF-DATE      ';'
  4554           WS-CERT-NO            ';'
  4555           WS-LAST-NAME          ';'
  4556           WS-FIRST-NAME         ';'
  4557           WS-MID-INIT           ';'
  4558           WS-LAST-JNAME         ';'
  4559           WS-FIRST-JNAME        ';'
  4560           WS-MID-JINIT          ';'
  4561           WS-POST-CARD-SW       ';'
  4562           ws-lf-coverage-type   ';'
  4563           WS-LF-STATUS          ';'
  4564           WS-LF-BEN-CODE        ';'
  4565           WS-LF-BEN-CODE-DESC   ';'
  4566           WS-LF-TERM            ';'
  4567           WS-LF-REM-TERM        ';'
  4568           WS-LF-PREM            ';'
  4569           WS-LF-REFUND          ';'
  4570           WS-LF-METHOD          ';'
  4571           WS-LF-ORIG-BENEFIT    ';'
  4572           WS-LF-REM-BEN         ';'
  4573           WS-LF-EXPIRE-DATE     ';'
  4574           WS-LF-COMM            ';'
  4575           WS-LF-UEC             ';'
  4576           WS-AH-COVERAGE-TYPE   ';'
  4577           WS-AH-STATUS          ';'
  4578           WS-AH-BEN-CODE        ';'
  4579           WS-AH-BEN-CODE-DESC   ';'
  4580           WS-AH-TERM            ';'
  4581           WS-AH-REM-TERM        ';'
  4582           WS-AH-PREM            ';'
  4583           WS-AH-REFUND          ';'
  4584           WS-AH-METHOD          ';'
  4585           WS-AH-ORIG-BENEFIT    ';'
  4586           WS-AH-REM-BEN         ';'
  4587           WS-AH-EXPIRE-DATE     ';'
  4588           WS-AH-COMM            ';'
  4589           WS-AH-UEC             ';'
  4590           WS-ACCOUNT-NAME       ';'
  4591           WS-REPORT-CODE-1      ';'
  4592           WS-REPORT-CODE-2      ';'
  4593           WS-REPORT-CODE-3      ';'
  4594           WS-CLM-PAID-THRU-DT   ';'
  4595           WS-LF-CANCEL-DATE     ';'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  81
* SOCK03.cbl
  4596           WS-AH-CANCEL-DATE     ';'
  4597           WS-VIN                ';'
  4598           WS-CRED-BENE-NAME     ';'
  4599           WS-HEX-0A
  4600            DELIMITED BY '  ' INTO WS-SEND-BUF
  4601        END-STRING
  4602     ELSE
  4603        STRING
  4604           WS-COMMENT            ';'  *> 0
  4605           WS-RESP               ';'
  4606           WS-CARRIER            ';'
  4607           WS-GROUPING           ';'
  4608           WS-STATE              ';'
  4609           WS-ACCOUNT            ';'
  4610           WS-CERT-EFF-DATE      ';'
  4611           WS-CERT-NO            ';'
  4612           WS-LAST-NAME          ';'
  4613           WS-FIRST-NAME         ';'
  4614           WS-MID-INIT           ';'
  4615           WS-LAST-JNAME         ';'
  4616           WS-FIRST-JNAME        ';'
  4617           WS-MID-JINIT          ';'
  4618           WS-POST-CARD-SW       ';'
  4619           WS-LF-STATUS          ';'
  4620           WS-LF-BEN-CODE        ';'  *> 16
  4621           WS-LF-BEN-CODE-DESC   ';'
  4622           WS-LF-TERM            ';'
  4623           WS-LF-REM-TERM        ';'
  4624           WS-LF-PREM            ';'
  4625           WS-LF-REFUND          ';'
  4626           WS-LF-METHOD          ';'
  4627           WS-LF-ORIG-BENEFIT    ';'
  4628           WS-LF-REM-BEN         ';'
  4629           WS-LF-EXPIRE-DATE     ';'
  4630           WS-LF-COMM            ';'
  4631           WS-LF-UEC             ';'
  4632           WS-AH-STATUS          ';'
  4633           WS-AH-BEN-CODE        ';'   *> 29
  4634           WS-AH-BEN-CODE-DESC   ';'
  4635           WS-AH-TERM            ';'
  4636           WS-AH-REM-TERM        ';'
  4637           WS-AH-PREM            ';'   *> 32
  4638           WS-AH-REFUND          ';'   *> 33
  4639           WS-AH-METHOD          ';'
  4640           WS-AH-ORIG-BENEFIT    ';'   *> 36
  4641           WS-AH-REM-BEN         ';'
  4642           WS-AH-EXPIRE-DATE     ';'
  4643           WS-AH-COMM            ';'
  4644           WS-AH-UEC             ';'
  4645           WS-ACCOUNT-NAME       ';'
  4646           WS-REPORT-CODE-1      ';'
  4647           WS-REPORT-CODE-2      ';'
  4648           WS-REPORT-CODE-3      ';'
  4649           WS-CLM-PAID-THRU-DT   ';'
  4650           WS-LF-CANCEL-DATE     ';'
  4651           WS-AH-CANCEL-DATE     ';'
  4652           WS-VIN                ';'
  4653           WS-CRED-BENE-NAME     ';'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  82
* SOCK03.cbl
  4654           'E'                   ';'
  4655            DELIMITED BY '  ' INTO WS-SEND-BUF
  4656        END-STRING
  4657     END-IF
  4658     .
  4659 0030-EXIT.
  4660     EXIT.
  4661 0050-BEGIN-REFUND-PROCESS.
  4662     IF WS-ELCERT-ACT-NAME
  4663        PERFORM 0060-FIND-FULL-KEY
  4664                                 THRU 0060-EXIT
  4665        MOVE AM-CARRIER          TO CLIENT-CAR
  4666        MOVE AM-GROUPING         TO CLIENT-GRP
  4667        MOVE AM-STATE            TO CLIENT-STATE
  4668     END-IF
  4669     PERFORM 0100-START-ELCERT   THRU 0100-EXIT
  4670     IF NOT RESP-NORMAL
  4671        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4672        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4673        MOVE WS-RESPONSE         TO WS-RESP
  4674        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4675        PERFORM 0020-SEND-BUFFER
  4676                                 THRU 0020-EXIT
  4677        PERFORM 0025-CLOSE-SOCKET
  4678                                 THRU 0025-EXIT
  4679        GO TO 0010-RETURN
  4680     END-IF
  4681     PERFORM 0150-READ-NEXT-ELCERT
  4682                                 THRU 0150-EXIT
  4683*    display ' came back from 0150 ' ws-response
  4684     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4685        DISPLAY ' CERT NOT FOUND '
  4686        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4687        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4688        MOVE WS-RESPONSE         TO WS-RESP
  4689        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4690        PERFORM 0020-SEND-BUFFER
  4691                                 THRU 0020-EXIT
  4692        PERFORM 0025-CLOSE-SOCKET
  4693                                 THRU 0025-EXIT
  4694        GO TO 0010-RETURN
  4695     END-IF
  4696     PERFORM 0200-BEGIN-REFUND-PROCESS
  4697                                 THRU 0200-EXIT UNTIL
  4698        ELCERT-FINISHED
  4699     .
  4700 0050-EXIT.
  4701     EXIT.
  4702 0060-FIND-FULL-KEY.
  4703     MOVE ' ' TO WS-STOP-SW
  4704     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4705     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4706
  4707* EXEC CICS STARTBR
  4708*       DATASET  ('ERACCT3')
  4709*       RIDFLD   (WS-AM3-KEY)
  4710*       GTEQ
  4711*       RESP (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  83
* SOCK03.cbl
  4712*    END-EXEC
  4713     MOVE 'ERACCT3' TO DFHEIV1
  4714     MOVE 0
  4715       TO DFHEIV11
  4716*    MOVE '&,         G          &  N#00004668' TO DFHEIV0
  4717     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4718     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4719     MOVE X'204E233030303034363638' TO DFHEIV0(25:11)
  4720     CALL 'kxdfhei1' USING DFHEIV0,
  4721           DFHEIV1,
  4722           WS-AM3-KEY,
  4723           DFHEIV99,
  4724           DFHEIV11,
  4725           DFHEIV99
  4726     MOVE EIBRESP  TO WS-RESPONSE
  4727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4728     IF RESP-NORMAL
  4729        PERFORM UNTIL TOLD-TO-STOP
  4730
  4731* EXEC CICS READNEXT
  4732*             DATASET  ('ERACCT3')
  4733*             INTO     (ACCOUNT-MASTER)
  4734*             RIDFLD   (WS-AM3-KEY)
  4735*          END-EXEC
  4736     MOVE LENGTH OF
  4737      ACCOUNT-MASTER
  4738       TO DFHEIV12
  4739     MOVE 'ERACCT3' TO DFHEIV1
  4740     MOVE 0
  4741       TO DFHEIV11
  4742*    MOVE '&.IL                  )   #00004676' TO DFHEIV0
  4743     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4744     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4745     MOVE X'2020233030303034363736' TO DFHEIV0(25:11)
  4746     CALL 'kxdfhei1' USING DFHEIV0,
  4747           DFHEIV1,
  4748           ACCOUNT-MASTER,
  4749           DFHEIV12,
  4750           WS-AM3-KEY,
  4751           DFHEIV99,
  4752           DFHEIV11,
  4753           DFHEIV99,
  4754           DFHEIV99
  4755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4756           EVALUATE TRUE
  4757              WHEN (RESP-NORMAL)
  4758                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4759                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4760                 SET TOLD-TO-STOP TO TRUE
  4761              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4762                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4763                 CONTINUE
  4764              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4765                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4766                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4767                 MOVE ZEROS      TO WS-RESP
  4768                 PERFORM 0030-BUILD-BUFFER
  4769                                 THRU 0030-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  84
* SOCK03.cbl
  4770                 PERFORM 0020-SEND-BUFFER
  4771                                 THRU 0020-EXIT
  4772                 PERFORM 0025-CLOSE-SOCKET
  4773                                 THRU 0025-EXIT
  4774                 GO TO 0010-RETURN
  4775           END-EVALUATE
  4776        END-PERFORM
  4777
  4778* EXEC CICS ENDBR
  4779*          DATASET   ('ERACCT3')
  4780*       END-EXEC
  4781     MOVE 'ERACCT3' TO DFHEIV1
  4782     MOVE 0
  4783       TO DFHEIV11
  4784*    MOVE '&2                    $   #00004702' TO DFHEIV0
  4785     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4787     MOVE X'2020233030303034373032' TO DFHEIV0(25:11)
  4788     CALL 'kxdfhei1' USING DFHEIV0,
  4789           DFHEIV1,
  4790           DFHEIV11,
  4791           DFHEIV99
  4792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4793     ELSE
  4794        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4795        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4796        MOVE ZEROS      TO WS-RESP
  4797        PERFORM 0030-BUILD-BUFFER
  4798                                 THRU 0030-EXIT
  4799        PERFORM 0020-SEND-BUFFER
  4800                                 THRU 0020-EXIT
  4801        PERFORM 0025-CLOSE-SOCKET
  4802                                 THRU 0025-EXIT
  4803        GO TO 0010-RETURN
  4804     END-IF
  4805     .
  4806 0060-EXIT.
  4807     EXIT.
  4808 0100-START-ELCERT.
  4809     MOVE SPACES                 TO WS-SEND-BUF
  4810     INITIALIZE WS-STRING-DATA
  4811     MOVE LOW-VALUES             TO WS-CM-KEY
  4812                                    WS-CM-KEY-A1
  4813                                    WS-CM-KEY-A4
  4814     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4815                                    WS-CM-COMPANY-CD-A1
  4816                                    WS-CM-COMPANY-CD-A4
  4817     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4818     MOVE 'L'                    TO DC-OPTION-CODE
  4819     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4820     IF NO-CONVERSION-ERROR
  4821        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4822     ELSE
  4823        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4824        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4825        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4826        PERFORM 0020-SEND-BUFFER
  4827                                 THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  85
* SOCK03.cbl
  4828        PERFORM 0025-CLOSE-SOCKET
  4829                                 THRU 0025-EXIT
  4830        GO TO 0010-RETURN
  4831     END-IF
  4832     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4833        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4834        MOVE 'L'                 TO DC-OPTION-CODE
  4835        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4836        IF NO-CONVERSION-ERROR
  4837           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4838        ELSE
  4839           MOVE 'BAD EFF DT CONVERT '
  4840                                 TO WS-COMMENT
  4841           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4842           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4843           PERFORM 0020-SEND-BUFFER
  4844                                 THRU 0020-EXIT
  4845           PERFORM 0025-CLOSE-SOCKET
  4846                                 THRU 0025-EXIT
  4847           GO TO 0010-RETURN
  4848        END-IF
  4849     END-IF
  4850     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4851        (F1 > +10)
  4852        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4853     END-PERFORM
  4854     IF F1 > +1
  4855        SUBTRACT +1 FROM F1
  4856     END-IF
  4857     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4858        (L1 > +15)
  4859        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4860     END-PERFORM
  4861     IF L1 > +1
  4862        SUBTRACT +1 FROM L1
  4863     END-IF
  4864     EVALUATE TRUE
  4865        WHEN WS-ELCERT-FULL
  4866           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4867           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4868           MOVE CLIENT-STATE        TO WS-CM-STATE
  4869           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4870           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4871           MOVE CLIENT-CERT-NO      TO WS-CM-CERT-NO
  4872
  4873* EXEC CICS READ
  4874*             INTO    (CERTIFICATE-MASTER)
  4875*             DATASET ('ELCERT')
  4876*             RIDFLD  (WS-CM-KEY)
  4877*             RESP    (WS-RESPONSE)
  4878*          END-EXEC
  4879     MOVE LENGTH OF
  4880      CERTIFICATE-MASTER
  4881       TO DFHEIV11
  4882     MOVE 'ELCERT' TO DFHEIV1
  4883*    MOVE '&"IL       E          (  N#00004784' TO DFHEIV0
  4884     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  86
* SOCK03.cbl
  4886     MOVE X'204E233030303034373834' TO DFHEIV0(25:11)
  4887     CALL 'kxdfhei1' USING DFHEIV0,
  4888           DFHEIV1,
  4889           CERTIFICATE-MASTER,
  4890           DFHEIV11,
  4891           WS-CM-KEY,
  4892           DFHEIV99,
  4893           DFHEIV99,
  4894           DFHEIV99
  4895     MOVE EIBRESP  TO WS-RESPONSE
  4896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4897        WHEN WS-ELCERT-ACT-NAME
  4898           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4899           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4900           MOVE CLIENT-STATE        TO WS-CM-STATE
  4901           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4902           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4903           MOVE ZEROS               TO WS-CM-CERT-NO
  4904
  4905* EXEC CICS STARTBR
  4906*             DATASET ('ELCERT')
  4907*             RIDFLD  (WS-CM-KEY)
  4908*             RESP    (WS-RESPONSE)
  4909*          END-EXEC
  4910     MOVE 'ELCERT' TO DFHEIV1
  4911     MOVE 0
  4912       TO DFHEIV11
  4913*    MOVE '&,         G          &  N#00004797' TO DFHEIV0
  4914     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4915     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4916     MOVE X'204E233030303034373937' TO DFHEIV0(25:11)
  4917     CALL 'kxdfhei1' USING DFHEIV0,
  4918           DFHEIV1,
  4919           WS-CM-KEY,
  4920           DFHEIV99,
  4921           DFHEIV11,
  4922           DFHEIV99
  4923     MOVE EIBRESP  TO WS-RESPONSE
  4924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4925        WHEN WS-ELCERT-NAME
  4926           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4927           MOVE SPACES           TO WS-CM-INITIALS
  4928           COMPUTE WS-LENGTH = L1 + +1
  4929
  4930* EXEC CICS STARTBR
  4931*             DATASET   ('ELCERT2')
  4932*             RIDFLD    (WS-CM-KEY-A1)
  4933*             GENERIC
  4934*             KEYLENGTH (WS-LENGTH)
  4935*             GTEQ
  4936*             RESP      (WS-RESPONSE)
  4937*          END-EXEC
  4938     MOVE 'ELCERT2' TO DFHEIV1
  4939     MOVE 0
  4940       TO DFHEIV11
  4941*    MOVE '&,   KG    G          &  N#00004806' TO DFHEIV0
  4942     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  87
* SOCK03.cbl
  4944     MOVE X'204E233030303034383036' TO DFHEIV0(25:11)
  4945     CALL 'kxdfhei1' USING DFHEIV0,
  4946           DFHEIV1,
  4947           WS-CM-KEY-A1,
  4948           WS-LENGTH,
  4949           DFHEIV11,
  4950           DFHEIV99
  4951     MOVE EIBRESP  TO WS-RESPONSE
  4952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4953*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4954*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4955        WHEN WS-ELCERT-CERT-NO
  4956* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4957           MOVE +11 TO WS-LENGTH
  4958           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4959
  4960* EXEC CICS STARTBR
  4961*             DATASET   ('ELCERT5')
  4962*             RIDFLD    (WS-CM-KEY-A4)
  4963*             GENERIC
  4964*             KEYLENGTH (WS-LENGTH)
  4965*             GTEQ
  4966*             RESP      (WS-RESPONSE)
  4967*          END-EXEC
  4968     MOVE 'ELCERT5' TO DFHEIV1
  4969     MOVE 0
  4970       TO DFHEIV11
  4971*    MOVE '&,   KG    G          &  N#00004820' TO DFHEIV0
  4972     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4973     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4974     MOVE X'204E233030303034383230' TO DFHEIV0(25:11)
  4975     CALL 'kxdfhei1' USING DFHEIV0,
  4976           DFHEIV1,
  4977           WS-CM-KEY-A4,
  4978           WS-LENGTH,
  4979           DFHEIV11,
  4980           DFHEIV99
  4981     MOVE EIBRESP  TO WS-RESPONSE
  4982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4983        when ws-elcert-vin
  4984           move low-values       to ws-cs-key
  4985           move ws-comp-cd       to ws-cs-company-cd
  4986           move client-car       to ws-cs-carrier
  4987           move client-grp       to ws-cs-group
  4988           move client-state     to ws-cs-state
  4989           move client-account   to ws-cs-account
  4990
  4991* exec cics startbr
  4992*             dataset   ('ELCRTT')
  4993*             RIDFLD    (WS-CS-KEY)
  4994*             GTEQ
  4995*             RESP      (WS-RESPONSE)
  4996*          END-EXEC
  4997     MOVE 'ELCRTT' TO DFHEIV1
  4998     MOVE 0
  4999       TO DFHEIV11
  5000*    MOVE '&,         G          &  N#00004835' TO DFHEIV0
  5001     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  88
* SOCK03.cbl
  5002     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5003     MOVE X'204E233030303034383335' TO DFHEIV0(25:11)
  5004     CALL 'kxdfhei1' USING DFHEIV0,
  5005           DFHEIV1,
  5006           WS-CS-KEY,
  5007           DFHEIV99,
  5008           DFHEIV11,
  5009           DFHEIV99
  5010     MOVE EIBRESP  TO WS-RESPONSE
  5011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5012     END-EVALUATE
  5013     .
  5014 0100-EXIT.
  5015     EXIT.
  5016 0150-READ-NEXT-ELCERT.
  5017     EVALUATE TRUE
  5018        WHEN WS-ELCERT-ACT-NAME
  5019*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  5020
  5021* EXEC CICS READNEXT
  5022*             DATASET   ('ELCERT')
  5023*             RIDFLD    (WS-CM-KEY)
  5024*             INTO      (CERTIFICATE-MASTER)
  5025*             RESP      (WS-RESPONSE)
  5026*          END-EXEC
  5027     MOVE LENGTH OF
  5028      CERTIFICATE-MASTER
  5029       TO DFHEIV12
  5030     MOVE 'ELCERT' TO DFHEIV1
  5031     MOVE 0
  5032       TO DFHEIV11
  5033*    MOVE '&.IL                  )  N#00004849' TO DFHEIV0
  5034     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5035     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5036     MOVE X'204E233030303034383439' TO DFHEIV0(25:11)
  5037     CALL 'kxdfhei1' USING DFHEIV0,
  5038           DFHEIV1,
  5039           CERTIFICATE-MASTER,
  5040           DFHEIV12,
  5041           WS-CM-KEY,
  5042           DFHEIV99,
  5043           DFHEIV11,
  5044           DFHEIV99,
  5045           DFHEIV99
  5046     MOVE EIBRESP  TO WS-RESPONSE
  5047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5048        WHEN WS-ELCERT-NAME
  5049*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  5050
  5051* EXEC CICS READNEXT
  5052*             DATASET   ('ELCERT2')
  5053*             RIDFLD    (WS-CM-KEY-A1)
  5054*             INTO      (CERTIFICATE-MASTER)
  5055*             RESP      (WS-RESPONSE)
  5056*          END-EXEC
  5057     MOVE LENGTH OF
  5058      CERTIFICATE-MASTER
  5059       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  89
* SOCK03.cbl
  5060     MOVE 'ELCERT2' TO DFHEIV1
  5061     MOVE 0
  5062       TO DFHEIV11
  5063*    MOVE '&.IL                  )  N#00004857' TO DFHEIV0
  5064     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5065     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5066     MOVE X'204E233030303034383537' TO DFHEIV0(25:11)
  5067     CALL 'kxdfhei1' USING DFHEIV0,
  5068           DFHEIV1,
  5069           CERTIFICATE-MASTER,
  5070           DFHEIV12,
  5071           WS-CM-KEY-A1,
  5072           DFHEIV99,
  5073           DFHEIV11,
  5074           DFHEIV99,
  5075           DFHEIV99
  5076     MOVE EIBRESP  TO WS-RESPONSE
  5077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5078        WHEN WS-ELCERT-CERT-NO
  5079
  5080* EXEC CICS READNEXT
  5081*             DATASET   ('ELCERT5')
  5082*             RIDFLD    (WS-CM-KEY-A4)
  5083*             INTO      (CERTIFICATE-MASTER)
  5084*             RESP      (WS-RESPONSE)
  5085*          END-EXEC
  5086     MOVE LENGTH OF
  5087      CERTIFICATE-MASTER
  5088       TO DFHEIV12
  5089     MOVE 'ELCERT5' TO DFHEIV1
  5090     MOVE 0
  5091       TO DFHEIV11
  5092*    MOVE '&.IL                  )  N#00004864' TO DFHEIV0
  5093     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5094     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5095     MOVE X'204E233030303034383634' TO DFHEIV0(25:11)
  5096     CALL 'kxdfhei1' USING DFHEIV0,
  5097           DFHEIV1,
  5098           CERTIFICATE-MASTER,
  5099           DFHEIV12,
  5100           WS-CM-KEY-A4,
  5101           DFHEIV99,
  5102           DFHEIV11,
  5103           DFHEIV99,
  5104           DFHEIV99
  5105     MOVE EIBRESP  TO WS-RESPONSE
  5106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5107        WHEN WS-ELCERT-VIN
  5108
  5109* EXEC CICS READNEXT
  5110*             DATASET   ('ELCRTT')
  5111*             RIDFLD    (WS-CS-KEY)
  5112*             INTO      (CERTIFICATE-TRAILERS)
  5113*             RESP      (WS-RESPONSE)
  5114*          END-EXEC
  5115     MOVE LENGTH OF
  5116      CERTIFICATE-TRAILERS
  5117       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  90
* SOCK03.cbl
  5118     MOVE 'ELCRTT' TO DFHEIV1
  5119     MOVE 0
  5120       TO DFHEIV11
  5121*    MOVE '&.IL                  )  N#00004871' TO DFHEIV0
  5122     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5123     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5124     MOVE X'204E233030303034383731' TO DFHEIV0(25:11)
  5125     CALL 'kxdfhei1' USING DFHEIV0,
  5126           DFHEIV1,
  5127           CERTIFICATE-TRAILERS,
  5128           DFHEIV12,
  5129           WS-CS-KEY,
  5130           DFHEIV99,
  5131           DFHEIV11,
  5132           DFHEIV99,
  5133           DFHEIV99
  5134     MOVE EIBRESP  TO WS-RESPONSE
  5135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5136     END-EVALUATE
  5137     .
  5138 0150-EXIT.
  5139     EXIT.
  5140 0200-BEGIN-REFUND-PROCESS.
  5141     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5142                                    WS-ERACCT-SW
  5143     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  5144                                    WS-NCB-DIFF-ODD-DAYS
  5145     INITIALIZE WS-STRING-DATA
  5146     IF RESP-NORMAL OR RESP-DUPKEY
  5147        EVALUATE TRUE
  5148           WHEN WS-ELCERT-ACT-NAME
  5149              EVALUATE TRUE
  5150                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5151                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5152                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5153                    OR (CM-STATE NOT = CLIENT-STATE)
  5154                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5155                    SET ELCERT-FINISHED TO TRUE
  5156                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5157                    CLIENT-LAST-NAME (1:L1))
  5158                    GO TO 0200-CONTINUE
  5159                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5160                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5161                    GO TO 0200-CONTINUE
  5162                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5163                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5164                     CLIENT-FIRST-NAME (1:F1)))
  5165                    GO TO 0200-CONTINUE
  5166                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5167                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5168                    GO TO 0200-CONTINUE
  5169              END-EVALUATE
  5170           WHEN WS-ELCERT-CERT-NO
  5171              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5172                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5173                 SET ELCERT-FINISHED TO TRUE
  5174              ELSE
  5175                 IF ((CLIENT-EFF-DT NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  91
* SOCK03.cbl
  5176                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5177                              OR
  5178                    ((CLIENT-LAST-NAME NOT = SPACES)
  5179                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5180                        CLIENT-LAST-NAME (1:L1)))
  5181                              OR
  5182                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5183                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5184                        CLIENT-FIRST-NAME (1:F1)))
  5185                              OR
  5186                    ((CLIENT-ACCOUNT NOT = SPACES)
  5187                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5188                     GO TO 0200-CONTINUE
  5189                 END-IF
  5190              END-IF
  5191           WHEN WS-ELCERT-NAME
  5192              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5193                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5194                    CLIENT-LAST-NAME (1:L1))
  5195                  SET ELCERT-FINISHED TO TRUE
  5196              ELSE
  5197                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5198                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5199                           OR
  5200                 ((CLIENT-FIRST-NAME NOT = SPACES)
  5201                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5202                     CLIENT-FIRST-NAME (1:F1)))
  5203                           OR
  5204                 ((CLIENT-ACCOUNT NOT = SPACES)
  5205                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5206                  GO TO 0200-CONTINUE
  5207                 END-IF
  5208              END-IF
  5209           WHEN WS-ELCERT-VIN
  5210              evaluate true
  5211                 when (CS-COMPANY-CD NOT = WS-COMP-CD)
  5212                    OR (CS-STATE NOT = CLIENT-STATE)
  5213                    OR (CS-ACCOUNT NOT = CLIENT-ACCOUNT)
  5214                    SET ELCERT-FINISHED TO TRUE
  5215                 when (cs-trailer-type  = 'C')
  5216                    and (cs-vin-number = client-vin)
  5217                    continue
  5218                 when (cs-trailer-type  = 'C')
  5219                    and (cs-vin-number(10:8) = client-vin(1:8))
  5220                    continue
  5221                 when other
  5222                    go to 0200-continue
  5223              end-evaluate
  5224           WHEN OTHER
  5225              SET ELCERT-FINISHED   TO TRUE
  5226        END-EVALUATE
  5227     ELSE
  5228        SET ELCERT-FINISHED TO TRUE
  5229     END-IF
  5230     if ws-elcert-vin
  5231        move cs-control-primary(1:33)
  5232                                 to ws-cm-key
  5233
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  92
* SOCK03.cbl
  5234* EXEC CICS READ
  5235*          INTO    (CERTIFICATE-MASTER)
  5236*          DATASET ('ELCERT')
  5237*          RIDFLD  (WS-CM-KEY)
  5238*          RESP    (WS-RESPONSE)
  5239*       END-EXEC
  5240     MOVE LENGTH OF
  5241      CERTIFICATE-MASTER
  5242       TO DFHEIV11
  5243     MOVE 'ELCERT' TO DFHEIV1
  5244*    MOVE '&"IL       E          (  N#00004974' TO DFHEIV0
  5245     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5247     MOVE X'204E233030303034393734' TO DFHEIV0(25:11)
  5248     CALL 'kxdfhei1' USING DFHEIV0,
  5249           DFHEIV1,
  5250           CERTIFICATE-MASTER,
  5251           DFHEIV11,
  5252           WS-CM-KEY,
  5253           DFHEIV99,
  5254           DFHEIV99,
  5255           DFHEIV99
  5256     MOVE EIBRESP  TO WS-RESPONSE
  5257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5258        if not resp-normal
  5259           set elcert-finished to true
  5260        end-if
  5261     end-if
  5262*       IF WS-ELCERT-CERT-NO
  5263*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5264*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5265*                          OR
  5266*                ((CLIENT-EFF-DT NOT = SPACES)
  5267*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5268*                          OR
  5269*                ((CLIENT-LAST-NAME NOT = SPACES)
  5270*                 AND (CM-INSURED-LAST-NAME NOT =
  5271*                    CLIENT-LAST-NAME))
  5272*                 SET ELCERT-FINISHED TO TRUE
  5273*          END-IF
  5274*          IF WS-ELCERT-NAME
  5275*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5276*                OR (CM-INSURED-LAST-NAME NOT =
  5277*                   CLIENT-LAST-NAME)
  5278*                            OR
  5279*                ((CLIENT-EFF-DT NOT = SPACES)
  5280*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5281*                 SET ELCERT-FINISHED TO TRUE
  5282*             END-IF
  5283*          ELSE
  5284*             SET ELCERT-FINISHED   TO TRUE
  5285*          END-IF
  5286     IF NOT WS-ELCERT-FULL
  5287        IF ELCERT-FINISHED
  5288           GO TO 0200-EXIT
  5289        END-IF
  5290     END-IF
  5291     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  93
* SOCK03.cbl
  5292        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5293        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5294        PERFORM 0030-BUILD-BUFFER
  5295                                 THRU 0030-EXIT
  5296        PERFORM 0020-SEND-BUFFER
  5297                                 THRU 0020-EXIT
  5298        GO TO 0200-CONTINUE
  5299     END-IF
  5300     if (ws-epiq-request)
  5301        and (not EPIQ-CLASS)
  5302        go to 0200-continue
  5303     end-if
  5304
  5305     if ws-epiq-request
  5306        add +1 to ws-epiq-max
  5307        if ws-epiq-max > +100
  5308           go to 0200-continue
  5309        end-if
  5310     end-if
  5311     PERFORM 0300-GET-ELCNTL-RECORDS
  5312                                 THRU 0300-EXIT
  5313     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5314     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5315     MOVE +0                     TO DC-ELAPSED-MONTHS
  5316                                    DC-ELAPSED-DAYS
  5317     MOVE '1'                    TO DC-OPTION-CODE
  5318     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5319     IF NO-CONVERSION-ERROR
  5320        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5321        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5322     END-IF
  5323     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5324     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5325     perform 0610-get-ermail     thru 0610-exit
  5326     perform 0620-get-elcrtt     thru 0620-exit
  5327     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5328     IF NOT ALREADY-SENT
  5329        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5330     END-IF
  5331     .
  5332 0200-CONTINUE.
  5333     PERFORM 0150-READ-NEXT-ELCERT
  5334                                 THRU 0150-EXIT
  5335     .
  5336 0200-EXIT.
  5337     EXIT.
  5338 0300-GET-ELCNTL-RECORDS.
  5339     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5340     IF NOT RESP-NORMAL
  5341        MOVE ' COMPANY RECORD NOT FOUND '
  5342                                 TO WS-COMMENT
  5343        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5344        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5345        PERFORM 0020-SEND-BUFFER
  5346                                 THRU 0020-EXIT
  5347        PERFORM 0025-CLOSE-SOCKET
  5348                                 THRU 0025-EXIT
  5349        GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  94
* SOCK03.cbl
  5350     END-IF
  5351     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5352        PERFORM 0320-GET-LIFE-RECORD
  5353                                 THRU 0320-EXIT
  5354        IF NOT RESP-NORMAL
  5355           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  5356                                 TO WS-COMMENT
  5357           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5358           PERFORM 0030-BUILD-BUFFER
  5359                                 THRU 0030-EXIT
  5360           PERFORM 0020-SEND-BUFFER
  5361                                 THRU 0020-EXIT
  5362           PERFORM 0025-CLOSE-SOCKET
  5363                                 THRU 0025-EXIT
  5364           GO TO 0010-RETURN
  5365        END-IF
  5366     END-IF
  5367     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5368        PERFORM 0330-GET-AH-RECORD
  5369                                 THRU 0330-EXIT
  5370        IF NOT RESP-NORMAL
  5371           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5372                                 TO WS-COMMENT
  5373           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5374           PERFORM 0030-BUILD-BUFFER
  5375                                 THRU 0030-EXIT
  5376           PERFORM 0020-SEND-BUFFER
  5377                                 THRU 0020-EXIT
  5378           PERFORM 0025-CLOSE-SOCKET
  5379                                 THRU 0025-EXIT
  5380           GO TO 0010-RETURN
  5381        END-IF
  5382     END-IF
  5383     PERFORM 0340-GET-STATE-RECORD
  5384                                 THRU 0340-EXIT
  5385     IF NOT RESP-NORMAL
  5386        MOVE ' STATE RECORD NOT FOUND '
  5387                                 TO WS-COMMENT
  5388        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5389        PERFORM 0030-BUILD-BUFFER
  5390                                 THRU 0030-EXIT
  5391        PERFORM 0020-SEND-BUFFER
  5392                                 THRU 0020-EXIT
  5393        PERFORM 0025-CLOSE-SOCKET
  5394                                 THRU 0025-EXIT
  5395        GO TO 0010-RETURN
  5396     END-IF
  5397     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5398     IF NOT ERACCT-FOUND
  5399        MOVE ' ACCOUNT NOT FOUND '
  5400                                 TO WS-COMMENT
  5401        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5402        PERFORM 0030-BUILD-BUFFER
  5403                                 THRU 0030-EXIT
  5404        PERFORM 0020-SEND-BUFFER
  5405                                 THRU 0020-EXIT
  5406        PERFORM 0025-CLOSE-SOCKET
  5407                                 THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  95
* SOCK03.cbl
  5408        GO TO 0010-RETURN
  5409     ELSE
  5410        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  5411        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5412        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  5413        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  5414     END-IF
  5415     .
  5416 0300-EXIT.
  5417     EXIT.
  5418 0310-GET-COMPANY.
  5419     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5420     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  5421     MOVE SPACES                 TO  WS-CF-ACCESS
  5422     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  5423
  5424* EXEC CICS READ
  5425*       INTO    (CONTROL-FILE)
  5426*       DATASET ('ELCNTL')
  5427*       RIDFLD  (WS-CF-KEY)
  5428*       RESP    (WS-RESPONSE)
  5429*    END-EXEC
  5430     MOVE LENGTH OF
  5431      CONTROL-FILE
  5432       TO DFHEIV11
  5433     MOVE 'ELCNTL' TO DFHEIV1
  5434*    MOVE '&"IL       E          (  N#00005145' TO DFHEIV0
  5435     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5437     MOVE X'204E233030303035313435' TO DFHEIV0(25:11)
  5438     CALL 'kxdfhei1' USING DFHEIV0,
  5439           DFHEIV1,
  5440           CONTROL-FILE,
  5441           DFHEIV11,
  5442           WS-CF-KEY,
  5443           DFHEIV99,
  5444           DFHEIV99,
  5445           DFHEIV99
  5446     MOVE EIBRESP  TO WS-RESPONSE
  5447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5448     IF (RESP-NORMAL)
  5449        AND (CF-COMPANY-ID = WS-COMP-ID)
  5450        AND (CF-RECORD-TYPE = '1')
  5451        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5452        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5453        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5454        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5455        IF CF-DEFAULT-APR NUMERIC
  5456           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5457        ELSE
  5458           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5459        END-IF
  5460        IF CF-VALID-REM-TRM-OPTION
  5461           MOVE CF-REM-TRM-CALC-OPTION
  5462                                 TO WS-CF-REM-TRM-CALC-OPTION
  5463        ELSE
  5464           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5465        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  96
* SOCK03.cbl
  5466     END-IF
  5467     .
  5468 0310-EXIT.
  5469     EXIT.
  5470 0320-GET-LIFE-RECORD.
  5471     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5472     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5473                                    WS-LF-BEN-CODE
  5474     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5475
  5476* EXEC CICS READ
  5477*       INTO    (CONTROL-FILE)
  5478*       DATASET ('ELCNTL')
  5479*       RIDFLD  (WS-CF-KEY)
  5480*       GTEQ
  5481*       RESP    (WS-RESPONSE)
  5482*    END-EXEC
  5483     MOVE LENGTH OF
  5484      CONTROL-FILE
  5485       TO DFHEIV11
  5486     MOVE 'ELCNTL' TO DFHEIV1
  5487*    MOVE '&"IL       G          (  N#00005178' TO DFHEIV0
  5488     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5490     MOVE X'204E233030303035313738' TO DFHEIV0(25:11)
  5491     CALL 'kxdfhei1' USING DFHEIV0,
  5492           DFHEIV1,
  5493           CONTROL-FILE,
  5494           DFHEIV11,
  5495           WS-CF-KEY,
  5496           DFHEIV99,
  5497           DFHEIV99,
  5498           DFHEIV99
  5499     MOVE EIBRESP  TO WS-RESPONSE
  5500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5501     IF RESP-NORMAL
  5502        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5503        AND (CF-RECORD-TYPE = '4')
  5504        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5505           (S1 > +8)
  5506           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5507        END-PERFORM
  5508        IF S1 > +8
  5509           CONTINUE
  5510        ELSE
  5511           MOVE CF-BENEFIT-DESCRIP (S1)
  5512                                 TO WS-LF-BEN-CODE-DESC
  5513           MOVE CF-LF-COVERAGE-TYPE (S1)
  5514                                 TO WS-CF-LF-COVERAGE-TYPE
  5515           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5516              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5517           ELSE
  5518              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5519           END-IF
  5520           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5521               MOVE CF-CO-REM-TERM-CALC (S1)
  5522                                 TO WS-LF-CO-REM-TERM-CALC
  5523           END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  97
* SOCK03.cbl
  5524           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5525               MOVE CF-CO-EARNINGS-CALC (S1)
  5526                                 TO WS-LF-CO-EARNINGS-CALC
  5527                                    WS-LF-CO-REFUND-CALC
  5528           END-IF
  5529           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5530               MOVE CF-SPECIAL-CALC-CD (S1)
  5531                                 TO WS-LF-SPECIAL-CALC-CD
  5532           END-IF
  5533           IF CF-CO-REFUND-CALC (S1) > '0'
  5534               MOVE CF-CO-REFUND-CALC (S1)
  5535                                 TO WS-LF-CO-REFUND-CALC
  5536        END-IF
  5537     END-IF
  5538     .
  5539 0320-EXIT.
  5540     EXIT.
  5541 0330-GET-AH-RECORD.
  5542     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5543     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5544     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5545
  5546* EXEC CICS READ
  5547*       INTO    (CONTROL-FILE)
  5548*       DATASET ('ELCNTL')
  5549*       RIDFLD  (WS-CF-KEY)
  5550*       GTEQ
  5551*       RESP    (WS-RESPONSE)
  5552*    END-EXEC
  5553     MOVE LENGTH OF
  5554      CONTROL-FILE
  5555       TO DFHEIV11
  5556     MOVE 'ELCNTL' TO DFHEIV1
  5557*    MOVE '&"IL       G          (  N#00005229' TO DFHEIV0
  5558     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5560     MOVE X'204E233030303035323239' TO DFHEIV0(25:11)
  5561     CALL 'kxdfhei1' USING DFHEIV0,
  5562           DFHEIV1,
  5563           CONTROL-FILE,
  5564           DFHEIV11,
  5565           WS-CF-KEY,
  5566           DFHEIV99,
  5567           DFHEIV99,
  5568           DFHEIV99
  5569     MOVE EIBRESP  TO WS-RESPONSE
  5570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5571     IF RESP-NORMAL
  5572        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5573        AND (CF-RECORD-TYPE = '5')
  5574        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5575           (S1 > +8)
  5576           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5577        END-PERFORM
  5578        IF S1 > +8
  5579           CONTINUE
  5580        ELSE
  5581           MOVE CF-BENEFIT-DESCRIP (S1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  98
* SOCK03.cbl
  5582                                 TO WS-AH-BEN-CODE-DESC
  5583           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5584              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5585           ELSE
  5586              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5587           END-IF
  5588           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5589              MOVE CF-CO-REM-TERM-CALC (S1)
  5590                                 TO WS-AH-CO-REM-TERM-CALC
  5591           END-IF
  5592           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5593              MOVE CF-CO-EARNINGS-CALC (S1)
  5594                                 TO WS-AH-CO-EARNINGS-CALC
  5595                                    WS-AH-CO-REFUND-CALC
  5596           END-IF
  5597           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5598              MOVE CF-SPECIAL-CALC-CD (S1)
  5599                                 TO WS-AH-SPECIAL-CALC-CD
  5600           END-IF
  5601           IF CF-CO-REFUND-CALC (S1) > '0'
  5602              MOVE CF-CO-REFUND-CALC (S1)
  5603                                 TO WS-AH-CO-REFUND-CALC
  5604           END-IF
  5605           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5606              MOVE CF-BENEFIT-CATEGORY (S1)
  5607                                 TO WS-AH-BEN-CATEGORY
  5608           END-IF
  5609        END-IF
  5610     END-IF
  5611     .
  5612 0330-EXIT.
  5613     EXIT.
  5614 0340-GET-STATE-RECORD.
  5615     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5616     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5617     MOVE CM-STATE               TO WS-CF-ACCESS
  5618     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5619
  5620* EXEC CICS READ
  5621*       INTO    (CONTROL-FILE)
  5622*       DATASET ('ELCNTL')
  5623*       RIDFLD  (WS-CF-KEY)
  5624*       RESP    (WS-RESPONSE)
  5625*    END-EXEC
  5626     MOVE LENGTH OF
  5627      CONTROL-FILE
  5628       TO DFHEIV11
  5629     MOVE 'ELCNTL' TO DFHEIV1
  5630*    MOVE '&"IL       E          (  N#00005284' TO DFHEIV0
  5631     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5632     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5633     MOVE X'204E233030303035323834' TO DFHEIV0(25:11)
  5634     CALL 'kxdfhei1' USING DFHEIV0,
  5635           DFHEIV1,
  5636           CONTROL-FILE,
  5637           DFHEIV11,
  5638           WS-CF-KEY,
  5639           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page  99
* SOCK03.cbl
  5640           DFHEIV99,
  5641           DFHEIV99
  5642     MOVE EIBRESP  TO WS-RESPONSE
  5643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5644     IF (RESP-NORMAL)
  5645        AND (CF-COMPANY-ID = WS-COMP-ID)
  5646        AND (CF-RECORD-TYPE = '3')
  5647        AND (CF-STATE-CODE = CM-STATE)
  5648        MOVE CF-ST-FREE-LOOK-PERIOD
  5649                                 TO WS-FREE-LOOK
  5650        MOVE CF-STATE-ABBREVIATION
  5651                                 TO WS-STATE-ABBREVIATION
  5652        MOVE CF-ST-FST-PMT-DAYS-CHG
  5653                                 TO  WS-STATE-EXT-DAYS-CHG
  5654        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5655           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5656           IF CF-ST-RT-CALC NOT = SPACES
  5657              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5658           END-IF
  5659           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5660              IF CF-ST-RF-LR-CALC > '0'
  5661                 MOVE CF-ST-RF-LR-CALC
  5662                                 TO WS-LF-ST-REFUND-CALC
  5663              END-IF
  5664              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5665                 IF CF-ST-RF-LN-CALC > '0'
  5666                    MOVE CF-ST-RF-LN-CALC
  5667                                 TO WS-LF-ST-REFUND-CALC
  5668                 END-IF
  5669              END-IF
  5670           ELSE
  5671              IF CF-ST-RF-LL-CALC > '0'
  5672                 MOVE CF-ST-RF-LL-CALC
  5673                                 TO WS-LF-ST-REFUND-CALC
  5674              END-IF
  5675           END-IF
  5676           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5677              (S1 > 50)
  5678              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5679                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5680           END-PERFORM
  5681           IF S1 < +51
  5682              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5683                 MOVE CF-ST-REM-TERM-CALC (S1)
  5684                                 TO WS-LF-ST-REM-TERM-CALC
  5685              END-IF
  5686              IF CF-ST-REFUND-CALC (S1) > '0'
  5687                 MOVE CF-ST-REFUND-CALC (S1)
  5688                                 TO WS-LF-ST-REFUND-CALC
  5689              END-IF
  5690           END-IF
  5691        END-IF
  5692        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5693           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5694           IF CF-ST-RT-CALC NOT = SPACES
  5695              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5696           END-IF
  5697           IF CF-ST-RF-AH-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 100
* SOCK03.cbl
  5698              MOVE CF-ST-RF-AH-CALC
  5699                                 TO WS-AH-ST-REFUND-CALC
  5700           END-IF
  5701           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5702              IF CF-ST-RF-CP-CALC > '0'
  5703                 MOVE CF-ST-RF-CP-CALC
  5704                                 TO WS-AH-ST-REFUND-CALC
  5705              END-IF
  5706           END-IF
  5707           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5708              (S1 > 50)
  5709              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5710                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5711           END-PERFORM
  5712           IF S1 < +51
  5713              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5714                 MOVE CF-ST-REM-TERM-CALC (S1)
  5715                                 TO WS-AH-ST-REM-TERM-CALC
  5716              END-IF
  5717              IF CF-ST-REFUND-CALC (S1) > '0'
  5718                 MOVE CF-ST-REFUND-CALC (S1)
  5719                                 TO WS-AH-ST-REFUND-CALC
  5720              END-IF
  5721           END-IF
  5722        END-IF
  5723     END-IF
  5724     .
  5725 0340-EXIT.
  5726     EXIT.
  5727 0350-GET-ERACCT.
  5728     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5729                                    WS-AM-EARN-METHOD-R
  5730                                    WS-AM-EARN-METHOD-A
  5731                                    WS-LF-AM-REM-TERM-CALC
  5732                                    WS-AH-AM-REM-TERM-CALC
  5733     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5734     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5735     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5736     MOVE CM-STATE               TO WS-AM-STATE
  5737     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5738     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5739     MOVE LOW-VALUES             TO WS-AM-FILLER
  5740     MOVE ' '                    TO WS-STOP-SW
  5741
  5742* EXEC CICS STARTBR
  5743*       DATASET  ('ERACCT')
  5744*       RIDFLD   (WS-AM-KEY)
  5745*       GTEQ
  5746*       RESP (WS-RESPONSE)
  5747*    END-EXEC
  5748     MOVE 'ERACCT' TO DFHEIV1
  5749     MOVE 0
  5750       TO DFHEIV11
  5751*    MOVE '&,         G          &  N#00005387' TO DFHEIV0
  5752     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5753     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5754     MOVE X'204E233030303035333837' TO DFHEIV0(25:11)
  5755     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 101
* SOCK03.cbl
  5756           DFHEIV1,
  5757           WS-AM-KEY,
  5758           DFHEIV99,
  5759           DFHEIV11,
  5760           DFHEIV99
  5761     MOVE EIBRESP  TO WS-RESPONSE
  5762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5763     IF RESP-NORMAL
  5764        PERFORM UNTIL TOLD-TO-STOP
  5765
  5766* EXEC CICS READNEXT
  5767*             DATASET  ('ERACCT')
  5768*             INTO     (ACCOUNT-MASTER)
  5769*             RIDFLD   (WS-AM-KEY)
  5770*          END-EXEC
  5771     MOVE LENGTH OF
  5772      ACCOUNT-MASTER
  5773       TO DFHEIV12
  5774     MOVE 'ERACCT' TO DFHEIV1
  5775     MOVE 0
  5776       TO DFHEIV11
  5777*    MOVE '&.IL                  )   #00005395' TO DFHEIV0
  5778     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5779     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5780     MOVE X'2020233030303035333935' TO DFHEIV0(25:11)
  5781     CALL 'kxdfhei1' USING DFHEIV0,
  5782           DFHEIV1,
  5783           ACCOUNT-MASTER,
  5784           DFHEIV12,
  5785           WS-AM-KEY,
  5786           DFHEIV99,
  5787           DFHEIV11,
  5788           DFHEIV99,
  5789           DFHEIV99
  5790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5791           IF RESP-NORMAL
  5792              EVALUATE TRUE
  5793                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5794                    CM-CONTROL-PRIMARY (1:20)
  5795                    SET TOLD-TO-STOP TO TRUE
  5796                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5797                    CM-CONTROL-PRIMARY (1:20))
  5798                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5799                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5800                    SET ERACCT-FOUND      TO TRUE
  5801                    SET TOLD-TO-STOP TO TRUE
  5802              END-EVALUATE
  5803           ELSE
  5804              SET TOLD-TO-STOP TO TRUE
  5805           END-IF
  5806        END-PERFORM
  5807
  5808* EXEC CICS ENDBR
  5809*          DATASET   ('ERACCT')
  5810*       END-EXEC
  5811     MOVE 'ERACCT' TO DFHEIV1
  5812     MOVE 0
  5813       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 102
* SOCK03.cbl
  5814*    MOVE '&2                    $   #00005416' TO DFHEIV0
  5815     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5816     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5817     MOVE X'2020233030303035343136' TO DFHEIV0(25:11)
  5818     CALL 'kxdfhei1' USING DFHEIV0,
  5819           DFHEIV1,
  5820           DFHEIV11,
  5821           DFHEIV99
  5822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5823     END-IF
  5824     .
  5825 0350-EXIT.
  5826     EXIT.
  5827 0400-PROCESS-LIFE.
  5828     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5829     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5830     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5831     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5832     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5833     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5834     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5835     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5836     MOVE CM-CARRIER             TO WS-CARRIER
  5837     MOVE CM-GROUPING            TO WS-GROUPING
  5838     MOVE CM-STATE               TO WS-STATE
  5839     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5840     MOVE CM-CERT-NO             TO WS-CERT-NO
  5841     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5842     MOVE ' '                    TO  DC-OPTION-CODE.
  5843     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5844     IF NO-CONVERSION-ERROR
  5845        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5846     ELSE
  5847        MOVE 99999999            TO WS-CERT-EFF-DATE
  5848     END-IF
  5849     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5850        GO TO 0400-EXIT
  5851     END-IF
  5852     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5853                                    WS-TOT-LF-PREM
  5854                                    WS-TOT-LF-COMM
  5855                                    WS-LF-CANCEL-DATE
  5856     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5857     MOVE ' '                    TO  DC-OPTION-CODE
  5858     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5859     IF NO-CONVERSION-ERROR
  5860        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5861     ELSE
  5862        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5863     END-IF
  5864     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5865        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5866        MOVE ' '                 TO DC-OPTION-CODE
  5867
  5868        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5869        IF NO-CONVERSION-ERROR
  5870           MOVE DC-GREG-DATE-CYMD
  5871                                 TO WS-LF-CANCEL-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 103
* SOCK03.cbl
  5872        ELSE
  5873           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5874        END-IF
  5875     END-IF
  5876     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5877        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  5878        MOVE ' '                 TO DC-OPTION-CODE
  5879
  5880        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5881        IF NO-CONVERSION-ERROR
  5882           MOVE DC-GREG-DATE-CYMD
  5883                                 TO WS-LF-CANCEL-DATE
  5884        ELSE
  5885           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5886        END-IF
  5887     END-IF
  5888     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5889     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5890     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5891     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5892     MOVE CM-STATE               TO CP-STATE
  5893     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5894     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5895     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5896     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5897     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5898     MOVE '2'                    TO CP-PROCESS-TYPE
  5899     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5900     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5901     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5902     MOVE WS-CF-REM-TRM-CALC-OPTION
  5903                                 TO CP-REM-TRM-CALC-OPTION
  5904     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5905     IF WS-LF-CO-REM-TERM-CALC > '0'
  5906        MOVE WS-LF-CO-REM-TERM-CALC
  5907                                 TO CP-REM-TERM-METHOD
  5908     END-IF
  5909     IF WS-LF-ST-REM-TERM-CALC > '0'
  5910         MOVE WS-LF-ST-REM-TERM-CALC
  5911                                 TO  CP-REM-TERM-METHOD.
  5912     IF WS-LF-AM-REM-TERM-CALC > '0'
  5913         MOVE WS-LF-AM-REM-TERM-CALC
  5914                                 TO  CP-REM-TERM-METHOD.
  5915     IF (WS-COMP-ID = 'CID')
  5916        AND (CP-STATE-STD-ABBRV = 'WI')
  5917        MOVE '7'                 TO CP-REM-TERM-METHOD
  5918        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5919     END-IF
  5920     IF (WS-COMP-ID = 'CID')
  5921        AND (CP-STATE-STD-ABBRV = 'MO')
  5922        AND (CM-CERT-EFF-DT >= X'9B41')
  5923        AND (CM-CERT-EFF-DT <= X'A2FB')
  5924        MOVE '7'                 TO CP-REM-TERM-METHOD
  5925        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5926     END-IF
  5927     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5928                                    CP-LOAN-TERM
  5929                                    WS-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 104
* SOCK03.cbl
  5930     IF CP-TRUNCATED-LIFE
  5931         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5932     IF CP-TERM-IS-DAYS
  5933        IF CM-LF-TERM-IN-DAYS NUMERIC
  5934           MOVE CM-LF-TERM-IN-DAYS
  5935                                 TO CP-TERM-OR-EXT-DAYS
  5936        ELSE
  5937           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5938        END-IF
  5939     ELSE
  5940        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5941           MOVE CM-PMT-EXTENSION-DAYS
  5942                                 TO CP-TERM-OR-EXT-DAYS
  5943        ELSE
  5944           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5945        END-IF
  5946     END-IF
  5947     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5948     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5949        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5950        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5951     END-IF
  5952     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5953     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5954     MOVE ' '                    TO WS-CLM-STOP-SW
  5955     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5956     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5957
  5958* EXEC CICS STARTBR
  5959*       DATASET     ('ELMSTR5')
  5960*       RIDFLD      (ELMSTR-KEY)
  5961*       RESP        (WS-RESPONSE)
  5962*    END-EXEC
  5963     MOVE 'ELMSTR5' TO DFHEIV1
  5964     MOVE 0
  5965       TO DFHEIV11
  5966*    MOVE '&,         G          &  N#00005553' TO DFHEIV0
  5967     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5968     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5969     MOVE X'204E233030303035353533' TO DFHEIV0(25:11)
  5970     CALL 'kxdfhei1' USING DFHEIV0,
  5971           DFHEIV1,
  5972           ELMSTR-KEY,
  5973           DFHEIV99,
  5974           DFHEIV11,
  5975           DFHEIV99
  5976     MOVE EIBRESP  TO WS-RESPONSE
  5977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5978     DISPLAY ' AFTER START ' WS-RESPONSE
  5979     IF RESP-NORMAL
  5980        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5981
  5982* EXEC CICS READNEXT
  5983*             DATASET   ('ELMSTR5')
  5984*             RIDFLD    (ELMSTR-KEY)
  5985*             INTO      (CLAIM-MASTER)
  5986*             RESP      (WS-RESPONSE)
  5987*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 105
* SOCK03.cbl
  5988     MOVE LENGTH OF
  5989      CLAIM-MASTER
  5990       TO DFHEIV12
  5991     MOVE 'ELMSTR5' TO DFHEIV1
  5992     MOVE 0
  5993       TO DFHEIV11
  5994*    MOVE '&.IL                  )  N#00005561' TO DFHEIV0
  5995     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5996     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5997     MOVE X'204E233030303035353631' TO DFHEIV0(25:11)
  5998     CALL 'kxdfhei1' USING DFHEIV0,
  5999           DFHEIV1,
  6000           CLAIM-MASTER,
  6001           DFHEIV12,
  6002           ELMSTR-KEY,
  6003           DFHEIV99,
  6004           DFHEIV11,
  6005           DFHEIV99,
  6006           DFHEIV99
  6007     MOVE EIBRESP  TO WS-RESPONSE
  6008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6009        IF (RESP-NORMAL OR RESP-DUPKEY)
  6010           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6011           AND (CM-CERT-NO = CL-CERT-NO)
  6012           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6013              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6014              IF CL-CLAIM-TYPE = 'L' OR 'O'
  6015                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  6016                    MOVE 'D'     TO WS-AH-STATUS
  6017                 END-IF
  6018                 IF CLAIM-IS-OPEN
  6019                    MOVE ' OPEN LIFE CLAIM '
  6020                                 TO WS-COMMENT
  6021                    MOVE 'L'     TO WS-LF-STATUS
  6022                    GO TO 0400-EXIT
  6023                 ELSE
  6024                    MOVE ' DEATH CLAIM APPLIED '
  6025                                 TO WS-COMMENT
  6026                    MOVE 'D'     TO WS-LF-STATUS
  6027*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  6028*                      MOVE CL-PAID-THRU-DT
  6029*                                TO WS-LF-BIN-PAID-THRU-DT
  6030*                   END-IF
  6031                 END-IF
  6032              END-IF
  6033           END-IF
  6034        ELSE
  6035           SET I-SAY-TO-STOP TO TRUE
  6036        END-IF
  6037        END-PERFORM
  6038
  6039* EXEC CICS ENDBR
  6040*          DATASET   ('ELMSTR5')
  6041*       END-EXEC
  6042     MOVE 'ELMSTR5' TO DFHEIV1
  6043     MOVE 0
  6044       TO DFHEIV11
  6045*    MOVE '&2                    $   #00005596' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 106
* SOCK03.cbl
  6046     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6048     MOVE X'2020233030303035353936' TO DFHEIV0(25:11)
  6049     CALL 'kxdfhei1' USING DFHEIV0,
  6050           DFHEIV1,
  6051           DFHEIV11,
  6052           DFHEIV99
  6053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6054     END-IF
  6055     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6056*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  6057        MOVE WS-LF-BIN-PAID-THRU-DT
  6058                                 TO DC-BIN-DATE-1
  6059        MOVE ' '                 TO DC-OPTION-CODE
  6060        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6061        IF NO-CONVERSION-ERROR
  6062           MOVE DC-GREG-DATE-CYMD
  6063                                 TO WS-CLM-PAID-THRU-DT
  6064        ELSE
  6065           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6066        END-IF
  6067*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  6068*          MOVE 'CAN DT =< CLM PD THRU DT'
  6069*                                TO WS-COMMENT
  6070*          MOVE 'P'              TO WS-LF-STATUS
  6071*          GO TO 0400-EXIT
  6072*       END-IF
  6073        GO TO 0400-EXIT
  6074     END-IF
  6075     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6076     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6077        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6078        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  6079        COMPUTE CP-REMAINING-TERM-1 =
  6080                CP-REMAINING-TERM-1 - +1
  6081        COMPUTE CP-REMAINING-TERM-2 =
  6082                CP-REMAINING-TERM-2 - +1
  6083     END-IF
  6084     IF CP-REMAINING-TERM-1 NEGATIVE
  6085        MOVE ZEROS               TO CP-REMAINING-TERM-1
  6086     END-IF
  6087     IF CP-REMAINING-TERM-2 NEGATIVE
  6088        MOVE ZEROS               TO CP-REMAINING-TERM-2
  6089     END-IF
  6090     IF CM-LIFE-COMM-PCT NOT NUMERIC
  6091        MOVE ZERO                TO CM-LIFE-COMM-PCT
  6092     END-IF
  6093     IF CM-LIFE-COMM-PCT > ZEROS
  6094        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  6095           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  6096     END-IF
  6097     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  6098     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  6099     IF CM-LF-CURRENT-STATUS = '8'
  6100        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  6101           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  6102                                 TO WS-COMMENT
  6103           MOVE 'C'              TO WS-LF-STATUS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 107
* SOCK03.cbl
  6104           move cm-lf-itd-cancel-amt
  6105                                 to ws-lf-refund
  6106*          PERFORM 0030-BUILD-BUFFER
  6107*                                THRU 0030-EXIT
  6108*          PERFORM 0020-SEND-BUFFER
  6109*                                THRU 0020-EXIT
  6110*          SET ALREADY-SENT      TO TRUE
  6111*          MOVE SPACES           TO WS-COMMENT
  6112           GO TO 0400-EXIT
  6113*          PERFORM 0025-CLOSE-SOCKET
  6114*                                THRU 0025-EXIT
  6115*          GO TO 0010-RETURN
  6116        END-IF
  6117     END-IF
  6118     IF CM-LF-CURRENT-STATUS = '7'
  6119        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  6120           MOVE ' DEATH CLAIM APPLIED '
  6121                                 TO WS-COMMENT
  6122           MOVE 'D'              TO WS-LF-STATUS
  6123*          PERFORM 0030-BUILD-BUFFER
  6124*                                THRU 0030-EXIT
  6125*          IF NOT ALREADY-SENT
  6126*             PERFORM 0020-SEND-BUFFER
  6127*                                THRU 0020-EXIT
  6128*             SET ALREADY-SENT   TO TRUE
  6129*          END-IF
  6130           GO TO 0400-EXIT
  6131*          PERFORM 0025-CLOSE-SOCKET
  6132*                                THRU 0025-EXIT
  6133*          GO TO 0010-RETURN
  6134        END-IF
  6135     END-IF
  6136     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6137        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6138        MOVE 'LF COVERAGE EXPIRED '
  6139                                 TO WS-COMMENT
  6140        MOVE 'E'                 TO WS-LF-STATUS
  6141        GO TO 0400-EXIT
  6142     END-IF
  6143     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6144        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6145        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6146     ELSE
  6147        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6148     END-IF
  6149     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6150     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6151*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6152     if ws-comp-id = 'AHL'
  6153        move cm-lf-class-cd      to cp-class-code
  6154        if cp-class-code = spaces
  6155           move zeros            to cp-class-code
  6156        end-if
  6157     else
  6158        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6159     end-if
  6160     IF (ws-comp-id = 'DCC' or 'VPP')
  6161        AND (AM-DCC-PRODUCT-CODE = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 108
* SOCK03.cbl
  6162        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6163        PERFORM 0730-GET-DDF-FACTORS
  6164                                 THRU 0730-EXIT
  6165        IF PDEF-FOUND
  6166           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6167              (P1 > +8)
  6168              OR (PD-PROD-CODE (P1) = 'L')
  6169           END-PERFORM
  6170           IF P1 < +9
  6171              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6172           END-IF
  6173        END-IF
  6174     END-IF
  6175     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  6176*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  6177     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6178        CM-LF-ALT-BENEFIT-AMT
  6179*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6180     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6181                                    WS-LF-REM-BEN
  6182     move cm-lf-premium-amt      to ws-tot-lf-prem
  6183     if ws-lf-co-earnings-calc = 'B'
  6184        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6185           + CM-LF-ALT-PREMIUM-AMT
  6186     end-if
  6187     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6188     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6189        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6190        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6191     ELSE
  6192        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6193     END-IF
  6194     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6195     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6196     IF WS-LF-ST-REFUND-CALC > ZERO
  6197         MOVE WS-LF-ST-REFUND-CALC
  6198                                 TO  CP-EARNING-METHOD.
  6199     IF WS-LF-FO-REFUND-CALC > ZERO
  6200         MOVE WS-LF-FO-REFUND-CALC
  6201                                 TO  CP-EARNING-METHOD.
  6202     IF CP-RATING-METHOD = '4'
  6203        MOVE '4'                 TO CP-EARNING-METHOD
  6204     END-IF
  6205*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6206     if ws-comp-id = 'AHL'
  6207        move cm-lf-class-cd      to cp-class-code
  6208        if cp-class-code = spaces
  6209           move zeros            to cp-class-code
  6210        end-if
  6211     else
  6212        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6213     end-if
  6214     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6215     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6216                                     CP-RATING-BENEFIT-AMT.
  6217     IF CP-STATE-STD-ABBRV = 'OR'
  6218         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6219                                         CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 109
* SOCK03.cbl
  6220****   N O T E   ****
  6221*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6222*      THE OH HARD CODING IN ELCRFNDP
  6223     IF WS-COMP-ID = 'CID'
  6224        IF CP-STATE-STD-ABBRV = 'OH'
  6225           MOVE WS-LF-CO-EARNINGS-CALC
  6226                                 TO CP-EARNING-METHOD
  6227        END-IF
  6228     END-IF
  6229****   N O T E   ****
  6230     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6231     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6232     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6233     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6234     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6235*    IF CP-EARN-AS-NET-PAY
  6236*       IF CP-LOAN-APR <= ZEROS
  6237*          IF WS-CF-DEFAULT-APR > ZEROS
  6238*             MOVE WS-CF-DEFAULT-APR
  6239*                                TO  CP-LOAN-APR
  6240*          END-IF
  6241*       END-IF
  6242*    END-IF
  6243*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6244*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6245*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6246*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6247*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6248*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6249*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6250*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6251*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6252*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6253*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6254*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6255*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6256*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6257*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6258*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6259*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6260*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6261     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6262     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6263     DISPLAY ' MADE IT BACK FROM ELRFND '
  6264     IF (CP-ERROR-RATE-IS-ZERO)
  6265        OR (CP-ERROR-RATE-NOT-FOUND)
  6266        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6267        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6268          DELIMITED BY SIZE INTO WS-COMMENT
  6269        END-STRING
  6270        MOVE 'X'                 TO WS-LF-STATUS
  6271        GO TO 0400-EXIT
  6272*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6273*       IF NOT ALREADY-SENT
  6274*          PERFORM 0020-SEND-BUFFER
  6275*                                THRU 0020-EXIT
  6276*          SET ALREADY-SENT      TO TRUE
  6277*       END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 110
* SOCK03.cbl
  6278*       PERFORM 0025-CLOSE-SOCKET
  6279*                                THRU 0025-EXIT
  6280*       GO TO 0010-RETURN
  6281     END-IF
  6282     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  6283                                    WS-TOT-LF-RFND
  6284     IF (WS-LF-STATUS = SPACES)
  6285        OR (CP-CALC-REFUND > ZEROS)
  6286        MOVE 'A'                 TO WS-LF-STATUS
  6287     END-IF
  6288     EVALUATE TRUE
  6289        WHEN CP-R-AS-R78
  6290           MOVE 'RULE 78'          TO  WS-LF-METHOD
  6291        WHEN  CP-R-AS-PRORATA
  6292           MOVE 'PRORATA'          TO  WS-LF-METHOD
  6293        WHEN CP-R-AS-CALIF
  6294           MOVE 'CALIF'            TO  WS-LF-METHOD
  6295        WHEN CP-R-AS-TEXAS
  6296           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6297        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6298           MOVE 'UTAH'             TO  WS-LF-METHOD
  6299        WHEN CP-R-AS-FARM-PLAN
  6300           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6301        WHEN CP-R-AS-NET-PAY
  6302           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6303        WHEN CP-R-AS-ANTICIPATION
  6304           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6305        WHEN CP-R-AS-MEAN
  6306           MOVE 'MEAN'             TO  WS-LF-METHOD
  6307        WHEN CP-R-AS-SUM-OF-DIGITS
  6308           MOVE 'SUM OF DIGITS'    TO  WS-LF-METHOD
  6309        WHEN CP-R-AS-REPOSSESSION
  6310           MOVE 'REPOSSESSION'     TO  WS-LF-METHOD
  6311     END-EVALUATE
  6312     IF WS-TOT-LF-RFND > ZEROS
  6313        COMPUTE WS-WORK-FACTOR ROUNDED =
  6314           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6315        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6316           WS-TOT-LF-COMM
  6317     END-IF
  6318     IF ERACCT-FOUND
  6319        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6320           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6321        END-IF
  6322        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6323           IF (AM-COMM-CHARGEBACK (1) = 99)
  6324                     OR
  6325              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6326                     OR
  6327              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6328              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6329              MOVE ZEROS         TO WS-LF-UEC
  6330           END-IF
  6331        END-IF
  6332     END-IF
  6333     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6334        GO TO 0400-EXIT
  6335     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 111
* SOCK03.cbl
  6336     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6337     MOVE '2'                    TO  CP-EARNING-METHOD
  6338                                     CP-RATING-METHOD.
  6339     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6340                                     CP-REMAINING-BENEFIT
  6341                                     CP-RATING-BENEFIT-AMT.
  6342     IF CP-STATE-STD-ABBRV = 'OR'
  6343         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6344                                         CM-LF-ALT-BENEFIT-AMT.
  6345     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6346     IF ws-comp-id = 'CID'
  6347        IF (CP-STATE-STD-ABBRV = 'MN')
  6348           AND (CM-CERT-EFF-DT > X'A4FF')
  6349           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6350           MOVE '5'              TO CP-EARNING-METHOD
  6351           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6352        END-IF
  6353     END-IF
  6354     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6355     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6356     IF (CP-ERROR-RATE-IS-ZERO)
  6357        OR (CP-ERROR-RATE-NOT-FOUND)
  6358        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6359        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6360          DELIMITED BY SIZE INTO WS-COMMENT
  6361        END-STRING
  6362        MOVE 'X'              TO WS-LF-STATUS
  6363        GO TO 0400-EXIT
  6364*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6365*       IF NOT ALREADY-SENT
  6366*          PERFORM 0020-SEND-BUFFER
  6367*                                THRU 0020-EXIT
  6368*          SET ALREADY-SENT      TO TRUE
  6369*       END-IF
  6370*       PERFORM 0025-CLOSE-SOCKET
  6371*                                THRU 0025-EXIT
  6372*       GO TO 0010-RETURN
  6373     END-IF
  6374     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6375     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6376     IF WS-TOT-LF-RFND > ZEROS
  6377        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6378           WS-TOT-LF-COMM
  6379     END-IF
  6380     IF ERACCT-FOUND
  6381        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6382           IF (AM-COMM-CHARGEBACK (1) = 99)
  6383                     OR
  6384              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6385                     OR
  6386              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6387              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6388              MOVE ZEROS         TO WS-LF-UEC
  6389           END-IF
  6390        END-IF
  6391     END-IF
  6392     .
  6393 0400-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 112
* SOCK03.cbl
  6394     EXIT.
  6395 0500-PROCESS-AH.
  6396     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  6397        GO TO 0500-EXIT
  6398     END-IF
  6399     MOVE ZEROS                  TO WS-TOT-AH-RFND
  6400                                    WS-TOT-AH-PREM
  6401                                    WS-TOT-AH-COMM
  6402                                    WS-AH-CANCEL-DATE
  6403     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6404     MOVE ' '                    TO  DC-OPTION-CODE
  6405     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6406     IF NO-CONVERSION-ERROR
  6407        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  6408     ELSE
  6409        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6410     END-IF
  6411     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6412        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6413        MOVE ' '                 TO DC-OPTION-CODE
  6414
  6415        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6416        IF NO-CONVERSION-ERROR
  6417           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6418        ELSE
  6419           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6420        END-IF
  6421     END-IF
  6422     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6423     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6424     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6425     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6426     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6427     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6428     MOVE CM-STATE               TO  CP-STATE.
  6429     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6430     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6431     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6432     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6433     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6434     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6435     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6436     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6437     MOVE WS-CF-CR-REM-TERM-CALC
  6438                                 TO  CP-REM-TERM-METHOD.
  6439     IF WS-AH-CO-REM-TERM-CALC > '0'
  6440         MOVE WS-AH-CO-REM-TERM-CALC
  6441                                 TO  CP-REM-TERM-METHOD.
  6442     IF WS-AH-ST-REM-TERM-CALC > '0'
  6443         MOVE WS-AH-ST-REM-TERM-CALC
  6444                                 TO  CP-REM-TERM-METHOD.
  6445     IF WS-AH-AM-REM-TERM-CALC > '0'
  6446         MOVE WS-AH-AM-REM-TERM-CALC
  6447                                 TO  CP-REM-TERM-METHOD.
  6448     IF (WS-COMP-ID = 'CID')
  6449        AND (CP-STATE-STD-ABBRV = 'WI')
  6450        MOVE '7'                 TO CP-REM-TERM-METHOD
  6451        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 113
* SOCK03.cbl
  6452     END-IF
  6453     IF (WS-COMP-ID = 'CID')
  6454        AND (CP-STATE-STD-ABBRV = 'MO')
  6455        AND (CM-CERT-EFF-DT >= X'9B41')
  6456        AND (CM-CERT-EFF-DT <= X'A2FB')
  6457        MOVE '7'                 TO CP-REM-TERM-METHOD
  6458        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6459     END-IF
  6460     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6461                                     CP-LOAN-TERM.
  6462     IF  NOT  CP-TERM-IS-DAYS
  6463         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6464             MOVE CM-PMT-EXTENSION-DAYS
  6465                                 TO  CP-TERM-OR-EXT-DAYS
  6466         ELSE
  6467             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6468     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  6469     IF CM-AH-COMM-PCT > ZEROS
  6470        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6471           CM-AH-PREMIUM-AMT
  6472     END-IF
  6473     IF (ws-comp-id = 'DCC' or 'VPP')
  6474        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6475        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6476           (cm-ah-clp + cm-addl-clp)
  6477     end-if
  6478     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6479     IF WS-AH-STATUS = 'D'
  6480        GO TO 0500-EXIT
  6481     END-IF
  6482     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6483     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6484     MOVE ' '                    TO WS-CLM-STOP-SW
  6485     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6486     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6487
  6488* EXEC CICS STARTBR
  6489*       DATASET     ('ELMSTR5')
  6490*       RIDFLD      (ELMSTR-KEY)
  6491*       RESP        (WS-RESPONSE)
  6492*    END-EXEC
  6493     MOVE 'ELMSTR5' TO DFHEIV1
  6494     MOVE 0
  6495       TO DFHEIV11
  6496*    MOVE '&,         G          &  N#00006032' TO DFHEIV0
  6497     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6498     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6499     MOVE X'204E233030303036303332' TO DFHEIV0(25:11)
  6500     CALL 'kxdfhei1' USING DFHEIV0,
  6501           DFHEIV1,
  6502           ELMSTR-KEY,
  6503           DFHEIV99,
  6504           DFHEIV11,
  6505           DFHEIV99
  6506     MOVE EIBRESP  TO WS-RESPONSE
  6507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6508     DISPLAY ' AFTER START ' WS-RESPONSE
  6509     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 114
* SOCK03.cbl
  6510        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6511           DISPLAY ' AH READNEXT '
  6512
  6513* EXEC CICS READNEXT
  6514*             DATASET   ('ELMSTR5')
  6515*             RIDFLD    (ELMSTR-KEY)
  6516*             INTO      (CLAIM-MASTER)
  6517*             RESP      (WS-RESPONSE)
  6518*          END-EXEC
  6519     MOVE LENGTH OF
  6520      CLAIM-MASTER
  6521       TO DFHEIV12
  6522     MOVE 'ELMSTR5' TO DFHEIV1
  6523     MOVE 0
  6524       TO DFHEIV11
  6525*    MOVE '&.IL                  )  N#00006041' TO DFHEIV0
  6526     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6527     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6528     MOVE X'204E233030303036303431' TO DFHEIV0(25:11)
  6529     CALL 'kxdfhei1' USING DFHEIV0,
  6530           DFHEIV1,
  6531           CLAIM-MASTER,
  6532           DFHEIV12,
  6533           ELMSTR-KEY,
  6534           DFHEIV99,
  6535           DFHEIV11,
  6536           DFHEIV99,
  6537           DFHEIV99
  6538     MOVE EIBRESP  TO WS-RESPONSE
  6539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6540        IF (RESP-NORMAL OR RESP-DUPKEY)
  6541           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6542           AND (CM-CERT-NO = CL-CERT-NO)
  6543           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6544              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6545              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6546                 IF CLAIM-IS-OPEN
  6547                    DISPLAY ' FOUND OPEN AH CLAIM '
  6548                    MOVE ' OPEN HEALTH CLAIM '
  6549                                 TO WS-COMMENT
  6550                    MOVE 'H'     TO WS-AH-STATUS
  6551                 ELSE
  6552                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6553                    MOVE ' CLOSED HEALTH CLAIM '
  6554                                 TO WS-COMMENT
  6555                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6556                       MOVE CL-PAID-THRU-DT
  6557                                 TO WS-AH-BIN-PAID-THRU-DT
  6558                    END-IF
  6559                 END-IF
  6560              END-IF
  6561           END-IF
  6562        ELSE
  6563           SET I-SAY-TO-STOP TO TRUE
  6564        END-IF
  6565        END-PERFORM
  6566
  6567* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 115
* SOCK03.cbl
  6568*          DATASET   ('ELMSTR5')
  6569*       END-EXEC
  6570     MOVE 'ELMSTR5' TO DFHEIV1
  6571     MOVE 0
  6572       TO DFHEIV11
  6573*    MOVE '&2                    $   #00006073' TO DFHEIV0
  6574     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6575     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6576     MOVE X'2020233030303036303733' TO DFHEIV0(25:11)
  6577     CALL 'kxdfhei1' USING DFHEIV0,
  6578           DFHEIV1,
  6579           DFHEIV11,
  6580           DFHEIV99
  6581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6582     END-IF
  6583     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6584*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6585        MOVE WS-AH-BIN-PAID-THRU-DT
  6586                                 TO DC-BIN-DATE-1
  6587        MOVE ' '                 TO DC-OPTION-CODE
  6588        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6589        IF NO-CONVERSION-ERROR
  6590           MOVE DC-GREG-DATE-CYMD
  6591                                 TO WS-CLM-PAID-THRU-DT
  6592        ELSE
  6593           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6594        END-IF
  6595        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6596           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6597                                 TO WS-COMMENT
  6598           MOVE 'P'              TO WS-AH-STATUS
  6599           GO TO 0500-EXIT
  6600        END-IF
  6601     END-IF
  6602     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6603     IF CM-AH-CURRENT-STATUS = '8'
  6604        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6605           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6606                                 TO WS-COMMENT
  6607           MOVE 'C'              TO WS-AH-STATUS
  6608           move cm-ah-itd-cancel-amt
  6609                                 to ws-ah-refund
  6610           GO TO 0500-EXIT
  6611        END-IF
  6612     END-IF
  6613     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6614        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6615           MOVE ' SETTLEMENT CLAIM APPLIED '
  6616                                 TO WS-COMMENT
  6617           MOVE 'S'              TO WS-AH-STATUS
  6618*          PERFORM 0030-BUILD-BUFFER
  6619*                                THRU 0030-EXIT
  6620*          IF NOT ALREADY-SENT
  6621*             PERFORM 0020-SEND-BUFFER
  6622*                                THRU 0020-EXIT
  6623*             SET ALREADY-SENT   TO TRUE
  6624*          END-IF
  6625           GO TO 0500-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 116
* SOCK03.cbl
  6626*          PERFORM 0025-CLOSE-SOCKET
  6627*                                THRU 0025-EXIT
  6628*          GO TO 0010-RETURN
  6629        END-IF
  6630     END-IF
  6631     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6632        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6633        MOVE 'AH COVERAGE EXPIRED '
  6634                                 TO WS-COMMENT
  6635        MOVE 'E'                 TO WS-AH-STATUS
  6636        GO TO 0500-EXIT
  6637     END-IF
  6638     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6639                                    WS-AH-PREM
  6640     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6641     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6642        * CP-REMAINING-TERM-1
  6643     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6644                                     WS-AH-REM-TERM
  6645     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6646     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6647     IF WS-AH-ST-REFUND-CALC > ZERO
  6648         MOVE WS-AH-ST-REFUND-CALC
  6649                                 TO  CP-EARNING-METHOD.
  6650     IF WS-AH-FO-REFUND-CALC > ZERO
  6651         MOVE WS-AH-FO-REFUND-CALC
  6652                                 TO  CP-EARNING-METHOD.
  6653*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6654     if ws-comp-id = 'AHL'
  6655        move cm-ah-class-cd      to cp-class-code
  6656        if cp-class-code = spaces
  6657           move zeros            to cp-class-code
  6658        end-if
  6659     else
  6660        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6661     end-if
  6662     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6663     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6664                                     CP-RATING-BENEFIT-AMT.
  6665     IF CP-STATE-STD-ABBRV = 'OR'
  6666         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6667                                         CM-AH-ORIG-TERM.
  6668     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6669     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6670     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6671     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6672     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6673     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6674     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6675     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6676     MOVE ' '                    TO  DC-OPTION-CODE.
  6677     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6678     IF CP-STATE-STD-ABBRV = 'OH'
  6679        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6680         IF (CP-ORIGINAL-TERM > 60)
  6681           AND (DC-GREG-DATE-1-YMD > '831101')
  6682           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6683             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 117
* SOCK03.cbl
  6684         END-IF
  6685        END-IF
  6686        IF WS-COMP-ID = 'CID'
  6687           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6688                           LOW-VALUES)
  6689              IF CP-CRITICAL-PERIOD
  6690                 MOVE '2'       TO CP-EARNING-METHOD
  6691              ELSE
  6692                 MOVE '6'       TO CP-EARNING-METHOD
  6693              END-IF
  6694           ELSE
  6695              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6696                 MOVE '2'       TO CP-EARNING-METHOD
  6697              ELSE
  6698                 IF ((CM-LF-ORIG-TERM > 60) AND
  6699                    (CM-RATE-CLASS NOT = 'L '))
  6700                               OR
  6701                    (WS-LF-CO-EARNINGS-CALC = '5')
  6702                    IF CP-CRITICAL-PERIOD
  6703                       MOVE '2'  TO CP-EARNING-METHOD
  6704                    ELSE
  6705                       MOVE '6'  TO CP-EARNING-METHOD
  6706                    END-IF
  6707                 ELSE
  6708                    MOVE '1'     TO CP-EARNING-METHOD
  6709                 END-IF
  6710              END-IF
  6711           END-IF
  6712        END-IF
  6713     END-IF
  6714     IF CP-STATE-STD-ABBRV = 'VA'
  6715       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6716         IF DC-GREG-DATE-1-YMD > '921231'
  6717            IF CP-ORIGINAL-TERM > 61
  6718                MOVE '6'            TO  CP-EARNING-METHOD
  6719            ELSE
  6720                MOVE '1'            TO  CP-EARNING-METHOD.
  6721*    IF CP-EARN-AS-NET-PAY
  6722*       IF CP-LOAN-APR <= ZEROS
  6723*          IF WS-CF-DEFAULT-APR > ZEROS
  6724*             MOVE WS-CF-DEFAULT-APR
  6725*                                TO  CP-LOAN-APR
  6726*          END-IF
  6727*       END-IF
  6728*    END-IF
  6729     IF WS-COMP-ID = 'DCC' or 'VPP'
  6730        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6731           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6732           MOVE 'S'              TO CP-EARNING-METHOD
  6733        END-IF
  6734     END-IF
  6735     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6736     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6737        AND (CP-EARNING-METHOD = 'D')
  6738        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6739                                    WS-DDF-CSO-ADMIN-FEE
  6740                                    WS-DDF-1ST-YR-TOT-EXP
  6741                                    WS-DDF-COMM-AND-MFEE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 118
* SOCK03.cbl
  6742        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6743           S1 > +10
  6744           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6745              IF (AM-A-COM (S1) NUMERIC)
  6746                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6747                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6748              ELSE
  6749                 MOVE +0         TO WS-COMM-PCT C0
  6750                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6751                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6752              END-IF
  6753              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6754                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6755                    + WS-COMM-PCT
  6756              END-IF
  6757              IF AM-COM-TYP (S1) = 'N'
  6758                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6759                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6760              END-IF
  6761              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6762                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6763                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6764              END-IF
  6765              IF AM-COM-TYP (S1) = 'I'
  6766                 COMPUTE WS-DDF-COMM-AND-MFEE
  6767                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6768              END-IF
  6769           END-IF
  6770        END-PERFORM
  6771        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6772        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6773        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6774           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6775     END-IF
  6776     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6777        AND (CP-EARNING-METHOD = 'D')
  6778        AND (ws-CANCEL-REASON NOT = 'R')
  6779        PERFORM 0730-GET-DDF-FACTORS
  6780                                 THRU 0730-EXIT
  6781        IF NOT PDEF-FOUND
  6782           MOVE ' DDF UE FACTORS  NOT FOUND '
  6783                                 TO WS-COMMENT
  6784           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6785           PERFORM 0030-BUILD-BUFFER
  6786                                 THRU 0030-EXIT
  6787           PERFORM 0020-SEND-BUFFER
  6788                                 THRU 0020-EXIT
  6789           PERFORM 0025-CLOSE-SOCKET
  6790                                 THRU 0025-EXIT
  6791           GO TO 0010-RETURN
  6792        END-IF
  6793*       IF NOT PDEF-FOUND
  6794*          MOVE ER-9999          TO EMI-ERROR
  6795*          PERFORM 9700-ERROR-FORMAT
  6796*                                THRU 9799-EXIT
  6797*          GO TO 8200-SEND-DATAONLY
  6798*       END-IF
  6799        MOVE PD-UEP-FACTOR (P1 P2 + 1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 119
* SOCK03.cbl
  6800                                 TO CP-DDF-LO-FACT
  6801        MOVE PD-UEP-FACTOR (P1 P2)
  6802                                 TO CP-DDF-HI-FACT
  6803        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6804        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6805        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6806        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6807           + PD-1ST-YR-ADMIN-ALLOW
  6808        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6809*       IF PI-CLP-YN = 'Y'
  6810*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6811*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6812*                                   CP-DDF-CLP
  6813*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6814*       END-IF
  6815        IF DD-IU-PRESENT
  6816           MOVE 'I'              TO CP-EARNING-METHOD
  6817        END-IF
  6818        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6819                                    CP-CLP-RATE-UP
  6820        IF (CP-CALC-GROSS-FEE)
  6821           AND (CP-IU-RATE-UP NOT = ZEROS)
  6822           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6823              / CP-ORIGINAL-PREMIUM)
  6824           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6825              / (1 - TEX-FACT-8)
  6826        END-IF
  6827     END-IF
  6828     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6829     IF (CP-ERROR-RATE-IS-ZERO)
  6830        OR (CP-ERROR-RATE-NOT-FOUND)
  6831        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6832        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6833          DELIMITED BY SIZE INTO WS-COMMENT
  6834        END-STRING
  6835        IF WS-AH-STATUS NOT = 'H'
  6836           MOVE 'X'                 TO WS-AH-STATUS
  6837        END-IF
  6838        GO TO 0500-EXIT
  6839*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6840*       IF NOT ALREADY-SENT
  6841*          PERFORM 0020-SEND-BUFFER
  6842*                                THRU 0020-EXIT
  6843*          SET ALREADY-SENT      TO TRUE
  6844*       END-IF
  6845*       PERFORM 0025-CLOSE-SOCKET
  6846*                                THRU 0025-EXIT
  6847*       GO TO 0010-RETURN
  6848     END-IF
  6849     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6850                                    WS-TOT-AH-RFND
  6851     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6852     IF ((WS-AH-STATUS = SPACES)
  6853        OR (CP-CALC-REFUND > ZEROS))
  6854                  AND
  6855          (WS-AH-STATUS NOT = 'H')
  6856        MOVE 'A'                 TO WS-AH-STATUS
  6857     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 120
* SOCK03.cbl
  6858     IF WS-COMP-ID = 'DCC' or 'VPP'
  6859        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6860        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6861        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6862        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6863        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6864        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6865        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6866        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6867        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6868     END-IF
  6869     EVALUATE TRUE
  6870        WHEN CP-R-AS-R78
  6871           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6872        WHEN CP-R-AS-PRORATA
  6873           MOVE 'PRORATA'          TO  WS-AH-METHOD
  6874        WHEN CP-REFUND-TYPE-USED = '3'
  6875           MOVE 'CALIF'            TO  WS-AH-METHOD
  6876        WHEN CP-R-AS-TEXAS
  6877           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6878        WHEN CP-R-AS-FARM-PLAN
  6879           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6880        WHEN CP-R-AS-NET-PAY
  6881           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6882        WHEN CP-R-AS-ANTICIPATION
  6883           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6884        WHEN CP-R-AS-MEAN
  6885           MOVE 'MEAN'             TO  WS-AH-METHOD
  6886        WHEN CP-R-AS-SUM-OF-DIGITS
  6887           MOVE 'SUM OF DIGITS'    TO  WS-AH-METHOD
  6888        WHEN CP-GAP-ACTUARIAL
  6889           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6890        WHEN CP-R-AS-REPOSSESSION
  6891           MOVE 'REPOSSESSION'     TO WS-AH-METHOD
  6892     END-EVALUATE
  6893     IF WS-TOT-AH-RFND > ZEROS
  6894        IF (ws-comp-id = 'DCC' or 'VPP')
  6895           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6896           compute ws-work-factor rounded =
  6897              ws-ah-rfnd-clp / cm-ah-clp
  6898        else
  6899           COMPUTE WS-WORK-FACTOR ROUNDED =
  6900              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6901        end-if
  6902        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6903           WS-TOT-AH-COMM
  6904     END-IF
  6905     IF ERACCT-FOUND
  6906        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6907           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6908        END-IF
  6909        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6910           IF (AM-COMM-CHARGEBACK (1) = 99)
  6911                     OR
  6912              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6913                     OR
  6914              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6915              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 121
* SOCK03.cbl
  6916              MOVE ZEROS         TO WS-AH-UEC
  6917           END-IF
  6918        END-IF
  6919     END-IF
  6920     .
  6921 0500-EXIT.
  6922     EXIT.
  6923 0610-GET-ERMAIL.
  6924
  6925     move cm-control-primary     to ws-ma-key
  6926*    MOVE WS-CM-KEY              TO WS-MA-KEY
  6927
  6928* EXEC CICS READ
  6929*       INTO    (MAILING-DATA)
  6930*       DATASET ('ERMAIL')
  6931*       RIDFLD  (WS-MA-KEY)
  6932*       RESP    (WS-RESPONSE)
  6933*    END-EXEC
  6934     MOVE LENGTH OF
  6935      MAILING-DATA
  6936       TO DFHEIV11
  6937     MOVE 'ERMAIL' TO DFHEIV1
  6938*    MOVE '&"IL       E          (  N#00006421' TO DFHEIV0
  6939     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6941     MOVE X'204E233030303036343231' TO DFHEIV0(25:11)
  6942     CALL 'kxdfhei1' USING DFHEIV0,
  6943           DFHEIV1,
  6944           MAILING-DATA,
  6945           DFHEIV11,
  6946           WS-MA-KEY,
  6947           DFHEIV99,
  6948           DFHEIV99,
  6949           DFHEIV99
  6950     MOVE EIBRESP  TO WS-RESPONSE
  6951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6952
  6953     IF RESP-NORMAL
  6954        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6955     else
  6956        move spaces              to ws-cred-bene-name
  6957     end-if
  6958
  6959     .
  6960 0610-EXIT.
  6961     EXIT.
  6962 0620-GET-ELCRTT.
  6963
  6964     move cm-control-primary     to ws-cs-key
  6965*    MOVE WS-CM-KEY              TO WS-CS-KEY
  6966     move 'C'                    to WS-CS-TRLR-TYPE
  6967
  6968
  6969* EXEC CICS READ
  6970*       INTO    (CERTIFICATE-TRAILERS)
  6971*       DATASET ('ELCRTT')
  6972*       RIDFLD  (WS-CS-KEY)
  6973*       RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 122
* SOCK03.cbl
  6974*    END-EXEC
  6975     MOVE LENGTH OF
  6976      CERTIFICATE-TRAILERS
  6977       TO DFHEIV11
  6978     MOVE 'ELCRTT' TO DFHEIV1
  6979*    MOVE '&"IL       E          (  N#00006443' TO DFHEIV0
  6980     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6982     MOVE X'204E233030303036343433' TO DFHEIV0(25:11)
  6983     CALL 'kxdfhei1' USING DFHEIV0,
  6984           DFHEIV1,
  6985           CERTIFICATE-TRAILERS,
  6986           DFHEIV11,
  6987           WS-CS-KEY,
  6988           DFHEIV99,
  6989           DFHEIV99,
  6990           DFHEIV99
  6991     MOVE EIBRESP  TO WS-RESPONSE
  6992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6993
  6994     IF RESP-NORMAL
  6995        MOVE cs-vin-number       to ws-vin
  6996     else
  6997        move spaces              to ws-vin
  6998     end-if
  6999
  7000     .
  7001 0620-EXIT.
  7002     EXIT.
  7003 0700-LINK-REM-TERM.
  7004
  7005* EXEC CICS LINK
  7006*        PROGRAM   ('ELRTRM')
  7007*        COMMAREA  (CALCULATION-PASS-AREA)
  7008*        LENGTH    (CP-COMM-LENGTH)
  7009*    END-EXEC.
  7010     MOVE 'ELRTRM' TO DFHEIV1
  7011*    MOVE '."C                   (   #00006460' TO DFHEIV0
  7012     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7014     MOVE X'2020233030303036343630' TO DFHEIV0(25:11)
  7015     CALL 'kxdfhei1' USING DFHEIV0,
  7016           DFHEIV1,
  7017           CALCULATION-PASS-AREA,
  7018           CP-COMM-LENGTH,
  7019           DFHEIV99,
  7020           DFHEIV99,
  7021           DFHEIV99,
  7022           DFHEIV99
  7023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7024
  7025 0700-EXIT.
  7026     EXIT.
  7027 0710-LINK-REM-AMOUNT.
  7028
  7029* EXEC CICS LINK
  7030*        PROGRAM   ('ELRAMT')
  7031*        COMMAREA  (CALCULATION-PASS-AREA)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 123
* SOCK03.cbl
  7032*        LENGTH    (CP-COMM-LENGTH)
  7033*    END-EXEC
  7034     MOVE 'ELRAMT' TO DFHEIV1
  7035*    MOVE '."C                   (   #00006468' TO DFHEIV0
  7036     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7038     MOVE X'2020233030303036343638' TO DFHEIV0(25:11)
  7039     CALL 'kxdfhei1' USING DFHEIV0,
  7040           DFHEIV1,
  7041           CALCULATION-PASS-AREA,
  7042           CP-COMM-LENGTH,
  7043           DFHEIV99,
  7044           DFHEIV99,
  7045           DFHEIV99,
  7046           DFHEIV99
  7047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7048     .
  7049 0710-EXIT.
  7050     EXIT.
  7051 0720-LINK-REFUND.
  7052
  7053* EXEC CICS LINK
  7054*        PROGRAM   ('ELRFND')
  7055*        COMMAREA  (CALCULATION-PASS-AREA)
  7056*        LENGTH    (CP-COMM-LENGTH)
  7057*    END-EXEC
  7058     MOVE 'ELRFND' TO DFHEIV1
  7059*    MOVE '."C                   (   #00006477' TO DFHEIV0
  7060     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7062     MOVE X'2020233030303036343737' TO DFHEIV0(25:11)
  7063     CALL 'kxdfhei1' USING DFHEIV0,
  7064           DFHEIV1,
  7065           CALCULATION-PASS-AREA,
  7066           CP-COMM-LENGTH,
  7067           DFHEIV99,
  7068           DFHEIV99,
  7069           DFHEIV99,
  7070           DFHEIV99
  7071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7072     .
  7073 0720-EXIT.
  7074     EXIT.
  7075 0730-GET-DDF-FACTORS.
  7076     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7077     MOVE WS-COMP-CD             TO ERPDEF-KEY
  7078     MOVE CM-STATE               TO ERPDEF-STATE
  7079     if cm-clp-state not = cm-state and spaces and zeros
  7080        move cm-clp-state        to erpdef-state
  7081     end-if
  7082     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7083     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7084     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7085     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7086     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7087
  7088* EXEC CICS STARTBR
  7089*        DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 124
* SOCK03.cbl
  7090*        RIDFLD   (ERPDEF-KEY)
  7091*        GTEQ
  7092*        RESP     (WS-RESPONSE)
  7093*    END-EXEC
  7094     MOVE 'ERPDEF' TO DFHEIV1
  7095     MOVE 0
  7096       TO DFHEIV11
  7097*    MOVE '&,         G          &  N#00006497' TO DFHEIV0
  7098     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7100     MOVE X'204E233030303036343937' TO DFHEIV0(25:11)
  7101     CALL 'kxdfhei1' USING DFHEIV0,
  7102           DFHEIV1,
  7103           ERPDEF-KEY,
  7104           DFHEIV99,
  7105           DFHEIV11,
  7106           DFHEIV99
  7107     MOVE EIBRESP  TO WS-RESPONSE
  7108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7109     IF NOT RESP-NORMAL
  7110        GO TO 0730-EXIT
  7111     END-IF
  7112     .
  7113 0730-READNEXT.
  7114
  7115* EXEC CICS READNEXT
  7116*       DATASET  ('ERPDEF')
  7117*       INTO     (PRODUCT-MASTER)
  7118*       RIDFLD   (ERPDEF-KEY)
  7119*       RESP     (WS-RESPONSE)
  7120*    END-EXEC
  7121     MOVE LENGTH OF
  7122      PRODUCT-MASTER
  7123       TO DFHEIV12
  7124     MOVE 'ERPDEF' TO DFHEIV1
  7125     MOVE 0
  7126       TO DFHEIV11
  7127*    MOVE '&.IL                  )  N#00006508' TO DFHEIV0
  7128     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7129     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7130     MOVE X'204E233030303036353038' TO DFHEIV0(25:11)
  7131     CALL 'kxdfhei1' USING DFHEIV0,
  7132           DFHEIV1,
  7133           PRODUCT-MASTER,
  7134           DFHEIV12,
  7135           ERPDEF-KEY,
  7136           DFHEIV99,
  7137           DFHEIV11,
  7138           DFHEIV99,
  7139           DFHEIV99
  7140     MOVE EIBRESP  TO WS-RESPONSE
  7141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7142     IF NOT RESP-NORMAL
  7143        GO TO 0730-ENDBR
  7144     END-IF
  7145     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7146        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7147           MOVE 'Y'              TO WS-PDEF-RECORD-SW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 125
* SOCK03.cbl
  7148        ELSE
  7149           GO TO 0730-READNEXT
  7150        END-IF
  7151     ELSE
  7152        GO TO 0730-ENDBR
  7153     END-IF
  7154     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7155        (P1 > +8)
  7156        OR (PD-PROD-CODE (P1) = 'I')
  7157     END-PERFORM
  7158     IF P1 < +9
  7159        SET DD-IU-PRESENT        TO TRUE
  7160     END-IF
  7161     IF CM-LOAN-TERM = ZEROS
  7162        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7163     END-IF
  7164     IF PD-TRUNCATED = 'Y'
  7165        MOVE CM-LOAN-TERM        TO WS-TERM
  7166     ELSE
  7167        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7168     END-IF
  7169     EVALUATE TRUE
  7170        WHEN WS-TERM > +168
  7171           MOVE 15               TO P1
  7172        WHEN WS-TERM > +156
  7173           MOVE 14               TO P1
  7174        WHEN WS-TERM > +144
  7175           MOVE 13               TO P1
  7176        WHEN WS-TERM > +132
  7177           MOVE 12               TO P1
  7178        WHEN WS-TERM > +120
  7179           MOVE 11               TO P1
  7180        WHEN WS-TERM > +108
  7181           MOVE 10               TO P1
  7182        WHEN WS-TERM > +96
  7183           MOVE 9                TO P1
  7184        WHEN WS-TERM > +84
  7185           MOVE 8                TO P1
  7186        WHEN WS-TERM > +72
  7187           MOVE 7                TO P1
  7188        WHEN WS-TERM > +60
  7189           MOVE 6                TO P1
  7190        WHEN WS-TERM > +48
  7191           MOVE 5                TO P1
  7192        WHEN WS-TERM > +36
  7193           MOVE 4                TO P1
  7194        WHEN WS-TERM > +24
  7195           MOVE 3                TO P1
  7196        WHEN WS-TERM > +12
  7197           MOVE 2                TO P1
  7198        WHEN OTHER
  7199           MOVE 1                TO P1
  7200     END-EVALUATE
  7201     EVALUATE TRUE
  7202*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7203*          AND (DD-IU-PRESENT)
  7204*          MOVE 2                TO P2
  7205*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 126
* SOCK03.cbl
  7206*          MOVE 1                TO P2
  7207        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7208           MOVE 2                TO P2
  7209        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7210           MOVE 3                TO P2
  7211        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7212           MOVE 4                TO P2
  7213        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7214           MOVE 5                TO P2
  7215        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7216           MOVE 6                TO P2
  7217        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7218           MOVE 7                TO P2
  7219        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7220           MOVE 8                TO P2
  7221        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7222           MOVE 9                TO P2
  7223        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7224           MOVE 10               TO P2
  7225        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7226           MOVE 11               TO P2
  7227        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7228           MOVE 12               TO P2
  7229        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7230           MOVE 13               TO P2
  7231        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7232           MOVE 14               TO P2
  7233        WHEN OTHER
  7234           MOVE 15               TO P2
  7235     END-EVALUATE
  7236     .
  7237 0730-ENDBR.
  7238
  7239* EXEC CICS ENDBR
  7240*       DATASET  ('ERPDEF')
  7241*    END-EXEC
  7242     MOVE 'ERPDEF' TO DFHEIV1
  7243     MOVE 0
  7244       TO DFHEIV11
  7245*    MOVE '&2                    $   #00006610' TO DFHEIV0
  7246     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7248     MOVE X'2020233030303036363130' TO DFHEIV0(25:11)
  7249     CALL 'kxdfhei1' USING DFHEIV0,
  7250           DFHEIV1,
  7251           DFHEIV11,
  7252           DFHEIV99
  7253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7254     .
  7255 0730-EXIT.
  7256     EXIT.
  7257 0740-GET-ERCTBL.
  7258     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7259     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7260     MOVE 'A'                    TO CTBL-BEN-TYPE
  7261     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7262     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7263     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 127
* SOCK03.cbl
  7264     IF RESP-NORMAL
  7265        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7266     ELSE
  7267        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7268        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7269        MOVE 'A'                    TO CTBL-BEN-TYPE
  7270        MOVE 'AA'                   TO CTBL-BEN-CODE
  7271        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7272        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7273        IF RESP-NORMAL
  7274           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7275        END-IF
  7276     END-IF
  7277     .
  7278 0740-EXIT.
  7279     EXIT.
  7280 0750-READ-ERCTBL.
  7281
  7282* EXEC CICS READ
  7283*         INTO    (COMM-TABLE-RECORD)
  7284*         DATASET ('ERCTBL')
  7285*         RIDFLD  (CTBL-KEY)
  7286*         RESP    (WS-RESPONSE)
  7287*    END-EXEC
  7288     MOVE LENGTH OF
  7289      COMM-TABLE-RECORD
  7290       TO DFHEIV11
  7291     MOVE 'ERCTBL' TO DFHEIV1
  7292*    MOVE '&"IL       E          (  N#00006640' TO DFHEIV0
  7293     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7295     MOVE X'204E233030303036363430' TO DFHEIV0(25:11)
  7296     CALL 'kxdfhei1' USING DFHEIV0,
  7297           DFHEIV1,
  7298           COMM-TABLE-RECORD,
  7299           DFHEIV11,
  7300           CTBL-KEY,
  7301           DFHEIV99,
  7302           DFHEIV99,
  7303           DFHEIV99
  7304     MOVE EIBRESP  TO WS-RESPONSE
  7305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7306     .
  7307 0750-EXIT.
  7308     EXIT.
  7309 0760-FIND-COMM.
  7310     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7311        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7312        OR (C1 > +3)
  7313     END-PERFORM
  7314     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7315        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7316        OR (C2 > +3)
  7317     END-PERFORM
  7318     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7319        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7320        OR (C3 > +3)
  7321     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 128
* SOCK03.cbl
  7322     IF C1 > +3
  7323        MOVE +1                  TO C1
  7324     END-IF
  7325     IF C2 > +3
  7326        MOVE +1                  TO C2
  7327     END-IF
  7328     IF C3 > +3
  7329        MOVE +1                  TO C3
  7330     END-IF
  7331     IF C1 = +3
  7332        MOVE +18                 TO C0
  7333     ELSE
  7334        IF C1 = +2
  7335           MOVE +9               TO C0
  7336        END-IF
  7337     END-IF
  7338     IF C2 = +3
  7339        ADD +6                   TO C0
  7340     ELSE
  7341        IF C2 = +2
  7342           ADD +3                TO C0
  7343        END-IF
  7344     END-IF
  7345     ADD C3                      TO C0
  7346     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7347     .
  7348 0760-EXIT.
  7349     EXIT.
  7350 9700-DATE-LINK.
  7351
  7352* EXEC CICS LINK
  7353*         PROGRAM  ('ELDATCV')
  7354*         COMMAREA (DATE-CONVERSION-DATA)
  7355*         LENGTH   (DC-COMM-LENGTH)
  7356*    END-EXEC.
  7357     MOVE 'ELDATCV' TO DFHEIV1
  7358*    MOVE '."C                   (   #00006691' TO DFHEIV0
  7359     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7361     MOVE X'2020233030303036363931' TO DFHEIV0(25:11)
  7362     CALL 'kxdfhei1' USING DFHEIV0,
  7363           DFHEIV1,
  7364           DATE-CONVERSION-DATA,
  7365           DC-COMM-LENGTH,
  7366           DFHEIV99,
  7367           DFHEIV99,
  7368           DFHEIV99,
  7369           DFHEIV99
  7370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7371
  7372 9700-EXIT.
  7373      EXIT.
  7374
  7375 9999-DFHBACK SECTION.
  7376     MOVE '9%                    "   ' TO DFHEIV0
  7377     MOVE 'SOCK03' TO DFHEIV1
  7378     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7379     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:46 Page 129
* SOCK03.cbl
  7380 9999-DFHEXIT.
  7381     IF DFHEIGDJ EQUAL 0001
  7382         NEXT SENTENCE.
  7383     MOVE '9%                    "   ' TO DFHEIV0
  7384     MOVE 'SOCK03' TO DFHEIV1
  7385     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7386     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20144     Code:       30637
