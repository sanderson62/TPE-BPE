* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52******************************************************************
    53
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   3
* EL156.cbl
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
    58
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER  PIC X(32)  VALUE '********************************'.
    63 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    64 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    65 77  WS-SSN  PIC X(9) VALUE ZEROS.
    66 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    67 77  C0                          PIC S999 COMP-3 VALUE +0.
    68 77  C1                          PIC S999 COMP-3 VALUE +0.
    69 77  C2                          PIC S999 COMP-3 VALUE +0.
    70 77  C3                          PIC S999 COMP-3 VALUE +0.
    71 77  s1                          PIC S999 COMP-3 VALUE +0.
    72 77  s2                          pic s999 comp-3 value +0.
    73 77  P1                          PIC S999 COMP-3 VALUE +0.
    74 77  DD-IU-SW                    PIC X   VALUE ' '.
    75     88  DD-IU-PRESENT                 VALUE 'Y'.
    76 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    77 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    78 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    79 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    80 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    81 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    82 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    83 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    84 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    85
    86*    COPY ELCSCTM.
    87******************************************************************
    88*                                                                *
    89*                                                                *
    90*                            ELCSCTM                             *
    91*                            VMOD=2.001                          *
    92*                                                                *
    93*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-MESSAGE.
    97     12  FILLER                          PIC X(30)
    98            VALUE '** LOGIC SECURITY VIOLATION -'.
    99     12  SM-READ                         PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' PGM='.
   102     12  SM-PGM                          PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' OPR='.
   105     12  SM-PROCESSOR-ID                 PIC X(4).
   106     12  FILLER                          PIC X(6)
   107            VALUE ' TERM='.
   108     12  SM-TERMID                       PIC X(4).
   109     12  FILLER                          PIC XX   VALUE SPACE.
   110     12  SM-JUL-DATE                     PIC 9(5).
   111     12  FILLER                          PIC X    VALUE SPACE.
   112     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   4
* EL156.cbl
   113
   114
   115*    COPY ELCSCRTY.
   116******************************************************************
   117*                                                                *
   118*                                                                *
   119*                            ELCSCRTY                            *
   120*                            VMOD=2.001                          *
   121*                                                                *
   122*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   123*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   124*        SAVED IN PI-SECURITY-ADDRESS.                           *
   125*                                                                *
   126******************************************************************
   127 01  SECURITY-CONTROL.
   128     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   129     12  FILLER                       PIC XX    VALUE 'SC'.
   130     12  SC-CREDIT-CODES.
   131         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   132             20  SC-CREDIT-DISPLAY    PIC X.
   133             20  SC-CREDIT-UPDATE     PIC X.
   134     12  SC-CLAIMS-CODES.
   135         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   136             20  SC-CLAIMS-DISPLAY    PIC X.
   137             20  SC-CLAIMS-UPDATE     PIC X.
   138
   139 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   140 01  WS-DATE-AREA.
   141     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   142     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   143     12  SAVE-DATE-CCYYMMDD.
   144         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   145         16  SAVE-DATE-YMD.
   146             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   147             20  FILLER              PIC X(04)   VALUE SPACES.
   148
   149 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   150 01  STANDARD-AREAS.
   151     12  WS-RESPONSE         PIC S9(8)   COMP.
   152         88  WS-RESP-NORMAL              VALUE +00.
   153         88  WS-RESP-ERROR               VALUE +01.
   154         88  WS-RESP-NOTFND              VALUE +13.
   155         88  WS-RESP-DUPREC              VALUE +14.
   156         88  WS-RESP-ENDFILE             VALUE +20.
   157     12  PMT-HEAD-A.
   158         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   159         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   160         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   161-        '     RESERVES  TYPE    AMOUNT'.
   162     12  PMT-HEAD-B.
   163         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   164         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   165         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   166     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   167     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   168     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   169     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   170     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   5
* EL156.cbl
   171     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   172     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   173     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   174     12  PGM-NAME            PIC X(8).
   175     12  TIME-IN             PIC S9(7).
   176     12  TIME-OUT-R  REDEFINES TIME-IN.
   177         16  FILLER          PIC X.
   178         16  TIME-OUT        PIC 99V99.
   179         16  FILLER          PIC XX.
   180     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   181     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   182     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   183     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   184     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   185     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   186     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   187     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   188     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   189     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   190     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   191     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   192     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   193     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   194     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   195     12  WS-BLANK            PIC X       VALUE ' '.
   196
   197 01  MISC-WORK-AREAS.
   198     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   199     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   200     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   201     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   202     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   203     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   204     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   205     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   206     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   207     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   208     12  W-CALLED-NAME           PIC X(08).
   209     12  W-EOB-CODES.
   210         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   211             20  W-EOB-CODE      PIC XXX.
   212             20  W-EOB-FILLER    PIC X.
   213     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   214     12  W-NAME-LAST             PIC X(15).
   215     12  W-NAME-FIRST            PIC X(15).
   216     12  W-NAME-MIDDLE.
   217         16  FILLER              PIC X.
   218         16  W-NAME-MIDDLE-2     PIC X.
   219         16  FILLER              PIC X(13).
   220     12  W-DMD-CHECK-NO.
   221         16  W-DMD-CHECK-NO-1    PIC X(4).
   222         16  W-DMD-CHECK-NO-2    PIC X.
   223         16  W-DMD-CHECK-NO-3    PIC XX.
   224
   225     12  WS-COMPUTE-FROM-DT  PIC XX.
   226     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   227     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   228     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   6
* EL156.cbl
   229     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   230     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   231     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   232         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   233         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   234     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   235         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   236     12  WS-UPDATE-SW        PIC X VALUE ' '.
   237     12  WS-GROUPING.
   238         16  WS-GROUP-1      PIC X VALUE SPACES.
   239         16  FILLER          PIC X(05) VALUE SPACES.
   240     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   241     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   242     12  WS-WORK-STATE-ACCT.
   243         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   244         16  FILLER          PIC X       VALUE '/'.
   245         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   246     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   247     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   248     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   249     12  QID.
   250         16  QID-TERM        PIC X(4)    VALUE SPACES.
   251         16  FILLER          PIC X(4)    VALUE '156A'.
   252     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   253     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   254     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   255     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   256     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   257     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   258     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   259     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   260     12  WS-STATUS           PIC X       VALUE SPACES.
   261     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   262     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   263     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   264     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   265     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   266     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   267     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   268     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   269     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   270     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   271     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   272     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   273     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   274     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   275     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   276     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   277     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   278     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   279     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   280     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   281     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   282     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   283     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   284     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   285     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   286     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   7
* EL156.cbl
   287     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   288     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   289     12  WORK-DATE-FROM.
   290         16  WDF-MONTH       PIC 99        VALUE ZERO.
   291         16  WDF-DAY         PIC 99        VALUE ZERO.
   292         16  WDF-YEAR        PIC 99        VALUE ZERO.
   293     12  WORK-DATE-THRU.
   294         16  WDT-MONTH       PIC 99        VALUE ZERO.
   295         16  WDT-DAY         PIC 99        VALUE ZERO.
   296         16  WDT-YEAR        PIC 99        VALUE ZERO.
   297     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   298     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   299     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   300     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   301     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   302     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   303     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   304     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   305     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   306     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   307     12  WS-PY-WK REDEFINES WS-PY-WORK.
   308         16  WS-PY-NUM       PIC S9(7)V99.
   309         16  WS-PY-SIGN      PIC X.
   310     12  WS-DY-WORK          PIC S9(5).
   311     12  WS-DY-WK REDEFINES WS-DY-WORK.
   312         16  WS-DY-NUM       PIC S9(4).
   313         16  WS-DY-SIGN      PIC X.
   314     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   315         88  COMP-REC-FOUND              VALUE 'Y'.
   316     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   317         88  BENEFIT-FOUND       VALUE 'Y'.
   318         88  NO-BENEFIT-FOUND    VALUE 'N'.
   319     12  WS-TERMS.
   320         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   321         16  FILLER          PIC X       VALUE '/'.
   322         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   323         16  WST-REM-DAYS-GRP.
   324             20  WST-SLASH   PIC X       VALUE '/'.
   325             20  WST-REM-DAYS
   326                             PIC --9.
   327     12  WS-ACCESS.
   328         16  FILLER          PIC XX      VALUE SPACES.
   329         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   330     12  WS-STATE-ACCESS.
   331         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   332         16  FILLER          PIC XX      VALUE SPACES.
   333     12  WS-CARR-ACCESS.
   334         16  FILLER          PIC X(3)    VALUE SPACES.
   335         16  WS-CARR         PIC X       VALUE SPACES.
   336     12  DATE-WORK.
   337         16  FILLER          PIC XX      VALUE SPACES.
   338         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   339     12  WS-SAVE-INPUT.
   340         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   341         16  WS-PAYEE        PIC XX      VALUE SPACE.
   342         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   343         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   344         16  WS-OFFLINE      PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   8
* EL156.cbl
   345         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   346         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   347         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   348         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   349         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   350         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   351         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   352         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   353         16  WS-ETYPE        PIC X       VALUE SPACE.
   354         16  WS-CASH         PIC X       VALUE SPACE.
   355         16  WS-GROUPED      PIC X       VALUE SPACE.
   356         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   357         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   358         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   359         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   360         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   361         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   362         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   363         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   364     12  LAST-ERROR-LINE.
   365         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   366         16  FILLER              PIC X(30)
   367             VALUE ' FATAL ERRORS ENCOUNTERED'.
   368         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   369         16  FILLER              PIC X(28)
   370             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   371     12  WS-CHECK-AREA.
   372         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   373         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   374     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   375     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   376         16  FILLER              PIC XX.
   377         16  WS-A-CHECK-NUM-5    PIC 9(5).
   378     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   379         16  FILLER              PIC X.
   380         16  WS-A-CHECK-NUM-6    PIC 9(6).
   381     12  OPTION-1-SAVE-AREA.
   382         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   383         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   384     12  WS-WORK-ZIP.
   385         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   386         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   387     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   388                                 PIC 9(9).
   389     12  WS-FLI-PMTNOTE.
   390         16  WS-PMTOPTION        PIC XX.
   391         16  WS-DOCNAME          PIC X(28).
   392         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   393             20  WS-AMOUNT       PIC X(8).
   394             20  FILLER          PIC X(20).
   395         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   396             20  WS-NUM-AMT      PIC 9(6)V99.
   397             20  FILLER          PIC X(20).
   398
   399     12  WS-HAN-PMTNOTE.
   400         16  WS-HAN-PMT-CODE     PIC X.
   401         16  WS-HAN-PMT-NOTE     PIC X(39).
   402
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   9
* EL156.cbl
   403     12  WS-NCL-PMT-OPTION       PIC XX.
   404         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   405
   406     12  WS-CLAIM-SEQUENCE.
   407         16  FILLER              PIC X VALUE '('.
   408         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   409         16  FILLER              PIC X(04) VALUE ' OF '.
   410         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   411         16  FILLER              PIC X VALUE ')'.
   412
   413     12  WS-REFUND-AMT           PIC Z(7).99.
   414     12  WS-CALC-INT             PIC S9(7)V99.
   415     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   416
   417     12  SUB                     PIC 99 VALUE ZEROS.
   418
   419     12  WS-BOANOTE1.
   420         16  WS-BOANOTE1-DESC    PIC X(11).
   421         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   422         16  FILLER              PIC X(17).
   423     12  WS-BOANOTE2.
   424         16  WS-BOANOTE2-DESC    PIC X(11).
   425         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   426         16  FILLER              PIC X(17).
   427
   428     12  WS-NCLNOTE1.
   429         16  WS-NCLNOTE1-DESC    PIC X(11).
   430         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   431         16  FILLER              PIC X(17).
   432     12  WS-NCLNOTE2.
   433         16  WS-NCLNOTE2-DESC    PIC X(11).
   434         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   435         16  FILLER              PIC X(17).
   436
   437     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   438     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   439     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   440     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   441     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   442     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   443     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   444     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   445     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   446     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   447
   448     12  WS-AIG-WORK-AREAS.
   449         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   450             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   451         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   452             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   453         16  WS-FROM-DATE-MDY.
   454             20  WS-FROM-MO      PIC 99.
   455             20  WS-FROM-DA      PIC 99.
   456             20  WS-FROM-YR      PIC 99.
   457         16  WS-TEMP-DATE-MDY.
   458             20  WS-TEMP-MO      PIC 99.
   459             20  WS-TEMP-DA      PIC 99.
   460             20  WS-TEMP-YR      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  10
* EL156.cbl
   461         16  WS-BIN-FROM-DT      PIC XX.
   462         16  WS-TEMP-INC-MDY.
   463             20  WS-TEMP-INC-MO  PIC 99.
   464             20  WS-TEMP-INC-DA  PIC 99.
   465             20  WS-TEMP-INC-YR  PIC 99.
   466         16  WS-PMT-DUE-MDY.
   467             20  WS-PMT-DUE-MO   PIC 99.
   468             20  WS-PMT-DUE-DA   PIC 99.
   469             20  WS-PMT-DUE-YR   PIC 99.
   470         16  WS-PMT-DUE-DT       PIC XX.
   471         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   472         16  WS-RETRO-ELIM-DT    PIC XX.
   473         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   474             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   475         16  WS-SAVE-DUE-DA      PIC 99.
   476         16  WS-CDAYS            PIC S9(05).
   477         16  WS-DAYS-OFF         PIC S9(05).
   478         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   479             88  ELIM-SATISFIED            VALUE 'Y'.
   480         16  WS-AIG-CHECKNO.
   481             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   482             20  WS-A-CHECKNO-3-7.
   483                 24  FILLER              PIC X(3)    VALUE SPACES.
   484                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   485                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   486         16  WS-AIG-GROUPING.
   487             20  WS-A-BENE               PIC XXX.
   488             20  FILLER                  PIC XXX.
   489         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   490             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   491             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   492         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   493                 VALUE 'UNEMPLOYMENT PAYMENT'.
   494         16  WS-CHK-THRU-DT              PIC XX.
   495         16  WS-HOLD-BIN-DATE-1          PIC XX.
   496
   497 01  MISC-CSO-AREA.
   498     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   499     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   500     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   501         88  APPROVAL-NEEDED                        VALUE 'Y'.
   502     12  WS-APPROV-NOTE                  PIC X(43)
   503         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   504     12  WS-REAUDIT-NOTE                 PIC X(43)
   505         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   506     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   507     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   508     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   509     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   510     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   511     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   512     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   513         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   514     12  WS-PAYEE-CITY-STATE     PIC X(30).
   515     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   516         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   517     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   518     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  11
* EL156.cbl
   519     12  WS-WORK-NAME            PIC X(30).
   520     12  FILLER  REDEFINES WS-WORK-NAME.
   521         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   522     12  WS-INSURED-NAME         PIC X(30).
   523     12  FILLER  REDEFINES WS-INSURED-NAME.
   524         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   525     12  WS-PAYEE-NAME           PIC X(30).
   526     12  FILLER  REDEFINES WS-PAYEE-NAME.
   527         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   528
   529 01  ERROR-MESSAGES.
   530     12  ER-0000                 PIC X(4)  VALUE '0000'.
   531     12  ER-0004                 PIC X(4)  VALUE '0004'.
   532     12  ER-0008                 PIC X(4)  VALUE '0008'.
   533     12  ER-0019                 PIC X(4)  VALUE '0019'.
   534     12  ER-0029                 PIC X(4)  VALUE '0029'.
   535     12  ER-0042                 PIC X(4)  VALUE '0042'.
   536     12  ER-0070                 PIC X(4)  VALUE '0070'.
   537     12  ER-0130                 PIC X(4)  VALUE '0130'.
   538     12  ER-0149                 PIC X(4)  VALUE '0149'.
   539     12  ER-0154                 PIC X(4)  VALUE '0154'.
   540     12  ER-0168                 PIC X(4)  VALUE '0168'.
   541     12  ER-0169                 PIC X(4)  VALUE '0169'.
   542     12  ER-0172                 PIC X(4)  VALUE '0174'.
   543     12  ER-0198                 PIC X(4)  VALUE '0198'.
   544     12  ER-0204                 PIC X(4)  VALUE '0204'.
   545     12  ER-0206                 PIC X(4)  VALUE '0206'.
   546     12  ER-0252                 PIC X(4)  VALUE '0252'.
   547     12  ER-0254                 PIC X(4)  VALUE '0254'.
   548     12  ER-0282                 PIC X(4)  VALUE '0282'.
   549     12  ER-0283                 PIC X(4)  VALUE '0283'.
   550     12  ER-0294                 PIC X(4)  VALUE '0294'.
   551     12  ER-0338                 PIC X(4)  VALUE '0338'.
   552     12  ER-0419                 PIC X(4)  VALUE '0419'.
   553     12  ER-0420                 PIC X(4)  VALUE '0420'.
   554     12  ER-0421                 PIC X(4)  VALUE '0421'.
   555     12  ER-0422                 PIC X(4)  VALUE '0422'.
   556     12  ER-0433                 PIC X(4)  VALUE '0433'.
   557     12  ER-0436                 PIC X(4)  VALUE '0436'.
   558     12  ER-0437                 PIC X(4)  VALUE '0437'.
   559     12  ER-0438                 PIC X(4)  VALUE '0438'.
   560     12  ER-0439                 PIC X(4)  VALUE '0439'.
   561     12  ER-0440                 PIC X(4)  VALUE '0440'.
   562     12  ER-0441                 PIC X(4)  VALUE '0441'.
   563     12  ER-0442                 PIC X(4)  VALUE '0442'.
   564     12  ER-0443                 PIC X(4)  VALUE '0443'.
   565     12  ER-0444                 PIC X(4)  VALUE '0444'.
   566     12  ER-0445                 PIC X(4)  VALUE '0445'.
   567     12  ER-0446                 PIC X(4)  VALUE '0446'.
   568     12  ER-0447                 PIC X(4)  VALUE '0447'.
   569     12  ER-0448                 PIC X(4)  VALUE '0448'.
   570     12  ER-0449                 PIC X(4)  VALUE '0449'.
   571     12  ER-0452                 PIC X(4)  VALUE '0452'.
   572     12  ER-0458                 PIC X(4)  VALUE '0458'.
   573     12  ER-0459                 PIC X(4)  VALUE '0459'.
   574     12  ER-0460                 PIC X(4)  VALUE '0460'.
   575     12  ER-0461                 PIC X(4)  VALUE '0461'.
   576     12  ER-0462                 PIC X(4)  VALUE '0462'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  12
* EL156.cbl
   577     12  ER-0463                 PIC X(4)  VALUE '0463'.
   578     12  ER-0464                 PIC X(4)  VALUE '0464'.
   579     12  ER-0465                 PIC X(4)  VALUE '0465'.
   580     12  ER-0466                 PIC X(4)  VALUE '0466'.
   581     12  ER-0467                 PIC X(4)  VALUE '0467'.
   582     12  ER-0468                 PIC X(4)  VALUE '0468'.
   583     12  ER-0469                 PIC X(4)  VALUE '0469'.
   584     12  ER-0473                 PIC X(4)  VALUE '0473'.
   585     12  ER-0474                 PIC X(4)  VALUE '0474'.
   586     12  ER-0475                 PIC X(4)  VALUE '0475'.
   587     12  ER-0476                 PIC X(4)  VALUE '0476'.
   588     12  ER-0477                 PIC X(4)  VALUE '0477'.
   589     12  ER-0478                 PIC X(4)  VALUE '0478'.
   590     12  ER-0479                 PIC X(4)  VALUE '0479'.
   591     12  ER-0481                 PIC X(4)  VALUE '0481'.
   592     12  ER-0491                 PIC X(4)  VALUE '0491'.
   593     12  ER-0492                 PIC X(4)  VALUE '0492'.
   594     12  ER-0493                 PIC X(4)  VALUE '0493'.
   595     12  ER-0494                 PIC X(4)  VALUE '0494'.
   596     12  ER-0495                 PIC X(4)  VALUE '0495'.
   597     12  ER-0499                 PIC X(4)  VALUE '0499'.
   598     12  ER-0500                 PIC X(4)  VALUE '0500'.
   599     12  ER-0501                 PIC X(4)  VALUE '0501'.
   600     12  ER-0502                 PIC X(4)  VALUE '0502'.
   601     12  ER-0508                 PIC X(4)  VALUE '0508'.
   602     12  ER-0513                 PIC X(4)  VALUE '0513'.
   603     12  ER-0518                 PIC X(4)  VALUE '0518'.
   604     12  ER-0524                 PIC X(4)  VALUE '0524'.
   605     12  ER-0525                 PIC X(4)  VALUE '0525'.
   606     12  ER-0526                 PIC X(4)  VALUE '0526'.
   607     12  ER-0530                 PIC X(4)  VALUE '0530'.
   608     12  ER-0540                 PIC X(4)  VALUE '0540'.
   609     12  ER-0541                 PIC X(4)  VALUE '0541'.
   610     12  ER-0542                 PIC X(4)  VALUE '0542'.
   611     12  ER-0543                 PIC X(4)  VALUE '0543'.
   612     12  ER-0545                 PIC X(4)  VALUE '0545'.
   613     12  ER-0552                 PIC X(4)  VALUE '0552'.
   614     12  ER-0555                 PIC X(4)  VALUE '0555'.
   615     12  ER-0556                 PIC X(4)  VALUE '0556'.
   616     12  ER-0557                 PIC X(4)  VALUE '0557'.
   617     12  ER-0572                 PIC X(4)  VALUE '0572'.
   618     12  ER-0573                 PIC X(4)  VALUE '0573'.
   619     12  ER-0594                 PIC X(4)  VALUE '0594'.
   620     12  ER-0616                 PIC X(4)  VALUE '0616'.
   621     12  ER-0617                 PIC X(4)  VALUE '0617'.
   622     12  ER-0618                 PIC X(4)  VALUE '0618'.
   623     12  ER-0657                 PIC X(4)  VALUE '0657'.
   624     12  ER-0658                 PIC X(4)  VALUE '0658'.
   625     12  ER-0699                 PIC X(4)  VALUE '0699'.
   626     12  ER-0730                 PIC X(4)  VALUE '0730'.
   627     12  ER-0737                 PIC X(4)  VALUE '0737'.
   628     12  ER-0760                 PIC X(4)  VALUE '0760'.
   629     12  ER-0768                 PIC X(4)  VALUE '0768'.
   630     12  ER-0769                 PIC X(4)  VALUE '0769'.
   631     12  ER-0770                 PIC X(4)  VALUE '0770'.
   632     12  ER-0802                 PIC X(4)  VALUE '0802'.
   633     12  ER-0803                 PIC X(4)  VALUE '0803'.
   634     12  ER-0819                 PIC X(4)  VALUE '0819'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  13
* EL156.cbl
   635     12  ER-0834                 PIC X(4)  VALUE '0834'.
   636     12  ER-0836                 PIC X(4)  VALUE '0836'.
   637     12  ER-0844                 PIC X(4)  VALUE '0844'.
   638     12  ER-0845                 PIC X(4)  VALUE '0845'.
   639     12  ER-0846                 PIC X(4)  VALUE '0846'.
   640     12  ER-0849                 PIC X(4)  VALUE '0849'.
   641     12  ER-0851                 PIC X(4)  VALUE '0851'.
   642     12  ER-0872                 PIC X(4)  VALUE '0872'.
   643     12  ER-0873                 PIC X(4)  VALUE '0873'.
   644     12  ER-0874                 PIC X(4)  VALUE '0874'.
   645     12  ER-0879                 PIC X(4)  VALUE '0879'.
   646     12  ER-0919                 PIC X(4)  VALUE '0919'.
   647     12  ER-0921                 PIC X(4)  VALUE '0921'.
   648     12  ER-0923                 PIC X(4)  VALUE '0923'.
   649     12  ER-0925                 PIC X(4)  VALUE '0925'.
   650     12  ER-0944                 PIC X(4)  VALUE '0944'.
   651     12  ER-0945                 PIC X(4)  VALUE '0945'.
   652     12  ER-0946                 PIC X(4)  VALUE '0946'.
   653     12  ER-0947                 PIC X(4)  VALUE '0947'.
   654     12  ER-0948                 PIC X(4)  VALUE '0948'.
   655     12  ER-0949                 PIC X(4)  VALUE '0949'.
   656     12  ER-0950                 PIC X(4)  VALUE '0950'.
   657     12  ER-0951                 PIC X(4)  VALUE '0951'.
   658     12  ER-0954                 PIC X(4)  VALUE '0954'.
   659     12  ER-0956                 PIC X(4)  VALUE '0956'.
   660     12  ER-0967                 PIC X(4)  VALUE '0967'.
   661     12  ER-0968                 PIC X(4)  VALUE '0968'.
   662     12  ER-0974                 PIC X(4)  VALUE '0974'.
   663     12  ER-0975                 PIC X(4)  VALUE '0975'.
   664     12  ER-1561                 PIC X(4)  VALUE '1561'.
   665     12  ER-1566                 PIC X(4)  VALUE '1566'.
   666     12  ER-1567                 PIC X(4)  VALUE '1567'.
   667     12  ER-1569                 PIC X(4)  VALUE '1569'.
   668     12  er-1657                 pic x(4)  value '1657'.
   669     12  er-1658                 pic x(4)  value '1658'.
   670     12  ER-1775                 PIC X(4)  VALUE '1775'.
   671     12  ER-1880                 PIC X(4)  VALUE '1880'.
   672     12  ER-2044                 PIC X(4)  VALUE '2044'.
   673     12  ER-3140                 PIC X(4)  VALUE '3140'.
   674     12  ER-3141                 PIC X(4)  VALUE '3141'.
   675     12  ER-3255                 PIC X(4)  VALUE '3255'.
   676     12  ER-3516                 PIC X(4)  VALUE '3516'.
   677     12  ER-3527                 PIC X(4)  VALUE '3527'.
   678     12  ER-3528                 PIC X(4)  VALUE '3528'.
   679     12  ER-3529                 PIC X(4)  VALUE '3529'.
   680     12  ER-3530                 PIC X(4)  VALUE '3530'.
   681     12  ER-3531                 PIC X(4)  VALUE '3531'.
   682     12  ER-3532                 PIC X(4)  VALUE '3532'.
   683     12  ER-3533                 PIC X(4)  VALUE '3533'.
   684     12  ER-3534                 PIC X(4)  VALUE '3534'.
   685     12  ER-3535                 PIC X(4)  VALUE '3535'.
   686     12  ER-3536                 PIC X(4)  VALUE '3536'.
   687     12  ER-3537                 PIC X(4)  VALUE '3537'.
   688     12  ER-3538                 PIC X(4)  VALUE '3538'.
   689     12  ER-3539                 PIC X(4)  VALUE '3539'.
   690     12  ER-3540                 PIC X(4)  VALUE '3540'.
   691     12  ER-3541                 PIC X(4)  VALUE '3541'.
   692     12  ER-3542                 PIC X(4)  VALUE '3542'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  14
* EL156.cbl
   693     12  ER-3543                 PIC X(4)  VALUE '3543'.
   694     12  ER-3546                 PIC X(4)  VALUE '3546'.
   695     12  ER-3549                 PIC X(4)  VALUE '3549'.
   696     12  ER-3818                 PIC X(4)  VALUE '3818'.
   697     12  ER-7540                 PIC X(4)  VALUE '7540'.
   698     12  ER-7576                 PIC X(4)  VALUE '7576'.
   699     12  ER-7579                 PIC X(4)  VALUE '7579'.
   700     12  ER-7580                 PIC X(4)  VALUE '7580'.
   701     12  ER-7583                 PIC X(4)  VALUE '7583'.
   702     12  ER-7830                 PIC X(4)  VALUE '7830'.
   703     12  ER-7831                 PIC X(4)  VALUE '7831'.
   704     12  ER-7832                 PIC X(4)  VALUE '7832'.
   705     12  ER-7833                 PIC X(4)  VALUE '7833'.
   706     12  ER-7834                 PIC X(4)  VALUE '7834'.
   707     12  ER-7835                 PIC X(4)  VALUE '7835'.
   708     12  ER-7836                 PIC X(4)  VALUE '7836'.
   709     12  ER-7837                 PIC X(4)  VALUE '7837'.
   710     12  ER-7838                 PIC X(4)  VALUE '7838'.
   711     12  ER-7841                 PIC X(4)  VALUE '7841'.
   712     12  ER-7844                 PIC X(4)  VALUE '7844'.
   713     12  ER-7845                 PIC X(4)  VALUE '7845'.
   714     12  ER-8000                 PIC X(4)  VALUE '8000'.
   715     12  ER-8051                 PIC X(4)  VALUE '8051'.
   716     12  ER-8052                 PIC X(4)  VALUE '8052'.
   717     12  ER-8053                 PIC X(4)  VALUE '8053'.
   718     12  ER-8054                 PIC X(4)  VALUE '8054'.
   719     12  ER-8055                 PIC X(4)  VALUE '8055'.
   720     12  ER-8056                 PIC X(4)  VALUE '8056'.
   721     12  ER-8057                 PIC X(4)  VALUE '8057'.
   722     12  ER-8058                 PIC X(4)  VALUE '8058'.
   723     12  ER-8059                 PIC X(4)  VALUE '8059'.
   724     12  ER-8060                 PIC X(4)  VALUE '8060'.
   725     12  ER-8061                 PIC X(4)  VALUE '8061'.
   726     12  ER-8062                 PIC X(4)  VALUE '8062'.
   727     12  ER-8063                 PIC X(4)  VALUE '8063'.
   728     12  ER-8064                 PIC X(4)  VALUE '8064'.
   729     12  ER-8065                 PIC X(4)  VALUE '8065'.
   730     12  ER-8066                 PIC X(4)  VALUE '8066'.
   731     12  ER-8146                 PIC X(4)  VALUE '8146'.
   732     12  ER-8147                 PIC X(4)  VALUE '8147'.
   733     12  ER-8152                 PIC X(4)  VALUE '8152'.
   734     12  ER-8153                 PIC X(4)  VALUE '8153'.
   735     12  ER-8154                 PIC X(4)  VALUE '8154'.
   736     12  ER-8155                 PIC X(4)  VALUE '8155'.
   737     12  ER-8310                 PIC X(4)  VALUE '8310'.
   738     12  ER-8311                 PIC X(4)  VALUE '8311'.
   739     12  ER-8312                 PIC X(4)  VALUE '8312'.
   740     12  ER-8313                 PIC X(4)  VALUE '8313'.
   741     12  ER-8314                 PIC X(4)  VALUE '8314'.
   742     12  ER-8315                 PIC X(4)  VALUE '8315'.
   743     12  ER-8316                 PIC X(4)  VALUE '8316'.
   744     12  ER-8317                 PIC X(4)  VALUE '8317'.
   745
   746 01  CSO-WORK-FIELDS.
   747     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   748       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   749
   750     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  15
* EL156.cbl
   751     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   752         88  CERT-NOTE-ADDED           VALUE 'Y'.
   753     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   754         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   755     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   756
   757     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   758
   759 01  SC-NP6-CERT-NOTE.
   760     12  FILLER                  PIC X(12)
   761               VALUE 'REM BENEFIT '.
   762     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   763     12  SC-NP6-COMM             PIC X(8)
   764               VALUE ' + 6 MO '.
   765     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   766     12  FILLER                  PIC X(12)
   767               VALUE ' = AMT PAID '.
   768     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   769
   770 01  SC-NP6-ORIG-NOTE.
   771     12  FILLER                  PIC X(63)  VALUE
   772         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   773 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   774     88  PDEF-FOUND                   VALUE 'Y'.
   775 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   776     88  ACCT-FOUND                   VALUE 'Y'.
   777 01  CTBL-KEY-SAVE               PIC X(5).
   778 01  CTBL-KEY.
   779     05  CTBL-COMPANY-CD         PIC X.
   780     05  CTBL-TABLE              PIC XXX.
   781     05  CTBL-BEN-TYPE           PIC X.
   782     05  CTBL-BEN-CODE           PIC XX.
   783 01  ERPDEF-KEY-SAVE             PIC X(18).
   784 01  ERPDEF-KEY.
   785     12  ERPDEF-COMPANY-CD       PIC X.
   786     12  ERPDEF-STATE            PIC XX.
   787     12  ERPDEF-PROD-CD          PIC XXX.
   788     12  F                       PIC X(7).
   789     12  ERPDEF-BEN-TYPE         PIC X.
   790     12  ERPDEF-BEN-CODE         PIC XX.
   791     12  ERPDEF-EXP-DT           PIC XX.
   792 01  ELCRTT-KEY.
   793     05  CTRLR-COMP-CD       PIC X.
   794     05  CTRLR-CARRIER       PIC X.
   795     05  CTRLR-GROUPING      PIC X(6).
   796     05  CTRLR-STATE         PIC X(2).
   797     05  CTRLR-ACCOUNT       PIC X(10).
   798     05  CTRLR-EFF-DT        PIC XX.
   799     05  CTRLR-CERT-NO       PIC X(11).
   800     05  CTRLR-REC-TYPE      PIC X.
   801 01  ACCESS-KEYS.
   802     12  ELARCH-KEY.
   803         16  ARCH-CO             PIC X.
   804         16  ARCH-NUMBER         PIC S9(08) COMP.
   805         16  ARCH-REC-TYPE       PIC X.
   806         16  ARCH-SEQ            PIC S9(04) COMP.
   807     12  ELMSTR-KEY.
   808         16  MSTR-COMP-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  16
* EL156.cbl
   809         16  MSTR-CARRIER        PIC X.
   810         16  MSTR-CLAIM-NO       PIC X(7).
   811         16  MSTR-CERT-NO        PIC X(11).
   812     12  ELCNTL-KEY.
   813         16  CNTL-COMP-ID        PIC X(3).
   814         16  CNTL-REC-TYPE       PIC X.
   815         16  CNTL-ACCESS         PIC X(4).
   816         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   817     12  ELCERT-KEY.
   818         16  CERT-COMP-CD        PIC X.
   819         16  CERT-CARRIER        PIC X.
   820         16  CERT-GROUPING       PIC X(6).
   821         16  CERT-STATE          PIC XX.
   822         16  CERT-ACCOUNT        PIC X(10).
   823         16  CERT-EFF-DT         PIC XX.
   824         16  CERT-CERT-NO        PIC X(11).
   825     12  ELTRLR-KEY.
   826         16  TRLR-COMP-CD        PIC X.
   827         16  TRLR-CARRIER        PIC X.
   828         16  TRLR-CLAIM-NO       PIC X(7).
   829         16  TRLR-CERT-NO        PIC X(11).
   830         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   831     12  ELACTQ-KEY.
   832         16  ACTQ-COMP-CD        PIC X.
   833         16  ACTQ-CARRIER        PIC X.
   834         16  ACTQ-CLAIM-NO       PIC X(7).
   835         16  ACTQ-CERT-NO        PIC X(11).
   836     12  W-NOTE-KEY.
   837         16  W-NOTE-COMP-CD      PIC X.
   838         16  W-NOTE-CERT-KEY.
   839             20  W-NOTE-CARRIER  PIC X.
   840             20  W-NOTE-GROUPING PIC X(6).
   841             20  W-NOTE-STATE    PIC XX.
   842             20  W-NOTE-ACCOUNT  PIC X(10).
   843             20  W-NOTE-EFF-DT   PIC XX.
   844             20  W-NOTE-CERT-NO  PIC X(11).
   845     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   846     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   847     12  ERACCT-KEY.
   848         16  ERACCT-PARTIAL-KEY.
   849             20  ACCT-COMP-CD    PIC X.
   850             20  ACCT-CARRIER    PIC X.
   851             20  ACCT-GROUPING   PIC X(6).
   852             20  ACCT-STATE      PIC XX.
   853             20  ACCT-ACCOUNT    PIC X(10).
   854         16  ACCT-EXP-DT         PIC XX.
   855         16  FILLER              PIC X(4) VALUE SPACES.
   856     12  ELCHKQ-KEY.
   857         16  CHKQ-COMP-CD        PIC X.
   858         16  CHKQ-CONTROL        PIC S9(8) COMP.
   859         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   860     12  ELBENE-KEY.
   861         16  BENE-COMP-CD         PIC X.
   862         16  BENE-RECORD-TYPE     PIC X.
   863         16  BENE-NUMBER          PIC X(10).
   864     12  ERCOMP-KEY.
   865         16  COMP-COMP-CD        PIC X.
   866         16  COMP-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  17
* EL156.cbl
   867         16  COMP-GROUP          PIC X(06).
   868         16  COMP-FIN-RESP       PIC X(10).
   869         16  COMP-ACCOUNT        PIC X(10).
   870         16  COMP-TYPE           PIC X.
   871
   872     12  DLO035-KEY.
   873         16  DL35-PROCESS-TYPE   PIC X.
   874         16  DL35-CREDIT-CARD    PIC X(20).
   875         16  DL35-BEN-TYPE       PIC XX.
   876         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   877         16  DL35-RETURN-CODE    PIC XX.
   878
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  18
* EL156.cbl
   880*    COPY ELCDATE.
   881******************************************************************
   882*                                                                *
   883*                                                                *
   884*                            ELCDATE.                            *
   885*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   886*                            VMOD=2.003
   887*                                                                *
   888*                                                                *
   889*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   890*                 LENGTH = 200                                   *
   891******************************************************************
   892
   893 01  DATE-CONVERSION-DATA.
   894     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   895     12  DC-OPTION-CODE                PIC X.
   896         88  BIN-TO-GREG                VALUE ' '.
   897         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   898         88  EDIT-GREG-TO-BIN           VALUE '2'.
   899         88  YMD-GREG-TO-BIN            VALUE '3'.
   900         88  MDY-GREG-TO-BIN            VALUE '4'.
   901         88  JULIAN-TO-BIN              VALUE '5'.
   902         88  BIN-PLUS-ELAPSED           VALUE '6'.
   903         88  FIND-CENTURY               VALUE '7'.
   904         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   905         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   906         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   907         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   908         88  JULIAN-TO-BIN-3            VALUE 'C'.
   909         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   910         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   911         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   912         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   913         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   914         88  CHECK-LEAP-YEAR            VALUE 'H'.
   915         88  BIN-3-TO-GREG              VALUE 'I'.
   916         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   917         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   918         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   919         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   920         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   921         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   922         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   923         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   924         88  THREE-CHARACTER-BIN
   925                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   926         88  GREGORIAN-TO-BIN
   927                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   928         88  BIN-TO-GREGORIAN
   929                  VALUES ' ' '1' 'I' '8' 'G'.
   930         88  JULIAN-TO-BINARY
   931                  VALUES '5' 'C' 'E' 'F'.
   932     12  DC-ERROR-CODE                 PIC X.
   933         88  NO-CONVERSION-ERROR        VALUE ' '.
   934         88  DATE-CONVERSION-ERROR
   935                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   936         88  DATE-IS-ZERO               VALUE '1'.
   937         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  19
* EL156.cbl
   938         88  DATE-IS-INVALID            VALUE '3'.
   939         88  DATE1-GREATER-DATE2        VALUE '4'.
   940         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   941         88  DATE-INVALID-OPTION        VALUE '9'.
   942         88  INVALID-CENTURY            VALUE 'A'.
   943         88  ONLY-CENTURY               VALUE 'B'.
   944         88  ONLY-LEAP-YEAR             VALUE 'C'.
   945         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   946     12  DC-END-OF-MONTH               PIC X.
   947         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   948     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   949         88  USE-NORMAL-PROCESS         VALUE ' '.
   950         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   951         88  ADJUST-UP-100-YRS          VALUE '2'.
   952     12  FILLER                        PIC X.
   953     12  DC-CONVERSION-DATES.
   954         16  DC-BIN-DATE-1             PIC XX.
   955         16  DC-BIN-DATE-2             PIC XX.
   956         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   957         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   958                       DC-GREG-DATE-1-EDIT.
   959             20  DC-EDIT1-MONTH        PIC 99.
   960             20  SLASH1-1              PIC X.
   961             20  DC-EDIT1-DAY          PIC 99.
   962             20  SLASH1-2              PIC X.
   963             20  DC-EDIT1-YEAR         PIC 99.
   964         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   965         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   966                     DC-GREG-DATE-2-EDIT.
   967             20  DC-EDIT2-MONTH        PIC 99.
   968             20  SLASH2-1              PIC X.
   969             20  DC-EDIT2-DAY          PIC 99.
   970             20  SLASH2-2              PIC X.
   971             20  DC-EDIT2-YEAR         PIC 99.
   972         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   973         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   974                     DC-GREG-DATE-1-YMD.
   975             20  DC-YMD-YEAR           PIC 99.
   976             20  DC-YMD-MONTH          PIC 99.
   977             20  DC-YMD-DAY            PIC 99.
   978         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   979         16  DC-GREG-DATE-1-MDY-R REDEFINES
   980                      DC-GREG-DATE-1-MDY.
   981             20  DC-MDY-MONTH          PIC 99.
   982             20  DC-MDY-DAY            PIC 99.
   983             20  DC-MDY-YEAR           PIC 99.
   984         16  DC-GREG-DATE-1-ALPHA.
   985             20  DC-ALPHA-MONTH        PIC X(10).
   986             20  DC-ALPHA-DAY          PIC 99.
   987             20  FILLER                PIC XX.
   988             20  DC-ALPHA-CENTURY.
   989                 24 DC-ALPHA-CEN-N     PIC 99.
   990             20  DC-ALPHA-YEAR         PIC 99.
   991         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   992         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   993         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   994         16  DC-JULIAN-DATE            PIC 9(05).
   995         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  20
* EL156.cbl
   996                                       PIC 9(05).
   997         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   998             20  DC-JULIAN-YEAR        PIC 99.
   999             20  DC-JULIAN-DAYS        PIC 999.
  1000         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1001         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1002         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1003     12  DATE-CONVERSION-VARIBLES.
  1004         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1005         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1006             20  FILLER                PIC 9(3).
  1007             20  HOLD-CEN-1-CCYY.
  1008                 24  HOLD-CEN-1-CC     PIC 99.
  1009                 24  HOLD-CEN-1-YY     PIC 99.
  1010             20  HOLD-CEN-1-MO         PIC 99.
  1011             20  HOLD-CEN-1-DA         PIC 99.
  1012         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1013             20  HOLD-CEN-1-R-MO       PIC 99.
  1014             20  HOLD-CEN-1-R-DA       PIC 99.
  1015             20  HOLD-CEN-1-R-CCYY.
  1016                 24  HOLD-CEN-1-R-CC   PIC 99.
  1017                 24  HOLD-CEN-1-R-YY   PIC 99.
  1018             20  FILLER                PIC 9(3).
  1019         16  HOLD-CENTURY-1-X.
  1020             20  FILLER                PIC X(3)  VALUE SPACES.
  1021             20  HOLD-CEN-1-X-CCYY.
  1022                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1023                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1024             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1025             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1026         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1027             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1028             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1029             20  HOLD-CEN-1-R-X-CCYY.
  1030                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1031                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1032             20  FILLER                PIC XXX.
  1033         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1034         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1035         16  DC-JULIAN-DATE-1          PIC 9(07).
  1036         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1037             20  DC-JULIAN-1-CCYY.
  1038                 24  DC-JULIAN-1-CC    PIC 99.
  1039                 24  DC-JULIAN-1-YR    PIC 99.
  1040             20  DC-JULIAN-DA-1        PIC 999.
  1041         16  DC-JULIAN-DATE-2          PIC 9(07).
  1042         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1043             20  DC-JULIAN-2-CCYY.
  1044                 24  DC-JULIAN-2-CC    PIC 99.
  1045                 24  DC-JULIAN-2-YR    PIC 99.
  1046             20  DC-JULIAN-DA-2        PIC 999.
  1047         16  DC-GREG-DATE-A-EDIT.
  1048             20  DC-EDITA-MONTH        PIC 99.
  1049             20  SLASHA-1              PIC X VALUE '/'.
  1050             20  DC-EDITA-DAY          PIC 99.
  1051             20  SLASHA-2              PIC X VALUE '/'.
  1052             20  DC-EDITA-CCYY.
  1053                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  21
* EL156.cbl
  1054                 24  DC-EDITA-YEAR     PIC 99.
  1055         16  DC-GREG-DATE-B-EDIT.
  1056             20  DC-EDITB-MONTH        PIC 99.
  1057             20  SLASHB-1              PIC X VALUE '/'.
  1058             20  DC-EDITB-DAY          PIC 99.
  1059             20  SLASHB-2              PIC X VALUE '/'.
  1060             20  DC-EDITB-CCYY.
  1061                 24  DC-EDITB-CENT     PIC 99.
  1062                 24  DC-EDITB-YEAR     PIC 99.
  1063         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1064         16  DC-GREG-DATE-CYMD-R REDEFINES
  1065                              DC-GREG-DATE-CYMD.
  1066             20  DC-CYMD-CEN           PIC 99.
  1067             20  DC-CYMD-YEAR          PIC 99.
  1068             20  DC-CYMD-MONTH         PIC 99.
  1069             20  DC-CYMD-DAY           PIC 99.
  1070         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1071         16  DC-GREG-DATE-MDCY-R REDEFINES
  1072                              DC-GREG-DATE-MDCY.
  1073             20  DC-MDCY-MONTH         PIC 99.
  1074             20  DC-MDCY-DAY           PIC 99.
  1075             20  DC-MDCY-CEN           PIC 99.
  1076             20  DC-MDCY-YEAR          PIC 99.
  1077    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1078        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1079    12  DC-EL310-DATE                  PIC X(21).
  1080    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  22
* EL156.cbl
  1082*    COPY ELCLOGOF.
  1083******************************************************************
  1084*                                                                *
  1085*                                                                *
  1086*                            ELCLOGOF.                           *
  1087*                            VMOD=2.001                          *
  1088*                                                                *
  1089*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1090*                                                                *
  1091******************************************************************
  1092 01  CLASIC-LOGOFF.
  1093     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1094     12  LOGOFF-TEXT.
  1095         16  FILLER          PIC X(5)    VALUE SPACES.
  1096         16  LOGOFF-MSG.
  1097             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1098             20  FILLER      PIC X       VALUE SPACES.
  1099             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1100         16  FILLER          PIC X(80)
  1101           VALUE '* YOU ARE NOW LOGGED OFF'.
  1102         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1103         16  FILLER          PIC X       VALUE QUOTE.
  1104         16  LOGOFF-SYS-MSG  PIC X(17)
  1105           VALUE 'S CLAS-IC SYSTEM '.
  1106     12  TEXT-MESSAGES.
  1107         16  UNACCESS-MSG    PIC X(29)
  1108             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1109         16  PGMIDERR-MSG    PIC X(17)
  1110             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  23
* EL156.cbl
  1112*    COPY ELCCALC.
  1113******************************************************************
  1114*                                                                *
  1115*                           ELCCALC.                            *
  1116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1117*                            VMOD=2.025                          *
  1118*                                                                *
  1119*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1120*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1121*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1122*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1123*                                                                *
  1124*  PASSED TO ELRTRM                                              *
  1125*  -----------------                                             *
  1126*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1127*  ORIGINAL TERM                                                 *
  1128*  BEGINNING DATE                                                *
  1129*  ENDING DATE                                                   *
  1130*  COMPANY I.D.                                                  *
  1131*  ACCOUNT MASTER USER FIELD                                     *
  1132*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1133*  FREE LOOK DAYS                                                *
  1134*                                                                *
  1135*  RETURNED FROM ELRTRM                                          *
  1136*  ---------------------                                         *
  1137*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1138*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1139*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1140*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1141*----------------------------------------------------------------*
  1142*  PASSED TO ELRAMT                                              *
  1143*  ----------------                                              *
  1144*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1145*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1146*  ORIGINAL AMOUNT                                               *
  1147*  ALTERNATE BENEFIT (BALLON)                                    *
  1148*  A.P.R. - NET PAY ONLY                                         *
  1149*  METHOD
  1150*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1151*  COMPANY I.D.                                                  *
  1152*  BENEFIT TYPE                                                  *
  1153*                                                                *
  1154*  RETURNED FROM ELRAMT                                          *
  1155*  --------------------                                          *
  1156*  REMAINING AMOUNT 1 - CURRENT                                  *
  1157*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1158*  REMAINING AMOUNT FACTOR
  1159*----------------------------------------------------------------*
  1160*  PASSED TO ELRESV                                              *
  1161*  -----------------                                             *
  1162*  CERTIFICATE EFFECTIVE DATE                                    *
  1163*  VALUATION DATE                                                *
  1164*  PAID THRU DATE                                                *
  1165*  BENEFIT                                                       *
  1166*  INCURRED DATE                                                 *
  1167*  REPORTED DATE                                                 *
  1168*  ISSUE AGE                                                     *
  1169*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  24
* EL156.cbl
  1170*  CDT PERCENT                                                   *
  1171*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1172* *CLAIM TYPE (LIFE, A/H)                                        *
  1173* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1174* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1175*                                                                *
  1176*  RETURNED FROM ELRESV                                          *
  1177*  --------------------                                          *
  1178*  CDT TABLE USED                                                *
  1179*  CDT FACTOR USED                                               *
  1180*  PAY TO CURRENT RESERVE                                        *
  1181*  I.B.N.R. - A/H ONLY                                           *
  1182*  FUTURE (ACCRUED) AH ONLY                                      *
  1183*----------------------------------------------------------------*
  1184*  PASSED TO ELRATE                                              *
  1185*  ----------------                                              *
  1186*  CERT ISSUE DATE                                               *
  1187*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1188*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1189*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1190*  STATE CODE (CLIENT DEFINED)                                   *
  1191*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1192*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1193*  DEVIATION CODE                                                *
  1194*  ISSUE AGE                                                     *
  1195*  ORIGINAL BENEFIT AMOUNT                                       *
  1196*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1197*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1198*  BENEFIT KIND (LIFE OR A/H)                                    *
  1199*  A.P.R.                                                        *
  1200*  METHOD
  1201*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1202*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1203*  COMPANY I.D. (3 CHARACTER)                                    *
  1204*  BENEFIT CODE                                                  *
  1205*  BENEFIT OVERRIDE CODE                                         *
  1206*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1207*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1208*  JOINT INDICATOR (CSL ONLY)                                    *
  1209*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1210*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1211*                                                                *
  1212*  RETURNED FROM ELRATE                                          *
  1213*  --------------------                                          *
  1214*  CALCULATED PREMIUM                                            *
  1215*  PREMIUM RATE                                                  *
  1216*  MORTALITY CODE                                                *
  1217*  MAX ATTAINED AGE                                              *
  1218*  MAX AGE                                                       *
  1219*  MAX TERM                                                      *
  1220*  MAX MONTHLY BENEFIT                                           *
  1221*  MAX TOTAL BENIFIT                                             *
  1222*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1223*----------------------------------------------------------------*
  1224*  PASSED TO ELRFND                                              *
  1225*  ----------------                                              *
  1226*  CERT ISSUE DATE                                               *
  1227*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  25
* EL156.cbl
  1228*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1229*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1230*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1231*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1232*  STATE CODE (CLIENT DEFINED)                                   *
  1233*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1234*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1235*  DEVIATION CODE                                                *
  1236*  ISSUE AGE                                                     *
  1237*  ORIGINAL BENEFIT AMOUNT                                       *
  1238*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1239*  PROCESS TYPE (CANCEL)                                         *
  1240*  BENEFIT KIND (LIFE OR A/H)                                    *
  1241*  A.P.R.                                                        *
  1242*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1243*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1244*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1245*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1246*  COMPANY I.D. (3 CHARACTER)                                    *
  1247*  BENEFIT CODE                                                  *
  1248*  BENEFIT OVERRIDE CODE                                         *
  1249*                                                                *
  1250*  RETURNED FROM ELRFND                                          *
  1251*  --------------------                                          *
  1252*  CALCULATED REFUND                                             *
  1253*----------------------------------------------------------------*
  1254*  PASSED TO ELEARN                                              *
  1255*  ----------------                                              *
  1256*  CERT ISSUE DATE                                               *
  1257*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1258*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1259*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1260*  STATE CODE (CLIENT DEFINED)                                   *
  1261*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1262*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1263*  DEVIATION CODE                                                *
  1264*  ISSUE AGE                                                     *
  1265*  ORIGINAL BENEFIT AMOUNT                                       *
  1266*  BENEFIT KIND (LIFE OR A/H)                                    *
  1267*  A.P.R.                                                        *
  1268*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1269*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1270*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1271*  COMPANY I.D. (3 CHARACTER)                                    *
  1272*  BENEFIT CODE                                                  *
  1273*  BENEFIT OVERRIDE CODE                                         *
  1274*                                                                *
  1275*  RETURNED FROM ELEARN                                          *
  1276*  --------------------                                          *
  1277*  INDICATED  EARNINGS                                           *
  1278*----------------------------------------------------------------*
  1279*                 LENGTH = 450                                   *
  1280*                                                                *
  1281******************************************************************
  1282******************************************************************
  1283*                   C H A N G E   L O G
  1284*
  1285* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  26
* EL156.cbl
  1286*-----------------------------------------------------------------
  1287*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1288* EFFECTIVE    NUMBER
  1289*-----------------------------------------------------------------
  1290* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1291* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1292* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1293* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1294* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1295* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1296* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1297* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1298* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1299******************************************************************
  1300
  1301 01  CALCULATION-PASS-AREA.
  1302     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1303                                     COMP.
  1304
  1305     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1306       88  NO-CP-ERROR                             VALUE ZERO.
  1307       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1308                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1309       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1310       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1311       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1312       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1313       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1314       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1315       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1316       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1317       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1318       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1319       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1320       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1321       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1322       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1323       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1324       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1325       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1326
  1327     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1328       88  NO-CP-ERROR-2                           VALUE ZERO.
  1329***********************  INPUT AREAS ****************************
  1330
  1331     12  CP-CALCULATION-AREA.
  1332         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1333         16  CP-CERT-EFF-DT        PIC XX.
  1334         16  CP-VALUATION-DT       PIC XX.
  1335         16  CP-PAID-THRU-DT       PIC XX.
  1336         16  CP-BENEFIT-TYPE       PIC X.
  1337           88  CP-AH                               VALUE 'A' 'D'
  1338                                                   'I' 'U'.
  1339           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1340           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1341         16  CP-INCURRED-DT        PIC XX.
  1342         16  CP-REPORTED-DT        PIC XX.
  1343         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  27
* EL156.cbl
  1344         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1345         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1346                                     COMP-3.
  1347         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1348                                     COMP-3.
  1349         16  CP-CDT-METHOD         PIC X.
  1350           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1351           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1352           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1353         16  CP-CLAIM-TYPE         PIC X.
  1354           88  CP-AH-CLAIM                         VALUE 'A'.
  1355           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1356         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1357                                     COMP-3.
  1358         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1359                                     COMP-3.
  1360         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1361                                     COMP-3.
  1362         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1363                                     COMP-3.
  1364         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1365                                     COMP-3.
  1366         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1367                                     COMP-3.
  1368         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1369                                     COMP-3.
  1370         16  CP-REM-TERM-METHOD    PIC X.
  1371           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1372           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1373           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1374           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1375           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1376           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1377           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1378         16  CP-EARNING-METHOD     PIC X.
  1379           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1380           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1381           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1382           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1383           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1384           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1385           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1386           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1387           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1388           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1389           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1390           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1391           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1392           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1393         16  CP-PROCESS-TYPE       PIC X.
  1394           88  CP-CLAIM                            VALUE '1'.
  1395           88  CP-CANCEL                           VALUE '2'.
  1396           88  CP-ISSUE                            VALUE '3'.
  1397         16  CP-SPECIAL-CALC-CD    PIC X.
  1398           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1399           88  CP-1-MTH-INTEREST               VALUE ' '.
  1400           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1401           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  28
* EL156.cbl
  1402           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1403           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1404           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1405           88  CP-FARM-PLAN                    VALUE 'F'.
  1406           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1407           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1408           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1409           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1410           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1411           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1412           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1413           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1414           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1415           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1416                                                     'W' 'X'.
  1417           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1418           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1419           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1420           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1421           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1422           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1423           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1424           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1425           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1426           88  CP-CSL-METH-1                   VALUE '5'.
  1427           88  CP-CSL-METH-2                   VALUE '6'.
  1428           88  CP-CSL-METH-3                   VALUE '7'.
  1429           88  CP-CSL-METH-4                   VALUE '8'.
  1430
  1431         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1432                                     COMP-3.
  1433         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1434         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1435         16  CP-STATE              PIC XX          VALUE SPACE.
  1436         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1437         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1438           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1439               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1440         16  CP-R78-OPTION         PIC X.
  1441           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1442           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1443
  1444         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1445         16  CP-IBNR-RESERVE-SW    PIC X.
  1446         16  CP-CLAIM-STATUS       PIC X.
  1447         16  CP-RATE-FILE          PIC X.
  1448         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1449                                     COMP-3.
  1450
  1451         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1452         16  CP-AH-OVERRIDE-CODE   PIC X.
  1453
  1454         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1455                                     COMP-3.
  1456         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1457                                   PIC S9(5)V99 COMP-3.
  1458         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1459                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  29
* EL156.cbl
  1460         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1461                                     COMP-3.
  1462         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1463                                     COMP-3.
  1464         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1465                                  PIC S9(7)V99 COMP-3.
  1466
  1467         16  CP-PAID-FROM-DATE     PIC X(02).
  1468         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1469         16  CP-EXT-DAYS-CALC      PIC X.
  1470           88  CP-EXT-NO-CHG                   VALUE ' '.
  1471           88  CP-EXT-CHG-LF                   VALUE '1'.
  1472           88  CP-EXT-CHG-AH                   VALUE '2'.
  1473           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1474         16  CP-DOMICILE-STATE     PIC XX.
  1475         16  CP-CARRIER            PIC X.
  1476         16  CP-REIN-FLAG          PIC X.
  1477         16  CP-REM-TRM-CALC-OPTION PIC X.
  1478           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1479                      '2' '3' '4' '5'.
  1480           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1481           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1482           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1483           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1484           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1485           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1486           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1487           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1488         16  CP-SIG-SWITCH         PIC X.
  1489         16  CP-RATING-METHOD      PIC X.
  1490           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1491           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1492           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1493           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1494           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1495           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1496           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1497           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1498           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1499         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1500                                     COMP-3.
  1501         16  CP-BEN-CATEGORY       PIC X.
  1502         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1503         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1504                                   PIC S99V9(5) COMP-3.
  1505         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1506         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1507                                   PIC S99V9(5) COMP-3.
  1508         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1509         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1510         16  CP-EXPIRE-DT          PIC XX.
  1511         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1512         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1513         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1514         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1515         16  CP-DDF-SPEC-CALC      PIC X.
  1516             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1517             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  30
* EL156.cbl
  1518         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1519         16  CP-CANCEL-REASON      PIC X.
  1520         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1521         16  CP-PMT-MODE           PIC X.
  1522         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1523         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1524         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1525         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1526         16  FILLER                PIC X.
  1527
  1528***************    OUTPUT FROM ELRESV   ************************
  1529
  1530         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1531
  1532         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1533                                     COMP-3.
  1534         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1535                                     COMP-3.
  1536         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1537                                     COMP-3.
  1538         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1539                                     COMP-3.
  1540         16  FILLER                PIC X(09).
  1541***************    OUTPUT FROM ELRTRM   *************************
  1542
  1543         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1544                                     COMP-3.
  1545         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1546                                     COMP-3.
  1547         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1548                                     COMP-3.
  1549         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1550                                     COMP-3.
  1551         16  FILLER                PIC X(12).
  1552
  1553***************    OUTPUT FROM ELRAMT   *************************
  1554
  1555         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1556                                     COMP-3.
  1557         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1558                                     COMP-3.
  1559         16  FILLER                PIC X(12).
  1560
  1561***************    OUTPUT FROM ELRATE   *************************
  1562
  1563         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1564                                     COMP-3.
  1565         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-MORTALITY-CODE     PIC X(4).
  1568         16  CP-RATE-EDIT-FLAG     PIC X.
  1569             88  CP-RATES-NEED-APR                  VALUE '1'.
  1570         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1571                                     COMP-3.
  1572         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1573         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1574         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1575                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  31
* EL156.cbl
  1576         16  FILLER                PIC X(07).
  1577
  1578***************    OUTPUT FROM ELRFND   *************************
  1579
  1580         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1581                                     COMP-3.
  1582         16  CP-REFUND-TYPE-USED   PIC X.
  1583           88  CP-R-AS-R78                         VALUE '1'.
  1584           88  CP-R-AS-PRORATA                     VALUE '2'.
  1585           88  CP-R-AS-CALIF                       VALUE '3'.
  1586           88  CP-R-AS-TEXAS                       VALUE '4'.
  1587           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1588           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1589           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1590           88  CP-R-AS-MEAN                        VALUE '8'.
  1591           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1592           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1593           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1594           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1595           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1596           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1597         16  FILLER                PIC X(12).
  1598
  1599***************    OUTPUT FROM ELEARN   *************************
  1600
  1601         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1604                                     COMP-3.
  1605         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1606                                     COMP-3.
  1607         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1608                                     COMP-3.
  1609         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1610                                     COMP-3.
  1611         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1612                                     COMP-3.
  1613         16  CP-EARNING-TYPE-USED  PIC X.
  1614           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1615           88  CP-E-AS-R78                         VALUE '1'.
  1616           88  CP-E-AS-PRORATA                     VALUE '2'.
  1617           88  CP-E-AS-TEXAS                       VALUE '4'.
  1618           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1619           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1620           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1621           88  CP-E-AS-MEAN                        VALUE '8'.
  1622           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1623         16  FILLER                PIC X(12).
  1624
  1625***************    OUTPUT FROM ELPMNT   *************************
  1626
  1627         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  FILLER                PIC X(12).
  1632
  1633***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  32
* EL156.cbl
  1634         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1635                                     COMP-3.
  1636         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1637                                     COMP-3.
  1638         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1641                                     COMP-3.
  1642         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1643                                     COMP-3.
  1644         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1645                                     COMP-3.
  1646         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1647             88  OPEN-RATE-FILE                   VALUE 'O'.
  1648             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1649             88  IO-ERROR                         VALUE 'E'.
  1650
  1651         16  CP-FIRST-PAY-DATE     PIC XX.
  1652
  1653         16  CP-JOINT-INDICATOR    PIC X.
  1654
  1655         16  CP-RESERVE-REMAINING-TERM
  1656                                   PIC S9(4)V9    VALUE ZERO
  1657                                     COMP-3.
  1658
  1659         16  CP-INSURED-BIRTH-DT   PIC XX.
  1660
  1661         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1662                                     COMP-3.
  1663
  1664         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1665                                     COMP-3.
  1666
  1667         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1668                                     COMP-3.
  1669
  1670         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1671                                     COMP-3.
  1672
  1673         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1674                                     COMP-3.
  1675
  1676         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1677                                     COMP-3.
  1678
  1679         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1680                                     COMP-3.
  1681
  1682         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1683             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1684
  1685         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1686                                     COMP-3.
  1687         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1688                                     COMP-3.
  1689         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1690         16  FILLER                PIC X(15).
  1691******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  33
* EL156.cbl
  1692*    COPY ELCICALC.
  1693******************************************************************
  1694*                                                                *
  1695*                           ELCCICALC.                           *
  1696*                            VMOD=2.001                          *
  1697*                                                                *
  1698*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1699*                 CALCULATION MODULE                             *
  1700*                                                                *
  1701*  PASSED TO ELCLMI                                              *
  1702*  -----------------                                             *
  1703*  STATE                                                         *
  1704*  PRODUCT                                                       *
  1705*  COVERAGE                                                      *
  1706*  EFFECTIVE DATE                                                *
  1707*  INCURRED DATE                                                 *
  1708*  ESTABLISHED DATE                                              *
  1709*  LAST PAID DATE                                                *
  1710*  REPORTED DATE                                                 *
  1711*  CLAIM PAYMENT AMOUNT                                          *
  1712*                                                                *
  1713*  RETURNED FROM ELRTRM                                          *
  1714*  ---------------------                                         *
  1715*  RETURN CODE                                                   *
  1716*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1717*  CLAIM INTEREST AMOUNT                                         *
  1718*----------------------------------------------------------------*
  1719*----------------------------------------------------------------*
  1720*                 LENGTH = 100                                   *
  1721*                                                                *
  1722******************************************************************
  1723******************************************************************
  1724*                   C H A N G E   L O G
  1725*
  1726* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1727*-----------------------------------------------------------------
  1728*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1729* EFFECTIVE    NUMBER
  1730*-----------------------------------------------------------------
  1731* 120905    2004040700004  PEMA  NEW COPYBOOK
  1732* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1733******************************************************************
  1734
  1735 01  CLAIM-INT-PASS-AREA.
  1736     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1737                                     COMP.
  1738
  1739     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1740       88  NO-CI-ERROR                             VALUE ZERO.
  1741       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1742       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1743       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1744       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1745       88  CP-AMT-LT-5000                          VALUE '4'.
  1746       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1747       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1748       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1749       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  34
* EL156.cbl
  1750***********************  INPUT AREAS ****************************
  1751
  1752     12  CP-CALCULATION-AREA.
  1753         16  CP-COMPANY-CD         PIC X.
  1754         16  CP-STATE              PIC XX.
  1755         16  CP-PRODUCT            PIC XX.
  1756         16  CP-COVERAGE           PIC XX.
  1757         16  CP-INC-DT             PIC XX.
  1758         16  CP-EST-DT             PIC XX.
  1759         16  CP-LSTPD-DT           PIC XX.
  1760         16  CP-RPT-DT             PIC XX.
  1761         16  CP-PRF-DT             PIC XX.
  1762         16  CP-EFF-DT             PIC XX.
  1763         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1764         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1765         16  FILLER                PIC X(37).
  1766
  1767***************    OUTPUT FROM ELCLMI   ************************
  1768
  1769         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1770
  1771         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1772         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1773         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1774         16  FILLER                PIC X(19).
  1775******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  35
* EL156.cbl
  1777*    COPY ELCATTR.
  1778******************************************************************
  1779*                                                                *
  1780*                            ELCATTR.                            *
  1781*                            VMOD=2.001                          *
  1782*                                                                *
  1783*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1784*                                                                *
  1785*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1786*                                                                *
  1787*                   POS 1   P=PROTECTED                          *
  1788*                           U=UNPROTECTED                        *
  1789*                           S=ASKIP                              *
  1790*                   POS 2   A=ALPHA/NUMERIC                      *
  1791*                           N=NUMERIC                            *
  1792*                   POS 3   N=NORMAL                             *
  1793*                           B=BRIGHT                             *
  1794*                           D=DARK                               *
  1795*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1796*                           OF=MODIFIED DATA TAG OFF             *
  1797*                                                                *
  1798*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1799******************************************************************
  1800 01  ATTRIBUTE-LIST.
  1801     12  AL-PABOF            PIC X       VALUE 'Y'.
  1802     12  AL-PABON            PIC X       VALUE 'Z'.
  1803     12  AL-PADOF            PIC X       VALUE '%'.
  1804     12  AL-PADON            PIC X       VALUE '_'.
  1805     12  AL-PANOF            PIC X       VALUE '-'.
  1806     12  AL-PANON            PIC X       VALUE '/'.
  1807     12  AL-SABOF            PIC X       VALUE '8'.
  1808     12  AL-SABON            PIC X       VALUE '9'.
  1809     12  AL-SADOF            PIC X       VALUE '@'.
  1810     12  AL-SADON            PIC X       VALUE QUOTE.
  1811     12  AL-SANOF            PIC X       VALUE '0'.
  1812     12  AL-SANON            PIC X       VALUE '1'.
  1813     12  AL-UABOF            PIC X       VALUE 'H'.
  1814     12  AL-UABON            PIC X       VALUE 'I'.
  1815     12  AL-UADOF            PIC X       VALUE '<'.
  1816     12  AL-UADON            PIC X       VALUE '('.
  1817     12  AL-UANOF            PIC X       VALUE ' '.
  1818     12  AL-UANON            PIC X       VALUE 'A'.
  1819     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1820     12  AL-UNBON            PIC X       VALUE 'R'.
  1821     12  AL-UNDOF            PIC X       VALUE '*'.
  1822     12  AL-UNDON            PIC X       VALUE ')'.
  1823     12  AL-UNNOF            PIC X       VALUE '&'.
  1824     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  36
* EL156.cbl
  1826*    COPY ELCEMIB.
  1827******************************************************************
  1828*                                                                *
  1829*                                                                *
  1830*                            ELCEMIB.                            *
  1831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1832*                            VMOD=2.005                          *
  1833*                                                                *
  1834*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1835*                                                                *
  1836******************************************************************
  1837 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1838     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1839     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1840     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1841     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1842     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1843     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1844     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1845     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1846     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1847         88  EMI-NO-ERRORS                    VALUE '1'.
  1848         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1849         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1850     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1851         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1852     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1853         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1854         88  EMI-AREA1-FULL                   VALUE '2'.
  1855     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1856         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1857         88  EMI-AREA2-FULL                   VALUE '2'.
  1858     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1859         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1860         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1861         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1862         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1863         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1864     12  EMI-ERROR-LINES.
  1865         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1866         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1867         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1868         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1869             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1870                 24  EMI-ERR-NUM         PIC X(4).
  1871                 24  EMI-FILLER          PIC X.
  1872                 24  EMI-SEV             PIC X.
  1873                 24  FILLER              PIC X.
  1874             20  FILLER                  PIC X(02).
  1875     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1876         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1877             20  EMI-ERROR-NUMBER    PIC X(4).
  1878             20  EMI-FILL            PIC X.
  1879             20  EMI-SEVERITY        PIC X.
  1880             20  FILLER              PIC X.
  1881             20  EMI-ERROR-TEXT.
  1882                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1883                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  37
* EL156.cbl
  1884     12  EMI-SEVERITY-SAVE           PIC X.
  1885         88  EMI-NOTE                    VALUE 'N'.
  1886         88  EMI-WARNING                 VALUE 'W'.
  1887         88  EMI-FORCABLE                VALUE 'F'.
  1888         88  EMI-FATAL                   VALUE 'X'.
  1889     12  EMI-MESSAGE-FLAG            PIC X.
  1890         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1891         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1892     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1893     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1894         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1895         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1896         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1897     12  emi-claim-no                pic x(7).
  1898     12  emi-claim-type              pic x(6).
  1899     12  FILLER                      PIC X(124)  VALUE SPACES.
  1900     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1901     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1902     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1903     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  38
* EL156.cbl
  1905*    COPY ELCLNKLT.
  1906******************************************************************
  1907*                                                                *
  1908*                                                                *
  1909*                           ELCLNKLT                             *
  1910*                            VMOD=2.003                          *
  1911*                                                                *
  1912*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1913*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1914*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1915*                                                                *
  1916*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1917*   COMPLETING THE REQUIRED FIELDS.                              *
  1918*                                                                *
  1919*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1920*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1921*                              9999 INDICATES AN UNKNOWN ABEND   *
  1922*                                   WAS DETECTED.                *
  1923*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1924*                              CODES FOUND IN THE ERROR FILE.    *
  1925******************************************************************
  1926 01  W-1523-LINKDATA.
  1927     12  W-1523-COMMON-PI-DATA.
  1928         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1929         16  FILLER              PIC  X(67).
  1930         16  W-1523-COMPANY-CD   PIC  X(01).
  1931         16  FILLER              PIC  X(10).
  1932         16  W-1523-CONTROL-IN-PROGRESS.
  1933             20  W-1523-CARRIER  PIC  X(01).
  1934             20  W-1523-GROUPING PIC  X(06).
  1935             20  W-1523-STATE    PIC  X(02).
  1936             20  W-1523-ACCOUNT  PIC  X(10).
  1937             20  W-1523-CLAIM-CERT-GRP.
  1938                 24  W-1523-CLAIM-NO
  1939                                 PIC  X(07).
  1940                 24  W-1523-CERT-NO.
  1941                     28  W-1523-CERT-PRIME
  1942                                 PIC  X(10).
  1943                     28  W-1523-CERT-SFX
  1944                                 PIC  X(01).
  1945                 24  W-1523-CERT-EFF-DT
  1946                                 PIC  X(02).
  1947         16  FILLER              PIC X(265).
  1948
  1949     12  W-1523-WORK-AREA.
  1950         16  W-1523-FORM-NUMBER  PIC  X(04).
  1951         16  W-1523-NUMBER-COPIES
  1952                                 PIC  9(01).
  1953         16  W-1523-ADDR-TYPE    PIC  X(02).
  1954         16  W-1523-FOLLOW-UP-DATE
  1955                                 PIC  X(02).
  1956         16  W-1523-RESEND-DATE  PIC  X(02).
  1957         16  W-1523-ERROR-CODE   PIC  9(04).
  1958             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1959             88  W-1523-FATAL-ERROR
  1960                                    VALUES  0006 0013 0042
  1961                                            0154 0168 0169
  1962                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  39
* EL156.cbl
  1963                                            0179 0186 0281
  1964                                            0332 2055 3697
  1965                                            3698 3699 3770
  1966                                            3771 3772 7675
  1967                                            9106 9808 9883
  1968                                            9887.
  1969             88  W-1523-STOP-ERRORS
  1970                                    VALUES  0013 0042 0154
  1971                                            0168 0169 0172
  1972                                            0281 0332 2055
  1973                                            3698 3699 7675
  1974                                            9106 9808 9883
  1975                                            9999.
  1976         16  W-1523-REASON       PIC  X(70).
  1977         16  W-1523-ARCHIVE-NUMBER
  1978                                 PIC  9(08).
  1979     12  W-1523-POINTER-AREA.
  1980         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1981         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1982         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1983         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1984         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  40
* EL156.cbl
  1986*    COPY ELCNWA.
  1987*****************************************************************
  1988*                                                               *
  1989*                                                               *
  1990*                            ELCNWA.                            *
  1991*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1992*                            VMOD=2.003                         *
  1993*                                                               *
  1994*            M O V E   N A M E   W O R K   A R E A.             *
  1995*                                                               *
  1996*****************************************************************.
  1997
  1998 01  WS-NAME-WORK-AREA.
  1999     05  WS-INSURED-LAST-NAME        PIC X(15).
  2000     05  WS-INSURED-1ST-NAME         PIC X(12).
  2001     05  WS-INSURED-MID-INIT         PIC X.
  2002
  2003     05  WS-NAME-WORK.
  2004         10  WS-NW                   PIC X
  2005             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2006
  2007     05  WS-NAME-WORK2.
  2008         10  WS-NW2                  PIC X
  2009             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2010                                        NWA-INDEX0.
  2011
  2012     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2013                                     COMP-3.
  2014
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  41
* EL156.cbl
  2016*    COPY ELCDMO.
  2017******************************************************************
  2018*                                                                *
  2019*                                                                *
  2020*                            ELCDMO.                             *
  2021*                            VMOD=2.004                          *
  2022*                                                                *
  2023*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2024*        COMMUNICATION AREA                                      *
  2025*   FILE TYPE = NA                                               *
  2026*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2027*                                                                *
  2028******************************************************************
  2029 01  DMO-COMMUNICATION-AREA.
  2030     12  DM-RECORD-TYPE                  PIC  X(02).
  2031             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2032             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2033             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2034     12  DM-DIST-CODE                    PIC  X(04).
  2035     12  DM-MAIL-CODE                    PIC  X(05).
  2036     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2037     12  DM-INSURED-NAME                 PIC  X(30).
  2038     12  DM-CLAIM-NO                     PIC  X(07).
  2039     12  DM-CLAIM-TYPE                   PIC  X.
  2040
  2041     12  DM-STATUS-DATA-AREA.
  2042         16  DM-CLAIM-STATUS             PIC  X.
  2043             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2044             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2045             88  DM-CLOSED                        VALUE '3'.
  2046             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2047             88  DM-DEFAULT                       VALUE '9'.
  2048         16  DM-STATUS-DATE              PIC  X(08).
  2049******YYYYMMDD
  2050         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2051             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2052             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2053             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2054             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2055             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2056             88  DM-RE-OPENED                     VALUE 'R'.
  2057             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2058             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2059             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2060         16  DM-STAT-CARRIER             PIC X.
  2061
  2062     12  DM-DRAFT-DATA-AREA.
  2063         16  DM-PAYMENT-TYPE             PIC  X.
  2064             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2065         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2066         16  DM-PAYMENT-DATE             PIC  X(08).
  2067******YYYYMMDD
  2068         16  DM-CERT-NO                  PIC  X(11).
  2069         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2070         16  DM-CARRIER                  PIC  X.
  2071
  2072     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  42
* EL156.cbl
  2074*    COPY ELCDMDCD.
  2075******************************************************************
  2076*                                                                *
  2077*                                                                *
  2078*                            ELCDMDCD.                           *
  2079*                            VMOD=2.001                          *
  2080*                                                                *
  2081*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2082*       COMMUNICATIONS AREA                                      *
  2083*                                                                *
  2084******************************************************************
  2085 01  CD-COMMUNICATION-AREA.
  2086     12  CD-SYSTEM-ID            PIC  X(02).
  2087         88 CD-CLAIMS                      VALUE 'CL'.
  2088         88 CD-CREDIT                      VALUE 'CR'.
  2089     12  CD-RECORD-TYPE          PIC  X(02).
  2090         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2091         88 CD-EOB-CODE                    VALUE 'EO'.
  2092         88 CD-ICD9-CODE                   VALUE 'I9'.
  2093         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2094         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2095         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2096         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2097         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2098     12  CD-RECORD-KEY           PIC  X(06).
  2099         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2100     12  CD-RETURN-CODE          PIC  X(02).
  2101     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2102     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2103     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2104     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  43
* EL156.cbl
  2106*    COPY ELCDCTB.
  2107******************************************************************
  2108*                                                                *
  2109*                                                                *
  2110*                            ELCDCTB.                            *
  2111*                            VMOD=2.002                          *
  2112*                                                                *
  2113*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2114*       COMMUNICATIONS AREA                                      *
  2115*                                                                *
  2116******************************************************************
  2117 01  DCT-COMMUNICATION-AREA.
  2118     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2119     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2120     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2121     12  DCT-PRODUCT-CODE         PIC  X(02).
  2122     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2123     12  DCT-RETURN-CODE          PIC  X(02).
  2124     12  DCT-MAIL-CODE            PIC  X(05).
  2125     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2126     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  44
* EL156.cbl
  2128 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2129 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2130 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2131 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  45
* EL156.cbl
  2133*    COPY ELCINTF.
  2134******************************************************************
  2135*                                                                *
  2136*                                                                *
  2137*                            ELCINTF.                            *
  2138*                            VMOD=2.017                          *
  2139*                                                                *
  2140*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2141*                                                                *
  2142*       LENGTH = 1024                                            *
  2143*                                                                *
  2144******************************************************************
  2145*                   C H A N G E   L O G
  2146*
  2147* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2148*-----------------------------------------------------------------
  2149*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2150* EFFECTIVE    NUMBER
  2151*-----------------------------------------------------------------
  2152* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2153******************************************************************
  2154 01  PROGRAM-INTERFACE-BLOCK.
  2155     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2156     12  PI-CALLING-PROGRAM              PIC X(8).
  2157     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2158     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2159     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2160     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2161     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2162     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2163     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2164     12  PI-COMPANY-ID                   PIC XXX.
  2165     12  PI-COMPANY-CD                   PIC X.
  2166
  2167     12  PI-COMPANY-PASSWORD             PIC X(8).
  2168
  2169     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2170
  2171     12  PI-CONTROL-IN-PROGRESS.
  2172         16  PI-CARRIER                  PIC X.
  2173         16  PI-GROUPING                 PIC X(6).
  2174         16  PI-STATE                    PIC XX.
  2175         16  PI-ACCOUNT                  PIC X(10).
  2176         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2177                                         PIC X(10).
  2178         16  PI-CLAIM-CERT-GRP.
  2179             20  PI-CLAIM-NO             PIC X(7).
  2180             20  PI-CERT-NO.
  2181                 25  PI-CERT-PRIME       PIC X(10).
  2182                 25  PI-CERT-SFX         PIC X.
  2183             20  PI-CERT-EFF-DT          PIC XX.
  2184         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2185             20  PI-PLAN-CODE            PIC X(2).
  2186             20  PI-REVISION-NUMBER      PIC X(3).
  2187             20  PI-PLAN-EFF-DT          PIC X(2).
  2188             20  PI-PLAN-EXP-DT          PIC X(2).
  2189             20  FILLER                  PIC X(11).
  2190         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  46
* EL156.cbl
  2191             20  PI-OE-REFERENCE-1.
  2192                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2193                 25  PI-OE-REF-1-SUFF    PIC XX.
  2194
  2195     12  PI-SESSION-IN-PROGRESS          PIC X.
  2196         88  CLAIM-SESSION                   VALUE '1'.
  2197         88  CREDIT-SESSION                  VALUE '2'.
  2198         88  WARRANTY-SESSION                VALUE '3'.
  2199         88  MORTGAGE-SESSION                VALUE '4'.
  2200         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2201
  2202
  2203*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2204
  2205     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2206     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2207
  2208     12  PI-CREDIT-USER                  PIC X.
  2209         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2210         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2211
  2212     12  PI-CLAIM-USER                   PIC X.
  2213         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2214         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2215
  2216     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2217         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2218         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2219         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2220         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2221         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2222
  2223     12  PI-PROCESSOR-ID                 PIC X(4).
  2224
  2225     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2226
  2227     12  PI-MEMBER-CAPTION               PIC X(10).
  2228
  2229     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2230         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2231
  2232     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2233     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2234     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2235     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2236
  2237     12  PI-AH-OVERRIDE-L1               PIC X.
  2238     12  PI-AH-OVERRIDE-L2               PIC XX.
  2239     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2240     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2241
  2242     12  PI-NEW-SYSTEM                   PIC X(2).
  2243
  2244     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2245     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2246         88  PI-USES-PAID-TO                 VALUE '1'.
  2247     12  PI-CRDTCRD-SYSTEM.
  2248         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  47
* EL156.cbl
  2249             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2250             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2251         16  PI-CC-MONTH-END-DT          PIC XX.
  2252     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2253
  2254     12  PI-OE-REFERENCE-2.
  2255         16  PI-OE-REF-2-PRIME           PIC X(10).
  2256         16  PI-OE-REF-2-SUFF            PIC X.
  2257
  2258     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2259
  2260     12  PI-LANGUAGE-TYPE                PIC X.
  2261             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2262             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2263             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2264
  2265     12  PI-POLICY-LINKAGE-IND           PIC X.
  2266         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2267         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2268                                                   LOW-VALUES.
  2269
  2270     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2271     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2272         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2273         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2274
  2275     12  PI-PROCESSOR-CSR-IND            PIC X.
  2276         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2277         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2278
  2279     12  FILLER                          PIC X(3).
  2280
  2281     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2282
  2283     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2284         PI-SYSTEM-LEVEL.
  2285
  2286         16  PI-ENTRY-CODES.
  2287             20  PI-ENTRY-CD-1           PIC X.
  2288             20  PI-ENTRY-CD-2           PIC X.
  2289
  2290         16  PI-RETURN-CODES.
  2291             20  PI-RETURN-CD-1          PIC X.
  2292             20  PI-RETURN-CD-2          PIC X.
  2293
  2294         16  PI-UPDATE-STATUS-SAVE.
  2295             20  PI-UPDATE-BY            PIC X(4).
  2296             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2297
  2298         16  PI-LOWER-CASE-LETTERS       PIC X.
  2299             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2300
  2301*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2302*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2303*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2304
  2305         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2306             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  48
* EL156.cbl
  2307             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2308             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2309             88  ACCNT-CNTL                  VALUE '3'.
  2310             88  CARR-ACCNT-CNTL             VALUE '4'.
  2311
  2312         16  PI-PROCESSOR-CAP-LIST.
  2313             20  PI-SYSTEM-CONTROLS.
  2314                24 PI-SYSTEM-DISPLAY     PIC X.
  2315                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2316                24 PI-SYSTEM-MODIFY      PIC X.
  2317                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2318             20  FILLER                  PIC XX.
  2319             20  PI-DISPLAY-CAP          PIC X.
  2320                 88  DISPLAY-CAP             VALUE 'Y'.
  2321             20  PI-MODIFY-CAP           PIC X.
  2322                 88  MODIFY-CAP              VALUE 'Y'.
  2323             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2324                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2325             20  PI-FORCE-CAP            PIC X.
  2326                 88  FORCE-CAP               VALUE 'Y'.
  2327
  2328         16  PI-PROGRAM-CONTROLS.
  2329             20  PI-PGM-PRINT-OPT        PIC X.
  2330             20  PI-PGM-FORMAT-OPT       PIC X.
  2331             20  PI-PGM-PROCESS-OPT      PIC X.
  2332             20  PI-PGM-TOTALS-OPT       PIC X.
  2333
  2334         16  PI-HELP-INTERFACE.
  2335             20  PI-LAST-ERROR-NO        PIC X(4).
  2336             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2337
  2338         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2339             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2340
  2341         16  PI-CR-CONTROL-IN-PROGRESS.
  2342             20  PI-CR-CARRIER           PIC X.
  2343             20  PI-CR-GROUPING          PIC X(6).
  2344             20  PI-CR-STATE             PIC XX.
  2345             20  PI-CR-ACCOUNT           PIC X(10).
  2346             20  PI-CR-FIN-RESP          PIC X(10).
  2347             20  PI-CR-TYPE              PIC X.
  2348
  2349         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2350
  2351         16  PI-CR-MONTH-END-DT          PIC XX.
  2352
  2353         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2354             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2355             88  PI-ZERO-CARRIER             VALUE '1'.
  2356             88  PI-ZERO-GROUPING            VALUE '2'.
  2357             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2358
  2359         16  PI-CARRIER-SECURITY         PIC X.
  2360             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2361
  2362         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2363             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2364             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  49
* EL156.cbl
  2365
  2366         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2367             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2368                                         INDEXED BY PI-ACCESS-NDX
  2369                                         PIC X.
  2370
  2371         16  PI-GA-BILLING-CONTROL       PIC X.
  2372             88  PI-GA-BILLING               VALUE '1'.
  2373
  2374         16  PI-MAIL-PROCESSING          PIC X.
  2375             88  PI-MAIL-YES                 VALUE 'Y'.
  2376
  2377         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2378
  2379         16  PI-AR-SYSTEM.
  2380             20  PI-AR-PROCESSING-CNTL   PIC X.
  2381                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2382             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2383             20  PI-AR-MONTH-END-DT      PIC XX.
  2384
  2385         16  PI-MP-SYSTEM.
  2386             20  PI-MORTGAGE-USER            PIC X.
  2387                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2388                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2389             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2390                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2391                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2392                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2393                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2394                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2395             20  PI-MP-MONTH-END-DT          PIC XX.
  2396             20  PI-MP-REFERENCE-NO.
  2397                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2398                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2399
  2400         16  PI-LABEL-CONTROL            PIC X(01).
  2401             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2402             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2403
  2404         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2405             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2406
  2407         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2408             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2409             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2410
  2411         16  FILLER                      PIC X(14).
  2412
  2413     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2414******************************************************************
  2415     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2416         16  PI-SAVE-FORM        PIC X(12).
  2417         16  PI-ACCT-KEY         PIC X(26).
  2418         16  PI-PAYEE-NAME       PIC X(30).
  2419         16  PI-DAILY-RATE       PIC S9(3)V99.
  2420         16  PI-MONTH-END-SAVE   PIC XX.
  2421         16  PI-BENEFIT-SAVE.
  2422             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  50
* EL156.cbl
  2423             20  PI-BEN-TYPE     PIC X.
  2424         16  PI-MANUAL-SW        PIC 9.
  2425         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2426         16  PI-PASS-SW          PIC X.
  2427         16  PI-PFKEY-USED       PIC X.
  2428         16  PI-CK-ASSIGN        PIC X.
  2429         16  PI-FATAL-COUNT      PIC 99.
  2430         16  PI-FORCE-COUNT      PIC 99.
  2431         16  PI-SAVE-INPUT.
  2432             20  PI-PMTTYPE      PIC X.
  2433             20  PI-PAYEE.
  2434                 24  PI-PAYEE-TYPE PIC X.
  2435                 24  PI-PAYEE-SEQ  PIC X.
  2436                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2437                   PI-PAYEE-SEQ    PIC S9.
  2438             20  PI-PMTNOTE1     PIC X(60).
  2439             20  PI-PMTNOTE2     PIC X(60).
  2440             20  PI-OFFLINE      PIC X.
  2441             20  PI-ECHECKNO     PIC X(7).
  2442             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2443                 28  PI-ECHECKNO-N     PIC X.
  2444                 28  PI-ECHECKNO-6     PIC X(6).
  2445             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2446                 24  PI-ECHECKNO-CR    PIC XX.
  2447                 24  PI-ECHECKNO-5     PIC X(5).
  2448             20  PI-HOLDTIL      PIC 9(6).
  2449             20  PI-EPYFROM      PIC 9(6).
  2450             20  PI-EPYTHRU      PIC 9(6).
  2451             20  PI-EDAYS        PIC S9(5).
  2452             20  PI-EPYAMT       PIC S9(7)V99.
  2453             20  PI-ERESV        PIC S9(7)V99.
  2454             20  PI-EEXPENS      PIC 9(6)V99.
  2455             20  PI-ETYPE        PIC X.
  2456             20  PI-CASH         PIC X.
  2457             20  PI-GROUPED      PIC X.
  2458             20  PI-INT-RATE     PIC S99V9(5).
  2459             20  PI-AIGFROM      PIC 9(6).
  2460             20  PI-LOAN-NO      PIC X(20).
  2461             20  PI-PROOF-DATE   PIC 9(6).
  2462             20  PI-PRINT-EOB-YN PIC X.
  2463             20  PI-PRINT-CLM-FRM-YN PIC X.
  2464             20  PI-PRINT-SURVEY-YN PIC X.
  2465             20  PI-SPECIAL-RELEASE-YN PIC X.
  2466         16  PI-SAVE-COMPUTED.
  2467             20  PI-CCHECKNO     PIC X(7).
  2468             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2469                 28  PI-CCHECKNO-N     PIC X.
  2470                 28  PI-CCHECKNO-6     PIC X(6).
  2471             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2472                 24  PI-CCHECKNO-CR    PIC XX.
  2473                 24  PI-CCHECKNO-5     PIC X(5).
  2474             20  PI-CPYFROM      PIC XX.
  2475             20  PI-CPYTHRU      PIC XX.
  2476             20  PI-CDAYS        PIC S9(5).
  2477             20  PI-CPYAMT       PIC S9(7)V99.
  2478             20  PI-CRESV        PIC 9(6)V99.
  2479             20  PI-CEXPENS      PIC 9(6)V99.
  2480             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  51
* EL156.cbl
  2481                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2482                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2483                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2484         16  PI-PREV-CLMNO       PIC X(7).
  2485         16  PI-LF-COVERAGE-TYPE PIC X.
  2486         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2487         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2488         16  PI-PROVISIONAL-IND  PIC X.
  2489             88 PI-PROV-PMT      VALUE 'P'.
  2490         16  PI-PREV-TRLR-KEY    PIC X(22).
  2491         16  PI-SPLIT-PMT-SW     PIC X.
  2492         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2493         16  PI-ACTIVITY-CODE    PIC 99.
  2494         16  PI-RESET-SW         PIC X.
  2495         16  PI-SPECIAL-BEN-SW   PIC X.
  2496             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2497         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2498         16  PI-EXP-DT           PIC XX.
  2499         16  PI-LOAN-DUE-DAY     PIC 99.
  2500         16  PI-3RD-PARTY-SW     PIC X.
  2501         16  PI-LOAN-UPDATE-SW   PIC X.
  2502
  2503         16  PI-DMD-DATA.
  2504             20  PI-SV-CERT-KEY       PIC X(21).
  2505             20  PI-SV-CERT-NO        PIC X(11).
  2506             20  PI-SV-BEN            PIC X(10).
  2507             20  PI-SV-CCN            PIC X(16).
  2508             20  PI-INTEREST-PAID-IND PIC X.
  2509                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2510             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2511             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2512             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2513             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2514         16  PI-AT-EOB-CODES.
  2515             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2516         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2517         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2518         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2519         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2520         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2521         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2522         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2523         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2524         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2525         16  PI-LF-BENEFIT-CD         PIC X(2).
  2526         16  PI-EOB-CODES-EXIST PIC X.
  2527         16  PI-SET-NOTE2-MDT   PIC X.
  2528         16  PI-VFY-2ND-BENE          PIC X.
  2529         16  PI-CLM-TYPE              PIC X.
  2530         16  PI-APPROVAL-LEVEL        PIC X.
  2531         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2532         16  PI-REAUDIT-NEEDED        PIC X.
  2533         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2534         16  PI-AH-BENEFIT-CD         PIC XX.
  2535*00781          16  FILLER                   PIC X(176).
  2536*052506         16  FILLER                   PIC X(161).
  2537*031808         16  FILLER                   PIC X(154).
  2538*091808         16  FILLER                   PIC X(152).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  52
* EL156.cbl
  2539*041710         16  FILLER                   PIC X(94).
  2540         16  FILLER                   PIC X(81).
  2541
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  53
* EL156.cbl
  2543*    COPY ELCJPFX.
  2544******************************************************************
  2545*                                                                *
  2546*                                                                *
  2547*                            ELCJPFX.                            *
  2548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2549*                            VMOD=2.002                          *
  2550*                                                                *
  2551*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2552*                                                                *
  2553*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2554*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2555*        ELCNTL - CONTROL FILE                                   *
  2556*        ELMSTR - CLAIM MASTERS                                  *
  2557*        ELTRLR - ACTIVITY TRAILERS                              *
  2558*        ELCHKQ - CHECK QUE                                      *
  2559******************************************************************
  2560 01  JOURNAL-RECORD.
  2561     12  jp-date                     pic s9(5) comp-3.
  2562     12  jp-time                     pic s9(7) comp-3.
  2563     12  JP-USER-ID                  PIC X(4).
  2564     12  JP-FILE-ID                  PIC X(8).
  2565     12  JP-PROGRAM-ID               PIC X(8).
  2566     12  JP-RECORD-TYPE              PIC X.
  2567         88 JP-ADD              VALUE 'A'.
  2568         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2569         88 JP-AFTER-CHANGE     VALUE 'C'.
  2570         88 JP-DELETE           VALUE 'D'.
  2571         88 JP-GENERIC-DELETE   VALUE 'G'.
  2572         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2573         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2574     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2575     12  JP-RECORD-AREA
  2576
  2577
  2578                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  54
* EL156.cbl
  2580*    COPY ELCAID.
  2581******************************************************************
  2582*                                                                *
  2583*                            ELCAID.                             *
  2584*                            VMOD=2.001                          *
  2585*                                                                *
  2586*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2587*                                                                *
  2588*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2589*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2590******************************************************************
  2591
  2592 01  DFHAID.
  2593   02  DFHNULL   PIC  X  VALUE  ' '.
  2594   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2595   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2596   02  DFHPEN    PIC  X  VALUE  '='.
  2597   02  DFHOPID   PIC  X  VALUE  'W'.
  2598   02  DFHPA1    PIC  X  VALUE  '%'.
  2599   02  DFHPA2    PIC  X  VALUE  '>'.
  2600   02  DFHPA3    PIC  X  VALUE  ','.
  2601   02  DFHPF1    PIC  X  VALUE  '1'.
  2602   02  DFHPF2    PIC  X  VALUE  '2'.
  2603   02  DFHPF3    PIC  X  VALUE  '3'.
  2604   02  DFHPF4    PIC  X  VALUE  '4'.
  2605   02  DFHPF5    PIC  X  VALUE  '5'.
  2606   02  DFHPF6    PIC  X  VALUE  '6'.
  2607   02  DFHPF7    PIC  X  VALUE  '7'.
  2608   02  DFHPF8    PIC  X  VALUE  '8'.
  2609   02  DFHPF9    PIC  X  VALUE  '9'.
  2610   02  DFHPF10   PIC  X  VALUE  ':'.
  2611   02  DFHPF11   PIC  X  VALUE  '#'.
  2612   02  DFHPF12   PIC  X  VALUE  '@'.
  2613   02  DFHPF13   PIC  X  VALUE  'A'.
  2614   02  DFHPF14   PIC  X  VALUE  'B'.
  2615   02  DFHPF15   PIC  X  VALUE  'C'.
  2616   02  DFHPF16   PIC  X  VALUE  'D'.
  2617   02  DFHPF17   PIC  X  VALUE  'E'.
  2618   02  DFHPF18   PIC  X  VALUE  'F'.
  2619   02  DFHPF19   PIC  X  VALUE  'G'.
  2620   02  DFHPF20   PIC  X  VALUE  'H'.
  2621   02  DFHPF21   PIC  X  VALUE  'I'.
  2622*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2623   02  DFHPF22   PIC  X  VALUE  '['.
  2624   02  DFHPF23   PIC  X  VALUE  '.'.
  2625   02  DFHPF24   PIC  X  VALUE  '<'.
  2626   02  DFHMSRE   PIC  X  VALUE  'X'.
  2627   02  DFHSTRF   PIC  X  VALUE  'h'.
  2628   02  DFHTRIG   PIC  X  VALUE  '"'.
  2629 01  FILLER    REDEFINES DFHAID.
  2630     12  FILLER              PIC X(8).
  2631     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  55
* EL156.cbl
  2633*    COPY EL156S.
  2634 01  EL156AI.
  2635     05  FILLER            PIC  X(0012).
  2636*    -------------------------------
  2637     05  RUNDTEAL PIC S9(0004) COMP.
  2638     05  RUNDTEAF PIC  X(0001).
  2639     05  FILLER REDEFINES RUNDTEAF.
  2640         10  RUNDTEAA PIC  X(0001).
  2641     05  RUNDTEAI PIC  X(0008).
  2642*    -------------------------------
  2643     05  RUNTIMAL PIC S9(0004) COMP.
  2644     05  RUNTIMAF PIC  X(0001).
  2645     05  FILLER REDEFINES RUNTIMAF.
  2646         10  RUNTIMAA PIC  X(0001).
  2647     05  RUNTIMAI PIC  X(0005).
  2648*    -------------------------------
  2649     05  SEQUL PIC S9(0004) COMP.
  2650     05  SEQUF PIC  X(0001).
  2651     05  FILLER REDEFINES SEQUF.
  2652         10  SEQUA PIC  X(0001).
  2653     05  SEQUI PIC  X(0010).
  2654*    -------------------------------
  2655     05  CLMNOL PIC S9(0004) COMP.
  2656     05  CLMNOF PIC  X(0001).
  2657     05  FILLER REDEFINES CLMNOF.
  2658         10  CLMNOA PIC  X(0001).
  2659     05  CLMNOI PIC  X(0007).
  2660*    -------------------------------
  2661     05  CARRL PIC S9(0004) COMP.
  2662     05  CARRF PIC  X(0001).
  2663     05  FILLER REDEFINES CARRF.
  2664         10  CARRA PIC  X(0001).
  2665     05  CARRI PIC  X(0001).
  2666*    -------------------------------
  2667     05  CERTNOL PIC S9(0004) COMP.
  2668     05  CERTNOF PIC  X(0001).
  2669     05  FILLER REDEFINES CERTNOF.
  2670         10  CERTNOA PIC  X(0001).
  2671     05  CERTNOI PIC  X(0010).
  2672*    -------------------------------
  2673     05  SUFXL PIC S9(0004) COMP.
  2674     05  SUFXF PIC  X(0001).
  2675     05  FILLER REDEFINES SUFXF.
  2676         10  SUFXA PIC  X(0001).
  2677     05  SUFXI PIC  X(0001).
  2678*    -------------------------------
  2679     05  CLMTYPL PIC S9(0004) COMP.
  2680     05  CLMTYPF PIC  X(0001).
  2681     05  FILLER REDEFINES CLMTYPF.
  2682         10  CLMTYPA PIC  X(0001).
  2683     05  CLMTYPI PIC  X(0006).
  2684*    -------------------------------
  2685     05  CLMSTATL PIC S9(0004) COMP.
  2686     05  CLMSTATF PIC  X(0001).
  2687     05  FILLER REDEFINES CLMSTATF.
  2688         10  CLMSTATA PIC  X(0001).
  2689     05  CLMSTATI PIC  X(0006).
  2690*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  56
* EL156.cbl
  2691     05  LSTNMEL PIC S9(0004) COMP.
  2692     05  LSTNMEF PIC  X(0001).
  2693     05  FILLER REDEFINES LSTNMEF.
  2694         10  LSTNMEA PIC  X(0001).
  2695     05  LSTNMEI PIC  X(0015).
  2696*    -------------------------------
  2697     05  FSTNMEL PIC S9(0004) COMP.
  2698     05  FSTNMEF PIC  X(0001).
  2699     05  FILLER REDEFINES FSTNMEF.
  2700         10  FSTNMEA PIC  X(0001).
  2701     05  FSTNMEI PIC  X(0012).
  2702*    -------------------------------
  2703     05  MINITL PIC S9(0004) COMP.
  2704     05  MINITF PIC  X(0001).
  2705     05  FILLER REDEFINES MINITF.
  2706         10  MINITA PIC  X(0001).
  2707     05  MINITI PIC  X(0001).
  2708*    -------------------------------
  2709     05  PRIMHDGL PIC S9(0004) COMP.
  2710     05  PRIMHDGF PIC  X(0001).
  2711     05  FILLER REDEFINES PRIMHDGF.
  2712         10  PRIMHDGA PIC  X(0001).
  2713     05  PRIMHDGI PIC  X(0012).
  2714*    -------------------------------
  2715     05  PCERTNOL PIC S9(0004) COMP.
  2716     05  PCERTNOF PIC  X(0001).
  2717     05  FILLER REDEFINES PCERTNOF.
  2718         10  PCERTNOA PIC  X(0001).
  2719     05  PCERTNOI PIC  X(0010).
  2720*    -------------------------------
  2721     05  PSUFXL PIC S9(0004) COMP.
  2722     05  PSUFXF PIC  X(0001).
  2723     05  FILLER REDEFINES PSUFXF.
  2724         10  PSUFXA PIC  X(0001).
  2725     05  PSUFXI PIC  X(0001).
  2726*    -------------------------------
  2727     05  STATUSL PIC S9(0004) COMP.
  2728     05  STATUSF PIC  X(0001).
  2729     05  FILLER REDEFINES STATUSF.
  2730         10  STATUSA PIC  X(0001).
  2731     05  STATUSI PIC  X(0010).
  2732*    -------------------------------
  2733     05  LOANHL PIC S9(0004) COMP.
  2734     05  LOANHF PIC  X(0001).
  2735     05  FILLER REDEFINES LOANHF.
  2736         10  LOANHA PIC  X(0001).
  2737     05  LOANHI PIC  X(0014).
  2738*    -------------------------------
  2739     05  LOANNOL PIC S9(0004) COMP.
  2740     05  LOANNOF PIC  X(0001).
  2741     05  FILLER REDEFINES LOANNOF.
  2742         10  LOANNOA PIC  X(0001).
  2743     05  LOANNOI PIC  X(0025).
  2744*    -------------------------------
  2745     05  DUEDAYHL PIC S9(0004) COMP.
  2746     05  DUEDAYHF PIC  X(0001).
  2747     05  FILLER REDEFINES DUEDAYHF.
  2748         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  57
* EL156.cbl
  2749     05  DUEDAYHI PIC  X(0008).
  2750*    -------------------------------
  2751     05  DUEDAYL PIC S9(0004) COMP.
  2752     05  DUEDAYF PIC  X(0001).
  2753     05  FILLER REDEFINES DUEDAYF.
  2754         10  DUEDAYA PIC  X(0001).
  2755     05  DUEDAYI PIC  X(0002).
  2756*    -------------------------------
  2757     05  ZINTHL PIC S9(0004) COMP.
  2758     05  ZINTHF PIC  X(0001).
  2759     05  FILLER REDEFINES ZINTHF.
  2760         10  ZINTHA PIC  X(0001).
  2761     05  ZINTHI PIC  X(0009).
  2762*    -------------------------------
  2763     05  ZINTL PIC S9(0004) COMP.
  2764     05  ZINTF PIC  X(0001).
  2765     05  FILLER REDEFINES ZINTF.
  2766         10  ZINTA PIC  X(0001).
  2767     05  ZINTI PIC  99V99999.
  2768*    -------------------------------
  2769     05  PTHRHDGL PIC S9(0004) COMP.
  2770     05  PTHRHDGF PIC  X(0001).
  2771     05  FILLER REDEFINES PTHRHDGF.
  2772         10  PTHRHDGA PIC  X(0001).
  2773     05  PTHRHDGI PIC  X(0014).
  2774*    -------------------------------
  2775     05  PDTHRUL PIC S9(0004) COMP.
  2776     05  PDTHRUF PIC  X(0001).
  2777     05  FILLER REDEFINES PDTHRUF.
  2778         10  PDTHRUA PIC  X(0001).
  2779     05  PDTHRUI PIC  X(0008).
  2780*    -------------------------------
  2781     05  TOTPAIDL PIC S9(0004) COMP.
  2782     05  TOTPAIDF PIC  X(0001).
  2783     05  FILLER REDEFINES TOTPAIDF.
  2784         10  TOTPAIDA PIC  X(0001).
  2785     05  TOTPAIDI PIC  X(0010).
  2786*    -------------------------------
  2787     05  COVERL PIC S9(0004) COMP.
  2788     05  COVERF PIC  X(0001).
  2789     05  FILLER REDEFINES COVERF.
  2790         10  COVERA PIC  X(0001).
  2791     05  COVERI PIC  X(0010).
  2792*    -------------------------------
  2793     05  INCURL PIC S9(0004) COMP.
  2794     05  INCURF PIC  X(0001).
  2795     05  FILLER REDEFINES INCURF.
  2796         10  INCURA PIC  X(0001).
  2797     05  INCURI PIC  X(0008).
  2798*    -------------------------------
  2799     05  LSTDTEL PIC S9(0004) COMP.
  2800     05  LSTDTEF PIC  X(0001).
  2801     05  FILLER REDEFINES LSTDTEF.
  2802         10  LSTDTEA PIC  X(0001).
  2803     05  LSTDTEI PIC  X(0008).
  2804*    -------------------------------
  2805     05  CRTSTATL PIC S9(0004) COMP.
  2806     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  58
* EL156.cbl
  2807     05  FILLER REDEFINES CRTSTATF.
  2808         10  CRTSTATA PIC  X(0001).
  2809     05  CRTSTATI PIC  X(0010).
  2810*    -------------------------------
  2811     05  EFFECTL PIC S9(0004) COMP.
  2812     05  EFFECTF PIC  X(0001).
  2813     05  FILLER REDEFINES EFFECTF.
  2814         10  EFFECTA PIC  X(0001).
  2815     05  EFFECTI PIC  X(0008).
  2816*    -------------------------------
  2817     05  TERMSL PIC S9(0004) COMP.
  2818     05  TERMSF PIC  X(0001).
  2819     05  FILLER REDEFINES TERMSF.
  2820         10  TERMSA PIC  X(0001).
  2821     05  TERMSI PIC  X(0011).
  2822*    -------------------------------
  2823     05  STACCTL PIC S9(0004) COMP.
  2824     05  STACCTF PIC  X(0001).
  2825     05  FILLER REDEFINES STACCTF.
  2826         10  STACCTA PIC  X(0001).
  2827     05  STACCTI PIC  X(0013).
  2828*    -------------------------------
  2829     05  EXPDTEHL PIC S9(0004) COMP.
  2830     05  EXPDTEHF PIC  X(0001).
  2831     05  FILLER REDEFINES EXPDTEHF.
  2832         10  EXPDTEHA PIC  X(0001).
  2833     05  EXPDTEHI PIC  X(0014).
  2834*    -------------------------------
  2835     05  EXPDTEL PIC S9(0004) COMP.
  2836     05  EXPDTEF PIC  X(0001).
  2837     05  FILLER REDEFINES EXPDTEF.
  2838         10  EXPDTEA PIC  X(0001).
  2839     05  EXPDTEI PIC  X(0008).
  2840*    -------------------------------
  2841     05  BENECAPL PIC S9(0004) COMP.
  2842     05  BENECAPF PIC  X(0001).
  2843     05  FILLER REDEFINES BENECAPF.
  2844         10  BENECAPA PIC  X(0001).
  2845     05  BENECAPI PIC  X(0013).
  2846*    -------------------------------
  2847     05  BENEL PIC S9(0004) COMP.
  2848     05  BENEF PIC  X(0001).
  2849     05  FILLER REDEFINES BENEF.
  2850         10  BENEA PIC  X(0001).
  2851     05  BENEI PIC  X(0009).
  2852*    -------------------------------
  2853     05  FORMTYPL PIC S9(0004) COMP.
  2854     05  FORMTYPF PIC  X(0001).
  2855     05  FILLER REDEFINES FORMTYPF.
  2856         10  FORMTYPA PIC  X(0001).
  2857     05  FORMTYPI PIC  X(0001).
  2858*    -------------------------------
  2859     05  PMTTYPEL PIC S9(0004) COMP.
  2860     05  PMTTYPEF PIC  X(0001).
  2861     05  FILLER REDEFINES PMTTYPEF.
  2862         10  PMTTYPEA PIC  X(0001).
  2863     05  PMTTYPEI PIC  X(0001).
  2864*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  59
* EL156.cbl
  2865     05  PAYEEL PIC S9(0004) COMP.
  2866     05  PAYEEF PIC  X(0001).
  2867     05  FILLER REDEFINES PAYEEF.
  2868         10  PAYEEA PIC  X(0001).
  2869     05  PAYEEI PIC  X(0002).
  2870*    -------------------------------
  2871     05  CHECKNOL PIC S9(0004) COMP.
  2872     05  CHECKNOF PIC  X(0001).
  2873     05  FILLER REDEFINES CHECKNOF.
  2874         10  CHECKNOA PIC  X(0001).
  2875     05  CHECKNOI PIC  X(0007).
  2876*    -------------------------------
  2877     05  OFFLINEL PIC S9(0004) COMP.
  2878     05  OFFLINEF PIC  X(0001).
  2879     05  FILLER REDEFINES OFFLINEF.
  2880         10  OFFLINEA PIC  X(0001).
  2881     05  OFFLINEI PIC  X(0001).
  2882*    -------------------------------
  2883     05  HOLDTILL PIC S9(0004) COMP.
  2884     05  HOLDTILF PIC  X(0001).
  2885     05  FILLER REDEFINES HOLDTILF.
  2886         10  HOLDTILA PIC  X(0001).
  2887     05  HOLDTILI PIC  X(0008).
  2888*    -------------------------------
  2889     05  NOTE1L PIC S9(0004) COMP.
  2890     05  NOTE1F PIC  X(0001).
  2891     05  FILLER REDEFINES NOTE1F.
  2892         10  NOTE1A PIC  X(0001).
  2893     05  NOTE1I PIC  X(0060).
  2894*    -------------------------------
  2895     05  NOTE2L PIC S9(0004) COMP.
  2896     05  NOTE2F PIC  X(0001).
  2897     05  FILLER REDEFINES NOTE2F.
  2898         10  NOTE2A PIC  X(0001).
  2899     05  NOTE2I PIC  X(0060).
  2900*    -------------------------------
  2901     05  EOBYNL PIC S9(0004) COMP.
  2902     05  EOBYNF PIC  X(0001).
  2903     05  FILLER REDEFINES EOBYNF.
  2904         10  EOBYNA PIC  X(0001).
  2905     05  EOBYNI PIC  X(0001).
  2906*    -------------------------------
  2907     05  CLMFMYNL PIC S9(0004) COMP.
  2908     05  CLMFMYNF PIC  X(0001).
  2909     05  FILLER REDEFINES CLMFMYNF.
  2910         10  CLMFMYNA PIC  X(0001).
  2911     05  CLMFMYNI PIC  X(0001).
  2912*    -------------------------------
  2913     05  SURVYYNL PIC S9(0004) COMP.
  2914     05  SURVYYNF PIC  X(0001).
  2915     05  FILLER REDEFINES SURVYYNF.
  2916         10  SURVYYNA PIC  X(0001).
  2917     05  SURVYYNI PIC  X(0001).
  2918*    -------------------------------
  2919     05  SPRELYNL PIC S9(0004) COMP.
  2920     05  SPRELYNF PIC  X(0001).
  2921     05  FILLER REDEFINES SPRELYNF.
  2922         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  60
* EL156.cbl
  2923     05  SPRELYNI PIC  X(0001).
  2924*    -------------------------------
  2925     05  PINTHL PIC S9(0004) COMP.
  2926     05  PINTHF PIC  X(0001).
  2927     05  FILLER REDEFINES PINTHF.
  2928         10  PINTHA PIC  X(0001).
  2929     05  PINTHI PIC  X(0004).
  2930*    -------------------------------
  2931     05  PINTL PIC S9(0004) COMP.
  2932     05  PINTF PIC  X(0001).
  2933     05  FILLER REDEFINES PINTF.
  2934         10  PINTA PIC  X(0001).
  2935     05  PINTI PIC  X(0008).
  2936*    -------------------------------
  2937     05  PROOFDTL PIC S9(0004) COMP.
  2938     05  PROOFDTF PIC  X(0001).
  2939     05  FILLER REDEFINES PROOFDTF.
  2940         10  PROOFDTA PIC  X(0001).
  2941     05  PROOFDTI PIC  X(0008).
  2942*    -------------------------------
  2943     05  AIGFRMHL PIC S9(0004) COMP.
  2944     05  AIGFRMHF PIC  X(0001).
  2945     05  FILLER REDEFINES AIGFRMHF.
  2946         10  AIGFRMHA PIC  X(0001).
  2947     05  AIGFRMHI PIC  X(0012).
  2948*    -------------------------------
  2949     05  AIGFROML PIC S9(0004) COMP.
  2950     05  AIGFROMF PIC  X(0001).
  2951     05  FILLER REDEFINES AIGFROMF.
  2952         10  AIGFROMA PIC  X(0001).
  2953     05  AIGFROMI PIC  X(0008).
  2954*    -------------------------------
  2955     05  PMTHDGAL PIC S9(0004) COMP.
  2956     05  PMTHDGAF PIC  X(0001).
  2957     05  FILLER REDEFINES PMTHDGAF.
  2958         10  PMTHDGAA PIC  X(0001).
  2959     05  PMTHDGAI PIC  X(0066).
  2960*    -------------------------------
  2961     05  EPYFROML PIC S9(0004) COMP.
  2962     05  EPYFROMF PIC  X(0001).
  2963     05  FILLER REDEFINES EPYFROMF.
  2964         10  EPYFROMA PIC  X(0001).
  2965     05  EPYFROMI PIC  X(0008).
  2966*    -------------------------------
  2967     05  EPYTHRUL PIC S9(0004) COMP.
  2968     05  EPYTHRUF PIC  X(0001).
  2969     05  FILLER REDEFINES EPYTHRUF.
  2970         10  EPYTHRUA PIC  X(0001).
  2971     05  EPYTHRUI PIC  X(0008).
  2972*    -------------------------------
  2973     05  EDAYSL PIC S9(0004) COMP.
  2974     05  EDAYSF PIC  X(0001).
  2975     05  FILLER REDEFINES EDAYSF.
  2976         10  EDAYSA PIC  X(0001).
  2977     05  EDAYSI PIC  S9(6).
  2978*    -------------------------------
  2979     05  EPYAMTL PIC S9(0004) COMP.
  2980     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  61
* EL156.cbl
  2981     05  FILLER REDEFINES EPYAMTF.
  2982         10  EPYAMTA PIC  X(0001).
  2983     05  EPYAMTI PIC  S9(8)V99.
  2984*    -------------------------------
  2985     05  ERESVL PIC S9(0004) COMP.
  2986     05  ERESVF PIC  X(0001).
  2987     05  FILLER REDEFINES ERESVF.
  2988         10  ERESVA PIC  X(0001).
  2989     05  ERESVI PIC  S9(7)V99.
  2990*    -------------------------------
  2991     05  ETYPEL PIC S9(0004) COMP.
  2992     05  ETYPEF PIC  X(0001).
  2993     05  FILLER REDEFINES ETYPEF.
  2994         10  ETYPEA PIC  X(0001).
  2995     05  ETYPEI PIC  X(0001).
  2996*    -------------------------------
  2997     05  EEXPENSL PIC S9(0004) COMP.
  2998     05  EEXPENSF PIC  X(0001).
  2999     05  FILLER REDEFINES EEXPENSF.
  3000         10  EEXPENSA PIC  X(0001).
  3001     05  EEXPENSI PIC  9(6)V99.
  3002*    -------------------------------
  3003     05  CPYFROML PIC S9(0004) COMP.
  3004     05  CPYFROMF PIC  X(0001).
  3005     05  FILLER REDEFINES CPYFROMF.
  3006         10  CPYFROMA PIC  X(0001).
  3007     05  CPYFROMI PIC  X(0008).
  3008*    -------------------------------
  3009     05  CPYTHRUL PIC S9(0004) COMP.
  3010     05  CPYTHRUF PIC  X(0001).
  3011     05  FILLER REDEFINES CPYTHRUF.
  3012         10  CPYTHRUA PIC  X(0001).
  3013     05  CPYTHRUI PIC  X(0008).
  3014*    -------------------------------
  3015     05  CDAYSL PIC S9(0004) COMP.
  3016     05  CDAYSF PIC  X(0001).
  3017     05  FILLER REDEFINES CDAYSF.
  3018         10  CDAYSA PIC  X(0001).
  3019     05  CDAYSI PIC  9(6).
  3020*    -------------------------------
  3021     05  CPYAMTL PIC S9(0004) COMP.
  3022     05  CPYAMTF PIC  X(0001).
  3023     05  FILLER REDEFINES CPYAMTF.
  3024         10  CPYAMTA PIC  X(0001).
  3025     05  CPYAMTI PIC  S9(8)V99.
  3026*    -------------------------------
  3027     05  CRESVL PIC S9(0004) COMP.
  3028     05  CRESVF PIC  X(0001).
  3029     05  FILLER REDEFINES CRESVF.
  3030         10  CRESVA PIC  X(0001).
  3031     05  CRESVI PIC  9(6)V99.
  3032*    -------------------------------
  3033     05  CEXPENSL PIC S9(0004) COMP.
  3034     05  CEXPENSF PIC  X(0001).
  3035     05  FILLER REDEFINES CEXPENSF.
  3036         10  CEXPENSA PIC  X(0001).
  3037     05  CEXPENSI PIC  9(6)V99.
  3038*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  62
* EL156.cbl
  3039     05  ERRMSG0L PIC S9(0004) COMP.
  3040     05  ERRMSG0F PIC  X(0001).
  3041     05  FILLER REDEFINES ERRMSG0F.
  3042         10  ERRMSG0A PIC  X(0001).
  3043     05  ERRMSG0I PIC  X(0072).
  3044*    -------------------------------
  3045     05  ERRMSG1L PIC S9(0004) COMP.
  3046     05  ERRMSG1F PIC  X(0001).
  3047     05  FILLER REDEFINES ERRMSG1F.
  3048         10  ERRMSG1A PIC  X(0001).
  3049     05  ERRMSG1I PIC  X(0072).
  3050*    -------------------------------
  3051     05  ERRMSG2L PIC S9(0004) COMP.
  3052     05  ERRMSG2F PIC  X(0001).
  3053     05  FILLER REDEFINES ERRMSG2F.
  3054         10  ERRMSG2A PIC  X(0001).
  3055     05  ERRMSG2I PIC  X(0072).
  3056*    -------------------------------
  3057     05  ENTERPFL PIC S9(0004) COMP.
  3058     05  ENTERPFF PIC  X(0001).
  3059     05  FILLER REDEFINES ENTERPFF.
  3060         10  ENTERPFA PIC  X(0001).
  3061     05  ENTERPFI PIC  99.
  3062*    -------------------------------
  3063     05  PF6TITL PIC S9(0004) COMP.
  3064     05  PF6TITF PIC  X(0001).
  3065     05  FILLER REDEFINES PF6TITF.
  3066         10  PF6TITA PIC  X(0001).
  3067     05  PF6TITI PIC  X(0016).
  3068 01  EL156AO REDEFINES EL156AI.
  3069     05  FILLER            PIC  X(0012).
  3070*    -------------------------------
  3071     05  FILLER            PIC  X(0003).
  3072     05  RUNDTEAO PIC  X(0008).
  3073*    -------------------------------
  3074     05  FILLER            PIC  X(0003).
  3075     05  RUNTIMAO PIC  99.99.
  3076*    -------------------------------
  3077     05  FILLER            PIC  X(0003).
  3078     05  SEQUO PIC  X(0010).
  3079*    -------------------------------
  3080     05  FILLER            PIC  X(0003).
  3081     05  CLMNOO PIC  X(0007).
  3082*    -------------------------------
  3083     05  FILLER            PIC  X(0003).
  3084     05  CARRO PIC  X(0001).
  3085*    -------------------------------
  3086     05  FILLER            PIC  X(0003).
  3087     05  CERTNOO PIC  X(0010).
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  SUFXO PIC  X(0001).
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
  3093     05  CLMTYPO PIC  X(0006).
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  63
* EL156.cbl
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  LSTNMEO PIC  X(0015).
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  FSTNMEO PIC  X(0012).
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  MINITO PIC  X(0001).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  PRIMHDGO PIC  X(0012).
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  PCERTNOO PIC  X(0010).
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  PSUFXO PIC  X(0001).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  STATUSO PIC  X(0010).
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  LOANHO PIC  X(0014).
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  LOANNOO PIC  X(0025).
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  DUEDAYHO PIC  X(0008).
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  DUEDAYO PIC  X(0002).
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  ZINTHO PIC  X(0009).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  ZINTO PIC  9.99999.
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  PTHRHDGO PIC  X(0014).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  PDTHRUO PIC  X(0008).
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  TOTPAIDO PIC  Z(6).99-.
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  COVERO PIC  X(0010).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  INCURO PIC  X(0008).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  LSTDTEO PIC  X(0008).
  3154*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  64
* EL156.cbl
  3155     05  FILLER            PIC  X(0003).
  3156     05  CRTSTATO PIC  X(0010).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  EFFECTO PIC  X(0008).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  TERMSO PIC  X(0011).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  STACCTO PIC  X(0013).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  EXPDTEHO PIC  X(0014).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  EXPDTEO PIC  X(0008).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  BENECAPO PIC  X(0013).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  BENEO PIC  Z(6).99.
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  FORMTYPO PIC  X(0001).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  PMTTYPEO PIC  X(0001).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  PAYEEO PIC  X(0002).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  CHECKNOO PIC  X(0007).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  OFFLINEO PIC  X(0001).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  HOLDTILO PIC  99B99B99.
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  NOTE1O PIC  X(0060).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  NOTE2O PIC  X(0060).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  EOBYNO PIC  X(0001).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  CLMFMYNO PIC  X(0001).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  SURVYYNO PIC  X(0001).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  65
* EL156.cbl
  3213     05  SPRELYNO PIC  X(0001).
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  PINTHO PIC  X(0004).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  PINTO PIC  Z,ZZ9.99.
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  PROOFDTO PIC  99B99B99.
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  AIGFRMHO PIC  X(0012).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  AIGFROMO PIC  99B99B99.
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  PMTHDGAO PIC  X(0066).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  EPYFROMO PIC  99B99B99.
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  EPYTHRUO PIC  99B99B99.
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  EDAYSO PIC  Z(4)9-.
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  EPYAMTO PIC  Z(6).99-.
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  ERESVO PIC  Z(5).99-.
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  ETYPEO PIC  X(0001).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  EEXPENSO PIC  Z(5).99.
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  CPYFROMO PIC  99B99B99.
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  CPYTHRUO PIC  99B99B99.
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  CDAYSO PIC  Z(4)9-.
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  CPYAMTO PIC  Z(6).99-.
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  CRESVO PIC  Z(5).99.
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  66
* EL156.cbl
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  ERRMSG0O PIC  X(0072).
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  ERRMSG1O PIC  X(0072).
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  ERRMSG2O PIC  X(0072).
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  ENTERPFO PIC  X(0002).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  PF6TITO PIC  X(0016).
  3286*    -------------------------------
  3287 01  EL156BI REDEFINES EL156AI.
  3288     05  FILLER            PIC  X(0012).
  3289*    -------------------------------
  3290     05  RUNDTEBL PIC S9(0004) COMP.
  3291     05  RUNDTEBF PIC  X(0001).
  3292     05  FILLER REDEFINES RUNDTEBF.
  3293         10  RUNDTEBA PIC  X(0001).
  3294     05  RUNDTEBI PIC  X(0008).
  3295*    -------------------------------
  3296     05  RUNTIMBL PIC S9(0004) COMP.
  3297     05  RUNTIMBF PIC  X(0001).
  3298     05  FILLER REDEFINES RUNTIMBF.
  3299         10  RUNTIMBA PIC  X(0001).
  3300     05  RUNTIMBI PIC  X(0005).
  3301*    -------------------------------
  3302     05  PAYDTBL PIC S9(0004) COMP.
  3303     05  PAYDTBF PIC  X(0001).
  3304     05  FILLER REDEFINES PAYDTBF.
  3305         10  PAYDTBA PIC  X(0001).
  3306     05  PAYDTBI PIC  X(0008).
  3307*    -------------------------------
  3308     05  PAYTYPBL PIC S9(0004) COMP.
  3309     05  PAYTYPBF PIC  X(0001).
  3310     05  FILLER REDEFINES PAYTYPBF.
  3311         10  PAYTYPBA PIC  X(0001).
  3312     05  PAYTYPBI PIC  X(0015).
  3313*    -------------------------------
  3314     05  PAYAMTBL PIC S9(0004) COMP.
  3315     05  PAYAMTBF PIC  X(0001).
  3316     05  FILLER REDEFINES PAYAMTBF.
  3317         10  PAYAMTBA PIC  X(0001).
  3318     05  PAYAMTBI PIC  X(0011).
  3319*    -------------------------------
  3320     05  LOANHBL PIC S9(0004) COMP.
  3321     05  LOANHBF PIC  X(0001).
  3322     05  FILLER REDEFINES LOANHBF.
  3323         10  LOANHBA PIC  X(0001).
  3324     05  LOANHBI PIC  X(0012).
  3325*    -------------------------------
  3326     05  LOANNBL PIC S9(0004) COMP.
  3327     05  LOANNBF PIC  X(0001).
  3328     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  67
* EL156.cbl
  3329         10  LOANNBA PIC  X(0001).
  3330     05  LOANNBI PIC  X(0025).
  3331*    -------------------------------
  3332     05  CKNUMHDL PIC S9(0004) COMP.
  3333     05  CKNUMHDF PIC  X(0001).
  3334     05  FILLER REDEFINES CKNUMHDF.
  3335         10  CKNUMHDA PIC  X(0001).
  3336     05  CKNUMHDI PIC  X(0012).
  3337*    -------------------------------
  3338     05  CKNUMBL PIC S9(0004) COMP.
  3339     05  CKNUMBF PIC  X(0001).
  3340     05  FILLER REDEFINES CKNUMBF.
  3341         10  CKNUMBA PIC  X(0001).
  3342     05  CKNUMBI PIC  X(0007).
  3343*    -------------------------------
  3344     05  AGTHDGL PIC S9(0004) COMP.
  3345     05  AGTHDGF PIC  X(0001).
  3346     05  FILLER REDEFINES AGTHDGF.
  3347         10  AGTHDGA PIC  X(0001).
  3348     05  AGTHDGI PIC  X(0016).
  3349*    -------------------------------
  3350     05  NAMEBL PIC S9(0004) COMP.
  3351     05  NAMEBF PIC  X(0001).
  3352     05  FILLER REDEFINES NAMEBF.
  3353         10  NAMEBA PIC  X(0001).
  3354     05  NAMEBI PIC  X(0030).
  3355*    -------------------------------
  3356     05  NAMEB2L PIC S9(0004) COMP.
  3357     05  NAMEB2F PIC  X(0001).
  3358     05  FILLER REDEFINES NAMEB2F.
  3359         10  NAMEB2A PIC  X(0001).
  3360     05  NAMEB2I PIC  X(0030).
  3361*    -------------------------------
  3362     05  ADDR1BL PIC S9(0004) COMP.
  3363     05  ADDR1BF PIC  X(0001).
  3364     05  FILLER REDEFINES ADDR1BF.
  3365         10  ADDR1BA PIC  X(0001).
  3366     05  ADDR1BI PIC  X(0030).
  3367*    -------------------------------
  3368     05  ADDR1B2L PIC S9(0004) COMP.
  3369     05  ADDR1B2F PIC  X(0001).
  3370     05  FILLER REDEFINES ADDR1B2F.
  3371         10  ADDR1B2A PIC  X(0001).
  3372     05  ADDR1B2I PIC  X(0030).
  3373*    -------------------------------
  3374     05  ADDR2BL PIC S9(0004) COMP.
  3375     05  ADDR2BF PIC  X(0001).
  3376     05  FILLER REDEFINES ADDR2BF.
  3377         10  ADDR2BA PIC  X(0001).
  3378     05  ADDR2BI PIC  X(0030).
  3379*    -------------------------------
  3380     05  ADDR2B2L PIC S9(0004) COMP.
  3381     05  ADDR2B2F PIC  X(0001).
  3382     05  FILLER REDEFINES ADDR2B2F.
  3383         10  ADDR2B2A PIC  X(0001).
  3384     05  ADDR2B2I PIC  X(0030).
  3385*    -------------------------------
  3386     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  68
* EL156.cbl
  3387     05  CITYSTBF PIC  X(0001).
  3388     05  FILLER REDEFINES CITYSTBF.
  3389         10  CITYSTBA PIC  X(0001).
  3390     05  CITYSTBI PIC  X(0030).
  3391*    -------------------------------
  3392     05  CITYST2L PIC S9(0004) COMP.
  3393     05  CITYST2F PIC  X(0001).
  3394     05  FILLER REDEFINES CITYST2F.
  3395         10  CITYST2A PIC  X(0001).
  3396     05  CITYST2I PIC  X(0030).
  3397*    -------------------------------
  3398     05  ZIPBL PIC S9(0004) COMP.
  3399     05  ZIPBF PIC  X(0001).
  3400     05  FILLER REDEFINES ZIPBF.
  3401         10  ZIPBA PIC  X(0001).
  3402     05  ZIPBI PIC  X(0009).
  3403*    -------------------------------
  3404     05  ZIPB2L PIC S9(0004) COMP.
  3405     05  ZIPB2F PIC  X(0001).
  3406     05  FILLER REDEFINES ZIPB2F.
  3407         10  ZIPB2A PIC  X(0001).
  3408     05  ZIPB2I PIC  X(0009).
  3409*    -------------------------------
  3410     05  INTHDBL PIC S9(0004) COMP.
  3411     05  INTHDBF PIC  X(0001).
  3412     05  FILLER REDEFINES INTHDBF.
  3413         10  INTHDBA PIC  X(0001).
  3414     05  INTHDBI PIC  X(0012).
  3415*    -------------------------------
  3416     05  INTAMTBL PIC S9(0004) COMP.
  3417     05  INTAMTBF PIC  X(0001).
  3418     05  FILLER REDEFINES INTAMTBF.
  3419         10  INTAMTBA PIC  X(0001).
  3420     05  INTAMTBI PIC  X(0011).
  3421*    -------------------------------
  3422     05  PMTHDGBL PIC S9(0004) COMP.
  3423     05  PMTHDGBF PIC  X(0001).
  3424     05  FILLER REDEFINES PMTHDGBF.
  3425         10  PMTHDGBA PIC  X(0001).
  3426     05  PMTHDGBI PIC  X(0034).
  3427*    -------------------------------
  3428     05  CLMNOBL PIC S9(0004) COMP.
  3429     05  CLMNOBF PIC  X(0001).
  3430     05  FILLER REDEFINES CLMNOBF.
  3431         10  CLMNOBA PIC  X(0001).
  3432     05  CLMNOBI PIC  X(0007).
  3433*    -------------------------------
  3434     05  CARRBL PIC S9(0004) COMP.
  3435     05  CARRBF PIC  X(0001).
  3436     05  FILLER REDEFINES CARRBF.
  3437         10  CARRBA PIC  X(0001).
  3438     05  CARRBI PIC  X(0001).
  3439*    -------------------------------
  3440     05  CERTNOBL PIC S9(0004) COMP.
  3441     05  CERTNOBF PIC  X(0001).
  3442     05  FILLER REDEFINES CERTNOBF.
  3443         10  CERTNOBA PIC  X(0001).
  3444     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  69
* EL156.cbl
  3445*    -------------------------------
  3446     05  SUFXBL PIC S9(0004) COMP.
  3447     05  SUFXBF PIC  X(0001).
  3448     05  FILLER REDEFINES SUFXBF.
  3449         10  SUFXBA PIC  X(0001).
  3450     05  SUFXBI PIC  X(0001).
  3451*    -------------------------------
  3452     05  CLMTYPBL PIC S9(0004) COMP.
  3453     05  CLMTYPBF PIC  X(0001).
  3454     05  FILLER REDEFINES CLMTYPBF.
  3455         10  CLMTYPBA PIC  X(0001).
  3456     05  CLMTYPBI PIC  X(0006).
  3457*    -------------------------------
  3458     05  INCURBL PIC S9(0004) COMP.
  3459     05  INCURBF PIC  X(0001).
  3460     05  FILLER REDEFINES INCURBF.
  3461         10  INCURBA PIC  X(0001).
  3462     05  INCURBI PIC  X(0008).
  3463*    -------------------------------
  3464     05  PYFROMBL PIC S9(0004) COMP.
  3465     05  PYFROMBF PIC  X(0001).
  3466     05  FILLER REDEFINES PYFROMBF.
  3467         10  PYFROMBA PIC  X(0001).
  3468     05  PYFROMBI PIC  X(0008).
  3469*    -------------------------------
  3470     05  PYTHRUBL PIC S9(0004) COMP.
  3471     05  PYTHRUBF PIC  X(0001).
  3472     05  FILLER REDEFINES PYTHRUBF.
  3473         10  PYTHRUBA PIC  X(0001).
  3474     05  PYTHRUBI PIC  X(0008).
  3475*    -------------------------------
  3476     05  DAYSBL PIC S9(0004) COMP.
  3477     05  DAYSBF PIC  X(0001).
  3478     05  FILLER REDEFINES DAYSBF.
  3479         10  DAYSBA PIC  X(0001).
  3480     05  DAYSBI PIC  X(0005).
  3481*    -------------------------------
  3482     05  BYBL PIC S9(0004) COMP.
  3483     05  BYBF PIC  X(0001).
  3484     05  FILLER REDEFINES BYBF.
  3485         10  BYBA PIC  X(0001).
  3486     05  BYBI PIC  X(0004).
  3487*    -------------------------------
  3488     05  PROOFDBL PIC S9(0004) COMP.
  3489     05  PROOFDBF PIC  X(0001).
  3490     05  FILLER REDEFINES PROOFDBF.
  3491         10  PROOFDBA PIC  X(0001).
  3492     05  PROOFDBI PIC  X(0008).
  3493*    -------------------------------
  3494     05  ACCTBL PIC S9(0004) COMP.
  3495     05  ACCTBF PIC  X(0001).
  3496     05  FILLER REDEFINES ACCTBF.
  3497         10  ACCTBA PIC  X(0001).
  3498     05  ACCTBI PIC  X(0010).
  3499*    -------------------------------
  3500     05  STATEBL PIC S9(0004) COMP.
  3501     05  STATEBF PIC  X(0001).
  3502     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  70
* EL156.cbl
  3503         10  STATEBA PIC  X(0001).
  3504     05  STATEBI PIC  X(0002).
  3505*    -------------------------------
  3506     05  GROUPBL PIC S9(0004) COMP.
  3507     05  GROUPBF PIC  X(0001).
  3508     05  FILLER REDEFINES GROUPBF.
  3509         10  GROUPBA PIC  X(0001).
  3510     05  GROUPBI PIC  X(0006).
  3511*    -------------------------------
  3512     05  ACARRBL PIC S9(0004) COMP.
  3513     05  ACARRBF PIC  X(0001).
  3514     05  FILLER REDEFINES ACARRBF.
  3515         10  ACARRBA PIC  X(0001).
  3516     05  ACARRBI PIC  X(0001).
  3517*    -------------------------------
  3518     05  ACCTNMBL PIC S9(0004) COMP.
  3519     05  ACCTNMBF PIC  X(0001).
  3520     05  FILLER REDEFINES ACCTNMBF.
  3521         10  ACCTNMBA PIC  X(0001).
  3522     05  ACCTNMBI PIC  X(0030).
  3523*    -------------------------------
  3524     05  UNDISBL PIC S9(0004) COMP.
  3525     05  UNDISBF PIC  X(0001).
  3526     05  FILLER REDEFINES UNDISBF.
  3527         10  UNDISBA PIC  X(0001).
  3528     05  UNDISBI PIC  X(0010).
  3529*    -------------------------------
  3530     05  RATEBL PIC S9(0004) COMP.
  3531     05  RATEBF PIC  X(0001).
  3532     05  FILLER REDEFINES RATEBF.
  3533         10  RATEBA PIC  X(0001).
  3534     05  RATEBI PIC  X(0006).
  3535*    -------------------------------
  3536     05  ERMSG1BL PIC S9(0004) COMP.
  3537     05  ERMSG1BF PIC  X(0001).
  3538     05  FILLER REDEFINES ERMSG1BF.
  3539         10  ERMSG1BA PIC  X(0001).
  3540     05  ERMSG1BI PIC  X(0072).
  3541*    -------------------------------
  3542     05  ENTPFBL PIC S9(0004) COMP.
  3543     05  ENTPFBF PIC  X(0001).
  3544     05  FILLER REDEFINES ENTPFBF.
  3545         10  ENTPFBA PIC  X(0001).
  3546     05  ENTPFBI PIC  99.
  3547 01  EL156BO REDEFINES EL156AI.
  3548     05  FILLER            PIC  X(0012).
  3549*    -------------------------------
  3550     05  FILLER            PIC  X(0003).
  3551     05  RUNDTEBO PIC  X(0008).
  3552*    -------------------------------
  3553     05  FILLER            PIC  X(0003).
  3554     05  RUNTIMBO PIC  99.99.
  3555*    -------------------------------
  3556     05  FILLER            PIC  X(0003).
  3557     05  PAYDTBO PIC  99B99B99.
  3558*    -------------------------------
  3559     05  FILLER            PIC  X(0003).
  3560     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  71
* EL156.cbl
  3561*    -------------------------------
  3562     05  FILLER            PIC  X(0003).
  3563     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3564*    -------------------------------
  3565     05  FILLER            PIC  X(0003).
  3566     05  LOANHBO PIC  X(0012).
  3567*    -------------------------------
  3568     05  FILLER            PIC  X(0003).
  3569     05  LOANNBO PIC  X(0025).
  3570*    -------------------------------
  3571     05  FILLER            PIC  X(0003).
  3572     05  CKNUMHDO PIC  X(0012).
  3573*    -------------------------------
  3574     05  FILLER            PIC  X(0003).
  3575     05  CKNUMBO PIC  X(0007).
  3576*    -------------------------------
  3577     05  FILLER            PIC  X(0003).
  3578     05  AGTHDGO PIC  X(0016).
  3579*    -------------------------------
  3580     05  FILLER            PIC  X(0003).
  3581     05  NAMEBO PIC  X(0030).
  3582*    -------------------------------
  3583     05  FILLER            PIC  X(0003).
  3584     05  NAMEB2O PIC  X(0030).
  3585*    -------------------------------
  3586     05  FILLER            PIC  X(0003).
  3587     05  ADDR1BO PIC  X(0030).
  3588*    -------------------------------
  3589     05  FILLER            PIC  X(0003).
  3590     05  ADDR1B2O PIC  X(0030).
  3591*    -------------------------------
  3592     05  FILLER            PIC  X(0003).
  3593     05  ADDR2BO PIC  X(0030).
  3594*    -------------------------------
  3595     05  FILLER            PIC  X(0003).
  3596     05  ADDR2B2O PIC  X(0030).
  3597*    -------------------------------
  3598     05  FILLER            PIC  X(0003).
  3599     05  CITYSTBO PIC  X(0030).
  3600*    -------------------------------
  3601     05  FILLER            PIC  X(0003).
  3602     05  CITYST2O PIC  X(0030).
  3603*    -------------------------------
  3604     05  FILLER            PIC  X(0003).
  3605     05  ZIPBO PIC  ZZZZ99999.
  3606*    -------------------------------
  3607     05  FILLER            PIC  X(0003).
  3608     05  ZIPB2O PIC  ZZZZZZZZZ.
  3609*    -------------------------------
  3610     05  FILLER            PIC  X(0003).
  3611     05  INTHDBO PIC  X(0012).
  3612*    -------------------------------
  3613     05  FILLER            PIC  X(0003).
  3614     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3615*    -------------------------------
  3616     05  FILLER            PIC  X(0003).
  3617     05  PMTHDGBO PIC  X(0034).
  3618*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  72
* EL156.cbl
  3619     05  FILLER            PIC  X(0003).
  3620     05  CLMNOBO PIC  X(0007).
  3621*    -------------------------------
  3622     05  FILLER            PIC  X(0003).
  3623     05  CARRBO PIC  X(0001).
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  CERTNOBO PIC  X(0010).
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  SUFXBO PIC  X(0001).
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  CLMTYPBO PIC  X(0006).
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  INCURBO PIC  X(0008).
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  PYFROMBO PIC  99B99B99.
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  PYTHRUBO PIC  99B99B99.
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  DAYSBO PIC  X(0005).
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  BYBO PIC  X(0004).
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  PROOFDBO PIC  99B99B99.
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  ACCTBO PIC  X(0010).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  STATEBO PIC  X(0002).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  GROUPBO PIC  X(0006).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  ACARRBO PIC  X(0001).
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  ACCTNMBO PIC  X(0030).
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  UNDISBO PIC  ZZZ,Z99.99.
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  RATEBO PIC  ZZZ.99.
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  ERMSG1BO PIC  X(0072).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  73
* EL156.cbl
  3677     05  ENTPFBO PIC  X(0002).
  3678*    -------------------------------
  3679****************************************************************
  3680*
  3681* Copyright (c) 2007 by Clerity Solutions, Inc.
  3682* All rights reserved.
  3683*
  3684****************************************************************
  3685 01  DFHEIV.
  3686   02  DFHEIV0               PIC X(35).
  3687   02  DFHEIV1               PIC X(08).
  3688   02  DFHEIV2               PIC X(08).
  3689   02  DFHEIV3               PIC X(08).
  3690   02  DFHEIV4               PIC X(06).
  3691   02  DFHEIV5               PIC X(04).
  3692   02  DFHEIV6               PIC X(04).
  3693   02  DFHEIV7               PIC X(02).
  3694   02  DFHEIV8               PIC X(02).
  3695   02  DFHEIV9               PIC X(01).
  3696   02  DFHEIV10              PIC S9(7) COMP-3.
  3697   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3698   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3699   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3700   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3701   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3702   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3703   02  DFHEIV17              PIC X(04).
  3704   02  DFHEIV18              PIC X(04).
  3705   02  DFHEIV19              PIC X(04).
  3706   02  DFHEIV20              USAGE IS POINTER.
  3707   02  DFHEIV21              USAGE IS POINTER.
  3708   02  DFHEIV22              USAGE IS POINTER.
  3709   02  DFHEIV23              USAGE IS POINTER.
  3710   02  DFHEIV24              USAGE IS POINTER.
  3711   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3712   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3713   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3714   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3715   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3716   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3717   02  FILLER                PIC X(02).
  3718   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3719   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3720   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3721   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3722   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3723 LINKAGE  SECTION.
  3724*****************************************************************
  3725*                                                               *
  3726* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3727* All rights reserved.                                          *
  3728*                                                               *
  3729*****************************************************************
  3730 01  dfheiblk.
  3731     02  eibtime          pic s9(7) comp-3.
  3732     02  eibdate          pic s9(7) comp-3.
  3733     02  eibtrnid         pic x(4).
  3734     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  74
* EL156.cbl
  3735     02  eibtrmid         pic x(4).
  3736     02  dfheigdi         pic s9(4) comp.
  3737     02  eibcposn         pic s9(4) comp.
  3738     02  eibcalen         pic s9(4) comp.
  3739     02  eibaid           pic x(1).
  3740     02  eibfiller1       pic x(1).
  3741     02  eibfn            pic x(2).
  3742     02  eibfiller2       pic x(2).
  3743     02  eibrcode         pic x(6).
  3744     02  eibfiller3       pic x(2).
  3745     02  eibds            pic x(8).
  3746     02  eibreqid         pic x(8).
  3747     02  eibrsrce         pic x(8).
  3748     02  eibsync          pic x(1).
  3749     02  eibfree          pic x(1).
  3750     02  eibrecv          pic x(1).
  3751     02  eibsend          pic x(1).
  3752     02  eibatt           pic x(1).
  3753     02  eibeoc           pic x(1).
  3754     02  eibfmh           pic x(1).
  3755     02  eibcompl         pic x(1).
  3756     02  eibsig           pic x(1).
  3757     02  eibconf          pic x(1).
  3758     02  eiberr           pic x(1).
  3759     02  eibrldbk         pic x(1).
  3760     02  eiberrcd         pic x(4).
  3761     02  eibsynrb         pic x(1).
  3762     02  eibnodat         pic x(1).
  3763     02  eibfiller5       pic x(2).
  3764     02  eibresp          pic 9(09) comp.
  3765     02  eibresp2         pic 9(09) comp.
  3766     02  dfheigdj         pic s9(4) comp.
  3767     02  dfheigdk         pic s9(4) comp.
  3768 01  DFHCOMMAREA             PIC X(1024).
  3769
  3770*    COPY ELCMSTR.
  3771******************************************************************
  3772*                                                                *
  3773*                            ELCMSTR.                            *
  3774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3775*                            VMOD=2.012                          *
  3776*                                                                *
  3777*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3778*                                                                *
  3779*   FILE TYPE = VSAM,KSDS                                        *
  3780*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3781*                                                                *
  3782*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3783*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3784*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3785*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3786*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3787*                                                 RKP=75,LEN=21  *
  3788*                                                                *
  3789*   **** NOTE ****                                               *
  3790*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3791*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3792*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  75
* EL156.cbl
  3793*   LOG = YES                                                    *
  3794*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3795******************************************************************
  3796*                   C H A N G E   L O G
  3797*
  3798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3799*-----------------------------------------------------------------
  3800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3801* EFFECTIVE    NUMBER
  3802*-----------------------------------------------------------------
  3803* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3804* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3805* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3806******************************************************************
  3807 01  CLAIM-MASTER.
  3808     12  CL-RECORD-ID                PIC XX.
  3809         88  VALID-CL-ID         VALUE 'CL'.
  3810
  3811     12  CL-CONTROL-PRIMARY.
  3812         16  CL-COMPANY-CD           PIC X.
  3813         16  CL-CARRIER              PIC X.
  3814         16  CL-CLAIM-NO             PIC X(7).
  3815         16  CL-CERT-NO.
  3816             20  CL-CERT-PRIME       PIC X(10).
  3817             20  CL-CERT-SFX         PIC X.
  3818
  3819     12  CL-CONTROL-BY-NAME.
  3820         16  CL-COMPANY-CD-A1        PIC X.
  3821         16  CL-INSURED-LAST-NAME    PIC X(15).
  3822         16  CL-INSURED-NAME.
  3823             20  CL-INSURED-1ST-NAME PIC X(12).
  3824             20  CL-INSURED-MID-INIT PIC X.
  3825
  3826     12  CL-CONTROL-BY-SSN.
  3827         16  CL-COMPANY-CD-A2        PIC X.
  3828         16  CL-SOC-SEC-NO.
  3829             20  CL-SSN-STATE        PIC XX.
  3830             20  CL-SSN-ACCOUNT      PIC X(6).
  3831             20  CL-SSN-LN3          PIC X(3).
  3832
  3833     12  CL-CONTROL-BY-CERT-NO.
  3834         16  CL-COMPANY-CD-A4        PIC X.
  3835         16  CL-CERT-NO-A4.
  3836             20  CL-CERT-A4-PRIME    PIC X(10).
  3837             20  CL-CERT-A4-SFX      PIC X.
  3838
  3839     12  CL-CONTROL-BY-CCN.
  3840         16  CL-COMPANY-CD-A5        PIC X.
  3841         16  CL-CCN-A5.
  3842             20  CL-CCN.
  3843                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3844                 24  CL-CCN-PRIME-A5 PIC X(12).
  3845             20  CL-CCN-FILLER-A5    PIC X(4).
  3846
  3847     12  CL-INSURED-PROFILE-DATA.
  3848         16  CL-INSURED-BIRTH-DT     PIC XX.
  3849         16  CL-INSURED-SEX-CD       PIC X.
  3850             88  INSURED-IS-MALE        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  76
* EL156.cbl
  3851             88  INSURED-IS-FEMALE      VALUE 'F'.
  3852             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3853         16  CL-INSURED-OCC-CD       PIC X(6).
  3854         16  FILLER                  PIC X(5).
  3855
  3856     12  CL-PROCESSING-INFO.
  3857         16  CL-PROCESSOR-ID         PIC X(4).
  3858         16  CL-CLAIM-STATUS         PIC X.
  3859             88  CLAIM-IS-OPEN          VALUE 'O'.
  3860             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3861         16  CL-CLAIM-TYPE           PIC X.
  3862*            88  AH-CLAIM               VALUE 'A'.
  3863*            88  LIFE-CLAIM             VALUE 'L'.
  3864*            88  PROPERTY-CLAIM         VALUE 'P'.
  3865*            88  IUI-CLAIM              VALUE 'I'.
  3866*            88  GAP-CLAIM              VALUE 'G'.
  3867         16  CL-CLAIM-PREM-TYPE      PIC X.
  3868             88  SINGLE-PREMIUM         VALUE '1'.
  3869             88  O-B-COVERAGE           VALUE '2'.
  3870             88  OPEN-END-COVERAGE      VALUE '3'.
  3871         16  CL-INCURRED-DT          PIC XX.
  3872         16  CL-REPORTED-DT          PIC XX.
  3873         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3874         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3875         16  CL-LAST-PMT-DT          PIC XX.
  3876         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3877         16  CL-PAID-THRU-DT         PIC XX.
  3878         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3879         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3880         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3881         16  CL-PMT-CALC-METHOD      PIC X.
  3882             88  CL-360-DAY-YR          VALUE '1'.
  3883             88  CL-365-DAY-YR          VALUE '2'.
  3884             88  CL-FULL-MONTHS         VALUE '3'.
  3885         16  CL-CAUSE-CD             PIC X(6).
  3886
  3887         16  CL-PRIME-CERT-NO.
  3888             20  CL-PRIME-CERT-PRIME PIC X(10).
  3889             20  CL-PRIME-CERT-SFX   PIC X.
  3890
  3891         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3892             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3893             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3894
  3895         16  CL-MICROFILM-NO         PIC X(10).
  3896         16  CL-PROG-FORM-TYPE       PIC X.
  3897         16  CL-LAST-ADD-ON-DT       PIC XX.
  3898
  3899         16  CL-LAST-REOPEN-DT       PIC XX.
  3900         16  CL-LAST-CLOSE-DT        PIC XX.
  3901         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3902             88  FINAL-PAID             VALUE '1'.
  3903             88  CLAIM-DENIED           VALUE '2'.
  3904             88  AUTO-CLOSE             VALUE '3'.
  3905             88  MANUAL-CLOSE           VALUE '4'.
  3906             88  BENEFITS-CHANGED       VALUE 'C'.
  3907             88  SETUP-ERRORS           VALUE 'E'.
  3908         16  CL-ASSOC-CERT-SEQU      PIC S99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  77
* EL156.cbl
  3909         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3910         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3911             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3912         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3913         16  FILLER                  PIC X.
  3914
  3915     12  CL-CERTIFICATE-DATA.
  3916         16  CL-CERT-ORIGIN          PIC X.
  3917             88  CERT-WAS-ONLINE        VALUE '1'.
  3918             88  CERT-WAS-CREATED       VALUE '2'.
  3919             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3920         16  CL-CERT-KEY-DATA.
  3921             20  CL-CERT-CARRIER     PIC X.
  3922             20  CL-CERT-GROUPING    PIC X(6).
  3923             20  CL-CERT-STATE       PIC XX.
  3924             20  CL-CERT-ACCOUNT.
  3925                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3926                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3927             20  CL-CERT-EFF-DT      PIC XX.
  3928
  3929     12  CL-STATUS-CONTROLS.
  3930         16  CL-PRIORITY-CD          PIC X.
  3931             88  CONFIDENTIAL-DATA      VALUE '8'.
  3932             88  HIGHEST-PRIORITY       VALUE '9'.
  3933         16  CL-SUPV-ATTN-CD         PIC X.
  3934             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3935             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3936         16  CL-PURGED-DT            PIC XX.
  3937         16  CL-RESTORED-DT          PIC XX.
  3938         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3939         16  CL-NEXT-RESEND-DT       PIC XX.
  3940         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3941         16  CL-CRITICAL-PERIOD      PIC 99.
  3942*        16  FILLER                  PIC XX.
  3943         16  CL-LAST-MAINT-DT        PIC XX.
  3944         16  CL-LAST-MAINT-USER      PIC X(4).
  3945         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3946         16  CL-LAST-MAINT-TYPE      PIC X.
  3947             88  CLAIM-SET-UP           VALUE ' '.
  3948             88  PAYMENT-MADE           VALUE '1'.
  3949             88  LETTER-SENT            VALUE '2'.
  3950             88  MASTER-WAS-ALTERED     VALUE '3'.
  3951             88  MASTER-WAS-RESTORED    VALUE '4'.
  3952             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3953             88  FILE-CONVERTED         VALUE '6'.
  3954             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3955             88  ERROR-CORRECTION       VALUE 'E'.
  3956         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3957         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3958         16  CL-BENEFICIARY          PIC X(10).
  3959         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3960         16  CL-DENIAL-TYPE          PIC X.
  3961             88  CL-TYPE-DENIAL          VALUE '1'.
  3962             88  CL-TYPE-RESCISSION      VALUE '2'.
  3963             88  CL-TYPE-REFORMATION     VALUE '3'.
  3964             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3965             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3966         16  CL-CRIT-PER-RECURRENT   PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  78
* EL156.cbl
  3967         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3968         16  CL-RTW-DT               PIC XX.
  3969
  3970     12  CL-TRAILER-CONTROLS.
  3971         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3972             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3973             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3974             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3975         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3976         16  FILLER                  PIC XX.
  3977         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3978         16  CL-ADDRESS-TRAILER-CNT.
  3979             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3980                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3981             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3982                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3983             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3984                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3985             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3986                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3987             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3988                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3989             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3990                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3991             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3992                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3993
  3994     12  CL-CV-REFERENCE-NO.
  3995         16  CL-CV-REFNO-PRIME       PIC X(18).
  3996         16  CL-CV-REFNO-SFX         PIC XX.
  3997
  3998     12  CL-FILE-LOCATION            PIC X(4).
  3999
  4000     12  CL-PROCESS-ERRORS.
  4001         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4002             88  NO-FATAL-ERRORS        VALUE ZERO.
  4003         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4004             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4005
  4006     12  CL-PRODUCT-CD               PIC X.
  4007
  4008     12  CL-CURRENT-KEY-DATA.
  4009         16  CL-CURRENT-CARRIER      PIC X.
  4010         16  CL-CURRENT-GROUPING     PIC X(6).
  4011         16  CL-CURRENT-STATE        PIC XX.
  4012         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4013
  4014     12  CL-ASSOCIATES               PIC X.
  4015         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4016         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4017         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4018         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4019
  4020     12  CL-ACTIVITY-CODE            PIC 99.
  4021     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4022     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4023
  4024     12  CL-LAPSE-REPORT-CODE        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  79
* EL156.cbl
  4025     12  CL-LAG-REPORT-CODE          PIC 9.
  4026     12  CL-LOAN-TYPE                PIC XX.
  4027     12  CL-LEGAL-STATE              PIC XX.
  4028
  4029     12  CL-YESNOSW                  PIC X.
  4030     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4031         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4032         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4033         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4034     12  cl-insured-claim            pic x.
  4035         88  cl-claim-on-primary         value 'P'.
  4036         88  cl-claim-on-secondary       value 'S'.
  4037     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  80
* EL156.cbl
  4039*    COPY ELCCNTL.
  4040******************************************************************
  4041*                                                                *
  4042*                                                                *
  4043*                            ELCCNTL.                            *
  4044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4045*                            VMOD=2.059                          *
  4046*                                                                *
  4047*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4048*                                                                *
  4049*   FILE TYPE = VSAM,KSDS                                        *
  4050*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4051*                                                                *
  4052*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4053*       ALTERNATE INDEX = NONE                                   *
  4054*                                                                *
  4055*   LOG = YES                                                    *
  4056*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4057******************************************************************
  4058*                   C H A N G E   L O G
  4059*
  4060* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4061*-----------------------------------------------------------------
  4062*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4063* EFFECTIVE    NUMBER
  4064*-----------------------------------------------------------------
  4065* 082503                   PEMA  ADD BENEFIT GROUP
  4066* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4067* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4068* 092705    2005050300006  PEMA  ADD SPP LEASES
  4069* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4070* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4071* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4072* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4073* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4074* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4075* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4076* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4077* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4078******************************************************************
  4079*
  4080 01  CONTROL-FILE.
  4081     12  CF-RECORD-ID                       PIC XX.
  4082         88  VALID-CF-ID                        VALUE 'CF'.
  4083
  4084     12  CF-CONTROL-PRIMARY.
  4085         16  CF-COMPANY-ID                  PIC XXX.
  4086         16  CF-RECORD-TYPE                 PIC X.
  4087             88  CF-COMPANY-MASTER              VALUE '1'.
  4088             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4089             88  CF-STATE-MASTER                VALUE '3'.
  4090             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4091             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4092             88  CF-CARRIER-MASTER              VALUE '6'.
  4093             88  CF-MORTALITY-MASTER            VALUE '7'.
  4094             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4095             88  CF-TERMINAL-MASTER             VALUE '9'.
  4096             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  81
* EL156.cbl
  4097             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4098             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4099             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4100             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4101             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4102             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4103             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4104             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4105         16  CF-ACCESS-CD-GENL              PIC X(4).
  4106         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4107             20  CF-PROCESSOR               PIC X(4).
  4108         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4109             20  CF-STATE-CODE              PIC XX.
  4110             20  FILLER                     PIC XX.
  4111         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4112             20  FILLER                     PIC XX.
  4113             20  CF-HI-BEN-IN-REC           PIC XX.
  4114         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4115             20  FILLER                     PIC XXX.
  4116             20  CF-CARRIER-CNTL            PIC X.
  4117         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4118             20  FILLER                     PIC XX.
  4119             20  CF-HI-TYPE-IN-REC          PIC 99.
  4120         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4121             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4122                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4123             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4124             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4125         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4126             20  FILLER                     PIC X.
  4127             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4128         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4129             20  FILLER                     PIC XX.
  4130             20  CF-MORTGAGE-PLAN           PIC XX.
  4131         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4132
  4133     12  CF-LAST-MAINT-DT                   PIC XX.
  4134     12  CF-LAST-MAINT-BY                   PIC X(4).
  4135     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4136
  4137     12  CF-RECORD-BODY                     PIC X(728).
  4138
  4139
  4140****************************************************************
  4141*             COMPANY MASTER RECORD                            *
  4142****************************************************************
  4143
  4144     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4145         16  CF-COMPANY-ADDRESS.
  4146             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4147             20  CF-CL-IN-CARE-OF           PIC X(30).
  4148             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4149             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4150             20  CF-CL-CITY-STATE           PIC X(30).
  4151             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4152             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4153         16  CF-COMPANY-CD                  PIC X.
  4154         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  82
* EL156.cbl
  4155         16  CF-SECURITY-OPTION             PIC X.
  4156             88  ALL-SECURITY                   VALUE '1'.
  4157             88  COMPANY-VERIFY                 VALUE '2'.
  4158             88  PROCESSOR-VERIFY               VALUE '3'.
  4159             88  NO-SECURITY                    VALUE '4'.
  4160             88  ALL-BUT-TERM                   VALUE '5'.
  4161         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4162             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4163         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4164             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4165         16  CF-INFORCE-LOCATION            PIC X.
  4166             88  CERTS-ARE-ONLINE               VALUE '1'.
  4167             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4168             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4169         16  CF-LOWER-CASE-LETTERS          PIC X.
  4170         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4171             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4172             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4173             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4174             88  CF-ACCNT-CNTL                  VALUE '3'.
  4175             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4176
  4177         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4178         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4179
  4180         16  CF-LGX-CREDIT-USER             PIC X.
  4181             88  CO-IS-NOT-USER                 VALUE 'N'.
  4182             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4183
  4184         16 CF-CREDIT-CALC-CODES.
  4185             20  CF-CR-REM-TERM-CALC PIC X.
  4186               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4187               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4188               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4189               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4190               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4191               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4192               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4193             20  CF-CR-R78-METHOD           PIC X.
  4194               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4195               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4196
  4197         16  CF-CLAIM-CONTROL-COUNTS.
  4198             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4199                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4200
  4201             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4202                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4203
  4204             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4205                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4206
  4207             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4208                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4209
  4210         16  CF-CURRENT-MONTH-END           PIC XX.
  4211
  4212         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  83
* EL156.cbl
  4213             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4214             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4215             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4216             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4217                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4218                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4219             20  CF-CO-PREM-REJECT-SW       PIC X.
  4220                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4221                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4222             20  CF-CO-REF-REJECT-SW        PIC X.
  4223                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4224                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4225
  4226         16  CF-CO-REPORTING-DT             PIC XX.
  4227         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4228         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4229           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4230           88  CF-CO-MONTH-END                  VALUE '1'.
  4231
  4232         16  CF-LGX-CLAIM-USER              PIC X.
  4233             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4234             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4235
  4236         16  CF-CREDIT-EDIT-CONTROLS.
  4237             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4238             20  CF-MIN-AGE                 PIC 99.
  4239             20  CF-DEFAULT-AGE             PIC 99.
  4240             20  CF-MIN-TERM                PIC S999      COMP-3.
  4241             20  CF-MAX-TERM                PIC S999      COMP-3.
  4242             20  CF-DEFAULT-SEX             PIC X.
  4243             20  CF-JOINT-AGE-INPUT         PIC X.
  4244                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4245             20  CF-BIRTH-DATE-INPUT        PIC X.
  4246                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4247             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4248                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4249                 88  CF-ZERO-CARRIER            VALUE '1'.
  4250                 88  CF-ZERO-GROUPING           VALUE '2'.
  4251                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4252             20  CF-EDIT-SW                 PIC X.
  4253                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4254             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4255             20  CF-CR-PR-METHOD            PIC X.
  4256               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4257               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4258             20  FILLER                     PIC X.
  4259
  4260         16  CF-CREDIT-MISC-CONTROLS.
  4261             20  CF-REIN-TABLE-SW           PIC X.
  4262                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4263             20  CF-COMP-TABLE-SW           PIC X.
  4264                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4265             20  CF-EXPERIENCE-RETENTION-AGE
  4266                                            PIC S9        COMP-3.
  4267             20  CF-CONVERSION-DT           PIC XX.
  4268             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4269             20  CF-RUN-FREQUENCY-SW        PIC X.
  4270                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  84
* EL156.cbl
  4271                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4272
  4273             20  CF-CR-CHECK-NO-CONTROL.
  4274                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4275                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4276                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4277                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4278                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4279                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4280
  4281                 24  CF-CR-CHECK-COUNT       REDEFINES
  4282                     CF-CR-CHECK-COUNTER      PIC X(4).
  4283
  4284                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4285                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4286
  4287                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4288                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4289                 24  CF-MAIL-PROCESSING       PIC X.
  4290                     88  MAIL-PROCESSING          VALUE 'Y'.
  4291
  4292         16  CF-MISC-SYSTEM-CONTROL.
  4293             20  CF-SYSTEM-C                 PIC X.
  4294                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4295             20  CF-SYSTEM-D                 PIC X.
  4296                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4297             20  CF-SOC-SEC-NO-SW            PIC X.
  4298                 88  SOC-SEC-NO-USED             VALUE '1'.
  4299             20  CF-MEMBER-NO-SW             PIC X.
  4300                 88  MEMBER-NO-USED              VALUE '1'.
  4301             20  CF-TAX-ID-NUMBER            PIC X(11).
  4302             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4303             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4304                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4305                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4306                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4307                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4308             20  CF-SYSTEM-E                 PIC X.
  4309                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4310
  4311         16  CF-LGX-LIFE-USER               PIC X.
  4312             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4313             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4314
  4315         16  CF-CR-MONTH-END-DT             PIC XX.
  4316
  4317         16  CF-FILE-MAINT-DATES.
  4318             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4319                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4320             20  CF-LAST-BATCH       REDEFINES
  4321                 CF-LAST-BATCH-NO               PIC X(4).
  4322             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4323             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4324             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4325             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4326             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4327             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4328             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  85
* EL156.cbl
  4329             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4330             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4331             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4332
  4333         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4334         16  FILLER                         PIC X.
  4335
  4336         16  CF-ALT-MORT-CODE               PIC X(4).
  4337         16  CF-MEMBER-CAPTION              PIC X(10).
  4338
  4339         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4340             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4341             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4342             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4343             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4344             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4345
  4346         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4347
  4348         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4349         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4350         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4351         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4352
  4353         16  CF-AH-OVERRIDE-L1              PIC X.
  4354         16  CF-AH-OVERRIDE-L2              PIC XX.
  4355         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4356         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4357
  4358         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4359         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4360
  4361         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4362         16  CF-AR-LAST-EL860-DT            PIC XX.
  4363         16  CF-MP-MONTH-END-DT             PIC XX.
  4364
  4365         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4366         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4367             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4368
  4369         16  CF-AR-MONTH-END-DT             PIC XX.
  4370
  4371         16  CF-CRDTCRD-USER                PIC X.
  4372             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4373             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4374
  4375         16  CF-CC-MONTH-END-DT             PIC XX.
  4376
  4377         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4378
  4379         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4380             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4381             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4382             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4383         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4384         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4385         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4386         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  86
* EL156.cbl
  4387             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4388             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4389         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4390         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4391         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4392             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4393         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4394
  4395         16  CF-CL-ZIP-CODE.
  4396             20  CF-CL-ZIP-PRIME.
  4397                 24  CF-CL-ZIP-1ST          PIC X.
  4398                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4399                 24  FILLER                 PIC X(4).
  4400             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4401         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4402             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4403             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4404             20  FILLER                     PIC XXX.
  4405
  4406         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4407         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4408         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4409         16  CF-CO-OPTION-START-DATE        PIC XX.
  4410         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4411           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4412                                                      '3' '4'.
  4413           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4414           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4415           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4416           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4417           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4418           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4419
  4420         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4421
  4422         16  CF-PAYMENT-APPROVAL-LEVELS.
  4423             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4424             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4425             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4426             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4427             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4428             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4429
  4430         16  CF-END-USER-REPORTING-USER     PIC X.
  4431             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4432             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4433
  4434         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4435             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4436             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4437
  4438         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4439
  4440         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4441         16  FILLER                         PIC X.
  4442
  4443         16  CF-CREDIT-ARCHIVE-CNTL.
  4444             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  87
* EL156.cbl
  4445             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4446             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4447
  4448         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4449
  4450         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4451             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4452             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4453
  4454         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4455             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4456             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4457
  4458         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4459
  4460         16  CF-CO-ACH-ID-CODE              PIC  X.
  4461             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4462             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4463             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4464         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4465         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4466         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4467         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4468         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4469         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4470         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4471         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4472         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4473                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4474         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4475                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4476
  4477         16  CF-CO-OVER-SHORT.
  4478             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4479             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4480
  4481*         16  FILLER                         PIC X(102).
  4482         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4483             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4484             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4485
  4486         16  CF-AH-APPROVAL-DAYS.
  4487             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4488             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4489             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4490             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4491
  4492         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4493
  4494         16  CF-APPROV-LEV-5.
  4495             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4496             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4497             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4498
  4499         16  FILLER                         PIC X(68).
  4500****************************************************************
  4501*             PROCESSOR/USER RECORD                            *
  4502****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  88
* EL156.cbl
  4503
  4504     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4505         16  CF-PROCESSOR-NAME              PIC X(30).
  4506         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4507         16  CF-PROCESSOR-TITLE             PIC X(26).
  4508         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4509                 88  MESSAGE-YES                VALUE 'Y'.
  4510                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4511
  4512*****************************************************
  4513****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4514****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4515****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4516****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4517*****************************************************
  4518
  4519         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4520             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4521             20  CF-APPLICATION-FORCE       PIC X.
  4522             20  CF-INDIVIDUAL-APP.
  4523                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4524                     28  CF-BROWSE-APP      PIC X.
  4525                     28  CF-UPDATE-APP      PIC X.
  4526
  4527         16  CF-CURRENT-TERM-ON             PIC X(4).
  4528         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4529             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4530             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4531             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4532             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4533             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4534             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4535             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4536         16  CF-PROCESSOR-CARRIER           PIC X.
  4537             88  NO-CARRIER-SECURITY            VALUE ' '.
  4538         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4539             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4540         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4541             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4542         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4543             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4544
  4545         16  CF-PROC-SYS-ACCESS-SW.
  4546             20  CF-PROC-CREDIT-CLAIMS-SW.
  4547                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4548                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4549                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4550                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4551             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4552                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4553                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4554             20  CF-PROC-LIFE-GNRLDGR-SW.
  4555                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4556                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4557                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4558                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4559             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4560                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  89
* EL156.cbl
  4561                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4562         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4563             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4564             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4565         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4566
  4567         16  CF-APPROVAL-LEVEL                  PIC X.
  4568             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4569             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4570             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4571             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4572             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4573
  4574         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4575
  4576         16  CF-LANGUAGE-TYPE                   PIC X.
  4577             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4578             88  CF-LANG-IS-FR                      VALUE 'F'.
  4579
  4580         16  CF-CSR-IND                         PIC X.
  4581         16  FILLER                             PIC X(239).
  4582
  4583****************************************************************
  4584*             PROCESSOR/REMINDERS RECORD                       *
  4585****************************************************************
  4586
  4587     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4588         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4589             20  CF-START-REMIND-DT         PIC XX.
  4590             20  CF-END-REMIND-DT           PIC XX.
  4591             20  CF-REMINDER-TEXT           PIC X(50).
  4592         16  FILLER                         PIC X(296).
  4593
  4594
  4595****************************************************************
  4596*             STATE MASTER RECORD                              *
  4597****************************************************************
  4598
  4599     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4600         16  CF-STATE-ABBREVIATION          PIC XX.
  4601         16  CF-STATE-NAME                  PIC X(25).
  4602         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4603         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4604             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4605             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4606             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4607             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4608                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4609                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4610             20  CF-ST-PREM-REJECT-SW       PIC X.
  4611                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4612                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4613             20  CF-ST-REF-REJECT-SW        PIC X.
  4614                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4615                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4616         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4617         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4618         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  90
* EL156.cbl
  4619             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4620             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4621             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4622         16  CF-ST-FST-PMT-EXTENSION.
  4623             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4624             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4625                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4626                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4627                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4628                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4629         16  CF-ST-STATE-CALL.
  4630             20  CF-ST-CALL-UNEARNED        PIC X.
  4631             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4632             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4633         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4634             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4635             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4636         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4637         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4638         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4639         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4640         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4641         16  FILLER                         PIC X.
  4642         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4643             20  CF-ST-BENEFIT-CD           PIC XX.
  4644             20  CF-ST-BENEFIT-KIND         PIC X.
  4645                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4646                 88  CF-ST-AH-KIND              VALUE 'A'.
  4647             20  CF-ST-REM-TERM-CALC        PIC X.
  4648                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4649                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4650                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4651                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4652                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4653                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4654                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4655                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4656
  4657             20  CF-ST-REFUND-CALC          PIC X.
  4658                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4659                 88  ST-REFD-BY-R78             VALUE '1'.
  4660                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4661                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4662                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4663                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4664                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4665                 88  ST-REFD-UTAH               VALUE '7'.
  4666                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4667                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4668                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4669
  4670             20  CF-ST-EARNING-CALC         PIC X.
  4671                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4672                 88  ST-EARN-BY-R78             VALUE '1'.
  4673                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4674                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4675                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4676                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  91
* EL156.cbl
  4677                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4678                 88  ST-EARN-MEAN               VALUE '8'.
  4679                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4680
  4681             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4682                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4683                 88  ST-OVRD-BY-R78             VALUE '1'.
  4684                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4685                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4686                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4687                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4688                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4689                 88  ST-OVRD-MEAN               VALUE '8'.
  4690                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4691             20  FILLER                     PIC X.
  4692
  4693         16  CF-ST-COMMISSION-CAPS.
  4694             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4695             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4696             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4697             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4698         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4699                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4700
  4701         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4702
  4703         16  CF-ST-STATUTORY-INTEREST.
  4704             20  CF-ST-STAT-DATE-FROM       PIC X.
  4705                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4706                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4707             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4708             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4709             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4710             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4711             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4712
  4713         16  CF-ST-OVER-SHORT.
  4714             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4715             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4716
  4717         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4718
  4719         16  CF-ST-RT-CALC                  PIC X.
  4720
  4721         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4722         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4723         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4724         16  CF-ST-RF-LR-CALC               PIC X.
  4725         16  CF-ST-RF-LL-CALC               PIC X.
  4726         16  CF-ST-RF-LN-CALC               PIC X.
  4727         16  CF-ST-RF-AH-CALC               PIC X.
  4728         16  CF-ST-RF-CP-CALC               PIC X.
  4729*        16  FILLER                         PIC X(206).
  4730*CIDMOD         16  FILLER                         PIC X(192).
  4731         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4732             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4733         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4734         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  92
* EL156.cbl
  4735         16  CF-ST-CAUSAL-STATE             PIC X.
  4736         16  FILLER                         PIC X(185).
  4737
  4738****************************************************************
  4739*             BENEFIT MASTER RECORD                            *
  4740****************************************************************
  4741
  4742     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4743         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4744             20  CF-BENEFIT-CODE            PIC XX.
  4745             20  CF-BENEFIT-NUMERIC  REDEFINES
  4746                 CF-BENEFIT-CODE            PIC XX.
  4747             20  CF-BENEFIT-ALPHA           PIC XXX.
  4748             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4749             20  CF-BENEFIT-COMMENT         PIC X(10).
  4750
  4751             20  CF-LF-COVERAGE-TYPE        PIC X.
  4752                 88  CF-REDUCING                VALUE 'R'.
  4753                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4754
  4755             20  CF-SPECIAL-CALC-CD         PIC X.
  4756                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4757                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4758                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4759                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4760                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4761                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4762                 88  CF-FARM-PLAN               VALUE 'F'.
  4763                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4764                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4765                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4766                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4767                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4768                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4769                 88  CF-PRUDENTIAL              VALUE 'P'.
  4770                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4771                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4772                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4773                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4774                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4775                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4776
  4777             20  CF-JOINT-INDICATOR         PIC X.
  4778                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4779
  4780*            20  FILLER                     PIC X(12).
  4781             20  FILLER                     PIC X(11).
  4782             20  CF-BENEFIT-CATEGORY        PIC X.
  4783             20  CF-LOAN-TYPE               PIC X(8).
  4784
  4785             20  CF-CO-REM-TERM-CALC        PIC X.
  4786                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4787                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4788                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4789                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4790                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4791
  4792             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  93
* EL156.cbl
  4793                 88  CO-EARN-BY-R78             VALUE '1'.
  4794                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4795                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4796                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4797                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4798                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4799                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4800                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4801
  4802             20  CF-CO-REFUND-CALC          PIC X.
  4803                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4804                 88  CO-REFD-BY-R78             VALUE '1'.
  4805                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4806                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4807                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4808                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4809                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4810                 88  CO-REFD-MEAN               VALUE '8'.
  4811                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4812                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4813                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4814
  4815             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4816                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4817                 88  CO-OVRD-BY-R78             VALUE '1'.
  4818                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4819                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4820                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4821                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4822                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4823                 88  CO-OVRD-MEAN               VALUE '8'.
  4824                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4825
  4826             20  CF-CO-BEN-I-G-CD           PIC X.
  4827                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4828                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4829                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4830
  4831         16  FILLER                         PIC X(304).
  4832
  4833
  4834****************************************************************
  4835*             CARRIER MASTER RECORD                            *
  4836****************************************************************
  4837
  4838     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4839         16  CF-ADDRESS-DATA.
  4840             20  CF-MAIL-TO-NAME            PIC X(30).
  4841             20  CF-IN-CARE-OF              PIC X(30).
  4842             20  CF-ADDRESS-LINE-1          PIC X(30).
  4843             20  CF-ADDRESS-LINE-2          PIC X(30).
  4844             20  CF-CITY-STATE              PIC X(30).
  4845             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4846             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4847
  4848         16  CF-CLAIM-NO-CONTROL.
  4849             20  CF-CLAIM-NO-METHOD         PIC X.
  4850                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  94
* EL156.cbl
  4851                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4852                 88  CLAIM-NO-SEQ               VALUE '3'.
  4853                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4854             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4855                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4856                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4857                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4858
  4859         16  CF-CHECK-NO-CONTROL.
  4860             20  CF-CHECK-NO-METHOD         PIC X.
  4861                 88  CHECK-NO-MANUAL            VALUE '1'.
  4862                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4863                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4864                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4865             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4866                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4867
  4868         16  CF-DOMICILE-STATE              PIC XX.
  4869
  4870         16  CF-EXPENSE-CONTROLS.
  4871             20  CF-EXPENSE-METHOD          PIC X.
  4872                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4873                 88  DOLLARS-PER-PMT            VALUE '2'.
  4874                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4875                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4876             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4877             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4878
  4879         16  CF-CORRESPONDENCE-CONTROL.
  4880             20  CF-LETTER-RESEND-OPT       PIC X.
  4881                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4882                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4883             20  FILLER                     PIC X(4).
  4884
  4885         16  CF-RESERVE-CONTROLS.
  4886             20  CF-MANUAL-SW               PIC X.
  4887                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4888             20  CF-FUTURE-SW               PIC X.
  4889                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4890             20  CF-PTC-SW                  PIC X.
  4891                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4892             20  CF-IBNR-SW                 PIC X.
  4893                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4894             20  CF-PTC-LF-SW               PIC X.
  4895                 88  CF-LF-PTC-USED             VALUE '1'.
  4896             20  CF-CDT-ACCESS-METHOD       PIC X.
  4897                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4898                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4899                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4900             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4901
  4902         16  CF-CLAIM-CALC-METHOD           PIC X.
  4903             88  360-PLUS-MONTHS                VALUE '1'.
  4904             88  365-PLUS-MONTHS                VALUE '2'.
  4905             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4906             88  360-DAILY                      VALUE '4'.
  4907             88  365-DAILY                      VALUE '5'.
  4908
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  95
* EL156.cbl
  4909         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4910         16  FILLER                         PIC X(11).
  4911
  4912         16  CF-LIMIT-AMOUNTS.
  4913             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4914             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4915             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4916             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4917             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4918             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4919             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4920             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4921             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4922             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4923
  4924         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4925         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4926         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4927
  4928         16  CF-ZIP-CODE.
  4929             20  CF-ZIP-PRIME.
  4930                 24  CF-ZIP-1ST             PIC X.
  4931                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4932                 24  FILLER                 PIC X(4).
  4933             20  CF-ZIP-PLUS4               PIC X(4).
  4934         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4935             20  CF-CAN-POSTAL-1            PIC XXX.
  4936             20  CF-CAN-POSTAL-2            PIC XXX.
  4937             20  FILLER                     PIC XXX.
  4938
  4939         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4940         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4941         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4942
  4943         16  CF-RATING-SWITCH               PIC X.
  4944             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4945             88  CF-NO-RATING                   VALUE 'N'.
  4946
  4947         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4948
  4949         16  CF-CARRIER-OVER-SHORT.
  4950             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4951             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4952
  4953         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4954         16  CF-SECPAY-SWITCH               PIC X.
  4955             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4956             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4957         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4958         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4959         16  FILLER                         PIC X(444).
  4960*        16  FILLER                         PIC X(452).
  4961
  4962
  4963****************************************************************
  4964*             MORTALITY MASTER RECORD                          *
  4965****************************************************************
  4966
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  96
* EL156.cbl
  4967     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4968         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4969                                INDEXED BY CF-MORT-NDX.
  4970             20  CF-MORT-TABLE              PIC X(5).
  4971             20  CF-MORT-TABLE-TYPE         PIC X.
  4972                 88  CF-MORT-JOINT              VALUE 'J'.
  4973                 88  CF-MORT-SINGLE             VALUE 'S'.
  4974                 88  CF-MORT-COMBINED           VALUE 'C'.
  4975                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4976                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4977             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4978             20  CF-MORT-AGE-METHOD         PIC XX.
  4979                 88  CF-AGE-LAST                VALUE 'AL'.
  4980                 88  CF-AGE-NEAR                VALUE 'AN'.
  4981             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4982             20  CF-MORT-ADJUSTMENT-DIRECTION
  4983                                            PIC X.
  4984                 88  CF-MINUS                   VALUE '-'.
  4985                 88  CF-PLUS                    VALUE '+'.
  4986             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4987             20  CF-MORT-JOINT-CODE         PIC X.
  4988                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4989             20  CF-MORT-PC-Q               PIC X.
  4990                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4991             20  CF-MORT-TABLE-CODE         PIC X(4).
  4992             20  CF-MORT-COMMENTS           PIC X(15).
  4993             20  FILLER                     PIC X(14).
  4994
  4995         16  FILLER                         PIC X(251).
  4996
  4997
  4998****************************************************************
  4999*             BUSSINESS TYPE MASTER RECORD                     *
  5000****************************************************************
  5001
  5002     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5003* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5004* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5005* AND RECORD 05 IS TYPES 81-99
  5006         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5007             20  CF-BUSINESS-TITLE          PIC  X(19).
  5008             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5009                                            PIC S9V9(4) COMP-3.
  5010             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5011             20  FILLER                     PIC  X.
  5012         16  FILLER                         PIC  X(248).
  5013
  5014
  5015****************************************************************
  5016*             TERMINAL MASTER RECORD                           *
  5017****************************************************************
  5018
  5019     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5020
  5021         16  CF-COMPANY-TERMINALS.
  5022             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5023                                  PIC X(4).
  5024         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  97
* EL156.cbl
  5025
  5026
  5027****************************************************************
  5028*             LIFE EDIT MASTER RECORD                          *
  5029****************************************************************
  5030
  5031     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5032         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5033             20  CF-LIFE-CODE-IN            PIC XX.
  5034             20  CF-LIFE-CODE-OUT           PIC XX.
  5035         16  FILLER                         PIC X(248).
  5036
  5037
  5038****************************************************************
  5039*             AH EDIT MASTER RECORD                            *
  5040****************************************************************
  5041
  5042     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5043         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5044             20  CF-AH-CODE-IN              PIC XXX.
  5045             20  CF-AH-CODE-OUT             PIC XX.
  5046         16  FILLER                         PIC X(248).
  5047
  5048
  5049****************************************************************
  5050*             CREDIBILITY TABLES                               *
  5051****************************************************************
  5052
  5053     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5054         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5055                             INDEXED BY CF-CRDB-NDX.
  5056             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5057             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5058             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5059         16  FILLER                         PIC  X(332).
  5060
  5061
  5062****************************************************************
  5063*             REPORT CUSTOMIZATION RECORD                      *
  5064****************************************************************
  5065
  5066     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5067         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5068             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5069             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5070             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5071**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5072****       A T-TRANSFER.                                   ****
  5073             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5074
  5075         16  FILLER                         PIC XX.
  5076
  5077         16  CF-CARRIER-CNTL-OPT.
  5078             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5079                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5080                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5081             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5082                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  98
* EL156.cbl
  5083         16  CF-GROUP-CNTL-OPT.
  5084             20  CF-GROUP-OPT-SEQ           PIC 9.
  5085                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5086                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5087             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5088                                            PIC X(6).
  5089         16  CF-STATE-CNTL-OPT.
  5090             20  CF-STATE-OPT-SEQ           PIC 9.
  5091                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5092                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5093             20  CF-STATE-SELECT OCCURS 3 TIMES
  5094                                            PIC XX.
  5095         16  CF-ACCOUNT-CNTL-OPT.
  5096             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5097                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5098                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5099             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5100                                            PIC X(10).
  5101         16  CF-BUS-TYP-CNTL-OPT.
  5102             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5103                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5104                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5105             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5106                                            PIC XX.
  5107         16  CF-LF-TYP-CNTL-OPT.
  5108             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5109                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5110                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5111             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5112                                            PIC XX.
  5113         16  CF-AH-TYP-CNTL-OPT.
  5114             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5115                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5116                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5117             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5118                                            PIC XX.
  5119         16  CF-REPTCD1-CNTL-OPT.
  5120             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5121                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5122                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5123             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5124                                            PIC X(10).
  5125         16  CF-REPTCD2-CNTL-OPT.
  5126             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5127                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5128                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5129             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5130                                            PIC X(10).
  5131         16  CF-USER1-CNTL-OPT.
  5132             20  CF-USER1-OPT-SEQ           PIC 9.
  5133                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5134                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5135             20  CF-USER1-SELECT OCCURS 3 TIMES
  5136                                            PIC X(10).
  5137         16  CF-USER2-CNTL-OPT.
  5138             20  CF-USER2-OPT-SEQ           PIC 9.
  5139                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5140                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  99
* EL156.cbl
  5141             20  CF-USER2-SELECT OCCURS 3 TIMES
  5142                                            PIC X(10).
  5143         16  CF-USER3-CNTL-OPT.
  5144             20  CF-USER3-OPT-SEQ           PIC 9.
  5145                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5146                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5147             20  CF-USER3-SELECT OCCURS 3 TIMES
  5148                                            PIC X(10).
  5149         16  CF-USER4-CNTL-OPT.
  5150             20  CF-USER4-OPT-SEQ           PIC 9.
  5151                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5152                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5153             20  CF-USER4-SELECT OCCURS 3 TIMES
  5154                                            PIC X(10).
  5155         16  CF-USER5-CNTL-OPT.
  5156             20  CF-USER5-OPT-SEQ           PIC 9.
  5157                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5158                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5159             20  CF-USER5-SELECT OCCURS 3 TIMES
  5160                                            PIC X(10).
  5161         16  CF-REINS-CNTL-OPT.
  5162             20  CF-REINS-OPT-SEQ           PIC 9.
  5163                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5164                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5165             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5166                 24  CF-REINS-PRIME         PIC XXX.
  5167                 24  CF-REINS-SUB           PIC XXX.
  5168
  5169         16  CF-AGENT-CNTL-OPT.
  5170             20  CF-AGENT-OPT-SEQ           PIC 9.
  5171                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5172                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5173             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5174                                            PIC X(10).
  5175
  5176         16  FILLER                         PIC X(43).
  5177
  5178         16  CF-LOSS-RATIO-SELECT.
  5179             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5180             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5181         16  CF-ENTRY-DATE-SELECT.
  5182             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5183             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5184         16  CF-EFFECTIVE-DATE-SELECT.
  5185             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5186             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5187
  5188         16  CF-EXCEPTION-LIST-IND          PIC X.
  5189             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5190
  5191         16  FILLER                         PIC X(318).
  5192
  5193****************************************************************
  5194*                  EXCEPTION REPORTING RECORD                  *
  5195****************************************************************
  5196
  5197     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5198         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 100
* EL156.cbl
  5199             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5200
  5201         16  CF-COMBINED-LIFE-AH-OPT.
  5202             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5203             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5204             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5205             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5206
  5207         16  CF-LIFE-OPT.
  5208             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5209             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5210             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5211             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5212             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5213             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5214             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5215             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5216             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5217             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5218
  5219         16  CF-AH-OPT.
  5220             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5221             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5222             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5223             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5224             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5225             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5226             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5227             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5228             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5229             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5230
  5231         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5232             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5233             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5234             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5235
  5236         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5237
  5238         16  FILLER                         PIC X(673).
  5239
  5240
  5241****************************************************************
  5242*             MORTGAGE SYSTEM PLAN RECORD                      *
  5243****************************************************************
  5244
  5245     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5246         16  CF-PLAN-TYPE                   PIC X.
  5247             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5248             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5249             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5250         16  CF-PLAN-ABBREV                 PIC XXX.
  5251         16  CF-PLAN-DESCRIPT               PIC X(10).
  5252         16  CF-PLAN-NOTES                  PIC X(20).
  5253         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5254         16  CF-PLAN-UNDERWRITING.
  5255             20  CF-PLAN-TERM-DATA.
  5256                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 101
* EL156.cbl
  5257                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5258             20  CF-PLAN-AGE-DATA.
  5259                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5260                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5261                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5262             20  CF-PLAN-BENEFIT-DATA.
  5263                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5264                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5265                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5266                                            PIC S9(7)V99  COMP-3.
  5267         16  CF-PLAN-POLICY-FORMS.
  5268             20  CF-POLICY-FORM             PIC X(12).
  5269             20  CF-MASTER-APPLICATION      PIC X(12).
  5270             20  CF-MASTER-POLICY           PIC X(12).
  5271         16  CF-PLAN-RATING.
  5272             20  CF-RATE-CODE               PIC X(5).
  5273             20  CF-SEX-RATING              PIC X.
  5274                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5275                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5276             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5277             20  CF-SUB-STD-TYPE            PIC X.
  5278                 88  CF-PCT-OF-PREM            VALUE '1'.
  5279                 88  CF-PCT-OF-BENE            VALUE '2'.
  5280         16  CF-PLAN-PREM-TOLERANCES.
  5281             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5282             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5283         16  CF-PLAN-PYMT-TOLERANCES.
  5284             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5285             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5286         16  CF-PLAN-MISC-DATA.
  5287             20  FILLER                     PIC X.
  5288             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5289             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5290         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5291         16  CF-PLAN-IND-GRP                PIC X.
  5292             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5293                                                     '1'.
  5294             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5295                                                     '2'.
  5296         16  CF-MIB-SEARCH-SW               PIC X.
  5297             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5298             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5299             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5300             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5301         16  CF-ALPHA-SEARCH-SW             PIC X.
  5302             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5303             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5304             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5305             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5306             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5307             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5308             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5309             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5310             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5311             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5312                                                     'A' 'B' 'C'
  5313                                                     'X' 'Y' 'Z'.
  5314         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 102
* EL156.cbl
  5315             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5316             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5317             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5318             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5319             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5320         16  FILLER                         PIC X(4).
  5321         16  CF-HEALTH-QUESTIONS            PIC X.
  5322             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5323         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5324         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5325         16  CF-PLAN-SNGL-JNT               PIC X.
  5326             88  CF-COMBINED-PLAN              VALUE 'C'.
  5327             88  CF-JNT-PLAN                   VALUE 'J'.
  5328             88  CF-SNGL-PLAN                  VALUE 'S'.
  5329         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5330         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5331         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5332         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5333         16  CF-RERATE-CNTL                 PIC  X.
  5334             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5335             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5336             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5337             88  CF-AUTO-RECALC                 VALUE '4'.
  5338         16  CF-BENEFIT-TYPE                PIC  X.
  5339             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5340             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5341         16  CF-POLICY-FEE                  PIC S999V99
  5342                                                    COMP-3.
  5343         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5344         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5345         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5346         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5347         16  FILLER                         PIC  X(32).
  5348         16  CF-TERMINATION-FORM            PIC  X(04).
  5349         16  FILLER                         PIC  X(08).
  5350         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5351                                                       COMP-3.
  5352         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5353         16  CF-ISSUE-LETTER                PIC  X(4).
  5354         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5355         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5356             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5357             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5358         16  CF-MP-REFUND-CALC              PIC X.
  5359             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5360             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5361             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5362             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5363             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5364             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5365             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5366             88  CF-MP-REFD-MEAN                VALUE '8'.
  5367         16  CF-ALT-RATE-CODE               PIC  X(5).
  5368
  5369
  5370         16  FILLER                         PIC X(498).
  5371****************************************************************
  5372*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 103
* EL156.cbl
  5373****************************************************************
  5374
  5375     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5376         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5377         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5378             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5379             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5380             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5381             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5382             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5383
  5384         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5385         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5386         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5387         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5388         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5389
  5390         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5391             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5392         16  CF-MP-RECON-USE-IND            PIC X(1).
  5393             88  CF-MP-USE-RECON             VALUE 'Y'.
  5394         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5395             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5396         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5397             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5398             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5399         16  FILLER                         PIC X(1).
  5400         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5401             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5402         16  CF-MORTG-MIB-VERSION           PIC X.
  5403             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5404             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5405             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5406         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5407             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5408                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5409             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5410                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5411             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5412                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5413             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5414                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5415             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5416                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5417             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5418                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5419         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5420         16  FILLER                         PIC X(7).
  5421         16  CF-MORTG-DESTINATION-SYMBOL.
  5422             20  CF-MORTG-MIB-COMM          PIC X(5).
  5423             20  CF-MORTG-MIB-TERM          PIC X(5).
  5424         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5425             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5426         16  FILLER                         PIC X(03).
  5427         16  CF-MP-CHECK-NO-CONTROL.
  5428             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5429                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5430                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 104
* EL156.cbl
  5431                                                ' ' LOW-VALUES.
  5432                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5433                                               VALUE '3'.
  5434         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5435         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5436         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5437             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5438                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5439             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5440                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5441             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5442                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5443             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5444                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5445             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5446                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5447             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5448                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5449         16  CF-MORTG-BILLING-AREA.
  5450             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5451                                            PIC X.
  5452         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5453         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5454         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5455         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5456             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5457             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5458         16  FILLER                         PIC X.
  5459         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5460             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5461             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5462         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5463         16  FILLER                         PIC X(8).
  5464         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5465         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5466         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5467         16  CF-ACH-COMPANY-ID.
  5468             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5469                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5470                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5471                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5472             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5473         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5474             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5475         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5476             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5477             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5478         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5479         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5480         16  FILLER                         PIC X(536).
  5481
  5482****************************************************************
  5483*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5484****************************************************************
  5485
  5486     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5487         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5488             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 105
* EL156.cbl
  5489                 24  CF-FEMALE-FT           PIC 99.
  5490                 24  CF-FEMALE-IN           PIC 99.
  5491             20  CF-FEMALE-MIN-WT           PIC 999.
  5492             20  CF-FEMALE-MAX-WT           PIC 999.
  5493         16  FILLER                         PIC X(428).
  5494
  5495     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5496         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5497             20  CF-MALE-HEIGHT.
  5498                 24  CF-MALE-FT             PIC 99.
  5499                 24  CF-MALE-IN             PIC 99.
  5500             20  CF-MALE-MIN-WT             PIC 999.
  5501             20  CF-MALE-MAX-WT             PIC 999.
  5502         16  FILLER                         PIC X(428).
  5503******************************************************************
  5504*             AUTOMATIC ACTIVITY RECORD                          *
  5505******************************************************************
  5506     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5507         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5508             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5509             20  CF-SYS-LETTER-ID           PIC X(04).
  5510             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5511             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5512             20  CF-SYS-RESET-SW            PIC X(01).
  5513             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5514             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5515
  5516         16  FILLER                         PIC X(50).
  5517
  5518         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5519             20  CF-USER-ACTIVE-SW          PIC X(01).
  5520             20  CF-USER-LETTER-ID          PIC X(04).
  5521             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5522             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5523             20  CF-USER-RESET-SW           PIC X(01).
  5524             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5525             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5526             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5527
  5528         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 106
* EL156.cbl
  5530*    COPY ELCCERT.
  5531******************************************************************
  5532*                                                                *
  5533*                            ELCCERT.                            *
  5534*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5535*                            VMOD=2.013                          *
  5536*                                                                *
  5537*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5538*                                                                *
  5539*   FILE TYPE = VSAM,KSDS                                        *
  5540*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5541*                                                                *
  5542*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5543*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5544*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5545*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5546*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5547*                                                                *
  5548*   LOG = YES                                                    *
  5549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5550******************************************************************
  5551*                   C H A N G E   L O G
  5552*
  5553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5554*-----------------------------------------------------------------
  5555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5556* EFFECTIVE    NUMBER
  5557*-----------------------------------------------------------------
  5558* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5559* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5560* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5561* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5562* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5563* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5564* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5565* 032612  CR2011110200001  PEMA  AHL CHANGES
  5566******************************************************************
  5567
  5568 01  CERTIFICATE-MASTER.
  5569     12  CM-RECORD-ID                      PIC XX.
  5570         88  VALID-CM-ID                      VALUE 'CM'.
  5571
  5572     12  CM-CONTROL-PRIMARY.
  5573         16  CM-COMPANY-CD                 PIC X.
  5574         16  CM-CARRIER                    PIC X.
  5575         16  CM-GROUPING.
  5576             20  CM-GROUPING-PREFIX        PIC X(3).
  5577             20  CM-GROUPING-PRIME         PIC X(3).
  5578         16  CM-STATE                      PIC XX.
  5579         16  CM-ACCOUNT.
  5580             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5581             20  CM-ACCOUNT-PRIME          PIC X(6).
  5582         16  CM-CERT-EFF-DT                PIC XX.
  5583         16  CM-CERT-NO.
  5584             20  CM-CERT-PRIME             PIC X(10).
  5585             20  CM-CERT-SFX               PIC X.
  5586
  5587     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 107
* EL156.cbl
  5588         16  CM-COMPANY-CD-A1              PIC X.
  5589         16  CM-INSURED-LAST-NAME          PIC X(15).
  5590         16  CM-INSURED-INITIALS.
  5591             20  CM-INSURED-INITIAL1       PIC X.
  5592             20  CM-INSURED-INITIAL2       PIC X.
  5593
  5594     12  CM-CONTROL-BY-SSN.
  5595         16  CM-COMPANY-CD-A2              PIC X.
  5596         16  CM-SOC-SEC-NO.
  5597             20  CM-SSN-STATE              PIC XX.
  5598             20  CM-SSN-ACCOUNT            PIC X(6).
  5599             20  CM-SSN-LN3.
  5600                 25  CM-INSURED-INITIALS-A2.
  5601                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5602                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5603                 25 CM-PART-LAST-NAME-A2         PIC X.
  5604
  5605     12  CM-CONTROL-BY-CERT-NO.
  5606         16  CM-COMPANY-CD-A4              PIC X.
  5607         16  CM-CERT-NO-A4                 PIC X(11).
  5608
  5609     12  CM-CONTROL-BY-MEMB.
  5610         16  CM-COMPANY-CD-A5              PIC X.
  5611         16  CM-MEMBER-NO.
  5612             20  CM-MEMB-STATE             PIC XX.
  5613             20  CM-MEMB-ACCOUNT           PIC X(6).
  5614             20  CM-MEMB-LN4.
  5615                 25  CM-INSURED-INITIALS-A5.
  5616                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5617                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5618                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5619
  5620     12  CM-INSURED-PROFILE-DATA.
  5621         16  CM-INSURED-FIRST-NAME.
  5622             20  CM-INSURED-1ST-INIT       PIC X.
  5623             20  FILLER                    PIC X(9).
  5624         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5625         16  CM-INSURED-SEX                PIC X.
  5626             88  CM-SEX-MALE                  VALUE 'M'.
  5627             88  CM-SEX-FEMAL                 VALUE 'F'.
  5628         16  CM-INSURED-JOINT-AGE          PIC 99.
  5629         16  CM-JOINT-INSURED-NAME.
  5630             20  CM-JT-LAST-NAME           PIC X(15).
  5631             20  CM-JT-FIRST-NAME.
  5632                 24  CM-JT-1ST-INIT        PIC X.
  5633                 24  FILLER                PIC X(9).
  5634             20  CM-JT-INITIAL             PIC X.
  5635
  5636     12  CM-LIFE-DATA.
  5637         16  CM-LF-BENEFIT-CD              PIC XX.
  5638         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5639         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5640         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5641         16  CM-LF-DEV-CODE                PIC XXX.
  5642         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5643         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5644         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5645         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 108
* EL156.cbl
  5646         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5647         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5648         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5649         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5650         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5651         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5652         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5653         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5654         16  FILLER                        PIC XX.
  5655
  5656     12  CM-AH-DATA.
  5657         16  CM-AH-BENEFIT-CD              PIC XX.
  5658         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5659         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5660         16  CM-AH-DEV-CODE                PIC XXX.
  5661         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5662         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5663         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5664         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5665         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5666         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5667         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5668         16  CM-AH-PAID-THRU-DT            PIC XX.
  5669             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5670         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5671         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5672         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5673         16  FILLER                        PIC X.
  5674
  5675     12  CM-LOAN-INFORMATION.
  5676         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5677         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5678                                           PIC S9(5)V99  COMP-3.
  5679         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5680         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5681         16  CM-PAY-FREQUENCY              PIC S99.
  5682         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5683         16  CM-RATE-CLASS                 PIC XX.
  5684         16  CM-BENEFICIARY                PIC X(25).
  5685         16  CM-POLICY-FORM-NO             PIC X(12).
  5686         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5687         16  CM-LAST-ADD-ON-DT             PIC XX.
  5688         16  CM-DEDUCTIBLE-AMOUNTS.
  5689             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5690             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5691         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5692             20  CM-RESIDENT-STATE         PIC XX.
  5693             20  CM-RATE-CODE              PIC X(4).
  5694             20  FILLER                    PIC XX.
  5695         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5696             20  CM-LOAN-OFFICER           PIC X(5).
  5697             20  FILLER                    PIC XXX.
  5698         16  CM-CSR-CODE                   PIC XXX.
  5699         16  CM-UNDERWRITING-CODE          PIC X.
  5700             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5701         16  CM-POST-CARD-IND              PIC X.
  5702         16  CM-NH-INTERFACE-SW            PIC X.
  5703         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 109
* EL156.cbl
  5704             88  CM-SING-PRM                  VALUE '1'.
  5705             88  CM-O-B-COVERAGE              VALUE '2'.
  5706             88  CM-OPEN-END                  VALUE '3'.
  5707         16  CM-IND-GRP-TYPE               PIC X.
  5708             88  CM-INDIVIDUAL                VALUE 'I'.
  5709             88  CM-GROUP                     VALUE 'G'.
  5710         16  CM-SKIP-CODE                  PIC X.
  5711             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5712             88  SKIP-JULY                    VALUE '1'.
  5713             88  SKIP-AUGUST                  VALUE '2'.
  5714             88  SKIP-SEPTEMBER               VALUE '3'.
  5715             88  SKIP-JULY-AUG                VALUE '4'.
  5716             88  SKIP-AUG-SEPT                VALUE '5'.
  5717             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5718             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5719             88  SKIP-JUNE                    VALUE '8'.
  5720             88  SKIP-JUNE-JULY               VALUE '9'.
  5721             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5722             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5723         16  CM-PAYMENT-MODE               PIC X.
  5724             88  PAY-MONTHLY                  VALUE SPACE.
  5725             88  PAY-WEEKLY                   VALUE '1'.
  5726             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5727             88  PAY-BI-WEEKLY                VALUE '3'.
  5728             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5729         16  CM-LOAN-NUMBER                PIC X(8).
  5730         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5731         16  CM-OLD-LOF                    PIC XXX.
  5732*        16  CM-LOAN-OFFICER               PIC XXX.
  5733         16  CM-REIN-TABLE                 PIC XXX.
  5734         16  CM-SPECIAL-REIN-CODE          PIC X.
  5735         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5736         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5737         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5738
  5739     12  CM-STATUS-DATA.
  5740         16  CM-ENTRY-STATUS               PIC X.
  5741         16  CM-ENTRY-DT                   PIC XX.
  5742
  5743         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5744         16  CM-LF-CANCEL-DT               PIC XX.
  5745         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5746
  5747         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5748         16  CM-LF-DEATH-DT                PIC XX.
  5749         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5750
  5751         16  CM-LF-CURRENT-STATUS          PIC X.
  5752             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5753                                                'M' '4' '5' '9'.
  5754             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5755             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5756             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5757             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5758             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5759             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5760             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5761             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 110
* EL156.cbl
  5762             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5763             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5764             88  CM-LF-DECLINED               VALUE 'D'.
  5765             88  CM-LF-VOIDED                 VALUE 'V'.
  5766
  5767         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5768         16  CM-AH-CANCEL-DT               PIC XX.
  5769         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5770
  5771         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5772         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5773         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5774
  5775         16  CM-AH-CURRENT-STATUS          PIC X.
  5776             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5777                                                'M' '4' '5' '9'.
  5778             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5779             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5780             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5781             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5782             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5783             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5784             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5785             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5786             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5787             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5788             88  CM-AH-DECLINED               VALUE 'D'.
  5789             88  CM-AH-VOIDED                 VALUE 'V'.
  5790
  5791         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5792             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5793             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5794             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5795         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5796
  5797         16  CM-ENTRY-BATCH                PIC X(6).
  5798         16  CM-LF-EXIT-BATCH              PIC X(6).
  5799         16  CM-AH-EXIT-BATCH              PIC X(6).
  5800         16  CM-LAST-MONTH-END             PIC XX.
  5801
  5802     12  CM-NOTE-SW                        PIC X.
  5803         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5804         88  CERT-NOTES-PRESENT               VALUE '1'.
  5805         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5806         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5807         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5808         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5809         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5810         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5811     12  CM-COMP-EXCP-SW                   PIC X.
  5812         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5813         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5814     12  CM-INSURED-ADDRESS-SW             PIC X.
  5815         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5816         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5817
  5818*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5819     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 111
* EL156.cbl
  5820     12  FILLER                            PIC X.
  5821
  5822*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5823     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5824     12  FILLER                            PIC X.
  5825*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5826     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5827
  5828     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5829         88  CERT-ADDED-BATCH                 VALUE ' '.
  5830         88  CERT-ADDED-ONLINE                VALUE '1'.
  5831         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5832         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5833         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5834     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5835         88  CERT-AS-LOADED                   VALUE ' '.
  5836         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5837         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5838         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5839         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5840         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5841         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5842         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5843
  5844     12  CM-ACCOUNT-COMM-PCTS.
  5845         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5846         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5847
  5848     12  CM-USER-FIELD                     PIC X.
  5849     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5850     12  CM-CLP-STATE                      PIC XX.
  5851     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5852     12  CM-USER-RESERVED                  PIC XXX.
  5853     12  FILLER REDEFINES CM-USER-RESERVED.
  5854         16  CM-AH-CLASS-CD                PIC XX.
  5855         16  F                             PIC X.
  5856******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 112
* EL156.cbl
  5858*    COPY ELCTRLR.
  5859******************************************************************
  5860*                                                                *
  5861*                            ELCTRLR.                            *
  5862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5863*                            VMOD=2.014                          *
  5864*                                                                *
  5865*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5866*                                                                *
  5867*   FILE TYPE = VSAM,KSDS                                        *
  5868*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5869*                                                                *
  5870*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5871*       ALTERNATE INDEX = NONE                                   *
  5872*                                                                *
  5873*   LOG = YES                                                    *
  5874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5875******************************************************************
  5876*                   C H A N G E   L O G
  5877*
  5878* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5879*-----------------------------------------------------------------
  5880*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5881* EFFECTIVE    NUMBER
  5882*-----------------------------------------------------------------
  5883* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5884* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5885* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5886* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5887* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5888* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5889* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5890* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5891* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5892* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5893* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5894* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5895* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5896* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5897* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5898* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5899* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5900* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5901******************************************************************
  5902 01  ACTIVITY-TRAILERS.
  5903     12  AT-RECORD-ID                    PIC XX.
  5904         88  VALID-AT-ID                       VALUE 'AT'.
  5905
  5906     12  AT-CONTROL-PRIMARY.
  5907         16  AT-COMPANY-CD               PIC X.
  5908         16  AT-CARRIER                  PIC X.
  5909         16  AT-CLAIM-NO                 PIC X(7).
  5910         16  AT-CERT-NO.
  5911             20  AT-CERT-PRIME           PIC X(10).
  5912             20  AT-CERT-SFX             PIC X.
  5913         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5914             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5915             88  AT-LAST-TRL-AVAIL            VALUE +100.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 113
* EL156.cbl
  5916             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5917             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5918             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5919             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5920             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5921             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5922             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5923             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5924             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5925             88  AT-BENEFICIARY-TRL           VALUE +91.
  5926             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5927             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5928             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5929             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5930
  5931     12  AT-TRAILER-TYPE                 PIC X.
  5932         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5933         88  PAYMENT-TR                       VALUE '2'.
  5934         88  AUTO-PAY-TR                      VALUE '3'.
  5935         88  CORRESPONDENCE-TR                VALUE '4'.
  5936         88  ADDRESS-TR                       VALUE '5'.
  5937         88  GENERAL-INFO-TR                  VALUE '6'.
  5938         88  AUTO-PROMPT-TR                   VALUE '7'.
  5939         88  DENIAL-TR                        VALUE '8'.
  5940         88  INCURRED-CHG-TR                  VALUE '9'.
  5941         88  FORM-CONTROL-TR                  VALUE 'A'.
  5942
  5943     12  AT-RECORDED-DT                  PIC XX.
  5944     12  AT-RECORDED-BY                  PIC X(4).
  5945     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5946
  5947     12  AT-TRAILER-BODY                 PIC X(165).
  5948
  5949     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5950         16  AT-RESERVE-CONTROLS.
  5951             20  AT-MANUAL-SW            PIC X.
  5952                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5953             20  AT-FUTURE-SW            PIC X.
  5954                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5955             20  AT-PTC-SW               PIC X.
  5956                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5957             20  AT-IBNR-SW              PIC X.
  5958                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5959             20  AT-PTC-LF-SW            PIC X.
  5960                 88  AT-LF-PTC-USED          VALUE '1'.
  5961             20  AT-CDT-ACCESS-METHOD    PIC X.
  5962                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5963                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5964                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5965             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5966         16  AT-LAST-COMPUTED-DT         PIC XX.
  5967         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5968         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5969         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5970         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5971         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5972         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5973         16  AT-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 114
* EL156.cbl
  5974             20  AT-EXPENSE-METHOD       PIC X.
  5975                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5976                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5977                 88  PERCENT-OF-PMT           VALUE '3'.
  5978                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5979             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5980             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5981         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5982         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5983
  5984         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5985         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5986
  5987*        16  FILLER                      PIC X(53).
  5988         16  FILLER                      PIC X(47).
  5989
  5990         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5991         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5992
  5993         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5994             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5995             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5996*                    C = CLOSED
  5997*                    O = OPEN
  5998             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5999*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6000
  6001     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6002         16  AT-PAYMENT-TYPE             PIC X.
  6003             88  PARTIAL-PAYMENT                VALUE '1'.
  6004             88  FINAL-PAYMENT                  VALUE '2'.
  6005             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6006             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6007             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6008             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6009             88  VOIDED-PAYMENT                 VALUE '9'.
  6010             88  TRANSFER                       VALUE 'T'.
  6011             88  LIFE-INTEREST                  VALUE 'I'.
  6012
  6013         16  AT-CLAIM-TYPE               PIC X.
  6014             88  PAID-FOR-AH                    VALUE 'A'.
  6015             88  PAID-FOR-LIFE                  VALUE 'L'.
  6016             88  PAID-FOR-IUI                   VALUE 'I'.
  6017             88  PAID-FOR-GAP                   VALUE 'G'.
  6018         16  AT-CLAIM-PREM-TYPE          PIC X.
  6019             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6020             88  AT-O-B-COVERAGE                VALUE '2'.
  6021             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6022         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6023         16  AT-CHECK-NO                 PIC X(7).
  6024         16  AT-PAID-FROM-DT             PIC XX.
  6025         16  AT-PAID-THRU-DT             PIC XX.
  6026         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6027         16  FILLER                      PIC X.
  6028         16  AT-PAYEES-NAME              PIC X(30).
  6029         16  AT-PAYMENT-ORIGIN           PIC X.
  6030             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6031             88  ONLINE-AUTO-PMT                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 115
* EL156.cbl
  6032             88  OFFLINE-PMT                    VALUE '3'.
  6033         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6034         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6035         16  AT-VOID-DATA.
  6036             20  AT-VOID-DT              PIC XX.
  6037*00144       20  AT-VOID-REASON          PIC X(30).
  6038             20  AT-VOID-REASON          PIC X(26).
  6039         16  AT-PMT-APPROVED-BY          PIC X(04).
  6040         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6041         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6042         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6043                                         PIC S99V9(5)  COMP-3.
  6044         16  AT-CREDIT-INTERFACE.
  6045             20  AT-PMT-SELECT-DT        PIC XX.
  6046                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6047             20  AT-PMT-ACCEPT-DT        PIC XX.
  6048                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6049             20  AT-VOID-SELECT-DT       PIC XX.
  6050                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6051             20  AT-VOID-ACCEPT-DT       PIC XX.
  6052                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6053
  6054         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6055                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6056                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6057         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6058
  6059         16  AT-FORCE-CONTROL            PIC X.
  6060             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6061         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6062         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6063         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6064         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6065         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6066         16  AT-BENEFIT-TYPE             PIC X.
  6067
  6068         16  AT-EXPENSE-TYPE             PIC X.
  6069         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6070
  6071         16  AT-PAYEE-TYPE-CD.
  6072             20  AT-PAYEE-TYPE           PIC X.
  6073                 88  INSURED-PAID           VALUE 'I'.
  6074                 88  BENEFICIARY-PAID       VALUE 'B'.
  6075                 88  ACCOUNT-PAID           VALUE 'A'.
  6076                 88  OTHER-1-PAID           VALUE 'O'.
  6077                 88  OTHER-2-PAID           VALUE 'Q'.
  6078                 88  DOCTOR-PAID            VALUE 'P'.
  6079                 88  EMPLOYER-PAID          VALUE 'E'.
  6080             20  AT-PAYEE-SEQ            PIC X.
  6081
  6082         16  AT-CASH-PAYMENT             PIC X.
  6083         16  AT-GROUPED-PAYMENT          PIC X.
  6084         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6085         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6086         16  AT-APPROVED-LEVEL           PIC X.
  6087         16  AT-VOID-TYPE                PIC X.
  6088             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6089             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 116
* EL156.cbl
  6090         16  AT-AIG-UNEMP-IND            PIC X.
  6091             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6092         16  AT-ASSOCIATES               PIC X.
  6093             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6094             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6095
  6096         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6097         16  AT-CV-PMT-CODE              PIC X.
  6098             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6099             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6100             88  FULL-ADD-PAYMENT           VALUE '3'.
  6101             88  HALF-ADD-PAYMENT           VALUE '4'.
  6102             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6103             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6104             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6105             88  ADDL-PAYMENT               VALUE '8'.
  6106
  6107         16  AT-EOB-CODE1                PIC XXX.
  6108         16  AT-EOB-CODE2                PIC XXX.
  6109         16  AT-EOB-CODE3                PIC XXX.
  6110         16  FILLER REDEFINES AT-EOB-CODE3.
  6111             20  AT-PRINT-CLM-FORM       PIC X.
  6112             20  AT-PRINT-SURVEY         PIC X.
  6113             20  AT-SPECIAL-RELEASE      PIC X.
  6114         16  AT-EOB-CODE4                PIC XXX.
  6115         16  FILLER REDEFINES AT-EOB-CODE4.
  6116             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6117             20  FILLER                  PIC X.
  6118         16  AT-EOB-CODE5                PIC XXX.
  6119         16  FILLER REDEFINES AT-EOB-CODE5.
  6120             20  AT-PMT-PROOF-DT         PIC XX.
  6121             20  FILLER                  PIC X.
  6122
  6123         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6124             88  AT-PRINT-EOB            VALUE 'Y'.
  6125
  6126         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6127         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6128
  6129     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6130         16  AT-SCHEDULE-START-DT        PIC XX.
  6131         16  AT-SCHEDULE-END-DT          PIC XX.
  6132         16  AT-TERMINATED-DT            PIC XX.
  6133         16  AT-LAST-PMT-TYPE            PIC X.
  6134             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6135             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6136         16  AT-FIRST-PMT-DATA.
  6137             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6138             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6139             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6140         16  AT-REGULAR-PMT-DATA.
  6141             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6142             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6143             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6144         16  AT-AUTO-PAYEE-CD.
  6145             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6146                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6147                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 117
* EL156.cbl
  6148                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6149                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6150                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6151             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6152         16  AT-AUTO-PAY-DAY             PIC 99.
  6153         16  AT-AUTO-CASH                PIC X.
  6154             88  AT-CASH                      VALUE 'Y'.
  6155             88  AT-NON-CASH                  VALUE 'N'.
  6156*        16  FILLER                      PIC X(129).
  6157         16  AT-AUTO-END-LETTER          PIC X(4).
  6158         16  FILLER                      PIC X(125).
  6159
  6160         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6161         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6162
  6163     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6164         16  AT-LETTER-SENT-DT           PIC XX.
  6165         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6166         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6167         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6168         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6169         16  AT-LETTER-ORIGIN            PIC X.
  6170             88  ONLINE-CREATION              VALUE '1' '3'.
  6171             88  OFFLINE-CREATION             VALUE '2' '4'.
  6172             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6173             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6174         16  AT-STD-LETTER-FORM          PIC X(4).
  6175         16  AT-REASON-TEXT              PIC X(70).
  6176         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6177         16  AT-ADDRESEE-TYPE            PIC X.
  6178              88  INSURED-ADDRESEE            VALUE 'I'.
  6179              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6180              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6181              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6182              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6183              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6184              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6185         16  AT-ADDRESSEE-NAME           PIC X(30).
  6186         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6187         16  AT-RESEND-PRINT-DATE        PIC XX.
  6188         16  AT-CORR-SOL-UNSOL           PIC X.
  6189         16  AT-LETTER-PURGED-DT         PIC XX.
  6190*
  6191*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6192*
  6193         16  AT-CSO-REDEFINITION.
  6194             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6195             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6196             20  AT-LETTER-TO-BENE       PIC X(1).
  6197             20  AT-STOP-LETTER-DT       PIC X(2).
  6198             20  FILLER                  PIC X(19).
  6199*             20  FILLER                  PIC X(27).
  6200             20  AT-CSO-LETTER-STATUS    PIC X.
  6201                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6202                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6203                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6204             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6205             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 118
* EL156.cbl
  6206*
  6207*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6208*
  6209*        16  FILLER                      PIC X(26).
  6210*
  6211*        16  AT-DMD-BSR-CODE             PIC X.
  6212*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6213*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6214*
  6215*        16  AT-DMD-LETTER-STATUS        PIC X.
  6216*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6217*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6218*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6219*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6220*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6221
  6222         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6223         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6224
  6225     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6226         16  AT-ADDRESS-TYPE             PIC X.
  6227             88  INSURED-ADDRESS               VALUE 'I'.
  6228             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6229             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6230             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6231             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6232             88  OTHER-ADDRESS-1               VALUE 'O'.
  6233             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6234         16  AT-MAIL-TO-NAME             PIC X(30).
  6235         16  AT-ADDRESS-LINE-1           PIC X(30).
  6236         16  AT-ADDRESS-LINE-2           PIC X(30).
  6237         16  AT-CITY-STATE.
  6238             20  AT-CITY                 PIC X(28).
  6239             20  AT-STATE                PIC XX.
  6240         16  AT-ZIP.
  6241             20  AT-ZIP-CODE.
  6242                 24  AT-ZIP-1ST          PIC X.
  6243                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6244                 24  FILLER              PIC X(4).
  6245             20  AT-ZIP-PLUS4            PIC X(4).
  6246         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6247             20  AT-CAN-POSTAL-1         PIC XXX.
  6248             20  AT-CAN-POSTAL-2         PIC XXX.
  6249             20  FILLER                  PIC XXX.
  6250         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6251*         16  FILLER                      PIC X(23).
  6252         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6253         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6254         16  FILLER                      PIC X(13).
  6255         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6256         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6257
  6258     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6259         16  AT-INFO-LINE-1              PIC X(60).
  6260         16  FILLER REDEFINES AT-INFO-LINE-1.
  6261             20  AT-NOTE-ERROR-NO OCCURS 15
  6262                                         PIC X(4).
  6263         16  AT-INFO-LINE-2              PIC X(60).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 119
* EL156.cbl
  6264         16  AT-INFO-TRAILER-TYPE        PIC X.
  6265             88  AT-ERRORS-NOTE          VALUE 'E'.
  6266             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6267             88  AT-CALL-NOTE            VALUE 'C'.
  6268             88  AT-MAINT-NOTE           VALUE 'M'.
  6269             88  AT-CERT-CHANGE          VALUE 'X'.
  6270             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6271             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6272             88  AT-CERT-CANCELLED       VALUE 'T'.
  6273         16  AT-CALL-TYPE                PIC X.
  6274             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6275             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6276         16  AT-NOTE-CONTINUATION        PIC X.
  6277             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6278         16  AT-EOB-CODES-EXIST          PIC X.
  6279             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6280         16  FILLER                      PIC X(35).
  6281         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6282         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6283
  6284     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6285         16  AT-PROMPT-LINE-1            PIC X(60).
  6286         16  AT-PROMPT-LINE-2            PIC X(60).
  6287         16  AT-PROMPT-START-DT          PIC XX.
  6288         16  AT-PROMPT-END-DT            PIC XX.
  6289         16  FILLER                      PIC X(35).
  6290         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6291         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6292
  6293     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6294         16  AT-DENIAL-INFO-1            PIC X(60).
  6295         16  AT-DENIAL-INFO-2            PIC X(60).
  6296         16  AT-DENIAL-DT                PIC XX.
  6297         16  AT-RETRACTION-DT            PIC XX.
  6298         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6299*         16  FILLER                      PIC X(31).
  6300         16  AT-DENIAL-PROOF-DT          PIC XX.
  6301         16  FILLER                      PIC X(29).
  6302         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6303         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6304
  6305     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6306         16  AT-OLD-INCURRED-DT          PIC XX.
  6307         16  AT-OLD-REPORTED-DT          PIC XX.
  6308         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6309         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6310         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6311         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6312         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6313         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6314         16  FILLER                      PIC X(26).
  6315         16  AT-OLD-DIAG-CODE            PIC X(6).
  6316         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6317         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6318         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6319         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6320         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6321         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 120
* EL156.cbl
  6322         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6323         16  FILLER                      PIC X(25).
  6324         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6325
  6326     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6327         16  AT-FORM-SEND-ON-DT          PIC XX.
  6328         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6329         16  AT-FORM-RE-SEND-DT          PIC XX.
  6330         16  AT-FORM-ANSWERED-DT         PIC XX.
  6331         16  AT-FORM-PRINTED-DT          PIC XX.
  6332         16  AT-FORM-REPRINT-DT          PIC XX.
  6333         16  AT-FORM-TYPE                PIC X.
  6334             88  INITIAL-FORM                  VALUE '1'.
  6335             88  PROGRESS-FORM                 VALUE '2'.
  6336         16  AT-INSTRUCT-LN-1            PIC X(28).
  6337         16  AT-INSTRUCT-LN-2            PIC X(28).
  6338         16  AT-INSTRUCT-LN-3            PIC X(28).
  6339         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6340         16  AT-FORM-ADDRESS             PIC X.
  6341             88  FORM-TO-INSURED              VALUE 'I'.
  6342             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6343             88  FORM-TO-OTHER-1              VALUE 'O'.
  6344             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6345         16  AT-RELATED-1.
  6346             20 AT-REL-CARR-1            PIC X.
  6347             20 AT-REL-CLAIM-1           PIC X(7).
  6348             20 AT-REL-CERT-1            PIC X(11).
  6349         16  AT-RELATED-2.
  6350             20 AT-REL-CARR-2            PIC X.
  6351             20 AT-REL-CLAIM-2           PIC X(7).
  6352             20 AT-REL-CERT-2            PIC X(11).
  6353         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6354         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6355         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6356         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6357         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6358         16  AT-STOP-FORM-DT             PIC X(2).
  6359
  6360         16  FILLER                      PIC X(09).
  6361         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6362         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6363******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 121
* EL156.cbl
  6365*    COPY ELCACTQ.
  6366******************************************************************
  6367*                                                                *
  6368*                            ELCACTQ.                            *
  6369*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6370*                            VMOD=2.004                          *
  6371*                                                                *
  6372*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6373*                                                                *
  6374*   FILE TYPE = VSAM,KSDS                                        *
  6375*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6376*                                                                *
  6377*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6378*       ALTERNATE INDEX = NONE                                   *
  6379*                                                                *
  6380*   LOG = YES                                                    *
  6381*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6382*                                                                *
  6383*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6384******************************************************************
  6385
  6386 01  ACTIVITY-QUE.
  6387     12  AQ-RECORD-ID                PIC XX.
  6388         88  VALID-AQ-ID                VALUE 'AQ'.
  6389
  6390     12  AQ-CONTROL-PRIMARY.
  6391         16  AQ-COMPANY-CD           PIC X.
  6392         16  AQ-CARRIER              PIC X.
  6393         16  AQ-CLAIM-NO             PIC X(7).
  6394         16  AQ-CERT-NO.
  6395             20  AQ-CERT-PRIME       PIC X(10).
  6396             20  AQ-CERT-SFX         PIC X.
  6397
  6398     12  AQ-PENDING-ACTIVITY-FLAGS.
  6399         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6400         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6401             88  PENDING-PAYMENTS       VALUE '1'.
  6402         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6403             88  PENDING-FULL-PRINT     VALUE '1'.
  6404             88  PENDING-PART-PRINT     VALUE '2'.
  6405         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6406             88  PENDING-LETTERS        VALUE '1'.
  6407         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6408             88  PENDING-RESTORE        VALUE 'C'.
  6409             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6410
  6411     12  FILLER                      PIC X(20).
  6412
  6413     12  AQ-RESEND-DATE              PIC XX.
  6414     12  AQ-FOLLOWUP-DATE            PIC XX.
  6415     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6416     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6417     12  AQ-AUTO-LETTER              PIC X(4).
  6418     12  FILLER                      PIC XX.
  6419     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6420*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 122
* EL156.cbl
  6422*    COPY ERCACCT.
  6423******************************************************************
  6424*                                                                *
  6425*                                                                *
  6426*                            ERCACCT                             *
  6427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6428*                            VMOD=2.031                          *
  6429*                                                                *
  6430*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6431*                                                                *
  6432*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6433*   VSAM ACCOUNT MASTER FILES.                                   *
  6434*                                                                *
  6435*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6436*                                                                *
  6437*   FILE TYPE = VSAM,KSDS                                        *
  6438*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6439*                                                                *
  6440*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6441*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6442*                                                                *
  6443*   LOG = NO                                                     *
  6444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6445*                                                                *
  6446*                                                                *
  6447******************************************************************
  6448*                   C H A N G E   L O G
  6449*
  6450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6451*-----------------------------------------------------------------
  6452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6453* EFFECTIVE    NUMBER
  6454*-----------------------------------------------------------------
  6455* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6456* 092705    2005050300006  PEMA  ADD SPP LEASES
  6457* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6458* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6459* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6460* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6461* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6462******************************************************************
  6463
  6464 01  ACCOUNT-MASTER.
  6465     12  AM-RECORD-ID                      PIC XX.
  6466         88  VALID-AM-ID                      VALUE 'AM'.
  6467
  6468     12  AM-CONTROL-PRIMARY.
  6469         16  AM-COMPANY-CD                 PIC X.
  6470         16  AM-MSTR-CNTRL.
  6471             20  AM-CONTROL-A.
  6472                 24  AM-CARRIER            PIC X.
  6473                 24  AM-GROUPING.
  6474                     28 AM-GROUPING-PREFIX PIC XXX.
  6475                     28 AM-GROUPING-PRIME  PIC XXX.
  6476                 24  AM-STATE              PIC XX.
  6477                 24  AM-ACCOUNT.
  6478                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6479                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 123
* EL156.cbl
  6480             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6481                                           PIC X(19).
  6482             20  AM-CNTRL-B.
  6483                 24  AM-EXPIRATION-DT      PIC XX.
  6484                 24  FILLER                PIC X(4).
  6485             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6486                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6487
  6488     12  AM-CONTROL-BY-VAR-GRP.
  6489         16  AM-COMPANY-CD-A1              PIC X.
  6490         16  AM-VG-CARRIER                 PIC X.
  6491         16  AM-VG-GROUPING                PIC X(6).
  6492         16  AM-VG-STATE                   PIC XX.
  6493         16  AM-VG-ACCOUNT                 PIC X(10).
  6494         16  AM-VG-DATE.
  6495             20  AM-VG-EXPIRATION-DT       PIC XX.
  6496             20  FILLER                    PIC X(4).
  6497         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6498                                           PIC 9(11)      COMP-3.
  6499     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6500         16  FILLER                        PIC X(10).
  6501         16  AM-VG-KEY3.
  6502             20  AM-VG3-ACCOUNT            PIC X(10).
  6503             20  AM-VG3-EXP-DT             PIC XX.
  6504         16  FILLER                        PIC X(4).
  6505     12  AM-MAINT-INFORMATION.
  6506         16  AM-LAST-MAINT-DT              PIC XX.
  6507         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6508         16  AM-LAST-MAINT-USER            PIC X(4).
  6509         16  FILLER                        PIC XX.
  6510
  6511     12  AM-EFFECTIVE-DT                   PIC XX.
  6512     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6513
  6514     12  AM-PREV-DATES  COMP-3.
  6515         16  AM-PREV-EXP-DT                PIC 9(11).
  6516         16  AM-PREV-EFF-DT                PIC 9(11).
  6517
  6518     12  AM-REPORT-CODE-1                  PIC X(10).
  6519     12  AM-REPORT-CODE-2                  PIC X(10).
  6520
  6521     12  AM-CITY-CODE                      PIC X(4).
  6522     12  AM-COUNTY-PARISH                  PIC X(6).
  6523
  6524     12  AM-NAME                           PIC X(30).
  6525     12  AM-PERSON                         PIC X(30).
  6526     12  AM-ADDRS                          PIC X(30).
  6527     12  AM-CITY.
  6528         16  AM-ADDR-CITY                  PIC X(28).
  6529         16  AM-ADDR-STATE                 PIC XX.
  6530     12  AM-ZIP.
  6531         16  AM-ZIP-PRIME.
  6532             20  AM-ZIP-PRI-1ST            PIC X.
  6533                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6534             20  FILLER                    PIC X(4).
  6535         16  AM-ZIP-PLUS4                  PIC X(4).
  6536     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6537         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 124
* EL156.cbl
  6538         16  AM-CAN-POSTAL-2               PIC XXX.
  6539         16  FILLER                        PIC XXX.
  6540     12  AM-TEL-NO.
  6541         16  AM-AREA-CODE                  PIC 999.
  6542         16  AM-TEL-PRE                    PIC 999.
  6543         16  AM-TEL-NBR                    PIC 9(4).
  6544     12  AM-TEL-LOC                        PIC X.
  6545         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6546         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6547
  6548     12  AM-COMM-STRUCTURE.
  6549         16  AM-DEFN-1.
  6550             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6551                 24  AM-AGT.
  6552                     28  AM-AGT-PREFIX     PIC X(4).
  6553                     28  AM-AGT-PRIME      PIC X(6).
  6554                 24  AM-COM-TYP            PIC X.
  6555                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6556                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6557                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6558                 24  AM-RECALC-LV-INDIC    PIC X.
  6559                 24  AM-RETRO-LV-INDIC     PIC X.
  6560                 24  AM-GL-CODES           PIC X.
  6561                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6562                 24  FILLER                PIC X(01).
  6563         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6564             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6565                 24  FILLER                PIC X(11).
  6566                 24  AM-L-COMA             PIC XXX.
  6567                 24  AM-J-COMA             PIC XXX.
  6568                 24  AM-A-COMA             PIC XXX.
  6569                 24  FILLER                PIC X(6).
  6570
  6571     12  AM-COMM-CHANGE-STATUS             PIC X.
  6572         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6573
  6574     12  AM-CSR-CODE                       PIC X(4).
  6575
  6576     12  AM-BILLING-STATUS                 PIC X.
  6577         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6578         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6579     12  AM-AUTO-REFUND-SW                 PIC X.
  6580         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6581         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6582     12  AM-GPCD                           PIC 99.
  6583     12  AM-IG                             PIC X.
  6584         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6585         88  AM-HAS-GROUP                     VALUE '2'.
  6586     12  AM-STATUS                         PIC X.
  6587         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6588         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6589         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6590         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6591         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6592         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6593     12  AM-REMIT-TO                       PIC 99.
  6594     12  AM-ID-NO                          PIC X(11).
  6595
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 125
* EL156.cbl
  6596     12  AM-CAL-TABLE                      PIC XX.
  6597     12  AM-LF-DEVIATION                   PIC XXX.
  6598     12  AM-AH-DEVIATION                   PIC XXX.
  6599     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6600     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6601     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6602     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6603     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6604     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6605
  6606     12  AM-USER-FIELDS.
  6607         16  AM-FLD-1                      PIC XX.
  6608         16  AM-FLD-2                      PIC XX.
  6609         16  AM-FLD-3                      PIC XX.
  6610         16  AM-FLD-4                      PIC XX.
  6611         16  AM-FLD-5                      PIC XX.
  6612
  6613     12  AM-1ST-PROD-DATE.
  6614         16  AM-1ST-PROD-YR                PIC XX.
  6615         16  AM-1ST-PROD-MO                PIC XX.
  6616         16  AM-1ST-PROD-DA                PIC XX.
  6617     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6618     12  AM-CERTS-PURGED-DATE.
  6619         16  AM-PUR-YR                     PIC XX.
  6620         16  AM-PUR-MO                     PIC XX.
  6621         16  AM-PUR-DA                     PIC XX.
  6622     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6623     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6624     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6625     12  AM-INACTIVE-DATE.
  6626         16  AM-INA-MO                     PIC 99.
  6627         16  AM-INA-DA                     PIC 99.
  6628         16  AM-INA-YR                     PIC 99.
  6629     12  AM-AR-HI-CERT-DATE                PIC XX.
  6630
  6631     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6632     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6633
  6634     12  AM-OB-PAYMENT-MODE                PIC X.
  6635         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6636         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6637         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6638         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6639
  6640     12  AM-AH-ONLY-INDICATOR              PIC X.
  6641         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6642         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6643
  6644     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6645
  6646     12  AM-OVER-SHORT.
  6647         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6648         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6649
  6650     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6651     12  AM-DCC-CLP-STATE                  PIC XX.
  6652
  6653     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 126
* EL156.cbl
  6654     12  AM-RECALC-REIN                    PIC X.
  6655
  6656     12  AM-REI-TABLE                      PIC XXX.
  6657     12  AM-REI-ET-LF                      PIC X.
  6658     12  AM-REI-ET-AH                      PIC X.
  6659     12  AM-REI-PE-LF                      PIC X.
  6660     12  AM-REI-PE-AH                      PIC X.
  6661     12  AM-REI-PRT-ST                     PIC X.
  6662     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6663     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6664     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6665     12  AM-REI-GROUP-A                    PIC X(6).
  6666     12  AM-REI-MORT                       PIC X(4).
  6667     12  AM-REI-PRT-OW                     PIC X.
  6668     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6669     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6670     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6671     12  AM-REI-GROUP-B                    PIC X(6).
  6672
  6673     12  AM-TRUST-TYPE                     PIC X(2).
  6674
  6675     12  AM-EMPLOYER-STMT-USED             PIC X.
  6676     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6677
  6678     12  AM-STD-AH-TYPE                    PIC XX.
  6679     12  AM-EARN-METHODS.
  6680         16  AM-EARN-METHOD-R              PIC X.
  6681             88 AM-REF-RL-R78                 VALUE 'R'.
  6682             88 AM-REF-RL-PR                  VALUE 'P'.
  6683             88 AM-REF-RL-MEAN                VALUE 'M'.
  6684             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6685         16  AM-EARN-METHOD-L              PIC X.
  6686             88 AM-REF-LL-R78                 VALUE 'R'.
  6687             88 AM-REF-LL-PR                  VALUE 'P'.
  6688             88 AM-REF-LL-MEAN                VALUE 'M'.
  6689             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6690         16  AM-EARN-METHOD-A              PIC X.
  6691             88 AM-REF-AH-R78                 VALUE 'R'.
  6692             88 AM-REF-AH-PR                  VALUE 'P'.
  6693             88 AM-REF-AH-MEAN                VALUE 'M'.
  6694             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6695             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6696             88 AM-REF-AH-NET                 VALUE 'N'.
  6697
  6698     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6699     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6700     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6701
  6702     12  AM-RET-Y-N                        PIC X.
  6703     12  AM-RET-P-E                        PIC X.
  6704     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6705     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6706     12  AM-RET-GRP                        PIC X(6).
  6707     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6708         16  AM-POOL-PRIME                 PIC XXX.
  6709         16  AM-POOL-SUB                   PIC XXX.
  6710     12  AM-RETRO-EARNINGS.
  6711         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 127
* EL156.cbl
  6712         16  AM-RET-EARN-L                 PIC X.
  6713         16  AM-RET-EARN-A                 PIC X.
  6714     12  AM-RET-ST-TAX-USE                 PIC X.
  6715         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6716         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6717     12  AM-RETRO-BEG-EARNINGS.
  6718         16  AM-RET-BEG-EARN-R             PIC X.
  6719         16  AM-RET-BEG-EARN-L             PIC X.
  6720         16  AM-RET-BEG-EARN-A             PIC X.
  6721     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6722     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6723
  6724     12  AM-USER-SELECT-OPTIONS.
  6725         16  AM-USER-SELECT-1              PIC X(10).
  6726         16  AM-USER-SELECT-2              PIC X(10).
  6727         16  AM-USER-SELECT-3              PIC X(10).
  6728         16  AM-USER-SELECT-4              PIC X(10).
  6729         16  AM-USER-SELECT-5              PIC X(10).
  6730
  6731     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6732
  6733     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6734
  6735     12  AM-RPT045A-SWITCH                 PIC X.
  6736         88  RPT045A-OFF                   VALUE 'N'.
  6737
  6738     12  AM-INSURANCE-LIMITS.
  6739         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6740         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6741
  6742     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6743         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6744
  6745     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6746         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6747         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6748
  6749     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6750
  6751     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6752     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6753     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6754     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6755     12  AM-DCC-UEF-STATE                  PIC XX.
  6756     12  FILLER                            PIC XXX.
  6757     12  AM-REPORT-CODE-3                  PIC X(10).
  6758*    12  FILLER                            PIC X(22).
  6759
  6760     12  AM-RESERVE-DATE.
  6761         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6762         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6763         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6764
  6765     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6766     12  AM-NOTIFICATION-TYPES.
  6767         16  AM-NOTIF-OF-LETTERS           PIC X.
  6768         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6769         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 128
* EL156.cbl
  6770         16  AM-NOTIF-OF-STATUS            PIC X.
  6771
  6772     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6773         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6774         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6775         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6776         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6777
  6778     12  AM-BENEFIT-CONTROLS.
  6779         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6780             20  AM-BENEFIT-CODE           PIC XX.
  6781             20  AM-BENEFIT-TYPE           PIC X.
  6782             20  AM-BENEFIT-REVISION       PIC XXX.
  6783             20  AM-BENEFIT-REM-TERM       PIC X.
  6784             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6785             20  FILLER                    PIC XX.
  6786         16  FILLER                        PIC X(80).
  6787
  6788     12  AM-TRANSFER-DATA.
  6789         16  AM-TRANSFERRED-FROM.
  6790             20  AM-TRNFROM-CARRIER        PIC X.
  6791             20  AM-TRNFROM-GROUPING.
  6792                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6793                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6794             20  AM-TRNFROM-STATE          PIC XX.
  6795             20  AM-TRNFROM-ACCOUNT.
  6796                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6797                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6798             20  AM-TRNFROM-DTE            PIC XX.
  6799         16  AM-TRANSFERRED-TO.
  6800             20  AM-TRNTO-CARRIER          PIC X.
  6801             20  AM-TRNTO-GROUPING.
  6802                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6803                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6804             20  AM-TRNTO-STATE            PIC XX.
  6805             20  AM-TRNTO-ACCOUNT.
  6806                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6807                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6808             20  AM-TRNTO-DTE              PIC XX.
  6809         16  FILLER                        PIC X(10).
  6810
  6811     12  AM-SAVED-REMIT-TO                 PIC 99.
  6812
  6813     12  AM-COMM-STRUCTURE-SAVED.
  6814         16  AM-DEFN-1-SAVED.
  6815             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6816                 24  AM-AGT-SV             PIC X(10).
  6817                 24  AM-COM-TYP-SV         PIC X.
  6818                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6819                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6820                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6821                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6822                 24  FILLER                PIC X.
  6823                 24  AM-GL-CODES-SV        PIC X.
  6824                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6825                 24  FILLER                PIC X.
  6826         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6827             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 129
* EL156.cbl
  6828                 24  FILLER                PIC X(11).
  6829                 24  AM-L-COMA-SV          PIC XXX.
  6830                 24  AM-J-COMA-SV          PIC XXX.
  6831                 24  AM-A-COMA-SV          PIC XXX.
  6832                 24  FILLER                PIC X(6).
  6833
  6834     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6835         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6836            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6837            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6838            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6839
  6840     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6841     12  FILLER                            PIC X(120).
  6842
  6843     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6844         16  AM-CONTROL-NAME               PIC X(30).
  6845         16  AM-EXECUTIVE-ONE.
  6846             20  AM-EXEC1-NAME             PIC X(15).
  6847             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6848                                                          COMP-3.
  6849             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6850                                                          COMP-3.
  6851         16  AM-EXECUTIVE-TWO.
  6852             20  AM-EXEC2-NAME             PIC X(15).
  6853             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6854                                                          COMP-3.
  6855             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6856                                                          COMP-3.
  6857
  6858     12  AM-RETRO-ADDITIONAL-DATA.
  6859         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6860         16  AM-RETRO-PREM-P-E             PIC X.
  6861         16  AM-RETRO-CLMS-P-I             PIC X.
  6862         16  AM-RETRO-RET-BRACKET-LF.
  6863             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6864                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6865                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6866             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6867                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6868                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6869             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6870                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6871                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6872         16  AM-RETRO-RET-BRACKET-AH.
  6873             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6874                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6875                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6876                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6877             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6878                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6879                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6880             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6881                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6882                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6883
  6884     12  AM-COMMENTS.
  6885         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 130
* EL156.cbl
  6886
  6887     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6888         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6889         16  AM-FLI-BILLING-CODE           PIC X.
  6890         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6891         16  AM-FLI-UNITED-IDENT           PIC X.
  6892         16  AM-FLI-INTEREST-LOST-DATA.
  6893             20  AM-FLI-BANK-NO            PIC X(5).
  6894             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6895             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6896             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6897         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6898             20  AM-FLI-AGT                PIC X(9).
  6899             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6900             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6901         16  FILLER                        PIC X(102).
  6902
  6903     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6904         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6905             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6906             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6907             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6908             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6909             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6910         16  FILLER                          PIC X(10).
  6911******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 131
* EL156.cbl
  6913*    COPY ELCCHKQ.
  6914******************************************************************
  6915*                                                                *
  6916*                                                                *
  6917*                            ELCCHKQ.                            *
  6918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6919*                            VMOD=2.007                          *
  6920*                                                                *
  6921*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6922*                                                                *
  6923*   FILE TYPE = VSAM,KSDS                                        *
  6924*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6925*                                                                *
  6926*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6927*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6928*                                                                *
  6929*   LOG = YES                                                    *
  6930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6931******************************************************************
  6932 01  CHECK-QUE.
  6933     12  CQ-RECORD-ID                PIC XX.
  6934         88  VALID-CQ-ID         VALUE 'CQ'.
  6935
  6936     12  CQ-CONTROL-PRIMARY.
  6937         16  CQ-COMPANY-CD           PIC X.
  6938         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6939         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6940
  6941     12  CQ-CONTROL-BY-PAYEE.
  6942         16  CQ-CONTROL-BY-NUMBER.
  6943             20  CQ-COMPANY-CD-A1     PIC X.
  6944             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6945         16  CQ-PAYEE-CARRIER        PIC X.
  6946         16  CQ-PAYEE-GROUPING       PIC X(6).
  6947         16  CQ-PAYEE-STATE          PIC XX.
  6948         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6949         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6950
  6951     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6952         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6953         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6954         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6955         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6956         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6957         16  FILLER                  PIC X(3).
  6958
  6959     12  CQ-ENTRY-TYPE               PIC X.
  6960             88  CHECK-ON-QUE           VALUE 'Q'.
  6961             88  ALIGNMENT-CHECK        VALUE 'A'.
  6962             88  SPOILED-CHECK          VALUE 'S'.
  6963             88  PAYMENT-ABORTED        VALUE 'X'.
  6964
  6965     12  CQ-CLAIM-MAST-CNTL.
  6966         16  CQ-CARRIER              PIC X.
  6967         16  CQ-CLAIM-NO             PIC X(7).
  6968         16  CQ-CERT-NO.
  6969             20  CQ-CERT-PRIME       PIC X(10).
  6970             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 132
* EL156.cbl
  6971         16  CQ-CLAIM-TYPE           PIC X.
  6972             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6973             88  CQ-AH-CLAIM            VALUE 'A'.
  6974         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6975             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6976             88  CQ-O-B-COVERAGE        VALUE '2'.
  6977             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6978
  6979     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6980     12  CQ-CHECK-NUMBER             PIC X(7).
  6981     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6982     12  CQ-PAYMENT-TYPE             PIC X.
  6983             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6984             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6985             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6986             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6987             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6988             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6989             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6990             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6991     12  CQ-VOID-INDICATOR           PIC X.
  6992             88  CHECK-IS-STOPPED          VALUE 'S'.
  6993             88  CHECK-IS-VOID             VALUE 'V'.
  6994     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6995     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6996     12  CQ-CHECK-BY-USER            PIC X(4).
  6997     12  CQ-PRE-NUMBERING-SW         PIC X.
  6998       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6999       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7000
  7001     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7002     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7003     12  CQ-LEDGER-FLAG              PIC X(01).
  7004     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7005     12  CQ-LAST-UPDATED-DT          PIC XX.
  7006     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7007     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7008
  7009     12  FILLER                      PIC X(04).
  7010
  7011******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 133
* EL156.cbl
  7013*    COPY ELCBENE.
  7014******************************************************************
  7015*                                                                *
  7016*                            ELCBENE.                            *
  7017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7018*                            VMOD=2.006                          *
  7019*                                                                *
  7020*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7021*                                                                *
  7022*   FILE TYPE = VSAM,KSDS                                        *
  7023*   RECORD SIZE = 500   RECFORM = FIX                            *
  7024*                                                                *
  7025*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7026*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7027*                                                                *
  7028*   LOG = YES                                                    *
  7029*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7030*                                                                *
  7031*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7032******************************************************************
  7033
  7034 01  BENEFICIARY-MASTER.
  7035     12  BE-RECORD-ID                PIC XX.
  7036         88  VALID-BE-ID                VALUE 'BE'.
  7037
  7038     12  BE-CONTROL-PRIMARY.
  7039         16  BE-COMPANY-CD           PIC X.
  7040         16  BE-RECORD-TYPE          PIC X.
  7041             88  BENEFICIARY-RECORD  VALUE 'B'.
  7042             88  ADJUSTOR-RECORD     VALUE 'A'.
  7043         16  BE-BENEFICIARY          PIC X(10).
  7044     12  BE-CONTROL-BY-NAME.
  7045         16  BE-COMPANY-CD-A1        PIC X.
  7046         16  BE-RECORD-TYPE-A1       PIC X.
  7047         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7048         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7049
  7050     12  BE-LAST-MAINT-DT            PIC XX.
  7051     12  BE-LAST-MAINT-BY            PIC X(4).
  7052     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7053
  7054     12  BE-ADDRESS-DATA.
  7055         16  BE-MAIL-TO-NAME         PIC X(30).
  7056         16  BE-ADDRESS-LINE-1       PIC X(30).
  7057         16  BE-ADDRESS-LINE-2       PIC X(30).
  7058         16  BE-ADDRESS-LINE-3       PIC X(30).
  7059         16  BE-CITY-STATE.
  7060             20  BE-CITY             PIC X(28).
  7061             20  BE-STATE            PIC XX.
  7062         16  BE-ZIP-CODE.
  7063             20  BE-ZIP-PRIME.
  7064                 24  BE-ZIP-1ST      PIC X.
  7065                     88  BE-CANADIAN-POST-CODE
  7066                                         VALUE 'A' THRU 'Z'.
  7067                 24  FILLER          PIC X(4).
  7068             20  BE-ZIP-PLUS4        PIC X(4).
  7069         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7070             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 134
* EL156.cbl
  7071             20  BE-CAN-POSTAL-2     PIC XXX.
  7072             20  FILLER              PIC XXX.
  7073         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7074         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7075
  7076******************************************************************
  7077*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7078*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7079******************************************************************
  7080     12  BE-CARRIER                  PIC X.
  7081
  7082     12  BE-ADDRESS-DATA2.
  7083         16  BE-MAIL-TO-NAME2        PIC X(30).
  7084         16  BE-ADDRESS-LINE-12      PIC X(30).
  7085         16  BE-ADDRESS-LINE-22      PIC X(30).
  7086         16  BE-ADDRESS-LINE-32      PIC X(30).
  7087         16  BE-CITY-STATE2.
  7088             20  BE-CITY2            PIC X(28).
  7089             20  BE-STATE2           PIC XX.
  7090         16  BE-ZIP-CODE2.
  7091             20  BE-ZIP-PRIME2.
  7092                 24  BE-ZIP-1ST2     PIC X.
  7093                     88  BE-CANADIAN-POST-CODE2
  7094                                         VALUE 'A' THRU 'Z'.
  7095                 24  FILLER          PIC X(4).
  7096             20  BE-ZIP-PLUS42       PIC X(4).
  7097         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7098             20  BE-CAN-POSTAL-12    PIC XXX.
  7099             20  BE-CAN-POSTAL-22    PIC XXX.
  7100             20  FILLER              PIC XXX.
  7101         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7102         16  BE-BILLING-STMT-DATA.
  7103             20  BE-BSR              PIC X.
  7104                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7105                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7106             20  BE-BSR-FROM         PIC X(30).
  7107             20  BE-BSR-DEPT         PIC X(30).
  7108             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7109             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7110             20  BE-OUTPUT-TYPE      PIC X.
  7111                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7112                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7113
  7114     12  FILLER                      PIC X(28).
  7115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 135
* EL156.cbl
  7117*    COPY ELCARCH.
  7118******************************************************************
  7119*                                                                *
  7120*                            ELCARCH.                            *
  7121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7122*                            VMOD=2.007                          *
  7123*                                                                *
  7124*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7125*                                                                *
  7126*   FILE TYPE = VSAM,KSDS                                        *
  7127*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7128*                                                                *
  7129*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7130*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7131*                                                                *
  7132*   LOG = NO                                                     *
  7133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7134*                                                                *
  7135*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7136******************************************************************
  7137 01  LETTER-ARCHIVE.
  7138     12  LA-RECORD-ID                PIC XX.
  7139         88  VALID-LA-ID                VALUE 'LA'.
  7140
  7141     12  LA-CONTROL-PRIMARY.
  7142         16  LA-COMPANY-CD           PIC X.
  7143         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7144         16  LA-RECORD-TYPE          PIC X.
  7145             88  LA-HEADER-DATA         VALUE '1'.
  7146             88  LA-ADDRESS-DATA        VALUE '2'.
  7147             88  LA-TEXT-DATA           VALUE '3'.
  7148             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7149         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7150
  7151     12  LA-CONTROL-BY-TYPE.
  7152         16  LA-COMPANY-CD-A1        PIC X.
  7153         16  LA-RECORD-TYPE-A1       PIC X.
  7154         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7155         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7156
  7157     12  LA-TEXT-RECORD.
  7158         16  LA-SKIP-CONTROL         PIC XX.
  7159             88  NO-LINES-SKIPPED       VALUE SPACES.
  7160             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7161         16  LA-TEXT-LINE            PIC X(70).
  7162
  7163     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7164         16  FILLER                  PIC XX.
  7165         16  LA-ADDRESS-LINE         PIC X(30).
  7166         16  FILLER                  PIC X(40).
  7167
  7168     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7169         16  FILLER                  PIC XX.
  7170         16  LA-CARRIER              PIC X.
  7171         16  LA-CLAIM-NO             PIC X(7).
  7172         16  LA-CERT-NO.
  7173             20  LA-CERT-PRIME       PIC X(10).
  7174             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 136
* EL156.cbl
  7175         16  LA-NO-OF-COPIES         PIC S9.
  7176         16  LA-RESEND-DATE          PIC XX.
  7177         16  LA-PROCESSOR-CD         PIC X(4).
  7178         16  LA-CREATION-DT          PIC XX.
  7179         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7180         16  LA-RESEND-PRINT-DATE    PIC XX.
  7181         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7182         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7183*
  7184* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7185*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7186*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7187*   I        20  LA-DMD-RES-ST           PIC XX.
  7188*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7189*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7190*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7191*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7192*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7193*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7194*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7195*   I        20  LA-DMD-UND-CODE         PIC XX.
  7196*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7197*   V    16  FILLER                  PIC X(15).
  7198* -----
  7199*
  7200* REINSERTED  CSO  MODS
  7201*
  7202         16  FILLER.
  7203             20  FILLER                  PIC X(29).
  7204             20  LA-CSO-LETTER-STATUS    PIC X.
  7205                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7206                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7207                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7208             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7209             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7210*
  7211
  7212     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7213         16  FILLER                  PIC XX.
  7214         16  LA4-CARRIER             PIC X.
  7215         16  LA4-CLAIM-NO            PIC X(7).
  7216         16  LA4-CERT-NO.
  7217             20  LA4-CERT-PRIME      PIC X(10).
  7218             20  LA4-CERT-SFX        PIC X.
  7219         16  LA4-NO-OF-COPIES        PIC S9.
  7220         16  LA4-RESEND-DATE         PIC XX.
  7221         16  LA4-PROCESSOR-CD        PIC X(4).
  7222         16  LA4-CREATION-DT         PIC XX.
  7223         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7224         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7225         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7226         16  LA4-FORM-TYPE           PIC X.
  7227             88  LA4-INITIAL-FORM    VALUE '1'.
  7228             88  LA4-PROGRESS-FORM   VALUE '2'.
  7229         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7230         16  LA4-STATE               PIC X(02).
  7231         16  FILLER                  PIC X(31).
  7232******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 137
* EL156.cbl
  7234*    COPY ELCDAR.
  7235******************************************************************
  7236*                                                                *
  7237*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7238*   FILE TYPE = VSAM,KSDS                                        *
  7239*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7240*   BASE CLUSTER = DLYACTV                                       *
  7241*   LOG = YES                                                    *
  7242*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7243*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7244*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7245*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7246*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7247*               BY PROGRAM "LGINFCE".                            *
  7248*                                                                *
  7249******************************************************************
  7250 01  DAILY-ACTIVITY-RECORD.
  7251     05  DA-KEY.
  7252         10  DA-COMP-CD          PIC X.
  7253         10  DA-CARRIER          PIC X.
  7254         10  DA-CLAIM-NO         PIC X(7).
  7255         10  DA-CERT-NO.
  7256             15  DA-CERT-PRIME   PIC X(10).
  7257             15  DA-CERT-SFX     PIC X.
  7258     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7259     05  DA-RECORD-TYPE          PIC X.
  7260     05  FILLER                  PIC X(2).
  7261******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 138
* EL156.cbl
  7263*    COPY ERCCOMP.
  7264******************************************************************
  7265*                                                                *
  7266*                                                                *
  7267*                            ERCCOMP                             *
  7268*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7269*                            VMOD=2.019                          *
  7270*                                                                *
  7271*   ONLINE CREDIT SYSTEM                                         *
  7272*                                                                *
  7273*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7274*                                                                *
  7275*   FILE TYPE = VSAM,KSDS                                        *
  7276*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7277*                                                                *
  7278*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7279*       ALTERNATE PATH = NONE                                    *
  7280*                                                                *
  7281*   LOG = NO                                                     *
  7282*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7283*                                                                *
  7284******************************************************************
  7285*                   C H A N G E   L O G
  7286*
  7287* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7288*-----------------------------------------------------------------
  7289*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7290* EFFECTIVE    NUMBER
  7291*-----------------------------------------------------------------
  7292* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7293* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7294* 092205    2005050300006  PEMA  ADD LEASE FEE
  7295* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7296* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7297* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7298* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7299* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7300* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7301******************************************************************
  7302
  7303 01  COMPENSATION-MASTER.
  7304     12  CO-RECORD-ID                          PIC XX.
  7305         88  VALID-CO-ID                          VALUE 'CO'.
  7306
  7307     12  CO-CONTROL-PRIMARY.
  7308         16  CO-COMPANY-CD                     PIC X.
  7309         16  CO-CONTROL.
  7310             20  CO-CTL-1.
  7311                 24  CO-CARR-GROUP.
  7312                     28  CO-CARRIER            PIC X.
  7313                     28  CO-GROUPING.
  7314                         32  CO-GROUP-PREFIX   PIC XXX.
  7315                         32  CO-GROUP-PRIME    PIC XXX.
  7316                 24  CO-RESP-NO.
  7317                     28  CO-RESP-PREFIX        PIC X(4).
  7318                     28  CO-RESP-PRIME         PIC X(6).
  7319             20  CO-CTL-2.
  7320                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 139
* EL156.cbl
  7321                     28  CO-ACCT-PREFIX        PIC X(4).
  7322                     28  CO-ACCT-PRIME         PIC X(6).
  7323         16  CO-TYPE                           PIC X.
  7324             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7325             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7326             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7327
  7328     12  CO-MAINT-INFORMATION.
  7329         16  CO-LAST-MAINT-DT                  PIC XX.
  7330         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7331         16  CO-LAST-MAINT-USER                PIC X(4).
  7332     12  FILLER                                PIC XX.
  7333     12  CO-STMT-TYPE                          PIC XXX.
  7334     12  CO-COMP-TYPE                          PIC X.
  7335         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7336     12  CO-STMT-OWNER                         PIC X(4).
  7337     12  CO-BALANCE-CONTROL                    PIC X.
  7338         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7339         88  CO-NO-BALANCE                        VALUE 'N'.
  7340
  7341     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7342         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7343         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7344         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7345
  7346     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7347         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7348         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7349
  7350     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7351     12  CO-GA-DIRECT-DEP                      PIC X.
  7352     12  CO-FUTURE-SPACE                       PIC X.
  7353         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7354
  7355     12  CO-ACCT-NAME                          PIC X(30).
  7356     12  CO-MAIL-NAME                          PIC X(30).
  7357     12  CO-ADDR-1                             PIC X(30).
  7358     12  CO-ADDR-2                             PIC X(30).
  7359     12  CO-ADDR-3.
  7360         16  CO-ADDR-CITY                      PIC X(27).
  7361         16  CO-ADDR-STATE                     PIC XX.
  7362     12  CO-CSO-1099                           PIC X.
  7363     12  CO-ZIP.
  7364         16  CO-ZIP-PRIME.
  7365             20  CO-ZIP-PRI-1ST                PIC X.
  7366                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7367             20  FILLER                        PIC X(4).
  7368         16  CO-ZIP-PLUS4                      PIC X(4).
  7369     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7370         16  CO-CAN-POSTAL-1                   PIC XXX.
  7371         16  CO-CAN-POSTAL-2                   PIC XXX.
  7372         16  FILLER                            PIC XXX.
  7373     12  CO-SOC-SEC                            PIC X(13).
  7374     12  CO-TELEPHONE.
  7375         16  CO-AREA-CODE                      PIC XXX.
  7376         16  CO-PREFIX                         PIC XXX.
  7377         16  CO-PHONE                          PIC X(4).
  7378
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 140
* EL156.cbl
  7379     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7380
  7381     12  CO-AR-BAL-LEVEL                       PIC X.
  7382         88  CO-AR-REF-LVL                        VALUE '1'.
  7383         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7384         88  CO-AR-BILL-LVL                       VALUE '2'.
  7385         88  CO-AR-AGT-LVL                        VALUE '3'.
  7386         88  CO-AR-FR-LVL                         VALUE '4'.
  7387
  7388     12  CO-AR-NORMAL-PRINT                    PIC X.
  7389         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7390         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7391
  7392     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7393
  7394     12  CO-AR-REPORTING                       PIC X.
  7395         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7396         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7397
  7398     12  CO-AR-PULL-CHECK                      PIC X.
  7399         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7400         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7401
  7402     12  CO-AR-BALANCE-PRINT                   PIC X.
  7403         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7404
  7405     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7406         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7407         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7408         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7409
  7410     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7411
  7412     12  CO-USER-CODE                          PIC X.
  7413     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7414
  7415******************************************************************
  7416*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7417*    THE LAST MONTH END RUN.
  7418******************************************************************
  7419
  7420     12  CO-LAST-ACTIVITY-DATE.
  7421         16  CO-ACT-YEAR                       PIC 99.
  7422         16  CO-ACT-MONTH                      PIC 99.
  7423         16  CO-ACT-DAY                        PIC 99.
  7424
  7425     12  CO-LAST-STMT-DT.
  7426         16  CO-LAST-STMT-YEAR                 PIC 99.
  7427         16  CO-LAST-STMT-MONTH                PIC 99.
  7428         16  CO-LAST-STMT-DAY                  PIC 99.
  7429
  7430     12  CO-MO-END-TOTALS.
  7431         16  CO-MONTHLY-TOTALS.
  7432             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7433             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7434             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7435             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7436             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 141
* EL156.cbl
  7437
  7438         16  CO-AGING-TOTALS.
  7439             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7440             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7441             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7442             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7443
  7444         16  CO-YTD-TOTALS.
  7445             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7446             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7447
  7448         16  CO-OVER-UNDER-TOTALS.
  7449             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7450             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7451
  7452     12  CO-MISCELLANEOUS-TOTALS.
  7453         16  CO-FICA-TOTALS.
  7454             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7455             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7456
  7457         16  CO-CLAIM-TOTALS.
  7458             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7459             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7460
  7461******************************************************************
  7462*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7463*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7464******************************************************************
  7465
  7466     12  CO-CURRENT-TOTALS.
  7467         16  CO-CURRENT-LAST-STMT-DT.
  7468             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7469             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7470             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7471
  7472         16  CO-CURRENT-MONTHLY-TOTALS.
  7473             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7474             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7475             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7476             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7477             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7478
  7479         16  CO-CURRENT-AGING-TOTALS.
  7480             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7481             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7482             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7483             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7484
  7485         16  CO-CURRENT-YTD-TOTALS.
  7486             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7487             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7488
  7489     12  CO-PAID-COMM-TOTALS.
  7490         16  CO-YTD-PAID-COMMS.
  7491             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7492             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7493
  7494     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 142
* EL156.cbl
  7495         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7496         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7497
  7498     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7499         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7500         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7501         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7502         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7503         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7504         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7505         88  CO-FINAL-LETTER                  VALUE 'F'.
  7506         88  CO-RECONCILING                   VALUE 'R'.
  7507         88  CO-PHONE-CALL                    VALUE 'P'.
  7508         88  CO-LEGAL                         VALUE 'L'.
  7509         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7510         88  CO-WRITE-OFF                     VALUE 'W'.
  7511         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7512
  7513     12  CO-CSR-CODE                       PIC X(4).
  7514
  7515     12  CO-GA-STATUS-INFO.
  7516         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7517         16  CO-GA-TERMINATION-DT          PIC XX.
  7518         16  CO-GA-STATUS-CODE             PIC X.
  7519             88  CO-GA-ACTIVE                 VALUE 'A'.
  7520             88  CO-GA-INACTIVE               VALUE 'I'.
  7521             88  CO-GA-PENDING                VALUE 'P'.
  7522         16  CO-GA-COMMENTS.
  7523             20  CO-GA-COMMENT-1           PIC X(40).
  7524             20  CO-GA-COMMENT-2           PIC X(40).
  7525             20  CO-GA-COMMENT-3           PIC X(40).
  7526             20  CO-GA-COMMENT-4           PIC X(40).
  7527
  7528     12  CO-RPTCD2                         PIC X(10).
  7529     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7530         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7531         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7532
  7533     12  CO-TYPE-AGENT                     PIC X(01).
  7534         88  CO-CORPORATION                   VALUE 'C'.
  7535         88  CO-PARTNERSHIP                   VALUE 'P'.
  7536         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7537         88  CO-TRUST                         VALUE 'T'.
  7538         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7539
  7540     12  CO-FAXNO.
  7541         16  CO-FAX-AREA-CODE                  PIC XXX.
  7542         16  CO-FAX-PREFIX                     PIC XXX.
  7543         16  CO-FAX-PHONE                      PIC X(4).
  7544
  7545     12  CO-BANK-INFORMATION.
  7546         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7547         16  CO-BANK-TRANSIT-NON REDEFINES
  7548             CO-BANK-TRANSIT-NO                PIC 9(8).
  7549
  7550         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7551     12  CO-MISC-DEDUCT-INFO REDEFINES
  7552                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 143
* EL156.cbl
  7553         16  CO-MD-GL-ACCT                     PIC X(10).
  7554         16  CO-MD-DIV                         PIC XX.
  7555         16  CO-MD-CENTER                      PIC X(4).
  7556         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7557         16  CO-CREATE-AP-CHECK                PIC X.
  7558         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7559         16  FILLER                            PIC XXX.
  7560     12  CO-ACH-STATUS                         PIC X.
  7561         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7562         88  CO-ACH-PENDING                        VALUE 'P'.
  7563
  7564     12  CO-BILL-SW                            PIC X.
  7565     12  CO-CONTROL-NAME                       PIC X(30).
  7566     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7567     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7568     12  CO-CLP-STATE                          PIC XX.
  7569     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7570     12  CO-SPP-REFUND-EDIT                    PIC X.
  7571
  7572******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 144
* EL156.cbl
  7574*    COPY ERCDMDNT.
  7575******************************************************************
  7576*                                                                *
  7577*                            ERCDMDNT                            *
  7578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7579*                            VMOD=2.005                          *
  7580*                                                                *
  7581*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7582*                                                                *
  7583*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7584*                                                                *
  7585*        FILE TYPE= VSAM,KSDS                                    *
  7586*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7587*                                                                *
  7588*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7589*                                                                *
  7590*        LOG = YES                                               *
  7591*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7592*                                                                *
  7593******************************************************************
  7594
  7595 01  CERTIFICATE-NOTE.
  7596     12  CN-RECORD-ID                     PIC  XX.
  7597         88  VALID-CN-ID                      VALUE 'CN'.
  7598
  7599     12  CN-CONTROL-PRIMARY.
  7600         16  CN-COMPANY-CD                PIC X.
  7601         16  CN-CERT-KEY.
  7602             20  CN-CARRIER               PIC X.
  7603             20  CN-GROUPING.
  7604                 24  CN-GROUPING-PREFIX   PIC XXX.
  7605                 24  CN-GROUPING-PRIME    PIC XXX.
  7606             20  CN-STATE                 PIC XX.
  7607             20  CN-ACCOUNT.
  7608                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7609                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7610             20  CN-CERT-EFF-DT           PIC XX.
  7611             20  CN-CERT-NO.
  7612                 24  CN-CERT-PRIME        PIC X(10).
  7613                 24  CN-CERT-SFX          PIC X.
  7614
  7615     12  CN-BILLING-START-LINE-NO         PIC 99.
  7616     12  CN-BILLING-END-LINE-NO           PIC 99.
  7617
  7618     12  CN-LINES.
  7619         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7620
  7621     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7622         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7623         16  CN-CSI-GENERAL-DATA-AREA.
  7624             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7625
  7626         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7627             CN-CSI-GENERAL-DATA-AREA.
  7628             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7629             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7630             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7631             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 145
* EL156.cbl
  7632             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7633             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7634             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7635             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7636             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7637             20  FILLER                       PIC XX.
  7638             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7639             20  FILLER                       PIC X(38).
  7640
  7641         16  CN-CSI-PRODUCT-DATA-AREA.
  7642             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7643
  7644         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7645             CN-CSI-PRODUCT-DATA-AREA.
  7646             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7647             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7648             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7649             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7650             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7651             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7652             20  FILLER                   PIC XX.
  7653             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7654             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7655             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7656             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7657             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7658             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7659             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7660             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7661             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7662             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7663             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7664             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7665             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7666             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7667             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7668             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7669             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7670             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7671             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7672             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7673             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7674             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7675             20  FILLER                   PIC X(25).
  7676
  7677         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7678             CN-CSI-CREDIT-CARD-DATA.
  7679             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7680             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7681             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7682             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7683             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7684             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7685             20  FILLER                   PIC XX.
  7686             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7687             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7688             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7689             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 146
* EL156.cbl
  7690             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7691             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7692             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7693             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7694             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7695             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7696             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7697             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7698             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7699             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7700             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7701             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7702             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7703             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7704             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7705             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7706             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7707             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7708             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7709             20  FILLER                   PIC X(17).
  7710
  7711         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7712             CN-CSI-FAMILY-LEAVE-DATA.
  7713             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7714             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7715             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7716             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7717             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7718             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7719             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7720             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7721             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7722             20  CN-CSI-SL-INT-ON-PROCEEDS
  7723                                          PIC S9(5)V99  COMP-3.
  7724             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7725             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7726             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7727             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7728             20  CN-CSI-SL-POLICY-BENEFITS
  7729                                          PIC S9(5)V99  COMP-3.
  7730             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7731             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7732             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7733             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7734             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7735             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7736             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7737             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7738             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7739             20  CN-CSI-SL-STATE-NOT      PIC X.
  7740             20  FILLER                   PIC XX.
  7741
  7742         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7743             CN-CSI-SENIOR-LIFE-DATA.
  7744             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7745             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7746             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7747                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 147
* EL156.cbl
  7748             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7749             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7750             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7751             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7752             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7753             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7754             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7755             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7756             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7757             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7758             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7759             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7760             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7761             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7762             20  CN-CSI-PP-REPAIR         PIC X.
  7763             20  CN-CSI-PP-REPLACE        PIC X.
  7764             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7765             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7766             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7767             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7768             20  FILLER                   PIC X(5).
  7769
  7770         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7771             CN-CSI-PURCH-PROP-DATA.
  7772             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7773             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7774             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7775             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7776             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7777             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7778             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7779             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7780             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7781             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7782             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7783             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7784             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7785             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7786             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7787             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7788             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7789             20  CN-CSI-EW-REPLACE        PIC X.
  7790             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7791             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7792             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7793             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7794             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7795             20  FILLER                   PIC X(4).
  7796
  7797     12  CN-LAST-MAINT-DT                 PIC XX.
  7798     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7799     12  CN-LAST-MAINT-USER               PIC X(4).
  7800     12  FILLER                           PIC X(6).
  7801
  7802******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 148
* EL156.cbl
  7804*    COPY ERCCNOT.
  7805******************************************************************
  7806*                                                                *
  7807*                            ERCCNOT                             *
  7808*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7809*                            VMOD=2.003                          *
  7810*                                                                *
  7811*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7812*                                                                *
  7813*        FILE TYPE= VSAM,KSDS                                    *
  7814*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7815*                                                                *
  7816*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7817*                                                                *
  7818*        LOG = YES                                               *
  7819*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7820*                                                                *
  7821******************************************************************
  7822*                   C H A N G E   L O G
  7823*
  7824* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7825*-----------------------------------------------------------------
  7826*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7827* EFFECTIVE    NUMBER
  7828*-----------------------------------------------------------------
  7829* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7830******************************************************************
  7831
  7832 01  CERT-NOTE-FILE.
  7833     12  CZ-RECORD-ID                PIC  XX.
  7834         88  VALID-CZ-ID                  VALUE 'CZ'.
  7835
  7836     12  CZ-CONTROL-PRIMARY.
  7837         16  CZ-COMPANY-CD           PIC X.
  7838         16  CZ-CARRIER              PIC X.
  7839         16  CZ-GROUPING.
  7840             20 CZ-GROUPING-PREFIX   PIC XXX.
  7841             20 CZ-GROUPING-PRIME    PIC XXX.
  7842         16  CZ-STATE                PIC XX.
  7843         16  CZ-ACCOUNT.
  7844             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7845             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7846         16  CZ-CERT-EFF-DT          PIC XX.
  7847         16  CZ-CERT-NO.
  7848             20  CZ-CERT-PRIME       PIC X(10).
  7849             20  CZ-CERT-SFX         PIC X.
  7850         16  CZ-RECORD-TYPE          PIC X.
  7851             88  CERT-NOTE           VALUE '1'.
  7852             88  CLAIM-CERT-NOTE     VALUE '2'.
  7853         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7854
  7855     12  CZ-LAST-MAINT-DT            PIC XX.
  7856     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7857     12  CZ-LAST-MAINT-USER          PIC X(4).
  7858
  7859     12  CZ-NOTE-INFORMATION.
  7860         16  CZ-NOTE                 PIC X(63).
  7861         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 149
* EL156.cbl
  7862******************************************************************
  7863*                            COPY ERCPDEF.
  7864******************************************************************
  7865*                                                                *
  7866*                                                                *
  7867*                            ERCPDEF.                            *
  7868*                                                                *
  7869*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7870*                                                                *
  7871*    FILE TYPE = VSAM,KSDS                                       *
  7872*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7873*                                                                *
  7874*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7875*                                                                *
  7876*    LOG = YES                                                   *
  7877*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7878******************************************************************
  7879 01  PRODUCT-MASTER.
  7880    12  PD-RECORD-ID                 PIC X(02).
  7881        88  VALID-PD-ID                  VALUE 'PD'.
  7882    12  PD-CONTROL-PRIMARY.
  7883        16  PD-COMPANY-CD            PIC X.
  7884        16  PD-STATE                 PIC XX.
  7885        16  PD-PRODUCT-CD            PIC XXX.
  7886        16  PD-FILLER                PIC X(7).
  7887        16  PD-BEN-TYPE              PIC X.
  7888        16  PD-BEN-CODE              PIC XX.
  7889        16  PD-PROD-EXP-DT           PIC XX.
  7890    12  FILLER                       PIC X(50).
  7891    12  PD-PRODUCT-DATA OCCURS 8.
  7892        16  PD-PROD-CODE             PIC X.
  7893            88  PD-PROD-LIFE           VALUE 'L'.
  7894            88  PD-PROD-PROP           VALUE 'P'.
  7895            88  PD-PROD-AH             VALUE 'A'.
  7896            88  PD-PROD-IU             VALUE 'I'.
  7897            88  PD-PROD-GAP            VALUE 'G'.
  7898        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7899        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7900        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7901        16  PD-MAX-TERM              PIC S999        COMP-3.
  7902        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7903        16  FILLER                   PIC X.
  7904        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7905        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7906        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7907        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7908        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7909        16  PD-REC-CRIT-PERIOD       PIC X.
  7910        16  PD-RTW-MOS               PIC 99.
  7911        16  FILLER                   PIC X(5).
  7912    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7913    12  PD-TERM-LIMITS OCCURS 15.
  7914        16  PD-LOW-TERM              PIC S999        COMP-3.
  7915        16  PD-HI-TERM               PIC S999        COMP-3.
  7916*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7917    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7918        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7919        16  PD-HI-AMT                PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 150
* EL156.cbl
  7920    12  PD-EARN-FACTORS.
  7921        16  FILLER OCCURS 15.
  7922            20  FILLER OCCURS 15.
  7923                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7924    12  PD-PRODUCT-DESC              PIC X(80).
  7925    12  PD-TRUNCATED                 PIC X.
  7926    12  FILLER                       PIC X(59).
  7927    12  PD-MAINT-INFORMATION.
  7928        16  PD-LAST-MAINT-DT         PIC X(02).
  7929        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7930        16  PD-LAST-MAINT-BY         PIC X(04).
  7931*                            COPY ELCCRTT.
  7932******************************************************************
  7933*                                                                *
  7934*                            ELCCRTT.                            *
  7935*                                                                *
  7936*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7937*                                                                *
  7938*   FILE TYPE = VSAM,KSDS                                        *
  7939*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7940*                                                                *
  7941*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7942*                                                                *
  7943*   LOG = YES                                                    *
  7944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7945******************************************************************
  7946*                   C H A N G E   L O G
  7947*
  7948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7949*-----------------------------------------------------------------
  7950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7951* EFFECTIVE    NUMBER
  7952*-----------------------------------------------------------------
  7953* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7954* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7955* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7956* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7957* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7958******************************************************************
  7959
  7960 01  CERTIFICATE-TRAILERS.
  7961     12  CS-RECORD-ID                      PIC XX.
  7962         88  VALID-CS-ID                      VALUE 'CS'.
  7963
  7964     12  CS-CONTROL-PRIMARY.
  7965         16  CS-COMPANY-CD                 PIC X.
  7966         16  CS-CARRIER                    PIC X.
  7967         16  CS-GROUPING                   PIC X(6).
  7968         16  CS-STATE                      PIC XX.
  7969         16  CS-ACCOUNT                    PIC X(10).
  7970         16  CS-CERT-EFF-DT                PIC XX.
  7971         16  CS-CERT-NO.
  7972             20  CS-CERT-PRIME             PIC X(10).
  7973             20  CS-CERT-SFX               PIC X.
  7974         16  CS-TRAILER-TYPE               PIC X.
  7975             88  COMM-TRLR           VALUE 'A'.
  7976             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7977             88  CERT-DATA-TRLR      VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 151
* EL156.cbl
  7978
  7979     12  CS-DATA-AREA                      PIC X(516).
  7980
  7981     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7982         16  CS-BANK-COMMISSION-AREA.
  7983             20  CS-BANK-COMMS       OCCURS 10.
  7984                 24  CS-AGT                PIC X(10).
  7985                 24  CS-COM-TYP            PIC X.
  7986                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7987                 24  CS-RECALC-LV-INDIC    PIC X.
  7988                 24  FILLER                PIC X(10).
  7989         16  FILLER                        PIC X(256).
  7990
  7991     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7992****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7993****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7994         16  CS-MB-CLAIM-DATA OCCURS 2.
  7995             20  FILLER OCCURS 10.
  7996                 24  CS-CLAIM-TYPE         PIC X.
  7997                     88  CS-AH-CLM           VALUE 'A'.
  7998                     88  CS-IU-CLM           VALUE 'I'.
  7999                     88  CS-GP-CLM           VALUE 'G'.
  8000                     88  CS-LF-CLM           VALUE 'L'.
  8001                     88  CS-PR-CLM           VALUE 'P'.
  8002                 24  CS-BANK               PIC S999 COMP-3.
  8003                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  8004                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  8005                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  8006         16  FILLER                        PIC X(216).
  8007     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8008         16  CS-VIN-NUMBER                 PIC X(17).
  8009         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8010         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8011         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8012         16  FILLER                        PIC X(496).
  8013******************************************************************
  8014 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8015                          CONTROL-FILE CERTIFICATE-MASTER
  8016                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8017                          ACCOUNT-MASTER CHECK-QUE
  8018                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8019                          DAILY-ACTIVITY-RECORD
  8020                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8021                          CERT-NOTE-FILE PRODUCT-MASTER
  8022                          CERTIFICATE-TRAILERS.
  8023 0000-DFHEXIT SECTION.
  8024     MOVE '9#                    $   ' TO DFHEIV0.
  8025     MOVE 'EL156' TO DFHEIV1.
  8026     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8027
  8028     IF EIBCALEN = 0
  8029         GO TO 8800-UNAUTHORIZED-ACCESS.
  8030
  8031     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8032     MOVE EIBTRMID               TO QID-TERM.
  8033     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8034     MOVE '2'                    TO EMI-SWITCH2.
  8035     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 152
* EL156.cbl
  8036     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8037
  8038     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8039     MOVE '5'                    TO DC-OPTION-CODE.
  8040     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8041     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8042                                    SAVE-BIN-DATE.
  8043     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8044     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8045
  8046     IF SAVE-DATE-YY > 70
  8047         MOVE 19                 TO SAVE-DATE-CC
  8048     ELSE
  8049         MOVE 20                 TO SAVE-DATE-CC.
  8050
  8051     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8052         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8053     END-IF.
  8054
  8055     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8056        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8057     ELSE
  8058        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8059     END-IF
  8060
  8061     IF PI-PRINT-CLM-FRM-YN = 'N'
  8062         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8063     ELSE
  8064         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8065     END-IF
  8066
  8067     IF PI-PRINT-SURVEY-YN = 'N'
  8068         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8069     ELSE
  8070         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8071     END-IF
  8072
  8073     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8074         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8075     ELSE
  8076         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8077     END-IF
  8078
  8079* EXEC CICS HANDLE CONDITION
  8080*        NOTOPEN   (9990-ABEND)
  8081*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8082*        MAPFAIL   (0400-FIRST-TIME)
  8083*        DUPREC    (6180-DUPREC)
  8084*        ERROR     (9990-ABEND)
  8085*    END-EXEC.
  8086*    MOVE '"$JL?%.               ! " #00008074' TO DFHEIV0
  8087     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8089     MOVE X'2220233030303038303734' TO DFHEIV0(25:11)
  8090     CALL 'kxdfhei1' USING DFHEIV0
  8091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8092
  8093
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 153
* EL156.cbl
  8094     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8095         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8096
  8097     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8098         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8099             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8100             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8101             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8102             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8103             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8104             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8105             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8106             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8107             MOVE LOW-VALUES           TO EL156AI
  8108             MOVE 'Y'                  TO FIRST-ENTRY
  8109         ELSE
  8110             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8111             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8112             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8113             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8114             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8115             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8116             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8117             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8118
  8119     IF RETURNED-FROM NOT = SPACES
  8120        IF (RETURNED-FROM = 'EL614')
  8121           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8122           IF WS-SAVED-EOB-CODES NOT = SPACES
  8123              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8124           ELSE
  8125              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8126           END-IF
  8127        END-IF
  8128         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8129            MOVE 'Y'             TO FIRST-ENTRY
  8130            IF RETURNED-FROM = 'EL614'
  8131               AND (PI-PASS-SW NOT = 'C')
  8132               IF WS-SAVED-EOB-CODES NOT = SPACES
  8133                  MOVE WS-SAVED-EOB-CODES
  8134                                 TO PI-PMTNOTE2
  8135                                    WS-PMTNOTE2
  8136                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8137               ELSE
  8138                  MOVE SPACES    TO PI-PMTNOTE2
  8139                                    WS-PMTNOTE2
  8140                                    PI-EOB-CODES-EXIST
  8141               END-IF
  8142            END-IF
  8143            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8144            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8145            IF RETURNED-FROM = 'EL614'
  8146               GO TO 1000-EDIT-DATA
  8147            END-IF
  8148            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8149               (PAYEEI   = LOW-VALUES OR SPACES)
  8150               GO TO 8100-SEND-INITIAL-MAP
  8151            ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 154
* EL156.cbl
  8152               GO TO 1000-EDIT-DATA.
  8153
  8154     IF EIBTRNID NOT = TRANS-ID
  8155         GO TO 0400-FIRST-TIME.
  8156
  8157     IF EIBAID = DFHCLEAR
  8158        IF PI-PASS-SW = 'C'
  8159           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8160           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8161           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8162           MOVE 'Y'            TO RETURNED-FROM-B
  8163           GO TO 1000-EDIT-DATA
  8164        ELSE
  8165           GO TO 9400-CLEAR.
  8166
  8167     IF PI-PASS-SW = 'C'
  8168         MOVE MAP-NAMEB          TO MAP-NAME
  8169         IF EIBAID = DFHPF1 OR DFHPF13
  8170             GO TO 5000-UPDATE
  8171           ELSE
  8172             IF EIBAID NOT = DFHENTER
  8173                 MOVE LOW-VALUES TO EL156BI
  8174                 MOVE MAP-NAMEB  TO MAP-NAME
  8175                 MOVE ER-0029    TO EMI-ERROR
  8176                 MOVE -1         TO  ENTPFBL
  8177                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8178                 GO TO 8200-SEND-DATAONLY.
  8179
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 155
* EL156.cbl
  8181 0200-RECEIVE.
  8182     MOVE LOW-VALUES             TO EL156AI.
  8183     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8184         MOVE ER-0008            TO EMI-ERROR
  8185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8186         IF PI-PASS-SW = 'C'
  8187             MOVE -1             TO ENTPFBL
  8188             GO TO 8200-SEND-DATAONLY
  8189         ELSE
  8190             MOVE -1             TO PMTTYPEL
  8191             GO TO 8200-SEND-DATAONLY.
  8192
  8193     IF PI-COMPANY-ID = 'DMD'
  8194         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8195
  8196     IF PI-PASS-SW = 'C'
  8197         MOVE MAP-NAMEB          TO MAP-NAME.
  8198
  8199
  8200* EXEC CICS RECEIVE
  8201*        MAP   (MAP-NAME)
  8202*        MAPSET(MAPSET-NAME)
  8203*        ASIS
  8204*        INTO  (EL156AI)
  8205*    END-EXEC.
  8206     MOVE LENGTH OF
  8207      EL156AI
  8208       TO DFHEIV11
  8209*    MOVE '8"TAI  L              ''   #00008187' TO DFHEIV0
  8210     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8211     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8212     MOVE X'2020233030303038313837' TO DFHEIV0(25:11)
  8213     CALL 'kxdfhei1' USING DFHEIV0,
  8214           MAP-NAME,
  8215           EL156AI,
  8216           DFHEIV11,
  8217           MAPSET-NAME,
  8218           DFHEIV99,
  8219           DFHEIV99
  8220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8221
  8222
  8223     IF PI-PASS-SW NOT = 'C'
  8224         GO TO 0250-MAPA.
  8225
  8226     IF ENTPFBL NOT > ZERO
  8227         MOVE MAP-NAMEB          TO MAP-NAME
  8228         MOVE ER-0029            TO EMI-ERROR
  8229         MOVE -1                 TO  ENTPFBL
  8230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8231         GO TO 8200-SEND-DATAONLY.
  8232
  8233     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8234         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8235       ELSE
  8236         MOVE MAP-NAMEB           TO MAP-NAME
  8237         MOVE ER-0029             TO EMI-ERROR
  8238         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 156
* EL156.cbl
  8239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8240         GO TO 8200-SEND-DATAONLY.
  8241
  8242     IF EIBAID = DFHPF1 OR DFHPF13
  8243         IF MODIFY-CAP
  8244            GO TO 5000-UPDATE
  8245          ELSE
  8246            MOVE 'UPDATE'           TO SM-READ
  8247            PERFORM 9995-SECURITY-VIOLATION
  8248            MOVE MAP-NAMEB          TO MAP-NAME
  8249            MOVE ER-0070            TO EMI-ERROR
  8250            MOVE -1                 TO  ENTPFBL
  8251            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8252            GO TO 8200-SEND-DATAONLY.
  8253
  8254 0250-MAPA.
  8255     IF ENTERPFL = 0
  8256         GO TO 0300-CHECK-PFKEYS.
  8257
  8258     IF EIBAID NOT = DFHENTER
  8259         MOVE ER-0004            TO EMI-ERROR
  8260         GO TO 0320-INPUT-ERROR.
  8261
  8262     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8263         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8264     ELSE
  8265         MOVE ER-0029            TO EMI-ERROR
  8266         GO TO 0320-INPUT-ERROR.
  8267
  8268 0300-CHECK-PFKEYS.
  8269     IF EIBAID = DFHPF7 OR DFHPF8
  8270         GO TO 8820-PF7-8.
  8271
  8272     IF EIBAID = DFHPF23
  8273         GO TO 8810-PF23.
  8274
  8275     IF EIBAID = DFHPF24
  8276         GO TO 9200-RETURN-MAIN-MENU.
  8277
  8278     IF EIBAID = DFHPF12
  8279         GO TO 9500-PF12.
  8280
  8281     IF EIBAID = DFHPF1
  8282        IF PI-PASS-SW = 'A' OR 'B'
  8283          GO TO 0330-BROWSE-FORWARD.
  8284
  8285     IF EIBAID = DFHPF2
  8286        IF PI-PASS-SW = 'A' OR 'B'
  8287          GO TO 0350-BROWSE-BACKWARD.
  8288
  8289     IF EIBAID = DFHPF6
  8290        IF PI-EOB-CODES-EXIST = 'Y'
  8291           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8292        ELSE
  8293           MOVE SPACES              TO WS-PMTNOTE2
  8294        END-IF
  8295         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8296         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 157
* EL156.cbl
  8297            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8298         END-IF
  8299         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8300         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8301             MOVE 'EL614'        TO PGM-NAME
  8302             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8303             GO TO 9300-XCTL
  8304         ELSE
  8305             MOVE XCTL-157       TO PGM-NAME
  8306             GO TO 9300-XCTL.
  8307
  8308     IF EIBAID = DFHPF9
  8309        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8310        MOVE XCTL-141            TO PGM-NAME
  8311        GO TO 9300-XCTL.
  8312
  8313     IF EIBAID = DFHPF10
  8314        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8315        MOVE XCTL-155            TO PGM-NAME
  8316        GO TO 9300-XCTL.
  8317
  8318     MOVE SPACES                 TO ERRMSG0O
  8319                                    ERRMSG1O
  8320                                    ERRMSG2O.
  8321
  8322     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8323         IF PI-PASS-SW NOT = 'B'
  8324             MOVE ER-0422        TO EMI-ERROR
  8325             GO TO 0320-INPUT-ERROR
  8326           ELSE
  8327             GO TO 0700-TEST-FOR-CHANGES.
  8328
  8329     IF EIBAID = DFHPF11
  8330        IF PI-PASS-SW = 'C'
  8331           MOVE ER-0029          TO EMI-ERROR
  8332           GO TO 0320-INPUT-ERROR.
  8333
  8334     IF EIBAID = DFHENTER OR DFHPF11
  8335        NEXT SENTENCE
  8336     ELSE
  8337        MOVE ER-0029             TO EMI-ERROR
  8338        GO TO 0320-INPUT-ERROR.
  8339
  8340     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8341
  8342     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8343         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8344         GO TO 1000-EDIT-DATA
  8345     ELSE
  8346         IF PI-FATAL-COUNT NOT = 0 OR
  8347            PI-FORCE-COUNT NOT = 0
  8348             GO TO 1000-EDIT-DATA
  8349         ELSE
  8350             GO TO 2000-EDIT-DONE.
  8351
  8352 0320-INPUT-ERROR.
  8353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8354
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 158
* EL156.cbl
  8355     IF ENTERPFL = 0
  8356         MOVE -1                 TO PMTTYPEL
  8357     ELSE
  8358         MOVE AL-UNBON           TO ENTERPFA
  8359         MOVE -1                 TO ENTERPFL.
  8360
  8361     GO TO 8200-SEND-DATAONLY.
  8362
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 159
* EL156.cbl
  8364 0330-BROWSE-FORWARD.
  8365
  8366     MOVE CLMNOI            TO PI-CLAIM-NO.
  8367     MOVE CARRI             TO PI-CARRIER.
  8368     MOVE CERTNOI           TO PI-CERT-PRIME.
  8369     MOVE SUFXI             TO PI-CERT-SFX.
  8370
  8371     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8372     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8373     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8374     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8375
  8376     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8377
  8378
  8379* EXEC CICS HANDLE CONDITION
  8380*         NOTFND   (0380-CLAIM-END-FILE)
  8381*         ENDFILE  (0380-CLAIM-END-FILE)
  8382*    END-EXEC.
  8383*    MOVE '"$I''                  ! # #00008349' TO DFHEIV0
  8384     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8386     MOVE X'2320233030303038333439' TO DFHEIV0(25:11)
  8387     CALL 'kxdfhei1' USING DFHEIV0
  8388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8389
  8390
  8391
  8392* EXEC CICS STARTBR
  8393*         DATASET    ('ELMSTR')
  8394*         RIDFLD     (ELMSTR-KEY)
  8395*         GTEQ
  8396*    END-EXEC.
  8397     MOVE 'ELMSTR' TO DFHEIV1
  8398     MOVE 0
  8399       TO DFHEIV11
  8400*    MOVE '&,         G          &   #00008354' TO DFHEIV0
  8401     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8402     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8403     MOVE X'2020233030303038333534' TO DFHEIV0(25:11)
  8404     CALL 'kxdfhei1' USING DFHEIV0,
  8405           DFHEIV1,
  8406           ELMSTR-KEY,
  8407           DFHEIV99,
  8408           DFHEIV11,
  8409           DFHEIV99
  8410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8411
  8412
  8413     MOVE 'Y' TO WS-BROWSE-START-SW.
  8414
  8415 0335-READNEXT.
  8416
  8417
  8418* EXEC CICS READNEXT
  8419*         DATASET    ('ELMSTR')
  8420*         RIDFLD     (ELMSTR-KEY)
  8421*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 160
* EL156.cbl
  8422*    END-EXEC.
  8423     MOVE 'ELMSTR' TO DFHEIV1
  8424     MOVE 0
  8425       TO DFHEIV11
  8426*    MOVE '&.S                   )   #00008364' TO DFHEIV0
  8427     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8428     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8429     MOVE X'2020233030303038333634' TO DFHEIV0(25:11)
  8430     CALL 'kxdfhei1' USING DFHEIV0,
  8431           DFHEIV1,
  8432           DFHEIV20,
  8433           DFHEIV99,
  8434           ELMSTR-KEY,
  8435           DFHEIV99,
  8436           DFHEIV11,
  8437           DFHEIV99,
  8438           DFHEIV99
  8439     SET ADDRESS OF CLAIM-MASTER TO
  8440         DFHEIV20
  8441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8442
  8443
  8444     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8445        GO TO 0380-CLAIM-END-FILE.
  8446
  8447     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8448        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8449        GO TO 0335-READNEXT.
  8450
  8451     IF PI-COMPANY-ID = 'CRI'
  8452         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8453            GO TO 0380-CLAIM-END-FILE.
  8454
  8455     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8456         GO TO 0335-READNEXT.
  8457
  8458     IF PI-CARRIER-SECURITY > SPACES
  8459         IF CL-CARRIER = PI-CARRIER-SECURITY
  8460             NEXT SENTENCE
  8461         ELSE
  8462             GO TO 0335-READNEXT.
  8463
  8464     IF PI-ACCOUNT-SECURITY > SPACES
  8465         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8466             NEXT SENTENCE
  8467         ELSE
  8468             GO TO 0335-READNEXT.
  8469
  8470     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8471     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8472     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8473
  8474     GO TO 0400-FIRST-TIME.
  8475
  8476 0350-BROWSE-BACKWARD.
  8477
  8478     MOVE CLMNOI            TO PI-CLAIM-NO
  8479                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 161
* EL156.cbl
  8480     MOVE CARRI             TO PI-CARRIER.
  8481     MOVE CERTNOI           TO PI-CERT-PRIME.
  8482     MOVE SUFXI             TO PI-CERT-SFX.
  8483
  8484     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8485
  8486     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8487     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8488     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8489
  8490
  8491* EXEC CICS HANDLE CONDITION
  8492*         NOTFND   (0380-CLAIM-END-FILE)
  8493*         ENDFILE  (0380-CLAIM-END-FILE)
  8494*    END-EXEC.
  8495*    MOVE '"$I''                  ! $ #00008416' TO DFHEIV0
  8496     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8498     MOVE X'2420233030303038343136' TO DFHEIV0(25:11)
  8499     CALL 'kxdfhei1' USING DFHEIV0
  8500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8501
  8502
  8503
  8504* EXEC CICS STARTBR
  8505*         DATASET    ('ELMSTR')
  8506*         RIDFLD     (ELMSTR-KEY)
  8507*         GTEQ
  8508*    END-EXEC.
  8509     MOVE 'ELMSTR' TO DFHEIV1
  8510     MOVE 0
  8511       TO DFHEIV11
  8512*    MOVE '&,         G          &   #00008421' TO DFHEIV0
  8513     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8515     MOVE X'2020233030303038343231' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0,
  8517           DFHEIV1,
  8518           ELMSTR-KEY,
  8519           DFHEIV99,
  8520           DFHEIV11,
  8521           DFHEIV99
  8522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8523
  8524
  8525     MOVE 'Y' TO WS-BROWSE-START-SW.
  8526
  8527
  8528* EXEC CICS READNEXT
  8529*         DATASET    ('ELMSTR')
  8530*         RIDFLD     (ELMSTR-KEY)
  8531*         SET        (ADDRESS OF CLAIM-MASTER)
  8532*    END-EXEC.
  8533     MOVE 'ELMSTR' TO DFHEIV1
  8534     MOVE 0
  8535       TO DFHEIV11
  8536*    MOVE '&.S                   )   #00008429' TO DFHEIV0
  8537     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 162
* EL156.cbl
  8538     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8539     MOVE X'2020233030303038343239' TO DFHEIV0(25:11)
  8540     CALL 'kxdfhei1' USING DFHEIV0,
  8541           DFHEIV1,
  8542           DFHEIV20,
  8543           DFHEIV99,
  8544           ELMSTR-KEY,
  8545           DFHEIV99,
  8546           DFHEIV11,
  8547           DFHEIV99,
  8548           DFHEIV99
  8549     SET ADDRESS OF CLAIM-MASTER TO
  8550         DFHEIV20
  8551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8552
  8553
  8554
  8555* EXEC CICS READPREV
  8556*         DATASET    ('ELMSTR')
  8557*         RIDFLD     (ELMSTR-KEY)
  8558*         SET        (ADDRESS OF CLAIM-MASTER)
  8559*    END-EXEC.
  8560     MOVE 'ELMSTR' TO DFHEIV1
  8561     MOVE 0
  8562       TO DFHEIV11
  8563*    MOVE '&0S                   )   #00008435' TO DFHEIV0
  8564     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8565     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8566     MOVE X'2020233030303038343335' TO DFHEIV0(25:11)
  8567     CALL 'kxdfhei1' USING DFHEIV0,
  8568           DFHEIV1,
  8569           DFHEIV20,
  8570           DFHEIV99,
  8571           ELMSTR-KEY,
  8572           DFHEIV99,
  8573           DFHEIV11,
  8574           DFHEIV99,
  8575           DFHEIV99
  8576     SET ADDRESS OF CLAIM-MASTER TO
  8577         DFHEIV20
  8578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8579
  8580
  8581 0360-BROWSE-BACKWARD.
  8582
  8583
  8584* EXEC CICS READPREV
  8585*         DATASET    ('ELMSTR')
  8586*         RIDFLD     (ELMSTR-KEY)
  8587*         SET        (ADDRESS OF CLAIM-MASTER)
  8588*    END-EXEC.
  8589     MOVE 'ELMSTR' TO DFHEIV1
  8590     MOVE 0
  8591       TO DFHEIV11
  8592*    MOVE '&0S                   )   #00008443' TO DFHEIV0
  8593     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8594     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8595     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 163
* EL156.cbl
  8596     CALL 'kxdfhei1' USING DFHEIV0,
  8597           DFHEIV1,
  8598           DFHEIV20,
  8599           DFHEIV99,
  8600           ELMSTR-KEY,
  8601           DFHEIV99,
  8602           DFHEIV11,
  8603           DFHEIV99,
  8604           DFHEIV99
  8605     SET ADDRESS OF CLAIM-MASTER TO
  8606         DFHEIV20
  8607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8608
  8609
  8610     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8611        GO TO 0380-CLAIM-END-FILE.
  8612
  8613     IF PI-COMPANY-ID = 'CRI'
  8614         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8615            GO TO 0380-CLAIM-END-FILE.
  8616
  8617     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8618         GO TO 0360-BROWSE-BACKWARD.
  8619
  8620     IF PI-CARRIER-SECURITY > SPACES
  8621         IF CL-CARRIER = PI-CARRIER-SECURITY
  8622             NEXT SENTENCE
  8623         ELSE
  8624             GO TO 0360-BROWSE-BACKWARD.
  8625
  8626     IF PI-ACCOUNT-SECURITY > SPACES
  8627         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8628             NEXT SENTENCE
  8629         ELSE
  8630             GO TO 0360-BROWSE-BACKWARD.
  8631
  8632     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8633     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8634     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8635
  8636     GO TO 0400-FIRST-TIME.
  8637
  8638 0380-CLAIM-END-FILE.
  8639
  8640     MOVE ER-0130     TO EMI-ERROR.
  8641     MOVE -1          TO CLMNOL.
  8642     MOVE AL-UABON    TO CARRA
  8643                         CLMNOA
  8644                         CERTNOA
  8645                         SUFXA.
  8646
  8647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8648
  8649     GO TO 8200-SEND-DATAONLY.
  8650
  8651 0400-FIRST-TIME.
  8652
  8653     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 164
* EL156.cbl
  8654        MOVE 'N'         TO WS-BROWSE-START-SW
  8655
  8656* EXEC CICS ENDBR
  8657*            DATASET    ('ELMSTR')
  8658*       END-EXEC.
  8659     MOVE 'ELMSTR' TO DFHEIV1
  8660     MOVE 0
  8661       TO DFHEIV11
  8662*    MOVE '&2                    $   #00008494' TO DFHEIV0
  8663     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303038343934' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           DFHEIV1,
  8668           DFHEIV11,
  8669           DFHEIV99
  8670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8671
  8672
  8673     IF PI-PROCESSOR-ID = 'LGXX'
  8674         NEXT SENTENCE
  8675     ELSE
  8676
  8677* EXEC CICS READQ TS
  8678*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8679*            INTO    (SECURITY-CONTROL)
  8680*            LENGTH  (SC-COMM-LENGTH)
  8681*            ITEM    (SC-ITEM)
  8682*        END-EXEC
  8683*    MOVE '*$II   L              ''   #00008501' TO DFHEIV0
  8684     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8685     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8686     MOVE X'2020233030303038353031' TO DFHEIV0(25:11)
  8687     CALL 'kxdfhei1' USING DFHEIV0,
  8688           PI-SECURITY-TEMP-STORE-ID,
  8689           SECURITY-CONTROL,
  8690           SC-COMM-LENGTH,
  8691           SC-ITEM,
  8692           DFHEIV99,
  8693           DFHEIV99
  8694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8695         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8696         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8697
  8698     MOVE LOW-VALUES             TO EL156AI.
  8699     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8700     MOVE 'Y'                    TO FIRST-ENTRY.
  8701     GO TO 7000-SHOW-CLAIM.
  8702
  8703 0500-CREATE-TEMP-STORAGE.
  8704     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8705
  8706
  8707* EXEC CICS WRITEQ TS
  8708*        QUEUE (QID)
  8709*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8710*        LENGTH(PI-COMM-LENGTH)
  8711*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 165
* EL156.cbl
  8712*    MOVE '*"                    ''   #00008518' TO DFHEIV0
  8713     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8714     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8715     MOVE X'2020233030303038353138' TO DFHEIV0(25:11)
  8716     CALL 'kxdfhei1' USING DFHEIV0,
  8717           QID,
  8718           PROGRAM-INTERFACE-BLOCK,
  8719           PI-COMM-LENGTH,
  8720           DFHEIV99,
  8721           DFHEIV99,
  8722           DFHEIV99
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8724
  8725
  8726
  8727* EXEC CICS WRITEQ TS
  8728*        QUEUE (QID)
  8729*        FROM  (EL156AI)
  8730*        LENGTH(MAP-LENGTH)
  8731*    END-EXEC.
  8732*    MOVE '*"                    ''   #00008524' TO DFHEIV0
  8733     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8734     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8735     MOVE X'2020233030303038353234' TO DFHEIV0(25:11)
  8736     CALL 'kxdfhei1' USING DFHEIV0,
  8737           QID,
  8738           EL156AI,
  8739           MAP-LENGTH,
  8740           DFHEIV99,
  8741           DFHEIV99,
  8742           DFHEIV99
  8743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8744
  8745
  8746 0599-EXIT.
  8747      EXIT.
  8748
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 166
* EL156.cbl
  8750 0600-RECOVER-TEMP-STORAGE.
  8751
  8752* EXEC CICS READQ TS
  8753*        QUEUE (QID)
  8754*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8755*        LENGTH(PI-COMM-LENGTH)
  8756*    END-EXEC.
  8757*    MOVE '*$I    L              ''   #00008535' TO DFHEIV0
  8758     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8760     MOVE X'2020233030303038353335' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0,
  8762           QID,
  8763           PROGRAM-INTERFACE-BLOCK,
  8764           PI-COMM-LENGTH,
  8765           DFHEIV99,
  8766           DFHEIV99,
  8767           DFHEIV99
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771
  8772* EXEC CICS READQ TS
  8773*        QUEUE (QID)
  8774*        INTO  (EL156AI)
  8775*        LENGTH(MAP-LENGTH)
  8776*    END-EXEC.
  8777*    MOVE '*$I    L              ''   #00008541' TO DFHEIV0
  8778     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8780     MOVE X'2020233030303038353431' TO DFHEIV0(25:11)
  8781     CALL 'kxdfhei1' USING DFHEIV0,
  8782           QID,
  8783           EL156AI,
  8784           MAP-LENGTH,
  8785           DFHEIV99,
  8786           DFHEIV99,
  8787           DFHEIV99
  8788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8789
  8790
  8791     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8792
  8793     IF PMTTYPEI NOT = LOW-VALUES
  8794         MOVE AL-UANON           TO PMTTYPEA.
  8795
  8796     IF PAYEEI NOT = LOW-VALUES
  8797         MOVE AL-UANON           TO PAYEEA.
  8798
  8799     IF NOTE1I NOT = LOW-VALUES
  8800         MOVE AL-UANON           TO NOTE1A.
  8801
  8802     IF (RETURNED-FROM = 'EL614')
  8803        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8804     END-IF
  8805*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8806*       AND (PI-EOB-CODES-EXIST = 'Y')
  8807*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 167
* EL156.cbl
  8808*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8809     IF PI-SET-NOTE2-MDT = 'Y'
  8810         MOVE AL-SANON           TO NOTE2A
  8811     END-IF
  8812
  8813     IF OFFLINEI NOT = LOW-VALUES
  8814         MOVE AL-UANON           TO OFFLINEA.
  8815
  8816*    IF GROUPEDI NOT = LOW-VALUES
  8817*        MOVE AL-UANON           TO GROUPEDA.
  8818
  8819*    IF CASHI NOT = LOW-VALUES
  8820*        MOVE AL-UANON           TO CASHA.
  8821
  8822     IF CHECKNOI NOT = LOW-VALUES
  8823         MOVE AL-UANON           TO CHECKNOA.
  8824
  8825     IF HOLDTILI NOT = LOW-VALUES
  8826         MOVE AL-UANON           TO HOLDTILA.
  8827
  8828     IF EPYFROMI NOT = LOW-VALUES
  8829         MOVE AL-UANON           TO EPYFROMA.
  8830
  8831     IF AIGFROMI NOT = LOW-VALUES
  8832         MOVE AL-UANON           TO AIGFROMA.
  8833
  8834     IF EPYTHRUI NOT = LOW-VALUES
  8835         MOVE AL-UANON           TO EPYTHRUA.
  8836
  8837     IF EDAYSI NOT = LOW-VALUES
  8838         MOVE AL-UNNON           TO EDAYSA.
  8839
  8840     IF EPYAMTL NOT = +0
  8841         MOVE AL-UNNON           TO EPYAMTA.
  8842
  8843     IF ERESVL NOT = +0
  8844         MOVE AL-UNNON           TO ERESVA.
  8845
  8846     IF EEXPENSL NOT = +0
  8847         MOVE AL-UNNON           TO EEXPENSA.
  8848
  8849     IF ETYPEI NOT = LOW-VALUES
  8850         MOVE AL-UNNON           TO ETYPEA.
  8851
  8852     IF PROOFDTI NOT = 0
  8853         MOVE AL-UNNON           TO PROOFDTA.
  8854
  8855     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8856        MOVE AL-UANON            TO EOBYNA
  8857     END-IF
  8858     IF CLMFMYNI = 'Y' OR 'N'
  8859        MOVE AL-UANON            TO CLMFMYNA
  8860     END-IF
  8861
  8862     IF SURVYYNI = 'Y' OR 'N'
  8863        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8864           MOVE AL-UANON         TO SURVYYNA
  8865        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 168
* EL156.cbl
  8866     END-IF
  8867
  8868     IF SPRELYNI = 'Y' OR 'N'
  8869        MOVE AL-UANON            TO SPRELYNA
  8870     END-IF
  8871
  8872     .
  8873 0699-EXIT.
  8874      EXIT.
  8875
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 169
* EL156.cbl
  8877 0700-TEST-FOR-CHANGES.
  8878     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8879         MOVE ER-0433            TO EMI-ERROR
  8880         GO TO 0750-FUNCTION-ERROR.
  8881
  8882     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8883
  8884     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8885         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8886         MOVE 'A'                TO PI-PASS-SW
  8887         GO TO 1000-EDIT-DATA.
  8888
  8889     IF PI-FATAL-COUNT NOT = 0
  8890         MOVE ER-0499            TO EMI-ERROR
  8891         GO TO 0750-FUNCTION-ERROR.
  8892
  8893     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8894         MOVE ER-0500            TO EMI-ERROR
  8895         GO TO 0750-FUNCTION-ERROR.
  8896
  8897     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8898        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8899           MOVE ER-0542          TO EMI-ERROR
  8900           MOVE -1               TO EPYAMTL
  8901           GO TO 0750-FUNCTION-ERROR.
  8902
  8903     IF PI-OFFLINE = 'Y'  OR
  8904        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8905        MOVE EIBAID              TO PI-PFKEY-USED
  8906        GO TO 5000-UPDATE.
  8907
  8908     GO TO 6000-BUILD-SCREEN-B.
  8909
  8910 0750-FUNCTION-ERROR.
  8911     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8912
  8913     IF ENTERPFL > 0
  8914         MOVE -1                 TO ENTERPFL
  8915         MOVE AL-UNBON           TO ENTERPFA
  8916         GO TO 8200-SEND-DATAONLY
  8917     ELSE
  8918         MOVE -1                 TO ENTERPFL
  8919         MOVE AL-UNNOF           TO ENTERPFA
  8920         GO TO 8200-SEND-DATAONLY.
  8921
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 170
* EL156.cbl
  8923 0800-DELETE-TS.
  8924
  8925* EXEC CICS HANDLE CONDITION
  8926*        QIDERR(0800-EXIT)
  8927*    END-EXEC.
  8928*    MOVE '"$N                   ! % #00008680' TO DFHEIV0
  8929     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8931     MOVE X'2520233030303038363830' TO DFHEIV0(25:11)
  8932     CALL 'kxdfhei1' USING DFHEIV0
  8933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8934
  8935
  8936
  8937* EXEC CICS DELETEQ TS
  8938*        QUEUE(QID)
  8939*    END-EXEC.
  8940*    MOVE '*&                    #   #00008684' TO DFHEIV0
  8941     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8943     MOVE X'2020233030303038363834' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0,
  8945           QID,
  8946           DFHEIV99
  8947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8948
  8949
  8950 0800-EXIT.
  8951      EXIT.
  8952 0900-GET-DDF-FACTORS.
  8953
  8954     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8955     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8956     MOVE CL-CERT-STATE          TO ERPDEF-STATE
  8957     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8958     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8959     MOVE PI-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8960     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8961
  8962     DISPLAY ' MADE 0900 ' ERPDEF-KEY (2:15)
  8963     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8964
  8965
  8966* EXEC CICS STARTBR
  8967*        DATASET  ('ERPDEF')
  8968*        RIDFLD   (ERPDEF-KEY)
  8969*        GTEQ
  8970*        RESP     (WS-RESPONSE)
  8971*    END-EXEC
  8972     MOVE 'ERPDEF' TO DFHEIV1
  8973     MOVE 0
  8974       TO DFHEIV11
  8975*    MOVE '&,         G          &  N#00008703' TO DFHEIV0
  8976     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8977     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8978     MOVE X'204E233030303038373033' TO DFHEIV0(25:11)
  8979     CALL 'kxdfhei1' USING DFHEIV0,
  8980           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 171
* EL156.cbl
  8981           ERPDEF-KEY,
  8982           DFHEIV99,
  8983           DFHEIV11,
  8984           DFHEIV99
  8985     MOVE EIBRESP  TO WS-RESPONSE
  8986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8987
  8988     IF NOT WS-RESP-NORMAL
  8989        GO TO 0900-EXIT
  8990     END-IF
  8991
  8992     .
  8993 0900-READNEXT.
  8994
  8995
  8996* EXEC CICS READNEXT
  8997*       DATASET  ('ERPDEF')
  8998*       SET      (ADDRESS OF PRODUCT-MASTER)
  8999*       RIDFLD   (ERPDEF-KEY)
  9000*       RESP     (WS-RESPONSE)
  9001*    END-EXEC
  9002     MOVE 'ERPDEF' TO DFHEIV1
  9003     MOVE 0
  9004       TO DFHEIV11
  9005*    MOVE '&.S                   )  N#00008717' TO DFHEIV0
  9006     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9007     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9008     MOVE X'204E233030303038373137' TO DFHEIV0(25:11)
  9009     CALL 'kxdfhei1' USING DFHEIV0,
  9010           DFHEIV1,
  9011           DFHEIV20,
  9012           DFHEIV99,
  9013           ERPDEF-KEY,
  9014           DFHEIV99,
  9015           DFHEIV11,
  9016           DFHEIV99,
  9017           DFHEIV99
  9018     SET ADDRESS OF PRODUCT-MASTER TO
  9019         DFHEIV20
  9020     MOVE EIBRESP  TO WS-RESPONSE
  9021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9022
  9023     IF NOT WS-RESP-NORMAL
  9024        GO TO 0900-ENDBR
  9025     END-IF
  9026
  9027     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9028        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9029           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9030        ELSE
  9031           GO TO 0900-READNEXT
  9032        END-IF
  9033     ELSE
  9034        GO TO 0900-ENDBR
  9035     END-IF
  9036
  9037     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9038        (P1 > +8)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 172
* EL156.cbl
  9039        OR (PD-PROD-CODE (P1) = 'I')
  9040     END-PERFORM
  9041     IF P1 < +9
  9042        SET DD-IU-PRESENT        TO TRUE
  9043     END-IF
  9044
  9045     IF CM-LOAN-TERM = ZEROS
  9046        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9047     END-IF
  9048
  9049     .
  9050 0900-ENDBR.
  9051
  9052
  9053* EXEC CICS ENDBR
  9054*       DATASET  ('ERPDEF')
  9055*    END-EXEC
  9056     MOVE 'ERPDEF' TO DFHEIV1
  9057     MOVE 0
  9058       TO DFHEIV11
  9059*    MOVE '&2                    $   #00008753' TO DFHEIV0
  9060     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9061     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9062     MOVE X'2020233030303038373533' TO DFHEIV0(25:11)
  9063     CALL 'kxdfhei1' USING DFHEIV0,
  9064           DFHEIV1,
  9065           DFHEIV11,
  9066           DFHEIV99
  9067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9068
  9069     .
  9070 0900-EXIT.
  9071     EXIT.
  9072 1000-EDIT-DATA.
  9073
  9074     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9075         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9076         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9077
  9078     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9079
  9080     IF NOT MODIFY-CAP
  9081         MOVE ER-0070            TO EMI-ERROR
  9082         MOVE -1                 TO PMTTYPEL
  9083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9084         GO TO 2000-EDIT-DONE.
  9085
  9086     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9087                         '5' AND '6'
  9088         MOVE ER-0420            TO EMI-ERROR
  9089         MOVE -1                 TO PMTTYPEL
  9090         MOVE AL-UABON           TO PMTTYPEA
  9091         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9092     ELSE
  9093         MOVE AL-UANON           TO PMTTYPEA.
  9094
  9095*    IF PI-OFFLINE = 'Y'
  9096*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 173
* EL156.cbl
  9097*          MOVE ER-1880         TO EMI-ERROR
  9098*          MOVE -1              TO GROUPEDL
  9099*          MOVE AL-UABON        TO GROUPEDA
  9100*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9101*
  9102*    IF GROUPEDL > +0
  9103*       IF PI-GROUPED = 'Y' OR 'N'
  9104*          MOVE AL-UANON TO GROUPEDA
  9105*       ELSE
  9106*          MOVE ER-3140            TO EMI-ERROR
  9107*          MOVE -1                 TO GROUPEDL
  9108*          MOVE AL-UABON           TO GROUPEDA
  9109*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9110*
  9111*    IF CASHL > +0
  9112*       IF PI-CASH = 'Y' OR 'N'
  9113*          MOVE AL-UANON           TO CASHA
  9114*       ELSE
  9115*          MOVE ER-3141            TO EMI-ERROR
  9116*          MOVE -1                 TO CASHL
  9117*          MOVE AL-UABON           TO CASHA
  9118*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9119
  9120     IF LOANNOL > +0
  9121         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9122
  9123 1000-EDIT-PAYEE.
  9124
  9125     IF PI-PAYEE-SEQ NOT NUMERIC
  9126         MOVE ER-0294            TO  EMI-ERROR
  9127         MOVE -1                 TO  PAYEEL
  9128         MOVE AL-UABON           TO  PAYEEA
  9129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9130         GO TO 1000-CONT-EDIT.
  9131
  9132     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9133                         'E' OR 'O' OR 'Q'
  9134         NEXT SENTENCE
  9135     ELSE
  9136         MOVE ER-0294            TO  EMI-ERROR
  9137         MOVE -1                 TO  PAYEEL
  9138         MOVE AL-UABON           TO  PAYEEA
  9139         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9140         GO TO 1000-CONT-EDIT.
  9141
  9142     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9143        (PI-PAYEE-SEQ NOT < '1' AND
  9144         PI-PAYEE-SEQ NOT > '9'))
  9145      OR
  9146        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9147         (PI-PAYEE-SEQ NOT > '9'))
  9148         MOVE AL-UANON            TO PAYEEA
  9149     ELSE
  9150         MOVE ER-0294            TO EMI-ERROR
  9151         MOVE -1                 TO PAYEEL
  9152         MOVE AL-UABON           TO PAYEEA
  9153         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9154
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 174
* EL156.cbl
  9155     IF PI-COMPANY-ID = 'DMD'
  9156         IF PI-PAYEE-TYPE = 'B' AND
  9157            PI-PAYEE-SEQ NOT = '0'
  9158               MOVE ER-7841            TO EMI-ERROR
  9159               MOVE -1                 TO PAYEEL
  9160               MOVE AL-UABON           TO PAYEEA
  9161               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9162
  9163     IF PI-COMPANY-ID = 'JHL'
  9164         IF PI-PAYEE = 'B0'
  9165             NEXT SENTENCE
  9166           ELSE
  9167
  9168* EXEC CICS HANDLE CONDITION
  9169*            ENDFILE(1950-NOT-FOUND)
  9170*            NOTFND (1950-NOT-FOUND)
  9171*        END-EXEC
  9172*    MOVE '"$''I                  ! & #00008855' TO DFHEIV0
  9173     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9175     MOVE X'2620233030303038383535' TO DFHEIV0(25:11)
  9176     CALL 'kxdfhei1' USING DFHEIV0
  9177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9178         MOVE 'N'                    TO FOUND-TOL-SW
  9179         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9180         MOVE '2'                    TO CNTL-REC-TYPE
  9181         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9182         MOVE +0                     TO CNTL-SEQ-NO
  9183         MOVE 'PROC'                 TO FILE-SWITCH
  9184         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9185         IF PI-PAYEE = 'I1' AND
  9186            APPROVAL-LEVEL-2
  9187             NEXT SENTENCE
  9188           ELSE
  9189         IF NOT PI-USER-ALMIGHTY-YES
  9190             MOVE ER-3546        TO EMI-ERROR
  9191             MOVE -1             TO PAYEEL
  9192             MOVE AL-UABON       TO PAYEEA
  9193             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9194
  9195     IF PI-PAYEE-TYPE = 'E'
  9196        IF PI-PMTTYPE = '5' OR '6'
  9197            NEXT SENTENCE
  9198        ELSE
  9199            MOVE ER-3539            TO EMI-ERROR
  9200            MOVE -1                 TO PAYEEL
  9201            MOVE AL-UABON           TO PAYEEA
  9202            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9203
  9204 1000-CONT-EDIT.
  9205
  9206     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9207        IF PI-EPYAMT NOT NEGATIVE
  9208            MOVE ER-0421         TO EMI-ERROR
  9209            MOVE -1              TO OFFLINEL
  9210            MOVE AL-UABON        TO OFFLINEA
  9211            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9212        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 175
* EL156.cbl
  9213            MOVE AL-UANON        TO OFFLINEA.
  9214
  9215     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9216        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9217           CONTINUE
  9218        ELSE
  9219        IF PI-PRINT-EOB-YN = 'S' AND
  9220           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9221             CONTINUE
  9222        ELSE
  9223           MOVE ER-1561          TO EMI-ERROR
  9224           MOVE -1               TO EOBYNL
  9225           MOVE AL-UABON         TO EOBYNA
  9226           PERFORM 9900-ERROR-FORMAT
  9227                                 THRU 9900-EXIT
  9228        END-IF
  9229        END-IF
  9230
  9231        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9232            MOVE ER-1566        TO EMI-ERROR
  9233            MOVE -1             TO CLMFMYNL
  9234            MOVE AL-UABON       TO CLMFMYNA
  9235            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9236        END-IF
  9237
  9238        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9239            MOVE ER-1567        TO EMI-ERROR
  9240            MOVE -1             TO SURVYYNL
  9241            MOVE AL-UABON       TO SURVYYNA
  9242            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9243        END-IF
  9244
  9245        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9246            MOVE ER-1569        TO EMI-ERROR
  9247            MOVE -1             TO SPRELYNL
  9248            MOVE AL-UABON       TO SPRELYNA
  9249            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9250        END-IF
  9251
  9252     END-IF
  9253     IF PI-EPYAMT IS NEGATIVE
  9254         IF PI-OFFLINE NOT = 'Y'
  9255             MOVE ER-0836        TO  EMI-ERROR
  9256             MOVE -1             TO  OFFLINEL
  9257             MOVE AL-UABON       TO  OFFLINEA
  9258             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9259
  9260     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9261        MOVE ER-0872             TO EMI-ERROR
  9262        MOVE -1                  TO PROOFDTL
  9263        MOVE AL-UABON            TO PROOFDTA
  9264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9265     ELSE
  9266        MOVE '4'                TO DC-OPTION-CODE
  9267        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9268        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9269        IF DATE-CONVERSION-ERROR
  9270            MOVE ER-0873        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 176
* EL156.cbl
  9271            MOVE -1                  TO PROOFDTL
  9272            MOVE AL-UABON            TO PROOFDTA
  9273            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9274        ELSE
  9275            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9276            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9277                MOVE ER-0873    TO EMI-ERROR
  9278                MOVE -1                  TO PROOFDTL
  9279                MOVE AL-UABON            TO PROOFDTA
  9280                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9281            END-IF
  9282        END-IF
  9283     END-IF.
  9284
  9285     IF PI-COMPANY-ID = 'DMD'
  9286        IF NOTE1L NOT = ZEROS
  9287            MOVE ER-7844        TO  EMI-ERROR
  9288            MOVE -1             TO  NOTE1L
  9289            MOVE AL-UABON       TO  NOTE1A
  9290            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9291
  9292     IF PI-COMPANY-ID = 'DMD'
  9293        IF NOTE2L NOT = ZEROS
  9294          GO TO 1004-DMD-EOB-CHECKS.
  9295
  9296     IF NOTE1L NOT > +0
  9297         GO TO 1005-CHECK-ERRORS.
  9298
  9299     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9300         GO TO 1005-CHECK-ERRORS.
  9301
  9302     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9303         GO TO 1003-HAN-PMT-NOTES.
  9304
  9305     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9306
  9307     IF WS-PMTOPTION NUMERIC
  9308        IF WS-PMTOPTION > '00' AND < '17'
  9309           NEXT SENTENCE
  9310        ELSE
  9311           MOVE ER-0618          TO EMI-ERROR
  9312           MOVE -1               TO NOTE1L
  9313           MOVE AL-UABON         TO NOTE1A
  9314           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9315     ELSE
  9316        GO TO 1005-CHECK-ERRORS.
  9317
  9318     IF WS-PMTOPTION = '05' AND
  9319        WS-DOCNAME = SPACES
  9320          MOVE ER-0616             TO EMI-ERROR
  9321          MOVE -1                  TO NOTE1L
  9322          MOVE AL-UABON            TO NOTE1A
  9323          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9324
  9325     IF WS-PMTOPTION = '15' OR '16'
  9326
  9327* EXEC CICS BIF DEEDIT
  9328*            FIELD (WS-AMOUNT)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 177
* EL156.cbl
  9329*            LENGTH(08)
  9330*        END-EXEC
  9331     MOVE 08
  9332       TO DFHEIV11
  9333*    MOVE '@"L                   #   #00009007' TO DFHEIV0
  9334     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9335     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9336     MOVE X'2020233030303039303037' TO DFHEIV0(25:11)
  9337     CALL 'kxdfhei1' USING DFHEIV0,
  9338           WS-AMOUNT,
  9339           DFHEIV11
  9340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9341        IF (WS-NUM-AMT = ZEROS) OR
  9342           (WS-AMOUNT NOT NUMERIC)
  9343           MOVE ER-0617          TO EMI-ERROR
  9344           MOVE -1               TO NOTE1L
  9345           MOVE AL-UABON         TO NOTE1A
  9346           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9347
  9348     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9349
  9350     GO TO 1005-CHECK-ERRORS.
  9351
  9352 1003-HAN-PMT-NOTES.
  9353
  9354     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9355
  9356     IF WS-HAN-PMT-CODE = SPACE
  9357         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9358     ELSE
  9359     IF WS-HAN-PMT-CODE = 'A'
  9360         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9361                                 TO WS-HAN-PMT-NOTE
  9362     ELSE
  9363     IF WS-HAN-PMT-CODE = 'B'
  9364         MOVE ':FINAL PAYMENT / DECEASED'
  9365                                 TO WS-HAN-PMT-NOTE
  9366     ELSE
  9367     IF WS-HAN-PMT-CODE = 'C'
  9368         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9369                                 TO WS-HAN-PMT-NOTE
  9370     ELSE
  9371     IF WS-HAN-PMT-CODE = 'D'
  9372         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9373                                 TO WS-HAN-PMT-NOTE
  9374     ELSE
  9375     IF WS-HAN-PMT-CODE = 'E'
  9376         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9377                                 TO WS-HAN-PMT-NOTE
  9378     ELSE
  9379     IF WS-HAN-PMT-CODE = 'F'
  9380         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9381                                 TO WS-HAN-PMT-NOTE
  9382     ELSE
  9383     IF WS-HAN-PMT-CODE = 'P'
  9384         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9385
  9386     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 178
* EL156.cbl
  9387     GO TO 1005-CHECK-ERRORS.
  9388
  9389 1004-DMD-EOB-CHECKS.
  9390
  9391     INITIALIZE PI-AT-EOB-CODES.
  9392
  9393     IF NOTE2I (20:21) > SPACES
  9394         MOVE ER-7845          TO EMI-ERROR
  9395         MOVE -1               TO NOTE2L
  9396         MOVE AL-UABON         TO NOTE2A
  9397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9398         GO TO 1005-CHECK-ERRORS
  9399      ELSE
  9400         MOVE NOTE2I             TO W-EOB-CODES.
  9401
  9402     MOVE +1                     TO W-EOB-NDX.
  9403
  9404 1004-CHECK-EACH-EOB.
  9405
  9406     IF W-EOB-NDX > +5
  9407             OR
  9408        W-EOB-CODE (W-EOB-NDX) = SPACES
  9409         GO TO 1004-CHECK-DUP-EOB.
  9410
  9411     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9412         MOVE ER-0956            TO EMI-ERROR
  9413         MOVE -1                 TO NOTE2L
  9414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9415         GO TO 1005-CHECK-ERRORS.
  9416
  9417     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9418     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9419     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9420     MOVE 'DLO023'               TO PGM-NAME.
  9421
  9422
  9423* EXEC CICS LINK
  9424*        PROGRAM    (PGM-NAME)
  9425*        COMMAREA   (CD-COMMUNICATION-AREA)
  9426*        LENGTH     (CD-RCRD-LENGTH)
  9427*    END-EXEC.
  9428*    MOVE '."C                   (   #00009092' TO DFHEIV0
  9429     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9431     MOVE X'2020233030303039303932' TO DFHEIV0(25:11)
  9432     CALL 'kxdfhei1' USING DFHEIV0,
  9433           PGM-NAME,
  9434           CD-COMMUNICATION-AREA,
  9435           CD-RCRD-LENGTH,
  9436           DFHEIV99,
  9437           DFHEIV99,
  9438           DFHEIV99,
  9439           DFHEIV99
  9440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9441
  9442
  9443     IF CD-RETURN-CODE = 'OK'
  9444         GO TO 1004-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 179
* EL156.cbl
  9445
  9446     MOVE -1                     TO NOTE2L.
  9447
  9448     IF CD-RETURN-CODE = '01'
  9449         MOVE ER-8310            TO EMI-ERROR
  9450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9451         GO TO 1005-CHECK-ERRORS.
  9452
  9453     IF CD-RETURN-CODE = '02'
  9454         MOVE ER-8311            TO EMI-ERROR
  9455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9456         GO TO 1005-CHECK-ERRORS.
  9457
  9458     IF CD-RETURN-CODE = '03'
  9459         MOVE ER-8312            TO EMI-ERROR
  9460         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9461         GO TO 1005-CHECK-ERRORS.
  9462
  9463     IF CD-RETURN-CODE = '04'
  9464         MOVE ER-8313            TO EMI-ERROR
  9465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9466         GO TO 1005-CHECK-ERRORS.
  9467
  9468     IF CD-RETURN-CODE = '05'
  9469         MOVE ER-8314            TO EMI-ERROR
  9470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9471         GO TO 1005-CHECK-ERRORS.
  9472
  9473     IF CD-RETURN-CODE = '06'
  9474         MOVE ER-8315            TO EMI-ERROR
  9475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9476         GO TO 1005-CHECK-ERRORS.
  9477
  9478     IF CD-RETURN-CODE = 'E1'
  9479         MOVE ER-8316            TO EMI-ERROR
  9480         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9481         GO TO 1005-CHECK-ERRORS.
  9482
  9483     IF CD-RETURN-CODE = 'N1'
  9484         MOVE ER-8317            TO EMI-ERROR
  9485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9486         GO TO 1005-CHECK-ERRORS.
  9487
  9488 1004-CONT.
  9489     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9490
  9491     ADD +1 TO W-EOB-NDX.
  9492     GO TO 1004-CHECK-EACH-EOB.
  9493
  9494 1004-CHECK-DUP-EOB.
  9495     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9496         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9497                               PI-AT-EOB-CODE (3) OR
  9498                               PI-AT-EOB-CODE (4) OR
  9499                               PI-AT-EOB-CODE (5)))
  9500                  OR
  9501        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9502         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 180
* EL156.cbl
  9503                               PI-AT-EOB-CODE (4) OR
  9504                               PI-AT-EOB-CODE (5)))
  9505                  OR
  9506        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9507         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9508                               PI-AT-EOB-CODE (5)))
  9509                  OR
  9510        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9511         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9512            MOVE ER-8000            TO EMI-ERROR
  9513            MOVE AL-UABON           TO NOTE2A
  9514            MOVE -1                 TO NOTE2L
  9515            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9516            GO TO 1005-CHECK-ERRORS.
  9517
  9518 1005-CHECK-ERRORS.
  9519*    IF PI-COMPANY-ID NOT = 'DMD'
  9520        GO TO 1006-CHECK-ERRORS.
  9521
  9522*********  DMD CODE START ******************
  9523*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9524*       GO TO 1006-CHECK-ERRORS.
  9525*
  9526*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9527*
  9528*    COMPUTE W-PAYMENT-TOTAL
  9529*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9530*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9531*               AND
  9532*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9533*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9534*          MOVE ER-0967    TO EMI-ERROR
  9535*          MOVE -1         TO PMTTYPEL
  9536*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9537*
  9538*    GO TO 1006-CHECK-ERRORS.
  9539*********  DMD CODE END ******************
  9540
  9541 1006-CHECK-ERRORS.
  9542     IF NOT EMI-NO-ERRORS
  9543        GO TO 2000-EDIT-DONE.
  9544
  9545
  9546* EXEC CICS HANDLE CONDITION
  9547*        NOTFND(1950-NOT-FOUND)
  9548*    END-EXEC.
  9549*    MOVE '"$I                   ! '' #00009200' TO DFHEIV0
  9550     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9552     MOVE X'2720233030303039323030' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0
  9554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9555
  9556
  9557     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9558     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9559     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9560     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 181
* EL156.cbl
  9561     MOVE 'MSTR'                 TO FILE-SWITCH.
  9562
  9563     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9564
  9565     IF PI-COMPANY-ID = 'DMD'
  9566         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9567
  9568     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9569        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9570           MOVE ER-0873    TO EMI-ERROR
  9571           MOVE -1                  TO PROOFDTL
  9572           MOVE AL-UABON            TO PROOFDTA
  9573           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9574        END-IF
  9575     END-IF
  9576     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9577     MOVE +95                    TO TRLR-SEQ-NO
  9578
  9579* EXEC CICS READ
  9580*       DATASET  ('ELTRLR')
  9581*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9582*       RIDFLD   (ELTRLR-KEY)
  9583*       RESP     (WS-RESPONSE)
  9584*    END-EXEC
  9585     MOVE 'ELTRLR' TO DFHEIV1
  9586*    MOVE '&"S        E          (  N#00009225' TO DFHEIV0
  9587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9589     MOVE X'204E233030303039323235' TO DFHEIV0(25:11)
  9590     CALL 'kxdfhei1' USING DFHEIV0,
  9591           DFHEIV1,
  9592           DFHEIV20,
  9593           DFHEIV99,
  9594           ELTRLR-KEY,
  9595           DFHEIV99,
  9596           DFHEIV99,
  9597           DFHEIV99
  9598     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9599         DFHEIV20
  9600     MOVE EIBRESP  TO WS-RESPONSE
  9601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9602
  9603     if ws-resp-normal
  9604        perform varying s1 from +1 by +1 until
  9605           at-note-error-no (s1) = spaces
  9606           if at-note-error-no (s1) = '1662'
  9607              continue
  9608           else
  9609              move at-note-error-no (s1)
  9610                                 to emi-error
  9611              if at-note-error-no (s1) = '1653'
  9612                 evaluate true
  9613                    when cl-claim-type = 'L'
  9614                       move '  LF  '
  9615                                 to emi-claim-type
  9616                    when cl-claim-type = 'I'
  9617                       move '  IU  '
  9618                                 to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 182
* EL156.cbl
  9619                    when other
  9620                       move '  AH  '
  9621                                 to emi-claim-type
  9622                 end-evaluate
  9623              end-if
  9624              PERFORM 9900-ERROR-FORMAT
  9625                                 THRU 9900-EXIT
  9626           end-if
  9627        end-perform
  9628     end-if
  9629     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9630         IF PI-PMTTYPE = '5' OR '6'
  9631             NEXT SENTENCE
  9632         ELSE
  9633             MOVE ER-0555             TO EMI-ERROR
  9634             MOVE -1                  TO PMTTYPEL
  9635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9636
  9637     IF CL-LAST-CLOSE-REASON = '2'
  9638         IF CL-CLAIM-STATUS = 'C'
  9639             MOVE ER-0760        TO  EMI-ERROR
  9640             MOVE -1             TO  PMTTYPEL
  9641             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9642
  9643     IF PI-ACTIVITY-CODE = 9
  9644         MOVE ER-3538            TO  EMI-ERROR
  9645         MOVE -1                 TO  PMTTYPEL
  9646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9647
  9648     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9649         GO TO 1008-READ-CERT.
  9650**********************AIG LOGIC STARTS *********************
  9651     IF CL-CERT-PRIME = 'INCOMPLETE'
  9652         MOVE ER-3540            TO  EMI-ERROR
  9653         MOVE -1                 TO  PMTTYPEL
  9654         MOVE AL-UABON           TO  PMTTYPEA
  9655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9656         GO TO 2000-EDIT-DONE.
  9657
  9658     IF PI-PMTTYPE = '4'
  9659         IF PI-EPYAMT IS NEGATIVE
  9660             IF PI-ECHECKNO-CR = 'CR'
  9661                 NEXT SENTENCE
  9662             ELSE
  9663                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9664
  9665     IF PI-PMTTYPE = '4'
  9666         IF PI-ECHECKNO-CR = 'CR'
  9667             IF PI-EPYAMT IS NEGATIVE
  9668                 NEXT SENTENCE
  9669             ELSE
  9670                 MOVE ER-0834    TO  EMI-ERROR
  9671                 MOVE -1         TO  EPYAMTL
  9672                 MOVE AL-UNBON   TO  EPYAMTA
  9673                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9674
  9675     IF PI-PMTTYPE = '4'
  9676         IF PI-EPYAMT IS NEGATIVE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 183
* EL156.cbl
  9677             IF PI-OFFLINE = 'Y'
  9678                 NEXT SENTENCE
  9679             ELSE
  9680                 MOVE 'Y'        TO  PI-OFFLINE
  9681                                     WS-OFFLINE
  9682                                     OFFLINEO
  9683                 MOVE AL-UANON   TO  OFFLINEA.
  9684
  9685*    IF PI-PMTTYPE = '4'
  9686*        IF PI-EPYAMT IS NEGATIVE
  9687*            IF PI-CASH = 'Y'
  9688*                NEXT SENTENCE
  9689*            ELSE
  9690*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9691*                MOVE AL-UANON   TO  CASHA
  9692*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9693*
  9694*    IF PI-CASH NOT = 'Y' AND 'N'
  9695*         IF PI-OFFLINE = 'Y'  AND
  9696*            PI-ECHECKNO-CR = 'CR'
  9697*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9698*              MOVE AL-UANON     TO  CASHA
  9699*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9700*
  9701*    IF PI-CASH NOT = 'Y' AND 'N'
  9702*        IF PI-PMTTYPE = '5' OR '6'
  9703*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9704*            MOVE AL-UANON       TO  CASHA
  9705*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9706*
  9707*    IF PI-CASH NOT = 'Y' AND 'N'
  9708*       IF CL-ASSOCIATES = 'N' OR 'A'
  9709*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9710*           MOVE AL-UANON        TO  CASHA
  9711*       ELSE
  9712*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9713*           MOVE AL-UANON        TO  CASHA.
  9714*
  9715*    IF PI-PMTTYPE = '5' OR '6'
  9716*        IF PI-CASH = 'N'
  9717*            MOVE ER-0819        TO  EMI-ERROR
  9718*            MOVE AL-UANON       TO  CASHA
  9719*            MOVE -1             TO  CASHL
  9720*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9721*
  9722*    IF CL-ASSOCIATES = 'N' OR 'A'
  9723*       IF CASHI = 'N'
  9724*        MOVE ER-3537            TO  EMI-ERROR
  9725*        MOVE AL-UANON           TO  CASHA
  9726*        MOVE -1                 TO  CASHL
  9727*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9728
  9729 1007-DEFAULT-AIG-CHECKNO.
  9730
  9731     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9732         MOVE ER-3532            TO  EMI-ERROR
  9733         MOVE -1                 TO  PMTTYPEL
  9734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 184
* EL156.cbl
  9735**********************AIG LOGIC ENDS ***********************
  9736
  9737 1008-READ-CERT.
  9738
  9739     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9740     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9741     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9742     MOVE CL-CERT-STATE          TO CERT-STATE.
  9743     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9744     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9745     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9746     MOVE 'CERT'                 TO FILE-SWITCH.
  9747
  9748     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9749
  9750     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9751         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9752     ELSE
  9753         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9754
  9755*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9756*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9757
  9758     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9759         MOVE ER-0458            TO EMI-ERROR
  9760         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9761
  9762     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9763         MOVE ER-0459            TO EMI-ERROR
  9764         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9765
  9766     IF CL-REPORTED-DT = LOW-VALUES
  9767        MOVE ER-0530             TO EMI-ERROR
  9768        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9769
  9770     IF PI-COMPANY-ID = 'NCL'
  9771        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9772            MOVE ER-0770            TO EMI-ERROR
  9773            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9774
  9775     IF PI-COMPANY-ID = 'NCL'
  9776        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9777            MOVE ER-0737            TO EMI-ERROR
  9778            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9779
  9780     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9781         MOVE ER-0768            TO  EMI-ERROR
  9782         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9783
  9784     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9785         MOVE ER-0769            TO  EMI-ERROR
  9786         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9787
  9788     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9789         GO TO 1020-DO-LIFE-EDITS
  9790     ELSE
  9791         GO TO 1030-DO-AH-EDITS.
  9792
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 185
* EL156.cbl
  9793 1010-GENERAL-ERROR.
  9794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9795
  9796     IF EMI-MESSAGE-FORMATTED
  9797         MOVE -1                 TO PMTTYPEL.
  9798
  9799 1010-EXIT.
  9800     EXIT.
  9801
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 186
* EL156.cbl
  9803 1020-DO-LIFE-EDITS.
  9804     IF CM-LF-BENEFIT-CD = '00'
  9805         IF PI-PMTTYPE = '5' OR '6'
  9806             MOVE ER-0658        TO EMI-ERROR
  9807             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9808         ELSE
  9809             MOVE ER-1775        TO EMI-ERROR
  9810             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9811
  9812     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9813     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9814         MOVE ER-0460            TO EMI-ERROR
  9815         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9816
  9817     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9818     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9819     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9820     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9821     MOVE '4'                    TO  CNTL-REC-TYPE.
  9822     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9823     MOVE 'BENE'                 TO  FILE-SWITCH.
  9824     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9825     IF NO-BENEFIT-FOUND
  9826         GO TO 1950-NOT-FOUND.
  9827
  9828     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9829
  9830     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9831         IF PI-PMTTYPE = '4'
  9832             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9833                PI-LF-COVERAGE-TYPE = 'P'
  9834                 NEXT SENTENCE
  9835             ELSE
  9836                 MOVE ER-0461        TO EMI-ERROR
  9837                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9838         ELSE
  9839            NEXT SENTENCE
  9840     ELSE
  9841         IF PI-PMTTYPE = '2'
  9842            IF NOT CM-O-B-COVERAGE
  9843              AND CM-LF-CURRENT-STATUS = '7'
  9844                MOVE ER-0462     TO EMI-ERROR
  9845                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9846
  9847     IF PI-PMTTYPE = '2'
  9848         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9849            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9850             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9851             MOVE ER-0730            TO  EMI-ERROR
  9852             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9853             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9854
  9855     IF PI-PMTTYPE = '2'
  9856         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9857            PI-LF-COVERAGE-TYPE = 'P'
  9858             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9859                 MOVE ER-0462    TO  EMI-ERROR
  9860                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 187
* EL156.cbl
  9861
  9862     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9863       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9864         MOVE ER-0466            TO EMI-ERROR
  9865         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9866
  9867     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9868         IF PI-PMTTYPE = '3'
  9869             MOVE 0436           TO EMI-ERROR
  9870             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9871             GO TO 1045-EDIT-PAYEE-ADDR
  9872         ELSE
  9873             GO TO 1045-EDIT-PAYEE-ADDR.
  9874
  9875     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9876        PI-LF-COVERAGE-TYPE = 'P'
  9877         IF PI-PMTTYPE = '3'
  9878             MOVE ER-0436          TO  EMI-ERROR
  9879             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9880         ELSE
  9881             NEXT SENTENCE
  9882     ELSE
  9883         IF PI-PMTTYPE = '1' OR '3'
  9884             MOVE ER-0436            TO EMI-ERROR
  9885             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9886*
  9887     IF PI-COMPANY-ID = 'CID' AND
  9888        CL-CERT-STATE = 'SC'  AND
  9889        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9890           MOVE ER-0879    TO  EMI-ERROR
  9891           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9892           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9893     END-IF.
  9894     IF PI-COMPANY-ID = 'AHL'
  9895        evaluate true
  9896           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9897              MOVE ER-0879       TO  EMI-ERROR
  9898              PERFORM 1040-PMTTYPE-ERROR
  9899                                 THRU 1040-EXIT
  9900              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9901           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9902                 '6D' OR '6H' OR '6R'
  9903              MOVE ER-0879       TO  EMI-ERROR
  9904              PERFORM 1040-PMTTYPE-ERROR
  9905                                 THRU 1040-EXIT
  9906              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9907           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9908              MOVE ER-0879       TO  EMI-ERROR
  9909              PERFORM 1040-PMTTYPE-ERROR
  9910                                 THRU 1040-EXIT
  9911              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9912        end-evaluate
  9913     END-IF
  9914     GO TO 1045-EDIT-PAYEE-ADDR.
  9915
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 188
* EL156.cbl
  9917 1030-DO-AH-EDITS.
  9918     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9919     IF CM-AH-BENEFIT-CD = '00'
  9920         IF PI-PMTTYPE = '5' OR '6'
  9921             MOVE ER-0658        TO EMI-ERROR
  9922             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9923         ELSE
  9924             MOVE ER-1775        TO EMI-ERROR
  9925             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9926
  9927     IF CL-TOTAL-PAID-AMT = ZEROS
  9928         IF PI-PMTTYPE = '4'
  9929             MOVE ER-0438        TO EMI-ERROR
  9930             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9931
  9932     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9933         IF PI-PMTTYPE = '3'
  9934             MOVE ER-0463        TO EMI-ERROR
  9935             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9936         ELSE
  9937             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9938              AND CM-LF-CURRENT-STATUS = '7'
  9939                 MOVE ER-0465    TO EMI-ERROR
  9940                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9941
  9942     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9943         IF PI-PMTTYPE = '3'
  9944             MOVE ER-0464        TO EMI-ERROR
  9945             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9946         ELSE
  9947             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9948                 MOVE ER-0469    TO EMI-ERROR
  9949                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9950
  9951     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9952         IF PI-PMTTYPE = '3'
  9953             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9954                 MOVE ER-0467    TO EMI-ERROR
  9955                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9956             ELSE
  9957                 NEXT SENTENCE
  9958         ELSE
  9959             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9960                 MOVE ER-0468    TO EMI-ERROR
  9961                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9962
  9963     GO TO 1045-EDIT-PAYEE-ADDR.
  9964
  9965 1040-PMTTYPE-ERROR.
  9966     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9967
  9968     IF EMI-MESSAGE-FORMATTED
  9969         MOVE -1                 TO PMTTYPEL
  9970         MOVE AL-UABON           TO PMTTYPEA.
  9971
  9972 1040-EXIT.
  9973     EXIT.
  9974
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 189
* EL156.cbl
  9976 1045-EDIT-PAYEE-ADDR.
  9977
  9978     IF PI-OFFLINE = 'N' AND
  9979        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9980           < PI-PAYEE-SEQ-NUM)
  9981        OR
  9982         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9983         (PI-PAYEE-TYPE = 'B')                 AND
  9984         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9985        OR
  9986         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9987           < PI-PAYEE-SEQ-NUM)
  9988        OR
  9989         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9990           < PI-PAYEE-SEQ-NUM)
  9991        OR
  9992         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9993           < PI-PAYEE-SEQ-NUM)
  9994        OR
  9995         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9996           < PI-PAYEE-SEQ-NUM)
  9997        OR
  9998         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9999           < PI-PAYEE-SEQ-NUM))
 10000             MOVE ER-0437        TO EMI-ERROR
 10001             MOVE -1             TO PAYEEL
 10002             MOVE AL-UABON       TO PAYEEA
 10003             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10004
 10005     IF PI-OFFLINE    = 'N' AND
 10006        PI-PAYEE-TYPE = 'B' AND
 10007        PI-PAYEE-SEQ  = '0'
 10008         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10009         IF BENE-FOUND-SW = 'N'
 10010             MOVE ER-0437        TO EMI-ERROR
 10011             MOVE -1             TO PAYEEL
 10012             MOVE AL-UABON       TO PAYEEA
 10013             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10014
 10015     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10016        IF PI-OFFLINE    = 'N'  AND
 10017           PI-PAYEE-TYPE = 'B'  AND
 10018           PI-PAYEE-SEQ  = '9'
 10019             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10020             IF BENE-FOUND-SW = 'N'
 10021                MOVE ER-0437        TO EMI-ERROR
 10022                MOVE -1             TO PAYEEL
 10023                MOVE AL-UABON       TO PAYEEA
 10024                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10025
 10026*    IF PI-COMPANY-ID = 'CRI'
 10027*        IF CL-CLAIM-TYPE = 'L'
 10028*            MOVE 'N'                TO  WS-GROUPED
 10029*                                        PI-GROUPED
 10030*                                        GROUPEDI
 10031*            MOVE AL-UANON           TO  GROUPEDA
 10032*            GO TO 1050-EDIT-CHECK-NO
 10033*        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 190
* EL156.cbl
 10034*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10035*            IF WS-GROUP-1 = 'C'
 10036*                NEXT SENTENCE
 10037*            ELSE
 10038*                MOVE 'N'            TO  WS-GROUPED
 10039*                                        PI-GROUPED
 10040*                                        GROUPEDI
 10041*                MOVE AL-UANON       TO  GROUPEDA
 10042*                GO TO 1050-EDIT-CHECK-NO.
 10043
 10044*     IF PI-GROUPED = 'Y'
 10045*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10046*           NEXT SENTENCE
 10047*        ELSE
 10048*           MOVE ER-0437        TO EMI-ERROR
 10049*           MOVE -1             TO PAYEEL
 10050**02180            MOVE AL-UABON       TO PAYEEA
 10051*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10052*
 10053*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10054*        (PI-GROUPED    = ' ')
 10055*        NEXT SENTENCE
 10056*     ELSE
 10057*
 10058     GO TO 1050-EDIT-CHECK-NO.
 10059*     IF PI-COMPANY-ID = 'CRI'
 10060*        MOVE 'N'           TO GROUPEDI
 10061*                              PI-GROUPED
 10062*                              WS-GROUPED
 10063*        MOVE AL-UANON      TO GROUPEDA.
 10064*
 10065*     IF PI-COMPANY-ID = 'CRI'
 10066*        IF PI-PAYEE-TYPE = 'B'
 10067*           IF BENE-FOUND-SW = 'Y'
 10068*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10069*                 MOVE 'Y'           TO GROUPEDI
 10070*                                       PI-GROUPED
 10071*                                       WS-GROUPED
 10072*                 MOVE AL-UANON      TO GROUPEDA
 10073*              ELSE
 10074*                 NEXT SENTENCE
 10075*           ELSE
 10076*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10077*              IF BENE-FOUND-SW = 'Y'
 10078*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10079*                    MOVE 'Y'      TO GROUPEDI
 10080*                                     PI-GROUPED
 10081*                                     WS-GROUPED
 10082*                    MOVE AL-UANON TO GROUPEDA.
 10083*
 10084
 10085     IF PI-COMPANY-ID NOT = 'CRI'
 10086        GO TO 1050-EDIT-CHECK-NO.
 10087
 10088*************** CRI CODE START ******************
 10089     IF PI-PAYEE-TYPE NOT = 'A'
 10090        GO TO 1050-EDIT-CHECK-NO.
 10091
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 191
* EL156.cbl
 10092     MOVE LOW-VALUES             TO ERACCT-KEY.
 10093     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10094     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10095     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10096     MOVE PI-STATE               TO ACCT-STATE.
 10097     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10098     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10099     MOVE 'ACCT'                 TO FILE-SWITCH.
 10100
 10101     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10102     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10103
 10104
 10105* EXEC CICS HANDLE CONDITION
 10106*         NOTFND   (1950-NOT-FOUND)
 10107*         ENDFILE  (1950-NOT-FOUND)
 10108*    END-EXEC.
 10109*    MOVE '"$I''                  ! ( #00009733' TO DFHEIV0
 10110     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10112     MOVE X'2820233030303039373333' TO DFHEIV0(25:11)
 10113     CALL 'kxdfhei1' USING DFHEIV0
 10114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10115
 10116
 10117
 10118* EXEC CICS STARTBR
 10119*         DATASET   ('ERACCT')
 10120*         RIDFLD    (ERACCT-KEY)
 10121*         GTEQ
 10122*    END-EXEC.
 10123     MOVE 'ERACCT' TO DFHEIV1
 10124     MOVE 0
 10125       TO DFHEIV11
 10126*    MOVE '&,         G          &   #00009738' TO DFHEIV0
 10127     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10128     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10129     MOVE X'2020233030303039373338' TO DFHEIV0(25:11)
 10130     CALL 'kxdfhei1' USING DFHEIV0,
 10131           DFHEIV1,
 10132           ERACCT-KEY,
 10133           DFHEIV99,
 10134           DFHEIV11,
 10135           DFHEIV99
 10136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10137
 10138
 10139 1046-READNEXT-ERACCT.
 10140
 10141
 10142* EXEC CICS READNEXT
 10143*         DATASET   ('ERACCT')
 10144*         RIDFLD    (ERACCT-KEY)
 10145*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10146*    END-EXEC.
 10147     MOVE 'ERACCT' TO DFHEIV1
 10148     MOVE 0
 10149       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 192
* EL156.cbl
 10150*    MOVE '&.S                   )   #00009746' TO DFHEIV0
 10151     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10152     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10153     MOVE X'2020233030303039373436' TO DFHEIV0(25:11)
 10154     CALL 'kxdfhei1' USING DFHEIV0,
 10155           DFHEIV1,
 10156           DFHEIV20,
 10157           DFHEIV99,
 10158           ERACCT-KEY,
 10159           DFHEIV99,
 10160           DFHEIV11,
 10161           DFHEIV99,
 10162           DFHEIV99
 10163     SET ADDRESS OF ACCOUNT-MASTER TO
 10164         DFHEIV20
 10165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10166
 10167
 10168     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10169        IF WS-ERACCT-HOLD-RECORD = SPACES
 10170           GO TO 1950-NOT-FOUND
 10171        ELSE
 10172           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10173           GO TO 1048-CONTINUE.
 10174
 10175     IF ACCT-EXP-DT = HIGH-VALUES
 10176        NEXT SENTENCE
 10177     ELSE
 10178        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10179        GO TO 1046-READNEXT-ERACCT.
 10180
 10181 1048-CONTINUE.
 10182
 10183*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10184*       MOVE 'Y'                 TO GROUPEDI
 10185*                                   PI-GROUPED
 10186*                                   WS-GROUPED
 10187*       MOVE AL-UANON            TO GROUPEDA.
 10188*************** CRI CODE END ******************
 10189
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 193
* EL156.cbl
 10191 1050-EDIT-CHECK-NO.
 10192
 10193     IF PI-OFFLINE = 'Y'
 10194         IF PI-ECHECKNO = SPACES
 10195              MOVE ER-0439        TO EMI-ERROR
 10196              GO TO 1090-CHECK-NO-ERROR
 10197           ELSE
 10198*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10199*           IF PI-ECHECKNO-N = 'N' AND
 10200*              PI-CASH       = 'Y'
 10201*                MOVE ER-3535        TO EMI-ERROR
 10202*                GO TO 1090-CHECK-NO-ERROR
 10203*             ELSE
 10204*                MOVE AL-UANON    TO CHECKNOA
 10205*                GO TO 1100-EDIT-HOLDTIL
 10206*         ELSE
 10207            MOVE AL-UANON    TO CHECKNOA
 10208            GO TO 1100-EDIT-HOLDTIL.
 10209
 10210     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10211     MOVE '6'                    TO CNTL-REC-TYPE.
 10212
 10213     IF CONTROL-IS-ACTUAL-CARRIER
 10214         MOVE PI-CARRIER         TO WS-CARR
 10215     ELSE
 10216         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10217
 10218     IF PI-COMPANY-ID = 'FIA'
 10219         MOVE PI-CARRIER         TO WS-CARR.
 10220
 10221     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10222     MOVE 0                      TO CNTL-SEQ-NO.
 10223     MOVE 'CARR'                 TO FILE-SWITCH.
 10224
 10225     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10226
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 194
* EL156.cbl
 10228     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10229         GO TO 1051-EDIT-CHECKNO-CONT.
 10230
 10231**********************AIG LOGIC STARTS**********************
 10232     IF PI-ECHECKNO = SPACES
 10233         IF CHECK-NO-MANUAL
 10234             MOVE ER-0441        TO EMI-ERROR
 10235             GO TO 1090-CHECK-NO-ERROR
 10236         ELSE
 10237             MOVE AL-UANOF       TO CHECKNOA
 10238             GO TO 1100-EDIT-HOLDTIL.
 10239
 10240     IF PI-ECHECKNO NOT = SPACES
 10241         IF CHECK-NO-MANUAL
 10242             MOVE AL-UANON       TO CHECKNOA
 10243             GO TO 1100-EDIT-HOLDTIL.
 10244
 10245     IF PI-ECHECKNO-CR = 'CR'
 10246        IF PI-OFFLINE = 'Y'
 10247            MOVE AL-UANON       TO CHECKNOA
 10248            GO TO 1100-EDIT-HOLDTIL
 10249        ELSE
 10250            MOVE ER-3534        TO EMI-ERROR
 10251            GO TO 1090-CHECK-NO-ERROR.
 10252
 10253     IF PI-ECHECKNO-N = 'N'
 10254        IF PI-CASH = 'N'
 10255            MOVE AL-UANON       TO CHECKNOA
 10256            GO TO 1100-EDIT-HOLDTIL
 10257        ELSE
 10258            MOVE ER-3535          TO EMI-ERROR
 10259            GO TO 1090-CHECK-NO-ERROR.
 10260
 10261     MOVE ER-0442        TO EMI-ERROR
 10262     GO TO 1090-CHECK-NO-ERROR.
 10263**********************AIG LOGIC ENDS************************
 10264
 10265 1051-EDIT-CHECKNO-CONT.
 10266
 10267     IF PI-COMPANY-ID = 'DMD'
 10268        IF PI-ECHECKNO NOT = SPACES
 10269           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10270              MOVE ER-0442        TO EMI-ERROR
 10271              GO TO 1090-CHECK-NO-ERROR
 10272            ELSE
 10273              GO TO 1100-EDIT-HOLDTIL
 10274          ELSE
 10275           GO TO 1100-EDIT-HOLDTIL.
 10276
 10277     IF PI-ECHECKNO = SPACES
 10278         IF CHECK-NO-MANUAL
 10279             MOVE ER-0441        TO EMI-ERROR
 10280             GO TO 1090-CHECK-NO-ERROR
 10281         ELSE
 10282             MOVE AL-UANOF       TO CHECKNOA
 10283             GO TO 1100-EDIT-HOLDTIL
 10284     ELSE
 10285         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 195
* EL156.cbl
 10286             MOVE AL-UANON       TO CHECKNOA
 10287             GO TO 1100-EDIT-HOLDTIL
 10288         ELSE
 10289             MOVE ER-0442        TO EMI-ERROR
 10290             GO TO 1090-CHECK-NO-ERROR.
 10291
 10292 1090-CHECK-NO-ERROR.
 10293     MOVE -1                     TO CHECKNOL.
 10294     MOVE AL-UABON               TO CHECKNOA.
 10295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10296
 10297     GO TO 2000-EDIT-DONE.
 10298
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 196
* EL156.cbl
 10300 1100-EDIT-HOLDTIL.
 10301     MOVE AL-UANON               TO HOLDTILA.
 10302
 10303     IF PI-HOLDTIL = ZEROS
 10304        IF PI-OFFLINE = 'Y'
 10305           MOVE ER-0572          TO EMI-ERROR
 10306           GO TO 1105-HOLDTIL-ERROR
 10307        ELSE
 10308           GO TO 1110-EDIT-PAID-FROM.
 10309
 10310     MOVE '4'                    TO DC-OPTION-CODE.
 10311     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10312     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10313
 10314     IF DATE-CONVERSION-ERROR
 10315         MOVE ER-0446            TO EMI-ERROR
 10316         GO TO 1105-HOLDTIL-ERROR
 10317     END-IF
 10318     IF PI-OFFLINE = 'Y'
 10319        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10320           MOVE ER-0446            TO EMI-ERROR
 10321           GO TO 1105-HOLDTIL-ERROR
 10322        END-IF
 10323     END-IF
 10324
 10325     IF PI-OFFLINE = 'Y'
 10326        GO TO 1110-EDIT-PAID-FROM.
 10327
 10328     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10329     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10330     MOVE '1'                    TO DC-OPTION-CODE.
 10331     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10332
 10333     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10334         MOVE ER-0447            TO EMI-ERROR
 10335         GO TO 1105-HOLDTIL-ERROR.
 10336
 10337     GO TO 1110-EDIT-PAID-FROM.
 10338
 10339 1105-HOLDTIL-ERROR.
 10340     MOVE -1                     TO HOLDTILL.
 10341     MOVE AL-UNBON               TO HOLDTILA.
 10342     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10343
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 197
* EL156.cbl
 10345 1110-EDIT-PAID-FROM.
 10346     MOVE AL-UANON               TO EPYFROMA.
 10347
 10348     IF PI-EPYFROM = ZEROS
 10349         GO TO 1120-CALCULATE-PAID-FROM.
 10350
 10351     IF PI-PMTTYPE = '5' OR '6'
 10352         MOVE ER-0448            TO EMI-ERROR
 10353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10354         MOVE AL-UNBON           TO EPYFROMA
 10355         MOVE -1                 TO EPYFROML
 10356         GO TO 1150-EDIT-PAID-THRU.
 10357
 10358     MOVE '4'                    TO DC-OPTION-CODE.
 10359     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10360     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10361
 10362     IF DATE-CONVERSION-ERROR
 10363         MOVE ER-0449            TO EMI-ERROR
 10364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10365         MOVE AL-UNBON           TO EPYFROMA
 10366         MOVE -1                 TO EPYFROML
 10367     ELSE
 10368         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10369
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 198
* EL156.cbl
 10371 1120-CALCULATE-PAID-FROM.
 10372     IF PI-PMTTYPE = '5' OR '6'
 10373         GO TO 1150-EDIT-PAID-THRU.
 10374
 10375*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10376*       IF PI-PMTTYPE = '4'
 10377*         GO TO 1150-EDIT-PAID-THRU.
 10378
 10379     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10380         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10381         MOVE ' '                TO DC-OPTION-CODE
 10382         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10383         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10384         GO TO 1145-TEST-PAID-FROM.
 10385
 10386     IF PI-PMTTYPE = '4'
 10387        GO TO 1150-EDIT-PAID-THRU.
 10388
 10389     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10390     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10391     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10392     MOVE '5'                    TO CNTL-REC-TYPE.
 10393     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10394     MOVE 'BENE'                 TO FILE-SWITCH.
 10395
 10396     IF WS-BEN-CD = ZEROS
 10397         GO TO 1950-NOT-FOUND.
 10398
 10399     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10400
 10401     IF NO-BENEFIT-FOUND
 10402         GO TO 1950-NOT-FOUND.
 10403
 10404     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10405     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10406
 10407     IF PI-BEN-DAYS NOT NUMERIC
 10408        MOVE ZEROS               TO PI-BEN-DAYS.
 10409
 10410     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10411
 10412     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10413        (CL-TOTAL-PAID-AMT > ZEROS)
 10414         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10415         MOVE '6'                 TO DC-OPTION-CODE
 10416         MOVE +0                  TO DC-ELAPSED-MONTHS
 10417         MOVE +1                  TO DC-ELAPSED-DAYS
 10418         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10419         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10420         GO TO 1145-TEST-PAID-FROM.
 10421
 10422******************************************************************
 10423****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10424****** SPECIAL ENTERED DATE.
 10425******************************************************************
 10426
 10427     IF PI-AIGFROM = ZEROS
 10428         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 199
* EL156.cbl
 10429
 10430     MOVE AL-UANON TO AIGFROMA.
 10431
 10432     MOVE '4'                    TO DC-OPTION-CODE.
 10433     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10434     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10435
 10436     IF DATE-CONVERSION-ERROR
 10437         MOVE ER-0449            TO EMI-ERROR
 10438         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10439         MOVE AL-UNBON           TO AIGFROMA
 10440         MOVE -1                 TO AIGFROML
 10441         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10442     ELSE
 10443         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10444         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10445
 10446     GO TO 1140-CONTINUE-PAID-FROM.
 10447
 10448 1130-CONTINUE-PAID-FROM.
 10449
 10450     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10451        (CL-TOTAL-PAID-AMT = ZEROS)
 10452           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10453
 10454 1140-CONTINUE-PAID-FROM.
 10455
 10456     IF PI-BEN-TYPE = 'R'
 10457         IF PI-BEN-DAYS = ZEROS
 10458             NEXT SENTENCE
 10459         ELSE
 10460         IF PI-COMPANY-ID NOT = 'DMD'
 10461             SUBTRACT 1 FROM PI-BEN-DAYS.
 10462
 10463     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10464
 10465     IF PI-COMPANY-ID = 'DMD'
 10466         MOVE -1                 TO DC-ELAPSED-DAYS
 10467         MOVE +0                 TO DC-ELAPSED-MONTHS
 10468         MOVE '6'                TO DC-OPTION-CODE
 10469         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10470         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10471         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10472                               REMAINDER DC-ELAPSED-DAYS
 10473      ELSE
 10474         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10475         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10476
 10477     MOVE '6'                    TO DC-OPTION-CODE.
 10478     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10479     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10480
 10481     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10482
 10483     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10484         MOVE ER-0541            TO EMI-ERROR
 10485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10486         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 200
* EL156.cbl
 10487         MOVE AL-UNBON           TO EPYFROMA.
 10488
 10489     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10490        (PI-BENEFIT-SAVE = '60E')
 10491        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10492           (CL-TOTAL-PAID-AMT = ZEROS)
 10493             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10494             MOVE 30                  TO DC-ELAPSED-DAYS
 10495             MOVE +0                  TO DC-ELAPSED-MONTHS
 10496             MOVE '6'                 TO DC-OPTION-CODE
 10497             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10498
 10499     IF PI-BEN-TYPE = 'R'
 10500         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10501     ELSE
 10502         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10503         IF WS-SV-EPYFROM = LOW-VALUES
 10504            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10505
 10506     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10507         IF WS-USE-AIG-PAYFROM   OR
 10508            WS-AIG-RECALC-PAYFROM
 10509              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10510                                      DC-BIN-DATE-1
 10511              MOVE ' '            TO  DC-OPTION-CODE
 10512              MOVE +0             TO  DC-ELAPSED-MONTHS
 10513                                      DC-ELAPSED-DAYS
 10514              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10515              IF NO-CONVERSION-ERROR
 10516                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10517
 10518     IF PI-CPYFROM < CL-INCURRED-DT
 10519        MOVE -1                  TO EPYFROML
 10520        MOVE ER-3542             TO EMI-ERROR
 10521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10522
 10523     IF CM-ENTRY-DT < CL-INCURRED-DT
 10524        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10525        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10526        MOVE +0                     TO DC-ELAPSED-DAYS
 10527        MOVE +0                     TO DC-ELAPSED-MONTHS
 10528        MOVE '1'                    TO DC-OPTION-CODE
 10529        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10530        ELSE
 10531        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10532
 10533     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10534         NEXT SENTENCE
 10535     ELSE
 10536         IF DC-ELAPSED-MONTHS < 2
 10537             MOVE ER-3255        TO EMI-ERROR
 10538             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10539
 10540 1145-TEST-PAID-FROM.
 10541     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10542         GO TO 1150-EDIT-PAID-THRU.
 10543
 10544     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 201
* EL156.cbl
 10545         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10546         MOVE ' '                TO DC-OPTION-CODE
 10547         MOVE +0                 TO DC-ELAPSED-MONTHS
 10548                                    DC-ELAPSED-DAYS
 10549         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10550         IF NO-CONVERSION-ERROR
 10551             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10552         ELSE
 10553             MOVE SPACES             TO EMI-DATE-FIELD.
 10554
 10555     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10556         IF CL-TOTAL-PAID-AMT = ZEROS
 10557             MOVE ER-3543            TO EMI-ERROR
 10558             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10559             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10560             IF EMI-MESSAGE-FORMATTED
 10561                MOVE -1             TO EPYFROML
 10562                MOVE AL-UNBON       TO EPYFROMA
 10563             ELSE
 10564                NEXT SENTENCE
 10565         ELSE
 10566             MOVE ER-0452            TO EMI-ERROR
 10567             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10568             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10569             IF EMI-MESSAGE-FORMATTED
 10570                MOVE -1             TO EPYFROML
 10571                MOVE AL-UNBON       TO EPYFROMA.
 10572
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 202
* EL156.cbl
 10574 1150-EDIT-PAID-THRU.
 10575
 10576     MOVE AL-UANON               TO EPYTHRUA.
 10577
 10578     IF PI-EPYTHRU = ZEROS
 10579         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10580             GO TO 1200-EDIT-FIND-TOLERANCES
 10581         ELSE
 10582            IF (PI-PMTTYPE = '3') OR
 10583               (PI-PMTTYPE = '2' AND
 10584                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10585               GO TO 1152-CHECK-TYPE
 10586            ELSE
 10587               MOVE ER-0473      TO EMI-ERROR
 10588               GO TO 1170-PAID-THRU-FATAL-ERROR
 10589     ELSE
 10590         IF PI-PMTTYPE = '5' OR '6'
 10591             MOVE ER-0474        TO EMI-ERROR
 10592             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10593
 10594     MOVE '4'                    TO DC-OPTION-CODE.
 10595     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10596     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10597
 10598     IF DATE-CONVERSION-ERROR
 10599         MOVE ER-0475            TO EMI-ERROR
 10600         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10601
 10602     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10603
 10604     IF PI-COMPANY-ID = 'DMD'
 10605         IF PI-PMTTYPE NOT = '2'
 10606                 AND
 10607            WS-EXP-DT > WS-SV-EPYTHRU
 10608             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10609             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10610             MOVE '1'              TO DC-OPTION-CODE
 10611             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10612             IF DATE-CONVERSION-ERROR
 10613                 MOVE ER-0944      TO EMI-ERROR
 10614                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10615             ELSE
 10616                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10617                    DC-ELAPSED-DAYS   = 1
 10618                     MOVE ER-0945  TO EMI-ERROR
 10619                     MOVE -1       TO EPYTHRUL
 10620                     MOVE AL-UABON TO EPYTHRUA
 10621                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10622
 10623     IF PI-PMTTYPE = '4'
 10624         NEXT SENTENCE
 10625     ELSE
 10626         IF WS-SV-EPYTHRU = WS-EXP-DT
 10627             IF PI-PMTTYPE NOT = '2' AND '3'
 10628                 MOVE ER-3541    TO EMI-ERROR
 10629                 MOVE -1         TO PMTTYPEL
 10630                 MOVE AL-UABON   TO PMTTYPEA
 10631                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 203
* EL156.cbl
 10632
 10633     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10634         MOVE ER-0501            TO EMI-ERROR
 10635         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10636
 10637     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10638        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10639*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10640*              MOVE ER-0540         TO EMI-ERROR
 10641*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10642*              MOVE -1              TO EPYTHRUL
 10643*              MOVE AL-UNBON        TO EPYTHRUA
 10644*          ELSE
 10645*          IF PI-COMPANY-ID = 'DMD'
 10646*              MOVE ER-7540         TO EMI-ERROR
 10647*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10648*              MOVE -1              TO EPYTHRUL
 10649*              MOVE AL-UNBON        TO EPYTHRUA
 10650*          ELSE
 10651               IF PI-PMTTYPE NOT = '2' AND '3'
 10652                  IF PI-COMPANY-ID = '???'
 10653                      MOVE ER-7540  TO EMI-ERROR
 10654                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10655                      MOVE -1       TO EPYTHRUL
 10656                      MOVE AL-UNBON TO EPYTHRUA
 10657                  ELSE
 10658                      MOVE ER-0540  TO EMI-ERROR
 10659                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10660                      MOVE -1       TO EPYTHRUL
 10661                      MOVE AL-UNBON TO EPYTHRUA.
 10662
 10663     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10664            OR
 10665        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10666         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10667            OR
 10668        (PI-CPYFROM NOT = LOW-VALUES AND
 10669         PI-CPYFROM < CL-PAID-THRU-DT)
 10670        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10671
 10672 1152-CHECK-TYPE.
 10673     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10674        OR (PI-PMTTYPE = '5' OR '6')
 10675         GO TO 1160-EDIT-PAID-THRU-AH.
 10676
 10677 1155-EDIT-PAID-THRU-LIFE.
 10678     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10679     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10680     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10681     MOVE '4'                    TO CNTL-REC-TYPE.
 10682     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10683     MOVE 'BENE'                 TO FILE-SWITCH.
 10684
 10685     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10686
 10687     IF NO-BENEFIT-FOUND
 10688         GO TO 1950-NOT-FOUND.
 10689
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 204
* EL156.cbl
 10690     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10691
 10692     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10693
 10694     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10695        PI-LF-COVERAGE-TYPE = 'P'
 10696         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10697         GO TO 1200-EDIT-FIND-TOLERANCES.
 10698
 10699     IF PI-EPYTHRU = ZEROS
 10700        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10701
 10702     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10703         MOVE ER-0476            TO EMI-ERROR
 10704         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10705
 10706     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10707*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10708     move cl-critical-period    to dc-elapsed-months
 10709     MOVE +0                    TO DC-ELAPSED-DAYS.
 10710     MOVE '6'                   TO DC-OPTION-CODE.
 10711     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10712
 10713     IF (NO-CONVERSION-ERROR AND
 10714         WS-SPECIAL-CALC-CD = 'C')
 10715        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10716            MOVE ER-0657 TO EMI-ERROR
 10717            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10718
 10719     IF PI-COMPANY-ID = 'NCL'
 10720         IF WS-SPECIAL-CALC-CD = 'C' AND
 10721            cl-critical-period = zeros
 10722*           CM-LF-CRITICAL-PERIOD = +0
 10723             MOVE ER-0844       TO EMI-ERROR
 10724             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10725
 10726     GO TO 1200-EDIT-FIND-TOLERANCES.
 10727
 10728 1160-EDIT-PAID-THRU-AH.
 10729     IF PI-EPYTHRU = ZEROS
 10730        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10731                                    WS-SV-EPYTHRU
 10732     ELSE
 10733        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10734
 10735     IF WS-SV-EPYTHRU < PI-CPYFROM
 10736         MOVE ER-0508            TO EMI-ERROR
 10737         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10738
 10739     IF PI-PMTTYPE = '3'
 10740        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10741         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10742             MOVE ER-0477        TO EMI-ERROR
 10743             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10744         ELSE
 10745             NEXT SENTENCE
 10746     ELSE
 10747         IF WS-SV-EPYTHRU > WS-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 205
* EL156.cbl
 10748             MOVE ER-0557        TO EMI-ERROR
 10749             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10750
 10751     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10752         PI-PMTTYPE NOT = '3'
 10753         MOVE ER-0541        TO EMI-ERROR
 10754         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10755
 10756     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10757        (PI-PMTTYPE NOT = '3')
 10758         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10759             MOVE ER-0478        TO EMI-ERROR
 10760             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10761
 10762     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10763        (PI-PMTTYPE NOT = '4')
 10764         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10765             MOVE ER-0479        TO EMI-ERROR
 10766             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10767
 10768     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10769         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10770             MOVE ER-0545        TO EMI-ERROR
 10771             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10772
 10773     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10774         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10775             MOVE ER-0481        TO EMI-ERROR
 10776             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10777
 10778*    IF PI-COMPANY-ID = 'NCL'
 10779*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10780*           CM-AH-CRITICAL-PERIOD = +0
 10781*            MOVE ER-0844        TO  EMI-ERROR
 10782*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10783
 10784*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10785     if (cl-critical-period = zeros)
 10786        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10787          GO TO 1200-EDIT-FIND-TOLERANCES.
 10788
 10789     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10790     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10791     MOVE '1'        TO DC-OPTION-CODE.
 10792     MOVE +0         TO DC-ELAPSED-DAYS
 10793                        DC-ELAPSED-MONTHS.
 10794     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10795
 10796*    IF NO-CONVERSION-ERROR
 10797*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10798*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10799*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10800*           MOVE ER-0657 TO EMI-ERROR
 10801*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10802
 10803     GO TO 1200-EDIT-FIND-TOLERANCES.
 10804
 10805 1165-PAID-THRU-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 206
* EL156.cbl
 10806     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10807
 10808     IF EMI-MESSAGE-FORMATTED
 10809         MOVE -1                 TO EPYTHRUL
 10810         MOVE AL-UNBON           TO EPYTHRUA.
 10811
 10812 1165-EXIT.
 10813     EXIT.
 10814
 10815 1166-CHECK-ALL-TRLRS.
 10816
 10817     IF PI-PMTTYPE = '4'
 10818        GO TO 1166-TRLR-EXIT.
 10819
 10820     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10821
 10822     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10823        WS-SV-EPYFROM = LOW-VALUES
 10824          GO TO 1166-END-CHECK.
 10825
 10826
 10827* EXEC CICS HANDLE CONDITION
 10828*        ENDFILE   (1166-END-CHECK)
 10829*        NOTFND    (1166-END-CHECK)
 10830*    END-EXEC.
 10831*    MOVE '"$''I                  ! ) #00010410' TO DFHEIV0
 10832     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10834     MOVE X'2920233030303130343130' TO DFHEIV0(25:11)
 10835     CALL 'kxdfhei1' USING DFHEIV0
 10836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10837
 10838
 10839     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10840     MOVE +100                   TO TRLR-SEQ-NO.
 10841
 10842
 10843* EXEC CICS STARTBR
 10844*         DATASET    ('ELTRLR')
 10845*         RIDFLD     (ELTRLR-KEY)
 10846*         GTEQ
 10847*    END-EXEC.
 10848     MOVE 'ELTRLR' TO DFHEIV1
 10849     MOVE 0
 10850       TO DFHEIV11
 10851*    MOVE '&,         G          &   #00010418' TO DFHEIV0
 10852     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10853     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10854     MOVE X'2020233030303130343138' TO DFHEIV0(25:11)
 10855     CALL 'kxdfhei1' USING DFHEIV0,
 10856           DFHEIV1,
 10857           ELTRLR-KEY,
 10858           DFHEIV99,
 10859           DFHEIV11,
 10860           DFHEIV99
 10861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10862
 10863
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 207
* EL156.cbl
 10864     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10865
 10866 1166-READ-TRLR-NEXT.
 10867
 10868
 10869* EXEC CICS READNEXT
 10870*         DATASET    ('ELTRLR')
 10871*         RIDFLD     (ELTRLR-KEY)
 10872*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10873*    END-EXEC.
 10874     MOVE 'ELTRLR' TO DFHEIV1
 10875     MOVE 0
 10876       TO DFHEIV11
 10877*    MOVE '&.S                   )   #00010428' TO DFHEIV0
 10878     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10879     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10880     MOVE X'2020233030303130343238' TO DFHEIV0(25:11)
 10881     CALL 'kxdfhei1' USING DFHEIV0,
 10882           DFHEIV1,
 10883           DFHEIV20,
 10884           DFHEIV99,
 10885           ELTRLR-KEY,
 10886           DFHEIV99,
 10887           DFHEIV11,
 10888           DFHEIV99,
 10889           DFHEIV99
 10890     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10891         DFHEIV20
 10892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10893
 10894
 10895     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10896        TRLR-CARRIER  = MSTR-CARRIER  AND
 10897        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10898        TRLR-CERT-NO  = MSTR-CERT-NO
 10899          NEXT SENTENCE
 10900      ELSE
 10901          GO TO 1166-END-CHECK.
 10902
 10903* **  BYPASS ALL NON-PAYMENT TRAILERS
 10904
 10905     IF AT-TRAILER-TYPE = '2'
 10906        NEXT SENTENCE
 10907     ELSE
 10908        GO TO 1166-READ-TRLR-NEXT.
 10909
 10910* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10911
 10912     IF AT-PAYMENT-TYPE = '1' OR '2'
 10913        NEXT SENTENCE
 10914     ELSE
 10915        GO TO 1166-READ-TRLR-NEXT.
 10916
 10917* **  BYPASS ALL VOID PAYMENTS
 10918
 10919     IF AT-VOID-DT NOT = LOW-VALUES
 10920        GO TO 1166-READ-TRLR-NEXT.
 10921
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 208
* EL156.cbl
 10922     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10923        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10924          GO TO 1166-READ-TRLR-NEXT.
 10925
 10926     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10927         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10928            OR
 10929        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10930         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10931        NEXT SENTENCE
 10932     ELSE
 10933         IF CL-TOTAL-PAID-AMT > ZEROS
 10934             MOVE ER-0502            TO EMI-ERROR
 10935             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10936             MOVE -1                 TO EPYTHRUL
 10937             MOVE AL-UNBON           TO EPYTHRUA.
 10938
 10939     GO TO 1166-READ-TRLR-NEXT.
 10940
 10941 1166-END-CHECK.
 10942
 10943     IF WS-BROWSE-TRLR-SW = 'Y'
 10944
 10945* EXEC CICS ENDBR
 10946*            DATASET   ('ELTRLR')
 10947*       END-EXEC.
 10948     MOVE 'ELTRLR' TO DFHEIV1
 10949     MOVE 0
 10950       TO DFHEIV11
 10951*    MOVE '&2                    $   #00010483' TO DFHEIV0
 10952     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10953     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10954     MOVE X'2020233030303130343833' TO DFHEIV0(25:11)
 10955     CALL 'kxdfhei1' USING DFHEIV0,
 10956           DFHEIV1,
 10957           DFHEIV11,
 10958           DFHEIV99
 10959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10960
 10961
 10962     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10963
 10964 1166-TRLR-EXIT.
 10965     EXIT.
 10966
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 209
* EL156.cbl
 10968 1170-PAID-THRU-FATAL-ERROR.
 10969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10970
 10971     MOVE -1                     TO EPYTHRUL.
 10972     MOVE AL-UNBON               TO EPYTHRUA.
 10973
 10974 1200-EDIT-FIND-TOLERANCES.
 10975
 10976* EXEC CICS HANDLE CONDITION
 10977*        ENDFILE(1950-NOT-FOUND)
 10978*        NOTFND (1950-NOT-FOUND)
 10979*    END-EXEC.
 10980*    MOVE '"$''I                  ! * #00010500' TO DFHEIV0
 10981     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10983     MOVE X'2A20233030303130353030' TO DFHEIV0(25:11)
 10984     CALL 'kxdfhei1' USING DFHEIV0
 10985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10986
 10987
 10988     IF PI-PROCESSOR-ID = 'LGXX'
 10989        GO TO 1240-FIND-ACCT-TOLERANCES.
 10990
 10991     MOVE 'N'                    TO FOUND-TOL-SW.
 10992     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10993     MOVE '2'                    TO CNTL-REC-TYPE.
 10994     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10995     MOVE +0                     TO CNTL-SEQ-NO.
 10996     MOVE 'PROC'                 TO FILE-SWITCH.
 10997
 10998     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10999
 11000     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11001     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11002                                    PI-MAX-PMT-TOL.
 11003     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11004
 11005     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11006         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11007
 11008     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11009     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11010                                    PI-MAX-LF-PMT-TOL.
 11011
 11012     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11013         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11014
 11015     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11016                                    PI-MAX-EXP-PMT.
 11017
 11018 1240-FIND-ACCT-TOLERANCES.
 11019
 11020     IF WS-PMT-TOL NOT = +0
 11021         MOVE 'Y'                TO FOUND-TOL-SW.
 11022
 11023     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11024         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11025         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 210
* EL156.cbl
 11026         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11027         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11028         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11029         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11030     ELSE
 11031         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11032         MOVE PI-CARRIER             TO ACCT-CARRIER
 11033         MOVE PI-GROUPING            TO ACCT-GROUPING
 11034         MOVE PI-STATE               TO ACCT-STATE
 11035         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11036         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11037
 11038     MOVE 'ACCT'                 TO FILE-SWITCH.
 11039
 11040     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11041     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11042
 11043
 11044* EXEC CICS HANDLE CONDITION
 11045*         NOTFND   (1950-NOT-FOUND)
 11046*         ENDFILE  (1950-NOT-FOUND)
 11047*    END-EXEC.
 11048*    MOVE '"$I''                  ! + #00010560' TO DFHEIV0
 11049     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11051     MOVE X'2B20233030303130353630' TO DFHEIV0(25:11)
 11052     CALL 'kxdfhei1' USING DFHEIV0
 11053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11054
 11055
 11056
 11057* EXEC CICS STARTBR
 11058*        DATASET('ERACCT')
 11059*        RIDFLD (ERACCT-KEY)
 11060*        GTEQ
 11061*    END-EXEC.
 11062     MOVE 'ERACCT' TO DFHEIV1
 11063     MOVE 0
 11064       TO DFHEIV11
 11065*    MOVE '&,         G          &   #00010565' TO DFHEIV0
 11066     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11067     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11068     MOVE X'2020233030303130353635' TO DFHEIV0(25:11)
 11069     CALL 'kxdfhei1' USING DFHEIV0,
 11070           DFHEIV1,
 11071           ERACCT-KEY,
 11072           DFHEIV99,
 11073           DFHEIV11,
 11074           DFHEIV99
 11075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11076
 11077
 11078 1245-FIND-ACCT-TOLERANCES-LOOP.
 11079
 11080
 11081* EXEC CICS READNEXT
 11082*        DATASET('ERACCT')
 11083*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 211
* EL156.cbl
 11084*        RIDFLD (ERACCT-KEY)
 11085*    END-EXEC.
 11086     MOVE 'ERACCT' TO DFHEIV1
 11087     MOVE 0
 11088       TO DFHEIV11
 11089*    MOVE '&.S                   )   #00010573' TO DFHEIV0
 11090     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11091     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11092     MOVE X'2020233030303130353733' TO DFHEIV0(25:11)
 11093     CALL 'kxdfhei1' USING DFHEIV0,
 11094           DFHEIV1,
 11095           DFHEIV20,
 11096           DFHEIV99,
 11097           ERACCT-KEY,
 11098           DFHEIV99,
 11099           DFHEIV11,
 11100           DFHEIV99,
 11101           DFHEIV99
 11102     SET ADDRESS OF ACCOUNT-MASTER TO
 11103         DFHEIV20
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11105
 11106
 11107     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11108        IF WS-ERACCT-HOLD-RECORD = SPACES
 11109           GO TO 1950-NOT-FOUND
 11110        ELSE
 11111           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11112           GO TO 1250-CONTINUE.
 11113
 11114     IF ACCT-EXP-DT = HIGH-VALUES
 11115        NEXT SENTENCE
 11116     ELSE
 11117        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11118        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11119
 11120 1250-CONTINUE.
 11121
 11122     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11123
 11124     IF FOUND-TOL-SW = 'N'
 11125         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11126
 11127********* 1260-FIND-STATE-TOLERANCES.
 11128
 11129     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11130     MOVE PI-STATE               TO WS-ST-ACCESS.
 11131     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11132     MOVE '3'                    TO CNTL-REC-TYPE.
 11133     MOVE +0                     TO CNTL-SEQ-NO.
 11134     MOVE 'STAT'                 TO FILE-SWITCH.
 11135
 11136     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11137
 11138     IF WS-PMT-TOL = +0
 11139         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11140
 11141     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 212
* EL156.cbl
 11142     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11143     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11144     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11145     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11146
 11147****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11148****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11149     IF PI-PAYEE-TYPE <> 'B'
 11150           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11151     END-IF.
 11152
 11153     IF PI-PMTTYPE      = '2'  AND
 11154        PI-SPLIT-PMT-SW = 'Y'  AND
 11155        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11156          MOVE ER-3530                TO EMI-ERROR
 11157          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11158
 11159********* 1280-FIND-BENEFIT-TOLERANCES.
 11160
 11161     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11162        OR (PI-PMTTYPE = '5' OR '6')
 11163         GO TO 1300-FIND-CARR-TOLERANCES.
 11164
 11165     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11166     MOVE '4'                    TO CNTL-REC-TYPE.
 11167     MOVE +0                     TO CNTL-SEQ-NO.
 11168     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11169     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11170     MOVE 'BENE'                 TO FILE-SWITCH.
 11171
 11172     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11173
 11174     IF NO-BENEFIT-FOUND
 11175         GO TO 1950-NOT-FOUND.
 11176
 11177     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11178     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11179     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11180
 11181
 11182* EXEC CICS HANDLE CONDITION
 11183*        NOTFND(1950-NOT-FOUND)
 11184*    END-EXEC.
 11185*    MOVE '"$I                   ! , #00010653' TO DFHEIV0
 11186     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11188     MOVE X'2C20233030303130363533' TO DFHEIV0(25:11)
 11189     CALL 'kxdfhei1' USING DFHEIV0
 11190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11191
 11192
 11193 1300-FIND-CARR-TOLERANCES.
 11194     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11195     MOVE '6'                    TO CNTL-REC-TYPE.
 11196
 11197     IF CONTROL-IS-ACTUAL-CARRIER
 11198         MOVE PI-CARRIER               TO WS-CARR
 11199     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 213
* EL156.cbl
 11200         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11201
 11202     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11203     MOVE +0                     TO CNTL-SEQ-NO.
 11204     MOVE 'CARR'                 TO FILE-SWITCH.
 11205
 11206     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11207
 11208     IF WS-DAYS-TOL = +0
 11209         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11210
 11211     IF WS-PMT-TOL = +0
 11212         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11213
 11214     IF WS-MAX-DAYS-TOL = +0
 11215         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11216
 11217     IF WS-MAX-PMT-TOL = +0
 11218         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11219                                    PI-MAX-PMT-TOL.
 11220
 11221     IF WS-MAX-LF-PMT-TOL = +0
 11222        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11223                                    PI-MAX-LF-PMT-TOL.
 11224
 11225     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11226
 11227********* 1320-FIND-COMP-TOLERANCES.
 11228
 11229     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11230     MOVE '1'                    TO CNTL-REC-TYPE.
 11231     MOVE SPACES                 TO CNTL-ACCESS.
 11232     MOVE +0                     TO CNTL-SEQ-NO.
 11233     MOVE 'COMP'                 TO FILE-SWITCH.
 11234
 11235     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11236
 11237     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11238     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11239
 11240     IF WS-PMT-TOL NOT = +0
 11241        IF WS-TOL-SEVERITY NOT = ' '
 11242         GO TO 1360-EDIT-DAYS.
 11243
 11244     IF WS-PMT-TOL = +0
 11245         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11246
 11247     IF WS-TOL-SEVERITY = ' '
 11248         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11249
 11250 1360-EDIT-DAYS.
 11251     IF PI-PMTTYPE NOT = '4'
 11252        IF PI-EDAYS NEGATIVE OR
 11253           PI-EPYAMT NEGATIVE
 11254          MOVE ER-0513             TO EMI-ERROR
 11255          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11256          MOVE -1                  TO PMTTYPEL.
 11257
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 214
* EL156.cbl
 11258     IF PI-PMTTYPE = '5' OR '6'
 11259        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11260
 11261     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11262        IF PI-PMTTYPE = '4'
 11263          MOVE PI-EDAYS          TO PI-CDAYS.
 11264
 11265     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11266         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11267
 11268     IF PI-PMTTYPE = '4'
 11269        MOVE PI-EDAYS            TO PI-CDAYS
 11270        GO TO 1400-EDIT-PAYMENT.
 11271
 11272     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11273        GO TO 1500-EDIT-EXPENSES.
 11274
 11275*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11276*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11277*          CM-AH-BENEFIT-CD = '23'              AND
 11278*          CL-CERT-STATE    = '04'              AND
 11279*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11280*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11281*            GO TO 1362-CHECK-MAX-DAYS.
 11282
 11283     IF PI-EDAYS = ZEROS
 11284*        IF PI-COMPANY-ID = 'DMD'
 11285*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11286*            MOVE -1             TO DC-ELAPSED-DAYS
 11287*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11288*            MOVE '6'            TO DC-OPTION-CODE
 11289*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11290*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11291*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11292*            MOVE '1'            TO DC-OPTION-CODE
 11293*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11294*            IF NO-CONVERSION-ERROR
 11295*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11296*                                 + DC-ODD-DAYS-OVER
 11297*               MOVE 6           TO EDAYSL
 11298*               MOVE AL-UNNON    TO EDAYSA
 11299*            ELSE
 11300*                NEXT SENTENCE
 11301*       ELSE
 11302            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11303            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11304            MOVE '1'             TO DC-OPTION-CODE
 11305            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11306            IF NO-CONVERSION-ERROR
 11307                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11308                ADD 1                 TO PI-EDAYS
 11309                MOVE AL-UNNON         TO EDAYSA.
 11310
 11311*    IF PI-COMPANY-ID = 'DMD'
 11312*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11313*        MOVE -1                 TO DC-ELAPSED-DAYS
 11314*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11315*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 215
* EL156.cbl
 11316*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11317*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11318*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11319*        MOVE '1'                TO DC-OPTION-CODE
 11320*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11321*    ELSE
 11322         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11323         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11324         MOVE '1'                TO DC-OPTION-CODE.
 11325         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11326
 11327     IF NO-CONVERSION-ERROR
 11328        IF PI-COMPANY-ID = 'DMD'
 11329            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11330                             + DC-ODD-DAYS-OVER
 11331        ELSE
 11332            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11333            ADD 1                TO PI-CDAYS.
 11334
 11335     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11336        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11337        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11338
 11339     IF PI-EDAYS NOT NUMERIC
 11340         MOVE ER-0491            TO EMI-ERROR
 11341         GO TO 1370-DAYS-ERROR.
 11342
 11343     IF CL-NO-OF-PMTS-MADE = 0
 11344        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11345        AND CL-CERT-STATE = 'MI'
 11346        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11347            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11348     END-IF.
 11349
 11350 1362-CHECK-MAX-DAYS.
 11351
 11352     IF WS-MAX-DAYS-TOL = +999
 11353         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11354
 11355     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11356         IF PI-EDAYS = ZEROS
 11357             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11358         ELSE
 11359             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11360
 11361     IF WS-MAX-DAYS-TOL NOT = ZERO
 11362        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11363           PI-CDAYS > WS-MAX-DAYS-TOL
 11364             MOVE ER-0492          TO EMI-ERROR
 11365             GO TO 1370-DAYS-ERROR.
 11366
 11367 1365-SKIP-MAX-DAYS-EDIT.
 11368     IF PI-EDAYS = ZEROS
 11369        GO TO 1400-EDIT-PAYMENT.
 11370
 11371     IF WS-DAYS-TOL NOT = ZERO
 11372        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11373           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 216
* EL156.cbl
 11374                MOVE ER-0493     TO EMI-ERROR
 11375                GO TO 1370-DAYS-ERROR.
 11376
 11377     GO TO 1400-EDIT-PAYMENT.
 11378
 11379 1370-DAYS-ERROR.
 11380     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11381
 11382     IF EMI-MESSAGE-FORMATTED
 11383         MOVE -1                 TO EDAYSL
 11384         MOVE AL-UABON           TO EDAYSA.
 11385
 11386     GO TO 1400-EDIT-PAYMENT.
 11387
 11388 1380-EDIT-EXPENSE-PMT-AMT.
 11389     IF PI-PMTTYPE = '5' OR '6'
 11390         NEXT SENTENCE
 11391     ELSE
 11392         GO TO 1400-EDIT-PAYMENT.
 11393
 11394     IF WS-MAX-EXP-PMT NOT = ZEROS
 11395        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11396            MOVE ER-3529            TO EMI-ERROR
 11397            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11398
 11399     GO TO 1500-EDIT-EXPENSES.
 11400
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 217
* EL156.cbl
 11402
 11403 1390-CHECK-PAYMENT-DAYS.
 11404
 11405     IF PI-EDAYS = 0
 11406         MOVE PI-CDAYS TO WS-PD-DAYS
 11407     ELSE
 11408         MOVE PI-EDAYS TO WS-PD-DAYS
 11409     END-IF.
 11410
 11411     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11412         IF WS-PD-DAYS = 14
 11413            GO TO 1390-EXIT
 11414         END-IF
 11415     END-IF.
 11416
 11417     IF PI-COMPANY-ID = 'AHL'  AND
 11418        CM-AH-BENEFIT-CD = '1K'
 11419         IF WS-PD-DAYS = 14
 11420            GO TO 1390-EXIT
 11421         END-IF
 11422     END-IF.
 11423
 11424     IF WS-PD-DAYS < 30
 11425         MOVE ER-3549              TO EMI-ERROR
 11426         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11427     END-IF.
 11428
 11429 1390-EXIT.
 11430      EXIT.
 11431
 11432 1400-EDIT-PAYMENT.
 11433*    IF PI-COMPANY-ID = 'DMD'
 11434*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11435*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11436
 11437     IF PI-COMPANY-ID = 'DCC'
 11438        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11439        MOVE PI-CARRIER          TO ACCT-CARRIER
 11440        MOVE PI-GROUPING         TO ACCT-GROUPING
 11441        MOVE PI-STATE            TO ACCT-STATE
 11442        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11443        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11444        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11445        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11446
 11447
 11448* EXEC CICS READ
 11449*          DATASET ('ERACCT')
 11450*          RIDFLD  (ERACCT-KEY)
 11451*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11452*          GTEQ
 11453*          resp    (WS-RESPONSE)
 11454*       END-EXEC
 11455     MOVE 'ERACCT' TO DFHEIV1
 11456*    MOVE '&"S        G          (  N#00010911' TO DFHEIV0
 11457     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11459     MOVE X'204E233030303130393131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 218
* EL156.cbl
 11460     CALL 'kxdfhei1' USING DFHEIV0,
 11461           DFHEIV1,
 11462           DFHEIV20,
 11463           DFHEIV99,
 11464           ERACCT-KEY,
 11465           DFHEIV99,
 11466           DFHEIV99,
 11467           DFHEIV99
 11468     SET ADDRESS OF ACCOUNT-MASTER TO
 11469         DFHEIV20
 11470     MOVE EIBRESP  TO WS-RESPONSE
 11471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11472        IF WS-RESP-NORMAL
 11473           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11474           and pi-cert-eff-dt < am-expiration-dt
 11475           and pi-cert-eff-dt >= am-effective-dt
 11476           move am-dcc-product-code to pi-dcc-product-code
 11477        else
 11478           move spaces           to pi-dcc-product-code
 11479        end-if
 11480        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11481           MOVE ' '              TO WS-PDEF-RECORD-SW
 11482           PERFORM 0900-GET-DDF-FACTORS
 11483                                 THRU 0900-EXIT
 11484           IF PDEF-FOUND
 11485              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11486                 (P1 > +8)
 11487                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11488              END-PERFORM
 11489              IF P1 < +9
 11490                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11491                    MOVE PD-MAX-AMT (P1)
 11492                                 TO CM-AH-BENEFIT-AMT
 11493                 end-if
 11494              END-IF
 11495           END-IF
 11496        end-if
 11497     END-IF
 11498     IF PI-PMTTYPE NOT = '4'
 11499        GO TO 1405-CALC-PAYMENT.
 11500
 11501     IF PI-EDAYS NOT NUMERIC
 11502         MOVE PI-EPYAMT           TO PI-CPYAMT
 11503         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11504         GO TO 1430-CHECK-AH-TOLERANCE.
 11505
 11506*    IF PI-COMPANY-ID = 'FIA'
 11507*       IF CERT-ACCOUNT = '0000011043'
 11508*        COMPUTE PI-DAILY-RATE ROUNDED =
 11509*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11510*        COMPUTE PI-CPYAMT ROUNDED =
 11511*                          PI-DAILY-RATE * PI-EDAYS
 11512*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11513*        GO TO 1430-CHECK-AH-TOLERANCE.
 11514
 11515     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11516         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11517         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 219
* EL156.cbl
 11518         GO TO 1420-CHECK-AIG-BENEFIT.
 11519
 11520     IF WS-CALC-METHOD = '2' OR  '5'
 11521         COMPUTE PI-DAILY-RATE ROUNDED =
 11522                        (CM-AH-BENEFIT-AMT * 12) / 365
 11523         COMPUTE PI-CPYAMT ROUNDED =
 11524                           PI-DAILY-RATE * PI-EDAYS
 11525        GO TO 1420-CHECK-AIG-BENEFIT.
 11526
 11527     IF WS-CALC-METHOD = '3'
 11528         COMPUTE PI-DAILY-RATE =
 11529                         (CM-AH-BENEFIT-AMT * 12) / 365
 11530         COMPUTE PI-CPYAMT ROUNDED =
 11531                           PI-DAILY-RATE * PI-EDAYS
 11532        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 220
* EL156.cbl
 11534*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11535
 11536****************************************************************
 11537****************************************************************
 11538*                  CALCULATED FROM      PAYMENT      PAYMENT
 11539*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11540* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11541*1-01-83  1-15-83    0    15     15        15           15
 11542*1-01-83  1-30-83    0    30     30        30           30
 11543*1-01-83  1-31-83    1     0     31        30           30
 11544*1-01-83  2-01-83    1     1     32        31           31
 11545*1-01-83  2-15-83    1    15     46        45           45
 11546*1-01-83  2-28-83    2     0     59        60           60
 11547*1-01-83  3-01-83    2     1     60        61           61
 11548*1-01-83  3-31-83    3     0     90        90           90
 11549*1-15-83  1-31-83    0    17     17        17           16
 11550*1-15-83  2-01-83    0    18     18        18           17
 11551*1-15-83  2-28-83    1    14     45        44           46
 11552*1-21-83  3-09-83    1    20     48        50           49
 11553*2-05-83  3-06-83    1     2     30        32           32
 11554*2-05-83  3-23-83    1    19     47        49           49
 11555*2-15-83  2-28-83    0    14     14        14           16
 11556*2-15-83  3-01-83    0    15     15        15           17
 11557*2-21-83  3-19-83    0    27     27        27           29
 11558*2-21-83  3-20-83    1     0     28        30           30
 11559*2-21-83  4-10-83    1    18     49        30           50
 11560*2-21-83  5-19-83    2    27     88        87           89
 11561*2-21-83  5-22-83    3     2     91        92           92
 11562*3-21-83  5-19-83    1    30     60        60           59
 11563****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 221
* EL156.cbl
 11565 1405-CALC-PAYMENT.
 11566     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11567     MOVE ' '                    TO DC-OPTION-CODE.
 11568     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11569     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11570     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11571
 11572     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11573     MOVE ' '                    TO DC-OPTION-CODE.
 11574     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11575     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11576     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11577
 11578     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11579     MOVE -1                     TO DC-ELAPSED-DAYS.
 11580     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11581     MOVE '6'                    TO DC-OPTION-CODE.
 11582     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11583     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11584
 11585     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11586     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11587     MOVE '1'                    TO DC-OPTION-CODE.
 11588     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11589
 11590     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11591     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11592     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11593
 11594******************************************************************
 11595*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11596*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11597*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11598******************************************************************
 11599
 11600     IF WS-CALC-METHOD = '1'           AND
 11601        DC-ELAPSED-MONTHS > ZERO AND
 11602        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11603        WDF-DAY > WDT-DAY
 11604          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11605          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11606          MOVE -1                  TO DC-ELAPSED-MONTHS
 11607          MOVE '6'                 TO DC-OPTION-CODE
 11608          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11609          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11610          COMPUTE WS-SAVE-ODD-DAYS =
 11611          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11612          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11613
 11614     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11615     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11616     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11617
 11618     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11619     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11620
 11621*    IF PI-COMPANY-ID = 'FIA'
 11622*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 222
* EL156.cbl
 11623*        COMPUTE PI-DAILY-RATE ROUNDED =
 11624*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11625*        COMPUTE PI-CPYAMT ROUNDED =
 11626*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11627*        GO TO 1420-CHECK-AIG-BENEFIT.
 11628
 11629*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11630*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11631*          CM-AH-BENEFIT-CD = '23'               AND
 11632*          CL-CERT-STATE    = '04'               AND
 11633*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11634*            COMPUTE WS-DAILY-RATE ROUNDED =
 11635*                               CM-AH-BENEFIT-AMT / 30
 11636*            COMPUTE PI-CPYAMT ROUNDED =
 11637*                               (WS-DAILY-RATE * PI-CDAYS)
 11638*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11639*            GO TO 1420-CHECK-AIG-BENEFIT.
 11640
 11641     IF WS-CALC-METHOD = '1'
 11642         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11643         COMPUTE PI-CPYAMT ROUNDED =
 11644             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11645             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11646         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11647         GO TO 1420-CHECK-AIG-BENEFIT.
 11648
 11649     IF WS-CALC-METHOD = '2'
 11650         COMPUTE PI-DAILY-RATE ROUNDED =
 11651                          (CM-AH-BENEFIT-AMT * 12) / 365
 11652         COMPUTE PI-CPYAMT ROUNDED =
 11653             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11654             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11655         GO TO 1420-CHECK-AIG-BENEFIT.
 11656
 11657     IF WS-CALC-METHOD = '4'
 11658         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11659         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11660         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11661         COMPUTE PI-CPYAMT ROUNDED =
 11662                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11663         GO TO 1420-CHECK-AIG-BENEFIT.
 11664
 11665     IF WS-CALC-METHOD = '5'
 11666         COMPUTE PI-DAILY-RATE ROUNDED =
 11667                            (CM-AH-BENEFIT-AMT * 12) / 365
 11668         COMPUTE PI-CPYAMT ROUNDED =
 11669                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11670         GO TO 1420-CHECK-AIG-BENEFIT.
 11671
 11672     IF WS-CALC-METHOD NOT = '3'
 11673        GO TO 1410-CHECK-PAYMENT.
 11674
 11675******   CALCULATION METHOD  3  ROUTINE
 11676     COMPUTE PI-DAILY-RATE =
 11677                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11678
 11679******CHECK TO SEE IF WITHIN SAME MONTH
 11680     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 223
* EL156.cbl
 11681        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11682                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11683         GO TO 1420-CHECK-AIG-BENEFIT.
 11684
 11685******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11686     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11687             SAVE-ODD-DAYS-OVER = ZEROS
 11688      COMPUTE PI-CPYAMT  ROUNDED =
 11689                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11690      GO TO 1420-CHECK-AIG-BENEFIT.
 11691
 11692******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11693******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11694     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11695        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11696        IF WDF-MONTH > 12
 11697           ADD 1                 TO WDF-YEAR
 11698           SUBTRACT 12         FROM WDF-MONTH.
 11699
 11700******CONVERT THE NEW FROM MONTH TO BINARY
 11701     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11702        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11703        MOVE '4'              TO DC-OPTION-CODE
 11704        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11705        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11706
 11707     IF WDF-MONTH = WDT-MONTH AND
 11708        WDF-YEAR  = WDT-YEAR
 11709          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11710                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11711                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11712        ELSE
 11713          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11714          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11715          COMPUTE PI-CPYAMT ROUNDED =
 11716       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11717       +
 11718       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11719       +
 11720       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11721
 11722     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 224
* EL156.cbl
 11724 1410-CHECK-PAYMENT.
 11725******PAYMENT OPTION 6
 11726******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11727     IF SAVE-ELAPSED-MONTHS > ZERO
 11728        IF SAVE-ODD-DAYS-OVER = ZEROS
 11729           GO TO 1412-CHECK-TO-DAY
 11730        ELSE
 11731           IF WDF-DAY > WDT-DAY
 11732              IF WDF-MONTH = 02
 11733                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11734                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11735                  GO TO 1412-CHECK-TO-DAY
 11736              ELSE
 11737                  IF FROM-DAYS-IN-MONTH = 31
 11738                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11739                     GO TO 1412-CHECK-TO-DAY
 11740                  ELSE
 11741                     GO TO 1412-CHECK-TO-DAY
 11742           ELSE
 11743               GO TO 1412-CHECK-TO-DAY.
 11744
 11745     IF WDF-MONTH NOT = WDT-MONTH
 11746        IF WDF-MONTH = 02
 11747           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11748           IF WDF-DAY = 29
 11749              ADD 1              TO SAVE-ODD-DAYS-OVER
 11750           ELSE
 11751              ADD 2              TO SAVE-ODD-DAYS-OVER
 11752        ELSE
 11753           IF FROM-DAYS-IN-MONTH = 31
 11754              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11755
 11756 1412-CHECK-TO-DAY.
 11757        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11758           IF WDT-DAY = 28
 11759              ADD 2              TO SAVE-ODD-DAYS-OVER
 11760           ELSE
 11761              IF WDT-DAY = 29
 11762                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11763              ELSE
 11764                 NEXT SENTENCE
 11765        ELSE
 11766           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11767              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11768
 11769     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11770     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11771     COMPUTE PI-CPYAMT ROUNDED =
 11772         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11773         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11774
 11775     GO TO 1420-CHECK-AIG-BENEFIT.
 11776
 11777 1415-CHECK-LEAP-YEAR.
 11778     IF FROM-DAYS-IN-MONTH = 29
 11779        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11780
 11781 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 225
* EL156.cbl
 11782     EXIT.
 11783
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 226
* EL156.cbl
 11785 1420-CHECK-AIG-BENEFIT.
 11786
 11787     IF WS-SPECIAL-CALC-CD = 'Q'
 11788         GO TO 1425-CHECK-WHOLE-MONTH.
 11789
 11790*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11791*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11792*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11793*       (PI-PMTTYPE = '1' OR '2')
 11794*        NEXT SENTENCE
 11795*    ELSE
 11796         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11797         GO TO 1430-CHECK-AH-TOLERANCE.
 11798
 11799******************AIG LOGIC STARTS**********************
 11800*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11801*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11802*    MOVE ER-3533      TO EMI-ERROR.
 11803*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11804*    GO TO 1430-CHECK-AH-TOLERANCE.
 11805******************AIG LOGIC ENDS************************
 11806
 11807 1425-CHECK-WHOLE-MONTH.
 11808******************************************************************
 11809****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11810****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11811****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11812****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11813****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11814****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11815****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11816****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11817****          PAID * MONTHLY BENEFIT.                         ****
 11818******************************************************************
 11819
 11820     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11821
 11822     IF CL-NO-OF-PMTS-MADE > +0
 11823         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11824
 11825     IF PI-CDAYS < WS-BEN-DAYS
 11826         GO TO 1430-CHECK-AH-TOLERANCE.
 11827
 11828     IF PI-CDAYS = WS-BEN-DAYS
 11829         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11830         GO TO 1430-CHECK-AH-TOLERANCE.
 11831
 11832*    IF PI-COMPANY-ID = 'ACM'
 11833*       NEXT SENTENCE
 11834*    ELSE
 11835        GO TO 1425-NOT-ACM-W15C.
 11836
 11837*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11838*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11839*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11840*    MOVE '6'                    TO  DC-OPTION-CODE.
 11841*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11842*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 227
* EL156.cbl
 11843*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11844*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11845*       MOVE '1'                 TO  DC-OPTION-CODE
 11846*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11847*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11848*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11849*       IF NO-CONVERSION-ERROR
 11850*          IF (DC-ELAPSED-MONTHS > +0) OR
 11851*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11852*             NEXT SENTENCE
 11853*          ELSE
 11854*             MOVE +0            TO  PI-CPYAMT
 11855*             MOVE ER-0846       TO  EMI-ERROR
 11856*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11857*             GO TO 1430-CHECK-AH-TOLERANCE
 11858*       ELSE
 11859*           MOVE ER-0846         TO  EMI-ERROR
 11860*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11861*           GO TO 1430-CHECK-AH-TOLERANCE.
 11862*
 11863*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11864*       ADD +1 TO DC-ELAPSED-MONTHS.
 11865*
 11866*    COMPUTE PI-CPYAMT ROUNDED =
 11867*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11868*
 11869*    GO TO 1430-CHECK-AH-TOLERANCE.
 11870
 11871 1425-NOT-ACM-W15C.
 11872
 11873     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11874     MOVE '6'                        TO  DC-OPTION-CODE.
 11875     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11876     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11877
 11878     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11879     IF NO-CONVERSION-ERROR
 11880         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11881     ELSE
 11882         MOVE ER-0846                TO  EMI-ERROR
 11883         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11884         GO TO 1430-CHECK-AH-TOLERANCE.
 11885
 11886     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11887     MOVE '1'                        TO  DC-OPTION-CODE.
 11888     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11889     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11890     IF NO-CONVERSION-ERROR
 11891         IF DC-ODD-DAYS-OVER = +0
 11892             NEXT SENTENCE
 11893         ELSE
 11894             MOVE ER-0846            TO  EMI-ERROR
 11895             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11896             GO TO 1430-CHECK-AH-TOLERANCE
 11897     ELSE
 11898         MOVE ER-0846                TO  EMI-ERROR
 11899         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11900         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 228
* EL156.cbl
 11901
 11902     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11903         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11904
 11905     GO TO 1430-CHECK-AH-TOLERANCE.
 11906
 11907 1425-CONT-WHOLE-MONTH-PMTS.
 11908******************************************************************
 11909****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11910****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11911****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11912******************************************************************
 11913
 11914     IF PI-COMPANY-ID = 'ACM'
 11915        NEXT SENTENCE
 11916     ELSE
 11917        IF DC-ODD-DAYS-OVER = +0
 11918            NEXT SENTENCE
 11919        ELSE
 11920            MOVE ER-0845            TO  EMI-ERROR
 11921            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11922            GO TO 1430-CHECK-AH-TOLERANCE.
 11923
 11924     COMPUTE PI-CPYAMT ROUNDED =
 11925                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11926
 11927 1430-CHECK-AH-TOLERANCE.
 11928     IF PI-PMT-APPR-SW = 'G'
 11929         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11930
 11931*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11932*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11933*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11934*
 11935*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11936*      IF WDF-MONTH = 02
 11937*        IF SAVE-ELAPSED-MONTHS = 0
 11938*          NEXT SENTENCE
 11939*        ELSE
 11940*          IF SAVE-ODD-DAYS-OVER > 0
 11941*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11942*            COMPUTE WS-PMT-MOS ROUNDED =
 11943*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11944*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11945*                                     WS-PMT-MOS
 11946*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11947*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11948*          ELSE
 11949*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11950*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11951*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11952*                                     WS-PMT-MOS.
 11953
 11954     IF WS-MAX-PMT-TOL NOT = ZERO
 11955        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11956           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11957            MOVE ER-0494         TO  EMI-ERROR
 11958            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 229
* EL156.cbl
 11959            GO TO 1500-EDIT-EXPENSES.
 11960
 11961 1430-CONT-CHECK-AH-TOLERANCE.
 11962
 11963     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11964        GO TO 1500-EDIT-EXPENSES.
 11965
 11966     IF CM-O-B-COVERAGE
 11967        GO TO 1500-EDIT-EXPENSES.
 11968
 11969     IF PI-COMPANY-ID = 'NCL'
 11970       IF FOUND-TOL-SW = 'Y'
 11971         IF WS-PMT-TOL NOT = ZERO
 11972           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11973              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11974                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11975                  IF WS-NCL-PMT-OPTION = SPACES
 11976                      MOVE ER-0699 TO EMI-ERROR
 11977                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11978                  ELSE
 11979                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11980                      NEXT SENTENCE
 11981                  ELSE
 11982                  IF NOT WS-VALID-NCL-OPTION
 11983                      MOVE ER-0699 TO EMI-ERROR
 11984                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11985
 11986     if pi-company-id = 'DCC'
 11987        and pdef-found
 11988        and pi-cpyamt < pi-epyamt
 11989           move er-1657          to emi-error
 11990           perform 1490-payment-error
 11991                                 thru 1490-exit
 11992     else
 11993        IF WS-PMT-TOL NOT = ZERO
 11994           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 11995              or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11996              MOVE ER-0495       TO EMI-ERROR
 11997              PERFORM 1490-PAYMENT-ERROR
 11998                                 THRU 1490-EXIT
 11999           end-if
 12000        end-if
 12001     end-if
 12002
 12003     GO TO 1500-EDIT-EXPENSES.
 12004
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 230
* EL156.cbl
 12006 1440-COMPUTE-LIFE-REMAINING.
 12007
 12008     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12009        IF PI-PMTTYPE = '4'
 12010          MOVE PI-EPYAMT TO PI-CPYAMT
 12011          GO TO 1460-TEST-TYPE.
 12012
 12013     IF WS-LF-COVERAGE-TYPE = 'L'
 12014        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12015                          - CL-TOTAL-PAID-AMT
 12016        GO TO 1450-CHECK-MAX.
 12017
 12018     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12019        PI-LF-COVERAGE-TYPE = 'P'
 12020          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12021                              CM-LF-ITD-DEATH-AMT
 12022          GO TO 1450-CHECK-MAX.
 12023
 12024     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12025     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12026     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12027     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12028     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12029     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12030     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12031     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12032     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12033
 12034     PERFORM 9800-LINK-REM-TERM.
 12035
 12036     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12037     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12038     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12039     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12040     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12041     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12042     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12043     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12044     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12045     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12046     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12047     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12048     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12049     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12050     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12051     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12052     IF PI-COMPANY-ID = 'DCC'
 12053        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12054        MOVE PI-CARRIER          TO ACCT-CARRIER
 12055        MOVE PI-GROUPING         TO ACCT-GROUPING
 12056        MOVE PI-STATE            TO ACCT-STATE
 12057        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12058        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12059        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12060        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12061
 12062
 12063* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 231
* EL156.cbl
 12064*          DATASET ('ERACCT')
 12065*          RIDFLD  (ERACCT-KEY)
 12066*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12067*          GTEQ
 12068*          resp    (WS-RESPONSE)
 12069*       END-EXEC
 12070     MOVE 'ERACCT' TO DFHEIV1
 12071*    MOVE '&"S        G          (  N#00011508' TO DFHEIV0
 12072     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12073     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12074     MOVE X'204E233030303131353038' TO DFHEIV0(25:11)
 12075     CALL 'kxdfhei1' USING DFHEIV0,
 12076           DFHEIV1,
 12077           DFHEIV20,
 12078           DFHEIV99,
 12079           ERACCT-KEY,
 12080           DFHEIV99,
 12081           DFHEIV99,
 12082           DFHEIV99
 12083     SET ADDRESS OF ACCOUNT-MASTER TO
 12084         DFHEIV20
 12085     MOVE EIBRESP  TO WS-RESPONSE
 12086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12087        IF WS-RESP-NORMAL
 12088           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12089           and (pi-cert-eff-dt < am-expiration-dt)
 12090           and (pi-cert-eff-dt >= am-effective-dt)
 12091           move am-dcc-product-code to pi-dcc-product-code
 12092        else
 12093           move spaces           to pi-dcc-product-code
 12094        end-if
 12095        if pi-dcc-product-code not = spaces
 12096           MOVE ' '              TO WS-PDEF-RECORD-SW
 12097           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12098           PERFORM 0900-GET-DDF-FACTORS
 12099                                 THRU 0900-EXIT
 12100           IF PDEF-FOUND
 12101              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12102                 (P1 > +8)
 12103                 OR (PD-PROD-CODE (P1) = 'L')
 12104              END-PERFORM
 12105              IF P1 < +9
 12106                 MOVE PD-MAX-AMT (P1)
 12107                                 TO CP-R-MAX-TOT-BEN
 12108              END-IF
 12109           END-IF
 12110        end-if
 12111     END-IF
 12112
 12113* EXEC CICS LINK
 12114*       PROGRAM  (LINK-REMAMT)
 12115*       COMMAREA (CALCULATION-PASS-AREA)
 12116*       LENGTH   (CP-COMM-LENGTH)
 12117*    END-EXEC.
 12118*    MOVE '."C                   (   #00011540' TO DFHEIV0
 12119     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12121     MOVE X'2020233030303131353430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 232
* EL156.cbl
 12122     CALL 'kxdfhei1' USING DFHEIV0,
 12123           LINK-REMAMT,
 12124           CALCULATION-PASS-AREA,
 12125           CP-COMM-LENGTH,
 12126           DFHEIV99,
 12127           DFHEIV99,
 12128           DFHEIV99,
 12129           DFHEIV99
 12130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12131
 12132
 12133     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12134
 12135     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12136     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12137
 12138     IF PI-COMPANY-ID = 'BOA' AND
 12139        PI-PMTTYPE    = '2'   AND
 12140        PI-OFFLINE    = 'N'
 12141           GO TO 1441-COMPUTE-BOA-INTEREST.
 12142
 12143     IF PI-COMPANY-ID = 'NCL' AND
 12144        PI-PMTTYPE    = '2'   AND
 12145        PI-OFFLINE    = 'N'
 12146          GO TO 1442-COMPUTE-NCL-INTEREST
 12147       ELSE
 12148          GO TO 1445-CONTINUE.
 12149
 12150 1441-COMPUTE-BOA-INTEREST.
 12151     MOVE +0             TO WS-CALC-INT.
 12152
 12153     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12154     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12155     MOVE +0             TO DC-ELAPSED-MONTHS
 12156                            DC-ELAPSED-DAYS.
 12157     MOVE '1'            TO DC-OPTION-CODE.
 12158     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12159     IF NO-CONVERSION-ERROR
 12160         NEXT SENTENCE
 12161     ELSE
 12162         GO TO 1445-CONTINUE.
 12163
 12164     IF (PI-INT-RATE NOT > ZEROS)  AND
 12165        (DC-ELAPSED-DAYS > +30)
 12166         MOVE ER-3531            TO EMI-ERROR
 12167         MOVE -1                 TO PINTL
 12168         MOVE AL-UNBON           TO PINTA
 12169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12170
 12171     IF PI-EPYAMT NOT > ZEROS
 12172         GO TO 1445-CONTINUE.
 12173
 12174     IF (PI-INT-RATE NOT > ZEROS)  OR
 12175        (DC-ELAPSED-DAYS NOT > +30)
 12176         MOVE PI-EPYAMT TO PI-CPYAMT
 12177         GO TO 1441-FORMAT-NOTE.
 12178
 12179     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 233
* EL156.cbl
 12180                                 *  PI-INT-RATE
 12181                                 *  DC-ELAPSED-DAYS
 12182                                 /  365
 12183                                 /  100.
 12184
 12185     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12186
 12187 1441-FORMAT-NOTE.
 12188
 12189     MOVE SPACES        TO WS-BOANOTE1.
 12190     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12191     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12192     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12193     MOVE AL-UANON      TO NOTE1A.
 12194
 12195     IF WS-CALC-INT > ZEROS
 12196         MOVE SPACES        TO WS-BOANOTE2
 12197         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12198         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12199         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12200         MOVE AL-UANON      TO NOTE2A.
 12201
 12202     GO TO 1445-CONTINUE.
 12203
 12204 1442-COMPUTE-NCL-INTEREST.
 12205     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12206     MOVE PI-STATE               TO WS-ST-ACCESS.
 12207     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12208     MOVE '3'                    TO CNTL-REC-TYPE.
 12209     MOVE +0                     TO CNTL-SEQ-NO.
 12210     MOVE 'STAT'                 TO FILE-SWITCH.
 12211
 12212     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12213
 12214     MOVE +0                 TO WS-CALC-INT.
 12215
 12216     IF ST-STAT-FROM-INCURRED
 12217         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12218       ELSE
 12219     IF ST-STAT-FROM-REPORTED
 12220         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12221       ELSE
 12222         GO TO 1445-CONTINUE.
 12223
 12224     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12225     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12226     MOVE +0                 TO DC-ELAPSED-MONTHS
 12227                                DC-ELAPSED-DAYS.
 12228     MOVE '1'                TO DC-OPTION-CODE.
 12229     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12230     IF NO-CONVERSION-ERROR
 12231         NEXT SENTENCE
 12232     ELSE
 12233         GO TO 1445-CONTINUE.
 12234
 12235     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12236        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12237         GO TO 1445-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 234
* EL156.cbl
 12238
 12239     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12240                                 *  CF-ST-STAT-INTEREST.
 12241
 12242     MOVE SPACES              TO WS-NCLNOTE1.
 12243     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12244     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12245     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12246                                 PI-PMTNOTE1
 12247                                 NOTE1I.
 12248     MOVE AL-UANON            TO NOTE1A.
 12249
 12250     IF WS-CALC-INT > ZEROS
 12251         MOVE SPACES          TO WS-NCLNOTE2
 12252         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12253         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12254         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12255                                 PI-PMTNOTE2
 12256                                 NOTE2I
 12257         MOVE AL-UANON        TO NOTE2A.
 12258
 12259     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12260
 12261 1445-CONTINUE.
 12262
 12263     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12264        GO TO 1460-TEST-TYPE.
 12265
 12266     IF CM-O-B-COVERAGE
 12267        GO TO 1460-TEST-TYPE.
 12268
 12269     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12270         GO TO 1450-CHECK-MAX.
 12271
 12272     if pi-company-id = 'DCC'
 12273        and pdef-found
 12274        and pi-epyamt > pd-max-amt (p1)
 12275        move er-1657             to emi-error
 12276        perform 1490-payment-error
 12277                                 thru 1490-exit
 12278        go to 1460-test-type
 12279     else
 12280        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12281           > PI-EPYAMT)
 12282                         OR
 12283           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12284           < PI-EPYAMT)
 12285           MOVE ER-0594          TO EMI-ERROR
 12286           PERFORM 1490-PAYMENT-ERROR
 12287                                 THRU 1490-EXIT
 12288           GO TO 1460-TEST-TYPE
 12289        end-if
 12290     end-if
 12291     .
 12292 1450-CHECK-MAX.
 12293
 12294     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12295        PI-LF-COVERAGE-TYPE = 'P'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 235
* EL156.cbl
 12296         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12297                                   CM-LF-ITD-DEATH-AMT
 12298     ELSE
 12299         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12300                                   CL-TOTAL-PAID-AMT.
 12301
 12302     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12303          MOVE ER-0543           TO EMI-ERROR
 12304          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12305
 12306 1460-TEST-TYPE.
 12307
 12308     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12309        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12310           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12311                                   CM-LF-ALT-BENEFIT-AMT -
 12312                                   CL-TOTAL-PAID-AMT
 12313           IF PI-EPYAMT > WS-LF-BEN-AMT
 12314               MOVE ER-0543      TO EMI-ERROR
 12315               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12316           END-IF
 12317        END-IF
 12318     END-IF
 12319
 12320     IF PI-PMT-APPR-SW = 'G'
 12321       NEXT SENTENCE
 12322     ELSE
 12323       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12324         IF PI-EPYAMT = ZERO
 12325             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12326                 MOVE ER-0494    TO  EMI-ERROR
 12327                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12328                 GO TO 1500-EDIT-EXPENSES
 12329             ELSE
 12330                 NEXT SENTENCE
 12331         ELSE
 12332             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12333                 MOVE ER-0494    TO  EMI-ERROR
 12334                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12335                 GO TO 1500-EDIT-EXPENSES.
 12336
 12337     IF PI-PMTTYPE NOT = '2' OR
 12338        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12339         GO TO 1500-EDIT-EXPENSES.
 12340
 12341     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12342     MOVE ER-0526                TO EMI-ERROR.
 12343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12344
 12345     IF EMI-ERROR-NUMBER (1) = '0526'
 12346        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12347
 12348     IF EMI-ERROR-NUMBER (2) = '0526'
 12349        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12350
 12351     GO TO 1500-EDIT-EXPENSES.
 12352
 12353 1490-PAYMENT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 236
* EL156.cbl
 12354     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12355
 12356     IF EMI-MESSAGE-FORMATTED
 12357         MOVE -1                 TO EPYAMTL
 12358         MOVE AL-UNBON           TO EPYAMTA.
 12359
 12360 1490-EXIT.
 12361      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 237
* EL156.cbl
 12363 1500-EDIT-EXPENSES.
 12364     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12365         GO TO 1500-SKIP-ERROR-0556.
 12366
 12367 1500-CONTINUE-ON.
 12368
 12369     IF CM-O-B-COVERAGE
 12370        MOVE ER-0556             TO EMI-ERROR
 12371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12372
 12373 1500-SKIP-ERROR-0556.
 12374     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12375        IF PI-EEXPENS NOT = ZEROS
 12376           MOVE ER-0524          TO EMI-ERROR
 12377           GO TO 1590-EXPENSE-ERROR
 12378        ELSE
 12379           GO TO 1600-EDIT-RESERVES.
 12380
 12381     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12382     MOVE '6'                    TO CNTL-REC-TYPE.
 12383
 12384     IF CONTROL-IS-ACTUAL-CARRIER
 12385         MOVE PI-CARRIER         TO WS-CARR
 12386     ELSE
 12387         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12388
 12389     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12390     MOVE +0                     TO CNTL-SEQ-NO.
 12391     MOVE 'CARR'                 TO FILE-SWITCH.
 12392
 12393     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12394
 12395     IF EXPENSE-CALC-MANUAL
 12396        GO TO 1600-EDIT-RESERVES.
 12397
 12398     IF DOLLARS-PER-PMT
 12399        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12400        GO TO 1600-EDIT-RESERVES.
 12401
 12402     IF DOLLARS-PER-MONTH AND
 12403        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12404       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12405       GO TO 1600-EDIT-RESERVES.
 12406
 12407     IF PERCENT-OF-PAYMENT
 12408        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12409
 12410     GO TO 1600-EDIT-RESERVES.
 12411
 12412 1590-EXPENSE-ERROR.
 12413     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12414
 12415     IF EMI-MESSAGE-FORMATTED
 12416        MOVE -1                  TO EEXPENSL
 12417        MOVE AL-UNBON            TO EEXPENSA.
 12418
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 238
* EL156.cbl
 12420 1600-EDIT-RESERVES.
 12421     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12422        IF PI-ERESV = ZEROS
 12423           GO TO 1700-EDIT-EXPENSE-TYPE
 12424        ELSE
 12425           MOVE ER-0525          TO EMI-ERROR
 12426           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12427           GO TO 1700-EDIT-EXPENSE-TYPE.
 12428
 12429     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12430     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12431     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12432
 12433     IF NOT AT-MANUAL-RESERVES-USED
 12434        IF PI-ERESV NOT = ZEROS
 12435           MOVE ER-0518          TO EMI-ERROR
 12436           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12437
 12438     IF AT-MANUAL-RESERVES-USED
 12439        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12440        GO TO 1700-EDIT-EXPENSE-TYPE.
 12441
 12442     IF AT-FUTURE-RESERVES-USED
 12443        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12444
 12445     IF AT-FUTURE-RESERVES-USED
 12446        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12447
 12448     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12449        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12450
 12451     IF AT-IBNR-RESERVES-USED
 12452        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12453
 12454     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12455     GO TO 1700-EDIT-EXPENSE-TYPE.
 12456
 12457 1690-RESERVE-ERROR.
 12458     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12459
 12460     IF EMI-MESSAGE-FORMATTED
 12461        MOVE AL-UNBON            TO ERESVA
 12462        MOVE -1                  TO ERESVL.
 12463
 12464 1690-EXIT.
 12465      EXIT.
 12466
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 239
* EL156.cbl
 12468 1700-EDIT-EXPENSE-TYPE.
 12469     IF PI-PMTTYPE NOT = '5' AND '6'
 12470        GO TO 2000-EDIT-DONE.
 12471
 12472     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12473                   '6' OR '7' OR '8' OR '9'
 12474        GO TO 2000-EDIT-DONE.
 12475
 12476 1705-EXPENSE-ERROR.
 12477     MOVE ER-0573                TO EMI-ERROR.
 12478     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12479
 12480     IF EMI-MESSAGE-FORMATTED
 12481        MOVE AL-UABON            TO ETYPEA
 12482        MOVE -1                  TO ETYPEL.
 12483
 12484     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 240
* EL156.cbl
 12486 1950-NOT-FOUND.
 12487     IF FILE-SWITCH = 'MSTR'
 12488        MOVE ER-0204             TO EMI-ERROR.
 12489
 12490     IF FILE-SWITCH = 'CARR'
 12491        MOVE ER-0252             TO EMI-ERROR.
 12492
 12493     IF FILE-SWITCH = 'COMP'
 12494        MOVE ER-0254             TO EMI-ERROR.
 12495
 12496     IF FILE-SWITCH = 'STAT'
 12497        MOVE ER-0149             TO EMI-ERROR.
 12498
 12499     IF FILE-SWITCH = 'PROC'
 12500        MOVE ER-0019             TO EMI-ERROR.
 12501
 12502     IF FILE-SWITCH = 'ACCT'
 12503        MOVE ER-0198             TO EMI-ERROR.
 12504
 12505     IF FILE-SWITCH = 'BENE'
 12506        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12507           MOVE ER-0282          TO EMI-ERROR
 12508        ELSE
 12509           MOVE ER-0283          TO EMI-ERROR.
 12510
 12511     MOVE -1                     TO PMTTYPEL.
 12512     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12513
 12514     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12515                                     WS-FORCE-CTR.
 12516
 12517     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12518                                     WS-FATAL-CTR.
 12519
 12520     GO TO 8200-SEND-DATAONLY.
 12521
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 241
* EL156.cbl
 12523 2000-EDIT-DONE.
 12524     if pi-company-id = 'DCC'
 12525        and cl-critical-period > 0
 12526        perform 2210-dcc-max-benes thru 2210-exit
 12527     else
 12528     IF (WS-SPECIAL-CALC-CD = 'C')
 12529*       AND (CM-AH-CRITICAL-PERIOD) > 0
 12530        and (cl-critical-period > 0)
 12531        IF CM-AH-BENEFIT-AMT NOT = ZERO
 12532           IF PI-EPYAMT > ZEROS
 12533              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12534                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12535           ELSE
 12536              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12537                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12538           END-IF
 12539*          IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 12540           if ws-crit-period-days > cl-critical-period
 12541              MOVE ER-0657          TO EMI-ERROR
 12542              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12543           END-IF
 12544        END-IF
 12545     END-IF
 12546     end-if
 12547     IF PI-HOLDTIL NOT = ZEROS
 12548        MOVE PI-HOLDTIL          TO HOLDTILO
 12549        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12550
 12551     IF PI-EPYFROM NOT = ZEROS
 12552        MOVE PI-EPYFROM          TO EPYFROMO
 12553        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12554
 12555     IF PI-EPYTHRU NOT = ZEROS
 12556        MOVE PI-EPYTHRU            TO EPYTHRUO
 12557        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12558        IF PI-USES-PAID-TO
 12559           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12560           MOVE '4'                TO DC-OPTION-CODE
 12561           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12562           IF NO-CONVERSION-ERROR
 12563              MOVE +1              TO DC-ELAPSED-DAYS
 12564              MOVE +0              TO DC-ELAPSED-MONTHS
 12565              MOVE '6'             TO DC-OPTION-CODE
 12566              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12567              IF NO-CONVERSION-ERROR
 12568                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12569
 12570     MOVE PI-EDAYS               TO EDAYSO.
 12571
 12572     IF PI-AIGFROM NOT = ZEROS
 12573        MOVE PI-AIGFROM          TO AIGFROMO
 12574        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12575
 12576     MOVE PI-EPYAMT              TO EPYAMTO.
 12577     MOVE PI-ERESV               TO ERESVO.
 12578     MOVE PI-EEXPENS             TO EEXPENSO.
 12579
 12580     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 242
* EL156.cbl
 12581     MOVE SPACES                 TO DC-OPTION-CODE.
 12582     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12583
 12584     IF DATE-CONVERSION-ERROR
 12585        MOVE SPACES              TO CPYFROMI
 12586     ELSE
 12587        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12588        IF PI-EPYFROM = ZEROS
 12589           MOVE AL-UANON             TO EPYFROMA
 12590           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12591           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12592
 12593     IF PI-USES-PAID-TO
 12594        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12595        MOVE +1                            TO DC-ELAPSED-DAYS
 12596        MOVE +0                            TO DC-ELAPSED-MONTHS
 12597        MOVE '6'                           TO DC-OPTION-CODE
 12598        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12599        IF NO-CONVERSION-ERROR
 12600           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12601           IF PI-EPYTHRU = ZEROS
 12602              MOVE AL-UANON                TO EPYTHRUA
 12603              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12604              MOVE ' '                     TO DC-OPTION-CODE
 12605              MOVE +0                      TO DC-ELAPSED-DAYS
 12606                                              DC-ELAPSED-MONTHS
 12607              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12608              IF NO-CONVERSION-ERROR
 12609                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12610                  GO TO 2001-CONTINUE
 12611              ELSE
 12612                  GO TO 2001-CONTINUE
 12613           ELSE
 12614              GO TO 2001-CONTINUE.
 12615
 12616     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12617     MOVE SPACES                 TO DC-OPTION-CODE.
 12618     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12619
 12620     IF DATE-CONVERSION-ERROR
 12621        MOVE SPACES              TO CPYTHRUI
 12622     ELSE
 12623        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12624        IF PI-EPYTHRU = ZEROS
 12625           MOVE AL-UANON TO EPYTHRUA
 12626           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12627           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12628
 12629 2001-CONTINUE.
 12630
 12631     MOVE PI-CDAYS               TO CDAYSO.
 12632
 12633     IF PI-EDAYS = ZEROS
 12634        MOVE AL-UNNON TO EDAYSA
 12635        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12636
 12637     MOVE PI-CPYAMT              TO CPYAMTO.
 12638
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 243
* EL156.cbl
 12639     IF PI-EPYAMT = ZEROS
 12640        MOVE AL-UNNON            TO EPYAMTA
 12641        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12642
 12643     MOVE PI-CRESV               TO CRESVO.
 12644     MOVE PI-CEXPENS             TO CEXPENSO.
 12645
 12646     IF PI-EEXPENS = ZEROS
 12647        MOVE AL-UNNON TO EEXPENSA
 12648        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12649
 12650     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12651        AND (CL-CLAIM-TYPE = 'L')
 12652        AND (PI-OFFLINE NOT EQUAL 'Y')
 12653        IF PI-PMTTYPE = '2' OR '4'
 12654           PERFORM 2200-CALC-INTEREST
 12655                                 THRU 2200-EXIT
 12656        END-IF
 12657     END-IF
 12658     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12659     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12660     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12661
 12662     IF EMI-FATAL-CTR = ZEROS
 12663        MOVE 'B'                 TO PI-PASS-SW.
 12664
 12665     IF NOT EMI-MESSAGE-FORMATTED
 12666         MOVE -1                 TO EPYFROML
 12667     ELSE
 12668         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12669            EMI-ERROR-NUMBER (2) = SPACES
 12670             MOVE -1             TO EPYFROML.
 12671
 12672     GO TO 8200-SEND-DATAONLY.
 12673
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 244
* EL156.cbl
 12675 2200-CALC-INTEREST.
 12676     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12677        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12678        MOVE '4'                 TO DC-OPTION-CODE
 12679        PERFORM 9700-LINK-DATE-CONVERT
 12680        IF DATE-CONVERSION-ERROR
 12681            MOVE LOW-VALUES      TO CP-PRF-DT
 12682        ELSE
 12683           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12684        END-IF
 12685     END-IF
 12686     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12687        IN CLAIM-INT-PASS-AREA
 12688     MOVE CL-CERT-STATE          TO CP-STATE
 12689        IN CLAIM-INT-PASS-AREA
 12690     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12691     MOVE 'LF'                   TO CP-COVERAGE
 12692     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12693     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12694     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12695     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12696     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12697     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12698
 12699* EXEC CICS LINK
 12700*       PROGRAM   ('ELCLMI')
 12701*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12702*       LENGTH    (CP-CLAIM-LENGTH)
 12703*    END-EXEC
 12704     MOVE 'ELCLMI' TO DFHEIV1
 12705*    MOVE '."C                   (   #00012111' TO DFHEIV0
 12706     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12707     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12708     MOVE X'2020233030303132313131' TO DFHEIV0(25:11)
 12709     CALL 'kxdfhei1' USING DFHEIV0,
 12710           DFHEIV1,
 12711           CLAIM-INT-PASS-AREA,
 12712           CP-CLAIM-LENGTH,
 12713           DFHEIV99,
 12714           DFHEIV99,
 12715           DFHEIV99,
 12716           DFHEIV99
 12717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12718     MOVE AL-PANOF               TO PINTHA
 12719                                    PINTA
 12720     IF NO-CI-ERROR
 12721        MOVE CP-CLM-INT-AMT      TO PINTO
 12722                                    PI-INT-AMT
 12723        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12724        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12725        MOVE AL-PANOF            TO PINTHA
 12726                                    PINTA
 12727     ELSE
 12728        IF CI-RETURN-CODE = '8'
 12729           MOVE ER-3818          TO EMI-ERROR
 12730           MOVE -1               TO ZINTL
 12731           PERFORM 9900-ERROR-FORMAT
 12732                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 245
* EL156.cbl
 12733           GO TO 2200-EXIT
 12734        ELSE
 12735           MOVE ZEROS            TO PINTO
 12736                                    PI-INT-AMT
 12737                                    PI-INT-DAYS
 12738                                    PI-INT-RATE-USED
 12739        END-IF
 12740     END-IF
 12741     IF PI-INT-AMT NOT = ZEROS
 12742        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12743           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12744           CONTINUE
 12745        ELSE
 12746           MOVE CL-SOC-SEC-NO (1:3)
 12747                                 TO WS-SSN (1:3)
 12748           MOVE CL-SOC-SEC-NO (5:2)
 12749                                 TO WS-SSN (4:2)
 12750           MOVE CL-SOC-SEC-NO (8:4)
 12751                                 TO WS-SSN (6:4)
 12752           IF (WS-SSN NUMERIC)
 12753              AND (WS-SSN NOT = ZEROS)
 12754              CONTINUE
 12755           ELSE
 12756              MOVE ER-2044       TO EMI-ERROR
 12757              PERFORM 9900-ERROR-FORMAT
 12758                                 THRU 9900-EXIT
 12759           END-IF
 12760        END-IF
 12761        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12762        MOVE +51                 TO TRLR-SEQ-NO
 12763
 12764* EXEC CICS READ
 12765*          DATASET  ('ELTRLR')
 12766*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12767*          RIDFLD   (ELTRLR-KEY)
 12768*          RESP     (WS-RESPONSE)
 12769*       END-EXEC
 12770     MOVE 'ELTRLR' TO DFHEIV1
 12771*    MOVE '&"S        E          (  N#00012161' TO DFHEIV0
 12772     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12773     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12774     MOVE X'204E233030303132313631' TO DFHEIV0(25:11)
 12775     CALL 'kxdfhei1' USING DFHEIV0,
 12776           DFHEIV1,
 12777           DFHEIV20,
 12778           DFHEIV99,
 12779           ELTRLR-KEY,
 12780           DFHEIV99,
 12781           DFHEIV99,
 12782           DFHEIV99
 12783     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12784         DFHEIV20
 12785     MOVE EIBRESP  TO WS-RESPONSE
 12786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12787        IF (NOT WS-RESP-NORMAL)
 12788                    OR
 12789           ((WS-RESP-NORMAL)
 12790           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 246
* EL156.cbl
 12791           OR (AT-CITY-STATE = SPACES)))
 12792           MOVE ER-0874          TO EMI-ERROR
 12793           PERFORM 9900-ERROR-FORMAT
 12794                                 THRU 9900-EXIT
 12795        END-IF
 12796     END-IF
 12797     .
 12798 2200-EXIT.
 12799     EXIT.
 12800 2210-dcc-max-benes.
 12801
 12802     move cm-ah-benefit-amt      to ws-monthly-benefit
 12803     if pdef-found
 12804        and pd-max-amt (p1) < ws-monthly-benefit
 12805        move pd-max-amt (p1)     to ws-monthly-benefit
 12806     end-if
 12807
 12808     move cl-cert-key-data       to elcrtt-key (2:21)
 12809     move cl-company-cd          to ctrlr-comp-cd
 12810     move cl-cert-no             to ctrlr-cert-no
 12811     move 'B'                    to ctrlr-rec-type
 12812
 12813
 12814* EXEC CICS READ
 12815*       DATASET  ('ELCRTT')
 12816*       set      (address of CERTIFICATE-TRAILERS)
 12817*       RIDFLD   (ELCRTT-KEY)
 12818*       RESP     (WS-RESPONSE)
 12819*    END-EXEC
 12820     MOVE 'ELCRTT' TO DFHEIV1
 12821*    MOVE '&"S        E          (  N#00012193' TO DFHEIV0
 12822     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12824     MOVE X'204E233030303132313933' TO DFHEIV0(25:11)
 12825     CALL 'kxdfhei1' USING DFHEIV0,
 12826           DFHEIV1,
 12827           DFHEIV20,
 12828           DFHEIV99,
 12829           ELCRTT-KEY,
 12830           DFHEIV99,
 12831           DFHEIV99,
 12832           DFHEIV99
 12833     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12834         DFHEIV20
 12835     MOVE EIBRESP  TO WS-RESPONSE
 12836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12837     IF not WS-RESP-NORMAL
 12838        go to 2210-exit
 12839     end-if
 12840
 12841*    if instypei = 'P'
 12842*       move +1 to s1
 12843*    else
 12844*       MOVE +2 to s1
 12845*    end-if
 12846
 12847     move +1 to s1
 12848     evaluate cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 247
* EL156.cbl
 12849        when 'A'
 12850           move +1 to s2
 12851        when 'I'
 12852           move +2 to s2
 12853        when 'G'
 12854           move +3 to s2
 12855        when 'L'
 12856           move +4 to s2
 12857        when 'P'
 12858           move +5 to s2
 12859     end-evaluate
 12860
 12861     if pi-epyamt > zeros
 12862        compute ws-crit-period-days =
 12863           (cs-total-paid (s1 s2) + PI-EPYAMT)
 12864           / ws-monthly-benefit
 12865     else
 12866        compute ws-crit-period-days =
 12867           (cs-total-paid (s1 s2) + PI-CPYAMT)
 12868           / ws-monthly-benefit
 12869     end-if
 12870
 12871     if ws-crit-period-days > cl-critical-period
 12872*    if ws-crit-period-days > pd-crit-period (p1)
 12873        move er-1658             to emi-error
 12874        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12875     end-if
 12876
 12877     .
 12878 2210-exit.
 12879     exit.
 12880
 12881 2220-update-elcrtt.
 12882
 12883
 12884* EXEC CICS GETMAIN
 12885*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 12886*       LENGTH   (ELCRTT-LENGTH)
 12887*       INITIMG  (GETMAIN-SPACE)
 12888*    END-EXEC
 12889*    MOVE ',"IL                  $   #00012245' TO DFHEIV0
 12890     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12891     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12892     MOVE X'2020233030303132323435' TO DFHEIV0(25:11)
 12893     CALL 'kxdfhei1' USING DFHEIV0,
 12894           DFHEIV20,
 12895           ELCRTT-LENGTH,
 12896           GETMAIN-SPACE
 12897     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12898         DFHEIV20
 12899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12900
 12901     move cl-cert-key-data       to elcrtt-key (2:21)
 12902     move cl-company-cd          to ctrlr-comp-cd
 12903     move cl-cert-no             to ctrlr-cert-no
 12904     move 'B'                    to ctrlr-rec-type
 12905
 12906
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 248
* EL156.cbl
 12907* EXEC CICS READ
 12908*       UPDATE
 12909*       DATASET  (ELCRTT-DSID)
 12910*       into     (CERTIFICATE-TRAILERS)
 12911*       RIDFLD   (ELCRTT-KEY)
 12912*       RESP     (WS-RESPONSE)
 12913*    END-EXEC
 12914     MOVE LENGTH OF
 12915      CERTIFICATE-TRAILERS
 12916       TO DFHEIV11
 12917*    MOVE '&"IL       EU         (  N#00012256' TO DFHEIV0
 12918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12920     MOVE X'204E233030303132323536' TO DFHEIV0(25:11)
 12921     CALL 'kxdfhei1' USING DFHEIV0,
 12922           ELCRTT-DSID,
 12923           CERTIFICATE-TRAILERS,
 12924           DFHEIV11,
 12925           ELCRTT-KEY,
 12926           DFHEIV99,
 12927           DFHEIV99,
 12928           DFHEIV99
 12929     MOVE EIBRESP  TO WS-RESPONSE
 12930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12931
 12932     IF WS-RESP-NORMAL
 12933        perform 2225-upd-crt-trlr thru 2225-exit
 12934
 12935* EXEC CICS REWRITE
 12936*          DATASET  (ELCRTT-DSID)
 12937*          from     (CERTIFICATE-TRAILERS)
 12938*          RESP     (WS-RESPONSE)
 12939*       END-EXEC
 12940     MOVE LENGTH OF
 12941      CERTIFICATE-TRAILERS
 12942       TO DFHEIV11
 12943*    MOVE '&& L                  %  N#00012266' TO DFHEIV0
 12944     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12945     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12946     MOVE X'204E233030303132323636' TO DFHEIV0(25:11)
 12947     CALL 'kxdfhei1' USING DFHEIV0,
 12948           ELCRTT-DSID,
 12949           CERTIFICATE-TRAILERS,
 12950           DFHEIV11,
 12951           DFHEIV99
 12952     MOVE EIBRESP  TO WS-RESPONSE
 12953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12954     else
 12955        if ws-resp-notfnd
 12956           move 'CS'             to certificate-trailers
 12957           move cl-company-cd    to cs-company-cd
 12958           move cl-cert-key-data to cs-control-primary (2:21)
 12959           move cl-cert-no       to cs-cert-no
 12960           move 'B'              to cs-trailer-type
 12961           perform varying s1 from +1 by +1 until s1 > +2
 12962              perform varying s2 from +1 by +1 until s2 > +10
 12963                 move zeros      to cs-bank (s1 s2)
 12964                                    cs-no-of-claims (s1 s2)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 249
* EL156.cbl
 12965                                    cs-days-paid (s1 s2)
 12966                                    cs-total-paid (s1 s2)
 12967              end-perform
 12968           end-perform
 12969           perform 2225-upd-crt-trlr
 12970                                 thru 2225-exit
 12971
 12972* EXEC CICS WRITE
 12973*             DATASET  (ELCRTT-DSID)
 12974*             from     (CERTIFICATE-TRAILERS)
 12975*             RIDFLD   (cs-control-primary)
 12976*             RESP     (WS-RESPONSE)
 12977*          END-EXEC
 12978     MOVE LENGTH OF
 12979      CERTIFICATE-TRAILERS
 12980       TO DFHEIV11
 12981*    MOVE '&$ L                  ''  N#00012288' TO DFHEIV0
 12982     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12983     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12984     MOVE X'204E233030303132323838' TO DFHEIV0(25:11)
 12985     CALL 'kxdfhei1' USING DFHEIV0,
 12986           ELCRTT-DSID,
 12987           CERTIFICATE-TRAILERS,
 12988           DFHEIV11,
 12989           cs-control-primary,
 12990           DFHEIV99,
 12991           DFHEIV99
 12992     MOVE EIBRESP  TO WS-RESPONSE
 12993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12994        end-if
 12995     END-IF
 12996
 12997     .
 12998 2220-exit.
 12999     exit.
 13000
 13001 2225-upd-crt-trlr.
 13002
 13003*    if instypei = 'P'
 13004*       move +1 to s1
 13005*    else
 13006*       MOVE +2 to s1
 13007*    end-if
 13008
 13009     move +1 to s1
 13010     evaluate cl-claim-type
 13011        when 'A'
 13012           move +1 to s2
 13013        when 'I'
 13014           move +2 to s2
 13015        when 'G'
 13016           move +3 to s2
 13017        when 'L'
 13018           move +4 to s2
 13019        when 'P'
 13020           move +5 to s2
 13021     end-evaluate
 13022
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 250
* EL156.cbl
 13023     compute cs-total-paid (s1 s2) = cs-total-paid (s1 s2) +
 13024        at-amount-paid
 13025     compute cs-days-paid (s1 s2) = cs-days-paid (s1 s2) +
 13026        at-days-in-period
 13027
 13028     .
 13029 2225-exit.
 13030     exit.
 13031 3000-MOVE-INPUT-TO-SAVE-AREA.
 13032     IF PMTTYPEL > 0
 13033         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13034
 13035     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13036
 13037     IF WS-PMTTYPE = '9'
 13038         MOVE 'P'                TO PI-PROVISIONAL-IND
 13039         MOVE '1'                TO WS-PMTTYPE.
 13040
 13041     IF PAYEEL > 0
 13042         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13043         MOVE PAYEEI             TO WS-PAYEE.
 13044
 13045     IF NOTE1L > +0
 13046         MOVE NOTE1I             TO WS-PMTNOTE1
 13047                                    WS-FLI-PMTNOTE
 13048                                    WS-HAN-PMTNOTE.
 13049
 13050     IF NOTE2L > +0
 13051         MOVE NOTE2I             TO WS-PMTNOTE2.
 13052
 13053     IF OFFLINEL > 0
 13054         MOVE OFFLINEI           TO WS-OFFLINE.
 13055
 13056     IF PROOFDTL > 0
 13057         MOVE PROOFDTI            TO DATE-WORK
 13058         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13059         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13060         MOVE '4'                 TO DC-OPTION-CODE
 13061         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13062         IF NO-CONVERSION-ERROR
 13063            MOVE NUM-WORK         TO PROOFDTO
 13064            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13065            MOVE NUM-WORK         TO WS-PROOF-DATE
 13066         ELSE
 13067            MOVE ZEROS            TO WS-PROOF-DATE
 13068         END-IF
 13069     END-IF.
 13070
 13071     IF EOBYNL > +0
 13072         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13073         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13074     END-IF
 13075
 13076     IF CLMFMYNL > +0
 13077         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13078         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13079     END-IF
 13080
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 251
* EL156.cbl
 13081     IF SURVYYNL > +0
 13082         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13083         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13084     END-IF
 13085
 13086     IF SPRELYNL > +0
 13087         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13088         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13089     END-IF
 13090*    IF GROUPEDL > +0
 13091*        MOVE GROUPEDI           TO WS-GROUPED.
 13092*
 13093*    IF CASHL > +0
 13094*       MOVE CASHI               TO WS-CASH.
 13095     IF LOANNOL > +0
 13096         MOVE LOANNOI            TO WS-LOAN-NO.
 13097
 13098     IF CHECKNOL > 0
 13099         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13100
 13101     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13102         IF WS-AIG-CREDIT-ENTERED
 13103             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13104             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13105             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13106             MOVE AL-UANON         TO CHECKNOA.
 13107
 13108     IF HOLDTILL > 0
 13109         MOVE HOLDTILI           TO DATE-WORK
 13110         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13111         MOVE NUM-WORK           TO WS-HOLDTIL.
 13112
 13113     IF ZINTL > +0
 13114
 13115* EXEC CICS BIF DEEDIT
 13116*           FIELD   (ZINTI)
 13117*           LENGTH  (07)
 13118*       END-EXEC
 13119     MOVE 07
 13120       TO DFHEIV11
 13121*    MOVE '@"L                   #   #00012414' TO DFHEIV0
 13122     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13123     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13124     MOVE X'2020233030303132343134' TO DFHEIV0(25:11)
 13125     CALL 'kxdfhei1' USING DFHEIV0,
 13126           ZINTI,
 13127           DFHEIV11
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13129        IF ZINTI NOT NUMERIC
 13130           MOVE ER-0419          TO EMI-ERROR
 13131           PERFORM 9900-ERROR-FORMAT
 13132           MOVE AL-UABON         TO ZINTA
 13133           MOVE -1               TO ZINTL
 13134        ELSE
 13135           MOVE ZINTI            TO CP-INT-RATE
 13136                                    WS-INT-RATE
 13137           MOVE CP-INT-RATE      TO ZINTO
 13138           MOVE AL-UNNON         TO ZINTA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 252
* EL156.cbl
 13139        END-IF
 13140     ELSE
 13141        MOVE ZEROS               TO CP-INT-RATE
 13142     END-IF
 13143     IF EPYFROML > 0
 13144         MOVE EPYFROMI           TO DATE-WORK
 13145         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13146         MOVE NUM-WORK           TO WS-EPYFROM.
 13147
 13148     IF AIGFROML > 0
 13149         MOVE AIGFROMI           TO DATE-WORK
 13150         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13151         MOVE NUM-WORK           TO WS-AIGFROM
 13152     ELSE
 13153         IF (AIGFROMI = LOW-VALUES) AND
 13154            (PI-AIGFROM NOT = ZEROS)
 13155              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13156
 13157     IF EPYTHRUL > +0
 13158        MOVE EPYTHRUI           TO DATE-WORK
 13159        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13160        MOVE NUM-WORK           TO WS-EPYTHRU
 13161        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13162        MOVE '4'                TO DC-OPTION-CODE
 13163        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13164        IF NO-CONVERSION-ERROR
 13165           IF PI-USES-PAID-TO
 13166              MOVE '6'                TO DC-OPTION-CODE
 13167              MOVE -1                 TO DC-ELAPSED-DAYS
 13168              MOVE +0                 TO DC-ELAPSED-MONTHS
 13169              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13170              IF NO-CONVERSION-ERROR
 13171                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13172                 MOVE ' '             TO DC-OPTION-CODE
 13173                 MOVE +0              TO DC-ELAPSED-DAYS
 13174                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13175              IF NO-CONVERSION-ERROR
 13176                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13177
 13178*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13179*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13180     IF EDAYSL > 0
 13181
 13182* EXEC CICS BIF DEEDIT
 13183*            FIELD(EDAYSI)
 13184*            LENGTH(6)
 13185*        END-EXEC
 13186     MOVE 6
 13187       TO DFHEIV11
 13188*    MOVE '@"L                   #   #00012470' TO DFHEIV0
 13189     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13190     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13191     MOVE X'2020233030303132343730' TO DFHEIV0(25:11)
 13192     CALL 'kxdfhei1' USING DFHEIV0,
 13193           EDAYSI,
 13194           DFHEIV11
 13195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13196         MOVE EDAYSI             TO WS-DY-WORK
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 253
* EL156.cbl
 13197         IF WS-DY-SIGN = SPACES
 13198            MOVE WS-DY-NUM       TO WS-EDAYS
 13199            ADD 0                TO WS-EDAYS
 13200         ELSE
 13201            MOVE EDAYSI          TO WS-EDAYS
 13202            ADD 0                TO WS-EDAYS.
 13203
 13204*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13205*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13206     IF EPYAMTL > 0
 13207
 13208* EXEC CICS BIF DEEDIT
 13209*            FIELD(EPYAMTI)
 13210*            LENGTH(10)
 13211*        END-EXEC
 13212     MOVE 10
 13213       TO DFHEIV11
 13214*    MOVE '@"L                   #   #00012485' TO DFHEIV0
 13215     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13216     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13217     MOVE X'2020233030303132343835' TO DFHEIV0(25:11)
 13218     CALL 'kxdfhei1' USING DFHEIV0,
 13219           EPYAMTI,
 13220           DFHEIV11
 13221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13222         MOVE EPYAMTI            TO WS-PY-WORK
 13223         IF WS-PY-SIGN = SPACES
 13224            MOVE WS-PY-NUM       TO WS-EPYAMT
 13225            ADD 0                TO WS-EPYAMT
 13226         ELSE
 13227            MOVE EPYAMTI         TO WS-EPYAMT
 13228            ADD 0                TO WS-EPYAMT.
 13229
 13230     IF ERESVL > 0
 13231
 13232* EXEC CICS BIF DEEDIT
 13233*            FIELD(ERESVI)
 13234*            LENGTH(9)
 13235*        END-EXEC
 13236     MOVE 9
 13237       TO DFHEIV11
 13238*    MOVE '@"L                   #   #00012498' TO DFHEIV0
 13239     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13240     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13241     MOVE X'2020233030303132343938' TO DFHEIV0(25:11)
 13242     CALL 'kxdfhei1' USING DFHEIV0,
 13243           ERESVI,
 13244           DFHEIV11
 13245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13246         MOVE ERESVI TO WS-ERESV.
 13247
 13248     IF EEXPENSL > 0
 13249
 13250* EXEC CICS BIF DEEDIT
 13251*            FIELD(EEXPENSI)
 13252*            LENGTH(8)
 13253*        END-EXEC
 13254     MOVE 8
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 254
* EL156.cbl
 13255       TO DFHEIV11
 13256*    MOVE '@"L                   #   #00012505' TO DFHEIV0
 13257     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13258     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13259     MOVE X'2020233030303132353035' TO DFHEIV0(25:11)
 13260     CALL 'kxdfhei1' USING DFHEIV0,
 13261           EEXPENSI,
 13262           DFHEIV11
 13263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13264         MOVE EEXPENSI           TO WS-EEXPENS.
 13265
 13266     IF ETYPEL > ZEROS
 13267         MOVE ETYPEI             TO WS-ETYPE.
 13268
 13269     IF PI-COMPANY-ID = 'BOA'
 13270        IF PINTL > ZEROS
 13271
 13272* EXEC CICS BIF DEEDIT
 13273*            FIELD (PINTI)
 13274*            LENGTH(05)
 13275*          END-EXEC
 13276     MOVE 05
 13277       TO DFHEIV11
 13278*    MOVE '@"L                   #   #00012516' TO DFHEIV0
 13279     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13281     MOVE X'2020233030303132353136' TO DFHEIV0(25:11)
 13282     CALL 'kxdfhei1' USING DFHEIV0,
 13283           PINTI,
 13284           DFHEIV11
 13285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13286           IF PINTI NUMERIC
 13287               MOVE AL-UNNON     TO PINTA
 13288               MOVE PINTI        TO WS-INT-RATE
 13289               MOVE WS-INT-RATE  TO PINTO.
 13290
 13291 3000-EXIT.
 13292     EXIT.
 13293
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 255
* EL156.cbl
 13295 3050-REBUILD-ENTERED.
 13296
 13297     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13298
 13299     IF PI-PROV-PMT
 13300         MOVE '9'           TO PMTTYPEO
 13301     ELSE
 13302         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13303
 13304     MOVE PI-PAYEE          TO PAYEEO.
 13305     MOVE PI-PMTNOTE1       TO NOTE1O.
 13306     MOVE PI-PMTNOTE2       TO NOTE2O.
 13307     MOVE PI-OFFLINE        TO OFFLINEO.
 13308     IF PI-PROOF-DATE NOT = ZEROS
 13309         MOVE PI-PROOF-DATE TO PROOFDTO
 13310         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13311     END-IF.
 13312*    MOVE PI-GROUPED        TO GROUPEDO.
 13313
 13314*    MOVE PI-CASH           TO CASHO.
 13315
 13316     IF PI-INT-RATE > ZEROS
 13317         MOVE PI-INT-RATE   TO PINTO.
 13318
 13319     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13320        IF PI-INT-AMT > ZEROS
 13321           MOVE PI-INT-AMT       TO PINTO
 13322           MOVE AL-PANOF         TO PINTA
 13323                                    PINTHA
 13324        END-IF
 13325     END-IF
 13326     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13327     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13328     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13329     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13330     IF PI-HOLDTIL NOT = ZEROS
 13331        MOVE PI-HOLDTIL          TO HOLDTILO
 13332        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13333
 13334     IF PI-EPYFROM NOT = ZEROS
 13335        MOVE PI-EPYFROM          TO EPYFROMO
 13336        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13337
 13338     IF PI-AIGFROM NOT = ZEROS
 13339        MOVE PI-AIGFROM          TO AIGFROMO
 13340        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13341
 13342     IF PI-EPYTHRU NOT = ZEROS
 13343        MOVE PI-EPYTHRU          TO EPYTHRUO
 13344        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13345        IF PI-USES-PAID-TO
 13346           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13347           MOVE '4'                TO DC-OPTION-CODE
 13348           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13349           IF NO-CONVERSION-ERROR
 13350              MOVE +1 TO DC-ELAPSED-DAYS
 13351              MOVE +0 TO DC-ELAPSED-MONTHS
 13352              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 256
* EL156.cbl
 13353              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13354              IF NO-CONVERSION-ERROR
 13355                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13356
 13357     IF PI-EDAYS NOT = ZEROS
 13358        MOVE PI-EDAYS TO EDAYSO.
 13359
 13360     IF PI-EPYAMT NOT = ZEROS
 13361        MOVE PI-EPYAMT TO EPYAMTO.
 13362
 13363     IF PI-ERESV NOT = ZEROS
 13364        MOVE PI-ERESV TO ERESVO.
 13365
 13366     IF PI-EEXPENS NOT = ZEROS
 13367        MOVE PI-EEXPENS TO EEXPENSO.
 13368
 13369     MOVE PI-ETYPE TO ETYPEO.
 13370
 13371     IF PI-ECHECKNO NOT = SPACES
 13372        MOVE PI-ECHECKNO         TO CHECKNOO
 13373     ELSE
 13374        MOVE PI-CCHECKNO         TO CHECKNOO.
 13375
 13376     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13377     MOVE SPACES                 TO DC-OPTION-CODE.
 13378     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13379
 13380     IF DATE-CONVERSION-ERROR
 13381        MOVE SPACES              TO CPYFROMI
 13382     ELSE
 13383        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13384
 13385     IF PI-USES-PAID-TO
 13386        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13387        MOVE +1                  TO DC-ELAPSED-DAYS
 13388        MOVE +0                  TO DC-ELAPSED-MONTHS
 13389        MOVE '6'                 TO DC-OPTION-CODE
 13390        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13391        IF NO-CONVERSION-ERROR
 13392           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13393           GO TO 3051-CONTINUE.
 13394
 13395     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13396     MOVE SPACES                 TO DC-OPTION-CODE.
 13397     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13398
 13399     IF DATE-CONVERSION-ERROR
 13400        MOVE SPACES              TO CPYTHRUI
 13401     ELSE
 13402        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13403
 13404 3051-CONTINUE.
 13405
 13406     IF PI-CDAYS NOT = ZEROS
 13407        MOVE PI-CDAYS TO CDAYSO.
 13408
 13409     IF PI-CPYAMT NOT = ZEROS
 13410        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 257
* EL156.cbl
 13411
 13412     IF PI-CRESV NOT = ZEROS
 13413        MOVE PI-CRESV TO CRESVO.
 13414
 13415     IF PI-CEXPENS NOT = ZEROS
 13416        MOVE PI-CEXPENS TO CEXPENSO.
 13417
 13418 3059-EXIT.
 13419     EXIT.
 13420
 13421 3100-DEEDIT-DATE.
 13422
 13423* EXEC CICS BIF DEEDIT
 13424*        FIELD(DATE-WORK)
 13425*        LENGTH(8)
 13426*    END-EXEC.
 13427     MOVE 8
 13428       TO DFHEIV11
 13429*    MOVE '@"L                   #   #00012656' TO DFHEIV0
 13430     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13432     MOVE X'2020233030303132363536' TO DFHEIV0(25:11)
 13433     CALL 'kxdfhei1' USING DFHEIV0,
 13434           DATE-WORK,
 13435           DFHEIV11
 13436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13437
 13438
 13439 3100-EXIT.
 13440     EXIT.
 13441
 13442 3200-CALC-AIG-DAYS.
 13443
 13444     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13445
 13446     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13447     MOVE ' '                    TO DC-OPTION-CODE.
 13448     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13449     IF NO-CONVERSION-ERROR
 13450         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13451     ELSE
 13452         GO TO 3290-ERROR.
 13453
 13454     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13455         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13456                                WS-BIN-FROM-DT
 13457     ELSE
 13458         IF CL-TOTAL-PAID-AMT > ZEROS
 13459             IF WS-SV-EPYFROM = LOW-VALUES
 13460                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13461                                        WS-BIN-FROM-DT
 13462             ELSE
 13463                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13464                                        WS-BIN-FROM-DT
 13465         ELSE
 13466             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13467                                        WS-BIN-FROM-DT.
 13468
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 258
* EL156.cbl
 13469 3210-CONTINUE.
 13470
 13471     MOVE ' '                    TO DC-OPTION-CODE.
 13472     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13473     IF DATE-CONVERSION-ERROR
 13474         GO TO 3290-ERROR.
 13475
 13476     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13477
 13478     IF PI-LOAN-DUE-DAY = 31
 13479         MOVE 30              TO WS-PMT-DUE-DA
 13480                                 WS-SAVE-DUE-DA
 13481     ELSE
 13482         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13483                                 WS-SAVE-DUE-DA.
 13484
 13485     IF (PI-LOAN-DUE-DAY > 28) AND
 13486        (WS-PMT-DUE-MO = 2)
 13487         MOVE 'Y'                TO WS-DUE-DAY-SW
 13488         MOVE 28                 TO WS-PMT-DUE-DA.
 13489
 13490     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13491     MOVE '4'                    TO DC-OPTION-CODE.
 13492     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13493     IF NO-CONVERSION-ERROR
 13494         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13495     ELSE
 13496         GO TO 3290-ERROR.
 13497
 13498*--------------------------------------------------------------*
 13499*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13500*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13501*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13502*                                                              *
 13503*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13504*             INCURRED DATE      - 04/15/91                    *
 13505*             PMT DUE DATE       - 04/03/91                    *
 13506*             PMT DUE DATE       - 05/03/91                    *
 13507*--------------------------------------------------------------*
 13508
 13509     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13510        (WS-SV-AIGFROM = LOW-VALUES)
 13511         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13512            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13513             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13514             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13515             IF NO-CONVERSION-ERROR
 13516                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13517                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13518             ELSE
 13519                 GO TO 3290-ERROR.
 13520
 13521     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13522        (WS-SV-AIGFROM = LOW-VALUES)
 13523         GO TO 3205-CONT-CALC-PMT.
 13524
 13525     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13526     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 259
* EL156.cbl
 13527     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13528     IF NO-CONVERSION-ERROR
 13529         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13530     ELSE
 13531         GO TO 3290-ERROR.
 13532
 13533     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13534        (WS-PMT-DUE-DA < WS-FROM-DA)
 13535          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13536          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13537          IF NO-CONVERSION-ERROR
 13538              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13539              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13540          ELSE
 13541              GO TO 3290-ERROR.
 13542
 13543 3205-CONT-CALC-PMT.
 13544
 13545*--------------------------------------------------------------*
 13546*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13547*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13548*--------------------------------------------------------------*
 13549
 13550     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13551        PI-PMTTYPE = '2'
 13552          NEXT SENTENCE
 13553     ELSE
 13554        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13555           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13556             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13557             MOVE ER-3527            TO EMI-ERROR
 13558             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13559             MOVE -1                 TO EPYTHRUL
 13560             MOVE AL-UNBON           TO EPYTHRUA
 13561                                        EPYFROMA
 13562             GO TO 3299-EXIT.
 13563
 13564*--------------------------------------------------------------*
 13565*    CALCULATE RETRO ELIMINATION DATE                          *
 13566*--------------------------------------------------------------*
 13567
 13568     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13569         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13570     ELSE
 13571         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13572
 13573     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13574     MOVE +0             TO DC-ELAPSED-MONTHS.
 13575     MOVE '6'            TO DC-OPTION-CODE.
 13576     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13577     IF NO-CONVERSION-ERROR
 13578         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13579     ELSE
 13580         GO TO 3290-ERROR.
 13581
 13582 3210-CHECK-PMT-DATE.
 13583
 13584*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 260
* EL156.cbl
 13585*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13586*    THE ENTERED PAY FROM DATE                                 *
 13587*--------------------------------------------------------------*
 13588
 13589     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13590         NEXT SENTENCE
 13591     ELSE
 13592         GO TO 3220-COMPUTE-DAYS.
 13593
 13594     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13595     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13596     IF NO-CONVERSION-ERROR
 13597         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13598         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13599         GO TO 3210-CHECK-PMT-DATE
 13600     ELSE
 13601         GO TO 3290-ERROR.
 13602
 13603 3220-COMPUTE-DAYS.
 13604
 13605     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13606     MOVE ZEROS         TO WS-CDAYS.
 13607     MOVE 'N'           TO WS-ELIMINATION-SW.
 13608
 13609*--------------------------------------------------------------*
 13610*    COMPUTE CALIFORNIA DUE DAYS                               *
 13611*--------------------------------------------------------------*
 13612
 13613     IF CL-TOTAL-PAID-AMT > ZEROS
 13614         MOVE 'Y' TO WS-ELIMINATION-SW
 13615         GO TO 3240-FIRST-PMT-DUE
 13616     ELSE
 13617        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13618            NEXT SENTENCE
 13619        ELSE
 13620            GO TO 3240-FIRST-PMT-DUE.
 13621
 13622 3230-NEXT-PMT-DUE.
 13623
 13624     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13625     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13626     IF NO-CONVERSION-ERROR
 13627         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13628         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13629     ELSE
 13630         GO TO 3290-ERROR.
 13631
 13632 3240-FIRST-PMT-DUE.
 13633
 13634     IF CL-TOTAL-PAID-AMT > ZEROS
 13635         NEXT SENTENCE
 13636     ELSE
 13637        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13638            GO TO 3230-NEXT-PMT-DUE.
 13639
 13640     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13641         GO TO 3250-VERIFY-ELIMINATION.
 13642
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 261
* EL156.cbl
 13643     ADD +30 TO WS-CDAYS.
 13644     MOVE 'Y' TO WS-ELIMINATION-SW.
 13645     GO TO 3230-NEXT-PMT-DUE.
 13646
 13647 3250-VERIFY-ELIMINATION.
 13648
 13649     IF ELIM-SATISFIED
 13650         GO TO 3260-END-CALC.
 13651
 13652     IF PI-PMTTYPE = '1'
 13653         MOVE ZEROS TO WS-CDAYS
 13654         GO TO 3260-END-CALC.
 13655
 13656     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13657         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13658     ELSE
 13659         IF CL-TOTAL-PAID-AMT > ZEROS
 13660             IF WS-SV-EPYFROM = LOW-VALUES
 13661                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13662             ELSE
 13663                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13664         ELSE
 13665             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13666
 13667     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13668     MOVE '1'                    TO DC-OPTION-CODE.
 13669     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13670     IF NO-CONVERSION-ERROR
 13671         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13672     ELSE
 13673         GO TO 3290-ERROR.
 13674
 13675     IF CL-TOTAL-PAID-AMT > ZEROS
 13676         MOVE WS-DAYS-OFF TO WS-CDAYS
 13677     ELSE
 13678         IF PI-BEN-DAYS > WS-DAYS-OFF
 13679             MOVE ZEROS TO WS-CDAYS
 13680         ELSE
 13681             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13682
 13683 3260-END-CALC.
 13684
 13685     MOVE WS-CDAYS TO PI-CDAYS.
 13686
 13687     IF PI-EDAYS = ZEROS
 13688         MOVE PI-CDAYS TO PI-EDAYS
 13689         MOVE AL-UNNON TO EDAYSA.
 13690
 13691     GO TO 3299-EXIT.
 13692
 13693 3290-ERROR.
 13694
 13695     MOVE ER-3528            TO EMI-ERROR.
 13696     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13697     MOVE -1                 TO CDAYSL.
 13698     MOVE AL-UNBON           TO CDAYSA.
 13699
 13700 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 262
* EL156.cbl
 13701     EXIT.
 13702
 13703 3300-BUMP-DATE.
 13704
 13705     IF WS-RESTORE-DUE-DAY
 13706         MOVE 'N'              TO WS-DUE-DAY-SW
 13707         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13708         ADD 1                 TO WS-PMT-DUE-MO
 13709         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13710         MOVE '4'              TO DC-OPTION-CODE
 13711         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13712         IF NO-CONVERSION-ERROR
 13713             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13714             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13715             GO TO 3399-EXIT
 13716         ELSE
 13717             MOVE '9'          TO DC-ERROR-CODE
 13718             GO TO 3399-EXIT.
 13719
 13720     IF (WS-PMT-DUE-MO = 1) AND
 13721        (WS-SAVE-DUE-DA > 28)
 13722           MOVE 'Y' TO WS-DUE-DAY-SW.
 13723
 13724     MOVE +0                 TO DC-ELAPSED-DAYS.
 13725     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13726     MOVE '6'                TO DC-OPTION-CODE.
 13727     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13728
 13729 3399-EXIT.
 13730     EXIT.
 13731
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 263
* EL156.cbl
 13733 3400-COMPUTE-EXPIRY.
 13734
 13735     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13736     MOVE +0                    TO DC-ELAPSED-DAYS
 13737                                   DC-ODD-DAYS-OVER.
 13738     MOVE '1'                   TO DC-END-OF-MONTH.
 13739     MOVE '6'                   TO DC-OPTION-CODE.
 13740
 13741     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13742         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13743     ELSE
 13744         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13745
 13746     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13747     IF NO-CONVERSION-ERROR
 13748         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13749     ELSE
 13750         GO TO 3390-CONTINUE.
 13751
 13752     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13753         GO TO 3390-CONTINUE.
 13754
 13755     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13756     MOVE '4'                    TO CNTL-REC-TYPE.
 13757     MOVE +0                     TO CNTL-SEQ-NO.
 13758     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13759     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13760     MOVE 'BENE'                 TO FILE-SWITCH.
 13761
 13762     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13763
 13764     IF NO-BENEFIT-FOUND
 13765         GO TO 3390-CONTINUE.
 13766
 13767     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13768        IF (PI-OFFLINE = 'Y') OR
 13769           (PI-PMTTYPE = '7')
 13770           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13771                                     THRU 9870-EXIT
 13772           IF ERROR-ON-OUTPUT
 13773             MOVE -1                 TO ENTERPFL
 13774             MOVE AL-UANON           TO ENTERPFA
 13775             MOVE MAP-NAMEA          TO MAP-NAME
 13776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13777             GO TO 8200-SEND-DATAONLY.
 13778
 13779     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13780        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13781        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 13782          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 13783          MOVE +0        TO DC-ELAPSED-DAYS
 13784          MOVE +1        TO DC-ELAPSED-MONTHS
 13785          MOVE 6         TO DC-OPTION-CODE
 13786          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13787          IF NO-CONVERSION-ERROR
 13788              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 13789
 13790 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 264
* EL156.cbl
 13791
 13792      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13793         MOVE CM-AH-LOAN-EXPIRE-DT
 13794                                 TO DC-BIN-DATE-1
 13795      ELSE
 13796         MOVE CM-LF-LOAN-EXPIRE-DT
 13797                                 TO DC-BIN-DATE-1
 13798      END-IF
 13799
 13800      MOVE ' '                    TO DC-OPTION-CODE.
 13801      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13802      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 13803      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 13804
 13805 3499-EXIT.
 13806     EXIT.
 13807
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 265
* EL156.cbl
 13809
 13810 3600-CHECK-VERIFICATION.
 13811
 13812     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13813
 13814     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13815
 13816     IF PI-PAYEE-TYPE = 'I'
 13817        GO TO 3600-READ-TRAILER.
 13818
 13819     IF PI-PAYEE-TYPE = 'B'
 13820        ADD +10                  TO TRLR-SEQ-NO
 13821        GO TO 3600-READ-TRAILER.
 13822
 13823     IF PI-PAYEE-TYPE = 'A'
 13824        ADD +20                  TO TRLR-SEQ-NO
 13825        GO TO 3600-READ-TRAILER.
 13826
 13827     IF PI-PAYEE-TYPE = 'O'
 13828        ADD +50                  TO TRLR-SEQ-NO
 13829        GO TO 3600-READ-TRAILER.
 13830
 13831     IF PI-PAYEE-TYPE = 'Q'
 13832        ADD +60                  TO TRLR-SEQ-NO
 13833        GO TO 3600-READ-TRAILER.
 13834
 13835     IF PI-PAYEE-TYPE = 'P'
 13836        ADD +30                  TO TRLR-SEQ-NO
 13837        GO TO 3600-READ-TRAILER.
 13838
 13839     IF PI-PAYEE-TYPE = 'E'
 13840        ADD +40                  TO TRLR-SEQ-NO.
 13841
 13842 3600-READ-TRAILER.
 13843
 13844
 13845* EXEC CICS HANDLE CONDITION
 13846*         NOTFND(3600-CONTINUE)
 13847*    END-EXEC.
 13848*    MOVE '"$I                   ! - #00013066' TO DFHEIV0
 13849     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13851     MOVE X'2D20233030303133303636' TO DFHEIV0(25:11)
 13852     CALL 'kxdfhei1' USING DFHEIV0
 13853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13854
 13855
 13856     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13857
 13858 3600-CONTINUE.
 13859
 13860     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13861         GO TO 3600-AH-VERIFY
 13862     END-IF.
 13863
 13864     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 13865       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 13866         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 266
* EL156.cbl
 13867           MOVE ER-7576            TO EMI-ERROR
 13868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13869           MOVE -1                 TO PAYEEL
 13870           MOVE AL-UABON           TO PAYEEA
 13871           GO TO 3600-EXIT
 13872         END-IF
 13873       END-IF
 13874     END-IF.
 13875
 13876     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13877     MOVE 1 TO WS-SUB2
 13878     MOVE SPACES TO WS-PAYEE-NAME
 13879     PERFORM VARYING WS-SUB FROM 1 BY 1
 13880             UNTIL WS-SUB > 30
 13881         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13882            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13883                 WS-PAYEE-NAME-X (WS-SUB2)
 13884            ADD +1 TO WS-SUB2
 13885         END-IF
 13886     END-PERFORM.
 13887
 13888     STRING CL-INSURED-1ST-NAME
 13889            CL-INSURED-MID-INIT
 13890            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13891     MOVE 1 TO WS-SUB2
 13892     MOVE SPACES TO WS-INSURED-NAME
 13893     PERFORM VARYING WS-SUB FROM 1 BY 1
 13894             UNTIL WS-SUB > 30
 13895         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13896            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13897                 WS-INSURED-NAME-X (WS-SUB2)
 13898            ADD +1 TO WS-SUB2
 13899         END-IF
 13900     END-PERFORM.
 13901
 13902     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13903        MOVE ER-7579            TO EMI-ERROR
 13904        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13905        MOVE -1                 TO PAYEEL
 13906        MOVE AL-UABON           TO PAYEEA
 13907     END-IF.
 13908
 13909     IF PI-PMTTYPE = '4'  AND
 13910        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 13911        PI-PAYEE-TYPE <> 'I'
 13912          MOVE ER-7580          TO EMI-ERROR
 13913          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13914          MOVE -1               TO PAYEEL
 13915          MOVE AL-UABON         TO PAYEEA
 13916     END-IF.
 13917
 13918     GO TO 3600-EXIT.
 13919
 13920 3600-AH-VERIFY.
 13921
 13922     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 13923        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 13924           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 267
* EL156.cbl
 13925           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13926           MOVE -1                 TO PAYEEL
 13927           MOVE AL-UABON           TO PAYEEA
 13928        END-IF
 13929     END-IF.
 13930
 13931
 13932 3600-EXIT.
 13933     EXIT.
 13934
 13935 5000-UPDATE.
 13936
 13937     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13938
 13939     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13940
 13941     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13942        PI-OFFLINE = 'Y'
 13943        NEXT SENTENCE
 13944     ELSE
 13945        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13946
 13947*    IF PI-COMPANY-ID = 'CRI'
 13948*       IF PI-PMTTYPE = '1' OR  '2'
 13949*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13950*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13951*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 13952
 13953*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13954*       IF PI-PMTTYPE = '1'
 13955*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13956*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13957
 13958     IF PI-PMTTYPE      = '2' AND
 13959        PI-SPLIT-PMT-SW = 'Y' AND
 13960        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13961          MOVE ER-3530                TO EMI-ERROR
 13962          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13963
 13964     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13965        AND (CL-CLAIM-TYPE = 'L')
 13966        IF PI-PMTTYPE = '2' OR '4'
 13967           IF PI-INT-AMT NOT = ZEROS
 13968              PERFORM 7110-BUILD-PMT-TRLR
 13969                                 THRU 7130-EXIT
 13970           ELSE
 13971              IF PI-PMTTYPE = '2'
 13972                 PERFORM 7140-BUILD-NOTE-TRLR
 13973                                 THRU 7170-EXIT
 13974              END-IF
 13975           END-IF
 13976        END-IF
 13977     END-IF
 13978*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13979*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13980*            MOVE 'N'                 TO  WS-LETTER-SW.
 13981
 13982*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 268
* EL156.cbl
 13983*        IF CL-NO-OF-PMTS-MADE = +1
 13984*                OR
 13985*           PI-PMTTYPE = '2'
 13986*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13987
 13988     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13989
 13990*    IF PI-COMPANY-ID = 'DMD'
 13991*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13992*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13993
 13994
 13995* EXEC CICS REWRITE
 13996*         DATASET('ELMSTR')
 13997*         FROM(CLAIM-MASTER)
 13998*     END-EXEC.
 13999     MOVE LENGTH OF
 14000      CLAIM-MASTER
 14001       TO DFHEIV11
 14002     MOVE 'ELMSTR' TO DFHEIV1
 14003*    MOVE '&& L                  %   #00013208' TO DFHEIV0
 14004     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14005     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14006     MOVE X'2020233030303133323038' TO DFHEIV0(25:11)
 14007     CALL 'kxdfhei1' USING DFHEIV0,
 14008           DFHEIV1,
 14009           CLAIM-MASTER,
 14010           DFHEIV11,
 14011           DFHEIV99
 14012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14013
 14014
 14015     IF WS-LETTER-SW = 'N'
 14016         GO TO 5000-END-UPDATE.
 14017
 14018 5000-GENERATE-AUTO-LETTER.
 14019
 14020
 14021* EXEC CICS LINK
 14022*        PROGRAM    (LINK-1523)
 14023*        COMMAREA   (W-1523-LINKDATA)
 14024*        LENGTH     (W-1523-COMM-LENGTH)
 14025*    END-EXEC.
 14026*    MOVE '."C                   (   #00013218' TO DFHEIV0
 14027     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14029     MOVE X'2020233030303133323138' TO DFHEIV0(25:11)
 14030     CALL 'kxdfhei1' USING DFHEIV0,
 14031           LINK-1523,
 14032           W-1523-LINKDATA,
 14033           W-1523-COMM-LENGTH,
 14034           DFHEIV99,
 14035           DFHEIV99,
 14036           DFHEIV99,
 14037           DFHEIV99
 14038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14039
 14040
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 269
* EL156.cbl
 14041     IF W-1523-FATAL-ERROR
 14042         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14044         MOVE ER-0802                TO  EMI-ERROR
 14045         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14046
 14047     IF W-1523-ERROR-CODE = 0191
 14048         MOVE ER-0803                TO  EMI-ERROR
 14049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14050
 14051     IF PI-COMPANY-ID      = 'HAN' AND
 14052        PI-PMTTYPE         = '1'   AND
 14053        PI-3RD-PARTY-SW    = 'Y'   AND
 14054        W-1523-FORM-NUMBER = 'EOB1'
 14055           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14056           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14057           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14058           GO TO 5000-GENERATE-AUTO-LETTER.
 14059
 14060 5000-END-UPDATE.
 14061
 14062     MOVE ER-0000                TO EMI-ERROR.
 14063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14064     GO TO 7000-SHOW-CLAIM.
 14065
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 270
* EL156.cbl
 14067 5000-MOVE-NAME.
 14068     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14069     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14070     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14071
 14072 5000-EXIT.
 14073     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 271
* EL156.cbl
 14075 5300-CREATE-DMO.
 14076
 14077     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14078     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14079     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14080
 14081
 14082* EXEC CICS HANDLE CONDITION
 14083*         NOTFND   (5300-NOTE-NOT-FOUND)
 14084*    END-EXEC.
 14085*    MOVE '"$I                   ! . #00013264' TO DFHEIV0
 14086     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14088     MOVE X'2E20233030303133323634' TO DFHEIV0(25:11)
 14089     CALL 'kxdfhei1' USING DFHEIV0
 14090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14091
 14092
 14093
 14094* EXEC CICS READ
 14095*         DATASET('ERNOTE')
 14096*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14097*         RIDFLD (W-NOTE-KEY)
 14098*    END-EXEC.
 14099     MOVE 'ERNOTE' TO DFHEIV1
 14100*    MOVE '&"S        E          (   #00013268' TO DFHEIV0
 14101     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14102     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14103     MOVE X'2020233030303133323638' TO DFHEIV0(25:11)
 14104     CALL 'kxdfhei1' USING DFHEIV0,
 14105           DFHEIV1,
 14106           DFHEIV20,
 14107           DFHEIV99,
 14108           W-NOTE-KEY,
 14109           DFHEIV99,
 14110           DFHEIV99,
 14111           DFHEIV99
 14112     SET ADDRESS OF CERTIFICATE-NOTE TO
 14113         DFHEIV20
 14114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14115
 14116
 14117     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14118     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14119     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14120
 14121     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14122         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14123     ELSE
 14124         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14125
 14126     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14127     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14128     MOVE 'DLO006'               TO PGM-NAME.
 14129
 14130
 14131* EXEC CICS LINK
 14132*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 272
* EL156.cbl
 14133*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14134*        LENGTH     (DCT-RCRD-LENGTH)
 14135*    END-EXEC.
 14136*    MOVE '."C                   (   #00013287' TO DFHEIV0
 14137     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14139     MOVE X'2020233030303133323837' TO DFHEIV0(25:11)
 14140     CALL 'kxdfhei1' USING DFHEIV0,
 14141           PGM-NAME,
 14142           DCT-COMMUNICATION-AREA,
 14143           DCT-RCRD-LENGTH,
 14144           DFHEIV99,
 14145           DFHEIV99,
 14146           DFHEIV99,
 14147           DFHEIV99
 14148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14149
 14150
 14151     IF DCT-RETURN-CODE = 'OK'
 14152         GO TO 5300-CONT.
 14153
 14154     IF DCT-RETURN-CODE = '01' OR '02'
 14155         GO TO 5300-EXIT.
 14156
 14157     IF DCT-RETURN-CODE = '03'
 14158         MOVE ER-0951            TO EMI-ERROR
 14159         GO TO 5300-BAD-EXIT.
 14160
 14161     IF DCT-RETURN-CODE = '04'
 14162         MOVE ER-0946            TO EMI-ERROR
 14163         GO TO 5300-BAD-EXIT.
 14164
 14165     IF DCT-RETURN-CODE = '05'
 14166         MOVE ER-0947            TO EMI-ERROR
 14167         GO TO 5300-BAD-EXIT.
 14168
 14169     IF DCT-RETURN-CODE = '06'
 14170         MOVE ER-0921            TO EMI-ERROR
 14171         GO TO 5300-BAD-EXIT.
 14172
 14173     IF DCT-RETURN-CODE = '07'
 14174         MOVE ER-0849            TO EMI-ERROR
 14175         GO TO 5300-BAD-EXIT.
 14176
 14177     IF DCT-RETURN-CODE = '08'
 14178         MOVE ER-0948            TO EMI-ERROR
 14179         GO TO 5300-BAD-EXIT.
 14180
 14181     IF DCT-RETURN-CODE = 'N1'
 14182         MOVE ER-0950            TO EMI-ERROR
 14183         GO TO 5300-BAD-EXIT.
 14184
 14185     IF DCT-RETURN-CODE = 'E1'
 14186         MOVE ER-0974            TO EMI-ERROR
 14187         GO TO 5300-BAD-EXIT.
 14188
 14189     IF DCT-RETURN-CODE = 'E2'
 14190         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 273
* EL156.cbl
 14191         GO TO 5300-BAD-EXIT.
 14192
 14193     IF DCT-RETURN-CODE NOT = 'OK'
 14194         MOVE ER-0949            TO EMI-ERROR
 14195         GO TO 5300-BAD-EXIT.
 14196
 14197 5300-CONT.
 14198
 14199     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14200     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14201     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14202     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14203     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14204     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14205     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14206     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14207
 14208     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14209     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14210     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14211     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14212     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14213
 14214     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14215
 14216     IF PI-PMTTYPE = '2'
 14217         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14218         MOVE '4'                TO DM-CLAIM-STATUS
 14219     ELSE
 14220         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14221         MOVE '2'                TO DM-CLAIM-STATUS.
 14222
 14223     MOVE 'DLO025'               TO PGM-NAME.
 14224
 14225
 14226* EXEC CICS LINK
 14227*        PROGRAM    (PGM-NAME)
 14228*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14229*        LENGTH     (DM-DMO-LENGTH)
 14230*    END-EXEC.
 14231*    MOVE '."C                   (   #00013367' TO DFHEIV0
 14232     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14234     MOVE X'2020233030303133333637' TO DFHEIV0(25:11)
 14235     CALL 'kxdfhei1' USING DFHEIV0,
 14236           PGM-NAME,
 14237           DMO-COMMUNICATION-AREA,
 14238           DM-DMO-LENGTH,
 14239           DFHEIV99,
 14240           DFHEIV99,
 14241           DFHEIV99,
 14242           DFHEIV99
 14243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14244
 14245
 14246     IF DM-RETURN-CODE = 'OK'
 14247         GO TO 5300-EXIT.
 14248
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 274
* EL156.cbl
 14249     IF DM-RETURN-CODE = '01'
 14250         MOVE ER-8051            TO EMI-ERROR
 14251         GO TO 5300-BAD-EXIT.
 14252
 14253     IF DM-RETURN-CODE = '02'
 14254         MOVE ER-8052            TO EMI-ERROR
 14255         GO TO 5300-BAD-EXIT.
 14256
 14257     IF DM-RETURN-CODE = '03'
 14258         MOVE ER-8053            TO EMI-ERROR
 14259         GO TO 5300-BAD-EXIT.
 14260
 14261     IF DM-RETURN-CODE = '04'
 14262         MOVE ER-8054            TO EMI-ERROR
 14263         GO TO 5300-BAD-EXIT.
 14264
 14265     IF DM-RETURN-CODE = '05'
 14266         MOVE ER-8055            TO EMI-ERROR
 14267         GO TO 5300-BAD-EXIT.
 14268
 14269     IF DM-RETURN-CODE = '06'
 14270         MOVE ER-8056            TO EMI-ERROR
 14271         GO TO 5300-BAD-EXIT.
 14272
 14273     IF DM-RETURN-CODE = '07'
 14274         MOVE ER-8057            TO EMI-ERROR
 14275         GO TO 5300-BAD-EXIT.
 14276
 14277     IF DM-RETURN-CODE = '08'
 14278         MOVE ER-8058            TO EMI-ERROR
 14279         GO TO 5300-BAD-EXIT.
 14280
 14281     IF DM-RETURN-CODE = '09'
 14282         MOVE ER-8059            TO EMI-ERROR
 14283         GO TO 5300-BAD-EXIT.
 14284
 14285     IF DM-RETURN-CODE = '10'
 14286         MOVE ER-8060            TO EMI-ERROR
 14287         GO TO 5300-BAD-EXIT.
 14288
 14289     IF DM-RETURN-CODE = '11'
 14290         MOVE ER-8061            TO EMI-ERROR
 14291         GO TO 5300-BAD-EXIT.
 14292
 14293     IF DM-RETURN-CODE = '12'
 14294         MOVE ER-8062            TO EMI-ERROR
 14295         GO TO 5300-BAD-EXIT.
 14296
 14297     IF DM-RETURN-CODE = '13'
 14298         MOVE ER-8063            TO EMI-ERROR
 14299         GO TO 5300-BAD-EXIT.
 14300
 14301     IF DM-RETURN-CODE = '14'
 14302         MOVE ER-8064            TO EMI-ERROR
 14303         GO TO 5300-BAD-EXIT.
 14304
 14305     IF DM-RETURN-CODE = '15'
 14306         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 275
* EL156.cbl
 14307         GO TO 5300-BAD-EXIT.
 14308
 14309     IF DM-RETURN-CODE = '16'
 14310         MOVE ER-8154            TO EMI-ERROR
 14311         GO TO 5300-BAD-EXIT.
 14312
 14313     IF DM-RETURN-CODE = '17'
 14314         MOVE ER-8155            TO EMI-ERROR
 14315         GO TO 5300-BAD-EXIT.
 14316
 14317     IF DM-RETURN-CODE = 'N1'
 14318         MOVE ER-8152            TO EMI-ERROR
 14319         GO TO 5300-BAD-EXIT.
 14320
 14321     IF DM-RETURN-CODE = 'E1'
 14322         MOVE ER-8153            TO EMI-ERROR
 14323         GO TO 5300-BAD-EXIT.
 14324
 14325     MOVE ER-8066            TO EMI-ERROR.
 14326     GO TO 5300-BAD-EXIT.
 14327
 14328 5300-NOTE-NOT-FOUND.
 14329
 14330     MOVE ER-0954                TO EMI-ERROR.
 14331     GO TO 5300-BAD-EXIT.
 14332
 14333 5300-BAD-EXIT.
 14334
 14335* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14336*    MOVE '6"R                   !   #00013461' TO DFHEIV0
 14337     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14339     MOVE X'2020233030303133343631' TO DFHEIV0(25:11)
 14340     CALL 'kxdfhei1' USING DFHEIV0
 14341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14342
 14343     IF MAP-NAME = 'EL156A'
 14344         MOVE -1             TO ENTERPFL
 14345       ELSE
 14346         MOVE LOW-VALUES     TO EL156BI
 14347         MOVE -1             TO ENTPFBL.
 14348
 14349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14350     GO TO 8200-SEND-DATAONLY.
 14351
 14352 5300-EXIT.
 14353     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 276
* EL156.cbl
 14355 5350-FORMAT-LAST-NAME-1ST.
 14356*****************************************************************
 14357*             M O V E   N A M E   R O U T I N E                 *
 14358*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14359*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14360*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14361*                  FIELD                   VALUE                *
 14362*           W-NAME-LAST    (CL15)      SMITH                    *
 14363*           W-NAME-FIRST   (CL15)      JOHN                     *
 14364*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14365*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14366*     CONTAIN                                                   *
 14367*                SMITH, JOHN ALLEN                              *
 14368*     OR                                                        *
 14369*                SMITH, JOHN A.                                 *
 14370*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14371*     COPYBOOK, ELCNWA.                                         *
 14372*****************************************************************.
 14373
 14374     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14375     MOVE ZERO                   TO  WS-NAME-SW.
 14376     SET NWA-INDEX               TO +1.
 14377
 14378     IF W-NAME-LAST   = SPACES AND
 14379        W-NAME-MIDDLE = SPACES
 14380         MOVE +1                 TO WS-NAME-SW.
 14381
 14382     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14383     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14384
 14385     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14386     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14387
 14388     SET NWA-INDEX UP BY +1.
 14389
 14390     IF W-NAME-MIDDLE NOT = SPACES
 14391         IF W-NAME-MIDDLE-2 = SPACES
 14392             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14393             SET NWA-INDEX UP BY +1
 14394             MOVE '.'            TO WS-NW (NWA-INDEX)
 14395             SET NWA-INDEX UP BY +2
 14396         ELSE
 14397             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14398             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14399
 14400 5350-EXIT.
 14401     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 277
* EL156.cbl
 14403 5360-MOVE-NAME.
 14404
 14405     IF WS-NAME-SW > +1
 14406         GO TO 5360-EXIT.
 14407
 14408     IF WS-NAME-WORK2 = SPACES
 14409         GO TO 5360-EXIT.
 14410
 14411     SET NWA-INDEX2            TO +1.
 14412     SET NWA-INDEX3            TO +2.
 14413
 14414 5360-MOVE-NAME-CYCLE.
 14415
 14416     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14417
 14418     IF NWA-INDEX < +30
 14419         SET NWA-INDEX UP BY +1
 14420     ELSE
 14421         ADD +2                TO  WS-NAME-SW
 14422         GO TO 5360-EXIT.
 14423
 14424     IF NWA-INDEX2 < +20
 14425         SET NWA-INDEX3 UP BY +1
 14426         SET NWA-INDEX2 UP BY +1.
 14427
 14428     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14429        WS-NW2 (NWA-INDEX3) = SPACES
 14430         IF WS-NAME-SW = ZERO
 14431             MOVE ','            TO  WS-NW (NWA-INDEX)
 14432             SET NWA-INDEX UP BY +2
 14433             MOVE +1             TO  WS-NAME-SW
 14434             GO TO 5360-EXIT
 14435         ELSE
 14436             GO TO 5360-EXIT.
 14437
 14438     GO TO 5360-MOVE-NAME-CYCLE.
 14439
 14440 5360-EXIT.
 14441     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 278
* EL156.cbl
 14443 6000-BUILD-SCREEN-B.
 14444     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14445     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14446     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14447     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14448
 14449     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14450
 14451 6050-BUILD-SCREEN.
 14452     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14453     MOVE LOW-VALUES             TO EL156BI.
 14454     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14455
 14456     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14457
 14458     IF PI-PAYEE-TYPE = 'I'
 14459        GO TO 6060-READ-TRAILER.
 14460
 14461     IF PI-PAYEE-TYPE = 'B'
 14462        ADD +10                  TO TRLR-SEQ-NO
 14463        GO TO 6060-READ-TRAILER.
 14464
 14465     IF PI-PAYEE-TYPE = 'A'
 14466        ADD +20                  TO TRLR-SEQ-NO
 14467        GO TO 6060-READ-TRAILER.
 14468
 14469     IF PI-PAYEE-TYPE = 'O'
 14470        ADD +50                  TO TRLR-SEQ-NO
 14471        GO TO 6060-READ-TRAILER.
 14472
 14473     IF PI-PAYEE-TYPE = 'Q'
 14474        ADD +60                  TO TRLR-SEQ-NO
 14475        GO TO 6060-READ-TRAILER.
 14476
 14477     IF PI-PAYEE-TYPE = 'P'
 14478        ADD +30                  TO TRLR-SEQ-NO
 14479        GO TO 6060-READ-TRAILER.
 14480
 14481     IF PI-PAYEE-TYPE = 'E'
 14482        ADD +40                  TO TRLR-SEQ-NO.
 14483
 14484 6060-READ-TRAILER.
 14485
 14486     IF PI-PAYEE-TYPE    = 'A' AND
 14487        PI-PAYEE-SEQ-NUM = 0
 14488          GO TO 6061-READ-ACCOUNT.
 14489
 14490     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14491        (PI-PAYEE-TYPE    = 'B')             AND
 14492        (PI-PAYEE-SEQ-NUM = 9)
 14493          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14494          IF BENE-FOUND-SW = 'N'
 14495            GO TO 6065-NOT-FOUND
 14496          ELSE
 14497            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14498            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14499            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14500*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 279
* EL156.cbl
 14501            STRING BE-CITY ' ' BE-STATE
 14502               DELIMITED BY '  ' INTO CITYSTBO
 14503            END-STRING
 14504            MOVE BE-ZIP-CODE       TO ZIPBO
 14505            GO TO 6061-READ-ACCOUNT.
 14506
 14507     IF PI-PAYEE-TYPE    = 'B' AND
 14508        PI-PAYEE-SEQ-NUM = 0
 14509          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14510          IF BENE-FOUND-SW = 'N'
 14511            GO TO 6065-NOT-FOUND
 14512          ELSE
 14513            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14514            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14515            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14516*           MOVE BE-CITY-STATE     TO CITYSTBO
 14517            STRING BE-CITY ' ' BE-STATE
 14518               DELIMITED BY '  ' INTO CITYSTBO
 14519            END-STRING
 14520            MOVE BE-ZIP-CODE       TO ZIPBO
 14521            GO TO 6061-READ-ACCOUNT.
 14522
 14523
 14524* EXEC CICS HANDLE CONDITION
 14525*         NOTFND(6065-NOT-FOUND)
 14526*     END-EXEC.
 14527*    MOVE '"$I                   ! / #00013642' TO DFHEIV0
 14528     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14530     MOVE X'2F20233030303133363432' TO DFHEIV0(25:11)
 14531     CALL 'kxdfhei1' USING DFHEIV0
 14532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14533
 14534
 14535     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14536
 14537     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14538     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14539     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14540     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14541*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14542     STRING AT-CITY ' ' AT-STATE
 14543        DELIMITED BY '  ' INTO CITYSTBO
 14544     END-STRING
 14545     MOVE AT-ZIP-CODE            TO ZIPBO.
 14546
 14547 6061-READ-ACCOUNT.
 14548
 14549* EXEC CICS HANDLE CONDITION
 14550*         NOTFND(6068-ACCT-NOT-FND)
 14551*     END-EXEC.
 14552*    MOVE '"$I                   ! 0 #00013659' TO DFHEIV0
 14553     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14555     MOVE X'3020233030303133363539' TO DFHEIV0(25:11)
 14556     CALL 'kxdfhei1' USING DFHEIV0
 14557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14558
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 280
* EL156.cbl
 14559
 14560
 14561* EXEC CICS READ
 14562*         DATASET('ERACCT')
 14563*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14564*         RIDFLD (PI-ACCT-KEY)
 14565*     END-EXEC.
 14566     MOVE 'ERACCT' TO DFHEIV1
 14567*    MOVE '&"S        E          (   #00013663' TO DFHEIV0
 14568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14570     MOVE X'2020233030303133363633' TO DFHEIV0(25:11)
 14571     CALL 'kxdfhei1' USING DFHEIV0,
 14572           DFHEIV1,
 14573           DFHEIV20,
 14574           DFHEIV99,
 14575           PI-ACCT-KEY,
 14576           DFHEIV99,
 14577           DFHEIV99,
 14578           DFHEIV99
 14579     SET ADDRESS OF ACCOUNT-MASTER TO
 14580         DFHEIV20
 14581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14582
 14583
 14584     MOVE AM-CARRIER             TO ACARRBO.
 14585     MOVE AM-GROUPING            TO GROUPBO.
 14586     MOVE AM-STATE               TO STATEBO.
 14587     MOVE AM-ACCOUNT             TO ACCTBO.
 14588     MOVE AM-NAME                TO ACCTNMBO.
 14589
 14590     IF PI-PAYEE-TYPE = 'A' AND
 14591        PI-PAYEE-SEQ-NUM = 0
 14592          MOVE AM-NAME             TO NAMEBO
 14593                                      PI-PAYEE-NAME
 14594          MOVE AM-ADDRS            TO ADDR1BO
 14595          MOVE SPACES              TO ADDR2BO
 14596*         MOVE AM-CITY             TO CITYSTBO
 14597          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14598             DELIMITED BY '  ' INTO CITYSTBO
 14599          END-STRING
 14600          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14601          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14602          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14603          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14604
 14605     IF CITYSTBO EQUAL SPACES
 14606         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14607         GO TO 6070-FORMAT-DATA
 14608     END-IF.
 14609
 14610     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14611     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14612     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14613     PERFORM VARYING WS-SUB FROM 30 BY -1
 14614          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14615        IF WS-END-SUB = 0  AND
 14616           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 281
* EL156.cbl
 14617              OR LOW-VALUES  OR '.')
 14618            CONTINUE
 14619        ELSE
 14620            IF WS-END-SUB = 0
 14621                MOVE WS-SUB TO WS-END-SUB
 14622            ELSE
 14623                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14624                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14625                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14626                END-IF
 14627            END-IF
 14628        END-IF
 14629        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14630            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14631            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14632        END-IF
 14633     END-PERFORM.
 14634
 14635     IF WS-BEG-SUB > 0
 14636         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14637         IF WS-STATE-LENGTH = 2
 14638             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14639                  TO PI-CHECK-STATE-FOR-AK
 14640         ELSE
 14641             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14642                'ALASKA'
 14643                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14644             ELSE
 14645                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14646             END-IF
 14647         END-IF
 14648     ELSE
 14649         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14650     END-IF.
 14651
 14652     GO TO 6070-FORMAT-DATA.
 14653
 14654 6065-NOT-FOUND.
 14655     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14656     GO TO 6061-READ-ACCOUNT.
 14657
 14658 6068-ACCT-NOT-FND.
 14659     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14660
 14661 6070-FORMAT-DATA.
 14662     IF PI-HOLDTIL = ZEROS
 14663        MOVE SAVE-DATE           TO PAYDTBI
 14664       ELSE
 14665        MOVE PI-HOLDTIL          TO PAYDTBO
 14666        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14667
 14668     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14669     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14670
 14671     IF EIBAID = DFHPF3 OR DFHPF4
 14672        NEXT SENTENCE
 14673     ELSE
 14674       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 282
* EL156.cbl
 14675
 14676     MOVE PI-EPYFROM          TO PYFROMBO.
 14677     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14678
 14679     IF NOT PI-USES-PAID-TO
 14680        MOVE PI-EPYTHRU          TO PYTHRUBO
 14681        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14682     ELSE
 14683        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14684        MOVE '4'              TO DC-OPTION-CODE
 14685        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14686        IF NO-CONVERSION-ERROR
 14687           MOVE +1            TO DC-ELAPSED-DAYS
 14688           MOVE +0            TO DC-ELAPSED-MONTHS
 14689           MOVE '6'           TO DC-OPTION-CODE
 14690           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14691           IF NO-CONVERSION-ERROR
 14692              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14693
 14694     MOVE PI-EDAYS            TO DAYSBO.
 14695     MOVE PI-EPYAMT           TO PAYAMTBO.
 14696     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14697        IF PI-INT-AMT > ZEROS
 14698           MOVE PI-INT-AMT       TO INTAMTBO
 14699        END-IF
 14700     END-IF
 14701     GO TO 6072-SET-TYPE.
 14702
 14703 6071-CONTINUE.
 14704
 14705     IF PI-CPYFROM NOT = LOW-VALUES
 14706        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14707        MOVE SPACES              TO DC-OPTION-CODE
 14708        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14709        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14710
 14711     IF PI-CPYTHRU NOT = LOW-VALUES
 14712        IF NOT PI-USES-PAID-TO
 14713           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14714           MOVE SPACES             TO DC-OPTION-CODE
 14715           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14716           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14717        ELSE
 14718           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14719           MOVE '6'                TO DC-OPTION-CODE
 14720           MOVE +1                 TO DC-ELAPSED-DAYS
 14721           MOVE +0                 TO DC-ELAPSED-MONTHS
 14722           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14723           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14724
 14725     MOVE PI-CDAYS               TO DAYSBO.
 14726     MOVE PI-CPYAMT              TO PAYAMTBO.
 14727     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14728        IF PI-INT-AMT > ZEROS
 14729           MOVE PI-INT-AMT       TO INTAMTBO
 14730        END-IF
 14731     END-IF
 14732     .
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 283
* EL156.cbl
 14733 6072-SET-TYPE.
 14734     IF PI-PMTTYPE = '1'
 14735        MOVE 'PARTIAL'           TO PAYTYPBO.
 14736
 14737     IF PI-PMTTYPE = '2'
 14738        MOVE 'FINAL'             TO PAYTYPBO.
 14739
 14740     IF PI-PMTTYPE = '3'
 14741        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14742
 14743     IF PI-PMTTYPE = '4'
 14744        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14745
 14746     IF PI-PMTTYPE = '5'
 14747        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14748
 14749     IF PI-PMTTYPE = '6'
 14750        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14751
 14752     IF PI-PROV-PMT
 14753        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14754
 14755     IF PI-ECHECKNO NOT = SPACES
 14756        MOVE PI-ECHECKNO         TO CKNUMBO
 14757     ELSE
 14758        MOVE PI-CCHECKNO         TO CKNUMBO.
 14759
 14760     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14761        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14762        MOVE +91                 TO  TRLR-SEQ-NO
 14763
 14764* EXEC CICS READ
 14765*           DATASET  ('ELTRLR')
 14766*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14767*           RIDFLD   (ELTRLR-KEY)
 14768*           RESP     (WS-RESPONSE)
 14769*       END-EXEC
 14770     MOVE 'ELTRLR' TO DFHEIV1
 14771*    MOVE '&"S        E          (  N#00013848' TO DFHEIV0
 14772     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14773     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14774     MOVE X'204E233030303133383438' TO DFHEIV0(25:11)
 14775     CALL 'kxdfhei1' USING DFHEIV0,
 14776           DFHEIV1,
 14777           DFHEIV20,
 14778           DFHEIV99,
 14779           ELTRLR-KEY,
 14780           DFHEIV99,
 14781           DFHEIV99,
 14782           DFHEIV99
 14783     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14784         DFHEIV20
 14785     MOVE EIBRESP  TO WS-RESPONSE
 14786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14787
 14788        IF WS-RESP-NORMAL
 14789           MOVE AT-INFO-LINE-1   TO  LOANNBO
 14790        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 284
* EL156.cbl
 14791           MOVE SPACES           TO  LOANNBO
 14792        END-IF
 14793     END-IF
 14794
 14795*       MOVE PI-LOAN-NO          TO LOANNBO
 14796
 14797     IF CKNUMBO = SPACES
 14798         MOVE SPACES             TO CKNUMHDO.
 14799
 14800     MOVE CL-CLAIM-NO            TO CLMNOBO.
 14801     MOVE CL-CARRIER             TO CARRBO.
 14802     MOVE CL-CERT-PRIME          TO CERTNOBO.
 14803     MOVE CL-CERT-SFX            TO SUFXBO.
 14804
 14805     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14806        EVALUATE CL-CLAIM-TYPE
 14807           WHEN 'I'
 14808              MOVE '  IU  '      TO CLMTYPBO
 14809           WHEN 'G'
 14810              MOVE ' GAP  '      TO CLMTYPBO
 14811           WHEN OTHER
 14812              MOVE PI-AH-OVERRIDE-L6
 14813                                 TO CLMTYPBO
 14814        END-EVALUATE
 14815        MOVE ZEROS               TO UNDISBO
 14816*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 14817        IF PI-PMTTYPE = '5' OR '6'
 14818           GO TO 6073-GET-NOTIFY-DATA
 14819        ELSE
 14820           MOVE PI-DAILY-RATE    TO RATEBO
 14821           GO TO 6073-GET-NOTIFY-DATA.
 14822
 14823     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 14824
 14825     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 14826        MOVE ZEROS               TO UNDISBO
 14827     ELSE
 14828        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 14829
 14830 6073-GET-NOTIFY-DATA.
 14831
 14832     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 14833
 14834     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 14835         MOVE SPACES             TO  NAMEB2O
 14836                                     ADDR1B2O
 14837                                     ADDR2B2O
 14838                                     CITYST2O
 14839                                     AGTHDGO
 14840         MOVE ZEROS              TO  ZIPB2O
 14841         GO TO 6080-SET-INCURRED.
 14842
 14843     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 14844     MOVE +29                    TO  TRLR-SEQ-NO.
 14845
 14846
 14847* EXEC CICS HANDLE CONDITION
 14848*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 285
* EL156.cbl
 14849*    END-EXEC.
 14850*    MOVE '"$I                   ! 1 #00013913' TO DFHEIV0
 14851     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14853     MOVE X'3120233030303133393133' TO DFHEIV0(25:11)
 14854     CALL 'kxdfhei1' USING DFHEIV0
 14855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14856
 14857
 14858     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14859
 14860     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 14861     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 14862     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 14863*    MOVE AT-CITY-STATE          TO  CITYST2O.
 14864     STRING AT-CITY ' ' AT-STATE
 14865        DELIMITED BY '  ' INTO CITYST2O
 14866     END-STRING
 14867     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 14868     GO TO 6080-SET-INCURRED.
 14869
 14870 6074-GET-COMP-DATA.
 14871
 14872     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 14873         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 14874
 14875     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 14876         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 14877                                         ADDR1B2O
 14878                                         ADDR2B2O
 14879                                         CITYST2O
 14880         MOVE ZEROS                  TO  ZIPB2O
 14881         GO TO 6080-SET-INCURRED.
 14882
 14883     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 14884     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 14885     MOVE AM-CARRIER             TO  COMP-CARRIER.
 14886     MOVE AM-GROUPING            TO  COMP-GROUP.
 14887     MOVE 'A'                    TO  COMP-TYPE.
 14888     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14889                                 TO  COMP-FIN-RESP.
 14890
 14891     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 14892         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 14893                                       'G' OR 'B'
 14894             MOVE 'G'            TO  COMP-TYPE
 14895             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14896         ELSE
 14897             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14898                                 TO  COMP-ACCOUNT
 14899     ELSE
 14900         MOVE 'G'                TO  COMP-TYPE
 14901         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14902
 14903     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14904
 14905     IF COMP-REC-FOUND
 14906         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 286
* EL156.cbl
 14907         MOVE CO-ADDR-1          TO  ADDR1B2O
 14908         MOVE CO-ADDR-2          TO  ADDR2B2O
 14909*        MOVE CO-ADDR-3          TO  CITYST2O
 14910         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14911            DELIMITED BY '  ' INTO CITYST2O
 14912         END-STRING
 14913         MOVE CO-ZIP             TO  ZIPB2O
 14914     ELSE
 14915         MOVE 'NO COMP ADDRESS AVAILABLE'
 14916                                 TO  NAMEB2O
 14917                                     ADDR1B2O
 14918                                     ADDR2B2O
 14919                                     CITYST2O
 14920         MOVE ZEROS               TO ZIPB2O.
 14921
 14922 6080-SET-INCURRED.
 14923     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14924     MOVE SPACES                 TO DC-OPTION-CODE.
 14925     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14926     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14927     MOVE PI-PROCESSOR-ID        TO BYBO.
 14928     MOVE MAP-NAMEB              TO MAP-NAME.
 14929     MOVE 'C'                    TO PI-PASS-SW.
 14930     MOVE EIBAID                 TO PI-PFKEY-USED.
 14931     MOVE -1                     TO ENTPFBL.
 14932     GO TO 8100-SEND-INITIAL-MAP.
 14933
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 287
* EL156.cbl
 14935 6100-BUILD-PAYMENT-TRAILER.
 14936
 14937     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14938       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14939         GO TO 6105-STATE-CHECK-NUMBER
 14940     END-IF.
 14941
 14942     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14943     MOVE '6'                    TO CNTL-REC-TYPE.
 14944
 14945     IF CONTROL-IS-ACTUAL-CARRIER
 14946         MOVE PI-CARRIER         TO WS-CARR
 14947     ELSE
 14948         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14949
 14950     IF PI-COMPANY-ID = 'FIA'
 14951         MOVE PI-CARRIER         TO  WS-CARR.
 14952
 14953     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14954     MOVE 0                      TO CNTL-SEQ-NO.
 14955     MOVE 'CARR'                 TO FILE-SWITCH.
 14956
 14957     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14958
 14959     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14960         IF PI-OFFLINE     = 'Y' AND
 14961            PI-ECHECKNO-CR = 'CR'
 14962              GO TO 6110-READ-CONTROL
 14963         ELSE
 14964            IF PI-CASH = 'N'
 14965                GO TO 6110-READ-CONTROL.
 14966
 14967     IF CHECK-NO-MANUAL    OR
 14968        CHECK-NO-AT-PRINT  OR
 14969        PI-OFFLINE = 'Y'
 14970          GO TO 6130-BUILD-TRAILER.
 14971
 14972     IF PI-COMPANY-ID = 'FIA'
 14973         NEXT SENTENCE
 14974     ELSE
 14975         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14976             GO TO 6110-READ-CONTROL.
 14977
 14978     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14979
 14980     IF CHECK-CNT-RESET-VALUE
 14981        MOVE +1                  TO CF-CHECK-COUNTER
 14982     ELSE
 14983        ADD +1                   TO CF-CHECK-COUNTER.
 14984
 14985     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14986
 14987     IF CHECK-NO-CARR-SEQ
 14988        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14989
 14990     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14991
 14992     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 288
* EL156.cbl
 14993     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 14994        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 14995         MOVE 'Y' TO PI-REAUDIT-NEEDED
 14996         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 14997            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 14998         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 14999                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15000     END-IF.
 15001
 15002     GO TO 6120-REWRITE.
 15003
 15004 6105-STATE-CHECK-NUMBER.
 15005     IF CHECK-NO-MANUAL    OR
 15006        CHECK-NO-AT-PRINT  OR
 15007        PI-OFFLINE = 'Y'
 15008           GO TO 6130-BUILD-TRAILER
 15009     END-IF.
 15010
 15011     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15012     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15013     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15014     MOVE '3'                TO CNTL-REC-TYPE.
 15015     MOVE +0                 TO CNTL-SEQ-NO.
 15016     MOVE 'STAT'             TO FILE-SWITCH.
 15017     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15018
 15019     IF CF-ST-CHECK-CNT-RESET
 15020         MOVE +1             TO CF-ST-CHECK-COUNTER
 15021     ELSE
 15022         ADD +1              TO CF-ST-CHECK-COUNTER
 15023     END-IF.
 15024
 15025     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15026     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15027     GO TO 6120-REWRITE.
 15028
 15029 6110-READ-CONTROL.
 15030     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15031     MOVE '1'                    TO CNTL-REC-TYPE.
 15032     MOVE SPACES                 TO CNTL-ACCESS.
 15033     MOVE 0                      TO CNTL-SEQ-NO.
 15034
 15035     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15036
 15037     IF CO-CHECK-COUNT-RESET
 15038        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15039     ELSE
 15040        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15041
 15042     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15043
 15044     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15045         IF PI-OFFLINE     = 'Y'  AND
 15046            PI-ECHECKNO-CR = 'CR'
 15047              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15048              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15049              MOVE AL-UANON           TO CHECKNOA
 15050              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 289
* EL156.cbl
 15051         ELSE
 15052         IF PI-CASH = 'N'
 15053             MOVE 'N'                TO PI-ECHECKNO-N
 15054             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15055             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15056             MOVE AL-UANON           TO CHECKNOA
 15057             GO TO 6120-REWRITE.
 15058
 15059     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15060
 15061 6120-REWRITE.
 15062
 15063* EXEC CICS REWRITE
 15064*         DATASET('ELCNTL')
 15065*         FROM(CONTROL-FILE)
 15066*     END-EXEC.
 15067     MOVE LENGTH OF
 15068      CONTROL-FILE
 15069       TO DFHEIV11
 15070     MOVE 'ELCNTL' TO DFHEIV1
 15071*    MOVE '&& L                  %   #00014121' TO DFHEIV0
 15072     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15073     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15074     MOVE X'2020233030303134313231' TO DFHEIV0(25:11)
 15075     CALL 'kxdfhei1' USING DFHEIV0,
 15076           DFHEIV1,
 15077           CONTROL-FILE,
 15078           DFHEIV11,
 15079           DFHEIV99
 15080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15081
 15082
 15083     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15084
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 290
* EL156.cbl
 15086 6130-BUILD-TRAILER.
 15087
 15088
 15089* EXEC CICS GETMAIN
 15090*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15091*         LENGTH    (200)
 15092*         INITIMG   (GETMAIN-SPACE)
 15093*     END-EXEC.
 15094     MOVE 200
 15095       TO DFHEIV11
 15096*    MOVE ',"IL                  $   #00014131' TO DFHEIV0
 15097     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15098     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15099     MOVE X'2020233030303134313331' TO DFHEIV0(25:11)
 15100     CALL 'kxdfhei1' USING DFHEIV0,
 15101           DFHEIV20,
 15102           DFHEIV11,
 15103           GETMAIN-SPACE
 15104     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15105         DFHEIV20
 15106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15107
 15108
 15109     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15110                                    AT-PREV-PAID-THRU-DT.
 15111     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15112     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15113     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15114     MOVE 'AT'                   TO AT-RECORD-ID.
 15115     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15116
 15117     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15118        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15119           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15120     ELSE
 15121           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15122           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15123
 15124     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15125         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15126             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15127             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15128           ELSE
 15129             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15130             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15131
 15132     MOVE '2'                    TO AT-TRAILER-TYPE.
 15133     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15134                                    AT-PAYMENT-LAST-MAINT-DT.
 15135     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15136                                    AT-PAYMENT-LAST-UPDATED-BY.
 15137     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15138     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15139     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15140     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15141
 15142     IF PI-PMT-APPROVED
 15143        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 291
* EL156.cbl
 15144           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15145
 15146     IF PI-PFKEY-USED = DFHPF5
 15147        GO TO 6140-PF5-ENTERED.
 15148
 15149     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15150     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15151
 15152     IF PI-AIG-SPECIAL-BENEFIT
 15153         IF WS-1ST-SPECIAL-PMT
 15154             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15155             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15156                                        AT-AMOUNT-PAID
 15157         ELSE
 15158             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15159
 15160     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15161
 15162     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15163     MOVE '4'                    TO DC-OPTION-CODE.
 15164     PERFORM 9700-LINK-DATE-CONVERT.
 15165
 15166     IF DATE-CONVERSION-ERROR
 15167        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15168     ELSE
 15169        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15170
 15171     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15172     MOVE '4'                    TO DC-OPTION-CODE.
 15173     PERFORM 9700-LINK-DATE-CONVERT.
 15174
 15175     IF DATE-CONVERSION-ERROR
 15176        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15177     ELSE
 15178        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15179
 15180     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15181     GO TO 6150-FINISH-MOVE.
 15182
 15183 6140-PF5-ENTERED.
 15184     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15185     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15186
 15187     IF PI-AIG-SPECIAL-BENEFIT
 15188         IF WS-1ST-SPECIAL-PMT
 15189             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15190             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15191                                        AT-AMOUNT-PAID
 15192         ELSE
 15193             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15194
 15195     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15196     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15197     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15198
 15199 6150-FINISH-MOVE.
 15200
 15201     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 292
* EL156.cbl
 15202         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15203     ELSE
 15204         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15205
 15206     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15207     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15208
 15209*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15210*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15211
 15212     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15213         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15214
 15215     IF PI-OFFLINE = 'N'
 15216        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15217        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15218     ELSE
 15219        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15220        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15221
 15222     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15223
 15224     IF WS-2ND-SPECIAL-PMT
 15225         MOVE 'Y'                TO AT-CASH-PAYMENT
 15226         MOVE SPACES             TO AT-CHECK-NO
 15227         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15228         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15229         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15230         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15231
 15232     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15233                                    AT-TO-BE-WRITTEN-DT.
 15234
 15235     IF PI-HOLDTIL NOT = ZEROS
 15236        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15237        MOVE '4'                 TO DC-OPTION-CODE
 15238        PERFORM 9700-LINK-DATE-CONVERT
 15239        IF PI-OFFLINE = 'N'
 15240           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15241        ELSE
 15242           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15243
 15244     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15245     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15246                                    AT-CHECK-QUE-SEQUENCE.
 15247
 15248     IF PI-PFKEY-USED = DFHPF4
 15249        MOVE '1'                 TO AT-FORCE-CONTROL.
 15250
 15251     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15252        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15253        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15254        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15255
 15256     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15257                                    AT-VOID-SELECT-DT
 15258                                    AT-VOID-ACCEPT-DT
 15259                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 293
* EL156.cbl
 15260     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15261        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15262        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15263        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15264        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15265     ELSE
 15266        MOVE ZEROS               TO AT-DAILY-RATE
 15267                                    AT-ELIMINATION-DAYS
 15268        MOVE SPACES              TO AT-BENEFIT-TYPE
 15269     END-IF
 15270     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15271     MOVE '4'                    TO DC-OPTION-CODE.
 15272     PERFORM 9700-LINK-DATE-CONVERT.
 15273     IF DATE-CONVERSION-ERROR
 15274         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15275     ELSE
 15276         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15277     END-IF.
 15278     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15279     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15280     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15281     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15282     IF PI-REAUDIT-NEEDED = 'Y'
 15283         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15284         MOVE 'Y' TO WS-NEED-APPROVAL
 15285         GO TO 6170-WRITE
 15286     END-IF.
 15287*******************************************************
 15288     IF NOT PI-PMT-GRADUATED
 15289         GO TO 6170-WRITE.
 15290
 15291     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15292     MOVE '1'                    TO CNTL-REC-TYPE.
 15293     MOVE SPACES                 TO CNTL-ACCESS.
 15294     MOVE +0                     TO CNTL-SEQ-NO.
 15295     MOVE 'COMP'                 TO FILE-SWITCH.
 15296
 15297     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15298
 15299     IF PAID-FOR-LIFE
 15300         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15301             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15302                                     WS-PMT-APPROVAL-SW
 15303             GO TO 6170-WRITE.
 15304
 15305*05999      IF PAID-FOR-AH
 15306     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15307         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15308             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15309                                     WS-PMT-APPROVAL-SW
 15310             GO TO 6170-WRITE.
 15311
 15312     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15313
 15314******A&H Limits are set as a monthly payment.  Calculate the mont
 15315******equivalent of the amount paid today
 15316     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15317        PI-SAVE-ODD-DAYS-OVER > 0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 294
* EL156.cbl
 15318           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15319                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15320           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15321                                  WS-CALC-PMT-MONTHS
 15322     ELSE
 15323           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15324     END-IF.
 15325*06007      IF ((PAID-FOR-AH) AND
 15326     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15327*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15328        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15329              OR
 15330        ((PAID-FOR-LIFE) AND
 15331        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15332            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15333       ELSE
 15334*06014      IF ((PAID-FOR-AH)  AND
 15335         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15336*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15337           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15338              OR
 15339        ((PAID-FOR-LIFE) AND
 15340        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15341            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15342         ELSE
 15343*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15344           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15345               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15346              OR
 15347          ((PAID-FOR-LIFE) AND
 15348          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15349            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15350       ELSE
 15351           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15352               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15353              OR
 15354          ((PAID-FOR-LIFE) AND
 15355          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15356            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15357       ELSE
 15358            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15359
 15360     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15361        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15362        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15363            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15364        END-IF
 15365     ELSE
 15366     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15367        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15368        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15369            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15370        END-IF
 15371     ELSE
 15372     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15373        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15374        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15375            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 295
* EL156.cbl
 15376        END-IF
 15377     ELSE
 15378     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15379        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15380        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15381            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15382        END-IF
 15383     ELSE
 15384     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15385            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15386
 15387     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15388
 15389     IF NOT PI-PMT-GRADUATED
 15390         GO TO 6170-WRITE.
 15391
 15392
 15393* EXEC CICS HANDLE CONDITION
 15394*        NOTFND   (6170-WRITE)
 15395*    END-EXEC.
 15396*    MOVE '"$I                   ! 2 #00014420' TO DFHEIV0
 15397     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15399     MOVE X'3220233030303134343230' TO DFHEIV0(25:11)
 15400     CALL 'kxdfhei1' USING DFHEIV0
 15401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15402
 15403
 15404     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15405     MOVE '2'                    TO CNTL-REC-TYPE.
 15406     MOVE +0                     TO CNTL-SEQ-NO.
 15407     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15408
 15409
 15410* EXEC CICS READ
 15411*         DATASET  ('ELCNTL')
 15412*         SET      (ADDRESS OF CONTROL-FILE)
 15413*         RIDFLD   (ELCNTL-KEY)
 15414*    END-EXEC.
 15415     MOVE 'ELCNTL' TO DFHEIV1
 15416*    MOVE '&"S        E          (   #00014429' TO DFHEIV0
 15417     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15419     MOVE X'2020233030303134343239' TO DFHEIV0(25:11)
 15420     CALL 'kxdfhei1' USING DFHEIV0,
 15421           DFHEIV1,
 15422           DFHEIV20,
 15423           DFHEIV99,
 15424           ELCNTL-KEY,
 15425           DFHEIV99,
 15426           DFHEIV99,
 15427           DFHEIV99
 15428     SET ADDRESS OF CONTROL-FILE TO
 15429         DFHEIV20
 15430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15431
 15432
 15433     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 296
* EL156.cbl
 15434
 15435     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15436                         OR '4' OR '5'
 15437         NEXT SENTENCE
 15438     ELSE
 15439         MOVE 'Y' TO WS-NEED-APPROVAL
 15440         GO TO 6170-WRITE.
 15441
 15442     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15443         MOVE 'Y' TO WS-NEED-APPROVAL
 15444         IF WS-APPROVAL-LEVEL = '1'
 15445             MOVE '2'        TO  AT-APPROVED-LEVEL
 15446                            WS-SAVE-APPROVED-LEVEL
 15447             GO TO 6170-WRITE
 15448         ELSE
 15449             IF WS-APPROVAL-LEVEL = '2'
 15450                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15451                                WS-SAVE-APPROVED-LEVEL
 15452                 GO TO 6170-WRITE
 15453             ELSE IF WS-APPROVAL-LEVEL = '3'
 15454                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15455                                WS-SAVE-APPROVED-LEVEL
 15456                 GO TO 6170-WRITE
 15457             ELSE IF WS-APPROVAL-LEVEL = '4'
 15458                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15459                                WS-SAVE-APPROVED-LEVEL
 15460                 GO TO 6170-WRITE.
 15461
 15462     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15463                             WS-PMT-APPROVAL-SW.
 15464     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15465                             AT-APPROVAL-LEVEL-REQD.
 15466
 15467*******************************************************
 15468
 15469 6170-WRITE.
 15470
 15471     if pi-company-id = 'DCC'
 15472        MOVE ' '                 TO WS-PDEF-RECORD-SW
 15473        PERFORM 0900-GET-DDF-FACTORS
 15474                                 THRU 0900-EXIT
 15475     end-if
 15476    perform 2220-update-elcrtt   thru 2220-exit
 15477     IF PI-COMPANY-ID = 'DMD'
 15478        IF PI-AT-EOB-CODES NOT = SPACES
 15479           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15480           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15481           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15482           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15483           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15484
 15485
 15486* EXEC CICS HANDLE CONDITION
 15487*        DUPREC    (6180-DUPREC)
 15488*    END-EXEC.
 15489*    MOVE '"$%                   ! 3 #00014487' TO DFHEIV0
 15490     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 297
* EL156.cbl
 15492     MOVE X'3320233030303134343837' TO DFHEIV0(25:11)
 15493     CALL 'kxdfhei1' USING DFHEIV0
 15494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15495
 15496
 15497
 15498* EXEC CICS WRITE
 15499*         DATASET       ('ELTRLR')
 15500*         FROM          (ACTIVITY-TRAILERS)
 15501*         RIDFLD        (AT-CONTROL-PRIMARY)
 15502*     END-EXEC.
 15503     MOVE LENGTH OF
 15504      ACTIVITY-TRAILERS
 15505       TO DFHEIV11
 15506     MOVE 'ELTRLR' TO DFHEIV1
 15507*    MOVE '&$ L                  ''   #00014491' TO DFHEIV0
 15508     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15509     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15510     MOVE X'2020233030303134343931' TO DFHEIV0(25:11)
 15511     CALL 'kxdfhei1' USING DFHEIV0,
 15512           DFHEIV1,
 15513           ACTIVITY-TRAILERS,
 15514           DFHEIV11,
 15515           AT-CONTROL-PRIMARY,
 15516           DFHEIV99,
 15517           DFHEIV99
 15518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15519
 15520
 15521     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15522        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15523*06088           GO TO 6199-EXIT.
 15524           GO TO 6176-APPROVAL-NOTE.
 15525
 15526
 15527* EXEC CICS GETMAIN
 15528*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15529*         LENGTH    (200)
 15530*         INITIMG   (GETMAIN-SPACE)
 15531*     END-EXEC.
 15532     MOVE 200
 15533       TO DFHEIV11
 15534*    MOVE ',"IL                  $   #00014502' TO DFHEIV0
 15535     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15536     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15537     MOVE X'2020233030303134353032' TO DFHEIV0(25:11)
 15538     CALL 'kxdfhei1' USING DFHEIV0,
 15539           DFHEIV20,
 15540           DFHEIV11,
 15541           GETMAIN-SPACE
 15542     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15543         DFHEIV20
 15544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15545
 15546
 15547     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15548
 15549     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 298
* EL156.cbl
 15550     MOVE 'AT'                   TO AT-RECORD-ID.
 15551     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15552     MOVE '6'                    TO AT-TRAILER-TYPE.
 15553     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15554                                    AT-GEN-INFO-LAST-MAINT-DT
 15555     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15556                                    AT-GEN-INFO-LAST-UPDATED-BY
 15557     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15558
 15559     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15560     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15561     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15562
 15563     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15564
 15565 6175-WRITE.
 15566
 15567
 15568* EXEC CICS HANDLE CONDITION
 15569*        DUPREC    (6190-DUPREC)
 15570*    END-EXEC.
 15571*    MOVE '"$%                   ! 4 #00014528' TO DFHEIV0
 15572     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15574     MOVE X'3420233030303134353238' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0
 15576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15577
 15578
 15579
 15580* EXEC CICS WRITE
 15581*         DATASET     ('ELTRLR')
 15582*         FROM        (ACTIVITY-TRAILERS)
 15583*         RIDFLD      (AT-CONTROL-PRIMARY)
 15584*     END-EXEC.
 15585     MOVE LENGTH OF
 15586      ACTIVITY-TRAILERS
 15587       TO DFHEIV11
 15588     MOVE 'ELTRLR' TO DFHEIV1
 15589*    MOVE '&$ L                  ''   #00014532' TO DFHEIV0
 15590     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15591     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15592     MOVE X'2020233030303134353332' TO DFHEIV0(25:11)
 15593     CALL 'kxdfhei1' USING DFHEIV0,
 15594           DFHEIV1,
 15595           ACTIVITY-TRAILERS,
 15596           DFHEIV11,
 15597           AT-CONTROL-PRIMARY,
 15598           DFHEIV99,
 15599           DFHEIV99
 15600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15601
 15602
 15603 6176-APPROVAL-NOTE.
 15604
 15605     IF NOT APPROVAL-NEEDED
 15606         GO TO 6199-EXIT.
 15607
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 299
* EL156.cbl
 15608
 15609* EXEC CICS GETMAIN
 15610*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15611*        LENGTH    (200)
 15612*        INITIMG   (GETMAIN-SPACE)
 15613*    END-EXEC.
 15614     MOVE 200
 15615       TO DFHEIV11
 15616*    MOVE ',"IL                  $   #00014543' TO DFHEIV0
 15617     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15618     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15619     MOVE X'2020233030303134353433' TO DFHEIV0(25:11)
 15620     CALL 'kxdfhei1' USING DFHEIV0,
 15621           DFHEIV20,
 15622           DFHEIV11,
 15623           GETMAIN-SPACE
 15624     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15625         DFHEIV20
 15626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15627
 15628
 15629     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15630
 15631     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15632     MOVE 'AT'               TO AT-RECORD-ID
 15633     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15634     MOVE '6'                TO AT-TRAILER-TYPE
 15635     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15636                                AT-GEN-INFO-LAST-MAINT-DT
 15637     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15638                                AT-GEN-INFO-LAST-UPDATED-BY
 15639     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15640
 15641     IF PI-REAUDIT-NEEDED = 'Y'
 15642         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15643     ELSE
 15644         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15645     END-IF
 15646     MOVE SPACES             TO AT-INFO-LINE-2
 15647
 15648     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15649 6177-WRITE.
 15650
 15651
 15652* EXEC CICS HANDLE CONDITION
 15653*        DUPREC    (6185-DUPREC)
 15654*    END-EXEC.
 15655*    MOVE '"$%                   ! 5 #00014571' TO DFHEIV0
 15656     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15658     MOVE X'3520233030303134353731' TO DFHEIV0(25:11)
 15659     CALL 'kxdfhei1' USING DFHEIV0
 15660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15661
 15662
 15663
 15664* EXEC CICS WRITE
 15665*         DATASET     ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 300
* EL156.cbl
 15666*         FROM        (ACTIVITY-TRAILERS)
 15667*         RIDFLD      (AT-CONTROL-PRIMARY)
 15668*     END-EXEC.
 15669     MOVE LENGTH OF
 15670      ACTIVITY-TRAILERS
 15671       TO DFHEIV11
 15672     MOVE 'ELTRLR' TO DFHEIV1
 15673*    MOVE '&$ L                  ''   #00014575' TO DFHEIV0
 15674     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15675     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15676     MOVE X'2020233030303134353735' TO DFHEIV0(25:11)
 15677     CALL 'kxdfhei1' USING DFHEIV0,
 15678           DFHEIV1,
 15679           ACTIVITY-TRAILERS,
 15680           DFHEIV11,
 15681           AT-CONTROL-PRIMARY,
 15682           DFHEIV99,
 15683           DFHEIV99
 15684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15685
 15686
 15687
 15688     GO TO 6199-EXIT.
 15689
 15690 6180-DUPREC.
 15691
 15692     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15693     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15694     GO TO 6170-WRITE.
 15695
 15696 6185-DUPREC.
 15697     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15698     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15699     GO TO 6177-WRITE.
 15700
 15701 6190-DUPREC.
 15702     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15703     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15704     GO TO 6175-WRITE.
 15705
 15706 6199-EXIT.
 15707      EXIT.
 15708
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 301
* EL156.cbl
 15710 6200-UPDATE-CLAIM-MSTR.
 15711     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15712     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15713     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15714     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15715
 15716     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15717
 15718     MOVE ZEROS                  TO W-INTEREST.
 15719
 15720     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15721        IF (PI-OFFLINE = 'Y') OR
 15722           (PI-PMTTYPE = '7')
 15723           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15724                                 THRU 9870-EXIT
 15725        END-IF
 15726     END-IF
 15727     IF NOT ERROR-ON-OUTPUT
 15728        CONTINUE
 15729     ELSE
 15730
 15731* EXEC CICS REWRITE
 15732*          DATASET('ELMSTR')
 15733*          FROM(CLAIM-MASTER)
 15734*       END-EXEC
 15735     MOVE LENGTH OF
 15736      CLAIM-MASTER
 15737       TO DFHEIV11
 15738     MOVE 'ELMSTR' TO DFHEIV1
 15739*    MOVE '&& L                  %   #00014624' TO DFHEIV0
 15740     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15741     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15742     MOVE X'2020233030303134363234' TO DFHEIV0(25:11)
 15743     CALL 'kxdfhei1' USING DFHEIV0,
 15744           DFHEIV1,
 15745           CLAIM-MASTER,
 15746           DFHEIV11,
 15747           DFHEIV99
 15748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15749
 15750        MOVE -1                  TO ENTPFBL
 15751        MOVE AL-UANON            TO ENTPFBA
 15752        MOVE MAP-NAMEB           TO MAP-NAME
 15753        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15754        GO TO 8200-SEND-DATAONLY
 15755     END-IF
 15756
 15757     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15758
 15759     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15760
 15761     IF PI-AIG-SPECIAL-BENEFIT
 15762         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15763
 15764     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15765
 15766     IF PI-SPECIAL-BEN-SW = 'Y'
 15767         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 302
* EL156.cbl
 15768         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15769
 15770     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15771         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15772     ELSE
 15773         IF PI-PMTTYPE NOT = '4'
 15774            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15775
 15776     IF PI-PMTTYPE = '5' OR '6'
 15777        GO TO  6250-SET-MAINT.
 15778
 15779     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 15780                                         CL-LAG-REPORT-CODE.
 15781
 15782     IF CL-ACTIVITY-CODE = 09
 15783         GO TO 6200-CONT-UPDATE.
 15784
 15785     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15786         IF CL-ACTIVITY-CODE = 11
 15787             GO TO 6200-CONT-UPDATE.
 15788
 15789     IF WS-ACT-REC-FOUND-SW = 'N'
 15790         GO TO 6200-CONT-UPDATE.
 15791
 15792     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 15793         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 15794         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 15795         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 15796
 15797     IF WS-UPDATE-SW = 'Y'
 15798         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 15799                                         CL-NEXT-FOLLOWUP-DT.
 15800
 15801 6200-CONT-UPDATE.
 15802
 15803     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15804       IF CLAIM-IS-CLOSED
 15805         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15806           IF WS-OPEN-CLOSE-SW = '2'
 15807             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 15808                                        CL-LAST-CLOSE-DT.
 15809
 15810     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 15811        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 15812        MOVE 'O'                 TO CL-CLAIM-STATUS.
 15813
 15814     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 15815        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 15816        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 15817        MOVE 'C'                 TO CL-CLAIM-STATUS
 15818        IF PI-PMTTYPE = '2'
 15819           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15820           CONTINUE
 15821        ELSE
 15822           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15823        END-IF
 15824     ELSE
 15825        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 303
* EL156.cbl
 15826           IF PI-PMTTYPE = '2' AND
 15827              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15828              CONTINUE
 15829           ELSE
 15830              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15831           END-IF
 15832        END-IF
 15833     END-IF
 15834
 15835     IF PI-PMTTYPE = '4'
 15836        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 15837
 15838     IF PI-COMPANY-ID = 'CVL'
 15839         IF PI-LOAN-UPDATE-SW = 'Y'
 15840             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 15841             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 15842             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 15843             MOVE CL-CERT-STATE      TO  CERT-STATE
 15844             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 15845             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 15846             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 15847             MOVE 'CERT'             TO  FILE-SWITCH
 15848             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 15849             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 15850             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 15851
 15852     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 15853        GO TO 6220-USE-COMPUTED.
 15854
 15855     IF (PI-PMTTYPE = '4')  AND
 15856        (PI-EPYAMT < ZEROS)
 15857          COMPUTE CL-NO-OF-DAYS-PAID =
 15858                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 15859          IF CL-NO-OF-DAYS-PAID < +0
 15860              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15861          ELSE
 15862              NEXT SENTENCE
 15863     ELSE
 15864          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 15865
 15866     IF PI-PROCESSOR-ID = 'FIX '
 15867        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15868           NEXT SENTENCE
 15869        ELSE
 15870           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 15871     ELSE
 15872        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 15873
 15874     IF PI-PMTTYPE = '4'
 15875        GO TO 6250-SET-MAINT.
 15876
 15877     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15878
 15879     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15880     MOVE '4'                    TO DC-OPTION-CODE.
 15881     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15882     IF DATE-CONVERSION-ERROR
 15883        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 304
* EL156.cbl
 15884     ELSE
 15885        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 15886           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 15887           IF PI-AIG-SPECIAL-BENEFIT
 15888               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 15889           ELSE
 15890               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 15891
 15892     GO TO 6250-SET-MAINT.
 15893
 15894 6220-USE-COMPUTED.
 15895
 15896     IF (PI-PMTTYPE = '4')  AND
 15897        (PI-CPYAMT < ZEROS)
 15898          COMPUTE CL-NO-OF-DAYS-PAID =
 15899                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 15900          IF CL-NO-OF-DAYS-PAID < +0
 15901              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15902          ELSE
 15903              NEXT SENTENCE
 15904     ELSE
 15905          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 15906
 15907     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 15908
 15909     IF PI-PMTTYPE = '4'
 15910        GO TO 6250-SET-MAINT.
 15911
 15912     IF PI-AIG-SPECIAL-BENEFIT
 15913         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 15914     ELSE
 15915         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 15916
 15917     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15918
 15919     IF PI-CPYTHRU > CL-PAID-THRU-DT
 15920        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 15921
 15922 6250-SET-MAINT.
 15923     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 15924
 15925     IF PI-PROCESSOR-ID = 'FIX '
 15926        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 15927           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 15928        ELSE
 15929           NEXT SENTENCE
 15930     ELSE
 15931        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 15932
 15933     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 15934     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 15935     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 15936
 15937 6299-EXIT.
 15938      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 305
* EL156.cbl
 15940 6300-UPDATE-CERT.
 15941
 15942*  ADD CERTNOTE FOR SC NP+6
 15943     IF PI-COMPANY-ID = 'CID' AND
 15944       (PI-PMTTYPE = '2' OR '3') AND
 15945        CL-CERT-STATE = 'SC'  AND
 15946        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15947           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15948     END-IF.
 15949
 15950     IF PI-COMPANY-ID = 'AHL' AND
 15951       (PI-PMTTYPE = '2' OR '3') AND
 15952        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 15953           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 15954           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15955     END-IF.
 15956
 15957     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15958     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15959     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15960     MOVE CL-CERT-STATE    TO CERT-STATE.
 15961     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15962     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15963     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15964     MOVE 'CERT'           TO FILE-SWITCH.
 15965
 15966     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15967
 15968     IF CERT-NOTE-ADDED
 15969        IF CM-NOTE-SW = ' '
 15970           MOVE '4'             TO CM-NOTE-SW
 15971        ELSE
 15972           IF CM-NOTE-SW = '1'
 15973               MOVE '5'           TO CM-NOTE-SW
 15974           ELSE
 15975              IF CM-NOTE-SW = '2'
 15976                 MOVE '6'         TO CM-NOTE-SW
 15977              ELSE
 15978                 IF CM-NOTE-SW = '3'
 15979                    MOVE '7'      TO CM-NOTE-SW
 15980                 END-IF
 15981              END-IF
 15982           END-IF
 15983        END-IF
 15984     END-IF.
 15985
 15986     IF PI-COMPANY-ID = 'CVL'
 15987         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15988         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15989
 15990     IF PI-PMTTYPE NOT = '4'
 15991        GO TO 6340-UPDATE-CERT.
 15992
 15993     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15994        IF PI-PFKEY-USED = DFHPF5
 15995           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15996        ELSE
 15997           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 306
* EL156.cbl
 15998
 15999*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16000*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16001*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16002*               PI-LF-COVERAGE-TYPE = 'P'
 16003*                GO TO 6350-REWRITE-CERT.
 16004
 16005     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16006       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16007          PI-LF-COVERAGE-TYPE = 'P'
 16008           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16009                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16010                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16011                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16012                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16013                GO TO 6350-REWRITE-CERT
 16014            ELSE
 16015                GO TO 6350-REWRITE-CERT.
 16016
 16017     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16018         GO TO 6350-REWRITE-CERT.
 16019
 16020     IF NOT CM-AH-LUMP-SUM-DISAB
 16021        GO TO 6380-UNLOCK-CERT.
 16022
 16023     IF PI-PFKEY-USED = DFHPF5
 16024        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16025                                    CM-AH-ITD-AH-PMT
 16026        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16027        GO TO 6350-REWRITE-CERT
 16028     ELSE
 16029        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16030                                    CM-AH-ITD-AH-PMT
 16031        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16032        GO TO 6350-REWRITE-CERT.
 16033
 16034 6340-UPDATE-CERT.
 16035
 16036     IF CL-CLAIM-TYPE = 'L'
 16037         IF PI-PFKEY-USED = DFHPF5
 16038             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16039         ELSE
 16040             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16041
 16042     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16043         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16044             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16045                PI-LF-COVERAGE-TYPE = 'P'
 16046                 GO TO 6350-REWRITE-CERT.
 16047
 16048     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16049       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16050          PI-LF-COVERAGE-TYPE = 'P'
 16051           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16052                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16053                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16054                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16055                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 307
* EL156.cbl
 16056                GO TO 6350-REWRITE-CERT.
 16057
 16058     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16059         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16060            PI-LF-COVERAGE-TYPE NOT = 'P'
 16061             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16062             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16063             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16064             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16065             GO TO 6350-REWRITE-CERT.
 16066
 16067     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16068         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16069         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16070         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16071         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16072         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16073         IF PI-PFKEY-USED = DFHPF5
 16074             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16075                                        CM-AH-ITD-AH-PMT
 16076             GO TO 6350-REWRITE-CERT
 16077         ELSE
 16078             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16079                                        CM-AH-ITD-AH-PMT
 16080             GO TO 6350-REWRITE-CERT.
 16081
 16082 6350-REWRITE-CERT.
 16083
 16084
 16085* EXEC CICS REWRITE
 16086*         DATASET  ('ELCERT')
 16087*         FROM(CERTIFICATE-MASTER)
 16088*     END-EXEC.
 16089     MOVE LENGTH OF
 16090      CERTIFICATE-MASTER
 16091       TO DFHEIV11
 16092     MOVE 'ELCERT' TO DFHEIV1
 16093*    MOVE '&& L                  %   #00014963' TO DFHEIV0
 16094     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16095     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16096     MOVE X'2020233030303134393633' TO DFHEIV0(25:11)
 16097     CALL 'kxdfhei1' USING DFHEIV0,
 16098           DFHEIV1,
 16099           CERTIFICATE-MASTER,
 16100           DFHEIV11,
 16101           DFHEIV99
 16102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16103
 16104
 16105     GO TO 6399-EXIT.
 16106
 16107 6380-UNLOCK-CERT.
 16108
 16109* EXEC CICS UNLOCK
 16110*         DATASET  ('ELCERT')
 16111*     END-EXEC.
 16112     MOVE 'ELCERT' TO DFHEIV1
 16113*    MOVE '&*                    #   #00014971' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 308
* EL156.cbl
 16114     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16115     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16116     MOVE X'2020233030303134393731' TO DFHEIV0(25:11)
 16117     CALL 'kxdfhei1' USING DFHEIV0,
 16118           DFHEIV1,
 16119           DFHEIV99
 16120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16121
 16122
 16123 6399-EXIT.
 16124      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 309
* EL156.cbl
 16126 6400-UPDATE-ZERO-TRAILER.
 16127     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16128     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16129
 16130     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16131
 16132     IF PI-EPYAMT NOT = ZEROS
 16133         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16134     ELSE
 16135         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16136
 16137     IF PI-ERESV NOT = ZEROS
 16138        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16139
 16140     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16141        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16142
 16143     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16144        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16145     ELSE
 16146        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16147
 16148     IF PI-PMTTYPE = '5'
 16149        IF PI-EPYAMT = ZEROS
 16150           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16151        ELSE
 16152           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16153
 16154     IF PI-PMTTYPE = '6'
 16155        IF PI-EPYAMT = ZEROS
 16156           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16157        ELSE
 16158           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16159
 16160 6420-CHECK-OPEN-CLOSE.
 16161     IF PI-PMTTYPE = '5' OR '6'
 16162        GO TO 6450-REWRITE.
 16163
 16164     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16165         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16166             IF CLAIM-IS-CLOSED
 16167                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16168                 MOVE 1          TO  SUB-1
 16169                 GO TO 6440-AIG-LOOP.
 16170
 16171     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16172        GO TO 6450-REWRITE.
 16173
 16174     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16175        GO TO 6450-REWRITE.
 16176
 16177     MOVE 1                      TO SUB-1.
 16178
 16179 6430-LOOP.
 16180     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16181        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16182        IF PI-PMTTYPE = '1' OR '4'
 16183           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 310
* EL156.cbl
 16184           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16185           GO TO 6450-REWRITE
 16186        ELSE
 16187           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16188           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16189           GO TO 6450-REWRITE.
 16190
 16191     IF SUB-1 = 6
 16192      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16193      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16194      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16195      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16196      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16197      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16198      GO TO 6430-LOOP.
 16199
 16200     ADD 1                       TO SUB-1.
 16201     GO TO 6430-LOOP.
 16202
 16203
 16204 6440-AIG-LOOP.
 16205
 16206     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16207       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16208       IF WS-OPEN-CLOSE-SW = '1'
 16209         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16210         IF PI-PMTTYPE = '2'
 16211           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16212           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16213         ELSE
 16214           IF PI-PMTTYPE = '3'
 16215             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16216             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16217           ELSE
 16218             IF PI-PMTTYPE = '4'
 16219               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16220               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16221             ELSE
 16222               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16223               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16224       ELSE
 16225         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16226         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16227         GO TO 6450-REWRITE.
 16228
 16229     IF SUB-1 = 6
 16230      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16231      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16232      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16233      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16234      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16235      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16236      GO TO 6440-AIG-LOOP.
 16237
 16238     ADD 1                       TO SUB-1.
 16239     GO TO 6440-AIG-LOOP.
 16240
 16241 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 311
* EL156.cbl
 16242     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16243     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16244     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16245
 16246     IF PI-COMPANY-ID = 'DMD'
 16247         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16248         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16249         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16250         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16251         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16252
 16253
 16254* EXEC CICS REWRITE
 16255*         DATASET  ('ELTRLR')
 16256*         FROM     (ACTIVITY-TRAILERS)
 16257*     END-EXEC.
 16258     MOVE LENGTH OF
 16259      ACTIVITY-TRAILERS
 16260       TO DFHEIV11
 16261     MOVE 'ELTRLR' TO DFHEIV1
 16262*    MOVE '&& L                  %   #00015105' TO DFHEIV0
 16263     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16264     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16265     MOVE X'2020233030303135313035' TO DFHEIV0(25:11)
 16266     CALL 'kxdfhei1' USING DFHEIV0,
 16267           DFHEIV1,
 16268           ACTIVITY-TRAILERS,
 16269           DFHEIV11,
 16270           DFHEIV99
 16271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16272
 16273
 16274 6499-EXIT.
 16275      EXIT.
 16276
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 312
* EL156.cbl
 16278 6500-READ-DLO035.
 16279     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16280     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16281     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16282     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16283
 16284
 16285* EXEC CICS LINK
 16286*        PROGRAM    ('DLO035')
 16287*        COMMAREA   (DLO035-KEY)
 16288*        LENGTH     (DL35-LENGTH)
 16289*    END-EXEC.
 16290     MOVE 'DLO035' TO DFHEIV1
 16291*    MOVE '."C                   (   #00015120' TO DFHEIV0
 16292     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16293     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16294     MOVE X'2020233030303135313230' TO DFHEIV0(25:11)
 16295     CALL 'kxdfhei1' USING DFHEIV0,
 16296           DFHEIV1,
 16297           DLO035-KEY,
 16298           DL35-LENGTH,
 16299           DFHEIV99,
 16300           DFHEIV99,
 16301           DFHEIV99,
 16302           DFHEIV99
 16303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16304
 16305
 16306     IF DL35-RETURN-CODE = 'OK'
 16307         GO TO 6500-EXIT.
 16308
 16309     IF DL35-RETURN-CODE = '01'
 16310         MOVE ER-7830            TO EMI-ERROR
 16311         GO TO 6500-BAD-EXIT.
 16312
 16313     IF DL35-RETURN-CODE = '02'
 16314         MOVE ER-7831            TO EMI-ERROR
 16315         GO TO 6500-BAD-EXIT.
 16316
 16317     IF DL35-RETURN-CODE = '03'
 16318         MOVE ER-7832            TO EMI-ERROR
 16319         GO TO 6500-BAD-EXIT.
 16320
 16321     IF DL35-RETURN-CODE = '04'
 16322         MOVE ER-7833            TO EMI-ERROR
 16323         GO TO 6500-BAD-EXIT.
 16324
 16325     IF DL35-RETURN-CODE = '05'
 16326         MOVE ER-7834            TO EMI-ERROR
 16327         GO TO 6500-BAD-EXIT.
 16328
 16329     IF DL35-RETURN-CODE = '06'
 16330         MOVE ER-7835            TO EMI-ERROR
 16331         GO TO 6500-BAD-EXIT.
 16332
 16333     IF DL35-RETURN-CODE = '07'
 16334         MOVE ER-7836            TO EMI-ERROR
 16335         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 313
* EL156.cbl
 16336
 16337     IF DL35-RETURN-CODE = 'E1'
 16338         MOVE ER-7837            TO EMI-ERROR
 16339         GO TO 6500-BAD-EXIT.
 16340
 16341     IF DL35-RETURN-CODE NOT = 'OK'
 16342         MOVE ER-7838            TO EMI-ERROR
 16343         GO TO 6500-BAD-EXIT.
 16344
 16345 6500-EXIT.
 16346      EXIT.
 16347
 16348 6500-BAD-EXIT.
 16349
 16350* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16351*    MOVE '6"R                   !   #00015169' TO DFHEIV0
 16352     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16354     MOVE X'2020233030303135313639' TO DFHEIV0(25:11)
 16355     CALL 'kxdfhei1' USING DFHEIV0
 16356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16357
 16358     MOVE -1                 TO PMTTYPEL.
 16359     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16360     GO TO 8200-SEND-DATAONLY.
 16361
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 314
* EL156.cbl
 16363 6600-UPDATE-DLO035.
 16364     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16365     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16366     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16367     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16368
 16369
 16370* EXEC CICS LINK
 16371*        PROGRAM    ('DLO035')
 16372*        COMMAREA   (DLO035-KEY)
 16373*        LENGTH     (DL35-LENGTH)
 16374*    END-EXEC.
 16375     MOVE 'DLO035' TO DFHEIV1
 16376*    MOVE '."C                   (   #00015181' TO DFHEIV0
 16377     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16379     MOVE X'2020233030303135313831' TO DFHEIV0(25:11)
 16380     CALL 'kxdfhei1' USING DFHEIV0,
 16381           DFHEIV1,
 16382           DLO035-KEY,
 16383           DL35-LENGTH,
 16384           DFHEIV99,
 16385           DFHEIV99,
 16386           DFHEIV99,
 16387           DFHEIV99
 16388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16389
 16390
 16391     IF DL35-RETURN-CODE = 'OK'
 16392         GO TO 6600-EXIT.
 16393
 16394     IF DL35-RETURN-CODE = '01'
 16395         MOVE ER-7830            TO EMI-ERROR
 16396         GO TO 6500-BAD-EXIT.
 16397
 16398     IF DL35-RETURN-CODE = '02'
 16399         MOVE ER-7831            TO EMI-ERROR
 16400         GO TO 6500-BAD-EXIT.
 16401
 16402     IF DL35-RETURN-CODE = '03'
 16403         MOVE ER-7832            TO EMI-ERROR
 16404         GO TO 6500-BAD-EXIT.
 16405
 16406     IF DL35-RETURN-CODE = '04'
 16407         MOVE ER-7833            TO EMI-ERROR
 16408         GO TO 6500-BAD-EXIT.
 16409
 16410     IF DL35-RETURN-CODE = '05'
 16411         MOVE ER-7834            TO EMI-ERROR
 16412         GO TO 6500-BAD-EXIT.
 16413
 16414     IF DL35-RETURN-CODE = '06'
 16415         MOVE ER-7835            TO EMI-ERROR
 16416         GO TO 6500-BAD-EXIT.
 16417
 16418     IF DL35-RETURN-CODE = '07'
 16419         MOVE ER-7836            TO EMI-ERROR
 16420         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 315
* EL156.cbl
 16421
 16422     IF DL35-RETURN-CODE = 'E1'
 16423         MOVE ER-7837            TO EMI-ERROR
 16424         GO TO 6500-BAD-EXIT.
 16425
 16426     IF DL35-RETURN-CODE NOT = 'OK'
 16427         MOVE ER-7838            TO EMI-ERROR
 16428         GO TO 6500-BAD-EXIT.
 16429
 16430 6600-EXIT.
 16431      EXIT.
 16432
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 316
* EL156.cbl
 16434 6700-UPDATE-ACTQ.
 16435***************************************************************
 16436*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16437*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16438*    ONE ALREADY THERE.                                       *
 16439***************************************************************
 16440
 16441
 16442* EXEC CICS HANDLE CONDITION
 16443*         NOTFND(6720-BUILD-NEW-RECORD)
 16444*     END-EXEC.
 16445*    MOVE '"$I                   ! 6 #00015237' TO DFHEIV0
 16446     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16448     MOVE X'3620233030303135323337' TO DFHEIV0(25:11)
 16449     CALL 'kxdfhei1' USING DFHEIV0
 16450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16451
 16452
 16453
 16454* EXEC CICS READ
 16455*         DATASET('ELACTQ')
 16456*         RIDFLD (ELMSTR-KEY)
 16457*         SET    (ADDRESS OF ACTIVITY-QUE)
 16458*         UPDATE
 16459*     END-EXEC.
 16460     MOVE 'ELACTQ' TO DFHEIV1
 16461*    MOVE '&"S        EU         (   #00015241' TO DFHEIV0
 16462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16464     MOVE X'2020233030303135323431' TO DFHEIV0(25:11)
 16465     CALL 'kxdfhei1' USING DFHEIV0,
 16466           DFHEIV1,
 16467           DFHEIV20,
 16468           DFHEIV99,
 16469           ELMSTR-KEY,
 16470           DFHEIV99,
 16471           DFHEIV99,
 16472           DFHEIV99
 16473     SET ADDRESS OF ACTIVITY-QUE TO
 16474         DFHEIV20
 16475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16476
 16477
 16478     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16479
 16480     IF PI-AIG-SPECIAL-BENEFIT AND
 16481        PI-CASH = 'Y'
 16482         ADD 2                   TO AQ-PAYMENT-COUNTER
 16483     ELSE
 16484         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16485
 16486     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16487         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16488
 16489     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16490
 16491     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 317
* EL156.cbl
 16492         IF WS-PMT-APPROVAL-SW = 'A'
 16493             NEXT SENTENCE
 16494         ELSE
 16495            IF PI-AIG-SPECIAL-BENEFIT AND
 16496               PI-CASH = 'Y'
 16497                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16498                                     WS-PMT-UNAPPROVED-CNT
 16499            ELSE
 16500                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16501                                     WS-PMT-UNAPPROVED-CNT
 16502     ELSE
 16503         IF PI-PMT-APPR-SW = 'Y'
 16504            IF PI-AIG-SPECIAL-BENEFIT AND
 16505               PI-CASH = 'Y'
 16506                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16507                                     WS-PMT-UNAPPROVED-CNT
 16508            ELSE
 16509                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16510                                     WS-PMT-UNAPPROVED-CNT.
 16511
 16512     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16513         MOVE ER-3536 TO EMI-ERROR
 16514         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16515
 16516     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16517
 16518
 16519* EXEC CICS REWRITE
 16520*         DATASET('ELACTQ')
 16521*         FROM   (ACTIVITY-QUE)
 16522*     END-EXEC.
 16523     MOVE LENGTH OF
 16524      ACTIVITY-QUE
 16525       TO DFHEIV11
 16526     MOVE 'ELACTQ' TO DFHEIV1
 16527*    MOVE '&& L                  %   #00015288' TO DFHEIV0
 16528     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16529     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16530     MOVE X'2020233030303135323838' TO DFHEIV0(25:11)
 16531     CALL 'kxdfhei1' USING DFHEIV0,
 16532           DFHEIV1,
 16533           ACTIVITY-QUE,
 16534           DFHEIV11,
 16535           DFHEIV99
 16536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16537
 16538
 16539     GO TO 6799-EXIT.
 16540
 16541 6720-BUILD-NEW-RECORD.
 16542
 16543* EXEC CICS GETMAIN
 16544*         SET    (ADDRESS OF ACTIVITY-QUE)
 16545*         LENGTH (60)
 16546*         INITIMG(GETMAIN-SPACE)
 16547*     END-EXEC.
 16548     MOVE 60
 16549       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 318
* EL156.cbl
 16550*    MOVE ',"IL                  $   #00015296' TO DFHEIV0
 16551     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16552     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16553     MOVE X'2020233030303135323936' TO DFHEIV0(25:11)
 16554     CALL 'kxdfhei1' USING DFHEIV0,
 16555           DFHEIV20,
 16556           DFHEIV11,
 16557           GETMAIN-SPACE
 16558     SET ADDRESS OF ACTIVITY-QUE TO
 16559         DFHEIV20
 16560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16561
 16562
 16563     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16564
 16565     IF PI-AIG-SPECIAL-BENEFIT AND
 16566        PI-CASH = 'Y'
 16567         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16568     ELSE
 16569         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16570
 16571     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16572     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16573     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16574     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16575                                    AQ-FOLLOWUP-DATE.
 16576     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16577     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16578
 16579     IF PI-PMT-GRADUATED
 16580         IF WS-PMT-APPROVAL-SW = 'A'
 16581             NEXT SENTENCE
 16582         ELSE
 16583            IF PI-AIG-SPECIAL-BENEFIT AND
 16584               PI-CASH = 'Y'
 16585                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16586            ELSE
 16587                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16588     ELSE
 16589         IF PI-PMT-APPR-SW = 'Y'
 16590            IF PI-AIG-SPECIAL-BENEFIT AND
 16591               PI-CASH = 'Y'
 16592                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16593            ELSE
 16594                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16595
 16596     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16597         MOVE ER-3536 TO EMI-ERROR
 16598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16599
 16600
 16601* EXEC CICS WRITE
 16602*         DATASET('ELACTQ')
 16603*         RIDFLD (ELMSTR-KEY)
 16604*         FROM   (ACTIVITY-QUE)
 16605*     END-EXEC.
 16606     MOVE LENGTH OF
 16607      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 319
* EL156.cbl
 16608       TO DFHEIV11
 16609     MOVE 'ELACTQ' TO DFHEIV1
 16610*    MOVE '&$ L                  ''   #00015339' TO DFHEIV0
 16611     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16613     MOVE X'2020233030303135333339' TO DFHEIV0(25:11)
 16614     CALL 'kxdfhei1' USING DFHEIV0,
 16615           DFHEIV1,
 16616           ACTIVITY-QUE,
 16617           DFHEIV11,
 16618           ELMSTR-KEY,
 16619           DFHEIV99,
 16620           DFHEIV99
 16621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16622
 16623
 16624 6799-EXIT.
 16625      EXIT.
 16626
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 320
* EL156.cbl
 16628 6800-BUILD-FORM-TRAILER.
 16629
 16630
 16631* EXEC CICS GETMAIN
 16632*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16633*         LENGTH   (200)
 16634*         INITIMG  (GETMAIN-SPACE)
 16635*    END-EXEC.
 16636     MOVE 200
 16637       TO DFHEIV11
 16638*    MOVE ',"IL                  $   #00015351' TO DFHEIV0
 16639     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16640     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16641     MOVE X'2020233030303135333531' TO DFHEIV0(25:11)
 16642     CALL 'kxdfhei1' USING DFHEIV0,
 16643           DFHEIV20,
 16644           DFHEIV11,
 16645           GETMAIN-SPACE
 16646     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16647         DFHEIV20
 16648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16649
 16650
 16651     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16652
 16653     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16654     MOVE 'AT'                   TO AT-RECORD-ID.
 16655     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16656
 16657     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16658     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16659                                    AT-FORM-LAST-MAINT-DT
 16660                                    AT-FORM-SEND-ON-DT.
 16661     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16662                                    AT-FORM-LAST-UPDATED-BY.
 16663     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16664     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16665     MOVE '6'                    TO DC-OPTION-CODE.
 16666     MOVE +29                    TO DC-ELAPSED-DAYS.
 16667     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16668     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16669     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16670
 16671     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16672         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16673
 16674     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16675                                    AT-FORM-RE-SEND-DT
 16676                                    AT-EMP-FORM-ANSWERED-DT
 16677                                    AT-PHY-FORM-ANSWERED-DT
 16678                                    AT-EMP-FORM-SEND-ON-DT
 16679                                    AT-PHY-FORM-SEND-ON-DT
 16680                                    AT-FORM-PRINTED-DT
 16681                                    AT-FORM-REPRINT-DT.
 16682     MOVE '2'                    TO AT-FORM-TYPE.
 16683
 16684     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16685     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 321
* EL156.cbl
 16686
 16687     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16688         NEXT SENTENCE
 16689     ELSE
 16690         IF CL-PROG-FORM-TYPE NOT = 'S'
 16691            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16692
 16693
 16694* EXEC CICS WRITE
 16695*         DATASET  ('ELTRLR')
 16696*         FROM     (ACTIVITY-TRAILERS)
 16697*         RIDFLD   (AT-CONTROL-PRIMARY)
 16698*     END-EXEC.
 16699     MOVE LENGTH OF
 16700      ACTIVITY-TRAILERS
 16701       TO DFHEIV11
 16702     MOVE 'ELTRLR' TO DFHEIV1
 16703*    MOVE '&$ L                  ''   #00015399' TO DFHEIV0
 16704     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16706     MOVE X'2020233030303135333939' TO DFHEIV0(25:11)
 16707     CALL 'kxdfhei1' USING DFHEIV0,
 16708           DFHEIV1,
 16709           ACTIVITY-TRAILERS,
 16710           DFHEIV11,
 16711           AT-CONTROL-PRIMARY,
 16712           DFHEIV99,
 16713           DFHEIV99
 16714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16715
 16716
 16717 6899-EXIT.
 16718      EXIT.
 16719
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 322
* EL156.cbl
 16721 6900-BUILD-ARCHIVE-HEADER.
 16722
 16723     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16724     MOVE '1'                    TO CNTL-REC-TYPE.
 16725     MOVE +0                     TO CNTL-SEQ-NO.
 16726     MOVE SPACES                 TO CNTL-ACCESS.
 16727
 16728
 16729* EXEC CICS READ
 16730*         DATASET  ('ELCNTL')
 16731*         SET      (ADDRESS OF CONTROL-FILE)
 16732*         RIDFLD   (ELCNTL-KEY)
 16733*         UPDATE
 16734*    END-EXEC.
 16735     MOVE 'ELCNTL' TO DFHEIV1
 16736*    MOVE '&"S        EU         (   #00015416' TO DFHEIV0
 16737     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16738     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16739     MOVE X'2020233030303135343136' TO DFHEIV0(25:11)
 16740     CALL 'kxdfhei1' USING DFHEIV0,
 16741           DFHEIV1,
 16742           DFHEIV20,
 16743           DFHEIV99,
 16744           ELCNTL-KEY,
 16745           DFHEIV99,
 16746           DFHEIV99,
 16747           DFHEIV99
 16748     SET ADDRESS OF CONTROL-FILE TO
 16749         DFHEIV20
 16750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16751
 16752
 16753     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16754     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16755
 16756
 16757* EXEC CICS REWRITE
 16758*         FROM     (CONTROL-FILE)
 16759*         DATASET  ('ELCNTL')
 16760*    END-EXEC.
 16761     MOVE LENGTH OF
 16762      CONTROL-FILE
 16763       TO DFHEIV11
 16764     MOVE 'ELCNTL' TO DFHEIV1
 16765*    MOVE '&& L                  %   #00015426' TO DFHEIV0
 16766     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16767     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16768     MOVE X'2020233030303135343236' TO DFHEIV0(25:11)
 16769     CALL 'kxdfhei1' USING DFHEIV0,
 16770           DFHEIV1,
 16771           CONTROL-FILE,
 16772           DFHEIV11,
 16773           DFHEIV99
 16774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16775
 16776
 16777
 16778* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 323
* EL156.cbl
 16779*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 16780*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 16781*    END-EXEC.
 16782*    MOVE '"$$%                  ! 7 #00015431' TO DFHEIV0
 16783     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 16784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16785     MOVE X'3720233030303135343331' TO DFHEIV0(25:11)
 16786     CALL 'kxdfhei1' USING DFHEIV0
 16787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16788
 16789
 16790
 16791* EXEC CICS GETMAIN
 16792*         SET     (ADDRESS OF LETTER-ARCHIVE)
 16793*         LENGTH  (ELARCH-LENGTH)
 16794*         INITIMG (GETMAIN-SPACE)
 16795*    END-EXEC.
 16796*    MOVE ',"IL                  $   #00015436' TO DFHEIV0
 16797     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16798     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16799     MOVE X'2020233030303135343336' TO DFHEIV0(25:11)
 16800     CALL 'kxdfhei1' USING DFHEIV0,
 16801           DFHEIV20,
 16802           ELARCH-LENGTH,
 16803           GETMAIN-SPACE
 16804     SET ADDRESS OF LETTER-ARCHIVE TO
 16805         DFHEIV20
 16806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16807
 16808
 16809     MOVE 'LA'                   TO LA-RECORD-ID.
 16810     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 16811                                    LA-ARCHIVE-NO-A1.
 16812     MOVE '4'                    TO LA-RECORD-TYPE
 16813                                    LA-RECORD-TYPE-A1.
 16814     MOVE +0                     TO LA-LINE-SEQ-NO
 16815                                    LA-LINE-SEQ-NO-A1.
 16816     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 16817                                    LA-COMPANY-CD-A1.
 16818     MOVE CL-CARRIER             TO LA4-CARRIER.
 16819     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 16820     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 16821     MOVE CL-CERT-STATE          TO LA4-STATE.
 16822     MOVE +0                     TO LA4-NO-OF-COPIES.
 16823     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 16824     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 16825     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 16826                                    LA4-INITIAL-PRINT-DATE
 16827                                    LA4-RESEND-PRINT-DATE
 16828                                    LA4-FORM-REM-PRINT-DT.
 16829     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 16830     MOVE '2'                    TO LA4-FORM-TYPE.
 16831
 16832
 16833* EXEC CICS WRITE
 16834*         DATASET  ('ELARCH')
 16835*         FROM     (LETTER-ARCHIVE)
 16836*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 324
* EL156.cbl
 16837*    END-EXEC.
 16838     MOVE LENGTH OF
 16839      LETTER-ARCHIVE
 16840       TO DFHEIV11
 16841     MOVE 'ELARCH' TO DFHEIV1
 16842*    MOVE '&$ L                  ''   #00015465' TO DFHEIV0
 16843     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16845     MOVE X'2020233030303135343635' TO DFHEIV0(25:11)
 16846     CALL 'kxdfhei1' USING DFHEIV0,
 16847           DFHEIV1,
 16848           LETTER-ARCHIVE,
 16849           DFHEIV11,
 16850           LA-CONTROL-PRIMARY,
 16851           DFHEIV99,
 16852           DFHEIV99
 16853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16854
 16855
 16856 6999-EXIT.
 16857      EXIT.
 16858
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 325
* EL156.cbl
 16860 7000-SHOW-CLAIM.
 16861     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 16862     MOVE 'A'                    TO PI-PASS-SW.
 16863     MOVE LOW-VALUES             TO PI-CPYFROM
 16864                                    PI-MONTH-END-SAVE
 16865                                    PI-CPYTHRU.
 16866
 16867     MOVE ZEROS                  TO PI-FATAL-COUNT
 16868                                    PI-DAILY-RATE
 16869                                    PI-BEN-DAYS
 16870                                    PI-MANUAL-SW
 16871                                    PI-SAVE-CURSOR
 16872                                    PI-FORCE-COUNT
 16873                                    PI-HOLDTIL
 16874                                    PI-EPYFROM
 16875                                    PI-EPYTHRU
 16876                                    PI-EDAYS
 16877                                    PI-EPYAMT
 16878                                    PI-ERESV
 16879                                    PI-EEXPENS
 16880                                    PI-CDAYS
 16881                                    PI-CPYAMT
 16882                                    PI-CRESV
 16883                                    PI-CEXPENS
 16884                                    PI-INT-RATE
 16885                                    PI-AIGFROM.
 16886     MOVE ZEROS                  TO PI-PROOF-DATE.
 16887     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 16888                                    PI-REM-BEN-AMT
 16889                                    PI-MO-BEN-AMT.
 16890
 16891     MOVE LOW-VALUES             TO EL156AI.
 16892     MOVE MAP-NAMEA              TO MAP-NAME.
 16893
 16894* EXEC CICS HANDLE CONDITION
 16895*        NOTFND   (7010-BUILD-MAP)
 16896*    END-EXEC.
 16897*    MOVE '"$I                   ! 8 #00015508' TO DFHEIV0
 16898     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16900     MOVE X'3820233030303135353038' TO DFHEIV0(25:11)
 16901     CALL 'kxdfhei1' USING DFHEIV0
 16902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16903
 16904
 16905     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16906     MOVE '2'                    TO CNTL-REC-TYPE.
 16907     MOVE +0                     TO CNTL-SEQ-NO.
 16908     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16909
 16910
 16911* EXEC CICS READ
 16912*         DATASET  ('ELCNTL')
 16913*         SET      (ADDRESS OF CONTROL-FILE)
 16914*         RIDFLD   (ELCNTL-KEY)
 16915*    END-EXEC.
 16916     MOVE 'ELCNTL' TO DFHEIV1
 16917*    MOVE '&"S        E          (   #00015517' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 326
* EL156.cbl
 16918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16920     MOVE X'2020233030303135353137' TO DFHEIV0(25:11)
 16921     CALL 'kxdfhei1' USING DFHEIV0,
 16922           DFHEIV1,
 16923           DFHEIV20,
 16924           DFHEIV99,
 16925           ELCNTL-KEY,
 16926           DFHEIV99,
 16927           DFHEIV99,
 16928           DFHEIV99
 16929     SET ADDRESS OF CONTROL-FILE TO
 16930         DFHEIV20
 16931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16932
 16933
 16934     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 16935
 16936     IF PI-APPROVAL-LEVEL = '4' OR '5'
 16937         MOVE AL-UANON      TO SURVYYNA
 16938     END-IF.
 16939
 16940
 16941     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16942     MOVE '1'                    TO CNTL-REC-TYPE.
 16943     MOVE SPACES                 TO CNTL-ACCESS.
 16944     MOVE +0                     TO CNTL-SEQ-NO.
 16945
 16946
 16947* EXEC CICS READ
 16948*         DATASET  ('ELCNTL')
 16949*         SET      (ADDRESS OF CONTROL-FILE)
 16950*         RIDFLD   (ELCNTL-KEY)
 16951*    END-EXEC.
 16952     MOVE 'ELCNTL' TO DFHEIV1
 16953*    MOVE '&"S        E          (   #00015535' TO DFHEIV0
 16954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16955     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16956     MOVE X'2020233030303135353335' TO DFHEIV0(25:11)
 16957     CALL 'kxdfhei1' USING DFHEIV0,
 16958           DFHEIV1,
 16959           DFHEIV20,
 16960           DFHEIV99,
 16961           ELCNTL-KEY,
 16962           DFHEIV99,
 16963           DFHEIV99,
 16964           DFHEIV99
 16965     SET ADDRESS OF CONTROL-FILE TO
 16966         DFHEIV20
 16967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16968
 16969
 16970     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 16971
 16972 7010-BUILD-MAP.
 16973
 16974
 16975* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 327
* EL156.cbl
 16976*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16977*    END-EXEC.
 16978*    MOVE '"$I                   ! 9 #00015545' TO DFHEIV0
 16979     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16981     MOVE X'3920233030303135353435' TO DFHEIV0(25:11)
 16982     CALL 'kxdfhei1' USING DFHEIV0
 16983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16984
 16985
 16986     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16987     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16988     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16989     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16990     MOVE 'MSTR'                 TO FILE-SWITCH.
 16991
 16992     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16993
 16994     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16995     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16996     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16997     MOVE CL-CCN                 TO PI-SV-CCN.
 16998
 16999     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17000     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17001     MOVE CL-CLAIM-NO            TO CLMNOO.
 17002     MOVE CL-CARRIER             TO CARRO.
 17003     MOVE CL-CERT-PRIME          TO CERTNOO.
 17004     MOVE CL-CERT-SFX            TO SUFXO.
 17005
 17006     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17007        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17008        CONTINUE
 17009     ELSE
 17010        MOVE AL-SADOF            TO ZINTHA
 17011                                    ZINTA
 17012                                    PINTHA
 17013                                    PINTA
 17014     END-IF
 17015     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17016     EVALUATE TRUE
 17017     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17018         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17019     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17020         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17021
 17022     WHEN CL-CLAIM-TYPE = 'I'
 17023         MOVE '  IU  '           TO CLMTYPO
 17024     WHEN CL-CLAIM-TYPE = 'G'
 17025         MOVE ' GAP  '           TO CLMTYPO
 17026     END-EVALUATE.
 17027     IF CLAIM-IS-OPEN
 17028         MOVE ' OPEN'            TO CLMSTATO
 17029     ELSE
 17030         MOVE 'CLOSED'           TO CLMSTATO.
 17031
 17032     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17033
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 328
* EL156.cbl
 17034     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17035         MOVE SPACES             TO  PCERTNOO
 17036                                     PSUFXO
 17037                                     PRIMHDGO
 17038                                     SEQUO
 17039         MOVE AL-SADOF           TO  PCERTNOA
 17040                                     PSUFXA
 17041                                     PRIMHDGA
 17042                                     SEQUA
 17043     ELSE
 17044         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17045         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17046         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17047         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17048         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17049         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17050         MOVE AL-SANON               TO  PCERTNOA
 17051                                         PSUFXA
 17052                                         PRIMHDGA
 17053         MOVE AL-SABON               TO  SEQUA.
 17054
 17055     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17056
 17057     IF CL-NO-OF-PMTS-MADE = 0 AND
 17058        CL-TOTAL-PAID-AMT = 0
 17059         NEXT SENTENCE
 17060     ELSE
 17061         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17062             IF NOT PI-USES-PAID-TO
 17063                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17064                 MOVE ' '                 TO DC-OPTION-CODE
 17065                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17066                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17067             ELSE
 17068                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17069                 MOVE '6'                 TO DC-OPTION-CODE
 17070                 MOVE +1                  TO DC-ELAPSED-DAYS
 17071                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17072                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17073                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17074
 17075     IF MAP-NAME = 'EL156A'
 17076        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17077           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17078             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17079           end-if
 17080        end-if
 17081     end-if
 17082     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17083         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17084         MOVE ' '                TO DC-OPTION-CODE
 17085         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17086         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17087
 17088     IF CL-INCURRED-DT NOT = LOW-VALUES
 17089         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17090         MOVE ' '                TO DC-OPTION-CODE
 17091         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 329
* EL156.cbl
 17092         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17093
 17094     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17095
 17096     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17097         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17098         MOVE ' '                TO DC-OPTION-CODE
 17099         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17100         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17101
 17102     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17103         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17104         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17105     ELSE
 17106         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17107         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17108
 17109     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17110     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17111     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17112     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17113                                    PI-GROUPING.
 17114     MOVE CL-CERT-STATE          TO CERT-STATE
 17115                                    PI-STATE.
 17116     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17117                                    PI-ACCOUNT.
 17118     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17119     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17120     MOVE 'CERT'                 TO FILE-SWITCH.
 17121
 17122     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17123     if pi-company-id = 'DCC'
 17124        perform 7975-read-acct   thru 7975-exit
 17125     end-if
 17126     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17127     MOVE PI-STATE               TO WS-ST-ACCESS.
 17128     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17129     MOVE '3'                    TO CNTL-REC-TYPE.
 17130     MOVE +0                     TO CNTL-SEQ-NO.
 17131     MOVE 'STAT'                 TO FILE-SWITCH.
 17132
 17133     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17134
 17135     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17136     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17137
 17138     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17139        GO TO 7020-BYPASS-BENEFIT.
 17140
 17141     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17142     MOVE '4'                    TO CNTL-REC-TYPE.
 17143     MOVE +0                     TO CNTL-SEQ-NO.
 17144     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17145     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17146     MOVE 'BENE'                 TO FILE-SWITCH.
 17147
 17148     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17149
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 330
* EL156.cbl
 17150     IF NO-BENEFIT-FOUND
 17151        GO TO 7020-BYPASS-BENEFIT.
 17152
 17153     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17154     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17155     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17156
 17157 7020-BYPASS-BENEFIT.
 17158
 17159*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17160*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17161*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17162
 17163     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17164         GO TO 7021-GO-TO-LIFE.
 17165     move zeros                  to PI-MAX-BENEFIT-AMT
 17166     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17167
 17168     IF (PI-COMPANY-ID = 'DCC')
 17169        and (acct-found)
 17170        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17171        MOVE ' '                 TO WS-PDEF-RECORD-SW
 17172        PERFORM 0900-GET-DDF-FACTORS
 17173                                 THRU 0900-EXIT
 17174        IF PDEF-FOUND
 17175           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17176              (P1 > +8)
 17177              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17178           END-PERFORM
 17179           IF P1 < +9
 17180              MOVE PD-MAX-AMT (P1)
 17181                                 TO PI-MAX-BENEFIT-AMT
 17182           END-IF
 17183        END-IF
 17184     end-if
 17185     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17186     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17187     if (pi-max-benefit-amt not = zeros)
 17188        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17189        move pi-max-benefit-amt  to beneo
 17190     else
 17191        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17192     end-if
 17193     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17194     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17195                                    CP-ORIGINAL-TERM.
 17196     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17197
 17198*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17199*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17200*    ELSE
 17201         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17202
 17203     MOVE ' '                    TO DC-OPTION-CODE.
 17204     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17205     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17206
 17207     IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 331
* EL156.cbl
 17208         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17209         GO TO 7023-BYPASS-REMAINING-TERM.
 17210
 17211     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17212     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17213     GO TO 7022-AROUND-LIFE.
 17214
 17215 7021-GO-TO-LIFE.
 17216
 17217     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17218     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17219     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17220                                    CP-ORIGINAL-TERM.
 17221     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17222     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17223     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17224     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17225
 17226     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17227         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17228     ELSE
 17229         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17230
 17231     MOVE ' '                    TO DC-OPTION-CODE.
 17232     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17233     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17234
 17235 7022-AROUND-LIFE.
 17236
 17237     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17238     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17239     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17240     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17241     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17242     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17243     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17244
 17245     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17246
 17247     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17248        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17249           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17250
 17251     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17252        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17253           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17254
 17255 7023-BYPASS-REMAINING-TERM.
 17256     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17257       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17258          MOVE ZEROS                  TO BENEO
 17259       ELSE
 17260          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17261          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17262          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17263          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17264          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17265          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 332
* EL156.cbl
 17266          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17267          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17268          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17269          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17270          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17271          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17272          IF (PI-COMPANY-ID = 'DCC')
 17273             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17274             MOVE ' '            TO WS-PDEF-RECORD-SW
 17275             PERFORM 0900-GET-DDF-FACTORS
 17276                                 THRU 0900-EXIT
 17277             IF PDEF-FOUND
 17278                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17279                   (P1 > +8)
 17280                   OR (PD-PROD-CODE (P1) = 'L')
 17281                END-PERFORM
 17282                IF P1 < +9
 17283                   MOVE PD-MAX-AMT (P1)
 17284                                 TO CP-R-MAX-TOT-BEN
 17285                END-IF
 17286             END-IF
 17287          END-IF
 17288
 17289* EXEC CICS LINK
 17290*            PROGRAM  (LINK-REMAMT)
 17291*            COMMAREA (CALCULATION-PASS-AREA)
 17292*            LENGTH   (CP-COMM-LENGTH)
 17293*         END-EXEC
 17294*    MOVE '."C                   (   #00015851' TO DFHEIV0
 17295     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17297     MOVE X'2020233030303135383531' TO DFHEIV0(25:11)
 17298     CALL 'kxdfhei1' USING DFHEIV0,
 17299           LINK-REMAMT,
 17300           CALCULATION-PASS-AREA,
 17301           CP-COMM-LENGTH,
 17302           DFHEIV99,
 17303           DFHEIV99,
 17304           DFHEIV99,
 17305           DFHEIV99
 17306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17307          MOVE CP-REMAINING-AMT       TO BENEO
 17308       end-if
 17309     end-if
 17310     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17311     MOVE +95                    TO TRLR-SEQ-NO
 17312
 17313* EXEC CICS READ
 17314*       DATASET  ('ELTRLR')
 17315*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17316*       RIDFLD   (ELTRLR-KEY)
 17317*       RESP     (WS-RESPONSE)
 17318*    END-EXEC
 17319     MOVE 'ELTRLR' TO DFHEIV1
 17320*    MOVE '&"S        E          (  N#00015861' TO DFHEIV0
 17321     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17323     MOVE X'204E233030303135383631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 333
* EL156.cbl
 17324     CALL 'kxdfhei1' USING DFHEIV0,
 17325           DFHEIV1,
 17326           DFHEIV20,
 17327           DFHEIV99,
 17328           ELTRLR-KEY,
 17329           DFHEIV99,
 17330           DFHEIV99,
 17331           DFHEIV99
 17332     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17333         DFHEIV20
 17334     MOVE EIBRESP  TO WS-RESPONSE
 17335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17336
 17337     if ws-resp-normal
 17338        perform varying s1 from +1 by +1 until
 17339           at-note-error-no (s1) = spaces
 17340           move at-note-error-no (s1)
 17341                                 to emi-error
 17342           if at-note-error-no (s1) = '1653'
 17343              evaluate true
 17344                 when cl-claim-type = 'L'
 17345                    move '  LF  '
 17346                                 to emi-claim-type
 17347                 when cl-claim-type = 'I'
 17348                    move '  IU  '
 17349                                 to emi-claim-type
 17350                 when other
 17351                    move '  AH  '
 17352                                 to emi-claim-type
 17353              end-evaluate
 17354           end-if
 17355           PERFORM 9900-ERROR-FORMAT
 17356                                 THRU 9900-EXIT
 17357        end-perform
 17358     end-if
 17359     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17360         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17361            WS-LF-COVERAGE-TYPE = 'P'
 17362             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17363                                        CM-LF-ITD-DEATH-AMT
 17364             MOVE WS-REMAINING-AMT  TO  BENEO.
 17365
 17366     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17367     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17368     MOVE WS-TERMS               TO TERMSO.
 17369
 17370     IF WS-STATUS = '6' OR '7' OR '8'
 17371         MOVE AL-SABOF           TO CRTSTATA.
 17372
 17373     IF WS-STATUS = '1' OR '4'
 17374        IF CP-REMAINING-TERM-3 = ZEROS
 17375           MOVE 'EXPIRED'        TO CRTSTATO
 17376        ELSE
 17377           MOVE 'ACTIVE  '       TO CRTSTATO.
 17378
 17379     IF WS-STATUS = '2'
 17380         MOVE 'PEND    '         TO CRTSTATO.
 17381
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 334
* EL156.cbl
 17382     IF WS-STATUS = '3'
 17383         MOVE 'RESTORE '         TO CRTSTATO.
 17384
 17385     IF WS-STATUS = '5'
 17386         MOVE 'REISSUE '         TO CRTSTATO.
 17387
 17388     IF WS-STATUS = '6'
 17389         MOVE 'LMP DIS'          TO CRTSTATO.
 17390
 17391     IF WS-STATUS = '7'
 17392         MOVE 'DEATH'            TO CRTSTATO.
 17393
 17394     IF WS-STATUS = '8'
 17395         MOVE 'CANCEL'           TO CRTSTATO.
 17396
 17397     IF WS-STATUS = '9'
 17398         MOVE 'RE-ONLY '         TO CRTSTATO.
 17399
 17400     IF WS-STATUS = 'V'
 17401         MOVE 'VOID  '           TO CRTSTATO.
 17402
 17403     IF WS-STATUS = 'D'
 17404         MOVE 'DECLINE '         TO CRTSTATO.
 17405
 17406     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17407         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17408         MOVE '5'                TO CNTL-REC-TYPE
 17409     ELSE
 17410         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17411         MOVE '4'                TO CNTL-REC-TYPE.
 17412
 17413     MOVE '** NONE **'           TO COVERO.
 17414     MOVE AL-SABON               TO COVERA.
 17415
 17416     IF PI-COMPANY-ID = 'CVL'
 17417         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17418             MOVE CM-BENEFICIARY TO LOANNOO
 17419             MOVE AL-UANON       TO LOANNOA.
 17420
 17421     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17422        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17423        MOVE +91                 TO  TRLR-SEQ-NO
 17424
 17425* EXEC CICS READ
 17426*           DATASET  ('ELTRLR')
 17427*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17428*           RIDFLD   (ELTRLR-KEY)
 17429*           RESP     (WS-RESPONSE)
 17430*       END-EXEC
 17431     MOVE 'ELTRLR' TO DFHEIV1
 17432*    MOVE '&"S        E          (  N#00015955' TO DFHEIV0
 17433     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17435     MOVE X'204E233030303135393535' TO DFHEIV0(25:11)
 17436     CALL 'kxdfhei1' USING DFHEIV0,
 17437           DFHEIV1,
 17438           DFHEIV20,
 17439           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 335
* EL156.cbl
 17440           ELTRLR-KEY,
 17441           DFHEIV99,
 17442           DFHEIV99,
 17443           DFHEIV99
 17444     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17445         DFHEIV20
 17446     MOVE EIBRESP  TO WS-RESPONSE
 17447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17448
 17449        IF WS-RESP-NORMAL
 17450           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17451        ELSE
 17452           MOVE SPACES           TO  LOANNOO
 17453        END-IF
 17454*052506
 17455*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17456*052506
 17457     END-IF
 17458
 17459     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17460        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17461
 17462     IF WS-BEN-CD = ZEROS
 17463         GO TO 7050-SHOW-CONTINUE.
 17464
 17465     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17466     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17467     MOVE +0                     TO CNTL-SEQ-NO.
 17468     MOVE 'BENE'                 TO FILE-SWITCH.
 17469
 17470     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17471
 17472     IF BENEFIT-FOUND
 17473         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17474         MOVE AL-SANON                    TO COVERA.
 17475
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 336
* EL156.cbl
 17477 7050-SHOW-CONTINUE.
 17478
 17479     IF PI-COMPANY-ID = 'DMD'
 17480         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17481
 17482     MOVE -1                     TO PMTTYPEL.
 17483     GO TO 8100-SEND-INITIAL-MAP.
 17484
 17485 7100-SHOW-RECORD-NOT-FOUND.
 17486     IF FILE-SWITCH = 'MSTR'
 17487         MOVE ER-0204            TO EMI-ERROR.
 17488
 17489     IF FILE-SWITCH = 'CERT'
 17490         MOVE ER-0206            TO EMI-ERROR.
 17491
 17492     IF FILE-SWITCH = 'STAT'
 17493         MOVE ER-0149            TO EMI-ERROR.
 17494
 17495     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17496
 17497     MOVE -1                     TO PMTTYPEL.
 17498     GO TO 8100-SEND-INITIAL-MAP
 17499
 17500     .
 17501 7110-BUILD-PMT-TRLR.
 17502     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17503     MOVE +51                    TO TRLR-SEQ-NO
 17504
 17505* EXEC CICS READ
 17506*        DATASET  ('ELTRLR')
 17507*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17508*        RIDFLD   (ELTRLR-KEY)
 17509*        RESP     (WS-RESPONSE)
 17510*    END-EXEC
 17511     MOVE 'ELTRLR' TO DFHEIV1
 17512*    MOVE '&"S        E          (  N#00016017' TO DFHEIV0
 17513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17515     MOVE X'204E233030303136303137' TO DFHEIV0(25:11)
 17516     CALL 'kxdfhei1' USING DFHEIV0,
 17517           DFHEIV1,
 17518           DFHEIV20,
 17519           DFHEIV99,
 17520           ELTRLR-KEY,
 17521           DFHEIV99,
 17522           DFHEIV99,
 17523           DFHEIV99
 17524     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17525         DFHEIV20
 17526     MOVE EIBRESP  TO WS-RESPONSE
 17527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17528     IF WS-RESP-NORMAL
 17529        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 17530     END-IF
 17531     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17532
 17533* EXEC CICS GETMAIN
 17534*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 337
* EL156.cbl
 17535*         LENGTH    (200)
 17536*         INITIMG   (GETMAIN-SPACE)
 17537*     END-EXEC
 17538     MOVE 200
 17539       TO DFHEIV11
 17540*    MOVE ',"IL                  $   #00016027' TO DFHEIV0
 17541     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17542     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17543     MOVE X'2020233030303136303237' TO DFHEIV0(25:11)
 17544     CALL 'kxdfhei1' USING DFHEIV0,
 17545           DFHEIV20,
 17546           DFHEIV11,
 17547           GETMAIN-SPACE
 17548     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17549         DFHEIV20
 17550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17551     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17552                                    AT-PREV-PAID-THRU-DT
 17553     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17554     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17555     MOVE 'AT'                   TO AT-RECORD-ID
 17556     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17557     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17558     MOVE '2'                    TO AT-TRAILER-TYPE
 17559     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17560                                    AT-PAYMENT-LAST-MAINT-DT
 17561     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17562                                    AT-PAYMENT-LAST-UPDATED-BY
 17563     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17564     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17565     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17566     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17567     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17568     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17569     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17570     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17571     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17572     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17573     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17574     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17575     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17576     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17577     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17578     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17579                                    AT-TO-BE-WRITTEN-DT
 17580     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17581                                    AT-CHECK-QUE-SEQUENCE
 17582                                    AT-ADDL-RESERVE
 17583     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17584                                    AT-VOID-SELECT-DT
 17585                                    AT-VOID-ACCEPT-DT
 17586                                    AT-VOID-DT
 17587                                    AT-PMT-PROOF-DT
 17588                                    AT-INT-PMT-SELECT-DT
 17589     MOVE ZEROS                  TO AT-DAILY-RATE
 17590                                    AT-ELIMINATION-DAYS
 17591     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17592*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 338
* EL156.cbl
 17593*        DUPREC    (7120-DUPREC)
 17594*    END-EXEC
 17595     .
 17596 7115-WRITE-INT-TRLR.
 17597
 17598* EXEC CICS WRITE
 17599*         DATASET       ('ELTRLR')
 17600*         FROM          (ACTIVITY-TRAILERS)
 17601*         RIDFLD        (AT-CONTROL-PRIMARY)
 17602*         RESP          (WS-RESPONSE)
 17603*     END-EXEC
 17604     MOVE LENGTH OF
 17605      ACTIVITY-TRAILERS
 17606       TO DFHEIV11
 17607     MOVE 'ELTRLR' TO DFHEIV1
 17608*    MOVE '&$ L                  ''  N#00016078' TO DFHEIV0
 17609     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17610     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17611     MOVE X'204E233030303136303738' TO DFHEIV0(25:11)
 17612     CALL 'kxdfhei1' USING DFHEIV0,
 17613           DFHEIV1,
 17614           ACTIVITY-TRAILERS,
 17615           DFHEIV11,
 17616           AT-CONTROL-PRIMARY,
 17617           DFHEIV99,
 17618           DFHEIV99
 17619     MOVE EIBRESP  TO WS-RESPONSE
 17620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17621      IF WS-RESP-DUPREC
 17622         GO TO 7120-DUPREC
 17623      END-IF
 17624     GO TO 7130-EXIT
 17625     .
 17626 7120-DUPREC.
 17627     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17628     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17629     GO TO 7115-WRITE-INT-TRLR
 17630     .
 17631 7130-EXIT.
 17632      EXIT.
 17633 7140-BUILD-NOTE-TRLR.
 17634
 17635
 17636* EXEC CICS GETMAIN
 17637*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17638*         LENGTH    (200)
 17639*         INITIMG   (GETMAIN-SPACE)
 17640*     END-EXEC
 17641     MOVE 200
 17642       TO DFHEIV11
 17643*    MOVE ',"IL                  $   #00016098' TO DFHEIV0
 17644     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17646     MOVE X'2020233030303136303938' TO DFHEIV0(25:11)
 17647     CALL 'kxdfhei1' USING DFHEIV0,
 17648           DFHEIV20,
 17649           DFHEIV11,
 17650           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 339
* EL156.cbl
 17651     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17652         DFHEIV20
 17653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17654     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17655     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17656     MOVE 'AT'                   TO AT-RECORD-ID
 17657     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17658     MOVE '6'                    TO AT-TRAILER-TYPE
 17659     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17660                                    AT-GEN-INFO-LAST-MAINT-DT
 17661     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17662                                    AT-GEN-INFO-LAST-UPDATED-BY
 17663     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17664     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17665     .
 17666 7150-WRITE.
 17667
 17668* EXEC CICS HANDLE CONDITION
 17669*        DUPREC    (7160-DUPREC)
 17670*    END-EXEC
 17671*    MOVE '"$%                   ! : #00016116' TO DFHEIV0
 17672     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17674     MOVE X'3A20233030303136313136' TO DFHEIV0(25:11)
 17675     CALL 'kxdfhei1' USING DFHEIV0
 17676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17677
 17678* EXEC CICS WRITE
 17679*         DATASET     ('ELTRLR')
 17680*         FROM        (ACTIVITY-TRAILERS)
 17681*         RIDFLD      (AT-CONTROL-PRIMARY)
 17682*         RESP        (WS-RESPONSE)
 17683*     END-EXEC
 17684     MOVE LENGTH OF
 17685      ACTIVITY-TRAILERS
 17686       TO DFHEIV11
 17687     MOVE 'ELTRLR' TO DFHEIV1
 17688*    MOVE '&$ L                  ''  N#00016119' TO DFHEIV0
 17689     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17690     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17691     MOVE X'204E233030303136313139' TO DFHEIV0(25:11)
 17692     CALL 'kxdfhei1' USING DFHEIV0,
 17693           DFHEIV1,
 17694           ACTIVITY-TRAILERS,
 17695           DFHEIV11,
 17696           AT-CONTROL-PRIMARY,
 17697           DFHEIV99,
 17698           DFHEIV99
 17699     MOVE EIBRESP  TO WS-RESPONSE
 17700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17701      IF WS-RESP-DUPREC
 17702         GO TO 7160-DUPREC
 17703      END-IF
 17704     GO TO 7170-EXIT
 17705     .
 17706 7160-DUPREC.
 17707     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17708     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 340
* EL156.cbl
 17709     GO TO 7150-WRITE
 17710     .
 17711 7170-EXIT.
 17712      EXIT.
 17713
 17714 7180-ADD-CERT-NOTE.
 17715*ADD CERT NOTE FOR SC NP+6
 17716
 17717
 17718* EXEC CICS GETMAIN
 17719*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17720*         LENGTH    (150)
 17721*         INITIMG   (GETMAIN-SPACE)
 17722*     END-EXEC.
 17723     MOVE 150
 17724       TO DFHEIV11
 17725*    MOVE ',"IL                  $   #00016141' TO DFHEIV0
 17726     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17727     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17728     MOVE X'2020233030303136313431' TO DFHEIV0(25:11)
 17729     CALL 'kxdfhei1' USING DFHEIV0,
 17730           DFHEIV20,
 17731           DFHEIV11,
 17732           GETMAIN-SPACE
 17733     SET ADDRESS OF CERT-NOTE-FILE TO
 17734         DFHEIV20
 17735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17736
 17737
 17738     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17739     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17740     MOVE +1                     TO WRK-NOTE-SEQ.
 17741     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17742     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17743     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17744     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17745     MOVE CL-CERT-STATE          TO CZ-STATE.
 17746     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17747     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17748     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17749     MOVE '2'                    TO CZ-RECORD-TYPE.
 17750     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17751     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17752     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17753     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17754     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17755     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17756     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17757     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17758     IF PI-COMPANY-ID = 'AHL'
 17759        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17760           CONTINUE
 17761        ELSE
 17762           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17763              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17764           ELSE
 17765              MOVE ' + 2 MO '    TO SC-NP6-COMM
 17766           END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 341
* EL156.cbl
 17767        END-IF
 17768     END-IF
 17769     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 17770     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 17771
 17772 7181-WRITE.
 17773
 17774
 17775* EXEC CICS WRITE
 17776*         DATASET     ('ERCNOT')
 17777*         FROM        (CERT-NOTE-FILE)
 17778*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17779*         RESP        (WS-RESPONSE)
 17780*    END-EXEC.
 17781     MOVE LENGTH OF
 17782      CERT-NOTE-FILE
 17783       TO DFHEIV11
 17784     MOVE 'ERCNOT' TO DFHEIV1
 17785*    MOVE '&$ L                  ''  N#00016183' TO DFHEIV0
 17786     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17787     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17788     MOVE X'204E233030303136313833' TO DFHEIV0(25:11)
 17789     CALL 'kxdfhei1' USING DFHEIV0,
 17790           DFHEIV1,
 17791           CERT-NOTE-FILE,
 17792           DFHEIV11,
 17793           CZ-CONTROL-PRIMARY,
 17794           DFHEIV99,
 17795           DFHEIV99
 17796     MOVE EIBRESP  TO WS-RESPONSE
 17797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17798
 17799
 17800     IF WS-RESP-DUPREC
 17801         GO TO 7182-DUPREC
 17802     END-IF.
 17803
 17804     SET CERT-NOTE-ADDED TO TRUE.
 17805
 17806     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 17807         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 17808     END-IF.
 17809
 17810     GO TO 7189-EXIT.
 17811
 17812 7182-DUPREC.
 17813
 17814     ADD +1                      TO  WRK-NOTE-SEQ.
 17815     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17816     GO TO 7181-WRITE.
 17817
 17818 7189-EXIT.
 17819      EXIT.
 17820
 17821 7190-ADD-ORIG-NOTE.
 17822
 17823
 17824* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 342
* EL156.cbl
 17825*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17826*         LENGTH    (150)
 17827*         INITIMG   (GETMAIN-SPACE)
 17828*     END-EXEC.
 17829     MOVE 150
 17830       TO DFHEIV11
 17831*    MOVE ',"IL                  $   #00016213' TO DFHEIV0
 17832     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17833     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17834     MOVE X'2020233030303136323133' TO DFHEIV0(25:11)
 17835     CALL 'kxdfhei1' USING DFHEIV0,
 17836           DFHEIV20,
 17837           DFHEIV11,
 17838           GETMAIN-SPACE
 17839     SET ADDRESS OF CERT-NOTE-FILE TO
 17840         DFHEIV20
 17841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17842
 17843
 17844     ADD +1                      TO WRK-NOTE-SEQ.
 17845     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17846     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17847     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17848     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17849     MOVE CL-CERT-STATE          TO CZ-STATE.
 17850     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17851     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17852     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17853     MOVE '2'                    TO CZ-RECORD-TYPE.
 17854     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17855     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17856     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17857     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17858     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17859     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 17860
 17861 7191-WRITE.
 17862
 17863
 17864* EXEC CICS WRITE
 17865*         DATASET     ('ERCNOT')
 17866*         FROM        (CERT-NOTE-FILE)
 17867*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17868*         RESP        (WS-RESPONSE)
 17869*    END-EXEC.
 17870     MOVE LENGTH OF
 17871      CERT-NOTE-FILE
 17872       TO DFHEIV11
 17873     MOVE 'ERCNOT' TO DFHEIV1
 17874*    MOVE '&$ L                  ''  N#00016238' TO DFHEIV0
 17875     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17877     MOVE X'204E233030303136323338' TO DFHEIV0(25:11)
 17878     CALL 'kxdfhei1' USING DFHEIV0,
 17879           DFHEIV1,
 17880           CERT-NOTE-FILE,
 17881           DFHEIV11,
 17882           CZ-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 343
* EL156.cbl
 17883           DFHEIV99,
 17884           DFHEIV99
 17885     MOVE EIBRESP  TO WS-RESPONSE
 17886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17887
 17888
 17889     IF WS-RESP-DUPREC
 17890         GO TO 7192-DUPREC
 17891     END-IF.
 17892
 17893     GO TO 7199-EXIT.
 17894
 17895 7192-DUPREC.
 17896
 17897     ADD +1                      TO  WRK-NOTE-SEQ.
 17898     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17899     GO TO 7191-WRITE.
 17900
 17901 7199-EXIT.
 17902      EXIT.
 17903 7200-FIND-BENEFIT.
 17904     MOVE 'N' TO WS-BEN-SEARCH-SW.
 17905
 17906
 17907* EXEC CICS HANDLE CONDITION
 17908*        ENDFILE(7200-EXIT)
 17909*        NOTFND(7200-EXIT)
 17910*    END-EXEC.
 17911*    MOVE '"$''I                  ! ; #00016262' TO DFHEIV0
 17912     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17914     MOVE X'3B20233030303136323632' TO DFHEIV0(25:11)
 17915     CALL 'kxdfhei1' USING DFHEIV0
 17916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17917
 17918
 17919
 17920* EXEC CICS READ
 17921*        DATASET('ELCNTL')
 17922*        SET(ADDRESS OF CONTROL-FILE)
 17923*        RIDFLD(ELCNTL-KEY)
 17924*        GTEQ
 17925*    END-EXEC.
 17926     MOVE 'ELCNTL' TO DFHEIV1
 17927*    MOVE '&"S        G          (   #00016267' TO DFHEIV0
 17928     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17930     MOVE X'2020233030303136323637' TO DFHEIV0(25:11)
 17931     CALL 'kxdfhei1' USING DFHEIV0,
 17932           DFHEIV1,
 17933           DFHEIV20,
 17934           DFHEIV99,
 17935           ELCNTL-KEY,
 17936           DFHEIV99,
 17937           DFHEIV99,
 17938           DFHEIV99
 17939     SET ADDRESS OF CONTROL-FILE TO
 17940         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 344
* EL156.cbl
 17941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17942
 17943
 17944     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 17945        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 17946           GO TO 7200-EXIT.
 17947
 17948     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 17949         VARYING SUB-1 FROM 1 BY 1 UNTIL
 17950            ((SUB-1 > 8) OR
 17951            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 17952
 17953     IF SUB-1 NOT = 9
 17954         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 17955
 17956     GO TO 7200-EXIT.
 17957
 17958 7200-BENEFIT-DUMMY.
 17959
 17960 7200-DUMMY-EXIT.
 17961     EXIT.
 17962
 17963 7200-EXIT.
 17964     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 345
* EL156.cbl
 17966*052506
 17967*052506 7250-FIND-LETTER-TRLR.
 17968*052506     EXEC CICS HANDLE CONDITION
 17969*052506         ENDFILE  (7250-END)
 17970*052506         NOTFND   (7250-END)
 17971*052506     END-EXEC.
 17972*052506
 17973*052506     EXEC CICS STARTBR
 17974*052506         DATASET   ('ELTRLR')
 17975*052506         RIDFLD    (ELTRLR-KEY)
 17976*052506         GTEQ
 17977*052506     END-EXEC.
 17978*052506
 17979*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 17980*052506
 17981*052506 7250-FIND-LOOP.
 17982*052506     EXEC CICS READNEXT
 17983*052506         DATASET   ('ELTRLR')
 17984*052506         RIDFLD    (ELTRLR-KEY)
 17985*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17986*052506     END-EXEC.
 17987*052506
 17988*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17989*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17990*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17991*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 17992*052506        GO TO 7250-END
 17993*052506     END-IF.
 17994*052506
 17995*052506     IF AT-TRAILER-TYPE NOT = '4'
 17996*052506         GO TO 7250-FIND-LOOP
 17997*052506     END-IF.
 17998*052506
 17999*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18000*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18001*052506     END-IF.
 18002*052506
 18003*052506     GO TO 7250-FIND-LOOP.
 18004*052506
 18005*052506 7250-END.
 18006*052506
 18007*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18008*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18009*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18010*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18011*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18012*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18013*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18014*052506     END-IF.
 18015*052506
 18016*052506     EXEC CICS ENDBR
 18017*052506          DATASET    ('ELTRLR')
 18018*052506     END-EXEC.
 18019*052506
 18020*052506 7250-EXIT.
 18021*052506     EXIT.
 18022*052506     EJECT
 18023*052506
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 346
* EL156.cbl
 18024 7300-CHECK-AUTO-ACTIVITY.
 18025
 18026     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18027         NEXT SENTENCE
 18028     ELSE
 18029         GO TO 7399-EXIT.
 18030
 18031     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18032
 18033     IF WS-ACT-REC-FOUND-SW = 'N'
 18034         GO TO 7399-EXIT.
 18035
 18036     IF PI-ACTIVITY-CODE = 09
 18037         GO TO 7300-CONT-AUTO-ACTIVITY.
 18038
 18039     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18040        (PI-ACTIVITY-CODE = 11)
 18041         GO TO 7300-CONT-AUTO-ACTIVITY.
 18042
 18043     IF PI-PROVISIONAL-IND = 'P'
 18044         IF PI-PMTTYPE = '1'
 18045             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18046                 MOVE 'N'    TO  PI-RESET-SW
 18047                 GO TO 7399-EXIT.
 18048
 18049     IF PI-PMTTYPE = '1'
 18050         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18051             MOVE 'N'        TO  PI-RESET-SW
 18052             GO TO 7399-EXIT.
 18053
 18054     IF PI-PMTTYPE = '2' OR '3'
 18055         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18056             MOVE 'N'        TO  PI-RESET-SW
 18057             GO TO 7399-EXIT.
 18058
 18059     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18060         IF PI-PROVISIONAL-IND = 'P'
 18061             NEXT SENTENCE
 18062         ELSE
 18063             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18064
 18065 7300-CONT-AUTO-ACTIVITY.
 18066
 18067     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18068         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18069         MOVE '4'            TO DC-OPTION-CODE
 18070         MOVE +0             TO DC-ELAPSED-DAYS
 18071                                DC-ELAPSED-MONTHS
 18072         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18073         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18074         IF PI-USES-PAID-TO
 18075             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18076             IF NO-CONVERSION-ERROR
 18077                 MOVE +1     TO DC-ELAPSED-DAYS
 18078                 MOVE +0     TO DC-ELAPSED-MONTHS
 18079                 MOVE '6'    TO DC-OPTION-CODE
 18080                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18081                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 347
* EL156.cbl
 18082                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18083
 18084     IF PI-PFKEY-USED = DFHPF5
 18085         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18086         IF PI-USES-PAID-TO
 18087             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18088             MOVE +1                  TO DC-ELAPSED-DAYS
 18089             MOVE +0                  TO DC-ELAPSED-MONTHS
 18090             MOVE '6'                 TO DC-OPTION-CODE
 18091             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18092             IF NO-CONVERSION-ERROR
 18093                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18094
 18095     IF WS-CHK-THRU-DT < PI-EXP-DT
 18096         NEXT SENTENCE
 18097     ELSE
 18098         MOVE 03                     TO  WS-ACTIVITY-CODE
 18099         GO TO 7390-PROCESS-ACTIVITY.
 18100
 18101     IF PI-PROV-PMT
 18102         MOVE 09                     TO  WS-ACTIVITY-CODE
 18103     ELSE
 18104        IF PI-PMTTYPE = '1'
 18105            MOVE 02                  TO  WS-ACTIVITY-CODE
 18106        ELSE
 18107        IF PI-PMTTYPE = '2' OR '3'
 18108            MOVE 07                  TO  WS-ACTIVITY-CODE
 18109        ELSE
 18110        IF PI-PMTTYPE = '4'
 18111            MOVE 00                  TO  WS-ACTIVITY-CODE
 18112        ELSE
 18113            MOVE 'N'                 TO  PI-RESET-SW
 18114            GO TO 7399-EXIT.
 18115
 18116 7390-PROCESS-ACTIVITY.
 18117
 18118     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 18119
 18120 7399-EXIT.
 18121     EXIT.
 18122
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 348
* EL156.cbl
 18124 7400-CHECK-AUTO-ACTIVITY.
 18125
 18126
 18127* EXEC CICS HANDLE CONDITION
 18128*        NOTFND   (7400-NOT-FOUND)
 18129*    END-EXEC.
 18130*    MOVE '"$I                   ! < #00016456' TO DFHEIV0
 18131     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18133     MOVE X'3C20233030303136343536' TO DFHEIV0(25:11)
 18134     CALL 'kxdfhei1' USING DFHEIV0
 18135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18136
 18137
 18138     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18139     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18140     MOVE SPACES                 TO  CNTL-ACCESS.
 18141     MOVE +0                     TO  CNTL-SEQ-NO.
 18142
 18143
 18144* EXEC CICS READ
 18145*        DATASET   ('ELCNTL')
 18146*        RIDFLD    (ELCNTL-KEY)
 18147*        SET       (ADDRESS OF CONTROL-FILE)
 18148*    END-EXEC.
 18149     MOVE 'ELCNTL' TO DFHEIV1
 18150*    MOVE '&"S        E          (   #00016465' TO DFHEIV0
 18151     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18153     MOVE X'2020233030303136343635' TO DFHEIV0(25:11)
 18154     CALL 'kxdfhei1' USING DFHEIV0,
 18155           DFHEIV1,
 18156           DFHEIV20,
 18157           DFHEIV99,
 18158           ELCNTL-KEY,
 18159           DFHEIV99,
 18160           DFHEIV99,
 18161           DFHEIV99
 18162     SET ADDRESS OF CONTROL-FILE TO
 18163         DFHEIV20
 18164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18165
 18166
 18167     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18168     GO TO 7400-EXIT.
 18169
 18170 7400-NOT-FOUND.
 18171     MOVE 'N'                        TO  PI-RESET-SW
 18172                                         WS-LETTER-SW
 18173                                         WS-ACT-REC-FOUND-SW.
 18174
 18175     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18176
 18177 7400-EXIT.
 18178     EXIT.
 18179
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 349
* EL156.cbl
 18181 7450-FORMAT-AUTO-LETTER.
 18182
 18183     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18184         MOVE 'Y'                    TO PI-RESET-SW
 18185         GO TO 7450-CONTINUE-PROCESS.
 18186
 18187     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18188
 18189     IF SUB > 9
 18190         SUBTRACT 9 FROM SUB
 18191         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18192     ELSE
 18193         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18194
 18195 7450-CONTINUE-PROCESS.
 18196
 18197     IF WS-ACTIVITY-CODE = ZEROS
 18198         MOVE 'N'                    TO  WS-LETTER-SW
 18199         GO TO 7499-EXIT.
 18200
 18201     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18202
 18203     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18204         MOVE 'N'                    TO  PI-RESET-SW
 18205                                         WS-LETTER-SW
 18206         GO TO 7499-EXIT.
 18207
 18208     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18209         MOVE 'N'                    TO  WS-LETTER-SW
 18210         GO TO 7499-EXIT.
 18211
 18212     MOVE 'Y'                        TO  WS-LETTER-SW.
 18213     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18214     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18215
 18216     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18217
 18218     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18219         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18220         MOVE '6'                    TO  DC-OPTION-CODE
 18221         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18222         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18223         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18224         IF NO-CONVERSION-ERROR
 18225             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18226         ELSE
 18227              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18228
 18229     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18230         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18231         MOVE '6'                    TO  DC-OPTION-CODE
 18232         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18233         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18234         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18235         IF NO-CONVERSION-ERROR
 18236             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18237         ELSE
 18238             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 350
* EL156.cbl
 18239
 18240 7499-EXIT.
 18241     EXIT.
 18242
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 351
* EL156.cbl
 18244 7500-RESET-AUTO-ACTIVITY.
 18245
 18246     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18247     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18248     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18249     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18250     MOVE +100                   TO  TRLR-SEQ-NO.
 18251
 18252 7500-STARTBR-TRLR.
 18253
 18254
 18255* EXEC CICS HANDLE CONDITION
 18256*        ENDFILE  (7590-END)
 18257*        NOTFND   (7590-END)
 18258*    END-EXEC.
 18259*    MOVE '"$''I                  ! = #00016558' TO DFHEIV0
 18260     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18262     MOVE X'3D20233030303136353538' TO DFHEIV0(25:11)
 18263     CALL 'kxdfhei1' USING DFHEIV0
 18264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18265
 18266
 18267
 18268* EXEC CICS STARTBR
 18269*        DATASET   ('ELTRLR')
 18270*        RIDFLD    (ELTRLR-KEY)
 18271*        GTEQ
 18272*    END-EXEC.
 18273     MOVE 'ELTRLR' TO DFHEIV1
 18274     MOVE 0
 18275       TO DFHEIV11
 18276*    MOVE '&,         G          &   #00016563' TO DFHEIV0
 18277     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18278     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18279     MOVE X'2020233030303136353633' TO DFHEIV0(25:11)
 18280     CALL 'kxdfhei1' USING DFHEIV0,
 18281           DFHEIV1,
 18282           ELTRLR-KEY,
 18283           DFHEIV99,
 18284           DFHEIV11,
 18285           DFHEIV99
 18286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18287
 18288
 18289     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18290
 18291 7500-READ-NEXT.
 18292
 18293
 18294* EXEC CICS READNEXT
 18295*        DATASET   ('ELTRLR')
 18296*        RIDFLD    (ELTRLR-KEY)
 18297*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18298*    END-EXEC.
 18299     MOVE 'ELTRLR' TO DFHEIV1
 18300     MOVE 0
 18301       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 352
* EL156.cbl
 18302*    MOVE '&.S                   )   #00016573' TO DFHEIV0
 18303     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18304     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18305     MOVE X'2020233030303136353733' TO DFHEIV0(25:11)
 18306     CALL 'kxdfhei1' USING DFHEIV0,
 18307           DFHEIV1,
 18308           DFHEIV20,
 18309           DFHEIV99,
 18310           ELTRLR-KEY,
 18311           DFHEIV99,
 18312           DFHEIV11,
 18313           DFHEIV99,
 18314           DFHEIV99
 18315     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18316         DFHEIV20
 18317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18318
 18319
 18320     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18321        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18322        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18323        PI-CERT-NO    NOT = TRLR-CERT-NO
 18324         GO TO 7590-END.
 18325
 18326     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18327         GO TO 7500-READ-NEXT.
 18328
 18329     IF AT-TRAILER-TYPE NOT = '4'
 18330         GO TO 7500-READ-NEXT.
 18331
 18332     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18333         GO TO 7500-READ-NEXT.
 18334
 18335     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18336        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18337         GO TO 7500-READ-NEXT.
 18338
 18339     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18340        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18341        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18342         GO TO 7500-READ-NEXT.
 18343
 18344     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18345                         AND
 18346        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18347                         AND
 18348        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18349            GO TO 7500-READ-NEXT.
 18350
 18351     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18352
 18353
 18354* EXEC CICS ENDBR
 18355*        DATASET   ('ELTRLR')
 18356*    END-EXEC.
 18357     MOVE 'ELTRLR' TO DFHEIV1
 18358     MOVE 0
 18359       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 353
* EL156.cbl
 18360*    MOVE '&2                    $   #00016612' TO DFHEIV0
 18361     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18363     MOVE X'2020233030303136363132' TO DFHEIV0(25:11)
 18364     CALL 'kxdfhei1' USING DFHEIV0,
 18365           DFHEIV1,
 18366           DFHEIV11,
 18367           DFHEIV99
 18368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18369
 18370
 18371     MOVE 'N'                        TO  WS-BROWSE-SW.
 18372
 18373
 18374* EXEC CICS READ
 18375*        DATASET   ('ELTRLR')
 18376*        RIDFLD    (ELTRLR-KEY)
 18377*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18378*        UPDATE
 18379*    END-EXEC.
 18380     MOVE 'ELTRLR' TO DFHEIV1
 18381*    MOVE '&"S        EU         (   #00016618' TO DFHEIV0
 18382     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18383     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18384     MOVE X'2020233030303136363138' TO DFHEIV0(25:11)
 18385     CALL 'kxdfhei1' USING DFHEIV0,
 18386           DFHEIV1,
 18387           DFHEIV20,
 18388           DFHEIV99,
 18389           ELTRLR-KEY,
 18390           DFHEIV99,
 18391           DFHEIV99,
 18392           DFHEIV99
 18393     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18394         DFHEIV20
 18395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18396
 18397
 18398     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18399
 18400     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18401         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18402     ELSE
 18403         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18404             NEXT SENTENCE
 18405         ELSE
 18406             GO TO 7500-REWRITE-TRLR.
 18407
 18408     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18409
 18410     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18411     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18412     MOVE '1'                        TO  ARCH-REC-TYPE.
 18413     MOVE +0                         TO  ARCH-SEQ.
 18414
 18415     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18416
 18417 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 354
* EL156.cbl
 18418
 18419
 18420* EXEC CICS REWRITE
 18421*        DATASET   ('ELTRLR')
 18422*        FROM      (ACTIVITY-TRAILERS)
 18423*    END-EXEC.
 18424     MOVE LENGTH OF
 18425      ACTIVITY-TRAILERS
 18426       TO DFHEIV11
 18427     MOVE 'ELTRLR' TO DFHEIV1
 18428*    MOVE '&& L                  %   #00016646' TO DFHEIV0
 18429     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18430     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18431     MOVE X'2020233030303136363436' TO DFHEIV0(25:11)
 18432     CALL 'kxdfhei1' USING DFHEIV0,
 18433           DFHEIV1,
 18434           ACTIVITY-TRAILERS,
 18435           DFHEIV11,
 18436           DFHEIV99
 18437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18438
 18439
 18440     GO TO 7500-STARTBR-TRLR.
 18441
 18442 7590-END.
 18443
 18444     IF WS-BROWSE-SW = 'Y'
 18445         MOVE 'N'                    TO  WS-BROWSE-SW
 18446
 18447* EXEC CICS ENDBR
 18448*            DATASET   ('ELTRLR')
 18449*        END-EXEC.
 18450     MOVE 'ELTRLR' TO DFHEIV1
 18451     MOVE 0
 18452       TO DFHEIV11
 18453*    MOVE '&2                    $   #00016657' TO DFHEIV0
 18454     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18455     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18456     MOVE X'2020233030303136363537' TO DFHEIV0(25:11)
 18457     CALL 'kxdfhei1' USING DFHEIV0,
 18458           DFHEIV1,
 18459           DFHEIV11,
 18460           DFHEIV99
 18461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18462
 18463
 18464 7599-EXIT.
 18465     EXIT.
 18466
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 355
* EL156.cbl
 18468 7600-READ-ARCH-UPDATE.
 18469
 18470
 18471* EXEC CICS HANDLE CONDITION
 18472*        NOTFND   (7699-EXIT)
 18473*    END-EXEC.
 18474*    MOVE '"$I                   ! > #00016667' TO DFHEIV0
 18475     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18477     MOVE X'3E20233030303136363637' TO DFHEIV0(25:11)
 18478     CALL 'kxdfhei1' USING DFHEIV0
 18479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18480
 18481
 18482
 18483* EXEC CICS READ
 18484*        DATASET   ('ELARCH')
 18485*        RIDFLD    (ELARCH-KEY)
 18486*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18487*        UPDATE
 18488*    END-EXEC.
 18489     MOVE 'ELARCH' TO DFHEIV1
 18490*    MOVE '&"S        EU         (   #00016671' TO DFHEIV0
 18491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18492     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18493     MOVE X'2020233030303136363731' TO DFHEIV0(25:11)
 18494     CALL 'kxdfhei1' USING DFHEIV0,
 18495           DFHEIV1,
 18496           DFHEIV20,
 18497           DFHEIV99,
 18498           ELARCH-KEY,
 18499           DFHEIV99,
 18500           DFHEIV99,
 18501           DFHEIV99
 18502     SET ADDRESS OF LETTER-ARCHIVE TO
 18503         DFHEIV20
 18504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18505
 18506
 18507     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18508
 18509
 18510* EXEC CICS REWRITE
 18511*        DATASET   ('ELARCH')
 18512*        FROM      (LETTER-ARCHIVE)
 18513*    END-EXEC.
 18514     MOVE LENGTH OF
 18515      LETTER-ARCHIVE
 18516       TO DFHEIV11
 18517     MOVE 'ELARCH' TO DFHEIV1
 18518*    MOVE '&& L                  %   #00016680' TO DFHEIV0
 18519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18521     MOVE X'2020233030303136363830' TO DFHEIV0(25:11)
 18522     CALL 'kxdfhei1' USING DFHEIV0,
 18523           DFHEIV1,
 18524           LETTER-ARCHIVE,
 18525           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 356
* EL156.cbl
 18526           DFHEIV99
 18527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18528
 18529
 18530 7699-EXIT.
 18531     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 357
* EL156.cbl
 18533 7700-GET-DCT.
 18534
 18535     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18536     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18537     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18538     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18539                                    PI-MAX-BENEFIT-AMT
 18540                                    PI-MAX-BENEFIT-PYMT
 18541                                    PI-MIN-PAYMENT-AMT
 18542                                    PI-TIME-OF-LOSS-BAL.
 18543
 18544
 18545* EXEC CICS HANDLE CONDITION
 18546*         NOTFND (5300-NOTE-NOT-FOUND)
 18547*     END-EXEC.
 18548*    MOVE '"$I                   ! ? #00016699' TO DFHEIV0
 18549     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18551     MOVE X'3F20233030303136363939' TO DFHEIV0(25:11)
 18552     CALL 'kxdfhei1' USING DFHEIV0
 18553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18554
 18555
 18556
 18557* EXEC CICS READ
 18558*         DATASET('ERNOTE')
 18559*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18560*         RIDFLD (W-NOTE-KEY)
 18561*     END-EXEC.
 18562     MOVE 'ERNOTE' TO DFHEIV1
 18563*    MOVE '&"S        E          (   #00016703' TO DFHEIV0
 18564     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18566     MOVE X'2020233030303136373033' TO DFHEIV0(25:11)
 18567     CALL 'kxdfhei1' USING DFHEIV0,
 18568           DFHEIV1,
 18569           DFHEIV20,
 18570           DFHEIV99,
 18571           W-NOTE-KEY,
 18572           DFHEIV99,
 18573           DFHEIV99,
 18574           DFHEIV99
 18575     SET ADDRESS OF CERTIFICATE-NOTE TO
 18576         DFHEIV20
 18577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18578
 18579
 18580     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18581     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18582     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18583     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18584     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18585
 18586     IF PI-PAYEE-TYPE NOT = 'B'
 18587         GO TO 7700-EXIT.
 18588
 18589     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18590     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 358
* EL156.cbl
 18591     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18592
 18593     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18594         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18595     ELSE
 18596         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18597
 18598     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18599     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18600     MOVE 'DLO006'               TO PGM-NAME.
 18601
 18602
 18603* EXEC CICS LINK
 18604*        PROGRAM    (PGM-NAME)
 18605*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18606*        LENGTH     (DCT-RCRD-LENGTH)
 18607*    END-EXEC.
 18608*    MOVE '."C                   (   #00016731' TO DFHEIV0
 18609     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18611     MOVE X'2020233030303136373331' TO DFHEIV0(25:11)
 18612     CALL 'kxdfhei1' USING DFHEIV0,
 18613           PGM-NAME,
 18614           DCT-COMMUNICATION-AREA,
 18615           DCT-RCRD-LENGTH,
 18616           DFHEIV99,
 18617           DFHEIV99,
 18618           DFHEIV99,
 18619           DFHEIV99
 18620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18621
 18622
 18623     IF DCT-RETURN-CODE = 'OK'
 18624         GO TO 7700-CONT.
 18625
 18626     IF DCT-RETURN-CODE = '01' OR '02'
 18627         GO TO 7700-SET-TO-YES.
 18628
 18629     IF DCT-RETURN-CODE = '03'
 18630
 18631* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18632*    MOVE '6"R                   !   #00016744' TO DFHEIV0
 18633     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18635     MOVE X'2020233030303136373434' TO DFHEIV0(25:11)
 18636     CALL 'kxdfhei1' USING DFHEIV0
 18637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18638         MOVE ER-0951            TO EMI-ERROR
 18639         MOVE -1                 TO PMTTYPEL
 18640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18641         GO TO 8200-SEND-DATAONLY.
 18642
 18643     IF DCT-RETURN-CODE = '04'
 18644
 18645* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18646*    MOVE '6"R                   !   #00016751' TO DFHEIV0
 18647     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 359
* EL156.cbl
 18649     MOVE X'2020233030303136373531' TO DFHEIV0(25:11)
 18650     CALL 'kxdfhei1' USING DFHEIV0
 18651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18652         MOVE ER-0946            TO EMI-ERROR
 18653         MOVE -1                 TO PMTTYPEL
 18654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18655         GO TO 8200-SEND-DATAONLY.
 18656
 18657     IF DCT-RETURN-CODE = '05'
 18658
 18659* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18660*    MOVE '6"R                   !   #00016758' TO DFHEIV0
 18661     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18663     MOVE X'2020233030303136373538' TO DFHEIV0(25:11)
 18664     CALL 'kxdfhei1' USING DFHEIV0
 18665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18666         MOVE ER-0947            TO EMI-ERROR
 18667         MOVE -1                 TO PMTTYPEL
 18668         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18669         GO TO 8200-SEND-DATAONLY.
 18670
 18671     IF DCT-RETURN-CODE = '06'
 18672
 18673* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18674*    MOVE '6"R                   !   #00016765' TO DFHEIV0
 18675     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18677     MOVE X'2020233030303136373635' TO DFHEIV0(25:11)
 18678     CALL 'kxdfhei1' USING DFHEIV0
 18679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18680         MOVE ER-0921            TO EMI-ERROR
 18681         MOVE -1                 TO PMTTYPEL
 18682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18683         GO TO 8200-SEND-DATAONLY.
 18684
 18685     IF DCT-RETURN-CODE = '07'
 18686
 18687* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18688*    MOVE '6"R                   !   #00016772' TO DFHEIV0
 18689     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18691     MOVE X'2020233030303136373732' TO DFHEIV0(25:11)
 18692     CALL 'kxdfhei1' USING DFHEIV0
 18693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18694         MOVE ER-0919            TO EMI-ERROR
 18695         MOVE -1                 TO PMTTYPEL
 18696         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18697         GO TO 8200-SEND-DATAONLY.
 18698
 18699     IF DCT-RETURN-CODE = '08'
 18700
 18701* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18702*    MOVE '6"R                   !   #00016779' TO DFHEIV0
 18703     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18705     MOVE X'2020233030303136373739' TO DFHEIV0(25:11)
 18706     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 360
* EL156.cbl
 18707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18708         MOVE ER-0948            TO EMI-ERROR
 18709         MOVE -1                 TO PMTTYPEL
 18710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18711         GO TO 8200-SEND-DATAONLY.
 18712
 18713     IF DCT-RETURN-CODE = 'N1'
 18714
 18715* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18716*    MOVE '6"R                   !   #00016786' TO DFHEIV0
 18717     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18719     MOVE X'2020233030303136373836' TO DFHEIV0(25:11)
 18720     CALL 'kxdfhei1' USING DFHEIV0
 18721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18722         MOVE ER-0950            TO EMI-ERROR
 18723         MOVE -1                 TO PMTTYPEL
 18724         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18725         GO TO 8200-SEND-DATAONLY.
 18726
 18727     IF DCT-RETURN-CODE = 'E1'
 18728
 18729* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18730*    MOVE '6"R                   !   #00016793' TO DFHEIV0
 18731     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18733     MOVE X'2020233030303136373933' TO DFHEIV0(25:11)
 18734     CALL 'kxdfhei1' USING DFHEIV0
 18735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18736         MOVE ER-0974            TO EMI-ERROR
 18737         MOVE -1                 TO PMTTYPEL
 18738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18739         GO TO 8200-SEND-DATAONLY.
 18740
 18741     IF DCT-RETURN-CODE = 'E2'
 18742
 18743* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18744*    MOVE '6"R                   !   #00016800' TO DFHEIV0
 18745     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18747     MOVE X'2020233030303136383030' TO DFHEIV0(25:11)
 18748     CALL 'kxdfhei1' USING DFHEIV0
 18749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18750         MOVE ER-0975            TO EMI-ERROR
 18751         MOVE -1                 TO PMTTYPEL
 18752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18753         GO TO 8200-SEND-DATAONLY.
 18754
 18755     IF DCT-RETURN-CODE NOT = 'OK'
 18756
 18757* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18758*    MOVE '6"R                   !   #00016807' TO DFHEIV0
 18759     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18761     MOVE X'2020233030303136383037' TO DFHEIV0(25:11)
 18762     CALL 'kxdfhei1' USING DFHEIV0
 18763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18764         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 361
* EL156.cbl
 18765         MOVE -1                 TO PMTTYPEL
 18766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18767         GO TO 8200-SEND-DATAONLY.
 18768
 18769 7700-CONT.
 18770
 18771*    MOVE 'N'                    TO CASHO.
 18772*    MOVE +1                     TO CASHL.
 18773*    MOVE AL-UANON               TO CASHA.
 18774
 18775     IF PI-OFFLINE = 'Y'
 18776         GO TO 7700-EXIT.
 18777
 18778     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 18779     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 18780     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 18781     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 18782     MOVE +7                     TO CHECKNOL.
 18783     MOVE AL-UANON               TO CHECKNOA.
 18784     GO TO 7700-EXIT.
 18785
 18786 7700-SET-TO-YES.
 18787
 18788*    MOVE 'Y'                    TO CASHO.
 18789*    MOVE +1                     TO CASHL.
 18790*    MOVE AL-UANON               TO CASHA.
 18791
 18792 7700-EXIT.
 18793     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 362
* EL156.cbl
 18795 7800-READ-COMP-MSTR.
 18796
 18797
 18798* EXEC CICS HANDLE CONDITION
 18799*        NOTFND   (7800-COMP-NOTFND)
 18800*    END-EXEC.
 18801*    MOVE '"$I                   ! @ #00016841' TO DFHEIV0
 18802     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18804     MOVE X'4020233030303136383431' TO DFHEIV0(25:11)
 18805     CALL 'kxdfhei1' USING DFHEIV0
 18806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18807
 18808
 18809
 18810* EXEC CICS READ
 18811*        DATASET   ('ERCOMP')
 18812*        RIDFLD    (ERCOMP-KEY)
 18813*        SET       (ADDRESS OF COMPENSATION-MASTER)
 18814*    END-EXEC.
 18815     MOVE 'ERCOMP' TO DFHEIV1
 18816*    MOVE '&"S        E          (   #00016845' TO DFHEIV0
 18817     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18819     MOVE X'2020233030303136383435' TO DFHEIV0(25:11)
 18820     CALL 'kxdfhei1' USING DFHEIV0,
 18821           DFHEIV1,
 18822           DFHEIV20,
 18823           DFHEIV99,
 18824           ERCOMP-KEY,
 18825           DFHEIV99,
 18826           DFHEIV99,
 18827           DFHEIV99
 18828     SET ADDRESS OF COMPENSATION-MASTER TO
 18829         DFHEIV20
 18830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18831
 18832
 18833     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 18834     GO TO 7800-COMP-EXIT.
 18835
 18836 7800-COMP-NOTFND.
 18837     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 18838
 18839 7800-COMP-EXIT.
 18840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 363
* EL156.cbl
 18842 7900-READ-CLAIM.
 18843
 18844* EXEC CICS READ
 18845*        DATASET  ('ELMSTR')
 18846*        SET      (ADDRESS OF CLAIM-MASTER)
 18847*        RIDFLD   (ELMSTR-KEY)
 18848*    END-EXEC.
 18849     MOVE 'ELMSTR' TO DFHEIV1
 18850*    MOVE '&"S        E          (   #00016861' TO DFHEIV0
 18851     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18852     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18853     MOVE X'2020233030303136383631' TO DFHEIV0(25:11)
 18854     CALL 'kxdfhei1' USING DFHEIV0,
 18855           DFHEIV1,
 18856           DFHEIV20,
 18857           DFHEIV99,
 18858           ELMSTR-KEY,
 18859           DFHEIV99,
 18860           DFHEIV99,
 18861           DFHEIV99
 18862     SET ADDRESS OF CLAIM-MASTER TO
 18863         DFHEIV20
 18864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18865
 18866
 18867 7900-EXIT.
 18868      EXIT.
 18869
 18870 7910-READ-CLAIM-UPDATE.
 18871
 18872* EXEC CICS READ
 18873*        DATASET  ('ELMSTR')
 18874*        SET      (ADDRESS OF CLAIM-MASTER)
 18875*        RIDFLD   (ELMSTR-KEY)
 18876*        UPDATE
 18877*    END-EXEC.
 18878     MOVE 'ELMSTR' TO DFHEIV1
 18879*    MOVE '&"S        EU         (   #00016871' TO DFHEIV0
 18880     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18882     MOVE X'2020233030303136383731' TO DFHEIV0(25:11)
 18883     CALL 'kxdfhei1' USING DFHEIV0,
 18884           DFHEIV1,
 18885           DFHEIV20,
 18886           DFHEIV99,
 18887           ELMSTR-KEY,
 18888           DFHEIV99,
 18889           DFHEIV99,
 18890           DFHEIV99
 18891     SET ADDRESS OF CLAIM-MASTER TO
 18892         DFHEIV20
 18893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18894
 18895
 18896 7910-EXIT.
 18897      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 364
* EL156.cbl
 18899 7920-READ-BENE.
 18900     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 18901     MOVE 'B'                TO BENE-RECORD-TYPE.
 18902     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 18903
 18904     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18905        IF PI-PAYEE-TYPE    = 'B' AND
 18906           PI-PAYEE-SEQ-NUM = 9
 18907             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 18908             MOVE WS-A-BENE           TO BENE-NUMBER.
 18909
 18910
 18911* EXEC CICS HANDLE CONDITION
 18912*        NOTFND   (7920-NOT-FOUND)
 18913*    END-EXEC.
 18914*    MOVE '"$I                   ! A #00016892' TO DFHEIV0
 18915     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18917     MOVE X'4120233030303136383932' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0
 18919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18920
 18921
 18922
 18923* EXEC CICS READ
 18924*        DATASET  ('ELBENE')
 18925*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 18926*        RIDFLD   (ELBENE-KEY)
 18927*    END-EXEC.
 18928     MOVE 'ELBENE' TO DFHEIV1
 18929*    MOVE '&"S        E          (   #00016896' TO DFHEIV0
 18930     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18931     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18932     MOVE X'2020233030303136383936' TO DFHEIV0(25:11)
 18933     CALL 'kxdfhei1' USING DFHEIV0,
 18934           DFHEIV1,
 18935           DFHEIV20,
 18936           DFHEIV99,
 18937           ELBENE-KEY,
 18938           DFHEIV99,
 18939           DFHEIV99,
 18940           DFHEIV99
 18941     SET ADDRESS OF BENEFICIARY-MASTER TO
 18942         DFHEIV20
 18943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18944
 18945
 18946     MOVE 'Y' TO BENE-FOUND-SW.
 18947     GO TO 7920-EXIT.
 18948
 18949 7920-NOT-FOUND.
 18950     MOVE 'N'                    TO BENE-FOUND-SW.
 18951
 18952 7920-EXIT.
 18953      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 365
* EL156.cbl
 18955 7930-READ-CONTROL.
 18956
 18957* EXEC CICS READ
 18958*        DATASET  ('ELCNTL')
 18959*        SET      (ADDRESS OF CONTROL-FILE)
 18960*        RIDFLD   (ELCNTL-KEY)
 18961*    END-EXEC.
 18962     MOVE 'ELCNTL' TO DFHEIV1
 18963*    MOVE '&"S        E          (   #00016912' TO DFHEIV0
 18964     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18966     MOVE X'2020233030303136393132' TO DFHEIV0(25:11)
 18967     CALL 'kxdfhei1' USING DFHEIV0,
 18968           DFHEIV1,
 18969           DFHEIV20,
 18970           DFHEIV99,
 18971           ELCNTL-KEY,
 18972           DFHEIV99,
 18973           DFHEIV99,
 18974           DFHEIV99
 18975     SET ADDRESS OF CONTROL-FILE TO
 18976         DFHEIV20
 18977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18978
 18979
 18980 7930-EXIT.
 18981      EXIT.
 18982
 18983 7940-READ-CONTROL-UPDATE.
 18984
 18985* EXEC CICS READ
 18986*        DATASET  ('ELCNTL')
 18987*        SET      (ADDRESS OF CONTROL-FILE)
 18988*        RIDFLD   (ELCNTL-KEY)
 18989*        UPDATE
 18990*    END-EXEC.
 18991     MOVE 'ELCNTL' TO DFHEIV1
 18992*    MOVE '&"S        EU         (   #00016922' TO DFHEIV0
 18993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18994     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18995     MOVE X'2020233030303136393232' TO DFHEIV0(25:11)
 18996     CALL 'kxdfhei1' USING DFHEIV0,
 18997           DFHEIV1,
 18998           DFHEIV20,
 18999           DFHEIV99,
 19000           ELCNTL-KEY,
 19001           DFHEIV99,
 19002           DFHEIV99,
 19003           DFHEIV99
 19004     SET ADDRESS OF CONTROL-FILE TO
 19005         DFHEIV20
 19006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19007
 19008
 19009 7940-EXIT.
 19010      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 366
* EL156.cbl
 19012 7950-READ-TRAILER.
 19013
 19014* EXEC CICS READ
 19015*        DATASET  ('ELTRLR')
 19016*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19017*        RIDFLD   (ELTRLR-KEY)
 19018*    END-EXEC.
 19019     MOVE 'ELTRLR' TO DFHEIV1
 19020*    MOVE '&"S        E          (   #00016933' TO DFHEIV0
 19021     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19023     MOVE X'2020233030303136393333' TO DFHEIV0(25:11)
 19024     CALL 'kxdfhei1' USING DFHEIV0,
 19025           DFHEIV1,
 19026           DFHEIV20,
 19027           DFHEIV99,
 19028           ELTRLR-KEY,
 19029           DFHEIV99,
 19030           DFHEIV99,
 19031           DFHEIV99
 19032     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19033         DFHEIV20
 19034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19035
 19036
 19037 7950-EXIT.
 19038      EXIT.
 19039
 19040 7960-READ-TRAILER-UPDATE.
 19041
 19042* EXEC CICS READ
 19043*        DATASET  ('ELTRLR')
 19044*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19045*        RIDFLD   (ELTRLR-KEY)
 19046*        UPDATE
 19047*    END-EXEC.
 19048     MOVE 'ELTRLR' TO DFHEIV1
 19049*    MOVE '&"S        EU         (   #00016943' TO DFHEIV0
 19050     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19051     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19052     MOVE X'2020233030303136393433' TO DFHEIV0(25:11)
 19053     CALL 'kxdfhei1' USING DFHEIV0,
 19054           DFHEIV1,
 19055           DFHEIV20,
 19056           DFHEIV99,
 19057           ELTRLR-KEY,
 19058           DFHEIV99,
 19059           DFHEIV99,
 19060           DFHEIV99
 19061     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19062         DFHEIV20
 19063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19064
 19065
 19066 7960-EXIT.
 19067      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 367
* EL156.cbl
 19069 7970-READ-CERT.
 19070
 19071* EXEC CICS READ
 19072*        DATASET  ('ELCERT')
 19073*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19074*        RIDFLD   (ELCERT-KEY)
 19075*    END-EXEC.
 19076     MOVE 'ELCERT' TO DFHEIV1
 19077*    MOVE '&"S        E          (   #00016954' TO DFHEIV0
 19078     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19080     MOVE X'2020233030303136393534' TO DFHEIV0(25:11)
 19081     CALL 'kxdfhei1' USING DFHEIV0,
 19082           DFHEIV1,
 19083           DFHEIV20,
 19084           DFHEIV99,
 19085           ELCERT-KEY,
 19086           DFHEIV99,
 19087           DFHEIV99,
 19088           DFHEIV99
 19089     SET ADDRESS OF CERTIFICATE-MASTER TO
 19090         DFHEIV20
 19091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19092
 19093
 19094 7970-EXIT.
 19095      EXIT.
 19096 7975-read-acct.
 19097
 19098     move spaces              to WS-ACCT-RECORD-SW
 19099                                 pi-dcc-product-code
 19100
 19101     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19102     MOVE PI-CARRIER          TO ACCT-CARRIER
 19103     MOVE PI-GROUPING         TO ACCT-GROUPING
 19104     MOVE PI-STATE            TO ACCT-STATE
 19105     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19106     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19107     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19108     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19109
 19110
 19111* EXEC CICS READ
 19112*       DATASET ('ERACCT')
 19113*       RIDFLD  (ERACCT-KEY)
 19114*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19115*       GTEQ
 19116*       resp    (WS-RESPONSE)
 19117*    END-EXEC
 19118     MOVE 'ERACCT' TO DFHEIV1
 19119*    MOVE '&"S        G          (  N#00016976' TO DFHEIV0
 19120     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19122     MOVE X'204E233030303136393736' TO DFHEIV0(25:11)
 19123     CALL 'kxdfhei1' USING DFHEIV0,
 19124           DFHEIV1,
 19125           DFHEIV20,
 19126           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 368
* EL156.cbl
 19127           ERACCT-KEY,
 19128           DFHEIV99,
 19129           DFHEIV99,
 19130           DFHEIV99
 19131     SET ADDRESS OF ACCOUNT-MASTER TO
 19132         DFHEIV20
 19133     MOVE EIBRESP  TO WS-RESPONSE
 19134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19135     IF WS-RESP-NORMAL
 19136        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19137        and pi-cert-eff-dt < am-expiration-dt
 19138        and pi-cert-eff-dt >= am-effective-dt
 19139        move am-dcc-product-code to pi-dcc-product-code
 19140        set acct-found to true
 19141     end-if
 19142
 19143     .
 19144 7975-exit.
 19145     exit.
 19146 7980-READ-CERT-UPDATE.
 19147
 19148* EXEC CICS READ
 19149*        DATASET  ('ELCERT')
 19150*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19151*        RIDFLD   (ELCERT-KEY)
 19152*        UPDATE
 19153*    END-EXEC.
 19154     MOVE 'ELCERT' TO DFHEIV1
 19155*    MOVE '&"S        EU         (   #00016995' TO DFHEIV0
 19156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19157     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19158     MOVE X'2020233030303136393935' TO DFHEIV0(25:11)
 19159     CALL 'kxdfhei1' USING DFHEIV0,
 19160           DFHEIV1,
 19161           DFHEIV20,
 19162           DFHEIV99,
 19163           ELCERT-KEY,
 19164           DFHEIV99,
 19165           DFHEIV99,
 19166           DFHEIV99
 19167     SET ADDRESS OF CERTIFICATE-MASTER TO
 19168         DFHEIV20
 19169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19170
 19171
 19172 7980-EXIT.
 19173      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 369
* EL156.cbl
 19175 8000-LOAD-ERROR-MESSAGES.
 19176     IF PI-PASS-SW = 'C'
 19177        MOVE EMI-LINE1           TO ERMSG1BO
 19178     ELSE
 19179        MOVE EMI-LINE1           TO ERRMSG1O
 19180        MOVE EMI-LINE2           TO ERRMSG2O.
 19181
 19182 8000-EXIT.
 19183     EXIT.
 19184
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 370
* EL156.cbl
 19186
 19187 8010-DMD-ERROR-CHECKS.
 19188     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19189
 19190     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19191         GO TO 8051-ISSUE-ERROR.
 19192
 19193     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19194     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19195     MOVE '3'                    TO DC-OPTION-CODE.
 19196     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19197     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19198         GO TO 8051-ISSUE-ERROR.
 19199
 19200     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19201       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19202                           OR
 19203          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19204           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19205             MOVE ER-0851         TO EMI-ERROR
 19206             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19207       END-IF
 19208       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19209             MOVE ER-8147         TO EMI-ERROR
 19210             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19211
 19212     GO TO 8090-EXIT.
 19213
 19214 8051-ISSUE-ERROR.
 19215     MOVE ER-8146            TO EMI-ERROR.
 19216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19217     GO TO 8090-EXIT.
 19218
 19219 8090-EXIT.
 19220      EXIT.
 19221
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 371
* EL156.cbl
 19223 8100-SEND-INITIAL-MAP.
 19224
 19225     MOVE SAVE-DATE              TO RUNDTEAO.
 19226     MOVE EIBTIME                TO TIME-IN.
 19227     MOVE TIME-OUT               TO RUNTIMAO.
 19228     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19229
 19230     IF MAP-NAME = 'EL156A'
 19231        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19232           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19233        END-IF
 19234     END-IF
 19235*    IF MAP-NAME = 'EL156A'
 19236*       IF PI-COMPANY-ID = 'CRI'
 19237*          NEXT SENTENCE
 19238*       ELSE
 19239*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19240
 19241     IF MAP-NAME = 'EL156A'
 19242        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19243           NEXT SENTENCE
 19244        ELSE
 19245           MOVE AL-SADOF TO  PINTA    PINTHA.
 19246
 19247     IF MAP-NAME = 'EL156A'
 19248        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19249            NEXT SENTENCE
 19250        ELSE
 19251           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19252
 19253*    IF MAP-NAME = 'EL156A'
 19254*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19255*          NEXT SENTENCE
 19256*       ELSE
 19257*          MOVE AL-SADOF TO CASHHA CASHA.
 19258
 19259     IF MAP-NAME = 'EL156A'
 19260        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19261           NEXT SENTENCE
 19262        ELSE
 19263           MOVE AL-SADOF        TO  LOANHA
 19264                                    LOANNOA.
 19265
 19266     IF MAP-NAME = 'EL156A'
 19267        MOVE -1                 TO  ENTERPFL
 19268        IF PI-USES-PAID-TO
 19269           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19270           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19271           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19272        ELSE
 19273           NEXT SENTENCE
 19274     ELSE
 19275        IF MAP-NAME = 'EL156B'
 19276           IF PI-USES-PAID-TO
 19277              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19278              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19279
 19280
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 372
* EL156.cbl
 19281* EXEC CICS SEND
 19282*        MAP   (MAP-NAME)
 19283*        MAPSET(MAPSET-NAME)
 19284*        FROM  (EL156AI)
 19285*        ERASE
 19286*        CURSOR
 19287*    END-EXEC.
 19288     MOVE LENGTH OF
 19289      EL156AI
 19290       TO DFHEIV12
 19291     MOVE -1
 19292       TO DFHEIV11
 19293*    MOVE '8$     CT  E    H L F ,   #00017110' TO DFHEIV0
 19294     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19295     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303137313130' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           MAP-NAME,
 19299           EL156AI,
 19300           DFHEIV12,
 19301           MAPSET-NAME,
 19302           DFHEIV99,
 19303           DFHEIV99,
 19304           DFHEIV99,
 19305           DFHEIV11,
 19306           DFHEIV99,
 19307           DFHEIV99,
 19308           DFHEIV99
 19309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19310
 19311
 19312     GO TO 9100-RETURN-TRAN.
 19313
 19314 8200-SEND-DATAONLY.
 19315
 19316     IF FIRST-ENTRY = 'Y'
 19317         GO TO 8100-SEND-INITIAL-MAP.
 19318
 19319     IF RETURNED-FROM-B = 'Y'
 19320         GO TO 8100-SEND-INITIAL-MAP.
 19321
 19322     MOVE SAVE-DATE              TO RUNDTEAO.
 19323     MOVE EIBTIME                TO TIME-IN.
 19324     MOVE TIME-OUT               TO RUNTIMAO.
 19325
 19326     IF EIBAID = DFHPF11
 19327        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19329        MOVE 'EL001   '          TO RETURNED-FROM
 19330        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19331        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19332        GO TO 8100-SEND-INITIAL-MAP.
 19333
 19334     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19335
 19336     IF MAP-NAME =  'EL156A'
 19337        MOVE -1                 TO  ENTERPFL
 19338        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 373
* EL156.cbl
 19339           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19340           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19341           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19342        ELSE
 19343           NEXT SENTENCE
 19344     ELSE
 19345        IF MAP-NAME = 'EL156B'
 19346           IF PI-USES-PAID-TO
 19347              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19348              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19349
 19350     IF MAP-NAME =  'EL156A'
 19351        IF PI-COMPANY-ID = 'BOA'
 19352            IF PI-INT-RATE NUMERIC
 19353                MOVE PI-INT-RATE TO PINTO.
 19354     IF MAP-NAME = 'EL156A'
 19355        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19356           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19357*          MOVE 'Y'              TO EOBYNO
 19358        END-IF
 19359     END-IF
 19360
 19361
 19362* EXEC CICS SEND
 19363*        MAP   (MAP-NAME)
 19364*        MAPSET(MAPSET-NAME)
 19365*        FROM  (EL156AI)
 19366*        DATAONLY
 19367*        CURSOR
 19368*    END-EXEC.
 19369     MOVE LENGTH OF
 19370      EL156AI
 19371       TO DFHEIV12
 19372     MOVE -1
 19373       TO DFHEIV11
 19374*    MOVE '8$D    CT       H L F ,   #00017167' TO DFHEIV0
 19375     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19376     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19377     MOVE X'2020233030303137313637' TO DFHEIV0(25:11)
 19378     CALL 'kxdfhei1' USING DFHEIV0,
 19379           MAP-NAME,
 19380           EL156AI,
 19381           DFHEIV12,
 19382           MAPSET-NAME,
 19383           DFHEIV99,
 19384           DFHEIV99,
 19385           DFHEIV99,
 19386           DFHEIV11,
 19387           DFHEIV99,
 19388           DFHEIV99,
 19389           DFHEIV99
 19390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19391
 19392
 19393     GO TO 9100-RETURN-TRAN.
 19394
 19395 8300-SEND-TEXT.
 19396
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 374
* EL156.cbl
 19397* EXEC CICS SEND TEXT
 19398*        FROM(LOGOFF-TEXT)
 19399*        LENGTH(LOGOFF-LENGTH)
 19400*        ERASE
 19401*        FREEKB
 19402*    END-EXEC.
 19403*    MOVE '8&      T  E F  H   F -   #00017178' TO DFHEIV0
 19404     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19405     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19406     MOVE X'2020233030303137313738' TO DFHEIV0(25:11)
 19407     CALL 'kxdfhei1' USING DFHEIV0,
 19408           LOGOFF-TEXT,
 19409           LOGOFF-LENGTH,
 19410           DFHEIV99,
 19411           DFHEIV99,
 19412           DFHEIV99,
 19413           DFHEIV99,
 19414           DFHEIV99,
 19415           DFHEIV99,
 19416           DFHEIV99,
 19417           DFHEIV99,
 19418           DFHEIV99,
 19419           DFHEIV99
 19420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19421
 19422
 19423
 19424* EXEC CICS RETURN
 19425*    END-EXEC.
 19426*    MOVE '.(                    ''   #00017185' TO DFHEIV0
 19427     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19429     MOVE X'2020233030303137313835' TO DFHEIV0(25:11)
 19430     CALL 'kxdfhei1' USING DFHEIV0,
 19431           DFHEIV99,
 19432           DFHEIV99,
 19433           DFHEIV99,
 19434           DFHEIV99,
 19435           DFHEIV99,
 19436           DFHEIV99
 19437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19438
 19439
 19440 8500-FILE-NOTOPEN.
 19441     IF FILE-SWITCH = 'MSTR'
 19442         MOVE ER-0154            TO EMI-ERROR.
 19443     IF FILE-SWITCH = 'TRLR'
 19444         MOVE ER-0172            TO EMI-ERROR.
 19445     IF FILE-SWITCH = 'CERT'
 19446         MOVE ER-0169            TO EMI-ERROR.
 19447     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19448                      'PROC' OR 'STAT'
 19449         MOVE ER-0042            TO EMI-ERROR.
 19450     IF FILE-SWITCH = 'ACTQ'
 19451         MOVE ER-0338            TO EMI-ERROR.
 19452     IF FILE-SWITCH = 'ACCT'
 19453         MOVE ER-0168            TO EMI-ERROR.
 19454
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 375
* EL156.cbl
 19455     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19456     MOVE -1                     TO PMTTYPEL.
 19457
 19458     IF FIRST-ENTRY = 'Y'
 19459         GO TO 8100-SEND-INITIAL-MAP.
 19460
 19461     GO TO 8200-SEND-DATAONLY.
 19462
 19463 8600-PGRM-NOT-FOUND.
 19464
 19465     MOVE ER-0923                TO EMI-ERROR.
 19466     MOVE -1                     TO ENTPFBL.
 19467     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19468
 19469     IF FIRST-ENTRY = 'Y'
 19470         GO TO 8100-SEND-INITIAL-MAP
 19471     ELSE
 19472         GO TO 8200-SEND-DATAONLY.
 19473
 19474 8800-UNAUTHORIZED-ACCESS.
 19475     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19476     GO TO 8300-SEND-TEXT.
 19477
 19478 8810-PF23.
 19479     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19480     MOVE XCTL-005               TO PGM-NAME.
 19481     GO TO 9300-XCTL.
 19482
 19483 8820-PF7-8.
 19484     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19485     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19486                                    PI-SAVED-PROGRAM-2
 19487                                    PI-SAVED-PROGRAM-3
 19488                                    PI-SAVED-PROGRAM-4
 19489                                    PI-SAVED-PROGRAM-5
 19490                                    PI-SAVED-PROGRAM-6
 19491                                    PI-RETURN-TO-PROGRAM.
 19492     IF EIBAID = DFHPF8
 19493        MOVE XCTL-132            TO PGM-NAME
 19494     ELSE
 19495        MOVE XCTL-130            TO PGM-NAME.
 19496
 19497     GO TO 9300-XCTL.
 19498
 19499 9100-RETURN-TRAN.
 19500     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19501     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19502
 19503
 19504* EXEC CICS RETURN
 19505*        TRANSID(TRANS-ID)
 19506*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19507*        LENGTH(PI-COMM-LENGTH)
 19508*    END-EXEC.
 19509*    MOVE '.(CT                  ''   #00017251' TO DFHEIV0
 19510     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19511     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19512     MOVE X'2020233030303137323531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 376
* EL156.cbl
 19513     CALL 'kxdfhei1' USING DFHEIV0,
 19514           TRANS-ID,
 19515           PROGRAM-INTERFACE-BLOCK,
 19516           PI-COMM-LENGTH,
 19517           DFHEIV99,
 19518           DFHEIV99,
 19519           DFHEIV99
 19520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19521
 19522
 19523 9200-RETURN-MAIN-MENU.
 19524     MOVE XCTL-126               TO PGM-NAME.
 19525     GO TO 9300-XCTL.
 19526
 19527 9300-XCTL.
 19528
 19529* EXEC CICS XCTL
 19530*        PROGRAM(PGM-NAME)
 19531*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19532*        LENGTH(PI-COMM-LENGTH)
 19533*    END-EXEC.
 19534*    MOVE '.$C                   %   #00017262' TO DFHEIV0
 19535     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19536     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19537     MOVE X'2020233030303137323632' TO DFHEIV0(25:11)
 19538     CALL 'kxdfhei1' USING DFHEIV0,
 19539           PGM-NAME,
 19540           PROGRAM-INTERFACE-BLOCK,
 19541           PI-COMM-LENGTH,
 19542           DFHEIV99
 19543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19544
 19545
 19546 9400-CLEAR.
 19547     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19548     GO TO 9300-XCTL.
 19549
 19550 9500-PF12.
 19551     MOVE XCTL-010               TO PGM-NAME.
 19552     GO TO 9300-XCTL.
 19553
 19554 9700-LINK-DATE-CONVERT.
 19555     MOVE LINK-ELDATCV           TO PGM-NAME.
 19556
 19557* EXEC CICS LINK
 19558*        PROGRAM   (PGM-NAME)
 19559*        COMMAREA  (DATE-CONVERSION-DATA)
 19560*        LENGTH    (DC-COMM-LENGTH)
 19561*    END-EXEC.
 19562*    MOVE '."C                   (   #00017278' TO DFHEIV0
 19563     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19565     MOVE X'2020233030303137323738' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0,
 19567           PGM-NAME,
 19568           DATE-CONVERSION-DATA,
 19569           DC-COMM-LENGTH,
 19570           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 377
* EL156.cbl
 19571           DFHEIV99,
 19572           DFHEIV99,
 19573           DFHEIV99
 19574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19575
 19576
 19577 9700-EXIT.
 19578     EXIT.
 19579
 19580 9800-LINK-REM-TERM.
 19581     MOVE LINK-REMTERM TO PGM-NAME.
 19582
 19583
 19584* EXEC CICS LINK
 19585*        PROGRAM   (PGM-NAME)
 19586*        COMMAREA  (CALCULATION-PASS-AREA)
 19587*        LENGTH    (CP-COMM-LENGTH)
 19588*    END-EXEC.
 19589*    MOVE '."C                   (   #00017290' TO DFHEIV0
 19590     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19592     MOVE X'2020233030303137323930' TO DFHEIV0(25:11)
 19593     CALL 'kxdfhei1' USING DFHEIV0,
 19594           PGM-NAME,
 19595           CALCULATION-PASS-AREA,
 19596           CP-COMM-LENGTH,
 19597           DFHEIV99,
 19598           DFHEIV99,
 19599           DFHEIV99,
 19600           DFHEIV99
 19601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19602
 19603
 19604 9800-EXIT.
 19605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 378
* EL156.cbl
 19607 9830-DMD-REMAINING-TERM.
 19608
 19609     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19610         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19611
 19612     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19613                              CM-PMT-EXTENSION-DAYS.
 19614
 19615     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19616                                  CL-NO-OF-DAYS-PAID.
 19617
 19618     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19619         GIVING W-REM REMAINDER W-REM-DAYS.
 19620
 19621     MOVE W-REM                  TO WST-REM.
 19622
 19623     IF W-REM-DAYS > ZEROS
 19624         MOVE '/'                TO WST-SLASH
 19625         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19626     ELSE
 19627         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19628
 19629 9830-EXIT.
 19630     EXIT.
 19631
 19632 9870-OUTPUT-ACTIVITY-RECORD.
 19633
 19634
 19635* EXEC CICS GETMAIN
 19636*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19637*         LENGTH(25)
 19638*         INITIMG(WS-BLANK)
 19639*    END-EXEC.
 19640     MOVE 25
 19641       TO DFHEIV11
 19642*    MOVE ',"IL                  $   #00017326' TO DFHEIV0
 19643     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19644     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19645     MOVE X'2020233030303137333236' TO DFHEIV0(25:11)
 19646     CALL 'kxdfhei1' USING DFHEIV0,
 19647           DFHEIV20,
 19648           DFHEIV11,
 19649           WS-BLANK
 19650     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19651         DFHEIV20
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19656     MOVE ELMSTR-KEY             TO DA-KEY.
 19657     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19658
 19659     IF PI-PMTTYPE EQUAL '7'
 19660         MOVE 'V'                TO DA-RECORD-TYPE
 19661     ELSE
 19662         MOVE 'P'                TO DA-RECORD-TYPE.
 19663
 19664
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 379
* EL156.cbl
 19665* EXEC CICS HANDLE CONDITION
 19666*         NOTOPEN(9870-NOTOPEN)
 19667*         DUPREC(9870-EXIT)
 19668*    END-EXEC.
 19669*    MOVE '"$J%                  ! B #00017341' TO DFHEIV0
 19670     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19672     MOVE X'4220233030303137333431' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0
 19674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19675
 19676
 19677
 19678* EXEC CICS WRITE
 19679*         DATASET('DLYACTV')
 19680*         RIDFLD(DA-KEY)
 19681*         FROM(DAILY-ACTIVITY-RECORD)
 19682*         LENGTH(25)
 19683*    END-EXEC.
 19684     MOVE 'DLYACTV' TO DFHEIV1
 19685     MOVE 25
 19686       TO DFHEIV11
 19687*    MOVE '&$ L                  ''   #00017346' TO DFHEIV0
 19688     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19690     MOVE X'2020233030303137333436' TO DFHEIV0(25:11)
 19691     CALL 'kxdfhei1' USING DFHEIV0,
 19692           DFHEIV1,
 19693           DAILY-ACTIVITY-RECORD,
 19694           DFHEIV11,
 19695           DA-KEY,
 19696           DFHEIV99,
 19697           DFHEIV99
 19698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19699
 19700     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19701     GO TO 9870-EXIT.
 19702
 19703 9870-NOTOPEN.
 19704
 19705     MOVE '2955'                 TO EMI-ERROR.
 19706     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19707
 19708 9870-EXIT.
 19709     EXIT.
 19710
 19711 9900-ERROR-FORMAT.
 19712
 19713     IF EMI-ERROR = ER-0923
 19714         MOVE PGM-NAME           TO W-CALLED-NAME.
 19715
 19716     MOVE LINK-001      TO PGM-NAME.
 19717     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19718
 19719
 19720* EXEC CICS LINK
 19721*        PROGRAM (PGM-NAME)
 19722*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 380
* EL156.cbl
 19723*        LENGTH  (EMI-COMM-LENGTH)
 19724*    END-EXEC.
 19725*    MOVE '."C                   (   #00017371' TO DFHEIV0
 19726     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19728     MOVE X'2020233030303137333731' TO DFHEIV0(25:11)
 19729     CALL 'kxdfhei1' USING DFHEIV0,
 19730           PGM-NAME,
 19731           ERROR-MESSAGE-INTERFACE-BLOCK,
 19732           EMI-COMM-LENGTH,
 19733           DFHEIV99,
 19734           DFHEIV99,
 19735           DFHEIV99,
 19736           DFHEIV99
 19737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19738
 19739
 19740     IF EMI-ERROR = ER-0923
 19741         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19742
 19743 9900-EXIT.
 19744     EXIT.
 19745
 19746 9990-ABEND.
 19747     MOVE LINK-004               TO PGM-NAME.
 19748     MOVE DFHEIBLK               TO EMI-LINE1.
 19749
 19750* EXEC CICS LINK
 19751*        PROGRAM   (PGM-NAME)
 19752*        COMMAREA  (EMI-LINE1)
 19753*        LENGTH    (64)
 19754*    END-EXEC.
 19755     MOVE 64
 19756       TO DFHEIV11
 19757*    MOVE '."C                   (   #00017386' TO DFHEIV0
 19758     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19760     MOVE X'2020233030303137333836' TO DFHEIV0(25:11)
 19761     CALL 'kxdfhei1' USING DFHEIV0,
 19762           PGM-NAME,
 19763           EMI-LINE1,
 19764           DFHEIV11,
 19765           DFHEIV99,
 19766           DFHEIV99,
 19767           DFHEIV99,
 19768           DFHEIV99
 19769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19770
 19771
 19772     MOVE 'EL156A'               TO  MAP-NAME.
 19773     MOVE LOW-VALUES             TO  EL156AO.
 19774     GO TO 8100-SEND-INITIAL-MAP.
 19775
 19776 9995-SECURITY-VIOLATION.
 19777*    COPY ELCSCTP.
 19778******************************************************************
 19779*                                                                *
 19780*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 381
* EL156.cbl
 19781*                            VMOD=2.001                          *
 19782*                                                                *
 19783*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 19784******************************************************************
 19785
 19786
 19787     MOVE EIBDATE          TO SM-JUL-DATE.
 19788     MOVE EIBTRMID         TO SM-TERMID.
 19789     MOVE THIS-PGM         TO SM-PGM.
 19790     MOVE EIBTIME          TO TIME-IN.
 19791     MOVE TIME-OUT         TO SM-TIME.
 19792     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 19793
 19794
 19795* EXEC CICS LINK
 19796*         PROGRAM  ('EL003')
 19797*         COMMAREA (SECURITY-MESSAGE)
 19798*         LENGTH   (80)
 19799*    END-EXEC.
 19800     MOVE 'EL003' TO DFHEIV1
 19801     MOVE 80
 19802       TO DFHEIV11
 19803*    MOVE '."C                   (   #00017414' TO DFHEIV0
 19804     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19806     MOVE X'2020233030303137343134' TO DFHEIV0(25:11)
 19807     CALL 'kxdfhei1' USING DFHEIV0,
 19808           DFHEIV1,
 19809           SECURITY-MESSAGE,
 19810           DFHEIV11,
 19811           DFHEIV99,
 19812           DFHEIV99,
 19813           DFHEIV99,
 19814           DFHEIV99
 19815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19816
 19817
 19818******************************************************************
 19819
 19820
 19821
 19822 9999-DFHBACK SECTION.
 19823     MOVE '9%                    "   ' TO DFHEIV0
 19824     MOVE 'EL156' TO DFHEIV1
 19825     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19826     GOBACK.
 19827 9999-DFHEXIT.
 19828     IF DFHEIGDJ EQUAL 0001
 19829         NEXT SENTENCE
 19830     ELSE IF DFHEIGDJ EQUAL 2
 19831         GO TO 9990-ABEND,
 19832               8600-PGRM-NOT-FOUND,
 19833               0400-FIRST-TIME,
 19834               6180-DUPREC,
 19835               9990-ABEND
 19836         DEPENDING ON DFHEIGDI
 19837     ELSE IF DFHEIGDJ EQUAL 3
 19838         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 382
* EL156.cbl
 19839               0380-CLAIM-END-FILE
 19840         DEPENDING ON DFHEIGDI
 19841     ELSE IF DFHEIGDJ EQUAL 4
 19842         GO TO 0380-CLAIM-END-FILE,
 19843               0380-CLAIM-END-FILE
 19844         DEPENDING ON DFHEIGDI
 19845     ELSE IF DFHEIGDJ EQUAL 5
 19846         GO TO 0800-EXIT
 19847         DEPENDING ON DFHEIGDI
 19848     ELSE IF DFHEIGDJ EQUAL 6
 19849         GO TO 1950-NOT-FOUND,
 19850               1950-NOT-FOUND
 19851         DEPENDING ON DFHEIGDI
 19852     ELSE IF DFHEIGDJ EQUAL 7
 19853         GO TO 1950-NOT-FOUND
 19854         DEPENDING ON DFHEIGDI
 19855     ELSE IF DFHEIGDJ EQUAL 8
 19856         GO TO 1950-NOT-FOUND,
 19857               1950-NOT-FOUND
 19858         DEPENDING ON DFHEIGDI
 19859     ELSE IF DFHEIGDJ EQUAL 9
 19860         GO TO 1166-END-CHECK,
 19861               1166-END-CHECK
 19862         DEPENDING ON DFHEIGDI
 19863     ELSE IF DFHEIGDJ EQUAL 10
 19864         GO TO 1950-NOT-FOUND,
 19865               1950-NOT-FOUND
 19866         DEPENDING ON DFHEIGDI
 19867     ELSE IF DFHEIGDJ EQUAL 11
 19868         GO TO 1950-NOT-FOUND,
 19869               1950-NOT-FOUND
 19870         DEPENDING ON DFHEIGDI
 19871     ELSE IF DFHEIGDJ EQUAL 12
 19872         GO TO 1950-NOT-FOUND
 19873         DEPENDING ON DFHEIGDI
 19874     ELSE IF DFHEIGDJ EQUAL 13
 19875         GO TO 3600-CONTINUE
 19876         DEPENDING ON DFHEIGDI
 19877     ELSE IF DFHEIGDJ EQUAL 14
 19878         GO TO 5300-NOTE-NOT-FOUND
 19879         DEPENDING ON DFHEIGDI
 19880     ELSE IF DFHEIGDJ EQUAL 15
 19881         GO TO 6065-NOT-FOUND
 19882         DEPENDING ON DFHEIGDI
 19883     ELSE IF DFHEIGDJ EQUAL 16
 19884         GO TO 6068-ACCT-NOT-FND
 19885         DEPENDING ON DFHEIGDI
 19886     ELSE IF DFHEIGDJ EQUAL 17
 19887         GO TO 6074-GET-COMP-DATA
 19888         DEPENDING ON DFHEIGDI
 19889     ELSE IF DFHEIGDJ EQUAL 18
 19890         GO TO 6170-WRITE
 19891         DEPENDING ON DFHEIGDI
 19892     ELSE IF DFHEIGDJ EQUAL 19
 19893         GO TO 6180-DUPREC
 19894         DEPENDING ON DFHEIGDI
 19895     ELSE IF DFHEIGDJ EQUAL 20
 19896         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 383
* EL156.cbl
 19897         DEPENDING ON DFHEIGDI
 19898     ELSE IF DFHEIGDJ EQUAL 21
 19899         GO TO 6185-DUPREC
 19900         DEPENDING ON DFHEIGDI
 19901     ELSE IF DFHEIGDJ EQUAL 22
 19902         GO TO 6720-BUILD-NEW-RECORD
 19903         DEPENDING ON DFHEIGDI
 19904     ELSE IF DFHEIGDJ EQUAL 23
 19905         GO TO 6900-BUILD-ARCHIVE-HEADER,
 19906               6900-BUILD-ARCHIVE-HEADER
 19907         DEPENDING ON DFHEIGDI
 19908     ELSE IF DFHEIGDJ EQUAL 24
 19909         GO TO 7010-BUILD-MAP
 19910         DEPENDING ON DFHEIGDI
 19911     ELSE IF DFHEIGDJ EQUAL 25
 19912         GO TO 7100-SHOW-RECORD-NOT-FOUND
 19913         DEPENDING ON DFHEIGDI
 19914     ELSE IF DFHEIGDJ EQUAL 26
 19915         GO TO 7160-DUPREC
 19916         DEPENDING ON DFHEIGDI
 19917     ELSE IF DFHEIGDJ EQUAL 27
 19918         GO TO 7200-EXIT,
 19919               7200-EXIT
 19920         DEPENDING ON DFHEIGDI
 19921     ELSE IF DFHEIGDJ EQUAL 28
 19922         GO TO 7400-NOT-FOUND
 19923         DEPENDING ON DFHEIGDI
 19924     ELSE IF DFHEIGDJ EQUAL 29
 19925         GO TO 7590-END,
 19926               7590-END
 19927         DEPENDING ON DFHEIGDI
 19928     ELSE IF DFHEIGDJ EQUAL 30
 19929         GO TO 7699-EXIT
 19930         DEPENDING ON DFHEIGDI
 19931     ELSE IF DFHEIGDJ EQUAL 31
 19932         GO TO 5300-NOTE-NOT-FOUND
 19933         DEPENDING ON DFHEIGDI
 19934     ELSE IF DFHEIGDJ EQUAL 32
 19935         GO TO 7800-COMP-NOTFND
 19936         DEPENDING ON DFHEIGDI
 19937     ELSE IF DFHEIGDJ EQUAL 33
 19938         GO TO 7920-NOT-FOUND
 19939         DEPENDING ON DFHEIGDI
 19940     ELSE IF DFHEIGDJ EQUAL 34
 19941         GO TO 9870-NOTOPEN,
 19942               9870-EXIT
 19943         DEPENDING ON DFHEIGDI.
 19944     MOVE '9%                    "   ' TO DFHEIV0
 19945     MOVE 'EL156' TO DFHEIV1
 19946     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19947     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12068     Code:       73526
