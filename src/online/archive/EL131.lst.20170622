* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45******************************************************************
    46
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   3
* EL131.cbl
    48 ENVIRONMENT DIVISION.
    49
    50 DATA DIVISION.
    51
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54
    55 77  FILLER  PIC X(32)  VALUE '********************************'.
    56 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    57 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    58 77  s1                          pic s999 comp-3 value+0.
    59 77  s2                          pic s999 comp-3 value+0.
    60 77  a1                          pic s999 comp-3 value+0.
    61 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    62 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    63 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    64 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    65 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    66 77  ws-max-extension            pic s999 comp-3 value +0.
    67 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    68 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    69 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    70     88  ERPDEF-FOUND                 VALUE 'Y'.
    71 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    72     88  TRLR-FILE-EOF                VALUE 'Y'.
    73 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    74     88  PAYMENT-PENDING              VALUE 'Y'.
    75 77  ws-eracct-sw                pic x  value ' '.
    76     88  acct-found                value 'Y'.
    77 77  ws-benper-sw                pic x   value ' '.
    78     88  good-benper               value 'Y'.
    79 77  ws-claim-type               pic x value ' '.
    80 77  ws-ben-per                  pic 99 value 00.
    81 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    82 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    83 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    84 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    85
    86 01  LCP-TIME-OF-DAY-XX.
    87     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    88     05  FILLER                    PIC 99.
    89 01  LCP-CICS-TIME                 PIC 9(15).
    90*                            COPY ELCSCTM.
    91******************************************************************
    92*                                                                *
    93*                                                                *
    94*                            ELCSCTM                             *
    95*                            VMOD=2.001                          *
    96*                                                                *
    97*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    98*                                                                *
    99******************************************************************
   100 01  SECURITY-MESSAGE.
   101     12  FILLER                          PIC X(30)
   102            VALUE '** LOGIC SECURITY VIOLATION -'.
   103     12  SM-READ                         PIC X(6).
   104     12  FILLER                          PIC X(5)
   105            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   4
* EL131.cbl
   106     12  SM-PGM                          PIC X(6).
   107     12  FILLER                          PIC X(5)
   108            VALUE ' OPR='.
   109     12  SM-PROCESSOR-ID                 PIC X(4).
   110     12  FILLER                          PIC X(6)
   111            VALUE ' TERM='.
   112     12  SM-TERMID                       PIC X(4).
   113     12  FILLER                          PIC XX   VALUE SPACE.
   114     12  SM-JUL-DATE                     PIC 9(5).
   115     12  FILLER                          PIC X    VALUE SPACE.
   116     12  SM-TIME                         PIC 99.99.
   117
   118
   119*                            COPY ELCSCRTY.
   120******************************************************************
   121*                                                                *
   122*                                                                *
   123*                            ELCSCRTY                            *
   124*                            VMOD=2.001                          *
   125*                                                                *
   126*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   127*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   128*        SAVED IN PI-SECURITY-ADDRESS.                           *
   129*                                                                *
   130******************************************************************
   131 01  SECURITY-CONTROL.
   132     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   133     12  FILLER                       PIC XX    VALUE 'SC'.
   134     12  SC-CREDIT-CODES.
   135         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   136             20  SC-CREDIT-DISPLAY    PIC X.
   137             20  SC-CREDIT-UPDATE     PIC X.
   138     12  SC-CLAIMS-CODES.
   139         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   140             20  SC-CLAIMS-DISPLAY    PIC X.
   141             20  SC-CLAIMS-UPDATE     PIC X.
   142
   143*                            COPY ELCNWA.
   144*****************************************************************
   145*                                                               *
   146*                                                               *
   147*                            ELCNWA.                            *
   148*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   149*                            VMOD=2.003                         *
   150*                                                               *
   151*            M O V E   N A M E   W O R K   A R E A.             *
   152*                                                               *
   153*****************************************************************.
   154
   155 01  WS-NAME-WORK-AREA.
   156     05  WS-INSURED-LAST-NAME        PIC X(15).
   157     05  WS-INSURED-1ST-NAME         PIC X(12).
   158     05  WS-INSURED-MID-INIT         PIC X.
   159
   160     05  WS-NAME-WORK.
   161         10  WS-NW                   PIC X
   162             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   163
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   5
* EL131.cbl
   164     05  WS-NAME-WORK2.
   165         10  WS-NW2                  PIC X
   166             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   167                                        NWA-INDEX0.
   168
   169     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   170                                     COMP-3.
   171
   172
   173 01  ws-dcc-error-line.
   174     05  filler occurs 15.
   175         10  ws-error-no        pic x(4).
   176 01  WS-DATE-AREA.
   177     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   178     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   179     12  SAVE-DATE-CCYYMMDD.
   180         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   181         16  SAVE-DATE-YMD.
   182             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   183             20  FILLER         PIC X(4)    VALUE SPACES.
   184
   185 01  WS-BLANK                   PIC X       VALUE ' '.
   186
   187 01  CSO-WORK-FIELDS.
   188     05  WS-HOLD-CLAIM-STATUS    PIC X.
   189     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   190     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   191         10  WS-RECURRENT-YN     PIC X.
   192         10  FILLER              PIC X.
   193
   194 01  LITERALS-NUMBERS.
   195     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   196     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   197     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   198     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   199     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   200     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   201     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   202     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   203
   204     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   205     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   206     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   207     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   208     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   209     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   210     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   211     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   212     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   213     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   214
   215     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   216
   217     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   218
   219     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   220     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   221     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   6
* EL131.cbl
   222     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   223     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   224     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   225     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   226     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   227     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   228     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   229     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   230
   231     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   232     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   233     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   234     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   235         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   236     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   237     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   238     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   239     12  WS-ICD-CODE-1           PIC X(8).
   240     12  WS-ICD-CODE-2           PIC X(8).
   241     12  WS-CLAIM-SEQU.
   242         16  FILLER              PIC X VALUE '('.
   243         16  WS-CURRENT-SEQU     PIC Z9.
   244         16  FILLER              PIC X(04) VALUE ' OF '.
   245         16  WS-OF-SEQU          PIC Z9.
   246         16  FILLER              PIC X VALUE ')'.
   247     12  WS-EDIT-BEN-CODE        PIC XX.
   248         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   249                                          '90' THRU '99'.
   250
   251     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   252     12  WS-EDIT-NUMBER          PIC ZZZ9.
   253
   254     12  WS-RESPONSE             PIC S9(8)   COMP.
   255         88  WS-RESP-NORMAL              VALUE +00.
   256         88  WS-RESP-ERROR               VALUE +01.
   257         88  WS-RESP-NOTFND              VALUE +13.
   258         88  WS-RESP-DUPKEY              VALUE +15.
   259         88  WS-RESP-NOTOPEN             VALUE +19.
   260         88  WS-RESP-ENDFILE             VALUE +20.
   261
   262     12  WS-MOS-PAID             PIC 999.
   263     12  WS-ODD-DAYS             PIC 99.
   264     12  WS-REM-MOS              PIC 999.
   265     12  WS-REM-DAYS             PIC 99.
   266     12  WS-TERM-IN-DAYS         PIC 9(4).
   267     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   268
   269     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   270     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   271     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   272     12  WS-RESET-SW             PIC X       VALUE 'N'.
   273     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   274     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   275     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   276
   277 01  DMD-DATE-YYYYMMDD.
   278     12  DMD-DECADE          PIC XX      VALUE SPACES.
   279     12  DMD-YYMMDD.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   7
* EL131.cbl
   280         16  DMD-YY          PIC XX      VALUE SPACES.
   281         16  DMD-MM          PIC XX      VALUE SPACES.
   282         16  DMD-DD          PIC XX      VALUE SPACES.
   283
   284 01  DMD-DATE-MMDDYYYY.
   285     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   286     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   287     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   288     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   289     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   290     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   291
   292 01  WS-MAIL-CODE.
   293     12  FILLER              PIC X.
   294     12  DMD-MAIL-CODE.
   295         16  WS-MAIL-4       PIC X(4).
   296         16  WS-MAIL-5       PIC X.
   297     12  FILLER              PIC X(4).
   298
   299     12  W-NAME-LAST             PIC  X(15).
   300     12  W-NAME-FIRST            PIC  X(15).
   301     12  W-NAME-MIDDLE.
   302         16  FILLER              PIC  X.
   303         16  W-NAME-MIDDLE-2     PIC  X.
   304         16  FILLER              PIC  X(13).
   305
   306*    COPY ELCDCTB.
   307******************************************************************
   308*                                                                *
   309*                                                                *
   310*                            ELCDCTB.                            *
   311*                            VMOD=2.002                          *
   312*                                                                *
   313*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   314*       COMMUNICATIONS AREA                                      *
   315*                                                                *
   316******************************************************************
   317 01  DCT-COMMUNICATION-AREA.
   318     12  DCT-BILLING-BANK-ID      PIC  X(05).
   319     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   320     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   321     12  DCT-PRODUCT-CODE         PIC  X(02).
   322     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   323     12  DCT-RETURN-CODE          PIC  X(02).
   324     12  DCT-MAIL-CODE            PIC  X(05).
   325     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   326     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   8
* EL131.cbl
   328 01  ERROR-SWITCHES.
   329     12  ERROR-SWITCH            PIC X.
   330         88  SCREEN-ERROR                    VALUE 'X'.
   331     12  MSTR-KEY-SWITCH         PIC X.
   332         88  MSTR-KEY-CHANGED                VALUE 'X'.
   333     12  CERT-KEY-SWITCH         PIC X.
   334*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   335         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   336*********SET TO Y IF PRIMARY KEY WILL CHANGE
   337         88  CERT-KEY-CHANGED                VALUE 'Y'.
   338     12  MSTR-SWITCH             PIC X.
   339         88  MSTR-UPDATES                    VALUE 'X'.
   340     12  crtt-switch             pic x value spaces.
   341         88  crtt-update             value 'X'.
   342     12  CERT-SWITCH             PIC X.
   343         88  CERT-UPDATES                    VALUE 'X'.
   344     12  UPDATE-SWITCH           PIC X.
   345         88  UPDATES-PRESENT                 VALUE 'X'.
   346     12  TRLR-SWITCH             PIC X.
   347         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   348         88  UPDATE-MADE                     VALUE 'Y'.
   349     12  NINETY-TRLR-SWITCH      PIC X.
   350         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   351     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   352         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   353     12  EARNINGS-CALC-SWITCH    PIC X.
   354         88  TEX-REG                         VALUE '4'.
   355         88  NET-PAY                         VALUE '5'.
   356     12  DLYACTV-SW              PIC X       VALUE 'N'.
   357         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page   9
* EL131.cbl
   359 01  EDIT-WORK-AREA.
   360     12  COUNT-2                 PIC 9.
   361     12  CALL-PGM                PIC X(8).
   362     12  TRANS-ID                PIC X(4).
   363     12  CHECK-PFKEYS            PIC 99.
   364     12  CHECK-MAINT             PIC X.
   365         88  ADD-ALPHA-RECORD                VALUE 'A'.
   366         88  CHANGE-CLAIM                    VALUE 'C'.
   367         88  DELETE-CLAIM                    VALUE 'D'.
   368         88  CHANGE-NAME                     VALUE 'N'.
   369         88  VALID-OPTIONS                   VALUE 'A' 'C'
   370                                                   'D' 'N'.
   371
   372     12  HOLD-BENEFIT            PIC XX.
   373     12  HOLD-FREQ               PIC XX.
   374     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   375     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   376     12  HOLD-PDTHRU             PIC XX.
   377     12  HOLD-ADDON              PIC XX.
   378     12  HOLD-NODAYS             PIC 9(4).
   379     12  HOLD-NOPMTS             PIC 9(3).
   380     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   381     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   382     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   383     12  HOLD-BIRTH              PIC XX.
   384     12  HOLD-END                PIC XX.
   385     12  HOLD-EFF                PIC XX.
   386     12  HOLD-ENTRY              PIC XX.
   387     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   388     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   389     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   390     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   391     12  HOLD-LF-CV-CAN          PIC XX.
   392     12  HOLD-AH-CV-CAN          PIC XX.
   393     12  DIVIDE-QUOT             PIC 9(3).
   394     12  DIVIDE-REM              PIC 9(3).
   395
   396     12  WS-ALPHA-DATE.
   397         16  WS-ALPHA-YEAR.
   398             20  WS-ALPHA-YY-1   PIC 99.
   399             20  WS-ALPHA-YY-2   PIC 99.
   400         16  WS-ALPHA-MM         PIC 99.
   401         16  WS-ALPHA-DD         PIC 99.
   402
   403     12  BUILD-VALID-DATE.
   404         16  BUILD-MONTH         PIC 99.
   405         16  BUILD-DAY           PIC 99.
   406         16  BUILD-YEAR          PIC 99.
   407     12  DEEDIT-MMYY-INPUT.
   408         16  FILLER              PIC X.
   409         16  DEEDIT-MONTH        PIC XX.
   410         16  DEEDIT-YEAR         PIC XX.
   411     12  DEEDIT-BEN              PIC 9(9)V99.
   412     12  DEEDIT-DATE-INPUT.
   413         16  FILLER              PIC XX.
   414         16  DEEDIT-DATE         PIC X(6).
   415     12  WORK-DATE-MDY.
   416         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  10
* EL131.cbl
   417         16  FILLER              PIC X(4).
   418         16  YEAR-WORK           PIC XX.
   419     12  WORK-DATE-MY.
   420         16  WORK-MONTH          PIC XX.
   421         16  WORK-SLASH          PIC X       VALUE '/'.
   422         16  WORK-YEAR           PIC XX.
   423     12  HOLD-DATE.
   424         16  HOLD-MONTH          PIC 99.
   425         16  FILLER              PIC X(4).
   426         16  HOLD-YEAR           PIC 99.
   427     12  SPLIT-INFO-LINE-1.
   428         16  SPLIT-INFO-DESC     PIC X(15).
   429         16  FILLER              PIC X(5)    VALUE ' OLD='.
   430         16  SPLIT-INFO-OLD      PIC X(40).
   431     12  EFF-TERM-MO             PIC 9(4).
   432     12  CURR-MO                 PIC 9(4).
   433     12  WS-BIN-CURRENT-DT       PIC XX.
   434     12  WS-CALC-METHOD          PIC X.
   435     12  WS-INITIALS.
   436         16  WS-INIT-1           PIC X.
   437         16  WS-INIT-2           PIC X.
   438     12  WS-REIN-TABLE.
   439         16  WS-REIN-1           PIC X.
   440         16  WS-REIN-2           PIC X.
   441         16  WS-REIN-3           PIC X.
   442     12  PI-KEY.
   443         16  PI-TERM             PIC X(4).
   444         16  PI-QUAL             PIC X(4).
   445     12  CHECK-KEY               PIC X(20).
   446     12  SAVE-ACCT-KEY           PIC X(20).
   447     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   448     12  WS-SOC-SEC-NUMBER.
   449         16  WS-SOC-SEC-NO       PIC 9(9).
   450         16  WS-SOC-SEC-BLANK    PIC X(2).
   451     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   452         16  WS-SSN-1-3          PIC 9(3).
   453         16  WS-SSN-DASH1        PIC X(1).
   454         16  WS-SSN-4-5          PIC 9(2).
   455         16  WS-SSN-DASH2        PIC X(1).
   456         16  WS-SSN-6-9          PIC 9(4).
   457     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   458     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   459
   460 01  WS-SAVE-FIELDS.
   461     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   462     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   463     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   464     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   465     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   466     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   467     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   468     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   469     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   470     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   471     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   473     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  11
* EL131.cbl
   475     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   477     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   479     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   481     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   483     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   485     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   487     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   489     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   491     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   493     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   495     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   497     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   499     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   501     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   503     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   505     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   507     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   509     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   511     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   513     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   514     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   515     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   516
   517 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   518     12  M                   PIC S9(7)V99           VALUE ZEROS.
   519     12  L                   PIC S9(7)V99           VALUE ZEROS.
   520     12  N                   PIC S9(3)              VALUE ZEROS.
   521     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   522     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   523     12  I                   PIC S99V9(5)           VALUE ZEROS.
   524     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   525     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   526     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   527     12  R                   PIC S9(3)              VALUE ZEROS.
   528     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   529     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   530     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   531     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   532     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  12
* EL131.cbl
   533     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   534     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   535     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   536     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   537
   538 01  TERM-CALC-WORK-AREA.
   539     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   540     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   541     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   542     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   543     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   544     12  V-EXPONENTS.
   545        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   546     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   547
   548 01  TIME-IN.
   549     12  UN-HOURS                PIC XX.
   550     12  UN-MINUTES              PIC XX.
   551     12  FILLER                  PIC XX.
   552
   553 01  TIME-OUT.
   554     12  FOR-HOURS               PIC XX.
   555     12  FILLER                  PIC X       VALUE '.'.
   556     12  FOR-MINUTES             PIC XX.
   557
   558 01  ERROR-NUMBERS.
   559     12  ER-0000                 PIC X(4)    VALUE '0000'.
   560     12  ER-0004                 PIC X(4)    VALUE '0004'.
   561     12  ER-0008                 PIC X(4)    VALUE '0008'.
   562     12  ER-0023                 PIC X(4)    VALUE '0023'.
   563     12  ER-0029                 PIC X(4)    VALUE '0029'.
   564     12  ER-0068                 PIC X(4)    VALUE '0068'.
   565     12  ER-0070                 PIC X(4)    VALUE '0070'.
   566     12  ER-0149                 PIC X(4)    VALUE '0149'.
   567     12  ER-0154                 PIC X(4)    VALUE '0154'.
   568     12  ER-0169                 PIC X(4)    VALUE '0169'.
   569     12  ER-0192                 PIC X(4)    VALUE '0192'.
   570     12  ER-0199                 PIC X(4)    VALUE '0199'.
   571     12  ER-0203                 PIC X(4)    VALUE '0203'.
   572     12  ER-0204                 PIC X(4)    VALUE '0204'.
   573     12  ER-0205                 PIC X(4)    VALUE '0205'.
   574     12  ER-0206                 PIC X(4)    VALUE '0206'.
   575     12  ER-0208                 PIC X(4)    VALUE '0208'.
   576     12  ER-0210                 PIC X(4)    VALUE '0210'.
   577     12  ER-0215                 PIC X(4)    VALUE '0215'.
   578     12  ER-0219                 PIC X(4)    VALUE '0219'.
   579     12  ER-0220                 PIC X(4)    VALUE '0220'.
   580     12  ER-0222                 PIC X(4)    VALUE '0222'.
   581     12  ER-0223                 PIC X(4)    VALUE '0223'.
   582     12  ER-0224                 PIC X(4)    VALUE '0224'.
   583     12  ER-0227                 PIC X(4)    VALUE '0227'.
   584     12  ER-0230                 PIC X(4)    VALUE '0230'.
   585     12  ER-0232                 PIC X(4)    VALUE '0232'.
   586     12  ER-0233                 PIC X(4)    VALUE '0233'.
   587     12  ER-0236                 PIC X(4)    VALUE '0236'.
   588     12  ER-0237                 PIC X(4)    VALUE '0237'.
   589     12  ER-0238                 PIC X(4)    VALUE '0238'.
   590     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  13
* EL131.cbl
   591     12  ER-0241                 PIC X(4)    VALUE '0241'.
   592     12  ER-0243                 PIC X(4)    VALUE '0243'.
   593     12  ER-0244                 PIC X(4)    VALUE '0244'.
   594     12  ER-0246                 PIC X(4)    VALUE '0246'.
   595     12  ER-0247                 PIC X(4)    VALUE '0247'.
   596     12  ER-0248                 PIC X(4)    VALUE '0248'.
   597     12  ER-0250                 PIC X(4)    VALUE '0250'.
   598     12  ER-0251                 PIC X(4)    VALUE '0251'.
   599     12  ER-0253                 PIC X(4)    VALUE '0253'.
   600     12  ER-0256                 PIC X(4)    VALUE '0256'.
   601     12  ER-0257                 PIC X(4)    VALUE '0257'.
   602     12  ER-0258                 PIC X(4)    VALUE '0258'.
   603     12  ER-0259                 PIC X(4)    VALUE '0259'.
   604     12  ER-0260                 PIC X(4)    VALUE '0260'.
   605     12  ER-0261                 PIC X(4)    VALUE '0261'.
   606     12  ER-0262                 PIC X(4)    VALUE '0262'.
   607     12  ER-0263                 PIC X(4)    VALUE '0263'.
   608     12  ER-0273                 PIC X(4)    VALUE '0273'.
   609     12  ER-0274                 PIC X(4)    VALUE '0274'.
   610     12  ER-0276                 PIC X(4)    VALUE '0276'.
   611     12  ER-0282                 PIC X(4)    VALUE '0282'.
   612     12  ER-0283                 PIC X(4)    VALUE '0283'.
   613     12  ER-0309                 PIC X(4)    VALUE '0309'.
   614     12  ER-0310                 PIC X(4)    VALUE '0310'.
   615     12  ER-0311                 PIC X(4)    VALUE '0311'.
   616     12  ER-0333                 PIC X(4)    VALUE '0333'.
   617     12  ER-0360                 PIC X(4)    VALUE '0360'.
   618     12  ER-0377                 PIC X(4)    VALUE '0377'.
   619     12  ER-0402                 PIC X(4)    VALUE '0402'.
   620     12  ER-0416                 PIC X(4)    VALUE '0416'.
   621     12  ER-0426                 PIC X(4)    VALUE '0426'.
   622     12  ER-0427                 PIC X(4)    VALUE '0427'.
   623     12  ER-0428                 PIC X(4)    VALUE '0428'.
   624     12  ER-0429                 PIC X(4)    VALUE '0429'.
   625     12  ER-0430                 PIC X(4)    VALUE '0430'.
   626     12  ER-0458                 PIC X(4)    VALUE '0458'.
   627     12  ER-0475                 PIC X(4)    VALUE '0475'.
   628     12  ER-0491                 PIC X(4)    VALUE '0491'.
   629     12  ER-0509                 PIC X(4)    VALUE '0509'.
   630     12  ER-0510                 PIC X(4)    VALUE '0510'.
   631     12  ER-0511                 PIC X(4)    VALUE '0511'.
   632     12  ER-0512                 PIC X(4)    VALUE '0512'.
   633     12  ER-0519                 PIC X(4)    VALUE '0519'.
   634     12  ER-0520                 PIC X(4)    VALUE '0520'.
   635     12  ER-0521                 PIC X(4)    VALUE '0521'.
   636     12  ER-0547                 PIC X(4)    VALUE '0547'.
   637     12  ER-0548                 PIC X(4)    VALUE '0548'.
   638     12  ER-0549                 PIC X(4)    VALUE '0549'.
   639     12  ER-0565                 PIC X(4)    VALUE '0565'.
   640     12  ER-0598                 PIC X(4)    VALUE '0598'.
   641     12  ER-0639                 PIC X(4)    VALUE '0639'.
   642     12  ER-0797                 PIC X(4)    VALUE '0797'.
   643     12  ER-0802                 PIC X(4)    VALUE '0802'.
   644     12  ER-0803                 PIC X(4)    VALUE '0803'.
   645     12  ER-0849                 PIC X(4)    VALUE '0849'.
   646     12  ER-0885                 PIC X(4)    VALUE '0885'.
   647     12  ER-0887                 PIC X(4)    VALUE '0887'.
   648     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  14
* EL131.cbl
   649     12  ER-0921                 PIC X(4)    VALUE '0921'.
   650     12  ER-0938                 PIC X(4)    VALUE '0938'.
   651     12  ER-0946                 PIC X(4)    VALUE '0946'.
   652     12  ER-0947                 PIC X(4)    VALUE '0947'.
   653     12  ER-0948                 PIC X(4)    VALUE '0948'.
   654     12  ER-0949                 PIC X(4)    VALUE '0949'.
   655     12  ER-0950                 PIC X(4)    VALUE '0950'.
   656     12  ER-0951                 PIC X(4)    VALUE '0951'.
   657     12  ER-0954                 PIC X(4)    VALUE '0954'.
   658     12  ER-0974                 PIC X(4)    VALUE '0974'.
   659     12  ER-0975                 PIC X(4)    VALUE '0975'.
   660     12  ER-0992                 PIC X(4)    VALUE '0992'.
   661     12  er-1581                 pic x(4)    value '1581'.
   662     12  ER-1651                 PIC X(4)    VALUE '1651'.
   663     12  ER-1652                 PIC X(4)    VALUE '1652'.
   664     12  ER-1653                 PIC X(4)    VALUE '1653'.
   665     12  ER-1654                 PIC X(4)    VALUE '1654'.
   666     12  ER-1655                 PIC X(4)    VALUE '1655'.
   667     12  er-1656                 pic x(4)    value '1656'.
   668     12  ER-1661                 PIC X(4)    VALUE '1661'.
   669     12  ER-1662                 PIC X(4)    VALUE '1662'.
   670     12  ER-1663                 PIC X(4)    VALUE '1663'.
   671     12  er-1664                 pic x(4)    value '1664'.
   672     12  er-1665                 pic x(4)    value '1665'.
   673     12  er-1666                 pic x(4)    value '1666'.
   674     12  er-1668                 pic x(4)    value '1668'.
   675     12  er-1669                 pic x(4)    value '1669'.
   676     12  er-1676                 pic x(4)    value '1676'.
   677     12  ER-1772                 PIC X(4)    VALUE '1772'.
   678     12  ER-1773                 PIC X(4)    VALUE '1773'.
   679     12  ER-2280                 PIC X(4)    VALUE '2280'.
   680     12  ER-2878                 PIC X(4)    VALUE '2878'.
   681     12  ER-7641                 PIC X(4)    VALUE '7641'.
   682     12  ER-7642                 PIC X(4)    VALUE '7642'.
   683     12  ER-7650                 PIC X(4)    VALUE '7650'.
   684     12  ER-7651                 PIC X(4)    VALUE '7651'.
   685     12  ER-7687                 PIC X(4)    VALUE '7687'.
   686     12  ER-7689                 PIC X(4)    VALUE '7689'.
   687     12  ER-7690                 PIC X(4)    VALUE '7690'.
   688     12  ER-7691                 PIC X(4)    VALUE '7691'.
   689     12  ER-8003                 PIC X(4)    VALUE '8003'.
   690     12  ER-8051                 PIC X(4)    VALUE '8051'.
   691     12  ER-8052                 PIC X(4)    VALUE '8052'.
   692     12  ER-8053                 PIC X(4)    VALUE '8053'.
   693     12  ER-8054                 PIC X(4)    VALUE '8054'.
   694     12  ER-8055                 PIC X(4)    VALUE '8055'.
   695     12  ER-8056                 PIC X(4)    VALUE '8056'.
   696     12  ER-8057                 PIC X(4)    VALUE '8057'.
   697     12  ER-8058                 PIC X(4)    VALUE '8058'.
   698     12  ER-8059                 PIC X(4)    VALUE '8059'.
   699     12  ER-8060                 PIC X(4)    VALUE '8060'.
   700     12  ER-8061                 PIC X(4)    VALUE '8061'.
   701     12  ER-8062                 PIC X(4)    VALUE '8062'.
   702     12  ER-8063                 PIC X(4)    VALUE '8063'.
   703     12  ER-8064                 PIC X(4)    VALUE '8064'.
   704     12  ER-8065                 PIC X(4)    VALUE '8065'.
   705     12  ER-8066                 PIC X(4)    VALUE '8066'.
   706     12  ER-8152                 PIC X(4)    VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  15
* EL131.cbl
   707     12  ER-8153                 PIC X(4)    VALUE '8153'.
   708     12  ER-8154                 PIC X(4)    VALUE '8154'.
   709     12  ER-8155                 PIC X(4)    VALUE '8155'.
   710 01  ERPDEF-KEY-SAVE             PIC X(18).
   711 01  ERPDEF-KEY.
   712     12  ERPDEF-COMPANY-CD       PIC X.
   713     12  ERPDEF-STATE            PIC XX.
   714     12  ERPDEF-PROD-CD          PIC XXX.
   715     12  F                       PIC X(7).
   716     12  ERPDEF-BEN-TYPE         PIC X.
   717     12  ERPDEF-BEN-CODE         PIC XX.
   718     12  ERPDEF-EXP-DT           PIC XX.
   719 01  MSTR-KEY.
   720     12  COMPANY-CODE            PIC X.
   721     12  CARRIER-CODE            PIC X.
   722     12  CLAIM-NO                PIC X(7).
   723     12  CERT-NO.
   724         16  CERT-NO-PRIME       PIC X(10).
   725         16  CERT-NO-SUFX        PIC X.
   726
   727 01  WS-SAVE-CLAIM-KEY.
   728     12  WS-SAVE-COMPANY-CD      PIC X.
   729     12  WS-SAVE-CARRIER         PIC X.
   730     12  WS-SAVE-CLAIM-NO        PIC X(7).
   731     12  WS-SAVE-CERT-NO.
   732         16  WS-CERT-NO-PRIME    PIC X(10).
   733         16  WS-CERT-NO-SUFX     PIC X.
   734
   735 01  CERT-KEY.
   736     12  CERT-COMPANY-CODE       PIC X.
   737     12  CERT-CARRIER            PIC X.
   738     12  CERT-GROUP              PIC X(6).
   739     12  CERT-STATE              PIC XX.
   740     12  CERT-ACCOUNT            PIC X(10).
   741     12  CERT-DATE               PIC XX.
   742     12  CERT-CERT.
   743         16  CERT-CERT-PRIME     PIC X(10).
   744         16  CERT-CERT-SUFX      PIC X.
   745
   746 01  ELCRTT-KEY.
   747     05  CTRLR-COMP-CD       PIC X.
   748     05  CTRLR-CARRIER       PIC X.
   749     05  CTRLR-GROUPING      PIC X(6).
   750     05  CTRLR-STATE         PIC X(2).
   751     05  CTRLR-ACCOUNT       PIC X(10).
   752     05  CTRLR-EFF-DT        PIC XX.
   753     05  CTRLR-CERT-NO       PIC X(11).
   754     05  CTRLR-REC-TYPE      PIC X.
   755 01  NOTE-KEY.
   756     12  NOTE-COMP-CD            PIC X.
   757     12  NOTE-CERT-KEY.
   758         16  NOTE-CARRIER        PIC X.
   759         16  NOTE-GROUP          PIC X(6).
   760         16  NOTE-STATE          PIC XX.
   761         16  NOTE-ACCOUNT        PIC X(10).
   762         16  NOTE-DATE           PIC XX.
   763         16  NOTE-CERT-NO        PIC X(11).
   764
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  16
* EL131.cbl
   765 01  TRLR-KEY.
   766     12  TRLR-MAIN-KEY.
   767         16  TRLR-COMPANY-CD     PIC X.
   768         16  TRLR-CARRIER        PIC X.
   769         16  TRLR-CLAIM-NO       PIC X(07).
   770         16  TRLR-CERT-NO        PIC X(11).
   771     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   772
   773 01  BENEFIT-KEY.
   774     12  BEN-CO-ID               PIC X(3).
   775     12  BEN-REC-TYPE            PIC X.
   776     12  FILLER                  PIC XX.
   777     12  BEN-ACC-CD              PIC XX.
   778     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   779
   780 01  CNTL-KEY.
   781     12  CNTL-CO-ID              PIC X(3).
   782     12  CNTL-REC-TYPE           PIC X.
   783     12  CNTL-PROC-ID            PIC X(4).
   784     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   785         16  CNTL-STATE-NUMBER   PIC XX.
   786         16  FILLER              PIC XX.
   787     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   788         16  FILLER              PIC X(3).
   789         16  CNTL-CARRIER        PIC X.
   790     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   791
   792 01  ACTQ-KEY                    PIC X(20).
   793
   794 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   795
   796 01  CHKQ-KEY.
   797     12  CHKQ-COMPANY-CODE       PIC X.
   798     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   799     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   800
   801 01  ARCH-KEY.
   802     12  ARCH-COMPANY-CODE       PIC X.
   803     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   804     12  ARCH-RECORD-TYPE        PIC X.
   805     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   806
   807 01  ACCT-KEY.
   808     05  ACCT-PARTIAL-KEY.
   809         12  ACCT-COMPANY-CODE   PIC X.
   810         12  ACCT-CARRIER        PIC X.
   811         12  ACCT-GROUP          PIC X(6).
   812         12  ACCT-STATE          PIC XX.
   813         12  ACCT-ACCOUNT        PIC X(10).
   814     05  ACCT-DATE               PIC XX.
   815
   816 01  WS-ELBENE-KEY.
   817     12  WS-ELBENE-COMPANY-CD    PIC X.
   818     12  WS-ELBENE-RECORD-TYPE   PIC X.
   819     12  WS-ELBENE-ID            PIC X(10).
   820
   821 01  ELALPH-KEY.
   822     12  ELALPH-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  17
* EL131.cbl
   823     12  ELALPH-SOURCE           PIC X.
   824     12  ELALPH-NAME.
   825         16  ELALPH-LAST-NAME    PIC X(15).
   826         16  ELALPH-FIRST-NAME.
   827             20  ELALPH-FIRST-INIT   PIC X.
   828             20  FILLER              PIC X(11).
   829         16  ELALPH-MIDDLE-INIT  PIC X.
   830     12  ELALPH-DATE             PIC X(08).
   831     12  ELALPH-TIME             PIC S9(04)    COMP.
   832
   833 01  COMP-LENGTHS.
   834     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   835     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   836     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   837     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   838     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   839     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   840     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   841     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   842     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   843     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   844     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   845     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   846     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   847     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  18
* EL131.cbl
   849*                                COPY ELCLNKLT.
   850******************************************************************
   851*                                                                *
   852*                                                                *
   853*                           ELCLNKLT                             *
   854*                            VMOD=2.003                          *
   855*                                                                *
   856*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   857*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   858*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   859*                                                                *
   860*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   861*   COMPLETING THE REQUIRED FIELDS.                              *
   862*                                                                *
   863*   THE CALLING PROGRAM SHOULD CHECK:                            *
   864*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   865*                              9999 INDICATES AN UNKNOWN ABEND   *
   866*                                   WAS DETECTED.                *
   867*                              ALL OTHER VALUES ARE NORMAL ERROR *
   868*                              CODES FOUND IN THE ERROR FILE.    *
   869******************************************************************
   870 01  W-1523-LINKDATA.
   871     12  W-1523-COMMON-PI-DATA.
   872         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   873         16  FILLER              PIC  X(67).
   874         16  W-1523-COMPANY-CD   PIC  X(01).
   875         16  FILLER              PIC  X(10).
   876         16  W-1523-CONTROL-IN-PROGRESS.
   877             20  W-1523-CARRIER  PIC  X(01).
   878             20  W-1523-GROUPING PIC  X(06).
   879             20  W-1523-STATE    PIC  X(02).
   880             20  W-1523-ACCOUNT  PIC  X(10).
   881             20  W-1523-CLAIM-CERT-GRP.
   882                 24  W-1523-CLAIM-NO
   883                                 PIC  X(07).
   884                 24  W-1523-CERT-NO.
   885                     28  W-1523-CERT-PRIME
   886                                 PIC  X(10).
   887                     28  W-1523-CERT-SFX
   888                                 PIC  X(01).
   889                 24  W-1523-CERT-EFF-DT
   890                                 PIC  X(02).
   891         16  FILLER              PIC X(265).
   892
   893     12  W-1523-WORK-AREA.
   894         16  W-1523-FORM-NUMBER  PIC  X(04).
   895         16  W-1523-NUMBER-COPIES
   896                                 PIC  9(01).
   897         16  W-1523-ADDR-TYPE    PIC  X(02).
   898         16  W-1523-FOLLOW-UP-DATE
   899                                 PIC  X(02).
   900         16  W-1523-RESEND-DATE  PIC  X(02).
   901         16  W-1523-ERROR-CODE   PIC  9(04).
   902             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   903             88  W-1523-FATAL-ERROR
   904                                    VALUES  0006 0013 0042
   905                                            0154 0168 0169
   906                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  19
* EL131.cbl
   907                                            0179 0186 0281
   908                                            0332 2055 3697
   909                                            3698 3699 3770
   910                                            3771 3772 7675
   911                                            9106 9808 9883
   912                                            9887.
   913             88  W-1523-STOP-ERRORS
   914                                    VALUES  0013 0042 0154
   915                                            0168 0169 0172
   916                                            0281 0332 2055
   917                                            3698 3699 7675
   918                                            9106 9808 9883
   919                                            9999.
   920         16  W-1523-REASON       PIC  X(70).
   921         16  W-1523-ARCHIVE-NUMBER
   922                                 PIC  9(08).
   923     12  W-1523-POINTER-AREA.
   924         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   925         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   926         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   927         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   928         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  20
* EL131.cbl
   930*                                COPY ELCINTF.
   931******************************************************************
   932*                                                                *
   933*                                                                *
   934*                            ELCINTF.                            *
   935*                            VMOD=2.017                          *
   936*                                                                *
   937*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   938*                                                                *
   939*       LENGTH = 1024                                            *
   940*                                                                *
   941******************************************************************
   942*                   C H A N G E   L O G
   943*
   944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   945*-----------------------------------------------------------------
   946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   947* EFFECTIVE    NUMBER
   948*-----------------------------------------------------------------
   949* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   950******************************************************************
   951 01  PROGRAM-INTERFACE-BLOCK.
   952     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   953     12  PI-CALLING-PROGRAM              PIC X(8).
   954     12  PI-SAVED-PROGRAM-1              PIC X(8).
   955     12  PI-SAVED-PROGRAM-2              PIC X(8).
   956     12  PI-SAVED-PROGRAM-3              PIC X(8).
   957     12  PI-SAVED-PROGRAM-4              PIC X(8).
   958     12  PI-SAVED-PROGRAM-5              PIC X(8).
   959     12  PI-SAVED-PROGRAM-6              PIC X(8).
   960     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   961     12  PI-COMPANY-ID                   PIC XXX.
   962     12  PI-COMPANY-CD                   PIC X.
   963
   964     12  PI-COMPANY-PASSWORD             PIC X(8).
   965
   966     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   967
   968     12  PI-CONTROL-IN-PROGRESS.
   969         16  PI-CARRIER                  PIC X.
   970         16  PI-GROUPING                 PIC X(6).
   971         16  PI-STATE                    PIC XX.
   972         16  PI-ACCOUNT                  PIC X(10).
   973         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   974                                         PIC X(10).
   975         16  PI-CLAIM-CERT-GRP.
   976             20  PI-CLAIM-NO             PIC X(7).
   977             20  PI-CERT-NO.
   978                 25  PI-CERT-PRIME       PIC X(10).
   979                 25  PI-CERT-SFX         PIC X.
   980             20  PI-CERT-EFF-DT          PIC XX.
   981         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   982             20  PI-PLAN-CODE            PIC X(2).
   983             20  PI-REVISION-NUMBER      PIC X(3).
   984             20  PI-PLAN-EFF-DT          PIC X(2).
   985             20  PI-PLAN-EXP-DT          PIC X(2).
   986             20  FILLER                  PIC X(11).
   987         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  21
* EL131.cbl
   988             20  PI-OE-REFERENCE-1.
   989                 25  PI-OE-REF-1-PRIME   PIC X(18).
   990                 25  PI-OE-REF-1-SUFF    PIC XX.
   991
   992     12  PI-SESSION-IN-PROGRESS          PIC X.
   993         88  CLAIM-SESSION                   VALUE '1'.
   994         88  CREDIT-SESSION                  VALUE '2'.
   995         88  WARRANTY-SESSION                VALUE '3'.
   996         88  MORTGAGE-SESSION                VALUE '4'.
   997         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   998
   999
  1000*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1001
  1002     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1003     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1004
  1005     12  PI-CREDIT-USER                  PIC X.
  1006         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1007         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1008
  1009     12  PI-CLAIM-USER                   PIC X.
  1010         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1011         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1012
  1013     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1014         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1015         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1016         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1017         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1018         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1019
  1020     12  PI-PROCESSOR-ID                 PIC X(4).
  1021
  1022     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1023
  1024     12  PI-MEMBER-CAPTION               PIC X(10).
  1025
  1026     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1027         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1028
  1029     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1030     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1031     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1032     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1033
  1034     12  PI-AH-OVERRIDE-L1               PIC X.
  1035     12  PI-AH-OVERRIDE-L2               PIC XX.
  1036     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1037     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1038
  1039     12  PI-NEW-SYSTEM                   PIC X(2).
  1040
  1041     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1042     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1043         88  PI-USES-PAID-TO                 VALUE '1'.
  1044     12  PI-CRDTCRD-SYSTEM.
  1045         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  22
* EL131.cbl
  1046             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1047             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1048         16  PI-CC-MONTH-END-DT          PIC XX.
  1049     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1050
  1051     12  PI-OE-REFERENCE-2.
  1052         16  PI-OE-REF-2-PRIME           PIC X(10).
  1053         16  PI-OE-REF-2-SUFF            PIC X.
  1054
  1055     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1056
  1057     12  PI-LANGUAGE-TYPE                PIC X.
  1058             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1059             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1060             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1061
  1062     12  PI-POLICY-LINKAGE-IND           PIC X.
  1063         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1064         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1065                                                   LOW-VALUES.
  1066
  1067     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1068     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1069         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1070         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1071
  1072     12  PI-PROCESSOR-CSR-IND            PIC X.
  1073         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1074         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1075
  1076     12  FILLER                          PIC X(3).
  1077
  1078     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1079
  1080     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1081         PI-SYSTEM-LEVEL.
  1082
  1083         16  PI-ENTRY-CODES.
  1084             20  PI-ENTRY-CD-1           PIC X.
  1085             20  PI-ENTRY-CD-2           PIC X.
  1086
  1087         16  PI-RETURN-CODES.
  1088             20  PI-RETURN-CD-1          PIC X.
  1089             20  PI-RETURN-CD-2          PIC X.
  1090
  1091         16  PI-UPDATE-STATUS-SAVE.
  1092             20  PI-UPDATE-BY            PIC X(4).
  1093             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1094
  1095         16  PI-LOWER-CASE-LETTERS       PIC X.
  1096             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1097
  1098*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1099*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1100*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1101
  1102         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1103             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  23
* EL131.cbl
  1104             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1105             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1106             88  ACCNT-CNTL                  VALUE '3'.
  1107             88  CARR-ACCNT-CNTL             VALUE '4'.
  1108
  1109         16  PI-PROCESSOR-CAP-LIST.
  1110             20  PI-SYSTEM-CONTROLS.
  1111                24 PI-SYSTEM-DISPLAY     PIC X.
  1112                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1113                24 PI-SYSTEM-MODIFY      PIC X.
  1114                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1115             20  FILLER                  PIC XX.
  1116             20  PI-DISPLAY-CAP          PIC X.
  1117                 88  DISPLAY-CAP             VALUE 'Y'.
  1118             20  PI-MODIFY-CAP           PIC X.
  1119                 88  MODIFY-CAP              VALUE 'Y'.
  1120             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1121                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1122             20  PI-FORCE-CAP            PIC X.
  1123                 88  FORCE-CAP               VALUE 'Y'.
  1124
  1125         16  PI-PROGRAM-CONTROLS.
  1126             20  PI-PGM-PRINT-OPT        PIC X.
  1127             20  PI-PGM-FORMAT-OPT       PIC X.
  1128             20  PI-PGM-PROCESS-OPT      PIC X.
  1129             20  PI-PGM-TOTALS-OPT       PIC X.
  1130
  1131         16  PI-HELP-INTERFACE.
  1132             20  PI-LAST-ERROR-NO        PIC X(4).
  1133             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1134
  1135         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1136             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1137
  1138         16  PI-CR-CONTROL-IN-PROGRESS.
  1139             20  PI-CR-CARRIER           PIC X.
  1140             20  PI-CR-GROUPING          PIC X(6).
  1141             20  PI-CR-STATE             PIC XX.
  1142             20  PI-CR-ACCOUNT           PIC X(10).
  1143             20  PI-CR-FIN-RESP          PIC X(10).
  1144             20  PI-CR-TYPE              PIC X.
  1145
  1146         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1147
  1148         16  PI-CR-MONTH-END-DT          PIC XX.
  1149
  1150         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1151             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1152             88  PI-ZERO-CARRIER             VALUE '1'.
  1153             88  PI-ZERO-GROUPING            VALUE '2'.
  1154             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1155
  1156         16  PI-CARRIER-SECURITY         PIC X.
  1157             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1158
  1159         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1160             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1161             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  24
* EL131.cbl
  1162
  1163         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1164             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1165                                         INDEXED BY PI-ACCESS-NDX
  1166                                         PIC X.
  1167
  1168         16  PI-GA-BILLING-CONTROL       PIC X.
  1169             88  PI-GA-BILLING               VALUE '1'.
  1170
  1171         16  PI-MAIL-PROCESSING          PIC X.
  1172             88  PI-MAIL-YES                 VALUE 'Y'.
  1173
  1174         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1175
  1176         16  PI-AR-SYSTEM.
  1177             20  PI-AR-PROCESSING-CNTL   PIC X.
  1178                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1179             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1180             20  PI-AR-MONTH-END-DT      PIC XX.
  1181
  1182         16  PI-MP-SYSTEM.
  1183             20  PI-MORTGAGE-USER            PIC X.
  1184                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1185                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1186             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1187                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1188                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1189                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1190                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1191                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1192             20  PI-MP-MONTH-END-DT          PIC XX.
  1193             20  PI-MP-REFERENCE-NO.
  1194                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1195                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1196
  1197         16  PI-LABEL-CONTROL            PIC X(01).
  1198             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1199             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1200
  1201         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1202             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1203
  1204         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1205             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1206             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1207
  1208         16  FILLER                      PIC X(14).
  1209
  1210     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1211******************************************************************
  1212     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1213         16  PI-NO-PMTS                    PIC 9(4).
  1214         16  PI-CERT-SWITCH                PIC X.
  1215             88  CREATED-CERT              VALUE '2'.
  1216         16  PI-PREM-TYPE                  PIC X.
  1217         16  PI-SAVE-CERT-NO.
  1218             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1219             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  25
* EL131.cbl
  1220         16  FILLER                        PIC X(46).
  1221         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1222         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1223         16  PI-REC-FOUND-SW               PIC X.
  1224         16  PI-LETTER-SW                  PIC X.
  1225         16  PI-PREV-TRLR-KEY              PIC X(22).
  1226         16  pi-claim-type                 pic x.
  1227         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1228         16  pi-approval-level             pic x.
  1229         16  FILLER                        PIC X(543).
  1230
  1231 01  SAVE-RECORD                 PIC X(450).
  1232
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  26
* EL131.cbl
  1234*                                COPY ELCLOGOF SUPPRESS.
  1235******************************************************************
  1236*                                                                *
  1237*                                                                *
  1238*                            ELCLOGOF.                           *
  1239*                            VMOD=2.001                          *
  1240*                                                                *
  1241*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1242*                                                                *
  1243******************************************************************
  1244 01  CLASIC-LOGOFF.
  1245     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1246     12  LOGOFF-TEXT.
  1247         16  FILLER          PIC X(5)    VALUE SPACES.
  1248         16  LOGOFF-MSG.
  1249             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1250             20  FILLER      PIC X       VALUE SPACES.
  1251             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1252         16  FILLER          PIC X(80)
  1253           VALUE '* YOU ARE NOW LOGGED OFF'.
  1254         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1255         16  FILLER          PIC X       VALUE QUOTE.
  1256         16  LOGOFF-SYS-MSG  PIC X(17)
  1257           VALUE 'S CLAS-IC SYSTEM '.
  1258     12  TEXT-MESSAGES.
  1259         16  UNACCESS-MSG    PIC X(29)
  1260             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1261         16  PGMIDERR-MSG    PIC X(17)
  1262             VALUE 'PROGRAM NOT FOUND'.
  1263
  1264*                                COPY ELCATTR SUPPRESS.
  1265******************************************************************
  1266*                                                                *
  1267*                            ELCATTR.                            *
  1268*                            VMOD=2.001                          *
  1269*                                                                *
  1270*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1271*                                                                *
  1272*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1273*                                                                *
  1274*                   POS 1   P=PROTECTED                          *
  1275*                           U=UNPROTECTED                        *
  1276*                           S=ASKIP                              *
  1277*                   POS 2   A=ALPHA/NUMERIC                      *
  1278*                           N=NUMERIC                            *
  1279*                   POS 3   N=NORMAL                             *
  1280*                           B=BRIGHT                             *
  1281*                           D=DARK                               *
  1282*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1283*                           OF=MODIFIED DATA TAG OFF             *
  1284*                                                                *
  1285*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1286******************************************************************
  1287 01  ATTRIBUTE-LIST.
  1288     12  AL-PABOF            PIC X       VALUE 'Y'.
  1289     12  AL-PABON            PIC X       VALUE 'Z'.
  1290     12  AL-PADOF            PIC X       VALUE '%'.
  1291     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  27
* EL131.cbl
  1292     12  AL-PANOF            PIC X       VALUE '-'.
  1293     12  AL-PANON            PIC X       VALUE '/'.
  1294     12  AL-SABOF            PIC X       VALUE '8'.
  1295     12  AL-SABON            PIC X       VALUE '9'.
  1296     12  AL-SADOF            PIC X       VALUE '@'.
  1297     12  AL-SADON            PIC X       VALUE QUOTE.
  1298     12  AL-SANOF            PIC X       VALUE '0'.
  1299     12  AL-SANON            PIC X       VALUE '1'.
  1300     12  AL-UABOF            PIC X       VALUE 'H'.
  1301     12  AL-UABON            PIC X       VALUE 'I'.
  1302     12  AL-UADOF            PIC X       VALUE '<'.
  1303     12  AL-UADON            PIC X       VALUE '('.
  1304     12  AL-UANOF            PIC X       VALUE ' '.
  1305     12  AL-UANON            PIC X       VALUE 'A'.
  1306     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1307     12  AL-UNBON            PIC X       VALUE 'R'.
  1308     12  AL-UNDOF            PIC X       VALUE '*'.
  1309     12  AL-UNDON            PIC X       VALUE ')'.
  1310     12  AL-UNNOF            PIC X       VALUE '&'.
  1311     12  AL-UNNON            PIC X       VALUE 'J'.
  1312
  1313*                                COPY ELCAID SUPPRESS.
  1314******************************************************************
  1315*                                                                *
  1316*                            ELCAID.                             *
  1317*                            VMOD=2.001                          *
  1318*                                                                *
  1319*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1320*                                                                *
  1321*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1322*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1323******************************************************************
  1324
  1325 01  DFHAID.
  1326   02  DFHNULL   PIC  X  VALUE  ' '.
  1327   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1328   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1329   02  DFHPEN    PIC  X  VALUE  '='.
  1330   02  DFHOPID   PIC  X  VALUE  'W'.
  1331   02  DFHPA1    PIC  X  VALUE  '%'.
  1332   02  DFHPA2    PIC  X  VALUE  '>'.
  1333   02  DFHPA3    PIC  X  VALUE  ','.
  1334   02  DFHPF1    PIC  X  VALUE  '1'.
  1335   02  DFHPF2    PIC  X  VALUE  '2'.
  1336   02  DFHPF3    PIC  X  VALUE  '3'.
  1337   02  DFHPF4    PIC  X  VALUE  '4'.
  1338   02  DFHPF5    PIC  X  VALUE  '5'.
  1339   02  DFHPF6    PIC  X  VALUE  '6'.
  1340   02  DFHPF7    PIC  X  VALUE  '7'.
  1341   02  DFHPF8    PIC  X  VALUE  '8'.
  1342   02  DFHPF9    PIC  X  VALUE  '9'.
  1343   02  DFHPF10   PIC  X  VALUE  ':'.
  1344   02  DFHPF11   PIC  X  VALUE  '#'.
  1345   02  DFHPF12   PIC  X  VALUE  '@'.
  1346   02  DFHPF13   PIC  X  VALUE  'A'.
  1347   02  DFHPF14   PIC  X  VALUE  'B'.
  1348   02  DFHPF15   PIC  X  VALUE  'C'.
  1349   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  28
* EL131.cbl
  1350   02  DFHPF17   PIC  X  VALUE  'E'.
  1351   02  DFHPF18   PIC  X  VALUE  'F'.
  1352   02  DFHPF19   PIC  X  VALUE  'G'.
  1353   02  DFHPF20   PIC  X  VALUE  'H'.
  1354   02  DFHPF21   PIC  X  VALUE  'I'.
  1355*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1356   02  DFHPF22   PIC  X  VALUE  '['.
  1357   02  DFHPF23   PIC  X  VALUE  '.'.
  1358   02  DFHPF24   PIC  X  VALUE  '<'.
  1359   02  DFHMSRE   PIC  X  VALUE  'X'.
  1360   02  DFHSTRF   PIC  X  VALUE  'h'.
  1361   02  DFHTRIG   PIC  X  VALUE  '"'.
  1362 01  FILLER REDEFINES DFHAID.
  1363     12  FILLER                  PIC X(8).
  1364     12  AID-KEYS OCCURS 24 TIMES.
  1365         16  FILLER              PIC X.
  1366
  1367*                                COPY EL131S.
  1368 01  EL131AI.
  1369     05  FILLER            PIC  X(0012).
  1370*    -------------------------------
  1371     05  DATEL PIC S9(0004) COMP.
  1372     05  DATEF PIC  X(0001).
  1373     05  FILLER REDEFINES DATEF.
  1374         10  DATEA PIC  X(0001).
  1375     05  DATEI PIC  X(0008).
  1376*    -------------------------------
  1377     05  TIMEL PIC S9(0004) COMP.
  1378     05  TIMEF PIC  X(0001).
  1379     05  FILLER REDEFINES TIMEF.
  1380         10  TIMEA PIC  X(0001).
  1381     05  TIMEI PIC  X(0005).
  1382*    -------------------------------
  1383     05  SEQUL PIC S9(0004) COMP.
  1384     05  SEQUF PIC  X(0001).
  1385     05  FILLER REDEFINES SEQUF.
  1386         10  SEQUA PIC  X(0001).
  1387     05  SEQUI PIC  X(0010).
  1388*    -------------------------------
  1389     05  COMPL PIC S9(0004) COMP.
  1390     05  COMPF PIC  X(0001).
  1391     05  FILLER REDEFINES COMPF.
  1392         10  COMPA PIC  X(0001).
  1393     05  COMPI PIC  X(0003).
  1394*    -------------------------------
  1395     05  USERIDL PIC S9(0004) COMP.
  1396     05  USERIDF PIC  X(0001).
  1397     05  FILLER REDEFINES USERIDF.
  1398         10  USERIDA PIC  X(0001).
  1399     05  USERIDI PIC  X(0004).
  1400*    -------------------------------
  1401     05  LABEL1L PIC S9(0004) COMP.
  1402     05  LABEL1F PIC  X(0001).
  1403     05  FILLER REDEFINES LABEL1F.
  1404         10  LABEL1A PIC  X(0001).
  1405     05  LABEL1I PIC  X(0011).
  1406*    -------------------------------
  1407     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  29
* EL131.cbl
  1408     05  PCERTNOF PIC  X(0001).
  1409     05  FILLER REDEFINES PCERTNOF.
  1410         10  PCERTNOA PIC  X(0001).
  1411     05  PCERTNOI PIC  X(0010).
  1412*    -------------------------------
  1413     05  PSUFXL PIC S9(0004) COMP.
  1414     05  PSUFXF PIC  X(0001).
  1415     05  FILLER REDEFINES PSUFXF.
  1416         10  PSUFXA PIC  X(0001).
  1417     05  PSUFXI PIC  X(0001).
  1418*    -------------------------------
  1419     05  CCNOL PIC S9(0004) COMP.
  1420     05  CCNOF PIC  X(0001).
  1421     05  FILLER REDEFINES CCNOF.
  1422         10  CCNOA PIC  X(0001).
  1423     05  CCNOI PIC  X(0016).
  1424*    -------------------------------
  1425     05  MAINTL PIC S9(0004) COMP.
  1426     05  MAINTF PIC  X(0001).
  1427     05  FILLER REDEFINES MAINTF.
  1428         10  MAINTA PIC  X(0001).
  1429     05  MAINTI PIC  X(0001).
  1430*    -------------------------------
  1431     05  CLAIML PIC S9(0004) COMP.
  1432     05  CLAIMF PIC  X(0001).
  1433     05  FILLER REDEFINES CLAIMF.
  1434         10  CLAIMA PIC  X(0001).
  1435     05  CLAIMI PIC  X(0007).
  1436*    -------------------------------
  1437     05  CARRL PIC S9(0004) COMP.
  1438     05  CARRF PIC  X(0001).
  1439     05  FILLER REDEFINES CARRF.
  1440         10  CARRA PIC  X(0001).
  1441     05  CARRI PIC  X(0001).
  1442*    -------------------------------
  1443     05  CERTL PIC S9(0004) COMP.
  1444     05  CERTF PIC  X(0001).
  1445     05  FILLER REDEFINES CERTF.
  1446         10  CERTA PIC  X(0001).
  1447     05  CERTI PIC  X(0010).
  1448*    -------------------------------
  1449     05  SUFXL PIC S9(0004) COMP.
  1450     05  SUFXF PIC  X(0001).
  1451     05  FILLER REDEFINES SUFXF.
  1452         10  SUFXA PIC  X(0001).
  1453     05  SUFXI PIC  X(0001).
  1454*    -------------------------------
  1455     05  TYPEL PIC S9(0004) COMP.
  1456     05  TYPEF PIC  X(0001).
  1457     05  FILLER REDEFINES TYPEF.
  1458         10  TYPEA PIC  X(0001).
  1459     05  TYPEI PIC  X(0001).
  1460*    -------------------------------
  1461     05  BENPERL PIC S9(0004) COMP.
  1462     05  BENPERF PIC  X(0001).
  1463     05  FILLER REDEFINES BENPERF.
  1464         10  BENPERA PIC  X(0001).
  1465     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  30
* EL131.cbl
  1466*    -------------------------------
  1467     05  INSTYPEL PIC S9(0004) COMP.
  1468     05  INSTYPEF PIC  X(0001).
  1469     05  FILLER REDEFINES INSTYPEF.
  1470         10  INSTYPEA PIC  X(0001).
  1471     05  INSTYPEI PIC  X(0001).
  1472*    -------------------------------
  1473     05  STATUSL PIC S9(0004) COMP.
  1474     05  STATUSF PIC  X(0001).
  1475     05  FILLER REDEFINES STATUSF.
  1476         10  STATUSA PIC  X(0001).
  1477     05  STATUSI PIC  X(0006).
  1478*    -------------------------------
  1479     05  INCL PIC S9(0004) COMP.
  1480     05  INCF PIC  X(0001).
  1481     05  FILLER REDEFINES INCF.
  1482         10  INCA PIC  X(0001).
  1483     05  INCI PIC  X(0008).
  1484*    -------------------------------
  1485     05  REPL PIC S9(0004) COMP.
  1486     05  REPF PIC  X(0001).
  1487     05  FILLER REDEFINES REPF.
  1488         10  REPA PIC  X(0001).
  1489     05  REPI PIC  X(0008).
  1490*    -------------------------------
  1491     05  ICD1L PIC S9(0004) COMP.
  1492     05  ICD1F PIC  X(0001).
  1493     05  FILLER REDEFINES ICD1F.
  1494         10  ICD1A PIC  X(0001).
  1495     05  ICD1I PIC  X(0008).
  1496*    -------------------------------
  1497     05  ICD2L PIC S9(0004) COMP.
  1498     05  ICD2F PIC  X(0001).
  1499     05  FILLER REDEFINES ICD2F.
  1500         10  ICD2A PIC  X(0001).
  1501     05  ICD2I PIC  X(0008).
  1502*    -------------------------------
  1503     05  DIAGL PIC S9(0004) COMP.
  1504     05  DIAGF PIC  X(0001).
  1505     05  FILLER REDEFINES DIAGF.
  1506         10  DIAGA PIC  X(0001).
  1507     05  DIAGI PIC  X(0060).
  1508*    -------------------------------
  1509     05  ACCSWL PIC S9(0004) COMP.
  1510     05  ACCSWF PIC  X(0001).
  1511     05  FILLER REDEFINES ACCSWF.
  1512         10  ACCSWA PIC  X(0001).
  1513     05  ACCSWI PIC  X(0001).
  1514*    -------------------------------
  1515     05  BENEL PIC S9(0004) COMP.
  1516     05  BENEF PIC  X(0001).
  1517     05  FILLER REDEFINES BENEF.
  1518         10  BENEA PIC  X(0001).
  1519     05  BENEI PIC  X(0010).
  1520*    -------------------------------
  1521     05  BIRTHL PIC S9(0004) COMP.
  1522     05  BIRTHF PIC  X(0001).
  1523     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  31
* EL131.cbl
  1524         10  BIRTHA PIC  X(0001).
  1525     05  BIRTHI PIC  X(0008).
  1526*    -------------------------------
  1527     05  SOCIALL PIC S9(0004) COMP.
  1528     05  SOCIALF PIC  X(0001).
  1529     05  FILLER REDEFINES SOCIALF.
  1530         10  SOCIALA PIC  X(0001).
  1531     05  SOCIALI PIC  X(0011).
  1532*    -------------------------------
  1533     05  SEXL PIC S9(0004) COMP.
  1534     05  SEXF PIC  X(0001).
  1535     05  FILLER REDEFINES SEXF.
  1536         10  SEXA PIC  X(0001).
  1537     05  SEXI PIC  X(0001).
  1538*    -------------------------------
  1539     05  MLNAMEL PIC S9(0004) COMP.
  1540     05  MLNAMEF PIC  X(0001).
  1541     05  FILLER REDEFINES MLNAMEF.
  1542         10  MLNAMEA PIC  X(0001).
  1543     05  MLNAMEI PIC  X(0015).
  1544*    -------------------------------
  1545     05  MFNAMEL PIC S9(0004) COMP.
  1546     05  MFNAMEF PIC  X(0001).
  1547     05  FILLER REDEFINES MFNAMEF.
  1548         10  MFNAMEA PIC  X(0001).
  1549     05  MFNAMEI PIC  X(0012).
  1550*    -------------------------------
  1551     05  MMINITL PIC S9(0004) COMP.
  1552     05  MMINITF PIC  X(0001).
  1553     05  FILLER REDEFINES MMINITF.
  1554         10  MMINITA PIC  X(0001).
  1555     05  MMINITI PIC  X(0001).
  1556*    -------------------------------
  1557     05  LOANNOL PIC S9(0004) COMP.
  1558     05  LOANNOF PIC  X(0001).
  1559     05  FILLER REDEFINES LOANNOF.
  1560         10  LOANNOA PIC  X(0001).
  1561     05  LOANNOI PIC  X(0008).
  1562*    -------------------------------
  1563     05  CRTLNMEL PIC S9(0004) COMP.
  1564     05  CRTLNMEF PIC  X(0001).
  1565     05  FILLER REDEFINES CRTLNMEF.
  1566         10  CRTLNMEA PIC  X(0001).
  1567     05  CRTLNMEI PIC  X(0015).
  1568*    -------------------------------
  1569     05  CRTFNMEL PIC S9(0004) COMP.
  1570     05  CRTFNMEF PIC  X(0001).
  1571     05  FILLER REDEFINES CRTFNMEF.
  1572         10  CRTFNMEA PIC  X(0001).
  1573     05  CRTFNMEI PIC  X(0012).
  1574*    -------------------------------
  1575     05  CRTINITL PIC S9(0004) COMP.
  1576     05  CRTINITF PIC  X(0001).
  1577     05  FILLER REDEFINES CRTINITF.
  1578         10  CRTINITA PIC  X(0001).
  1579     05  CRTINITI PIC  X(0001).
  1580*    -------------------------------
  1581     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  32
* EL131.cbl
  1582     05  LOANBALF PIC  X(0001).
  1583     05  FILLER REDEFINES LOANBALF.
  1584         10  LOANBALA PIC  X(0001).
  1585     05  LOANBALI PIC  9(7)V99.
  1586*    -------------------------------
  1587     05  PROCL PIC S9(0004) COMP.
  1588     05  PROCF PIC  X(0001).
  1589     05  FILLER REDEFINES PROCF.
  1590         10  PROCA PIC  X(0001).
  1591     05  PROCI PIC  X(0004).
  1592*    -------------------------------
  1593     05  SUPVL PIC S9(0004) COMP.
  1594     05  SUPVF PIC  X(0001).
  1595     05  FILLER REDEFINES SUPVF.
  1596         10  SUPVA PIC  X(0001).
  1597     05  SUPVI PIC  X(0001).
  1598*    -------------------------------
  1599     05  PRICDL PIC S9(0004) COMP.
  1600     05  PRICDF PIC  X(0001).
  1601     05  FILLER REDEFINES PRICDF.
  1602         10  PRICDA PIC  X(0001).
  1603     05  PRICDI PIC  X(0001).
  1604*    -------------------------------
  1605     05  CRITPL PIC S9(0004) COMP.
  1606     05  CRITPF PIC  X(0001).
  1607     05  FILLER REDEFINES CRITPF.
  1608         10  CRITPA PIC  X(0001).
  1609     05  CRITPI PIC  X(0002).
  1610*    -------------------------------
  1611     05  CRITPTL PIC S9(0004) COMP.
  1612     05  CRITPTF PIC  X(0001).
  1613     05  FILLER REDEFINES CRITPTF.
  1614         10  CRITPTA PIC  X(0001).
  1615     05  CRITPTI PIC  X(0002).
  1616*    -------------------------------
  1617     05  RTWMOSL PIC S9(0004) COMP.
  1618     05  RTWMOSF PIC  X(0001).
  1619     05  FILLER REDEFINES RTWMOSF.
  1620         10  RTWMOSA PIC  X(0001).
  1621     05  RTWMOSI PIC  X(0002).
  1622*    -------------------------------
  1623     05  FILETOL PIC S9(0004) COMP.
  1624     05  FILETOF PIC  X(0001).
  1625     05  FILLER REDEFINES FILETOF.
  1626         10  FILETOA PIC  X(0001).
  1627     05  FILETOI PIC  X(0004).
  1628*    -------------------------------
  1629     05  PTHRHDGL PIC S9(0004) COMP.
  1630     05  PTHRHDGF PIC  X(0001).
  1631     05  FILLER REDEFINES PTHRHDGF.
  1632         10  PTHRHDGA PIC  X(0001).
  1633     05  PTHRHDGI PIC  X(0010).
  1634*    -------------------------------
  1635     05  PDTHRUL PIC S9(0004) COMP.
  1636     05  PDTHRUF PIC  X(0001).
  1637     05  FILLER REDEFINES PDTHRUF.
  1638         10  PDTHRUA PIC  X(0001).
  1639     05  PDTHRUI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  33
* EL131.cbl
  1640*    -------------------------------
  1641     05  PDAMTL PIC S9(0004) COMP.
  1642     05  PDAMTF PIC  X(0001).
  1643     05  FILLER REDEFINES PDAMTF.
  1644         10  PDAMTA PIC  X(0001).
  1645     05  PDAMTI PIC  9(7)V99.
  1646*    -------------------------------
  1647     05  NODAYSL PIC S9(0004) COMP.
  1648     05  NODAYSF PIC  X(0001).
  1649     05  FILLER REDEFINES NODAYSF.
  1650         10  NODAYSA PIC  X(0001).
  1651     05  NODAYSI PIC  9(5).
  1652*    -------------------------------
  1653     05  NOPMTSL PIC S9(0004) COMP.
  1654     05  NOPMTSF PIC  X(0001).
  1655     05  FILLER REDEFINES NOPMTSF.
  1656         10  NOPMTSA PIC  X(0001).
  1657     05  NOPMTSI PIC  9(4).
  1658*    -------------------------------
  1659     05  FORMTYPL PIC S9(0004) COMP.
  1660     05  FORMTYPF PIC  X(0001).
  1661     05  FILLER REDEFINES FORMTYPF.
  1662         10  FORMTYPA PIC  X(0001).
  1663     05  FORMTYPI PIC  X(0001).
  1664*    -------------------------------
  1665     05  ESTL PIC S9(0004) COMP.
  1666     05  ESTF PIC  X(0001).
  1667     05  FILLER REDEFINES ESTF.
  1668         10  ESTA PIC  X(0001).
  1669     05  ESTI PIC  X(0008).
  1670*    -------------------------------
  1671     05  AUIDL PIC S9(0004) COMP.
  1672     05  AUIDF PIC  X(0001).
  1673     05  FILLER REDEFINES AUIDF.
  1674         10  AUIDA PIC  X(0001).
  1675     05  AUIDI PIC  X(0004).
  1676*    -------------------------------
  1677     05  OCCL PIC S9(0004) COMP.
  1678     05  OCCF PIC  X(0001).
  1679     05  FILLER REDEFINES OCCF.
  1680         10  OCCA PIC  X(0001).
  1681     05  OCCI PIC  X(0006).
  1682*    -------------------------------
  1683     05  MNTDTL PIC S9(0004) COMP.
  1684     05  MNTDTF PIC  X(0001).
  1685     05  FILLER REDEFINES MNTDTF.
  1686         10  MNTDTA PIC  X(0001).
  1687     05  MNTDTI PIC  X(0008).
  1688*    -------------------------------
  1689     05  MNTTYPEL PIC S9(0004) COMP.
  1690     05  MNTTYPEF PIC  X(0001).
  1691     05  FILLER REDEFINES MNTTYPEF.
  1692         10  MNTTYPEA PIC  X(0001).
  1693     05  MNTTYPEI PIC  X(0006).
  1694*    -------------------------------
  1695     05  CERTCARL PIC S9(0004) COMP.
  1696     05  CERTCARF PIC  X(0001).
  1697     05  FILLER REDEFINES CERTCARF.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  34
* EL131.cbl
  1698         10  CERTCARA PIC  X(0001).
  1699     05  CERTCARI PIC  X(0001).
  1700*    -------------------------------
  1701     05  CERTGRPL PIC S9(0004) COMP.
  1702     05  CERTGRPF PIC  X(0001).
  1703     05  FILLER REDEFINES CERTGRPF.
  1704         10  CERTGRPA PIC  X(0001).
  1705     05  CERTGRPI PIC  X(0006).
  1706*    -------------------------------
  1707     05  CERTSTL PIC S9(0004) COMP.
  1708     05  CERTSTF PIC  X(0001).
  1709     05  FILLER REDEFINES CERTSTF.
  1710         10  CERTSTA PIC  X(0001).
  1711     05  CERTSTI PIC  X(0002).
  1712*    -------------------------------
  1713     05  CERTACTL PIC S9(0004) COMP.
  1714     05  CERTACTF PIC  X(0001).
  1715     05  FILLER REDEFINES CERTACTF.
  1716         10  CERTACTA PIC  X(0001).
  1717     05  CERTACTI PIC  X(0010).
  1718*    -------------------------------
  1719     05  CERTEFFL PIC S9(0004) COMP.
  1720     05  CERTEFFF PIC  X(0001).
  1721     05  FILLER REDEFINES CERTEFFF.
  1722         10  CERTEFFA PIC  X(0001).
  1723     05  CERTEFFI PIC  X(0008).
  1724*    -------------------------------
  1725     05  ISSAGEL PIC S9(0004) COMP.
  1726     05  ISSAGEF PIC  X(0001).
  1727     05  FILLER REDEFINES ISSAGEF.
  1728         10  ISSAGEA PIC  X(0001).
  1729     05  ISSAGEI PIC  X(0002).
  1730*    -------------------------------
  1731     05  APRL PIC S9(0004) COMP.
  1732     05  APRF PIC  X(0001).
  1733     05  FILLER REDEFINES APRF.
  1734         10  APRA PIC  X(0001).
  1735     05  APRI PIC  9(4)V9(4).
  1736*    -------------------------------
  1737     05  PMTFREQL PIC S9(0004) COMP.
  1738     05  PMTFREQF PIC  X(0001).
  1739     05  FILLER REDEFINES PMTFREQF.
  1740         10  PMTFREQA PIC  X(0001).
  1741     05  PMTFREQI PIC  99.
  1742*    -------------------------------
  1743     05  INDGRPL PIC S9(0004) COMP.
  1744     05  INDGRPF PIC  X(0001).
  1745     05  FILLER REDEFINES INDGRPF.
  1746         10  INDGRPA PIC  X(0001).
  1747     05  INDGRPI PIC  X(0001).
  1748*    -------------------------------
  1749     05  PREMTYPL PIC S9(0004) COMP.
  1750     05  PREMTYPF PIC  X(0001).
  1751     05  FILLER REDEFINES PREMTYPF.
  1752         10  PREMTYPA PIC  X(0001).
  1753     05  PREMTYPI PIC  X(0001).
  1754*    -------------------------------
  1755     05  REINCDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  35
* EL131.cbl
  1756     05  REINCDF PIC  X(0001).
  1757     05  FILLER REDEFINES REINCDF.
  1758         10  REINCDA PIC  X(0001).
  1759     05  REINCDI PIC  X(0001).
  1760*    -------------------------------
  1761     05  JNTLNMEL PIC S9(0004) COMP.
  1762     05  JNTLNMEF PIC  X(0001).
  1763     05  FILLER REDEFINES JNTLNMEF.
  1764         10  JNTLNMEA PIC  X(0001).
  1765     05  JNTLNMEI PIC  X(0015).
  1766*    -------------------------------
  1767     05  JNTFNMEL PIC S9(0004) COMP.
  1768     05  JNTFNMEF PIC  X(0001).
  1769     05  FILLER REDEFINES JNTFNMEF.
  1770         10  JNTFNMEA PIC  X(0001).
  1771     05  JNTFNMEI PIC  X(0012).
  1772*    -------------------------------
  1773     05  JNTINITL PIC S9(0004) COMP.
  1774     05  JNTINITF PIC  X(0001).
  1775     05  FILLER REDEFINES JNTINITF.
  1776         10  JNTINITA PIC  X(0001).
  1777     05  JNTINITI PIC  X(0001).
  1778*    -------------------------------
  1779     05  JNTAGEL PIC S9(0004) COMP.
  1780     05  JNTAGEF PIC  X(0001).
  1781     05  FILLER REDEFINES JNTAGEF.
  1782         10  JNTAGEA PIC  X(0001).
  1783     05  JNTAGEI PIC  X(0002).
  1784*    -------------------------------
  1785     05  ADDONDTL PIC S9(0004) COMP.
  1786     05  ADDONDTF PIC  X(0001).
  1787     05  FILLER REDEFINES ADDONDTF.
  1788         10  ADDONDTA PIC  X(0001).
  1789     05  ADDONDTI PIC  X(0008).
  1790*    -------------------------------
  1791     05  LCVDSCRL PIC S9(0004) COMP.
  1792     05  LCVDSCRF PIC  X(0001).
  1793     05  FILLER REDEFINES LCVDSCRF.
  1794         10  LCVDSCRA PIC  X(0001).
  1795     05  LCVDSCRI PIC  X(0006).
  1796*    -------------------------------
  1797     05  LCVKINDL PIC S9(0004) COMP.
  1798     05  LCVKINDF PIC  X(0001).
  1799     05  FILLER REDEFINES LCVKINDF.
  1800         10  LCVKINDA PIC  X(0001).
  1801     05  LCVKINDI PIC  X(0003).
  1802*    -------------------------------
  1803     05  LCVCDL PIC S9(0004) COMP.
  1804     05  LCVCDF PIC  X(0001).
  1805     05  FILLER REDEFINES LCVCDF.
  1806         10  LCVCDA PIC  X(0001).
  1807     05  LCVCDI PIC  X(0002).
  1808*    -------------------------------
  1809     05  LCVOTRML PIC S9(0004) COMP.
  1810     05  LCVOTRMF PIC  X(0001).
  1811     05  FILLER REDEFINES LCVOTRMF.
  1812         10  LCVOTRMA PIC  X(0001).
  1813     05  LCVOTRMI PIC  999.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  36
* EL131.cbl
  1814*    -------------------------------
  1815     05  LCVRTRML PIC S9(0004) COMP.
  1816     05  LCVRTRMF PIC  X(0001).
  1817     05  FILLER REDEFINES LCVRTRMF.
  1818         10  LCVRTRMA PIC  X(0001).
  1819     05  LCVRTRMI PIC  X(0003).
  1820*    -------------------------------
  1821     05  LCVRATEL PIC S9(0004) COMP.
  1822     05  LCVRATEF PIC  X(0001).
  1823     05  FILLER REDEFINES LCVRATEF.
  1824         10  LCVRATEA PIC  X(0001).
  1825     05  LCVRATEI PIC  9999V99.
  1826*    -------------------------------
  1827     05  LCVBENEL PIC S9(0004) COMP.
  1828     05  LCVBENEF PIC  X(0001).
  1829     05  FILLER REDEFINES LCVBENEF.
  1830         10  LCVBENEA PIC  X(0001).
  1831     05  LCVBENEI PIC  9(9)V99.
  1832*    -------------------------------
  1833     05  LCVFORML PIC S9(0004) COMP.
  1834     05  LCVFORMF PIC  X(0001).
  1835     05  FILLER REDEFINES LCVFORMF.
  1836         10  LCVFORMA PIC  X(0001).
  1837     05  LCVFORMI PIC  X(0012).
  1838*    -------------------------------
  1839     05  LCVCNDTL PIC S9(0004) COMP.
  1840     05  LCVCNDTF PIC  X(0001).
  1841     05  FILLER REDEFINES LCVCNDTF.
  1842         10  LCVCNDTA PIC  X(0001).
  1843     05  LCVCNDTI PIC  X(0008).
  1844*    -------------------------------
  1845     05  LCVEXITL PIC S9(0004) COMP.
  1846     05  LCVEXITF PIC  X(0001).
  1847     05  FILLER REDEFINES LCVEXITF.
  1848         10  LCVEXITA PIC  X(0001).
  1849     05  LCVEXITI PIC  X(0008).
  1850*    -------------------------------
  1851     05  LCVSTATL PIC S9(0004) COMP.
  1852     05  LCVSTATF PIC  X(0001).
  1853     05  FILLER REDEFINES LCVSTATF.
  1854         10  LCVSTATA PIC  X(0001).
  1855     05  LCVSTATI PIC  X(0006).
  1856*    -------------------------------
  1857     05  ACVDSCRL PIC S9(0004) COMP.
  1858     05  ACVDSCRF PIC  X(0001).
  1859     05  FILLER REDEFINES ACVDSCRF.
  1860         10  ACVDSCRA PIC  X(0001).
  1861     05  ACVDSCRI PIC  X(0006).
  1862*    -------------------------------
  1863     05  ACVKINDL PIC S9(0004) COMP.
  1864     05  ACVKINDF PIC  X(0001).
  1865     05  FILLER REDEFINES ACVKINDF.
  1866         10  ACVKINDA PIC  X(0001).
  1867     05  ACVKINDI PIC  X(0003).
  1868*    -------------------------------
  1869     05  ACVCDL PIC S9(0004) COMP.
  1870     05  ACVCDF PIC  X(0001).
  1871     05  FILLER REDEFINES ACVCDF.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  37
* EL131.cbl
  1872         10  ACVCDA PIC  X(0001).
  1873     05  ACVCDI PIC  X(0002).
  1874*    -------------------------------
  1875     05  ACVOTRML PIC S9(0004) COMP.
  1876     05  ACVOTRMF PIC  X(0001).
  1877     05  FILLER REDEFINES ACVOTRMF.
  1878         10  ACVOTRMA PIC  X(0001).
  1879     05  ACVOTRMI PIC  999.
  1880*    -------------------------------
  1881     05  ACVRTRML PIC S9(0004) COMP.
  1882     05  ACVRTRMF PIC  X(0001).
  1883     05  FILLER REDEFINES ACVRTRMF.
  1884         10  ACVRTRMA PIC  X(0001).
  1885     05  ACVRTRMI PIC  X(0003).
  1886*    -------------------------------
  1887     05  ACVRATEL PIC S9(0004) COMP.
  1888     05  ACVRATEF PIC  X(0001).
  1889     05  FILLER REDEFINES ACVRATEF.
  1890         10  ACVRATEA PIC  X(0001).
  1891     05  ACVRATEI PIC  9999V99.
  1892*    -------------------------------
  1893     05  ACVBENEL PIC S9(0004) COMP.
  1894     05  ACVBENEF PIC  X(0001).
  1895     05  FILLER REDEFINES ACVBENEF.
  1896         10  ACVBENEA PIC  X(0001).
  1897     05  ACVBENEI PIC  9(9)V99.
  1898*    -------------------------------
  1899     05  ACVFORML PIC S9(0004) COMP.
  1900     05  ACVFORMF PIC  X(0001).
  1901     05  FILLER REDEFINES ACVFORMF.
  1902         10  ACVFORMA PIC  X(0001).
  1903     05  ACVFORMI PIC  X(0012).
  1904*    -------------------------------
  1905     05  ACVCNDTL PIC S9(0004) COMP.
  1906     05  ACVCNDTF PIC  X(0001).
  1907     05  FILLER REDEFINES ACVCNDTF.
  1908         10  ACVCNDTA PIC  X(0001).
  1909     05  ACVCNDTI PIC  X(0008).
  1910*    -------------------------------
  1911     05  ACVEXITL PIC S9(0004) COMP.
  1912     05  ACVEXITF PIC  X(0001).
  1913     05  FILLER REDEFINES ACVEXITF.
  1914         10  ACVEXITA PIC  X(0001).
  1915     05  ACVEXITI PIC  X(0008).
  1916*    -------------------------------
  1917     05  ACVSTATL PIC S9(0004) COMP.
  1918     05  ACVSTATF PIC  X(0001).
  1919     05  FILLER REDEFINES ACVSTATF.
  1920         10  ACVSTATA PIC  X(0001).
  1921     05  ACVSTATI PIC  X(0006).
  1922*    -------------------------------
  1923     05  LABEL2L PIC S9(0004) COMP.
  1924     05  LABEL2F PIC  X(0001).
  1925     05  FILLER REDEFINES LABEL2F.
  1926         10  LABEL2A PIC  X(0001).
  1927     05  LABEL2I PIC  X(0014).
  1928*    -------------------------------
  1929     05  BCERT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  38
* EL131.cbl
  1930     05  BCERT1F PIC  X(0001).
  1931     05  FILLER REDEFINES BCERT1F.
  1932         10  BCERT1A PIC  X(0001).
  1933     05  BCERT1I PIC  X(0010).
  1934*    -------------------------------
  1935     05  BSUFX1L PIC S9(0004) COMP.
  1936     05  BSUFX1F PIC  X(0001).
  1937     05  FILLER REDEFINES BSUFX1F.
  1938         10  BSUFX1A PIC  X(0001).
  1939     05  BSUFX1I PIC  X(0001).
  1940*    -------------------------------
  1941     05  BCERT2L PIC S9(0004) COMP.
  1942     05  BCERT2F PIC  X(0001).
  1943     05  FILLER REDEFINES BCERT2F.
  1944         10  BCERT2A PIC  X(0001).
  1945     05  BCERT2I PIC  X(0010).
  1946*    -------------------------------
  1947     05  BSUFX2L PIC S9(0004) COMP.
  1948     05  BSUFX2F PIC  X(0001).
  1949     05  FILLER REDEFINES BSUFX2F.
  1950         10  BSUFX2A PIC  X(0001).
  1951     05  BSUFX2I PIC  X(0001).
  1952*    -------------------------------
  1953     05  BCERT3L PIC S9(0004) COMP.
  1954     05  BCERT3F PIC  X(0001).
  1955     05  FILLER REDEFINES BCERT3F.
  1956         10  BCERT3A PIC  X(0001).
  1957     05  BCERT3I PIC  X(0010).
  1958*    -------------------------------
  1959     05  BSUFX3L PIC S9(0004) COMP.
  1960     05  BSUFX3F PIC  X(0001).
  1961     05  FILLER REDEFINES BSUFX3F.
  1962         10  BSUFX3A PIC  X(0001).
  1963     05  BSUFX3I PIC  X(0001).
  1964*    -------------------------------
  1965     05  BCERT4L PIC S9(0004) COMP.
  1966     05  BCERT4F PIC  X(0001).
  1967     05  FILLER REDEFINES BCERT4F.
  1968         10  BCERT4A PIC  X(0001).
  1969     05  BCERT4I PIC  X(0010).
  1970*    -------------------------------
  1971     05  BSUFX4L PIC S9(0004) COMP.
  1972     05  BSUFX4F PIC  X(0001).
  1973     05  FILLER REDEFINES BSUFX4F.
  1974         10  BSUFX4A PIC  X(0001).
  1975     05  BSUFX4I PIC  X(0001).
  1976*    -------------------------------
  1977     05  BCERT5L PIC S9(0004) COMP.
  1978     05  BCERT5F PIC  X(0001).
  1979     05  FILLER REDEFINES BCERT5F.
  1980         10  BCERT5A PIC  X(0001).
  1981     05  BCERT5I PIC  X(0010).
  1982*    -------------------------------
  1983     05  BSUFX5L PIC S9(0004) COMP.
  1984     05  BSUFX5F PIC  X(0001).
  1985     05  FILLER REDEFINES BSUFX5F.
  1986         10  BSUFX5A PIC  X(0001).
  1987     05  BSUFX5I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  39
* EL131.cbl
  1988*    -------------------------------
  1989     05  MSG1L PIC S9(0004) COMP.
  1990     05  MSG1F PIC  X(0001).
  1991     05  FILLER REDEFINES MSG1F.
  1992         10  MSG1A PIC  X(0001).
  1993     05  MSG1I PIC  X(0072).
  1994*    -------------------------------
  1995     05  MSG2L PIC S9(0004) COMP.
  1996     05  MSG2F PIC  X(0001).
  1997     05  FILLER REDEFINES MSG2F.
  1998         10  MSG2A PIC  X(0001).
  1999     05  MSG2I PIC  X(0072).
  2000*    -------------------------------
  2001     05  PFKEYL PIC S9(0004) COMP.
  2002     05  PFKEYF PIC  X(0001).
  2003     05  FILLER REDEFINES PFKEYF.
  2004         10  PFKEYA PIC  X(0001).
  2005     05  PFKEYI PIC  99.
  2006*    -------------------------------
  2007     05  PFKEY6L PIC S9(0004) COMP.
  2008     05  PFKEY6F PIC  X(0001).
  2009     05  FILLER REDEFINES PFKEY6F.
  2010         10  PFKEY6A PIC  X(0001).
  2011     05  PFKEY6I PIC  X(0016).
  2012 01  EL131AO REDEFINES EL131AI.
  2013     05  FILLER            PIC  X(0012).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  DATEO PIC  X(0008).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  TIMEO PIC  99.99.
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  SEQUO PIC  X(0010).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  COMPO PIC  X(0003).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  USERIDO PIC  X(0004).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  LABEL1O PIC  X(0011).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  PCERTNOO PIC  X(0010).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  PSUFXO PIC  X(0001).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  CCNOO PIC  X(0016).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  MAINTO PIC  X(0001).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  40
* EL131.cbl
  2046     05  CLAIMO PIC  X(0007).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  CARRO PIC  X(0001).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  CERTO PIC  X(0010).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  SUFXO PIC  X(0001).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  TYPEO PIC  X(0001).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  BENPERO PIC  X(0002).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  INSTYPEO PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  STATUSO PIC  X(0006).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  INCO PIC  X(0008).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  REPO PIC  X(0008).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  ICD1O PIC  X(0008).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  ICD2O PIC  X(0008).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  DIAGO PIC  X(0060).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  ACCSWO PIC  X(0001).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  BENEO PIC  X(0010).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  BIRTHO PIC  X(0008).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  SOCIALO PIC  X(0011).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  SEXO PIC  X(0001).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  MLNAMEO PIC  X(0015).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  MFNAMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  41
* EL131.cbl
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  MMINITO PIC  X(0001).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  LOANNOO PIC  X(0008).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  CRTLNMEO PIC  X(0015).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  CRTFNMEO PIC  X(0012).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  CRTINITO PIC  X(0001).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  LOANBALO PIC  ZZZZZ9.99.
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  PROCO PIC  X(0004).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  SUPVO PIC  X(0001).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  PRICDO PIC  X(0001).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  CRITPO PIC  X(0002).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  CRITPTO PIC  X(0002).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  RTWMOSO PIC  X(0002).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  FILETOO PIC  X(0004).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  PTHRHDGO PIC  X(0010).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  PDTHRUO PIC  X(0008).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  PDAMTO PIC  Z(06).99.
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  NODAYSO PIC  ZZZ99.
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  NOPMTSO PIC  ZZ99.
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  FORMTYPO PIC  X(0001).
  2161*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  42
* EL131.cbl
  2162     05  FILLER            PIC  X(0003).
  2163     05  ESTO PIC  X(0008).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  AUIDO PIC  X(0004).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  OCCO PIC  X(0006).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  MNTDTO PIC  X(0008).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  MNTTYPEO PIC  X(0006).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  CERTCARO PIC  X(0001).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  CERTGRPO PIC  X(0006).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  CERTSTO PIC  X(0002).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  CERTACTO PIC  X(0010).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  CERTEFFO PIC  X(0008).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  ISSAGEO PIC  X(0002).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  APRO PIC  9(3).9(4).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  PMTFREQO PIC  99.
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  INDGRPO PIC  X(0001).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  PREMTYPO PIC  X(0001).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  REINCDO PIC  X(0001).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  JNTLNMEO PIC  X(0015).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  JNTFNMEO PIC  X(0012).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  JNTINITO PIC  X(0001).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  43
* EL131.cbl
  2220     05  JNTAGEO PIC  X(0002).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  ADDONDTO PIC  X(0008).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  LCVDSCRO PIC  X(0006).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  LCVKINDO PIC  X(0003).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  LCVCDO PIC  X(0002).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  LCVOTRMO PIC  999.
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  LCVRTRMO PIC  999.
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  LCVRATEO PIC  ZZZ.ZZ.
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  LCVFORMO PIC  X(0012).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  LCVCNDTO PIC  X(0008).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  LCVEXITO PIC  X(0008).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  LCVSTATO PIC  X(0006).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  ACVDSCRO PIC  X(0006).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  ACVKINDO PIC  X(0003).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  ACVCDO PIC  X(0002).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  ACVOTRMO PIC  999.
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  ACVRTRMO PIC  999.
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  ACVRATEO PIC  ZZZ.ZZ.
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  44
* EL131.cbl
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  ACVFORMO PIC  X(0012).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  ACVCNDTO PIC  X(0008).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  ACVEXITO PIC  X(0008).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  ACVSTATO PIC  X(0006).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  LABEL2O PIC  X(0014).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  BCERT1O PIC  X(0010).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  BSUFX1O PIC  X(0001).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  BCERT2O PIC  X(0010).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  BSUFX2O PIC  X(0001).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  BCERT3O PIC  X(0010).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  BSUFX3O PIC  X(0001).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  BCERT4O PIC  X(0010).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  BSUFX4O PIC  X(0001).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  BCERT5O PIC  X(0010).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  BSUFX5O PIC  X(0001).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  MSG1O PIC  X(0072).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  MSG2O PIC  X(0072).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  PFKEYO PIC  X(0002).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  PFKEY6O PIC  X(0016).
  2335*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  45
* EL131.cbl
  2336
  2337*                                COPY ELCEMIB SUPPRESS.
  2338******************************************************************
  2339*                                                                *
  2340*                                                                *
  2341*                            ELCEMIB.                            *
  2342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2343*                            VMOD=2.005                          *
  2344*                                                                *
  2345*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2346*                                                                *
  2347******************************************************************
  2348 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2349     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2350     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2351     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2352     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2353     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2354     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2355     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2356     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2357     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2358         88  EMI-NO-ERRORS                    VALUE '1'.
  2359         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2360         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2361     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2362         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2363     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2364         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2365         88  EMI-AREA1-FULL                   VALUE '2'.
  2366     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2367         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2368         88  EMI-AREA2-FULL                   VALUE '2'.
  2369     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2370         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2371         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2372         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2373         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2374         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2375     12  EMI-ERROR-LINES.
  2376         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2377         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2378         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2379         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2380             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2381                 24  EMI-ERR-NUM         PIC X(4).
  2382                 24  EMI-FILLER          PIC X.
  2383                 24  EMI-SEV             PIC X.
  2384                 24  FILLER              PIC X.
  2385             20  FILLER                  PIC X(02).
  2386     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2387         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2388             20  EMI-ERROR-NUMBER    PIC X(4).
  2389             20  EMI-FILL            PIC X.
  2390             20  EMI-SEVERITY        PIC X.
  2391             20  FILLER              PIC X.
  2392             20  EMI-ERROR-TEXT.
  2393                 24  EMI-TEXT-VARIABLE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  46
* EL131.cbl
  2394                 24  FILLER          PIC X(55).
  2395     12  EMI-SEVERITY-SAVE           PIC X.
  2396         88  EMI-NOTE                    VALUE 'N'.
  2397         88  EMI-WARNING                 VALUE 'W'.
  2398         88  EMI-FORCABLE                VALUE 'F'.
  2399         88  EMI-FATAL                   VALUE 'X'.
  2400     12  EMI-MESSAGE-FLAG            PIC X.
  2401         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2402         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2403     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2404     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2405         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2406         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2407         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2408     12  emi-claim-no                pic x(7).
  2409     12  emi-claim-type              pic x(6).
  2410     12  FILLER                      PIC X(124)  VALUE SPACES.
  2411     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2412     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2413     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2414     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2415
  2416*                                COPY ELCJPFX SUPPRESS.
  2417******************************************************************
  2418*                                                                *
  2419*                                                                *
  2420*                            ELCJPFX.                            *
  2421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2422*                            VMOD=2.002                          *
  2423*                                                                *
  2424*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2425*                                                                *
  2426*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2427*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2428*        ELCNTL - CONTROL FILE                                   *
  2429*        ELMSTR - CLAIM MASTERS                                  *
  2430*        ELTRLR - ACTIVITY TRAILERS                              *
  2431*        ELCHKQ - CHECK QUE                                      *
  2432******************************************************************
  2433 01  JOURNAL-RECORD.
  2434     12  jp-date                     pic s9(5) comp-3.
  2435     12  jp-time                     pic s9(7) comp-3.
  2436     12  JP-USER-ID                  PIC X(4).
  2437     12  JP-FILE-ID                  PIC X(8).
  2438     12  JP-PROGRAM-ID               PIC X(8).
  2439     12  JP-RECORD-TYPE              PIC X.
  2440         88 JP-ADD              VALUE 'A'.
  2441         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2442         88 JP-AFTER-CHANGE     VALUE 'C'.
  2443         88 JP-DELETE           VALUE 'D'.
  2444         88 JP-GENERIC-DELETE   VALUE 'G'.
  2445         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2446         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2447     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2448     12  JP-RECORD-AREA
  2449
  2450
  2451                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  47
* EL131.cbl
  2452
  2453*                                COPY ELCCALC.
  2454******************************************************************
  2455*                                                                *
  2456*                           ELCCALC.                            *
  2457*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2458*                            VMOD=2.025                          *
  2459*                                                                *
  2460*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2461*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2462*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2463*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2464*                                                                *
  2465*  PASSED TO ELRTRM                                              *
  2466*  -----------------                                             *
  2467*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2468*  ORIGINAL TERM                                                 *
  2469*  BEGINNING DATE                                                *
  2470*  ENDING DATE                                                   *
  2471*  COMPANY I.D.                                                  *
  2472*  ACCOUNT MASTER USER FIELD                                     *
  2473*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2474*  FREE LOOK DAYS                                                *
  2475*                                                                *
  2476*  RETURNED FROM ELRTRM                                          *
  2477*  ---------------------                                         *
  2478*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2479*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2480*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2481*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2482*----------------------------------------------------------------*
  2483*  PASSED TO ELRAMT                                              *
  2484*  ----------------                                              *
  2485*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2486*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2487*  ORIGINAL AMOUNT                                               *
  2488*  ALTERNATE BENEFIT (BALLON)                                    *
  2489*  A.P.R. - NET PAY ONLY                                         *
  2490*  METHOD
  2491*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2492*  COMPANY I.D.                                                  *
  2493*  BENEFIT TYPE                                                  *
  2494*                                                                *
  2495*  RETURNED FROM ELRAMT                                          *
  2496*  --------------------                                          *
  2497*  REMAINING AMOUNT 1 - CURRENT                                  *
  2498*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2499*  REMAINING AMOUNT FACTOR
  2500*----------------------------------------------------------------*
  2501*  PASSED TO ELRESV                                              *
  2502*  -----------------                                             *
  2503*  CERTIFICATE EFFECTIVE DATE                                    *
  2504*  VALUATION DATE                                                *
  2505*  PAID THRU DATE                                                *
  2506*  BENEFIT                                                       *
  2507*  INCURRED DATE                                                 *
  2508*  REPORTED DATE                                                 *
  2509*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  48
* EL131.cbl
  2510*  TERM                                                          *
  2511*  CDT PERCENT                                                   *
  2512*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2513* *CLAIM TYPE (LIFE, A/H)                                        *
  2514* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2515* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2516*                                                                *
  2517*  RETURNED FROM ELRESV                                          *
  2518*  --------------------                                          *
  2519*  CDT TABLE USED                                                *
  2520*  CDT FACTOR USED                                               *
  2521*  PAY TO CURRENT RESERVE                                        *
  2522*  I.B.N.R. - A/H ONLY                                           *
  2523*  FUTURE (ACCRUED) AH ONLY                                      *
  2524*----------------------------------------------------------------*
  2525*  PASSED TO ELRATE                                              *
  2526*  ----------------                                              *
  2527*  CERT ISSUE DATE                                               *
  2528*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2529*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2530*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2531*  STATE CODE (CLIENT DEFINED)                                   *
  2532*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2533*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2534*  DEVIATION CODE                                                *
  2535*  ISSUE AGE                                                     *
  2536*  ORIGINAL BENEFIT AMOUNT                                       *
  2537*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2538*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2539*  BENEFIT KIND (LIFE OR A/H)                                    *
  2540*  A.P.R.                                                        *
  2541*  METHOD
  2542*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2543*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2544*  COMPANY I.D. (3 CHARACTER)                                    *
  2545*  BENEFIT CODE                                                  *
  2546*  BENEFIT OVERRIDE CODE                                         *
  2547*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2548*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2549*  JOINT INDICATOR (CSL ONLY)                                    *
  2550*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2551*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2552*                                                                *
  2553*  RETURNED FROM ELRATE                                          *
  2554*  --------------------                                          *
  2555*  CALCULATED PREMIUM                                            *
  2556*  PREMIUM RATE                                                  *
  2557*  MORTALITY CODE                                                *
  2558*  MAX ATTAINED AGE                                              *
  2559*  MAX AGE                                                       *
  2560*  MAX TERM                                                      *
  2561*  MAX MONTHLY BENEFIT                                           *
  2562*  MAX TOTAL BENIFIT                                             *
  2563*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2564*----------------------------------------------------------------*
  2565*  PASSED TO ELRFND                                              *
  2566*  ----------------                                              *
  2567*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  49
* EL131.cbl
  2568*  REFUND DATE                                                   *
  2569*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2570*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2571*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2572*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2573*  STATE CODE (CLIENT DEFINED)                                   *
  2574*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2575*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2576*  DEVIATION CODE                                                *
  2577*  ISSUE AGE                                                     *
  2578*  ORIGINAL BENEFIT AMOUNT                                       *
  2579*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2580*  PROCESS TYPE (CANCEL)                                         *
  2581*  BENEFIT KIND (LIFE OR A/H)                                    *
  2582*  A.P.R.                                                        *
  2583*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2584*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2585*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2586*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2587*  COMPANY I.D. (3 CHARACTER)                                    *
  2588*  BENEFIT CODE                                                  *
  2589*  BENEFIT OVERRIDE CODE                                         *
  2590*                                                                *
  2591*  RETURNED FROM ELRFND                                          *
  2592*  --------------------                                          *
  2593*  CALCULATED REFUND                                             *
  2594*----------------------------------------------------------------*
  2595*  PASSED TO ELEARN                                              *
  2596*  ----------------                                              *
  2597*  CERT ISSUE DATE                                               *
  2598*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2599*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2600*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2601*  STATE CODE (CLIENT DEFINED)                                   *
  2602*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2603*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2604*  DEVIATION CODE                                                *
  2605*  ISSUE AGE                                                     *
  2606*  ORIGINAL BENEFIT AMOUNT                                       *
  2607*  BENEFIT KIND (LIFE OR A/H)                                    *
  2608*  A.P.R.                                                        *
  2609*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2610*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2611*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2612*  COMPANY I.D. (3 CHARACTER)                                    *
  2613*  BENEFIT CODE                                                  *
  2614*  BENEFIT OVERRIDE CODE                                         *
  2615*                                                                *
  2616*  RETURNED FROM ELEARN                                          *
  2617*  --------------------                                          *
  2618*  INDICATED  EARNINGS                                           *
  2619*----------------------------------------------------------------*
  2620*                 LENGTH = 450                                   *
  2621*                                                                *
  2622******************************************************************
  2623******************************************************************
  2624*                   C H A N G E   L O G
  2625*
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  50
* EL131.cbl
  2626* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2627*-----------------------------------------------------------------
  2628*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2629* EFFECTIVE    NUMBER
  2630*-----------------------------------------------------------------
  2631* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2632* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2633* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2634* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2635* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2636* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2637* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2638* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2639* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2640* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2641* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2642******************************************************************
  2643
  2644 01  CALCULATION-PASS-AREA.
  2645     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2646                                     COMP.
  2647
  2648     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2649       88  NO-CP-ERROR                             VALUE ZERO.
  2650       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2651                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2652       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2653       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2654       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2655       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2656       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2657       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2658       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2659       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2660       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2661       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2662       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2663       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2664       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2665       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2666       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2667       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2668       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2669
  2670     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2671       88  NO-CP-ERROR-2                           VALUE ZERO.
  2672***********************  INPUT AREAS ****************************
  2673
  2674     12  CP-CALCULATION-AREA.
  2675         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2676         16  CP-CERT-EFF-DT        PIC XX.
  2677         16  CP-VALUATION-DT       PIC XX.
  2678         16  CP-PAID-THRU-DT       PIC XX.
  2679         16  CP-BENEFIT-TYPE       PIC X.
  2680           88  CP-AH                               VALUE 'A' 'D'
  2681                                                   'I' 'U'.
  2682           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2683           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  51
* EL131.cbl
  2684         16  CP-INCURRED-DT        PIC XX.
  2685         16  CP-REPORTED-DT        PIC XX.
  2686         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2687         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2688         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2689                                     COMP-3.
  2690         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2691                                     COMP-3.
  2692         16  CP-CDT-METHOD         PIC X.
  2693           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2694           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2695           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2696         16  CP-CLAIM-TYPE         PIC X.
  2697           88  CP-AH-CLAIM                         VALUE 'A'.
  2698           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2699         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2700                                     COMP-3.
  2701         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2702                                     COMP-3.
  2703         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2704                                     COMP-3.
  2705         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2706                                     COMP-3.
  2707         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-REM-TERM-METHOD    PIC X.
  2714           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2715           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2716           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2717           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2718           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2719           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2720           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2721         16  CP-EARNING-METHOD     PIC X.
  2722           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2723           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2724           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2725           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2726           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2727           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2728           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2729           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2730           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2731           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2732           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2733           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2734           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2735           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2736         16  CP-PROCESS-TYPE       PIC X.
  2737           88  CP-CLAIM                            VALUE '1'.
  2738           88  CP-CANCEL                           VALUE '2'.
  2739           88  CP-ISSUE                            VALUE '3'.
  2740         16  CP-SPECIAL-CALC-CD    PIC X.
  2741           88  CP-OUTSTANDING-BAL              VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  52
* EL131.cbl
  2742           88  CP-1-MTH-INTEREST               VALUE ' '.
  2743           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2744           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2745           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2746           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2747           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2748           88  CP-FARM-PLAN                    VALUE 'F'.
  2749           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2750           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2751           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2752           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2753           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2754           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2755           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2756           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2757           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2758           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2759                                                     'W' 'X'.
  2760           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2761           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2762           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2763           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2764           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2765           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2766           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2767           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2768           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2769           88  CP-CSL-METH-1                   VALUE '5'.
  2770           88  CP-CSL-METH-2                   VALUE '6'.
  2771           88  CP-CSL-METH-3                   VALUE '7'.
  2772           88  CP-CSL-METH-4                   VALUE '8'.
  2773
  2774         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2775                                     COMP-3.
  2776         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2777         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2778         16  CP-STATE              PIC XX          VALUE SPACE.
  2779         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2780         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2781           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2782               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2783         16  CP-R78-OPTION         PIC X.
  2784           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2785           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2786
  2787         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2788         16  CP-IBNR-RESERVE-SW    PIC X.
  2789         16  CP-CLAIM-STATUS       PIC X.
  2790         16  CP-RATE-FILE          PIC X.
  2791         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2792                                     COMP-3.
  2793
  2794         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2795         16  CP-AH-OVERRIDE-CODE   PIC X.
  2796
  2797         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2798                                     COMP-3.
  2799         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  53
* EL131.cbl
  2800                                   PIC S9(5)V99 COMP-3.
  2801         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2802                                     COMP-3.
  2803         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2804                                     COMP-3.
  2805         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2806                                     COMP-3.
  2807         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2808                                  PIC S9(7)V99 COMP-3.
  2809
  2810         16  CP-PAID-FROM-DATE     PIC X(02).
  2811         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2812         16  CP-EXT-DAYS-CALC      PIC X.
  2813           88  CP-EXT-NO-CHG                   VALUE ' '.
  2814           88  CP-EXT-CHG-LF                   VALUE '1'.
  2815           88  CP-EXT-CHG-AH                   VALUE '2'.
  2816           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2817         16  CP-DOMICILE-STATE     PIC XX.
  2818         16  CP-CARRIER            PIC X.
  2819         16  CP-REIN-FLAG          PIC X.
  2820         16  CP-REM-TRM-CALC-OPTION PIC X.
  2821           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2822                      '2' '3' '4' '5'.
  2823           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2824           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2825           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2826           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2827           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2828           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2829           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2830           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2831         16  CP-SIG-SWITCH         PIC X.
  2832         16  CP-RATING-METHOD      PIC X.
  2833           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2834           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2835           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2836           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2837           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2838           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2839           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2840           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2841           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2842         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2843                                     COMP-3.
  2844         16  CP-BEN-CATEGORY       PIC X.
  2845         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2846         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2847                                   PIC S99V9(5) COMP-3.
  2848         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2849         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2850                                   PIC S99V9(5) COMP-3.
  2851         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2852         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2853         16  CP-EXPIRE-DT          PIC XX.
  2854         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2855         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2856         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2857         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  54
* EL131.cbl
  2858         16  CP-DDF-SPEC-CALC      PIC X.
  2859             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2860             88  CP-CALC-CLP              VALUE 'C'.
  2861         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2862         16  CP-CANCEL-REASON      PIC X.
  2863         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2864         16  CP-PMT-MODE           PIC X.
  2865         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2866         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2867         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2868         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2869         16  FILLER                PIC X.
  2870
  2871***************    OUTPUT FROM ELRESV   ************************
  2872
  2873         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2874
  2875         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2876                                     COMP-3.
  2877         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2878                                     COMP-3.
  2879         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2880                                     COMP-3.
  2881         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2882                                     COMP-3.
  2883         16  FILLER                PIC X(09).
  2884***************    OUTPUT FROM ELRTRM   *************************
  2885
  2886         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2887                                     COMP-3.
  2888         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2889                                     COMP-3.
  2890         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2891                                     COMP-3.
  2892         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2893                                     COMP-3.
  2894         16  FILLER                PIC X(12).
  2895
  2896***************    OUTPUT FROM ELRAMT   *************************
  2897
  2898         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2899                                     COMP-3.
  2900         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2901                                     COMP-3.
  2902         16  FILLER                PIC X(12).
  2903
  2904***************    OUTPUT FROM ELRATE   *************************
  2905
  2906         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2907                                     COMP-3.
  2908         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2909                                     COMP-3.
  2910         16  CP-MORTALITY-CODE     PIC X(4).
  2911         16  CP-RATE-EDIT-FLAG     PIC X.
  2912             88  CP-RATES-NEED-APR                  VALUE '1'.
  2913         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2914                                     COMP-3.
  2915         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  55
* EL131.cbl
  2916         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2917         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2918                                   PIC S9(7)V99 COMP-3.
  2919         16  FILLER                PIC X(07).
  2920
  2921***************    OUTPUT FROM ELRFND   *************************
  2922
  2923         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2924                                     COMP-3.
  2925         16  CP-REFUND-TYPE-USED   PIC X.
  2926           88  CP-R-AS-R78                         VALUE '1'.
  2927           88  CP-R-AS-PRORATA                     VALUE '2'.
  2928           88  CP-R-AS-CALIF                       VALUE '3'.
  2929           88  CP-R-AS-TEXAS                       VALUE '4'.
  2930           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2931           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2932           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2933           88  CP-R-AS-MEAN                        VALUE '8'.
  2934           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2935           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2936           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2937           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2938           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2939           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2940         16  FILLER                PIC X(12).
  2941
  2942***************    OUTPUT FROM ELEARN   *************************
  2943
  2944         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2945                                     COMP-3.
  2946         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2947                                     COMP-3.
  2948         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2949                                     COMP-3.
  2950         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2951                                     COMP-3.
  2952         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2953                                     COMP-3.
  2954         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2955                                     COMP-3.
  2956         16  CP-EARNING-TYPE-USED  PIC X.
  2957           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2958           88  CP-E-AS-R78                         VALUE '1'.
  2959           88  CP-E-AS-PRORATA                     VALUE '2'.
  2960           88  CP-E-AS-TEXAS                       VALUE '4'.
  2961           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2962           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2963           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2964           88  CP-E-AS-MEAN                        VALUE '8'.
  2965           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2966         16  FILLER                PIC X(12).
  2967
  2968***************    OUTPUT FROM ELPMNT   *************************
  2969
  2970         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2971                                     COMP-3.
  2972         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2973                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  56
* EL131.cbl
  2974         16  FILLER                PIC X(12).
  2975
  2976***************   MISC WORK AREAS    *****************************
  2977         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2978                                     COMP-3.
  2979         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2980                                     COMP-3.
  2981         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2982                                     COMP-3.
  2983         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2984                                     COMP-3.
  2985         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2986                                     COMP-3.
  2987         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2988                                     COMP-3.
  2989         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2990             88  OPEN-RATE-FILE                   VALUE 'O'.
  2991             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2992             88  IO-ERROR                         VALUE 'E'.
  2993
  2994         16  CP-FIRST-PAY-DATE     PIC XX.
  2995
  2996         16  CP-JOINT-INDICATOR    PIC X.
  2997
  2998         16  CP-RESERVE-REMAINING-TERM
  2999                                   PIC S9(4)V9    VALUE ZERO
  3000                                     COMP-3.
  3001
  3002         16  CP-INSURED-BIRTH-DT   PIC XX.
  3003
  3004         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3005                                     COMP-3.
  3006
  3007         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3008                                     COMP-3.
  3009
  3010         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3011                                     COMP-3.
  3012
  3013         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3014                                     COMP-3.
  3015
  3016         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3017                                     COMP-3.
  3018
  3019         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3020                                     COMP-3.
  3021
  3022         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3023                                     COMP-3.
  3024
  3025         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3026             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3027
  3028         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3029                                     COMP-3.
  3030         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3031                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  57
* EL131.cbl
  3032         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3033         16  cp-extra-periods      pic 9 value zeros.
  3034         16  cp-net-only-state     pic x value spaces.
  3035         16  FILLER                PIC X(13).
  3036******************************************************************
  3037
  3038*                                COPY ELCDATE.
  3039******************************************************************
  3040*                                                                *
  3041*                                                                *
  3042*                            ELCDATE.                            *
  3043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3044*                            VMOD=2.003
  3045*                                                                *
  3046*                                                                *
  3047*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3048*                 LENGTH = 200                                   *
  3049******************************************************************
  3050
  3051 01  DATE-CONVERSION-DATA.
  3052     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3053     12  DC-OPTION-CODE                PIC X.
  3054         88  BIN-TO-GREG                VALUE ' '.
  3055         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3056         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3057         88  YMD-GREG-TO-BIN            VALUE '3'.
  3058         88  MDY-GREG-TO-BIN            VALUE '4'.
  3059         88  JULIAN-TO-BIN              VALUE '5'.
  3060         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3061         88  FIND-CENTURY               VALUE '7'.
  3062         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3063         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3064         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3065         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3066         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3067         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3068         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3069         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3070         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3071         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3072         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3073         88  BIN-3-TO-GREG              VALUE 'I'.
  3074         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3075         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3076         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3077         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3078         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3079         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3080         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3081         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3082         88  THREE-CHARACTER-BIN
  3083                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3084         88  GREGORIAN-TO-BIN
  3085                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3086         88  BIN-TO-GREGORIAN
  3087                  VALUES ' ' '1' 'I' '8' 'G'.
  3088         88  JULIAN-TO-BINARY
  3089                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  58
* EL131.cbl
  3090     12  DC-ERROR-CODE                 PIC X.
  3091         88  NO-CONVERSION-ERROR        VALUE ' '.
  3092         88  DATE-CONVERSION-ERROR
  3093                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3094         88  DATE-IS-ZERO               VALUE '1'.
  3095         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3096         88  DATE-IS-INVALID            VALUE '3'.
  3097         88  DATE1-GREATER-DATE2        VALUE '4'.
  3098         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3099         88  DATE-INVALID-OPTION        VALUE '9'.
  3100         88  INVALID-CENTURY            VALUE 'A'.
  3101         88  ONLY-CENTURY               VALUE 'B'.
  3102         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3103         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3104     12  DC-END-OF-MONTH               PIC X.
  3105         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3106     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3107         88  USE-NORMAL-PROCESS         VALUE ' '.
  3108         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3109         88  ADJUST-UP-100-YRS          VALUE '2'.
  3110     12  FILLER                        PIC X.
  3111     12  DC-CONVERSION-DATES.
  3112         16  DC-BIN-DATE-1             PIC XX.
  3113         16  DC-BIN-DATE-2             PIC XX.
  3114         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3115         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3116                       DC-GREG-DATE-1-EDIT.
  3117             20  DC-EDIT1-MONTH        PIC 99.
  3118             20  SLASH1-1              PIC X.
  3119             20  DC-EDIT1-DAY          PIC 99.
  3120             20  SLASH1-2              PIC X.
  3121             20  DC-EDIT1-YEAR         PIC 99.
  3122         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3123         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3124                     DC-GREG-DATE-2-EDIT.
  3125             20  DC-EDIT2-MONTH        PIC 99.
  3126             20  SLASH2-1              PIC X.
  3127             20  DC-EDIT2-DAY          PIC 99.
  3128             20  SLASH2-2              PIC X.
  3129             20  DC-EDIT2-YEAR         PIC 99.
  3130         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3131         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3132                     DC-GREG-DATE-1-YMD.
  3133             20  DC-YMD-YEAR           PIC 99.
  3134             20  DC-YMD-MONTH          PIC 99.
  3135             20  DC-YMD-DAY            PIC 99.
  3136         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3137         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3138                      DC-GREG-DATE-1-MDY.
  3139             20  DC-MDY-MONTH          PIC 99.
  3140             20  DC-MDY-DAY            PIC 99.
  3141             20  DC-MDY-YEAR           PIC 99.
  3142         16  DC-GREG-DATE-1-ALPHA.
  3143             20  DC-ALPHA-MONTH        PIC X(10).
  3144             20  DC-ALPHA-DAY          PIC 99.
  3145             20  FILLER                PIC XX.
  3146             20  DC-ALPHA-CENTURY.
  3147                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  59
* EL131.cbl
  3148             20  DC-ALPHA-YEAR         PIC 99.
  3149         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3150         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3151         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3152         16  DC-JULIAN-DATE            PIC 9(05).
  3153         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3154                                       PIC 9(05).
  3155         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3156             20  DC-JULIAN-YEAR        PIC 99.
  3157             20  DC-JULIAN-DAYS        PIC 999.
  3158         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3159         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3160         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3161     12  DATE-CONVERSION-VARIBLES.
  3162         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3163         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3164             20  FILLER                PIC 9(3).
  3165             20  HOLD-CEN-1-CCYY.
  3166                 24  HOLD-CEN-1-CC     PIC 99.
  3167                 24  HOLD-CEN-1-YY     PIC 99.
  3168             20  HOLD-CEN-1-MO         PIC 99.
  3169             20  HOLD-CEN-1-DA         PIC 99.
  3170         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3171             20  HOLD-CEN-1-R-MO       PIC 99.
  3172             20  HOLD-CEN-1-R-DA       PIC 99.
  3173             20  HOLD-CEN-1-R-CCYY.
  3174                 24  HOLD-CEN-1-R-CC   PIC 99.
  3175                 24  HOLD-CEN-1-R-YY   PIC 99.
  3176             20  FILLER                PIC 9(3).
  3177         16  HOLD-CENTURY-1-X.
  3178             20  FILLER                PIC X(3)  VALUE SPACES.
  3179             20  HOLD-CEN-1-X-CCYY.
  3180                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3181                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3182             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3183             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3184         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3185             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3186             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3187             20  HOLD-CEN-1-R-X-CCYY.
  3188                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3189                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3190             20  FILLER                PIC XXX.
  3191         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3192         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3193         16  DC-JULIAN-DATE-1          PIC 9(07).
  3194         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3195             20  DC-JULIAN-1-CCYY.
  3196                 24  DC-JULIAN-1-CC    PIC 99.
  3197                 24  DC-JULIAN-1-YR    PIC 99.
  3198             20  DC-JULIAN-DA-1        PIC 999.
  3199         16  DC-JULIAN-DATE-2          PIC 9(07).
  3200         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3201             20  DC-JULIAN-2-CCYY.
  3202                 24  DC-JULIAN-2-CC    PIC 99.
  3203                 24  DC-JULIAN-2-YR    PIC 99.
  3204             20  DC-JULIAN-DA-2        PIC 999.
  3205         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  60
* EL131.cbl
  3206             20  DC-EDITA-MONTH        PIC 99.
  3207             20  SLASHA-1              PIC X VALUE '/'.
  3208             20  DC-EDITA-DAY          PIC 99.
  3209             20  SLASHA-2              PIC X VALUE '/'.
  3210             20  DC-EDITA-CCYY.
  3211                 24  DC-EDITA-CENT     PIC 99.
  3212                 24  DC-EDITA-YEAR     PIC 99.
  3213         16  DC-GREG-DATE-B-EDIT.
  3214             20  DC-EDITB-MONTH        PIC 99.
  3215             20  SLASHB-1              PIC X VALUE '/'.
  3216             20  DC-EDITB-DAY          PIC 99.
  3217             20  SLASHB-2              PIC X VALUE '/'.
  3218             20  DC-EDITB-CCYY.
  3219                 24  DC-EDITB-CENT     PIC 99.
  3220                 24  DC-EDITB-YEAR     PIC 99.
  3221         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3222         16  DC-GREG-DATE-CYMD-R REDEFINES
  3223                              DC-GREG-DATE-CYMD.
  3224             20  DC-CYMD-CEN           PIC 99.
  3225             20  DC-CYMD-YEAR          PIC 99.
  3226             20  DC-CYMD-MONTH         PIC 99.
  3227             20  DC-CYMD-DAY           PIC 99.
  3228         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3229         16  DC-GREG-DATE-MDCY-R REDEFINES
  3230                              DC-GREG-DATE-MDCY.
  3231             20  DC-MDCY-MONTH         PIC 99.
  3232             20  DC-MDCY-DAY           PIC 99.
  3233             20  DC-MDCY-CEN           PIC 99.
  3234             20  DC-MDCY-YEAR          PIC 99.
  3235    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3236        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3237    12  DC-EL310-DATE                  PIC X(21).
  3238    12  FILLER                         PIC X(28).
  3239
  3240*                                COPY ELCDMO.
  3241******************************************************************
  3242*                                                                *
  3243*                                                                *
  3244*                            ELCDMO.                             *
  3245*                            VMOD=2.004                          *
  3246*                                                                *
  3247*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3248*        COMMUNICATION AREA                                      *
  3249*   FILE TYPE = NA                                               *
  3250*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3251*                                                                *
  3252******************************************************************
  3253 01  DMO-COMMUNICATION-AREA.
  3254     12  DM-RECORD-TYPE                  PIC  X(02).
  3255             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3256             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3257             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3258     12  DM-DIST-CODE                    PIC  X(04).
  3259     12  DM-MAIL-CODE                    PIC  X(05).
  3260     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3261     12  DM-INSURED-NAME                 PIC  X(30).
  3262     12  DM-CLAIM-NO                     PIC  X(07).
  3263     12  DM-CLAIM-TYPE                   PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  61
* EL131.cbl
  3264
  3265     12  DM-STATUS-DATA-AREA.
  3266         16  DM-CLAIM-STATUS             PIC  X.
  3267             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3268             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3269             88  DM-CLOSED                        VALUE '3'.
  3270             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3271             88  DM-DEFAULT                       VALUE '9'.
  3272         16  DM-STATUS-DATE              PIC  X(08).
  3273******YYYYMMDD
  3274         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3275             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3276             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3277             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3278             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3279             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3280             88  DM-RE-OPENED                     VALUE 'R'.
  3281             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3282             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3283             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3284         16  DM-STAT-CARRIER             PIC X.
  3285
  3286     12  DM-DRAFT-DATA-AREA.
  3287         16  DM-PAYMENT-TYPE             PIC  X.
  3288             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3289         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3290         16  DM-PAYMENT-DATE             PIC  X(08).
  3291******YYYYMMDD
  3292         16  DM-CERT-NO                  PIC  X(11).
  3293         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3294         16  DM-CARRIER                  PIC  X.
  3295
  3296     12  DM-RETURN-CODE                  PIC  XX.
  3297*                                COPY ERCPDEF.
  3298******************************************************************
  3299*                                                                *
  3300*                                                                *
  3301*                            ERCPDEF.                            *
  3302*                                                                *
  3303*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3304*                                                                *
  3305*    FILE TYPE = VSAM,KSDS                                       *
  3306*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3307*                                                                *
  3308*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3309*                                                                *
  3310*    LOG = YES                                                   *
  3311*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3312******************************************************************
  3313*                   C H A N G E   L O G
  3314*
  3315* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3316*-----------------------------------------------------------------
  3317*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3318* EFFECTIVE    NUMBER
  3319*-----------------------------------------------------------------
  3320* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3321* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  62
* EL131.cbl
  3322* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3323******************************************************************
  3324 01  PRODUCT-MASTER.
  3325    12  PD-RECORD-ID                 PIC X(02).
  3326        88  VALID-PD-ID                  VALUE 'PD'.
  3327    12  PD-CONTROL-PRIMARY.
  3328        16  PD-COMPANY-CD            PIC X.
  3329        16  PD-STATE                 PIC XX.
  3330        16  PD-PRODUCT-CD            PIC XXX.
  3331        16  PD-FILLER                PIC X(7).
  3332        16  PD-BEN-TYPE              PIC X.
  3333        16  PD-BEN-CODE              PIC XX.
  3334        16  PD-PROD-EXP-DT           PIC XX.
  3335    12  FILLER                       PIC X(50).
  3336    12  PD-PRODUCT-DATA OCCURS 8.
  3337        16  PD-PROD-CODE             PIC X.
  3338            88  PD-PROD-LIFE           VALUE 'L'.
  3339            88  PD-PROD-PROP           VALUE 'P'.
  3340            88  PD-PROD-AH             VALUE 'A'.
  3341            88  PD-PROD-IU             VALUE 'I'.
  3342            88  PD-PROD-GAP            VALUE 'G'.
  3343            88  PD-PROD-FAML           VALUE 'F'.
  3344        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3345        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3346        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3347        16  PD-MAX-TERM              PIC S999        COMP-3.
  3348        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3349        16  FILLER                   PIC X.
  3350        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3351        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3352        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3353        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3354        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3355        16  PD-REC-CRIT-PERIOD       PIC 99.
  3356        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3357            20  PD-RECURRING-YN      PIC X.
  3358            20  FILLER               PIC X.
  3359        16  PD-RTW-MOS               PIC 99.
  3360        16  PD-MAX-EXTENSION         PIC 99.
  3361        16  pd-ben-pct               pic sv999 comp-3.
  3362*       16  FILLER                   PIC XX.
  3363    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3364    12  PD-TERM-LIMITS OCCURS 15.
  3365        16  PD-LOW-TERM              PIC S999        COMP-3.
  3366        16  PD-HI-TERM               PIC S999        COMP-3.
  3367*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3368    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3369        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3370        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3371    12  PD-EARN-FACTORS.
  3372        16  FILLER OCCURS 15.
  3373            20  FILLER OCCURS 15.
  3374                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3375    12  PD-PRODUCT-DESC              PIC X(80).
  3376    12  PD-TRUNCATED                 PIC X.
  3377    12  FILLER                       PIC X(59).
  3378    12  PD-MAINT-INFORMATION.
  3379        16  PD-LAST-MAINT-DT         PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  63
* EL131.cbl
  3380        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3381        16  PD-LAST-MAINT-BY         PIC X(04).
  3382*                                COPY ELCCRTT.
  3383******************************************************************
  3384*                                                                *
  3385*                            ELCCRTT.                            *
  3386*                                                                *
  3387*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3388*                                                                *
  3389*   FILE TYPE = VSAM,KSDS                                        *
  3390*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3391*                                                                *
  3392*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3393*                                                                *
  3394*   LOG = YES                                                    *
  3395*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3396******************************************************************
  3397*                   C H A N G E   L O G
  3398*
  3399* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3400*-----------------------------------------------------------------
  3401*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3402* EFFECTIVE    NUMBER
  3403*-----------------------------------------------------------------
  3404* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3405* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3406* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3407* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3408* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3409* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3410* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3411* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3412* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3413******************************************************************
  3414
  3415 01  CERTIFICATE-TRAILERS.
  3416     12  CS-RECORD-ID                      PIC XX.
  3417         88  VALID-CS-ID                      VALUE 'CS'.
  3418
  3419     12  CS-CONTROL-PRIMARY.
  3420         16  CS-COMPANY-CD                 PIC X.
  3421         16  CS-CARRIER                    PIC X.
  3422         16  CS-GROUPING                   PIC X(6).
  3423         16  CS-STATE                      PIC XX.
  3424         16  CS-ACCOUNT                    PIC X(10).
  3425         16  CS-CERT-EFF-DT                PIC XX.
  3426         16  CS-CERT-NO.
  3427             20  CS-CERT-PRIME             PIC X(10).
  3428             20  CS-CERT-SFX               PIC X.
  3429         16  CS-TRAILER-TYPE               PIC X.
  3430             88  COMM-TRLR           VALUE 'A'.
  3431             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3432             88  CERT-DATA-TRLR      VALUE 'C'.
  3433
  3434     12  CS-DATA-AREA                      PIC X(516).
  3435
  3436     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3437         16  CS-BANK-COMMISSION-AREA.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  64
* EL131.cbl
  3438             20  CS-BANK-COMMS       OCCURS 10.
  3439                 24  CS-AGT                PIC X(10).
  3440                 24  CS-COM-TYP            PIC X.
  3441                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3442                 24  CS-RECALC-LV-INDIC    PIC X.
  3443                 24  FILLER                PIC X(10).
  3444         16  FILLER                        PIC X(256).
  3445
  3446     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3447****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3448         16  CS-MB-CLAIM-DATA OCCURS 24.
  3449             20  CS-CLAIM-NO               PIC X(7).
  3450             20  CS-CLAIM-TYPE             PIC X.
  3451                 88  CS-AH-CLM               VALUE 'A'.
  3452                 88  CS-IU-CLM               VALUE 'I'.
  3453                 88  CS-GP-CLM               VALUE 'G'.
  3454                 88  CS-LF-CLM               VALUE 'L'.
  3455                 88  CS-PR-CLM               VALUE 'P'.
  3456                 88  CS-FL-CLM               VALUE 'F'.
  3457             20  CS-INSURED-TYPE           PIC X.
  3458                 88  CS-PRIM-INSURED          VALUE 'P'.
  3459                 88  CS-CO-BORROWER           VALUE 'C'.
  3460             20  CS-BENEFIT-PERIOD         PIC 99.
  3461             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3462             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3463             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3464         16  FILLER                        PIC X(12).
  3465     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3466         16  CS-VIN-NUMBER                 PIC X(17).
  3467         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3468         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3469         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3470         16  cs-agent-name.
  3471             20  cs-agent-fname            pic x(20).
  3472             20  cs-agent-mi               pic x.
  3473             20  cs-agent-lname            pic x(25).
  3474         16  cs-license-no                 pic x(15).
  3475         16  cs-npn-number                 pic x(10).
  3476         16  cs-agent-edit-status          pic x.
  3477             88  cs-ae-refer-to-manager      value 'M'.
  3478             88  cs-ae-cover-sheet           value 'C'.
  3479             88  cs-ae-sig-form              value 'S'.
  3480             88  cs-ae-verified              value 'V'.
  3481             88  cs-unidentified-signature   value 'U'.
  3482             88  cs-cert-returned            value 'R'.
  3483             88  cs-accept-no-commission     value 'N'.
  3484         16  cs-year                       pic 9999.
  3485         16  cs-make                       pic x(20).
  3486         16  cs-model                      pic x(20).
  3487         16  cs-future                     pic x(20).
  3488         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3489         16  FILLER                        PIC X(356). *> was 420
  3490*        16  FILLER                        PIC X(496).
  3491
  3492****************************************************************
  3493*
  3494* Copyright (c) 2007 by Clerity Solutions, Inc.
  3495* All rights reserved.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  65
* EL131.cbl
  3496*
  3497****************************************************************
  3498 01  DFHEIV.
  3499   02  DFHEIV0               PIC X(35).
  3500   02  DFHEIV1               PIC X(08).
  3501   02  DFHEIV2               PIC X(08).
  3502   02  DFHEIV3               PIC X(08).
  3503   02  DFHEIV4               PIC X(06).
  3504   02  DFHEIV5               PIC X(04).
  3505   02  DFHEIV6               PIC X(04).
  3506   02  DFHEIV7               PIC X(02).
  3507   02  DFHEIV8               PIC X(02).
  3508   02  DFHEIV9               PIC X(01).
  3509   02  DFHEIV10              PIC S9(7) COMP-3.
  3510   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3511   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3512   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3513   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3514   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3515   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3516   02  DFHEIV17              PIC X(04).
  3517   02  DFHEIV18              PIC X(04).
  3518   02  DFHEIV19              PIC X(04).
  3519   02  DFHEIV20              USAGE IS POINTER.
  3520   02  DFHEIV21              USAGE IS POINTER.
  3521   02  DFHEIV22              USAGE IS POINTER.
  3522   02  DFHEIV23              USAGE IS POINTER.
  3523   02  DFHEIV24              USAGE IS POINTER.
  3524   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3525   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3526   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3527   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3528   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3529   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3530   02  FILLER                PIC X(02).
  3531   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3532   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3533   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3534   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3535   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3536 LINKAGE  SECTION.
  3537*****************************************************************
  3538*                                                               *
  3539* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3540* All rights reserved.                                          *
  3541*                                                               *
  3542*****************************************************************
  3543 01  dfheiblk.
  3544     02  eibtime          pic s9(7) comp-3.
  3545     02  eibdate          pic s9(7) comp-3.
  3546     02  eibtrnid         pic x(4).
  3547     02  eibtaskn         pic s9(7) comp-3.
  3548     02  eibtrmid         pic x(4).
  3549     02  dfheigdi         pic s9(4) comp.
  3550     02  eibcposn         pic s9(4) comp.
  3551     02  eibcalen         pic s9(4) comp.
  3552     02  eibaid           pic x(1).
  3553     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  66
* EL131.cbl
  3554     02  eibfn            pic x(2).
  3555     02  eibfiller2       pic x(2).
  3556     02  eibrcode         pic x(6).
  3557     02  eibfiller3       pic x(2).
  3558     02  eibds            pic x(8).
  3559     02  eibreqid         pic x(8).
  3560     02  eibrsrce         pic x(8).
  3561     02  eibsync          pic x(1).
  3562     02  eibfree          pic x(1).
  3563     02  eibrecv          pic x(1).
  3564     02  eibsend          pic x(1).
  3565     02  eibatt           pic x(1).
  3566     02  eibeoc           pic x(1).
  3567     02  eibfmh           pic x(1).
  3568     02  eibcompl         pic x(1).
  3569     02  eibsig           pic x(1).
  3570     02  eibconf          pic x(1).
  3571     02  eiberr           pic x(1).
  3572     02  eibrldbk         pic x(1).
  3573     02  eiberrcd         pic x(4).
  3574     02  eibsynrb         pic x(1).
  3575     02  eibnodat         pic x(1).
  3576     02  eibfiller5       pic x(2).
  3577     02  eibresp          pic 9(09) comp.
  3578     02  eibresp2         pic 9(09) comp.
  3579     02  dfheigdj         pic s9(4) comp.
  3580     02  dfheigdk         pic s9(4) comp.
  3581 01  DFHCOMMAREA                 PIC X(1024).
  3582
  3583*                                COPY ELCMSTR.
  3584******************************************************************
  3585*                                                                *
  3586*                            ELCMSTR.                            *
  3587*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3588*                            VMOD=2.012                          *
  3589*                                                                *
  3590*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3591*                                                                *
  3592*   FILE TYPE = VSAM,KSDS                                        *
  3593*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3594*                                                                *
  3595*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3596*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3597*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3598*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3599*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3600*                                                 RKP=75,LEN=21  *
  3601*                                                                *
  3602*   **** NOTE ****                                               *
  3603*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3604*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3605*                                                                *
  3606*   LOG = YES                                                    *
  3607*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3608******************************************************************
  3609*                   C H A N G E   L O G
  3610*
  3611* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  67
* EL131.cbl
  3612*-----------------------------------------------------------------
  3613*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3614* EFFECTIVE    NUMBER
  3615*-----------------------------------------------------------------
  3616* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3617* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3618* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3619* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3620* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3621******************************************************************
  3622 01  CLAIM-MASTER.
  3623     12  CL-RECORD-ID                PIC XX.
  3624         88  VALID-CL-ID         VALUE 'CL'.
  3625
  3626     12  CL-CONTROL-PRIMARY.
  3627         16  CL-COMPANY-CD           PIC X.
  3628         16  CL-CARRIER              PIC X.
  3629         16  CL-CLAIM-NO             PIC X(7).
  3630         16  CL-CERT-NO.
  3631             20  CL-CERT-PRIME       PIC X(10).
  3632             20  CL-CERT-SFX         PIC X.
  3633
  3634     12  CL-CONTROL-BY-NAME.
  3635         16  CL-COMPANY-CD-A1        PIC X.
  3636         16  CL-INSURED-LAST-NAME    PIC X(15).
  3637         16  CL-INSURED-NAME.
  3638             20  CL-INSURED-1ST-NAME PIC X(12).
  3639             20  CL-INSURED-MID-INIT PIC X.
  3640
  3641     12  CL-CONTROL-BY-SSN.
  3642         16  CL-COMPANY-CD-A2        PIC X.
  3643         16  CL-SOC-SEC-NO.
  3644             20  CL-SSN-STATE        PIC XX.
  3645             20  CL-SSN-ACCOUNT      PIC X(6).
  3646             20  CL-SSN-LN3          PIC X(3).
  3647
  3648     12  CL-CONTROL-BY-CERT-NO.
  3649         16  CL-COMPANY-CD-A4        PIC X.
  3650         16  CL-CERT-NO-A4.
  3651             20  CL-CERT-A4-PRIME    PIC X(10).
  3652             20  CL-CERT-A4-SFX      PIC X.
  3653
  3654     12  CL-CONTROL-BY-CCN.
  3655         16  CL-COMPANY-CD-A5        PIC X.
  3656         16  CL-CCN-A5.
  3657             20  CL-CCN.
  3658                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3659                 24  CL-CCN-PRIME-A5 PIC X(12).
  3660             20  CL-CCN-FILLER-A5    PIC X(4).
  3661
  3662     12  CL-INSURED-PROFILE-DATA.
  3663         16  CL-INSURED-BIRTH-DT     PIC XX.
  3664         16  CL-INSURED-SEX-CD       PIC X.
  3665             88  INSURED-IS-MALE        VALUE 'M'.
  3666             88  INSURED-IS-FEMALE      VALUE 'F'.
  3667             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3668         16  CL-INSURED-OCC-CD       PIC X(6).
  3669         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  68
* EL131.cbl
  3670
  3671     12  CL-PROCESSING-INFO.
  3672         16  CL-PROCESSOR-ID         PIC X(4).
  3673         16  CL-CLAIM-STATUS         PIC X.
  3674             88  CLAIM-IS-OPEN          VALUE 'O'.
  3675             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3676         16  CL-CLAIM-TYPE           PIC X.
  3677*            88  AH-CLAIM               VALUE 'A'.
  3678*            88  LIFE-CLAIM             VALUE 'L'.
  3679*            88  PROPERTY-CLAIM         VALUE 'P'.
  3680*            88  IUI-CLAIM              VALUE 'I'.
  3681*            88  GAP-CLAIM              VALUE 'G'.
  3682*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3683         16  CL-CLAIM-PREM-TYPE      PIC X.
  3684             88  SINGLE-PREMIUM         VALUE '1'.
  3685             88  O-B-COVERAGE           VALUE '2'.
  3686             88  OPEN-END-COVERAGE      VALUE '3'.
  3687         16  CL-INCURRED-DT          PIC XX.
  3688         16  CL-REPORTED-DT          PIC XX.
  3689         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3690         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3691         16  CL-LAST-PMT-DT          PIC XX.
  3692         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3693         16  CL-PAID-THRU-DT         PIC XX.
  3694         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3695         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3696         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3697         16  CL-PMT-CALC-METHOD      PIC X.
  3698             88  CL-360-DAY-YR          VALUE '1'.
  3699             88  CL-365-DAY-YR          VALUE '2'.
  3700             88  CL-FULL-MONTHS         VALUE '3'.
  3701         16  CL-CAUSE-CD             PIC X(6).
  3702
  3703         16  CL-PRIME-CERT-NO.
  3704             20  CL-PRIME-CERT-PRIME PIC X(10).
  3705             20  CL-PRIME-CERT-SFX   PIC X.
  3706
  3707         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3708             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3709             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3710
  3711         16  CL-MICROFILM-NO         PIC X(10).
  3712         16  FILLER REDEFINES CL-MICROFILM-NO.
  3713             20  CL-BENEFIT-PERIOD   PIC 99.
  3714             20  FILLER              PIC X(8).
  3715         16  CL-PROG-FORM-TYPE       PIC X.
  3716         16  CL-LAST-ADD-ON-DT       PIC XX.
  3717
  3718         16  CL-LAST-REOPEN-DT       PIC XX.
  3719         16  CL-LAST-CLOSE-DT        PIC XX.
  3720         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3721             88  FINAL-PAID             VALUE '1'.
  3722             88  CLAIM-DENIED           VALUE '2'.
  3723             88  AUTO-CLOSE             VALUE '3'.
  3724             88  MANUAL-CLOSE           VALUE '4'.
  3725             88  BENEFITS-CHANGED       VALUE 'C'.
  3726             88  SETUP-ERRORS           VALUE 'E'.
  3727         16  CL-ASSOC-CERT-SEQU      PIC S99.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  69
* EL131.cbl
  3728         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3729         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3730             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3731         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3732         16  FILLER                  PIC X.
  3733
  3734     12  CL-CERTIFICATE-DATA.
  3735         16  CL-CERT-ORIGIN          PIC X.
  3736             88  CERT-WAS-ONLINE        VALUE '1'.
  3737             88  CERT-WAS-CREATED       VALUE '2'.
  3738             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3739         16  CL-CERT-KEY-DATA.
  3740             20  CL-CERT-CARRIER     PIC X.
  3741             20  CL-CERT-GROUPING    PIC X(6).
  3742             20  CL-CERT-STATE       PIC XX.
  3743             20  CL-CERT-ACCOUNT.
  3744                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3745                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3746             20  CL-CERT-EFF-DT      PIC XX.
  3747
  3748     12  CL-STATUS-CONTROLS.
  3749         16  CL-PRIORITY-CD          PIC X.
  3750             88  CONFIDENTIAL-DATA      VALUE '8'.
  3751             88  HIGHEST-PRIORITY       VALUE '9'.
  3752         16  CL-SUPV-ATTN-CD         PIC X.
  3753             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3754             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3755         16  CL-PURGED-DT            PIC XX.
  3756         16  CL-RESTORED-DT          PIC XX.
  3757         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3758         16  CL-NEXT-RESEND-DT       PIC XX.
  3759         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3760         16  CL-CRITICAL-PERIOD      PIC 99.
  3761*        16  FILLER                  PIC XX.
  3762         16  CL-LAST-MAINT-DT        PIC XX.
  3763         16  CL-LAST-MAINT-USER      PIC X(4).
  3764         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3765         16  CL-LAST-MAINT-TYPE      PIC X.
  3766             88  CLAIM-SET-UP           VALUE ' '.
  3767             88  PAYMENT-MADE           VALUE '1'.
  3768             88  LETTER-SENT            VALUE '2'.
  3769             88  MASTER-WAS-ALTERED     VALUE '3'.
  3770             88  MASTER-WAS-RESTORED    VALUE '4'.
  3771             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3772             88  FILE-CONVERTED         VALUE '6'.
  3773             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3774             88  ERROR-CORRECTION       VALUE 'E'.
  3775         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3776         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3777         16  CL-BENEFICIARY          PIC X(10).
  3778         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3779         16  CL-DENIAL-TYPE          PIC X.
  3780             88  CL-TYPE-DENIAL          VALUE '1'.
  3781             88  CL-TYPE-RESCISSION      VALUE '2'.
  3782             88  CL-TYPE-REFORMATION     VALUE '3'.
  3783             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3784             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3785         16  filler                  pic x(5).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  70
* EL131.cbl
  3786*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3787*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3788*        16  CL-RTW-DT               PIC XX.
  3789
  3790     12  CL-TRAILER-CONTROLS.
  3791         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3792             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3793             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3794             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3795         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3796         16  FILLER                  PIC XX.
  3797         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3798         16  CL-ADDRESS-TRAILER-CNT.
  3799             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3800                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3801             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3802                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3803             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3804                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3805             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3806                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3807             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3808                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3809             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3810                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3811             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3812                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3813
  3814     12  CL-CV-REFERENCE-NO.
  3815         16  CL-CV-REFNO-PRIME       PIC X(18).
  3816         16  CL-CV-REFNO-SFX         PIC XX.
  3817
  3818     12  CL-FILE-LOCATION            PIC X(4).
  3819
  3820     12  CL-PROCESS-ERRORS.
  3821         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3822             88  NO-FATAL-ERRORS        VALUE ZERO.
  3823         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3824             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3825
  3826     12  CL-PRODUCT-CD               PIC X.
  3827
  3828     12  CL-CURRENT-KEY-DATA.
  3829         16  CL-CURRENT-CARRIER      PIC X.
  3830         16  CL-CURRENT-GROUPING     PIC X(6).
  3831         16  CL-CURRENT-STATE        PIC XX.
  3832         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3833
  3834     12  CL-ASSOCIATES               PIC X.
  3835         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3836         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3837         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3838         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3839
  3840     12  CL-ACTIVITY-CODE            PIC 99.
  3841     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3842     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3843
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  71
* EL131.cbl
  3844     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3845     12  CL-LAG-REPORT-CODE          PIC 9.
  3846     12  CL-LOAN-TYPE                PIC XX.
  3847     12  CL-LEGAL-STATE              PIC XX.
  3848
  3849     12  CL-YESNOSW                  PIC X.
  3850     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3851         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3852         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3853         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3854     12  cl-insured-type             pic x.
  3855         88  cl-claim-on-primary         value 'P'.
  3856         88  cl-claim-on-co-borrower     value 'C'.
  3857     12  cl-benefit-expiration-dt    PIC XX.
  3858
  3859*                                COPY ELCCERT.
  3860******************************************************************
  3861*                                                                *
  3862*                            ELCCERT.                            *
  3863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3864*                            VMOD=2.013                          *
  3865*                                                                *
  3866*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3867*                                                                *
  3868*   FILE TYPE = VSAM,KSDS                                        *
  3869*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3870*                                                                *
  3871*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3872*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3873*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3874*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3875*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3876*                                                                *
  3877*   LOG = YES                                                    *
  3878*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3879******************************************************************
  3880*                   C H A N G E   L O G
  3881*
  3882* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3883*-----------------------------------------------------------------
  3884*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3885* EFFECTIVE    NUMBER
  3886*-----------------------------------------------------------------
  3887* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3888* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3889* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3890* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3891* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3892* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3893* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3894* 032612  CR2011110200001  PEMA  AHL CHANGES
  3895* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3896* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3897******************************************************************
  3898
  3899 01  CERTIFICATE-MASTER.
  3900     12  CM-RECORD-ID                      PIC XX.
  3901         88  VALID-CM-ID                      VALUE 'CM'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  72
* EL131.cbl
  3902
  3903     12  CM-CONTROL-PRIMARY.
  3904         16  CM-COMPANY-CD                 PIC X.
  3905         16  CM-CARRIER                    PIC X.
  3906         16  CM-GROUPING.
  3907             20  CM-GROUPING-PREFIX        PIC X(3).
  3908             20  CM-GROUPING-PRIME         PIC X(3).
  3909         16  CM-STATE                      PIC XX.
  3910         16  CM-ACCOUNT.
  3911             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3912             20  CM-ACCOUNT-PRIME          PIC X(6).
  3913         16  CM-CERT-EFF-DT                PIC XX.
  3914         16  CM-CERT-NO.
  3915             20  CM-CERT-PRIME             PIC X(10).
  3916             20  CM-CERT-SFX               PIC X.
  3917
  3918     12  CM-CONTROL-BY-NAME.
  3919         16  CM-COMPANY-CD-A1              PIC X.
  3920         16  CM-INSURED-LAST-NAME          PIC X(15).
  3921         16  CM-INSURED-INITIALS.
  3922             20  CM-INSURED-INITIAL1       PIC X.
  3923             20  CM-INSURED-INITIAL2       PIC X.
  3924
  3925     12  CM-CONTROL-BY-SSN.
  3926         16  CM-COMPANY-CD-A2              PIC X.
  3927         16  CM-SOC-SEC-NO.
  3928             20  CM-SSN-STATE              PIC XX.
  3929             20  CM-SSN-ACCOUNT            PIC X(6).
  3930             20  CM-SSN-LN3.
  3931                 25  CM-INSURED-INITIALS-A2.
  3932                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3933                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3934                 25 CM-PART-LAST-NAME-A2         PIC X.
  3935
  3936     12  CM-CONTROL-BY-CERT-NO.
  3937         16  CM-COMPANY-CD-A4              PIC X.
  3938         16  CM-CERT-NO-A4                 PIC X(11).
  3939
  3940     12  CM-CONTROL-BY-MEMB.
  3941         16  CM-COMPANY-CD-A5              PIC X.
  3942         16  CM-MEMBER-NO.
  3943             20  CM-MEMB-STATE             PIC XX.
  3944             20  CM-MEMB-ACCOUNT           PIC X(6).
  3945             20  CM-MEMB-LN4.
  3946                 25  CM-INSURED-INITIALS-A5.
  3947                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3948                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3949                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3950
  3951     12  CM-INSURED-PROFILE-DATA.
  3952         16  CM-INSURED-FIRST-NAME.
  3953             20  CM-INSURED-1ST-INIT       PIC X.
  3954             20  FILLER                    PIC X(9).
  3955         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3956         16  CM-INSURED-SEX                PIC X.
  3957             88  CM-SEX-MALE                  VALUE 'M'.
  3958             88  CM-SEX-FEMAL                 VALUE 'F'.
  3959         16  CM-INSURED-JOINT-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  73
* EL131.cbl
  3960         16  CM-JOINT-INSURED-NAME.
  3961             20  CM-JT-LAST-NAME           PIC X(15).
  3962             20  CM-JT-FIRST-NAME.
  3963                 24  CM-JT-1ST-INIT        PIC X.
  3964                 24  FILLER                PIC X(9).
  3965             20  CM-JT-INITIAL             PIC X.
  3966
  3967     12  CM-LIFE-DATA.
  3968         16  CM-LF-BENEFIT-CD              PIC XX.
  3969         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3970         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3971         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3972         16  CM-LF-DEV-CODE                PIC XXX.
  3973         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3974         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3975         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3976         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3977         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3978         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3979         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3980         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3981         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3982         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3983         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3984         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3985         16  cm-temp-epiq                  pic xx.
  3986             88  EPIQ-CLASS                  value 'EQ'.
  3987*        16  FILLER                        PIC XX.
  3988
  3989     12  CM-AH-DATA.
  3990         16  CM-AH-BENEFIT-CD              PIC XX.
  3991         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3992         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3993         16  CM-AH-DEV-CODE                PIC XXX.
  3994         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3995         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3996         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3997         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3998         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3999         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4000         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4001         16  CM-AH-PAID-THRU-DT            PIC XX.
  4002             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4003         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4004         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4005         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4006         16  FILLER                        PIC X.
  4007
  4008     12  CM-LOAN-INFORMATION.
  4009         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4010         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4011                                           PIC S9(5)V99  COMP-3.
  4012         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4013         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4014         16  CM-PAY-FREQUENCY              PIC S99.
  4015         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4016         16  CM-RATE-CLASS                 PIC XX.
  4017         16  CM-BENEFICIARY                PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  74
* EL131.cbl
  4018         16  CM-POLICY-FORM-NO             PIC X(12).
  4019         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4020         16  CM-LAST-ADD-ON-DT             PIC XX.
  4021         16  CM-DEDUCTIBLE-AMOUNTS.
  4022             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4023             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4024         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4025             20  CM-RESIDENT-STATE         PIC XX.
  4026             20  CM-RATE-CODE              PIC X(4).
  4027             20  FILLER                    PIC XX.
  4028         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4029             20  CM-LOAN-OFFICER           PIC X(5).
  4030             20  FILLER                    PIC XXX.
  4031         16  CM-CSR-CODE                   PIC XXX.
  4032         16  CM-UNDERWRITING-CODE          PIC X.
  4033             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4034         16  CM-POST-CARD-IND              PIC X.
  4035         16  CM-NH-INTERFACE-SW            PIC X.
  4036         16  CM-PREMIUM-TYPE               PIC X.
  4037             88  CM-SING-PRM                  VALUE '1'.
  4038             88  CM-O-B-COVERAGE              VALUE '2'.
  4039             88  CM-OPEN-END                  VALUE '3'.
  4040         16  CM-IND-GRP-TYPE               PIC X.
  4041             88  CM-INDIVIDUAL                VALUE 'I'.
  4042             88  CM-GROUP                     VALUE 'G'.
  4043         16  CM-SKIP-CODE                  PIC X.
  4044             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4045             88  SKIP-JULY                    VALUE '1'.
  4046             88  SKIP-AUGUST                  VALUE '2'.
  4047             88  SKIP-SEPTEMBER               VALUE '3'.
  4048             88  SKIP-JULY-AUG                VALUE '4'.
  4049             88  SKIP-AUG-SEPT                VALUE '5'.
  4050             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4051             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4052             88  SKIP-JUNE                    VALUE '8'.
  4053             88  SKIP-JUNE-JULY               VALUE '9'.
  4054             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4055             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4056         16  CM-PAYMENT-MODE               PIC X.
  4057             88  PAY-MONTHLY                  VALUE SPACE.
  4058             88  PAY-WEEKLY                   VALUE '1'.
  4059             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4060             88  PAY-BI-WEEKLY                VALUE '3'.
  4061             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4062         16  CM-LOAN-NUMBER                PIC X(8).
  4063         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4064         16  CM-OLD-LOF                    PIC XXX.
  4065*        16  CM-LOAN-OFFICER               PIC XXX.
  4066         16  CM-REIN-TABLE                 PIC XXX.
  4067         16  CM-SPECIAL-REIN-CODE          PIC X.
  4068         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4069         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4070         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4071
  4072     12  CM-STATUS-DATA.
  4073         16  CM-ENTRY-STATUS               PIC X.
  4074         16  CM-ENTRY-DT                   PIC XX.
  4075
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  75
* EL131.cbl
  4076         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4077         16  CM-LF-CANCEL-DT               PIC XX.
  4078         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4079
  4080         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4081         16  CM-LF-DEATH-DT                PIC XX.
  4082         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4083
  4084         16  CM-LF-CURRENT-STATUS          PIC X.
  4085             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4086                                                'M' '4' '5' '9'.
  4087             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4088             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4089             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4090             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4091             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4092             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4093             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4094             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4095             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4096             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4097             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4098             88  CM-LF-DECLINED               VALUE 'D'.
  4099             88  CM-LF-VOIDED                 VALUE 'V'.
  4100
  4101         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4102         16  CM-AH-CANCEL-DT               PIC XX.
  4103         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4104
  4105         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4106         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4107         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4108
  4109         16  CM-AH-CURRENT-STATUS          PIC X.
  4110             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4111                                                'M' '4' '5' '9'.
  4112             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4113             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4114             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4115             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4116             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4117             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4118             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4119             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4120             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4121             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4122             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4123             88  CM-AH-DECLINED               VALUE 'D'.
  4124             88  CM-AH-VOIDED                 VALUE 'V'.
  4125
  4126         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4127             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4128             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4129             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4130         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4131
  4132         16  CM-ENTRY-BATCH                PIC X(6).
  4133         16  CM-LF-EXIT-BATCH              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  76
* EL131.cbl
  4134         16  CM-AH-EXIT-BATCH              PIC X(6).
  4135         16  CM-LAST-MONTH-END             PIC XX.
  4136
  4137     12  CM-NOTE-SW                        PIC X.
  4138         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4139         88  CERT-NOTES-PRESENT               VALUE '1'.
  4140         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4141         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4142         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4143         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4144         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4145         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4146     12  CM-COMP-EXCP-SW                   PIC X.
  4147         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4148         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4149     12  CM-INSURED-ADDRESS-SW             PIC X.
  4150         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4151         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4152
  4153*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4154     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4155     12  FILLER                            PIC X.
  4156
  4157*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4158     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4159     12  FILLER                            PIC X.
  4160*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4161     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4162
  4163     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4164         88  CERT-ADDED-BATCH                 VALUE ' '.
  4165         88  CERT-ADDED-ONLINE                VALUE '1'.
  4166         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4167         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4168         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4169     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4170         88  CERT-AS-LOADED                   VALUE ' '.
  4171         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4172         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4173         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4174         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4175         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4176         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4177         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4178
  4179     12  CM-ACCOUNT-COMM-PCTS.
  4180         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4181         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4182
  4183     12  CM-USER-FIELD                     PIC X.
  4184     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4185     12  CM-CLP-STATE                      PIC XX.
  4186     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4187     12  CM-USER-RESERVED                  PIC XXX.
  4188     12  FILLER REDEFINES CM-USER-RESERVED.
  4189         16  CM-AH-CLASS-CD                PIC XX.
  4190         16  F                             PIC X.
  4191******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  77
* EL131.cbl
  4192
  4193*                                COPY ELCTRLR.
  4194******************************************************************
  4195*                                                                *
  4196*                            ELCTRLR.                            *
  4197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4198*                            VMOD=2.014                          *
  4199*                                                                *
  4200*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4201*                                                                *
  4202*   FILE TYPE = VSAM,KSDS                                        *
  4203*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4204*                                                                *
  4205*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4206*       ALTERNATE INDEX = NONE                                   *
  4207*                                                                *
  4208*   LOG = YES                                                    *
  4209*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4210******************************************************************
  4211*                   C H A N G E   L O G
  4212*
  4213* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4214*-----------------------------------------------------------------
  4215*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4216* EFFECTIVE    NUMBER
  4217*-----------------------------------------------------------------
  4218* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4219* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4220* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4221* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4222* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4223* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4224* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4225* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4226* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4227* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4228* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4229* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4230* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4231* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4232* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4233* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4234* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4235* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4236* 040814    2014030500002  AJRA  ADD ICD CODES
  4237* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4238******************************************************************
  4239 01  ACTIVITY-TRAILERS.
  4240     12  AT-RECORD-ID                    PIC XX.
  4241         88  VALID-AT-ID                       VALUE 'AT'.
  4242
  4243     12  AT-CONTROL-PRIMARY.
  4244         16  AT-COMPANY-CD               PIC X.
  4245         16  AT-CARRIER                  PIC X.
  4246         16  AT-CLAIM-NO                 PIC X(7).
  4247         16  AT-CERT-NO.
  4248             20  AT-CERT-PRIME           PIC X(10).
  4249             20  AT-CERT-SFX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  78
* EL131.cbl
  4250         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4251             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4252             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4253             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4254             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4255             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4256             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4257             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4258             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4259             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4260             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4261             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4262             88  AT-BENEFICIARY-TRL           VALUE +91.
  4263             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4264             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4265             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4266             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4267
  4268     12  AT-TRAILER-TYPE                 PIC X.
  4269         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4270         88  PAYMENT-TR                       VALUE '2'.
  4271         88  AUTO-PAY-TR                      VALUE '3'.
  4272         88  CORRESPONDENCE-TR                VALUE '4'.
  4273         88  ADDRESS-TR                       VALUE '5'.
  4274         88  GENERAL-INFO-TR                  VALUE '6'.
  4275         88  AUTO-PROMPT-TR                   VALUE '7'.
  4276         88  DENIAL-TR                        VALUE '8'.
  4277         88  INCURRED-CHG-TR                  VALUE '9'.
  4278         88  FORM-CONTROL-TR                  VALUE 'A'.
  4279
  4280     12  AT-RECORDED-DT                  PIC XX.
  4281     12  AT-RECORDED-BY                  PIC X(4).
  4282     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4283
  4284     12  AT-TRAILER-BODY                 PIC X(165).
  4285
  4286     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4287         16  AT-RESERVE-CONTROLS.
  4288             20  AT-MANUAL-SW            PIC X.
  4289                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4290             20  AT-FUTURE-SW            PIC X.
  4291                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4292             20  AT-PTC-SW               PIC X.
  4293                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4294             20  AT-IBNR-SW              PIC X.
  4295                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4296             20  AT-PTC-LF-SW            PIC X.
  4297                 88  AT-LF-PTC-USED          VALUE '1'.
  4298             20  AT-CDT-ACCESS-METHOD    PIC X.
  4299                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4300                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4301                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4302             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4303         16  AT-LAST-COMPUTED-DT         PIC XX.
  4304         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4305         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4306         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4307         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  79
* EL131.cbl
  4308         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4309         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4310         16  AT-EXPENSE-CONTROLS.
  4311             20  AT-EXPENSE-METHOD       PIC X.
  4312                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4313                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4314                 88  PERCENT-OF-PMT           VALUE '3'.
  4315                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4316             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4317             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4318         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4319         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4320
  4321         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4322         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4323
  4324*        16  FILLER                      PIC X(53).
  4325         16  FILLER                      PIC X(47).
  4326
  4327         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4328         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4329
  4330         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4331             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4332             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4333*                    C = CLOSED
  4334*                    O = OPEN
  4335             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4336*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4337
  4338     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4339         16  AT-PAYMENT-TYPE             PIC X.
  4340             88  PARTIAL-PAYMENT                VALUE '1'.
  4341             88  FINAL-PAYMENT                  VALUE '2'.
  4342             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4343             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4344             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4345             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4346             88  VOIDED-PAYMENT                 VALUE '9'.
  4347             88  TRANSFER                       VALUE 'T'.
  4348             88  LIFE-INTEREST                  VALUE 'I'.
  4349
  4350         16  AT-CLAIM-TYPE               PIC X.
  4351             88  PAID-FOR-AH                    VALUE 'A'.
  4352             88  PAID-FOR-LIFE                  VALUE 'L'.
  4353             88  PAID-FOR-IUI                   VALUE 'I'.
  4354             88  PAID-FOR-GAP                   VALUE 'G'.
  4355             88  PAID-FOR-FAM                   VALUE 'F'.
  4356         16  AT-CLAIM-PREM-TYPE          PIC X.
  4357             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4358             88  AT-O-B-COVERAGE                VALUE '2'.
  4359             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4360         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4361         16  AT-CHECK-NO                 PIC X(7).
  4362         16  AT-PAID-FROM-DT             PIC XX.
  4363         16  AT-PAID-THRU-DT             PIC XX.
  4364         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4365         16  FILLER                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  80
* EL131.cbl
  4366         16  AT-PAYEES-NAME              PIC X(30).
  4367         16  AT-PAYMENT-ORIGIN           PIC X.
  4368             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4369             88  ONLINE-AUTO-PMT                VALUE '2'.
  4370             88  OFFLINE-PMT                    VALUE '3'.
  4371         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4372         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4373         16  AT-VOID-DATA.
  4374             20  AT-VOID-DT              PIC XX.
  4375*00144       20  AT-VOID-REASON          PIC X(30).
  4376             20  AT-VOID-REASON          PIC X(26).
  4377         16  AT-PMT-APPROVED-BY          PIC X(04).
  4378         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4379         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4380         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4381                                         PIC S99V9(5)  COMP-3.
  4382         16  AT-CREDIT-INTERFACE.
  4383             20  AT-PMT-SELECT-DT        PIC XX.
  4384                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4385             20  AT-PMT-ACCEPT-DT        PIC XX.
  4386                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4387             20  AT-VOID-SELECT-DT       PIC XX.
  4388                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4389             20  AT-VOID-ACCEPT-DT       PIC XX.
  4390                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4391
  4392         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4393                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4394                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4395         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4396
  4397         16  AT-FORCE-CONTROL            PIC X.
  4398             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4399         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4400         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4401         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4402         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4403         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4404         16  AT-BENEFIT-TYPE             PIC X.
  4405
  4406         16  AT-EXPENSE-TYPE             PIC X.
  4407         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4408
  4409         16  AT-PAYEE-TYPE-CD.
  4410             20  AT-PAYEE-TYPE           PIC X.
  4411                 88  INSURED-PAID           VALUE 'I'.
  4412                 88  BENEFICIARY-PAID       VALUE 'B'.
  4413                 88  ACCOUNT-PAID           VALUE 'A'.
  4414                 88  OTHER-1-PAID           VALUE 'O'.
  4415                 88  OTHER-2-PAID           VALUE 'Q'.
  4416                 88  DOCTOR-PAID            VALUE 'P'.
  4417                 88  EMPLOYER-PAID          VALUE 'E'.
  4418             20  AT-PAYEE-SEQ            PIC X.
  4419
  4420         16  AT-CASH-PAYMENT             PIC X.
  4421         16  AT-GROUPED-PAYMENT          PIC X.
  4422         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4423         16  AT-APPROVAL-LEVEL-REQD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  81
* EL131.cbl
  4424         16  AT-APPROVED-LEVEL           PIC X.
  4425         16  AT-VOID-TYPE                PIC X.
  4426             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4427             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4428         16  AT-AIG-UNEMP-IND            PIC X.
  4429             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4430         16  AT-ASSOCIATES               PIC X.
  4431             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4432             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4433
  4434         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4435         16  AT-CV-PMT-CODE              PIC X.
  4436             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4437             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4438             88  FULL-ADD-PAYMENT           VALUE '3'.
  4439             88  HALF-ADD-PAYMENT           VALUE '4'.
  4440             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4441             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4442             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4443             88  ADDL-PAYMENT               VALUE '8'.
  4444
  4445         16  AT-EOB-CODE1                PIC XXX.
  4446         16  AT-EOB-CODE2                PIC XXX.
  4447         16  AT-EOB-CODE3                PIC XXX.
  4448         16  FILLER REDEFINES AT-EOB-CODE3.
  4449             20  AT-PRINT-CLM-FORM       PIC X.
  4450             20  AT-PRINT-SURVEY         PIC X.
  4451             20  AT-SPECIAL-RELEASE      PIC X.
  4452         16  AT-EOB-CODE4                PIC XXX.
  4453         16  FILLER REDEFINES AT-EOB-CODE4.
  4454             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4455             20  FILLER                  PIC X.
  4456         16  AT-EOB-CODE5                PIC XXX.
  4457         16  FILLER REDEFINES AT-EOB-CODE5.
  4458             20  AT-PMT-PROOF-DT         PIC XX.
  4459             20  FILLER                  PIC X.
  4460
  4461         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4462             88  AT-PRINT-EOB            VALUE 'Y'.
  4463
  4464         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4465         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4466
  4467     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4468         16  AT-SCHEDULE-START-DT        PIC XX.
  4469         16  AT-SCHEDULE-END-DT          PIC XX.
  4470         16  AT-TERMINATED-DT            PIC XX.
  4471         16  AT-LAST-PMT-TYPE            PIC X.
  4472             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4473             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4474         16  AT-FIRST-PMT-DATA.
  4475             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4476             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4477             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4478         16  AT-REGULAR-PMT-DATA.
  4479             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4480             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4481             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  82
* EL131.cbl
  4482         16  AT-AUTO-PAYEE-CD.
  4483             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4484                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4485                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4486                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4487                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4488                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4489             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4490         16  AT-AUTO-PAY-DAY             PIC 99.
  4491         16  AT-AUTO-CASH                PIC X.
  4492             88  AT-CASH                      VALUE 'Y'.
  4493             88  AT-NON-CASH                  VALUE 'N'.
  4494*        16  FILLER                      PIC X(129).
  4495         16  AT-AUTO-END-LETTER          PIC X(4).
  4496         16  FILLER                      PIC X(125).
  4497
  4498         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4499         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4500
  4501     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4502         16  AT-LETTER-SENT-DT           PIC XX.
  4503         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4504         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4505         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4506         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4507         16  AT-LETTER-ORIGIN            PIC X.
  4508             88  ONLINE-CREATION              VALUE '1' '3'.
  4509             88  OFFLINE-CREATION             VALUE '2' '4'.
  4510             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4511             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4512         16  AT-STD-LETTER-FORM          PIC X(4).
  4513         16  AT-REASON-TEXT              PIC X(70).
  4514         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4515         16  AT-ADDRESEE-TYPE            PIC X.
  4516              88  INSURED-ADDRESEE            VALUE 'I'.
  4517              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4518              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4519              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4520              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4521              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4522              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4523         16  AT-ADDRESSEE-NAME           PIC X(30).
  4524         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4525         16  AT-RESEND-PRINT-DATE        PIC XX.
  4526         16  AT-CORR-SOL-UNSOL           PIC X.
  4527         16  AT-LETTER-PURGED-DT         PIC XX.
  4528*
  4529*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4530*
  4531         16  AT-CSO-REDEFINITION.
  4532             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4533             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4534             20  AT-LETTER-TO-BENE       PIC X(1).
  4535             20  AT-STOP-LETTER-DT       PIC X(2).
  4536             20  FILLER                  PIC X(19).
  4537*             20  FILLER                  PIC X(27).
  4538             20  AT-CSO-LETTER-STATUS    PIC X.
  4539                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  83
* EL131.cbl
  4540                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4541                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4542             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4543             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4544*
  4545*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4546*
  4547*        16  FILLER                      PIC X(26).
  4548*
  4549*        16  AT-DMD-BSR-CODE             PIC X.
  4550*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4551*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4552*
  4553*        16  AT-DMD-LETTER-STATUS        PIC X.
  4554*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4555*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4556*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4557*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4558*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4559
  4560         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4561         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4562
  4563     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4564         16  AT-ADDRESS-TYPE             PIC X.
  4565             88  INSURED-ADDRESS               VALUE 'I'.
  4566             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4567             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4568             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4569             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4570             88  OTHER-ADDRESS-1               VALUE 'O'.
  4571             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4572         16  AT-MAIL-TO-NAME             PIC X(30).
  4573         16  AT-ADDRESS-LINE-1           PIC X(30).
  4574         16  AT-ADDRESS-LINE-2           PIC X(30).
  4575         16  AT-CITY-STATE.
  4576             20  AT-CITY                 PIC X(28).
  4577             20  AT-STATE                PIC XX.
  4578         16  AT-ZIP.
  4579             20  AT-ZIP-CODE.
  4580                 24  AT-ZIP-1ST          PIC X.
  4581                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4582                 24  FILLER              PIC X(4).
  4583             20  AT-ZIP-PLUS4            PIC X(4).
  4584         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4585             20  AT-CAN-POSTAL-1         PIC XXX.
  4586             20  AT-CAN-POSTAL-2         PIC XXX.
  4587             20  FILLER                  PIC XXX.
  4588         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4589*         16  FILLER                      PIC X(23).
  4590         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4591         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4592         16  FILLER                      PIC X(13).
  4593         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4594         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4595
  4596     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4597         16  AT-INFO-LINE-1              PIC X(60).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  84
* EL131.cbl
  4598         16  FILLER REDEFINES AT-INFO-LINE-1.
  4599             20  AT-NOTE-ERROR-NO OCCURS 15
  4600                                         PIC X(4).
  4601         16  AT-INFO-LINE-2              PIC X(60).
  4602         16  FILLER REDEFINES AT-INFO-LINE-2.
  4603             20  AT-ICD-CODE-1           PIC X(8).
  4604             20  AT-ICD-CODE-2           PIC X(8).
  4605             20  FILLER                  PIC X(44).
  4606         16  AT-INFO-TRAILER-TYPE        PIC X.
  4607             88  AT-ERRORS-NOTE          VALUE 'E'.
  4608             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4609             88  AT-CALL-NOTE            VALUE 'C'.
  4610             88  AT-MAINT-NOTE           VALUE 'M'.
  4611             88  AT-CERT-CHANGE          VALUE 'X'.
  4612             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4613             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4614             88  AT-CERT-CANCELLED       VALUE 'T'.
  4615         16  AT-CALL-TYPE                PIC X.
  4616             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4617             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4618         16  AT-NOTE-CONTINUATION        PIC X.
  4619             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4620         16  AT-EOB-CODES-EXIST          PIC X.
  4621             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4622         16  FILLER                      PIC X(35).
  4623         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4624         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4625
  4626     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4627         16  AT-PROMPT-LINE-1            PIC X(60).
  4628         16  AT-PROMPT-LINE-2            PIC X(60).
  4629         16  AT-PROMPT-START-DT          PIC XX.
  4630         16  AT-PROMPT-END-DT            PIC XX.
  4631         16  FILLER                      PIC X(35).
  4632         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4633         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4634
  4635     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4636         16  AT-DENIAL-INFO-1            PIC X(60).
  4637         16  AT-DENIAL-INFO-2            PIC X(60).
  4638         16  AT-DENIAL-DT                PIC XX.
  4639         16  AT-RETRACTION-DT            PIC XX.
  4640         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4641*         16  FILLER                      PIC X(31).
  4642         16  AT-DENIAL-PROOF-DT          PIC XX.
  4643         16  FILLER                      PIC X(29).
  4644         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4645         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4646
  4647     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4648         16  AT-OLD-INCURRED-DT          PIC XX.
  4649         16  AT-OLD-REPORTED-DT          PIC XX.
  4650         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4651         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4652         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4653         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4654         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4655         16  AT-LAST-PMT-MADE-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  85
* EL131.cbl
  4656         16  FILLER                      PIC X(26).
  4657         16  AT-OLD-DIAG-CODE            PIC X(6).
  4658         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4659         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4660         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4661         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4662         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4663         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4664         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4665         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4666         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4667         16  FILLER                      PIC X(9).
  4668         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4669
  4670     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4671         16  AT-FORM-SEND-ON-DT          PIC XX.
  4672         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4673         16  AT-FORM-RE-SEND-DT          PIC XX.
  4674         16  AT-FORM-ANSWERED-DT         PIC XX.
  4675         16  AT-FORM-PRINTED-DT          PIC XX.
  4676         16  AT-FORM-REPRINT-DT          PIC XX.
  4677         16  AT-FORM-TYPE                PIC X.
  4678             88  INITIAL-FORM                  VALUE '1'.
  4679             88  PROGRESS-FORM                 VALUE '2'.
  4680         16  AT-INSTRUCT-LN-1            PIC X(28).
  4681         16  AT-INSTRUCT-LN-2            PIC X(28).
  4682         16  AT-INSTRUCT-LN-3            PIC X(28).
  4683         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4684         16  AT-FORM-ADDRESS             PIC X.
  4685             88  FORM-TO-INSURED              VALUE 'I'.
  4686             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4687             88  FORM-TO-OTHER-1              VALUE 'O'.
  4688             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4689         16  AT-RELATED-1.
  4690             20 AT-REL-CARR-1            PIC X.
  4691             20 AT-REL-CLAIM-1           PIC X(7).
  4692             20 AT-REL-CERT-1            PIC X(11).
  4693         16  AT-RELATED-2.
  4694             20 AT-REL-CARR-2            PIC X.
  4695             20 AT-REL-CLAIM-2           PIC X(7).
  4696             20 AT-REL-CERT-2            PIC X(11).
  4697         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4698         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4699         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4700         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4701         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4702         16  AT-STOP-FORM-DT             PIC X(2).
  4703
  4704         16  FILLER                      PIC X(09).
  4705         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4706         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4707******************************************************************
  4708
  4709*                                COPY ELCCNTL.
  4710******************************************************************
  4711*                                                                *
  4712*                                                                *
  4713*                            ELCCNTL.                            *
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  86
* EL131.cbl
  4714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4715*                            VMOD=2.059                          *
  4716*                                                                *
  4717*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4718*                                                                *
  4719*   FILE TYPE = VSAM,KSDS                                        *
  4720*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4721*                                                                *
  4722*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4723*       ALTERNATE INDEX = NONE                                   *
  4724*                                                                *
  4725*   LOG = YES                                                    *
  4726*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4727******************************************************************
  4728*                   C H A N G E   L O G
  4729*
  4730* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4731*-----------------------------------------------------------------
  4732*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4733* EFFECTIVE    NUMBER
  4734*-----------------------------------------------------------------
  4735* 082503                   PEMA  ADD BENEFIT GROUP
  4736* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4737* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4738* 092705    2005050300006  PEMA  ADD SPP LEASES
  4739* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4740* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4741* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4742* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4743* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4744* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4745* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4746* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4747* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4748* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4749******************************************************************
  4750*
  4751 01  CONTROL-FILE.
  4752     12  CF-RECORD-ID                       PIC XX.
  4753         88  VALID-CF-ID                        VALUE 'CF'.
  4754
  4755     12  CF-CONTROL-PRIMARY.
  4756         16  CF-COMPANY-ID                  PIC XXX.
  4757         16  CF-RECORD-TYPE                 PIC X.
  4758             88  CF-COMPANY-MASTER              VALUE '1'.
  4759             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4760             88  CF-STATE-MASTER                VALUE '3'.
  4761             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4762             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4763             88  CF-CARRIER-MASTER              VALUE '6'.
  4764             88  CF-MORTALITY-MASTER            VALUE '7'.
  4765             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4766             88  CF-TERMINAL-MASTER             VALUE '9'.
  4767             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4768             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4769             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4770             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4771             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  87
* EL131.cbl
  4772             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4773             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4774             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4775             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4776         16  CF-ACCESS-CD-GENL              PIC X(4).
  4777         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4778             20  CF-PROCESSOR               PIC X(4).
  4779         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4780             20  CF-STATE-CODE              PIC XX.
  4781             20  FILLER                     PIC XX.
  4782         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4783             20  FILLER                     PIC XX.
  4784             20  CF-HI-BEN-IN-REC           PIC XX.
  4785         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4786             20  FILLER                     PIC XXX.
  4787             20  CF-CARRIER-CNTL            PIC X.
  4788         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4789             20  FILLER                     PIC XX.
  4790             20  CF-HI-TYPE-IN-REC          PIC 99.
  4791         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4792             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4793                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4794             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4795             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4796         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4797             20  FILLER                     PIC X.
  4798             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4799         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4800             20  FILLER                     PIC XX.
  4801             20  CF-MORTGAGE-PLAN           PIC XX.
  4802         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4803
  4804     12  CF-LAST-MAINT-DT                   PIC XX.
  4805     12  CF-LAST-MAINT-BY                   PIC X(4).
  4806     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4807
  4808     12  CF-RECORD-BODY                     PIC X(728).
  4809
  4810
  4811****************************************************************
  4812*             COMPANY MASTER RECORD                            *
  4813****************************************************************
  4814
  4815     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4816         16  CF-COMPANY-ADDRESS.
  4817             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4818             20  CF-CL-IN-CARE-OF           PIC X(30).
  4819             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4820             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4821             20  CF-CL-CITY-STATE           PIC X(30).
  4822             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4823             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4824         16  CF-COMPANY-CD                  PIC X.
  4825         16  CF-COMPANY-PASSWORD            PIC X(8).
  4826         16  CF-SECURITY-OPTION             PIC X.
  4827             88  ALL-SECURITY                   VALUE '1'.
  4828             88  COMPANY-VERIFY                 VALUE '2'.
  4829             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  88
* EL131.cbl
  4830             88  NO-SECURITY                    VALUE '4'.
  4831             88  ALL-BUT-TERM                   VALUE '5'.
  4832         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4833             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4834         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4835             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4836         16  CF-INFORCE-LOCATION            PIC X.
  4837             88  CERTS-ARE-ONLINE               VALUE '1'.
  4838             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4839             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4840         16  CF-LOWER-CASE-LETTERS          PIC X.
  4841         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4842             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4843             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4844             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4845             88  CF-ACCNT-CNTL                  VALUE '3'.
  4846             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4847
  4848         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4849         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4850
  4851         16  CF-LGX-CREDIT-USER             PIC X.
  4852             88  CO-IS-NOT-USER                 VALUE 'N'.
  4853             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4854
  4855         16 CF-CREDIT-CALC-CODES.
  4856             20  CF-CR-REM-TERM-CALC PIC X.
  4857               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4858               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4859               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4860               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4861               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4862               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4863               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4864             20  CF-CR-R78-METHOD           PIC X.
  4865               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4866               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4867
  4868         16  CF-CLAIM-CONTROL-COUNTS.
  4869             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4870                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4871
  4872             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4873                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4874
  4875             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4876                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4877
  4878             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4879                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4880
  4881         16  CF-CURRENT-MONTH-END           PIC XX.
  4882
  4883         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4884             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4885             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4886             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4887             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  89
* EL131.cbl
  4888                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4889                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4890             20  CF-CO-PREM-REJECT-SW       PIC X.
  4891                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4892                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4893             20  CF-CO-REF-REJECT-SW        PIC X.
  4894                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4895                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4896
  4897         16  CF-CO-REPORTING-DT             PIC XX.
  4898         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4899         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4900           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4901           88  CF-CO-MONTH-END                  VALUE '1'.
  4902
  4903         16  CF-LGX-CLAIM-USER              PIC X.
  4904             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4905             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4906
  4907         16  CF-CREDIT-EDIT-CONTROLS.
  4908             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4909             20  CF-MIN-AGE                 PIC 99.
  4910             20  CF-DEFAULT-AGE             PIC 99.
  4911             20  CF-MIN-TERM                PIC S999      COMP-3.
  4912             20  CF-MAX-TERM                PIC S999      COMP-3.
  4913             20  CF-DEFAULT-SEX             PIC X.
  4914             20  CF-JOINT-AGE-INPUT         PIC X.
  4915                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4916             20  CF-BIRTH-DATE-INPUT        PIC X.
  4917                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4918             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4919                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4920                 88  CF-ZERO-CARRIER            VALUE '1'.
  4921                 88  CF-ZERO-GROUPING           VALUE '2'.
  4922                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4923             20  CF-EDIT-SW                 PIC X.
  4924                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4925             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4926             20  CF-CR-PR-METHOD            PIC X.
  4927               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4928               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4929             20  FILLER                     PIC X.
  4930
  4931         16  CF-CREDIT-MISC-CONTROLS.
  4932             20  CF-REIN-TABLE-SW           PIC X.
  4933                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4934             20  CF-COMP-TABLE-SW           PIC X.
  4935                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4936             20  CF-EXPERIENCE-RETENTION-AGE
  4937                                            PIC S9        COMP-3.
  4938             20  CF-CONVERSION-DT           PIC XX.
  4939             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4940             20  CF-RUN-FREQUENCY-SW        PIC X.
  4941                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4942                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4943
  4944             20  CF-CR-CHECK-NO-CONTROL.
  4945                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  90
* EL131.cbl
  4946                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4947                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4948                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4949                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4950                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4951
  4952                 24  CF-CR-CHECK-COUNT       REDEFINES
  4953                     CF-CR-CHECK-COUNTER      PIC X(4).
  4954
  4955                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4956                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4957
  4958                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4959                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4960                 24  CF-MAIL-PROCESSING       PIC X.
  4961                     88  MAIL-PROCESSING          VALUE 'Y'.
  4962
  4963         16  CF-MISC-SYSTEM-CONTROL.
  4964             20  CF-SYSTEM-C                 PIC X.
  4965                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4966             20  CF-SYSTEM-D                 PIC X.
  4967                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4968             20  CF-SOC-SEC-NO-SW            PIC X.
  4969                 88  SOC-SEC-NO-USED             VALUE '1'.
  4970             20  CF-MEMBER-NO-SW             PIC X.
  4971                 88  MEMBER-NO-USED              VALUE '1'.
  4972             20  CF-TAX-ID-NUMBER            PIC X(11).
  4973             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4974             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4975                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4976                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4977                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4978                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4979             20  CF-SYSTEM-E                 PIC X.
  4980                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4981
  4982         16  CF-LGX-LIFE-USER               PIC X.
  4983             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4984             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4985
  4986         16  CF-CR-MONTH-END-DT             PIC XX.
  4987
  4988         16  CF-FILE-MAINT-DATES.
  4989             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4990                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4991             20  CF-LAST-BATCH       REDEFINES
  4992                 CF-LAST-BATCH-NO               PIC X(4).
  4993             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4994             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4995             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4996             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4997             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4998             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4999             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5000             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5001             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5002             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5003
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  91
* EL131.cbl
  5004         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5005         16  FILLER                         PIC X.
  5006
  5007         16  CF-ALT-MORT-CODE               PIC X(4).
  5008         16  CF-MEMBER-CAPTION              PIC X(10).
  5009
  5010         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5011             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5012             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5013             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5014             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5015             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5016
  5017         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5018
  5019         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5020         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5021         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5022         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5023
  5024         16  CF-AH-OVERRIDE-L1              PIC X.
  5025         16  CF-AH-OVERRIDE-L2              PIC XX.
  5026         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5027         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5028
  5029         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5030         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5031
  5032         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5033         16  CF-AR-LAST-EL860-DT            PIC XX.
  5034         16  CF-MP-MONTH-END-DT             PIC XX.
  5035
  5036         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5037         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5038             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5039
  5040         16  CF-AR-MONTH-END-DT             PIC XX.
  5041
  5042         16  CF-CRDTCRD-USER                PIC X.
  5043             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5044             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5045
  5046         16  CF-CC-MONTH-END-DT             PIC XX.
  5047
  5048         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5049
  5050         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5051             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5052             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5053             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5054         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5055         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5056         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5057         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5058             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5059             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5060         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5061         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  92
* EL131.cbl
  5062         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5063             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5064         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5065
  5066         16  CF-CL-ZIP-CODE.
  5067             20  CF-CL-ZIP-PRIME.
  5068                 24  CF-CL-ZIP-1ST          PIC X.
  5069                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5070                 24  FILLER                 PIC X(4).
  5071             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5072         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5073             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5074             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5075             20  FILLER                     PIC XXX.
  5076
  5077         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5078         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5079         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5080         16  CF-CO-OPTION-START-DATE        PIC XX.
  5081         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5082           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5083                                                      '3' '4'.
  5084           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5085           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5086           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5087           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5088           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5089           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5090
  5091         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5092
  5093         16  CF-PAYMENT-APPROVAL-LEVELS.
  5094             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5095             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5096             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5097             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5098             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5099             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5100
  5101         16  CF-END-USER-REPORTING-USER     PIC X.
  5102             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5103             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5104
  5105         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5106             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5107             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5108
  5109         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5110
  5111         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5112         16  FILLER                         PIC X.
  5113
  5114         16  CF-CREDIT-ARCHIVE-CNTL.
  5115             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5116             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5117             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5118
  5119         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  93
* EL131.cbl
  5120
  5121         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5122             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5123             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5124
  5125         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5126             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5127             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5128
  5129         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5130
  5131         16  CF-CO-ACH-ID-CODE              PIC  X.
  5132             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5133             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5134             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5135         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5136         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5137         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5138         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5139         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5140         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5141         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5142         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5143         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5144                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5145         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5146                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5147
  5148         16  CF-CO-OVER-SHORT.
  5149             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5150             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5151
  5152*         16  FILLER                         PIC X(102).
  5153         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5154             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5155             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5156
  5157         16  CF-AH-APPROVAL-DAYS.
  5158             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5159             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5160             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5161             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5162
  5163         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5164
  5165         16  CF-APPROV-LEV-5.
  5166             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5167             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5168             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5169
  5170         16  FILLER                         PIC X(68).
  5171****************************************************************
  5172*             PROCESSOR/USER RECORD                            *
  5173****************************************************************
  5174
  5175     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5176         16  CF-PROCESSOR-NAME              PIC X(30).
  5177         16  CF-PROCESSOR-PASSWORD          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  94
* EL131.cbl
  5178         16  CF-PROCESSOR-TITLE             PIC X(26).
  5179         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5180                 88  MESSAGE-YES                VALUE 'Y'.
  5181                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5182
  5183*****************************************************
  5184****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5185****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5186****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5187****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5188*****************************************************
  5189
  5190         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5191             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5192             20  CF-APPLICATION-FORCE       PIC X.
  5193             20  CF-INDIVIDUAL-APP.
  5194                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5195                     28  CF-BROWSE-APP      PIC X.
  5196                     28  CF-UPDATE-APP      PIC X.
  5197
  5198         16  CF-CURRENT-TERM-ON             PIC X(4).
  5199         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5200             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5201             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5202             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5203             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5204             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5205             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5206             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5207         16  CF-PROCESSOR-CARRIER           PIC X.
  5208             88  NO-CARRIER-SECURITY            VALUE ' '.
  5209         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5210             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5211         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5212             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5213         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5214             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5215
  5216         16  CF-PROC-SYS-ACCESS-SW.
  5217             20  CF-PROC-CREDIT-CLAIMS-SW.
  5218                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5219                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5220                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5221                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5222             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5223                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5224                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5225             20  CF-PROC-LIFE-GNRLDGR-SW.
  5226                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5227                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5228                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5229                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5230             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5231                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5232                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5233         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5234             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5235             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  95
* EL131.cbl
  5236         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5237
  5238         16  CF-APPROVAL-LEVEL                  PIC X.
  5239             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5240             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5241             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5242             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5243             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5244
  5245         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5246
  5247         16  CF-LANGUAGE-TYPE                   PIC X.
  5248             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5249             88  CF-LANG-IS-FR                      VALUE 'F'.
  5250
  5251         16  CF-CSR-IND                         PIC X.
  5252         16  FILLER                             PIC X(239).
  5253
  5254****************************************************************
  5255*             PROCESSOR/REMINDERS RECORD                       *
  5256****************************************************************
  5257
  5258     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5259         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5260             20  CF-START-REMIND-DT         PIC XX.
  5261             20  CF-END-REMIND-DT           PIC XX.
  5262             20  CF-REMINDER-TEXT           PIC X(50).
  5263         16  FILLER                         PIC X(296).
  5264
  5265
  5266****************************************************************
  5267*             STATE MASTER RECORD                              *
  5268****************************************************************
  5269
  5270     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5271         16  CF-STATE-ABBREVIATION          PIC XX.
  5272         16  CF-STATE-NAME                  PIC X(25).
  5273         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5274         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5275             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5276             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5277             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5278             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5279                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5280                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5281             20  CF-ST-PREM-REJECT-SW       PIC X.
  5282                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5283                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5284             20  CF-ST-REF-REJECT-SW        PIC X.
  5285                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5286                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5287         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5288         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5289         16  CF-ST-REFUND-RULES.
  5290             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5291             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5292             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5293         16  CF-ST-FST-PMT-EXTENSION.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  96
* EL131.cbl
  5294             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5295             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5296                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5297                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5298                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5299                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5300         16  CF-ST-STATE-CALL.
  5301             20  CF-ST-CALL-UNEARNED        PIC X.
  5302             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5303             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5304         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5305             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5306             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5307         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5308         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5309         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5310         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5311         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5312         16  FILLER                         PIC X.
  5313         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5314             20  CF-ST-BENEFIT-CD           PIC XX.
  5315             20  CF-ST-BENEFIT-KIND         PIC X.
  5316                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5317                 88  CF-ST-AH-KIND              VALUE 'A'.
  5318             20  CF-ST-REM-TERM-CALC        PIC X.
  5319                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5320                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5321                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5322                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5323                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5324                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5325                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5326                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5327
  5328             20  CF-ST-REFUND-CALC          PIC X.
  5329                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5330                 88  ST-REFD-BY-R78             VALUE '1'.
  5331                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5332                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5333                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5334                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5335                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5336                 88  ST-REFD-UTAH               VALUE '7'.
  5337                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5338                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5339                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5340
  5341             20  CF-ST-EARNING-CALC         PIC X.
  5342                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5343                 88  ST-EARN-BY-R78             VALUE '1'.
  5344                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5345                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5346                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5347                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5348                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5349                 88  ST-EARN-MEAN               VALUE '8'.
  5350                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5351
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  97
* EL131.cbl
  5352             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5353                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5354                 88  ST-OVRD-BY-R78             VALUE '1'.
  5355                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5356                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5357                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5358                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5359                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5360                 88  ST-OVRD-MEAN               VALUE '8'.
  5361                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5362             20  cf-st-extra-periods        pic 9.
  5363*            20  FILLER                     PIC X.
  5364
  5365         16  CF-ST-COMMISSION-CAPS.
  5366             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5367             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5368             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5369             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5370         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5371                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5372
  5373         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5374
  5375         16  CF-ST-STATUTORY-INTEREST.
  5376             20  CF-ST-STAT-DATE-FROM       PIC X.
  5377                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5378                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5379             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5380             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5381             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5382             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5383             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5384
  5385         16  CF-ST-OVER-SHORT.
  5386             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5387             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5388
  5389         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5390
  5391         16  CF-ST-RT-CALC                  PIC X.
  5392
  5393         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5394         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5395         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5396         16  CF-ST-RF-LR-CALC               PIC X.
  5397         16  CF-ST-RF-LL-CALC               PIC X.
  5398         16  CF-ST-RF-LN-CALC               PIC X.
  5399         16  CF-ST-RF-AH-CALC               PIC X.
  5400         16  CF-ST-RF-CP-CALC               PIC X.
  5401*        16  FILLER                         PIC X(206).
  5402*CIDMOD         16  FILLER                         PIC X(192).
  5403         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5404             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5405         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5406         16  CF-ST-VFY-2ND-BENE             PIC X.
  5407         16  CF-ST-CAUSAL-STATE             PIC X.
  5408         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5409         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  98
* EL131.cbl
  5410         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5411             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5412         16  CF-ST-NET-ONLY-STATE           PIC X.
  5413             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5414         16  FILLER                         PIC X(181).
  5415
  5416****************************************************************
  5417*             BENEFIT MASTER RECORD                            *
  5418****************************************************************
  5419
  5420     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5421         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5422             20  CF-BENEFIT-CODE            PIC XX.
  5423             20  CF-BENEFIT-NUMERIC  REDEFINES
  5424                 CF-BENEFIT-CODE            PIC XX.
  5425             20  CF-BENEFIT-ALPHA           PIC XXX.
  5426             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5427             20  CF-BENEFIT-COMMENT         PIC X(10).
  5428
  5429             20  CF-LF-COVERAGE-TYPE        PIC X.
  5430                 88  CF-REDUCING                VALUE 'R'.
  5431                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5432
  5433             20  CF-SPECIAL-CALC-CD         PIC X.
  5434                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5435                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5436                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5437                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5438                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5439                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5440                 88  CF-FARM-PLAN               VALUE 'F'.
  5441                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5442                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5443                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5444                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5445                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5446                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5447                 88  CF-PRUDENTIAL              VALUE 'P'.
  5448                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5449                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5450                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5451                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5452                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5453                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5454
  5455             20  CF-JOINT-INDICATOR         PIC X.
  5456                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5457
  5458*            20  FILLER                     PIC X(12).
  5459             20  cf-maximum-benefits        pic s999 comp-3.
  5460             20  FILLER                     PIC X(09).
  5461             20  CF-BENEFIT-CATEGORY        PIC X.
  5462             20  CF-LOAN-TYPE               PIC X(8).
  5463
  5464             20  CF-CO-REM-TERM-CALC        PIC X.
  5465                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5466                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5467                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page  99
* EL131.cbl
  5468                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5469                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5470
  5471             20  CF-CO-EARNINGS-CALC        PIC X.
  5472                 88  CO-EARN-BY-R78             VALUE '1'.
  5473                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5474                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5475                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5476                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5477                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5478                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5479                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5480
  5481             20  CF-CO-REFUND-CALC          PIC X.
  5482                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5483                 88  CO-REFD-BY-R78             VALUE '1'.
  5484                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5485                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5486                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5487                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5488                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5489                 88  CO-REFD-MEAN               VALUE '8'.
  5490                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5491                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5492                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5493
  5494             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5495                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5496                 88  CO-OVRD-BY-R78             VALUE '1'.
  5497                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5498                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5499                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5500                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5501                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5502                 88  CO-OVRD-MEAN               VALUE '8'.
  5503                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5504
  5505             20  CF-CO-BEN-I-G-CD           PIC X.
  5506                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5507                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5508                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5509
  5510         16  FILLER                         PIC X(304).
  5511
  5512
  5513****************************************************************
  5514*             CARRIER MASTER RECORD                            *
  5515****************************************************************
  5516
  5517     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5518         16  CF-ADDRESS-DATA.
  5519             20  CF-MAIL-TO-NAME            PIC X(30).
  5520             20  CF-IN-CARE-OF              PIC X(30).
  5521             20  CF-ADDRESS-LINE-1          PIC X(30).
  5522             20  CF-ADDRESS-LINE-2          PIC X(30).
  5523             20  CF-CITY-STATE              PIC X(30).
  5524             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5525             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 100
* EL131.cbl
  5526
  5527         16  CF-CLAIM-NO-CONTROL.
  5528             20  CF-CLAIM-NO-METHOD         PIC X.
  5529                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5530                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5531                 88  CLAIM-NO-SEQ               VALUE '3'.
  5532                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5533             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5534                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5535                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5536                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5537
  5538         16  CF-CHECK-NO-CONTROL.
  5539             20  CF-CHECK-NO-METHOD         PIC X.
  5540                 88  CHECK-NO-MANUAL            VALUE '1'.
  5541                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5542                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5543                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5544             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5545                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5546
  5547         16  CF-DOMICILE-STATE              PIC XX.
  5548
  5549         16  CF-EXPENSE-CONTROLS.
  5550             20  CF-EXPENSE-METHOD          PIC X.
  5551                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5552                 88  DOLLARS-PER-PMT            VALUE '2'.
  5553                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5554                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5555             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5556             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5557
  5558         16  CF-CORRESPONDENCE-CONTROL.
  5559             20  CF-LETTER-RESEND-OPT       PIC X.
  5560                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5561                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5562             20  FILLER                     PIC X(4).
  5563
  5564         16  CF-RESERVE-CONTROLS.
  5565             20  CF-MANUAL-SW               PIC X.
  5566                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5567             20  CF-FUTURE-SW               PIC X.
  5568                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5569             20  CF-PTC-SW                  PIC X.
  5570                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5571             20  CF-IBNR-SW                 PIC X.
  5572                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5573             20  CF-PTC-LF-SW               PIC X.
  5574                 88  CF-LF-PTC-USED             VALUE '1'.
  5575             20  CF-CDT-ACCESS-METHOD       PIC X.
  5576                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5577                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5578                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5579             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5580
  5581         16  CF-CLAIM-CALC-METHOD           PIC X.
  5582             88  360-PLUS-MONTHS                VALUE '1'.
  5583             88  365-PLUS-MONTHS                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 101
* EL131.cbl
  5584             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5585             88  360-DAILY                      VALUE '4'.
  5586             88  365-DAILY                      VALUE '5'.
  5587
  5588         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5589         16  FILLER                         PIC X(11).
  5590
  5591         16  CF-LIMIT-AMOUNTS.
  5592             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5593             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5594             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5595             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5596             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5597             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5598             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5599             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5600             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5601             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5602
  5603         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5604         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5605         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5606
  5607         16  CF-ZIP-CODE.
  5608             20  CF-ZIP-PRIME.
  5609                 24  CF-ZIP-1ST             PIC X.
  5610                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5611                 24  FILLER                 PIC X(4).
  5612             20  CF-ZIP-PLUS4               PIC X(4).
  5613         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5614             20  CF-CAN-POSTAL-1            PIC XXX.
  5615             20  CF-CAN-POSTAL-2            PIC XXX.
  5616             20  FILLER                     PIC XXX.
  5617
  5618         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5619         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5620         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5621
  5622         16  CF-RATING-SWITCH               PIC X.
  5623             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5624             88  CF-NO-RATING                   VALUE 'N'.
  5625
  5626         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5627
  5628         16  CF-CARRIER-OVER-SHORT.
  5629             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5630             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5631
  5632         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5633         16  CF-SECPAY-SWITCH               PIC X.
  5634             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5635             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5636         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5637         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5638         16  FILLER                         PIC X(444).
  5639*        16  FILLER                         PIC X(452).
  5640
  5641
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 102
* EL131.cbl
  5642****************************************************************
  5643*             MORTALITY MASTER RECORD                          *
  5644****************************************************************
  5645
  5646     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5647         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5648                                INDEXED BY CF-MORT-NDX.
  5649             20  CF-MORT-TABLE              PIC X(5).
  5650             20  CF-MORT-TABLE-TYPE         PIC X.
  5651                 88  CF-MORT-JOINT              VALUE 'J'.
  5652                 88  CF-MORT-SINGLE             VALUE 'S'.
  5653                 88  CF-MORT-COMBINED           VALUE 'C'.
  5654                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5655                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5656             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5657             20  CF-MORT-AGE-METHOD         PIC XX.
  5658                 88  CF-AGE-LAST                VALUE 'AL'.
  5659                 88  CF-AGE-NEAR                VALUE 'AN'.
  5660             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5661             20  CF-MORT-ADJUSTMENT-DIRECTION
  5662                                            PIC X.
  5663                 88  CF-MINUS                   VALUE '-'.
  5664                 88  CF-PLUS                    VALUE '+'.
  5665             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5666             20  CF-MORT-JOINT-CODE         PIC X.
  5667                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5668             20  CF-MORT-PC-Q               PIC X.
  5669                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5670             20  CF-MORT-TABLE-CODE         PIC X(4).
  5671             20  CF-MORT-COMMENTS           PIC X(15).
  5672             20  FILLER                     PIC X(14).
  5673
  5674         16  FILLER                         PIC X(251).
  5675
  5676
  5677****************************************************************
  5678*             BUSSINESS TYPE MASTER RECORD                     *
  5679****************************************************************
  5680
  5681     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5682* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5683* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5684* AND RECORD 05 IS TYPES 81-99
  5685         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5686             20  CF-BUSINESS-TITLE          PIC  X(19).
  5687             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5688                                            PIC S9V9(4) COMP-3.
  5689             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5690             20  FILLER                     PIC  X.
  5691         16  FILLER                         PIC  X(248).
  5692
  5693
  5694****************************************************************
  5695*             TERMINAL MASTER RECORD                           *
  5696****************************************************************
  5697
  5698     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5699
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 103
* EL131.cbl
  5700         16  CF-COMPANY-TERMINALS.
  5701             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5702                                  PIC X(4).
  5703         16  FILLER               PIC X(248).
  5704
  5705
  5706****************************************************************
  5707*             LIFE EDIT MASTER RECORD                          *
  5708****************************************************************
  5709
  5710     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5711         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5712             20  CF-LIFE-CODE-IN            PIC XX.
  5713             20  CF-LIFE-CODE-OUT           PIC XX.
  5714         16  FILLER                         PIC X(248).
  5715
  5716
  5717****************************************************************
  5718*             AH EDIT MASTER RECORD                            *
  5719****************************************************************
  5720
  5721     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5722         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5723             20  CF-AH-CODE-IN              PIC XXX.
  5724             20  CF-AH-CODE-OUT             PIC XX.
  5725         16  FILLER                         PIC X(248).
  5726
  5727
  5728****************************************************************
  5729*             CREDIBILITY TABLES                               *
  5730****************************************************************
  5731
  5732     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5733         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5734                             INDEXED BY CF-CRDB-NDX.
  5735             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5736             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5737             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5738         16  FILLER                         PIC  X(332).
  5739
  5740
  5741****************************************************************
  5742*             REPORT CUSTOMIZATION RECORD                      *
  5743****************************************************************
  5744
  5745     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5746         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5747             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5748             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5749             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5750**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5751****       A T-TRANSFER.                                   ****
  5752             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5753
  5754         16  FILLER                         PIC XX.
  5755
  5756         16  CF-CARRIER-CNTL-OPT.
  5757             20  CF-CARRIER-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 104
* EL131.cbl
  5758                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5759                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5760             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5761                                            PIC X.
  5762         16  CF-GROUP-CNTL-OPT.
  5763             20  CF-GROUP-OPT-SEQ           PIC 9.
  5764                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5765                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5766             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5767                                            PIC X(6).
  5768         16  CF-STATE-CNTL-OPT.
  5769             20  CF-STATE-OPT-SEQ           PIC 9.
  5770                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5771                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5772             20  CF-STATE-SELECT OCCURS 3 TIMES
  5773                                            PIC XX.
  5774         16  CF-ACCOUNT-CNTL-OPT.
  5775             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5776                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5777                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5778             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5779                                            PIC X(10).
  5780         16  CF-BUS-TYP-CNTL-OPT.
  5781             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5782                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5783                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5784             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5785                                            PIC XX.
  5786         16  CF-LF-TYP-CNTL-OPT.
  5787             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5788                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5789                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5790             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5791                                            PIC XX.
  5792         16  CF-AH-TYP-CNTL-OPT.
  5793             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5794                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5795                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5796             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5797                                            PIC XX.
  5798         16  CF-REPTCD1-CNTL-OPT.
  5799             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5800                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5801                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5802             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5803                                            PIC X(10).
  5804         16  CF-REPTCD2-CNTL-OPT.
  5805             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5806                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5807                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5808             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5809                                            PIC X(10).
  5810         16  CF-USER1-CNTL-OPT.
  5811             20  CF-USER1-OPT-SEQ           PIC 9.
  5812                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5813                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5814             20  CF-USER1-SELECT OCCURS 3 TIMES
  5815                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 105
* EL131.cbl
  5816         16  CF-USER2-CNTL-OPT.
  5817             20  CF-USER2-OPT-SEQ           PIC 9.
  5818                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5819                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5820             20  CF-USER2-SELECT OCCURS 3 TIMES
  5821                                            PIC X(10).
  5822         16  CF-USER3-CNTL-OPT.
  5823             20  CF-USER3-OPT-SEQ           PIC 9.
  5824                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5825                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5826             20  CF-USER3-SELECT OCCURS 3 TIMES
  5827                                            PIC X(10).
  5828         16  CF-USER4-CNTL-OPT.
  5829             20  CF-USER4-OPT-SEQ           PIC 9.
  5830                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5831                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5832             20  CF-USER4-SELECT OCCURS 3 TIMES
  5833                                            PIC X(10).
  5834         16  CF-USER5-CNTL-OPT.
  5835             20  CF-USER5-OPT-SEQ           PIC 9.
  5836                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5837                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5838             20  CF-USER5-SELECT OCCURS 3 TIMES
  5839                                            PIC X(10).
  5840         16  CF-REINS-CNTL-OPT.
  5841             20  CF-REINS-OPT-SEQ           PIC 9.
  5842                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5843                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5844             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5845                 24  CF-REINS-PRIME         PIC XXX.
  5846                 24  CF-REINS-SUB           PIC XXX.
  5847
  5848         16  CF-AGENT-CNTL-OPT.
  5849             20  CF-AGENT-OPT-SEQ           PIC 9.
  5850                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5851                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5852             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5853                                            PIC X(10).
  5854
  5855         16  FILLER                         PIC X(43).
  5856
  5857         16  CF-LOSS-RATIO-SELECT.
  5858             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5859             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5860         16  CF-ENTRY-DATE-SELECT.
  5861             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5862             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5863         16  CF-EFFECTIVE-DATE-SELECT.
  5864             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5865             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5866
  5867         16  CF-EXCEPTION-LIST-IND          PIC X.
  5868             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5869
  5870         16  FILLER                         PIC X(318).
  5871
  5872****************************************************************
  5873*                  EXCEPTION REPORTING RECORD                  *
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 106
* EL131.cbl
  5874****************************************************************
  5875
  5876     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5877         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5878             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5879
  5880         16  CF-COMBINED-LIFE-AH-OPT.
  5881             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5882             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5883             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5884             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5885
  5886         16  CF-LIFE-OPT.
  5887             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5888             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5889             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5890             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5891             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5892             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5893             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5894             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5895             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5896             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5897
  5898         16  CF-AH-OPT.
  5899             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5900             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5901             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5902             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5903             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5904             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5905             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5906             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5907             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5908             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5909
  5910         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5911             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5912             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5913             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5914
  5915         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5916
  5917         16  FILLER                         PIC X(673).
  5918
  5919
  5920****************************************************************
  5921*             MORTGAGE SYSTEM PLAN RECORD                      *
  5922****************************************************************
  5923
  5924     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5925         16  CF-PLAN-TYPE                   PIC X.
  5926             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5927             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5928             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5929         16  CF-PLAN-ABBREV                 PIC XXX.
  5930         16  CF-PLAN-DESCRIPT               PIC X(10).
  5931         16  CF-PLAN-NOTES                  PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 107
* EL131.cbl
  5932         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5933         16  CF-PLAN-UNDERWRITING.
  5934             20  CF-PLAN-TERM-DATA.
  5935                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5936                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5937             20  CF-PLAN-AGE-DATA.
  5938                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5939                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5940                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5941             20  CF-PLAN-BENEFIT-DATA.
  5942                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5943                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5944                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5945                                            PIC S9(7)V99  COMP-3.
  5946         16  CF-PLAN-POLICY-FORMS.
  5947             20  CF-POLICY-FORM             PIC X(12).
  5948             20  CF-MASTER-APPLICATION      PIC X(12).
  5949             20  CF-MASTER-POLICY           PIC X(12).
  5950         16  CF-PLAN-RATING.
  5951             20  CF-RATE-CODE               PIC X(5).
  5952             20  CF-SEX-RATING              PIC X.
  5953                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5954                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5955             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5956             20  CF-SUB-STD-TYPE            PIC X.
  5957                 88  CF-PCT-OF-PREM            VALUE '1'.
  5958                 88  CF-PCT-OF-BENE            VALUE '2'.
  5959         16  CF-PLAN-PREM-TOLERANCES.
  5960             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5961             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5962         16  CF-PLAN-PYMT-TOLERANCES.
  5963             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5964             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5965         16  CF-PLAN-MISC-DATA.
  5966             20  FILLER                     PIC X.
  5967             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5968             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5969         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5970         16  CF-PLAN-IND-GRP                PIC X.
  5971             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5972                                                     '1'.
  5973             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5974                                                     '2'.
  5975         16  CF-MIB-SEARCH-SW               PIC X.
  5976             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5977             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5978             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5979             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5980         16  CF-ALPHA-SEARCH-SW             PIC X.
  5981             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5982             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5983             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5984             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5985             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5986             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5987             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5988             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5989             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 108
* EL131.cbl
  5990             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5991                                                     'A' 'B' 'C'
  5992                                                     'X' 'Y' 'Z'.
  5993         16  CF-EFF-DT-RULE-SW              PIC X.
  5994             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5995             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5996             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5997             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5998             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5999         16  FILLER                         PIC X(4).
  6000         16  CF-HEALTH-QUESTIONS            PIC X.
  6001             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6002         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6003         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6004         16  CF-PLAN-SNGL-JNT               PIC X.
  6005             88  CF-COMBINED-PLAN              VALUE 'C'.
  6006             88  CF-JNT-PLAN                   VALUE 'J'.
  6007             88  CF-SNGL-PLAN                  VALUE 'S'.
  6008         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6009         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6010         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6011         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6012         16  CF-RERATE-CNTL                 PIC  X.
  6013             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6014             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6015             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6016             88  CF-AUTO-RECALC                 VALUE '4'.
  6017         16  CF-BENEFIT-TYPE                PIC  X.
  6018             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6019             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6020         16  CF-POLICY-FEE                  PIC S999V99
  6021                                                    COMP-3.
  6022         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6023         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6024         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6025         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6026         16  FILLER                         PIC  X(32).
  6027         16  CF-TERMINATION-FORM            PIC  X(04).
  6028         16  FILLER                         PIC  X(08).
  6029         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6030                                                       COMP-3.
  6031         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6032         16  CF-ISSUE-LETTER                PIC  X(4).
  6033         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6034         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6035             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6036             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6037         16  CF-MP-REFUND-CALC              PIC X.
  6038             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6039             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6040             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6041             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6042             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6043             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6044             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6045             88  CF-MP-REFD-MEAN                VALUE '8'.
  6046         16  CF-ALT-RATE-CODE               PIC  X(5).
  6047
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 109
* EL131.cbl
  6048
  6049         16  FILLER                         PIC X(498).
  6050****************************************************************
  6051*             MORTGAGE COMPANY MASTER RECORD                   *
  6052****************************************************************
  6053
  6054     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6055         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6056         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6057             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6058             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6059             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6060             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6061             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6062
  6063         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6064         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6065         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6066         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6067         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6068
  6069         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6070             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6071         16  CF-MP-RECON-USE-IND            PIC X(1).
  6072             88  CF-MP-USE-RECON             VALUE 'Y'.
  6073         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6074             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6075         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6076             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6077             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6078         16  FILLER                         PIC X(1).
  6079         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6080             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6081         16  CF-MORTG-MIB-VERSION           PIC X.
  6082             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6083             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6084             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6085         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6086             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6087                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6088             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6089                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6090             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6091                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6092             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6093                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6094             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6095                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6096             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6097                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6098         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6099         16  FILLER                         PIC X(7).
  6100         16  CF-MORTG-DESTINATION-SYMBOL.
  6101             20  CF-MORTG-MIB-COMM          PIC X(5).
  6102             20  CF-MORTG-MIB-TERM          PIC X(5).
  6103         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6104             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6105         16  FILLER                         PIC X(03).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 110
* EL131.cbl
  6106         16  CF-MP-CHECK-NO-CONTROL.
  6107             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6108                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6109                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6110                                                ' ' LOW-VALUES.
  6111                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6112                                               VALUE '3'.
  6113         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6114         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6115         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6116             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6117                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6118             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6119                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6120             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6121                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6122             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6123                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6124             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6125                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6126             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6127                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6128         16  CF-MORTG-BILLING-AREA.
  6129             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6130                                            PIC X.
  6131         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6132         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6133         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6134         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6135             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6136             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6137         16  FILLER                         PIC X.
  6138         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6139             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6140             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6141         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6142         16  FILLER                         PIC X(8).
  6143         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6144         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6145         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6146         16  CF-ACH-COMPANY-ID.
  6147             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6148                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6149                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6150                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6151             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6152         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6153             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6154         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6155             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6156             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6157         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6158         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6159         16  FILLER                         PIC X(536).
  6160
  6161****************************************************************
  6162*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6163****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 111
* EL131.cbl
  6164
  6165     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6166         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6167             20  CF-FEMALE-HEIGHT.
  6168                 24  CF-FEMALE-FT           PIC 99.
  6169                 24  CF-FEMALE-IN           PIC 99.
  6170             20  CF-FEMALE-MIN-WT           PIC 999.
  6171             20  CF-FEMALE-MAX-WT           PIC 999.
  6172         16  FILLER                         PIC X(428).
  6173
  6174     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6175         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6176             20  CF-MALE-HEIGHT.
  6177                 24  CF-MALE-FT             PIC 99.
  6178                 24  CF-MALE-IN             PIC 99.
  6179             20  CF-MALE-MIN-WT             PIC 999.
  6180             20  CF-MALE-MAX-WT             PIC 999.
  6181         16  FILLER                         PIC X(428).
  6182******************************************************************
  6183*             AUTOMATIC ACTIVITY RECORD                          *
  6184******************************************************************
  6185     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6186         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6187             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6188             20  CF-SYS-LETTER-ID           PIC X(04).
  6189             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6190             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6191             20  CF-SYS-RESET-SW            PIC X(01).
  6192             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6193             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6194
  6195         16  FILLER                         PIC X(50).
  6196
  6197         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6198             20  CF-USER-ACTIVE-SW          PIC X(01).
  6199             20  CF-USER-LETTER-ID          PIC X(04).
  6200             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6201             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6202             20  CF-USER-RESET-SW           PIC X(01).
  6203             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6204             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6205             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6206
  6207         16  FILLER                         PIC X(246).
  6208
  6209*                                COPY ELCACTQ.
  6210******************************************************************
  6211*                                                                *
  6212*                            ELCACTQ.                            *
  6213*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6214*                            VMOD=2.004                          *
  6215*                                                                *
  6216*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6217*                                                                *
  6218*   FILE TYPE = VSAM,KSDS                                        *
  6219*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6220*                                                                *
  6221*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 112
* EL131.cbl
  6222*       ALTERNATE INDEX = NONE                                   *
  6223*                                                                *
  6224*   LOG = YES                                                    *
  6225*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6226*                                                                *
  6227*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6228******************************************************************
  6229
  6230 01  ACTIVITY-QUE.
  6231     12  AQ-RECORD-ID                PIC XX.
  6232         88  VALID-AQ-ID                VALUE 'AQ'.
  6233
  6234     12  AQ-CONTROL-PRIMARY.
  6235         16  AQ-COMPANY-CD           PIC X.
  6236         16  AQ-CARRIER              PIC X.
  6237         16  AQ-CLAIM-NO             PIC X(7).
  6238         16  AQ-CERT-NO.
  6239             20  AQ-CERT-PRIME       PIC X(10).
  6240             20  AQ-CERT-SFX         PIC X.
  6241
  6242     12  AQ-PENDING-ACTIVITY-FLAGS.
  6243         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6244         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6245             88  PENDING-PAYMENTS       VALUE '1'.
  6246         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6247             88  PENDING-FULL-PRINT     VALUE '1'.
  6248             88  PENDING-PART-PRINT     VALUE '2'.
  6249         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6250             88  PENDING-LETTERS        VALUE '1'.
  6251         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6252             88  PENDING-RESTORE        VALUE 'C'.
  6253             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6254
  6255     12  FILLER                      PIC X(20).
  6256
  6257     12  AQ-RESEND-DATE              PIC XX.
  6258     12  AQ-FOLLOWUP-DATE            PIC XX.
  6259     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6260     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6261     12  AQ-AUTO-LETTER              PIC X(4).
  6262     12  FILLER                      PIC XX.
  6263     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6264*****************************************************************
  6265
  6266*                                COPY ERCACCT.
  6267******************************************************************
  6268*                                                                *
  6269*                                                                *
  6270*                            ERCACCT                             *
  6271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6272*                            VMOD=2.031                          *
  6273*                                                                *
  6274*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6275*                                                                *
  6276*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6277*   VSAM ACCOUNT MASTER FILES.                                   *
  6278*                                                                *
  6279*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 113
* EL131.cbl
  6280*                                                                *
  6281*   FILE TYPE = VSAM,KSDS                                        *
  6282*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6283*                                                                *
  6284*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6285*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6286*                                                                *
  6287*   LOG = NO                                                     *
  6288*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6289*                                                                *
  6290*                                                                *
  6291******************************************************************
  6292*                   C H A N G E   L O G
  6293*
  6294* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6295*-----------------------------------------------------------------
  6296*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6297* EFFECTIVE    NUMBER
  6298*-----------------------------------------------------------------
  6299* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6300* 092705    2005050300006  PEMA  ADD SPP LEASES
  6301* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6302* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6303* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6304* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6305* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6306* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6307******************************************************************
  6308
  6309 01  ACCOUNT-MASTER.
  6310     12  AM-RECORD-ID                      PIC XX.
  6311         88  VALID-AM-ID                      VALUE 'AM'.
  6312
  6313     12  AM-CONTROL-PRIMARY.
  6314         16  AM-COMPANY-CD                 PIC X.
  6315         16  AM-MSTR-CNTRL.
  6316             20  AM-CONTROL-A.
  6317                 24  AM-CARRIER            PIC X.
  6318                 24  AM-GROUPING.
  6319                     28 AM-GROUPING-PREFIX PIC XXX.
  6320                     28 AM-GROUPING-PRIME  PIC XXX.
  6321                 24  AM-STATE              PIC XX.
  6322                 24  AM-ACCOUNT.
  6323                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6324                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6325             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6326                                           PIC X(19).
  6327             20  AM-CNTRL-B.
  6328                 24  AM-EXPIRATION-DT      PIC XX.
  6329                 24  FILLER                PIC X(4).
  6330             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6331                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6332
  6333     12  AM-CONTROL-BY-VAR-GRP.
  6334         16  AM-COMPANY-CD-A1              PIC X.
  6335         16  AM-VG-CARRIER                 PIC X.
  6336         16  AM-VG-GROUPING                PIC X(6).
  6337         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 114
* EL131.cbl
  6338         16  AM-VG-ACCOUNT                 PIC X(10).
  6339         16  AM-VG-DATE.
  6340             20  AM-VG-EXPIRATION-DT       PIC XX.
  6341             20  FILLER                    PIC X(4).
  6342         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6343                                           PIC 9(11)      COMP-3.
  6344     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6345         16  FILLER                        PIC X(10).
  6346         16  AM-VG-KEY3.
  6347             20  AM-VG3-ACCOUNT            PIC X(10).
  6348             20  AM-VG3-EXP-DT             PIC XX.
  6349         16  FILLER                        PIC X(4).
  6350     12  AM-MAINT-INFORMATION.
  6351         16  AM-LAST-MAINT-DT              PIC XX.
  6352         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6353         16  AM-LAST-MAINT-USER            PIC X(4).
  6354         16  FILLER                        PIC XX.
  6355
  6356     12  AM-EFFECTIVE-DT                   PIC XX.
  6357     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6358
  6359     12  AM-PREV-DATES  COMP-3.
  6360         16  AM-PREV-EXP-DT                PIC 9(11).
  6361         16  AM-PREV-EFF-DT                PIC 9(11).
  6362
  6363     12  AM-REPORT-CODE-1                  PIC X(10).
  6364     12  AM-REPORT-CODE-2                  PIC X(10).
  6365
  6366     12  AM-CITY-CODE                      PIC X(4).
  6367     12  AM-COUNTY-PARISH                  PIC X(6).
  6368
  6369     12  AM-NAME                           PIC X(30).
  6370     12  AM-PERSON                         PIC X(30).
  6371     12  AM-ADDRS                          PIC X(30).
  6372     12  AM-CITY.
  6373         16  AM-ADDR-CITY                  PIC X(28).
  6374         16  AM-ADDR-STATE                 PIC XX.
  6375     12  AM-ZIP.
  6376         16  AM-ZIP-PRIME.
  6377             20  AM-ZIP-PRI-1ST            PIC X.
  6378                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6379             20  FILLER                    PIC X(4).
  6380         16  AM-ZIP-PLUS4                  PIC X(4).
  6381     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6382         16  AM-CAN-POSTAL-1               PIC XXX.
  6383         16  AM-CAN-POSTAL-2               PIC XXX.
  6384         16  FILLER                        PIC XXX.
  6385     12  AM-TEL-NO.
  6386         16  AM-AREA-CODE                  PIC 999.
  6387         16  AM-TEL-PRE                    PIC 999.
  6388         16  AM-TEL-NBR                    PIC 9(4).
  6389     12  AM-TEL-LOC                        PIC X.
  6390         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6391         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6392
  6393     12  AM-COMM-STRUCTURE.
  6394         16  AM-DEFN-1.
  6395             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 115
* EL131.cbl
  6396                 24  AM-AGT.
  6397                     28  AM-AGT-PREFIX     PIC X(4).
  6398                     28  AM-AGT-PRIME      PIC X(6).
  6399                 24  AM-COM-TYP            PIC X.
  6400                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6401                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6402                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6403                 24  AM-RECALC-LV-INDIC    PIC X.
  6404                 24  AM-RETRO-LV-INDIC     PIC X.
  6405                 24  AM-GL-CODES           PIC X.
  6406                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6407                 24  FILLER                PIC X(01).
  6408         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6409             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6410                 24  FILLER                PIC X(11).
  6411                 24  AM-L-COMA             PIC XXX.
  6412                 24  AM-J-COMA             PIC XXX.
  6413                 24  AM-A-COMA             PIC XXX.
  6414                 24  FILLER                PIC X(6).
  6415
  6416     12  AM-COMM-CHANGE-STATUS             PIC X.
  6417         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6418
  6419     12  AM-CSR-CODE                       PIC X(4).
  6420
  6421     12  AM-BILLING-STATUS                 PIC X.
  6422         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6423         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6424     12  AM-AUTO-REFUND-SW                 PIC X.
  6425         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6426         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6427     12  AM-GPCD                           PIC 99.
  6428     12  AM-IG                             PIC X.
  6429         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6430         88  AM-HAS-GROUP                     VALUE '2'.
  6431     12  AM-STATUS                         PIC X.
  6432         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6433         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6434         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6435         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6436         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6437         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6438         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6439         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6440         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6441         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6442     12  AM-REMIT-TO                       PIC 99.
  6443     12  AM-ID-NO                          PIC X(11).
  6444
  6445     12  AM-CAL-TABLE                      PIC XX.
  6446     12  AM-LF-DEVIATION                   PIC XXX.
  6447     12  AM-AH-DEVIATION                   PIC XXX.
  6448     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6449     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6450     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6451     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6452     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6453     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 116
* EL131.cbl
  6454
  6455     12  AM-USER-FIELDS.
  6456         16  AM-FLD-1                      PIC XX.
  6457         16  AM-FLD-2                      PIC XX.
  6458         16  AM-FLD-3                      PIC XX.
  6459         16  AM-FLD-4                      PIC XX.
  6460         16  AM-FLD-5                      PIC XX.
  6461
  6462     12  AM-1ST-PROD-DATE.
  6463         16  AM-1ST-PROD-YR                PIC XX.
  6464         16  AM-1ST-PROD-MO                PIC XX.
  6465         16  AM-1ST-PROD-DA                PIC XX.
  6466     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6467     12  AM-CERTS-PURGED-DATE.
  6468         16  AM-PUR-YR                     PIC XX.
  6469         16  AM-PUR-MO                     PIC XX.
  6470         16  AM-PUR-DA                     PIC XX.
  6471     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6472     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6473     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6474     12  AM-INACTIVE-DATE.
  6475         16  AM-INA-MO                     PIC 99.
  6476         16  AM-INA-DA                     PIC 99.
  6477         16  AM-INA-YR                     PIC 99.
  6478     12  AM-AR-HI-CERT-DATE                PIC XX.
  6479
  6480     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6481     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6482
  6483     12  AM-OB-PAYMENT-MODE                PIC X.
  6484         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6485         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6486         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6487         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6488
  6489     12  AM-AH-ONLY-INDICATOR              PIC X.
  6490         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6491         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6492
  6493     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6494
  6495     12  AM-OVER-SHORT.
  6496         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6497         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6498
  6499     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6500     12  AM-DCC-CLP-STATE                  PIC XX.
  6501
  6502     12  AM-RECALC-COMM                    PIC X.
  6503     12  AM-RECALC-REIN                    PIC X.
  6504
  6505     12  AM-REI-TABLE                      PIC XXX.
  6506     12  AM-REI-ET-LF                      PIC X.
  6507     12  AM-REI-ET-AH                      PIC X.
  6508     12  AM-REI-PE-LF                      PIC X.
  6509     12  AM-REI-PE-AH                      PIC X.
  6510     12  AM-REI-PRT-ST                     PIC X.
  6511     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 117
* EL131.cbl
  6512     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6513     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6514     12  AM-REI-GROUP-A                    PIC X(6).
  6515     12  AM-REI-MORT                       PIC X(4).
  6516     12  AM-REI-PRT-OW                     PIC X.
  6517     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6518     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6519     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6520     12  AM-REI-GROUP-B                    PIC X(6).
  6521
  6522     12  AM-TRUST-TYPE                     PIC X(2).
  6523
  6524     12  AM-EMPLOYER-STMT-USED             PIC X.
  6525     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6526
  6527     12  AM-STD-AH-TYPE                    PIC XX.
  6528     12  AM-EARN-METHODS.
  6529         16  AM-EARN-METHOD-R              PIC X.
  6530             88 AM-REF-RL-R78                 VALUE 'R'.
  6531             88 AM-REF-RL-PR                  VALUE 'P'.
  6532             88 AM-REF-RL-MEAN                VALUE 'M'.
  6533             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6534         16  AM-EARN-METHOD-L              PIC X.
  6535             88 AM-REF-LL-R78                 VALUE 'R'.
  6536             88 AM-REF-LL-PR                  VALUE 'P'.
  6537             88 AM-REF-LL-MEAN                VALUE 'M'.
  6538             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6539         16  AM-EARN-METHOD-A              PIC X.
  6540             88 AM-REF-AH-R78                 VALUE 'R'.
  6541             88 AM-REF-AH-PR                  VALUE 'P'.
  6542             88 AM-REF-AH-MEAN                VALUE 'M'.
  6543             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6544             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6545             88 AM-REF-AH-NET                 VALUE 'N'.
  6546
  6547     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6548     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6549     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6550
  6551     12  AM-RET-Y-N                        PIC X.
  6552     12  AM-RET-P-E                        PIC X.
  6553     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6554     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6555     12  AM-RET-GRP                        PIC X(6).
  6556     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6557         16  AM-POOL-PRIME                 PIC XXX.
  6558         16  AM-POOL-SUB                   PIC XXX.
  6559     12  AM-RETRO-EARNINGS.
  6560         16  AM-RET-EARN-R                 PIC X.
  6561         16  AM-RET-EARN-L                 PIC X.
  6562         16  AM-RET-EARN-A                 PIC X.
  6563     12  AM-RET-ST-TAX-USE                 PIC X.
  6564         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6565         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6566     12  AM-RETRO-BEG-EARNINGS.
  6567         16  AM-RET-BEG-EARN-R             PIC X.
  6568         16  AM-RET-BEG-EARN-L             PIC X.
  6569         16  AM-RET-BEG-EARN-A             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 118
* EL131.cbl
  6570     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6571     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6572
  6573     12  AM-USER-SELECT-OPTIONS.
  6574         16  AM-USER-SELECT-1              PIC X(10).
  6575         16  AM-USER-SELECT-2              PIC X(10).
  6576         16  AM-USER-SELECT-3              PIC X(10).
  6577         16  AM-USER-SELECT-4              PIC X(10).
  6578         16  AM-USER-SELECT-5              PIC X(10).
  6579
  6580     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6581
  6582     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6583
  6584     12  AM-RPT045A-SWITCH                 PIC X.
  6585         88  RPT045A-OFF                   VALUE 'N'.
  6586
  6587     12  AM-INSURANCE-LIMITS.
  6588         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6589         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6590
  6591     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6592         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6593
  6594     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6595         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6596         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6597
  6598     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6599
  6600     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6601     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6602     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6603     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6604     12  AM-DCC-UEF-STATE                  PIC XX.
  6605     12  FILLER                            PIC XXX.
  6606     12  AM-REPORT-CODE-3                  PIC X(10).
  6607*    12  FILLER                            PIC X(22).
  6608
  6609     12  AM-RESERVE-DATE.
  6610         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6611         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6612         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6613
  6614     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6615     12  AM-NOTIFICATION-TYPES.
  6616         16  AM-NOTIF-OF-LETTERS           PIC X.
  6617         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6618         16  AM-NOTIF-OF-REPORTS           PIC X.
  6619         16  AM-NOTIF-OF-STATUS            PIC X.
  6620
  6621     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6622         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6623         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6624         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6625         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6626
  6627     12  AM-BENEFIT-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 119
* EL131.cbl
  6628         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6629             20  AM-BENEFIT-CODE           PIC XX.
  6630             20  AM-BENEFIT-TYPE           PIC X.
  6631             20  AM-BENEFIT-REVISION       PIC XXX.
  6632             20  AM-BENEFIT-REM-TERM       PIC X.
  6633             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6634             20  FILLER                    PIC XX.
  6635         16  FILLER                        PIC X(80).
  6636
  6637     12  AM-TRANSFER-DATA.
  6638         16  AM-TRANSFERRED-FROM.
  6639             20  AM-TRNFROM-CARRIER        PIC X.
  6640             20  AM-TRNFROM-GROUPING.
  6641                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6642                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6643             20  AM-TRNFROM-STATE          PIC XX.
  6644             20  AM-TRNFROM-ACCOUNT.
  6645                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6646                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6647             20  AM-TRNFROM-DTE            PIC XX.
  6648         16  AM-TRANSFERRED-TO.
  6649             20  AM-TRNTO-CARRIER          PIC X.
  6650             20  AM-TRNTO-GROUPING.
  6651                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6652                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6653             20  AM-TRNTO-STATE            PIC XX.
  6654             20  AM-TRNTO-ACCOUNT.
  6655                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6656                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6657             20  AM-TRNTO-DTE              PIC XX.
  6658         16  FILLER                        PIC X(10).
  6659
  6660     12  AM-SAVED-REMIT-TO                 PIC 99.
  6661
  6662     12  AM-COMM-STRUCTURE-SAVED.
  6663         16  AM-DEFN-1-SAVED.
  6664             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6665                 24  AM-AGT-SV             PIC X(10).
  6666                 24  AM-COM-TYP-SV         PIC X.
  6667                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6668                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6669                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6670                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6671                 24  FILLER                PIC X.
  6672                 24  AM-GL-CODES-SV        PIC X.
  6673                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6674                 24  FILLER                PIC X.
  6675         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6676             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6677                 24  FILLER                PIC X(11).
  6678                 24  AM-L-COMA-SV          PIC XXX.
  6679                 24  AM-J-COMA-SV          PIC XXX.
  6680                 24  AM-A-COMA-SV          PIC XXX.
  6681                 24  FILLER                PIC X(6).
  6682
  6683     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6684         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6685            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 120
* EL131.cbl
  6686            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6687            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6688
  6689     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6690     12  FILLER                            PIC X(120).
  6691
  6692     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6693         16  AM-CONTROL-NAME               PIC X(30).
  6694         16  AM-EXECUTIVE-ONE.
  6695             20  AM-EXEC1-NAME             PIC X(15).
  6696             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6697                                                          COMP-3.
  6698             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6699                                                          COMP-3.
  6700         16  AM-EXECUTIVE-TWO.
  6701             20  AM-EXEC2-NAME             PIC X(15).
  6702             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6703                                                          COMP-3.
  6704             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6705                                                          COMP-3.
  6706
  6707     12  AM-RETRO-ADDITIONAL-DATA.
  6708         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6709         16  AM-RETRO-PREM-P-E             PIC X.
  6710         16  AM-RETRO-CLMS-P-I             PIC X.
  6711         16  AM-RETRO-RET-BRACKET-LF.
  6712             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6713                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6714                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6715             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6716                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6717                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6718             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6719                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6720                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6721         16  AM-RETRO-RET-BRACKET-AH.
  6722             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6723                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6724                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6725                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6726             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6727                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6728                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6729             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6730                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6731                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6732
  6733     12  AM-COMMENTS.
  6734         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6735
  6736     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6737         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6738         16  AM-FLI-BILLING-CODE           PIC X.
  6739         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6740         16  AM-FLI-UNITED-IDENT           PIC X.
  6741         16  AM-FLI-INTEREST-LOST-DATA.
  6742             20  AM-FLI-BANK-NO            PIC X(5).
  6743             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 121
* EL131.cbl
  6744             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6745             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6746         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6747             20  AM-FLI-AGT                PIC X(9).
  6748             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6749             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6750         16  FILLER                        PIC X(102).
  6751
  6752     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6753         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6754             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6755             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6756             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6757             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6758             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6759         16  FILLER                          PIC X(10).
  6760******************************************************************
  6761
  6762*                                COPY ELCCHKQ.
  6763******************************************************************
  6764*                                                                *
  6765*                                                                *
  6766*                            ELCCHKQ.                            *
  6767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6768*                            VMOD=2.007                          *
  6769*                                                                *
  6770*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6771*                                                                *
  6772*   FILE TYPE = VSAM,KSDS                                        *
  6773*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6774*                                                                *
  6775*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6776*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6777*                                                                *
  6778*   LOG = YES                                                    *
  6779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6780******************************************************************
  6781 01  CHECK-QUE.
  6782     12  CQ-RECORD-ID                PIC XX.
  6783         88  VALID-CQ-ID         VALUE 'CQ'.
  6784
  6785     12  CQ-CONTROL-PRIMARY.
  6786         16  CQ-COMPANY-CD           PIC X.
  6787         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6788         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6789
  6790     12  CQ-CONTROL-BY-PAYEE.
  6791         16  CQ-CONTROL-BY-NUMBER.
  6792             20  CQ-COMPANY-CD-A1     PIC X.
  6793             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6794         16  CQ-PAYEE-CARRIER        PIC X.
  6795         16  CQ-PAYEE-GROUPING       PIC X(6).
  6796         16  CQ-PAYEE-STATE          PIC XX.
  6797         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6798         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6799
  6800     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6801         16  CQ-DMD-COMPANY-CD-A2    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 122
* EL131.cbl
  6802         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6803         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6804         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6805         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6806         16  FILLER                  PIC X(3).
  6807
  6808     12  CQ-ENTRY-TYPE               PIC X.
  6809             88  CHECK-ON-QUE           VALUE 'Q'.
  6810             88  ALIGNMENT-CHECK        VALUE 'A'.
  6811             88  SPOILED-CHECK          VALUE 'S'.
  6812             88  PAYMENT-ABORTED        VALUE 'X'.
  6813
  6814     12  CQ-CLAIM-MAST-CNTL.
  6815         16  CQ-CARRIER              PIC X.
  6816         16  CQ-CLAIM-NO             PIC X(7).
  6817         16  CQ-CERT-NO.
  6818             20  CQ-CERT-PRIME       PIC X(10).
  6819             20  CQ-CERT-SFX         PIC X.
  6820         16  CQ-CLAIM-TYPE           PIC X.
  6821             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6822             88  CQ-AH-CLAIM            VALUE 'A'.
  6823         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6824             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6825             88  CQ-O-B-COVERAGE        VALUE '2'.
  6826             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6827
  6828     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6829     12  CQ-CHECK-NUMBER             PIC X(7).
  6830     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6831     12  CQ-PAYMENT-TYPE             PIC X.
  6832             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6833             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6834             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6835             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6836             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6837             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6838             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6839             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6840     12  CQ-VOID-INDICATOR           PIC X.
  6841             88  CHECK-IS-STOPPED          VALUE 'S'.
  6842             88  CHECK-IS-VOID             VALUE 'V'.
  6843     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6844     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6845     12  CQ-CHECK-BY-USER            PIC X(4).
  6846     12  CQ-PRE-NUMBERING-SW         PIC X.
  6847       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6848       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6849
  6850     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6851     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6852     12  CQ-LEDGER-FLAG              PIC X(01).
  6853     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6854     12  CQ-LAST-UPDATED-DT          PIC XX.
  6855     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6856     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6857
  6858     12  FILLER                      PIC X(04).
  6859
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 123
* EL131.cbl
  6860******************************************************************
  6861
  6862*                                COPY ELCARCH.
  6863******************************************************************
  6864*                                                                *
  6865*                            ELCARCH.                            *
  6866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6867*                            VMOD=2.007                          *
  6868*                                                                *
  6869*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6870*                                                                *
  6871*   FILE TYPE = VSAM,KSDS                                        *
  6872*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6873*                                                                *
  6874*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6875*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6876*                                                                *
  6877*   LOG = NO                                                     *
  6878*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6879*                                                                *
  6880*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6881******************************************************************
  6882 01  LETTER-ARCHIVE.
  6883     12  LA-RECORD-ID                PIC XX.
  6884         88  VALID-LA-ID                VALUE 'LA'.
  6885
  6886     12  LA-CONTROL-PRIMARY.
  6887         16  LA-COMPANY-CD           PIC X.
  6888         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6889         16  LA-RECORD-TYPE          PIC X.
  6890             88  LA-HEADER-DATA         VALUE '1'.
  6891             88  LA-ADDRESS-DATA        VALUE '2'.
  6892             88  LA-TEXT-DATA           VALUE '3'.
  6893             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6894         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6895
  6896     12  LA-CONTROL-BY-TYPE.
  6897         16  LA-COMPANY-CD-A1        PIC X.
  6898         16  LA-RECORD-TYPE-A1       PIC X.
  6899         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6900         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6901
  6902     12  LA-TEXT-RECORD.
  6903         16  LA-SKIP-CONTROL         PIC XX.
  6904             88  NO-LINES-SKIPPED       VALUE SPACES.
  6905             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6906         16  LA-TEXT-LINE            PIC X(70).
  6907
  6908     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6909         16  FILLER                  PIC XX.
  6910         16  LA-ADDRESS-LINE         PIC X(30).
  6911         16  FILLER                  PIC X(40).
  6912
  6913     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6914         16  FILLER                  PIC XX.
  6915         16  LA-CARRIER              PIC X.
  6916         16  LA-CLAIM-NO             PIC X(7).
  6917         16  LA-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 124
* EL131.cbl
  6918             20  LA-CERT-PRIME       PIC X(10).
  6919             20  LA-CERT-SFX         PIC X.
  6920         16  LA-NO-OF-COPIES         PIC S9.
  6921         16  LA-RESEND-DATE          PIC XX.
  6922         16  LA-PROCESSOR-CD         PIC X(4).
  6923         16  LA-CREATION-DT          PIC XX.
  6924         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6925         16  LA-RESEND-PRINT-DATE    PIC XX.
  6926         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6927         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6928*
  6929* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6930*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6931*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6932*   I        20  LA-DMD-RES-ST           PIC XX.
  6933*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6934*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6935*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6936*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6937*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6938*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6939*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6940*   I        20  LA-DMD-UND-CODE         PIC XX.
  6941*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6942*   V    16  FILLER                  PIC X(15).
  6943* -----
  6944*
  6945* REINSERTED  CSO  MODS
  6946*
  6947         16  FILLER.
  6948             20  FILLER                  PIC X(29).
  6949             20  LA-CSO-LETTER-STATUS    PIC X.
  6950                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6951                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6952                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6953             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6954             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6955*
  6956
  6957     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6958         16  FILLER                  PIC XX.
  6959         16  LA4-CARRIER             PIC X.
  6960         16  LA4-CLAIM-NO            PIC X(7).
  6961         16  LA4-CERT-NO.
  6962             20  LA4-CERT-PRIME      PIC X(10).
  6963             20  LA4-CERT-SFX        PIC X.
  6964         16  LA4-NO-OF-COPIES        PIC S9.
  6965         16  LA4-RESEND-DATE         PIC XX.
  6966         16  LA4-PROCESSOR-CD        PIC X(4).
  6967         16  LA4-CREATION-DT         PIC XX.
  6968         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6969         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6970         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6971         16  LA4-FORM-TYPE           PIC X.
  6972             88  LA4-INITIAL-FORM    VALUE '1'.
  6973             88  LA4-PROGRESS-FORM   VALUE '2'.
  6974         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6975         16  LA4-STATE               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 125
* EL131.cbl
  6976         16  FILLER                  PIC X(31).
  6977******************************************************************
  6978
  6979*                                COPY ELCBENE.
  6980******************************************************************
  6981*                                                                *
  6982*                            ELCBENE.                            *
  6983*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6984*                            VMOD=2.006                          *
  6985*                                                                *
  6986*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6987*                                                                *
  6988*   FILE TYPE = VSAM,KSDS                                        *
  6989*   RECORD SIZE = 500   RECFORM = FIX                            *
  6990*                                                                *
  6991*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6992*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6993*                                                                *
  6994*   LOG = YES                                                    *
  6995*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6996*                                                                *
  6997*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6998******************************************************************
  6999
  7000 01  BENEFICIARY-MASTER.
  7001     12  BE-RECORD-ID                PIC XX.
  7002         88  VALID-BE-ID                VALUE 'BE'.
  7003
  7004     12  BE-CONTROL-PRIMARY.
  7005         16  BE-COMPANY-CD           PIC X.
  7006         16  BE-RECORD-TYPE          PIC X.
  7007             88  BENEFICIARY-RECORD  VALUE 'B'.
  7008             88  ADJUSTOR-RECORD     VALUE 'A'.
  7009         16  BE-BENEFICIARY          PIC X(10).
  7010     12  BE-CONTROL-BY-NAME.
  7011         16  BE-COMPANY-CD-A1        PIC X.
  7012         16  BE-RECORD-TYPE-A1       PIC X.
  7013         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7014         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7015
  7016     12  BE-LAST-MAINT-DT            PIC XX.
  7017     12  BE-LAST-MAINT-BY            PIC X(4).
  7018     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7019
  7020     12  BE-ADDRESS-DATA.
  7021         16  BE-MAIL-TO-NAME         PIC X(30).
  7022         16  BE-ADDRESS-LINE-1       PIC X(30).
  7023         16  BE-ADDRESS-LINE-2       PIC X(30).
  7024         16  BE-ADDRESS-LINE-3       PIC X(30).
  7025         16  BE-CITY-STATE.
  7026             20  BE-CITY             PIC X(28).
  7027             20  BE-STATE            PIC XX.
  7028         16  BE-ZIP-CODE.
  7029             20  BE-ZIP-PRIME.
  7030                 24  BE-ZIP-1ST      PIC X.
  7031                     88  BE-CANADIAN-POST-CODE
  7032                                         VALUE 'A' THRU 'Z'.
  7033                 24  FILLER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 126
* EL131.cbl
  7034             20  BE-ZIP-PLUS4        PIC X(4).
  7035         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7036             20  BE-CAN-POSTAL-1     PIC XXX.
  7037             20  BE-CAN-POSTAL-2     PIC XXX.
  7038             20  FILLER              PIC XXX.
  7039         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7040         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7041
  7042******************************************************************
  7043*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7044*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7045******************************************************************
  7046     12  BE-CARRIER                  PIC X.
  7047
  7048     12  BE-ADDRESS-DATA2.
  7049         16  BE-MAIL-TO-NAME2        PIC X(30).
  7050         16  BE-ADDRESS-LINE-12      PIC X(30).
  7051         16  BE-ADDRESS-LINE-22      PIC X(30).
  7052         16  BE-ADDRESS-LINE-32      PIC X(30).
  7053         16  BE-CITY-STATE2.
  7054             20  BE-CITY2            PIC X(28).
  7055             20  BE-STATE2           PIC XX.
  7056         16  BE-ZIP-CODE2.
  7057             20  BE-ZIP-PRIME2.
  7058                 24  BE-ZIP-1ST2     PIC X.
  7059                     88  BE-CANADIAN-POST-CODE2
  7060                                         VALUE 'A' THRU 'Z'.
  7061                 24  FILLER          PIC X(4).
  7062             20  BE-ZIP-PLUS42       PIC X(4).
  7063         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7064             20  BE-CAN-POSTAL-12    PIC XXX.
  7065             20  BE-CAN-POSTAL-22    PIC XXX.
  7066             20  FILLER              PIC XXX.
  7067         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7068         16  BE-ACH-DATA.
  7069             20  BE-ACH-YES-OR-NO    PIC X.
  7070                 88  BE-ON-ACH       VALUE 'Y'.
  7071                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7072             20  BE-ACH-ABA-ROUTING-NUMBER
  7073                                     PIC X(15).
  7074             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7075                                     PIC X(20).
  7076             20  FILLER              PIC X(25).
  7077         16  BE-BILLING-STMT-DATA.
  7078*            20  BE-BSR              PIC X.
  7079*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7080*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7081*            20  BE-BSR-FROM         PIC X(30).
  7082*            20  BE-BSR-DEPT         PIC X(30).
  7083             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7084             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7085             20  BE-OUTPUT-TYPE      PIC X.
  7086                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7087                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7088
  7089     12  FILLER                      PIC X(28).
  7090******************************************************************
  7091
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 127
* EL131.cbl
  7092*                                COPY ELCDAR.
  7093******************************************************************
  7094*                                                                *
  7095*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7096*   FILE TYPE = VSAM,KSDS                                        *
  7097*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7098*   BASE CLUSTER = DLYACTV                                       *
  7099*   LOG = YES                                                    *
  7100*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7101*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7102*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7103*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7104*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7105*               BY PROGRAM "LGINFCE".                            *
  7106*                                                                *
  7107******************************************************************
  7108 01  DAILY-ACTIVITY-RECORD.
  7109     05  DA-KEY.
  7110         10  DA-COMP-CD          PIC X.
  7111         10  DA-CARRIER          PIC X.
  7112         10  DA-CLAIM-NO         PIC X(7).
  7113         10  DA-CERT-NO.
  7114             15  DA-CERT-PRIME   PIC X(10).
  7115             15  DA-CERT-SFX     PIC X.
  7116     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7117     05  DA-RECORD-TYPE          PIC X.
  7118     05  FILLER                  PIC X(2).
  7119******************************************************************
  7120
  7121*                                COPY ELCALPH.
  7122******************************************************************
  7123*                                                                *
  7124*                            ELCALPH.                            *
  7125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7126*                            VMOD=2.003                          *
  7127*                                                                *
  7128*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7129*                                                                *
  7130*   FILE TYPE = VSAM,KSDS                                        *
  7131*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7132*                                                                *
  7133*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7134*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7135*                                                                *
  7136*   LOG = YES                                                    *
  7137*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7138*                                                                *
  7139*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7140******************************************************************
  7141
  7142 01  ALPHA-INDEX.
  7143     12  AI-RECORD-ID                         PIC XX.
  7144         88  VALID-AI-ID                  VALUE 'AI'.
  7145     12  AI-CONTROL-PRIMARY.
  7146         16  AI-COMPANY-CD                     PIC X.
  7147         16  AI-SOURCE                         PIC X.
  7148             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7149             88  AI-ADMIN-SYSTEM          VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 128
* EL131.cbl
  7150         16  AI-NAME.
  7151             20  AI-LAST-NAME                  PIC X(15).
  7152             20  AI-FIRST-NAME.
  7153                 24  AI-FIRST-INITIAL          PIC X.
  7154                 24  FILLER                    PIC X(11).
  7155             20  AI-MIDDLE-INIT                PIC X.
  7156         16  AI-DATE                           PIC X(8).
  7157         16  AI-TIME                           PIC S9(07) COMP-3.
  7158
  7159     12  AI-CONTROL-BY-ADMIN-KEY.
  7160         16  AI-CM-COMPANY-CD                  PIC X.
  7161         16  AI-CM-SOURCE                      PIC X.
  7162         16  AI-CM-CARRIER                     PIC X.
  7163         16  AI-CM-GROUPING.
  7164             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7165             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7166         16  AI-CM-STATE                       PIC XX.
  7167         16  AI-CM-PRODUCER.
  7168             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7169             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7170         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7171         16  AI-CM-CERTIFICATE-NUMBER.
  7172             20  AI-CM-CERT-PRIME              PIC X(10).
  7173             20  AI-CM-CERT-SFX                PIC X.
  7174         16  AI-CM-DATE                        PIC X(8).
  7175         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7176         16  FILLER                            PIC X(11).
  7177
  7178     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7179         AI-CONTROL-BY-ADMIN-KEY.
  7180         16  AI-CL-COMPANY-CD                  PIC X.
  7181         16  AI-CL-SOURCE                      PIC X.
  7182         16  AI-CL-CARRIER                     PIC X.
  7183         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7184         16  AI-CL-CERTIFICATE-NUMBER.
  7185             20  AI-CL-CERT-PRIME              PIC X(10).
  7186             20  AI-CL-CERT-SFX                PIC X.
  7187         16  AI-CL-DATE                        PIC X(8).
  7188         16  AI-CL-INCURRED-DATE               PIC XX.
  7189         16  AI-CL-CLOSE-DATE                  PIC XX.
  7190         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7191         16  AI-CREDIT-CARD-NUMBER.
  7192             20  AI-CCN.
  7193                 24  AI-CCN-PREFIX             PIC X(4).
  7194                 24  AI-CCN-PRIME              PIC X(12).
  7195             20  AI-CCN-FILLER                 PIC X(4).
  7196
  7197     12  AI-MAINT-INFO.
  7198         16  AI-LAST-MAINT-BY                  PIC X(4).
  7199         16  AI-LAST-MAINT-DT                  PIC XX.
  7200         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7201
  7202     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7203
  7204     12  FILLER                                PIC X(15).
  7205
  7206
  7207*                                COPY ERCDMDNT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 129
* EL131.cbl
  7208******************************************************************
  7209*                                                                *
  7210*                            ERCDMDNT                            *
  7211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7212*                            VMOD=2.005                          *
  7213*                                                                *
  7214*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7215*                                                                *
  7216*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7217*                                                                *
  7218*        FILE TYPE= VSAM,KSDS                                    *
  7219*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7220*                                                                *
  7221*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7222*                                                                *
  7223*        LOG = YES                                               *
  7224*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7225*                                                                *
  7226******************************************************************
  7227
  7228 01  CERTIFICATE-NOTE.
  7229     12  CN-RECORD-ID                     PIC  XX.
  7230         88  VALID-CN-ID                      VALUE 'CN'.
  7231
  7232     12  CN-CONTROL-PRIMARY.
  7233         16  CN-COMPANY-CD                PIC X.
  7234         16  CN-CERT-KEY.
  7235             20  CN-CARRIER               PIC X.
  7236             20  CN-GROUPING.
  7237                 24  CN-GROUPING-PREFIX   PIC XXX.
  7238                 24  CN-GROUPING-PRIME    PIC XXX.
  7239             20  CN-STATE                 PIC XX.
  7240             20  CN-ACCOUNT.
  7241                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7242                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7243             20  CN-CERT-EFF-DT           PIC XX.
  7244             20  CN-CERT-NO.
  7245                 24  CN-CERT-PRIME        PIC X(10).
  7246                 24  CN-CERT-SFX          PIC X.
  7247
  7248     12  CN-BILLING-START-LINE-NO         PIC 99.
  7249     12  CN-BILLING-END-LINE-NO           PIC 99.
  7250
  7251     12  CN-LINES.
  7252         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7253
  7254     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7255         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7256         16  CN-CSI-GENERAL-DATA-AREA.
  7257             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7258
  7259         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7260             CN-CSI-GENERAL-DATA-AREA.
  7261             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7262             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7263             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7264             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7265             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 130
* EL131.cbl
  7266             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7267             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7268             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7269             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7270             20  FILLER                       PIC XX.
  7271             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7272             20  FILLER                       PIC X(38).
  7273
  7274         16  CN-CSI-PRODUCT-DATA-AREA.
  7275             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7276
  7277         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7278             CN-CSI-PRODUCT-DATA-AREA.
  7279             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7280             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7281             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7282             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7283             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7284             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7285             20  FILLER                   PIC XX.
  7286             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7287             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7288             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7289             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7290             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7291             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7292             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7293             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7294             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7295             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7296             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7297             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7298             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7299             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7300             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7301             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7302             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7303             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7304             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7305             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7306             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7307             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7308             20  FILLER                   PIC X(25).
  7309
  7310         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7311             CN-CSI-CREDIT-CARD-DATA.
  7312             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7313             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7314             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7315             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7316             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7317             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7318             20  FILLER                   PIC XX.
  7319             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7320             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7321             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7322             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7323             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 131
* EL131.cbl
  7324             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7325             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7326             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7327             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7328             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7329             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7330             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7331             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7332             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7333             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7334             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7335             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7336             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7337             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7338             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7339             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7340             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7341             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7342             20  FILLER                   PIC X(17).
  7343
  7344         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7345             CN-CSI-FAMILY-LEAVE-DATA.
  7346             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7347             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7348             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7349             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7350             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7351             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7352             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7353             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7354             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7355             20  CN-CSI-SL-INT-ON-PROCEEDS
  7356                                          PIC S9(5)V99  COMP-3.
  7357             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7358             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7359             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7360             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7361             20  CN-CSI-SL-POLICY-BENEFITS
  7362                                          PIC S9(5)V99  COMP-3.
  7363             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7364             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7365             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7366             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7367             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7368             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7369             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7370             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7371             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7372             20  CN-CSI-SL-STATE-NOT      PIC X.
  7373             20  FILLER                   PIC XX.
  7374
  7375         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7376             CN-CSI-SENIOR-LIFE-DATA.
  7377             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7378             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7379             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7380                                          PIC S9(5)V99  COMP-3.
  7381             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 132
* EL131.cbl
  7382             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7383             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7384             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7385             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7386             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7387             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7388             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7389             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7390             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7391             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7392             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7393             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7394             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7395             20  CN-CSI-PP-REPAIR         PIC X.
  7396             20  CN-CSI-PP-REPLACE        PIC X.
  7397             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7398             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7399             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7400             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7401             20  FILLER                   PIC X(5).
  7402
  7403         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7404             CN-CSI-PURCH-PROP-DATA.
  7405             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7406             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7407             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7408             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7409             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7410             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7411             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7412             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7413             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7414             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7415             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7416             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7417             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7418             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7419             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7420             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7421             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7422             20  CN-CSI-EW-REPLACE        PIC X.
  7423             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7424             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7425             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7426             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7427             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7428             20  FILLER                   PIC X(4).
  7429
  7430     12  CN-LAST-MAINT-DT                 PIC XX.
  7431     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7432     12  CN-LAST-MAINT-USER               PIC X(4).
  7433     12  FILLER                           PIC X(6).
  7434
  7435******************************************************************
  7436
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 133
* EL131.cbl
  7438 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7439                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7440                          CONTROL-FILE ACTIVITY-QUE
  7441                          ACCOUNT-MASTER CHECK-QUE
  7442                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7443                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7444                          CERTIFICATE-NOTE.
  7445 0000-DFHEXIT SECTION.
  7446     MOVE '9#                    $   ' TO DFHEIV0.
  7447     MOVE 'EL131' TO DFHEIV1.
  7448     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7449
  7450     IF EIBCALEN = ZERO
  7451         GO TO 8800-UNAUTHORIZED-ACCESS.
  7452
  7453     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7454     MOVE '5'                    TO DC-OPTION-CODE.
  7455     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7456     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7457     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7458     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7459
  7460     IF SAVE-DATE-YY GREATER 70
  7461         MOVE 19                 TO SAVE-DATE-CC
  7462      ELSE
  7463         MOVE 20                 TO SAVE-DATE-CC.
  7464
  7465
  7466* EXEC CICS HANDLE CONDITION
  7467*        PGMIDERR (8820-XCTL-ERROR)
  7468*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7469*        ERROR    (9990-ABEND)
  7470*    END-EXEC.
  7471*    MOVE '"$LI.                 ! " #00007461' TO DFHEIV0
  7472     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7474     MOVE X'2220233030303037343631' TO DFHEIV0(25:11)
  7475     CALL 'kxdfhei1' USING DFHEIV0
  7476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7477
  7478
  7479     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7480     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7481     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7482
  7483     INITIALIZE    EDIT-WORK-AREA.
  7484     MOVE '/'                    TO WORK-SLASH.
  7485     MOVE SPACES                 TO ERROR-SWITCHES.
  7486
  7487     MOVE TRAN-ID                TO TRANS-ID.
  7488     MOVE EIBTRMID               TO PI-TERM.
  7489     MOVE MAP-ID                 TO PI-QUAL.
  7490
  7491     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7492
  7493     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7494         MOVE LOW-VALUES         TO EL131AO
  7495         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 134
* EL131.cbl
  7496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7497         MOVE -1                 TO MAINTL
  7498         GO TO 8110-SEND-DATA.
  7499
  7500     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7501         MOVE LOW-VALUES         TO EL131AO
  7502         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7503         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7504         MOVE 'X'                TO PI-RETURN-CD-1
  7505         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7506         MOVE -1                 TO MAINTL
  7507         IF WS-RETURNED-FROM = XCTL-EL114
  7508             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7509         END-IF
  7510         GO TO 8100-SEND-MAP.
  7511
  7512     IF EIBAID = DFHCLEAR
  7513         GO TO 8200-RETURN-PRIOR.
  7514
  7515     IF PI-PROCESSOR-ID = 'LGXX'
  7516         NEXT SENTENCE
  7517     ELSE
  7518
  7519* EXEC CICS READQ TS
  7520*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7521*            INTO    (SECURITY-CONTROL)
  7522*            LENGTH  (SC-COMM-LENGTH)
  7523*            ITEM    (SC-ITEM)
  7524*        END-EXEC
  7525*    MOVE '*$II   L              ''   #00007506' TO DFHEIV0
  7526     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7527     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7528     MOVE X'2020233030303037353036' TO DFHEIV0(25:11)
  7529     CALL 'kxdfhei1' USING DFHEIV0,
  7530           PI-SECURITY-TEMP-STORE-ID,
  7531           SECURITY-CONTROL,
  7532           SC-COMM-LENGTH,
  7533           SC-ITEM,
  7534           DFHEIV99,
  7535           DFHEIV99
  7536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7537         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7538         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7539         IF NOT DISPLAY-CAP
  7540             MOVE 'READ'               TO  SM-READ
  7541             PERFORM 9995-SECURITY-VIOLATION
  7542             MOVE ER-0070              TO  EMI-ERROR
  7543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7544             GO TO 8100-SEND-MAP.
  7545
  7546
  7547* EXEC CICS RECEIVE
  7548*        MAP    ('EL131A')
  7549*        MAPSET ('EL131S')
  7550*    END-EXEC.
  7551     MOVE 'EL131A' TO DFHEIV1
  7552     MOVE 'EL131S' TO DFHEIV2
  7553*    MOVE '8"T                   ''   #00007521' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 135
* EL131.cbl
  7554     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7555     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7556     MOVE X'2020233030303037353231' TO DFHEIV0(25:11)
  7557     CALL 'kxdfhei1' USING DFHEIV0,
  7558           DFHEIV1,
  7559           EL131AI,
  7560           DFHEIV99,
  7561           DFHEIV2,
  7562           DFHEIV99,
  7563           DFHEIV99
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7565
  7566
  7567     IF PFKEYL GREATER THAN ZERO
  7568         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7569
  7570     IF SCREEN-ERROR
  7571         MOVE ER-0004 TO EMI-ERROR
  7572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7573         MOVE -1 TO MAINTL
  7574         GO TO 8110-SEND-DATA.
  7575
  7576     IF EIBAID = DFHPF3
  7577         GO TO 8500-TRLR-MNT.
  7578
  7579     IF EIBAID = DFHPF4
  7580         GO TO 8600-ADDR-MNT.
  7581
  7582     IF EIBAID = DFHPF5
  7583         GO TO 8700-CERT-MNT.
  7584
  7585     IF PI-COMPANY-ID = 'DMD'
  7586       IF EIBAID = DFHPF6
  7587         GO TO 8750-DMD-CLM-FIX.
  7588
  7589     IF EIBAID = DFHPF7
  7590         GO TO 4000-FORCE-ERRORS.
  7591
  7592     IF EIBAID = DFHPF12
  7593         GO TO 8300-GET-HELP.
  7594
  7595     IF EIBAID = DFHPF15
  7596         GO TO 8725-BENEFICIARY-MNT
  7597     END-IF.
  7598
  7599     IF EIBAID = DFHPF23
  7600         GO TO 8810-PF23-ENTERED.
  7601
  7602     IF EIBAID = DFHPF24
  7603         GO TO 8400-RETURN-MASTER.
  7604
  7605     IF EIBAID NOT = DFHENTER
  7606         MOVE ER-0029            TO EMI-ERROR
  7607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7608         MOVE -1                 TO MAINTL
  7609         GO TO 8110-SEND-DATA.
  7610
  7611     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 136
* EL131.cbl
  7612         MOVE ER-0311            TO EMI-ERROR
  7613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7614         MOVE -1                 TO MAINTL
  7615         GO TO 8110-SEND-DATA.
  7616
  7617     IF MAINTI = 'A'
  7618         GO TO 0500-ADD-ALPHA-ONLY.
  7619
  7620     IF MAINTI = 'N'
  7621         GO TO 0600-CHANGE-NAME.
  7622
  7623     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7624
  7625     IF SCREEN-ERROR
  7626         GO TO 8110-SEND-DATA.
  7627
  7628     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7629         MOVE ER-0276            TO EMI-ERROR
  7630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7631         MOVE -1                 TO MAINTL
  7632         GO TO 8110-SEND-DATA.
  7633
  7634     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7635
  7636     IF SCREEN-ERROR
  7637         GO TO 8110-SEND-DATA.
  7638
  7639     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7640
  7641     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7642
  7643     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7644         GO TO 8110-SEND-DATA.
  7645
  7646     IF EMI-FATAL-CTR GREATER THAN ZERO
  7647         GO TO 8110-SEND-DATA.
  7648
  7649     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7650
  7651     IF WS-OPEN-CLOSE-SW = 'Y'
  7652         IF PI-LETTER-SW = 'Y'
  7653             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7654             MOVE 'T'            TO  CNTL-REC-TYPE
  7655             MOVE SPACES         TO  CNTL-PROC-ID
  7656             MOVE +0             TO  CNTL-SEQ-NO
  7657
  7658* EXEC CICS READ
  7659*                DATASET   (CNTL-FILE-ID)
  7660*                RIDFLD    (CNTL-KEY)
  7661*                SET       (ADDRESS OF CONTROL-FILE)
  7662*            END-EXEC
  7663*    MOVE '&"S        E          (   #00007616' TO DFHEIV0
  7664     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7666     MOVE X'2020233030303037363136' TO DFHEIV0(25:11)
  7667     CALL 'kxdfhei1' USING DFHEIV0,
  7668           CNTL-FILE-ID,
  7669           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 137
* EL131.cbl
  7670           DFHEIV99,
  7671           CNTL-KEY,
  7672           DFHEIV99,
  7673           DFHEIV99,
  7674           DFHEIV99
  7675     SET ADDRESS OF CONTROL-FILE TO
  7676         DFHEIV20
  7677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7678             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7679
  7680     MOVE ER-0000                TO EMI-ERROR.
  7681     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7682
  7683     MOVE SPACE                  TO MAINTO.
  7684     MOVE -1                     TO MAINTL.
  7685     GO TO 8100-SEND-MAP.
  7686
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 138
* EL131.cbl
  7688 0100-UPDATE-PI.
  7689
  7690     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7691     IF WS-RETURNED-FROM = XCTL-EL114
  7692***sometimes there is crap in positions 7-10 when no code was sele
  7693        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7694          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7695        END-IF
  7696     END-IF.
  7697
  7698     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7699         GO TO 0110-UPDATE-UP.
  7700
  7701     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7702     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7703     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7704     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7705     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7706     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7707     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7708     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7709     GO TO 0120-UPDATE-PI-EXIT.
  7710
  7711 0110-UPDATE-UP.
  7712     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7713     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7714     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7715     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7716     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7717     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7718     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7719     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7720
  7721
  7722* EXEC CICS HANDLE CONDITION
  7723*         QIDERR    (0130-TS-ERROR)
  7724*         ITEMERR   (0130-TS-ERROR)
  7725*    END-EXEC.
  7726*    MOVE '"$N<                  ! # #00007664' TO DFHEIV0
  7727     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7729     MOVE X'2320233030303037363634' TO DFHEIV0(25:11)
  7730     CALL 'kxdfhei1' USING DFHEIV0
  7731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7732
  7733
  7734     IF WS-RETURNED-FROM = XCTL-EL114
  7735
  7736* EXEC CICS READQ TS
  7737*            QUEUE    (PI-KEY)
  7738*            INTO     (EL131AI)
  7739*            LENGTH   (MAP-LENGTH)
  7740*       END-EXEC
  7741*    MOVE '*$I    L              ''   #00007670' TO DFHEIV0
  7742     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7743     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7744     MOVE X'2020233030303037363730' TO DFHEIV0(25:11)
  7745     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 139
* EL131.cbl
  7746           PI-KEY,
  7747           EL131AI,
  7748           MAP-LENGTH,
  7749           DFHEIV99,
  7750           DFHEIV99,
  7751           DFHEIV99
  7752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7753
  7754        IF WS-SAVE-BENEFICIARY > SPACES
  7755            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7756            MOVE +10            TO BENEL
  7757            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7758        END-IF
  7759        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7760     END-IF.
  7761
  7762
  7763* EXEC CICS READQ TS
  7764*         QUEUE    (PI-KEY)
  7765*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7766*         LENGTH   (PI-COMM-LENGTH)
  7767*    END-EXEC.
  7768*    MOVE '*$I    L              ''   #00007684' TO DFHEIV0
  7769     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7771     MOVE X'2020233030303037363834' TO DFHEIV0(25:11)
  7772     CALL 'kxdfhei1' USING DFHEIV0,
  7773           PI-KEY,
  7774           PROGRAM-INTERFACE-BLOCK,
  7775           PI-COMM-LENGTH,
  7776           DFHEIV99,
  7777           DFHEIV99,
  7778           DFHEIV99
  7779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7780
  7781
  7782
  7783* EXEC CICS DELETEQ TS
  7784*         QUEUE    (PI-KEY)
  7785*    END-EXEC.
  7786*    MOVE '*&                    #   #00007690' TO DFHEIV0
  7787     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7788     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7789     MOVE X'2020233030303037363930' TO DFHEIV0(25:11)
  7790     CALL 'kxdfhei1' USING DFHEIV0,
  7791           PI-KEY,
  7792           DFHEIV99
  7793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7794
  7795
  7796 0120-UPDATE-PI-EXIT.
  7797     EXIT.
  7798
  7799 0130-TS-ERROR.
  7800     MOVE LOW-VALUES             TO EL131AO.
  7801     MOVE ER-0192                TO EMI-ERROR.
  7802
  7803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 140
* EL131.cbl
  7804
  7805     GO TO 8100-SEND-MAP.
  7806
  7807 0200-TRANS-PF.
  7808     IF EIBAID NOT = DFHENTER
  7809         MOVE 'X'                TO ERROR-SWITCH
  7810         GO TO 0210-EXIT.
  7811
  7812     IF PFKEYI NOT NUMERIC
  7813         MOVE 'X'                TO ERROR-SWITCH
  7814         GO TO 0210-EXIT.
  7815
  7816     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7817
  7818     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7819         MOVE 'X' TO ERROR-SWITCH
  7820         GO TO 0210-EXIT.
  7821
  7822     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7823
  7824 0210-EXIT.
  7825     EXIT.
  7826
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 141
* EL131.cbl
  7828 0500-ADD-ALPHA-ONLY.
  7829******************************************************************
  7830*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7831*    RECORD.                                                     *
  7832******************************************************************
  7833
  7834     IF MLNAMEL = +0 AND
  7835        MFNAMEL = +0 AND
  7836        MMINITL = +0
  7837         MOVE ER-0797                TO  EMI-ERROR
  7838         MOVE -1                     TO  MAINTL
  7839         MOVE AL-UABON               TO  MAINTA
  7840         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7841         GO TO 8110-SEND-DATA.
  7842
  7843     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7844     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7845     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7846     MOVE PI-CERT-NO                 TO  CERT-NO.
  7847
  7848
  7849* EXEC CICS READ
  7850*        DATASET   (CLMS-FILE-ID)
  7851*        RIDFLD    (MSTR-KEY)
  7852*        SET       (ADDRESS OF CLAIM-MASTER)
  7853*    END-EXEC.
  7854*    MOVE '&"S        E          (   #00007746' TO DFHEIV0
  7855     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7857     MOVE X'2020233030303037373436' TO DFHEIV0(25:11)
  7858     CALL 'kxdfhei1' USING DFHEIV0,
  7859           CLMS-FILE-ID,
  7860           DFHEIV20,
  7861           DFHEIV99,
  7862           MSTR-KEY,
  7863           DFHEIV99,
  7864           DFHEIV99,
  7865           DFHEIV99
  7866     SET ADDRESS OF CLAIM-MASTER TO
  7867         DFHEIV20
  7868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7869
  7870
  7871
  7872* EXEC CICS GETMAIN
  7873*        SET       (ADDRESS OF ALPHA-INDEX)
  7874*        LENGTH    (ALPH-LENGTH)
  7875*        INITIMG   (GETMAIN-SPACE)
  7876*    END-EXEC.
  7877*    MOVE ',"IL                  $   #00007752' TO DFHEIV0
  7878     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7880     MOVE X'2020233030303037373532' TO DFHEIV0(25:11)
  7881     CALL 'kxdfhei1' USING DFHEIV0,
  7882           DFHEIV20,
  7883           ALPH-LENGTH,
  7884           GETMAIN-SPACE
  7885     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 142
* EL131.cbl
  7886         DFHEIV20
  7887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7888
  7889
  7890     MOVE 'AI'                       TO  AI-RECORD-ID.
  7891     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7892                                         AI-CL-COMPANY-CD.
  7893     MOVE 'C'                        TO  AI-SOURCE
  7894                                         AI-CL-SOURCE.
  7895
  7896     IF MLNAMEL IS GREATER THAN +0
  7897         MOVE MLNAMEI                TO  AI-LAST-NAME
  7898     ELSE
  7899         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7900
  7901     IF MFNAMEL IS GREATER THAN +0
  7902         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7903     ELSE
  7904         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7905
  7906     IF MMINITL IS GREATER THAN +0
  7907         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7908     ELSE
  7909         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7910
  7911     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7912     MOVE '5'                        TO  DC-OPTION-CODE.
  7913     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7914     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7915     IF BUILD-YEAR IS GREATER THAN 50
  7916         MOVE '19'                   TO  WS-ALPHA-YY-1
  7917         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7918         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7919         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7920     ELSE
  7921         MOVE '20'                   TO  WS-ALPHA-YY-1
  7922         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7923         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7924         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7925
  7926     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7927                                         AI-CL-DATE.
  7928
  7929     MOVE EIBTIME                    TO  AI-TIME
  7930                                         AI-CL-TIME.
  7931
  7932     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7933     MOVE 'C'                        TO  AI-CL-SOURCE.
  7934     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7935     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7936     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7937     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7938     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7939
  7940     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7941     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7942     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7943
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 143
* EL131.cbl
  7944
  7945* EXEC CICS WRITE
  7946*        DATASET   (ALPH-FILE-ID)
  7947*        RIDFLD    (AI-CONTROL-PRIMARY)
  7948*        FROM      (ALPHA-INDEX)
  7949*    END-EXEC.
  7950     MOVE LENGTH OF
  7951      ALPHA-INDEX
  7952       TO DFHEIV11
  7953*    MOVE '&$ L                  ''   #00007812' TO DFHEIV0
  7954     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7955     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7956     MOVE X'2020233030303037383132' TO DFHEIV0(25:11)
  7957     CALL 'kxdfhei1' USING DFHEIV0,
  7958           ALPH-FILE-ID,
  7959           ALPHA-INDEX,
  7960           DFHEIV11,
  7961           AI-CONTROL-PRIMARY,
  7962           DFHEIV99,
  7963           DFHEIV99
  7964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7965
  7966
  7967     MOVE LOW-VALUES                 TO  EL131AO.
  7968     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7969     MOVE ER-0000                    TO  EMI-ERROR.
  7970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7971     MOVE -1                         TO  MAINTL.
  7972     GO TO 8100-SEND-MAP.
  7973
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 144
* EL131.cbl
  7975 0600-CHANGE-NAME.
  7976******************************************************************
  7977*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7978*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7979******************************************************************
  7980
  7981     IF MLNAMEL = +0 AND
  7982        MFNAMEL = +0 AND
  7983        MMINITL = +0
  7984         MOVE ER-0276                TO  EMI-ERROR
  7985         MOVE -1                     TO  MAINTL
  7986         MOVE AL-UABON               TO  MAINTA
  7987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7988         GO TO 8110-SEND-DATA.
  7989
  7990     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7991     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7992     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7993     MOVE PI-CERT-NO                 TO  CERT-NO.
  7994
  7995
  7996* EXEC CICS READ
  7997*        DATASET   (CLMS-FILE-ID)
  7998*        RIDFLD    (MSTR-KEY)
  7999*        SET       (ADDRESS OF CLAIM-MASTER)
  8000*    END-EXEC.
  8001*    MOVE '&"S        E          (   #00007846' TO DFHEIV0
  8002     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8004     MOVE X'2020233030303037383436' TO DFHEIV0(25:11)
  8005     CALL 'kxdfhei1' USING DFHEIV0,
  8006           CLMS-FILE-ID,
  8007           DFHEIV20,
  8008           DFHEIV99,
  8009           MSTR-KEY,
  8010           DFHEIV99,
  8011           DFHEIV99,
  8012           DFHEIV99
  8013     SET ADDRESS OF CLAIM-MASTER TO
  8014         DFHEIV20
  8015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8016
  8017
  8018
  8019* EXEC CICS GETMAIN
  8020*        SET       (ADDRESS OF ALPHA-INDEX)
  8021*        LENGTH    (ALPH-LENGTH)
  8022*        INITIMG   (GETMAIN-SPACE)
  8023*    END-EXEC.
  8024*    MOVE ',"IL                  $   #00007852' TO DFHEIV0
  8025     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8027     MOVE X'2020233030303037383532' TO DFHEIV0(25:11)
  8028     CALL 'kxdfhei1' USING DFHEIV0,
  8029           DFHEIV20,
  8030           ALPH-LENGTH,
  8031           GETMAIN-SPACE
  8032     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 145
* EL131.cbl
  8033         DFHEIV20
  8034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8035
  8036
  8037     MOVE 'AI'                       TO  AI-RECORD-ID.
  8038     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8039                                         AI-CL-COMPANY-CD.
  8040     MOVE 'C'                        TO  AI-SOURCE
  8041                                         AI-CL-SOURCE.
  8042
  8043     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8044     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8045     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8046
  8047     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8048     MOVE '5'                        TO  DC-OPTION-CODE.
  8049     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8050     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8051     IF BUILD-YEAR IS GREATER THAN 50
  8052         MOVE '19'                   TO  WS-ALPHA-YY-1
  8053         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8054         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8055         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8056     ELSE
  8057         MOVE '20'                   TO  WS-ALPHA-YY-1
  8058         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8059         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8060         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8061
  8062     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8063                                         AI-CL-DATE.
  8064
  8065     MOVE EIBTIME                    TO  AI-TIME
  8066                                         AI-CL-TIME.
  8067
  8068     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8069     MOVE 'C'                        TO  AI-CL-SOURCE.
  8070     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8071     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8072     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8073     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8074     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8075
  8076     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8077     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8078     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8079
  8080     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8081         MOVE 'Y'                TO CL-YESNOSW
  8082     END-IF.
  8083
  8084
  8085* EXEC CICS WRITE
  8086*        DATASET   (ALPH-FILE-ID)
  8087*        RIDFLD    (AI-CONTROL-PRIMARY)
  8088*        FROM      (ALPHA-INDEX)
  8089*    END-EXEC.
  8090     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 146
* EL131.cbl
  8091      ALPHA-INDEX
  8092       TO DFHEIV11
  8093*    MOVE '&$ L                  ''   #00007905' TO DFHEIV0
  8094     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8095     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8096     MOVE X'2020233030303037393035' TO DFHEIV0(25:11)
  8097     CALL 'kxdfhei1' USING DFHEIV0,
  8098           ALPH-FILE-ID,
  8099           ALPHA-INDEX,
  8100           DFHEIV11,
  8101           AI-CONTROL-PRIMARY,
  8102           DFHEIV99,
  8103           DFHEIV99
  8104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8105
  8106
  8107
  8108* EXEC CICS READ
  8109*        DATASET   (CLMS-FILE-ID)
  8110*        RIDFLD    (MSTR-KEY)
  8111*        SET       (ADDRESS OF CLAIM-MASTER)
  8112*        UPDATE
  8113*    END-EXEC.
  8114*    MOVE '&"S        EU         (   #00007911' TO DFHEIV0
  8115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8117     MOVE X'2020233030303037393131' TO DFHEIV0(25:11)
  8118     CALL 'kxdfhei1' USING DFHEIV0,
  8119           CLMS-FILE-ID,
  8120           DFHEIV20,
  8121           DFHEIV99,
  8122           MSTR-KEY,
  8123           DFHEIV99,
  8124           DFHEIV99,
  8125           DFHEIV99
  8126     SET ADDRESS OF CLAIM-MASTER TO
  8127         DFHEIV20
  8128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8129
  8130
  8131     if (cl-priority-cd = '8')
  8132        and (pi-processor-id not = 'PEMA'and 'JMS '
  8133             AND 'AMWA' AND 'KMSB')
  8134        MOVE ER-8003             TO EMI-ERROR
  8135        PERFORM 9900-ERROR-FORMAT
  8136                                 THRU 9900-EXIT
  8137        MOVE -1                  TO MAINTL
  8138        GO TO 8110-SEND-DATA
  8139     end-if
  8140
  8141     IF MLNAMEL IS GREATER THAN +0
  8142         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8143
  8144     IF MFNAMEL IS GREATER THAN +0
  8145         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8146
  8147     IF MMINITL IS GREATER THAN +0
  8148         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 147
* EL131.cbl
  8149
  8150     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8151     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8152     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8153     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8154
  8155     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8156         MOVE 'Y'                TO CL-YESNOSW
  8157     END-IF.
  8158
  8159
  8160* EXEC CICS HANDLE CONDITION
  8161*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8162*    END-EXEC.
  8163*    MOVE '"$$                   ! $ #00007946' TO DFHEIV0
  8164     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8166     MOVE X'2420233030303037393436' TO DFHEIV0(25:11)
  8167     CALL 'kxdfhei1' USING DFHEIV0
  8168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8169
  8170
  8171
  8172* EXEC CICS REWRITE
  8173*        DATASET   (CLMS-FILE-ID)
  8174*        FROM      (CLAIM-MASTER)
  8175*    END-EXEC.
  8176     MOVE LENGTH OF
  8177      CLAIM-MASTER
  8178       TO DFHEIV11
  8179*    MOVE '&& L                  %   #00007950' TO DFHEIV0
  8180     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8181     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8182     MOVE X'2020233030303037393530' TO DFHEIV0(25:11)
  8183     CALL 'kxdfhei1' USING DFHEIV0,
  8184           CLMS-FILE-ID,
  8185           CLAIM-MASTER,
  8186           DFHEIV11,
  8187           DFHEIV99
  8188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8189
  8190
  8191 0600-CONTINUE-NAME-UPDATE.
  8192
  8193     MOVE LOW-VALUES                 TO  EL131AO.
  8194     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8195     MOVE ER-0000                    TO  EMI-ERROR.
  8196     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8197     MOVE -1                         TO  MAINTL.
  8198     GO TO 8100-SEND-MAP.
  8199
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 148
* EL131.cbl
  8201 1000-EDIT-SCREEN.
  8202
  8203     MOVE MAINTI                 TO CHECK-MAINT.
  8204
  8205     IF NOT VALID-OPTIONS
  8206         MOVE 'X'                TO ERROR-SWITCH
  8207         MOVE -1                 TO MAINTL
  8208         MOVE AL-UABON           TO MAINTA
  8209         MOVE ER-0023            TO EMI-ERROR
  8210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8211         GO TO 1010-EXIT.
  8212
  8213     IF NOT MODIFY-CAP
  8214         MOVE 'UPDATE'           TO  SM-READ
  8215         PERFORM 9995-SECURITY-VIOLATION
  8216         MOVE ER-0070               TO  EMI-ERROR
  8217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8218         GO TO 8100-SEND-MAP.
  8219
  8220     IF DELETE-CLAIM
  8221         MOVE AL-UANON TO MAINTA
  8222         GO TO 1010-EXIT.
  8223
  8224     MOVE AL-UANON               TO MAINTA.
  8225
  8226     IF CCNOI GREATER THAN LOW-VALUES
  8227         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8228
  8229     IF PI-COMPANY-ID = 'CSL'
  8230        CONTINUE
  8231     ELSE
  8232        IF TYPEL > ZERO
  8233           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8234              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8235                    PI-LIFE-OVERRIDE-L1))
  8236                       OR
  8237              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8238              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8239                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8240              MOVE AL-UANON      TO TYPEA
  8241              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8242           ELSE
  8243              MOVE ER-0199       TO EMI-ERROR
  8244              PERFORM 9900-ERROR-FORMAT
  8245                                 THRU 9900-EXIT
  8246              MOVE AL-UABON      TO TYPEA
  8247              MOVE -1            TO TYPEL
  8248              MOVE 'X'           TO ERROR-SWITCH
  8249           END-IF
  8250        ELSE
  8251           MOVE AL-UANOF         TO TYPEA
  8252        END-IF
  8253     END-IF
  8254     IF STATUSI GREATER THAN LOW-VALUES
  8255         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8256             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8257             MOVE AL-UANON       TO STATUSA
  8258             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 149
* EL131.cbl
  8259             MOVE 'Y'            TO DLYACTV-SW
  8260         ELSE
  8261             MOVE ER-0333        TO EMI-ERROR
  8262             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8263             MOVE AL-UABON       TO STATUSA
  8264             MOVE -1             TO STATUSL
  8265             MOVE 'X'            TO ERROR-SWITCH
  8266         END-IF
  8267     ELSE
  8268         MOVE SPACE              TO TRLR-SWITCH
  8269         MOVE 'N'                TO DLYACTV-SW
  8270         MOVE AL-UANOF           TO STATUSA.
  8271
  8272     IF PROCI GREATER THAN LOW-VALUES
  8273         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8274     ELSE
  8275         MOVE AL-UANOF TO PROCA.
  8276
  8277     IF SEXI GREATER THAN LOW-VALUES
  8278         IF SEXI = 'F' OR 'M'
  8279             MOVE AL-UANON       TO SEXA
  8280             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8281           ELSE
  8282             MOVE ER-0219        TO EMI-ERROR
  8283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8284             MOVE AL-UABON       TO SEXA
  8285             MOVE -1             TO SEXL
  8286             MOVE 'X'            TO ERROR-SWITCH
  8287       ELSE
  8288         MOVE AL-UANOF           TO SEXA.
  8289
  8290     IF BIRTHL = +0
  8291         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8292         MOVE AL-UANOF           TO  BIRTHA
  8293         GO TO 1000-CONTINUE-EDITS.
  8294
  8295     IF BIRTHI = SPACES
  8296         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8297         MOVE 'X'                TO  UPDATE-SWITCH
  8298                                     MSTR-SWITCH
  8299         GO TO 1000-CONTINUE-EDITS.
  8300
  8301     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8302     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8303     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8304     MOVE '4'                    TO  DC-OPTION-CODE.
  8305     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8306     IF DATE-CONVERSION-ERROR
  8307         MOVE ER-0220            TO  EMI-ERROR
  8308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8309         MOVE AL-UABON           TO  BIRTHA
  8310         MOVE -1                 TO  BIRTHL
  8311         MOVE 'X'                TO  ERROR-SWITCH
  8312         GO TO 1000-CONTINUE-EDITS.
  8313
  8314******************************************************************
  8315**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8316**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 150
* EL131.cbl
  8317**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8318******************************************************************
  8319     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8320         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8321         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8322         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8323         MOVE '4'                TO  DC-OPTION-CODE
  8324         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8325         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8326                                     DC-ELAPSED-DAYS
  8327         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8328         IF DATE-CONVERSION-ERROR
  8329             MOVE ER-0220        TO  EMI-ERROR
  8330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8331             MOVE AL-UABON       TO  BIRTHA
  8332             MOVE -1             TO  BIRTHL
  8333             MOVE 'X'            TO  ERROR-SWITCH
  8334             GO TO 1000-CONTINUE-EDITS.
  8335
  8336     MOVE AL-UANON               TO  BIRTHA.
  8337     MOVE 'X'                    TO  UPDATE-SWITCH
  8338                                     MSTR-SWITCH.
  8339     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8340     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8341     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8342
  8343 1000-CONTINUE-EDITS.
  8344
  8345     IF SOCIALI GREATER THAN LOW-VALUES
  8346         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8347         IF WS-SOC-SEC-NO NUMERIC AND
  8348           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8349             NEXT SENTENCE
  8350         ELSE
  8351            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8352               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8353               WS-SSN-DASH2 = '-'
  8354                 NEXT SENTENCE
  8355            ELSE
  8356                 MOVE ER-0887        TO  EMI-ERROR
  8357                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8358                 MOVE AL-UABON       TO  SOCIALA
  8359                 MOVE -1             TO  SOCIALL
  8360                 MOVE 'X'            TO  ERROR-SWITCH
  8361            END-IF
  8362        END-IF
  8363     END-IF.
  8364     if critpl > zeros
  8365        and critpi numeric
  8366        move al-uanon            to critpa
  8367        move 'X'                 to update-switch
  8368     end-if
  8369     IF SOCIALI GREATER THAN LOW-VALUES
  8370         MOVE AL-UANON           TO SOCIALA
  8371         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8372     ELSE
  8373         MOVE AL-UANOF           TO SOCIALA.
  8374
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 151
* EL131.cbl
  8375     IF OCCI GREATER THAN LOW-VALUES
  8376         MOVE AL-UANON           TO OCCA
  8377         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8378     ELSE
  8379         MOVE AL-UANOF           TO OCCA.
  8380
  8381     IF BENEL NOT GREATER THAN ZERO
  8382            GO TO 1005-CONTINUE-EDITS.
  8383
  8384     IF BENEI = SPACES
  8385        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8386           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8387           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8388           IF AUTO-PAY-TO-BENE = 'Y'
  8389               MOVE ER-1773      TO  EMI-ERROR
  8390               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8391               MOVE 'X'          TO ERROR-SWITCH
  8392               MOVE AL-UABON     TO BENEA
  8393               MOVE -1           TO BENEL
  8394           ELSE
  8395               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8396           END-IF
  8397        ELSE
  8398           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8399           IF PAYMENT-PENDING
  8400               MOVE ER-1772      TO  EMI-ERROR
  8401               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8402               MOVE 'X'          TO ERROR-SWITCH
  8403               MOVE AL-UABON     TO BENEA
  8404               MOVE -1           TO BENEL
  8405           END-IF
  8406           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8407        END-IF
  8408        GO TO 1005-CONTINUE-EDITS.
  8409
  8410
  8411* EXEC CICS HANDLE CONDITION
  8412*        NOTFND (1004-BENE-NOT-FOUND)
  8413*    END-EXEC.
  8414*    MOVE '"$I                   ! % #00008174' TO DFHEIV0
  8415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8417     MOVE X'2520233030303038313734' TO DFHEIV0(25:11)
  8418     CALL 'kxdfhei1' USING DFHEIV0
  8419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8420
  8421
  8422     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8423     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8424     MOVE BENEI                  TO  WS-ELBENE-ID.
  8425
  8426
  8427* EXEC CICS READ
  8428*        DATASET ('ELBENE')
  8429*        RIDFLD  (WS-ELBENE-KEY)
  8430*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8431*    END-EXEC.
  8432     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 152
* EL131.cbl
  8433*    MOVE '&"S        E          (   #00008182' TO DFHEIV0
  8434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8436     MOVE X'2020233030303038313832' TO DFHEIV0(25:11)
  8437     CALL 'kxdfhei1' USING DFHEIV0,
  8438           DFHEIV1,
  8439           DFHEIV20,
  8440           DFHEIV99,
  8441           WS-ELBENE-KEY,
  8442           DFHEIV99,
  8443           DFHEIV99,
  8444           DFHEIV99
  8445     SET ADDRESS OF BENEFICIARY-MASTER TO
  8446         DFHEIV20
  8447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8448
  8449
  8450     MOVE AL-UANON               TO  BENEA.
  8451     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8452
  8453     GO TO 1005-CONTINUE-EDITS.
  8454
  8455 1004-BENE-NOT-FOUND.
  8456     MOVE ER-0565                TO  EMI-ERROR.
  8457
  8458     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8459     MOVE 'X'                    TO ERROR-SWITCH.
  8460     MOVE AL-UABON               TO BENEA.
  8461     MOVE -1                     TO BENEL.
  8462
  8463 1005-CONTINUE-EDITS.
  8464
  8465     IF DIAGI GREATER THAN LOW-VALUES
  8466         MOVE AL-UANON           TO DIAGA
  8467         MOVE 'X'                TO UPDATE-SWITCH
  8468                                    NINETY-TRLR-SWITCH
  8469     ELSE
  8470         MOVE AL-UANOF           TO DIAGA.
  8471
  8472     IF ICD1I GREATER THAN LOW-VALUES
  8473         IF (ICD1I GREATER THAN SPACES) AND
  8474            (ICD1I(4:1) NOT = '.')
  8475             IF ICD1I(4:1) = ' '
  8476                 MOVE '.' TO ICD1I(4:1)
  8477             ELSE
  8478                 IF ICD1I(8:1) = ' '
  8479                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8480                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8481                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8482                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8483                     MOVE '.'        TO ICD1I(4:1)
  8484                 END-IF
  8485             END-IF
  8486         END-IF
  8487         IF (ICD1I GREATER THAN SPACES) AND
  8488            (ICD1I(1:1) NOT > ' ' OR
  8489             ICD1I(2:1) NOT > ' ' OR
  8490             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 153
* EL131.cbl
  8491             ICD1I(4:1) NOT = '.')
  8492              MOVE ER-0992        TO  EMI-ERROR
  8493              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8494              MOVE 'X'            TO ERROR-SWITCH
  8495              MOVE AL-UABON       TO ICD1A
  8496              MOVE -1             TO ICD1L
  8497         ELSE
  8498             MOVE AL-UANON       TO ICD1A
  8499             MOVE 'X'            TO UPDATE-SWITCH
  8500                                    NINETY-TRLR-SWITCH
  8501         END-IF
  8502     ELSE
  8503         MOVE AL-UANOF           TO ICD1A
  8504     END-IF.
  8505
  8506     IF ICD2I GREATER THAN LOW-VALUES
  8507         IF (ICD2I GREATER THAN SPACES) AND
  8508            (ICD2I(4:1) NOT = '.')
  8509             IF ICD2I(4:1) = ' '
  8510                 MOVE '.' TO ICD2I(4:1)
  8511             ELSE
  8512                 IF ICD2I(8:1) = ' '
  8513                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8514                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8515                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8516                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8517                     MOVE '.'        TO ICD2I(4:1)
  8518                 END-IF
  8519             END-IF
  8520         END-IF
  8521         IF (ICD2I GREATER THAN SPACES) AND
  8522            (ICD2I(1:1) NOT > ' ' OR
  8523             ICD2I(2:1) NOT > ' ' OR
  8524             ICD2I(3:1) NOT > ' ' OR
  8525             ICD2I(4:1) NOT = '.')
  8526              MOVE ER-0992        TO EMI-ERROR
  8527              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8528              MOVE 'X'            TO ERROR-SWITCH
  8529              MOVE AL-UABON       TO ICD2A
  8530              MOVE -1             TO ICD2L
  8531         ELSE
  8532             MOVE AL-UANON       TO ICD2A
  8533             MOVE 'X'            TO UPDATE-SWITCH
  8534                                    NINETY-TRLR-SWITCH
  8535         END-IF
  8536     ELSE
  8537         MOVE AL-UANOF           TO ICD2A
  8538     END-IF.
  8539
  8540*    IF CAUSEI GREATER THAN LOW-VALUES
  8541*        MOVE AL-UANON           TO CAUSEA
  8542*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8543*    ELSE
  8544*        MOVE AL-UANOF           TO CAUSEA.
  8545
  8546*    IF ENDL GREATER THAN ZERO
  8547*        MOVE LOW-VALUES         TO HOLD-END
  8548*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 154
* EL131.cbl
  8549*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8550*        ELSE
  8551*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8552*            EXEC CICS BIF DEEDIT
  8553*                FIELD    (DEEDIT-DATE-INPUT)
  8554*                LENGTH   (DATE-LENGTH)
  8555*            END-EXEC
  8556*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8557*            MOVE '4'            TO DC-OPTION-CODE
  8558*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8559*            IF NOT DATE-CONVERSION-ERROR
  8560*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8561*                MOVE AL-UANON   TO ENDA
  8562*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8563*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8564*            ELSE
  8565*                MOVE ER-0224    TO EMI-ERROR
  8566*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8567*                MOVE AL-UABON   TO ENDA
  8568*                MOVE -1         TO ENDL
  8569*                MOVE 'X'        TO ERROR-SWITCH
  8570*      ELSE
  8571*          MOVE AL-UANOF         TO ENDA.
  8572
  8573     IF INCL GREATER THAN ZERO
  8574         MOVE LOW-VALUES         TO HOLD-INCUR
  8575         IF INCI = SPACES
  8576             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8577         ELSE
  8578             MOVE INCI           TO DEEDIT-DATE-INPUT
  8579
  8580* EXEC CICS BIF DEEDIT
  8581*                FIELD    (DEEDIT-DATE-INPUT)
  8582*                LENGTH   (DATE-LENGTH)
  8583*            END-EXEC
  8584*    MOVE '@"L                   #   #00008317' TO DFHEIV0
  8585     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8586     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8587     MOVE X'2020233030303038333137' TO DFHEIV0(25:11)
  8588     CALL 'kxdfhei1' USING DFHEIV0,
  8589           DEEDIT-DATE-INPUT,
  8590           DATE-LENGTH
  8591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8592             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8593             MOVE '4'            TO DC-OPTION-CODE
  8594             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8595             IF NOT DATE-CONVERSION-ERROR
  8596                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8597                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8598                 MOVE AL-UANON           TO INCA
  8599                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8600             ELSE
  8601                 MOVE ER-0222    TO EMI-ERROR
  8602                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8603                 MOVE AL-UABON   TO INCA
  8604                 MOVE -1         TO INCL
  8605                 MOVE 'X'        TO ERROR-SWITCH
  8606       ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 155
* EL131.cbl
  8607           IF PI-NO-PMTS = ZEROS
  8608               MOVE AL-UANOF     TO INCA.
  8609
  8610     IF REPL GREATER THAN ZERO
  8611         MOVE LOW-VALUES         TO HOLD-REPORTED
  8612         IF REPI = SPACES
  8613             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8614         ELSE
  8615             MOVE REPI           TO DEEDIT-DATE-INPUT
  8616
  8617* EXEC CICS BIF DEEDIT
  8618*                FIELD    (DEEDIT-DATE-INPUT)
  8619*                LENGTH   (DATE-LENGTH)
  8620*            END-EXEC
  8621*    MOVE '@"L                   #   #00008345' TO DFHEIV0
  8622     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8623     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8624     MOVE X'2020233030303038333435' TO DFHEIV0(25:11)
  8625     CALL 'kxdfhei1' USING DFHEIV0,
  8626           DEEDIT-DATE-INPUT,
  8627           DATE-LENGTH
  8628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8629             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8630             MOVE '4'            TO DC-OPTION-CODE
  8631             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8632             IF NOT DATE-CONVERSION-ERROR
  8633                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8634                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8635                 MOVE AL-UANON   TO REPA
  8636                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8637             ELSE
  8638                 MOVE ER-0223    TO EMI-ERROR
  8639                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8640                 MOVE AL-UABON   TO REPA
  8641                 MOVE -1         TO REPL
  8642                 MOVE 'X'        TO ERROR-SWITCH
  8643       ELSE
  8644         MOVE AL-UANOF TO REPA.
  8645
  8646     IF PDTHRUI GREATER THAN LOW-VALUES
  8647        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8648        IF PDTHRUI = SPACES
  8649           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8650        ELSE
  8651           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8652
  8653* EXEC CICS BIF DEEDIT
  8654*               FIELD    (DEEDIT-DATE-INPUT)
  8655*               LENGTH   (DATE-LENGTH)
  8656*          END-EXEC
  8657*    MOVE '@"L                   #   #00008372' TO DFHEIV0
  8658     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8659     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8660     MOVE X'2020233030303038333732' TO DFHEIV0(25:11)
  8661     CALL 'kxdfhei1' USING DFHEIV0,
  8662           DEEDIT-DATE-INPUT,
  8663           DATE-LENGTH
  8664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 156
* EL131.cbl
  8665           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8666           MOVE '4'            TO DC-OPTION-CODE
  8667           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8668           IF NOT DATE-CONVERSION-ERROR
  8669              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8670              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8671              MOVE AL-UANON   TO PDTHRUA
  8672              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8673              IF PI-USES-PAID-TO
  8674                 MOVE '6'            TO DC-OPTION-CODE
  8675                 MOVE -1             TO DC-ELAPSED-DAYS
  8676                 MOVE +0             TO DC-ELAPSED-MONTHS
  8677                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8678                 IF NO-CONVERSION-ERROR
  8679                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8680                 ELSE
  8681                    NEXT SENTENCE
  8682              ELSE
  8683                 NEXT SENTENCE
  8684           ELSE
  8685              MOVE ER-0475    TO EMI-ERROR
  8686              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8687              MOVE AL-UABON   TO PDTHRUA
  8688              MOVE -1         TO PDTHRUL
  8689              MOVE 'X'        TO ERROR-SWITCH
  8690     ELSE
  8691        IF MODIFY-CAP
  8692           MOVE AL-UANOF        TO PDTHRUA.
  8693
  8694     IF PDAMTL GREATER THAN +0
  8695         MOVE ZEROS              TO HOLD-PDAMT
  8696
  8697* EXEC CICS BIF DEEDIT
  8698*            FIELD    (PDAMTI)
  8699*            LENGTH   (9)
  8700*        END-EXEC
  8701     MOVE 9
  8702       TO DFHEIV11
  8703*    MOVE '@"L                   #   #00008407' TO DFHEIV0
  8704     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8705     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8706     MOVE X'2020233030303038343037' TO DFHEIV0(25:11)
  8707     CALL 'kxdfhei1' USING DFHEIV0,
  8708           PDAMTI,
  8709           DFHEIV11
  8710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8711         IF PDAMTI NUMERIC
  8712             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8713             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8714             MOVE AL-UNNON       TO PDAMTA
  8715         ELSE
  8716             MOVE ER-0547        TO EMI-ERROR
  8717             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8718             MOVE AL-UNBON       TO PDAMTA
  8719             MOVE -1             TO PDAMTL
  8720             MOVE 'X'            TO ERROR-SWITCH
  8721     ELSE
  8722         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 157
* EL131.cbl
  8723            MOVE AL-UNNOF        TO PDAMTA.
  8724
  8725     IF NODAYSI GREATER THAN LOW-VALUES
  8726         MOVE ZEROS              TO HOLD-NODAYS
  8727
  8728* EXEC CICS BIF DEEDIT
  8729*            FIELD (NODAYSI)
  8730*            LENGTH (5)
  8731*        END-EXEC
  8732     MOVE 5
  8733       TO DFHEIV11
  8734*    MOVE '@"L                   #   #00008427' TO DFHEIV0
  8735     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8736     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8737     MOVE X'2020233030303038343237' TO DFHEIV0(25:11)
  8738     CALL 'kxdfhei1' USING DFHEIV0,
  8739           NODAYSI,
  8740           DFHEIV11
  8741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8742         IF NODAYSI NUMERIC
  8743             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8744             MOVE AL-UNNON       TO NODAYSA
  8745             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8746         ELSE
  8747             MOVE ER-0491        TO EMI-ERROR
  8748             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8749             MOVE AL-UNBON       TO NODAYSA
  8750             MOVE -1             TO NODAYSL
  8751             MOVE 'X'            TO ERROR-SWITCH
  8752     ELSE
  8753         IF MODIFY-CAP
  8754            MOVE AL-UNNOF        TO NODAYSA.
  8755
  8756     IF NOPMTSI GREATER THAN LOW-VALUES
  8757         MOVE ZEROS              TO HOLD-NOPMTS
  8758
  8759* EXEC CICS BIF DEEDIT
  8760*            FIELD (NOPMTSI)
  8761*            LENGTH (4)
  8762*        END-EXEC
  8763     MOVE 4
  8764       TO DFHEIV11
  8765*    MOVE '@"L                   #   #00008447' TO DFHEIV0
  8766     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8767     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8768     MOVE X'2020233030303038343437' TO DFHEIV0(25:11)
  8769     CALL 'kxdfhei1' USING DFHEIV0,
  8770           NOPMTSI,
  8771           DFHEIV11
  8772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8773         IF NOPMTSI NUMERIC
  8774             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8775             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8776             MOVE AL-UNNON       TO NOPMTSA
  8777           ELSE
  8778             MOVE ER-0548        TO EMI-ERROR
  8779             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8780             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 158
* EL131.cbl
  8781             MOVE -1             TO NOPMTSL
  8782             MOVE 'X'            TO ERROR-SWITCH
  8783       ELSE
  8784         IF MODIFY-CAP
  8785            MOVE AL-UNNOF        TO NOPMTSA.
  8786
  8787     IF FORMTYPI GREATER THAN LOW-VALUES
  8788         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8789             MOVE AL-UANON       TO FORMTYPA
  8790             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8791           ELSE
  8792             MOVE ER-7650        TO EMI-ERROR
  8793             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8794             MOVE AL-UABON       TO FORMTYPA
  8795             MOVE -1             TO FORMTYPL
  8796             MOVE 'X'            TO ERROR-SWITCH
  8797       ELSE
  8798         MOVE AL-UANOF           TO FORMTYPA.
  8799
  8800     IF PRICDL GREATER THAN ZERO
  8801         IF (PRICDI = ' ') OR
  8802            (PRICDI GREATER THAN ZERO   AND
  8803             PRICDI NOT GREATER THAN '9')
  8804             MOVE AL-UANON       TO PRICDA
  8805             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8806         ELSE
  8807             MOVE ER-0274        TO EMI-ERROR
  8808             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8809             MOVE AL-UABON       TO PRICDA
  8810             MOVE -1             TO PRICDL
  8811             MOVE 'X'            TO ERROR-SWITCH
  8812     ELSE
  8813         MOVE AL-UANOF TO PRICDA.
  8814
  8815     IF PI-COMPANY-ID = 'DMD'
  8816     IF PRICDL GREATER THAN ZERO
  8817       IF SYSTEM-MODIFY-CAP  OR
  8818          PI-PROCESSOR-ID = 'LGXX'
  8819             NEXT SENTENCE
  8820           ELSE
  8821            IF CL-PRIORITY-CD = '9'  OR
  8822               PRICDI         = '9'
  8823                  MOVE ER-0938        TO EMI-ERROR
  8824                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8825                  MOVE AL-UABON       TO PRICDA
  8826                  MOVE -1             TO PRICDL
  8827                  MOVE 'X'            TO ERROR-SWITCH.
  8828
  8829     IF FILETOL GREATER THAN ZERO
  8830         MOVE AL-UANON           TO FILETOA
  8831         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8832     ELSE
  8833         MOVE AL-UANOF TO FILETOA.
  8834
  8835     IF SUPVL GREATER THAN ZERO
  8836         IF SUPVI = 'Y' OR 'N' OR SPACE
  8837             MOVE AL-UANON       TO SUPVA
  8838             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 159
* EL131.cbl
  8839         ELSE
  8840             MOVE ER-0230        TO EMI-ERROR
  8841             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8842             MOVE AL-UABON       TO SUPVA
  8843             MOVE -1             TO SUPVL
  8844             MOVE 'X'            TO ERROR-SWITCH
  8845     ELSE
  8846         MOVE AL-UANOF           TO SUPVA.
  8847
  8848     IF MLNAMEL GREATER THAN ZERO
  8849         IF MLNAMEI GREATER THAN SPACES
  8850            MOVE AL-UANON        TO MLNAMEA
  8851            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8852                                     MSTR-KEY-SWITCH
  8853         ELSE
  8854            MOVE ER-0236         TO EMI-ERROR
  8855            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8856            MOVE AL-UABON        TO MLNAMEA
  8857            MOVE -1              TO MLNAMEL
  8858            MOVE 'X'             TO ERROR-SWITCH
  8859     ELSE
  8860         MOVE AL-UANOF           TO MLNAMEA.
  8861
  8862     IF MFNAMEI GREATER THAN LOW-VALUES
  8863         MOVE AL-UANON           TO MFNAMEA
  8864         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8865     ELSE
  8866         MOVE AL-UANOF           TO MFNAMEA.
  8867
  8868     IF MMINITI GREATER THAN LOW-VALUES
  8869         MOVE AL-UANON           TO MMINITA
  8870         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8871     ELSE
  8872         MOVE AL-UANOF           TO MMINITA.
  8873
  8874     IF CRTLNMEI GREATER THAN LOW-VALUES
  8875         IF CRTLNMEI NOT = SPACES
  8876            MOVE AL-UANON        TO CRTLNMEA
  8877            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8878                                     CERT-KEY-SWITCH
  8879        ELSE
  8880            MOVE ER-0236         TO EMI-ERROR
  8881            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8882            MOVE AL-UABON        TO CRTLNMEA
  8883            MOVE -1              TO CRTLNMEL
  8884            MOVE 'X'             TO ERROR-SWITCH
  8885     ELSE
  8886         MOVE AL-UANOF           TO CRTLNMEA.
  8887
  8888     IF CRTFNMEI GREATER THAN LOW-VALUES
  8889         MOVE AL-UANON           TO CRTFNMEA
  8890         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8891     ELSE
  8892         MOVE AL-UANOF           TO CRTFNMEA.
  8893
  8894     IF CRTINITI GREATER THAN LOW-VALUES
  8895         MOVE AL-UANON           TO CRTINITA
  8896         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 160
* EL131.cbl
  8897     ELSE
  8898         MOVE AL-UANOF           TO CRTINITA.
  8899
  8900     IF ISSAGEL GREATER THAN ZERO
  8901         IF ISSAGEI NUMERIC
  8902            MOVE AL-UANON        TO ISSAGEA
  8903            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8904         ELSE
  8905            MOVE ER-0237         TO EMI-ERROR
  8906            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8907            MOVE AL-UABON        TO ISSAGEA
  8908            MOVE -1              TO ISSAGEL
  8909            MOVE 'X'             TO ERROR-SWITCH
  8910     ELSE
  8911         MOVE AL-UANOF           TO ISSAGEA.
  8912
  8913     IF JNTFNMEI GREATER THAN LOW-VALUES
  8914         MOVE AL-UANON           TO JNTFNMEA
  8915         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8916     ELSE
  8917         MOVE AL-UANOF           TO JNTFNMEA.
  8918
  8919     IF JNTLNMEI GREATER THAN LOW-VALUES
  8920         MOVE AL-UANON           TO JNTLNMEA
  8921         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8922     ELSE
  8923         MOVE AL-UANOF           TO JNTLNMEA.
  8924
  8925     IF JNTINITI GREATER THAN LOW-VALUES
  8926         MOVE AL-UANON           TO JNTINITA
  8927         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8928     ELSE
  8929         MOVE AL-UANOF           TO JNTINITA.
  8930
  8931     IF JNTAGEL GREATER THAN ZERO
  8932         IF JNTAGEI NUMERIC
  8933            MOVE AL-UANON        TO JNTAGEA
  8934            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8935         ELSE
  8936            MOVE ER-0238         TO EMI-ERROR
  8937            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8938            MOVE AL-UABON        TO JNTAGEA
  8939            MOVE -1              TO JNTAGEL
  8940            MOVE 'X'             TO ERROR-SWITCH
  8941     ELSE
  8942         MOVE AL-UANOF           TO JNTAGEA.
  8943
  8944     IF ADDONDTI GREATER THAN LOW-VALUES
  8945         MOVE LOW-VALUES         TO HOLD-ADDON
  8946         IF ADDONDTI = SPACES
  8947             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8948         ELSE
  8949             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8950
  8951* EXEC CICS BIF DEEDIT
  8952*                FIELD    (DEEDIT-DATE-INPUT)
  8953*                LENGTH   (DATE-LENGTH)
  8954*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 161
* EL131.cbl
  8955*    MOVE '@"L                   #   #00008628' TO DFHEIV0
  8956     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8957     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8958     MOVE X'2020233030303038363238' TO DFHEIV0(25:11)
  8959     CALL 'kxdfhei1' USING DFHEIV0,
  8960           DEEDIT-DATE-INPUT,
  8961           DATE-LENGTH
  8962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8963             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8964             MOVE '4'            TO DC-OPTION-CODE
  8965             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8966             IF NOT DATE-CONVERSION-ERROR
  8967                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8968                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8969                                                  CERT-SWITCH
  8970                 MOVE AL-UANON   TO ADDONDTA
  8971                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8972             ELSE
  8973                 MOVE ER-7651    TO EMI-ERROR
  8974                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8975                 MOVE AL-UABON   TO ADDONDTA
  8976                 MOVE -1         TO ADDONDTL
  8977                 MOVE 'X'        TO ERROR-SWITCH
  8978       ELSE
  8979         MOVE AL-UANOF TO ADDONDTA.
  8980
  8981     IF LCVCDI GREATER THAN LOW-VALUES
  8982         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8983         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8984     ELSE
  8985         MOVE AL-UANOF           TO LCVCDA.
  8986
  8987     IF ACVCDI GREATER THAN LOW-VALUES
  8988         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8989         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8990     ELSE
  8991         MOVE AL-UANOF           TO ACVCDA.
  8992
  8993     IF LCVOTRMI GREATER THAN LOW-VALUES
  8994
  8995* EXEC CICS BIF DEEDIT
  8996*            FIELD (LCVOTRMI)
  8997*            LENGTH(3)
  8998*        END-EXEC
  8999     MOVE 3
  9000       TO DFHEIV11
  9001*    MOVE '@"L                   #   #00008663' TO DFHEIV0
  9002     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9003     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9004     MOVE X'2020233030303038363633' TO DFHEIV0(25:11)
  9005     CALL 'kxdfhei1' USING DFHEIV0,
  9006           LCVOTRMI,
  9007           DFHEIV11
  9008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9009         IF LCVOTRMI IS NUMERIC
  9010             MOVE LCVOTRMI       TO LCVOTRMO
  9011             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9012             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 162
* EL131.cbl
  9013         ELSE
  9014             MOVE ER-0241        TO EMI-ERROR
  9015             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9016             MOVE AL-UNBON       TO LCVOTRMA
  9017             MOVE 'X'            TO ERROR-SWITCH
  9018             MOVE -1             TO LCVOTRML
  9019     ELSE
  9020         MOVE AL-UANOF           TO LCVOTRMA.
  9021
  9022     IF ACVOTRMI GREATER THAN LOW-VALUES
  9023
  9024* EXEC CICS BIF DEEDIT
  9025*            FIELD (ACVOTRMI)
  9026*            LENGTH(3)
  9027*        END-EXEC
  9028     MOVE 3
  9029       TO DFHEIV11
  9030*    MOVE '@"L                   #   #00008681' TO DFHEIV0
  9031     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9032     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9033     MOVE X'2020233030303038363831' TO DFHEIV0(25:11)
  9034     CALL 'kxdfhei1' USING DFHEIV0,
  9035           ACVOTRMI,
  9036           DFHEIV11
  9037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9038         IF ACVOTRMI IS NUMERIC
  9039             MOVE ACVOTRMI       TO ACVOTRMO
  9040             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9041             MOVE AL-UANON       TO ACVOTRMA
  9042         ELSE
  9043             MOVE ER-0241        TO EMI-ERROR
  9044             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9045             MOVE AL-UNBON       TO ACVOTRMA
  9046             MOVE 'X'            TO ERROR-SWITCH
  9047             MOVE -1             TO ACVOTRML
  9048     ELSE
  9049         MOVE AL-UANOF           TO ACVOTRMA.
  9050
  9051     IF LCVRATEL GREATER THAN +0
  9052
  9053* EXEC CICS BIF DEEDIT
  9054*            FIELD (LCVRATEI)
  9055*            LENGTH(6)
  9056*        END-EXEC
  9057     MOVE 6
  9058       TO DFHEIV11
  9059*    MOVE '@"L                   #   #00008699' TO DFHEIV0
  9060     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9061     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9062     MOVE X'2020233030303038363939' TO DFHEIV0(25:11)
  9063     CALL 'kxdfhei1' USING DFHEIV0,
  9064           LCVRATEI,
  9065           DFHEIV11
  9066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9067         IF LCVRATEI IS NUMERIC
  9068             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9069             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9070             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 163
* EL131.cbl
  9071         ELSE
  9072             MOVE ER-2280        TO EMI-ERROR
  9073             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9074             MOVE AL-UNBON       TO LCVRATEA
  9075             MOVE 'X'            TO ERROR-SWITCH
  9076             MOVE -1             TO LCVRATEL
  9077     ELSE
  9078         MOVE AL-UNNOF           TO LCVRATEA.
  9079
  9080     IF ACVRATEL GREATER THAN +0
  9081
  9082* EXEC CICS BIF DEEDIT
  9083*            FIELD (ACVRATEI)
  9084*            LENGTH(6)
  9085*        END-EXEC
  9086     MOVE 6
  9087       TO DFHEIV11
  9088*    MOVE '@"L                   #   #00008717' TO DFHEIV0
  9089     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9090     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9091     MOVE X'2020233030303038373137' TO DFHEIV0(25:11)
  9092     CALL 'kxdfhei1' USING DFHEIV0,
  9093           ACVRATEI,
  9094           DFHEIV11
  9095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9096         IF ACVRATEI IS NUMERIC
  9097             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9098             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9099             MOVE AL-UNNON       TO ACVRATEA
  9100         ELSE
  9101             MOVE ER-2280        TO EMI-ERROR
  9102             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9103             MOVE AL-UNBON       TO ACVRATEA
  9104             MOVE 'X'            TO ERROR-SWITCH
  9105             MOVE -1             TO ACVRATEL
  9106     ELSE
  9107         MOVE AL-UNNOF           TO ACVRATEA.
  9108
  9109     IF LCVBENEL GREATER THAN ZERO
  9110
  9111* EXEC CICS BIF DEEDIT
  9112*            FIELD (LCVBENEI)
  9113*            LENGTH (11)
  9114*        END-EXEC
  9115     MOVE 11
  9116       TO DFHEIV11
  9117*    MOVE '@"L                   #   #00008735' TO DFHEIV0
  9118     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9119     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9120     MOVE X'2020233030303038373335' TO DFHEIV0(25:11)
  9121     CALL 'kxdfhei1' USING DFHEIV0,
  9122           LCVBENEI,
  9123           DFHEIV11
  9124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9125         IF LCVBENEI IS NUMERIC
  9126            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9127            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9128            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 164
* EL131.cbl
  9129         ELSE
  9130            MOVE ER-0243         TO EMI-ERROR
  9131            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9132            MOVE AL-UNBON        TO LCVBENEA
  9133            MOVE -1              TO LCVBENEL
  9134            MOVE 'X'             TO ERROR-SWITCH
  9135     ELSE
  9136         MOVE AL-UANOF           TO LCVBENEA.
  9137
  9138     IF ACVBENEL GREATER THAN ZERO
  9139
  9140* EXEC CICS BIF DEEDIT
  9141*            FIELD (ACVBENEI)
  9142*            LENGTH (11)
  9143*        END-EXEC
  9144     MOVE 11
  9145       TO DFHEIV11
  9146*    MOVE '@"L                   #   #00008753' TO DFHEIV0
  9147     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9148     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9149     MOVE X'2020233030303038373533' TO DFHEIV0(25:11)
  9150     CALL 'kxdfhei1' USING DFHEIV0,
  9151           ACVBENEI,
  9152           DFHEIV11
  9153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9154         IF ACVBENEI IS NUMERIC
  9155            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9156            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9157            MOVE AL-UNNON        TO ACVBENEA
  9158         ELSE
  9159            MOVE ER-0243         TO EMI-ERROR
  9160            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9161            MOVE AL-UNBON        TO ACVBENEA
  9162            MOVE -1              TO ACVBENEL
  9163            MOVE 'X'             TO ERROR-SWITCH
  9164     ELSE
  9165         MOVE AL-UANOF           TO ACVBENEA.
  9166
  9167     IF LCVFORMI GREATER THAN LOW-VALUES
  9168        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9169        MOVE AL-UANON            TO LCVFORMA
  9170     ELSE
  9171        MOVE AL-UANOF            TO LCVFORMA.
  9172
  9173     IF ACVFORMI GREATER THAN LOW-VALUES
  9174        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9175        MOVE AL-UANON            TO ACVFORMA
  9176     ELSE
  9177        MOVE AL-UANOF            TO ACVFORMA.
  9178
  9179     IF LCVCNDTL GREATER THAN ZERO
  9180         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9181         IF LCVCNDTI = SPACES
  9182             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9183         ELSE
  9184             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9185             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9186             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 165
* EL131.cbl
  9187             MOVE '4'            TO DC-OPTION-CODE
  9188             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9189             IF NOT DATE-CONVERSION-ERROR
  9190                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9191                 MOVE AL-UANON   TO LCVCNDTA
  9192                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9193                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9194             ELSE
  9195                 MOVE ER-0246    TO EMI-ERROR
  9196                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9197                 MOVE AL-UABON   TO LCVCNDTA
  9198                 MOVE -1         TO LCVCNDTL
  9199                 MOVE 'X'        TO ERROR-SWITCH
  9200     ELSE
  9201         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9202         MOVE AL-UANOF           TO LCVCNDTA.
  9203
  9204     IF ACVCNDTL GREATER THAN ZERO
  9205         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9206         IF ACVCNDTI = SPACES
  9207             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9208         ELSE
  9209             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9210             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9211             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9212             MOVE '4'            TO DC-OPTION-CODE
  9213             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9214             IF NOT DATE-CONVERSION-ERROR
  9215                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9216                 MOVE AL-UANON   TO ACVCNDTA
  9217                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9218                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9219             ELSE
  9220                 MOVE ER-0246    TO EMI-ERROR
  9221                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9222                 MOVE AL-UABON   TO ACVCNDTA
  9223                 MOVE -1         TO ACVCNDTL
  9224                 MOVE 'X'        TO ERROR-SWITCH
  9225     ELSE
  9226         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9227         MOVE AL-UANOF           TO ACVCNDTA.
  9228
  9229     IF APRL GREATER THAN +0
  9230
  9231* EXEC CICS BIF DEEDIT
  9232*            FIELD    (APRI)
  9233*            LENGTH   (8)
  9234*        END-EXEC
  9235     MOVE 8
  9236       TO DFHEIV11
  9237*    MOVE '@"L                   #   #00008833' TO DFHEIV0
  9238     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9239     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9240     MOVE X'2020233030303038383333' TO DFHEIV0(25:11)
  9241     CALL 'kxdfhei1' USING DFHEIV0,
  9242           APRI,
  9243           DFHEIV11
  9244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 166
* EL131.cbl
  9245         IF APRI NUMERIC
  9246            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9247            MOVE APRI            TO HOLD-APR APRO
  9248            MOVE AL-UANON        TO APRA
  9249          ELSE
  9250            MOVE ER-0259         TO EMI-ERROR
  9251            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9252            MOVE AL-UABON        TO APRA
  9253            MOVE -1              TO APRL
  9254            MOVE 'X'             TO ERROR-SWITCH
  9255     ELSE
  9256         MOVE AL-UANOF           TO APRA.
  9257
  9258     IF PMTFREQL GREATER THAN ZERO
  9259
  9260* EXEC CICS BIF DEEDIT
  9261*            FIELD    (PMTFREQI)
  9262*            LENGTH   (2)
  9263*        END-EXEC
  9264     MOVE 2
  9265       TO DFHEIV11
  9266*    MOVE '@"L                   #   #00008851' TO DFHEIV0
  9267     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9268     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9269     MOVE X'2020233030303038383531' TO DFHEIV0(25:11)
  9270     CALL 'kxdfhei1' USING DFHEIV0,
  9271           PMTFREQI,
  9272           DFHEIV11
  9273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9274         IF PMTFREQI NUMERIC
  9275            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9276            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9277            MOVE AL-UANON        TO PMTFREQA
  9278          ELSE
  9279            MOVE ER-0427         TO EMI-ERROR
  9280            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9281            MOVE AL-UABON        TO PMTFREQA
  9282            MOVE -1              TO PMTFREQL
  9283            MOVE 'X'             TO ERROR-SWITCH
  9284     ELSE
  9285         MOVE AL-UANOF           TO PMTFREQA.
  9286
  9287     IF INDGRPL GREATER THAN ZERO
  9288         IF INDGRPI = 'I' OR 'G' OR SPACE
  9289             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9290             MOVE AL-UANON       TO INDGRPA
  9291          ELSE
  9292             MOVE ER-0260        TO EMI-ERROR
  9293             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9294             MOVE AL-UABON       TO INDGRPA
  9295             MOVE -1             TO INDGRPL
  9296             MOVE 'X'            TO ERROR-SWITCH
  9297     ELSE
  9298         MOVE AL-UANOF           TO INDGRPA.
  9299
  9300     IF PREMTYPL GREATER THAN ZERO
  9301         IF PREMTYPI = '1' OR '2' OR '3'
  9302            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 167
* EL131.cbl
  9303            MOVE AL-UNNON        TO PREMTYPA
  9304            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9305          ELSE
  9306            MOVE ER-0227         TO EMI-ERROR
  9307            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9308            MOVE AL-UNBON        TO PREMTYPA
  9309            MOVE -1              TO PREMTYPL
  9310            MOVE 'X'             TO ERROR-SWITCH
  9311     ELSE
  9312         MOVE AL-UANOF           TO PREMTYPA.
  9313
  9314     IF LOANBALL GREATER THAN ZERO
  9315
  9316* EXEC CICS BIF DEEDIT
  9317*             FIELD    (LOANBALI)
  9318*             LENGTH   (9)
  9319*        END-EXEC
  9320     MOVE 9
  9321       TO DFHEIV11
  9322*    MOVE '@"L                   #   #00008896' TO DFHEIV0
  9323     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9324     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9325     MOVE X'2020233030303038383936' TO DFHEIV0(25:11)
  9326     CALL 'kxdfhei1' USING DFHEIV0,
  9327           LOANBALI,
  9328           DFHEIV11
  9329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9330         IF LOANBALI NUMERIC
  9331             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9332             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9333             MOVE AL-UNNON TO LOANBALA
  9334         ELSE
  9335             MOVE ER-0639        TO EMI-ERROR
  9336             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9337             MOVE AL-UNBON       TO LOANBALA
  9338             MOVE -1             TO LOANBALL
  9339             MOVE 'X'            TO ERROR-SWITCH
  9340     ELSE
  9341         MOVE AL-UNNOF           TO LOANBALA.
  9342
  9343     IF LOANNOL GREATER THAN ZERO
  9344        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9345        MOVE AL-UANON            TO LOANNOA
  9346     ELSE
  9347        MOVE AL-UANOF            TO LOANNOA.
  9348
  9349     IF REINCDI GREATER THAN LOW-VALUES
  9350        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9351        MOVE AL-UANON            TO REINCDA
  9352     ELSE
  9353        MOVE AL-UANOF            TO REINCDA.
  9354
  9355     IF CERTI GREATER THAN LOW-VALUES
  9356         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9357     ELSE
  9358         MOVE AL-UANOF           TO CERTA.
  9359
  9360     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 168
* EL131.cbl
  9361         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9362     ELSE
  9363         MOVE AL-UANOF           TO CERTEFFA.
  9364
  9365     IF CERTACTI GREATER THAN LOW-VALUES
  9366         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9367     ELSE
  9368         MOVE AL-UANOF           TO CERTACTA.
  9369
  9370     IF CERTSTI GREATER THAN LOW-VALUES
  9371         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9372     ELSE
  9373         MOVE AL-UANOF           TO CERTSTA.
  9374
  9375     IF CERTCARI GREATER THAN LOW-VALUES
  9376         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9377     ELSE
  9378         MOVE AL-UANOF           TO CERTCARA.
  9379
  9380     IF DLYACTV-RECORD-NEEDED
  9381         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9382                 1150-EXIT
  9383     END-IF.
  9384
  9385     IF CERTEFFI GREATER LOW-VALUES OR
  9386        CERTACTI GREATER LOW-VALUES OR
  9387        CERTSTI  GREATER LOW-VALUES OR
  9388        CERTCARI GREATER LOW-VALUES OR
  9389        CERTGRPI GREATER LOW-VALUES
  9390        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9391
  9392*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9393*      IF PI-PREM-TYPE NOT = '1'  AND
  9394*         PI-NO-PMTS = ZEROS
  9395*          IF LOANBALL GREATER +0 OR
  9396*             ACVBENEL GREATER +0
  9397*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9398     if not acct-found
  9399        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9400     end-if
  9401     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9402     MOVE PI-CARRIER             TO CARRIER-CODE
  9403     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9404     MOVE PI-CERT-NO             TO CERT-NO
  9405
  9406* EXEC CICS READ
  9407*        DATASET   (CLMS-FILE-ID)
  9408*        RIDFLD    (MSTR-KEY)
  9409*        SET       (ADDRESS OF CLAIM-MASTER)
  9410*        RESP      (WS-RESPONSE)
  9411*    END-EXEC
  9412*    MOVE '&"S        E          (  N#00008975' TO DFHEIV0
  9413     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9415     MOVE X'204E233030303038393735' TO DFHEIV0(25:11)
  9416     CALL 'kxdfhei1' USING DFHEIV0,
  9417           CLMS-FILE-ID,
  9418           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 169
* EL131.cbl
  9419           DFHEIV99,
  9420           MSTR-KEY,
  9421           DFHEIV99,
  9422           DFHEIV99,
  9423           DFHEIV99
  9424     SET ADDRESS OF CLAIM-MASTER TO
  9425         DFHEIV20
  9426     MOVE EIBRESP  TO WS-RESPONSE
  9427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9428     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9429     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9430     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9431     MOVE CL-CERT-STATE          TO CERT-STATE
  9432     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9433     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9434     MOVE CL-CERT-NO             TO CERT-CERT
  9435
  9436* EXEC CICS READ
  9437*       DATASET   (CERT-FILE-ID)
  9438*       RIDFLD    (CERT-KEY)
  9439*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9440*       RESP      (WS-RESPONSE)
  9441*    END-EXEC
  9442*    MOVE '&"S        E          (  N#00008988' TO DFHEIV0
  9443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9445     MOVE X'204E233030303038393838' TO DFHEIV0(25:11)
  9446     CALL 'kxdfhei1' USING DFHEIV0,
  9447           CERT-FILE-ID,
  9448           DFHEIV20,
  9449           DFHEIV99,
  9450           CERT-KEY,
  9451           DFHEIV99,
  9452           DFHEIV99,
  9453           DFHEIV99
  9454     SET ADDRESS OF CERTIFICATE-MASTER TO
  9455         DFHEIV20
  9456     MOVE EIBRESP  TO WS-RESPONSE
  9457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9458     if mfnamei > low-values
  9459        move mfnamei to w-name-first
  9460     else
  9461        move cl-insured-1st-name to w-name-first
  9462     end-if
  9463     if mlnamei > low-values
  9464        move mlnamei to w-name-last
  9465     else
  9466        move cl-insured-last-name to w-name-last
  9467     end-if
  9468     if instypel > zeros
  9469        evaluate true
  9470           when cl-no-of-days-paid > zeros
  9471              move er-1668       to emi-error
  9472              perform 9900-error-format
  9473                                 thru 9900-exit
  9474              move al-uabon      to instypea
  9475              move -1            to instypel
  9476              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 170
* EL131.cbl
  9477           when instypei = 'C'
  9478              if w-name-first (1:10) = cm-insured-first-name
  9479                 move er-1666    to emi-error
  9480                 PERFORM 9900-ERROR-FORMAT
  9481                                 THRU 9900-EXIT
  9482                 move al-uabon   to instypea
  9483                 move -1         to instypel
  9484                 move 'X'        to error-switch
  9485              end-if
  9486           when instypei = 'P'
  9487              if (w-name-first (1:10) <> cm-insured-first-name)
  9488                 or (w-name-last <> cm-insured-last-name)
  9489                 move er-1676    to emi-error
  9490                 PERFORM 9900-ERROR-FORMAT
  9491                                 THRU 9900-EXIT
  9492                 move al-uabon   to instypea
  9493                 move -1         to instypel
  9494                 move 'X'        to error-switch
  9495              end-if
  9496        end-evaluate
  9497     end-if
  9498*    if (instypel > zeros)
  9499*       and (cl-no-of-days-paid > zero)
  9500*       move er-1668             to emi-error
  9501*       perform 9900-error-format thru 9900-exit
  9502*       move al-uabon            to instypea
  9503*       move -1                  to instypel
  9504*       move 'X'                 to error-switch
  9505*    end-if
  9506*
  9507*    if instypel > zero
  9508*       if instypei = 'C'
  9509*          if w-name-first (1:10) = cm-insured-first-name
  9510*             move er-1666          to emi-error
  9511*             PERFORM 9900-ERROR-FORMAT
  9512*                                   THRU 9900-EXIT
  9513*             move al-uabon         to instypea
  9514*             move -1               to instypel
  9515*             move 'X'              to error-switch
  9516*          end-if
  9517*       end-if
  9518*    end-if
  9519     if (pi-company-id = 'DCC' OR 'VPP')
  9520        and (acct-found)
  9521        perform 2120-check-pdef  thru 2120-exit
  9522     end-if
  9523     if benperl > zeros
  9524        move al-uanon            to benpera
  9525     end-if
  9526     if benperl > zeros
  9527        if benperi numeric
  9528           perform 1015-edit-benefit-period
  9529                                 thru 1015-exit
  9530        else
  9531           move er-1669          to emi-error
  9532           PERFORM 9900-ERROR-FORMAT
  9533                                 THRU 9900-EXIT
  9534           move al-uabon         to benpera
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 171
* EL131.cbl
  9535           move -1               to benperl
  9536           move 'X'              to error-switch
  9537        end-if
  9538    end-if
  9539     if instypel > zeros
  9540        if instypei = 'P' OR 'C'
  9541           move 'X'              to update-switch
  9542                                    mstr-switch
  9543           move al-uanon         to instypea
  9544        else
  9545            move er-1654          to emi-error
  9546           PERFORM 9900-ERROR-FORMAT
  9547                                 THRU 9900-EXIT
  9548           move al-uabon         to instypea
  9549           move -1               to instypel
  9550           move 'X'              to error-switch
  9551        end-if
  9552    end-if
  9553     if accswl > zeros
  9554        if accswi = 'Y' OR 'N'
  9555           MOVE 'X'              TO UPDATE-SWITCH
  9556                                    MSTR-SWITCH
  9557           MOVE AL-UANON         TO accswa
  9558*       else
  9559*          move er-1656          to emi-error
  9560*          PERFORM 9900-ERROR-FORMAT
  9561*                                THRU 9900-EXIT
  9562*          move al-uabon         to accswa
  9563*          move -1               to accswl
  9564*          move 'X'              to error-switch
  9565*          move al-uanof         to accswa
  9566        end-if
  9567     end-if
  9568     IF CERTL = ZEROS AND
  9569        SUFXL = ZEROS
  9570          GO TO 1010-EXIT.
  9571
  9572     IF CERTL GREATER THAN ZEROS
  9573         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9574             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9575             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9576             MOVE 'X'            TO ERROR-SWITCH
  9577             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9578
  9579     IF SUFXL GREATER THAN ZEROS
  9580         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9581             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9582             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9583             MOVE 'X'            TO ERROR-SWITCH
  9584             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9585
  9586 1010-EXIT.
  9587     EXIT.
  9588
  9589 1015-edit-benefit-period.
  9590     move ' '                    to ws-benper-sw
  9591     evaluate true
  9592        when not erpdef-found
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 172
* EL131.cbl
  9593           set good-benper       to true
  9594        when pd-recurring-yn (a1) = 'Y'
  9595           set good-benper       to true
  9596        when pd-recurring-yn (a1) = 'N'
  9597           if benperi < 02
  9598              set good-benper    to true
  9599           end-if
  9600        when pd-rec-crit-period (a1) numeric
  9601           if benperi <= pd-rec-crit-period (a1)
  9602              set good-benper    to true
  9603           end-if
  9604     end-evaluate
  9605     MOVE CERT-KEY               TO ELCRTT-KEY
  9606     MOVE 'B'                    TO CTRLR-REC-TYPE
  9607
  9608* EXEC CICS READ
  9609*       DATASET   ('ELCRTT')
  9610*       RIDFLD    (ELCRTT-KEY)
  9611*       INTO      (CERTIFICATE-TRAILERS)
  9612*       RESP      (WS-RESPONSE)
  9613*    END-EXEC
  9614     MOVE LENGTH OF
  9615      CERTIFICATE-TRAILERS
  9616       TO DFHEIV11
  9617     MOVE 'ELCRTT' TO DFHEIV1
  9618*    MOVE '&"IL       E          (  N#00009143' TO DFHEIV0
  9619     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9620     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9621     MOVE X'204E233030303039313433' TO DFHEIV0(25:11)
  9622     CALL 'kxdfhei1' USING DFHEIV0,
  9623           DFHEIV1,
  9624           CERTIFICATE-TRAILERS,
  9625           DFHEIV11,
  9626           ELCRTT-KEY,
  9627           DFHEIV99,
  9628           DFHEIV99,
  9629           DFHEIV99
  9630     MOVE EIBRESP  TO WS-RESPONSE
  9631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9632     IF WS-RESP-NORMAL
  9633        perform varying s1 from +1 by +1 until
  9634           (s1 > +24)
  9635           or ((cs-claim-type (s1) = cl-claim-type)
  9636           and (cs-insured-type (s1) = cl-insured-type)
  9637           and (cs-benefit-period (s1) > benperi))
  9638        end-perform
  9639        if s1 < +25
  9640           move er-1665          to emi-error
  9641           PERFORM 9900-ERROR-FORMAT
  9642                                 THRU 9900-EXIT
  9643           move al-uabon         to benpera
  9644           move -1               to benperl
  9645           move 'X'              to error-switch
  9646           go to 1015-exit
  9647*       else
  9648*          set good-benper       to true
  9649        end-if
  9650     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 173
* EL131.cbl
  9651     if good-benper
  9652        move 'X'                 to update-switch
  9653                                    mstr-switch
  9654        move al-uanon            to benpera
  9655     else
  9656        move er-1669             to emi-error
  9657        PERFORM 9900-ERROR-FORMAT
  9658                                 THRU 9900-EXIT
  9659        move al-uabon            to benpera
  9660        move -1                  to benperl
  9661        move 'X'                 to error-switch
  9662     end-if
  9663     .
  9664 1015-exit.
  9665     exit.
  9666 1050-EDIT-BENE.
  9667     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9668     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9669     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9670     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9671     MOVE 1000               TO TRLR-SEQ-NO.
  9672
  9673
  9674* EXEC CICS HANDLE CONDITION
  9675*         NOTFND    (1052-DONE)
  9676*         ENDFILE   (1052-DONE)
  9677*    END-EXEC.
  9678*    MOVE '"$I''                  ! & #00009190' TO DFHEIV0
  9679     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9680     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9681     MOVE X'2620233030303039313930' TO DFHEIV0(25:11)
  9682     CALL 'kxdfhei1' USING DFHEIV0
  9683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9684
  9685
  9686
  9687* EXEC CICS STARTBR
  9688*        DATASET (TRLR-FILE-ID)
  9689*        RIDFLD  (TRLR-KEY)
  9690*    END-EXEC
  9691     MOVE 0
  9692       TO DFHEIV11
  9693*    MOVE '&,         G          &   #00009195' TO DFHEIV0
  9694     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9695     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9696     MOVE X'2020233030303039313935' TO DFHEIV0(25:11)
  9697     CALL 'kxdfhei1' USING DFHEIV0,
  9698           TRLR-FILE-ID,
  9699           TRLR-KEY,
  9700           DFHEIV99,
  9701           DFHEIV11,
  9702           DFHEIV99
  9703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9704
  9705
  9706     MOVE SPACES TO WS-TRLR-FILE-EOF
  9707                    WS-PAYMENT-PENDING
  9708     PERFORM 1052-READ-TRLR THRU 1052-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 174
* EL131.cbl
  9709       UNTIL  TRLR-FILE-EOF
  9710         OR PAYMENT-PENDING
  9711
  9712
  9713* EXEC CICS ENDBR
  9714*        DATASET (TRLR-FILE-ID)
  9715*    END-EXEC.
  9716     MOVE 0
  9717       TO DFHEIV11
  9718*    MOVE '&2                    $   #00009207' TO DFHEIV0
  9719     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9720     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9721     MOVE X'2020233030303039323037' TO DFHEIV0(25:11)
  9722     CALL 'kxdfhei1' USING DFHEIV0,
  9723           TRLR-FILE-ID,
  9724           DFHEIV11,
  9725           DFHEIV99
  9726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9727
  9728 1050-EXIT.
  9729     EXIT.
  9730
  9731 1052-READ-TRLR.
  9732
  9733* EXEC CICS READNEXT
  9734*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9735*         DATASET  (TRLR-FILE-ID)
  9736*         RIDFLD   (TRLR-KEY)
  9737*    END-EXEC.
  9738     MOVE 0
  9739       TO DFHEIV11
  9740*    MOVE '&.S                   )   #00009214' TO DFHEIV0
  9741     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9742     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9743     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
  9744     CALL 'kxdfhei1' USING DFHEIV0,
  9745           TRLR-FILE-ID,
  9746           DFHEIV20,
  9747           DFHEIV99,
  9748           TRLR-KEY,
  9749           DFHEIV99,
  9750           DFHEIV11,
  9751           DFHEIV99,
  9752           DFHEIV99
  9753     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9754         DFHEIV20
  9755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9756
  9757
  9758     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9759       AND PI-CARRIER  = TRLR-CARRIER
  9760       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9761       AND PI-CERT-NO  = TRLR-CERT-NO
  9762        CONTINUE
  9763     ELSE
  9764        GO TO 1052-DONE
  9765     END-IF.
  9766
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 175
* EL131.cbl
  9767     IF PAYMENT-TR
  9768       AND BENEFICIARY-PAID
  9769       AND AT-VOID-DT = LOW-VALUES
  9770       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9771         SET PAYMENT-PENDING TO TRUE
  9772     END-IF.
  9773
  9774     GO TO 1052-EXIT.
  9775
  9776 1052-DONE.
  9777     SET TRLR-FILE-EOF TO TRUE.
  9778 1052-EXIT.
  9779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 176
* EL131.cbl
  9781 1120-EDIT-PROC.
  9782     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9783     MOVE '2'                    TO CNTL-REC-TYPE.
  9784     MOVE PROCI                  TO CNTL-PROC-ID.
  9785     MOVE ZERO                   TO CNTL-SEQ-NO.
  9786
  9787
  9788* EXEC CICS HANDLE CONDITION
  9789*         NOTFND    (1120-CNTL-NOTFND)
  9790*    END-EXEC.
  9791*    MOVE '"$I                   ! '' #00009249' TO DFHEIV0
  9792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9794     MOVE X'2720233030303039323439' TO DFHEIV0(25:11)
  9795     CALL 'kxdfhei1' USING DFHEIV0
  9796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9797
  9798
  9799
  9800* EXEC CICS READ
  9801*         SET      (ADDRESS OF CONTROL-FILE)
  9802*         DATASET  (CNTL-FILE-ID)
  9803*         RIDFLD   (CNTL-KEY)
  9804*    END-EXEC.
  9805*    MOVE '&"S        E          (   #00009253' TO DFHEIV0
  9806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9808     MOVE X'2020233030303039323533' TO DFHEIV0(25:11)
  9809     CALL 'kxdfhei1' USING DFHEIV0,
  9810           CNTL-FILE-ID,
  9811           DFHEIV20,
  9812           DFHEIV99,
  9813           CNTL-KEY,
  9814           DFHEIV99,
  9815           DFHEIV99,
  9816           DFHEIV99
  9817     SET ADDRESS OF CONTROL-FILE TO
  9818         DFHEIV20
  9819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9820
  9821
  9822     MOVE AL-UANON               TO PROCA.
  9823     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9824     GO TO 1120-EXIT.
  9825
  9826 1120-CNTL-NOTFND.
  9827     MOVE ER-0273                TO EMI-ERROR.
  9828     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9829     MOVE AL-UABON               TO PROCA.
  9830     MOVE -1                     TO PROCL.
  9831     MOVE 'X'                    TO ERROR-SWITCH.
  9832
  9833 1120-EXIT.
  9834     EXIT.
  9835
  9836*************************************************************
  9837*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9838*************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 177
* EL131.cbl
  9839
  9840 1150-OUTPUT-ACTIVITY-RECORD.
  9841
  9842
  9843* EXEC CICS GETMAIN
  9844*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9845*        LENGTH (25)
  9846*        INITIMG (WS-BLANK)
  9847*    END-EXEC.
  9848     MOVE 25
  9849       TO DFHEIV11
  9850*    MOVE ',"IL                  $   #00009279' TO DFHEIV0
  9851     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9852     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9853     MOVE X'2020233030303039323739' TO DFHEIV0(25:11)
  9854     CALL 'kxdfhei1' USING DFHEIV0,
  9855           DFHEIV20,
  9856           DFHEIV11,
  9857           WS-BLANK
  9858     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9859         DFHEIV20
  9860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9861
  9862
  9863     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9864     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9865     MOVE PI-CARRIER             TO DA-CARRIER.
  9866     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9867     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9868     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9869     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9870
  9871
  9872* EXEC CICS HANDLE CONDITION
  9873*        NOTOPEN (1150-NOTOPEN-ERROR)
  9874*        DUPREC (1150-EXIT)
  9875*    END-EXEC.
  9876*    MOVE '"$J%                  ! ( #00009293' TO DFHEIV0
  9877     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9879     MOVE X'2820233030303039323933' TO DFHEIV0(25:11)
  9880     CALL 'kxdfhei1' USING DFHEIV0
  9881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9882
  9883     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9884     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9885     MOVE 'A'                    TO JP-RECORD-TYPE.
  9886     MOVE +48                    TO JOURNAL-LENGTH.
  9887
  9888
  9889* EXEC CICS WRITE
  9890*        DATASET ('DLYACTV')
  9891*        RIDFLD (DA-KEY)
  9892*        FROM (DAILY-ACTIVITY-RECORD)
  9893*        LENGTH (25)
  9894*    END-EXEC.
  9895     MOVE 'DLYACTV' TO DFHEIV1
  9896     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 178
* EL131.cbl
  9897       TO DFHEIV11
  9898*    MOVE '&$ L                  ''   #00009302' TO DFHEIV0
  9899     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9900     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9901     MOVE X'2020233030303039333032' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0,
  9903           DFHEIV1,
  9904           DAILY-ACTIVITY-RECORD,
  9905           DFHEIV11,
  9906           DA-KEY,
  9907           DFHEIV99,
  9908           DFHEIV99
  9909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9910
  9911
  9912     GO TO 1150-EXIT.
  9913
  9914 1150-NOTOPEN-ERROR.
  9915
  9916     MOVE '2955'                 TO EMI-ERROR.
  9917     MOVE -1                     TO MAINTL.
  9918     MOVE AL-UANON               TO MAINTA.
  9919     MOVE 'X'                    TO ERROR-SWITCH.
  9920     PERFORM 9900-ERROR-FORMAT THRU
  9921             9900-EXIT.
  9922
  9923 1150-EXIT.
  9924     EXIT.
  9925
  9926*************************************************************
  9927*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9928*************************************************************
  9929
  9930 1240-EDIT-LIFE-CODE.
  9931
  9932     IF INVALID-BENEFIT-CODE
  9933         GO TO 1240-SET-ERROR.
  9934
  9935     MOVE SPACES                 TO BENEFIT-KEY.
  9936     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9937     MOVE '4'                    TO BEN-REC-TYPE.
  9938     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9939     MOVE ZERO                   TO BEN-SEQ-NO.
  9940
  9941
  9942* EXEC CICS READ GTEQ
  9943*         DATASET  (CNTL-FILE-ID)
  9944*         RIDFLD   (BENEFIT-KEY)
  9945*         SET      (ADDRESS OF CONTROL-FILE)
  9946*    END-EXEC.
  9947*    MOVE '&"S        G          (   #00009338' TO DFHEIV0
  9948     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9950     MOVE X'2020233030303039333338' TO DFHEIV0(25:11)
  9951     CALL 'kxdfhei1' USING DFHEIV0,
  9952           CNTL-FILE-ID,
  9953           DFHEIV20,
  9954           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 179
* EL131.cbl
  9955           BENEFIT-KEY,
  9956           DFHEIV99,
  9957           DFHEIV99,
  9958           DFHEIV99
  9959     SET ADDRESS OF CONTROL-FILE TO
  9960         DFHEIV20
  9961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9962
  9963
  9964     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9965        CF-RECORD-TYPE NOT = '4'
  9966         GO TO 1240-SET-ERROR.
  9967
  9968     MOVE ZERO                   TO COUNT-2.
  9969     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9970
  9971     IF SCREEN-ERROR
  9972         GO TO 1240-SET-ERROR.
  9973
  9974 1240-SET-CODE-SWITCHES.
  9975     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9976     MOVE AL-UANON               TO LCVCDA.
  9977     GO TO 1240-EXIT.
  9978
  9979 1240-SET-ERROR.
  9980     MOVE ER-0240                TO EMI-ERROR.
  9981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9982     MOVE 'X'                    TO ERROR-SWITCH.
  9983     MOVE AL-UABON               TO LCVCDA.
  9984     MOVE -1                     TO LCVCDL.
  9985
  9986 1240-EXIT.
  9987     EXIT.
  9988
  9989 1310-EDIT-AH-CODE.
  9990     IF INVALID-BENEFIT-CODE
  9991         GO TO 1310-SET-ERROR.
  9992
  9993     MOVE SPACES                 TO BENEFIT-KEY.
  9994     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9995     MOVE '5'                    TO BEN-REC-TYPE.
  9996     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9997     MOVE ZERO                   TO BEN-SEQ-NO.
  9998
  9999
 10000* EXEC CICS READ GTEQ
 10001*         DATASET  (CNTL-FILE-ID)
 10002*         RIDFLD   (BENEFIT-KEY)
 10003*         SET      (ADDRESS OF CONTROL-FILE)
 10004*    END-EXEC.
 10005*    MOVE '&"S        G          (   #00009379' TO DFHEIV0
 10006     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10008     MOVE X'2020233030303039333739' TO DFHEIV0(25:11)
 10009     CALL 'kxdfhei1' USING DFHEIV0,
 10010           CNTL-FILE-ID,
 10011           DFHEIV20,
 10012           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 180
* EL131.cbl
 10013           BENEFIT-KEY,
 10014           DFHEIV99,
 10015           DFHEIV99,
 10016           DFHEIV99
 10017     SET ADDRESS OF CONTROL-FILE TO
 10018         DFHEIV20
 10019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10020
 10021
 10022     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10023        CF-RECORD-TYPE NOT = '5'
 10024         GO TO 1310-SET-ERROR.
 10025
 10026     MOVE ZERO                   TO COUNT-2.
 10027     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10028     IF SCREEN-ERROR
 10029         GO TO 1310-SET-ERROR.
 10030
 10031 1310-SET-CODE-SWITCHES.
 10032     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10033     MOVE AL-UANON               TO ACVCDA.
 10034     GO TO 1310-EXIT.
 10035
 10036 1310-SET-ERROR.
 10037     MOVE ER-0250                TO EMI-ERROR.
 10038     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10039     MOVE AL-UABON               TO ACVCDA.
 10040     MOVE 'X'                    TO ERROR-SWITCH.
 10041     MOVE -1                     TO ACVCDL.
 10042
 10043 1310-EXIT.
 10044     EXIT.
 10045
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 181
* EL131.cbl
 10047 1460-EDIT-CERT-NO.
 10048     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10049     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10050
 10051     IF WS-SAVE-CERT-NO = SPACES
 10052         MOVE ER-0203            TO EMI-ERROR
 10053         GO TO 1460-CERT-NO-ERROR.
 10054
 10055     IF WS-CERT-NO-PRIME = SPACES AND
 10056        WS-CERT-NO-SUFX GREATER THAN SPACE
 10057            MOVE ER-0210         TO EMI-ERROR
 10058            GO TO 1460-CERT-NO-ERROR.
 10059
 10060     MOVE 'X'                    TO UPDATE-SWITCH.
 10061     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10062     MOVE AL-UANON               TO CERTA.
 10063
 10064     IF SUFXL IS GREATER THAN 0
 10065         MOVE AL-UANON           TO SUFXA.
 10066
 10067     GO TO 1460-EXIT.
 10068
 10069 1460-CERT-NO-ERROR.
 10070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10071     MOVE AL-UABON               TO SUFXA.
 10072     MOVE AL-UABON               TO CERTA.
 10073     MOVE -1                     TO CERTL.
 10074     MOVE 'X'                    TO ERROR-SWITCH.
 10075
 10076 1460-EXIT.
 10077     EXIT.
 10078
 10079 1470-EDIT-EFF.
 10080     IF CERTEFFI = SPACES
 10081         GO TO 1470-DATE-ERROR.
 10082
 10083     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10084     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10085     IF DEEDIT-DATE = ZERO
 10086         GO TO 1470-DATE-ERROR.
 10087
 10088     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10089     MOVE '4'                    TO DC-OPTION-CODE.
 10090     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10091     IF NOT DATE-CONVERSION-ERROR
 10092         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10093         MOVE AL-UANON           TO CERTEFFA
 10094         MOVE 'X'                TO UPDATE-SWITCH
 10095         MOVE 'Y'                TO CERT-KEY-SWITCH
 10096         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10097         GO TO 1470-EXIT.
 10098
 10099 1470-DATE-ERROR.
 10100     MOVE ER-0215                TO EMI-ERROR.
 10101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10102     MOVE AL-UABON               TO CERTEFFA.
 10103     MOVE -1                     TO CERTEFFL.
 10104     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 182
* EL131.cbl
 10105
 10106 1470-EXIT.
 10107     EXIT.
 10108
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 183
* EL131.cbl
 10110 1480-EDIT-ACCT.
 10111     IF CERTACTI = SPACES
 10112         MOVE ER-0232            TO EMI-ERROR
 10113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10114         MOVE AL-UABON           TO CERTACTA
 10115         MOVE -1                 TO CERTACTL
 10116         MOVE 'X'                TO ERROR-SWITCH
 10117     ELSE
 10118         MOVE 'X'                TO UPDATE-SWITCH
 10119         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10120
 10121 1480-EXIT.
 10122     EXIT.
 10123
 10124 1490-EDIT-STATE.
 10125     IF CERTSTI = SPACES
 10126         MOVE ER-0233            TO EMI-ERROR
 10127         GO TO 1490-STATE-ERROR.
 10128
 10129     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10130     MOVE '3'                    TO CNTL-REC-TYPE.
 10131     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10132     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10133     MOVE ZERO                   TO CNTL-SEQ-NO.
 10134
 10135
 10136* EXEC CICS HANDLE CONDITION
 10137*         NOTFND (1490-STATE-NOTFND)
 10138*    END-EXEC.
 10139*    MOVE '"$I                   ! ) #00009498' TO DFHEIV0
 10140     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10142     MOVE X'2920233030303039343938' TO DFHEIV0(25:11)
 10143     CALL 'kxdfhei1' USING DFHEIV0
 10144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10145
 10146
 10147
 10148* EXEC CICS READ
 10149*         SET        (ADDRESS OF CONTROL-FILE)
 10150*         DATASET    ('ELCNTL')
 10151*         RIDFLD     (CNTL-KEY)
 10152*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10153*         GENERIC
 10154*    END-EXEC.
 10155     MOVE 'ELCNTL' TO DFHEIV1
 10156*    MOVE '&"S  KG    E          (   #00009502' TO DFHEIV0
 10157     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10159     MOVE X'2020233030303039353032' TO DFHEIV0(25:11)
 10160     CALL 'kxdfhei1' USING DFHEIV0,
 10161           DFHEIV1,
 10162           DFHEIV20,
 10163           DFHEIV99,
 10164           CNTL-KEY,
 10165           CNTL-GENERIC-LENGTH,
 10166           DFHEIV99,
 10167           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 184
* EL131.cbl
 10168     SET ADDRESS OF CONTROL-FILE TO
 10169         DFHEIV20
 10170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10171
 10172
 10173     MOVE AL-UANON               TO CERTSTA.
 10174     MOVE 'X'                    TO UPDATE-SWITCH.
 10175     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10176     GO TO 1490-EXIT.
 10177
 10178 1490-STATE-NOTFND.
 10179     MOVE ER-0149                TO EMI-ERROR.
 10180
 10181 1490-STATE-ERROR.
 10182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10183     MOVE AL-UABON               TO CERTSTA.
 10184     MOVE -1                     TO CERTSTL.
 10185     MOVE 'X'                    TO ERROR-SWITCH.
 10186
 10187 1490-EXIT.
 10188     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 185
* EL131.cbl
 10190 1500-EDIT-CARR.
 10191     IF CERTCARI = SPACES
 10192         GO TO 1500-CARR-NOTFND.
 10193
 10194     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10195     MOVE '6'                    TO CNTL-REC-TYPE.
 10196     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10197     MOVE CERTCARI               TO CNTL-CARRIER.
 10198     MOVE ZERO                   TO CNTL-SEQ-NO.
 10199
 10200
 10201* EXEC CICS HANDLE CONDITION
 10202*         NOTFND   (1500-CARR-NOTFND)
 10203*    END-EXEC.
 10204*    MOVE '"$I                   ! * #00009537' TO DFHEIV0
 10205     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10207     MOVE X'2A20233030303039353337' TO DFHEIV0(25:11)
 10208     CALL 'kxdfhei1' USING DFHEIV0
 10209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10210
 10211
 10212
 10213* EXEC CICS READ
 10214*         SET        (ADDRESS OF CONTROL-FILE)
 10215*         DATASET    ('ELCNTL')
 10216*         RIDFLD     (CNTL-KEY)
 10217*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10218*         GENERIC
 10219*    END-EXEC.
 10220     MOVE 'ELCNTL' TO DFHEIV1
 10221*    MOVE '&"S  KG    E          (   #00009541' TO DFHEIV0
 10222     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10224     MOVE X'2020233030303039353431' TO DFHEIV0(25:11)
 10225     CALL 'kxdfhei1' USING DFHEIV0,
 10226           DFHEIV1,
 10227           DFHEIV20,
 10228           DFHEIV99,
 10229           CNTL-KEY,
 10230           CNTL-GENERIC-LENGTH,
 10231           DFHEIV99,
 10232           DFHEIV99
 10233     SET ADDRESS OF CONTROL-FILE TO
 10234         DFHEIV20
 10235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10236
 10237
 10238     MOVE AL-UANON               TO CERTCARA.
 10239     MOVE 'X'                    TO UPDATE-SWITCH.
 10240     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10241     GO TO 1500-EXIT.
 10242
 10243 1500-CARR-NOTFND.
 10244     MOVE ER-0360                TO EMI-ERROR.
 10245     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10246     MOVE AL-UABON               TO CERTCARA.
 10247     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 186
* EL131.cbl
 10248     MOVE 'X'                    TO ERROR-SWITCH.
 10249
 10250 1500-EXIT.
 10251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 187
* EL131.cbl
 10253 1510-DEEDIT-DATE.
 10254
 10255* EXEC CICS BIF DEEDIT
 10256*         FIELD    (DEEDIT-DATE-INPUT)
 10257*         LENGTH   (DATE-LENGTH)
 10258*    END-EXEC.
 10259*    MOVE '@"L                   #   #00009565' TO DFHEIV0
 10260     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10261     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10262     MOVE X'2020233030303039353635' TO DFHEIV0(25:11)
 10263     CALL 'kxdfhei1' USING DFHEIV0,
 10264           DEEDIT-DATE-INPUT,
 10265           DATE-LENGTH
 10266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10267
 10268
 10269 1510-EXIT.
 10270     EXIT.
 10271
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 188
* EL131.cbl
 10273 1620-VERIFY-ACCT.
 10274
 10275     move ' '                    to ws-eracct-sw
 10276     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10277     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10278     MOVE PI-GROUPING            TO ACCT-GROUP.
 10279     MOVE PI-STATE               TO ACCT-STATE.
 10280     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10281
 10282     IF CERTEFFI GREATER THAN LOW-VALUES
 10283         MOVE HOLD-EFF           TO ACCT-DATE
 10284     ELSE
 10285         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10286
 10287     IF CERTACTI GREATER THAN LOW-VALUES
 10288         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10289     IF CERTSTI GREATER THAN LOW-VALUES
 10290         MOVE CERTSTI            TO  ACCT-STATE.
 10291     IF CERTCARI GREATER THAN LOW-VALUES
 10292         MOVE CERTCARI           TO  ACCT-CARRIER.
 10293     IF CERTGRPI GREATER THAN LOW-VALUES
 10294         MOVE CERTGRPI           TO ACCT-GROUP.
 10295
 10296     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10297
 10298
 10299* EXEC CICS HANDLE CONDITION
 10300*         NOTFND  (1620-ACCT-NOTFND)
 10301*    END-EXEC.
 10302*    MOVE '"$I                   ! + #00009599' TO DFHEIV0
 10303     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10305     MOVE X'2B20233030303039353939' TO DFHEIV0(25:11)
 10306     CALL 'kxdfhei1' USING DFHEIV0
 10307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10308
 10309
 10310
 10311* EXEC CICS STARTBR
 10312*         DATASET   (ACCT-FILE-ID)
 10313*         RIDFLD    (ACCT-KEY)
 10314*    END-EXEC.
 10315     MOVE 0
 10316       TO DFHEIV11
 10317*    MOVE '&,         G          &   #00009603' TO DFHEIV0
 10318     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10320     MOVE X'2020233030303039363033' TO DFHEIV0(25:11)
 10321     CALL 'kxdfhei1' USING DFHEIV0,
 10322           ACCT-FILE-ID,
 10323           ACCT-KEY,
 10324           DFHEIV99,
 10325           DFHEIV11,
 10326           DFHEIV99
 10327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10328
 10329
 10330 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 189
* EL131.cbl
 10331
 10332
 10333* EXEC CICS READNEXT
 10334*         DATASET  (ACCT-FILE-ID)
 10335*         RIDFLD   (ACCT-KEY)
 10336*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10337*    END-EXEC.
 10338     MOVE 0
 10339       TO DFHEIV11
 10340*    MOVE '&.S                   )   #00009610' TO DFHEIV0
 10341     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10342     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10343     MOVE X'2020233030303039363130' TO DFHEIV0(25:11)
 10344     CALL 'kxdfhei1' USING DFHEIV0,
 10345           ACCT-FILE-ID,
 10346           DFHEIV20,
 10347           DFHEIV99,
 10348           ACCT-KEY,
 10349           DFHEIV99,
 10350           DFHEIV11,
 10351           DFHEIV99,
 10352           DFHEIV99
 10353     SET ADDRESS OF ACCOUNT-MASTER TO
 10354         DFHEIV20
 10355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10356
 10357
 10358     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10359         GO TO 1620-ACCT-NOTFND.
 10360
 10361     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10362        HOLD-EFF     LESS AM-EXPIRATION-DT
 10363         NEXT SENTENCE
 10364     ELSE
 10365         GO TO 1620-ACCT-LOOP.
 10366
 10367     set acct-found to true
 10368     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10369         GO TO 1620-ACCT-END-BROWSE.
 10370
 10371     IF LOANBALL GREATER THAN +0
 10372         IF AM-MAX-TOT-BEN NUMERIC  AND
 10373            AM-MAX-TOT-BEN GREATER THAN ZERO
 10374             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10375                 MOVE AL-UNBON     TO LOANBALA
 10376                 MOVE -1           TO LOANBALL
 10377                 MOVE 'X'          TO ERROR-SWITCH
 10378                 MOVE ER-7641      TO EMI-ERROR
 10379                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10380
 10381     IF ACVBENEL GREATER THAN +0
 10382         IF AM-MAX-MON-BEN NUMERIC  AND
 10383            AM-MAX-MON-BEN GREATER THAN ZERO
 10384             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10385                 MOVE AL-UNBON     TO ACVBENEA
 10386                 MOVE -1           TO ACVBENEL
 10387                 MOVE 'X'          TO ERROR-SWITCH
 10388                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 190
* EL131.cbl
 10389                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10390
 10391 1620-ACCT-END-BROWSE.
 10392
 10393
 10394* EXEC CICS ENDBR
 10395*         DATASET (ACCT-FILE-ID)
 10396*    END-EXEC.
 10397     MOVE 0
 10398       TO DFHEIV11
 10399*    MOVE '&2                    $   #00009651' TO DFHEIV0
 10400     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10402     MOVE X'2020233030303039363531' TO DFHEIV0(25:11)
 10403     CALL 'kxdfhei1' USING DFHEIV0,
 10404           ACCT-FILE-ID,
 10405           DFHEIV11,
 10406           DFHEIV99
 10407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10408
 10409
 10410     GO TO 1620-EXIT.
 10411
 10412 1620-ACCT-NOTFND.
 10413
 10414     MOVE -1                     TO MAINTL.
 10415     MOVE 'X'                    TO ERROR-SWITCH.
 10416     MOVE ER-0426                TO EMI-ERROR.
 10417     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10418
 10419 1620-EXIT.
 10420     EXIT.
 10421
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 191
* EL131.cbl
 10423 2000-UPDATE-CLAIM.
 10424
 10425     MOVE SPACES                 TO ERROR-SWITCH.
 10426     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10427     MOVE PI-CARRIER             TO CARRIER-CODE.
 10428     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10429     MOVE PI-CERT-NO             TO CERT-NO.
 10430
 10431     IF DELETE-CLAIM
 10432         GO TO 3000-DELETE-CLAIM.
 10433
 10434     IF  NOT MODIFY-CAP
 10435         MOVE ER-0070            TO EMI-ERROR
 10436         MOVE 'X'                TO ERROR-SWITCH
 10437         MOVE -1                 TO MAINTL
 10438         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10439         GO TO 2000-EXIT.
 10440
 10441     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10442     MOVE ZERO                   TO TRLR-SEQ-NO.
 10443
 10444
 10445* EXEC CICS READ UPDATE
 10446*         SET       (ADDRESS OF CLAIM-MASTER)
 10447*         DATASET   (CLMS-FILE-ID)
 10448*         RIDFLD    (MSTR-KEY)
 10449*    END-EXEC.
 10450*    MOVE '&"S        EU         (   #00009689' TO DFHEIV0
 10451     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10452     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10453     MOVE X'2020233030303039363839' TO DFHEIV0(25:11)
 10454     CALL 'kxdfhei1' USING DFHEIV0,
 10455           CLMS-FILE-ID,
 10456           DFHEIV20,
 10457           DFHEIV99,
 10458           MSTR-KEY,
 10459           DFHEIV99,
 10460           DFHEIV99,
 10461           DFHEIV99
 10462     SET ADDRESS OF CLAIM-MASTER TO
 10463         DFHEIV20
 10464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10465
 10466
 10467     if (incl > zeros)
 10468        and (cl-no-of-pmts-made > 0)
 10469        and (hold-incur > low-values)
 10470        and (hold-incur not = cl-incurred-dt)
 10471        if hold-incur > cl-incurred-dt
 10472           move cl-incurred-dt   to dc-bin-date-1
 10473           move hold-incur       to dc-bin-date-2
 10474        else
 10475           move hold-incur       to dc-bin-date-1
 10476           move cl-incurred-dt   to dc-bin-date-2
 10477        end-if
 10478        move '1'                 to dc-option-code
 10479        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10480        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 192
* EL131.cbl
 10481           MOVE ER-1663             TO EMI-ERROR
 10482           PERFORM 9900-ERROR-FORMAT
 10483                                 THRU 9900-EXIT
 10484           MOVE -1                  TO MAINTL
 10485           GO TO 8110-SEND-DATA
 10486        end-if
 10487     end-if
 10488     IF (CL-PRIORITY-CD = '8')
 10489        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10490             AND 'AMWA' AND 'KMSB')
 10491        MOVE ER-8003             TO EMI-ERROR
 10492        PERFORM 9900-ERROR-FORMAT
 10493                                 THRU 9900-EXIT
 10494        MOVE -1                  TO MAINTL
 10495        GO TO 8110-SEND-DATA
 10496     END-IF
 10497
 10498     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10499         MOVE ER-0068            TO EMI-ERROR
 10500         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10501         GO TO 2000-EXIT.
 10502
 10503     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10504         MOVE ER-0068            TO EMI-ERROR
 10505         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10506         GO TO 2000-EXIT.
 10507
 10508     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10509         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10510
 10511     IF CL-PURGED-DT NOT = LOW-VALUES
 10512         MOVE ER-7691            TO EMI-ERROR
 10513         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10514         GO TO 2000-EXIT.
 10515
 10516     IF CERT-KEY-CHANGED
 10517         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10518
 10519     IF SCREEN-ERROR
 10520         MOVE ER-0068            TO EMI-ERROR
 10521         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10522         GO TO 2000-EXIT.
 10523
 10524     IF NINETY-TRLR-UPDATED
 10525         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10526
 10527     IF MSTR-KEY-CHANGED
 10528         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10529        ELSE
 10530         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10531
 10532     IF TRLR-UPDATE-REQUIRED
 10533         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10534
 10535 2000-CHECK-CERT.
 10536     IF NOT CERT-UPDATES
 10537         GO TO 2000-EXIT.
 10538
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 193
* EL131.cbl
 10539     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10540     MOVE PI-CARRIER             TO CERT-CARRIER.
 10541     MOVE PI-GROUPING            TO CERT-GROUP.
 10542     MOVE PI-STATE               TO CERT-STATE.
 10543     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10544     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10545     MOVE PI-CERT-NO             TO CERT-CERT.
 10546
 10547     IF CERT-ALT-KEY-CHANGED
 10548         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10549     ELSE
 10550         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10551
 10552 2000-EXIT.
 10553     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 194
* EL131.cbl
 10555 2010-RELEASE-REC.
 10556
 10557* EXEC CICS UNLOCK
 10558*         DATASET  (CLMS-FILE-ID)
 10559*    END-EXEC
 10560*    MOVE '&*                    #   #00009784' TO DFHEIV0
 10561     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10562     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10563     MOVE X'2020233030303039373834' TO DFHEIV0(25:11)
 10564     CALL 'kxdfhei1' USING DFHEIV0,
 10565           CLMS-FILE-ID,
 10566           DFHEIV99
 10567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10568
 10569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10570     MOVE 'X'                    TO ERROR-SWITCH.
 10571
 10572 2010-EXIT.
 10573     EXIT.
 10574
 10575 2020-NORMAL-UPDATE.
 10576     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10577
 10578     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10579
 10580     IF WS-OPEN-CLOSE-SW = 'Y'
 10581       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10582       IF PI-REC-FOUND-SW = 'Y'
 10583         IF CL-ACTIVITY-CODE = 09
 10584           NEXT SENTENCE
 10585         ELSE
 10586           IF WS-RESET-SW = 'Y'
 10587             IF CL-CLAIM-STATUS = 'C'
 10588               MOVE 07               TO  CL-ACTIVITY-CODE
 10589               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10590               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10591             ELSE
 10592               MOVE 08               TO  CL-ACTIVITY-CODE
 10593               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10594               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10595
 10596     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10597         MOVE 'Y'                TO CL-YESNOSW
 10598     END-IF.
 10599
 10600     if pi-company-id = 'DCC' OR 'VPP'
 10601        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10602        perform 2120-check-pdef  thru 2120-exit
 10603     end-if
 10604     if ((benperl <> zeros)
 10605        and (benperi numeric))
 10606                  or
 10607            (instypel <> zeros)
 10608        perform 2140-update-elcrtt thru 2140-exit
 10609     end-if
 10610
 10611* EXEC CICS HANDLE CONDITION
 10612*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 195
* EL131.cbl
 10613*    END-EXEC.
 10614*    MOVE '"$$                   ! , #00009829' TO DFHEIV0
 10615     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10617     MOVE X'2C20233030303039383239' TO DFHEIV0(25:11)
 10618     CALL 'kxdfhei1' USING DFHEIV0
 10619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10620
 10621
 10622
 10623* EXEC CICS REWRITE
 10624*         DATASET   (CLMS-FILE-ID)
 10625*         FROM      (CLAIM-MASTER)
 10626*    END-EXEC.
 10627     MOVE LENGTH OF
 10628      CLAIM-MASTER
 10629       TO DFHEIV11
 10630*    MOVE '&& L                  %   #00009833' TO DFHEIV0
 10631     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10632     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10633     MOVE X'2020233030303039383333' TO DFHEIV0(25:11)
 10634     CALL 'kxdfhei1' USING DFHEIV0,
 10635           CLMS-FILE-ID,
 10636           CLAIM-MASTER,
 10637           DFHEIV11,
 10638           DFHEIV99
 10639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10640
 10641
 10642 2020-EXIT.
 10643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 196
* EL131.cbl
 10645 2030-KEY-UPDATE.
 10646     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10647
 10648
 10649* EXEC CICS DELETE
 10650*        DATASET  (CLMS-FILE-ID)
 10651*    END-EXEC.
 10652*    MOVE '&(                    &   #00009844' TO DFHEIV0
 10653     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10654     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10655     MOVE X'2020233030303039383434' TO DFHEIV0(25:11)
 10656     CALL 'kxdfhei1' USING DFHEIV0,
 10657           CLMS-FILE-ID,
 10658           DFHEIV99,
 10659           DFHEIV99,
 10660           DFHEIV99,
 10661           DFHEIV99
 10662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10663
 10664
 10665
 10666* EXEC CICS GETMAIN
 10667*         SET      (ADDRESS OF CLAIM-MASTER)
 10668*         LENGTH   (MSTR-LENGTH)
 10669*         INITIMG  (GETMAIN-SPACE)
 10670*    END-EXEC.
 10671*    MOVE ',"IL                  $   #00009848' TO DFHEIV0
 10672     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10673     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10674     MOVE X'2020233030303039383438' TO DFHEIV0(25:11)
 10675     CALL 'kxdfhei1' USING DFHEIV0,
 10676           DFHEIV20,
 10677           MSTR-LENGTH,
 10678           GETMAIN-SPACE
 10679     SET ADDRESS OF CLAIM-MASTER TO
 10680         DFHEIV20
 10681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10682
 10683
 10684     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10685
 10686     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10687
 10688     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10689
 10690     IF WS-OPEN-CLOSE-SW = 'Y'
 10691       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10692         IF PI-REC-FOUND-SW = 'Y'
 10693           IF CL-ACTIVITY-CODE = 09
 10694             NEXT SENTENCE
 10695           ELSE
 10696             IF WS-RESET-SW = 'Y'
 10697               IF CL-CLAIM-STATUS = 'C'
 10698                 MOVE 07             TO  CL-ACTIVITY-CODE
 10699                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10700                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10701               ELSE
 10702                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 197
* EL131.cbl
 10703                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10704                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10705
 10706
 10707* EXEC CICS HANDLE CONDITION
 10708*         DUPKEY    (2030-EXIT)
 10709*    END-EXEC.
 10710*    MOVE '"$$                   ! - #00009876' TO DFHEIV0
 10711     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10713     MOVE X'2D20233030303039383736' TO DFHEIV0(25:11)
 10714     CALL 'kxdfhei1' USING DFHEIV0
 10715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10716
 10717
 10718** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10719*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10720
 10721     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10722         MOVE 'Y'                TO CL-YESNOSW
 10723     END-IF.
 10724
 10725
 10726* EXEC CICS WRITE
 10727*         DATASET   (CLMS-FILE-ID)
 10728*         RIDFLD    (MSTR-KEY)
 10729*         FROM      (CLAIM-MASTER)
 10730*    END-EXEC.
 10731     MOVE LENGTH OF
 10732      CLAIM-MASTER
 10733       TO DFHEIV11
 10734*    MOVE '&$ L                  ''   #00009887' TO DFHEIV0
 10735     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10736     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10737     MOVE X'2020233030303039383837' TO DFHEIV0(25:11)
 10738     CALL 'kxdfhei1' USING DFHEIV0,
 10739           CLMS-FILE-ID,
 10740           CLAIM-MASTER,
 10741           DFHEIV11,
 10742           MSTR-KEY,
 10743           DFHEIV99,
 10744           DFHEIV99
 10745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10746
 10747
 10748 2030-EXIT.
 10749     EXIT.
 10750
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 198
* EL131.cbl
 10752 2040-NORMAL-UPDATE.
 10753
 10754* EXEC CICS READ UPDATE
 10755*         DATASET  (CERT-FILE-ID)
 10756*         RIDFLD   (CERT-KEY)
 10757*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10758*    END-EXEC.
 10759*    MOVE '&"S        EU         (   #00009898' TO DFHEIV0
 10760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10761     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10762     MOVE X'2020233030303039383938' TO DFHEIV0(25:11)
 10763     CALL 'kxdfhei1' USING DFHEIV0,
 10764           CERT-FILE-ID,
 10765           DFHEIV20,
 10766           DFHEIV99,
 10767           CERT-KEY,
 10768           DFHEIV99,
 10769           DFHEIV99,
 10770           DFHEIV99
 10771     SET ADDRESS OF CERTIFICATE-MASTER TO
 10772         DFHEIV20
 10773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10774
 10775
 10776     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10777
 10778
 10779* EXEC CICS HANDLE CONDITION
 10780*         DUPKEY   (2040-EXIT)
 10781*    END-EXEC.
 10782*    MOVE '"$$                   ! . #00009906' TO DFHEIV0
 10783     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10785     MOVE X'2E20233030303039393036' TO DFHEIV0(25:11)
 10786     CALL 'kxdfhei1' USING DFHEIV0
 10787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10788
 10789
 10790
 10791* EXEC CICS REWRITE
 10792*         DATASET  (CERT-FILE-ID)
 10793*         FROM     (CERTIFICATE-MASTER)
 10794*    END-EXEC.
 10795     MOVE LENGTH OF
 10796      CERTIFICATE-MASTER
 10797       TO DFHEIV11
 10798*    MOVE '&& L                  %   #00009910' TO DFHEIV0
 10799     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10800     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10801     MOVE X'2020233030303039393130' TO DFHEIV0(25:11)
 10802     CALL 'kxdfhei1' USING DFHEIV0,
 10803           CERT-FILE-ID,
 10804           CERTIFICATE-MASTER,
 10805           DFHEIV11,
 10806           DFHEIV99
 10807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10808
 10809
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 199
* EL131.cbl
 10810 2040-EXIT.
 10811     EXIT.
 10812
 10813 2050-KEY-UPDATE.
 10814
 10815* EXEC CICS READ UPDATE
 10816*         DATASET  (CERT-FILE-ID)
 10817*         RIDFLD   (CERT-KEY)
 10818*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10819*    END-EXEC.
 10820*    MOVE '&"S        EU         (   #00009919' TO DFHEIV0
 10821     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10822     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10823     MOVE X'2020233030303039393139' TO DFHEIV0(25:11)
 10824     CALL 'kxdfhei1' USING DFHEIV0,
 10825           CERT-FILE-ID,
 10826           DFHEIV20,
 10827           DFHEIV99,
 10828           CERT-KEY,
 10829           DFHEIV99,
 10830           DFHEIV99,
 10831           DFHEIV99
 10832     SET ADDRESS OF CERTIFICATE-MASTER TO
 10833         DFHEIV20
 10834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10835
 10836
 10837     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10838
 10839
 10840* EXEC CICS DELETE
 10841*         DATASET   (CERT-FILE-ID)
 10842*    END-EXEC.
 10843*    MOVE '&(                    &   #00009927' TO DFHEIV0
 10844     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10845     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10846     MOVE X'2020233030303039393237' TO DFHEIV0(25:11)
 10847     CALL 'kxdfhei1' USING DFHEIV0,
 10848           CERT-FILE-ID,
 10849           DFHEIV99,
 10850           DFHEIV99,
 10851           DFHEIV99,
 10852           DFHEIV99
 10853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10854
 10855
 10856
 10857* EXEC CICS GETMAIN
 10858*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10859*         LENGTH    (CERT-LENGTH)
 10860*         INITIMG   (GETMAIN-SPACE)
 10861*    END-EXEC.
 10862*    MOVE ',"IL                  $   #00009931' TO DFHEIV0
 10863     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10864     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10865     MOVE X'2020233030303039393331' TO DFHEIV0(25:11)
 10866     CALL 'kxdfhei1' USING DFHEIV0,
 10867           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 200
* EL131.cbl
 10868           CERT-LENGTH,
 10869           GETMAIN-SPACE
 10870     SET ADDRESS OF CERTIFICATE-MASTER TO
 10871         DFHEIV20
 10872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10873
 10874
 10875     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10876
 10877     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10878
 10879
 10880* EXEC CICS HANDLE CONDITION
 10881*         DUPKEY (2050-EXIT)
 10882*    END-EXEC.
 10883*    MOVE '"$$                   ! / #00009941' TO DFHEIV0
 10884     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10886     MOVE X'2F20233030303039393431' TO DFHEIV0(25:11)
 10887     CALL 'kxdfhei1' USING DFHEIV0
 10888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10889
 10890
 10891
 10892* EXEC CICS WRITE
 10893*         DATASET  (CERT-FILE-ID)
 10894*         RIDFLD   (CERT-KEY)
 10895*         FROM     (CERTIFICATE-MASTER)
 10896*    END-EXEC.
 10897     MOVE LENGTH OF
 10898      CERTIFICATE-MASTER
 10899       TO DFHEIV11
 10900*    MOVE '&$ L                  ''   #00009945' TO DFHEIV0
 10901     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10903     MOVE X'2020233030303039393435' TO DFHEIV0(25:11)
 10904     CALL 'kxdfhei1' USING DFHEIV0,
 10905           CERT-FILE-ID,
 10906           CERTIFICATE-MASTER,
 10907           DFHEIV11,
 10908           CERT-KEY,
 10909           DFHEIV99,
 10910           DFHEIV99
 10911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10912
 10913
 10914 2050-EXIT.
 10915     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 201
* EL131.cbl
 10917 2060-CHANGE-CERT.
 10918     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10919     MOVE PI-CARRIER             TO CERT-CARRIER.
 10920     MOVE PI-GROUPING            TO CERT-GROUP.
 10921     MOVE PI-STATE               TO CERT-STATE.
 10922     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10923     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10924     MOVE PI-CERT-NO             TO CERT-CERT.
 10925     IF CERTEFFI GREATER THAN LOW-VALUES
 10926         MOVE HOLD-EFF           TO CERT-DATE.
 10927     IF CERTACTI GREATER THAN LOW-VALUES
 10928         MOVE CERTACTI           TO CERT-ACCOUNT.
 10929     IF CERTSTI GREATER THAN LOW-VALUES
 10930         MOVE CERTSTI            TO CERT-STATE.
 10931     IF CERTCARI GREATER THAN LOW-VALUES
 10932         MOVE CERTCARI           TO CERT-CARRIER.
 10933     IF CERTGRPI GREATER THAN LOW-VALUES
 10934         MOVE CERTGRPI           TO CERT-GROUP.
 10935     IF CERTI GREATER THAN LOW-VALUES
 10936         MOVE CERTI              TO CERT-CERT-PRIME.
 10937     IF SUFXI GREATER THAN LOW-VALUES
 10938         MOVE SUFXI              TO CERT-CERT-SUFX.
 10939
 10940
 10941* EXEC CICS HANDLE CONDITION
 10942*         NOTFND   (2060-CERT-NOTFND)
 10943*    END-EXEC.
 10944*    MOVE '"$I                   ! 0 #00009977' TO DFHEIV0
 10945     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10947     MOVE X'3020233030303039393737' TO DFHEIV0(25:11)
 10948     CALL 'kxdfhei1' USING DFHEIV0
 10949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10950
 10951
 10952
 10953* EXEC CICS READ UPDATE
 10954*         DATASET  (CERT-FILE-ID)
 10955*         RIDFLD   (CERT-KEY)
 10956*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10957*    END-EXEC.
 10958*    MOVE '&"S        EU         (   #00009981' TO DFHEIV0
 10959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10960     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10961     MOVE X'2020233030303039393831' TO DFHEIV0(25:11)
 10962     CALL 'kxdfhei1' USING DFHEIV0,
 10963           CERT-FILE-ID,
 10964           DFHEIV20,
 10965           DFHEIV99,
 10966           CERT-KEY,
 10967           DFHEIV99,
 10968           DFHEIV99,
 10969           DFHEIV99
 10970     SET ADDRESS OF CERTIFICATE-MASTER TO
 10971         DFHEIV20
 10972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10973
 10974
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 202
* EL131.cbl
 10975     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10976
 10977     IF CM-CLAIM-INTERFACE-SW = SPACES
 10978        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10979
 10980
 10981* EXEC CICS HANDLE CONDITION
 10982*         DUPKEY   (2060-DUPKEY)
 10983*    END-EXEC.
 10984*    MOVE '"$$                   ! 1 #00009992' TO DFHEIV0
 10985     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10987     MOVE X'3120233030303039393932' TO DFHEIV0(25:11)
 10988     CALL 'kxdfhei1' USING DFHEIV0
 10989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10990
 10991
 10992
 10993* EXEC CICS REWRITE
 10994*         DATASET  (CERT-FILE-ID)
 10995*         FROM     (CERTIFICATE-MASTER)
 10996*    END-EXEC.
 10997     MOVE LENGTH OF
 10998      CERTIFICATE-MASTER
 10999       TO DFHEIV11
 11000*    MOVE '&& L                  %   #00009996' TO DFHEIV0
 11001     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11002     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11003     MOVE X'2020233030303039393936' TO DFHEIV0(25:11)
 11004     CALL 'kxdfhei1' USING DFHEIV0,
 11005           CERT-FILE-ID,
 11006           CERTIFICATE-MASTER,
 11007           DFHEIV11,
 11008           DFHEIV99
 11009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11010
 11011
 11012 2060-DUPKEY.
 11013
 11014     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11015
 11016 2060-CHANGE-TRLR-ACTQ.
 11017     IF SCREEN-ERROR
 11018         GO TO 2060-EXIT.
 11019
 11020     IF CERTI    GREATER LOW-VALUES OR
 11021        SUFXI    GREATER LOW-VALUES OR
 11022        CERTCARI GREATER LOW-VALUES
 11023         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11024         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11025
 11026     MOVE SPACES                 TO CERT-KEY-SWITCH
 11027                                    CERT-SWITCH
 11028                                    TRLR-SWITCH
 11029                                    NINETY-TRLR-SWITCH.
 11030     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11031     GO TO 2060-EXIT.
 11032
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 203
* EL131.cbl
 11033 2060-CERT-NOTFND.
 11034     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11035
 11036     IF WS-REC-FOUND-SW = 'N'
 11037         MOVE ER-0206            TO  EMI-ERROR
 11038         MOVE -1                 TO  MAINTL
 11039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11040
 11041* EXEC CICS UNLOCK
 11042*            DATASET   (CLMS-FILE-ID)
 11043*        END-EXEC
 11044*    MOVE '&*                    #   #00010029' TO DFHEIV0
 11045     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11046     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11047     MOVE X'2020233030303130303239' TO DFHEIV0(25:11)
 11048     CALL 'kxdfhei1' USING DFHEIV0,
 11049           CLMS-FILE-ID,
 11050           DFHEIV99
 11051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11052         GO TO 8110-SEND-DATA.
 11053
 11054     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11055
 11056     GO TO 2060-CHANGE-TRLR-ACTQ.
 11057
 11058 2060-EXIT.
 11059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 204
* EL131.cbl
 11061 2070-CHECK-OLD.
 11062
 11063
 11064* EXEC CICS HANDLE CONDITION
 11065*        NOTFND   (2070-NOT-FOUND)
 11066*    END-EXEC.
 11067*    MOVE '"$I                   ! 2 #00010043' TO DFHEIV0
 11068     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11070     MOVE X'3220233030303130303433' TO DFHEIV0(25:11)
 11071     CALL 'kxdfhei1' USING DFHEIV0
 11072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11073
 11074
 11075     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11076     MOVE PI-CARRIER             TO CERT-CARRIER.
 11077     MOVE PI-GROUPING            TO CERT-GROUP.
 11078     MOVE PI-STATE               TO CERT-STATE.
 11079     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11080     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11081     MOVE PI-CERT-NO             TO CERT-CERT.
 11082
 11083
 11084* EXEC CICS READ UPDATE
 11085*         DATASET  (CERT-FILE-ID)
 11086*         RIDFLD   (CERT-KEY)
 11087*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11088*    END-EXEC.
 11089*    MOVE '&"S        EU         (   #00010055' TO DFHEIV0
 11090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11091     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11092     MOVE X'2020233030303130303535' TO DFHEIV0(25:11)
 11093     CALL 'kxdfhei1' USING DFHEIV0,
 11094           CERT-FILE-ID,
 11095           DFHEIV20,
 11096           DFHEIV99,
 11097           CERT-KEY,
 11098           DFHEIV99,
 11099           DFHEIV99,
 11100           DFHEIV99
 11101     SET ADDRESS OF CERTIFICATE-MASTER TO
 11102         DFHEIV20
 11103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11104
 11105
 11106     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11107     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11108     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11109
 11110     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11111         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11112
 11113     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11114       AND
 11115        CERT-WAS-CREATED-FOR-CLAIM
 11116         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11117
 11118* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 205
* EL131.cbl
 11119*             DATASET   (CERT-FILE-ID)
 11120*        END-EXEC
 11121*    MOVE '&(                    &   #00010072' TO DFHEIV0
 11122     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11123     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11124     MOVE X'2020233030303130303732' TO DFHEIV0(25:11)
 11125     CALL 'kxdfhei1' USING DFHEIV0,
 11126           CERT-FILE-ID,
 11127           DFHEIV99,
 11128           DFHEIV99,
 11129           DFHEIV99,
 11130           DFHEIV99
 11131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11132         GO TO 2070-EXIT.
 11133
 11134     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11135         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11136
 11137
 11138* EXEC CICS HANDLE CONDITION
 11139*         DUPKEY   (2070-EXIT)
 11140*    END-EXEC.
 11141*    MOVE '"$$                   ! 3 #00010080' TO DFHEIV0
 11142     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11144     MOVE X'3320233030303130303830' TO DFHEIV0(25:11)
 11145     CALL 'kxdfhei1' USING DFHEIV0
 11146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11147
 11148
 11149
 11150* EXEC CICS REWRITE
 11151*         DATASET  (CERT-FILE-ID)
 11152*         FROM     (CERTIFICATE-MASTER)
 11153*    END-EXEC.
 11154     MOVE LENGTH OF
 11155      CERTIFICATE-MASTER
 11156       TO DFHEIV11
 11157*    MOVE '&& L                  %   #00010084' TO DFHEIV0
 11158     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11159     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11160     MOVE X'2020233030303130303834' TO DFHEIV0(25:11)
 11161     CALL 'kxdfhei1' USING DFHEIV0,
 11162           CERT-FILE-ID,
 11163           CERTIFICATE-MASTER,
 11164           DFHEIV11,
 11165           DFHEIV99
 11166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11167
 11168
 11169     GO TO 2070-EXIT.
 11170
 11171 2070-NOT-FOUND.
 11172     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11173
 11174 2070-EXIT.
 11175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 206
* EL131.cbl
 11177 2080-CREATE-CERT.
 11178
 11179* EXEC CICS GETMAIN
 11180*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11181*         LENGTH    (CERT-LENGTH)
 11182*         INITIMG   (GETMAIN-SPACE)
 11183*    END-EXEC.
 11184*    MOVE ',"IL                  $   #00010098' TO DFHEIV0
 11185     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11187     MOVE X'2020233030303130303938' TO DFHEIV0(25:11)
 11188     CALL 'kxdfhei1' USING DFHEIV0,
 11189           DFHEIV20,
 11190           CERT-LENGTH,
 11191           GETMAIN-SPACE
 11192     SET ADDRESS OF CERTIFICATE-MASTER TO
 11193         DFHEIV20
 11194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11195
 11196
 11197     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11198
 11199     IF CERTEFFI GREATER THAN LOW-VALUES
 11200         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11201                                    DC-BIN-DATE-1
 11202         MOVE '6'                TO DC-OPTION-CODE
 11203         MOVE +1                 TO DC-ELAPSED-MONTHS
 11204         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11205         IF NO-CONVERSION-ERROR
 11206             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11207
 11208     IF CERTACTI GREATER THAN LOW-VALUES
 11209         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11210     IF CERTSTI GREATER THAN LOW-VALUES
 11211         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11212     IF CERTCARI GREATER THAN LOW-VALUES
 11213         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11214     IF CERTGRPI GREATER THAN LOW-VALUES
 11215         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11216     IF CERTI GREATER THAN LOW-VALUES
 11217         MOVE CERTI              TO CERT-CERT-PRIME
 11218                                    CM-CERT-PRIME
 11219         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11220
 11221     IF SUFXI GREATER THAN LOW-VALUES
 11222         MOVE SUFXI              TO CERT-CERT-SUFX
 11223                                    CM-CERT-SFX
 11224         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11225
 11226     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11227
 11228     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11229
 11230     MOVE SPACES                 TO CM-ENTRY-BATCH
 11231                                    CM-LF-EXIT-BATCH
 11232                                    CM-AH-EXIT-BATCH
 11233                                    CM-CREDIT-INTERFACE-SW-1
 11234                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 207
* EL131.cbl
 11235
 11236     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11237                               '9' OR 'D' OR 'V'
 11238         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11239
 11240     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11241                               '9' OR 'D' OR 'V'
 11242         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11243
 11244     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11245                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11246     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11247
 11248
 11249* EXEC CICS HANDLE CONDITION
 11250*         DUPKEY (2080-EXIT)
 11251*    END-EXEC.
 11252*    MOVE '"$$                   ! 4 #00010155' TO DFHEIV0
 11253     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11255     MOVE X'3420233030303130313535' TO DFHEIV0(25:11)
 11256     CALL 'kxdfhei1' USING DFHEIV0
 11257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11258
 11259
 11260
 11261* EXEC CICS WRITE
 11262*         DATASET  (CERT-FILE-ID)
 11263*         RIDFLD   (CERT-KEY)
 11264*         FROM     (CERTIFICATE-MASTER)
 11265*    END-EXEC.
 11266     MOVE LENGTH OF
 11267      CERTIFICATE-MASTER
 11268       TO DFHEIV11
 11269*    MOVE '&$ L                  ''   #00010159' TO DFHEIV0
 11270     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11271     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11272     MOVE X'2020233030303130313539' TO DFHEIV0(25:11)
 11273     CALL 'kxdfhei1' USING DFHEIV0,
 11274           CERT-FILE-ID,
 11275           CERTIFICATE-MASTER,
 11276           DFHEIV11,
 11277           CERT-KEY,
 11278           DFHEIV99,
 11279           DFHEIV99
 11280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11281
 11282
 11283 2080-EXIT.
 11284     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 208
* EL131.cbl
 11286 2100-MOVE-MSTR.
 11287     IF TYPEI GREATER THAN LOW-VALUES
 11288         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11289
 11290     IF STATUSI = LOW-VALUES
 11291         GO TO 2100-NO-STATUS-CHANGE.
 11292
 11293     IF STATUSI = 'OPEN' OR 'O'
 11294         IF CL-CLAIM-STATUS = 'O'
 11295             MOVE SPACES         TO TRLR-SWITCH
 11296                 GO TO 2100-NO-STATUS-CHANGE.
 11297
 11298     IF STATUSI = 'CLOSED' OR 'C'
 11299         IF CL-CLAIM-STATUS = 'C'
 11300             MOVE SPACES         TO TRLR-SWITCH
 11301                 GO TO 2100-NO-STATUS-CHANGE.
 11302
 11303     IF PI-COMPANY-ID = 'DMD'
 11304        IF STATUSI = 'OPEN' OR 'O'
 11305           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11306              MOVE ZERO       TO STATUSL
 11307              MOVE LOW-VALUES TO STATUSI
 11308              GO TO 2100-NO-STATUS-CHANGE.
 11309
 11310     IF PI-COMPANY-ID = 'DMD'
 11311         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11312
 11313     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11314
 11315 2100-NO-STATUS-CHANGE.
 11316
 11317     IF CCNOI GREATER THAN LOW-VALUES
 11318         MOVE CCNOI              TO CL-CCN.
 11319
 11320     IF PROCI GREATER THAN LOW-VALUES
 11321         MOVE PROCI              TO CL-PROCESSOR-ID.
 11322
 11323     if (accswi > low-values)
 11324        and (accswi = 'Y' OR 'N')
 11325        move accswi              to cl-accident-claim-sw
 11326     end-if
 11327     if benperi > low-values
 11328        and benperi numeric
 11329        move benperi             to cl-benefit-period
 11330     end-if
 11331     if instypei > low-values
 11332        move instypei            to cl-insured-type
 11333     end-if
 11334     IF SEXI GREATER THAN LOW-VALUES
 11335         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11336
 11337     IF BIRTHI GREATER THAN LOW-VALUES
 11338         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11339
 11340     IF SOCIALI GREATER THAN LOW-VALUES
 11341       AND
 11342        SOCIALI = SPACES
 11343         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 209
* EL131.cbl
 11344         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11345         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11346     ELSE
 11347         IF SOCIALI GREATER THAN LOW-VALUES
 11348             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11349
 11350     IF OCCI GREATER THAN LOW-VALUES
 11351         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11352
 11353     IF BENEL GREATER THAN ZERO
 11354         MOVE BENEI              TO CL-BENEFICIARY.
 11355
 11356     IF DIAGI GREATER THAN LOW-VALUES
 11357         MOVE DIAGI              TO WS-DIAGNOSIS.
 11358
 11359     IF ICD1I GREATER THAN LOW-VALUES
 11360         MOVE ICD1I              TO WS-ICD-CODE-1
 11361     END-IF.
 11362
 11363     IF ICD2I GREATER THAN LOW-VALUES
 11364         MOVE ICD2I              TO WS-ICD-CODE-2
 11365     END-IF.
 11366
 11367     IF PREMTYPI GREATER THAN LOW-VALUES
 11368         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11369
 11370*    IF CAUSEI GREATER THAN LOW-VALUES
 11371*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11372
 11373*    IF ENDI GREATER THAN LOW-VALUES
 11374*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11375
 11376     IF PDTHRUI GREATER THAN LOW-VALUES
 11377        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11378
 11379     IF PDAMTL GREATER THAN +0
 11380        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11381
 11382     IF NODAYSI GREATER THAN LOW-VALUES
 11383        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11384
 11385     IF NOPMTSI GREATER THAN LOW-VALUES
 11386        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11387
 11388     IF FORMTYPI GREATER THAN LOW-VALUES
 11389        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11390
 11391     IF INCI GREATER THAN LOW-VALUES
 11392        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11393
 11394     IF REPI GREATER THAN LOW-VALUES
 11395        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11396
 11397     IF ADDONDTI GREATER THAN LOW-VALUES
 11398        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11399
 11400     IF PRICDI GREATER THAN LOW-VALUES
 11401         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 210
* EL131.cbl
 11402
 11403     IF CRITPL  > ZEROS
 11404        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11405     END-IF
 11406
 11407*    IF CRITPTL > ZEROS
 11408*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11409*    END-IF
 11410
 11411*    IF RTWMOSL > ZEROS
 11412*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11413*    END-IF
 11414     IF FILETOI GREATER THAN LOW-VALUES
 11415         MOVE FILETOI            TO CL-FILE-LOCATION.
 11416
 11417     IF SUPVI GREATER THAN LOW-VALUES
 11418         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11419
 11420     IF MLNAMEI GREATER THAN LOW-VALUES
 11421         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11422
 11423     IF MFNAMEI GREATER THAN LOW-VALUES
 11424         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11425
 11426     IF MMINITI GREATER THAN LOW-VALUES
 11427         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11428
 11429     IF CERTEFFI GREATER THAN LOW-VALUES
 11430         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11431
 11432     IF CERTACTI GREATER THAN LOW-VALUES
 11433         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11434
 11435     IF CERTSTI GREATER THAN LOW-VALUES
 11436         MOVE CERTSTI            TO CL-CERT-STATE.
 11437
 11438     IF CERTCARI GREATER THAN LOW-VALUES
 11439         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11440                                    CL-CARRIER.
 11441
 11442     IF CERTGRPI GREATER THAN LOW-VALUES
 11443         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11444
 11445     IF CERTI GREATER THAN LOW-VALUES
 11446         MOVE CERTI              TO CERT-NO-PRIME.
 11447
 11448     IF SUFXI GREATER THAN LOW-VALUES
 11449         MOVE SUFXI              TO CERT-NO-SUFX.
 11450
 11451     MOVE CERT-NO                TO CL-CERT-NO
 11452                                    CL-CERT-NO-A4.
 11453
 11454     IF PI-COMPANY-ID = 'FLA'
 11455          NEXT SENTENCE
 11456     ELSE
 11457         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11458         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11459         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 211
* EL131.cbl
 11460         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11461
 11462     IF TRLR-UPDATE-REQUIRED
 11463        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11464        MOVE ZEROS              TO TRLR-SEQ-NO
 11465
 11466* EXEC CICS READ
 11467*            DATASET   (TRLR-FILE-ID)
 11468*            RIDFLD    (TRLR-KEY)
 11469*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11470*       END-EXEC
 11471*    MOVE '&"S        E          (   #00010347' TO DFHEIV0
 11472     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11473     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11474     MOVE X'2020233030303130333437' TO DFHEIV0(25:11)
 11475     CALL 'kxdfhei1' USING DFHEIV0,
 11476           TRLR-FILE-ID,
 11477           DFHEIV20,
 11478           DFHEIV99,
 11479           TRLR-KEY,
 11480           DFHEIV99,
 11481           DFHEIV99,
 11482           DFHEIV99
 11483     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11484         DFHEIV20
 11485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11486        IF AT-TRAILER-TYPE = '1'
 11487           MOVE +1 TO MISC-SUB
 11488           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11489           MISC-SUB GREATER THAN +6 OR
 11490           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11491           IF MISC-SUB GREATER THAN +1
 11492              SUBTRACT +1 FROM MISC-SUB
 11493              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11494                 GO TO 2100-BYPASS-LAST-UPDATE.
 11495
 11496     IF TRLR-UPDATE-REQUIRED AND
 11497        CLAIM-IS-OPEN
 11498         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11499     ELSE
 11500         IF TRLR-UPDATE-REQUIRED AND
 11501            CLAIM-IS-CLOSED
 11502             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11503             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11504
 11505 2100-BYPASS-LAST-UPDATE.
 11506     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11507     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11508
 11509     GO TO 2100-EXIT.
 11510
 11511 2100-BUMP-OPEN-CLOSE-HIST.
 11512     ADD +1                      TO MISC-SUB.
 11513
 11514 2100-EXIT.
 11515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 212
* EL131.cbl
 11517 2120-check-pdef.
 11518     move +0                     to s1
 11519     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11520     move spaces                 to ws-dcc-error-line
 11521     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11522     IF ERPDEF-FOUND
 11523        perform 2130-check-trlr  thru 2130-exit
 11524        move +1                  to s1
 11525*       if cl-accident-claim-sw = ' '
 11526*          move er-1655             to ws-error-no (s1)
 11527*          add +1 to s1
 11528*       end-if
 11529        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11530        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11531        if (hold-incur > low-values)
 11532           and (incl > zeros)
 11533           and (hold-incur not = cl-incurred-dt)
 11534           move hold-incur       to dc-bin-date-2
 11535        end-if
 11536        MOVE '1'                 TO DC-OPTION-CODE
 11537        MOVE +0                  TO DC-ELAPSED-MONTHS
 11538                                    DC-ELAPSED-DAYS
 11539        PERFORM 9800-CONVERT-DATE
 11540                                 THRU 9800-EXIT
 11541        IF NO-CONVERSION-ERROR
 11542           MOVE DC-ELAPSED-MONTHS
 11543                                 TO WS-MONTHS-BETWEEN
 11544           IF DC-ELAPSED-DAYS > 1
 11545              ADD 1 TO WS-MONTHS-BETWEEN
 11546           END-IF
 11547        ELSE
 11548           display ' dte conv error ' dc-error-code
 11549           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11550        END-IF
 11551        IF (WS-EXCL-PERIOD = ZEROS)
 11552           OR (WS-MONTHS-BETWEEN = ZEROS)
 11553           CONTINUE
 11554        ELSE
 11555           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11556              MOVE ER-1651       TO ws-error-no (s1)
 11557              add +1             to s1
 11558           END-IF
 11559        END-IF
 11560        IF (WS-COV-ENDS = ZEROS)
 11561           OR (WS-MONTHS-BETWEEN = ZEROS)
 11562           CONTINUE
 11563        ELSE
 11564           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11565              MOVE -1            TO MAINTL
 11566              MOVE ER-1653       TO ws-error-no (s1)
 11567              add +1 to s1
 11568           END-IF
 11569        END-IF
 11570        IF (WS-ACC-PERIOD = ZEROS)
 11571           OR (WS-MONTHS-BETWEEN = ZEROS)
 11572           CONTINUE
 11573        ELSE
 11574           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 213
* EL131.cbl
 11575              and (accswi = spaces or low-values)
 11576*             and (cl-accident-claim-sw = ' ')
 11577              move er-1655       to ws-error-no (s1)
 11578              add +1             to s1
 11579           end-if
 11580           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11581*             if (cl-accident-claim-sw not = 'Y')
 11582              if (accswi not = 'Y')
 11583                 MOVE ER-1652    TO ws-error-no (s1)
 11584              else
 11585                 move er-1662    to ws-error-no (s1)
 11586              end-if
 11587              MOVE -1            TO MAINTL
 11588              add +1             to s1
 11589           END-IF
 11590        END-IF
 11591        if cl-claim-type  = 'I'
 11592           move er-1661          to ws-error-no (s1)
 11593           add +1                to s1
 11594        end-if
 11595        perform 2130-check-trlr  thru 2130-exit
 11596     END-IF
 11597
 11598     .
 11599 2120-exit.
 11600     exit.
 11601
 11602 2130-check-trlr.
 11603
 11604     evaluate true
 11605        when s1 = +0
 11606           move cl-control-primary
 11607                                 to trlr-key
 11608           MOVE +95              TO TRLR-SEQ-NO
 11609
 11610* EXEC CICS READ
 11611*             update
 11612*             DATASET  ('ELTRLR')
 11613*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11614*             RIDFLD   (TRLR-KEY)
 11615*             RESP     (WS-RESPONSE)
 11616*          END-EXEC
 11617     MOVE 'ELTRLR' TO DFHEIV1
 11618*    MOVE '&"S        EU         (  N#00010475' TO DFHEIV0
 11619     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11620     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11621     MOVE X'204E233030303130343735' TO DFHEIV0(25:11)
 11622     CALL 'kxdfhei1' USING DFHEIV0,
 11623           DFHEIV1,
 11624           DFHEIV20,
 11625           DFHEIV99,
 11626           TRLR-KEY,
 11627           DFHEIV99,
 11628           DFHEIV99,
 11629           DFHEIV99
 11630     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11631         DFHEIV20
 11632     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 214
* EL131.cbl
 11633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11634           if ws-resp-normal
 11635              move spaces        to at-info-line-1
 11636           end-if
 11637        when s1 = +1
 11638           if ws-resp-normal
 11639
 11640* exec cics rewrite
 11641*                dataset   ('ELTRLR')
 11642*                from      (activity-trailers)
 11643*             end-exec
 11644     MOVE LENGTH OF
 11645      activity-trailers
 11646       TO DFHEIV11
 11647     MOVE 'ELTRLR' TO DFHEIV1
 11648*    MOVE '&& L                  %   #00010487' TO DFHEIV0
 11649     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11650     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11651     MOVE X'2020233030303130343837' TO DFHEIV0(25:11)
 11652     CALL 'kxdfhei1' USING DFHEIV0,
 11653           DFHEIV1,
 11654           activity-trailers,
 11655           DFHEIV11,
 11656           DFHEIV99
 11657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11658           end-if
 11659        when s1 > +1
 11660           if ws-resp-normal
 11661              move ws-dcc-error-line
 11662                                 to at-info-line-1
 11663
 11664* exec cics rewrite
 11665*                dataset   ('ELTRLR')
 11666*                from      (activity-trailers)
 11667*             end-exec
 11668     MOVE LENGTH OF
 11669      activity-trailers
 11670       TO DFHEIV11
 11671     MOVE 'ELTRLR' TO DFHEIV1
 11672*    MOVE '&& L                  %   #00010496' TO DFHEIV0
 11673     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11674     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11675     MOVE X'2020233030303130343936' TO DFHEIV0(25:11)
 11676     CALL 'kxdfhei1' USING DFHEIV0,
 11677           DFHEIV1,
 11678           activity-trailers,
 11679           DFHEIV11,
 11680           DFHEIV99
 11681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11682           else
 11683
 11684* EXEC CICS GETMAIN
 11685*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11686*                LENGTH   (TRLR-LENGTH)
 11687*                INITIMG  (GETMAIN-SPACE)
 11688*             END-EXEC
 11689*    MOVE ',"IL                  $   #00010501' TO DFHEIV0
 11690     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 215
* EL131.cbl
 11691     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11692     MOVE X'2020233030303130353031' TO DFHEIV0(25:11)
 11693     CALL 'kxdfhei1' USING DFHEIV0,
 11694           DFHEIV20,
 11695           TRLR-LENGTH,
 11696           GETMAIN-SPACE
 11697     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11698         DFHEIV20
 11699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11700              move 'AT'          to at-record-id
 11701              move cl-control-primary
 11702                                 to at-control-primary
 11703              move +95           to at-sequence-no
 11704              move '6'           to at-trailer-type
 11705              move ws-dcc-error-line
 11706                                 to at-info-line-1
 11707              move 'E'           to at-info-trailer-type
 11708              move save-bin-date to at-recorded-dt
 11709                                    at-gen-info-last-maint-dt
 11710              move pi-processor-id
 11711                                 to at-recorded-by
 11712                                    at-gen-info-last-updated-by
 11713              move eibtime       to at-last-maint-hhmmss
 11714
 11715* exec cics write
 11716*                dataset   ('ELTRLR')
 11717*                from      (activity-trailers)
 11718*                ridfld    (trlr-key)
 11719*             end-exec
 11720     MOVE LENGTH OF
 11721      activity-trailers
 11722       TO DFHEIV11
 11723     MOVE 'ELTRLR' TO DFHEIV1
 11724*    MOVE '&$ L                  ''   #00010520' TO DFHEIV0
 11725     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11726     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11727     MOVE X'2020233030303130353230' TO DFHEIV0(25:11)
 11728     CALL 'kxdfhei1' USING DFHEIV0,
 11729           DFHEIV1,
 11730           activity-trailers,
 11731           DFHEIV11,
 11732           trlr-key,
 11733           DFHEIV99,
 11734           DFHEIV99
 11735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11736              perform varying s1 from +1 by +1 until
 11737                 ws-error-no (s1) = spaces
 11738                 move ws-error-no (s1)
 11739                                 to emi-error
 11740                 PERFORM 9900-ERROR-FORMAT
 11741                                 THRU 9900-EXIT
 11742              end-perform
 11743           end-if
 11744     end-evaluate
 11745
 11746     .
 11747 2130-exit.
 11748     exit.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 216
* EL131.cbl
 11749 2140-update-elcrtt.
 11750     move ' '                    to crtt-switch
 11751     MOVE CERT-KEY               TO ELCRTT-KEY
 11752     MOVE 'B'                    TO CTRLR-REC-TYPE
 11753
 11754* EXEC CICS READ
 11755*       UPDATE
 11756*       DATASET   ('ELCRTT')
 11757*       RIDFLD    (ELCRTT-KEY)
 11758*       INTO      (CERTIFICATE-TRAILERS)
 11759*       RESP      (WS-RESPONSE)
 11760*    END-EXEC
 11761     MOVE LENGTH OF
 11762      CERTIFICATE-TRAILERS
 11763       TO DFHEIV11
 11764     MOVE 'ELCRTT' TO DFHEIV1
 11765*    MOVE '&"IL       EU         (  N#00010542' TO DFHEIV0
 11766     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11767     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11768     MOVE X'204E233030303130353432' TO DFHEIV0(25:11)
 11769     CALL 'kxdfhei1' USING DFHEIV0,
 11770           DFHEIV1,
 11771           CERTIFICATE-TRAILERS,
 11772           DFHEIV11,
 11773           ELCRTT-KEY,
 11774           DFHEIV99,
 11775           DFHEIV99,
 11776           DFHEIV99
 11777     MOVE EIBRESP  TO WS-RESPONSE
 11778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11779     IF WS-RESP-NORMAL
 11780        perform varying s1 from +1 by +1 until
 11781           (s1 > +24)
 11782           or (cs-claim-no (s1) = cl-claim-no)
 11783        end-perform
 11784        if (s1 < +25)
 11785           if (benperl <> zeros)
 11786              and (cs-benefit-period (s1) not = benperi)
 11787              move benperi       to cs-benefit-period (s1)
 11788              set crtt-update    to true
 11789          end-if
 11790          if (instypel <> zeros)
 11791             and (instypei not = cs-insured-type (s1))
 11792             move instypei      to cs-insured-type (s1)
 11793             set crtt-update    to true
 11794          end-if
 11795          move cs-claim-type (s1) to ws-claim-type
 11796          move cs-benefit-period (s1) to ws-ben-per
 11797        end-if
 11798        if crtt-update
 11799           perform 2150-accum    thru 2150-exit
 11800
 11801* EXEC CICS REWRITE
 11802*             DATASET   ('ELCRTT')
 11803*             FROM      (CERTIFICATE-TRAILERS)
 11804*          END-EXEC
 11805     MOVE LENGTH OF
 11806      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 217
* EL131.cbl
 11807       TO DFHEIV11
 11808     MOVE 'ELCRTT' TO DFHEIV1
 11809*    MOVE '&& L                  %   #00010570' TO DFHEIV0
 11810     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11811     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11812     MOVE X'2020233030303130353730' TO DFHEIV0(25:11)
 11813     CALL 'kxdfhei1' USING DFHEIV0,
 11814           DFHEIV1,
 11815           CERTIFICATE-TRAILERS,
 11816           DFHEIV11,
 11817           DFHEIV99
 11818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11819        else
 11820
 11821* exec cics unlock
 11822*             dataset   ('ELCRTT')
 11823*          end-exec
 11824     MOVE 'ELCRTT' TO DFHEIV1
 11825*    MOVE '&*                    #   #00010575' TO DFHEIV0
 11826     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11827     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11828     MOVE X'2020233030303130353735' TO DFHEIV0(25:11)
 11829     CALL 'kxdfhei1' USING DFHEIV0,
 11830           DFHEIV1,
 11831           DFHEIV99
 11832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11833        end-if
 11834     end-if
 11835     .
 11836 2140-exit.
 11837     exit.
 11838 2150-accum.
 11839     if not erpdef-found
 11840        perform 3997-get-erpdef  thru 3997-exit
 11841     end-if
 11842     if (erpdef-found)
 11843        and (ws-max-moben not = zeros)
 11844        and (ws-max-moben < cm-ah-benefit-amt)
 11845        continue
 11846     else
 11847        move cm-ah-benefit-amt   to ws-max-moben
 11848     end-if
 11849     move cm-ah-orig-term        to ws-max-bens
 11850     if cl-critical-period not = zeros and spaces
 11851        move cl-critical-period  to ws-max-bens
 11852     end-if
 11853     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11854     perform varying s2 from +1 by +1 until
 11855        (s2 > +24)
 11856        or (cs-claim-no (s2) = spaces)
 11857        if (cs-benefit-period (s2) = ws-ben-per)
 11858           and (cs-claim-type (s2) = ws-claim-type)
 11859           and (cs-insured-type (s2) = cl-insured-type)
 11860*          compute ws-tot-days-paid =
 11861*             ws-tot-days-paid + cs-days-paid (s2)
 11862           compute ws-tot-amt-paid =
 11863              ws-tot-amt-paid + cs-total-paid (s2)
 11864        end-if
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 218
* EL131.cbl
 11865     end-perform
 11866     if s2 < +25
 11867        compute ws-pd-bens rounded =
 11868           ws-tot-amt-paid / ws-max-moben
 11869        compute cs-remaining-bens (s1) =
 11870           ws-max-bens - ws-pd-bens
 11871        if cs-remaining-bens (s1) < zeros
 11872           move zeros            to cs-remaining-bens (s1)
 11873        end-if
 11874     end-if
 11875     .
 11876 2150-exit.
 11877     exit.
 11878 2200-MOVE-CERT.
 11879     IF CRTLNMEI GREATER THAN LOW-VALUES
 11880         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11881
 11882     IF CRTFNMEI GREATER THAN LOW-VALUES
 11883         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11884         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11885
 11886     IF CRTINITI GREATER THAN LOW-VALUES
 11887         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11888
 11889     IF CM-INSURED-INITIALS = SPACES
 11890         MOVE '**'               TO CM-INSURED-INITIALS.
 11891
 11892     IF ISSAGEI GREATER THAN LOW-VALUES
 11893         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11894
 11895     IF JNTFNMEI GREATER THAN LOW-VALUES
 11896         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11897
 11898     IF JNTLNMEI GREATER THAN LOW-VALUES
 11899         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11900
 11901     IF JNTINITI GREATER THAN LOW-VALUES
 11902         MOVE JNTINITI           TO CM-JT-INITIAL.
 11903
 11904     IF JNTAGEI GREATER THAN LOW-VALUES
 11905         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11906
 11907     IF ADDONDTI GREATER THAN LOW-VALUES
 11908        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11909
 11910     IF LCVCDI GREATER THAN LOW-VALUES
 11911        IF LCVCDI = SPACES OR ZEROS
 11912           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11913        ELSE
 11914           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11915
 11916     IF LCVOTRMI GREATER THAN LOW-VALUES
 11917         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11918
 11919     IF LCVRATEL GREATER THAN +0
 11920         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11921
 11922     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 219
* EL131.cbl
 11923         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11924
 11925     IF LCVFORMI GREATER THAN LOW-VALUES
 11926         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11927
 11928     IF LCVCNDTI = LOW-VALUES
 11929        GO TO 2210-SET-STATUS.
 11930
 11931     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11932        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11933        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11934        GO TO 2210-SET-STATUS.
 11935
 11936     IF CM-LF-CURRENT-STATUS = '7'
 11937        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11938        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11939        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11940                                    CM-LF-DEATH-DT
 11941        GO TO 2210-SET-STATUS.
 11942
 11943     IF CM-LF-CURRENT-STATUS = '8'
 11944        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11945        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11946                                    CM-LF-CANCEL-DT.
 11947
 11948 2210-SET-STATUS.
 11949
 11950     IF CM-LF-CURRENT-STATUS = SPACES
 11951         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11952
 11953     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11954         MOVE '6'                TO DC-OPTION-CODE
 11955         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11956         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11957         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11958         IF NO-CONVERSION-ERROR
 11959             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11960         ELSE
 11961             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11962     ELSE
 11963         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11964
 11965 2215-PROCESS-AH-SIDE.
 11966
 11967     IF ACVCDI GREATER THAN LOW-VALUES
 11968        IF ACVCDI = SPACES OR ZEROS
 11969           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11970        ELSE
 11971           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11972
 11973     IF ACVOTRMI GREATER THAN LOW-VALUES
 11974         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11975
 11976     IF ACVRATEL GREATER THAN +0
 11977         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11978
 11979     IF ACVBENEL GREATER THAN +0
 11980         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 220
* EL131.cbl
 11981                                    PI-PAYMENT-AMT.
 11982
 11983     IF ACVFORMI GREATER THAN LOW-VALUES
 11984         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11985
 11986     IF ACVCNDTI = LOW-VALUES
 11987        GO TO 2220-SET-STATUS.
 11988
 11989     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11990        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11991        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11992        GO TO 2220-SET-STATUS.
 11993
 11994     IF CM-AH-CURRENT-STATUS = '6'
 11995        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11996                                 TO CM-AH-CURRENT-STATUS
 11997        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11998        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11999                                    CM-AH-SETTLEMENT-DT
 12000        GO TO 2220-SET-STATUS.
 12001
 12002     IF CM-AH-CURRENT-STATUS = '8'
 12003        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12004        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12005                                    CM-AH-CANCEL-DT.
 12006
 12007 2220-SET-STATUS.
 12008     IF CM-AH-CURRENT-STATUS = SPACES
 12009         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12010
 12011     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12012         MOVE '6'                TO DC-OPTION-CODE
 12013         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12014         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12015         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12016         IF NO-CONVERSION-ERROR
 12017             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12018         ELSE
 12019             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12020     ELSE
 12021         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12022
 12023 2225-FINISH-CERT.
 12024     IF APRL GREATER THAN +0
 12025         MOVE HOLD-APR           TO CM-LOAN-APR.
 12026
 12027     IF PMTFREQI GREATER THAN LOW-VALUES
 12028         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12029
 12030     IF INDGRPI GREATER THAN LOW-VALUES
 12031         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12032
 12033     IF LOANNOI GREATER THAN LOW-VALUES
 12034        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12035
 12036     IF LOANBALL GREATER THAN +0
 12037        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12038
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 221
* EL131.cbl
 12039     IF PREMTYPI GREATER THAN LOW-VALUES
 12040         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12041
 12042     IF REINCDI GREATER THAN LOW-VALUES
 12043         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12044                                    WS-REIN-1
 12045                                    WS-REIN-2
 12046                                    WS-REIN-3
 12047         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12048
 12049     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12050
 12051     MOVE ZEROS                  TO CM-LOAN-TERM
 12052                                    CM-LIFE-COMM-PCT
 12053                                    CM-AH-COMM-PCT.
 12054
 12055*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12056*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12057*         PI-NO-PMTS = ZEROS
 12058*          IF LOANBALL GREATER THAN +0          OR
 12059*             ACVBENEL GREATER THAN +0          OR
 12060*             APRL     GREATER THAN +0          OR
 12061*             LCVRATEL GREATER THAN +0          OR
 12062*             ACVRATEL GREATER THAN +0
 12063*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12064
 12065 2200-EXIT.
 12066     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 222
* EL131.cbl
 12068 2300-UPDATE-TRLR.
 12069     MOVE ZERO                   TO TRLR-SEQ-NO.
 12070
 12071* EXEC CICS READ UPDATE
 12072*         DATASET  (TRLR-FILE-ID)
 12073*         RIDFLD   (TRLR-KEY)
 12074*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12075*    END-EXEC.
 12076*    MOVE '&"S        EU         (   #00010815' TO DFHEIV0
 12077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12078     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12079     MOVE X'2020233030303130383135' TO DFHEIV0(25:11)
 12080     CALL 'kxdfhei1' USING DFHEIV0,
 12081           TRLR-FILE-ID,
 12082           DFHEIV20,
 12083           DFHEIV99,
 12084           TRLR-KEY,
 12085           DFHEIV99,
 12086           DFHEIV99,
 12087           DFHEIV99
 12088     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12089         DFHEIV20
 12090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12091
 12092
 12093     MOVE ZERO                   TO COUNT-2.
 12094
 12095     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12096         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12097
 12098     IF NOT UPDATE-MADE
 12099         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12100
 12101
 12102* EXEC CICS REWRITE
 12103*         DATASET  (TRLR-FILE-ID)
 12104*         FROM     (ACTIVITY-TRAILERS)
 12105*    END-EXEC.
 12106     MOVE LENGTH OF
 12107      ACTIVITY-TRAILERS
 12108       TO DFHEIV11
 12109*    MOVE '&& L                  %   #00010829' TO DFHEIV0
 12110     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12111     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12112     MOVE X'2020233030303130383239' TO DFHEIV0(25:11)
 12113     CALL 'kxdfhei1' USING DFHEIV0,
 12114           TRLR-FILE-ID,
 12115           ACTIVITY-TRAILERS,
 12116           DFHEIV11,
 12117           DFHEIV99
 12118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12119
 12120
 12121 2300-EXIT.
 12122     EXIT.
 12123
 12124 2310-INS-STATUS.
 12125     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 223
* EL131.cbl
 12126     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12127         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12128         MOVE 'Y'                TO TRLR-SWITCH.
 12129
 12130 2310-EXIT.
 12131     EXIT.
 12132
 12133 2320-SHIFT-STATUS.
 12134     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12135        MOVE 6                   TO COUNT-2
 12136        GO TO 2320-EXIT.
 12137
 12138     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12139     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12140     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12141     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12142     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12143     MOVE 6       TO COUNT-2.
 12144     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12145
 12146 2320-EXIT.
 12147     EXIT.
 12148
 12149 2330-ADD-UPDATE.
 12150
 12151     IF COUNT-2 GREATER THAN 1
 12152        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12153        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12154           GO TO 2330-EXIT.
 12155
 12156     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12157                                   AT-RESERVES-LAST-MAINT-DT
 12158
 12159     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12160     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12161     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12162     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12163
 12164 2330-EXIT.
 12165     EXIT.
 12166
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 224
* EL131.cbl
 12168 2400-UPDATE-TRLR.
 12169
 12170* EXEC CICS HANDLE CONDITION
 12171*         NOTFND    (2400-TRLR-NOTFND)
 12172*         ENDFILE   (2410-EXIT)
 12173*    END-EXEC.
 12174*    MOVE '"$I''                  ! 5 #00010882' TO DFHEIV0
 12175     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12177     MOVE X'3520233030303130383832' TO DFHEIV0(25:11)
 12178     CALL 'kxdfhei1' USING DFHEIV0
 12179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12180
 12181
 12182
 12183* EXEC CICS STARTBR
 12184*        DATASET (TRLR-FILE-ID)
 12185*        RIDFLD  (TRLR-KEY)
 12186*    END-EXEC.
 12187     MOVE 0
 12188       TO DFHEIV11
 12189*    MOVE '&,         G          &   #00010887' TO DFHEIV0
 12190     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12191     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12192     MOVE X'2020233030303130383837' TO DFHEIV0(25:11)
 12193     CALL 'kxdfhei1' USING DFHEIV0,
 12194           TRLR-FILE-ID,
 12195           TRLR-KEY,
 12196           DFHEIV99,
 12197           DFHEIV11,
 12198           DFHEIV99
 12199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12200
 12201
 12202
 12203* EXEC CICS GETMAIN
 12204*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12205*         LENGTH    (TRLR-LENGTH)
 12206*         INITIMG   (GETMAIN-SPACE)
 12207*    END-EXEC.
 12208*    MOVE ',"IL                  $   #00010892' TO DFHEIV0
 12209     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12211     MOVE X'2020233030303130383932' TO DFHEIV0(25:11)
 12212     CALL 'kxdfhei1' USING DFHEIV0,
 12213           DFHEIV20,
 12214           TRLR-LENGTH,
 12215           GETMAIN-SPACE
 12216     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12217         DFHEIV20
 12218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12219
 12220
 12221     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12222
 12223
 12224* EXEC CICS ENDBR
 12225*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 225
* EL131.cbl
 12226*    END-EXEC.
 12227     MOVE 0
 12228       TO DFHEIV11
 12229*    MOVE '&2                    $   #00010900' TO DFHEIV0
 12230     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12231     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12232     MOVE X'2020233030303130393030' TO DFHEIV0(25:11)
 12233     CALL 'kxdfhei1' USING DFHEIV0,
 12234           TRLR-FILE-ID,
 12235           DFHEIV11,
 12236           DFHEIV99
 12237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12238
 12239
 12240     GO TO 2400-EXIT.
 12241
 12242 2400-TRLR-NOTFND.
 12243     MOVE ER-0205                TO EMI-ERROR.
 12244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12245     MOVE 'X'                    TO ERROR-SWITCH.
 12246
 12247 2400-EXIT.
 12248     EXIT.
 12249
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 226
* EL131.cbl
 12251 2410-CHANGE-TRLR.
 12252
 12253* EXEC CICS READNEXT
 12254*        DATASET (TRLR-FILE-ID)
 12255*        RIDFLD  (TRLR-KEY)
 12256*        INTO    (ACTIVITY-TRAILERS)
 12257*    END-EXEC.
 12258     MOVE LENGTH OF
 12259      ACTIVITY-TRAILERS
 12260       TO DFHEIV12
 12261     MOVE 0
 12262       TO DFHEIV11
 12263*    MOVE '&.IL                  )   #00010916' TO DFHEIV0
 12264     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12265     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12266     MOVE X'2020233030303130393136' TO DFHEIV0(25:11)
 12267     CALL 'kxdfhei1' USING DFHEIV0,
 12268           TRLR-FILE-ID,
 12269           ACTIVITY-TRAILERS,
 12270           DFHEIV12,
 12271           TRLR-KEY,
 12272           DFHEIV99,
 12273           DFHEIV11,
 12274           DFHEIV99,
 12275           DFHEIV99
 12276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12277
 12278
 12279     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12280        GO TO 2410-CHANGE-TRLR.
 12281
 12282     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12283                                    CHECK-KEY.
 12284
 12285     IF CHECK-KEY NOT = MSTR-KEY
 12286         GO TO 2410-EXIT.
 12287
 12288
 12289* EXEC CICS ENDBR
 12290*        DATASET (TRLR-FILE-ID)
 12291*    END-EXEC.
 12292     MOVE 0
 12293       TO DFHEIV11
 12294*    MOVE '&2                    $   #00010931' TO DFHEIV0
 12295     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12296     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12297     MOVE X'2020233030303130393331' TO DFHEIV0(25:11)
 12298     CALL 'kxdfhei1' USING DFHEIV0,
 12299           TRLR-FILE-ID,
 12300           DFHEIV11,
 12301           DFHEIV99
 12302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12303
 12304
 12305
 12306* EXEC CICS READ UPDATE
 12307*        DATASET (TRLR-FILE-ID)
 12308*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 227
* EL131.cbl
 12309*        INTO    (ACTIVITY-TRAILERS)
 12310*    END-EXEC.
 12311     MOVE LENGTH OF
 12312      ACTIVITY-TRAILERS
 12313       TO DFHEIV11
 12314*    MOVE '&"IL       EU         (   #00010935' TO DFHEIV0
 12315     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12316     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12317     MOVE X'2020233030303130393335' TO DFHEIV0(25:11)
 12318     CALL 'kxdfhei1' USING DFHEIV0,
 12319           TRLR-FILE-ID,
 12320           ACTIVITY-TRAILERS,
 12321           DFHEIV11,
 12322           TRLR-KEY,
 12323           DFHEIV99,
 12324           DFHEIV99,
 12325           DFHEIV99
 12326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12327
 12328
 12329
 12330* EXEC CICS DELETE
 12331*        DATASET (TRLR-FILE-ID)
 12332*    END-EXEC.
 12333*    MOVE '&(                    &   #00010941' TO DFHEIV0
 12334     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12335     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12336     MOVE X'2020233030303130393431' TO DFHEIV0(25:11)
 12337     CALL 'kxdfhei1' USING DFHEIV0,
 12338           TRLR-FILE-ID,
 12339           DFHEIV99,
 12340           DFHEIV99,
 12341           DFHEIV99,
 12342           DFHEIV99
 12343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12344
 12345
 12346     IF AT-SEQUENCE-NO = ZERO AND
 12347        TRLR-UPDATE-REQUIRED
 12348         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12349
 12350     IF CERTI GREATER THAN LOW-VALUES
 12351        MOVE CERTI               TO AT-CERT-PRIME.
 12352
 12353     IF SUFXI GREATER THAN LOW-VALUES
 12354        MOVE SUFXI               TO AT-CERT-SFX.
 12355
 12356     IF CERTCARI GREATER THAN LOW-VALUES
 12357        MOVE CERTCARI            TO AT-CARRIER.
 12358
 12359     IF PAYMENT-TR
 12360        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12361           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12362              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12363
 12364     IF CORRESPONDENCE-TR
 12365        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12366           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 228
* EL131.cbl
 12367
 12368
 12369* EXEC CICS WRITE
 12370*         DATASET  (TRLR-FILE-ID)
 12371*         RIDFLD   (AT-CONTROL-PRIMARY)
 12372*         FROM     (ACTIVITY-TRAILERS)
 12373*    END-EXEC.
 12374     MOVE LENGTH OF
 12375      ACTIVITY-TRAILERS
 12376       TO DFHEIV11
 12377*    MOVE '&$ L                  ''   #00010967' TO DFHEIV0
 12378     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12379     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12380     MOVE X'2020233030303130393637' TO DFHEIV0(25:11)
 12381     CALL 'kxdfhei1' USING DFHEIV0,
 12382           TRLR-FILE-ID,
 12383           ACTIVITY-TRAILERS,
 12384           DFHEIV11,
 12385           AT-CONTROL-PRIMARY,
 12386           DFHEIV99,
 12387           DFHEIV99
 12388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12389
 12390
 12391
 12392* EXEC CICS STARTBR
 12393*         DATASET  (TRLR-FILE-ID)
 12394*         RIDFLD   (TRLR-KEY)
 12395*    END-EXEC.
 12396     MOVE 0
 12397       TO DFHEIV11
 12398*    MOVE '&,         G          &   #00010973' TO DFHEIV0
 12399     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12400     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12401     MOVE X'2020233030303130393733' TO DFHEIV0(25:11)
 12402     CALL 'kxdfhei1' USING DFHEIV0,
 12403           TRLR-FILE-ID,
 12404           TRLR-KEY,
 12405           DFHEIV99,
 12406           DFHEIV11,
 12407           DFHEIV99
 12408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12409
 12410
 12411     GO TO 2410-CHANGE-TRLR.
 12412
 12413 2410-EXIT.
 12414     EXIT.
 12415
 12416 2420-UPDATE-TRLR.
 12417     MOVE ZERO TO COUNT-2.
 12418     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12419         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12420
 12421     IF NOT UPDATE-MADE
 12422         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12423
 12424 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 229
* EL131.cbl
 12425     EXIT.
 12426
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 230
* EL131.cbl
 12428 2425-UPDATE-NINETY-TRLR.
 12429
 12430     MOVE +90                    TO TRLR-SEQ-NO.
 12431
 12432
 12433* EXEC CICS HANDLE CONDITION
 12434*         NOTFND    (2425-NINETY-NOTFND)
 12435*         ENDFILE   (2425-NINETY-NOTFND)
 12436*    END-EXEC.
 12437*    MOVE '"$I''                  ! 6 #00010999' TO DFHEIV0
 12438     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12440     MOVE X'3620233030303130393939' TO DFHEIV0(25:11)
 12441     CALL 'kxdfhei1' USING DFHEIV0
 12442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12443
 12444
 12445
 12446* EXEC CICS READ UPDATE
 12447*        DATASET (TRLR-FILE-ID)
 12448*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12449*        RIDFLD  (TRLR-KEY)
 12450*    END-EXEC.
 12451*    MOVE '&"S        EU         (   #00011004' TO DFHEIV0
 12452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12453     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12454     MOVE X'2020233030303131303034' TO DFHEIV0(25:11)
 12455     CALL 'kxdfhei1' USING DFHEIV0,
 12456           TRLR-FILE-ID,
 12457           DFHEIV20,
 12458           DFHEIV99,
 12459           TRLR-KEY,
 12460           DFHEIV99,
 12461           DFHEIV99,
 12462           DFHEIV99
 12463     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12464         DFHEIV20
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467     if (diagi > low-values)
 12468        and (diagi not = at-info-line-1)
 12469        and (cl-total-paid-amt > zeros)
 12470        move cl-cert-eff-dt      to dc-bin-date-1
 12471        move cl-paid-thru-dt     to dc-bin-date-2
 12472        move '1'                 to dc-option-code
 12473        perform 9800-convert-date
 12474                                 thru 9800-exit
 12475        if no-conversion-error
 12476           and dc-elapsed-months < +24
 12477           and (not emi-bypass-forcables)
 12478           move er-1581          to emi-error
 12479           perform 9900-error-format
 12480                                thru 9900-exit
 12481           move -1              to diagl
 12482           go to 8110-send-data
 12483        end-if
 12484     end-if
 12485     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 231
* EL131.cbl
 12486     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12487     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12488
 12489     IF DIAGI GREATER THAN LOW-VALUES
 12490         MOVE DIAGI             TO AT-INFO-LINE-1
 12491     END-IF.
 12492
 12493     IF ICD1I GREATER THAN LOW-VALUES
 12494         MOVE ICD1I             TO AT-ICD-CODE-1
 12495     END-IF.
 12496
 12497     IF ICD2I GREATER THAN LOW-VALUES
 12498         MOVE ICD2I             TO AT-ICD-CODE-2
 12499     END-IF.
 12500
 12501
 12502* EXEC CICS REWRITE
 12503*        DATASET (TRLR-FILE-ID)
 12504*        FROM    (ACTIVITY-TRAILERS)
 12505*    END-EXEC.
 12506     MOVE LENGTH OF
 12507      ACTIVITY-TRAILERS
 12508       TO DFHEIV11
 12509*    MOVE '&& L                  %   #00011043' TO DFHEIV0
 12510     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12511     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12512     MOVE X'2020233030303131303433' TO DFHEIV0(25:11)
 12513     CALL 'kxdfhei1' USING DFHEIV0,
 12514           TRLR-FILE-ID,
 12515           ACTIVITY-TRAILERS,
 12516           DFHEIV11,
 12517           DFHEIV99
 12518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12519
 12520
 12521     IF DIAGI GREATER THAN LOW-VALUES
 12522       AND DIAGI NOT = WS-DIAGNOSIS
 12523         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12524         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12525         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12526
 12527     IF ICD1I GREATER THAN LOW-VALUES
 12528       AND ICD1I NOT = WS-ICD-CODE-1
 12529         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12530         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12531         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12532     END-IF.
 12533
 12534     IF ICD2I GREATER THAN LOW-VALUES
 12535       AND ICD2I NOT = WS-ICD-CODE-2
 12536         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12537         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12538         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12539     END-IF.
 12540
 12541     GO TO 2425-EXIT.
 12542
 12543 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 232
* EL131.cbl
 12544
 12545
 12546* EXEC CICS GETMAIN
 12547*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12548*         LENGTH    (TRLR-LENGTH)
 12549*         INITIMG   (GETMAIN-SPACE)
 12550*    END-EXEC.
 12551*    MOVE ',"IL                  $   #00011072' TO DFHEIV0
 12552     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12554     MOVE X'2020233030303131303732' TO DFHEIV0(25:11)
 12555     CALL 'kxdfhei1' USING DFHEIV0,
 12556           DFHEIV20,
 12557           TRLR-LENGTH,
 12558           GETMAIN-SPACE
 12559     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12560         DFHEIV20
 12561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12562
 12563
 12564     MOVE +90                  TO TRLR-SEQ-NO.
 12565     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12566
 12567     MOVE 'AT'                 TO AT-RECORD-ID
 12568     MOVE '6'                  TO AT-TRAILER-TYPE
 12569     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12570                                  AT-GEN-INFO-LAST-MAINT-DT
 12571     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12572                                  AT-GEN-INFO-LAST-UPDATED-BY
 12573     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12574     MOVE DIAGI                TO AT-INFO-LINE-1.
 12575     MOVE ICD1I                TO AT-ICD-CODE-1.
 12576     MOVE ICD2I                TO AT-ICD-CODE-2.
 12577
 12578
 12579* EXEC CICS WRITE
 12580*        DATASET (TRLR-FILE-ID)
 12581*        FROM    (ACTIVITY-TRAILERS)
 12582*        RIDFLD  (TRLR-KEY)
 12583*    END-EXEC.
 12584     MOVE LENGTH OF
 12585      ACTIVITY-TRAILERS
 12586       TO DFHEIV11
 12587*    MOVE '&$ L                  ''   #00011092' TO DFHEIV0
 12588     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12589     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12590     MOVE X'2020233030303131303932' TO DFHEIV0(25:11)
 12591     CALL 'kxdfhei1' USING DFHEIV0,
 12592           TRLR-FILE-ID,
 12593           ACTIVITY-TRAILERS,
 12594           DFHEIV11,
 12595           TRLR-KEY,
 12596           DFHEIV99,
 12597           DFHEIV99
 12598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12599
 12600
 12601 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 233
* EL131.cbl
 12602     EXIT.
 12603
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 234
* EL131.cbl
 12605 2430-UPDATE-ACTQ.
 12606
 12607* EXEC CICS HANDLE CONDITION
 12608*         NOTFND    (2430-EXIT)
 12609*         ENDFILE   (2440-EXIT)
 12610*    END-EXEC.
 12611*    MOVE '"$I''                  ! 7 #00011103' TO DFHEIV0
 12612     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12613     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12614     MOVE X'3720233030303131313033' TO DFHEIV0(25:11)
 12615     CALL 'kxdfhei1' USING DFHEIV0
 12616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12617
 12618
 12619
 12620* EXEC CICS STARTBR
 12621*         DATASET  (ACTQ-FILE-ID)
 12622*         RIDFLD   (ACTQ-KEY)
 12623*    END-EXEC.
 12624     MOVE 0
 12625       TO DFHEIV11
 12626*    MOVE '&,         G          &   #00011108' TO DFHEIV0
 12627     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12628     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12629     MOVE X'2020233030303131313038' TO DFHEIV0(25:11)
 12630     CALL 'kxdfhei1' USING DFHEIV0,
 12631           ACTQ-FILE-ID,
 12632           ACTQ-KEY,
 12633           DFHEIV99,
 12634           DFHEIV11,
 12635           DFHEIV99
 12636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12637
 12638
 12639
 12640* EXEC CICS GETMAIN
 12641*         SET      (ADDRESS OF ACTIVITY-QUE)
 12642*         LENGTH   (ACTQ-LENGTH)
 12643*         INITIMG  (GETMAIN-SPACE)
 12644*    END-EXEC.
 12645*    MOVE ',"IL                  $   #00011113' TO DFHEIV0
 12646     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12647     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12648     MOVE X'2020233030303131313133' TO DFHEIV0(25:11)
 12649     CALL 'kxdfhei1' USING DFHEIV0,
 12650           DFHEIV20,
 12651           ACTQ-LENGTH,
 12652           GETMAIN-SPACE
 12653     SET ADDRESS OF ACTIVITY-QUE TO
 12654         DFHEIV20
 12655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12656
 12657
 12658     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12659
 12660 2430-EXIT.
 12661     EXIT.
 12662
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 235
* EL131.cbl
 12663 2440-CHANGE-ACTQ.
 12664
 12665
 12666* EXEC CICS READNEXT
 12667*         DATASET  (ACTQ-FILE-ID)
 12668*         RIDFLD   (ACTQ-KEY)
 12669*         INTO     (ACTIVITY-QUE)
 12670*    END-EXEC.
 12671     MOVE LENGTH OF
 12672      ACTIVITY-QUE
 12673       TO DFHEIV12
 12674     MOVE 0
 12675       TO DFHEIV11
 12676*    MOVE '&.IL                  )   #00011126' TO DFHEIV0
 12677     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12678     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12679     MOVE X'2020233030303131313236' TO DFHEIV0(25:11)
 12680     CALL 'kxdfhei1' USING DFHEIV0,
 12681           ACTQ-FILE-ID,
 12682           ACTIVITY-QUE,
 12683           DFHEIV12,
 12684           ACTQ-KEY,
 12685           DFHEIV99,
 12686           DFHEIV11,
 12687           DFHEIV99,
 12688           DFHEIV99
 12689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12690
 12691
 12692
 12693* EXEC CICS ENDBR
 12694*         DATASET (ACTQ-FILE-ID)
 12695*    END-EXEC.
 12696     MOVE 0
 12697       TO DFHEIV11
 12698*    MOVE '&2                    $   #00011132' TO DFHEIV0
 12699     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12700     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12701     MOVE X'2020233030303131313332' TO DFHEIV0(25:11)
 12702     CALL 'kxdfhei1' USING DFHEIV0,
 12703           ACTQ-FILE-ID,
 12704           DFHEIV11,
 12705           DFHEIV99
 12706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12707
 12708
 12709     IF ACTQ-KEY NOT = MSTR-KEY
 12710         GO TO 2440-EXIT.
 12711
 12712
 12713* EXEC CICS READ UPDATE
 12714*         DATASET  (ACTQ-FILE-ID)
 12715*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12716*         SET      (ADDRESS OF ACTIVITY-QUE)
 12717*    END-EXEC.
 12718*    MOVE '&"S        EU         (   #00011139' TO DFHEIV0
 12719     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12720     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 236
* EL131.cbl
 12721     MOVE X'2020233030303131313339' TO DFHEIV0(25:11)
 12722     CALL 'kxdfhei1' USING DFHEIV0,
 12723           ACTQ-FILE-ID,
 12724           DFHEIV20,
 12725           DFHEIV99,
 12726           AQ-CONTROL-PRIMARY,
 12727           DFHEIV99,
 12728           DFHEIV99,
 12729           DFHEIV99
 12730     SET ADDRESS OF ACTIVITY-QUE TO
 12731         DFHEIV20
 12732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12733
 12734
 12735     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12736
 12737
 12738* EXEC CICS DELETE
 12739*         DATASET (ACTQ-FILE-ID)
 12740*    END-EXEC.
 12741*    MOVE '&(                    &   #00011147' TO DFHEIV0
 12742     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12743     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12744     MOVE X'2020233030303131313437' TO DFHEIV0(25:11)
 12745     CALL 'kxdfhei1' USING DFHEIV0,
 12746           ACTQ-FILE-ID,
 12747           DFHEIV99,
 12748           DFHEIV99,
 12749           DFHEIV99,
 12750           DFHEIV99
 12751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12752
 12753
 12754     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12755     IF CERTI GREATER THAN LOW-VALUES
 12756        MOVE CERTI               TO AQ-CERT-PRIME.
 12757     IF SUFXI GREATER THAN LOW-VALUES
 12758        MOVE SUFXI               TO AQ-CERT-SFX.
 12759     IF CERTCARI GREATER THAN LOW-VALUES
 12760        MOVE CERTCARI            TO AQ-CARRIER.
 12761
 12762
 12763* EXEC CICS HANDLE CONDITION
 12764*         DUPREC   (2440-EXIT)
 12765*    END-EXEC.
 12766*    MOVE '"$%                   ! 8 #00011159' TO DFHEIV0
 12767     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12769     MOVE X'3820233030303131313539' TO DFHEIV0(25:11)
 12770     CALL 'kxdfhei1' USING DFHEIV0
 12771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12772
 12773
 12774
 12775* EXEC CICS WRITE
 12776*         DATASET  (ACTQ-FILE-ID)
 12777*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12778*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 237
* EL131.cbl
 12779*    END-EXEC.
 12780     MOVE LENGTH OF
 12781      ACTIVITY-QUE
 12782       TO DFHEIV11
 12783*    MOVE '&$ L                  ''   #00011163' TO DFHEIV0
 12784     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12785     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12786     MOVE X'2020233030303131313633' TO DFHEIV0(25:11)
 12787     CALL 'kxdfhei1' USING DFHEIV0,
 12788           ACTQ-FILE-ID,
 12789           ACTIVITY-QUE,
 12790           DFHEIV11,
 12791           AQ-CONTROL-PRIMARY,
 12792           DFHEIV99,
 12793           DFHEIV99
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12795
 12796
 12797 2440-EXIT.
 12798     EXIT.
 12799
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 238
* EL131.cbl
 12801 2460-UPDATE-CHECKQ.
 12802
 12803* EXEC CICS HANDLE CONDITION
 12804*         NOTFND   (2460-EXIT)
 12805*    END-EXEC.
 12806*    MOVE '"$I                   ! 9 #00011174' TO DFHEIV0
 12807     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12809     MOVE X'3920233030303131313734' TO DFHEIV0(25:11)
 12810     CALL 'kxdfhei1' USING DFHEIV0
 12811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12812
 12813
 12814     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12815     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12816     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12817
 12818
 12819* EXEC CICS READ UPDATE
 12820*         DATASET   (CHKQ-FILE-ID)
 12821*         RIDFLD    (CHKQ-KEY)
 12822*         SET       (ADDRESS OF CHECK-QUE)
 12823*    END-EXEC.
 12824*    MOVE '&"S        EU         (   #00011182' TO DFHEIV0
 12825     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12827     MOVE X'2020233030303131313832' TO DFHEIV0(25:11)
 12828     CALL 'kxdfhei1' USING DFHEIV0,
 12829           CHKQ-FILE-ID,
 12830           DFHEIV20,
 12831           DFHEIV99,
 12832           CHKQ-KEY,
 12833           DFHEIV99,
 12834           DFHEIV99,
 12835           DFHEIV99
 12836     SET ADDRESS OF CHECK-QUE TO
 12837         DFHEIV20
 12838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12839
 12840
 12841     IF CERTI GREATER THAN LOW-VALUES
 12842        MOVE CERTI               TO CQ-CERT-PRIME.
 12843     IF SUFXI GREATER THAN LOW-VALUES
 12844        MOVE SUFXI               TO CQ-CERT-SFX.
 12845     IF CERTCARI GREATER THAN LOW-VALUES
 12846        MOVE CERTCARI            TO CQ-CARRIER.
 12847
 12848
 12849* EXEC CICS REWRITE
 12850*         DATASET  (CHKQ-FILE-ID)
 12851*         FROM     (CHECK-QUE)
 12852*    END-EXEC.
 12853     MOVE LENGTH OF
 12854      CHECK-QUE
 12855       TO DFHEIV11
 12856*    MOVE '&& L                  %   #00011195' TO DFHEIV0
 12857     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12858     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 239
* EL131.cbl
 12859     MOVE X'2020233030303131313935' TO DFHEIV0(25:11)
 12860     CALL 'kxdfhei1' USING DFHEIV0,
 12861           CHKQ-FILE-ID,
 12862           CHECK-QUE,
 12863           DFHEIV11,
 12864           DFHEIV99
 12865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12866
 12867
 12868 2460-EXIT.
 12869     EXIT.
 12870
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 240
* EL131.cbl
 12872 2475-UPDATE-LETTER.
 12873
 12874* EXEC CICS HANDLE CONDITION
 12875*         NOTFND   (2475-EXIT)
 12876*    END-EXEC.
 12877*    MOVE '"$I                   ! : #00011205' TO DFHEIV0
 12878     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12880     MOVE X'3A20233030303131323035' TO DFHEIV0(25:11)
 12881     CALL 'kxdfhei1' USING DFHEIV0
 12882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12883
 12884
 12885     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12886     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12887     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12888     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12889
 12890
 12891* EXEC CICS READ UPDATE
 12892*         DATASET   (ARCH-FILE-ID)
 12893*         RIDFLD    (ARCH-KEY)
 12894*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12895*    END-EXEC.
 12896*    MOVE '&"S        EU         (   #00011214' TO DFHEIV0
 12897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12898     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12899     MOVE X'2020233030303131323134' TO DFHEIV0(25:11)
 12900     CALL 'kxdfhei1' USING DFHEIV0,
 12901           ARCH-FILE-ID,
 12902           DFHEIV20,
 12903           DFHEIV99,
 12904           ARCH-KEY,
 12905           DFHEIV99,
 12906           DFHEIV99,
 12907           DFHEIV99
 12908     SET ADDRESS OF LETTER-ARCHIVE TO
 12909         DFHEIV20
 12910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12911
 12912
 12913* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12914* TO THIS MASTER-KEY INFORMATION.
 12915
 12916     IF LA-CARRIER  = CARRIER-CODE AND
 12917        LA-CLAIM-NO = CLAIM-NO     AND
 12918        LA-CERT-NO  = CERT-NO
 12919        NEXT SENTENCE
 12920     ELSE
 12921        GO TO 2475-UNLOCK.
 12922
 12923     IF CERTI GREATER THAN LOW-VALUES
 12924        MOVE CERTI               TO LA-CERT-PRIME.
 12925     IF SUFXI GREATER THAN LOW-VALUES
 12926        MOVE SUFXI               TO LA-CERT-SFX.
 12927     IF CERTCARI GREATER THAN LOW-VALUES
 12928        MOVE CERTCARI            TO LA-CARRIER.
 12929
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 241
* EL131.cbl
 12930
 12931* EXEC CICS REWRITE
 12932*         DATASET  (ARCH-FILE-ID)
 12933*         FROM     (LETTER-ARCHIVE)
 12934*    END-EXEC.
 12935     MOVE LENGTH OF
 12936      LETTER-ARCHIVE
 12937       TO DFHEIV11
 12938*    MOVE '&& L                  %   #00011237' TO DFHEIV0
 12939     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12940     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12941     MOVE X'2020233030303131323337' TO DFHEIV0(25:11)
 12942     CALL 'kxdfhei1' USING DFHEIV0,
 12943           ARCH-FILE-ID,
 12944           LETTER-ARCHIVE,
 12945           DFHEIV11,
 12946           DFHEIV99
 12947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12948
 12949
 12950     GO TO 2475-EXIT.
 12951
 12952 2475-UNLOCK.
 12953
 12954* EXEC CICS UNLOCK
 12955*         DATASET  (ARCH-FILE-ID)
 12956*    END-EXEC.
 12957*    MOVE '&*                    #   #00011245' TO DFHEIV0
 12958     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12959     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12960     MOVE X'2020233030303131323435' TO DFHEIV0(25:11)
 12961     CALL 'kxdfhei1' USING DFHEIV0,
 12962           ARCH-FILE-ID,
 12963           DFHEIV99
 12964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12965
 12966
 12967 2475-EXIT.
 12968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 242
* EL131.cbl
 12970 2600-CREATE-MAINT-NOTE.
 12971     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12972     MOVE '1'                    TO CNTL-REC-TYPE.
 12973     MOVE SPACES                 TO CNTL-PROC-ID.
 12974     MOVE ZERO                   TO CNTL-SEQ-NO.
 12975
 12976
 12977* EXEC CICS READ
 12978*         SET        (ADDRESS OF CONTROL-FILE)
 12979*         DATASET    ('ELCNTL')
 12980*         RIDFLD     (CNTL-KEY)
 12981*    END-EXEC.
 12982     MOVE 'ELCNTL' TO DFHEIV1
 12983*    MOVE '&"S        E          (   #00011258' TO DFHEIV0
 12984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303131323538' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           DFHEIV1,
 12989           DFHEIV20,
 12990           DFHEIV99,
 12991           CNTL-KEY,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     SET ADDRESS OF CONTROL-FILE TO
 12996         DFHEIV20
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12998
 12999
 13000     IF CO-NO-USE-AUDIT-CHANGES
 13001         GO TO 2600-EXIT.
 13002
 13003     IF PROCL GREATER ZERO
 13004     IF PROCI NOT = LOW-VALUES
 13005     IF PROCI NOT = CL-PROCESSOR-ID
 13006         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13007         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13008         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13009
 13010     IF SEXL GREATER ZERO
 13011     IF SEXI NOT = LOW-VALUES
 13012     IF SEXI NOT = CL-INSURED-SEX-CD
 13013         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13014         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13015         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13016
 13017     IF BIRTHL GREATER ZERO
 13018     IF HOLD-BIRTH NOT = LOW-VALUES
 13019     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13020         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13021         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13022         MOVE SPACES               TO DC-OPTION-CODE
 13023         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13024         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13025         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13026
 13027     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 243
* EL131.cbl
 13028     IF SOCIALI NOT = LOW-VALUES
 13029     IF SOCIALI NOT = CL-SOC-SEC-NO
 13030         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13031         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13032         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13033
 13034     IF OCCL GREATER ZERO
 13035     IF OCCI NOT = LOW-VALUES
 13036     IF OCCI NOT = CL-INSURED-OCC-CD
 13037         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13038         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13039         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13040
 13041     IF BENEL GREATER ZERO
 13042     IF BENEI NOT = LOW-VALUES
 13043     IF BENEI NOT = CL-BENEFICIARY
 13044         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13045         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13046         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13047
 13048     IF PREMTYPL GREATER ZERO
 13049     IF PREMTYPI NOT = LOW-VALUES
 13050     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13051         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13052         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13053         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13054
 13055*    IF CAUSEL GREATER ZERO
 13056*    IF CAUSEI NOT = LOW-VALUES
 13057*    IF CAUSEI NOT = CL-CAUSE-CD
 13058*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13059*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13060*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13061
 13062*    IF ENDL GREATER ZERO
 13063*    IF HOLD-END NOT = LOW-VALUES
 13064*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13065*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13066*        MOVE CL-EST-END-OF-DISAB-DT
 13067*                                  TO DC-BIN-DATE-1
 13068*        MOVE SPACES               TO DC-OPTION-CODE
 13069*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13070*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13071*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13072
 13073     IF PDTHRUL GREATER ZERO
 13074     IF HOLD-PDTHRU NOT = LOW-VALUES
 13075     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13076         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13077         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13078         MOVE SPACES               TO DC-OPTION-CODE
 13079         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13080         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13081         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13082
 13083     IF PDAMTL GREATER ZERO
 13084     IF HOLD-PDAMT NOT = ZEROS
 13085     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 244
* EL131.cbl
 13086         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13087         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13088         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13089         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13090
 13091     IF NODAYSL GREATER ZERO
 13092     IF HOLD-NODAYS NOT = ZEROS
 13093     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13094         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13095         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13096         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13097         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13098
 13099     IF NOPMTSL GREATER ZERO
 13100     IF HOLD-NOPMTS NOT = ZEROS
 13101     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13102         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13103         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13104         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13105         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13106
 13107     IF FORMTYPL GREATER ZERO
 13108     IF FORMTYPI NOT = LOW-VALUES
 13109     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13110         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13111         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13112         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13113
 13114     IF REPL GREATER ZERO
 13115     IF HOLD-REPORTED NOT = LOW-VALUES
 13116     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13117         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13118         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13119         MOVE SPACES               TO DC-OPTION-CODE
 13120         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13121         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13122         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13123
 13124     IF ADDONDTL GREATER ZERO
 13125     IF HOLD-ADDON NOT = LOW-VALUES
 13126     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13127         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13128         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13129         MOVE SPACES               TO DC-OPTION-CODE
 13130         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13131         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13132         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13133
 13134     IF PRICDL GREATER ZERO
 13135     IF PRICDI NOT = LOW-VALUES
 13136     IF PRICDI NOT = CL-PRIORITY-CD
 13137         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13138         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13139         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13140
 13141     IF FILETOL GREATER ZERO
 13142     IF FILETOI NOT = LOW-VALUES
 13143     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 245
* EL131.cbl
 13144         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13145         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13146         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13147
 13148     IF SUPVL GREATER ZERO
 13149     IF SUPVI NOT = LOW-VALUES
 13150     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13151         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13152         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13153         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13154*    IF (CRITPTL > ZERO)
 13155*       AND (CRITPTI NOT = LOW-VALUES)
 13156*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13157*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13158*       MOVE CL-CRIT-PER-RECURRENT
 13159*                                TO SPLIT-INFO-OLD
 13160*       PERFORM 2650-WRITE-MAINT-NOTE
 13161*                                THRU 2650-EXIT
 13162*    END-IF
 13163
 13164*    IF (RTWMOSL > ZERO)
 13165*       AND (RTWMOSI NOT = LOW-VALUES)
 13166*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13167*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13168*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13169*       PERFORM 2650-WRITE-MAINT-NOTE
 13170*                                THRU 2650-EXIT
 13171*    END-IF
 13172     IF MLNAMEL GREATER ZERO
 13173     IF MLNAMEI NOT = LOW-VALUES
 13174     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13175         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13176         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13177         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13178
 13179     IF MFNAMEL GREATER ZERO
 13180     IF MFNAMEI NOT = LOW-VALUES
 13181     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13182         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13183         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13184         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13185
 13186     IF MMINITL GREATER ZERO
 13187     IF MMINITI NOT = LOW-VALUES
 13188     IF MMINITI NOT = CL-INSURED-MID-INIT
 13189         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13190         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13191         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13192
 13193     IF CERTEFFL GREATER ZERO
 13194     IF HOLD-EFF NOT = LOW-VALUES
 13195     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13196         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13197         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13198         MOVE SPACES               TO DC-OPTION-CODE
 13199         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13200         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13201         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 246
* EL131.cbl
 13202
 13203     IF CERTACTL GREATER ZERO
 13204     IF CERTACTI NOT = LOW-VALUES
 13205     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13206         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13207         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13208         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13209
 13210     IF CERTSTL GREATER ZERO
 13211     IF CERTSTI NOT = LOW-VALUES
 13212     IF CERTSTI NOT = CL-CERT-STATE
 13213         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13214         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13215         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13216
 13217     IF CERTCARL GREATER ZERO
 13218     IF CERTCARI NOT = LOW-VALUES
 13219     IF CERTCARI NOT = CL-CERT-CARRIER
 13220         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13221         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13222         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13223
 13224     IF CERTGRPL GREATER ZERO
 13225     IF CERTGRPI NOT = LOW-VALUES
 13226     IF CERTGRPI NOT = CL-CERT-GROUPING
 13227         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13228         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13229         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13230
 13231     IF CERTL GREATER ZERO OR
 13232        SUFXL GREATER ZERO
 13233     IF (CERTI NOT = LOW-VALUES AND
 13234                     CL-CERT-PRIME)
 13235                OR
 13236        (SUFXI NOT = LOW-VALUES AND
 13237                     CL-CERT-SFX)
 13238         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13239         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13240         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13241     IF incl > zeros
 13242        IF (HOLD-INCUR NOT = LOW-VALUES)
 13243           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13244           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13245           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13246           MOVE SPACES           TO DC-OPTION-CODE
 13247           PERFORM 9800-CONVERT-DATE
 13248                                 THRU 9800-EXIT
 13249           MOVE DC-GREG-DATE-1-EDIT
 13250                                 TO SPLIT-INFO-OLD
 13251           PERFORM 2650-WRITE-MAINT-NOTE
 13252                                 THRU 2650-EXIT
 13253        END-IF
 13254     END-IF
 13255     .
 13256 2600-EXIT.
 13257      EXIT.
 13258
 13259 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 247
* EL131.cbl
 13260
 13261* EXEC CICS GETMAIN
 13262*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13263*         LENGTH   (TRLR-LENGTH)
 13264*         INITIMG  (GETMAIN-SPACE)
 13265*    END-EXEC.
 13266*    MOVE ',"IL                  $   #00011524' TO DFHEIV0
 13267     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13269     MOVE X'2020233030303131353234' TO DFHEIV0(25:11)
 13270     CALL 'kxdfhei1' USING DFHEIV0,
 13271           DFHEIV20,
 13272           TRLR-LENGTH,
 13273           GETMAIN-SPACE
 13274     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13275         DFHEIV20
 13276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13277
 13278
 13279
 13280* EXEC CICS HANDLE CONDITION
 13281*         DUPREC   (2650-EXIT)
 13282*    END-EXEC.
 13283*    MOVE '"$%                   ! ; #00011530' TO DFHEIV0
 13284     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13286     MOVE X'3B20233030303131353330' TO DFHEIV0(25:11)
 13287     CALL 'kxdfhei1' USING DFHEIV0
 13288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13289
 13290
 13291     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13292
 13293     IF CERTL GREATER ZERO
 13294         MOVE CERTI          TO CL-CERT-PRIME.
 13295
 13296     IF SUFXL GREATER ZERO
 13297         MOVE SUFXI          TO CL-CERT-SFX.
 13298
 13299     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13300
 13301     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13302     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13303
 13304     MOVE 'AT'               TO AT-RECORD-ID.
 13305
 13306     MOVE '6'                TO AT-TRAILER-TYPE.
 13307     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13308                                AT-GEN-INFO-LAST-MAINT-DT.
 13309     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13310                                AT-GEN-INFO-LAST-UPDATED-BY.
 13311     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13312     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13313     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13314
 13315
 13316* EXEC CICS WRITE
 13317*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 248
* EL131.cbl
 13318*         RIDFLD   (AT-CONTROL-PRIMARY)
 13319*         FROM     (ACTIVITY-TRAILERS)
 13320*    END-EXEC.
 13321     MOVE LENGTH OF
 13322      ACTIVITY-TRAILERS
 13323       TO DFHEIV11
 13324*    MOVE '&$ L                  ''   #00011558' TO DFHEIV0
 13325     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13327     MOVE X'2020233030303131353538' TO DFHEIV0(25:11)
 13328     CALL 'kxdfhei1' USING DFHEIV0,
 13329           TRLR-FILE-ID,
 13330           ACTIVITY-TRAILERS,
 13331           DFHEIV11,
 13332           AT-CONTROL-PRIMARY,
 13333           DFHEIV99,
 13334           DFHEIV99
 13335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13336
 13337
 13338 2650-EXIT.
 13339      EXIT.
 13340
 13341 2800-CHECK-AUTO-PAY.
 13342
 13343     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13344     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13345     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13346     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13347     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13348
 13349
 13350* EXEC CICS HANDLE CONDITION
 13351*         NOTFND    (2800-EXIT)
 13352*         ENDFILE   (2800-EXIT)
 13353*    END-EXEC.
 13354*    MOVE '"$I''                  ! < #00011575' TO DFHEIV0
 13355     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13357     MOVE X'3C20233030303131353735' TO DFHEIV0(25:11)
 13358     CALL 'kxdfhei1' USING DFHEIV0
 13359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13360
 13361
 13362
 13363* EXEC CICS READ
 13364*        DATASET (TRLR-FILE-ID)
 13365*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13366*        RIDFLD  (TRLR-KEY)
 13367*    END-EXEC.
 13368*    MOVE '&"S        E          (   #00011580' TO DFHEIV0
 13369     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13371     MOVE X'2020233030303131353830' TO DFHEIV0(25:11)
 13372     CALL 'kxdfhei1' USING DFHEIV0,
 13373           TRLR-FILE-ID,
 13374           DFHEIV20,
 13375           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 249
* EL131.cbl
 13376           TRLR-KEY,
 13377           DFHEIV99,
 13378           DFHEIV99,
 13379           DFHEIV99
 13380     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13381         DFHEIV20
 13382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13383
 13384
 13385     IF BENEFICIARY-PAID-AUTO
 13386         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13387     END-IF.
 13388
 13389 2800-EXIT.
 13390      EXIT.
 13391
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 250
* EL131.cbl
 13393 3000-DELETE-CLAIM.
 13394     IF  NOT MODIFY-CAP
 13395         MOVE ER-0070            TO EMI-ERROR
 13396         MOVE -1                 TO MAINTL
 13397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13398         GO TO 8110-SEND-DATA.
 13399
 13400
 13401* EXEC CICS READ
 13402*         SET      (ADDRESS OF CLAIM-MASTER)
 13403*         DATASET  (CLMS-FILE-ID)
 13404*         RIDFLD   (MSTR-KEY)
 13405*    END-EXEC.
 13406*    MOVE '&"S        E          (   #00011601' TO DFHEIV0
 13407     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13409     MOVE X'2020233030303131363031' TO DFHEIV0(25:11)
 13410     CALL 'kxdfhei1' USING DFHEIV0,
 13411           CLMS-FILE-ID,
 13412           DFHEIV20,
 13413           DFHEIV99,
 13414           MSTR-KEY,
 13415           DFHEIV99,
 13416           DFHEIV99,
 13417           DFHEIV99
 13418     SET ADDRESS OF CLAIM-MASTER TO
 13419         DFHEIV20
 13420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13421
 13422
 13423     IF CL-1ST-TRL-AVAIL
 13424         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13425     ELSE
 13426        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13427        MOVE 0                   TO TRLR-SEQ-NO
 13428
 13429* EXEC CICS STARTBR
 13430*            DATASET (TRLR-FILE-ID)
 13431*            RIDFLD  (TRLR-KEY)
 13432*        END-EXEC
 13433     MOVE 0
 13434       TO DFHEIV11
 13435*    MOVE '&,         G          &   #00011612' TO DFHEIV0
 13436     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13438     MOVE X'2020233030303131363132' TO DFHEIV0(25:11)
 13439     CALL 'kxdfhei1' USING DFHEIV0,
 13440           TRLR-FILE-ID,
 13441           TRLR-KEY,
 13442           DFHEIV99,
 13443           DFHEIV11,
 13444           DFHEIV99
 13445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13446         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13447
 13448* EXEC CICS ENDBR
 13449*            DATASET (TRLR-FILE-ID)
 13450*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 251
* EL131.cbl
 13451     MOVE 0
 13452       TO DFHEIV11
 13453*    MOVE '&2                    $   #00011617' TO DFHEIV0
 13454     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13455     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13456     MOVE X'2020233030303131363137' TO DFHEIV0(25:11)
 13457     CALL 'kxdfhei1' USING DFHEIV0,
 13458           TRLR-FILE-ID,
 13459           DFHEIV11,
 13460           DFHEIV99
 13461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13462        IF SCREEN-ERROR
 13463            MOVE ER-0208         TO EMI-ERROR
 13464            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13465            MOVE -1              TO MAINTL
 13466            GO TO 8110-SEND-DATA
 13467        ELSE
 13468            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13469
 13470     IF SCREEN-ERROR
 13471         MOVE -1                 TO MAINTL
 13472         GO TO 8110-SEND-DATA.
 13473
 13474     MOVE -1                     TO ONE-OR-MIN1.
 13475     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13476
 13477     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13478         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13479                                    WS-SAVE-CLAIM-KEY
 13480         MOVE +1                 TO ONE-OR-MIN1
 13481         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13482
 13483     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13484
 13485     MOVE LOW-VALUES             TO EL131AO.
 13486     MOVE ER-0000                TO EMI-ERROR.
 13487     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13488     MOVE 'X'                    TO PI-RETURN-CD-1.
 13489     MOVE -1                     TO MAINTL.
 13490     GO TO 8100-SEND-MAP.
 13491
 13492 3010-DEL-MSTR-TRLR.
 13493
 13494* EXEC CICS READ UPDATE
 13495*         SET       (ADDRESS OF CLAIM-MASTER)
 13496*         DATASET   (CLMS-FILE-ID)
 13497*         RIDFLD    (MSTR-KEY)
 13498*    END-EXEC.
 13499*    MOVE '&"S        EU         (   #00011651' TO DFHEIV0
 13500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13501     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13502     MOVE X'2020233030303131363531' TO DFHEIV0(25:11)
 13503     CALL 'kxdfhei1' USING DFHEIV0,
 13504           CLMS-FILE-ID,
 13505           DFHEIV20,
 13506           DFHEIV99,
 13507           MSTR-KEY,
 13508           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 252
* EL131.cbl
 13509           DFHEIV99,
 13510           DFHEIV99
 13511     SET ADDRESS OF CLAIM-MASTER TO
 13512         DFHEIV20
 13513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13514
 13515
 13516     if (cl-priority-cd = '8')
 13517        and (pi-processor-id not = 'PEMA' and 'JMS '
 13518             AND 'AMWA')
 13519        MOVE ER-8003             TO EMI-ERROR
 13520        PERFORM 9900-ERROR-FORMAT
 13521                                 THRU 9900-EXIT
 13522        MOVE -1                  TO MAINTL
 13523        GO TO 8110-SEND-DATA
 13524     end-if
 13525
 13526     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13527     MOVE ZERO                   TO TRLR-SEQ-NO.
 13528
 13529
 13530* EXEC CICS HANDLE CONDITION
 13531*         NOTFND    (3010-DEL-ACTQ)
 13532*         ENDFILE   (3040-EXIT)
 13533*    END-EXEC.
 13534*    MOVE '"$I''                  ! = #00011670' TO DFHEIV0
 13535     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13537     MOVE X'3D20233030303131363730' TO DFHEIV0(25:11)
 13538     CALL 'kxdfhei1' USING DFHEIV0
 13539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13540
 13541
 13542     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13543
 13544 3010-DEL-ACTQ.
 13545
 13546
 13547* EXEC CICS HANDLE CONDITION
 13548*         NOTFND    (3010-NO-ACTIVITY)
 13549*         ENDFILE   (3050-EXIT)
 13550*    END-EXEC.
 13551*    MOVE '"$I''                  ! > #00011679' TO DFHEIV0
 13552     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13554     MOVE X'3E20233030303131363739' TO DFHEIV0(25:11)
 13555     CALL 'kxdfhei1' USING DFHEIV0
 13556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13557
 13558
 13559
 13560* EXEC CICS STARTBR
 13561*         DATASET  (ACTQ-FILE-ID)
 13562*         RIDFLD   (ACTQ-KEY)
 13563*    END-EXEC.
 13564     MOVE 0
 13565       TO DFHEIV11
 13566*    MOVE '&,         G          &   #00011684' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 253
* EL131.cbl
 13567     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13568     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13569     MOVE X'2020233030303131363834' TO DFHEIV0(25:11)
 13570     CALL 'kxdfhei1' USING DFHEIV0,
 13571           ACTQ-FILE-ID,
 13572           ACTQ-KEY,
 13573           DFHEIV99,
 13574           DFHEIV11,
 13575           DFHEIV99
 13576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13577
 13578
 13579
 13580* EXEC CICS GETMAIN
 13581*         SET      (ADDRESS OF ACTIVITY-QUE)
 13582*         LENGTH   (ACTQ-LENGTH)
 13583*         INITIMG  (GETMAIN-SPACE)
 13584*    END-EXEC.
 13585*    MOVE ',"IL                  $   #00011689' TO DFHEIV0
 13586     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13587     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13588     MOVE X'2020233030303131363839' TO DFHEIV0(25:11)
 13589     CALL 'kxdfhei1' USING DFHEIV0,
 13590           DFHEIV20,
 13591           ACTQ-LENGTH,
 13592           GETMAIN-SPACE
 13593     SET ADDRESS OF ACTIVITY-QUE TO
 13594         DFHEIV20
 13595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13596
 13597
 13598     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13599
 13600
 13601* EXEC CICS ENDBR
 13602*         DATASET (ACTQ-FILE-ID)
 13603*    END-EXEC.
 13604     MOVE 0
 13605       TO DFHEIV11
 13606*    MOVE '&2                    $   #00011697' TO DFHEIV0
 13607     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13608     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13609     MOVE X'2020233030303131363937' TO DFHEIV0(25:11)
 13610     CALL 'kxdfhei1' USING DFHEIV0,
 13611           ACTQ-FILE-ID,
 13612           DFHEIV11,
 13613           DFHEIV99
 13614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13615
 13616
 13617 3010-NO-ACTIVITY.
 13618
 13619
 13620* EXEC CICS HANDLE CONDITION
 13621*        NOTFND   (3010-CERT-NOT-FOUND)
 13622*    END-EXEC.
 13623*    MOVE '"$I                   ! ? #00011703' TO DFHEIV0
 13624     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 254
* EL131.cbl
 13625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13626     MOVE X'3F20233030303131373033' TO DFHEIV0(25:11)
 13627     CALL 'kxdfhei1' USING DFHEIV0
 13628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13629
 13630
 13631     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13632     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13633     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13634     MOVE CL-CERT-STATE          TO CERT-STATE.
 13635     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13636     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13637     MOVE CL-CERT-NO             TO CERT-CERT.
 13638
 13639
 13640* EXEC CICS READ
 13641*        DATASET   (CERT-FILE-ID)
 13642*        RIDFLD    (CERT-KEY)
 13643*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13644*    END-EXEC.
 13645*    MOVE '&"S        E          (   #00011715' TO DFHEIV0
 13646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13648     MOVE X'2020233030303131373135' TO DFHEIV0(25:11)
 13649     CALL 'kxdfhei1' USING DFHEIV0,
 13650           CERT-FILE-ID,
 13651           DFHEIV20,
 13652           DFHEIV99,
 13653           CERT-KEY,
 13654           DFHEIV99,
 13655           DFHEIV99,
 13656           DFHEIV99
 13657     SET ADDRESS OF CERTIFICATE-MASTER TO
 13658         DFHEIV20
 13659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13660
 13661
 13662     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13663       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13664         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13665     ELSE
 13666         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13667
 13668 3010-UPDATE-CERT-TRLR.
 13669
 13670     MOVE CERT-KEY               TO ELCRTT-KEY
 13671     MOVE 'B'                    TO CTRLR-REC-TYPE
 13672
 13673* EXEC CICS READ
 13674*       UPDATE
 13675*       DATASET   ('ELCRTT')
 13676*       RIDFLD    (ELCRTT-KEY)
 13677*       INTO      (CERTIFICATE-TRAILERS)
 13678*       RESP      (WS-RESPONSE)
 13679*    END-EXEC
 13680     MOVE LENGTH OF
 13681      CERTIFICATE-TRAILERS
 13682       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 255
* EL131.cbl
 13683     MOVE 'ELCRTT' TO DFHEIV1
 13684*    MOVE '&"IL       EU         (  N#00011731' TO DFHEIV0
 13685     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13686     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13687     MOVE X'204E233030303131373331' TO DFHEIV0(25:11)
 13688     CALL 'kxdfhei1' USING DFHEIV0,
 13689           DFHEIV1,
 13690           CERTIFICATE-TRAILERS,
 13691           DFHEIV11,
 13692           ELCRTT-KEY,
 13693           DFHEIV99,
 13694           DFHEIV99,
 13695           DFHEIV99
 13696     MOVE EIBRESP  TO WS-RESPONSE
 13697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13698     IF WS-RESP-NORMAL
 13699        perform varying s1 from +1 by +1 until
 13700           (s1 > +24)
 13701           or (cs-claim-no (s1) = cl-claim-no)
 13702        end-perform
 13703        if s1 < +25
 13704           move spaces           to cs-claim-no (s1)
 13705                                    cs-claim-type (s1)
 13706                                    cs-insured-type (s1)
 13707           move zeros            to cs-days-paid (s1)
 13708                                    cs-total-paid (s1)
 13709                                    cs-benefit-period (s1)
 13710           if s1 not = +24
 13711              compute s2 = s1 + +1
 13712              perform 3015-bump  thru 3015-exit
 13713           end-if
 13714
 13715* EXEC CICS REWRITE
 13716*             DATASET   ('ELCRTT')
 13717*             FROM      (CERTIFICATE-TRAILERS)
 13718*          END-EXEC
 13719     MOVE LENGTH OF
 13720      CERTIFICATE-TRAILERS
 13721       TO DFHEIV11
 13722     MOVE 'ELCRTT' TO DFHEIV1
 13723*    MOVE '&& L                  %   #00011754' TO DFHEIV0
 13724     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13725     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13726     MOVE X'2020233030303131373534' TO DFHEIV0(25:11)
 13727     CALL 'kxdfhei1' USING DFHEIV0,
 13728           DFHEIV1,
 13729           CERTIFICATE-TRAILERS,
 13730           DFHEIV11,
 13731           DFHEIV99
 13732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13733        end-if
 13734     end-if
 13735     .
 13736 3010-CERT-NOT-FOUND.
 13737
 13738
 13739* EXEC CICS DELETE
 13740*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 256
* EL131.cbl
 13741*    END-EXEC.
 13742*    MOVE '&(                    &   #00011763' TO DFHEIV0
 13743     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13744     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13745     MOVE X'2020233030303131373633' TO DFHEIV0(25:11)
 13746     CALL 'kxdfhei1' USING DFHEIV0,
 13747           CLMS-FILE-ID,
 13748           DFHEIV99,
 13749           DFHEIV99,
 13750           DFHEIV99,
 13751           DFHEIV99
 13752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13753
 13754
 13755 3010-EXIT.
 13756      EXIT.
 13757
 13758 3015-bump.
 13759     perform varying s2 from s2 by +1 until s2 > +24
 13760        move cs-mb-claim-data (s2)
 13761                                 to cs-mb-claim-data (s1)
 13762        move spaces              to cs-mb-claim-data (s2)
 13763        add +1 to s1
 13764     end-perform
 13765     .
 13766 3015-exit.
 13767     exit.
 13768 3020-UPDATE-CERT.
 13769
 13770* EXEC CICS READ UPDATE
 13771*         DATASET  (CERT-FILE-ID)
 13772*         RIDFLD   (CERT-KEY)
 13773*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13774*    END-EXEC.
 13775*    MOVE '&"S        EU         (   #00011781' TO DFHEIV0
 13776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13778     MOVE X'2020233030303131373831' TO DFHEIV0(25:11)
 13779     CALL 'kxdfhei1' USING DFHEIV0,
 13780           CERT-FILE-ID,
 13781           DFHEIV20,
 13782           DFHEIV99,
 13783           CERT-KEY,
 13784           DFHEIV99,
 13785           DFHEIV99,
 13786           DFHEIV99
 13787     SET ADDRESS OF CERTIFICATE-MASTER TO
 13788         DFHEIV20
 13789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13790
 13791
 13792     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13793
 13794
 13795* EXEC CICS HANDLE CONDITION
 13796*         DUPKEY   (3020-EXIT)
 13797*    END-EXEC.
 13798*    MOVE '"$$                   ! @ #00011789' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 257
* EL131.cbl
 13799     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13801     MOVE X'4020233030303131373839' TO DFHEIV0(25:11)
 13802     CALL 'kxdfhei1' USING DFHEIV0
 13803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13804
 13805
 13806
 13807* EXEC CICS REWRITE
 13808*         DATASET  (CERT-FILE-ID)
 13809*         FROM     (CERTIFICATE-MASTER)
 13810*    END-EXEC.
 13811     MOVE LENGTH OF
 13812      CERTIFICATE-MASTER
 13813       TO DFHEIV11
 13814*    MOVE '&& L                  %   #00011793' TO DFHEIV0
 13815     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13817     MOVE X'2020233030303131373933' TO DFHEIV0(25:11)
 13818     CALL 'kxdfhei1' USING DFHEIV0,
 13819           CERT-FILE-ID,
 13820           CERTIFICATE-MASTER,
 13821           DFHEIV11,
 13822           DFHEIV99
 13823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13824
 13825
 13826 3020-EXIT.
 13827     EXIT.
 13828
 13829 3030-DELETE-CERT.
 13830
 13831* EXEC CICS READ UPDATE
 13832*         DATASET  (CERT-FILE-ID)
 13833*         RIDFLD   (CERT-KEY)
 13834*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13835*    END-EXEC.
 13836*    MOVE '&"S        EU         (   #00011802' TO DFHEIV0
 13837     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13838     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13839     MOVE X'2020233030303131383032' TO DFHEIV0(25:11)
 13840     CALL 'kxdfhei1' USING DFHEIV0,
 13841           CERT-FILE-ID,
 13842           DFHEIV20,
 13843           DFHEIV99,
 13844           CERT-KEY,
 13845           DFHEIV99,
 13846           DFHEIV99,
 13847           DFHEIV99
 13848     SET ADDRESS OF CERTIFICATE-MASTER TO
 13849         DFHEIV20
 13850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13851
 13852
 13853
 13854* EXEC CICS DELETE
 13855*         DATASET   (CERT-FILE-ID)
 13856*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 258
* EL131.cbl
 13857*    MOVE '&(                    &   #00011808' TO DFHEIV0
 13858     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13859     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13860     MOVE X'2020233030303131383038' TO DFHEIV0(25:11)
 13861     CALL 'kxdfhei1' USING DFHEIV0,
 13862           CERT-FILE-ID,
 13863           DFHEIV99,
 13864           DFHEIV99,
 13865           DFHEIV99,
 13866           DFHEIV99
 13867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13868
 13869
 13870 3030-EXIT.
 13871     EXIT.
 13872
 13873 3040-DELETE-TRLR.
 13874
 13875* EXEC CICS READ
 13876*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13877*         DATASET  (TRLR-FILE-ID)
 13878*         RIDFLD   (TRLR-KEY)
 13879*         GTEQ
 13880*    END-EXEC.
 13881*    MOVE '&"S        G          (   #00011816' TO DFHEIV0
 13882     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13884     MOVE X'2020233030303131383136' TO DFHEIV0(25:11)
 13885     CALL 'kxdfhei1' USING DFHEIV0,
 13886           TRLR-FILE-ID,
 13887           DFHEIV20,
 13888           DFHEIV99,
 13889           TRLR-KEY,
 13890           DFHEIV99,
 13891           DFHEIV99,
 13892           DFHEIV99
 13893     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13894         DFHEIV20
 13895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13896
 13897
 13898     IF PI-COMPANY-CD = AT-COMPANY-CD
 13899        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13900        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13901           GO TO 3040-EXIT
 13902        ELSE
 13903           NEXT SENTENCE
 13904     ELSE
 13905        GO TO 3040-EXIT.
 13906
 13907
 13908* EXEC CICS DELETE
 13909*         DATASET  (TRLR-FILE-ID)
 13910*         RIDFLD   (TRLR-KEY)
 13911*    END-EXEC.
 13912*    MOVE '&(  R                 &   #00011832' TO DFHEIV0
 13913     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 259
* EL131.cbl
 13915     MOVE X'2020233030303131383332' TO DFHEIV0(25:11)
 13916     CALL 'kxdfhei1' USING DFHEIV0,
 13917           TRLR-FILE-ID,
 13918           TRLR-KEY,
 13919           DFHEIV99,
 13920           DFHEIV99,
 13921           DFHEIV99
 13922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13923
 13924
 13925     GO TO 3040-DELETE-TRLR.
 13926
 13927 3040-EXIT.
 13928     EXIT.
 13929
 13930 3050-DELETE-ACTQ.
 13931
 13932* EXEC CICS READNEXT
 13933*         DATASET  (ACTQ-FILE-ID)
 13934*         RIDFLD   (ACTQ-KEY)
 13935*         INTO     (ACTIVITY-QUE)
 13936*    END-EXEC.
 13937     MOVE LENGTH OF
 13938      ACTIVITY-QUE
 13939       TO DFHEIV12
 13940     MOVE 0
 13941       TO DFHEIV11
 13942*    MOVE '&.IL                  )   #00011843' TO DFHEIV0
 13943     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13944     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13945     MOVE X'2020233030303131383433' TO DFHEIV0(25:11)
 13946     CALL 'kxdfhei1' USING DFHEIV0,
 13947           ACTQ-FILE-ID,
 13948           ACTIVITY-QUE,
 13949           DFHEIV12,
 13950           ACTQ-KEY,
 13951           DFHEIV99,
 13952           DFHEIV11,
 13953           DFHEIV99,
 13954           DFHEIV99
 13955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13956
 13957
 13958     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13959         GO TO 3050-EXIT.
 13960
 13961
 13962* EXEC CICS ENDBR
 13963*         DATASET  (ACTQ-FILE-ID)
 13964*    END-EXEC.
 13965     MOVE 0
 13966       TO DFHEIV11
 13967*    MOVE '&2                    $   #00011852' TO DFHEIV0
 13968     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13969     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13970     MOVE X'2020233030303131383532' TO DFHEIV0(25:11)
 13971     CALL 'kxdfhei1' USING DFHEIV0,
 13972           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 260
* EL131.cbl
 13973           DFHEIV11,
 13974           DFHEIV99
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13976
 13977
 13978
 13979* EXEC CICS DELETE
 13980*         DATASET   (ACTQ-FILE-ID)
 13981*         RIDFLD    (ACTQ-KEY)
 13982*    END-EXEC.
 13983*    MOVE '&(  R                 &   #00011856' TO DFHEIV0
 13984     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13985     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13986     MOVE X'2020233030303131383536' TO DFHEIV0(25:11)
 13987     CALL 'kxdfhei1' USING DFHEIV0,
 13988           ACTQ-FILE-ID,
 13989           ACTQ-KEY,
 13990           DFHEIV99,
 13991           DFHEIV99,
 13992           DFHEIV99
 13993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13994
 13995
 13996
 13997* EXEC CICS STARTBR
 13998*         DATASET   (ACTQ-FILE-ID)
 13999*         RIDFLD    (ACTQ-KEY)
 14000*    END-EXEC.
 14001     MOVE 0
 14002       TO DFHEIV11
 14003*    MOVE '&,         G          &   #00011861' TO DFHEIV0
 14004     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14006     MOVE X'2020233030303131383631' TO DFHEIV0(25:11)
 14007     CALL 'kxdfhei1' USING DFHEIV0,
 14008           ACTQ-FILE-ID,
 14009           ACTQ-KEY,
 14010           DFHEIV99,
 14011           DFHEIV11,
 14012           DFHEIV99
 14013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14014
 14015
 14016     GO TO 3050-DELETE-ACTQ.
 14017
 14018 3050-EXIT.
 14019     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 261
* EL131.cbl
 14021 3060-READ-TRLR.
 14022
 14023* EXEC CICS HANDLE CONDITION
 14024*         NOTFND    (3060-EXIT)
 14025*         ENDFILE   (3060-EXIT)
 14026*    END-EXEC.
 14027*    MOVE '"$I''                  ! A #00011872' TO DFHEIV0
 14028     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14030     MOVE X'4120233030303131383732' TO DFHEIV0(25:11)
 14031     CALL 'kxdfhei1' USING DFHEIV0
 14032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14033
 14034
 14035 3060-LOOP.
 14036
 14037* EXEC CICS READNEXT
 14038*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14039*         DATASET  (TRLR-FILE-ID)
 14040*         RIDFLD   (TRLR-KEY)
 14041*    END-EXEC.
 14042     MOVE 0
 14043       TO DFHEIV11
 14044*    MOVE '&.S                   )   #00011878' TO DFHEIV0
 14045     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14046     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14047     MOVE X'2020233030303131383738' TO DFHEIV0(25:11)
 14048     CALL 'kxdfhei1' USING DFHEIV0,
 14049           TRLR-FILE-ID,
 14050           DFHEIV20,
 14051           DFHEIV99,
 14052           TRLR-KEY,
 14053           DFHEIV99,
 14054           DFHEIV11,
 14055           DFHEIV99,
 14056           DFHEIV99
 14057     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14058         DFHEIV20
 14059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14060
 14061
 14062     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14063         GO TO 3060-EXIT.
 14064
 14065     IF FORM-CONTROL-TR
 14066         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14067             NEXT SENTENCE
 14068         ELSE
 14069             MOVE 'X'            TO ERROR-SWITCH
 14070             GO TO 3060-EXIT
 14071     ELSE
 14072         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14073            MOVE 'X'                 TO ERROR-SWITCH
 14074            GO TO 3060-EXIT.
 14075
 14076     GO TO 3060-LOOP.
 14077
 14078 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 262
* EL131.cbl
 14079     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 263
* EL131.cbl
 14081 3997-GET-ERPDEF.
 14082
 14083     move cl-company-cd          to cert-company-code
 14084     move cl-cert-key-data       to cert-key (2:21)
 14085     move cl-cert-no             to cert-cert
 14086
 14087
 14088* EXEC CICS READ
 14089*        DATASET   (CERT-FILE-ID)
 14090*        RIDFLD    (CERT-KEY)
 14091*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14092*        resp      (ws-response)
 14093*    END-EXEC
 14094*    MOVE '&"S        E          (  N#00011909' TO DFHEIV0
 14095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14097     MOVE X'204E233030303131393039' TO DFHEIV0(25:11)
 14098     CALL 'kxdfhei1' USING DFHEIV0,
 14099           CERT-FILE-ID,
 14100           DFHEIV20,
 14101           DFHEIV99,
 14102           CERT-KEY,
 14103           DFHEIV99,
 14104           DFHEIV99,
 14105           DFHEIV99
 14106     SET ADDRESS OF CERTIFICATE-MASTER TO
 14107         DFHEIV20
 14108     MOVE EIBRESP  TO ws-response
 14109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14110
 14111     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14112                                    WS-ERPDEF-SW
 14113     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14114                                    WS-CRIT-PER-RTW-MOS
 14115
 14116     if cm-clp-state = spaces or low-values or zeros
 14117        move cm-state            to cm-clp-state
 14118     end-if
 14119     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14120     MOVE CM-clp-state           TO ERPDEF-STATE
 14121     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14122     evaluate true
 14123        when (cl-claim-type = 'L' or 'P')
 14124           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14125             and 'CU')
 14126           move 'L'              to erpdef-ben-type
 14127           move cm-lf-benefit-cd to erpdef-ben-code
 14128        when (cl-claim-type not = 'L' and 'P')
 14129           and (cm-ah-benefit-cd not = '00' and '  ')
 14130           move 'A'              to erpdef-ben-type
 14131           move cm-ah-benefit-cd to erpdef-ben-code
 14132        when (cl-claim-type not = 'L' and 'P')
 14133           and (cm-ah-benefit-cd = '00' or '  ')
 14134           move 'L'              to erpdef-ben-type
 14135           move cm-lf-benefit-cd to erpdef-ben-code
 14136        when (cl-claim-type = 'L' or 'P')
 14137           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14138           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 264
* EL131.cbl
 14139           move cm-ah-benefit-cd to erpdef-ben-code
 14140        when other
 14141           move 'A'              to erpdef-ben-type
 14142           move cm-ah-benefit-cd to erpdef-ben-code
 14143     end-evaluate
 14144
 14145*    if (cl-claim-type = 'L' or 'P')
 14146*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14147*          and 'CU')
 14148*       move 'L'                 to erpdef-ben-type
 14149*       move cm-lf-benefit-cd    to erpdef-ben-code
 14150*    else
 14151*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14152*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14153*    end-if
 14154     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14155     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14156
 14157
 14158* EXEC CICS STARTBR
 14159*        DATASET  ('ERPDEF')
 14160*        RIDFLD   (ERPDEF-KEY)
 14161*        GTEQ
 14162*        RESP     (WS-RESPONSE)
 14163*    END-EXEC
 14164     MOVE 'ERPDEF' TO DFHEIV1
 14165     MOVE 0
 14166       TO DFHEIV11
 14167*    MOVE '&,         G          &  N#00011962' TO DFHEIV0
 14168     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14169     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14170     MOVE X'204E233030303131393632' TO DFHEIV0(25:11)
 14171     CALL 'kxdfhei1' USING DFHEIV0,
 14172           DFHEIV1,
 14173           ERPDEF-KEY,
 14174           DFHEIV99,
 14175           DFHEIV11,
 14176           DFHEIV99
 14177     MOVE EIBRESP  TO WS-RESPONSE
 14178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14179
 14180     IF WS-RESP-NORMAL
 14181
 14182* EXEC CICS READNEXT
 14183*          DATASET  ('ERPDEF')
 14184*          INTO     (PRODUCT-MASTER)
 14185*          RIDFLD   (ERPDEF-KEY)
 14186*          RESP     (WS-RESPONSE)
 14187*       END-EXEC
 14188     MOVE LENGTH OF
 14189      PRODUCT-MASTER
 14190       TO DFHEIV12
 14191     MOVE 'ERPDEF' TO DFHEIV1
 14192     MOVE 0
 14193       TO DFHEIV11
 14194*    MOVE '&.IL                  )  N#00011970' TO DFHEIV0
 14195     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14196     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 265
* EL131.cbl
 14197     MOVE X'204E233030303131393730' TO DFHEIV0(25:11)
 14198     CALL 'kxdfhei1' USING DFHEIV0,
 14199           DFHEIV1,
 14200           PRODUCT-MASTER,
 14201           DFHEIV12,
 14202           ERPDEF-KEY,
 14203           DFHEIV99,
 14204           DFHEIV11,
 14205           DFHEIV99,
 14206           DFHEIV99
 14207     MOVE EIBRESP  TO WS-RESPONSE
 14208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14209        IF WS-RESP-NORMAL
 14210           IF (ERPDEF-KEY-SAVE (1:16) =
 14211              PD-CONTROL-PRIMARY (1:16))
 14212              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14213              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14214                 (A1 > +8)
 14215                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14216              END-PERFORM
 14217              IF A1 < +9
 14218                 SET ERPDEF-FOUND TO TRUE
 14219                 MOVE PD-CRIT-PERIOD (A1)
 14220                              TO WS-CRITICAL-PERIOD
 14221                 MOVE PD-REC-CRIT-PERIOD (A1)
 14222                              TO WS-CRIT-PER-RECURRENT
 14223                 IF PD-RTW-MOS (A1) NUMERIC
 14224                    MOVE PD-RTW-MOS (A1)
 14225                              TO WS-CRIT-PER-RTW-MOS
 14226                 ELSE
 14227                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14228                 END-IF
 14229                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14230                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14231                                 TO WS-EXCL-PERIOD
 14232                 END-IF
 14233                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14234                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14235                                 TO WS-COV-ENDS
 14236                 END-IF
 14237                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14238                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14239                                 TO WS-ACC-PERIOD
 14240                 END-IF
 14241                 if pd-max-extension (a1) numeric
 14242                    move pd-max-extension (a1)
 14243                                 to ws-max-extension
 14244                 end-if
 14245                 if pd-max-amt (a1) numeric
 14246                    move pd-max-amt (a1)
 14247                                 to ws-max-moben
 14248                 end-if
 14249              END-IF
 14250           END-IF
 14251        END-IF
 14252     END-IF
 14253
 14254     .
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 266
* EL131.cbl
 14255 3997-EXIT.
 14256     EXIT.
 14257 4000-FORCE-ERRORS.
 14258     IF PI-RETURN-CD-1 = 'X'
 14259         MOVE ER-0311            TO EMI-ERROR
 14260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14261         MOVE -1                 TO MAINTL
 14262         GO TO 8110-SEND-DATA.
 14263
 14264     IF NOT FORCE-CAP
 14265         MOVE ER-0416            TO EMI-ERROR
 14266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14267         MOVE -1                 TO MAINTL
 14268         GO TO 8110-SEND-DATA.
 14269
 14270     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14271     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14272     IF EMI-FATAL-CTR GREATER THAN ZERO
 14273         GO TO 4000-FATAL-ERRORS.
 14274
 14275     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14276
 14277     IF EMI-FATAL-CTR GREATER THAN ZERO
 14278         GO TO 4000-FATAL-ERRORS.
 14279
 14280     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14281
 14282     IF EMI-FATAL-CTR GREATER THAN ZERO
 14283         GO TO 4000-FATAL-ERRORS.
 14284
 14285     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14286     MOVE AL-UANOF               TO CERTA.
 14287     MOVE ER-0000 TO EMI-ERROR.
 14288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14289
 14290 4000-FATAL-ERRORS.
 14291     MOVE -1                     TO MAINTL.
 14292     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 267
* EL131.cbl
 14294
 14295 4100-SAVE-CHANGES.
 14296     IF MAINTL > 0
 14297         MOVE MAINTI  TO WS-SAVE-MAINTI
 14298         MOVE MAINTL  TO WS-SAVE-MAINTL
 14299     END-IF
 14300     IF STATUSL > 0
 14301         MOVE STATUSI  TO WS-SAVE-STATUSI
 14302         MOVE STATUSL  TO WS-SAVE-STATUSL
 14303     END-IF
 14304     IF REPL > 0
 14305         MOVE REPI  TO WS-SAVE-REPI
 14306         MOVE REPL  TO WS-SAVE-REPL
 14307     END-IF
 14308*    IF CAUSEL > 0
 14309*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14310*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14311*    END-IF
 14312*    IF ENDL > 0
 14313*        MOVE ENDI  TO WS-SAVE-ENDI
 14314*        MOVE ENDL  TO WS-SAVE-ENDL
 14315*    END-IF
 14316     IF DIAGL > 0
 14317         MOVE DIAGI  TO WS-SAVE-DIAGI
 14318         MOVE DIAGL  TO WS-SAVE-DIAGL
 14319     END-IF
 14320     IF ICD1L > 0
 14321         MOVE ICD1I  TO WS-SAVE-ICD1I
 14322         MOVE ICD1L  TO WS-SAVE-ICD1L
 14323     END-IF
 14324     IF ICD2L > 0
 14325         MOVE ICD2I  TO WS-SAVE-ICD2I
 14326         MOVE ICD2L  TO WS-SAVE-ICD2L
 14327     END-IF
 14328     IF BENEL > 0
 14329         MOVE BENEI  TO WS-SAVE-BENEI
 14330         MOVE BENEL  TO WS-SAVE-BENEL
 14331     END-IF
 14332     IF BIRTHL > 0
 14333         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14334         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14335     END-IF
 14336     IF SOCIALL > 0
 14337         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14338         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14339     END-IF
 14340     IF SEXL > 0
 14341         MOVE SEXI  TO WS-SAVE-SEXI
 14342         MOVE SEXL  TO WS-SAVE-SEXL
 14343     END-IF
 14344     IF MLNAMEL > 0
 14345         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14346         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14347     END-IF
 14348     IF MFNAMEL > 0
 14349         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14350         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14351     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 268
* EL131.cbl
 14352     IF MMINITL > 0
 14353         MOVE MMINITI  TO WS-SAVE-MMINITI
 14354         MOVE MMINITL  TO WS-SAVE-MMINITL
 14355     END-IF
 14356     IF LOANNOL > 0
 14357         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14358         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14359     END-IF
 14360     IF LOANBALL > 0
 14361         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14362         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14363     END-IF
 14364     IF PROCL > 0
 14365         MOVE PROCI  TO WS-SAVE-PROCI
 14366         MOVE PROCL  TO WS-SAVE-PROCL
 14367     END-IF
 14368     IF SUPVL > 0
 14369         MOVE SUPVI  TO WS-SAVE-SUPVI
 14370         MOVE SUPVL  TO WS-SAVE-SUPVL
 14371     END-IF
 14372     IF PRICDL > 0
 14373         MOVE PRICDI  TO WS-SAVE-PRICDI
 14374         MOVE PRICDL  TO WS-SAVE-PRICDL
 14375     END-IF
 14376     IF FILETOL > 0
 14377         MOVE FILETOI  TO WS-SAVE-FILETOI
 14378         MOVE FILETOL  TO WS-SAVE-FILETOL
 14379     END-IF
 14380     IF PDTHRUL > 0
 14381         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14382         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14383     END-IF
 14384     IF PDAMTL > 0
 14385         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14386         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14387     END-IF
 14388     IF NODAYSL > 0
 14389         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14390         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14391     END-IF
 14392     IF NOPMTSL > 0
 14393         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14394         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14395     END-IF
 14396     IF FORMTYPL > 0
 14397         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14398         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14399     END-IF
 14400     IF OCCL > 0
 14401         MOVE OCCI  TO WS-SAVE-OCCI
 14402         MOVE OCCL  TO WS-SAVE-OCCL
 14403     END-IF.
 14404 4100-EXIT.
 14405      EXIT.
 14406
 14407 4200-LOAD-CHANGES.
 14408     IF WS-SAVE-MAINTL > 0
 14409         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 269
* EL131.cbl
 14410         MOVE WS-SAVE-MAINTL  TO MAINTL
 14411         MOVE AL-UANON        TO MAINTA
 14412     END-IF
 14413     IF WS-SAVE-STATUSL > 0
 14414         MOVE WS-SAVE-STATUSI  TO STATUSI
 14415         MOVE WS-SAVE-STATUSL  TO STATUSL
 14416         MOVE AL-UANON         TO STATUSA
 14417     END-IF
 14418     IF WS-SAVE-REPL > 0
 14419         MOVE WS-SAVE-REPI  TO REPI
 14420         MOVE WS-SAVE-REPL  TO REPL
 14421         MOVE AL-UANON      TO REPA
 14422     END-IF
 14423*    IF WS-SAVE-CAUSEL > 0
 14424*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14425*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14426*        MOVE AL-UANON        TO CAUSEA
 14427*    END-IF
 14428*    IF WS-SAVE-ENDL > 0
 14429*        MOVE WS-SAVE-ENDI  TO ENDI
 14430*        MOVE WS-SAVE-ENDL  TO ENDL
 14431*        MOVE AL-UANON      TO ENDA
 14432*    END-IF
 14433     IF WS-SAVE-DIAGL > 0
 14434         MOVE WS-SAVE-DIAGI  TO DIAGI
 14435         MOVE WS-SAVE-DIAGL  TO DIAGL
 14436         MOVE AL-UANON       TO DIAGA
 14437     END-IF
 14438     IF WS-SAVE-ICD1L > 0
 14439         MOVE WS-SAVE-ICD1I  TO ICD1I
 14440         MOVE WS-SAVE-ICD1L  TO ICD1L
 14441         MOVE AL-UANON       TO ICD1A
 14442     END-IF
 14443     IF WS-SAVE-ICD2L > 0
 14444         MOVE WS-SAVE-ICD2I  TO ICD2I
 14445         MOVE WS-SAVE-ICD2L  TO ICD2L
 14446         MOVE AL-UANON       TO ICD2A
 14447     END-IF
 14448     IF WS-SAVE-BENEL > 0
 14449         MOVE WS-SAVE-BENEI  TO BENEI
 14450         MOVE WS-SAVE-BENEL  TO BENEL
 14451         MOVE AL-UANON       TO BENEA
 14452     END-IF
 14453     IF WS-SAVE-BIRTHL > 0
 14454         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14455         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14456         MOVE AL-UANON        TO BIRTHA
 14457     END-IF
 14458     IF WS-SAVE-SOCIALL > 0
 14459         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14460         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14461         MOVE AL-UANON         TO SOCIALA
 14462     END-IF
 14463     IF WS-SAVE-SEXL > 0
 14464         MOVE WS-SAVE-SEXI  TO SEXI
 14465         MOVE WS-SAVE-SEXL  TO SEXL
 14466         MOVE AL-UANON      TO SEXA
 14467     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 270
* EL131.cbl
 14468     IF WS-SAVE-MLNAMEL > 0
 14469         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14470         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14471         MOVE AL-UANON         TO MLNAMEA
 14472     END-IF
 14473     IF WS-SAVE-MFNAMEL > 0
 14474         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14475         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14476         MOVE AL-UANON         TO MFNAMEA
 14477     END-IF
 14478     IF WS-SAVE-MMINITL > 0
 14479         MOVE WS-SAVE-MMINITI  TO MMINITI
 14480         MOVE WS-SAVE-MMINITL  TO MMINITL
 14481         MOVE AL-UANON         TO MMINITA
 14482     END-IF
 14483     IF WS-SAVE-LOANNOL > 0
 14484         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14485         MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14486         MOVE AL-UANON         TO LOANNOA
 14487     END-IF
 14488     IF WS-SAVE-LOANBALL > 0
 14489         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14490         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14491         MOVE AL-UANON          TO LOANBALA
 14492     END-IF
 14493     IF WS-SAVE-PROCL > 0
 14494         MOVE WS-SAVE-PROCI  TO PROCI
 14495         MOVE WS-SAVE-PROCL  TO PROCL
 14496         MOVE AL-UANON       TO PROCA
 14497     END-IF
 14498     IF WS-SAVE-SUPVL > 0
 14499         MOVE WS-SAVE-SUPVI  TO SUPVI
 14500         MOVE WS-SAVE-SUPVL  TO SUPVL
 14501         MOVE AL-UANON       TO SUPVA
 14502     END-IF
 14503     IF WS-SAVE-PRICDL > 0
 14504         MOVE WS-SAVE-PRICDI  TO PRICDI
 14505         MOVE WS-SAVE-PRICDL  TO PRICDL
 14506         MOVE AL-UANON        TO PRICDA
 14507     END-IF
 14508     IF WS-SAVE-FILETOL > 0
 14509         MOVE WS-SAVE-FILETOI  TO FILETOI
 14510         MOVE WS-SAVE-FILETOL  TO FILETOL
 14511         MOVE AL-UANON         TO FILETOA
 14512     END-IF
 14513     IF WS-SAVE-PDTHRUL > 0
 14514         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14515         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14516         MOVE AL-UANON         TO PDTHRUA
 14517     END-IF
 14518     IF WS-SAVE-PDAMTL > 0
 14519         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14520         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14521         MOVE AL-UANON        TO PDAMTA
 14522     END-IF
 14523     IF WS-SAVE-NODAYSL > 0
 14524         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14525         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 271
* EL131.cbl
 14526         MOVE AL-UANON         TO NODAYSA
 14527     END-IF
 14528     IF WS-SAVE-NOPMTSL > 0
 14529         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14530         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14531         MOVE AL-UANON         TO NOPMTSA
 14532     END-IF
 14533     IF WS-SAVE-FORMTYPL > 0
 14534         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14535         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14536         MOVE AL-UANON          TO FORMTYPA
 14537     END-IF
 14538     IF WS-SAVE-OCCL > 0
 14539         MOVE WS-SAVE-OCCI  TO OCCI
 14540         MOVE WS-SAVE-OCCL  TO OCCL
 14541         MOVE AL-UANON      TO OCCA
 14542     END-IF.
 14543 4200-EXIT.
 14544      EXIT.
 14545
 14546 5000-BUILD-MAP.
 14547     IF PI-RETURN-CD-1 = SPACE
 14548         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14549
 14550     MOVE SPACE                  TO PI-RETURN-CD-1.
 14551
 14552     MOVE LOW-VALUES             TO EL131AI.
 14553
 14554     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14555     MOVE PI-CARRIER             TO CARRIER-CODE.
 14556     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14557     MOVE PI-CERT-NO             TO CERT-NO.
 14558
 14559 5000-READ-CLAIM-MASTER.
 14560
 14561
 14562* EXEC CICS READ
 14563*         SET      (ADDRESS OF CLAIM-MASTER)
 14564*         DATASET  (CLMS-FILE-ID)
 14565*         RIDFLD   (MSTR-KEY)
 14566*    END-EXEC.
 14567*    MOVE '&"S        E          (   #00012328' TO DFHEIV0
 14568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14570     MOVE X'2020233030303132333238' TO DFHEIV0(25:11)
 14571     CALL 'kxdfhei1' USING DFHEIV0,
 14572           CLMS-FILE-ID,
 14573           DFHEIV20,
 14574           DFHEIV99,
 14575           MSTR-KEY,
 14576           DFHEIV99,
 14577           DFHEIV99,
 14578           DFHEIV99
 14579     SET ADDRESS OF CLAIM-MASTER TO
 14580         DFHEIV20
 14581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14582
 14583
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 272
* EL131.cbl
 14584     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14585
 14586 5000-READ-DIAGNOSIS-TRAILER.
 14587
 14588
 14589* EXEC CICS HANDLE CONDITION
 14590*         NOTFND (5000-TRLR-NOT-FOUND)
 14591*    END-EXEC.
 14592*    MOVE '"$I                   ! B #00012338' TO DFHEIV0
 14593     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14595     MOVE X'4220233030303132333338' TO DFHEIV0(25:11)
 14596     CALL 'kxdfhei1' USING DFHEIV0
 14597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14598
 14599
 14600     MOVE MSTR-KEY               TO TRLR-KEY.
 14601     MOVE NINETY                 TO TRLR-SEQ-NO.
 14602
 14603
 14604* EXEC CICS READ
 14605*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14606*         DATASET  (TRLR-FILE-ID)
 14607*         RIDFLD   (TRLR-KEY)
 14608*    END-EXEC.
 14609*    MOVE '&"S        E          (   #00012345' TO DFHEIV0
 14610     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14612     MOVE X'2020233030303132333435' TO DFHEIV0(25:11)
 14613     CALL 'kxdfhei1' USING DFHEIV0,
 14614           TRLR-FILE-ID,
 14615           DFHEIV20,
 14616           DFHEIV99,
 14617           TRLR-KEY,
 14618           DFHEIV99,
 14619           DFHEIV99,
 14620           DFHEIV99
 14621     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14622         DFHEIV20
 14623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14624
 14625
 14626     MOVE AT-INFO-LINE-1         TO DIAGO.
 14627     MOVE AT-ICD-CODE-1          TO ICD1O.
 14628     MOVE AT-ICD-CODE-2          TO ICD2O.
 14629
 14630 5000-READ-CERTIFICATE-MASTER.
 14631
 14632     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14633     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14634     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14635     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14636     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14637     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14638     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14639
 14640
 14641* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 273
* EL131.cbl
 14642*         NOTFND (5000-CERT-NOT-FOUND)
 14643*    END-EXEC.
 14644*    MOVE '"$I                   ! C #00012365' TO DFHEIV0
 14645     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14647     MOVE X'4320233030303132333635' TO DFHEIV0(25:11)
 14648     CALL 'kxdfhei1' USING DFHEIV0
 14649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14650
 14651
 14652
 14653* EXEC CICS READ
 14654*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14655*         DATASET  (CERT-FILE-ID)
 14656*         RIDFLD   (CERT-KEY)
 14657*    END-EXEC.
 14658*    MOVE '&"S        E          (   #00012369' TO DFHEIV0
 14659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14661     MOVE X'2020233030303132333639' TO DFHEIV0(25:11)
 14662     CALL 'kxdfhei1' USING DFHEIV0,
 14663           CERT-FILE-ID,
 14664           DFHEIV20,
 14665           DFHEIV99,
 14666           CERT-KEY,
 14667           DFHEIV99,
 14668           DFHEIV99,
 14669           DFHEIV99
 14670     SET ADDRESS OF CERTIFICATE-MASTER TO
 14671         DFHEIV20
 14672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14673
 14674
 14675     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14676     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14677
 14678     GO TO 5000-EXIT.
 14679
 14680 5000-TRLR-NOT-FOUND.
 14681     MOVE ER-7687                TO EMI-ERROR.
 14682     MOVE -1                     TO DIAGL.
 14683     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14684     GO TO 5000-EXIT.
 14685
 14686 5000-CERT-NOT-FOUND.
 14687     MOVE ER-0206                TO EMI-ERROR.
 14688     MOVE -1                     TO CERTL.
 14689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14690
 14691 5000-EXIT.
 14692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 274
* EL131.cbl
 14694 5010-RESET-PI-AREA.
 14695     IF CERTI GREATER THAN LOW-VALUES
 14696         MOVE CERTI              TO PI-CERT-PRIME.
 14697
 14698     IF SUFXI GREATER THAN LOW-VALUES
 14699         MOVE SUFXI              TO PI-CERT-SFX.
 14700
 14701     IF CERTEFFI GREATER THAN LOW-VALUES
 14702         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14703
 14704     IF CERTACTI GREATER THAN LOW-VALUES
 14705         MOVE CERTACTI           TO PI-ACCOUNT.
 14706
 14707     IF CERTSTI GREATER THAN LOW-VALUES
 14708         MOVE CERTSTI            TO PI-STATE.
 14709
 14710     IF CERTCARI GREATER THAN LOW-VALUES
 14711         MOVE CERTCARI           TO PI-CARRIER.
 14712
 14713     IF CERTGRPI GREATER THAN LOW-VALUES
 14714         MOVE CERTGRPI           TO PI-GROUPING.
 14715
 14716 5010-EXIT.
 14717     EXIT.
 14718
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 275
* EL131.cbl
 14720 5020-MOVE-MSTR.
 14721
 14722     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14723     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14724     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14725     MOVE AL-SABON               TO SEQUA.
 14726     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14727     MOVE CL-CLAIM-TYPE          TO TYPEO
 14728                                    pi-claim-type
 14729
 14730     IF CL-TOTAL-PAID-AMT  = +0 AND
 14731        CL-LAST-PMT-AMT    = +0 AND
 14732        CL-NO-OF-PMTS-MADE = +0
 14733          MOVE AL-UANON          TO TYPEA.
 14734
 14735     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14736     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14737     MOVE CL-CERT-PRIME          TO CERTO.
 14738     MOVE CL-CERT-SFX            TO SUFXO.
 14739     MOVE CL-CERT-CARRIER        TO CARRO.
 14740
 14741     IF CL-CLAIM-STATUS = 'C'
 14742         MOVE 'CLOSED'           TO STATUSO
 14743     ELSE
 14744         MOVE 'OPEN  '           TO STATUSO.
 14745
 14746     move cl-accident-claim-sw   to accswo
 14747     if cl-benefit-period not numeric
 14748        move zeros               to cl-benefit-period
 14749     end-if
 14750     move cl-benefit-period      to benpero
 14751     move cl-insured-type        to instypeo
 14752     MOVE CL-PROCESSOR-ID        TO PROCO.
 14753
 14754     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14755     MOVE CL-CCN                 TO CCNOO.
 14756
 14757     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14758     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14759     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14760     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14761
 14762     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14763         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14764         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14765         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14766         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14767     ELSE
 14768         MOVE SPACES             TO BIRTHO.
 14769
 14770     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14771        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14772         NEXT SENTENCE
 14773       ELSE
 14774         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14775
 14776     IF PI-COMPANY-ID = 'DMD'
 14777       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 276
* EL131.cbl
 14778          IF SOCIALO = SPACES OR LOW-VALUES
 14779            MOVE ER-0885         TO EMI-ERROR
 14780            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14781
 14782     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14783*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14784
 14785*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14786*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14787*        MOVE SPACES                 TO DC-OPTION-CODE
 14788*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14789*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14790*    ELSE
 14791*        MOVE SPACES             TO ENDO.
 14792
 14793     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14794        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14795        MOVE SPACES             TO DC-OPTION-CODE
 14796        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14797        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14798        IF PI-USES-PAID-TO
 14799           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14800           MOVE '6'                TO DC-OPTION-CODE
 14801           MOVE +1                 TO DC-ELAPSED-DAYS
 14802           MOVE +0                 TO DC-ELAPSED-MONTHS
 14803           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14804           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14805        ELSE
 14806           NEXT SENTENCE
 14807     ELSE
 14808        MOVE SPACES             TO PDTHRUO.
 14809
 14810     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14811     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14812     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14813     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14814
 14815     IF MODIFY-CAP
 14816        MOVE AL-UNNOF            TO PDAMTA
 14817                                    NODAYSA
 14818                                    NOPMTSA
 14819        MOVE AL-UANOF            TO PDTHRUA.
 14820     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14821     MOVE '2'                    TO CNTL-REC-TYPE
 14822     MOVE +0                     TO CNTL-SEQ-NO
 14823     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14824
 14825
 14826* EXEC CICS READ
 14827*         DATASET  (CNTL-FILE-ID)
 14828*         SET      (ADDRESS OF CONTROL-FILE)
 14829*         RIDFLD   (CNTL-KEY)
 14830*         RESP     (WS-RESPONSE)
 14831*    END-EXEC
 14832*    MOVE '&"S        E          (  N#00012525' TO DFHEIV0
 14833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14835     MOVE X'204E233030303132353235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 277
* EL131.cbl
 14836     CALL 'kxdfhei1' USING DFHEIV0,
 14837           CNTL-FILE-ID,
 14838           DFHEIV20,
 14839           DFHEIV99,
 14840           CNTL-KEY,
 14841           DFHEIV99,
 14842           DFHEIV99,
 14843           DFHEIV99
 14844     SET ADDRESS OF CONTROL-FILE TO
 14845         DFHEIV20
 14846     MOVE EIBRESP  TO WS-RESPONSE
 14847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14848
 14849     IF WS-RESP-NORMAL
 14850        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14851     end-if
 14852     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14853         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14854         MOVE SPACES             TO DC-OPTION-CODE
 14855         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14856         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14857     ELSE
 14858         MOVE SPACES             TO INCO.
 14859
 14860     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14861        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14862        MOVE AL-UANOF            TO INCA
 14863     end-if
 14864     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14865
 14866     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14867         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14868         MOVE SPACES             TO DC-OPTION-CODE
 14869         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14870         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14871     ELSE
 14872         MOVE SPACES             TO REPO.
 14873
 14874     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14875         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14876         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14877         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14878         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14879     ELSE
 14880         MOVE SPACES             TO ESTO.
 14881
 14882     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14883         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14884         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14885         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14886         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14887     ELSE
 14888         MOVE SPACES             TO MNTDTO.
 14889
 14890
 14891     IF CL-LAST-MAINT-TYPE = SPACE
 14892         MOVE 'SET-UP'           TO MNTTYPEO
 14893     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 278
* EL131.cbl
 14894     IF CL-LAST-MAINT-TYPE = '1'
 14895         MOVE 'PAYMNT'           TO MNTTYPEO
 14896     ELSE
 14897     IF CL-LAST-MAINT-TYPE = '2'
 14898         MOVE 'LETTER'           TO MNTTYPEO
 14899     ELSE
 14900     IF CL-LAST-MAINT-TYPE = '3'
 14901         MOVE 'UPDATE'           TO MNTTYPEO
 14902     ELSE
 14903     IF CL-LAST-MAINT-TYPE = '4'
 14904         MOVE 'RESTOR'           TO MNTTYPEO
 14905     ELSE
 14906     IF CL-LAST-MAINT-TYPE = '5'
 14907         MOVE 'INC DT'           TO MNTTYPEO
 14908     ELSE
 14909     IF CL-LAST-MAINT-TYPE = '6'
 14910         MOVE ' CONV'            TO MNTTYPEO
 14911     ELSE
 14912     IF CL-LAST-MAINT-TYPE = 'C'
 14913         MOVE 'CHGBEN'           TO MNTTYPEO
 14914     ELSE
 14915     IF CL-LAST-MAINT-TYPE = 'E'
 14916         MOVE 'ERRCOR'           TO MNTTYPEO
 14917     ELSE
 14918         MOVE SPACES             TO MNTTYPEO.
 14919
 14920     MOVE CL-BENEFICIARY         TO BENEO.
 14921     MOVE CL-FILE-LOCATION       TO FILETOO.
 14922     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14923        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14924     END-IF
 14925     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14926*    MOVE CL-CRIT-PER-RECURRENT
 14927*                                TO CRITPTO
 14928*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14929*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14930*    END-IF
 14931*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14932     MOVE CL-PRIORITY-CD         TO PRICDO.
 14933     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14934     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14935     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14936     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14937
 14938 5020-EXIT.
 14939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 279
* EL131.cbl
 14941 5030-MOVE-CERT.
 14942
 14943     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14944         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14945         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14946         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14947         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14948       ELSE
 14949         MOVE SPACES             TO CERTEFFO
 14950         MOVE ZERO               TO HOLD-DATE.
 14951
 14952     MOVE CM-ACCOUNT             TO CERTACTO.
 14953     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14954     MOVE CM-GROUPING            TO CERTGRPO.
 14955     MOVE CM-CARRIER             TO CERTCARO.
 14956     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14957     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14958     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14959     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14960     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14961     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14962     MOVE CM-JT-INITIAL          TO JNTINITO.
 14963     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14964
 14965*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14966     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14967     MOVE '3'                    TO CNTL-REC-TYPE.
 14968     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14969     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14970     MOVE ZERO                   TO CNTL-SEQ-NO.
 14971
 14972
 14973* EXEC CICS READ
 14974*         SET        (ADDRESS OF CONTROL-FILE)
 14975*         DATASET    ('ELCNTL')
 14976*         RIDFLD     (CNTL-KEY)
 14977*         RESP       (WS-RESPONSE)
 14978*    END-EXEC.
 14979     MOVE 'ELCNTL' TO DFHEIV1
 14980*    MOVE '&"S        E          (  N#00012655' TO DFHEIV0
 14981     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14982     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14983     MOVE X'204E233030303132363535' TO DFHEIV0(25:11)
 14984     CALL 'kxdfhei1' USING DFHEIV0,
 14985           DFHEIV1,
 14986           DFHEIV20,
 14987           DFHEIV99,
 14988           CNTL-KEY,
 14989           DFHEIV99,
 14990           DFHEIV99,
 14991           DFHEIV99
 14992     SET ADDRESS OF CONTROL-FILE TO
 14993         DFHEIV20
 14994     MOVE EIBRESP  TO WS-RESPONSE
 14995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14996
 14997
 14998     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 280
* EL131.cbl
 14999        MOVE ZERO                TO CP-FREE-LOOK
 15000     ELSE
 15001        MOVE CF-ST-FREE-LOOK-PERIOD
 15002                                 TO CP-FREE-LOOK.
 15003
 15004     IF CM-LF-BENEFIT-CD = '00'
 15005        GO TO 5030-MOVE-CERT-AH.
 15006
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 281
* EL131.cbl
 15008     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15009     MOVE '5'                    TO DC-OPTION-CODE
 15010     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15011     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15012     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15013     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15014     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15015     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15016     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15017     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15018     MOVE '4'                    TO CP-REM-TERM-METHOD
 15019     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15020     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15021     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15022
 15023     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15024     IF CM-LF-PREMIUM-RATE NUMERIC
 15025         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15026     ELSE
 15027         MOVE ZEROS              TO LCVRATEO.
 15028
 15029     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15030         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15031
 15032     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15033
 15034     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15035
 15036     IF CM-LF-CURRENT-STATUS = '8'
 15037        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15038            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15039            MOVE ' '             TO DC-OPTION-CODE
 15040            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15041            IF NOT DATE-CONVERSION-ERROR
 15042                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15043
 15044     IF CM-LF-CURRENT-STATUS = '7'
 15045        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15046            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15047            MOVE ' '             TO DC-OPTION-CODE
 15048            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15049            IF NOT DATE-CONVERSION-ERROR
 15050                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15051
 15052     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15053         MOVE ' '                TO DC-OPTION-CODE
 15054         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15055         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15056         IF NOT DATE-CONVERSION-ERROR
 15057             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15058             MOVE HOLD-MONTH     TO WORK-MONTH
 15059             MOVE HOLD-YEAR      TO WORK-YEAR
 15060             MOVE WORK-DATE-MY   TO LCVEXITO.
 15061
 15062     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15063        IF CP-REMAINING-TERM-3 = ZEROS
 15064           MOVE 'EXPIRED'        TO LCVSTATO
 15065        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 282
* EL131.cbl
 15066           MOVE 'ACTIVE'         TO LCVSTATO.
 15067
 15068     IF CM-LF-CURRENT-STATUS = '2'
 15069        MOVE 'PEND   '           TO LCVSTATO.
 15070     IF CM-LF-CURRENT-STATUS = '3'
 15071        MOVE 'RESTORE'           TO LCVSTATO.
 15072     IF CM-LF-CURRENT-STATUS = '5'
 15073        MOVE 'REISSUE'           TO LCVSTATO.
 15074     IF CM-LF-CURRENT-STATUS = '6'
 15075        MOVE 'LMP DIS'           TO LCVSTATO.
 15076     IF CM-LF-CURRENT-STATUS = '7'
 15077        MOVE 'DEATH  '           TO LCVSTATO.
 15078     IF CM-LF-CURRENT-STATUS = '8'
 15079        MOVE 'CANCEL '           TO LCVSTATO.
 15080     IF CM-LF-CURRENT-STATUS = '9'
 15081        MOVE 'RE-ONLY'           TO LCVSTATO.
 15082     IF CM-LF-CURRENT-STATUS = 'V'
 15083        MOVE 'VOID   '           TO LCVSTATO.
 15084     IF CM-LF-CURRENT-STATUS = 'D'
 15085        MOVE 'DECLINE'           TO LCVSTATO.
 15086
 15087     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15088     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15089     MOVE '4'                    TO BEN-REC-TYPE.
 15090     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15091     MOVE ZERO                   TO BEN-SEQ-NO.
 15092
 15093
 15094* EXEC CICS READ GTEQ
 15095*         DATASET  (CNTL-FILE-ID)
 15096*         RIDFLD   (BENEFIT-KEY)
 15097*         SET      (ADDRESS OF CONTROL-FILE)
 15098*    END-EXEC.
 15099*    MOVE '&"S        G          (   #00012757' TO DFHEIV0
 15100     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15102     MOVE X'2020233030303132373537' TO DFHEIV0(25:11)
 15103     CALL 'kxdfhei1' USING DFHEIV0,
 15104           CNTL-FILE-ID,
 15105           DFHEIV20,
 15106           DFHEIV99,
 15107           BENEFIT-KEY,
 15108           DFHEIV99,
 15109           DFHEIV99,
 15110           DFHEIV99
 15111     SET ADDRESS OF CONTROL-FILE TO
 15112         DFHEIV20
 15113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15114
 15115
 15116     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15117        CF-RECORD-TYPE NOT = '4'
 15118         MOVE ER-0240            TO EMI-ERROR
 15119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15120         GO TO 5030-MOVE-CERT-FINISH.
 15121
 15122     MOVE ZERO                   TO COUNT-2.
 15123     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 283
* EL131.cbl
 15124
 15125     IF SCREEN-ERROR
 15126         MOVE ER-0282            TO EMI-ERROR
 15127         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15128        ELSE
 15129         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15130
 15131 5030-MOVE-CERT-AH.
 15132
 15133     IF CM-LF-BENEFIT-CD = '00'
 15134         IF CM-AH-BENEFIT-CD = '00'
 15135             GO TO 5030-MOVE-CERT-FINISH.
 15136
 15137     IF CM-AH-BENEFIT-CD = '00'
 15138        MOVE SPACES             TO ACVKINDO
 15139        COMPUTE PI-PAYMENT-AMT =
 15140                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15141        GO TO 5030-MOVE-CERT-FINISH.
 15142
 15143     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15144     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15145     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15146     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15147     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15148     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15149     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15150     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15151
 15152**DMD **********************************************
 15153     IF PI-COMPANY-ID = 'DMD'
 15154         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15155                                   CM-PMT-EXTENSION-DAYS
 15156         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15157                                      CL-NO-OF-DAYS-PAID
 15158         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15159             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15160         MOVE WS-REM-MOS         TO ACVRTRMO
 15161                                    CP-REMAINING-TERM-3
 15162*        MOVE WS-REM-DAYS        TO DAYSPO
 15163         GO TO 5030-SKIP-RTRM.
 15164**DMD **********************************************
 15165
 15166     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15167     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15168     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15169     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15170
 15171 5030-SKIP-RTRM.
 15172     IF CM-AH-PREMIUM-RATE NUMERIC
 15173         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15174     ELSE
 15175         MOVE ZEROS              TO ACVRATEO.
 15176
 15177     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15178     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15179
 15180     IF CM-AH-CURRENT-STATUS = '8'
 15181        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 284
* EL131.cbl
 15182            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15183            MOVE ' '             TO DC-OPTION-CODE
 15184            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15185            IF NOT DATE-CONVERSION-ERROR
 15186                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15187
 15188     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15189        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15190            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15191            MOVE ' '             TO DC-OPTION-CODE
 15192            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15193            IF NOT DATE-CONVERSION-ERROR
 15194                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15195
 15196     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15197        IF CP-REMAINING-TERM-3 = ZEROS
 15198           MOVE 'EXPIRED'        TO ACVSTATO
 15199        ELSE
 15200           MOVE 'ACTIVE'         TO ACVSTATO.
 15201
 15202     IF CM-AH-CURRENT-STATUS = '2'
 15203        MOVE 'PEND   '           TO ACVSTATO.
 15204     IF CM-AH-CURRENT-STATUS = '3'
 15205        MOVE 'RESTORE'           TO ACVSTATO.
 15206     IF CM-AH-CURRENT-STATUS = '5'
 15207        MOVE 'REISSUE'           TO ACVSTATO.
 15208     IF CM-AH-CURRENT-STATUS = '6'
 15209        MOVE 'LMP DIS'           TO ACVSTATO.
 15210     IF CM-AH-CURRENT-STATUS = '7'
 15211        MOVE 'DEATH  '           TO ACVSTATO.
 15212     IF CM-AH-CURRENT-STATUS = '8'
 15213        MOVE 'CANCEL '           TO ACVSTATO.
 15214     IF CM-AH-CURRENT-STATUS = '9'
 15215        MOVE 'RE-ONLY'           TO ACVSTATO.
 15216     IF CM-AH-CURRENT-STATUS = 'V'
 15217        MOVE 'VOID   '           TO ACVSTATO.
 15218     IF CM-AH-CURRENT-STATUS = '9'
 15219        MOVE 'DECLINE'           TO ACVSTATO.
 15220
 15221     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15222         MOVE ' '                TO DC-OPTION-CODE
 15223         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15224         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15225         IF NOT DATE-CONVERSION-ERROR
 15226             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15227             MOVE HOLD-MONTH     TO WORK-MONTH
 15228             MOVE HOLD-YEAR      TO WORK-YEAR
 15229             MOVE WORK-DATE-MY   TO ACVEXITO.
 15230
 15231     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15232
 15233     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15234     MOVE '5'                    TO BEN-REC-TYPE.
 15235     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15236     MOVE ZERO                   TO BEN-SEQ-NO.
 15237
 15238
 15239* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 285
* EL131.cbl
 15240*         DATASET  (CNTL-FILE-ID)
 15241*         RIDFLD   (BENEFIT-KEY)
 15242*         SET      (ADDRESS OF CONTROL-FILE)
 15243*    END-EXEC.
 15244*    MOVE '&"S        G          (   #00012885' TO DFHEIV0
 15245     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15247     MOVE X'2020233030303132383835' TO DFHEIV0(25:11)
 15248     CALL 'kxdfhei1' USING DFHEIV0,
 15249           CNTL-FILE-ID,
 15250           DFHEIV20,
 15251           DFHEIV99,
 15252           BENEFIT-KEY,
 15253           DFHEIV99,
 15254           DFHEIV99,
 15255           DFHEIV99
 15256     SET ADDRESS OF CONTROL-FILE TO
 15257         DFHEIV20
 15258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15259
 15260
 15261     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15262        CF-RECORD-TYPE NOT = '5'
 15263         MOVE ER-0250            TO EMI-ERROR
 15264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15265         GO TO 5030-MOVE-CERT-FINISH.
 15266
 15267     MOVE ZERO                   TO COUNT-2.
 15268     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15269
 15270     IF SCREEN-ERROR
 15271         MOVE ER-0283            TO EMI-ERROR
 15272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15273       ELSE
 15274         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15275
 15276 5030-MOVE-CERT-FINISH.
 15277
 15278     MOVE CM-LOAN-APR            TO APRO.
 15279     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15280     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15281     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15282     MOVE CM-LOAN-NUMBER         TO LOANNOO
 15283     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15284     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15285
 15286     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15287         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15288         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15289         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15290         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15291     ELSE
 15292         MOVE SPACES               TO ADDONDTO.
 15293
 15294     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15295
 15296 5030-EXIT.
 15297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 286
* EL131.cbl
 15299 5040-FIND-BENEFIT.
 15300     ADD 1                       TO COUNT-2.
 15301     IF COUNT-2 GREATER THAN 8
 15302         GO TO 5050-BENEFIT-NOTFND.
 15303
 15304     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15305         GO TO 5060-EXIT.
 15306
 15307     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15308         GO TO 5050-BENEFIT-NOTFND.
 15309
 15310     GO TO 5040-FIND-BENEFIT.
 15311
 15312 5050-BENEFIT-NOTFND.
 15313     MOVE 'X'                    TO ERROR-SWITCH.
 15314
 15315 5060-EXIT.
 15316     EXIT.
 15317
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 287
* EL131.cbl
 15319 6000-CALCULATE-CERT-TERM.
 15320
 15321     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15322         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15323     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15324         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15325     IF CM-LOAN-APR NOT NUMERIC
 15326         MOVE ZEROS              TO CM-LOAN-APR.
 15327
 15328*    IF WS-CALC-METHOD  = 'G'
 15329         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15330*     ELSE
 15331*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15332
 15333     IF N GREATER 120
 15334         MOVE 120                TO N.
 15335
 15336     MOVE '6'                    TO DC-OPTION-CODE.
 15337     MOVE N                      TO DC-ELAPSED-MONTHS.
 15338     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15339     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15340
 15341     IF CM-LF-BENEFIT-CD NOT = ZERO
 15342         MOVE N                  TO CM-LF-ORIG-TERM
 15343         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15344         IF NO-CONVERSION-ERROR
 15345             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15346
 15347     IF CM-AH-BENEFIT-CD NOT = ZERO
 15348         MOVE N                  TO CM-AH-ORIG-TERM
 15349         IF NO-CONVERSION-ERROR
 15350             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15351
 15352 6000-EXIT.
 15353      EXIT.
 15354
 15355 6100-CALC-GROSS-TERM.
 15356     MOVE CM-LOAN-BALANCE         TO L.
 15357     MOVE PI-PAYMENT-AMT          TO M.
 15358
 15359     COMPUTE N = L / M.
 15360     IF N LESS 1
 15361         MOVE 1  TO N.
 15362
 15363     IF CM-LF-BENEFIT-CD NOT = ZERO
 15364         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15365     ELSE
 15366         MOVE ZEROS               TO WS-LF-RATE.
 15367
 15368     IF CM-AH-BENEFIT-CD NOT = ZERO
 15369         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15370     ELSE
 15371         MOVE ZEROS               TO WS-AH-RATE.
 15372
 15373     COMPUTE I = CM-LOAN-APR / +1200.
 15374
 15375 6105-LOOP.
 15376     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 288
* EL131.cbl
 15377         GO TO 6200-EXIT.
 15378     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15379     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15380         ADD 1 TO N
 15381         GO TO 6105-LOOP.
 15382
 15383 6200-EXIT.
 15384      EXIT.
 15385
 15386 6210-CALC-LEFT-RIGHTONE.
 15387      MOVE L         TO LEFT-TOT-1.
 15388      SUBTRACT 1 FROM N.
 15389      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15390      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15391      ADD 1 TO N.
 15392 6211-CALC-TERM1.
 15393      MOVE N         TO TERM1.
 15394      MULTIPLY M BY TERM1.
 15395 6212-LOOP.
 15396      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15397      ADD 1 TO A-N.
 15398      MULTIPLY A-N BY TERM1.
 15399      SUBTRACT 1 FROM A-N.
 15400      ADD TERM1 TO LEFT-TOT-1.
 15401 6213-CALC-TERM2.
 15402      MOVE M         TO TERM2.
 15403      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15404      MULTIPLY IA-N BY TERM2.
 15405      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15406 6215-CALC-RIGHTONE.
 15407      MOVE M         TO RIGHT-TOT-1.
 15408      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15409      MULTIPLY A-N BY RIGHT-TOT-1.
 15410 6220-EXIT.
 15411      EXIT.
 15412
 15413 6300-CALC-A-N.
 15414     IF N LESS 1
 15415         MOVE 0     TO A-N
 15416         GO TO 6300-EXIT.
 15417     IF I = 0
 15418         MOVE .00001 TO I.
 15419     ADD 1 TO I.
 15420     DIVIDE I INTO 1 GIVING V.
 15421     SUBTRACT 1 FROM I.
 15422     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15423     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15424     DIVIDE I INTO TERM3 GIVING A-N.
 15425 6300-EXIT.
 15426      EXIT.
 15427
 15428 6350-CALC-IA-N.
 15429     IF N LESS 1
 15430         MOVE 0      TO IA-N
 15431         GO TO 6400-EXIT.
 15432     ADD 1 TO N.
 15433     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15434     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 289
* EL131.cbl
 15435     MULTIPLY N BY V-EX-N GIVING TERM3.
 15436     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15437     SUBTRACT V FROM 1 GIVING TERM4.
 15438     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15439 6400-EXIT.
 15440      EXIT.
 15441
 15442 6450-CALC-V-EX-N.
 15443     IF N LESS 1
 15444         MOVE 1    TO V-EX-N
 15445         GO TO 6490-EXIT.
 15446     MOVE N        TO NV-STORE.
 15447     IF V-EX-ONETIME = 1  OR
 15448        V NOT = V-EXPONENT (1)
 15449          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15450 6460-LOOP.
 15451     IF N GREATER 248
 15452         MOVE 248 TO N.
 15453     IF N = 1
 15454         MOVE V               TO V-EX-N
 15455      ELSE
 15456         MOVE V-EXPONENT (N)  TO V-EX-N.
 15457     GO TO 6490-EXIT.
 15458
 15459 6470-BUILD-V-EX-TABLE.
 15460     MOVE 2      TO N.
 15461     MOVE V      TO V-EXPONENT (1)
 15462                    V-EX-N.
 15463 6471-LOOP.
 15464     MULTIPLY V BY V-EX-N.
 15465     MOVE V-EX-N   TO V-EXPONENT (N).
 15466     ADD 1 TO N.
 15467     IF N LESS 248
 15468         GO TO 6471-LOOP.
 15469     MOVE NV-STORE     TO N.
 15470     MOVE 0            TO V-EX-ONETIME.
 15471 6480-EXIT.
 15472      EXIT.
 15473
 15474 6490-EXIT.
 15475      EXIT.
 15476
 15477 6500-CALC-NET-TERM.
 15478     MOVE CM-LOAN-BALANCE         TO L.
 15479     MOVE PI-PAYMENT-AMT          TO M.
 15480
 15481     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15482     IF WS-REMAIN GREATER ZERO
 15483         ADD 1 TO N.
 15484     IF N = 0
 15485         MOVE 1 TO N.
 15486
 15487 6700-EXIT.
 15488      EXIT.
 15489
 15490 6999-CALC-TERM-EXIT.
 15491     EXIT.
 15492
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 290
* EL131.cbl
 15494 7000-RESET-ATTRIBUTE.
 15495
 15496     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15497                                    CERTSTA   CERTCARA
 15498                                    CERTGRPA.
 15499     MOVE -1                     TO CERTCARL.
 15500
 15501 7000-EXIT.
 15502     EXIT.
 15503
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 291
* EL131.cbl
 15505 7600-BROWSE-CLAIM.
 15506
 15507
 15508* EXEC CICS READ
 15509*        DATASET(CLMS-FILE-ID)
 15510*        SET    (ADDRESS OF CLAIM-MASTER)
 15511*        RIDFLD (MSTR-KEY)
 15512*        GENERIC
 15513*        EQUAL
 15514*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15515*    END-EXEC.
 15516*    MOVE '&"S  KG    E          (   #00013137' TO DFHEIV0
 15517     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15519     MOVE X'2020233030303133313337' TO DFHEIV0(25:11)
 15520     CALL 'kxdfhei1' USING DFHEIV0,
 15521           CLMS-FILE-ID,
 15522           DFHEIV20,
 15523           DFHEIV99,
 15524           MSTR-KEY,
 15525           ELMSTR-GENERIC-LENGTH,
 15526           DFHEIV99,
 15527           DFHEIV99
 15528     SET ADDRESS OF CLAIM-MASTER TO
 15529         DFHEIV20
 15530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15531
 15532
 15533     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15534
 15535     if cl-assoc-cert-total = 0
 15536        move 1 to cl-assoc-cert-total
 15537     end-if
 15538     IF CL-ASSOC-CERT-SEQU = 0
 15539        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15540     END-IF
 15541
 15542     IF CL-ASSOC-CERT-TOTAL = 1
 15543         MOVE AL-SADOF           TO BCERT1A
 15544                                    BSUFX1A
 15545                                    BCERT2A
 15546                                    BSUFX2A
 15547                                    BCERT3A
 15548                                    BSUFX3A
 15549                                    BCERT4A
 15550                                    BSUFX4A
 15551                                    BCERT5A
 15552                                    BSUFX5A
 15553                                    PCERTNOA
 15554                                    PSUFXA
 15555                                    LABEL1A
 15556                                    LABEL2A
 15557         GO TO 7699-EXIT.
 15558
 15559 7610-BROWSE-CLAIM-LOOP.
 15560
 15561     MOVE LOW-VALUES             TO BCERT1O
 15562                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 292
* EL131.cbl
 15563                                    BCERT2O
 15564                                    BSUFX2O
 15565                                    BCERT3O
 15566                                    BSUFX3O
 15567                                    BCERT4O
 15568                                    BSUFX4O
 15569                                    BCERT5O
 15570                                    BSUFX5O.
 15571
 15572
 15573* EXEC CICS HANDLE CONDITION
 15574*        ENDFILE  (7630-END-BROWSE)
 15575*    END-EXEC.
 15576*    MOVE '"$''                   ! D #00013185' TO DFHEIV0
 15577     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15579     MOVE X'4420233030303133313835' TO DFHEIV0(25:11)
 15580     CALL 'kxdfhei1' USING DFHEIV0
 15581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15582
 15583
 15584
 15585* EXEC CICS STARTBR
 15586*        DATASET    (CLMS-FILE-ID)
 15587*        RIDFLD     (MSTR-KEY)
 15588*    END-EXEC.
 15589     MOVE 0
 15590       TO DFHEIV11
 15591*    MOVE '&,         G          &   #00013189' TO DFHEIV0
 15592     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15593     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15594     MOVE X'2020233030303133313839' TO DFHEIV0(25:11)
 15595     CALL 'kxdfhei1' USING DFHEIV0,
 15596           CLMS-FILE-ID,
 15597           MSTR-KEY,
 15598           DFHEIV99,
 15599           DFHEIV11,
 15600           DFHEIV99
 15601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15602
 15603
 15604     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15605
 15606 7620-READ-CLAIM-LOOP.
 15607
 15608
 15609* EXEC CICS READNEXT
 15610*        DATASET   (CLMS-FILE-ID)
 15611*        SET       (ADDRESS OF CLAIM-MASTER)
 15612*        RIDFLD    (MSTR-KEY)
 15613*    END-EXEC.
 15614     MOVE 0
 15615       TO DFHEIV11
 15616*    MOVE '&.S                   )   #00013198' TO DFHEIV0
 15617     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15618     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15619     MOVE X'2020233030303133313938' TO DFHEIV0(25:11)
 15620     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 293
* EL131.cbl
 15621           CLMS-FILE-ID,
 15622           DFHEIV20,
 15623           DFHEIV99,
 15624           MSTR-KEY,
 15625           DFHEIV99,
 15626           DFHEIV11,
 15627           DFHEIV99,
 15628           DFHEIV99
 15629     SET ADDRESS OF CLAIM-MASTER TO
 15630         DFHEIV20
 15631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15632
 15633
 15634     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15635        CL-CARRIER     NOT = CARRI           OR
 15636        CL-CLAIM-NO    NOT = CLAIMI
 15637        GO TO 7630-END-BROWSE.
 15638
 15639     IF WS-ASSOCIATED-CERTS = 1
 15640         MOVE CL-CERT-PRIME      TO BCERT1O
 15641         MOVE CL-CERT-SFX        TO BSUFX1O.
 15642
 15643     IF WS-ASSOCIATED-CERTS = 2
 15644         MOVE CL-CERT-PRIME      TO BCERT2O
 15645         MOVE CL-CERT-SFX        TO BSUFX2O.
 15646
 15647     IF WS-ASSOCIATED-CERTS = 3
 15648         MOVE CL-CERT-PRIME      TO BCERT3O
 15649         MOVE CL-CERT-SFX        TO BSUFX3O.
 15650
 15651     IF WS-ASSOCIATED-CERTS = 4
 15652         MOVE CL-CERT-PRIME      TO BCERT4O
 15653         MOVE CL-CERT-SFX        TO BSUFX4O.
 15654
 15655     IF WS-ASSOCIATED-CERTS = 5
 15656         MOVE CL-CERT-PRIME      TO BCERT5O
 15657         MOVE CL-CERT-SFX        TO BSUFX5O
 15658     ELSE
 15659         ADD +1                  TO WS-ASSOCIATED-CERTS
 15660         GO TO 7620-READ-CLAIM-LOOP.
 15661
 15662 7630-END-BROWSE.
 15663
 15664
 15665* EXEC CICS ENDBR
 15666*        DATASET   (CLMS-FILE-ID)
 15667*    END-EXEC.
 15668     MOVE 0
 15669       TO DFHEIV11
 15670*    MOVE '&2                    $   #00013234' TO DFHEIV0
 15671     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15672     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15673     MOVE X'2020233030303133323334' TO DFHEIV0(25:11)
 15674     CALL 'kxdfhei1' USING DFHEIV0,
 15675           CLMS-FILE-ID,
 15676           DFHEIV11,
 15677           DFHEIV99
 15678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 294
* EL131.cbl
 15679
 15680
 15681 7640-HIGHLIGHT-CERT-DISPLAYED.
 15682
 15683     MOVE AL-SANON               TO BCERT1A
 15684                                    BSUFX1A
 15685                                    BCERT2A
 15686                                    BSUFX2A
 15687                                    BCERT3A
 15688                                    BSUFX3A
 15689                                    BCERT4A
 15690                                    BSUFX4A
 15691                                    BCERT5A
 15692                                    BSUFX5A.
 15693
 15694     IF BCERT1O = CERTI AND
 15695        BSUFX1O = SUFXI
 15696            MOVE AL-SABON        TO BCERT1A
 15697                                    BSUFX1A.
 15698
 15699     IF BCERT2O = CERTI AND
 15700        BSUFX2O = SUFXI
 15701            MOVE AL-SABON        TO BCERT2A
 15702                                    BSUFX2A.
 15703
 15704     IF BCERT3O = CERTI AND
 15705        BSUFX3O = SUFXI
 15706            MOVE AL-SABON        TO BCERT3A
 15707                                    BSUFX3A.
 15708
 15709     IF BCERT4O = CERTI AND
 15710        BSUFX4O = SUFXI
 15711            MOVE AL-SABON        TO BCERT4A
 15712                                    BSUFX4A.
 15713
 15714     IF BCERT5O = CERTI AND
 15715        BSUFX5O = SUFXI
 15716            MOVE AL-SABON        TO BCERT5A
 15717                                    BSUFX5A.
 15718
 15719 7699-EXIT.
 15720     EXIT.
 15721
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 295
* EL131.cbl
 15723 7700-CHECK-SEQUENCE.
 15724
 15725
 15726* EXEC CICS HANDLE CONDITION
 15727*        ENDFILE  (7799-EXIT)
 15728*        NOTFND   (7799-EXIT)
 15729*    END-EXEC.
 15730*    MOVE '"$''I                  ! E #00013282' TO DFHEIV0
 15731     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15733     MOVE X'4520233030303133323832' TO DFHEIV0(25:11)
 15734     CALL 'kxdfhei1' USING DFHEIV0
 15735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15736
 15737
 15738
 15739* EXEC CICS READ
 15740*        DATASET(CLMS-FILE-ID)
 15741*        SET    (ADDRESS OF CLAIM-MASTER)
 15742*        RIDFLD (MSTR-KEY)
 15743*        GENERIC
 15744*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15745*    END-EXEC.
 15746*    MOVE '&"S  KG    E          (   #00013287' TO DFHEIV0
 15747     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15749     MOVE X'2020233030303133323837' TO DFHEIV0(25:11)
 15750     CALL 'kxdfhei1' USING DFHEIV0,
 15751           CLMS-FILE-ID,
 15752           DFHEIV20,
 15753           DFHEIV99,
 15754           MSTR-KEY,
 15755           ELMSTR-GENERIC-LENGTH,
 15756           DFHEIV99,
 15757           DFHEIV99
 15758     SET ADDRESS OF CLAIM-MASTER TO
 15759         DFHEIV20
 15760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15761
 15762
 15763     COMPUTE WS-ASSOC-CERT-TOTAL =
 15764             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15765
 15766     GO TO 7799-EXIT.
 15767
 15768 7710-RESEQUENCE-CLAIMS.
 15769
 15770
 15771* EXEC CICS HANDLE CONDITION
 15772*        ENDFILE  (7799-EXIT)
 15773*    END-EXEC.
 15774*    MOVE '"$''                   ! F #00013302' TO DFHEIV0
 15775     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15777     MOVE X'4620233030303133333032' TO DFHEIV0(25:11)
 15778     CALL 'kxdfhei1' USING DFHEIV0
 15779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15780
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 296
* EL131.cbl
 15781
 15782
 15783* EXEC CICS STARTBR
 15784*        DATASET(CLMS-FILE-ID)
 15785*        RIDFLD (MSTR-KEY)
 15786*    END-EXEC.
 15787     MOVE 0
 15788       TO DFHEIV11
 15789*    MOVE '&,         G          &   #00013306' TO DFHEIV0
 15790     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15791     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15792     MOVE X'2020233030303133333036' TO DFHEIV0(25:11)
 15793     CALL 'kxdfhei1' USING DFHEIV0,
 15794           CLMS-FILE-ID,
 15795           MSTR-KEY,
 15796           DFHEIV99,
 15797           DFHEIV11,
 15798           DFHEIV99
 15799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15800
 15801
 15802     COMPUTE WS-ASSOC-CERT-SEQU =
 15803             WS-ASSOC-CERT-SEQU + 1.
 15804
 15805     COMPUTE WS-READNEXT-SWITCH =
 15806             WS-READNEXT-SWITCH + 1.
 15807
 15808 7720-READ-CLAIM-LOOP.
 15809
 15810
 15811* EXEC CICS READNEXT
 15812*        DATASET(CLMS-FILE-ID)
 15813*        SET    (ADDRESS OF CLAIM-MASTER)
 15814*        RIDFLD (MSTR-KEY)
 15815*    END-EXEC.
 15816     MOVE 0
 15817       TO DFHEIV11
 15818*    MOVE '&.S                   )   #00013319' TO DFHEIV0
 15819     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15820     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15821     MOVE X'2020233030303133333139' TO DFHEIV0(25:11)
 15822     CALL 'kxdfhei1' USING DFHEIV0,
 15823           CLMS-FILE-ID,
 15824           DFHEIV20,
 15825           DFHEIV99,
 15826           MSTR-KEY,
 15827           DFHEIV99,
 15828           DFHEIV11,
 15829           DFHEIV99,
 15830           DFHEIV99
 15831     SET ADDRESS OF CLAIM-MASTER TO
 15832         DFHEIV20
 15833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15834
 15835
 15836     IF WS-READNEXT-SWITCH = 1
 15837         ADD 1                   TO WS-READNEXT-SWITCH
 15838         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 297
* EL131.cbl
 15839
 15840 7730-END-BROWSE.
 15841
 15842
 15843* EXEC CICS ENDBR
 15844*        DATASET(CLMS-FILE-ID)
 15845*    END-EXEC.
 15846     MOVE 0
 15847       TO DFHEIV11
 15848*    MOVE '&2                    $   #00013331' TO DFHEIV0
 15849     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15850     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303133333331' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           CLMS-FILE-ID,
 15854           DFHEIV11,
 15855           DFHEIV99
 15856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15857
 15858
 15859 7740-READ-CLAIM-UPDATE.
 15860
 15861     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15862        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15863        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15864        GO TO 7799-EXIT
 15865     ELSE
 15866        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15867
 15868
 15869* EXEC CICS READ
 15870*        DATASET(CLMS-FILE-ID)
 15871*        SET    (ADDRESS OF CLAIM-MASTER)
 15872*        RIDFLD (MSTR-KEY)
 15873*        UPDATE
 15874*    END-EXEC.
 15875*    MOVE '&"S        EU         (   #00013344' TO DFHEIV0
 15876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15877     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15878     MOVE X'2020233030303133333434' TO DFHEIV0(25:11)
 15879     CALL 'kxdfhei1' USING DFHEIV0,
 15880           CLMS-FILE-ID,
 15881           DFHEIV20,
 15882           DFHEIV99,
 15883           MSTR-KEY,
 15884           DFHEIV99,
 15885           DFHEIV99,
 15886           DFHEIV99
 15887     SET ADDRESS OF CLAIM-MASTER TO
 15888         DFHEIV20
 15889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15890
 15891
 15892     if (cl-priority-cd = '8')
 15893        and (pi-processor-id not = 'PEMA' and 'JMS '
 15894             AND 'AMWA')
 15895        MOVE ER-8003             TO EMI-ERROR
 15896        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 298
* EL131.cbl
 15897                                 THRU 9900-EXIT
 15898        MOVE -1                  TO MAINTL
 15899        GO TO 8110-SEND-DATA
 15900     end-if
 15901
 15902     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15903         MOVE 'Y'                TO CL-YESNOSW
 15904     END-IF.
 15905
 15906     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15907     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15908
 15909
 15910* EXEC CICS REWRITE
 15911*         DATASET(CLMS-FILE-ID)
 15912*         FROM   (CLAIM-MASTER)
 15913*    END-EXEC.
 15914     MOVE LENGTH OF
 15915      CLAIM-MASTER
 15916       TO DFHEIV11
 15917*    MOVE '&& L                  %   #00013368' TO DFHEIV0
 15918     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15919     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15920     MOVE X'2020233030303133333638' TO DFHEIV0(25:11)
 15921     CALL 'kxdfhei1' USING DFHEIV0,
 15922           CLMS-FILE-ID,
 15923           CLAIM-MASTER,
 15924           DFHEIV11,
 15925           DFHEIV99
 15926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15927
 15928
 15929     GO TO 7710-RESEQUENCE-CLAIMS.
 15930
 15931 7799-EXIT.
 15932     EXIT.
 15933
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 299
* EL131.cbl
 15935 7800-CHECK-AUTO-ACTIVITY.
 15936
 15937
 15938* EXEC CICS HANDLE CONDITION
 15939*        NOTFND   (7800-NOT-FOUND)
 15940*    END-EXEC.
 15941*    MOVE '"$I                   ! G #00013381' TO DFHEIV0
 15942     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15944     MOVE X'4720233030303133333831' TO DFHEIV0(25:11)
 15945     CALL 'kxdfhei1' USING DFHEIV0
 15946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15947
 15948
 15949     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15950     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15951     MOVE SPACES                     TO  CNTL-PROC-ID.
 15952     MOVE +0                         TO  CNTL-SEQ-NO.
 15953
 15954
 15955* EXEC CICS READ
 15956*        DATASET   (CNTL-FILE-ID)
 15957*        RIDFLD    (CNTL-KEY)
 15958*        SET       (ADDRESS OF CONTROL-FILE)
 15959*    END-EXEC.
 15960*    MOVE '&"S        E          (   #00013390' TO DFHEIV0
 15961     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15962     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15963     MOVE X'2020233030303133333930' TO DFHEIV0(25:11)
 15964     CALL 'kxdfhei1' USING DFHEIV0,
 15965           CNTL-FILE-ID,
 15966           DFHEIV20,
 15967           DFHEIV99,
 15968           CNTL-KEY,
 15969           DFHEIV99,
 15970           DFHEIV99,
 15971           DFHEIV99
 15972     SET ADDRESS OF CONTROL-FILE TO
 15973         DFHEIV20
 15974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15975
 15976
 15977     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15978         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15979
 15980     IF CL-ACTIVITY-CODE NOT = ZEROS
 15981         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15982         IF MISC-SUB IS GREATER THAN +9
 15983             SUBTRACT +9 FROM MISC-SUB
 15984             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15985         ELSE
 15986             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15987     ELSE
 15988         MOVE 'Y'                              TO  WS-RESET-SW.
 15989
 15990     IF STATUSI = 'C' OR 'CLOSED'
 15991         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15992             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 300
* EL131.cbl
 15993                                         PI-LETTER-SW
 15994             GO TO 7800-EXIT.
 15995
 15996     IF STATUSI = 'C' OR 'CLOSED'
 15997         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15998             MOVE 'N'                TO  PI-LETTER-SW
 15999         ELSE
 16000             MOVE 'Y'                TO  PI-LETTER-SW.
 16001
 16002     IF STATUSI = 'O' OR 'OPEN'
 16003         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16004             MOVE 'N'                TO  PI-REC-FOUND-SW
 16005                                         PI-LETTER-SW
 16006             GO TO 7800-EXIT.
 16007
 16008     IF STATUSI = 'O' OR 'OPEN'
 16009         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16010             MOVE 'N'                TO  PI-LETTER-SW
 16011         ELSE
 16012             MOVE 'Y'                TO  PI-LETTER-SW.
 16013
 16014     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16015     GO TO 7800-EXIT.
 16016
 16017 7800-NOT-FOUND.
 16018
 16019     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16020                                         PI-LETTER-SW.
 16021
 16022 7800-EXIT.
 16023     EXIT.
 16024
 16025 7850-AUTO-LETTER-WRITER.
 16026
 16027     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16028     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16029
 16030     IF STATUSI = 'C' OR 'CLOSED'
 16031         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16032     ELSE
 16033         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16034
 16035     IF STATUSI = 'C' OR 'CLOSED'
 16036         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16037             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16038             MOVE '6'                TO  DC-OPTION-CODE
 16039             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16040             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16041             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16042             IF NO-CONVERSION-ERROR
 16043                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16044             ELSE
 16045                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16046
 16047     IF STATUSI = 'C' OR 'CLOSED'
 16048         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16049             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16050             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 301
* EL131.cbl
 16051             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16052             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16053             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16054             IF NO-CONVERSION-ERROR
 16055                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16056             ELSE
 16057                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16058
 16059     IF STATUSI = 'O' OR 'OPEN'
 16060         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16061             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16062             MOVE '6'                TO  DC-OPTION-CODE
 16063             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16064             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16065             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16066             IF NO-CONVERSION-ERROR
 16067                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16068             ELSE
 16069                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16070
 16071     IF STATUSI = 'O' OR 'OPEN'
 16072         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16073             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16074             MOVE '6'                TO  DC-OPTION-CODE
 16075             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16076             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16077             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16078             IF NO-CONVERSION-ERROR
 16079                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16080             ELSE
 16081                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16082
 16083
 16084* EXEC CICS LINK
 16085*        PROGRAM    (LINK-1523)
 16086*        COMMAREA   (W-1523-LINKDATA)
 16087*        LENGTH     (W-1523-COMM-LENGTH)
 16088*    END-EXEC.
 16089*    MOVE '."C                   (   #00013502' TO DFHEIV0
 16090     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16092     MOVE X'2020233030303133353032' TO DFHEIV0(25:11)
 16093     CALL 'kxdfhei1' USING DFHEIV0,
 16094           LINK-1523,
 16095           W-1523-LINKDATA,
 16096           W-1523-COMM-LENGTH,
 16097           DFHEIV99,
 16098           DFHEIV99,
 16099           DFHEIV99,
 16100           DFHEIV99
 16101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16102
 16103
 16104     IF W-1523-ERROR-CODE = ZEROS
 16105         GO TO 7850-EXIT.
 16106
 16107     IF W-1523-FATAL-ERROR
 16108         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 302
* EL131.cbl
 16109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16110
 16111     IF W-1523-ERROR-CODE = 0191
 16112         MOVE ER-0803                TO  EMI-ERROR
 16113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16114
 16115 7850-EXIT.
 16116     EXIT.
 16117
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 303
* EL131.cbl
 16119 8000-CREATE-DMO-REC.
 16120     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16121     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16122     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16123
 16124
 16125* EXEC CICS HANDLE CONDITION
 16126*         NOTFND   (8000-NOTE-NOT-FOUND)
 16127*    END-EXEC.
 16128*    MOVE '"$I                   ! H #00013528' TO DFHEIV0
 16129     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16131     MOVE X'4820233030303133353238' TO DFHEIV0(25:11)
 16132     CALL 'kxdfhei1' USING DFHEIV0
 16133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16134
 16135
 16136
 16137* EXEC CICS READ
 16138*         DATASET(NOTE-FILE-ID)
 16139*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16140*         RIDFLD (NOTE-KEY)
 16141*    END-EXEC.
 16142*    MOVE '&"S        E          (   #00013532' TO DFHEIV0
 16143     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16145     MOVE X'2020233030303133353332' TO DFHEIV0(25:11)
 16146     CALL 'kxdfhei1' USING DFHEIV0,
 16147           NOTE-FILE-ID,
 16148           DFHEIV20,
 16149           DFHEIV99,
 16150           NOTE-KEY,
 16151           DFHEIV99,
 16152           DFHEIV99,
 16153           DFHEIV99
 16154     SET ADDRESS OF CERTIFICATE-NOTE TO
 16155         DFHEIV20
 16156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16157
 16158
 16159     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16160     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16161     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16162
 16163     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16164         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16165     ELSE
 16166         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16167
 16168     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16169     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16170
 16171
 16172* EXEC CICS LINK
 16173*        PROGRAM    ('DLO006')
 16174*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16175*        LENGTH     (WS-DCT-LENGTH)
 16176*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 304
* EL131.cbl
 16177     MOVE 'DLO006' TO DFHEIV1
 16178*    MOVE '."C                   (   #00013550' TO DFHEIV0
 16179     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16181     MOVE X'2020233030303133353530' TO DFHEIV0(25:11)
 16182     CALL 'kxdfhei1' USING DFHEIV0,
 16183           DFHEIV1,
 16184           DCT-COMMUNICATION-AREA,
 16185           WS-DCT-LENGTH,
 16186           DFHEIV99,
 16187           DFHEIV99,
 16188           DFHEIV99,
 16189           DFHEIV99
 16190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16191
 16192
 16193     IF  DCT-RETURN-CODE = 'OK'
 16194         GO TO 8000-CONT.
 16195
 16196     IF DCT-RETURN-CODE = '01' OR '02'
 16197         GO TO 8000-EXIT.
 16198
 16199     IF DCT-RETURN-CODE = '03'
 16200         MOVE ER-0951            TO EMI-ERROR
 16201         MOVE -1                 TO MAINTL
 16202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16203         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16204         GO TO 8110-SEND-DATA.
 16205
 16206     IF DCT-RETURN-CODE = '04'
 16207         MOVE ER-0946            TO EMI-ERROR
 16208         MOVE -1                 TO MAINTL
 16209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16210         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16211         GO TO 8110-SEND-DATA.
 16212
 16213     IF DCT-RETURN-CODE = '05'
 16214         MOVE ER-0947            TO EMI-ERROR
 16215         MOVE -1                 TO MAINTL
 16216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16217         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16218         GO TO 8110-SEND-DATA.
 16219
 16220     IF DCT-RETURN-CODE = '06'
 16221         MOVE ER-0921            TO EMI-ERROR
 16222         MOVE -1                 TO MAINTL
 16223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16224         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16225         GO TO 8110-SEND-DATA.
 16226
 16227     IF DCT-RETURN-CODE = '07'
 16228         MOVE ER-0919            TO EMI-ERROR
 16229         MOVE -1                 TO MAINTL
 16230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16231         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16232         GO TO 8110-SEND-DATA.
 16233
 16234     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 305
* EL131.cbl
 16235         MOVE ER-0948            TO EMI-ERROR
 16236         MOVE -1                 TO MAINTL
 16237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16238         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16239         GO TO 8110-SEND-DATA.
 16240
 16241     IF DCT-RETURN-CODE = 'N1'
 16242         MOVE ER-0950            TO EMI-ERROR
 16243         MOVE -1                 TO MAINTL
 16244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16245         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16246         GO TO 8110-SEND-DATA.
 16247
 16248     IF DCT-RETURN-CODE = 'E1'
 16249         MOVE ER-0974            TO EMI-ERROR
 16250         MOVE -1                 TO MAINTL
 16251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16252         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16253         GO TO 8110-SEND-DATA.
 16254
 16255     IF DCT-RETURN-CODE = 'E2'
 16256         MOVE ER-0975            TO EMI-ERROR
 16257         MOVE -1                 TO MAINTL
 16258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16259         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16260         GO TO 8110-SEND-DATA.
 16261
 16262     IF DCT-RETURN-CODE NOT = 'OK'
 16263         MOVE ER-0949            TO EMI-ERROR
 16264         MOVE -1                 TO MAINTL
 16265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16266         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16267         GO TO 8110-SEND-DATA.
 16268
 16269 8000-CONT.
 16270
 16271     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16272     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16273     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16274     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16275     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16276     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16277     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16278     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16279
 16280     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16281     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16282     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16283     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16284     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16285
 16286     IF STATUSI = 'OPEN' OR 'O'
 16287         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16288      ELSE
 16289         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16290
 16291     IF STATUSI = 'OPEN' OR 'O'
 16292        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 306
* EL131.cbl
 16293         MOVE '1'                TO DM-CLAIM-STATUS
 16294      ELSE
 16295         MOVE '2'                TO DM-CLAIM-STATUS.
 16296
 16297     IF STATUSI = 'CLOSED' OR 'C'
 16298        IF NOT FINAL-PAID
 16299         MOVE '3'                TO DM-CLAIM-STATUS
 16300      ELSE
 16301         MOVE '4'                TO DM-CLAIM-STATUS.
 16302
 16303     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16304
 16305
 16306* EXEC CICS LINK
 16307*        PROGRAM    ('DLO025')
 16308*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16309*        LENGTH     (WS-DMO-LENGTH)
 16310*    END-EXEC.
 16311     MOVE 'DLO025' TO DFHEIV1
 16312*    MOVE '."C                   (   #00013668' TO DFHEIV0
 16313     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16315     MOVE X'2020233030303133363638' TO DFHEIV0(25:11)
 16316     CALL 'kxdfhei1' USING DFHEIV0,
 16317           DFHEIV1,
 16318           DMO-COMMUNICATION-AREA,
 16319           WS-DMO-LENGTH,
 16320           DFHEIV99,
 16321           DFHEIV99,
 16322           DFHEIV99,
 16323           DFHEIV99
 16324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16325
 16326
 16327     IF  DM-RETURN-CODE = 'OK'
 16328         GO TO 8000-EXIT.
 16329
 16330     IF DM-RETURN-CODE = '01'
 16331         MOVE ER-8051            TO EMI-ERROR
 16332         MOVE -1                 TO MAINTL
 16333         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16334         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16335         GO TO 8110-SEND-DATA.
 16336
 16337     IF DM-RETURN-CODE = '02'
 16338         MOVE ER-8052            TO EMI-ERROR
 16339         MOVE -1                 TO MAINTL
 16340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16341         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16342         GO TO 8110-SEND-DATA.
 16343
 16344     IF DM-RETURN-CODE = '03'
 16345         MOVE ER-8053            TO EMI-ERROR
 16346         MOVE -1                 TO MAINTL
 16347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16348         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16349         GO TO 8110-SEND-DATA.
 16350
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 307
* EL131.cbl
 16351     IF DM-RETURN-CODE = '04'
 16352         MOVE ER-8054            TO EMI-ERROR
 16353         MOVE -1                 TO MAINTL
 16354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16355         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16356         GO TO 8110-SEND-DATA.
 16357
 16358     IF DM-RETURN-CODE = '05'
 16359         MOVE ER-8055            TO EMI-ERROR
 16360         MOVE -1                 TO MAINTL
 16361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16362         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16363         GO TO 8110-SEND-DATA.
 16364
 16365     IF DM-RETURN-CODE = '06'
 16366         MOVE ER-8056            TO EMI-ERROR
 16367         MOVE -1                 TO MAINTL
 16368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16369         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16370         GO TO 8110-SEND-DATA.
 16371
 16372     IF DM-RETURN-CODE = '07'
 16373         MOVE ER-8057            TO EMI-ERROR
 16374         MOVE -1                 TO MAINTL
 16375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16376         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16377         GO TO 8110-SEND-DATA.
 16378
 16379     IF DM-RETURN-CODE = '08'
 16380         MOVE ER-8058            TO EMI-ERROR
 16381         MOVE -1                 TO MAINTL
 16382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16383         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16384         GO TO 8110-SEND-DATA.
 16385
 16386     IF DM-RETURN-CODE = '09'
 16387         MOVE ER-8059            TO EMI-ERROR
 16388         MOVE -1                 TO MAINTL
 16389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16390         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16391         GO TO 8110-SEND-DATA.
 16392
 16393     IF DM-RETURN-CODE = '10'
 16394         MOVE ER-8060            TO EMI-ERROR
 16395         MOVE -1                 TO MAINTL
 16396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16397         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16398         GO TO 8110-SEND-DATA.
 16399
 16400     IF DM-RETURN-CODE = '11'
 16401         MOVE ER-8061            TO EMI-ERROR
 16402         MOVE -1                 TO MAINTL
 16403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16404         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16405         GO TO 8110-SEND-DATA.
 16406
 16407     IF DM-RETURN-CODE = '12'
 16408         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 308
* EL131.cbl
 16409         MOVE -1                 TO MAINTL
 16410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16411         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16412         GO TO 8110-SEND-DATA.
 16413
 16414     IF DM-RETURN-CODE = '13'
 16415         MOVE ER-8063            TO EMI-ERROR
 16416         MOVE -1                 TO MAINTL
 16417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16418         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16419         GO TO 8110-SEND-DATA.
 16420
 16421     IF DM-RETURN-CODE = '14'
 16422         MOVE ER-8064            TO EMI-ERROR
 16423         MOVE -1                 TO MAINTL
 16424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16425         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16426         GO TO 8110-SEND-DATA.
 16427
 16428     IF DM-RETURN-CODE = '15'
 16429         MOVE ER-8065            TO EMI-ERROR
 16430         MOVE -1                 TO MAINTL
 16431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16432         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16433         GO TO 8110-SEND-DATA.
 16434
 16435     IF DM-RETURN-CODE = '16'
 16436         MOVE ER-8154            TO EMI-ERROR
 16437         MOVE -1                 TO MAINTL
 16438         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16439         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16440         GO TO 8110-SEND-DATA.
 16441
 16442     IF DM-RETURN-CODE = '17'
 16443         MOVE ER-8155            TO EMI-ERROR
 16444         MOVE -1                 TO MAINTL
 16445         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16446         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16447         GO TO 8110-SEND-DATA.
 16448
 16449     IF DM-RETURN-CODE = 'N1'
 16450         MOVE ER-8152            TO EMI-ERROR
 16451         MOVE -1                 TO MAINTL
 16452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16453         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16454         GO TO 8110-SEND-DATA.
 16455
 16456     IF DM-RETURN-CODE = 'E1'
 16457         MOVE ER-8153            TO EMI-ERROR
 16458         MOVE -1                 TO MAINTL
 16459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16460         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16461         GO TO 8110-SEND-DATA.
 16462
 16463     MOVE ER-8066                TO EMI-ERROR.
 16464     MOVE -1                     TO MAINTL.
 16465     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16466     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 309
* EL131.cbl
 16467     GO TO 8110-SEND-DATA.
 16468
 16469 8000-NOTE-NOT-FOUND.
 16470
 16471* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16472*    MOVE '6"R                   !   #00013817' TO DFHEIV0
 16473     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16475     MOVE X'2020233030303133383137' TO DFHEIV0(25:11)
 16476     CALL 'kxdfhei1' USING DFHEIV0
 16477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16478
 16479     MOVE ER-0954                TO EMI-ERROR.
 16480     MOVE -1                     TO MAINTL.
 16481     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16482     GO TO 8110-SEND-DATA.
 16483
 16484 8000-EXIT.
 16485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 310
* EL131.cbl
 16487 8050-FORMAT-LAST-NAME-1ST.
 16488*****************************************************************
 16489*             M O V E   N A M E   R O U T I N E                 *
 16490*                                                               *
 16491*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16492*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16493*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16494*                                                               *
 16495*                  FIELD               VALUE                    *
 16496*                  -----               -----                    *
 16497*           W-NAME-LAST    (CL15)      SMITH                    *
 16498*           W-NAME-FIRST   (CL15)      JOHN                     *
 16499*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16500*                                                               *
 16501*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16502*                SMITH, JOHN ALLEN                              *
 16503*                     OR                                        *
 16504*                SMITH, JOHN A.                                 *
 16505*                                                               *
 16506*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16507*     COPYBOOK, ELCNWA.                                         *
 16508*****************************************************************.
 16509
 16510     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16511     MOVE ZERO                   TO WS-NAME-SW.
 16512     SET NWA-INDEX               TO +1.
 16513
 16514     IF W-NAME-LAST   = SPACES  AND
 16515        W-NAME-MIDDLE = SPACES
 16516          MOVE +1                TO WS-NAME-SW.
 16517
 16518     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16519     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16520
 16521     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16522     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16523
 16524     SET NWA-INDEX UP BY +1.
 16525
 16526     IF W-NAME-MIDDLE NOT = SPACES
 16527         IF W-NAME-MIDDLE-2 = SPACES
 16528             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16529             SET NWA-INDEX UP BY +1
 16530             MOVE '.'            TO WS-NW (NWA-INDEX)
 16531             SET NWA-INDEX UP BY +2
 16532         ELSE
 16533             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16534             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16535
 16536 8050-EXIT.
 16537     EXIT.
 16538
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 311
* EL131.cbl
 16540 8060-MOVE-NAME.
 16541     IF WS-NAME-SW GREATER THAN +1
 16542         GO TO 8060-EXIT.
 16543
 16544     IF WS-NAME-WORK2 = SPACES
 16545         GO TO 8060-EXIT.
 16546
 16547     SET NWA-INDEX2            TO +1.
 16548     SET NWA-INDEX3            TO +2.
 16549
 16550 8060-MOVE-NAME-CYCLE.
 16551     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16552
 16553     IF NWA-INDEX LESS THAN +30
 16554         SET NWA-INDEX UP BY +1
 16555     ELSE
 16556         ADD +2 TO  WS-NAME-SW
 16557         GO TO 8060-EXIT.
 16558
 16559     IF NWA-INDEX2 LESS THAN +20
 16560         SET NWA-INDEX3 UP BY +1
 16561         SET NWA-INDEX2 UP BY +1.
 16562
 16563     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16564        WS-NW2 (NWA-INDEX3) = SPACES
 16565         IF WS-NAME-SW = ZERO
 16566             MOVE ','            TO WS-NW (NWA-INDEX)
 16567             SET NWA-INDEX UP BY +2
 16568             MOVE +1             TO WS-NAME-SW
 16569             GO TO 8060-EXIT
 16570         ELSE
 16571             GO TO 8060-EXIT.
 16572
 16573     GO TO 8060-MOVE-NAME-CYCLE.
 16574
 16575 8060-EXIT.
 16576     EXIT.
 16577
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 312
* EL131.cbl
 16579
 16580 8070-UNLOCK-CLAIM-MSTR.
 16581
 16582* EXEC CICS UNLOCK
 16583*        DATASET   (CLMS-FILE-ID)
 16584*    END-EXEC.
 16585*    MOVE '&*                    #   #00013920' TO DFHEIV0
 16586     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16587     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16588     MOVE X'2020233030303133393230' TO DFHEIV0(25:11)
 16589     CALL 'kxdfhei1' USING DFHEIV0,
 16590           CLMS-FILE-ID,
 16591           DFHEIV99
 16592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16593
 16594
 16595 8070-EXIT.
 16596      EXIT.
 16597
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 313
* EL131.cbl
 16599 8100-SEND-MAP.
 16600     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16601
 16602     move al-uanon               to accswa
 16603     IF NOT PI-NO-CARRIER-SECURITY
 16604        MOVE AL-SANOF            TO CERTCARA.
 16605     IF NOT PI-NO-ACCOUNT-SECURITY
 16606        MOVE AL-SANOF            TO CERTACTA.
 16607
 16608     IF PI-PROCESSOR-ID = 'LGXX'
 16609        MOVE AL-UANON            TO CCNOA.
 16610
 16611     IF PI-COMPANY-ID = 'DMD'
 16612        NEXT SENTENCE
 16613     ELSE
 16614        MOVE AL-SADOF            TO PFKEY6A.
 16615
 16616     IF PI-USES-PAID-TO
 16617        MOVE 'PAID TO  :' TO PTHRHDGO.
 16618
 16619
 16620* EXEC CICS SEND
 16621*         MAP     ('EL131A')
 16622*         MAPSET  ('EL131S')
 16623*         ERASE
 16624*         FREEKB
 16625*         CURSOR
 16626*    END-EXEC.
 16627     MOVE 'EL131A' TO DFHEIV1
 16628     MOVE -1
 16629       TO DFHEIV11
 16630     MOVE 'EL131S' TO DFHEIV2
 16631*    MOVE '8$     CT  E F  H     ,   #00013948' TO DFHEIV0
 16632     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16633     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16634     MOVE X'2020233030303133393438' TO DFHEIV0(25:11)
 16635     CALL 'kxdfhei1' USING DFHEIV0,
 16636           DFHEIV1,
 16637           EL131AO,
 16638           DFHEIV99,
 16639           DFHEIV2,
 16640           DFHEIV99,
 16641           DFHEIV99,
 16642           DFHEIV99,
 16643           DFHEIV11,
 16644           DFHEIV99,
 16645           DFHEIV99,
 16646           DFHEIV99
 16647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16648
 16649
 16650     GO TO 9000-RETURN-TRANS.
 16651
 16652 8110-SEND-DATA.
 16653     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16654
 16655     IF PI-USES-PAID-TO
 16656        MOVE 'PAID TO  :' TO PTHRHDGO.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 314
* EL131.cbl
 16657
 16658     IF PI-PROCESSOR-ID = 'LGXX'
 16659        MOVE AL-UANON            TO CCNOA.
 16660
 16661     IF PI-COMPANY-ID = 'DMD'
 16662        NEXT SENTENCE
 16663     ELSE
 16664        MOVE AL-SADOF            TO PFKEY6A.
 16665
 16666
 16667* EXEC CICS SEND
 16668*         MAP      ('EL131A')
 16669*         MAPSET   ('EL131S')
 16670*         DATAONLY
 16671*         FREEKB
 16672*         CURSOR
 16673*    END-EXEC.
 16674     MOVE 'EL131A' TO DFHEIV1
 16675     MOVE -1
 16676       TO DFHEIV11
 16677     MOVE 'EL131S' TO DFHEIV2
 16678*    MOVE '8$D    CT    F  H     ,   #00013972' TO DFHEIV0
 16679     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16680     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16681     MOVE X'2020233030303133393732' TO DFHEIV0(25:11)
 16682     CALL 'kxdfhei1' USING DFHEIV0,
 16683           DFHEIV1,
 16684           EL131AO,
 16685           DFHEIV99,
 16686           DFHEIV2,
 16687           DFHEIV99,
 16688           DFHEIV99,
 16689           DFHEIV99,
 16690           DFHEIV11,
 16691           DFHEIV99,
 16692           DFHEIV99,
 16693           DFHEIV99
 16694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16695
 16696
 16697     GO TO 9000-RETURN-TRANS.
 16698
 16699 8120-FORMAT-TIME-DATE.
 16700     perform 8140-check-for-prev-errors
 16701                                 thru 8140-exit
 16702     IF SKIP-ATTRIBUTE = 'Y'
 16703        MOVE SPACES              TO SKIP-ATTRIBUTE
 16704        MOVE ER-0598             TO EMI-ERROR
 16705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16706        GO TO 8125-SKIP-ATTRIBUTE.
 16707
 16708*     IF PI-COMPANY-ID = 'DMD'
 16709      IF PI-PROCESSOR-ID <> 'EMER'
 16710         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16711                                    CERTCARA  CERTGRPA CERTA SUFXA
 16712
 16713     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16714                                    ISSAGEA   JNTLNMEA  JNTFNMEA
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 315
* EL131.cbl
 16715                                    JNTINITA  JNTAGEA   APRA
 16716                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16717                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16718                                    LCVEXITA  LCVSTATA  LCVKINDA
 16719                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16720                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16721                                    ACVEXITA  ACVSTATA  ACVKINDA
 16722                                    PMTFREQA  INDGRPA   PREMTYPA
 16723                                    REINCDA   LCVRATEA  ACVRATEA
 16724                                    ADDONDTA.
 16725
 16726*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16727*       IF PI-COMPANY-ID = 'DMD'
 16728*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16729*                                   SUFXA
 16730*                                   PDAMTA    NODAYSA   NOPMTSA
 16731*                                   INCA      OCCA
 16732*          IF NOT SYSTEM-MODIFY-CAP
 16733*              MOVE AL-SANOF         TO PDTHRUA.
 16734
 16735     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16736         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16737
 16738 8125-SKIP-ATTRIBUTE.
 16739
 16740     MOVE SAVE-DATE              TO DATEO.
 16741
 16742* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16743*    END-EXEC
 16744*    MOVE '0"A                   "   #00014024' TO DFHEIV0
 16745     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16746     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16747     MOVE X'2020233030303134303234' TO DFHEIV0(25:11)
 16748     CALL 'kxdfhei1' USING DFHEIV0,
 16749           LCP-CICS-TIME
 16750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16751
 16752* EXEC CICS FORMATTIME
 16753*              ABSTIME(LCP-CICS-TIME)
 16754*              TIME(LCP-TIME-OF-DAY-XX)
 16755*    END-EXEC
 16756*    MOVE 'j$(     (             #   #00014026' TO DFHEIV0
 16757     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16758     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16759     MOVE X'2020233030303134303236' TO DFHEIV0(25:11)
 16760     CALL 'kxdfhei1' USING DFHEIV0,
 16761           LCP-CICS-TIME,
 16762           LCP-TIME-OF-DAY-XX
 16763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16764     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16765     MOVE UN-HOURS               TO FOR-HOURS.
 16766     MOVE UN-MINUTES             TO FOR-MINUTES.
 16767     MOVE TIME-OUT               TO TIMEO.
 16768     MOVE PI-COMPANY-ID          TO COMPO.
 16769     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16770     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16771     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16772     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 316
* EL131.cbl
 16773     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16774
 16775 8130-EXIT.
 16776     EXIT.
 16777
 16778 8140-check-for-prev-errors.
 16779
 16780     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16781     MOVE PI-CARRIER             TO trlr-carrier
 16782     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16783     MOVE PI-CERT-NO             TO trlr-cert-no
 16784     MOVE +95                    TO TRLR-SEQ-NO
 16785
 16786
 16787* EXEC CICS READ
 16788*       DATASET  ('ELTRLR')
 16789*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16790*       RIDFLD   (TRLR-KEY)
 16791*       RESP     (WS-RESPONSE)
 16792*    END-EXEC
 16793     MOVE 'ELTRLR' TO DFHEIV1
 16794*    MOVE '&"S        E          (  N#00014052' TO DFHEIV0
 16795     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16797     MOVE X'204E233030303134303532' TO DFHEIV0(25:11)
 16798     CALL 'kxdfhei1' USING DFHEIV0,
 16799           DFHEIV1,
 16800           DFHEIV20,
 16801           DFHEIV99,
 16802           TRLR-KEY,
 16803           DFHEIV99,
 16804           DFHEIV99,
 16805           DFHEIV99
 16806     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16807         DFHEIV20
 16808     MOVE EIBRESP  TO WS-RESPONSE
 16809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16810
 16811     if ws-resp-normal
 16812        perform varying s1 from +1 by +1 until
 16813           at-note-error-no (s1) = spaces
 16814           if at-note-error-no (s1) = '1652'
 16815              continue
 16816           else
 16817              move at-note-error-no (s1)
 16818                                 to emi-error
 16819              move -1 to maintl
 16820              if at-note-error-no (s1) = '1653'
 16821                 evaluate true
 16822                    when pi-claim-type = 'L'
 16823                       move '  LF  '
 16824                        to emi-claim-type
 16825                    when pi-claim-type = 'I'
 16826                       move '  IU  '
 16827                        to emi-claim-type
 16828                    WHEN PI-CLAIM-TYPE = 'F'
 16829                       MOVE '  FL  '
 16830                        TO EMI-CLAIM-TYPE
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 317
* EL131.cbl
 16831                    when other
 16832                       move '  AH  '
 16833                        to emi-claim-type
 16834                 end-evaluate
 16835              end-if
 16836              PERFORM 9900-ERROR-FORMAT
 16837                                 THRU 9900-EXIT
 16838           end-if
 16839*          if at-note-error-no (s1) = '1653'
 16840*             perform varying emi-sub from 1 by 1 until
 16841*                emi-sub > 3
 16842*                if emi-error-number (emi-sub) = '1653'
 16843*                   evaluate true
 16844*                      when pi-claim-type = 'L'
 16845*                         move '  LF  '
 16846*                          to emi-claim-type
 16847*                      when pi-claim-type = 'I'
 16848*                         move '  IU  '
 16849*                          to emi-claim-type
 16850*                      when other
 16851*                         move '  AH  '
 16852*                          to emi-claim-type
 16853*                   end-evaluate
 16854*                end-if
 16855*             end-perform
 16856*          end-if
 16857        end-perform
 16858     else
 16859        display ' resp not normal ' ws-response ' '
 16860        trlr-key (2:19)
 16861     end-if
 16862
 16863     .
 16864 8140-exit.
 16865     exit.
 16866 8150-ENTERED-CLAIM-NOTFOUND.
 16867
 16868     MOVE ER-0204                TO EMI-ERROR.
 16869     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16870     MOVE -1                     TO MAINTL.
 16871     GO TO 8100-SEND-MAP.
 16872
 16873 8200-RETURN-PRIOR.
 16874     MOVE SPACE                  TO PI-RETURN-CD-1.
 16875     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16876     GO TO 9200-XCTL.
 16877
 16878 8300-GET-HELP.
 16879     MOVE XCTL-EL010             TO CALL-PGM.
 16880     GO TO 9200-XCTL.
 16881
 16882 8400-RETURN-MASTER.
 16883     MOVE SPACE                  TO PI-RETURN-CD-1.
 16884     MOVE XCTL-EL126             TO CALL-PGM.
 16885     GO TO 9200-XCTL.
 16886
 16887 8500-TRLR-MNT.
 16888     IF PI-RETURN-CD-1 = 'X'
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 318
* EL131.cbl
 16889         MOVE ER-0311            TO EMI-ERROR
 16890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16891         MOVE -1                 TO MAINTL
 16892         GO TO 8110-SEND-DATA.
 16893
 16894
 16895* EXEC CICS WRITEQ TS
 16896*         QUEUE     (PI-KEY)
 16897*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16898*         LENGTH    (PI-COMM-LENGTH)
 16899*    END-EXEC.
 16900*    MOVE '*"                    ''   #00014142' TO DFHEIV0
 16901     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16903     MOVE X'2020233030303134313432' TO DFHEIV0(25:11)
 16904     CALL 'kxdfhei1' USING DFHEIV0,
 16905           PI-KEY,
 16906           PROGRAM-INTERFACE-BLOCK,
 16907           PI-COMM-LENGTH,
 16908           DFHEIV99,
 16909           DFHEIV99,
 16910           DFHEIV99
 16911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16912
 16913
 16914     MOVE XCTL-EL142             TO CALL-PGM.
 16915     GO TO 9200-XCTL.
 16916
 16917 8600-ADDR-MNT.
 16918     IF PI-RETURN-CD-1 = 'X'
 16919         MOVE ER-0311            TO EMI-ERROR
 16920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16921         MOVE -1                 TO MAINTL
 16922         GO TO 8110-SEND-DATA.
 16923
 16924
 16925* EXEC CICS WRITEQ TS
 16926*         QUEUE     (PI-KEY)
 16927*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16928*         LENGTH    (PI-COMM-LENGTH)
 16929*    END-EXEC.
 16930*    MOVE '*"                    ''   #00014158' TO DFHEIV0
 16931     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16932     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16933     MOVE X'2020233030303134313538' TO DFHEIV0(25:11)
 16934     CALL 'kxdfhei1' USING DFHEIV0,
 16935           PI-KEY,
 16936           PROGRAM-INTERFACE-BLOCK,
 16937           PI-COMM-LENGTH,
 16938           DFHEIV99,
 16939           DFHEIV99,
 16940           DFHEIV99
 16941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16942
 16943
 16944     MOVE XCTL-EL141             TO CALL-PGM.
 16945     GO TO 9200-XCTL.
 16946
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 319
* EL131.cbl
 16947 8700-CERT-MNT.
 16948     IF PI-RETURN-CD-1 = 'X'
 16949         MOVE ER-7690            TO EMI-ERROR
 16950         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16951         MOVE -1                 TO MAINTL
 16952         GO TO 8110-SEND-DATA.
 16953
 16954
 16955* EXEC CICS WRITEQ TS
 16956*         QUEUE     (PI-KEY)
 16957*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16958*         LENGTH    (PI-COMM-LENGTH)
 16959*    END-EXEC.
 16960*    MOVE '*"                    ''   #00014174' TO DFHEIV0
 16961     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16963     MOVE X'2020233030303134313734' TO DFHEIV0(25:11)
 16964     CALL 'kxdfhei1' USING DFHEIV0,
 16965           PI-KEY,
 16966           PROGRAM-INTERFACE-BLOCK,
 16967           PI-COMM-LENGTH,
 16968           DFHEIV99,
 16969           DFHEIV99,
 16970           DFHEIV99
 16971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16972
 16973
 16974     MOVE XCTL-EL1273            TO CALL-PGM.
 16975     GO TO 9200-XCTL.
 16976
 16977 8725-BENEFICIARY-MNT.
 16978     IF PI-RETURN-CD-1 = 'X'
 16979         MOVE ER-0311            TO EMI-ERROR
 16980         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16981         MOVE -1                 TO MAINTL
 16982         GO TO 8110-SEND-DATA.
 16983
 16984
 16985* EXEC CICS WRITEQ TS
 16986*         QUEUE     (PI-KEY)
 16987*         FROM      (EL131AI)
 16988*         LENGTH    (MAP-LENGTH)
 16989*    END-EXEC.
 16990*    MOVE '*"                    ''   #00014190' TO DFHEIV0
 16991     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16992     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16993     MOVE X'2020233030303134313930' TO DFHEIV0(25:11)
 16994     CALL 'kxdfhei1' USING DFHEIV0,
 16995           PI-KEY,
 16996           EL131AI,
 16997           MAP-LENGTH,
 16998           DFHEIV99,
 16999           DFHEIV99,
 17000           DFHEIV99
 17001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17002
 17003
 17004
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 320
* EL131.cbl
 17005* EXEC CICS WRITEQ TS
 17006*         QUEUE     (PI-KEY)
 17007*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17008*         LENGTH    (PI-COMM-LENGTH)
 17009*    END-EXEC.
 17010*    MOVE '*"                    ''   #00014196' TO DFHEIV0
 17011     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 17012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17013     MOVE X'2020233030303134313936' TO DFHEIV0(25:11)
 17014     CALL 'kxdfhei1' USING DFHEIV0,
 17015           PI-KEY,
 17016           PROGRAM-INTERFACE-BLOCK,
 17017           PI-COMM-LENGTH,
 17018           DFHEIV99,
 17019           DFHEIV99,
 17020           DFHEIV99
 17021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17022
 17023
 17024     MOVE XCTL-EL114             TO CALL-PGM.
 17025     GO TO 9200-XCTL.
 17026
 17027 8750-DMD-CLM-FIX.
 17028
 17029* EXEC CICS WRITEQ TS
 17030*         QUEUE     (PI-KEY)
 17031*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17032*         LENGTH    (PI-COMM-LENGTH)
 17033*    END-EXEC.
 17034*    MOVE '*"                    ''   #00014206' TO DFHEIV0
 17035     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 17036     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17037     MOVE X'2020233030303134323036' TO DFHEIV0(25:11)
 17038     CALL 'kxdfhei1' USING DFHEIV0,
 17039           PI-KEY,
 17040           PROGRAM-INTERFACE-BLOCK,
 17041           PI-COMM-LENGTH,
 17042           DFHEIV99,
 17043           DFHEIV99,
 17044           DFHEIV99
 17045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17046
 17047
 17048     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17049     GO TO 9200-XCTL.
 17050
 17051 8800-UNAUTHORIZED-ACCESS.
 17052     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17053     GO TO 8990-SEND-TEXT.
 17054
 17055 8810-PF23-ENTERED.
 17056     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17057     MOVE XCTL-EL005             TO CALL-PGM.
 17058     GO TO 9200-XCTL.
 17059
 17060 8820-XCTL-ERROR.
 17061
 17062* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 321
* EL131.cbl
 17063*        PGMIDERR (8990-SEND-TEXT)
 17064*    END-EXEC.
 17065*    MOVE '"$L                   ! I #00014225' TO DFHEIV0
 17066     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17068     MOVE X'4920233030303134323235' TO DFHEIV0(25:11)
 17069     CALL 'kxdfhei1' USING DFHEIV0
 17070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17071
 17072
 17073     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17074     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17075     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17076     MOVE XCTL-EL005            TO CALL-PGM.
 17077     GO TO 9200-XCTL.
 17078
 17079 8990-SEND-TEXT.
 17080
 17081* EXEC CICS SEND TEXT
 17082*         FROM      (LOGOFF-TEXT)
 17083*         LENGTH    (LOGOFF-LENGTH)
 17084*         ERASE
 17085*         FREEKB
 17086*    END-EXEC.
 17087*    MOVE '8&      T  E F  H   F -   #00014236' TO DFHEIV0
 17088     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17089     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17090     MOVE X'2020233030303134323336' TO DFHEIV0(25:11)
 17091     CALL 'kxdfhei1' USING DFHEIV0,
 17092           LOGOFF-TEXT,
 17093           LOGOFF-LENGTH,
 17094           DFHEIV99,
 17095           DFHEIV99,
 17096           DFHEIV99,
 17097           DFHEIV99,
 17098           DFHEIV99,
 17099           DFHEIV99,
 17100           DFHEIV99,
 17101           DFHEIV99,
 17102           DFHEIV99,
 17103           DFHEIV99
 17104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17105
 17106
 17107     GO TO 9100-RETURN-CICS.
 17108
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 322
* EL131.cbl
 17110 9000-RETURN-TRANS.
 17111
 17112* EXEC CICS RETURN
 17113*         TRANSID   (TRANS-ID)
 17114*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17115*         LENGTH    (PI-COMM-LENGTH)
 17116*    END-EXEC.
 17117*    MOVE '.(CT                  ''   #00014247' TO DFHEIV0
 17118     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17119     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17120     MOVE X'2020233030303134323437' TO DFHEIV0(25:11)
 17121     CALL 'kxdfhei1' USING DFHEIV0,
 17122           TRANS-ID,
 17123           PROGRAM-INTERFACE-BLOCK,
 17124           PI-COMM-LENGTH,
 17125           DFHEIV99,
 17126           DFHEIV99,
 17127           DFHEIV99
 17128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17129
 17130
 17131
 17132* GOBACK.
 17133     MOVE '9%                    "   ' TO DFHEIV0
 17134     MOVE 'EL131' TO DFHEIV1
 17135     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17136     GOBACK.
 17137
 17138 9100-RETURN-CICS.
 17139
 17140* EXEC CICS RETURN
 17141*    END-EXEC.
 17142*    MOVE '.(                    ''   #00014256' TO DFHEIV0
 17143     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17145     MOVE X'2020233030303134323536' TO DFHEIV0(25:11)
 17146     CALL 'kxdfhei1' USING DFHEIV0,
 17147           DFHEIV99,
 17148           DFHEIV99,
 17149           DFHEIV99,
 17150           DFHEIV99,
 17151           DFHEIV99,
 17152           DFHEIV99
 17153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17154
 17155
 17156
 17157* GOBACK.
 17158     MOVE '9%                    "   ' TO DFHEIV0
 17159     MOVE 'EL131' TO DFHEIV1
 17160     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17161     GOBACK.
 17162
 17163 9200-XCTL.
 17164
 17165* EXEC CICS XCTL
 17166*         PROGRAM    (CALL-PGM)
 17167*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 323
* EL131.cbl
 17168*         LENGTH     (PI-COMM-LENGTH)
 17169*    END-EXEC.
 17170*    MOVE '.$C                   %   #00014262' TO DFHEIV0
 17171     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17172     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17173     MOVE X'2020233030303134323632' TO DFHEIV0(25:11)
 17174     CALL 'kxdfhei1' USING DFHEIV0,
 17175           CALL-PGM,
 17176           PROGRAM-INTERFACE-BLOCK,
 17177           PI-COMM-LENGTH,
 17178           DFHEIV99
 17179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17180
 17181
 17182 9700-LINK-RTRM-FILE-ID.
 17183
 17184* EXEC CICS LINK
 17185*        PROGRAM  (RTRM-FILE-ID)
 17186*        COMMAREA (CALCULATION-PASS-AREA)
 17187*        LENGTH   (CP-COMM-LENGTH)
 17188*    END-EXEC.
 17189*    MOVE '."C                   (   #00014269' TO DFHEIV0
 17190     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17192     MOVE X'2020233030303134323639' TO DFHEIV0(25:11)
 17193     CALL 'kxdfhei1' USING DFHEIV0,
 17194           RTRM-FILE-ID,
 17195           CALCULATION-PASS-AREA,
 17196           CP-COMM-LENGTH,
 17197           DFHEIV99,
 17198           DFHEIV99,
 17199           DFHEIV99,
 17200           DFHEIV99
 17201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17202
 17203
 17204 9700-EXIT.
 17205      EXIT.
 17206
 17207 9800-CONVERT-DATE.
 17208     MOVE SPACES TO DC-ERROR-CODE.
 17209
 17210* EXEC CICS LINK
 17211*         PROGRAM    (DATE-CONV)
 17212*         COMMAREA   (DATE-CONVERSION-DATA)
 17213*         LENGTH     (DC-COMM-LENGTH)
 17214*    END-EXEC.
 17215*    MOVE '."C                   (   #00014280' TO DFHEIV0
 17216     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17217     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17218     MOVE X'2020233030303134323830' TO DFHEIV0(25:11)
 17219     CALL 'kxdfhei1' USING DFHEIV0,
 17220           DATE-CONV,
 17221           DATE-CONVERSION-DATA,
 17222           DC-COMM-LENGTH,
 17223           DFHEIV99,
 17224           DFHEIV99,
 17225           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 324
* EL131.cbl
 17226           DFHEIV99
 17227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17228
 17229
 17230 9800-EXIT.
 17231     EXIT.
 17232
 17233 9900-ERROR-FORMAT.
 17234
 17235* EXEC CICS LINK
 17236*         PROGRAM    (XCTL-EL001)
 17237*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17238*         LENGTH     (EMI-COMM-LENGTH)
 17239*    END-EXEC.
 17240*    MOVE '."C                   (   #00014290' TO DFHEIV0
 17241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17243     MOVE X'2020233030303134323930' TO DFHEIV0(25:11)
 17244     CALL 'kxdfhei1' USING DFHEIV0,
 17245           XCTL-EL001,
 17246           ERROR-MESSAGE-INTERFACE-BLOCK,
 17247           EMI-COMM-LENGTH,
 17248           DFHEIV99,
 17249           DFHEIV99,
 17250           DFHEIV99,
 17251           DFHEIV99
 17252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17253
 17254
 17255 9900-EXIT.
 17256     EXIT.
 17257
 17258 9990-ABEND.
 17259     MOVE DFHEIBLK               TO EMI-LINE1.
 17260
 17261* EXEC CICS LINK
 17262*         PROGRAM   (XCTL-EL004)
 17263*         COMMAREA  (EMI-LINE1)
 17264*         LENGTH    (72)
 17265*     END-EXEC.
 17266     MOVE 72
 17267       TO DFHEIV11
 17268*    MOVE '."C                   (   #00014301' TO DFHEIV0
 17269     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17271     MOVE X'2020233030303134333031' TO DFHEIV0(25:11)
 17272     CALL 'kxdfhei1' USING DFHEIV0,
 17273           XCTL-EL004,
 17274           EMI-LINE1,
 17275           DFHEIV11,
 17276           DFHEIV99,
 17277           DFHEIV99,
 17278           DFHEIV99,
 17279           DFHEIV99
 17280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17281
 17282
 17283     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 325
* EL131.cbl
 17284
 17285     GO TO 8110-SEND-DATA.
 17286
 17287 9995-SECURITY-VIOLATION.
 17288*           COPY ELCSCTP.
 17289******************************************************************
 17290*                                                                *
 17291*                            ELCSCTP                             *
 17292*                            VMOD=2.001                          *
 17293*                                                                *
 17294*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17295******************************************************************
 17296
 17297
 17298     MOVE EIBDATE          TO SM-JUL-DATE.
 17299     MOVE EIBTRMID         TO SM-TERMID.
 17300     MOVE THIS-PGM         TO SM-PGM.
 17301     MOVE EIBTIME          TO TIME-IN.
 17302     MOVE TIME-OUT         TO SM-TIME.
 17303     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17304
 17305
 17306* EXEC CICS LINK
 17307*         PROGRAM  ('EL003')
 17308*         COMMAREA (SECURITY-MESSAGE)
 17309*         LENGTH   (80)
 17310*    END-EXEC.
 17311     MOVE 'EL003' TO DFHEIV1
 17312     MOVE 80
 17313       TO DFHEIV11
 17314*    MOVE '."C                   (   #00014329' TO DFHEIV0
 17315     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17317     MOVE X'2020233030303134333239' TO DFHEIV0(25:11)
 17318     CALL 'kxdfhei1' USING DFHEIV0,
 17319           DFHEIV1,
 17320           SECURITY-MESSAGE,
 17321           DFHEIV11,
 17322           DFHEIV99,
 17323           DFHEIV99,
 17324           DFHEIV99,
 17325           DFHEIV99
 17326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17327
 17328
 17329******************************************************************
 17330
 17331
 17332
 17333 9999-DFHBACK SECTION.
 17334     MOVE '9%                    "   ' TO DFHEIV0
 17335     MOVE 'EL131' TO DFHEIV1
 17336     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17337     GOBACK.
 17338 9999-DFHEXIT.
 17339     IF DFHEIGDJ EQUAL 0001
 17340         NEXT SENTENCE
 17341     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 326
* EL131.cbl
 17342         GO TO 8820-XCTL-ERROR,
 17343               8150-ENTERED-CLAIM-NOTFOUND,
 17344               9990-ABEND
 17345         DEPENDING ON DFHEIGDI
 17346     ELSE IF DFHEIGDJ EQUAL 3
 17347         GO TO 0130-TS-ERROR,
 17348               0130-TS-ERROR
 17349         DEPENDING ON DFHEIGDI
 17350     ELSE IF DFHEIGDJ EQUAL 4
 17351         GO TO 0600-CONTINUE-NAME-UPDATE
 17352         DEPENDING ON DFHEIGDI
 17353     ELSE IF DFHEIGDJ EQUAL 5
 17354         GO TO 1004-BENE-NOT-FOUND
 17355         DEPENDING ON DFHEIGDI
 17356     ELSE IF DFHEIGDJ EQUAL 6
 17357         GO TO 1052-DONE,
 17358               1052-DONE
 17359         DEPENDING ON DFHEIGDI
 17360     ELSE IF DFHEIGDJ EQUAL 7
 17361         GO TO 1120-CNTL-NOTFND
 17362         DEPENDING ON DFHEIGDI
 17363     ELSE IF DFHEIGDJ EQUAL 8
 17364         GO TO 1150-NOTOPEN-ERROR,
 17365               1150-EXIT
 17366         DEPENDING ON DFHEIGDI
 17367     ELSE IF DFHEIGDJ EQUAL 9
 17368         GO TO 1490-STATE-NOTFND
 17369         DEPENDING ON DFHEIGDI
 17370     ELSE IF DFHEIGDJ EQUAL 10
 17371         GO TO 1500-CARR-NOTFND
 17372         DEPENDING ON DFHEIGDI
 17373     ELSE IF DFHEIGDJ EQUAL 11
 17374         GO TO 1620-ACCT-NOTFND
 17375         DEPENDING ON DFHEIGDI
 17376     ELSE IF DFHEIGDJ EQUAL 12
 17377         GO TO 2020-EXIT
 17378         DEPENDING ON DFHEIGDI
 17379     ELSE IF DFHEIGDJ EQUAL 13
 17380         GO TO 2030-EXIT
 17381         DEPENDING ON DFHEIGDI
 17382     ELSE IF DFHEIGDJ EQUAL 14
 17383         GO TO 2040-EXIT
 17384         DEPENDING ON DFHEIGDI
 17385     ELSE IF DFHEIGDJ EQUAL 15
 17386         GO TO 2050-EXIT
 17387         DEPENDING ON DFHEIGDI
 17388     ELSE IF DFHEIGDJ EQUAL 16
 17389         GO TO 2060-CERT-NOTFND
 17390         DEPENDING ON DFHEIGDI
 17391     ELSE IF DFHEIGDJ EQUAL 17
 17392         GO TO 2060-DUPKEY
 17393         DEPENDING ON DFHEIGDI
 17394     ELSE IF DFHEIGDJ EQUAL 18
 17395         GO TO 2070-NOT-FOUND
 17396         DEPENDING ON DFHEIGDI
 17397     ELSE IF DFHEIGDJ EQUAL 19
 17398         GO TO 2070-EXIT
 17399         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 327
* EL131.cbl
 17400     ELSE IF DFHEIGDJ EQUAL 20
 17401         GO TO 2080-EXIT
 17402         DEPENDING ON DFHEIGDI
 17403     ELSE IF DFHEIGDJ EQUAL 21
 17404         GO TO 2400-TRLR-NOTFND,
 17405               2410-EXIT
 17406         DEPENDING ON DFHEIGDI
 17407     ELSE IF DFHEIGDJ EQUAL 22
 17408         GO TO 2425-NINETY-NOTFND,
 17409               2425-NINETY-NOTFND
 17410         DEPENDING ON DFHEIGDI
 17411     ELSE IF DFHEIGDJ EQUAL 23
 17412         GO TO 2430-EXIT,
 17413               2440-EXIT
 17414         DEPENDING ON DFHEIGDI
 17415     ELSE IF DFHEIGDJ EQUAL 24
 17416         GO TO 2440-EXIT
 17417         DEPENDING ON DFHEIGDI
 17418     ELSE IF DFHEIGDJ EQUAL 25
 17419         GO TO 2460-EXIT
 17420         DEPENDING ON DFHEIGDI
 17421     ELSE IF DFHEIGDJ EQUAL 26
 17422         GO TO 2475-EXIT
 17423         DEPENDING ON DFHEIGDI
 17424     ELSE IF DFHEIGDJ EQUAL 27
 17425         GO TO 2650-EXIT
 17426         DEPENDING ON DFHEIGDI
 17427     ELSE IF DFHEIGDJ EQUAL 28
 17428         GO TO 2800-EXIT,
 17429               2800-EXIT
 17430         DEPENDING ON DFHEIGDI
 17431     ELSE IF DFHEIGDJ EQUAL 29
 17432         GO TO 3010-DEL-ACTQ,
 17433               3040-EXIT
 17434         DEPENDING ON DFHEIGDI
 17435     ELSE IF DFHEIGDJ EQUAL 30
 17436         GO TO 3010-NO-ACTIVITY,
 17437               3050-EXIT
 17438         DEPENDING ON DFHEIGDI
 17439     ELSE IF DFHEIGDJ EQUAL 31
 17440         GO TO 3010-CERT-NOT-FOUND
 17441         DEPENDING ON DFHEIGDI
 17442     ELSE IF DFHEIGDJ EQUAL 32
 17443         GO TO 3020-EXIT
 17444         DEPENDING ON DFHEIGDI
 17445     ELSE IF DFHEIGDJ EQUAL 33
 17446         GO TO 3060-EXIT,
 17447               3060-EXIT
 17448         DEPENDING ON DFHEIGDI
 17449     ELSE IF DFHEIGDJ EQUAL 34
 17450         GO TO 5000-TRLR-NOT-FOUND
 17451         DEPENDING ON DFHEIGDI
 17452     ELSE IF DFHEIGDJ EQUAL 35
 17453         GO TO 5000-CERT-NOT-FOUND
 17454         DEPENDING ON DFHEIGDI
 17455     ELSE IF DFHEIGDJ EQUAL 36
 17456         GO TO 7630-END-BROWSE
 17457         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 06-Apr-17 09:32 Page 328
* EL131.cbl
 17458     ELSE IF DFHEIGDJ EQUAL 37
 17459         GO TO 7799-EXIT,
 17460               7799-EXIT
 17461         DEPENDING ON DFHEIGDI
 17462     ELSE IF DFHEIGDJ EQUAL 38
 17463         GO TO 7799-EXIT
 17464         DEPENDING ON DFHEIGDI
 17465     ELSE IF DFHEIGDJ EQUAL 39
 17466         GO TO 7800-NOT-FOUND
 17467         DEPENDING ON DFHEIGDI
 17468     ELSE IF DFHEIGDJ EQUAL 40
 17469         GO TO 8000-NOTE-NOT-FOUND
 17470         DEPENDING ON DFHEIGDI
 17471     ELSE IF DFHEIGDJ EQUAL 41
 17472         GO TO 8990-SEND-TEXT
 17473         DEPENDING ON DFHEIGDI.
 17474     MOVE '9%                    "   ' TO DFHEIV0
 17475     MOVE 'EL131' TO DFHEIV1
 17476     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17477     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13596     Code:       60594
