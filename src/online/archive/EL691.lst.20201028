* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   1
* EL691.cbl
* Options: int("EL691.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL691.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL691.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL691.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL691.
     5*
     6*AUTHOR.    LOGIC, INC.
     7*           DALLAS, TEXAS.
     8
     9*DATE-COMPILED.
    10
    11*REMARKS.
    12*        THIS PROGRAM PROVIDES THE FUNCTIONS TO BROWSE AND EDIT
    13*    THE DETAIL OF AN ARCHIVED LETTER.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   2
* EL691.cbl
    14
    15*    TRANS ID = EXN1
    16
    17******************************************************************
    18*                   C H A N G E   L O G
    19*
    20* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    21*-----------------------------------------------------------------
    22*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    23* EFFECTIVE    NUMBER
    24*-----------------------------------------------------------------
    25* 071111    2011022800001  AJRA  NAPERSOFT - NEW SCREEN
    26* 100312    2011022800001  AJRA  CHANGE RECEIVED MSG
    27* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTE, ENDT ARCH N
    28* 122612    2012101700002  AJRA  UPDATE BILLING NOTE ON RECEIVED
    29* 100813    2013100700002  AJRA  VERITY RESEND LETTER ID ON CHANGE
    30* 102918  CR2018080300002  PEMA  ADD VOID OB LETTER OPTION
    31* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
    32******************************************************************
    33
    34 DATA DIVISION.
    35 WORKING-STORAGE SECTION.
    36 01  DFH-START PIC X(04).
    37 77  FILLER  PIC X(32) VALUE '********************************'.
    38 77  FILLER  PIC X(32) VALUE '*    EL691 WORKING STORAGE     *'.
    39 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    40 77  c1                          pic s9(5) comp-3 value +0.
    41 77  n1                          pic s999  comp-3 value +0.
    42 77  w-comment-line-cnt          pic s999 comp-3 value +0.
    43 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    44 77  note-count                  pic s999 comp-3 value +0.
    45 77  ws-build-note-sw            pic x value ' '.
    46     88  finished-with-notes      value 'Y'.
    47 77  ws-ercnot-sw                pic x  value spaces.
    48     88  ercnot-startbr            value 'Y'.
    49
    50 01  P pointer.
    51 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    52 01  var-ptr pointer.
    53 01  env-var-len                 pic 9(4)  binary.
    54 01  rc                          pic 9(9)  binary.
    55
    56 01  WS-KIXSYS.
    57     05  WS-KIX-FIL1             PIC X(10).
    58     05  WS-KIX-APPS             PIC X(10).
    59     05  WS-KIX-ENV              PIC X(10).
    60     05  WS-KIX-MYENV            PIC X(10).
    61     05  WS-KIX-SYS              PIC X(10).
*   62 EXEC SQL
*   63    INCLUDE SQLDA
*   64 END-EXEC
    65 01 SQLDA sync.
    66    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    67    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    68    05 SQLN                  PIC S9(4) COMP-5 value 0.
    69    05 SQLD                  PIC S9(4) COMP-5 value 0.
    70    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    71       10 SQLTYPE            PIC S9(4) COMP-5.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   3
* EL691.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72       10 SQLLEN             PIC S9(4) COMP-5.
    73$IF P64 SET
    74X      *> For 64-bit environments, ensure that SQLDATA is
    75X      *> aligned on an 8-byte boundary.
    76X      10 FILLER             PIC S9(9) COMP-5.
    77$END
    78       10 SQLDATA            USAGE POINTER.
    79       10 SQLIND             USAGE POINTER.
    80       10 SQLNAME.
    81          15 SQLNAMEL        PIC S9(4) COMP-5.
    82          15 SQLNAMEC        PIC X(30).
    83
    84* Values for SQLTYPE
    85
    86 78  ESQL-DATE-CHAR              VALUE 384.
    87 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    88 78  ESQL-DATE-REC               VALUE 386.
    89 78  ESQL-DATE-REC-NULL          VALUE 387.
    90 78  ESQL-TIME-CHAR              VALUE 388.
    91 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    92 78  ESQL-TIME-REC               VALUE 390.
    93 78  ESQL-TIME-REC-NULL          VALUE 391.
    94 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
    95 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
    96 78  ESQL-TIMESTAMP-REC          VALUE 394.
    97 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
    98 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
    99 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   100 78  ESQL-TS-OFFSET-REC          VALUE 398.
   101 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   102 78  ESQL-LONGVARBINARY          VALUE 404.
   103 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   104 78  ESQL-LONGVARCHAR            VALUE 408.
   105 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   106 78  ESQL-BINARY                 VALUE 444.
   107 78  ESQL-BINARY-NULL            VALUE 445.
   108 78  ESQL-VARBINARY              VALUE 446.
   109 78  ESQL-VARBINARY-NULL         VALUE 447.
   110 78  ESQL-VARCHAR                VALUE 448.
   111 78  ESQL-VARCHAR-NULL           VALUE 449.
   112
   113 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   114 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   115
   116 78  ESQL-CHAR                   VALUE 452.
   117 78  ESQL-CHAR-NULL              VALUE 453.
   118
   119 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   120 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   121
   122 78  ESQL-DOUBLE                 VALUE 480.
   123 78  ESQL-DOUBLE-NULL            VALUE 481.
   124 78  ESQL-REAL                   VALUE 482.
   125 78  ESQL-REAL-NULL              VALUE 483.
   126 78  ESQL-DECIMAL                VALUE 484.
   127 78  ESQL-DECIMAL-NULL           VALUE 485.
   128 78  ESQL-INTEGER                VALUE 496.
   129 78  ESQL-INTEGER-NULL           VALUE 497.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   4
* EL691.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-SMALLINT               VALUE 500.
   131 78  ESQL-SMALLINT-NULL          VALUE 501.
   132 78  ESQL-TINYINT                VALUE 502.
   133 78  ESQL-TINYINT-NULL           VALUE 503.
*  134 EXEC SQL
*  135    INCLUDE SQLCA
*  136 END-EXEC
   137 01 SQLCA.
   138     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   139     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   140     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   141     05  SQLERRM.
   142         49  SQLERRML    PIC S9(4) COMP-5.
   143         49  SQLERRMC    PIC X(70).
   144     05  SQLERRP         PIC X(8).
   145     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   146     05  SQLWARN.
   147         10  SQLWARN0    PIC X.
   148         10  SQLWARN1    PIC X.
   149         10  SQLWARN2    PIC X.
   150         10  SQLWARN3    PIC X.
   151         10  SQLWARN4    PIC X.
   152         10  SQLWARN5    PIC X.
   153         10  SQLWARN6    PIC X.
   154         10  SQLWARN7    PIC X.
   155     05  SQLEXT.
   156         10  SQLWARN8    PIC X.
   157         10  SQLWARN9    PIC X.
   158         10  SQLWARN10   PIC X.
   159         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   160     05  SQLSTATE    PIC X(5).
   161 EXEC SQL
   162    BEGIN DECLARE SECTION
   163 END-EXEC
   164 01  sqlcmd                      pic x(1024).
   165 01  WS-MOE-DATE                 pic x(10).
   166 01  svr                         pic x(32).
   167 01  usr                         pic x(32).
   168 01  pass                        pic x(32).
   169 01  usr-pass                    pic x(64).
   170 01  ws-sql-code                 pic s9(7) value zeros.
   171 01  ws-dis-sql-code             pic -9999999 value zeros.
   172***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   173***                                                            ***
   174***  These indicators are used to determine if a variable      ***
   175***  is passed nulls from sql. The indicator will be -1        ***
   176***  if the value on sql is nulls and +0 if the value is       ***
   177***  something other than nulls. Here is an example on how     ***
   178***  to use the indicator variables.                           ***
   179***                                                            ***
   180***     EXEC SQL                                               ***
   181***        fetch keyword into                                  ***
   182***           :db-Complete-dt :nu-Complete-date,               ***
   183***           :db-app-by     :nu-app-by,                       ***
   184***           :db-app-date   :nu-app-date,                     ***
   185***           :db-app-batch  :nu-app-batch                     ***
   186***     END-EXEC                                               ***
   187***                                                            ***
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   5
* EL691.cbl
   188***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   189 01  indicator-vaiables-for-nulls.
   190     05  nu-Complete-date        pic s9(4) comp value +0.
   191 01  key-word-key-data.
   192     05  kd-unique-id            pic 9(7).
   193     05  kd-cert-no              pic x(11).
   194 01  key-word-table-data.
   195     05  db-req-date             pic x(10).
   196     05  db-doc-type             pic x(30).
   197     05  db-Cert-no              pic x(11).
   198     05  db-Print-dt             pic x(10).
   199     05  db-Cert-exp-dt          pic x(10).
   200     05  db-cert-state           pic xx.
   201     05  db-key-word-type        pic x(30).
   202     05  db-key-word-value       pic x(30).
   203     05  db-complete-dt          pic x(10).
   204 EXEC SQL
   205    END DECLARE SECTION
   206 END-EXEC
   207
   208 01  W-WORK-AREAS.
   209     12  ws-sql-update-sw        pic x value ' '.
   210         88  sql-update-succeeded    value 'Y'.
   211         88  sql-update-failed       value 'N'.
   212     12  ws-connect-sw           pic x  value ' '.
   213         88  connected-to-db        value 'Y'.
   214     12  ws-cert-sw              pic x value ' '.
   215         88  cert-found             value 'Y'.
   216     12  FILLER                  PIC  X(18)
   217                                      VALUE 'PROGRAM WORK AREA:'.
   218     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   219     12  W-CALL-PGM              PIC  X(08).
   220     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   221     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   222     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   223
   224     12  W-TIME-IN               PIC S9(07).
   225     12  FILLER REDEFINES W-TIME-IN.
   226         16  FILLER              PIC  X(01).
   227         16  W-TIME-OUT          PIC  9(02)V9(02).
   228         16  FILLER              PIC  X(02).
   229
   230     12  W-DEEDIT-FIELD          PIC  X(15).
   231     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   232
   233     12  W-ERROR-COUNT           PIC S9(3)       VALUE ZERO.
   234     12  W-UPDATE-SW             PIC S9          VALUE ZERO.
   235     12  W-RESEND-DATE           PIC XX    VALUE LOW-VALUES.
   236     12  W-SENT-DATE             PIC XX    VALUE LOW-VALUES.
   237     12  W-FINAL-ACT-DATE        PIC XX    VALUE LOW-VALUES.
   238     12  W-RECEIVED-DATE         PIC XX    VALUE LOW-VALUES.
   239     12  W-STOP-LETTER-DATE      PIC XX    VALUE LOW-VALUES.
   240     12  W-RESPONSE              PIC S9(8)   COMP.
   241         88  RESP-NORMAL                  VALUE +00.
   242         88  RESP-NOTFND                  VALUE +13.
   243         88  RESP-DUPREC                  VALUE +14.
   244         88  RESP-DUPKEY                  VALUE +15.
   245         88  RESP-NOTOPEN                 VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   6
* EL691.cbl
   246         88  RESP-ENDFILE                 VALUE +20.
   247         88  resp-lengtherr               value +22.
   248
   249     12  W-ARCH-SAVE-KEY         PIC  X(03).
   250     12  W-ARCH-KEY.
   251         16  W-ARCH-COMPANY-CD   PIC  X(01).
   252         16  W-ARCH-NUMBER       PIC S9(08)      COMP.
   253
   254     12  W-ARCT-KEY.
   255         16  W-ARCT-COMPANY-CD   PIC  X(01).
   256         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
   257         16  W-ARCT-RECORD-TYPE  PIC  X(01).
   258             88  W-ARCT-COMMENT-DATA   VALUE '3'.
   259         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
   260
   261     12  w-stop-letter-comment   pic x(126) value spaces.
   262     12  w-cert-note-comment     pic x(70) value spaces.
   263     12  W-CERT-NOTE-MSG.
   264         16  FILLER              PIC X(29)
   265             VALUE 'REQUESTED DOCUMENT RECEIVED  '.
   266         16  W-CERT-NOTE-RECV-DT PIC X(8).
   267
   268     12  WS-FIND-BILLING-NOTE.
   269         16  WS-FBN-NOTE         PIC X(25).
   270         16  WS-FBN-LTRID        PIC X(4).
   271
   272     12  WS-RECEIVED-NOTE.
   273         16  FILLER              PIC X(12)
   274             VALUE ' - RECEIVED '.
   275         16  WS-BN-RECV-DATE     PIC X(8).
   276
   277     12  WS-Z-RECORD-IND         PIC X(1) VALUE 'N'.
   278         88 Z-RECORD-FOUND                VALUE 'Y'.
   279         88 Z-RECORD-NOT-FOUND            VALUE 'N'.
   280
   281     12  ELCERT-FILE-ID          PIC  X(08)  VALUE 'ELCERT'.
   282     12  ERCNOT-FILE-ID          PIC  X(08)  VALUE 'ERCNOT'.
   283     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
   284     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   285     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   286     12  ERCNOT-KEY.
   287         16  ERCNOT-PARTIAL-KEY.
   288             20 ERCNOT-COMPANY-CD    PIC X.
   289             20 ERCNOT-CARRIER       PIC X.
   290             20 ERCNOT-GROUPING      PIC X(06).
   291             20 ERCNOT-STATE         PIC XX.
   292             20 ERCNOT-ACCOUNT       PIC X(10).
   293             20 ERCNOT-EFF-DT        PIC XX.
   294             20 ERCNOT-CERT-NO.
   295                25 ERCNOT-CERT-PRIME PIC X(10).
   296                25 ERCNOT-CERT-SFX   PIC X.
   297             20 ERCNOT-REC-TYP       PIC X.
   298         16 ERCNOT-SEQ           PIC S9(4) COMP.
   299     12  SV-PRIOR-KEY.
   300         16 SV-COMPANY-CD            PIC X.
   301         16 SV-CARRIER               PIC X.
   302         16 SV-GROUPING              PIC X(06).
   303         16 SV-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   7
* EL691.cbl
   304         16 SV-ACCOUNT               PIC X(10).
   305         16 SV-EFF-DT                PIC XX.
   306         16 SV-CERT-NO.
   307            20 SV-CERT-PRIME         PIC X(10).
   308            20 SV-CERT-SFX           PIC X(1).
   309         16 SV-REC-TYP               PIC X.
   310         16  SV-NOTE-SEQUENCE        PIC S9(4) COMP.
   311     12  ELCERT-KEY.
   312         16  ELCERT-COMPANY-CD        PIC X.
   313         16  ELCERT-CARRIER           PIC X.
   314         16  ELCERT-GROUPING          PIC X(6).
   315         16  ELCERT-STATE             PIC XX.
   316         16  ELCERT-ACCOUNT           PIC X(10).
   317         16  ELCERT-EFF-DT            PIC XX.
   318         16  ELCERT-CERT-NO.
   319             20  ELCERT-CERT-PRIME    PIC X(10).
   320             20  ELCERT-CERT-SFX      PIC X.
   321     12  ELEOBC-FILE-ID          PIC X(08)  VALUE 'ELEOBC'.
   322     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   323     12  ELEOBC-KEY.
   324         16  EOBC-COMPANY-CD     PIC X.
   325         16  EOBC-REC-TYPE       PIC X.
   326         16  EOBC-CODE           PIC X(4).
   327         16  FILLER              PIC X(9).
   328     12  ERNOTE-FILE-ID          PIC X(08)  VALUE 'ERNOTE'.
   329     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   330     12  ERNOTE-KEY.
   331         16  ERNOTE-COMPANY-CD   PIC X.
   332         16  ERNOTE-CARRIER      PIC X.
   333         16  ERNOTE-GROUPING     PIC X(6).
   334         16  ERNOTE-STATE        PIC XX.
   335         16  ERNOTE-ACCOUNT      PIC X(10).
   336         16  ERNOTE-CERT-EFF-DT  PIC XX.
   337         16  ERNOTE-CERT-PRIME   PIC X(10).
   338         16  ERNOTE-CERT-SFX     PIC X.
   339         16  ernote-record-type  pic x.
   340     12  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
   341     12  ELLETR-KEY.
   342         16  LETR-PART-KEY.
   343             20  LETR-COMPANY-CD PIC X.
   344             20  LETR-LETTER-ID  PIC X(4).
   345         16  LETR-FILLER         PIC X(8).
   346         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   347     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   348 01  w-comment-line-1            pic x(63) value spaces.
   349 01  w-comment-line-2            pic x(63) value spaces.
   350 01  cert-note-records-holder.
   351     05  cert-note-record occurs 500.
   352         10  filler              pic x(48).
   353         10  cnr-rest            pic x(102).
   354
   355
   356 01  FILLER                      PIC  X(22)
   357                                 VALUE 'INTERFACE AREA STARTS:'.
   358*    COPY ELCINTF.
   359******************************************************************
   360*                                                                *
   361*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   8
* EL691.cbl
   362*                            ELCINTF.                            *
   363*                            VMOD=2.017                          *
   364*                                                                *
   365*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   366*                                                                *
   367*       LENGTH = 1024                                            *
   368*                                                                *
   369******************************************************************
   370*                   C H A N G E   L O G
   371*
   372* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   373*-----------------------------------------------------------------
   374*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   375* EFFECTIVE    NUMBER
   376*-----------------------------------------------------------------
   377* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   378******************************************************************
   379 01  PROGRAM-INTERFACE-BLOCK.
   380     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   381     12  PI-CALLING-PROGRAM              PIC X(8).
   382     12  PI-SAVED-PROGRAM-1              PIC X(8).
   383     12  PI-SAVED-PROGRAM-2              PIC X(8).
   384     12  PI-SAVED-PROGRAM-3              PIC X(8).
   385     12  PI-SAVED-PROGRAM-4              PIC X(8).
   386     12  PI-SAVED-PROGRAM-5              PIC X(8).
   387     12  PI-SAVED-PROGRAM-6              PIC X(8).
   388     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   389     12  PI-COMPANY-ID                   PIC XXX.
   390     12  PI-COMPANY-CD                   PIC X.
   391
   392     12  PI-COMPANY-PASSWORD             PIC X(8).
   393
   394     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   395
   396     12  PI-CONTROL-IN-PROGRESS.
   397         16  PI-CARRIER                  PIC X.
   398         16  PI-GROUPING                 PIC X(6).
   399         16  PI-STATE                    PIC XX.
   400         16  PI-ACCOUNT                  PIC X(10).
   401         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   402                                         PIC X(10).
   403         16  PI-CLAIM-CERT-GRP.
   404             20  PI-CLAIM-NO             PIC X(7).
   405             20  PI-CERT-NO.
   406                 25  PI-CERT-PRIME       PIC X(10).
   407                 25  PI-CERT-SFX         PIC X.
   408             20  PI-CERT-EFF-DT          PIC XX.
   409         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   410             20  PI-PLAN-CODE            PIC X(2).
   411             20  PI-REVISION-NUMBER      PIC X(3).
   412             20  PI-PLAN-EFF-DT          PIC X(2).
   413             20  PI-PLAN-EXP-DT          PIC X(2).
   414             20  FILLER                  PIC X(11).
   415         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   416             20  PI-OE-REFERENCE-1.
   417                 25  PI-OE-REF-1-PRIME   PIC X(18).
   418                 25  PI-OE-REF-1-SUFF    PIC XX.
   419
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   9
* EL691.cbl
   420     12  PI-SESSION-IN-PROGRESS          PIC X.
   421         88  CLAIM-SESSION                   VALUE '1'.
   422         88  CREDIT-SESSION                  VALUE '2'.
   423         88  WARRANTY-SESSION                VALUE '3'.
   424         88  MORTGAGE-SESSION                VALUE '4'.
   425         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   426
   427
   428*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   429
   430     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   431     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   432
   433     12  PI-CREDIT-USER                  PIC X.
   434         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   435         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   436
   437     12  PI-CLAIM-USER                   PIC X.
   438         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   439         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   440
   441     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   442         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   443         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   444         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   445         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   446         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   447
   448     12  PI-PROCESSOR-ID                 PIC X(4).
   449
   450     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   451
   452     12  PI-MEMBER-CAPTION               PIC X(10).
   453
   454     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   455         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   456
   457     12  PI-LIFE-OVERRIDE-L1             PIC X.
   458     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   459     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   460     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   461
   462     12  PI-AH-OVERRIDE-L1               PIC X.
   463     12  PI-AH-OVERRIDE-L2               PIC XX.
   464     12  PI-AH-OVERRIDE-L6               PIC X(6).
   465     12  PI-AH-OVERRIDE-L12              PIC X(12).
   466
   467     12  PI-NEW-SYSTEM                   PIC X(2).
   468
   469     12  PI-PRIMARY-CERT-NO              PIC X(11).
   470     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   471         88  PI-USES-PAID-TO                 VALUE '1'.
   472     12  PI-CRDTCRD-SYSTEM.
   473         16  PI-CRDTCRD-USER             PIC X.
   474             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   475             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   476         16  PI-CC-MONTH-END-DT          PIC XX.
   477     12  PI-PROCESSOR-PRINTER            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  10
* EL691.cbl
   478
   479     12  PI-OE-REFERENCE-2.
   480         16  PI-OE-REF-2-PRIME           PIC X(10).
   481         16  PI-OE-REF-2-SUFF            PIC X.
   482
   483     12  PI-REM-TRM-CALC-OPTION          PIC X.
   484
   485     12  PI-LANGUAGE-TYPE                PIC X.
   486             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   487             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   488             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   489
   490     12  PI-POLICY-LINKAGE-IND           PIC X.
   491         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   492         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   493                                                   LOW-VALUES.
   494
   495     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   496     12  PI-CLAIM-PW-SESSION             PIC X(1).
   497         88  PI-CLAIM-CREDIT                 VALUE '1'.
   498         88  PI-CLAIM-CONVEN                 VALUE '2'.
   499
   500     12  PI-PROCESSOR-CSR-IND            PIC X.
   501         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   502         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   503
   504     12  FILLER                          PIC X(3).
   505
   506     12  PI-SYSTEM-LEVEL                 PIC X(145).
   507
   508     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   509         PI-SYSTEM-LEVEL.
   510
   511         16  PI-ENTRY-CODES.
   512             20  PI-ENTRY-CD-1           PIC X.
   513             20  PI-ENTRY-CD-2           PIC X.
   514
   515         16  PI-RETURN-CODES.
   516             20  PI-RETURN-CD-1          PIC X.
   517             20  PI-RETURN-CD-2          PIC X.
   518
   519         16  PI-UPDATE-STATUS-SAVE.
   520             20  PI-UPDATE-BY            PIC X(4).
   521             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   522
   523         16  PI-LOWER-CASE-LETTERS       PIC X.
   524             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   525
   526*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   527*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   528*            88  CARRIER-CLM-CNTL            VALUE '2'.
   529
   530         16  PI-CERT-ACCESS-CONTROL      PIC X.
   531             88  ST-ACCNT-CNTL               VALUE ' '.
   532             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   533             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   534             88  ACCNT-CNTL                  VALUE '3'.
   535             88  CARR-ACCNT-CNTL             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  11
* EL691.cbl
   536
   537         16  PI-PROCESSOR-CAP-LIST.
   538             20  PI-SYSTEM-CONTROLS.
   539                24 PI-SYSTEM-DISPLAY     PIC X.
   540                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   541                24 PI-SYSTEM-MODIFY      PIC X.
   542                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   543             20  FILLER                  PIC XX.
   544             20  PI-DISPLAY-CAP          PIC X.
   545                 88  DISPLAY-CAP             VALUE 'Y'.
   546             20  PI-MODIFY-CAP           PIC X.
   547                 88  MODIFY-CAP              VALUE 'Y'.
   548             20  PI-MSG-AT-LOGON-CAP     PIC X.
   549                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   550             20  PI-FORCE-CAP            PIC X.
   551                 88  FORCE-CAP               VALUE 'Y'.
   552
   553         16  PI-PROGRAM-CONTROLS.
   554             20  PI-PGM-PRINT-OPT        PIC X.
   555             20  PI-PGM-FORMAT-OPT       PIC X.
   556             20  PI-PGM-PROCESS-OPT      PIC X.
   557             20  PI-PGM-TOTALS-OPT       PIC X.
   558
   559         16  PI-HELP-INTERFACE.
   560             20  PI-LAST-ERROR-NO        PIC X(4).
   561             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   562
   563         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   564             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   565
   566         16  PI-CR-CONTROL-IN-PROGRESS.
   567             20  PI-CR-CARRIER           PIC X.
   568             20  PI-CR-GROUPING          PIC X(6).
   569             20  PI-CR-STATE             PIC XX.
   570             20  PI-CR-ACCOUNT           PIC X(10).
   571             20  PI-CR-FIN-RESP          PIC X(10).
   572             20  PI-CR-TYPE              PIC X.
   573
   574         16  PI-CR-BATCH-NUMBER          PIC X(6).
   575
   576         16  PI-CR-MONTH-END-DT          PIC XX.
   577
   578         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   579             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   580             88  PI-ZERO-CARRIER             VALUE '1'.
   581             88  PI-ZERO-GROUPING            VALUE '2'.
   582             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   583
   584         16  PI-CARRIER-SECURITY         PIC X.
   585             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   586
   587         16  PI-ACCOUNT-SECURITY         PIC X(10).
   588             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   589             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   590
   591         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   592             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   593                                         INDEXED BY PI-ACCESS-NDX
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  12
* EL691.cbl
   594                                         PIC X.
   595
   596         16  PI-GA-BILLING-CONTROL       PIC X.
   597             88  PI-GA-BILLING               VALUE '1'.
   598
   599         16  PI-MAIL-PROCESSING          PIC X.
   600             88  PI-MAIL-YES                 VALUE 'Y'.
   601
   602         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   603
   604         16  PI-AR-SYSTEM.
   605             20  PI-AR-PROCESSING-CNTL   PIC X.
   606                 88  PI-AR-PROCESSING        VALUE 'Y'.
   607             20  PI-AR-SUMMARY-CODE      PIC X(6).
   608             20  PI-AR-MONTH-END-DT      PIC XX.
   609
   610         16  PI-MP-SYSTEM.
   611             20  PI-MORTGAGE-USER            PIC X.
   612                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   613                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   614             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   615                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   616                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   617                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   618                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   619                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   620             20  PI-MP-MONTH-END-DT          PIC XX.
   621             20  PI-MP-REFERENCE-NO.
   622                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   623                 24  PI-MP-REFERENCE-SFX     PIC XX.
   624
   625         16  PI-LABEL-CONTROL            PIC X(01).
   626             88  PI-CREATE-LABELS                    VALUE 'Y'.
   627             88  PI-BYPASS-LABELS                    VALUE 'N'.
   628
   629         16  PI-BILL-GROUPING-CODE       PIC X(01).
   630             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   631
   632         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   633             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   634             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   635
   636         16  FILLER                      PIC X(14).
   637
   638     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   639******************************************************************
   640     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   641*    COPY ELC1042.
   642******************************************************************
   643*                                                                *
   644*                                                                *
   645*                           ELC1042                              *
   646*                            VMOD=2.002                          *
   647*                                                                *
   648*    NOTE                                                        *
   649*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   650*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   651*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  13
* EL691.cbl
   652*        TO THESE PROGRAMS.                                      *
   653*                                                                *
   654*    NOTE                                                        *
   655*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   656*        USE ONLY!                                               *
   657*                                                                *
   658******************************************************************
   659
   660         16  PI-1042-WA.
   661             20  PI-ACTION       PIC  X(01).
   662                 88 PI-SHOW-MODE           VALUE '1'.
   663                 88 PI-CLEAR-MODE          VALUE '2'.
   664                 88 PI-CREATE-MODE         VALUE '3'.
   665             20  PI-COMM-CONTROL PIC  X(12).
   666             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   667             20  PI-EOF-SW       PIC  X(01).
   668                 88  PI-FILE-EOF           VALUE 'Y'.
   669             20  PI-FILETYP      PIC  X(01).
   670             20  PI-FORM-SQUEEZE-CONTROL
   671                                 PIC  X(01).
   672                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   673                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   674             20  PI-LAST-CONTROL PIC  X(12).
   675             20  PI-TEMP-STOR-ITEMS
   676                                 PIC S9(04) COMP.
   677             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   678             20  PI-UPDATE-SW    PIC  9(01).
   679                 88 ANY-UPDATES            VALUE 1.
   680             20  PI-104-SCREEN-SENT-IND
   681                                 PIC  X(01).
   682                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   683                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   684             20  PI-1042-SCREEN-SENT-IND
   685                                 PIC  X(01).
   686                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   687                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   688             20  PI-1042-ARCHIVE-IND
   689                                 PIC  X(01).
   690                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   691             20  FILLER          PIC  X(29).
   692*    COPY ELC689PI.
   693******************************************************************
   694*                                                                *
   695*                            ELC689PI                            *
   696*                            VMOD=2.003                          *
   697*                                                                *
   698*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   699*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   700*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   701*                                                                *
   702*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   703*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   704*    BETWEEN PROGRAMS.                                           *
   705*                                                                *
   706*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   707*                                                                *
   708*               EL631 - EL689  - EL6891 - EL6892                 *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  14
* EL691.cbl
   710******************************************************************
   711*                   C H A N G E   L O G
   712*
   713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   714*-----------------------------------------------------------------
   715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   716* EFFECTIVE    NUMBER
   717*-----------------------------------------------------------------
   718* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   719* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   720* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   721******************************************************************
   722
   723
   724         16  PI-689-WORK-AREA.
   725             20  PI-689-ALT-PRINTER-ID
   726                                 PIC  X(04).
   727             20  PI-689-ARCHIVE-NUMBER
   728                                 PIC  9(08).
   729             20  PI-689-ARCHIVE-SW
   730                                 PIC  X(01).
   731                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   732             20  PI-689-DATA-SOURCE
   733                                 PIC  X(01).
   734                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   735                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   736                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   737                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   738                 88  PI-689-SRC-CHECKS         VALUE '5'.
   739             20  PI-689-ERROR-IND
   740                                 PIC  X(01).
   741                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   742             20  PI-689-ERROR    PIC  9(04).
   743                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   744                 88  PI-689-FATAL-ERROR
   745                     VALUES 0004 0006 0008 0013 0023 0029 0033
   746                            0042 0047 0051 0066 0067 0070
   747                            0168 0169 0174 0175 0176 0177 0179
   748                            0180 0181 0182 0184 0185 0189 0190
   749                            0191
   750                            0215 0279 0280
   751                            0412 0413 0454
   752                            0533 0537
   753                            2055 2114 2208 2209 2216 2232 2369
   754                            2398 2433 2908 2999
   755                            3000 3770 3771 3775
   756                            7250 7365 7367 7368 7369 7370 7371
   757                            7272 7373 7374 7376 7377 7378 7379
   758                            7381 7388 7390 7393 7395 7396 7398
   759                            9095 9096 9281 9298 9299 9320 9327
   760                            9426 9427.
   761                 88  PI-689-STOP-ERROR
   762                     VALUES 0004 0008 0013 0023 0029 0033
   763                            0042 0047 0066 0067 0070
   764                            0168 0169 0174 0175 0176 0177
   765                            0181 0182 0184 0185 0189 0190
   766                            0279 0280
   767                            0412 0413 0454
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  15
* EL691.cbl
   768                            2055 2208 2209 2216 2232
   769                            2398 2999
   770                            3000 3770 3771 3775
   771                            7250 7365 7369 7370 7371
   772                            7272 7373 7374 7376 7377 7378 7379
   773                            7381 7388 7390 7393 7396 7398
   774                            9095 9096 9299 9320 9426.
   775             20  PI-689-FOLLOW-UP-DATE
   776                                 PIC  X(02).
   777             20  PI-689-FORM-NUMBER
   778                                 PIC  X(04).
   779             20  PI-689-LABEL-SOURCE
   780                                 PIC X(01).
   781                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   782                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   783                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   784                 88  PI-689-SOURCE-COMP     VALUE '4'.
   785                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   786                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   787                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   788             20  PI-689-NUMBER-COPIES
   789                                 PIC  9(01).
   790             20  PI-689-NUMBER-LABEL-LINES
   791                                 PIC  9(01).
   792             20  PI-689-NUMBER-TEXT-RECORDS
   793                                 PIC  9(03).
   794             20  PI-689-PRINT-ORDER-SW
   795                                 PIC  X(01).
   796                 88  PI-689-PRINT-FIRST     VALUE '1'.
   797                 88  PI-689-PRINT-SECOND    VALUE '2'.
   798                 88  PI-689-PRINT-LATER     VALUE '3'.
   799                 88  PI-689-PRINT-ONLY      VALUE '4'.
   800             20  PI-689-PRINT-RESTRICTION
   801                                 PIC  X(01).
   802                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   803                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
   804                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   805             20  PI-689-PRINT-SW PIC  X(01).
   806                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   807             20  PI-689-RESEND-DATE-1
   808                                 PIC  X(02).
   809             20  PI-689-RESEND-LETR-1
   810                                 PIC X(4).
   811             20  PI-689-TEMP-STOR-ID
   812                                 PIC  X(08).
   813             20  PI-689-USE-SCREEN-IND
   814                                 PIC  X(01).
   815                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   816             20  PI-689-ARCH-POINTER
   817                                 PIC S9(08) COMP.
   818                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   819             20  PI-689-ARCT-POINTER
   820                                 PIC S9(08) COMP.
   821                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   822             20  PI-689-VARIABLE-DATA-GRP.
   823                 24  PI-689-VARIABLE-DATA-1
   824                                 PIC  X(30).
   825                 24  PI-689-VARIABLE-DATA-2
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  16
* EL691.cbl
   826                                 PIC  X(30).
   827                 24  PI-689-VARIABLE-DATA-3
   828                                 PIC  X(30).
   829                 24  PI-689-VARIABLE-DATA-4
   830                                 PIC  X(30).
   831
   832         16  PI-689-KEY-DATA-FIELDS.
   833             20  PI-689-ACCOUNT  PIC  X(10).
   834             20  PI-689-CARRIER  PIC  X(01).
   835             20  PI-689-CERT-NO.
   836                 24  PI-689-CERT-PRIME
   837                                 PIC  X(10).
   838                 24  PI-689-CERT-SFX
   839                                 PIC  X(01).
   840             20  PI-689-CHG-SEQ-NO
   841                                 PIC S9(04)    COMP.
   842             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
   843                                 PIC  X(02).
   844             20  PI-689-ENTRY-BATCH
   845                                 PIC  X(06).
   846             20  PI-689-EFF-DATE PIC  X(02).
   847             20  PI-689-EXP-DATE PIC  X(02).
   848             20  PI-689-GROUPING PIC  X(06).
   849             20  PI-689-RESP-PERSON
   850                                 PIC  X(10).
   851             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   852             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   853                                 PIC  X(04).
   854             20  PI-689-STATE    PIC  X(02).
   855             20  PI-689-TYPE     PIC  X(01).
   856             20  PI-689-CONTROL  PIC S9(08)    COMP.
   857             20  PI-689-ALT-SEQ-NO
   858                                 PIC S9(04)    COMP.
   859         16  PI-689-DATE-EDIT    PIC  X(08).
   860         16  PI-689-FOLLOW-UP-EDIT
   861                                 PIC  X(08).
   862         16  PI-689-RESEND1-EDIT PIC  X(08).
   863         16  PI-689-SEQ-EDIT     PIC  X(08).
   864         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   865         16  PI-689-LBL-OVERRIDE PIC  X(01).
   866             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   867         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   868         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   869         16  PI-690-WORK-AREA.
   870             20  PI-690-ARCHIVE-TABLE.
   871                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
   872                                 PIC S9(08) COMP.
   873             20  PI-690-CURSOR   PIC S9(04) COMP.
   874             20  PI-690-FIRST-DATA.
   875                 24  PI-690-FIRST-CERT-NO.
   876                     28  PI-690-FIRST-CERT-PRIME
   877                                 PIC  X(10).
   878                     28  PI-690-FIRST-SUFFIX
   879                                 PIC  X(01).
   880                 24  PI-690-FIRST-CARRIER
   881                                 PIC  X(01).
   882                 24  PI-690-FIRST-GROUPING
   883                                 PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  17
* EL691.cbl
   884                 24  PI-690-FIRST-STATE
   885                                 PIC  X(02).
   886                 24  PI-690-FIRST-ACCOUNT
   887                                 PIC  X(10).
   888                 24  PI-690-FIRST-EFFECT-DATE
   889                                 PIC  X(02).
   890                 24  PI-690-FIRST-ENTRY.
   891                     28  PI-690-FIRST-CONTROL-PREFIX
   892                                 PIC  X(02).
   893                     28  PI-690-FIRST-CONTROL
   894                                 PIC S9(08) COMP.
   895                 24  PI-690-FIRST-FORM
   896                                 PIC  X(04).
   897                 24  PI-690-FIRST-PROCESSOR
   898                                 PIC  X(04).
   899                 24  PI-690-FIRST-ARCHIVE-NO
   900                                 PIC S9(08) COMP.
   901             20  PI-690-INIT-DATA.
   902                 24  PI-690-INIT-CERT-NO.
   903                     28  PI-690-INIT-CERT-PRIME
   904                                 PIC  X(10).
   905                     28  PI-690-INIT-SUFFIX
   906                                 PIC  X(01).
   907                 24  PI-690-INIT-CARRIER
   908                                 PIC  X(01).
   909                 24  PI-690-INIT-GROUPING
   910                                 PIC  X(06).
   911                 24  PI-690-INIT-STATE
   912                                 PIC  X(02).
   913                 24  PI-690-INIT-ACCOUNT
   914                                 PIC  X(10).
   915                 24  PI-690-INIT-EFFECT-DATE
   916                                 PIC  X(02).
   917                 24  PI-690-INIT-EFF-DTE
   918                                 PIC  X(08).
   919                 24  PI-690-INIT-ENTRY.
   920                     28  PI-690-INIT-CONTROL-PREFIX
   921                                 PIC  X(02).
   922                     28  PI-690-INIT-CONTROL
   923                                 PIC S9(08) COMP.
   924                 24  PI-690-INIT-FORM
   925                                 PIC  X(04).
   926                 24  PI-690-INIT-PROCESSOR
   927                                 PIC  X(04).
   928                 24  PI-690-INIT-ARCHIVE-NO
   929                                 PIC S9(08) COMP.
   930             20  PI-690-LAST-DATA.
   931                 24  PI-690-LAST-CERT-NO.
   932                     28  PI-690-LAST-CERT-PRIME
   933                                 PIC  X(10).
   934                     28  PI-690-LAST-SUFFIX
   935                                 PIC  X(01).
   936                 24  PI-690-LAST-CARRIER
   937                                 PIC  X(01).
   938                 24  PI-690-LAST-GROUPING
   939                                 PIC  X(06).
   940                 24  PI-690-LAST-STATE
   941                                 PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  18
* EL691.cbl
   942                 24  PI-690-LAST-ACCOUNT
   943                                 PIC  X(10).
   944                 24  PI-690-LAST-EFFECT-DATE
   945                                 PIC  X(02).
   946                 24  PI-690-LAST-ENTRY.
   947                     28  PI-690-LAST-CONTROL-PREFIX
   948                                 PIC  X(02).
   949                     28  PI-690-LAST-CONTROL
   950                                 PIC S9(08) COMP.
   951                 24  PI-690-LAST-FORM
   952                                 PIC  X(04).
   953                 24  PI-690-LAST-PROCESSOR
   954                                 PIC  X(04).
   955                 24  PI-690-LAST-ARCHIVE-NO
   956                                 PIC S9(08) COMP.
   957             20  PI-690-LAST-ARCH-NDX
   958                                 PIC S9(04) COMP.
   959             20  PI-690-BRWS-TYPE-IND
   960                                 PIC  9(01).
   961                 88  PI-690-BRWS-CERTRP               VALUE 1.
   962                 88  PI-690-BRWS-FORM                 VALUE 2.
   963                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
   964                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
   965                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
   966                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
   967             20  PI-690-LAST-BROWSE-IND
   968                                 PIC  X(01).
   969                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
   970                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
   971             20  PI-690-STATUS-SELECTION-IND
   972                                 PIC  X(01).
   973                 88  PI-690-SELECT-ALL       VALUE 'N'.
   974                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
   975                                               'X' 'P' 'V' 'N'.
   976         16  PI-ARCHIVE-COMPLETE    PIC X(01).
   977         16  PI-ARCHIVE-RECEIVED    PIC X(01).
   978         16  PI-ARCHIVE-STOPPED     PIC X(01).
   979         16  PI-ARCHIVE-FINAL       PIC X(01).
   980         16  PI-COMMENT-INDEX       PIC S9(4) COMP.
   981         16  PI-ARCHIVE-LTRID       PIC X(4).
   982         16  pi-create-date         pic x(08).
   983         16  pi-initial-print-date  pic xx.
   984         16  FILLER              PIC X(49).
   985
   986 01  W-CONSTANT-AREA.
   987     12  FILLER                  PIC  X(18)
   988                                 VALUE 'PROGRAM CONSTANTS:'.
   989     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
   990
   991     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
   992     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
   993     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
   994     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
   995     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
   996     12  W-MAP                   PIC  X(08)  VALUE 'EL691A'.
   997     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
   998         16  FILLER              PIC  X(02).
   999         16  W-MAP-NUM           PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  19
* EL691.cbl
  1000     12  W-MAPSET                PIC  X(08)  VALUE 'EL691S'.
  1001     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL691'.
  1002     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXN1'.
  1003     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
  1004     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
  1005     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
  1006     12  SLASH                   PIC X       VALUE '/'.
  1007     12  W-ZEROS                 PIC  S9(03) VALUE +0 COMP-3.
  1008     12  W-ADD-ARCT              PIC  X      VALUE 'N'.
  1009     12  W-DONE-ADDING           PIC  X      VALUE 'N'.
  1010     12  W-NEED-COMMENT          PIC  X      VALUE 'N'.
  1011
  1012 01  ERROR-MESSAGES.
  1013     12  ER-0000                 PIC  X(04) VALUE '0000'.
  1014     12  ER-0004                 PIC  X(04) VALUE '0004'.
  1015     12  ER-0029                 PIC  X(04) VALUE '0029'.
  1016     12  ER-0051                 PIC  X(04) VALUE '0051'.
  1017     12  ER-0070                 PIC  X(04) VALUE '0070'.
  1018     12  ER-0249                 PIC  X(04) VALUE '0249'.
  1019     12  ER-0295                 PIC  X(04) VALUE '0295'.
  1020     12  ER-0296                 PIC  X(04) VALUE '0296'.
  1021     12  ER-0539                 PIC  X(04) VALUE '0539'.
  1022     12  ER-0895                 PIC  X(04) VALUE '0895'.
  1023     12  ER-0897                 PIC  X(04) VALUE '0897'.
  1024     12  ER-1236                 PIC  X(04) VALUE '1236'.
  1025     12  ER-3112                 PIC  X(04) VALUE '3112'.
  1026     12  ER-7008                 PIC  X(04) VALUE '7008'.
  1027     12  ER-7330                 PIC  X(04) VALUE '7330'.
  1028     12  ER-7331                 PIC  X(04) VALUE '7331'.
  1029     12  ER-7332                 PIC  X(04) VALUE '7332'.
  1030     12  ER-7333                 PIC  X(04) VALUE '7333'.
  1031     12  ER-7334                 PIC  X(04) VALUE '7334'.
  1032     12  ER-7363                 PIC  X(04) VALUE '7363'.
  1033     12  ER-7364                 PIC  X(04) VALUE '7364'.
  1034     12  ER-7371                 PIC  X(04) VALUE '7371'.
  1035     12  ER-7373                 PIC  X(04) VALUE '7373'.
  1036     12  ER-7388                 PIC  X(04) VALUE '7388'.
  1037     12  ER-9097                 PIC  X(04) VALUE '9097'.
  1038     12  ER-9245                 PIC  X(04) VALUE '9245'.
  1039*                                COPY ELCAID.
  1040******************************************************************
  1041*                                                                *
  1042*                            ELCAID.                             *
  1043*                            VMOD=2.001                          *
  1044*                                                                *
  1045*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1046*                                                                *
  1047*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1048*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1049******************************************************************
  1050
  1051 01  DFHAID.
  1052   02  DFHNULL   PIC  X  VALUE  ' '.
  1053   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1054   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1055   02  DFHPEN    PIC  X  VALUE  '='.
  1056   02  DFHOPID   PIC  X  VALUE  'W'.
  1057   02  DFHPA1    PIC  X  VALUE  '%'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  20
* EL691.cbl
  1058   02  DFHPA2    PIC  X  VALUE  '>'.
  1059   02  DFHPA3    PIC  X  VALUE  ','.
  1060   02  DFHPF1    PIC  X  VALUE  '1'.
  1061   02  DFHPF2    PIC  X  VALUE  '2'.
  1062   02  DFHPF3    PIC  X  VALUE  '3'.
  1063   02  DFHPF4    PIC  X  VALUE  '4'.
  1064   02  DFHPF5    PIC  X  VALUE  '5'.
  1065   02  DFHPF6    PIC  X  VALUE  '6'.
  1066   02  DFHPF7    PIC  X  VALUE  '7'.
  1067   02  DFHPF8    PIC  X  VALUE  '8'.
  1068   02  DFHPF9    PIC  X  VALUE  '9'.
  1069   02  DFHPF10   PIC  X  VALUE  ':'.
  1070   02  DFHPF11   PIC  X  VALUE  '#'.
  1071   02  DFHPF12   PIC  X  VALUE  '@'.
  1072   02  DFHPF13   PIC  X  VALUE  'A'.
  1073   02  DFHPF14   PIC  X  VALUE  'B'.
  1074   02  DFHPF15   PIC  X  VALUE  'C'.
  1075   02  DFHPF16   PIC  X  VALUE  'D'.
  1076   02  DFHPF17   PIC  X  VALUE  'E'.
  1077   02  DFHPF18   PIC  X  VALUE  'F'.
  1078   02  DFHPF19   PIC  X  VALUE  'G'.
  1079   02  DFHPF20   PIC  X  VALUE  'H'.
  1080   02  DFHPF21   PIC  X  VALUE  'I'.
  1081*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1082   02  DFHPF22   PIC  X  VALUE  '['.
  1083   02  DFHPF23   PIC  X  VALUE  '.'.
  1084   02  DFHPF24   PIC  X  VALUE  '<'.
  1085   02  DFHMSRE   PIC  X  VALUE  'X'.
  1086   02  DFHSTRF   PIC  X  VALUE  'h'.
  1087   02  DFHTRIG   PIC  X  VALUE  '"'.
  1088 01  FILLER    REDEFINES DFHAID.
  1089     12  FILLER                  PIC  X(08).
  1090     12  PF-VALUES               PIC  X(01) OCCURS 2.
  1091*                                COPY ELCATTR.
  1092******************************************************************
  1093*                                                                *
  1094*                            ELCATTR.                            *
  1095*                            VMOD=2.001                          *
  1096*                                                                *
  1097*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1098*                                                                *
  1099*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1100*                                                                *
  1101*                   POS 1   P=PROTECTED                          *
  1102*                           U=UNPROTECTED                        *
  1103*                           S=ASKIP                              *
  1104*                   POS 2   A=ALPHA/NUMERIC                      *
  1105*                           N=NUMERIC                            *
  1106*                   POS 3   N=NORMAL                             *
  1107*                           B=BRIGHT                             *
  1108*                           D=DARK                               *
  1109*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1110*                           OF=MODIFIED DATA TAG OFF             *
  1111*                                                                *
  1112*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1113******************************************************************
  1114 01  ATTRIBUTE-LIST.
  1115     12  AL-PABOF            PIC X       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  21
* EL691.cbl
  1116     12  AL-PABON            PIC X       VALUE 'Z'.
  1117     12  AL-PADOF            PIC X       VALUE '%'.
  1118     12  AL-PADON            PIC X       VALUE '_'.
  1119     12  AL-PANOF            PIC X       VALUE '-'.
  1120     12  AL-PANON            PIC X       VALUE '/'.
  1121     12  AL-SABOF            PIC X       VALUE '8'.
  1122     12  AL-SABON            PIC X       VALUE '9'.
  1123     12  AL-SADOF            PIC X       VALUE '@'.
  1124     12  AL-SADON            PIC X       VALUE QUOTE.
  1125     12  AL-SANOF            PIC X       VALUE '0'.
  1126     12  AL-SANON            PIC X       VALUE '1'.
  1127     12  AL-UABOF            PIC X       VALUE 'H'.
  1128     12  AL-UABON            PIC X       VALUE 'I'.
  1129     12  AL-UADOF            PIC X       VALUE '<'.
  1130     12  AL-UADON            PIC X       VALUE '('.
  1131     12  AL-UANOF            PIC X       VALUE ' '.
  1132     12  AL-UANON            PIC X       VALUE 'A'.
  1133     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1134     12  AL-UNBON            PIC X       VALUE 'R'.
  1135     12  AL-UNDOF            PIC X       VALUE '*'.
  1136     12  AL-UNDON            PIC X       VALUE ')'.
  1137     12  AL-UNNOF            PIC X       VALUE '&'.
  1138     12  AL-UNNON            PIC X       VALUE 'J'.
  1139*                                COPY ELCDATE.
  1140******************************************************************
  1141*                                                                *
  1142*                                                                *
  1143*                            ELCDATE.                            *
  1144*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1145*                            VMOD=2.003
  1146*                                                                *
  1147*                                                                *
  1148*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1149*                 LENGTH = 200                                   *
  1150******************************************************************
  1151
  1152 01  DATE-CONVERSION-DATA.
  1153     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1154     12  DC-OPTION-CODE                PIC X.
  1155         88  BIN-TO-GREG                VALUE ' '.
  1156         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1157         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1158         88  YMD-GREG-TO-BIN            VALUE '3'.
  1159         88  MDY-GREG-TO-BIN            VALUE '4'.
  1160         88  JULIAN-TO-BIN              VALUE '5'.
  1161         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1162         88  FIND-CENTURY               VALUE '7'.
  1163         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1164         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1165         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1166         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1167         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1168         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1169         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1170         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1171         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1172         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1173         88  CHECK-LEAP-YEAR            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  22
* EL691.cbl
  1174         88  BIN-3-TO-GREG              VALUE 'I'.
  1175         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1176         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1177         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1178         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1179         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1180         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1181         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1182         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1183         88  THREE-CHARACTER-BIN
  1184                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1185         88  GREGORIAN-TO-BIN
  1186                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1187         88  BIN-TO-GREGORIAN
  1188                  VALUES ' ' '1' 'I' '8' 'G'.
  1189         88  JULIAN-TO-BINARY
  1190                  VALUES '5' 'C' 'E' 'F'.
  1191     12  DC-ERROR-CODE                 PIC X.
  1192         88  NO-CONVERSION-ERROR        VALUE ' '.
  1193         88  DATE-CONVERSION-ERROR
  1194                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1195         88  DATE-IS-ZERO               VALUE '1'.
  1196         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1197         88  DATE-IS-INVALID            VALUE '3'.
  1198         88  DATE1-GREATER-DATE2        VALUE '4'.
  1199         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1200         88  DATE-INVALID-OPTION        VALUE '9'.
  1201         88  INVALID-CENTURY            VALUE 'A'.
  1202         88  ONLY-CENTURY               VALUE 'B'.
  1203         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1204         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1205     12  DC-END-OF-MONTH               PIC X.
  1206         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1207     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1208         88  USE-NORMAL-PROCESS         VALUE ' '.
  1209         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1210         88  ADJUST-UP-100-YRS          VALUE '2'.
  1211     12  FILLER                        PIC X.
  1212     12  DC-CONVERSION-DATES.
  1213         16  DC-BIN-DATE-1             PIC XX.
  1214         16  DC-BIN-DATE-2             PIC XX.
  1215         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1216         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1217                       DC-GREG-DATE-1-EDIT.
  1218             20  DC-EDIT1-MONTH        PIC 99.
  1219             20  SLASH1-1              PIC X.
  1220             20  DC-EDIT1-DAY          PIC 99.
  1221             20  SLASH1-2              PIC X.
  1222             20  DC-EDIT1-YEAR         PIC 99.
  1223         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1224         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1225                     DC-GREG-DATE-2-EDIT.
  1226             20  DC-EDIT2-MONTH        PIC 99.
  1227             20  SLASH2-1              PIC X.
  1228             20  DC-EDIT2-DAY          PIC 99.
  1229             20  SLASH2-2              PIC X.
  1230             20  DC-EDIT2-YEAR         PIC 99.
  1231         16  DC-GREG-DATE-1-YMD        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  23
* EL691.cbl
  1232         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1233                     DC-GREG-DATE-1-YMD.
  1234             20  DC-YMD-YEAR           PIC 99.
  1235             20  DC-YMD-MONTH          PIC 99.
  1236             20  DC-YMD-DAY            PIC 99.
  1237         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1238         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1239                      DC-GREG-DATE-1-MDY.
  1240             20  DC-MDY-MONTH          PIC 99.
  1241             20  DC-MDY-DAY            PIC 99.
  1242             20  DC-MDY-YEAR           PIC 99.
  1243         16  DC-GREG-DATE-1-ALPHA.
  1244             20  DC-ALPHA-MONTH        PIC X(10).
  1245             20  DC-ALPHA-DAY          PIC 99.
  1246             20  FILLER                PIC XX.
  1247             20  DC-ALPHA-CENTURY.
  1248                 24 DC-ALPHA-CEN-N     PIC 99.
  1249             20  DC-ALPHA-YEAR         PIC 99.
  1250         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1251         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1252         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1253         16  DC-JULIAN-DATE            PIC 9(05).
  1254         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1255                                       PIC 9(05).
  1256         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1257             20  DC-JULIAN-YEAR        PIC 99.
  1258             20  DC-JULIAN-DAYS        PIC 999.
  1259         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1260         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1261         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1262     12  DATE-CONVERSION-VARIBLES.
  1263         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1264         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1265             20  FILLER                PIC 9(3).
  1266             20  HOLD-CEN-1-CCYY.
  1267                 24  HOLD-CEN-1-CC     PIC 99.
  1268                 24  HOLD-CEN-1-YY     PIC 99.
  1269             20  HOLD-CEN-1-MO         PIC 99.
  1270             20  HOLD-CEN-1-DA         PIC 99.
  1271         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1272             20  HOLD-CEN-1-R-MO       PIC 99.
  1273             20  HOLD-CEN-1-R-DA       PIC 99.
  1274             20  HOLD-CEN-1-R-CCYY.
  1275                 24  HOLD-CEN-1-R-CC   PIC 99.
  1276                 24  HOLD-CEN-1-R-YY   PIC 99.
  1277             20  FILLER                PIC 9(3).
  1278         16  HOLD-CENTURY-1-X.
  1279             20  FILLER                PIC X(3)  VALUE SPACES.
  1280             20  HOLD-CEN-1-X-CCYY.
  1281                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1282                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1283             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1284             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1285         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1286             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1287             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1288             20  HOLD-CEN-1-R-X-CCYY.
  1289                 24  HOLD-CEN-1-R-X-CC PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  24
* EL691.cbl
  1290                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1291             20  FILLER                PIC XXX.
  1292         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1293         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1294         16  DC-JULIAN-DATE-1          PIC 9(07).
  1295         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1296             20  DC-JULIAN-1-CCYY.
  1297                 24  DC-JULIAN-1-CC    PIC 99.
  1298                 24  DC-JULIAN-1-YR    PIC 99.
  1299             20  DC-JULIAN-DA-1        PIC 999.
  1300         16  DC-JULIAN-DATE-2          PIC 9(07).
  1301         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1302             20  DC-JULIAN-2-CCYY.
  1303                 24  DC-JULIAN-2-CC    PIC 99.
  1304                 24  DC-JULIAN-2-YR    PIC 99.
  1305             20  DC-JULIAN-DA-2        PIC 999.
  1306         16  DC-GREG-DATE-A-EDIT.
  1307             20  DC-EDITA-MONTH        PIC 99.
  1308             20  SLASHA-1              PIC X VALUE '/'.
  1309             20  DC-EDITA-DAY          PIC 99.
  1310             20  SLASHA-2              PIC X VALUE '/'.
  1311             20  DC-EDITA-CCYY.
  1312                 24  DC-EDITA-CENT     PIC 99.
  1313                 24  DC-EDITA-YEAR     PIC 99.
  1314         16  DC-GREG-DATE-B-EDIT.
  1315             20  DC-EDITB-MONTH        PIC 99.
  1316             20  SLASHB-1              PIC X VALUE '/'.
  1317             20  DC-EDITB-DAY          PIC 99.
  1318             20  SLASHB-2              PIC X VALUE '/'.
  1319             20  DC-EDITB-CCYY.
  1320                 24  DC-EDITB-CENT     PIC 99.
  1321                 24  DC-EDITB-YEAR     PIC 99.
  1322         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1323         16  DC-GREG-DATE-CYMD-R REDEFINES
  1324                              DC-GREG-DATE-CYMD.
  1325             20  DC-CYMD-CEN           PIC 99.
  1326             20  DC-CYMD-YEAR          PIC 99.
  1327             20  DC-CYMD-MONTH         PIC 99.
  1328             20  DC-CYMD-DAY           PIC 99.
  1329         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1330         16  DC-GREG-DATE-MDCY-R REDEFINES
  1331                              DC-GREG-DATE-MDCY.
  1332             20  DC-MDCY-MONTH         PIC 99.
  1333             20  DC-MDCY-DAY           PIC 99.
  1334             20  DC-MDCY-CEN           PIC 99.
  1335             20  DC-MDCY-YEAR          PIC 99.
  1336    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1337        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1338    12  DC-EL310-DATE                  PIC X(21).
  1339    12  FILLER                         PIC X(28).
  1340*                                COPY ELCTEXT.
  1341******************************************************************
  1342*                                                                *
  1343*                                                                *
  1344*                            ELCTEXT.                            *
  1345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1346*                            VMOD=2.008                          *
  1347*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  25
* EL691.cbl
  1348*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1349*                                     FORM LETTERS,              *
  1350*                                     CERT FORM DISPLAY.
  1351*                                                                *
  1352*   FILE TYPE = VSAM,KSDS                                        *
  1353*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1354*                                                                *
  1355*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1356*       ALTERNATE INDEX = NONE                                   *
  1357*                                                                *
  1358*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1359*       ALTERNATE INDEX = NONE                                   *
  1360*                                                                *
  1361*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1362*       ALTERNATE INDEX = NONE                                   *
  1363*                                                                *
  1364*   LOG = NO                                                     *
  1365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1366******************************************************************
  1367 01  TEXT-FILES.
  1368     12  TEXT-FILE-ID                PIC XX.
  1369         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1370         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1371         88  HELP-FILE-TEXT             VALUE 'TH'.
  1372
  1373     12  TX-CONTROL-PRIMARY.
  1374         16  TX-COMPANY-CD           PIC X.
  1375             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1376         16  TX-ACCESS-CD-GENL       PIC X(12).
  1377
  1378         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1379             20  TX-LETTER-NO        PIC X(4).
  1380             20  FILLER              PIC X(8).
  1381
  1382         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1383             20  TX-FORM-NO          PIC X(12).
  1384
  1385         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1386             20  TX-HELP-TYPE        PIC X.
  1387                 88  HELP-FOR-GENERAL   VALUE ' '.
  1388                 88  HELP-BY-SCREEN     VALUE 'S'.
  1389                 88  HELP-BY-ERROR      VALUE 'E'.
  1390             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1391                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1392             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1393                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1394             20  FILLER              PIC X(4).
  1395
  1396         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1397
  1398     12  TX-PROCESS-CONTROL          PIC XX.
  1399         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1400
  1401     12  TX-TEXT-LINE                PIC X(70).
  1402
  1403     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1404         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1405         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  26
* EL691.cbl
  1406         88  TX-VALID-FORM-SQUEEZE-VALUE
  1407                                        VALUE 'Y' ' '.
  1408
  1409     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1410         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1411         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1412         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1413         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1414         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1415         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1416         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1417                                              'K' 'N' ' '
  1418                                              'Z'.
  1419
  1420     12  TX-ARCHIVE-SW               PIC X.
  1421         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1422         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1423         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1424
  1425     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1426     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1427
  1428     12  TX-BSR-CODE                 PIC X.
  1429         88  TX-BSR-LETTER              VALUE 'B'.
  1430         88  TX-NON-BSR-LETTER          VALUE ' '.
  1431
  1432     12  FILLER                      PIC X.
  1433*****************************************************************
  1434*                                COPY ELCNWA.
  1435*****************************************************************
  1436*                                                               *
  1437*                                                               *
  1438*                            ELCNWA.                            *
  1439*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1440*                            VMOD=2.003                         *
  1441*                                                               *
  1442*            M O V E   N A M E   W O R K   A R E A.             *
  1443*                                                               *
  1444*****************************************************************.
  1445
  1446 01  WS-NAME-WORK-AREA.
  1447     05  WS-INSURED-LAST-NAME        PIC X(15).
  1448     05  WS-INSURED-1ST-NAME         PIC X(12).
  1449     05  WS-INSURED-MID-INIT         PIC X.
  1450
  1451     05  WS-NAME-WORK.
  1452         10  WS-NW                   PIC X
  1453             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1454
  1455     05  WS-NAME-WORK2.
  1456         10  WS-NW2                  PIC X
  1457             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1458                                        NWA-INDEX0.
  1459
  1460     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1461                                     COMP-3.
  1462
  1463*                                COPY ELCEMIB.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  27
* EL691.cbl
  1464******************************************************************
  1465*                                                                *
  1466*                                                                *
  1467*                            ELCEMIB.                            *
  1468*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1469*                            VMOD=2.005                          *
  1470*                                                                *
  1471*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1472*                                                                *
  1473******************************************************************
  1474 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1475     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1476     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1477     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1478     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1479     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1480     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1481     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1482     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1483     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1484         88  EMI-NO-ERRORS                    VALUE '1'.
  1485         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1486         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1487     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1488         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1489     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1490         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1491         88  EMI-AREA1-FULL                   VALUE '2'.
  1492     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1493         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1494         88  EMI-AREA2-FULL                   VALUE '2'.
  1495     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1496         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1497         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1498         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1499         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1500         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1501     12  EMI-ERROR-LINES.
  1502         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1503         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1504         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1505         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1506             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1507                 24  EMI-ERR-NUM         PIC X(4).
  1508                 24  EMI-FILLER          PIC X.
  1509                 24  EMI-SEV             PIC X.
  1510                 24  FILLER              PIC X.
  1511             20  FILLER                  PIC X(02).
  1512     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1513         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1514             20  EMI-ERROR-NUMBER    PIC X(4).
  1515             20  EMI-FILL            PIC X.
  1516             20  EMI-SEVERITY        PIC X.
  1517             20  FILLER              PIC X.
  1518             20  EMI-ERROR-TEXT.
  1519                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1520                 24  FILLER          PIC X(55).
  1521     12  EMI-SEVERITY-SAVE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  28
* EL691.cbl
  1522         88  EMI-NOTE                    VALUE 'N'.
  1523         88  EMI-WARNING                 VALUE 'W'.
  1524         88  EMI-FORCABLE                VALUE 'F'.
  1525         88  EMI-FATAL                   VALUE 'X'.
  1526     12  EMI-MESSAGE-FLAG            PIC X.
  1527         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1528         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1529     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1530     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1531         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1532         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1533         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1534     12  emi-claim-no                pic x(7).
  1535     12  emi-claim-type              pic x(6).
  1536     12  FILLER                      PIC X(124)  VALUE SPACES.
  1537     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1538     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1539     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1540     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1541*                                COPY ERCCNOT.
  1542******************************************************************
  1543*                                                                *
  1544*                            ERCCNOT                             *
  1545*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1546*                            VMOD=2.003                          *
  1547*                                                                *
  1548*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1549*                                                                *
  1550*        FILE TYPE= VSAM,KSDS                                    *
  1551*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1552*                                                                *
  1553*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1554*                                                                *
  1555*        LOG = YES                                               *
  1556*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1557*                                                                *
  1558******************************************************************
  1559*                   C H A N G E   L O G
  1560*
  1561* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1562*-----------------------------------------------------------------
  1563*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1564* EFFECTIVE    NUMBER
  1565*-----------------------------------------------------------------
  1566* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1567******************************************************************
  1568
  1569 01  CERT-NOTE-FILE.
  1570     12  CZ-RECORD-ID                PIC  XX.
  1571         88  VALID-CZ-ID                  VALUE 'CZ'.
  1572
  1573     12  CZ-CONTROL-PRIMARY.
  1574         16  CZ-COMPANY-CD           PIC X.
  1575         16  CZ-CARRIER              PIC X.
  1576         16  CZ-GROUPING.
  1577             20 CZ-GROUPING-PREFIX   PIC XXX.
  1578             20 CZ-GROUPING-PRIME    PIC XXX.
  1579         16  CZ-STATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  29
* EL691.cbl
  1580         16  CZ-ACCOUNT.
  1581             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1582             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1583         16  CZ-CERT-EFF-DT          PIC XX.
  1584         16  CZ-CERT-NO.
  1585             20  CZ-CERT-PRIME       PIC X(10).
  1586             20  CZ-CERT-SFX         PIC X.
  1587         16  CZ-RECORD-TYPE          PIC X.
  1588             88  CERT-NOTE           VALUE '1'.
  1589             88  CLAIM-CERT-NOTE     VALUE '2'.
  1590         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1591
  1592     12  CZ-LAST-MAINT-DT            PIC XX.
  1593     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1594     12  CZ-LAST-MAINT-USER          PIC X(4).
  1595
  1596     12  CZ-NOTE-INFORMATION.
  1597         16  CZ-NOTE                 PIC X(63).
  1598         16  FILLER                  PIC X(39).
  1599******************************************************************
  1600 01  EMI-SAVE-AREA               PIC X(400).
  1601*                                COPY ELCLOGOF.
  1602******************************************************************
  1603*                                                                *
  1604*                                                                *
  1605*                            ELCLOGOF.                           *
  1606*                            VMOD=2.001                          *
  1607*                                                                *
  1608*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1609*                                                                *
  1610******************************************************************
  1611 01  CLASIC-LOGOFF.
  1612     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1613     12  LOGOFF-TEXT.
  1614         16  FILLER          PIC X(5)    VALUE SPACES.
  1615         16  LOGOFF-MSG.
  1616             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1617             20  FILLER      PIC X       VALUE SPACES.
  1618             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1619         16  FILLER          PIC X(80)
  1620           VALUE '* YOU ARE NOW LOGGED OFF'.
  1621         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1622         16  FILLER          PIC X       VALUE QUOTE.
  1623         16  LOGOFF-SYS-MSG  PIC X(17)
  1624           VALUE 'S CLAS-IC SYSTEM '.
  1625     12  TEXT-MESSAGES.
  1626         16  UNACCESS-MSG    PIC X(29)
  1627             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1628         16  PGMIDERR-MSG    PIC X(17)
  1629             VALUE 'PROGRAM NOT FOUND'.
  1630*                                COPY ELCSCTM.
  1631******************************************************************
  1632*                                                                *
  1633*                                                                *
  1634*                            ELCSCTM                             *
  1635*                            VMOD=2.001                          *
  1636*                                                                *
  1637*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  30
* EL691.cbl
  1638*                                                                *
  1639******************************************************************
  1640 01  SECURITY-MESSAGE.
  1641     12  FILLER                          PIC X(30)
  1642            VALUE '** LOGIC SECURITY VIOLATION -'.
  1643     12  SM-READ                         PIC X(6).
  1644     12  FILLER                          PIC X(5)
  1645            VALUE ' PGM='.
  1646     12  SM-PGM                          PIC X(6).
  1647     12  FILLER                          PIC X(5)
  1648            VALUE ' OPR='.
  1649     12  SM-PROCESSOR-ID                 PIC X(4).
  1650     12  FILLER                          PIC X(6)
  1651            VALUE ' TERM='.
  1652     12  SM-TERMID                       PIC X(4).
  1653     12  FILLER                          PIC XX   VALUE SPACE.
  1654     12  SM-JUL-DATE                     PIC 9(5).
  1655     12  FILLER                          PIC X    VALUE SPACE.
  1656     12  SM-TIME                         PIC 99.99.
  1657
  1658*                                COPY ELCSCRTY.
  1659******************************************************************
  1660*                                                                *
  1661*                                                                *
  1662*                            ELCSCRTY                            *
  1663*                            VMOD=2.001                          *
  1664*                                                                *
  1665*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1666*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1667*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1668*                                                                *
  1669******************************************************************
  1670 01  SECURITY-CONTROL.
  1671     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1672     12  FILLER                       PIC XX    VALUE 'SC'.
  1673     12  SC-CREDIT-CODES.
  1674         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1675             20  SC-CREDIT-DISPLAY    PIC X.
  1676             20  SC-CREDIT-UPDATE     PIC X.
  1677     12  SC-CLAIMS-CODES.
  1678         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1679             20  SC-CLAIMS-DISPLAY    PIC X.
  1680             20  SC-CLAIMS-UPDATE     PIC X.
  1681*                                COPY EL691S.
  1682 01  EL691AI.
  1683     05  FILLER            PIC  X(0012).
  1684*    -------------------------------
  1685     05  RUNDTEL PIC S9(0004) COMP.
  1686     05  RUNDTEF PIC  X(0001).
  1687     05  FILLER REDEFINES RUNDTEF.
  1688         10  RUNDTEA PIC  X(0001).
  1689     05  RUNDTEI PIC  X(0008).
  1690*    -------------------------------
  1691     05  RUNTIMEL PIC S9(0004) COMP.
  1692     05  RUNTIMEF PIC  X(0001).
  1693     05  FILLER REDEFINES RUNTIMEF.
  1694         10  RUNTIMEA PIC  X(0001).
  1695     05  RUNTIMEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  31
* EL691.cbl
  1696*    -------------------------------
  1697     05  COMPANYL PIC S9(0004) COMP.
  1698     05  COMPANYF PIC  X(0001).
  1699     05  FILLER REDEFINES COMPANYF.
  1700         10  COMPANYA PIC  X(0001).
  1701     05  COMPANYI PIC  X(0003).
  1702*    -------------------------------
  1703     05  USERIDL PIC S9(0004) COMP.
  1704     05  USERIDF PIC  X(0001).
  1705     05  FILLER REDEFINES USERIDF.
  1706         10  USERIDA PIC  X(0001).
  1707     05  USERIDI PIC  X(0004).
  1708*    -------------------------------
  1709     05  CARRIERL PIC S9(0004) COMP.
  1710     05  CARRIERF PIC  X(0001).
  1711     05  FILLER REDEFINES CARRIERF.
  1712         10  CARRIERA PIC  X(0001).
  1713     05  CARRIERI PIC  X(0001).
  1714*    -------------------------------
  1715     05  GROUPL PIC S9(0004) COMP.
  1716     05  GROUPF PIC  X(0001).
  1717     05  FILLER REDEFINES GROUPF.
  1718         10  GROUPA PIC  X(0001).
  1719     05  GROUPI PIC  X(0006).
  1720*    -------------------------------
  1721     05  STATEL PIC S9(0004) COMP.
  1722     05  STATEF PIC  X(0001).
  1723     05  FILLER REDEFINES STATEF.
  1724         10  STATEA PIC  X(0001).
  1725     05  STATEI PIC  X(0002).
  1726*    -------------------------------
  1727     05  ACCTL PIC S9(0004) COMP.
  1728     05  ACCTF PIC  X(0001).
  1729     05  FILLER REDEFINES ACCTF.
  1730         10  ACCTA PIC  X(0001).
  1731     05  ACCTI PIC  X(0010).
  1732*    -------------------------------
  1733     05  CERTL PIC S9(0004) COMP.
  1734     05  CERTF PIC  X(0001).
  1735     05  FILLER REDEFINES CERTF.
  1736         10  CERTA PIC  X(0001).
  1737     05  CERTI PIC  X(0010).
  1738*    -------------------------------
  1739     05  SFXL PIC S9(0004) COMP.
  1740     05  SFXF PIC  X(0001).
  1741     05  FILLER REDEFINES SFXF.
  1742         10  SFXA PIC  X(0001).
  1743     05  SFXI PIC  X(0001).
  1744*    -------------------------------
  1745     05  MAINTL PIC S9(0004) COMP.
  1746     05  MAINTF PIC  X(0001).
  1747     05  FILLER REDEFINES MAINTF.
  1748         10  MAINTA PIC  X(0001).
  1749     05  MAINTI PIC  X(0001).
  1750*    -------------------------------
  1751     05  MAINTBYL PIC S9(0004) COMP.
  1752     05  MAINTBYF PIC  X(0001).
  1753     05  FILLER REDEFINES MAINTBYF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  32
* EL691.cbl
  1754         10  MAINTBYA PIC  X(0001).
  1755     05  MAINTBYI PIC  X(0004).
  1756*    -------------------------------
  1757     05  MAINTDTL PIC S9(0004) COMP.
  1758     05  MAINTDTF PIC  X(0001).
  1759     05  FILLER REDEFINES MAINTDTF.
  1760         10  MAINTDTA PIC  X(0001).
  1761     05  MAINTDTI PIC  X(0008).
  1762*    -------------------------------
  1763     05  MAINTTML PIC S9(0004) COMP.
  1764     05  MAINTTMF PIC  X(0001).
  1765     05  FILLER REDEFINES MAINTTMF.
  1766         10  MAINTTMA PIC  X(0001).
  1767     05  MAINTTMI PIC  X(0005).
  1768*    -------------------------------
  1769     05  ARCHNOL PIC S9(0004) COMP.
  1770     05  ARCHNOF PIC  X(0001).
  1771     05  FILLER REDEFINES ARCHNOF.
  1772         10  ARCHNOA PIC  X(0001).
  1773     05  ARCHNOI PIC  X(0008).
  1774*    -------------------------------
  1775     05  ENDARCHL PIC S9(0004) COMP.
  1776     05  ENDARCHF PIC  X(0001).
  1777     05  FILLER REDEFINES ENDARCHF.
  1778         10  ENDARCHA PIC  X(0001).
  1779     05  ENDARCHI PIC  X(0008).
  1780*    -------------------------------
  1781     05  FORMNOL PIC S9(0004) COMP.
  1782     05  FORMNOF PIC  X(0001).
  1783     05  FILLER REDEFINES FORMNOF.
  1784         10  FORMNOA PIC  X(0001).
  1785     05  FORMNOI PIC  X(0004).
  1786*    -------------------------------
  1787     05  RESFORML PIC S9(0004) COMP.
  1788     05  RESFORMF PIC  X(0001).
  1789     05  FILLER REDEFINES RESFORMF.
  1790         10  RESFORMA PIC  X(0001).
  1791     05  RESFORMI PIC  X(0004).
  1792*    -------------------------------
  1793     05  CREATDTL PIC S9(0004) COMP.
  1794     05  CREATDTF PIC  X(0001).
  1795     05  FILLER REDEFINES CREATDTF.
  1796         10  CREATDTA PIC  X(0001).
  1797     05  CREATDTI PIC  X(0008).
  1798*    -------------------------------
  1799     05  RESENDL PIC S9(0004) COMP.
  1800     05  RESENDF PIC  X(0001).
  1801     05  FILLER REDEFINES RESENDF.
  1802         10  RESENDA PIC  X(0001).
  1803     05  RESENDI PIC  X(0008).
  1804*    -------------------------------
  1805     05  CREATBYL PIC S9(0004) COMP.
  1806     05  CREATBYF PIC  X(0001).
  1807     05  FILLER REDEFINES CREATBYF.
  1808         10  CREATBYA PIC  X(0001).
  1809     05  CREATBYI PIC  X(0004).
  1810*    -------------------------------
  1811     05  PRINTDTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  33
* EL691.cbl
  1812     05  PRINTDTF PIC  X(0001).
  1813     05  FILLER REDEFINES PRINTDTF.
  1814         10  PRINTDTA PIC  X(0001).
  1815     05  PRINTDTI PIC  X(0008).
  1816*    -------------------------------
  1817     05  RESPRNTL PIC S9(0004) COMP.
  1818     05  RESPRNTF PIC  X(0001).
  1819     05  FILLER REDEFINES RESPRNTF.
  1820         10  RESPRNTA PIC  X(0001).
  1821     05  RESPRNTI PIC  X(0008).
  1822*    -------------------------------
  1823     05  STCOMPL PIC S9(0004) COMP.
  1824     05  STCOMPF PIC  X(0001).
  1825     05  FILLER REDEFINES STCOMPF.
  1826         10  STCOMPA PIC  X(0001).
  1827     05  STCOMPI PIC  X(0019).
  1828*    -------------------------------
  1829     05  REPLYL PIC S9(0004) COMP.
  1830     05  REPLYF PIC  X(0001).
  1831     05  FILLER REDEFINES REPLYF.
  1832         10  REPLYA PIC  X(0001).
  1833     05  REPLYI PIC  X(0008).
  1834*    -------------------------------
  1835     05  STRECVL PIC S9(0004) COMP.
  1836     05  STRECVF PIC  X(0001).
  1837     05  FILLER REDEFINES STRECVF.
  1838         10  STRECVA PIC  X(0001).
  1839     05  STRECVI PIC  X(0019).
  1840*    -------------------------------
  1841     05  STOPDTEL PIC S9(0004) COMP.
  1842     05  STOPDTEF PIC  X(0001).
  1843     05  FILLER REDEFINES STOPDTEF.
  1844         10  STOPDTEA PIC  X(0001).
  1845     05  STOPDTEI PIC  X(0008).
  1846*    -------------------------------
  1847     05  STSTOPL PIC S9(0004) COMP.
  1848     05  STSTOPF PIC  X(0001).
  1849     05  FILLER REDEFINES STSTOPF.
  1850         10  STSTOPA PIC  X(0001).
  1851     05  STSTOPI PIC  X(0019).
  1852*    -------------------------------
  1853     05  OBVYNL PIC S9(0004) COMP.
  1854     05  OBVYNF PIC  X(0001).
  1855     05  FILLER REDEFINES OBVYNF.
  1856         10  OBVYNA PIC  X(0001).
  1857     05  OBVYNI PIC  X(0001).
  1858*    -------------------------------
  1859     05  FINDATEL PIC S9(0004) COMP.
  1860     05  FINDATEF PIC  X(0001).
  1861     05  FILLER REDEFINES FINDATEF.
  1862         10  FINDATEA PIC  X(0001).
  1863     05  FINDATEI PIC  X(0008).
  1864*    -------------------------------
  1865     05  STFINLL PIC S9(0004) COMP.
  1866     05  STFINLF PIC  X(0001).
  1867     05  FILLER REDEFINES STFINLF.
  1868         10  STFINLA PIC  X(0001).
  1869     05  STFINLI PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  34
* EL691.cbl
  1870*    -------------------------------
  1871     05  OBUIDL PIC S9(0004) COMP.
  1872     05  OBUIDF PIC  X(0001).
  1873     05  FILLER REDEFINES OBUIDF.
  1874         10  OBUIDA PIC  X(0001).
  1875     05  OBUIDI PIC  X(0005).
  1876*    -------------------------------
  1877     05  FINLACTL PIC S9(0004) COMP.
  1878     05  FINLACTF PIC  X(0001).
  1879     05  FILLER REDEFINES FINLACTF.
  1880         10  FINLACTA PIC  X(0001).
  1881     05  FINLACTI PIC  X(0001).
  1882*    -------------------------------
  1883     05  COMMENTL PIC S9(0004) COMP.
  1884     05  COMMENTF PIC  X(0001).
  1885     05  FILLER REDEFINES COMMENTF.
  1886         10  COMMENTA PIC  X(0001).
  1887     05  COMMENTI PIC  X(0069).
  1888*    -------------------------------
  1889     05  ERRMSG1L PIC S9(0004) COMP.
  1890     05  ERRMSG1F PIC  X(0001).
  1891     05  FILLER REDEFINES ERRMSG1F.
  1892         10  ERRMSG1A PIC  X(0001).
  1893     05  ERRMSG1I PIC  X(0079).
  1894*    -------------------------------
  1895     05  ERRMSG2L PIC S9(0004) COMP.
  1896     05  ERRMSG2F PIC  X(0001).
  1897     05  FILLER REDEFINES ERRMSG2F.
  1898         10  ERRMSG2A PIC  X(0001).
  1899     05  ERRMSG2I PIC  X(0079).
  1900 01  EL691AO REDEFINES EL691AI.
  1901     05  FILLER            PIC  X(0012).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  RUNDTEO PIC  X(0008).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  RUNTIMEO PIC  99.99.
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  COMPANYO PIC  X(0003).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  USERIDO PIC  X(0004).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  CARRIERO PIC  X(0001).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  GROUPO PIC  X(0006).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  STATEO PIC  X(0002).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  ACCTO PIC  X(0010).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  35
* EL691.cbl
  1928     05  CERTO PIC  X(0010).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  SFXO PIC  X(0001).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  MAINTO PIC  X(0001).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  MAINTBYO PIC  X(0004).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  MAINTDTO PIC  99B99B99.
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  MAINTTMO PIC  99.99.
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  ARCHNOO PIC  X(0008).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  ENDARCHO PIC  X(0008).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  FORMNOO PIC  X(0004).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  RESFORMO PIC  X(0004).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  CREATDTO PIC  99B99B99.
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  RESENDO PIC  99B99B99.
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  CREATBYO PIC  X(0004).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  PRINTDTO PIC  99B99B99.
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  RESPRNTO PIC  99B99B99.
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  STCOMPO PIC  X(0019).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  REPLYO PIC  99B99B99.
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  STRECVO PIC  X(0019).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  STOPDTEO PIC  99B99B99.
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  STSTOPO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  36
* EL691.cbl
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  OBVYNO PIC  X(0001).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  FINDATEO PIC  99B99B99.
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  STFINLO PIC  X(0019).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  OBUIDO PIC  ZZZ99.
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  FINLACTO PIC  X(0001).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  COMMENTO PIC  X(0069).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  ERRMSG1O PIC  X(0079).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  ERRMSG2O PIC  X(0079).
  2010*    -------------------------------
  2011****************************************************************
  2012*
  2013* Copyright (c) 2007-2013 Dell Inc.
  2014* All rights reserved.
  2015*
  2016****************************************************************
  2017 01  DFHEIV.
  2018   02  DFHEIV0               PIC X(35).
  2019   02  DFHEIV1               PIC X(08).
  2020   02  DFHEIV2               PIC X(08).
  2021   02  DFHEIV3               PIC X(08).
  2022   02  DFHEIV4               PIC X(06).
  2023   02  DFHEIV5               PIC X(04).
  2024   02  DFHEIV6               PIC X(04).
  2025   02  DFHEIV7               PIC X(02).
  2026   02  DFHEIV8               PIC X(02).
  2027   02  DFHEIV9               PIC X(01).
  2028   02  DFHEIV10              PIC S9(7) COMP-3.
  2029   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2030   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2031   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2032   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2033   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2034   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2035   02  DFHEIV17              PIC X(04).
  2036   02  DFHEIV18              PIC X(04).
  2037   02  DFHEIV19              PIC X(04).
  2038   02  DFHEIV20              USAGE IS POINTER.
  2039   02  DFHEIV21              USAGE IS POINTER.
  2040   02  DFHEIV22              USAGE IS POINTER.
  2041   02  DFHEIV23              USAGE IS POINTER.
  2042   02  DFHEIV24              USAGE IS POINTER.
  2043   02  DFHEIV25              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  37
* EL691.cbl
  2044   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2045   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2046   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2047   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2048   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2049   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2050   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2051   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2052   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2053   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2054   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2055   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2056   02  FILLER                PIC X(02).
  2057   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2058   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2059   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2060   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2061   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2062   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2063   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2064 LINKAGE  SECTION.
  2065*****************************************************************
  2066*                                                               *
  2067* Copyright (c) 2007-2013 Dell Inc.                             *
  2068* All rights reserved.                                          *
  2069*                                                               *
  2070*****************************************************************
  2071 01  dfheiblk.
  2072     02  eibtime          pic s9(7) comp-3.
  2073     02  eibdate          pic s9(7) comp-3.
  2074     02  eibtrnid         pic x(4).
  2075     02  eibtaskn         pic s9(7) comp-3.
  2076     02  eibtrmid         pic x(4).
  2077     02  dfheigdi         pic s9(4) comp.
  2078     02  eibcposn         pic s9(4) comp.
  2079     02  eibcalen         pic s9(4) comp.
  2080     02  eibaid           pic x(1).
  2081     02  eibfiller1       pic x(1).
  2082     02  eibfn            pic x(2).
  2083     02  eibfiller2       pic x(2).
  2084     02  eibrcode         pic x(6).
  2085     02  eibfiller3       pic x(2).
  2086     02  eibds            pic x(8).
  2087     02  eibreqid         pic x(8).
  2088     02  eibrsrce         pic x(8).
  2089     02  eibsync          pic x(1).
  2090     02  eibfree          pic x(1).
  2091     02  eibrecv          pic x(1).
  2092     02  eibsend          pic x(1).
  2093     02  eibatt           pic x(1).
  2094     02  eibeoc           pic x(1).
  2095     02  eibfmh           pic x(1).
  2096     02  eibcompl         pic x(1).
  2097     02  eibsig           pic x(1).
  2098     02  eibconf          pic x(1).
  2099     02  eiberr           pic x(1).
  2100     02  eibrldbk         pic x(1).
  2101     02  eiberrcd         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  38
* EL691.cbl
  2102     02  eibsynrb         pic x(1).
  2103     02  eibnodat         pic x(1).
  2104     02  eibfiller5       pic x(2).
  2105     02  eibresp          pic s9(8) comp.
  2106     02  eibresp2         pic s9(8) comp.
  2107     02  dfheigdj         pic s9(4) comp.
  2108     02  dfheigdk         pic s9(4) comp.
  2109 01  DFHCOMMAREA                 PIC X(1024).
  2110*                                COPY ERCARCH.
  2111******************************************************************
  2112*                                                                *
  2113*                            ERCARCH.                            *
  2114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2115*                            VMOD=2.002                          *
  2116*                                                                *
  2117*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2118*                                                                *
  2119*   FILE TYPE = VSAM,KSDS                                        *
  2120*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2121*                                                                *
  2122*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2123*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2124*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2125*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2126*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2127*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2128*                                                                *
  2129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2130******************************************************************
  2131*                   C H A N G E   L O G
  2132*
  2133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2134*-----------------------------------------------------------------
  2135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2136* EFFECTIVE    NUMBER
  2137*-----------------------------------------------------------------
  2138* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2139* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2140* 110612    2012101700002  AJRA  ADD NEW FIELDS
  2141* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  2142******************************************************************
  2143 01  LETTER-ARCHIVE.
  2144     12  LA-RECORD-ID                PIC  X(02).
  2145         88  LA-VALID-ID                VALUE 'LA'.
  2146
  2147     12  LA-CONTROL-PRIMARY.
  2148         16  LA-COMPANY-CD           PIC  X(01).
  2149         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2150
  2151     12  LA-CONTROL-BY-CERT-RESP.
  2152         16  LA-COMPANY-CD-A2        PIC  X(01).
  2153         16  LA-CERT-NO-A2.
  2154             20  LA-CERT-PRIME-A2    PIC  X(10).
  2155             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2156         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2157             20  LA-RESP-PERSON-A2   PIC  X(10).
  2158             20  LA-TYPE-A2          PIC  X(01).
  2159         16  LA-CARRIER-A2           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  39
* EL691.cbl
  2160         16  LA-GROUPING-A2          PIC  X(06).
  2161         16  LA-STATE-A2             PIC  X(02).
  2162         16  LA-ACCOUNT-A2           PIC  X(10).
  2163         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2164         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2165
  2166     12  LA-CONTROL-BY-FORM.
  2167         16  LA-COMPANY-CD-A3        PIC  X(01).
  2168         16  LA-FORM-A3              PIC  X(04).
  2169         16  LA-CARRIER-A3           PIC  X(01).
  2170         16  LA-GROUPING-A3          PIC  X(06).
  2171         16  LA-STATE-A3             PIC  X(02).
  2172         16  LA-ACCOUNT-A3           PIC  X(10).
  2173         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2174
  2175     12  LA-CONTROL-BY-PROCESSOR.
  2176         16  LA-COMPANY-CD-A4        PIC  X(01).
  2177         16  LA-PROCESSOR-CD         PIC  X(04).
  2178         16  LA-CARRIER-A4           PIC  X(01).
  2179         16  LA-GROUPING-A4          PIC  X(06).
  2180         16  LA-STATE-A4             PIC  X(02).
  2181         16  LA-ACCOUNT-A4           PIC  X(10).
  2182         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2183
  2184     12  LA-CONTROL-BY-KEY-FIELDS.
  2185         16  LA-COMPANY-CD-A5        PIC  X(01).
  2186         16  LA-CARRIER-A5           PIC  X(01).
  2187         16  LA-GROUPING-A5          PIC  X(06).
  2188         16  LA-STATE-A5             PIC  X(02).
  2189         16  LA-ACCOUNT-A5           PIC  X(10).
  2190         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2191
  2192     12  LA-CONTROL-BY-GROUP-CODE.
  2193         16  LA-COMPANY-CD-A6        PIC  X(01).
  2194         16  LA-ENTRY-A6.
  2195             20  LA-FILLER           PIC  X(02).
  2196             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2197         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2198
  2199     12  FILLER                      PIC  X(09).
  2200
  2201     12  LA-HEADER-RECORD.
  2202         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2203         16  LA-CREATION-DATE        PIC  X(02).
  2204         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2205         16  LA-FINAL-ACT-DATE       REDEFINES
  2206               LA-FOLLOW-UP-DATE     PIC  X(02).
  2207         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2208         16  LA-NO-OF-COPIES         PIC S9(01).
  2209         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2210         16  LA-REPLY-DATE           PIC  X(02).
  2211         16  LA-RESEND-DATES.
  2212             20  LA-RESEND-DATE      PIC  X(02).
  2213             20  LA-SENT-DATE        PIC  X(02).
  2214             20  FILLER              PIC  X(08).
  2215         16  LA-SOURCE-INFORMATION.
  2216             20  LA-DATA-SOURCE      PIC  X(01).
  2217             20  LA-ADDR-SOURCE      PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  40
* EL691.cbl
  2218         16  LA-STATUS               PIC  X(01).
  2219             88  LA-STATUS-ACTIVE         VALUE 'A'.
  2220             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2221             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2222             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2223             88  LA-STATUS-PURGED         VALUE 'P'.
  2224             88  LA-STATUS-VOIDED         VALUE 'V'.
  2225         16  LA-LAST-RESENT-PRINT-DATE
  2226                                     PIC  X(02).
  2227         16  LA-PRINT-RESTRICTION    PIC  X(01).
  2228             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2229                                          VALUE 'C'.
  2230             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2231                                          VALUE 'F'.
  2232             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2233                                          VALUE 'P'.
  2234         16  LA-PURGED-DATE          PIC  X(02).
  2235         16  LA-VOIDED-DATE          PIC  X(02).
  2236         16  LA-RESEND-LETR          PIC  X(4).
  2237         16  LA-VOID-ONBASE-YN       PIC  X.
  2238         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  2239         16  FILLER                  PIC  X(04).
  2240*        16  LA-RESEND-LETR-2        PIC  X(4).
  2241*        16  LA-RESEND-LETR-3        PIC  X(4).
  2242*        16  FILLER                  PIC  X(59).
  2243         16  LA-ARCHIVE-STATUS       PIC  X.
  2244             88  LA-TEMP                VALUE 'T'.
  2245             88  LA-QWS                 VALUE 'Q'.
  2246             88  LA-BATCH               VALUE 'B'.
  2247         16  LA-FINAL-ACT-IND        PIC  X(1).
  2248         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2249         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  2250         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  2251                                     PIC X(4).
  2252         16  FILLER                  PIC  X(42).
  2253*        16  FILLER                  PIC  X(71).
  2254         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2255         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2256         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2257                                     PIC  X(4).
  2258         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2259
  2260******************************************************************
  2261*                                COPY ERCARCT.
  2262******************************************************************
  2263*                                                                *
  2264*                            ERCARCT.                            *
  2265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2266*                            VMOD=2.002                          *
  2267*                                                                *
  2268*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  2269*                                                                *
  2270*   FILE TYPE = VSAM,KSDS                                        *
  2271*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  2272*                                                                *
  2273*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  2274*                                                                *
  2275*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  41
* EL691.cbl
  2276*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2277******************************************************************
  2278*                   C H A N G E   L O G
  2279*
  2280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2281*-----------------------------------------------------------------
  2282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2283* EFFECTIVE    NUMBER
  2284*-----------------------------------------------------------------
  2285* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2286******************************************************************
  2287 01  LETTER-ARCHIVE-TEXT.
  2288     12  LT-RECORD-ID                PIC  X(02).
  2289         88  LT-VALID-ID                VALUE 'LT'.
  2290
  2291     12  LT-CONTROL-PRIMARY.
  2292         16  LT-COMPANY-CD           PIC  X(01).
  2293         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  2294         16  LT-RECORD-TYPE          PIC  X(01).
  2295             88  LT-ADDRESS-DATA        VALUE '1'.
  2296             88  LT-TEXT-DATA           VALUE '2'.
  2297             88  LT-COMMENT-DATA        VALUE '3'.
  2298         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  2299
  2300     12  FILLER                      PIC  X(28).
  2301     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  2302
  2303     12  LT-TEXT-RECORD.
  2304         16  LT-LETTER-TEXT OCCURS 20 TIMES
  2305                            INDEXED BY LT-NDX.
  2306             20  LT-TEXT-LINE        PIC  X(70).
  2307             20  LT-SKIP-CONTROL     PIC  X(02).
  2308                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  2309                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  2310             20  FILLER              PIC  X(08).
  2311
  2312     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  2313         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  2314             20  LT-COMMENT-LINE     PIC X(69).
  2315             20  LT-COMMENT-CHG-DT   PIC X(02).
  2316             20  LT-COMMENT-CHG-BY   PIC X(04).
  2317             20  FILLER              PIC X(05).
  2318
  2319*                                COPY ELCCERT.
  2320******************************************************************
  2321*                                                                *
  2322*                            ELCCERT.                            *
  2323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2324*                            VMOD=2.013                          *
  2325*                                                                *
  2326*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2327*                                                                *
  2328*   FILE TYPE = VSAM,KSDS                                        *
  2329*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2330*                                                                *
  2331*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2332*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2333*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  42
* EL691.cbl
  2334*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2335*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2336*                                                                *
  2337*   LOG = YES                                                    *
  2338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2339******************************************************************
  2340*                   C H A N G E   L O G
  2341*
  2342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2343*-----------------------------------------------------------------
  2344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2345* EFFECTIVE    NUMBER
  2346*-----------------------------------------------------------------
  2347* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2348* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2349* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2350* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2351* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2352* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2353* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2354* 032612  CR2011110200001  PEMA  AHL CHANGES
  2355* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2356* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2357* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2358******************************************************************
  2359
  2360 01  CERTIFICATE-MASTER.
  2361     12  CM-RECORD-ID                      PIC XX.
  2362         88  VALID-CM-ID                      VALUE 'CM'.
  2363
  2364     12  CM-CONTROL-PRIMARY.
  2365         16  CM-COMPANY-CD                 PIC X.
  2366         16  CM-CARRIER                    PIC X.
  2367         16  CM-GROUPING.
  2368             20  CM-GROUPING-PREFIX        PIC X(3).
  2369             20  CM-GROUPING-PRIME         PIC X(3).
  2370         16  CM-STATE                      PIC XX.
  2371         16  CM-ACCOUNT.
  2372             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2373             20  CM-ACCOUNT-PRIME          PIC X(6).
  2374         16  CM-CERT-EFF-DT                PIC XX.
  2375         16  CM-CERT-NO.
  2376             20  CM-CERT-PRIME             PIC X(10).
  2377             20  CM-CERT-SFX               PIC X.
  2378
  2379     12  CM-CONTROL-BY-NAME.
  2380         16  CM-COMPANY-CD-A1              PIC X.
  2381         16  CM-INSURED-LAST-NAME          PIC X(15).
  2382         16  CM-INSURED-INITIALS.
  2383             20  CM-INSURED-INITIAL1       PIC X.
  2384             20  CM-INSURED-INITIAL2       PIC X.
  2385
  2386     12  CM-CONTROL-BY-SSN.
  2387         16  CM-COMPANY-CD-A2              PIC X.
  2388         16  CM-SOC-SEC-NO.
  2389             20  CM-SSN-STATE              PIC XX.
  2390             20  CM-SSN-ACCOUNT            PIC X(6).
  2391             20  CM-SSN-LN3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  43
* EL691.cbl
  2392                 25  CM-INSURED-INITIALS-A2.
  2393                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2394                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2395                 25 CM-PART-LAST-NAME-A2         PIC X.
  2396
  2397     12  CM-CONTROL-BY-CERT-NO.
  2398         16  CM-COMPANY-CD-A4              PIC X.
  2399         16  CM-CERT-NO-A4                 PIC X(11).
  2400
  2401     12  CM-CONTROL-BY-MEMB.
  2402         16  CM-COMPANY-CD-A5              PIC X.
  2403         16  CM-MEMBER-NO.
  2404             20  CM-MEMB-STATE             PIC XX.
  2405             20  CM-MEMB-ACCOUNT           PIC X(6).
  2406             20  CM-MEMB-LN4.
  2407                 25  CM-INSURED-INITIALS-A5.
  2408                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2409                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2410                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2411
  2412     12  CM-INSURED-PROFILE-DATA.
  2413         16  CM-INSURED-FIRST-NAME.
  2414             20  CM-INSURED-1ST-INIT       PIC X.
  2415             20  FILLER                    PIC X(9).
  2416         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2417         16  CM-INSURED-SEX                PIC X.
  2418             88  CM-SEX-MALE                  VALUE 'M'.
  2419             88  CM-SEX-FEMAL                 VALUE 'F'.
  2420         16  CM-INSURED-JOINT-AGE          PIC 99.
  2421         16  CM-JOINT-INSURED-NAME.
  2422             20  CM-JT-LAST-NAME           PIC X(15).
  2423             20  CM-JT-FIRST-NAME.
  2424                 24  CM-JT-1ST-INIT        PIC X.
  2425                 24  FILLER                PIC X(9).
  2426             20  CM-JT-INITIAL             PIC X.
  2427
  2428     12  CM-LIFE-DATA.
  2429         16  CM-LF-BENEFIT-CD              PIC XX.
  2430         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2431         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2432         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2433         16  CM-LF-DEV-CODE                PIC XXX.
  2434         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2435         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2436         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2437         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2438         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2439         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2440         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2441         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2442         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2443         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2444         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2445         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2446         16  cm-temp-epiq                  pic xx.
  2447             88  EPIQ-CLASS                  value 'EQ'.
  2448*        16  FILLER                        PIC XX.
  2449
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  44
* EL691.cbl
  2450     12  CM-AH-DATA.
  2451         16  CM-AH-BENEFIT-CD              PIC XX.
  2452         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2453         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2454         16  CM-AH-DEV-CODE                PIC XXX.
  2455         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2456         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2457         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2458         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2459         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2460         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2461         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2462         16  CM-AH-PAID-THRU-DT            PIC XX.
  2463             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2464         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2465         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2466         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2467         16  FILLER                        PIC X.
  2468
  2469     12  CM-LOAN-INFORMATION.
  2470         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2471         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2472                                           PIC S9(5)V99  COMP-3.
  2473         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2474         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2475         16  CM-PAY-FREQUENCY              PIC S99.
  2476         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2477         16  CM-RATE-CLASS                 PIC XX.
  2478         16  CM-BENEFICIARY                PIC X(25).
  2479         16  CM-POLICY-FORM-NO             PIC X(12).
  2480         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2481         16  CM-LAST-ADD-ON-DT             PIC XX.
  2482         16  CM-DEDUCTIBLE-AMOUNTS.
  2483             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2484             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2485         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2486             20  CM-RESIDENT-STATE         PIC XX.
  2487             20  CM-RATE-CODE              PIC X(4).
  2488             20  FILLER                    PIC XX.
  2489         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2490             20  CM-LOAN-OFFICER           PIC X(5).
  2491             20  FILLER                    PIC XXX.
  2492         16  CM-CSR-CODE                   PIC XXX.
  2493         16  CM-UNDERWRITING-CODE          PIC X.
  2494             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2495         16  CM-POST-CARD-IND              PIC X.
  2496         16  CM-REF-INTERFACE-SW           PIC X.
  2497         16  CM-PREMIUM-TYPE               PIC X.
  2498             88  CM-SING-PRM                  VALUE '1'.
  2499             88  CM-O-B-COVERAGE              VALUE '2'.
  2500             88  CM-OPEN-END                  VALUE '3'.
  2501         16  CM-IND-GRP-TYPE               PIC X.
  2502             88  CM-INDIVIDUAL                VALUE 'I'.
  2503             88  CM-GROUP                     VALUE 'G'.
  2504         16  CM-SKIP-CODE                  PIC X.
  2505             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2506             88  SKIP-JULY                    VALUE '1'.
  2507             88  SKIP-AUGUST                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  45
* EL691.cbl
  2508             88  SKIP-SEPTEMBER               VALUE '3'.
  2509             88  SKIP-JULY-AUG                VALUE '4'.
  2510             88  SKIP-AUG-SEPT                VALUE '5'.
  2511             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2512             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2513             88  SKIP-JUNE                    VALUE '8'.
  2514             88  SKIP-JUNE-JULY               VALUE '9'.
  2515             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2516             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2517         16  CM-PAYMENT-MODE               PIC X.
  2518             88  PAY-MONTHLY                  VALUE SPACE.
  2519             88  PAY-WEEKLY                   VALUE '1'.
  2520             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2521             88  PAY-BI-WEEKLY                VALUE '3'.
  2522             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2523         16  CM-LOAN-NUMBER                PIC X(8).
  2524         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2525         16  CM-OLD-LOF                    PIC XXX.
  2526*        16  CM-LOAN-OFFICER               PIC XXX.
  2527         16  CM-REIN-TABLE                 PIC XXX.
  2528         16  CM-SPECIAL-REIN-CODE          PIC X.
  2529         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2530         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2531         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2532
  2533     12  CM-STATUS-DATA.
  2534         16  CM-ENTRY-STATUS               PIC X.
  2535         16  CM-ENTRY-DT                   PIC XX.
  2536
  2537         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2538         16  CM-LF-CANCEL-DT               PIC XX.
  2539         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2540
  2541         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2542         16  CM-LF-DEATH-DT                PIC XX.
  2543         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2544
  2545         16  CM-LF-CURRENT-STATUS          PIC X.
  2546             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2547                                                'M' '4' '5' '9'.
  2548             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2549             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2550             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2551             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2552             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2553             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2554             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2555             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2556             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2557             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2558             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2559             88  CM-LF-DECLINED               VALUE 'D'.
  2560             88  CM-LF-VOIDED                 VALUE 'V'.
  2561
  2562         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2563         16  CM-AH-CANCEL-DT               PIC XX.
  2564         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2565
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  46
* EL691.cbl
  2566         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2567         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2568         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2569
  2570         16  CM-AH-CURRENT-STATUS          PIC X.
  2571             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2572                                                'M' '4' '5' '9'.
  2573             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2574             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2575             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2576             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2577             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2578             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2579             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2580             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2581             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2582             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2583             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2584             88  CM-AH-DECLINED               VALUE 'D'.
  2585             88  CM-AH-VOIDED                 VALUE 'V'.
  2586
  2587         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2588             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2589             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2590             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2591         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2592
  2593         16  CM-ENTRY-BATCH                PIC X(6).
  2594         16  CM-LF-EXIT-BATCH              PIC X(6).
  2595         16  CM-AH-EXIT-BATCH              PIC X(6).
  2596         16  CM-LAST-MONTH-END             PIC XX.
  2597
  2598     12  CM-NOTE-SW                        PIC X.
  2599         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2600         88  CERT-NOTES-PRESENT               VALUE '1'.
  2601         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2602         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2603         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2604         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2605         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2606         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2607     12  CM-COMP-EXCP-SW                   PIC X.
  2608         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2609         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2610     12  CM-INSURED-ADDRESS-SW             PIC X.
  2611         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2612         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2613
  2614*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2615     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2616     12  FILLER                            PIC X.
  2617
  2618*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2619     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2620     12  FILLER                            PIC X.
  2621*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2622     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2623
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  47
* EL691.cbl
  2624     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2625         88  CERT-ADDED-BATCH                 VALUE ' '.
  2626         88  CERT-ADDED-ONLINE                VALUE '1'.
  2627         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2628         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2629         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2630     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2631         88  CERT-AS-LOADED                   VALUE ' '.
  2632         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2633         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2634         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2635         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2636         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2637         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2638         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2639
  2640     12  CM-ACCOUNT-COMM-PCTS.
  2641         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2642         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2643
  2644     12  CM-USER-FIELD                     PIC X.
  2645     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2646     12  CM-CLP-STATE                      PIC XX.
  2647     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2648     12  CM-USER-RESERVED                  PIC XXX.
  2649     12  FILLER REDEFINES CM-USER-RESERVED.
  2650         16  CM-AH-CLASS-CD                PIC XX.
  2651         16  F                             PIC X.
  2652******************************************************************
  2653*                                COPY ELCEOBC.
  2654******************************************************************
  2655*                                                                *
  2656*                                                                *
  2657*                            ELCEOBC                             *
  2658*                            VMOD=2.001                          *
  2659*                                                                *
  2660*   CLAIM SYSTEM EOB CODE TABLE                                  *
  2661*                                                                *
  2662*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2663*   VSAM EOB CODE TABLE                                          *
  2664*                                                                *
  2665*   FILE DESCRIPTION = EOB CODE TABLE                            *
  2666*                                                                *
  2667*   FILE TYPE = VSAM,KSDS                                        *
  2668*   RECORD SIZE = 350   RECFORM = FIX                            *
  2669*                                                                *
  2670*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  2671*                                                                *
  2672*   LOG = NO                                                     *
  2673*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2674*                                                                *
  2675*                                                                *
  2676******************************************************************
  2677*                   C H A N G E   L O G
  2678*
  2679* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2680*-----------------------------------------------------------------
  2681*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  48
* EL691.cbl
  2682* EFFECTIVE    NUMBER
  2683*-----------------------------------------------------------------
  2684* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  2685* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  2686* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  2687******************************************************************
  2688 01  EOB-CODES.
  2689     12  EO-RECORD-ID                      PIC XX.
  2690         88  VALID-DN-ID                      VALUE 'EO'.
  2691     12  EO-CONTROL-PRIMARY.
  2692         16  EO-COMPANY-CD                 PIC X.
  2693         16  EO-RECORD-TYPE                PIC X.
  2694             88  EO-EOB-RECS                  VALUE '1'.
  2695             88  EO-VERIF-RECS                VALUE '2'.
  2696             88  EO-GCE-RECS                  VALUE '3'.
  2697             88  EO-CANC-RECS                 VALUE '4'.
  2698             88  EO-BILL-NOTE-RECS            VALUE '5'.
  2699         16  EO-EOB-CODE                   PIC X(4).
  2700         16  FILLER                        PIC X(9).
  2701     12  EO-MAINT-INFORMATION.
  2702         16  EO-LAST-MAINT-DT              PIC XX.
  2703         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2704         16  EO-LAST-MAINT-USER            PIC X(4).
  2705         16  FILLER                        PIC XX.
  2706     12  EO-DESCRIPTION                    PIC X(275).
  2707     12  FILLER                            PIC X(46).
  2708******************************************************************
  2709*                                COPY ERCNOTE.
  2710******************************************************************
  2711*                                                                *
  2712*                                                                *
  2713*                            ERCNOTE                             *
  2714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2715*                            VMOD=2.003                          *
  2716*                                                                *
  2717*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2718*                                                                *
  2719*        FILE TYPE= VSAM,KSDS                                    *
  2720*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2721*                                                                *
  2722*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  2723*                                                                *
  2724*        LOG = YES                                               *
  2725*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2726*                                                                *
  2727******************************************************************
  2728*                   C H A N G E   L O G
  2729*
  2730* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2731*-----------------------------------------------------------------
  2732*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2733* EFFECTIVE    NUMBER
  2734*-----------------------------------------------------------------
  2735* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2736*                                FILE WILL CONTAIN BILLING NOTES O
  2737* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  2738******************************************************************
  2739
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  49
* EL691.cbl
  2740 01  CERTIFICATE-NOTE.
  2741     12  CN-RECORD-ID                PIC  XX.
  2742         88  VALID-CN-ID                  VALUE 'CN'.
  2743
  2744     12  CN-CONTROL-PRIMARY.
  2745         16  CN-COMPANY-CD           PIC X.
  2746         16  CN-CARRIER              PIC X.
  2747         16  CN-GROUPING.
  2748             20 CN-GROUPING-PREFIX   PIC XXX.
  2749             20 CN-GROUPING-PRIME    PIC XXX.
  2750         16  CN-STATE                PIC XX.
  2751         16  CN-ACCOUNT.
  2752             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2753             20 CN-ACCOUNT-PRIME     PIC X(6).
  2754         16  CN-CERT-EFF-DT          PIC XX.
  2755         16  CN-CERT-NO.
  2756             20  CN-CERT-PRIME       PIC X(10).
  2757             20  CN-CERT-SFX         PIC X.
  2758         16  CN-RECORD-TYPE          PIC X.
  2759             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  2760             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  2761     12  CN-BILLING-START-LINE-NO    PIC 99.
  2762     12  CN-BILLING-END-LINE-NO      PIC 99.
  2763
  2764     12  CN-LINES.
  2765         16  CN-LINE OCCURS 10       PIC X(77).
  2766
  2767     12  CN-LAST-MAINT-DT            PIC XX.
  2768     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2769     12  CN-LAST-MAINT-USER          PIC X(4).
  2770     12  FILLER                      PIC X(5).
  2771******************************************************************
  2772 01  var                         pic x(30).
  2773 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  2774                          LETTER-ARCHIVE-TEXT
  2775                          CERTIFICATE-MASTER EOB-CODES
  2776                          CERTIFICATE-NOTE VAR.
  2777 0000-DFHEXIT SECTION.
  2778     MOVE '9#                    $   ' TO DFHEIV0.
  2779     MOVE 'EL691' TO DFHEIV1.
  2780     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2781     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2782
  2783     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2784     MOVE '5'                    TO DC-OPTION-CODE.
  2785     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  2786     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  2787     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  2788                                    W-CURRENT-SAVE.
  2789
  2790     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2791     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2792                                 TO EMI-SAVE-AREA.
  2793
  2794     IF  EIBCALEN EQUAL 0
  2795         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  2796         GO TO 8300-SEND-TEXT
  2797     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  50
* EL691.cbl
  2798     set P to address of KIXSYS
  2799     CALL "getenv" using by value P returning var-ptr
  2800     if var-ptr = null then
  2801        display ' kixsys not set '
  2802     else
  2803        set address of var to var-ptr
  2804        move 0 to env-var-len
  2805        inspect var tallying env-var-len
  2806          for characters before X'00'
  2807        unstring var (1:env-var-len) delimited by '/'
  2808           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2809              WS-KIX-SYS
  2810        end-unstring
  2811     end-if
  2812     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  2813         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  2814             MOVE PI-SAVED-PROGRAM-5
  2815                                 TO PI-SAVED-PROGRAM-6
  2816             MOVE PI-SAVED-PROGRAM-4
  2817                                 TO PI-SAVED-PROGRAM-5
  2818             MOVE PI-SAVED-PROGRAM-3
  2819                                 TO PI-SAVED-PROGRAM-4
  2820             MOVE PI-SAVED-PROGRAM-2
  2821                                 TO PI-SAVED-PROGRAM-3
  2822             MOVE PI-SAVED-PROGRAM-1
  2823                                 TO PI-SAVED-PROGRAM-2
  2824             MOVE PI-RETURN-TO-PROGRAM
  2825                                 TO PI-SAVED-PROGRAM-1
  2826             MOVE PI-CALLING-PROGRAM
  2827                                 TO PI-RETURN-TO-PROGRAM
  2828             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  2829         ELSE
  2830             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  2831             MOVE PI-RETURN-TO-PROGRAM
  2832                                     TO PI-CALLING-PROGRAM
  2833             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  2834             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  2835             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  2836             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  2837             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  2838             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  2839             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  2840         END-IF
  2841     ELSE
  2842         GO TO 0200-RECEIVE
  2843     END-IF.
  2844
  2845     GO TO 1000-SHOW.
  2846
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  51
* EL691.cbl
  2848
  2849 0200-RECEIVE.
  2850
  2851
  2852* EXEC CICS HANDLE AID
  2853*        CLEAR    (9300-DFHCLEAR)
  2854*        PA1      (9200-PA)
  2855*        PA2      (9200-PA)
  2856*        PA3      (9200-PA)
  2857*    END-EXEC.
  2858*    MOVE '"&=!"#               V! " #00002754' TO DFHEIV0
  2859     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2860     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2861     MOVE X'2220233030303032373534' TO DFHEIV0(25:11)
  2862     CALL 'kxdfhei1' USING DFHEIV0
  2863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2864
  2865
  2866
  2867* EXEC CICS HANDLE CONDITION
  2868*        PGMIDERR (9700-PGMID-ERROR)
  2869*        ERROR    (9800-ABEND)
  2870*    END-EXEC.
  2871*    MOVE '"$L.                  ! # #00002761' TO DFHEIV0
  2872     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2874     MOVE X'2320233030303032373631' TO DFHEIV0(25:11)
  2875     CALL 'kxdfhei1' USING DFHEIV0
  2876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2877
  2878
  2879
  2880* EXEC CICS RECEIVE
  2881*        MAP      (W-MAP)
  2882*        MAPSET   (W-MAPSET)
  2883*        INTO     (EL691AI)
  2884*    END-EXEC.
  2885     MOVE LENGTH OF
  2886      EL691AI
  2887       TO DFHEIV11
  2888*    MOVE '8"T I  L              ''   #00002766' TO DFHEIV0
  2889     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2891     MOVE X'2020233030303032373636' TO DFHEIV0(25:11)
  2892     CALL 'kxdfhei1' USING DFHEIV0,
  2893           W-MAP,
  2894           EL691AI,
  2895           DFHEIV11,
  2896           W-MAPSET,
  2897           DFHEIV99,
  2898           DFHEIV99
  2899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2900
  2901
  2902     IF  NOT DISPLAY-CAP
  2903         MOVE 'READ'             TO SM-READ
  2904         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2905         MOVE ER-9097            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  52
* EL691.cbl
  2906         MOVE -1                 TO MAINTL
  2907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2908         GO TO 8100-SEND-INITIAL-MAP
  2909     END-IF.
  2910
  2911
  2912 0300-CHECK-PFKEYS.
  2913
  2914     IF  EIBAID EQUAL DFHPF23
  2915         MOVE EIBAID             TO PI-ENTRY-CD-1
  2916         MOVE W-XCTL-005         TO W-CALL-PGM
  2917         GO TO 9400-XCTL
  2918     END-IF.
  2919
  2920     IF  EIBAID EQUAL DFHPF24
  2921         MOVE W-XCTL-626         TO W-CALL-PGM
  2922         GO TO 9400-XCTL
  2923     END-IF.
  2924
  2925     IF  EIBAID EQUAL DFHPF6
  2926         MOVE W-XCTL-1279        TO W-CALL-PGM
  2927         GO TO 9400-XCTL
  2928     END-IF
  2929
  2930     IF  MAINTI EQUAL 'C'  AND
  2931         EIBAID EQUAL DFHENTER
  2932          GO TO 0700-PROCESS-CHANGES
  2933     END-IF.
  2934
  2935     MOVE ER-0029                TO EMI-ERROR.
  2936
  2937
  2938 0320-INPUT-ERROR.
  2939
  2940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2941     MOVE -1                     TO  MAINTL.
  2942     GO TO 8200-SEND-DATAONLY.
  2943
  2944
  2945 0700-PROCESS-CHANGES.
  2946
  2947     IF  NOT MODIFY-CAP
  2948         MOVE 'UPDATE'           TO SM-READ
  2949         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2950         MOVE ER-0070            TO EMI-ERROR
  2951         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2952         MOVE -1                 TO MAINTL
  2953         GO TO 8100-SEND-INITIAL-MAP
  2954     END-IF.
  2955
  2956     IF RESFORML > ZEROS
  2957        AND RESFORMI > SPACES
  2958        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  2959        MOVE RESFORMI            TO LETR-LETTER-ID
  2960        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  2961        MOVE SPACES              TO LETR-FILLER
  2962        MOVE 0                   TO LETR-SEQ-NO
  2963        PERFORM 1500-CHECK-Z-RECORD THRU 1500-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  53
* EL691.cbl
  2964        IF Z-RECORD-NOT-FOUND
  2965           MOVE ER-1236          TO EMI-ERROR
  2966           MOVE -1               TO RESFORML
  2967           MOVE AL-UABON         TO RESFORMA
  2968           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2969        END-IF
  2970     END-IF
  2971
  2972     MOVE 'N'                    TO W-NEED-COMMENT.
  2973
  2974     IF RESENDL GREATER ZERO
  2975         MOVE 'Y'                TO W-NEED-COMMENT
  2976         IF RESENDI = SPACES
  2977             MOVE AL-UANON       TO  RESENDA
  2978             MOVE +1             TO  W-UPDATE-SW
  2979             MOVE LOW-VALUES     TO  W-RESEND-DATE
  2980         ELSE
  2981             MOVE RESENDI       TO  W-DEEDIT-FIELD
  2982             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2983             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2984                 MOVE W-DEEDIT-FIELD-V0  TO  RESENDO
  2985                 INSPECT RESENDI CONVERTING SPACES TO SLASH
  2986                 MOVE '4'        TO  DC-OPTION-CODE
  2987                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2988                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2989                 IF DC-ERROR-CODE NOT = SPACES
  2990                     MOVE ER-0295         TO  EMI-ERROR
  2991                     MOVE -1              TO  RESENDL
  2992                     MOVE AL-UABON        TO  RESENDA
  2993                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2994                 ELSE
  2995                     MOVE AL-UANON       TO  RESENDA
  2996                     MOVE +1             TO  W-UPDATE-SW
  2997                     MOVE DC-BIN-DATE-1  TO  W-RESEND-DATE
  2998                 END-IF
  2999             ELSE
  3000                 MOVE ER-0295    TO  EMI-ERROR
  3001                 MOVE -1         TO  RESENDL
  3002                 MOVE AL-UABON   TO  RESENDA
  3003                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3004             END-IF
  3005         END-IF
  3006     END-IF.
  3007
  3008     IF FINDATEL GREATER ZERO
  3009         IF FINDATEI = SPACES
  3010             MOVE AL-UANON       TO  FINDATEA
  3011             MOVE +1             TO  W-UPDATE-SW
  3012             MOVE LOW-VALUES     TO  W-FINAL-ACT-DATE
  3013             MOVE SPACES         TO  PI-ARCHIVE-FINAL
  3014         ELSE
  3015             MOVE 'Y'             TO  PI-ARCHIVE-FINAL
  3016             MOVE FINDATEI        TO  W-DEEDIT-FIELD
  3017             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3018             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3019                 MOVE W-DEEDIT-FIELD-V0  TO  FINDATEO
  3020                 INSPECT FINDATEI CONVERTING SPACES TO SLASH
  3021                 MOVE '4'                 TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  54
* EL691.cbl
  3022                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  3023                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3024                 IF DC-ERROR-CODE NOT = SPACES
  3025                     MOVE ER-0296        TO  EMI-ERROR
  3026                     MOVE -1             TO  FINDATEL
  3027                     MOVE AL-UABON       TO  FINDATEA
  3028                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3029                 ELSE
  3030                     MOVE AL-UANON       TO  FINDATEA
  3031                     MOVE +1             TO  W-UPDATE-SW
  3032                     MOVE DC-BIN-DATE-1  TO  W-FINAL-ACT-DATE
  3033                 END-IF
  3034             ELSE
  3035                 MOVE ER-0296    TO  EMI-ERROR
  3036                 MOVE -1         TO  FINDATEL
  3037                 MOVE AL-UABON   TO  FINDATEA
  3038                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3039             END-IF
  3040         END-IF
  3041     END-IF.
  3042
  3043     IF REPLYL GREATER ZERO
  3044         IF REPLYI = SPACES
  3045             MOVE AL-UANON       TO  REPLYA
  3046             MOVE +1             TO  W-UPDATE-SW
  3047             MOVE LOW-VALUES     TO  W-RECEIVED-DATE
  3048             MOVE SPACES         TO  PI-ARCHIVE-RECEIVED
  3049                                     WS-RECEIVED-NOTE
  3050             PERFORM 4500-UPDATE-BILL-NOTE THRU 4500-EXIT
  3051         ELSE
  3052             MOVE 'Y'            TO  PI-ARCHIVE-RECEIVED
  3053             MOVE REPLYI         TO  W-DEEDIT-FIELD
  3054             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3055             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3056                 MOVE W-DEEDIT-FIELD-V0  TO  REPLYO
  3057                 INSPECT REPLYI CONVERTING SPACES TO SLASH
  3058                 MOVE '4'        TO  DC-OPTION-CODE
  3059                 MOVE W-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  3060                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3061                 IF DC-ERROR-CODE NOT = SPACES
  3062                     MOVE ER-9245        TO  EMI-ERROR
  3063                     MOVE -1             TO  REPLYL
  3064                     MOVE AL-UABON       TO  REPLYA
  3065                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3066                 ELSE
  3067                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  3068                       MOVE ER-0539      TO  EMI-ERROR
  3069                       MOVE -1           TO  REPLYL
  3070                       MOVE AL-UABON     TO  REPLYA
  3071                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3072                   ELSE
  3073                       MOVE AL-UANON     TO  REPLYA
  3074                       MOVE +1           TO  W-UPDATE-SW
  3075                       MOVE DC-BIN-DATE-1 TO W-RECEIVED-DATE
  3076                       MOVE DC-GREG-DATE-1-EDIT TO
  3077                                        W-CERT-NOTE-RECV-DT
  3078                                        WS-BN-RECV-DATE
  3079                   END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  55
* EL691.cbl
  3080                 END-IF
  3081             ELSE
  3082                 MOVE ER-9245    TO  EMI-ERROR
  3083                 MOVE -1         TO  REPLYL
  3084                 MOVE AL-UABON   TO  REPLYA
  3085                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3086             END-IF
  3087         END-IF
  3088     END-IF.
  3089
  3090     IF STOPDTEL GREATER ZERO
  3091         IF STOPDTEI = SPACES
  3092             MOVE AL-UANON       TO  STOPDTEA
  3093             MOVE +1             TO  W-UPDATE-SW
  3094             MOVE LOW-VALUES     TO  W-STOP-LETTER-DATE
  3095             MOVE SPACES         TO  PI-ARCHIVE-STOPPED
  3096             MOVE AL-UANOF       TO  RESENDA
  3097                                     RESFORMA
  3098                                     FINDATEA
  3099                                     FINLACTA
  3100                                     REPLYA
  3101                                     COMMENTA
  3102         ELSE
  3103             MOVE 'Y'            TO  PI-ARCHIVE-STOPPED
  3104             MOVE 'Y'            TO  W-NEED-COMMENT
  3105             MOVE STOPDTEI       TO  W-DEEDIT-FIELD
  3106             PERFORM 8600-DEEDIT THRU 8600-EXIT
  3107             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  3108                 MOVE W-DEEDIT-FIELD-V0  TO  STOPDTEO
  3109                 INSPECT STOPDTEI CONVERTING SPACES TO SLASH
  3110                 MOVE '4'        TO  DC-OPTION-CODE
  3111                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  3112                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3113                 IF DC-ERROR-CODE NOT = SPACES
  3114                     MOVE ER-0897         TO  EMI-ERROR
  3115                     MOVE -1              TO  STOPDTEL
  3116                     MOVE AL-UABON        TO  STOPDTEA
  3117                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3118                 ELSE
  3119                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  3120                       MOVE ER-0895      TO  EMI-ERROR
  3121                       MOVE -1           TO  STOPDTEL
  3122                       MOVE AL-UABON     TO  STOPDTEA
  3123                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3124                   ELSE
  3125                     MOVE AL-UANON       TO  STOPDTEA
  3126                     MOVE +1             TO  W-UPDATE-SW
  3127                     MOVE DC-BIN-DATE-1  TO  W-STOP-LETTER-DATE
  3128                   END-IF
  3129                 END-IF
  3130             ELSE
  3131                 MOVE ER-0897    TO  EMI-ERROR
  3132                 MOVE -1         TO  STOPDTEL
  3133                 MOVE AL-UABON   TO  STOPDTEA
  3134                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3135             END-IF
  3136         END-IF
  3137     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  56
* EL691.cbl
  3138
  3139     IF W-NEED-COMMENT = 'Y'  AND
  3140        COMMENTL NOT > ZERO
  3141           MOVE -1         TO  COMMENTL
  3142           MOVE ER-7363    TO  EMI-ERROR
  3143           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3144     END-IF.
  3145     if (stopdtel > zeros)
  3146        and (PI-ARCHIVE-STOPPED = 'Y')
  3147        and (pi-initial-print-date <> low-values)
  3148        if obvyni not = 'Y' AND 'N'
  3149           move -1               to obvynl
  3150           move al-uabon         to obvyna
  3151           move er-7364          to emi-error
  3152           perform 9900-error-format
  3153                                 thru 9900-exit
  3154        end-if
  3155     end-if
  3156     if obvynl > zeros
  3157        and pi-archive-stopped <> 'Y'
  3158        move -1                  to stopdtel
  3159        move al-uabon            to stopdtea
  3160        move er-7333             to emi-error
  3161        perform 9900-error-format
  3162                                 thru 9900-exit
  3163     end-if
  3164     IF COMMENTL GREATER ZERO
  3165      OR  RESFORML GREATER ZERO
  3166      OR  FINLACTL GREATER ZERO
  3167      or obvynl > 0
  3168         MOVE +1          TO  W-UPDATE-SW
  3169     END-IF.
  3170
  3171     IF W-ERROR-COUNT GREATER ZERO
  3172         GO TO 8200-SEND-DATAONLY
  3173     END-IF.
  3174
  3175     IF W-UPDATE-SW NOT GREATER ZERO
  3176         MOVE ER-3112    TO  EMI-ERROR
  3177         MOVE -1         TO  MAINTL
  3178         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3179         GO TO 8200-SEND-DATAONLY
  3180     END-IF.
  3181
  3182     IF PI-ARCHIVE-STOPPED = 'Y'
  3183        MOVE AL-SANOF       TO RESENDA
  3184                               RESFORMA
  3185                               FINDATEA
  3186                               FINLACTA
  3187                               REPLYA
  3188*                              COMMENTA
  3189     END-IF.
  3190
  3191     PERFORM 3000-READ-FOR-UPDATE THRU 3000-EXIT.
  3192
  3193     IF RESENDL GREATER ZERO
  3194         MOVE W-RESEND-DATE      TO  LA-RESEND-DATE
  3195     END-IF.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  57
* EL691.cbl
  3196
  3197     IF FINDATEL GREATER ZERO
  3198         MOVE W-FINAL-ACT-DATE   TO  LA-FINAL-ACT-DATE
  3199     END-IF.
  3200     IF REPLYL GREATER ZERO  *> its really received date
  3201        MOVE W-RECEIVED-DATE     TO LA-REPLY-DATE
  3202        IF W-RECEIVED-DATE <> LOW-VALUES
  3203           move w-cert-note-msg  to w-comment-line-1
  3204           move +1               to w-comment-line-cnt
  3205           PERFORM 4000-ADD-CERT-NOTE
  3206                                 THRU 4099-EXIT
  3207           PERFORM 4500-UPDATE-BILL-NOTE
  3208                                 THRU 4500-EXIT
  3209        END-IF
  3210     END-IF
  3211     IF RESFORML GREATER ZERO
  3212        MOVE RESFORMI            TO  LA-RESEND-LETR
  3213     END-IF.
  3214
  3215     IF FINLACTL GREATER ZERO
  3216        MOVE FINLACTI            TO  LA-FINAL-ACT-IND
  3217     END-IF.
  3218
  3219     IF STOPDTEL GREATER ZERO
  3220        MOVE W-STOP-LETTER-DATE  TO  LA-VOIDED-DATE
  3221     END-IF.
  3222     perform 1620-read-elcert    thru 1620-exit
  3223
  3224     IF (OBVYNL > ZERO)
  3225        and (obvyni <> la-void-onbase-yn)
  3226        if (obvyni = 'N')
  3227           and (la-void-onbase-yn = spaces)
  3228           continue
  3229        else
  3230           if la-initial-print-date <> low-values
  3231              perform 1600-update-obkeywords
  3232                                 thru 1600-exit
  3233           end-if
  3234        end-if
  3235        MOVE OBVYNI              TO LA-VOID-ONBASE-YN
  3236     end-if
  3237
  3238     if (not cert-found)
  3239        or (sql-update-failed)
  3240        or ((la-initial-print-date = low-values)
  3241              and
  3242            (la-void-onbase-yn = 'Y'))
  3243
  3244* exec cics unlock
  3245*          dataset (W-ARCH-FILE-ID)
  3246*       end-exec
  3247*    MOVE '&*                    #   #00003113' TO DFHEIV0
  3248     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3249     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3250     MOVE X'2020233030303033313133' TO DFHEIV0(25:11)
  3251     CALL 'kxdfhei1' USING DFHEIV0,
  3252           W-ARCH-FILE-ID,
  3253           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  58
* EL691.cbl
  3254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3255        if connected-to-db
  3256           move ' '              to ws-connect-sw
  3257           display ' about to disconnect '
  3258           exec sql
  3259              disconnect
  3260           end-exec
  3261        end-if
  3262     end-if
  3263
  3264     if not cert-found
  3265        move er-0249             to emi-error
  3266        move -1                  to maintl
  3267        perform 9900-error-format thru 9900-exit
  3268        go to 8200-send-dataonly
  3269     end-if
  3270
  3271     if sql-update-failed
  3272        move er-7331             to emi-error
  3273        move -1                  to maintl
  3274        perform 9900-error-format thru 9900-exit
  3275        go to 8200-send-dataonly
  3276     end-if
  3277
  3278     if (la-void-onbase-yn = 'Y')
  3279        and (la-initial-print-date = low-values)
  3280        move er-7334             to emi-error
  3281        move -1                  to maintl
  3282        perform 9900-error-format thru 9900-exit
  3283        go to 8200-send-dataonly
  3284     end-if
  3285
  3286     if sql-update-succeeded
  3287        display ' about to commit work '
  3288        exec sql
  3289           commit work
  3290        end-exec
  3291     end-if
  3292     if connected-to-db
  3293        display ' about to disconnect all '
  3294        exec sql
  3295           disconnect
  3296        end-exec
  3297        move ' ' to ws-connect-sw
  3298     end-if
  3299     PERFORM 3100-REWRITE THRU 3100-EXIT.
  3300
  3301     IF COMMENTL NOT GREATER ZERO
  3302
  3303         MOVE ER-0000            TO  EMI-ERROR
  3304         MOVE ' '                TO  MAINTO
  3305         MOVE -1                 TO  MAINTL
  3306         MOVE AL-UANOF           TO  MAINTA
  3307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3308         GO TO 1000-SHOW
  3309     END-IF.
  3310     if (commentl > zeros)
  3311        and (commenti not = spaces)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  59
* EL691.cbl
  3312        move commenti            to w-cert-note-comment
  3313        perform 4160-check-comment thru 4160-exit
  3314        PERFORM 4000-ADD-CERT-NOTE
  3315                                 THRU 4099-EXIT
  3316     end-if
  3317     PERFORM 3200-READ-ARCT-FOR-UPDATE THRU 3200-EXIT.
  3318
  3319     IF PI-COMMENT-INDEX EQUAL +20
  3320         MOVE ER-0051    TO  EMI-ERROR
  3321         MOVE -1         TO  MAINTL
  3322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3323         GO TO 8200-SEND-DATAONLY
  3324     END-IF
  3325
  3326     SET PI-COMMENT-INDEX UP BY +1.
  3327     SET LC-NDX TO PI-COMMENT-INDEX.
  3328     MOVE COMMENTI        TO  LT-COMMENT-LINE (LC-NDX)
  3329     MOVE W-SAVE-BIN-DATE TO  LT-COMMENT-CHG-DT (LC-NDX).
  3330     MOVE PI-PROCESSOR-ID TO  LT-COMMENT-CHG-BY (LC-NDX).
  3331     ADD +1               TO  LT-NUM-LINES-ON-RECORD.
  3332
  3333
  3334     IF W-ADD-ARCT = 'N'
  3335         PERFORM 3300-REWRITE-ARCT THRU 3300-EXIT
  3336     ELSE
  3337         PERFORM 3350-INSERT-ARCT THRU 3350-EXIT
  3338     END-IF.
  3339
  3340
  3341     MOVE ER-0000                TO  EMI-ERROR.
  3342     MOVE ' '                    TO  MAINTO.
  3343     MOVE -1                     TO  MAINTL.
  3344     MOVE AL-UANOF               TO  MAINTA.
  3345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3346     GO TO 1000-SHOW.
  3347
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  60
* EL691.cbl
  3349
  3350 1000-SHOW.
  3351***************************************************************
  3352*     THIS ROUTINE WILL READ THE ARCHIVE FILE WITH THE        *
  3353*     ARCHIVE NUMBER SPECIFIED FROM THE PRIOR SCREEN.         *
  3354***************************************************************
  3355     MOVE LOW-VALUES              TO W-ARCT-KEY.
  3356     MOVE PI-COMPANY-CD           TO W-ARCH-COMPANY-CD
  3357                                     W-ARCT-COMPANY-CD.
  3358     MOVE PI-689-ARCHIVE-NUMBER   TO W-ARCH-NUMBER
  3359                                     W-ARCT-ARCHIVE-NO.
  3360     MOVE '3'                     TO W-ARCT-RECORD-TYPE.
  3361     MOVE +0                      TO W-ARCT-LINE-SEQ-NO.
  3362
  3363
  3364* EXEC CICS HANDLE CONDITION
  3365*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3366*         NOTFND     (1070-ARCH-NOT-FOUND)
  3367*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3368*    END-EXEC.
  3369*    MOVE '"$JI''                 ! $ #00003224' TO DFHEIV0
  3370     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3372     MOVE X'2420233030303033323234' TO DFHEIV0(25:11)
  3373     CALL 'kxdfhei1' USING DFHEIV0
  3374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3375
  3376
  3377
  3378* EXEC CICS READ
  3379*        DATASET (W-ARCH-FILE-ID)
  3380*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3381*        RIDFLD  (W-ARCH-KEY)
  3382*    END-EXEC.
  3383*    MOVE '&"S        E          (   #00003230' TO DFHEIV0
  3384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3386     MOVE X'2020233030303033323330' TO DFHEIV0(25:11)
  3387     CALL 'kxdfhei1' USING DFHEIV0,
  3388           W-ARCH-FILE-ID,
  3389           DFHEIV20,
  3390           DFHEIV99,
  3391           W-ARCH-KEY,
  3392           DFHEIV99,
  3393           DFHEIV99,
  3394           DFHEIV99
  3395     SET ADDRESS OF LETTER-ARCHIVE TO
  3396         DFHEIV20
  3397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3398
  3399
  3400     MOVE LA-FORM-A3             TO FORMNOO.
  3401     MOVE LA-FORM-A3             TO PI-ARCHIVE-LTRID
  3402     MOVE LA-ARCHIVE-NO          TO ARCHNOO.
  3403     MOVE LA-CARRIER-A2          TO CARRIERO.
  3404     MOVE LA-GROUPING-A2         TO GROUPO.
  3405     MOVE LA-STATE-A2            TO STATEO.
  3406     MOVE LA-ACCOUNT-A2          TO ACCTO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  61
* EL691.cbl
  3407     MOVE LA-CERT-PRIME-A2       TO CERTO.
  3408     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  3409
  3410     IF LA-ENDT-ARCH-NO-X EQUAL LOW-VALUES OR SPACES
  3411          MOVE SPACES            TO ENDARCHO
  3412     ELSE
  3413          MOVE LA-ENDT-ARCH-NO   TO ENDARCHO
  3414     END-IF
  3415
  3416     IF  LA-CREATION-DATE EQUAL LOW-VALUES OR SPACES
  3417         MOVE SPACES             TO CREATDTI
  3418                                    pi-create-date
  3419     ELSE
  3420         MOVE LA-CREATION-DATE   TO DC-BIN-DATE-1
  3421         MOVE ' '                TO DC-OPTION-CODE
  3422         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3423         MOVE DC-GREG-DATE-1-EDIT TO CREATDTI
  3424                                     pi-create-date
  3425     END-IF.
  3426
  3427     MOVE LA-PROCESSOR-CD        TO CREATBYI.
  3428
  3429     IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES OR SPACES
  3430         MOVE SPACES             TO PRINTDTI
  3431         move low-values         to pi-initial-print-date
  3432     ELSE
  3433         move la-initial-print-date
  3434                                 to pi-initial-print-date
  3435         MOVE LA-INITIAL-PRINT-DATE TO DC-BIN-DATE-1
  3436         MOVE ' '                TO DC-OPTION-CODE
  3437         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3438         MOVE DC-GREG-DATE-1-EDIT TO PRINTDTI
  3439     END-IF.
  3440
  3441     IF  LA-RESEND-DATE = LOW-VALUES OR SPACES
  3442         MOVE SPACES             TO RESENDI
  3443     ELSE
  3444         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  3445         MOVE ' '                TO DC-OPTION-CODE
  3446         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3447         MOVE DC-GREG-DATE-1-EDIT TO RESENDI
  3448     END-IF.
  3449
  3450     MOVE LA-RESEND-LETR         TO RESFORMI.
  3451
  3452     IF  LA-SENT-DATE = LOW-VALUES OR SPACES
  3453         MOVE SPACES             TO RESPRNTI
  3454         MOVE SPACES             TO PI-ARCHIVE-COMPLETE
  3455     ELSE
  3456         MOVE 'Y'                TO PI-ARCHIVE-COMPLETE
  3457         MOVE LA-SENT-DATE     TO DC-BIN-DATE-1
  3458         MOVE ' '                TO DC-OPTION-CODE
  3459         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3460         MOVE DC-GREG-DATE-1-EDIT TO RESPRNTI
  3461     END-IF.
  3462
  3463     IF  LA-FINAL-ACT-DATE EQUAL LOW-VALUES OR SPACES
  3464         MOVE SPACES             TO FINDATEI
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  62
* EL691.cbl
  3465         MOVE SPACES             TO PI-ARCHIVE-FINAL
  3466     ELSE
  3467         MOVE 'Y'                TO PI-ARCHIVE-FINAL
  3468         MOVE LA-FINAL-ACT-DATE  TO DC-BIN-DATE-1
  3469         MOVE ' '                TO DC-OPTION-CODE
  3470         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3471         MOVE DC-GREG-DATE-1-EDIT TO FINDATEI
  3472     END-IF.
  3473
  3474     MOVE LA-FINAL-ACT-IND       TO FINLACTI.
  3475
  3476     IF  LA-REPLY-DATE = LOW-VALUES OR SPACES
  3477         MOVE SPACES             TO REPLYI
  3478         MOVE SPACES             TO PI-ARCHIVE-RECEIVED
  3479     ELSE
  3480         MOVE 'Y'                TO PI-ARCHIVE-RECEIVED
  3481         MOVE LA-REPLY-DATE      TO DC-BIN-DATE-1
  3482         MOVE ' '                TO DC-OPTION-CODE
  3483         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3484         MOVE DC-GREG-DATE-1-EDIT TO REPLYI
  3485     END-IF.
  3486
  3487     IF  LA-VOIDED-DATE = LOW-VALUES OR SPACES
  3488         MOVE SPACES             TO STOPDTEI
  3489         MOVE SPACES             TO PI-ARCHIVE-STOPPED
  3490     ELSE
  3491         MOVE 'Y'                TO PI-ARCHIVE-STOPPED
  3492         MOVE LA-VOIDED-DATE     TO DC-BIN-DATE-1
  3493         MOVE ' '                TO DC-OPTION-CODE
  3494         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3495         MOVE DC-GREG-DATE-1-EDIT TO STOPDTEI
  3496     END-IF.
  3497     if LA-VOID-ONBASE-YN not = spaces
  3498        move LA-VOID-ONBASE-YN   to obvyno
  3499     end-if
  3500     if la-onbase-unique-id numeric
  3501        move la-onbase-unique-id to obuido
  3502     end-if
  3503     IF LA-LAST-MAINT-DATE = LOW-VALUES OR SPACES
  3504         MOVE SPACES             TO MAINTDTI
  3505     ELSE
  3506         MOVE LA-LAST-MAINT-DATE TO DC-BIN-DATE-1
  3507         MOVE ' '                TO DC-OPTION-CODE
  3508         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  3509         MOVE DC-GREG-DATE-1-EDIT TO MAINTDTI
  3510     END-IF.
  3511
  3512     IF LA-LAST-MAINT-TIMEX = LOW-VALUES OR SPACES
  3513         MOVE ZEROES             TO MAINTTMO
  3514     ELSE
  3515         MOVE LA-LAST-MAINT-TIME TO W-TIME-IN
  3516         MOVE W-TIME-OUT         TO MAINTTMO
  3517     END-IF.
  3518
  3519     MOVE LA-LAST-UPDATED-BY     TO MAINTBYI.
  3520
  3521     IF (LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  3522       OR (LA-VOIDED-DATE  NOT EQUAL LOW-VALUES AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  63
* EL691.cbl
  3523          MOVE AL-SANOF          TO RESENDA
  3524                                    RESFORMA
  3525                                    FINDATEA
  3526                                    FINLACTA
  3527                                    REPLYA
  3528                                    COMMENTA
  3529     END-IF.
  3530
  3531     IF LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES
  3532         MOVE AL-SANOF           TO STOPDTEA
  3533     END-IF.
  3534
  3535
  3536* EXEC CICS HANDLE CONDITION
  3537*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  3538*         NOTFND     (1000-ARCT-NOT-FOUND)
  3539*         ENDFILE    (1000-ARCT-NOT-FOUND)
  3540*    END-EXEC.
  3541*    MOVE '"$JI''                 ! % #00003371' TO DFHEIV0
  3542     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3544     MOVE X'2520233030303033333731' TO DFHEIV0(25:11)
  3545     CALL 'kxdfhei1' USING DFHEIV0
  3546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3547
  3548
  3549
  3550* EXEC CICS READ
  3551*        DATASET  (W-ARCT-FILE-ID)
  3552*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3553*        RIDFLD   (W-ARCT-KEY)
  3554*    END-EXEC.
  3555*    MOVE '&"S        E          (   #00003377' TO DFHEIV0
  3556     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3558     MOVE X'2020233030303033333737' TO DFHEIV0(25:11)
  3559     CALL 'kxdfhei1' USING DFHEIV0,
  3560           W-ARCT-FILE-ID,
  3561           DFHEIV20,
  3562           DFHEIV99,
  3563           W-ARCT-KEY,
  3564           DFHEIV99,
  3565           DFHEIV99,
  3566           DFHEIV99
  3567     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3568         DFHEIV20
  3569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3570
  3571
  3572     SET LC-NDX TO W-ZEROS.
  3573     PERFORM 20 TIMES
  3574         SET LC-NDX UP BY +1
  3575         IF LT-COMMENT-LINE (LC-NDX) > SPACES
  3576             MOVE LT-COMMENT-LINE (LC-NDX) TO COMMENTI
  3577             SET PI-COMMENT-INDEX TO LC-NDX
  3578         END-IF
  3579     END-PERFORM.
  3580
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  64
* EL691.cbl
  3581     MOVE -1                     TO MAINTL.
  3582     GO TO 8100-SEND-INITIAL-MAP.
  3583
  3584 1000-ARCT-NOT-FOUND.
  3585
  3586     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3587     MOVE -1                     TO MAINTL.
  3588     GO TO 8100-SEND-INITIAL-MAP.
  3589
  3590 1000-EXIT.
  3591     EXIT.
  3592
  3593
  3594 1070-ARCH-NOT-FOUND.
  3595
  3596     MOVE ER-7371                TO EMI-ERROR.
  3597     MOVE -1                     TO ARCHNOL.
  3598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3599     GO TO 8100-SEND-INITIAL-MAP.
  3600
  3601
  3602 1500-CHECK-Z-RECORD.
  3603
  3604     MOVE 'N' TO WS-Z-RECORD-IND
  3605
  3606
  3607* EXEC CICS STARTBR
  3608*         DATASET    ('ELLETR')
  3609*         RIDFLD     (ELLETR-KEY)
  3610*         GTEQ
  3611*         RESP      (W-RESPONSE)
  3612*    END-EXEC.
  3613     MOVE 'ELLETR' TO DFHEIV1
  3614     MOVE 0
  3615       TO DFHEIV11
  3616*    MOVE '&,         G          &  N#00003417' TO DFHEIV0
  3617     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3618     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3619     MOVE X'204E233030303033343137' TO DFHEIV0(25:11)
  3620     CALL 'kxdfhei1' USING DFHEIV0,
  3621           DFHEIV1,
  3622           ELLETR-KEY,
  3623           DFHEIV99,
  3624           DFHEIV11,
  3625           DFHEIV99
  3626     MOVE EIBRESP  TO W-RESPONSE
  3627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3628
  3629     IF NOT RESP-NORMAL
  3630         GO TO 1500-ENDBR
  3631     END-IF.
  3632
  3633 1500-READNEXT.
  3634
  3635
  3636* EXEC CICS READNEXT
  3637*        DATASET   ('ELLETR')
  3638*        INTO      (TEXT-FILES)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  65
* EL691.cbl
  3639*        RIDFLD    (ELLETR-KEY)
  3640*        RESP      (W-RESPONSE)
  3641*    END-EXEC
  3642     MOVE LENGTH OF
  3643      TEXT-FILES
  3644       TO DFHEIV12
  3645     MOVE 'ELLETR' TO DFHEIV1
  3646     MOVE 0
  3647       TO DFHEIV11
  3648*    MOVE '&.IL                  )  N#00003429' TO DFHEIV0
  3649     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3650     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3651     MOVE X'204E233030303033343239' TO DFHEIV0(25:11)
  3652     CALL 'kxdfhei1' USING DFHEIV0,
  3653           DFHEIV1,
  3654           TEXT-FILES,
  3655           DFHEIV12,
  3656           ELLETR-KEY,
  3657           DFHEIV99,
  3658           DFHEIV11,
  3659           DFHEIV99,
  3660           DFHEIV99
  3661     MOVE EIBRESP  TO W-RESPONSE
  3662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3663     IF RESP-NORMAL
  3664        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  3665           GO TO 1500-ENDBR
  3666        END-IF
  3667
  3668        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  3669           MOVE 'Y' TO WS-Z-RECORD-IND
  3670           GO TO 1500-ENDBR
  3671        ELSE
  3672           GO TO 1500-READNEXT
  3673        END-IF
  3674     ELSE
  3675        GO TO 1500-ENDBR
  3676     END-IF.
  3677
  3678 1500-ENDBR.
  3679
  3680
  3681* EXEC CICS ENDBR
  3682*        DATASET     ('ELLETR')
  3683*    END-EXEC.
  3684     MOVE 'ELLETR' TO DFHEIV1
  3685     MOVE 0
  3686       TO DFHEIV11
  3687*    MOVE '&2                    $   #00003452' TO DFHEIV0
  3688     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3690     MOVE X'2020233030303033343532' TO DFHEIV0(25:11)
  3691     CALL 'kxdfhei1' USING DFHEIV0,
  3692           DFHEIV1,
  3693           DFHEIV11,
  3694           DFHEIV99
  3695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3696
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  66
* EL691.cbl
  3697
  3698 1500-EXIT.
  3699      EXIT.
  3700 1600-update-obkeywords.
  3701
  3702     if not connected-to-db
  3703        perform 1700-CONNECT-TO-DB
  3704                                 thru 1700-exit
  3705     end-if
  3706
  3707*    perform 1620-read-elcert    thru 1620-exit
  3708*    if not cert-found
  3709*       go to 1600-exit
  3710*    end-if
  3711
  3712     if obvyni = 'N'
  3713        if la-onbase-unique-id numeric
  3714           and la-onbase-unique-id > 0
  3715           perform 1610-void-void thru 1610-exit
  3716           go to 1600-exit
  3717        end-if
  3718     end-if
  3719
  3720***  If I get here I assume they are voiding the letter
  3721***  I am using a stored procedure so I can get back the
  3722***  unique id from the insert and update the erarch
  3723***  record with it.  May come in handy down the road
  3724
  3725     if obvyni = 'Y'
  3726        and (la-onbase-unique-id not numeric
  3727           or la-onbase-unique-id = zeros)
  3728        continue
  3729     else
  3730        go to 1600-exit
  3731     end-if
  3732
  3733     move 'CID Certs'            to db-doc-type
  3734     move 'Status'               to db-key-word-type
  3735     move 'V'                    to db-key-word-value
  3736     move cm-state               to db-cert-state
  3737     move cm-cert-prime          to db-cert-no
  3738     move cm-lf-loan-expire-dt   to dc-bin-date-1
  3739     if cm-ah-loan-expire-dt > cm-lf-loan-expire-dt
  3740        move cm-ah-loan-expire-dt
  3741                                 to dc-bin-date-1
  3742     end-if
  3743     move ' '                    to dc-option-code
  3744     perform 9500-LINK-DATE-CONVERT thru 9500-exit
  3745     if no-conversion-error
  3746        move dc-greg-date-a-edit to db-cert-exp-dt
  3747        inspect db-cert-exp-dt
  3748           converting '/' to '-'
  3749     end-if
  3750     move la-initial-print-date  to dc-bin-date-1
  3751     move ' '                    to dc-option-code
  3752     perform 9500-LINK-DATE-CONVERT thru 9500-exit
  3753     if no-conversion-error
  3754        move dc-greg-date-a-edit to db-print-dt
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  67
* EL691.cbl
  3755        inspect db-print-dt
  3756           converting '/' to '-'
  3757     end-if
  3758
  3759     EXEC SQL
  3760        CALL sp_OBKeyWordChgs_ADD
  3761           @DocType       =  :db-doc-type,
  3762           @CertNo        =  :db-cert-no,
  3763           @PrintDt       =  :db-print-dt,
  3764           @CertExpDt     =  :db-cert-exp-dt,
  3765           @CertSt        =  :db-cert-state,
  3766           @KeyWordType   =  :db-key-word-type,
  3767           @KeyWordValue  =  :db-key-word-value,
  3768           @RetValue      = :kd-unique-id OUT
  3769     END-EXEC
  3770
  3771     if sqlcode not = 0
  3772        move sqlcode             to ws-sql-code
  3773        move ws-sql-code         to ws-dis-sql-code
  3774        display ' Error: Cannot INSERT row ' kd-unique-id
  3775        display ' sql return code        ' ws-dis-sql-code
  3776        display ' sql err mess           ' sqlerrmc
  3777        set sql-update-failed to true
  3778     else
  3779        move kd-unique-id        to la-onbase-unique-id
  3780                                    obuido
  3781        set sql-update-succeeded to true
  3782     end-if
  3783
  3784     .
  3785 1600-exit.
  3786     exit.
  3787
  3788 1610-void-void.
  3789
  3790     move la-onbase-unique-id    to kd-unique-id
  3791     EXEC SQL
  3792        SELECT
  3793           RequestDate,
  3794           KeyWordType,
  3795           KeyWordValue,
  3796           CompletionDate
  3797        INTO
  3798           :db-req-date,
  3799           :db-key-word-type,
  3800           :db-key-word-value,
  3801           :db-complete-dt  :nu-Complete-date
  3802        FROM
  3803           OBKeyWordChgs
  3804        where
  3805           :kd-unique-id = UniqueID
  3806     END-EXEC
  3807
  3808     if sqlcode not = 0
  3809        move sqlcode             to ws-sql-code
  3810        move ws-sql-code         to ws-dis-sql-code
  3811        display ' Error: Cannot read row ' kd-unique-id
  3812        display ' sql return code        ' ws-dis-sql-code
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  68
* EL691.cbl
  3813        display ' sql err mess           ' sqlerrmc
  3814        go to 1610-exit
  3815     end-if
  3816     if nu-complete-date = -1
  3817        display ' complete date is null '
  3818     end-if
  3819     if nu-complete-date = -1  *> isnull
  3820        and db-key-word-type = 'Status'
  3821        and obvyni <> 'Y'
  3822        and db-key-word-value = 'V'
  3823
  3824        EXEC SQL
  3825           DELETE
  3826              OBKeyWordChgs
  3827           WHERE
  3828              UniqueID = :kd-unique-id
  3829        END-EXEC
  3830
  3831        if sqlcode = 0
  3832           display ' delete succeeded '
  3833           set sql-update-succeeded to true
  3834           move zeros            to la-onbase-unique-id
  3835        else
  3836           display ' delete not successful ' sqlcode
  3837           set sql-update-failed to true
  3838        end-if
  3839     end-if
  3840
  3841     .
  3842 1610-exit.
  3843     exit.
  3844
  3845 1620-read-elcert.
  3846
  3847     move la-company-cd          to elcert-key
  3848     move la-carrier-a2          to elcert-carrier
  3849     move la-grouping-a2         to elcert-grouping
  3850     move la-state-a2            to elcert-state
  3851     move la-account-a2          to elcert-account
  3852     move la-effect-date-a2      to elcert-eff-dt
  3853     move la-cert-no-a2          to elcert-cert-no
  3854
  3855
  3856* exec cics read
  3857*       dataset    ('ELCERT')
  3858*       ridfld     (elcert-key)
  3859*       SET        (ADDRESS OF CERTIFICATE-MASTER)
  3860*       resp       (w-response)
  3861*    end-exec
  3862     MOVE 'ELCERT' TO DFHEIV1
  3863*    MOVE '&"S        E          (  N#00003613' TO DFHEIV0
  3864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3866     MOVE X'204E233030303033363133' TO DFHEIV0(25:11)
  3867     CALL 'kxdfhei1' USING DFHEIV0,
  3868           DFHEIV1,
  3869           DFHEIV20,
  3870           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  69
* EL691.cbl
  3871           elcert-key,
  3872           DFHEIV99,
  3873           DFHEIV99,
  3874           DFHEIV99
  3875     SET ADDRESS OF CERTIFICATE-MASTER TO
  3876         DFHEIV20
  3877     MOVE EIBRESP  TO w-response
  3878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3879
  3880     if resp-normal
  3881        set cert-found to true
  3882     end-if
  3883
  3884     .
  3885 1620-exit.
  3886     exit.
  3887
  3888 1700-CONNECT-TO-DB.
  3889
  3890     move 'NTSQLTST2_PEMA'       to svr
  3891     move 'sa'                   to usr
  3892     move 'sql2008r2'            to pass
  3893
  3894     if ws-kix-myenv = 'cid1p'
  3895        move 'NTCSO2_Logic'      to svr
  3896        move 'sa'                to usr
  3897        move 'ntcso2'            to pass
  3898     end-if
  3899
  3900     string
  3901         usr delimited space
  3902         "." delimited size
  3903         pass delimited space into usr-pass
  3904     end-string
  3905
  3906     EXEC SQL
  3907        CONNECT TO :svr USER :usr-pass
  3908     END-EXEC
  3909
  3910     if sqlcode not = 0
  3911        move sqlcode             to ws-sql-code
  3912        move ws-sql-code         to ws-dis-sql-code
  3913        display ' Error: Cannot Connect  ' kd-unique-id
  3914        display ' sql return code        ' ws-dis-sql-code
  3915        display ' sql err mess           ' sqlerrmc
  3916        move er-7332             to emi-error
  3917        perform 9900-error-format thru 9900-exit
  3918        go to 8200-send-dataonly
  3919     end-if
  3920
  3921     set connected-to-db to true
  3922     display ' good connection '
  3923
  3924     .
  3925 1700-EXIT.
  3926     EXIT.
  3927 3000-READ-FOR-UPDATE.
  3928
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  70
* EL691.cbl
  3929
  3930* EXEC CICS HANDLE CONDITION
  3931*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  3932*         NOTFND     (1070-ARCH-NOT-FOUND)
  3933*         ENDFILE    (1070-ARCH-NOT-FOUND)
  3934*    END-EXEC.
  3935*    MOVE '"$JI''                 ! & #00003669' TO DFHEIV0
  3936     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3938     MOVE X'2620233030303033363639' TO DFHEIV0(25:11)
  3939     CALL 'kxdfhei1' USING DFHEIV0
  3940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3941
  3942
  3943     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
  3944     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCH-NUMBER
  3945
  3946
  3947* EXEC CICS READ
  3948*        DATASET (W-ARCH-FILE-ID)
  3949*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3950*        RIDFLD  (W-ARCH-KEY)
  3951*        UPDATE
  3952*    END-EXEC.
  3953*    MOVE '&"S        EU         (   #00003678' TO DFHEIV0
  3954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3956     MOVE X'2020233030303033363738' TO DFHEIV0(25:11)
  3957     CALL 'kxdfhei1' USING DFHEIV0,
  3958           W-ARCH-FILE-ID,
  3959           DFHEIV20,
  3960           DFHEIV99,
  3961           W-ARCH-KEY,
  3962           DFHEIV99,
  3963           DFHEIV99,
  3964           DFHEIV99
  3965     SET ADDRESS OF LETTER-ARCHIVE TO
  3966         DFHEIV20
  3967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3968
  3969
  3970 3000-EXIT.
  3971     EXIT.
  3972
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  71
* EL691.cbl
  3974
  3975 3100-REWRITE.
  3976
  3977     MOVE PI-PROCESSOR-ID        TO  LA-LAST-UPDATED-BY
  3978                                     MAINTBYI.
  3979     MOVE W-SAVE-BIN-DATE        TO  LA-LAST-MAINT-DATE.
  3980     MOVE W-SAVE-DATE            TO  MAINTDTI.
  3981
  3982     MOVE EIBTIME                TO  LA-LAST-MAINT-TIME
  3983                                     W-TIME-IN.
  3984     MOVE W-TIME-OUT             TO  MAINTTMO.
  3985
  3986
  3987* EXEC CICS REWRITE
  3988*        DATASET (W-ARCH-FILE-ID)
  3989*        FROM    (LETTER-ARCHIVE)
  3990*    END-EXEC.
  3991     MOVE LENGTH OF
  3992      LETTER-ARCHIVE
  3993       TO DFHEIV11
  3994*    MOVE '&& L                  %   #00003701' TO DFHEIV0
  3995     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3996     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3997     MOVE X'2020233030303033373031' TO DFHEIV0(25:11)
  3998     CALL 'kxdfhei1' USING DFHEIV0,
  3999           W-ARCH-FILE-ID,
  4000           LETTER-ARCHIVE,
  4001           DFHEIV11,
  4002           DFHEIV99
  4003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4004
  4005
  4006 3100-EXIT.
  4007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  72
* EL691.cbl
  4009 3200-READ-ARCT-FOR-UPDATE.
  4010
  4011
  4012* EXEC CICS HANDLE CONDITION
  4013*         NOTFND     (3200-NOT-FOUND)
  4014*         ENDFILE    (3200-NOT-FOUND)
  4015*    END-EXEC.
  4016*    MOVE '"$I''                  ! '' #00003711' TO DFHEIV0
  4017     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4019     MOVE X'2720233030303033373131' TO DFHEIV0(25:11)
  4020     CALL 'kxdfhei1' USING DFHEIV0
  4021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4022
  4023
  4024     MOVE PI-COMPANY-CD TO W-ARCT-COMPANY-CD.
  4025     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCT-ARCHIVE-NO.
  4026     MOVE '3'                   TO W-ARCT-RECORD-TYPE.
  4027     MOVE +0                    TO W-ARCT-LINE-SEQ-NO.
  4028
  4029
  4030* EXEC CICS READ
  4031*        DATASET  (W-ARCT-FILE-ID)
  4032*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  4033*        RIDFLD   (W-ARCT-KEY)
  4034*        UPDATE
  4035*    END-EXEC.
  4036*    MOVE '&"S        EU         (   #00003721' TO DFHEIV0
  4037     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4038     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4039     MOVE X'2020233030303033373231' TO DFHEIV0(25:11)
  4040     CALL 'kxdfhei1' USING DFHEIV0,
  4041           W-ARCT-FILE-ID,
  4042           DFHEIV20,
  4043           DFHEIV99,
  4044           W-ARCT-KEY,
  4045           DFHEIV99,
  4046           DFHEIV99,
  4047           DFHEIV99
  4048     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  4049         DFHEIV20
  4050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4051
  4052
  4053     MOVE 'N' TO W-ADD-ARCT.
  4054     GO TO 3200-EXIT.
  4055
  4056 3200-NOT-FOUND.
  4057
  4058
  4059* EXEC CICS GETMAIN
  4060*         SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  4061*         LENGTH   (W-ARCT-LENGTH)
  4062*    END-EXEC.
  4063*    MOVE '," L                  $   #00003733' TO DFHEIV0
  4064     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4065     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4066     MOVE X'2020233030303033373333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  73
* EL691.cbl
  4067     CALL 'kxdfhei1' USING DFHEIV0,
  4068           DFHEIV20,
  4069           W-ARCT-LENGTH,
  4070           DFHEIV99
  4071     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  4072         DFHEIV20
  4073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4074
  4075
  4076     MOVE 'Y'                    TO W-ADD-ARCT.
  4077     MOVE LOW-VALUES             TO LETTER-ARCHIVE-TEXT.
  4078     MOVE 'LT'                   TO LT-RECORD-ID.
  4079     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
  4080     MOVE PI-689-ARCHIVE-NUMBER  TO LT-ARCHIVE-NO.
  4081     MOVE '3'                    TO LT-RECORD-TYPE.
  4082     MOVE +0                     TO LT-LINE-SEQ-NO.
  4083     MOVE +0                     TO LT-NUM-LINES-ON-RECORD.
  4084     SET PI-COMMENT-INDEX        TO W-ZEROS.
  4085
  4086 3200-EXIT.
  4087     EXIT.
  4088
  4089 3300-REWRITE-ARCT.
  4090
  4091
  4092* EXEC CICS REWRITE
  4093*        DATASET (W-ARCT-FILE-ID)
  4094*        FROM    (LETTER-ARCHIVE-TEXT)
  4095*    END-EXEC.
  4096     MOVE LENGTH OF
  4097      LETTER-ARCHIVE-TEXT
  4098       TO DFHEIV11
  4099*    MOVE '&& L                  %   #00003753' TO DFHEIV0
  4100     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4101     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4102     MOVE X'2020233030303033373533' TO DFHEIV0(25:11)
  4103     CALL 'kxdfhei1' USING DFHEIV0,
  4104           W-ARCT-FILE-ID,
  4105           LETTER-ARCHIVE-TEXT,
  4106           DFHEIV11,
  4107           DFHEIV99
  4108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4109
  4110
  4111 3300-EXIT.
  4112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  74
* EL691.cbl
  4114
  4115 3350-INSERT-ARCT.
  4116
  4117* EXEC CICS WRITE
  4118*         DATASET   (W-ARCT-FILE-ID)
  4119*         FROM      (LETTER-ARCHIVE-TEXT)
  4120*         RIDFLD    (LT-CONTROL-PRIMARY)
  4121*    END-EXEC.
  4122     MOVE LENGTH OF
  4123      LETTER-ARCHIVE-TEXT
  4124       TO DFHEIV11
  4125*    MOVE '&$ L                  ''   #00003763' TO DFHEIV0
  4126     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4127     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4128     MOVE X'2020233030303033373633' TO DFHEIV0(25:11)
  4129     CALL 'kxdfhei1' USING DFHEIV0,
  4130           W-ARCT-FILE-ID,
  4131           LETTER-ARCHIVE-TEXT,
  4132           DFHEIV11,
  4133           LT-CONTROL-PRIMARY,
  4134           DFHEIV99,
  4135           DFHEIV99
  4136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4137
  4138
  4139 3350-EXIT.
  4140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  75
* EL691.cbl
  4142
  4143
  4144 4000-ADD-CERT-NOTE.
  4145
  4146     MOVE SPACES                 TO  ERCNOT-KEY
  4147                                     ELCERT-KEY.
  4148     move spaces                 to cert-note-records-holder
  4149                                    ws-build-note-sw
  4150                                    ws-ercnot-sw
  4151     move +0                     to c1
  4152     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  4153                                     ELCERT-COMPANY-CD.
  4154     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  4155                                     ELCERT-CARRIER.
  4156     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  4157                                     ELCERT-GROUPING.
  4158     MOVE PI-STATE               TO  ERCNOT-STATE
  4159                                     ELCERT-STATE.
  4160     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  4161                                     ELCERT-ACCOUNT.
  4162     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  4163                                     ELCERT-EFF-DT.
  4164     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  4165                                     ELCERT-CERT-PRIME.
  4166     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  4167                                     ELCERT-CERT-SFX.
  4168     MOVE '1'                    TO  ERCNOT-REC-TYP
  4169     MOVE ZEROS                  TO  ERCNOT-SEQ.
  4170     MOVE ERCNOT-KEY             TO  SV-PRIOR-KEY.
  4171
  4172* EXEC CICS STARTBR
  4173*       DATASET    ('ERCNOT')
  4174*       RIDFLD     (ercnot-key)
  4175*       GTEQ
  4176*       RESP       (W-RESPONSE)
  4177*    END-EXEC
  4178     MOVE 'ERCNOT' TO DFHEIV1
  4179     MOVE 0
  4180       TO DFHEIV11
  4181*    MOVE '&,         G          &  N#00003801' TO DFHEIV0
  4182     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4183     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4184     MOVE X'204E233030303033383031' TO DFHEIV0(25:11)
  4185     CALL 'kxdfhei1' USING DFHEIV0,
  4186           DFHEIV1,
  4187           ercnot-key,
  4188           DFHEIV99,
  4189           DFHEIV11,
  4190           DFHEIV99
  4191     MOVE EIBRESP  TO W-RESPONSE
  4192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4193
  4194     IF RESP-NORMAL
  4195        set ercnot-startbr to true
  4196*       display ' resp normal startbr '
  4197        perform until finished-with-notes
  4198
  4199* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  76
* EL691.cbl
  4200*             DATASET    ('ERCNOT')
  4201*             RIDFLD     (ercnot-key)
  4202*             INTO       (cert-note-file)
  4203*             resp       (w-response)
  4204*          end-exec
  4205     MOVE LENGTH OF
  4206      cert-note-file
  4207       TO DFHEIV12
  4208     MOVE 'ERCNOT' TO DFHEIV1
  4209     MOVE 0
  4210       TO DFHEIV11
  4211*    MOVE '&.IL                  )  N#00003812' TO DFHEIV0
  4212     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4213     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4214     MOVE X'204E233030303033383132' TO DFHEIV0(25:11)
  4215     CALL 'kxdfhei1' USING DFHEIV0,
  4216           DFHEIV1,
  4217           cert-note-file,
  4218           DFHEIV12,
  4219           ercnot-key,
  4220           DFHEIV99,
  4221           DFHEIV11,
  4222           DFHEIV99,
  4223           DFHEIV99
  4224     MOVE EIBRESP  TO w-response
  4225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4226           if (resp-normal)
  4227              and (cz-control-primary (1:33) =
  4228                 sv-prior-key (1:33))
  4229              if cz-record-type = '1'
  4230                 add +1 to c1
  4231                 move cert-note-file
  4232                                 to cert-note-record (c1)
  4233              end-if
  4234           else
  4235              set finished-with-notes to true
  4236           end-if
  4237        end-perform
  4238     end-if
  4239
  4240     if ercnot-startbr
  4241*       display ' about to endbr ercnot '
  4242
  4243* exec cics endbr
  4244*          dataset    ('ERCNOT')
  4245*       end-exec
  4246     MOVE 'ERCNOT' TO DFHEIV1
  4247     MOVE 0
  4248       TO DFHEIV11
  4249*    MOVE '&2                    $   #00003834' TO DFHEIV0
  4250     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4251     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4252     MOVE X'2020233030303033383334' TO DFHEIV0(25:11)
  4253     CALL 'kxdfhei1' USING DFHEIV0,
  4254           DFHEIV1,
  4255           DFHEIV11,
  4256           DFHEIV99
  4257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  77
* EL691.cbl
  4258     end-if
  4259     move c1                     to note-count
  4260
  4261     if c1 = +0
  4262        perform 4100-add-note    thru 4100-exit
  4263     else
  4264        perform 4120-delete-cert-notes
  4265                                 thru 4120-exit
  4266        if resp-normal
  4267           perform 4100-add-note thru 4100-exit
  4268           if resp-normal
  4269              perform 4140-put-back-cert-notes
  4270                                 thru 4140-exit
  4271              if resp-normal
  4272                 display 'NOTE SUCCESSFULLY ADDED'
  4273              else
  4274                 display ' something wrong with put back '
  4275              end-if
  4276           else
  4277              display ' something went wrong with adding note '
  4278           end-if
  4279        else
  4280           display ' something went wrong with generic delete '
  4281        end-if
  4282     end-if
  4283
  4284     .
  4285 4099-EXIT.
  4286     EXIT.
  4287
  4288
  4289 4100-add-note.
  4290
  4291***  Need to check how long the note is
  4292
  4293     if w-comment-line-cnt = +0
  4294        go to 4100-exit
  4295     end-if
  4296
  4297     move 'CZ'                to cert-note-file
  4298     move sv-prior-key        to cz-control-primary
  4299     move '1'                 to cz-record-type
  4300     move +1                  to cz-note-sequence
  4301     move w-save-bin-date     to cz-last-maint-dt
  4302     move eibtime             to cz-last-maint-hhmmss
  4303     move pi-processor-id     to cz-last-maint-user
  4304     move w-comment-line-1    to cz-note
  4305
  4306     .
  4307 4100-write.
  4308
  4309
  4310* exec cics write
  4311*       dataset   ('ERCNOT')
  4312*       from      (cert-note-file)
  4313*       ridfld    (cz-control-primary)
  4314*       resp      (w-response)
  4315*    end-exec
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  78
* EL691.cbl
  4316     MOVE LENGTH OF
  4317      cert-note-file
  4318       TO DFHEIV11
  4319     MOVE 'ERCNOT' TO DFHEIV1
  4320*    MOVE '&$ L                  ''  N#00003888' TO DFHEIV0
  4321     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4322     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4323     MOVE X'204E233030303033383838' TO DFHEIV0(25:11)
  4324     CALL 'kxdfhei1' USING DFHEIV0,
  4325           DFHEIV1,
  4326           cert-note-file,
  4327           DFHEIV11,
  4328           cz-control-primary,
  4329           DFHEIV99,
  4330           DFHEIV99
  4331     MOVE EIBRESP  TO w-response
  4332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4333     if not resp-normal
  4334        display ' error-ercnot-write ' w-response ' '
  4335           cz-control-primary (2:33)
  4336        go to 4100-exit
  4337     else
  4338        display 'NOTE SUCCESSFULLY ADDED'
  4339     end-if
  4340
  4341     if w-comment-line-cnt > +1
  4342        move w-comment-line-2    to cz-note
  4343        add +1 to cz-note-sequence
  4344        move +0                  to w-comment-line-cnt
  4345        go to 4100-write
  4346     end-if
  4347
  4348     .
  4349 4100-exit.
  4350     exit.
  4351
  4352
  4353
  4354 4120-delete-cert-notes.
  4355
  4356     move sv-prior-key (1:33)    to ercnot-key
  4357     move '1'                    to ercnot-rec-typ
  4358     move +0                     to ercnot-seq
  4359
  4360* exec cics delete
  4361*       dataset    ('ERCNOT')
  4362*       keylength  (ws-cert-note-generic-key-len)
  4363*       ridfld     (ercnot-key (1:34))
  4364*       generic
  4365*       resp       (w-response)
  4366*    end-exec
  4367     MOVE 'ERCNOT' TO DFHEIV1
  4368*    MOVE '&(  RKG               &  N#00003920' TO DFHEIV0
  4369     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  4370     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4371     MOVE X'204E233030303033393230' TO DFHEIV0(25:11)
  4372     CALL 'kxdfhei1' USING DFHEIV0,
  4373           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  79
* EL691.cbl
  4374           ercnot-key(1 : 34),
  4375           ws-cert-note-generic-key-len,
  4376           DFHEIV99,
  4377           DFHEIV99
  4378     MOVE EIBRESP  TO w-response
  4379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4380
  4381     .
  4382 4120-exit.
  4383     exit.
  4384
  4385 4140-put-back-cert-notes.
  4386
  4387     perform varying c1 from +1 by +1 until
  4388        c1 > note-count
  4389        move cert-note-record (c1)
  4390                                 to cert-note-file
  4391        add +2                   to cz-note-sequence
  4392*       display ' about to write ' cz-control-primary (2:19) ' '
  4393*          cz-control-primary (23:11) ' ' cz-note-sequence ' '
  4394*           cz-record-type ' ' cz-note-information
  4395
  4396* exec cics write
  4397*          dataset ('ERCNOT')
  4398*          FROM    (cert-note-file)
  4399*          ridfld  (cz-control-primary)
  4400*          resp    (w-response)
  4401*       end-exec
  4402     MOVE LENGTH OF
  4403      cert-note-file
  4404       TO DFHEIV11
  4405     MOVE 'ERCNOT' TO DFHEIV1
  4406*    MOVE '&$ L                  ''  N#00003942' TO DFHEIV0
  4407     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4408     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4409     MOVE X'204E233030303033393432' TO DFHEIV0(25:11)
  4410     CALL 'kxdfhei1' USING DFHEIV0,
  4411           DFHEIV1,
  4412           cert-note-file,
  4413           DFHEIV11,
  4414           cz-control-primary,
  4415           DFHEIV99,
  4416           DFHEIV99
  4417     MOVE EIBRESP  TO w-response
  4418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4419        if not resp-normal
  4420           display ' error-ercnot-write subsequ ' w-response ' '
  4421              cz-control-primary (2:33)
  4422           move +999             to c1
  4423        end-if
  4424     end-perform
  4425
  4426    .
  4427 4140-exit.
  4428     exit.
  4429
  4430 4160-check-comment.
  4431
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  80
* EL691.cbl
  4432     string
  4433        w-cert-note-comment ' ' delimited by '  '
  4434        la-form-a3 ' ' delimited by size
  4435        la-processor-cd ' ' delimited by size
  4436        pi-create-date delimited by size
  4437           into w-stop-letter-comment
  4438     end-string
  4439
  4440     perform varying n1 from +126 by -1 until
  4441        w-stop-letter-comment(n1:1) <> space
  4442     end-perform
  4443     if n1 < +64
  4444        move +1                  to w-comment-line-cnt
  4445        move w-stop-letter-comment
  4446                                 to w-comment-line-1
  4447        go to 4160-exit
  4448     end-if
  4449
  4450     move +2                     to w-comment-line-cnt
  4451
  4452     perform varying n1 from n1 by -1 until
  4453        ((w-stop-letter-comment(n1:1) = ' ')
  4454            and
  4455         (n1 < +64))
  4456        or (n1 < +1)
  4457     end-perform
  4458
  4459     if n1 < +1
  4460        move w-stop-letter-comment(1:63)
  4461                                 to w-comment-line-1
  4462        move w-stop-letter-comment(64:63)
  4463                                 to w-comment-line-2
  4464     else
  4465        move w-stop-letter-comment(1:n1)
  4466                                 to w-comment-line-1
  4467        move w-stop-letter-comment(n1 + 1:126 - n1)
  4468                                 to w-comment-line-2
  4469     end-if
  4470
  4471     .
  4472 4160-exit.
  4473     exit.
  4474 4500-UPDATE-BILL-NOTE SECTION.
  4475
  4476
  4477* EXEC CICS GETMAIN
  4478*         SET      (ADDRESS OF EOB-CODES)
  4479*         LENGTH   (ELEOBC-LENGTH)
  4480*    END-EXEC
  4481*    MOVE '," L                  $   #00004005' TO DFHEIV0
  4482     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4484     MOVE X'2020233030303034303035' TO DFHEIV0(25:11)
  4485     CALL 'kxdfhei1' USING DFHEIV0,
  4486           DFHEIV20,
  4487           ELEOBC-LENGTH,
  4488           DFHEIV99
  4489     SET ADDRESS OF EOB-CODES TO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  81
* EL691.cbl
  4490         DFHEIV20
  4491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4492
  4493     MOVE LOW-VALUES             TO ELEOBC-KEY
  4494     MOVE PI-COMPANY-CD          TO EOBC-COMPANY-CD
  4495     MOVE '5'                    TO EOBC-REC-TYPE
  4496
  4497
  4498* EXEC CICS STARTBR
  4499*        DATASET   (ELEOBC-FILE-ID)
  4500*        RIDFLD    (ELEOBC-KEY)
  4501*        GTEQ
  4502*        RESP      (W-RESPONSE)
  4503*    END-EXEC
  4504     MOVE 0
  4505       TO DFHEIV11
  4506*    MOVE '&,         G          &  N#00004014' TO DFHEIV0
  4507     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4509     MOVE X'204E233030303034303134' TO DFHEIV0(25:11)
  4510     CALL 'kxdfhei1' USING DFHEIV0,
  4511           ELEOBC-FILE-ID,
  4512           ELEOBC-KEY,
  4513           DFHEIV99,
  4514           DFHEIV11,
  4515           DFHEIV99
  4516     MOVE EIBRESP  TO W-RESPONSE
  4517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4518
  4519     IF NOT RESP-NORMAL
  4520        GO TO 4500-EXIT
  4521     END-IF
  4522      .
  4523 4500-READNEXT-ELEOBC.
  4524
  4525
  4526* EXEC CICS READNEXT
  4527*       INTO    (EOB-CODES)
  4528*       DATASET (ELEOBC-FILE-ID)
  4529*       RIDFLD  (ELEOBC-KEY)
  4530*       RESP    (W-RESPONSE)
  4531*    END-EXEC
  4532     MOVE LENGTH OF
  4533      EOB-CODES
  4534       TO DFHEIV12
  4535     MOVE 0
  4536       TO DFHEIV11
  4537*    MOVE '&.IL                  )  N#00004027' TO DFHEIV0
  4538     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4539     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4540     MOVE X'204E233030303034303237' TO DFHEIV0(25:11)
  4541     CALL 'kxdfhei1' USING DFHEIV0,
  4542           ELEOBC-FILE-ID,
  4543           EOB-CODES,
  4544           DFHEIV12,
  4545           ELEOBC-KEY,
  4546           DFHEIV99,
  4547           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  82
* EL691.cbl
  4548           DFHEIV99,
  4549           DFHEIV99
  4550     MOVE EIBRESP  TO W-RESPONSE
  4551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4552
  4553     IF RESP-NORMAL
  4554         IF EO-RECORD-TYPE NOT = '5'
  4555             GO TO 4500-EXIT
  4556         END-IF
  4557     ELSE
  4558         GO TO 4500-EXIT
  4559     END-IF
  4560
  4561     IF EO-RECORD-TYPE = '5' AND
  4562        EO-EOB-CODE = PI-ARCHIVE-LTRID
  4563           CONTINUE
  4564     ELSE
  4565         GO TO 4500-READNEXT-ELEOBC
  4566     END-IF
  4567
  4568     MOVE SPACES TO WS-FIND-BILLING-NOTE
  4569     MOVE EO-DESCRIPTION TO WS-FBN-NOTE
  4570     MOVE PI-ARCHIVE-LTRID TO WS-FBN-LTRID
  4571
  4572
  4573* EXEC CICS GETMAIN
  4574*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  4575*         LENGTH   (ERNOTE-LENGTH)
  4576*    END-EXEC
  4577*    MOVE '," L                  $   #00004053' TO DFHEIV0
  4578     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  4579     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4580     MOVE X'2020233030303034303533' TO DFHEIV0(25:11)
  4581     CALL 'kxdfhei1' USING DFHEIV0,
  4582           DFHEIV20,
  4583           ERNOTE-LENGTH,
  4584           DFHEIV99
  4585     SET ADDRESS OF CERTIFICATE-NOTE TO
  4586         DFHEIV20
  4587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4588
  4589     MOVE PI-COMPANY-CD          TO  ERNOTE-COMPANY-CD
  4590     MOVE PI-CARRIER             TO  ERNOTE-CARRIER
  4591     MOVE PI-GROUPING            TO  ERNOTE-GROUPING
  4592     MOVE PI-STATE               TO  ERNOTE-STATE
  4593     MOVE PI-ACCOUNT             TO  ERNOTE-ACCOUNT
  4594     MOVE PI-CERT-EFF-DT         TO  ERNOTE-CERT-EFF-DT
  4595     MOVE PI-CERT-PRIME          TO  ERNOTE-CERT-PRIME
  4596     MOVE PI-CERT-SFX            TO  ERNOTE-CERT-SFX
  4597     move '1'                    to  ernote-record-type
  4598
  4599
  4600* EXEC CICS READ
  4601*       DATASET    (ERNOTE-FILE-ID)
  4602*       RIDFLD     (ERNOTE-KEY)
  4603*       INTO       (CERTIFICATE-NOTE)
  4604*       RESP       (W-RESPONSE)
  4605*       UPDATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  83
* EL691.cbl
  4606*    END-EXEC
  4607     MOVE LENGTH OF
  4608      CERTIFICATE-NOTE
  4609       TO DFHEIV11
  4610*    MOVE '&"IL       EU         (  N#00004068' TO DFHEIV0
  4611     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4612     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4613     MOVE X'204E233030303034303638' TO DFHEIV0(25:11)
  4614     CALL 'kxdfhei1' USING DFHEIV0,
  4615           ERNOTE-FILE-ID,
  4616           CERTIFICATE-NOTE,
  4617           DFHEIV11,
  4618           ERNOTE-KEY,
  4619           DFHEIV99,
  4620           DFHEIV99,
  4621           DFHEIV99
  4622     MOVE EIBRESP  TO W-RESPONSE
  4623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4624
  4625     IF RESP-NORMAL
  4626       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  4627           (NOTE-SUB > +10) OR
  4628           (CN-LINE (NOTE-SUB) (1:29) =
  4629                             WS-FIND-BILLING-NOTE (1:29))
  4630       END-PERFORM
  4631       IF CN-LINE (NOTE-SUB) (1:29) NOT =
  4632                              WS-FIND-BILLING-NOTE (1:29)
  4633
  4634* EXEC CICS UNLOCK
  4635*           DATASET    (ERNOTE-FILE-ID)
  4636*        END-EXEC
  4637*    MOVE '&*                    #   #00004084' TO DFHEIV0
  4638     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4639     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4640     MOVE X'2020233030303034303834' TO DFHEIV0(25:11)
  4641     CALL 'kxdfhei1' USING DFHEIV0,
  4642           ERNOTE-FILE-ID,
  4643           DFHEIV99
  4644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4645         GO TO 4500-EXIT
  4646       END-IF
  4647
  4648       MOVE WS-RECEIVED-NOTE TO CN-LINE (NOTE-SUB) (50:20)
  4649       MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  4650       MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
  4651       MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  4652
  4653* EXEC CICS REWRITE
  4654*         DATASET    (ERNOTE-FILE-ID)
  4655*         FROM       (CERTIFICATE-NOTE)
  4656*         RESP       (W-RESPONSE)
  4657*      END-EXEC
  4658     MOVE LENGTH OF
  4659      CERTIFICATE-NOTE
  4660       TO DFHEIV11
  4661*    MOVE '&& L                  %  N#00004094' TO DFHEIV0
  4662     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4663     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  84
* EL691.cbl
  4664     MOVE X'204E233030303034303934' TO DFHEIV0(25:11)
  4665     CALL 'kxdfhei1' USING DFHEIV0,
  4666           ERNOTE-FILE-ID,
  4667           CERTIFICATE-NOTE,
  4668           DFHEIV11,
  4669           DFHEIV99
  4670     MOVE EIBRESP  TO W-RESPONSE
  4671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4672
  4673       .
  4674
  4675 4500-EXIT.
  4676     EXIT.
  4677
  4678
  4679 4800-CERTIFICATE-UPDATE SECTION.
  4680
  4681
  4682* EXEC CICS HANDLE CONDITION
  4683*        NOTFND   (4899-EXIT)
  4684*    END-EXEC.
  4685*    MOVE '"$I                   ! ( #00004108' TO DFHEIV0
  4686     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4688     MOVE X'2820233030303034313038' TO DFHEIV0(25:11)
  4689     CALL 'kxdfhei1' USING DFHEIV0
  4690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4691
  4692
  4693
  4694* EXEC CICS READ
  4695*    EQUAL
  4696*    DATASET   (ELCERT-FILE-ID)
  4697*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  4698*    RIDFLD    (ELCERT-KEY)
  4699*    UPDATE
  4700*    RESP      (W-RESPONSE)
  4701*    END-EXEC.
  4702*    MOVE '&"S        EU         (  N#00004112' TO DFHEIV0
  4703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4704     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4705     MOVE X'204E233030303034313132' TO DFHEIV0(25:11)
  4706     CALL 'kxdfhei1' USING DFHEIV0,
  4707           ELCERT-FILE-ID,
  4708           DFHEIV20,
  4709           DFHEIV99,
  4710           ELCERT-KEY,
  4711           DFHEIV99,
  4712           DFHEIV99,
  4713           DFHEIV99
  4714     SET ADDRESS OF CERTIFICATE-MASTER TO
  4715         DFHEIV20
  4716     MOVE EIBRESP  TO W-RESPONSE
  4717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4718
  4719
  4720     IF RESP-NORMAL
  4721        IF CM-NOTE-SW = ' '
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  85
* EL691.cbl
  4722           MOVE '1'        TO CM-NOTE-SW
  4723        ELSE
  4724           IF CM-NOTE-SW = '2'
  4725              MOVE '3'      TO CM-NOTE-SW
  4726           ELSE
  4727              IF CM-NOTE-SW = '4'
  4728                  MOVE '5'    TO CM-NOTE-SW
  4729              ELSE
  4730                 IF CM-NOTE-SW = '6'
  4731                    MOVE '7'  TO CM-NOTE-SW
  4732                 END-IF
  4733              END-IF
  4734           END-IF
  4735        END-IF
  4736
  4737* EXEC CICS REWRITE
  4738*          FROM      (CERTIFICATE-MASTER)
  4739*          DATASET   (ELCERT-FILE-ID)
  4740*       END-EXEC
  4741     MOVE LENGTH OF
  4742      CERTIFICATE-MASTER
  4743       TO DFHEIV11
  4744*    MOVE '&& L                  %   #00004137' TO DFHEIV0
  4745     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4746     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4747     MOVE X'2020233030303034313337' TO DFHEIV0(25:11)
  4748     CALL 'kxdfhei1' USING DFHEIV0,
  4749           ELCERT-FILE-ID,
  4750           CERTIFICATE-MASTER,
  4751           DFHEIV11,
  4752           DFHEIV99
  4753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4754     END-IF.
  4755
  4756 4899-EXIT.
  4757      EXIT.
  4758
  4759
  4760
  4761 8010-ARCH-NOT-OPEN.
  4762
  4763     MOVE ER-7388                TO EMI-ERROR.
  4764     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4765     MOVE -1                     TO MAINTL.
  4766     GO TO 8200-SEND-DATAONLY.
  4767
  4768 8015-ARCT-NOT-OPEN.
  4769
  4770     MOVE ER-7373                TO EMI-ERROR.
  4771     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4772     MOVE -1                     TO MAINTL.
  4773     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  86
* EL691.cbl
  4775
  4776 8100-SEND-INITIAL-MAP.
  4777
  4778     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4779
  4780     IF  NOT EMI-NO-ERRORS
  4781         MOVE EMI-MESSAGE-AREA (1)
  4782                                 TO ERRMSG1O
  4783     ELSE
  4784         MOVE SPACES             TO ERRMSG1O
  4785     END-IF.
  4786
  4787
  4788* EXEC CICS SEND
  4789*        MAP    (W-MAP)
  4790*        MAPSET (W-MAPSET)
  4791*        FROM   (EL691AO)
  4792*        ERASE
  4793*        CURSOR
  4794*    END-EXEC.
  4795     MOVE LENGTH OF
  4796      EL691AO
  4797       TO DFHEIV12
  4798     MOVE -1
  4799       TO DFHEIV11
  4800*    MOVE '8$     CT  E    H L F ,   #00004174' TO DFHEIV0
  4801     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4802     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4803     MOVE X'2020233030303034313734' TO DFHEIV0(25:11)
  4804     CALL 'kxdfhei1' USING DFHEIV0,
  4805           W-MAP,
  4806           EL691AO,
  4807           DFHEIV12,
  4808           W-MAPSET,
  4809           DFHEIV99,
  4810           DFHEIV99,
  4811           DFHEIV99,
  4812           DFHEIV11,
  4813           DFHEIV99,
  4814           DFHEIV99,
  4815           DFHEIV99
  4816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4817
  4818
  4819     GO TO 9000-RETURN-TRANS.
  4820
  4821 8100-EXIT.
  4822     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  87
* EL691.cbl
  4824
  4825 8200-SEND-DATAONLY.
  4826
  4827     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  4828
  4829     IF  NOT EMI-NO-ERRORS
  4830         MOVE EMI-MESSAGE-AREA (1)
  4831                                 TO ERRMSG1O
  4832     ELSE
  4833         MOVE SPACES             TO ERRMSG1O
  4834     END-IF.
  4835
  4836
  4837* EXEC CICS SEND
  4838*        MAP    (W-MAP)
  4839*        MAPSET (W-MAPSET)
  4840*        FROM   (EL691AO)
  4841*        DATAONLY
  4842*        CURSOR
  4843*    END-EXEC.
  4844     MOVE LENGTH OF
  4845      EL691AO
  4846       TO DFHEIV12
  4847     MOVE -1
  4848       TO DFHEIV11
  4849*    MOVE '8$D    CT       H L F ,   #00004199' TO DFHEIV0
  4850     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4851     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4852     MOVE X'2020233030303034313939' TO DFHEIV0(25:11)
  4853     CALL 'kxdfhei1' USING DFHEIV0,
  4854           W-MAP,
  4855           EL691AO,
  4856           DFHEIV12,
  4857           W-MAPSET,
  4858           DFHEIV99,
  4859           DFHEIV99,
  4860           DFHEIV99,
  4861           DFHEIV11,
  4862           DFHEIV99,
  4863           DFHEIV99,
  4864           DFHEIV99
  4865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4866
  4867
  4868     GO TO 9000-RETURN-TRANS.
  4869
  4870 8200-EXIT.
  4871     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  88
* EL691.cbl
  4873
  4874 8300-SEND-TEXT.
  4875
  4876
  4877* EXEC CICS SEND TEXT
  4878*        FROM    (LOGOFF-TEXT)
  4879*        LENGTH  (LOGOFF-LENGTH)
  4880*        ERASE
  4881*        FREEKB
  4882*    END-EXEC.
  4883*    MOVE '8&      T  E F  H   F -   #00004215' TO DFHEIV0
  4884     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4885     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4886     MOVE X'2020233030303034323135' TO DFHEIV0(25:11)
  4887     CALL 'kxdfhei1' USING DFHEIV0,
  4888           LOGOFF-TEXT,
  4889           LOGOFF-LENGTH,
  4890           DFHEIV99,
  4891           DFHEIV99,
  4892           DFHEIV99,
  4893           DFHEIV99,
  4894           DFHEIV99,
  4895           DFHEIV99,
  4896           DFHEIV99,
  4897           DFHEIV99,
  4898           DFHEIV99,
  4899           DFHEIV99
  4900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4901
  4902
  4903     GO TO 9000-RETURN-TRANS.
  4904
  4905 8300-EXIT.
  4906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  89
* EL691.cbl
  4908
  4909 8600-DEEDIT.
  4910
  4911
  4912* EXEC CICS BIF DEEDIT
  4913*         FIELD    (W-DEEDIT-FIELD)
  4914*         LENGTH   (15)
  4915*    END-EXEC.
  4916     MOVE 15
  4917       TO DFHEIV11
  4918*    MOVE '@"L                   #   #00004230' TO DFHEIV0
  4919     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4920     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4921     MOVE X'2020233030303034323330' TO DFHEIV0(25:11)
  4922     CALL 'kxdfhei1' USING DFHEIV0,
  4923           W-DEEDIT-FIELD,
  4924           DFHEIV11
  4925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4926
  4927
  4928 8600-EXIT.
  4929     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  90
* EL691.cbl
  4931
  4932 9000-RETURN-TRANS.
  4933
  4934     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  4935     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
  4936
  4937* EXEC CICS RETURN
  4938*        TRANSID    (W-TRANSACTION)
  4939*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4940*        LENGTH     (PI-COMM-LENGTH)
  4941*    END-EXEC.
  4942*    MOVE '.(CT                  ''   #00004243' TO DFHEIV0
  4943     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4945     MOVE X'2020233030303034323433' TO DFHEIV0(25:11)
  4946     CALL 'kxdfhei1' USING DFHEIV0,
  4947           W-TRANSACTION,
  4948           PROGRAM-INTERFACE-BLOCK,
  4949           PI-COMM-LENGTH,
  4950           DFHEIV99,
  4951           DFHEIV99,
  4952           DFHEIV99
  4953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4954
  4955
  4956 9000-EXIT.
  4957     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  91
* EL691.cbl
  4959
  4960 9200-PA.
  4961
  4962     MOVE ER-7008                TO EMI-ERROR.
  4963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4964     MOVE -1                     TO MAINTL.
  4965     GO TO 8200-SEND-DATAONLY.
  4966
  4967 9200-EXIT.
  4968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  92
* EL691.cbl
  4970
  4971 9300-DFHCLEAR.
  4972
  4973     MOVE PI-RETURN-TO-PROGRAM TO W-CALL-PGM.
  4974     GO TO 9400-XCTL.
  4975
  4976 9300-EXIT.
  4977     EXIT.
  4978
  4979 9400-XCTL.
  4980
  4981
  4982* EXEC CICS XCTL
  4983*        PROGRAM  (W-CALL-PGM)
  4984*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4985*        LENGTH   (PI-COMM-LENGTH)
  4986*    END-EXEC.
  4987*    MOVE '.$C                   %   #00004274' TO DFHEIV0
  4988     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4990     MOVE X'2020233030303034323734' TO DFHEIV0(25:11)
  4991     CALL 'kxdfhei1' USING DFHEIV0,
  4992           W-CALL-PGM,
  4993           PROGRAM-INTERFACE-BLOCK,
  4994           PI-COMM-LENGTH,
  4995           DFHEIV99
  4996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4997
  4998
  4999 9400-EXIT.
  5000     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  93
* EL691.cbl
  5002
  5003 9500-LINK-DATE-CONVERT.
  5004
  5005
  5006* EXEC CICS LINK
  5007*        PROGRAM    ('ELDATCV')
  5008*        COMMAREA   (DATE-CONVERSION-DATA)
  5009*        LENGTH     (DC-COMM-LENGTH)
  5010*    END-EXEC.
  5011     MOVE 'ELDATCV' TO DFHEIV1
  5012*    MOVE '."C                   (   #00004286' TO DFHEIV0
  5013     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5014     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5015     MOVE X'2020233030303034323836' TO DFHEIV0(25:11)
  5016     CALL 'kxdfhei1' USING DFHEIV0,
  5017           DFHEIV1,
  5018           DATE-CONVERSION-DATA,
  5019           DC-COMM-LENGTH,
  5020           DFHEIV99,
  5021           DFHEIV99,
  5022           DFHEIV99,
  5023           DFHEIV99
  5024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5025
  5026
  5027 9500-EXIT.
  5028     EXIT.
  5029
  5030 9600-FORMAT-DATE-TIME.
  5031
  5032     MOVE W-SAVE-DATE            TO RUNDTEO.
  5033     MOVE EIBTIME                TO W-TIME-IN.
  5034     MOVE W-TIME-OUT             TO RUNTIMEO.
  5035     MOVE PI-COMPANY-ID          TO COMPANYO.
  5036     MOVE PI-PROCESSOR-ID        TO USERIDO.
  5037     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  5038
  5039     IF PI-ARCHIVE-COMPLETE = 'Y'
  5040        MOVE AL-SANOF           TO STCOMPA
  5041        MOVE AL-SADOF           TO STRECVA
  5042                                   STSTOPA
  5043                                   STFINLA
  5044     ELSE
  5045       IF PI-ARCHIVE-RECEIVED = 'Y'
  5046           MOVE AL-SANOF        TO STRECVA
  5047           MOVE AL-SADOF        TO STCOMPA
  5048                                   STSTOPA
  5049                                   STFINLA
  5050       ELSE
  5051         IF PI-ARCHIVE-STOPPED = 'Y'
  5052             MOVE AL-SANOF      TO STSTOPA
  5053             MOVE AL-SADOF      TO STCOMPA
  5054                                   STRECVA
  5055                                   STFINLA
  5056         ELSE
  5057           IF PI-ARCHIVE-FINAL = 'Y'
  5058               MOVE AL-SANOF    TO STFINLA
  5059               MOVE AL-SADOF    TO STCOMPA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  94
* EL691.cbl
  5060                                   STRECVA
  5061                                   STSTOPA
  5062           ELSE
  5063               MOVE AL-SADOF    TO STCOMPA
  5064                                   STRECVA
  5065                                   STSTOPA
  5066                                   STFINLA
  5067           END-IF
  5068         END-IF
  5069       END-IF
  5070     END-IF.
  5071
  5072
  5073 9600-EXIT.
  5074     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  95
* EL691.cbl
  5076
  5077 9700-PGMID-ERROR.
  5078
  5079
  5080* EXEC CICS  HANDLE CONDITION
  5081*        PGMIDERR  (8300-SEND-TEXT)
  5082*    END-EXEC.
  5083*    MOVE '"$L                   ! ) #00004344' TO DFHEIV0
  5084     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5086     MOVE X'2920233030303034333434' TO DFHEIV0(25:11)
  5087     CALL 'kxdfhei1' USING DFHEIV0
  5088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5089
  5090
  5091     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  5092     MOVE ' '                    TO PI-ENTRY-CD-1.
  5093     MOVE W-XCTL-005             TO W-CALL-PGM
  5094                                    LOGOFF-PGM.
  5095     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  5096
  5097     PERFORM 9400-XCTL THRU 9400-EXIT.
  5098
  5099 9700-EXIT.
  5100     EXIT.
  5101
  5102 9800-ABEND.
  5103
  5104     MOVE W-LINK-004             TO W-CALL-PGM.
  5105     MOVE DFHEIBLK               TO EMI-LINE1
  5106
  5107
  5108* EXEC CICS  LINK
  5109*        PROGRAM   (W-CALL-PGM)
  5110*        COMMAREA  (EMI-LINE1)
  5111*        LENGTH    (72)
  5112*    END-EXEC.
  5113     MOVE 72
  5114       TO DFHEIV11
  5115*    MOVE '."C                   (   #00004364' TO DFHEIV0
  5116     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5118     MOVE X'2020233030303034333634' TO DFHEIV0(25:11)
  5119     CALL 'kxdfhei1' USING DFHEIV0,
  5120           W-CALL-PGM,
  5121           EMI-LINE1,
  5122           DFHEIV11,
  5123           DFHEIV99,
  5124           DFHEIV99,
  5125           DFHEIV99,
  5126           DFHEIV99
  5127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5128
  5129
  5130     GO TO 8200-SEND-DATAONLY.
  5131
  5132 9800-EXIT.
  5133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  96
* EL691.cbl
  5135
  5136 9900-ERROR-FORMAT.
  5137
  5138     IF  EMI-ERROR EQUAL ER-9097
  5139         NEXT SENTENCE
  5140     ELSE
  5141         IF  EMI-ERRORS-COMPLETE
  5142                 OR
  5143             EMI-ERROR EQUAL W-LAST-ERROR
  5144             GO TO 9900-EXIT
  5145     END-IF.
  5146
  5147     ADD +1  TO  W-ERROR-COUNT.
  5148     MOVE W-LINK-001             TO W-CALL-PGM.
  5149
  5150
  5151* EXEC CICS LINK
  5152*        PROGRAM    (W-CALL-PGM)
  5153*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  5154*        LENGTH     (EMI-COMM-LENGTH)
  5155*    END-EXEC.
  5156*    MOVE '."C                   (   #00004390' TO DFHEIV0
  5157     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5159     MOVE X'2020233030303034333930' TO DFHEIV0(25:11)
  5160     CALL 'kxdfhei1' USING DFHEIV0,
  5161           W-CALL-PGM,
  5162           ERROR-MESSAGE-INTERFACE-BLOCK,
  5163           EMI-COMM-LENGTH,
  5164           DFHEIV99,
  5165           DFHEIV99,
  5166           DFHEIV99,
  5167           DFHEIV99
  5168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5169
  5170
  5171     MOVE EMI-ERROR              TO W-LAST-ERROR.
  5172
  5173 9900-EXIT.
  5174     EXIT.
  5175
  5176 9905-INITIALIZE-SECURITY.
  5177******************************************************************
  5178*                                                                *
  5179*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  5180*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  5181*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  5182*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  5183*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  5184*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  5185*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  5186*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
  5187*                                                                *
  5188*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
  5189*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  5190*                                                                *
  5191******************************************************************
  5192
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  97
* EL691.cbl
  5193     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  5194         MOVE 'Y'                TO PI-DISPLAY-CAP
  5195                                    PI-MODIFY-CAP
  5196     ELSE
  5197
  5198* EXEC CICS READQ TS
  5199*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5200*            INTO   (SECURITY-CONTROL)
  5201*            LENGTH (SC-COMM-LENGTH)
  5202*            ITEM   (1)
  5203*        END-EXEC
  5204     MOVE 1
  5205       TO DFHEIV11
  5206*    MOVE '*$II   L              ''   #00004422' TO DFHEIV0
  5207     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5208     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5209     MOVE X'2020233030303034343232' TO DFHEIV0(25:11)
  5210     CALL 'kxdfhei1' USING DFHEIV0,
  5211           PI-SECURITY-TEMP-STORE-ID,
  5212           SECURITY-CONTROL,
  5213           SC-COMM-LENGTH,
  5214           DFHEIV11,
  5215           DFHEIV99,
  5216           DFHEIV99
  5217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5218         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  5219                                 TO PI-DISPLAY-CAP
  5220         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  5221                                 TO PI-MODIFY-CAP
  5222     END-IF.
  5223
  5224 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  98
* EL691.cbl
  5226
  5227 9995-SECURITY-VIOLATION.
  5228
  5229     MOVE EIBDATE                TO SM-JUL-DATE.
  5230     MOVE EIBTRMID               TO SM-TERMID.
  5231     MOVE W-THIS-PGM             TO SM-PGM.
  5232     MOVE EIBTIME                TO W-TIME-IN.
  5233     MOVE W-TIME-OUT             TO SM-TIME.
  5234     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
  5235
  5236
  5237* EXEC CICS LINK
  5238*         PROGRAM  ('EL003')
  5239*         COMMAREA (SECURITY-MESSAGE)
  5240*         LENGTH   (80)
  5241*    END-EXEC.
  5242     MOVE 'EL003' TO DFHEIV1
  5243     MOVE 80
  5244       TO DFHEIV11
  5245*    MOVE '."C                   (   #00004446' TO DFHEIV0
  5246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5248     MOVE X'2020233030303034343436' TO DFHEIV0(25:11)
  5249     CALL 'kxdfhei1' USING DFHEIV0,
  5250           DFHEIV1,
  5251           SECURITY-MESSAGE,
  5252           DFHEIV11,
  5253           DFHEIV99,
  5254           DFHEIV99,
  5255           DFHEIV99,
  5256           DFHEIV99
  5257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5258
  5259
  5260 9995-EXIT.
  5261     EXIT.
  5262
  5263 9999-GOBACK.
  5264
  5265
  5266* GOBACK.
  5267     MOVE '9%                    "   ' TO DFHEIV0
  5268     MOVE 'EL691' TO DFHEIV1
  5269     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5270     GOBACK.
  5271
  5272 9999-EXIT.
  5273     EXIT.
  5274
  5275 9999-DFHBACK SECTION.
  5276     MOVE '9%                    "   ' TO DFHEIV0
  5277     MOVE 'EL691' TO DFHEIV1
  5278     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5279     GOBACK.
  5280 9999-DFHEXIT.
  5281     IF DFHEIGDJ EQUAL 0001
  5282         NEXT SENTENCE
  5283     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  99
* EL691.cbl
  5284         GO TO 9300-DFHCLEAR,
  5285               9200-PA,
  5286               9200-PA,
  5287               9200-PA
  5288         DEPENDING ON DFHEIGDI
  5289     ELSE IF DFHEIGDJ EQUAL 3
  5290         GO TO 9700-PGMID-ERROR,
  5291               9800-ABEND
  5292         DEPENDING ON DFHEIGDI
  5293     ELSE IF DFHEIGDJ EQUAL 4
  5294         GO TO 8010-ARCH-NOT-OPEN,
  5295               1070-ARCH-NOT-FOUND,
  5296               1070-ARCH-NOT-FOUND
  5297         DEPENDING ON DFHEIGDI
  5298     ELSE IF DFHEIGDJ EQUAL 5
  5299         GO TO 8015-ARCT-NOT-OPEN,
  5300               1000-ARCT-NOT-FOUND,
  5301               1000-ARCT-NOT-FOUND
  5302         DEPENDING ON DFHEIGDI
  5303     ELSE IF DFHEIGDJ EQUAL 6
  5304         GO TO 8010-ARCH-NOT-OPEN,
  5305               1070-ARCH-NOT-FOUND,
  5306               1070-ARCH-NOT-FOUND
  5307         DEPENDING ON DFHEIGDI
  5308     ELSE IF DFHEIGDJ EQUAL 7
  5309         GO TO 3200-NOT-FOUND,
  5310               3200-NOT-FOUND
  5311         DEPENDING ON DFHEIGDI
  5312     ELSE IF DFHEIGDJ EQUAL 8
  5313         GO TO 4899-EXIT
  5314         DEPENDING ON DFHEIGDI
  5315     ELSE IF DFHEIGDJ EQUAL 9
  5316         GO TO 8300-SEND-TEXT
  5317         DEPENDING ON DFHEIGDI.
  5318     MOVE '9%                    "   ' TO DFHEIV0
  5319     MOVE 'EL691' TO DFHEIV1
  5320     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5321     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      214652     Code:       17977
