* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   1
* EL152.cbl
* Options: int("EL152.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL152.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL152.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL152.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL152 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/14/94 08:03:40.
     7*                            VMOD=2.055.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX27 - CLAIMS LETTER WRITER.
    13
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   2
* EL152.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23*                                REMOVE OBSOLETE CODE
    24* 102703                   SMVA  MOD COPY MEMBER ELCNAMET TO LEAVE
    25*                                CERTIFICATION DESIGNATION ON
    26*                                PROCESSOR NAME LINE IN CAPS
    27* 121203                   SMVA  ADD PROCESSING FOR NEW CLM TYP G
    28* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    29* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    30* 010407    2006111300003  PEMA  ADD PROCESSING FOR CARRIER 8
    31* 060109  CR2008102800002  PEMA  ADD VAR 16.1
    32* 033110  CR2009122800001  AJRA  NAPERSOFT
    33* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    34* 011212  IR2012011100002  AJRA  FIX DCC PROMPT LETTER
    35* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    36* 041513  CR2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    37* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   3
* EL152.cbl
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL152 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    48
    49*77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    50*77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    51*                                  USAGE POINTER.
    52 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    53 77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    54                                   USAGE POINTER.
    55 77  B1                          PIC S9(5) COMP-3 VALUE +0.
    56 77  S1                          PIC S9 VALUE +0.
    57 77  S2                          PIC S9 VALUE +0.
    58 01  P pointer.
    59 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    60 01  var-ptr pointer.
    61 01  env-var-len                 pic 9(4)  binary.
    62 01  rc                          pic 9(9)  binary.
    63 01  WS-KIXSYS.
    64     05  WS-KIX-FIL1             PIC X(10).
    65     05  WS-KIX-APPS             PIC X(10).
    66     05  WS-KIX-ENV              PIC X(10).
    67     05  WS-KIX-MYENV            PIC X(10).
    68     05  WS-KIX-SYS              PIC X(10).
    69 01  WS-HOLDING-ZIPS.
    70     05  FILLER              PIC X(10)  VALUE '--AM-ZIP--'.
    71     05  WS-AM-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    72     05  FILLER              PIC X(10)  VALUE '--AT-ZIP--'.
    73     05  WS-AT-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    74     05  FILLER              PIC X(10)  VALUE '--BE-ZIP--'.
    75     05  WS-BE-ZIP-CODE      PIC X(9)   VALUE 'XXXXXXXXX'.
    76     05  FILLER              PIC X(10)  VALUE '--CO-ZIP--'.
    77     05  WS-CO-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    78     05  FILLER              PIC X(17)  VALUE '--AM-ZIP-BEFORE--'.
    79     05  WS-AM-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    80     05  FILLER              PIC X(17)  VALUE '--AT-ZIP-BEFORE--'.
    81     05  WS-AT-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    82     05  FILLER              PIC X(17)  VALUE '--BE-ZIP-BEFORE--'.
    83     05  WS-BE-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    84     05  FILLER              PIC X(17)  VALUE '--CO-ZIP-BEFORE--'.
    85     05  WS-CO-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    86     05  FILLER              PIC X(17)  VALUE '-----------------'.
    87
    88*                            COPY ELCSCTM.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCTM                             *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    96*                                                                *
    97******************************************************************
    98 01  SECURITY-MESSAGE.
    99     12  FILLER                          PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   4
* EL152.cbl
   100            VALUE '** LOGIC SECURITY VIOLATION -'.
   101     12  SM-READ                         PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' PGM='.
   104     12  SM-PGM                          PIC X(6).
   105     12  FILLER                          PIC X(5)
   106            VALUE ' OPR='.
   107     12  SM-PROCESSOR-ID                 PIC X(4).
   108     12  FILLER                          PIC X(6)
   109            VALUE ' TERM='.
   110     12  SM-TERMID                       PIC X(4).
   111     12  FILLER                          PIC XX   VALUE SPACE.
   112     12  SM-JUL-DATE                     PIC 9(5).
   113     12  FILLER                          PIC X    VALUE SPACE.
   114     12  SM-TIME                         PIC 99.99.
   115
   116
   117*                            COPY ELCSCRTY.
   118******************************************************************
   119*                                                                *
   120*                                                                *
   121*                            ELCSCRTY                            *
   122*                            VMOD=2.001                          *
   123*                                                                *
   124*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   125*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   126*        SAVED IN PI-SECURITY-ADDRESS.                           *
   127*                                                                *
   128******************************************************************
   129 01  SECURITY-CONTROL.
   130     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   131     12  FILLER                       PIC XX    VALUE 'SC'.
   132     12  SC-CREDIT-CODES.
   133         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   134             20  SC-CREDIT-DISPLAY    PIC X.
   135             20  SC-CREDIT-UPDATE     PIC X.
   136     12  SC-CLAIMS-CODES.
   137         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   138             20  SC-CLAIMS-DISPLAY    PIC X.
   139             20  SC-CLAIMS-UPDATE     PIC X.
   140
   141 01  WS-DATE-AREA.
   142     12  SAVE-DATE               PIC X(08)    VALUE SPACES.
   143     12  SAVE-BIN-DATE           PIC XX       VALUE SPACES.
   144     12  W-REVERSE-DATE-SW       PIC X        VALUE SPACES.
   145         88  W-REVERSE-DATE                   VALUE 'Y'.
   146     12  W-EDIT-DATE-1.
   147         16  W-ED1-MM            PIC XX.
   148         16  FILLER              PIC X        VALUE '/'.
   149         16  W-ED1-DD            PIC XX.
   150         16  FILLER              PIC X        VALUE '/'.
   151         16  W-ED1-YY            PIC XX.
   152     12  W-EDIT-DATE-2.
   153         16  W-ED2-DD            PIC XX.
   154         16  FILLER              PIC X        VALUE '/'.
   155         16  W-ED2-MM            PIC XX.
   156         16  FILLER              PIC X        VALUE '/'.
   157         16  W-ED2-YY            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   5
* EL152.cbl
   158 01  FILLER.
   159     05  WS-WORK-INT-RATE        PIC 99.999.
   160     05  WS-WORK-INT REDEFINES WS-WORK-INT-RATE
   161                                 PIC X(6).
   162 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   163     'BEGINJOB mode=''MVS'''.
   164 01  TRAN-DATA-LINE2.
   165*     05  FILLER                  PIC X(39)    VALUE
   166*     '"smtp -f EL152cl2 -t pema,kmsb,jmsb -s '.
   167     05  FILLER                  PIC X(29)    VALUE
   168     '"smtp -f EL152cl2 -t ajra -s '.
   169     05  TRAN-DETAIL.
   170         10  FILLER              PIC XX       VALUE
   171         ''' '.
   172         10  TRAN-DL2-USER       PIC X(05)    VALUE SPACES.
   173         10  TRAN-DL2-ARCHNO     PIC ZZZZ999  VALUE ZEROS.
   174         10  FILLER              PIC X        VALUE SPACES.
   175         10  TRAN-DL2-CCC        PIC X(22)    VALUE SPACES.
   176     05  FILLER                  PIC XX       VALUE '''"'.
   177     05  FILLER                  PIC X(30)    VALUE SPACES.
   178 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   179     'ENDJOB            '.
   180
   181 01  WS-PRINTER-ID               PIC X(4)    VALUE SPACES.
   182 01  STANDARD-AREAS.
   183     12  WS-ACCT-READ-SW         PIC X       VALUE ' '.
   184     12  WS-COMP-READ-SW         PIC X       VALUE ' '.
   185     12  WS-PROD-READ-SW         PIC X       VALUE ' '.
   186     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   187     12  MAP-NAME.
   188         16  MAP-PREFIX          PIC XX      VALUE 'EL'.
   189         16  MAP-NUMBER          PIC X(4)    VALUE '152A'.
   190         16  MAP-FILLER          PIC XX      VALUE SPACES.
   191     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   192     12  MAPSET-NAME             PIC X(8)    VALUE 'EL152S'.
   193     12  TRANS-ID                PIC X(4)    VALUE 'EX27'.
   194     12  PRINT-TRANS             PIC X(4)    VALUE 'EX57'.
   195     12  LGXX-ID                 PIC X(4)    VALUE 'LGXX'.
   196     12  PGM-NAME                PIC X(8).
   197     12  TIME-IN                 PIC S9(7).
   198     12  TIME-OUT-R  REDEFINES TIME-IN.
   199         16  FILLER              PIC X.
   200         16  TIME-OUT            PIC 99V99.
   201         16  FILLER              PIC XX.
   202     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   203     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   204     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   205     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   206     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   207     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   208     12  THIS-PGM                PIC X(8)    VALUE 'EL152'.
   209     12  LINK-EL1522             PIC X(8)    VALUE 'EL1522'.
   210     12  PGM-EL126               PIC X(8)    VALUE 'EL126'.
   211     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   212     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   213     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   214     12  SUB                     PIC 99.
   215     12  WS-LABELS-SW            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   6
* EL152.cbl
   216
   217     12  WS-PI-QID.
   218         16  QID-TERM            PIC X(4)    VALUE SPACES.
   219         16  FILLER              PIC X(4)    VALUE '152A'.
   220
   221     12  W-LETTER-ADDRESS-TYPE.
   222         16  W-LETTER-ADDR-TYPE  PIC  X VALUE SPACES.
   223         16  W-LETTER-ADDR-SEQ   PIC  9 VALUE ZEROS.
   224
   225     12  W-ADDRESS-SELECTION.
   226         16  W-ACCOUNT           PIC  9 VALUE ZEROS.
   227         16  W-BENEFICIARY       PIC  9 VALUE ZEROS.
   228         16  W-EMPLOYER          PIC  9 VALUE ZEROS.
   229         16  W-INSURED           PIC  9 VALUE ZEROS.
   230         16  W-OTHER-1           PIC  9 VALUE ZEROS.
   231         16  W-OTHER-2           PIC  9 VALUE ZEROS.
   232         16  W-PHYSICIAN         PIC  9 VALUE ZEROS.
   233
   234     12  W-Z-CONTROL-DATA.
   235         16  W-NUMBER-OF-COPIES  PIC  9.
   236         16  FILLER              PIC  X.
   237         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   238         16  FILLER              PIC  X.
   239         16  W-DAYS-TO-RESEND-1  PIC  999.
   240         16  FILLER              PIC  X.
   241         16  W-FORM-TO-RESEND    PIC  X(4).
   242         16  FILLER              PIC  X(1).
   243         16  W-PROMPT-LETTER     PIC  X(1).
   244         16  FILLER              PIC  X(1).
   245         16  W-ENCLOSURE-CD      PIC  X(3).
   246         16  FILLER              PIC  X(1).
   247         16  W-AUTO-CLOSE-IND    PIC  X(1).
   248         16  FILLER              PIC  X(1).
   249         16  W-LETTER-TO-BENE    PIC  X(1).
   250
   251     12  W-CREDIT-CARD-LOAN-NO.
   252         16  W-LOAN-NO           PIC  X(08).
   253         16  W-CURRENT-LOAN-NO   PIC  X(12).
   254
   255     12  W-GROUPING.
   256         16  W-GROUP-3           PIC  XXX.
   257         16  FILLER              PIC  XXX.
   258
   259     12  W-NAME.
   260         16  W-FIRST-NAME        PIC  X(12).
   261         16  W-MIDDLE-NAME       PIC  X(12).
   262         16  W-LAST-NAME         PIC  X(15).
   263
   264     12  WS-PHONE-IN             PIC 9(11)   VALUE ZEROS.
   265     12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   266         16  FILLER              PIC 9.
   267         16  WSPI-AREA           PIC 9(3).
   268         16  WSPI-PFX            PIC 9(3).
   269         16  WSPI-SFX            PIC 9(4).
   270     12  WS-PHONE-OUT.
   271         16  WSPO-AREA           PIC X(3).
   272         16  FILLER              PIC X       VALUE '-'.
   273         16  WSPO-PFX            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   7
* EL152.cbl
   274         16  FILLER              PIC X       VALUE '-'.
   275         16  WSPO-SFX            PIC X(4).
   276
   277     12  WS-ZIP-NUMERIC          PIC 9(9).
   278     12  WS-ZIP-NONNUM  REDEFINES  WS-ZIP-NUMERIC
   279                                 PIC X(9).
   280
   281     12  WS-ZIP-CODE.
   282         16  WS-AM-ZIP-CODE      PIC X(5).
   283         16  WS-AM-ZIP-DASH      PIC X.
   284         16  WS-AM-ZIP-PLUS4     PIC X(4).
   285     12  WS-ZIP-CODE-CANADIAN  REDEFINES  WS-ZIP-CODE.
   286         16  WS-CAN-POSTAL-1     PIC XXX.
   287         16  FILLER              PIC X.
   288         16  WS-CAN-POSTAL-2     PIC XXX.
   289         16  FILLER              PIC XXX.
   290
   291     12  WS-LABEL-HOLD-AREA.
   292         16  WS-LABEL-LINES OCCURS 6 TIMES
   293                            INDEXED BY WS-NDX  WS-NDX2.
   294             20  WS-LABEL-ZIP.
   295                 24  WS-LABEL-1ST-ZIP  PIC X(5).
   296                 24  FILLER            PIC X.
   297                 24  WS-LABEL-2ND-ZIP  PIC X(4).
   298             20  FILLER                PIC X(9).
   299             20  WS-LAST-DIGIT         PIC X.
   300             20  WS-LAST-ZIP.
   301                 24  WS-LAST-1ST-ZIP   PIC X(5).
   302                 24  FILLER            PIC X.
   303                 24  WS-LAST-2ND-ZIP   PIC X(4).
   304
   305     12  WS-DATA-FOUND-SW            PIC X.
   306         88  NO-CHARACTERS-FOUND           VALUE 'N'.
   307
   308     12  WS-SKIP-EMAIL           PIC X       VALUE 'N'.
   309     12  WS-STATE-LINE           PIC X       VALUE 'N'.
   310     12  WS-PROCESSOR-LINE       PIC X(01)   VALUE 'N'.
   311     12  WS-CAPS-SW              PIC X(01)   VALUE 'N'.
   312         88  THE-REST-R-CAPS                 VALUE 'Y'.
   313     12  WS-POSITION2            PIC S9(4)   COMP.
   314     12  WS-POSITION21           PIC S9(4)   COMP.
   315     12  WS-WORD-LENGTH          PIC S9(4)   COMP-3.
   316
   317     12  WS-TEMP-AREA1.
   318         16  WS-TEMP-1           PIC X OCCURS 29
   319                                       INDEXED BY TA1.
   320     12  WS-TEMP-AREA2.
   321         16  WS-TEMP-2           PIC X OCCURS 30
   322                                       INDEXED BY TA2
   323                                                  TA21
   324                                                  MOVE-INDX.
   325
   326     12  WS-SAVE-TEMP-AREA2      PIC X(30)   VALUE SPACES.
   327
   328     12  ACCT-BROWSE-STARTED     PIC X       VALUE 'N'.
   329     12  TEXT-BROWSE-STARTED     PIC X       VALUE 'N'.
   330     12  ARCH-BROWSE-STARTED     PIC X       VALUE 'N'.
   331     12  ACTV-BROWSE-STARTED     PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   8
* EL152.cbl
   332     12  PROD-BROWSE-STARTED     PIC X       VALUE 'N'.
   333     12  INDX-WORK               PIC 99.
   334     12  TEMP-CURR-LINE          PIC S9(3)    COMP-3.
   335
   336     12  DATE-WORK               PIC 9(7).
   337     12  DT-REDEF REDEFINES DATE-WORK.
   338         16  FILLER              PIC XX.
   339         16  DT-WORK             PIC 9(5).
   340
   341     12  BEN-HOLD                PIC XX.
   342
   343     12  BENEFIT-WORK            PIC XXX.
   344     12  BEN-R REDEFINES BENEFIT-WORK.
   345         16  ELIM-DAYS           PIC XX.
   346         16  FILLER              PIC X.
   347
   348     12  GETMAIN-SWITCH          PIC 9        VALUE 0.
   349         88  NO-GETMAIN-DONE-YET              VALUE 0.
   350         88  REFRESH-GETMAIN-AREA             VALUE 1.
   351
   352     12  WORK-AMOUNT             PIC S9(9)V99 VALUE +0.
   353     12  CURRENT-SAVE            PIC XX.
   354     12  CURRENT-PLUS3-SAVE      PIC XX.
   355     12  RESEND-SAVE             PIC XX    VALUE LOW-VALUE.
   356     12  FOLLOW-UP-SAVE          PIC XX    VALUE LOW-VALUE.
   357     12  SEQ-COUNTER             PIC S9(4) COMP.
   358     12  CORR-TRLR-SEQ           PIC S9(4) COMP.
   359     12  DEEDIT-FIELD            PIC X(15).
   360     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   361
   362     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   363     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   364
   365     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   366     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   367
   368     12  WS-CCN-12               PIC X(12).
   369
   370     12  WS-ADDR-TYPE-CD.
   371         16  WS-ADDR-TYPE        PIC X.
   372         16  WS-ADDR-SEQ         PIC X.
   373         16  WS-ADDR-SEQ-NUM REDEFINES
   374             WS-ADDR-SEQ         PIC 9.
   375
   376     12  WS-DMD-CERT-STATE       PIC XX.
   377     12  WS-DMD-CERT-GROUPING    PIC XX.
   378     12  WS-DMD-BEN-CODE         PIC XX.
   379     12  WS-DMD-CORR-TRLR-SEQ    PIC S9(4) COMP.
   380     12  WS-DMD-LETTER-FORM      PIC X(4).
   381     12  WS-DMD-RES-ST           PIC XX.
   382
   383     12  WS-DMD-UND-STATEMENT    PIC X(50)  VALUE
   384          'Central States provides plan administration for'.
   385
   386     12  WS-DMD-UND-COMPANYA     PIC X(50)  VALUE
   387          'Central States Health and Life Co.'.
   388
   389     12  WS-DMD-UND-COMPANYB     PIC X(50)  VALUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   9
* EL152.cbl
   390          'Central States Indemnity Co.'.
   391
   392* DLO023
   393 01  DL23-COMM-LENGTH            PIC S9(4) COMP VALUE +132.
   394 01  WS-DLO-CODES-TABLE.
   395     12  DL23-SYSTEM-ID          PIC XX.
   396     12  DL23-RECORD-TYPE        PIC XX.
   397     12  DL23-RECORD-KEY         PIC X(6).
   398     12  DL23-RETURN-CODE        PIC XX.
   399     12  DL23-CODE-DESC          PIC X(60).
   400     12  DL23-GEN-DESC-1         PIC X(20).
   401     12  DL23-GEN-DESC-2         PIC X(20).
   402     12  DL23-GEN-DESC-3         PIC X(20).
   403     12  WS-LETTER-STATUS        PIC X        VALUE ' '.
   404     12  WS-BLANK                PIC X        VALUE ' '.
   405
   406 01  WS-SAVE-ACCT-RECORD         PIC X(2000)  VALUE SPACES.
   407 01  WS-SAVE-PRODUCER-RECORD     PIC X(2000)  VALUE SPACES.
   408
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  10
* EL152.cbl
   410 01  ACCESS-KEYS-AND-FILE-IDS.
   411     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   412     12  ACCT-ID                  PIC X(8)    VALUE 'ERACCT'.
   413     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   414     12  ARCH-ID                  PIC X(8)    VALUE 'ELARCH'.
   415     12  ARCT-ID                  PIC X(8)    VALUE 'ELARCT'.
   416     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   417     12  TEXT-ID                  PIC X(8)    VALUE 'ELLETR'.
   418     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   419     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   420     12  PROD-ID                  PIC X(8)    VALUE 'MPPROD'.
   421     12  PLCY-ID                  PIC X(8)    VALUE 'MPPLCY'.
   422     12  PLAN-ID                  PIC X(8)    VALUE 'MPPLAN'.
   423     12  NAPS-ID                  PIC X(8)    VALUE 'ELNAPS'.
   424     12  ENCC-ID                  PIC X(8)    VALUE 'ELENCC'.
   425
   426     12  CNTL-KEY.
   427         16  CNTL-CO              PIC X(3).
   428         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   429         16  CNTL-GENL.
   430           18 CNTL-GEN1           PIC XX      VALUE SPACES.
   431           18 CNTL-GEN2.
   432             20 CNTL-GEN3         PIC X       VALUE SPACES.
   433             20 CNTL-GEN4         PIC X       VALUE SPACES.
   434         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   435
   436      12  WS-ERCOMP-KEY.
   437          16  WS-ERCOMP-COMPANY-CD PIC X.
   438          16  WS-ERCOMP-CARRIER    PIC X.
   439          16  WS-ERCOMP-GROUPING   PIC X(6).
   440          16  WS-ERCOMP-RESP-NO    PIC X(10).
   441          16  WS-ERCOMP-ACCOUNT    PIC X(10).
   442          16  WS-ERCOMP-TYPE       PIC X.
   443
   444     12  CLAM-KEY.
   445         16  CLAM-CO              PIC X.
   446         16  CLAM-CARRIER         PIC X.
   447         16  CLAM-CLAIM           PIC X(7).
   448         16  CLAM-CERT-NUM        PIC X(11).
   449
   450     12  TEXT-KEY.
   451         16  TEXT-PARTIAL-KEY.
   452             20  TEXT-CO          PIC X.
   453             20  TEXT-LETTER      PIC X(4).
   454         16  TEXT-FILLER          PIC X(8)    VALUE SPACES.
   455         16  TEXT-SEQ             PIC S9(4)   VALUE +0    COMP.
   456
   457     12  ACTV-KEY.
   458         16  ACTV-PARTIAL-KEY.
   459             20  ACTV-CO          PIC X.
   460             20  ACTV-CARRIER     PIC X.
   461             20  ACTV-CLAIM       PIC X(7).
   462             20  ACTV-CERT-NUM    PIC X(11).
   463         16  ACTV-SEQ             PIC S9(4)   VALUE +0    COMP.
   464
   465     12  CERT-KEY.
   466         16  CERT-CO              PIC X.
   467         16  CERT-CARRIER         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  11
* EL152.cbl
   468         16  CERT-GROUPING        PIC X(6).
   469         16  CERT-STATE           PIC XX.
   470         16  CERT-ACCOUNT         PIC X(10).
   471         16  CERT-EFF-DT          PIC XX.
   472         16  CERT-CERT-NUM        PIC X(11).
   473
   474     12  ACCT-KEY.
   475         16  ACCT-PARTIAL-KEY.
   476             20  ACCT-CO              PIC X.
   477             20  ACCT-CARRIER         PIC X.
   478             20  ACCT-GROUPING        PIC X(6).
   479             20  ACCT-STATE           PIC XX.
   480             20  ACCT-ACCOUNT         PIC X(10).
   481         16  ACCT-EXP-DATE            PIC XX.
   482
   483     12  ARCH-KEY.
   484         16  ARCH-PARTIAL-KEY.
   485             20  ARCH-CO          PIC X.
   486             20  ARCH-NUMBER      PIC S9(8)      COMP.
   487         16  ARCH-REC-TYPE        PIC X.
   488         16  ARCH-SEQ             PIC S9(4)      COMP VALUE +0.
   489
   490     12  BENE-KEY.
   491         16  BENE-COMP-CD         PIC X.
   492         16  BENE-REC-TYPE        PIC X.
   493         16  BENE-NUMBER.
   494             20  BENE-CREDITOR    PIC XXX.
   495             20  FILLER           PIC X(7).
   496
   497     12  PROD-KEY.
   498         16  PROD-PARTIAL-KEY.
   499             20  PROD-CO          PIC X.
   500             20  PROD-CARRIER     PIC X.
   501             20  PROD-GROUPING    PIC X(6).
   502             20  PROD-STATE       PIC XX.
   503             20  PROD-PRODUCER    PIC X(10).
   504         16  PROD-EXP-DATE        PIC XX.
   505
   506     12  PLCY-KEY.
   507         16  PLCY-CO              PIC X.
   508         16  PLCY-CARRIER         PIC X.
   509         16  PLCY-GROUPING        PIC X(06).
   510         16  PLCY-STATE           PIC XX.
   511         16  PLCY-PRODUCER        PIC X(10).
   512         16  PLCY-EFF-DT          PIC XX.
   513         16  PLCY-REFERENCE-NO    PIC X(20).
   514
   515     12  PLAN-KEY.
   516         16  PLAN-CO              PIC X.
   517         16  PLAN-CARRIER         PIC X.
   518         16  PLAN-GROUPING        PIC X(6).
   519         16  PLAN-STATE           PIC XX.
   520         16  PLAN-PRODUCER        PIC X(10).
   521         16  PLAN-CODE            PIC XX.
   522         16  PLAN-REV-NO          PIC 999.
   523
   524     12  ELENCC-KEY.
   525         16  ELENCC-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  12
* EL152.cbl
   526         16  ELENCC-REC-TYPE      PIC X.
   527         16  ELENCC-ENC-CODE      PIC X(5).
   528         16  F                    PIC X(09).
   529
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  13
* EL152.cbl
   531     12  ARCH-SAVE-KEY           PIC X(5).
   532     12  ACTV-SAVE-KEY           PIC X(20).
   533     12  ACCT-SAVE-KEY           PIC X(20).
   534     12  PROD-SAVE-KEY           PIC X(20).
   535     12  ACCT-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   536     12  ARCH-LENGTH             PIC S9(4)  COMP  VALUE +90.
   537     12  ARCT-LENGTH             PIC S9(4)  COMP  VALUE +90.
   538     12  ACTV-LENGTH             PIC S9(4)  COMP  VALUE +200.
   539     12  PROD-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   540     12  NAPS-LENGTH             PIC S9(4)  COMP  VALUE +150.
   541     12  ENCC-LENGTH             PIC S9(4)  COMP  VALUE +400.
   542     12  TEXT-SAVE-KEY           PIC X(5).
   543     12  SAVE-VARIABLE-POINTER   PIC S9(8)   COMP.
   544     12  VAR-HOLD.
   545         16  V1                  PIC X.
   546         16  V2                  PIC X.
   547         16  V3                  PIC X.
   548         16  V4                  PIC X.
   549     12  V-HOLD REDEFINES VAR-HOLD.
   550         16  V-NUM               PIC 99.
   551         16  V-PERIOD            PIC X.
   552         16  V-DECIMAL           PIC 9.
   553
   554     12  MAX-LINES               PIC 999     VALUE 300.
   555     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 13.
   556     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   557     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0     COMP-3.
   558     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   559     12  TS-ITEM                 PIC S9(4)   VALUE +0    COMP.
   560     12  TS-MAP-LENGTH           PIC S9(4)   VALUE +1343 COMP.
   561     12  ROLL-COUNTER            PIC S999    VALUE +0    COMP-3.
   562     12  TS-NAME-TEXT.
   563         16  TS-ID-TEXT          PIC X(4)    VALUE '104A'.
   564         16  TS-ID-TIME REDEFINES TS-ID-TEXT  PIC S9(7) COMP-3.
   565         16  TS-TERM-TEXT.
   566          17 TS-TERM-PREFIX      PIC XX.
   567          17 FILLER              PIC XX.
   568     12  TS-NAME-SCREEN.
   569         16  FILLER              PIC X(4)    VALUE '152X'.
   570         16  TS-TERM-SCREEN      PIC X(4).
   571
   572     12  LINE-NUM.
   573         16  LINE1               PIC X.
   574         16  LINE23              PIC 99.
   575     12  LIN-NUM REDEFINES LINE-NUM  PIC 999.
   576     12  TOP-FORM                PIC X(70)
   577         VALUE '*****TOP OF FORM *****'.
   578     12  SINGLE-LINE             PIC X(70).
   579     12  SINGLE-LINE-BY-1 REDEFINES SINGLE-LINE.
   580         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY INDX1 INDX2
   581                                 PIC X.
   582     12  NAPERSOFT-LETTER        PIC X(16)
   583         VALUE 'Napersoft letter'.
   584
   585     12  WS-RESPONSE             PIC S9(8)   COMP.
   586         88  RESP-NORMAL              VALUE +00.
   587         88  RESP-ERROR               VALUE +01.
   588         88  RESP-NOTFND              VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  14
* EL152.cbl
   589         88  RESP-NOTOPEN             VALUE +19.
   590         88  RESP-ENDFILE             VALUE +20.
   591
   592 01  HAN-LETTER-REASON-DATA.
   593     12  WS-REASON-TEXT.
   594         16  WS-RE-NDX           PIC 99.
   595         16  FILLER              PIC X(68).
   596
   597     12  HAN-REASON-TABLE.
   598         16  FILLER              PIC X(50) VALUE
   599           'ADDITIONAL INFO REQUESTED FROM PHYSICIAN          '.
   600         16  FILLER              PIC X(50) VALUE
   601           'CHECKING PRE-EXISTING CONDITION                   '.
   602         16  FILLER              PIC X(50) VALUE
   603           'ADDITIONAL INFO RECEIVED / CLAIM REOPENED         '.
   604         16  FILLER              PIC X(50) VALUE
   605           'LETTER TO INSURED                                 '.
   606         16  FILLER              PIC X(50) VALUE
   607           'LETTER TO CREDITOR                                '.
   608         16  FILLER              PIC X(50) VALUE
   609           'LETTER TO EMPLOYER                                '.
   610         16  FILLER              PIC X(50) VALUE
   611           'LETTER TO INSURED / 2ND REQUEST                   '.
   612         16  FILLER              PIC X(50) VALUE
   613           'LETTER TO CREDITOR / 2ND REQUEST                  '.
   614         16  FILLER              PIC X(50) VALUE
   615           'LETTER TO EMPLOYER / 2ND REQUEST                  '.
   616         16  FILLER              PIC X(50) VALUE
   617           'AWAITING INITIAL CLAIM FORM                       '.
   618         16  FILLER              PIC X(50) VALUE
   619           'AWAITING SUPPLEMENTAL INFORMATION                 '.
   620         16  FILLER              PIC X(50) VALUE
   621           'DENIED / PRE-EXISTING CONDITION                   '.
   622         16  FILLER              PIC X(50) VALUE
   623           'DENIED / WAITING PERIOD NOT MET                   '.
   624         16  FILLER              PIC X(50) VALUE
   625           'DENIED / NORMAL PREGNANCY                         '.
   626         16  FILLER              PIC X(50) VALUE
   627           'DENIED / ACT OF WAR                               '.
   628         16  FILLER              PIC X(50) VALUE
   629           'DENIED / NOT TOTALLY DISABLED                     '.
   630         16  FILLER              PIC X(50) VALUE
   631           'DENIED / NOT UNDER CARE & TREATMENT OF PHYSICIAN  '.
   632         16  FILLER              PIC X(50) VALUE
   633           'DENIED / NO COVERAGE INFORCE                      '.
   634         16  FILLER              PIC X(50) VALUE
   635           'DENIED / DISABLED ON DATE OF LOAN                 '.
   636         16  FILLER              PIC X(50) VALUE
   637           'DENIED / OVER MAXIMUM AGE                         '.
   638         16  FILLER              PIC X(50) VALUE
   639           'CLOSED / CLAIM INFO NOT PROVIDED                  '.
   640         16  FILLER              PIC X(50) VALUE
   641           'PHYSICIAN INFORMATION INCOMPLETE                  '.
   642         16  FILLER              PIC X(50) VALUE
   643           'ACKNOWLEDGEMENT LETTER TO INSURED                 '.
   644         16  FILLER              PIC X(50) VALUE
   645           'DENIED/SUICIDE EXCLUSION                          '.
   646         16  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  15
* EL152.cbl
   647           'DENIED/LOAN EFFECTIVE BEFORE POLICY EFFECTIVE DATE'.
   648         16  FILLER              PIC X(50) VALUE
   649           'DENIED/JOINT DEBTORS NOT COVERED                  '.
   650         16  FILLER              PIC X(50) VALUE
   651           'DENIED/GROUP POLICY LAPSED                        '.
   652         16  FILLER              PIC X(50) VALUE
   653           'DENIED/DECEASED PRIOR TO POLICY EFFECTIVE DATE    '.
   654         16  FILLER              PIC X(50) VALUE
   655           'DENIED/LOAN TERM IN EXCESS OF MAXIMUM LOAN TERM   '.
   656         16  FILLER              PIC X(50) VALUE
   657           'DENIED/INSURED NOT PERMANENTLY & TOTALLY DISABLED '.
   658         16  FILLER              PIC X(50) VALUE
   659           'DENIED/IME EXAM DOES NOT SUPPORT CONT. DISABILITY '.
   660         16  FILLER              PIC X(50) VALUE
   661           'DENIED/INSURED DID NOT APPEAR FOR IME EXAM        '.
   662
   663     12  HAN-LETTER-REASON-TABLE  REDEFINES  HAN-REASON-TABLE.
   664         16  HAN-TABLE-ENTRIES  OCCURS  32  TIMES.
   665             20  HAN-REASON-TEXT PIC X(50).
   666
   667 01  ERROR-MESSAGES.
   668     12  ER-0000                 PIC X(4)  VALUE '0000'.
   669     12  ER-0004                 PIC X(4)  VALUE '0004'.
   670     12  ER-0006                 PIC X(4)  VALUE '0006'.
   671     12  ER-0008                 PIC X(4)  VALUE '0008'.
   672     12  ER-0013                 PIC X(4)  VALUE '0013'.
   673     12  ER-0023                 PIC X(4)  VALUE '0023'.
   674     12  ER-0029                 PIC X(4)  VALUE '0029'.
   675     12  ER-0033                 PIC X(4)  VALUE '0033'.
   676     12  ER-0042                 PIC X(4)  VALUE '0042'.
   677     12  ER-0047                 PIC X(4)  VALUE '0047'.
   678     12  ER-0051                 PIC X(4)  VALUE '0051'.
   679     12  ER-0066                 PIC X(4)  VALUE '0066'.
   680     12  ER-0067                 PIC X(4)  VALUE '0067'.
   681     12  ER-0070                 PIC X(4)  VALUE '0070'.
   682     12  ER-0133                 PIC X(4)  VALUE '0133'.
   683     12  ER-0154                 PIC X(4)  VALUE '0154'.
   684     12  ER-0168                 PIC X(4)  VALUE '0168'.
   685     12  ER-0169                 PIC X(4)  VALUE '0169'.
   686     12  ER-0172                 PIC X(4)  VALUE '0172'.
   687     12  ER-0174                 PIC X(4)  VALUE '0174'.
   688     12  ER-0175                 PIC X(4)  VALUE '0175'.
   689     12  ER-0176                 PIC X(4)  VALUE '0176'.
   690     12  ER-0177                 PIC X(4)  VALUE '0177'.
   691     12  ER-0178                 PIC X(4)  VALUE '0178'.
   692     12  ER-0179                 PIC X(4)  VALUE '0179'.
   693     12  ER-0180                 PIC X(4)  VALUE '0180'.
   694     12  ER-0181                 PIC X(4)  VALUE '0181'.
   695     12  ER-0182                 PIC X(4)  VALUE '0182'.
   696     12  ER-0183                 PIC X(4)  VALUE '0183'.
   697     12  ER-0184                 PIC X(4)  VALUE '0184'.
   698     12  ER-0185                 PIC X(4)  VALUE '0185'.
   699     12  ER-0186                 PIC X(4)  VALUE '0186'.
   700     12  ER-0187                 PIC X(4)  VALUE '0187'.
   701     12  ER-0188                 PIC X(4)  VALUE '0188'.
   702     12  ER-0189                 PIC X(4)  VALUE '0189'.
   703     12  ER-0190                 PIC X(4)  VALUE '0190'.
   704     12  ER-0191                 PIC X(4)  VALUE '0191'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  16
* EL152.cbl
   705     12  ER-0206                 PIC X(4)  VALUE '0206'.
   706     12  ER-0211                 PIC X(4)  VALUE '0211'.
   707     12  ER-0279                 PIC X(4)  VALUE '0279'.
   708     12  ER-0280                 PIC X(4)  VALUE '0280'.
   709     12  ER-0281                 PIC X(4)  VALUE '0281'.
   710     12  ER-0332                 PIC X(4)  VALUE '0332'.
   711     12  ER-0343                 PIC X(4)  VALUE '0343'.
   712     12  ER-0373                 PIC X(4)  VALUE '0373'.
   713     12  ER-0374                 PIC X(4)  VALUE '0374'.
   714     12  ER-0412                 PIC X(4)  VALUE '0412'.
   715     12  ER-0413                 PIC X(4)  VALUE '0413'.
   716     12  ER-0533                 PIC X(4)  VALUE '0533'.
   717     12  ER-0537                 PIC X(4)  VALUE '0537'.
   718     12  ER-0716                 PIC X(4)  VALUE '0716'.
   719     12  ER-0861                 PIC X(4)  VALUE '0861'.
   720     12  ER-0894                 PIC X(4)  VALUE '0894'.
   721     12  ER-0900                 PIC X(4)  VALUE '0900'.
   722     12  ER-0909                 PIC X(4)  VALUE '0909'.
   723     12  ER-0911                 PIC X(4)  VALUE '0911'.
   724     12  ER-0912                 PIC X(4)  VALUE '0912'.
   725     12  ER-1236                 PIC X(4)  VALUE '1236'.
   726     12  ER-1560                 PIC X(4)  VALUE '1560'.
   727     12  ER-2055                 PIC X(4)  VALUE '2055'.
   728     12  ER-2397                 PIC X(4)  VALUE '2397'.
   729     12  ER-2398                 PIC X(4)  VALUE '2398'.
   730     12  ER-3547                 PIC X(4)  VALUE '3547'.
   731     12  ER-3770                 PIC X(4)  VALUE '3770'.
   732     12  ER-3771                 PIC X(4)  VALUE '3771'.
   733     12  ER-3772                 PIC X(4)  VALUE '3772'.
   734     12  ER-7675                 PIC X(4)  VALUE '7675'.
   735     12  ER-7840                 PIC X(4)  VALUE '7840'.
   736     12  ER-7842                 PIC X(4)  VALUE '7842'.
   737     12  ER-7843                 PIC X(4)  VALUE '7843'.
   738     12  ER-8158                 PIC X(4)  VALUE '8158'.
   739     12  ER-9106                 PIC X(4)  VALUE '9106'.
   740     12  ER-9483                 PIC X(4)  VALUE '9483'.
   741     12  ER-9808                 PIC X(4)  VALUE '9808'.
   742     12  ER-9883                 PIC X(4)  VALUE '9883'.
   743     12  ER-9887                 PIC X(4)  VALUE '9887'.
   744
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  17
* EL152.cbl
   746****************************************************
   747*       WHEN ADDING OR DELETING ENTRIES TO         *
   748*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
   749*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
   750*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
   751*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
   752*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
   753*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
   754*                                                  *
   755*   3 FIELDS TO CHANGE:                            *
   756*      1 - SS-NUM-ENTRIES........(NO.OF ENTRIES)   *
   757*      2 - SS-WORK-AREA-LENGTH...(TOTAL LENGTH)    *
   758*      3 - SYSTEM-VARIABLES......( "      "   )    *
   759****************************************************
   760
   761*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
   762*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
   763
   764     12  SS-NUM-ENTRIES          PIC 999    VALUE 130      COMP-3.
   765     12  SS-COUNTER              PIC 999                   COMP-3.
   766     12  SS-WORK-AREA-LENGTH     PIC S9(4)  VALUE +3865    COMP.
   767
   768 01  VARIABLE-WORK-AREA.
   769     12  VAR-CODE                PIC X(4).
   770     12  VAR-LEN                 PIC 99.
   771     12  VAR-DATA                PIC X(100).
   772     12  VAR-DATA-R REDEFINES VAR-DATA.
   773       16  VAR-ONE-CHAR OCCURS 100 TIMES INDEXED BY INDXV PIC X.
   774
   775 01  SYSTEM-SUPPORTED-VARIABLES.
   776*****COMPANY NAME
   777     12  SS01                    PIC X(4)  VALUE     '01.0'.
   778     12  SS01L                   PIC 99    VALUE 36.
   779     12  SS01D                   PIC X(30) VALUE ALL '*'.
   780*****FULL COMPANY ADDRESS
   781     12  SS02-1                  PIC X(4)  VALUE     '02.1'.
   782     12  SS02-1L                 PIC 99    VALUE 36.
   783     12  SS02-1D                 PIC X(30) VALUE ALL '*'.
   784     12  SS02-2                  PIC X(4)  VALUE     '02.2'.
   785     12  SS02-2L                 PIC 99    VALUE 36.
   786     12  SS02-2D                 PIC X(30) VALUE ALL '*'.
   787     12  SS02-3                  PIC X(4)  VALUE     '02.3'.
   788     12  SS02-3L                 PIC 99    VALUE 36.
   789     12  SS02-3D                 PIC X(30) VALUE ALL '*'.
   790     12  SS02-4                  PIC X(4)  VALUE     '02.4'.
   791     12  SS02-4L                 PIC 99    VALUE 36.
   792     12  SS02-4D                 PIC X(30) VALUE ALL '*'.
   793     12  SS02-5                  PIC X(4)  VALUE     '02.5'.
   794     12  SS02-5L                 PIC 99    VALUE 36.
   795     12  SS02-5D                 PIC X(30) VALUE ALL '*'.
   796*****CARRIER NAME
   797     12  SS03                    PIC X(4)  VALUE     '03.0'.
   798     12  SS03L                   PIC 99    VALUE 36.
   799     12  SS03D                   PIC X(30) VALUE ALL '*'.
   800*****INVESTORS HERITAGE
   801* as Administrator for Investors Heritage Life Insurance Company
   802     12  SS03-1                  PIC X(4)  VALUE     '03.1'.
   803     12  SS03-1L                 PIC 99    VALUE 68.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  18
* EL152.cbl
   804     12  SS03-1D                 PIC X(62) VALUE ALL '*'.
   805*****FULL CARRIER ADDRESS
   806     12  SS04-1                  PIC X(4)  VALUE     '04.1'.
   807     12  SS04-1L                 PIC 99    VALUE 36.
   808     12  SS04-1D                 PIC X(30) VALUE ALL '*'.
   809     12  SS04-2                  PIC X(4)  VALUE     '04.2'.
   810     12  SS04-2L                 PIC 99    VALUE 36.
   811     12  SS04-2D                 PIC X(30) VALUE ALL '*'.
   812     12  SS04-3                  PIC X(4)  VALUE     '04.3'.
   813     12  SS04-3L                 PIC 99    VALUE 36.
   814     12  SS04-3D                 PIC X(30) VALUE ALL '*'.
   815     12  SS04-4                  PIC X(4)  VALUE     '04.4'.
   816     12  SS04-4L                 PIC 99    VALUE 36.
   817     12  SS04-4D                 PIC X(30) VALUE ALL '*'.
   818     12  SS04-5                  PIC X(4)  VALUE     '04.5'.
   819     12  SS04-5L                 PIC 99    VALUE 36.
   820     12  SS04-5D                 PIC X(30) VALUE ALL '*'.
   821*****CARRIER PHONE NUMBER
   822     12  SS04-6                  PIC X(4)  VALUE     '04.6'.
   823     12  SS04-6L                 PIC 99    VALUE 18.
   824     12  SS04-6D                 PIC X(12) VALUE ALL '*'.
   825*****FULL ADDRESEE LABEL
   826     12  SS05-1                  PIC X(4)  VALUE     '05.1'.
   827     12  SS05-1L                 PIC 99    VALUE 36.
   828     12  SS05-1D                 PIC X(30) VALUE ALL '*'.
   829     12  SS05-2                  PIC X(4)  VALUE     '05.2'.
   830     12  SS05-2L                 PIC 99    VALUE 36.
   831     12  SS05-2D                 PIC X(30) VALUE ALL '*'.
   832     12  SS05-3                  PIC X(4)  VALUE     '05.3'.
   833     12  SS05-3L                 PIC 99    VALUE 36.
   834     12  SS05-3D                 PIC X(30) VALUE ALL '*'.
   835     12  SS05-4                  PIC X(4)  VALUE     '05.4'.
   836     12  SS05-4L                 PIC 99    VALUE 36.
   837     12  SS05-4D                 PIC X(30) VALUE ALL '*'.
   838     12  SS05-5                  PIC X(4)  VALUE     '05.5'.
   839     12  SS05-5L                 PIC 99    VALUE 36.
   840     12  SS05-5D                 PIC X(30) VALUE ALL '*'.
   841     12  SS05-6                  PIC X(4)  VALUE     '05.6'.
   842     12  SS05-6L                 PIC 99    VALUE 36.
   843     12  SS05-6D                 PIC X(30) VALUE ALL '*'.
   844*****ACCOUNT NAME
   845     12  SS06                    PIC X(4)  VALUE     '06.0'.
   846     12  SS06L                   PIC 99    VALUE 36.
   847     12  SS06D                   PIC X(30) VALUE ALL '*'.
   848*****FULL ACCOUNT ADDRESS
   849     12  SS07-1                  PIC X(4)  VALUE     '07.1'.
   850     12  SS07-1L                 PIC 99    VALUE 36.
   851     12  SS07-1D                 PIC X(30) VALUE ALL '*'.
   852     12  SS07-2                  PIC X(4)  VALUE     '07.2'.
   853     12  SS07-2L                 PIC 99    VALUE 36.
   854     12  SS07-2D                 PIC X(30) VALUE ALL '*'.
   855     12  SS07-3                  PIC X(4)  VALUE     '07.3'.
   856     12  SS07-3L                 PIC 99    VALUE 36.
   857     12  SS07-3D                 PIC X(30) VALUE ALL '*'.
   858     12  SS07-4                  PIC X(4)  VALUE     '07.4'.
   859     12  SS07-4L                 PIC 99    VALUE 36.
   860     12  SS07-4D                 PIC X(30) VALUE ALL '*'.
   861     12  SS07-5                  PIC X(4)  VALUE     '07.5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  19
* EL152.cbl
   862     12  SS07-5L                 PIC 99    VALUE 36.
   863     12  SS07-5D                 PIC X(30) VALUE ALL '*'.
   864*****ACCOUNT PHONE NUMBER
   865     12  SS07-6                  PIC X(4)  VALUE     '07.6'.
   866     12  SS07-6L                 PIC 99    VALUE 18.
   867     12  SS07-6D                 PIC X(12) VALUE ALL '*'.
   868*****EXECUTING PROCESSOR NAME
   869     12  SS08                    PIC X(4)  VALUE     '08.0'.
   870     12  SS08L                   PIC 99    VALUE 36.
   871     12  SS08D                   PIC X(30) VALUE ALL '*'.
   872*****PROCESSOR TITLE
   873     12  SS09                    PIC X(4)  VALUE     '09.0'.
   874     12  SS09L                   PIC 99    VALUE 32.
   875     12  SS09D                   PIC X(26) VALUE ALL '*'.
   876*****INSUREDS NAME
   877     12  SS10                    PIC X(4)  VALUE     '10.0'.
   878     12  SS10L                   PIC 99    VALUE 36.
   879     12  SS10D                   PIC X(30) VALUE ALL '*'.
   880*****INSUREDS ADDRESS
   881     12  SS11-1                  PIC X(4)  VALUE     '11.1'.
   882     12  SS11-1L                 PIC 99    VALUE 36.
   883     12  SS11-1D                 PIC X(30) VALUE ALL '*'.
   884     12  SS11-2                  PIC X(4)  VALUE     '11.2'.
   885     12  SS11-2L                 PIC 99    VALUE 36.
   886     12  SS11-2D                 PIC X(30) VALUE ALL '*'.
   887     12  SS11-3                  PIC X(4)  VALUE     '11.3'.
   888     12  SS11-3L                 PIC 99    VALUE 36.
   889     12  SS11-3D                 PIC X(30) VALUE ALL '*'.
   890     12  SS11-4                  PIC X(4)  VALUE     '11.4'.
   891     12  SS11-4L                 PIC 99    VALUE 36.
   892     12  SS11-4D                 PIC X(30) VALUE ALL '*'.
   893*****INSUREDS NAME FROM ADDR TRAILER
   894     12  SS11-5                  PIC X(4)  VALUE     '11.5'.
   895     12  SS11-5L                 PIC 99    VALUE 36.
   896     12  SS11-5D                 PIC X(30) VALUE ALL '*'.
   897*****INSUREDS PHONE NUMBER FROM ADDR TRAILER
   898     12  SS11-6                  PIC X(4)  VALUE     '11.6'.
   899     12  SS11-6L                 PIC 99    VALUE 18.
   900     12  SS11-6D                 PIC X(12) VALUE ALL '*'.
   901*****CLAIM TYPE NAME
   902     12  SS12                    PIC X(4)  VALUE     '12.0'.
   903     12  SS12L                   PIC 99    VALUE 12.
   904     12  SS12D                   PIC X(6)  VALUE ALL '*'.
   905*****CLAIM INCURRED DATE
   906     12  SS13                    PIC X(4)  VALUE     '13.0'.
   907     12  SS13L                   PIC 99    VALUE 14.
   908     12  SS13D                   PIC X(8)  VALUE ALL '*'.
   909*****CLAIM REPORTED DATE
   910     12  SS14                    PIC X(4)  VALUE     '14.0'.
   911     12  SS14L                   PIC 99    VALUE 14.
   912     12  SS14D                   PIC X(8)  VALUE ALL '*'.
   913*****LAST PAYMENT DATE
   914     12  SS15                    PIC X(4)  VALUE     '15.0'.
   915     12  SS15L                   PIC 99    VALUE 14.
   916     12  SS15D                   PIC X(8)  VALUE ALL '*'.
   917*****LAST PAYMENT AMOUNT
   918     12  SS16                    PIC X(4)  VALUE     '16.0'.
   919     12  SS16L                   PIC 99    VALUE 17.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  20
* EL152.cbl
   920     12  SS16D                   PIC $$$$,$$$.99 VALUE ZEROS.
   921*****CLAIM INTEREST RATE
   922     12  SS16-1                  PIC X(4)  VALUE     '16.1'.
   923     12  SS16-1L                 PIC 99    VALUE 13.
   924     12  SS16-1D                 PIC X(7)        VALUE SPACE.
   925*****CLAIM PAID THRU/TO DATE
   926     12  SS17                    PIC X(4)  VALUE     '17.0'.
   927     12  SS17L                   PIC 99    VALUE 14.
   928     12  SS17D                   PIC X(8)  VALUE ALL '*'.
   929*****TOTAL PAID TO DATE
   930     12  SS18                    PIC X(4)  VALUE     '18.0'.
   931     12  SS18L                   PIC 99    VALUE 17.
   932     12  SS18D                   PIC $$$$,$$$.99 VALUE ZEROS.
   933*****DIAGNOSIS OR CAUSE
   934     12  SS19                    PIC X(4)  VALUE     '19.0'.
   935     12  SS19L                   PIC 99    VALUE 32.
   936     12  SS19D                   PIC X(26) VALUE ALL '*'.
   937*****CAUSE CODE
   938     12  SS19-1                  PIC X(4)  VALUE     '19.1'.
   939     12  SS19-1L                 PIC 99    VALUE 12.
   940     12  SS19-1D                 PIC X(6)  VALUE ALL '*'.
   941*****CID LOAN NUMBER
   942     12  SS19-2                  PIC X(4)  VALUE     '19.2'.
   943     12  SS19-2L                 PIC 99    VALUE 31.
   944     12  SS19-2D                 PIC X(25) VALUE ALL '*'.
   945*****CURRENT DATE
   946     12  SS20                    PIC X(4)  VALUE     '20.0'.
   947     12  SS20L                   PIC 99    VALUE 14.
   948     12  SS20D                   PIC X(8)  VALUE ALL '*'.
   949*****FULL CURRENT DATE
   950     12  SS21                    PIC X(4)  VALUE     '21.0'.
   951     12  SS21L                   PIC 99    VALUE 24.
   952     12  SS21D                   PIC X(18) VALUE ALL '*'.
   953*****BENEFIT DESCRIPTION
   954     12  SS22                    PIC X(4)  VALUE     '22.0'.
   955     12  SS22L                   PIC 99    VALUE 16.
   956     12  SS22D                   PIC X(10) VALUE ALL '*'.
   957*****CARRIER CODE IN CERT
   958     12  SS23                    PIC X(4)  VALUE     '23.0'.
   959     12  SS23L                   PIC 99    VALUE 9.
   960     12  SS23D                   PIC XXX   VALUE ALL '*'.
   961*****GROUPING CODE IN CERT
   962     12  SS24                    PIC X(4)  VALUE     '24.0'.
   963     12  SS24L                   PIC 99    VALUE 12.
   964     12  SS24D                   PIC X(6)  VALUE ALL '*'.
   965*****ACCOUNT NUMBER IN CERT
   966     12  SS25                    PIC X(4)  VALUE     '25.0'.
   967     12  SS25L                   PIC 99    VALUE 16.
   968     12  SS25D                   PIC X(10) VALUE ALL '*'.
   969*****CERTIFICATE NUMBER
   970     12  SS26                    PIC X(4)  VALUE     '26.0'.
   971     12  SS26L                   PIC 99    VALUE 17.
   972     12  SS26D                   PIC X(11) VALUE ALL '*'.
   973*****CERT EFFECTIVE DATE
   974     12  SS27                    PIC X(4)  VALUE     '27.0'.
   975     12  SS27L                   PIC 99    VALUE 14.
   976     12  SS27D                   PIC X(8)  VALUE ALL '*'.
   977*****CERT EXPIRATION DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  21
* EL152.cbl
   978     12  SS28                    PIC X(4)  VALUE     '28.0'.
   979     12  SS28L                   PIC 99    VALUE 14.
   980     12  SS28D                   PIC X(8)  VALUE ALL '*'.
   981*****APPLICABLE COVERAGE TERM
   982     12  SS29                    PIC X(4)  VALUE     '29.0'.
   983     12  SS29L                   PIC 99    VALUE 9.
   984     12  SS29D                   PIC XXX   VALUE ALL '*'.
   985*****APPLICABLE COVERAGE AMOUNT
   986     12  SS30                    PIC X(4)  VALUE     '30.0'.
   987     12  SS30L                   PIC 99    VALUE 18.
   988     12  SS30D                   PIC $$$$$,$$$.99  VALUE ZEROS.
   989*****APPLICABLE COVERAGE CANCEL DATE
   990     12  SS31                    PIC X(4)  VALUE     '31.0'.
   991     12  SS31L                   PIC 99    VALUE 14.
   992     12  SS31D                   PIC X(8)  VALUE ALL '*'.
   993*****APPLICABLE COVERAGE FORM NUMBER
   994     12  SS32                    PIC X(4)  VALUE     '32.0'.
   995     12  SS32L                   PIC 99    VALUE 18.
   996     12  SS32D                   PIC X(12) VALUE ALL '*'.
   997*****INSURES AGE AT POLICY ISSUE
   998     12  SS33                    PIC X(4)  VALUE     '33.0'.
   999     12  SS33L                   PIC 99    VALUE 9.
  1000     12  SS33D                   PIC XXX   VALUE ALL '*'.
  1001*****CLAIM NUMBER
  1002     12  SS34                    PIC X(4)  VALUE     '34.0'.
  1003     12  SS34L                   PIC 99    VALUE 13.
  1004     12  SS34D                   PIC X(7)  VALUE ALL '*'.
  1005*****LAST DENIAL TEXT
  1006     12  SS35-1                  PIC X(4)  VALUE     '35.1'.
  1007     12  SS35-1L                 PIC 99    VALUE 66.
  1008     12  SS35-1D                 PIC X(60) VALUE ALL '*'.
  1009     12  SS35-2                  PIC X(4)  VALUE     '35.2'.
  1010     12  SS35-2L                 PIC 99    VALUE 66.
  1011     12  SS35-2D                 PIC X(60) VALUE ALL '*'.
  1012*****LOAN NUMBER
  1013     12  SS36                    PIC X(4)  VALUE     '36.0'.
  1014     12  SS36L                   PIC 99    VALUE 14.
  1015     12  SS36D                   PIC X(8)  VALUE ALL '*'.
  1016*****CURRENT LOAN NUMBER
  1017     12  SS36-1                  PIC X(4)  VALUE     '36.1'.
  1018     12  SS36-1L                 PIC 99    VALUE 26.
  1019     12  SS36-1D                 PIC X(20) VALUE ALL '*'.
  1020*****LOAN BALANCE
  1021     12  SS37                    PIC X(4)  VALUE     '37.0'.
  1022     12  SS37L                   PIC 99    VALUE 18.
  1023     12  SS37D                   PIC $$$$$,$$$.99  VALUE ZEROS.
  1024*****MEMBER NUMBER
  1025     12  SS38                    PIC X(4)  VALUE     '38.0'.
  1026     12  SS38L                   PIC 99    VALUE 18.
  1027     12  SS38D                   PIC X(12) VALUE ALL '*'.
  1028*****INSURED NAME (FIRST M LAST)
  1029     12  SS39                    PIC X(4)  VALUE     '39.0'.
  1030     12  SS39L                   PIC 99    VALUE 36.
  1031     12  SS39D                   PIC X(30) VALUE ALL '*'.
  1032*****INSURED LAST NAME ONLY
  1033     12  SS40                    PIC X(4)  VALUE     '40.0'.
  1034     12  SS40L                   PIC 99    VALUE 21.
  1035     12  SS40D                   PIC X(15) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  22
* EL152.cbl
  1036*****TITLE (MR/MS)
  1037     12  SS41                    PIC X(4)  VALUE     '41.0'.
  1038     12  SS41L                   PIC 99    VALUE 9.
  1039     12  SS41D                   PIC X(3)  VALUE ALL '*'.
  1040*****ELIMINATION PERIOD
  1041     12  SS42                    PIC X(4)  VALUE     '42.0'.
  1042     12  SS42L                   PIC 99    VALUE 9.
  1043     12  SS42D                   PIC X(3)  VALUE ALL '*'.
  1044*****BENEFICIARY NAME
  1045     12  SS43                    PIC X(4)  VALUE     '43.0'.
  1046     12  SS43L                   PIC 99    VALUE 36.
  1047     12  SS43D                   PIC X(30) VALUE ALL '*'.
  1048*****BENEFICIARY ADDRESS
  1049     12  SS44-1                  PIC X(4)  VALUE     '44.1'.
  1050     12  SS44-1L                 PIC 99    VALUE 36.
  1051     12  SS44-1D                 PIC X(30) VALUE ALL '*'.
  1052     12  SS44-2                  PIC X(4)  VALUE     '44.2'.
  1053     12  SS44-2L                 PIC 99    VALUE 36.
  1054     12  SS44-2D                 PIC X(30) VALUE ALL '*'.
  1055     12  SS44-3                  PIC X(4)  VALUE     '44.3'.
  1056     12  SS44-3L                 PIC 99    VALUE 36.
  1057     12  SS44-3D                 PIC X(30) VALUE ALL '*'.
  1058     12  SS44-4                  PIC X(4)  VALUE     '44.4'.
  1059     12  SS44-4L                 PIC 99    VALUE 36.
  1060     12  SS44-4D                 PIC X(30) VALUE ALL '*'.
  1061     12  SS44-5                  PIC X(4)  VALUE     '44.5'.
  1062     12  SS44-5L                 PIC 99    VALUE 18.
  1063     12  SS44-5D                 PIC X(12) VALUE ALL '*'.
  1064     12  SS44-6                  PIC X(4)  VALUE     '44.6'.
  1065     12  SS44-6L                 PIC 99    VALUE 36.
  1066     12  SS44-6D                 PIC X(30) VALUE ALL '*'.
  1067*****INSUREDS DATE OF BIRTH
  1068     12  SS45                    PIC X(4)  VALUE     '45.0'.
  1069     12  SS45L                   PIC 99    VALUE 14.
  1070     12  SS45D                   PIC X(8)  VALUE ALL '*'.
  1071*****INSUREDS SOC SEC NUMBER
  1072     12  SS46                    PIC X(4)  VALUE     '46.0'.
  1073     12  SS46L                   PIC 99    VALUE 17.
  1074     12  SS46D                   PIC X(11) VALUE ALL '*'.
  1075*****PHYSICIANS  NAME
  1076     12  SS47                    PIC X(4)  VALUE     '47.0'.
  1077     12  SS47L                   PIC 99    VALUE 36.
  1078     12  SS47D                   PIC X(30) VALUE ALL '*'.
  1079*****PHYSICIANS  ADDRESS
  1080     12  SS47-1                  PIC X(4)  VALUE     '47.1'.
  1081     12  SS47-1L                 PIC 99    VALUE 36.
  1082     12  SS47-1D                 PIC X(30) VALUE ALL '*'.
  1083     12  SS47-2                  PIC X(4)  VALUE     '47.2'.
  1084     12  SS47-2L                 PIC 99    VALUE 36.
  1085     12  SS47-2D                 PIC X(30) VALUE ALL '*'.
  1086     12  SS47-3                  PIC X(4)  VALUE     '47.3'.
  1087     12  SS47-3L                 PIC 99    VALUE 36.
  1088     12  SS47-3D                 PIC X(30) VALUE ALL '*'.
  1089     12  SS47-4                  PIC X(4)  VALUE     '47.4'.
  1090     12  SS47-4L                 PIC 99    VALUE 36.
  1091     12  SS47-4D                 PIC X(30) VALUE ALL '*'.
  1092     12  SS47-5                  PIC X(4)  VALUE     '47.5'.
  1093     12  SS47-5L                 PIC 99    VALUE 18.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  23
* EL152.cbl
  1094     12  SS47-5D                 PIC X(12) VALUE ALL '*'.
  1095*****EMPLOYERS   NAME
  1096     12  SS48                    PIC X(4)  VALUE     '48.0'.
  1097     12  SS48L                   PIC 99    VALUE 36.
  1098     12  SS48D                   PIC X(30) VALUE ALL '*'.
  1099*****EMPLOYERS   ADDRESS
  1100     12  SS48-1                  PIC X(4)  VALUE     '48.1'.
  1101     12  SS48-1L                 PIC 99    VALUE 36.
  1102     12  SS48-1D                 PIC X(30) VALUE ALL '*'.
  1103     12  SS48-2                  PIC X(4)  VALUE     '48.2'.
  1104     12  SS48-2L                 PIC 99    VALUE 36.
  1105     12  SS48-2D                 PIC X(30) VALUE ALL '*'.
  1106     12  SS48-3                  PIC X(4)  VALUE     '48.3'.
  1107     12  SS48-3L                 PIC 99    VALUE 36.
  1108     12  SS48-3D                 PIC X(30) VALUE ALL '*'.
  1109     12  SS48-4                  PIC X(4)  VALUE     '48.4'.
  1110     12  SS48-4L                 PIC 99    VALUE 36.
  1111     12  SS48-4D                 PIC X(30) VALUE ALL '*'.
  1112     12  SS48-5                  PIC X(4)  VALUE     '48.5'.
  1113     12  SS48-5L                 PIC 99    VALUE 18.
  1114     12  SS48-5D                 PIC X(12) VALUE ALL '*'.
  1115*****OTHER1      NAME
  1116     12  SS49                    PIC X(4)  VALUE     '49.0'.
  1117     12  SS49L                   PIC 99    VALUE 36.
  1118     12  SS49D                   PIC X(30) VALUE ALL '*'.
  1119*****OTHER1      ADDRESS
  1120     12  SS49-1                  PIC X(4)  VALUE     '49.1'.
  1121     12  SS49-1L                 PIC 99    VALUE 36.
  1122     12  SS49-1D                 PIC X(30) VALUE ALL '*'.
  1123     12  SS49-2                  PIC X(4)  VALUE     '49.2'.
  1124     12  SS49-2L                 PIC 99    VALUE 36.
  1125     12  SS49-2D                 PIC X(30) VALUE ALL '*'.
  1126     12  SS49-3                  PIC X(4)  VALUE     '49.3'.
  1127     12  SS49-3L                 PIC 99    VALUE 36.
  1128     12  SS49-3D                 PIC X(30) VALUE ALL '*'.
  1129     12  SS49-4                  PIC X(4)  VALUE     '49.4'.
  1130     12  SS49-4L                 PIC 99    VALUE 36.
  1131     12  SS49-4D                 PIC X(30) VALUE ALL '*'.
  1132     12  SS49-5                  PIC X(4)  VALUE     '49.5'.
  1133     12  SS49-5L                 PIC 99    VALUE 18.
  1134     12  SS49-5D                 PIC X(12) VALUE ALL '*'.
  1135*****OTHER2      NAME
  1136     12  SS50                    PIC X(4)  VALUE     '50.0'.
  1137     12  SS50L                   PIC 99    VALUE 36.
  1138     12  SS50D                   PIC X(30) VALUE ALL '*'.
  1139*****OTHER2      ADDRESS
  1140     12  SS50-1                  PIC X(4)  VALUE     '50.1'.
  1141     12  SS50-1L                 PIC 99    VALUE 36.
  1142     12  SS50-1D                 PIC X(30) VALUE ALL '*'.
  1143     12  SS50-2                  PIC X(4)  VALUE     '50.2'.
  1144     12  SS50-2L                 PIC 99    VALUE 36.
  1145     12  SS50-2D                 PIC X(30) VALUE ALL '*'.
  1146     12  SS50-3                  PIC X(4)  VALUE     '50.3'.
  1147     12  SS50-3L                 PIC 99    VALUE 36.
  1148     12  SS50-3D                 PIC X(30) VALUE ALL '*'.
  1149     12  SS50-4                  PIC X(4)  VALUE     '50.4'.
  1150     12  SS50-4L                 PIC 99    VALUE 36.
  1151     12  SS50-4D                 PIC X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  24
* EL152.cbl
  1152     12  SS50-5                  PIC X(4)  VALUE     '50.5'.
  1153     12  SS50-5L                 PIC 99    VALUE 18.
  1154     12  SS50-5D                 PIC X(12) VALUE ALL '*'.
  1155*****A&H TERM TIMES MON. BEN.
  1156     12  SS51                    PIC X(4)  VALUE     '51.0'.
  1157     12  SS51L                   PIC 99    VALUE 17.
  1158     12  SS51D                   PIC $$$$,$$$.99 VALUE ZEROS.
  1159*****THIRD PARTY NAME
  1160     12  SS52                    PIC X(4)  VALUE     '52.0'.
  1161     12  SS52L                   PIC 99    VALUE 36.
  1162     12  SS52D                   PIC X(30) VALUE ALL '*'.
  1163*****THIRD PARTY ADDRESS
  1164     12  SS53-1                  PIC X(4)  VALUE     '53.1'.
  1165     12  SS53-1L                 PIC 99    VALUE 36.
  1166     12  SS53-1D                 PIC X(30) VALUE ALL '*'.
  1167     12  SS53-2                  PIC X(4)  VALUE     '53.2'.
  1168     12  SS53-2L                 PIC 99    VALUE 36.
  1169     12  SS53-2D                 PIC X(30) VALUE ALL '*'.
  1170     12  SS53-3                  PIC X(4)  VALUE     '53.3'.
  1171     12  SS53-3L                 PIC 99    VALUE 36.
  1172     12  SS53-3D                 PIC X(30) VALUE ALL '*'.
  1173     12  SS53-4                  PIC X(4)  VALUE     '53.4'.
  1174     12  SS53-4L                 PIC 99    VALUE 36.
  1175     12  SS53-4D                 PIC X(30) VALUE ALL '*'.
  1176     12  SS53-5                  PIC X(4)  VALUE     '53.5'.
  1177     12  SS53-5L                 PIC 99    VALUE 36.
  1178     12  SS53-5D                 PIC X(30) VALUE ALL '*'.
  1179*****THIRD PARTY PHONE NUMBER
  1180     12  SS53-6                  PIC X(4)  VALUE     '53.6'.
  1181     12  SS53-6L                 PIC 99    VALUE 18.
  1182     12  SS53-6D                 PIC X(12) VALUE ALL '*'.
  1183*****CERTIFICATE SEQUENCE
  1184     12  SS54                    PIC X(4)  VALUE     '54.0'.
  1185     12  SS54L                   PIC 99    VALUE 09.
  1186     12  SS54D                   PIC XXX VALUE ALL '*'.
  1187*****CERTIFICATE TOTAL  E
  1188     12  SS55                    PIC X(4)  VALUE     '55.0'.
  1189     12  SS55L                   PIC 99    VALUE 09.
  1190     12  SS55D                   PIC XXX VALUE ALL '*'.
  1191*****CREDITOR ID
  1192     12  SS56                    PIC  X(04) VALUE    '56.0'.
  1193     12  SS56L                   PIC  99 VALUE 36.
  1194     12  SS56D                   PIC  X(30) VALUE ALL '*'.
  1195*****INSUREDS NAME (CERTIFICATE)
  1196     12  SS57                    PIC X(4)  VALUE     '57.0'.
  1197     12  SS57L                   PIC 99    VALUE 36.
  1198     12  SS57D                   PIC X(30) VALUE ALL '*'.
  1199*****JOINT NAME (CERTIFICATE)
  1200     12  SS58                    PIC X(4)  VALUE     '58.0'.
  1201     12  SS58L                   PIC 99    VALUE 36.
  1202     12  SS58D                   PIC X(30) VALUE ALL '*'.
  1203*****POLICY REFERENCE NUMBER
  1204     12  SS59                    PIC X(4)  VALUE     '59.0'.
  1205     12  SS59L                   PIC 99    VALUE 26.
  1206     12  SS59D                   PIC X(20) VALUE ALL '*'.
  1207*****CREDIT CARD NUMBER (CLAIMS)
  1208     12  SS60                    PIC X(4)  VALUE     '60.0'.
  1209     12  SS60L                   PIC 99    VALUE 22.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  25
* EL152.cbl
  1210     12  SS60D                   PIC X(16) VALUE ALL '*'.
  1211*****CORRESPONDENCE BENEFICIARY NAME
  1212     12  SS61                    PIC X(4)  VALUE     '61.0'.
  1213     12  SS61L                   PIC 99    VALUE 36.
  1214     12  SS61D                   PIC X(30) VALUE ALL '*'.
  1215*****CORRESPONDENCE BENEFICIARY ADDRESS
  1216     12  SS61-1                  PIC X(4)  VALUE     '61.1'.
  1217     12  SS61-1L                 PIC 99    VALUE 36.
  1218     12  SS61-1D                 PIC X(30) VALUE ALL '*'.
  1219     12  SS61-2                  PIC X(4)  VALUE     '61.2'.
  1220     12  SS61-2L                 PIC 99    VALUE 36.
  1221     12  SS61-2D                 PIC X(30) VALUE ALL '*'.
  1222     12  SS61-3                  PIC X(4)  VALUE     '61.3'.
  1223     12  SS61-3L                 PIC 99    VALUE 36.
  1224     12  SS61-3D                 PIC X(30) VALUE ALL '*'.
  1225     12  SS61-4                  PIC X(4)  VALUE     '61.4'.
  1226     12  SS61-4L                 PIC 99    VALUE 36.
  1227     12  SS61-4D                 PIC X(30) VALUE ALL '*'.
  1228     12  SS61-5                  PIC X(4)  VALUE     '61.5'.
  1229     12  SS61-5L                 PIC 99    VALUE 36.
  1230     12  SS61-5D                 PIC X(30) VALUE ALL '*'.
  1231     12  SS61-6                  PIC X(4)  VALUE     '61.6'.
  1232     12  SS61-6L                 PIC 99    VALUE 18.
  1233     12  SS61-6D                 PIC X(12) VALUE ALL '*'.
  1234
  1235*****DMD UNDERWRITER STATEMENT
  1236     12  SS62                    PIC X(4)  VALUE     '62.0'.
  1237     12  SS62L                   PIC 99    VALUE 56.
  1238     12  SS62D                   PIC X(50) VALUE ALL '*'.
  1239
  1240*****DMD UNDERWRITER NAME
  1241     12  SS63                    PIC X(4)  VALUE     '63.0'.
  1242     12  SS63L                   PIC 99    VALUE 66.
  1243     12  SS63D                   PIC X(60) VALUE ALL '*'.
  1244
  1245*****DMD UNDERWRITER NAME
  1246     12  SS64                    PIC X(4)  VALUE     '64.0'.
  1247     12  SS64L                   PIC 99    VALUE 66.
  1248     12  SS64D                   PIC X(60) VALUE ALL '*'.
  1249
  1250****************************************************
  1251*       WHEN ADDING OR DELETING ENTRIES TO         *
  1252*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
  1253*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
  1254*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
  1255*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
  1256*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
  1257*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
  1258****************************************************
  1259*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  1260*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  1261
  1262 01  SYSTEM-VARIABLES            PIC X(3865).
  1263 01  SYS-VAR-ENTRY.
  1264     12  SYS-VAR-CODE            PIC X(4).
  1265     12  SYS-VAR-LEN             PIC 99.
  1266     12  SYS-VAR-DATA            PIC X(100).
  1267
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  26
* EL152.cbl
  1268*                                COPY ELCDATE.
  1269******************************************************************
  1270*                                                                *
  1271*                                                                *
  1272*                            ELCDATE.                            *
  1273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1274*                            VMOD=2.003
  1275*                                                                *
  1276*                                                                *
  1277*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1278*                 LENGTH = 200                                   *
  1279******************************************************************
  1280
  1281 01  DATE-CONVERSION-DATA.
  1282     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1283     12  DC-OPTION-CODE                PIC X.
  1284         88  BIN-TO-GREG                VALUE ' '.
  1285         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1286         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1287         88  YMD-GREG-TO-BIN            VALUE '3'.
  1288         88  MDY-GREG-TO-BIN            VALUE '4'.
  1289         88  JULIAN-TO-BIN              VALUE '5'.
  1290         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1291         88  FIND-CENTURY               VALUE '7'.
  1292         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1293         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1294         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1295         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1296         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1297         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1298         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1299         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1300         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1301         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1302         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1303         88  BIN-3-TO-GREG              VALUE 'I'.
  1304         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1305         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1306         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1307         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1308         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1309         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1310         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1311         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1312         88  THREE-CHARACTER-BIN
  1313                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1314         88  GREGORIAN-TO-BIN
  1315                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1316         88  BIN-TO-GREGORIAN
  1317                  VALUES ' ' '1' 'I' '8' 'G'.
  1318         88  JULIAN-TO-BINARY
  1319                  VALUES '5' 'C' 'E' 'F'.
  1320     12  DC-ERROR-CODE                 PIC X.
  1321         88  NO-CONVERSION-ERROR        VALUE ' '.
  1322         88  DATE-CONVERSION-ERROR
  1323                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1324         88  DATE-IS-ZERO               VALUE '1'.
  1325         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  27
* EL152.cbl
  1326         88  DATE-IS-INVALID            VALUE '3'.
  1327         88  DATE1-GREATER-DATE2        VALUE '4'.
  1328         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1329         88  DATE-INVALID-OPTION        VALUE '9'.
  1330         88  INVALID-CENTURY            VALUE 'A'.
  1331         88  ONLY-CENTURY               VALUE 'B'.
  1332         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1333         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1334     12  DC-END-OF-MONTH               PIC X.
  1335         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1336     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1337         88  USE-NORMAL-PROCESS         VALUE ' '.
  1338         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1339         88  ADJUST-UP-100-YRS          VALUE '2'.
  1340     12  FILLER                        PIC X.
  1341     12  DC-CONVERSION-DATES.
  1342         16  DC-BIN-DATE-1             PIC XX.
  1343         16  DC-BIN-DATE-2             PIC XX.
  1344         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1345         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1346                       DC-GREG-DATE-1-EDIT.
  1347             20  DC-EDIT1-MONTH        PIC 99.
  1348             20  SLASH1-1              PIC X.
  1349             20  DC-EDIT1-DAY          PIC 99.
  1350             20  SLASH1-2              PIC X.
  1351             20  DC-EDIT1-YEAR         PIC 99.
  1352         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1353         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1354                     DC-GREG-DATE-2-EDIT.
  1355             20  DC-EDIT2-MONTH        PIC 99.
  1356             20  SLASH2-1              PIC X.
  1357             20  DC-EDIT2-DAY          PIC 99.
  1358             20  SLASH2-2              PIC X.
  1359             20  DC-EDIT2-YEAR         PIC 99.
  1360         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1361         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1362                     DC-GREG-DATE-1-YMD.
  1363             20  DC-YMD-YEAR           PIC 99.
  1364             20  DC-YMD-MONTH          PIC 99.
  1365             20  DC-YMD-DAY            PIC 99.
  1366         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1367         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1368                      DC-GREG-DATE-1-MDY.
  1369             20  DC-MDY-MONTH          PIC 99.
  1370             20  DC-MDY-DAY            PIC 99.
  1371             20  DC-MDY-YEAR           PIC 99.
  1372         16  DC-GREG-DATE-1-ALPHA.
  1373             20  DC-ALPHA-MONTH        PIC X(10).
  1374             20  DC-ALPHA-DAY          PIC 99.
  1375             20  FILLER                PIC XX.
  1376             20  DC-ALPHA-CENTURY.
  1377                 24 DC-ALPHA-CEN-N     PIC 99.
  1378             20  DC-ALPHA-YEAR         PIC 99.
  1379         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1380         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1381         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1382         16  DC-JULIAN-DATE            PIC 9(05).
  1383         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  28
* EL152.cbl
  1384                                       PIC 9(05).
  1385         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1386             20  DC-JULIAN-YEAR        PIC 99.
  1387             20  DC-JULIAN-DAYS        PIC 999.
  1388         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1389         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1390         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1391     12  DATE-CONVERSION-VARIBLES.
  1392         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1393         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1394             20  FILLER                PIC 9(3).
  1395             20  HOLD-CEN-1-CCYY.
  1396                 24  HOLD-CEN-1-CC     PIC 99.
  1397                 24  HOLD-CEN-1-YY     PIC 99.
  1398             20  HOLD-CEN-1-MO         PIC 99.
  1399             20  HOLD-CEN-1-DA         PIC 99.
  1400         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1401             20  HOLD-CEN-1-R-MO       PIC 99.
  1402             20  HOLD-CEN-1-R-DA       PIC 99.
  1403             20  HOLD-CEN-1-R-CCYY.
  1404                 24  HOLD-CEN-1-R-CC   PIC 99.
  1405                 24  HOLD-CEN-1-R-YY   PIC 99.
  1406             20  FILLER                PIC 9(3).
  1407         16  HOLD-CENTURY-1-X.
  1408             20  FILLER                PIC X(3)  VALUE SPACES.
  1409             20  HOLD-CEN-1-X-CCYY.
  1410                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1411                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1412             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1413             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1414         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1415             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1416             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1417             20  HOLD-CEN-1-R-X-CCYY.
  1418                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1419                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1420             20  FILLER                PIC XXX.
  1421         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1422         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1423         16  DC-JULIAN-DATE-1          PIC 9(07).
  1424         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1425             20  DC-JULIAN-1-CCYY.
  1426                 24  DC-JULIAN-1-CC    PIC 99.
  1427                 24  DC-JULIAN-1-YR    PIC 99.
  1428             20  DC-JULIAN-DA-1        PIC 999.
  1429         16  DC-JULIAN-DATE-2          PIC 9(07).
  1430         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1431             20  DC-JULIAN-2-CCYY.
  1432                 24  DC-JULIAN-2-CC    PIC 99.
  1433                 24  DC-JULIAN-2-YR    PIC 99.
  1434             20  DC-JULIAN-DA-2        PIC 999.
  1435         16  DC-GREG-DATE-A-EDIT.
  1436             20  DC-EDITA-MONTH        PIC 99.
  1437             20  SLASHA-1              PIC X VALUE '/'.
  1438             20  DC-EDITA-DAY          PIC 99.
  1439             20  SLASHA-2              PIC X VALUE '/'.
  1440             20  DC-EDITA-CCYY.
  1441                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  29
* EL152.cbl
  1442                 24  DC-EDITA-YEAR     PIC 99.
  1443         16  DC-GREG-DATE-B-EDIT.
  1444             20  DC-EDITB-MONTH        PIC 99.
  1445             20  SLASHB-1              PIC X VALUE '/'.
  1446             20  DC-EDITB-DAY          PIC 99.
  1447             20  SLASHB-2              PIC X VALUE '/'.
  1448             20  DC-EDITB-CCYY.
  1449                 24  DC-EDITB-CENT     PIC 99.
  1450                 24  DC-EDITB-YEAR     PIC 99.
  1451         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1452         16  DC-GREG-DATE-CYMD-R REDEFINES
  1453                              DC-GREG-DATE-CYMD.
  1454             20  DC-CYMD-CEN           PIC 99.
  1455             20  DC-CYMD-YEAR          PIC 99.
  1456             20  DC-CYMD-MONTH         PIC 99.
  1457             20  DC-CYMD-DAY           PIC 99.
  1458         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1459         16  DC-GREG-DATE-MDCY-R REDEFINES
  1460                              DC-GREG-DATE-MDCY.
  1461             20  DC-MDCY-MONTH         PIC 99.
  1462             20  DC-MDCY-DAY           PIC 99.
  1463             20  DC-MDCY-CEN           PIC 99.
  1464             20  DC-MDCY-YEAR          PIC 99.
  1465    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1466        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1467    12  DC-EL310-DATE                  PIC X(21).
  1468    12  FILLER                         PIC X(28).
  1469
  1470*                                COPY ELCLOGOF.
  1471******************************************************************
  1472*                                                                *
  1473*                                                                *
  1474*                            ELCLOGOF.                           *
  1475*                            VMOD=2.001                          *
  1476*                                                                *
  1477*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1478*                                                                *
  1479******************************************************************
  1480 01  CLASIC-LOGOFF.
  1481     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1482     12  LOGOFF-TEXT.
  1483         16  FILLER          PIC X(5)    VALUE SPACES.
  1484         16  LOGOFF-MSG.
  1485             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1486             20  FILLER      PIC X       VALUE SPACES.
  1487             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1488         16  FILLER          PIC X(80)
  1489           VALUE '* YOU ARE NOW LOGGED OFF'.
  1490         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1491         16  FILLER          PIC X       VALUE QUOTE.
  1492         16  LOGOFF-SYS-MSG  PIC X(17)
  1493           VALUE 'S CLAS-IC SYSTEM '.
  1494     12  TEXT-MESSAGES.
  1495         16  UNACCESS-MSG    PIC X(29)
  1496             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1497         16  PGMIDERR-MSG    PIC X(17)
  1498             VALUE 'PROGRAM NOT FOUND'.
  1499
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  30
* EL152.cbl
  1501*                                COPY ELCNWA.
  1502*****************************************************************
  1503*                                                               *
  1504*                                                               *
  1505*                            ELCNWA.                            *
  1506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1507*                            VMOD=2.003                         *
  1508*                                                               *
  1509*            M O V E   N A M E   W O R K   A R E A.             *
  1510*                                                               *
  1511*****************************************************************.
  1512
  1513 01  WS-NAME-WORK-AREA.
  1514     05  WS-INSURED-LAST-NAME        PIC X(15).
  1515     05  WS-INSURED-1ST-NAME         PIC X(12).
  1516     05  WS-INSURED-MID-INIT         PIC X.
  1517
  1518     05  WS-NAME-WORK.
  1519         10  WS-NW                   PIC X
  1520             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1521
  1522     05  WS-NAME-WORK2.
  1523         10  WS-NW2                  PIC X
  1524             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1525                                        NWA-INDEX0.
  1526
  1527     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1528                                     COMP-3.
  1529
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  31
* EL152.cbl
  1531*                                COPY ELCATTR.
  1532******************************************************************
  1533*                                                                *
  1534*                            ELCATTR.                            *
  1535*                            VMOD=2.001                          *
  1536*                                                                *
  1537*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1538*                                                                *
  1539*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1540*                                                                *
  1541*                   POS 1   P=PROTECTED                          *
  1542*                           U=UNPROTECTED                        *
  1543*                           S=ASKIP                              *
  1544*                   POS 2   A=ALPHA/NUMERIC                      *
  1545*                           N=NUMERIC                            *
  1546*                   POS 3   N=NORMAL                             *
  1547*                           B=BRIGHT                             *
  1548*                           D=DARK                               *
  1549*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1550*                           OF=MODIFIED DATA TAG OFF             *
  1551*                                                                *
  1552*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1553******************************************************************
  1554 01  ATTRIBUTE-LIST.
  1555     12  AL-PABOF            PIC X       VALUE 'Y'.
  1556     12  AL-PABON            PIC X       VALUE 'Z'.
  1557     12  AL-PADOF            PIC X       VALUE '%'.
  1558     12  AL-PADON            PIC X       VALUE '_'.
  1559     12  AL-PANOF            PIC X       VALUE '-'.
  1560     12  AL-PANON            PIC X       VALUE '/'.
  1561     12  AL-SABOF            PIC X       VALUE '8'.
  1562     12  AL-SABON            PIC X       VALUE '9'.
  1563     12  AL-SADOF            PIC X       VALUE '@'.
  1564     12  AL-SADON            PIC X       VALUE QUOTE.
  1565     12  AL-SANOF            PIC X       VALUE '0'.
  1566     12  AL-SANON            PIC X       VALUE '1'.
  1567     12  AL-UABOF            PIC X       VALUE 'H'.
  1568     12  AL-UABON            PIC X       VALUE 'I'.
  1569     12  AL-UADOF            PIC X       VALUE '<'.
  1570     12  AL-UADON            PIC X       VALUE '('.
  1571     12  AL-UANOF            PIC X       VALUE ' '.
  1572     12  AL-UANON            PIC X       VALUE 'A'.
  1573     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1574     12  AL-UNBON            PIC X       VALUE 'R'.
  1575     12  AL-UNDOF            PIC X       VALUE '*'.
  1576     12  AL-UNDON            PIC X       VALUE ')'.
  1577     12  AL-UNNOF            PIC X       VALUE '&'.
  1578     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  32
* EL152.cbl
  1580*                                COPY ELCEMIB.
  1581******************************************************************
  1582*                                                                *
  1583*                                                                *
  1584*                            ELCEMIB.                            *
  1585*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1586*                            VMOD=2.005                          *
  1587*                                                                *
  1588*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1589*                                                                *
  1590******************************************************************
  1591 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1592     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1593     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1594     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1595     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1596     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1597     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1598     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1599     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1600     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1601         88  EMI-NO-ERRORS                    VALUE '1'.
  1602         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1603         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1604     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1605         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1606     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1607         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1608         88  EMI-AREA1-FULL                   VALUE '2'.
  1609     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1610         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1611         88  EMI-AREA2-FULL                   VALUE '2'.
  1612     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1613         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1614         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1615         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1616         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1617         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1618     12  EMI-ERROR-LINES.
  1619         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1620         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1621         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1622         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1623             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1624                 24  EMI-ERR-NUM         PIC X(4).
  1625                 24  EMI-FILLER          PIC X.
  1626                 24  EMI-SEV             PIC X.
  1627                 24  FILLER              PIC X.
  1628             20  FILLER                  PIC X(02).
  1629     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1630         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1631             20  EMI-ERROR-NUMBER    PIC X(4).
  1632             20  EMI-FILL            PIC X.
  1633             20  EMI-SEVERITY        PIC X.
  1634             20  FILLER              PIC X.
  1635             20  EMI-ERROR-TEXT.
  1636                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1637                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  33
* EL152.cbl
  1638     12  EMI-SEVERITY-SAVE           PIC X.
  1639         88  EMI-NOTE                    VALUE 'N'.
  1640         88  EMI-WARNING                 VALUE 'W'.
  1641         88  EMI-FORCABLE                VALUE 'F'.
  1642         88  EMI-FATAL                   VALUE 'X'.
  1643     12  EMI-MESSAGE-FLAG            PIC X.
  1644         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1645         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1646     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1647     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1648         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1649         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1650         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1651     12  emi-claim-no                pic x(7).
  1652     12  emi-claim-type              pic x(6).
  1653     12  FILLER                      PIC X(124)  VALUE SPACES.
  1654     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1655     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1656     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1657     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1658 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  34
* EL152.cbl
  1660*                                COPY ELCINTF.
  1661******************************************************************
  1662*                                                                *
  1663*                                                                *
  1664*                            ELCINTF.                            *
  1665*                            VMOD=2.017                          *
  1666*                                                                *
  1667*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1668*                                                                *
  1669*       LENGTH = 1024                                            *
  1670*                                                                *
  1671******************************************************************
  1672*                   C H A N G E   L O G
  1673*
  1674* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1675*-----------------------------------------------------------------
  1676*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1677* EFFECTIVE    NUMBER
  1678*-----------------------------------------------------------------
  1679* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1680******************************************************************
  1681 01  PROGRAM-INTERFACE-BLOCK.
  1682     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1683     12  PI-CALLING-PROGRAM              PIC X(8).
  1684     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1685     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1686     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1687     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1688     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1689     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1690     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1691     12  PI-COMPANY-ID                   PIC XXX.
  1692     12  PI-COMPANY-CD                   PIC X.
  1693
  1694     12  PI-COMPANY-PASSWORD             PIC X(8).
  1695
  1696     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1697
  1698     12  PI-CONTROL-IN-PROGRESS.
  1699         16  PI-CARRIER                  PIC X.
  1700         16  PI-GROUPING                 PIC X(6).
  1701         16  PI-STATE                    PIC XX.
  1702         16  PI-ACCOUNT                  PIC X(10).
  1703         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1704                                         PIC X(10).
  1705         16  PI-CLAIM-CERT-GRP.
  1706             20  PI-CLAIM-NO             PIC X(7).
  1707             20  PI-CERT-NO.
  1708                 25  PI-CERT-PRIME       PIC X(10).
  1709                 25  PI-CERT-SFX         PIC X.
  1710             20  PI-CERT-EFF-DT          PIC XX.
  1711         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1712             20  PI-PLAN-CODE            PIC X(2).
  1713             20  PI-REVISION-NUMBER      PIC X(3).
  1714             20  PI-PLAN-EFF-DT          PIC X(2).
  1715             20  PI-PLAN-EXP-DT          PIC X(2).
  1716             20  FILLER                  PIC X(11).
  1717         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  35
* EL152.cbl
  1718             20  PI-OE-REFERENCE-1.
  1719                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1720                 25  PI-OE-REF-1-SUFF    PIC XX.
  1721
  1722     12  PI-SESSION-IN-PROGRESS          PIC X.
  1723         88  CLAIM-SESSION                   VALUE '1'.
  1724         88  CREDIT-SESSION                  VALUE '2'.
  1725         88  WARRANTY-SESSION                VALUE '3'.
  1726         88  MORTGAGE-SESSION                VALUE '4'.
  1727         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1728
  1729
  1730*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1731
  1732     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1733     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1734
  1735     12  PI-CREDIT-USER                  PIC X.
  1736         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1737         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1738
  1739     12  PI-CLAIM-USER                   PIC X.
  1740         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1741         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1742
  1743     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1744         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1745         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1746         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1747         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1748         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1749
  1750     12  PI-PROCESSOR-ID                 PIC X(4).
  1751
  1752     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1753
  1754     12  PI-MEMBER-CAPTION               PIC X(10).
  1755
  1756     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1757         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1758
  1759     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1760     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1761     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1762     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1763
  1764     12  PI-AH-OVERRIDE-L1               PIC X.
  1765     12  PI-AH-OVERRIDE-L2               PIC XX.
  1766     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1767     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1768
  1769     12  PI-NEW-SYSTEM                   PIC X(2).
  1770
  1771     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1772     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1773         88  PI-USES-PAID-TO                 VALUE '1'.
  1774     12  PI-CRDTCRD-SYSTEM.
  1775         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  36
* EL152.cbl
  1776             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1777             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1778         16  PI-CC-MONTH-END-DT          PIC XX.
  1779     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1780
  1781     12  PI-OE-REFERENCE-2.
  1782         16  PI-OE-REF-2-PRIME           PIC X(10).
  1783         16  PI-OE-REF-2-SUFF            PIC X.
  1784
  1785     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1786
  1787     12  PI-LANGUAGE-TYPE                PIC X.
  1788             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1789             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1790             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1791
  1792     12  PI-POLICY-LINKAGE-IND           PIC X.
  1793         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1794         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1795                                                   LOW-VALUES.
  1796
  1797     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1798     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1799         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1800         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1801
  1802     12  PI-PROCESSOR-CSR-IND            PIC X.
  1803         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1804         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1805
  1806     12  FILLER                          PIC X(3).
  1807
  1808     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1809
  1810     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1811         PI-SYSTEM-LEVEL.
  1812
  1813         16  PI-ENTRY-CODES.
  1814             20  PI-ENTRY-CD-1           PIC X.
  1815             20  PI-ENTRY-CD-2           PIC X.
  1816
  1817         16  PI-RETURN-CODES.
  1818             20  PI-RETURN-CD-1          PIC X.
  1819             20  PI-RETURN-CD-2          PIC X.
  1820
  1821         16  PI-UPDATE-STATUS-SAVE.
  1822             20  PI-UPDATE-BY            PIC X(4).
  1823             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1824
  1825         16  PI-LOWER-CASE-LETTERS       PIC X.
  1826             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1827
  1828*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1829*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1830*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1831
  1832         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1833             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  37
* EL152.cbl
  1834             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1835             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1836             88  ACCNT-CNTL                  VALUE '3'.
  1837             88  CARR-ACCNT-CNTL             VALUE '4'.
  1838
  1839         16  PI-PROCESSOR-CAP-LIST.
  1840             20  PI-SYSTEM-CONTROLS.
  1841                24 PI-SYSTEM-DISPLAY     PIC X.
  1842                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1843                24 PI-SYSTEM-MODIFY      PIC X.
  1844                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1845             20  FILLER                  PIC XX.
  1846             20  PI-DISPLAY-CAP          PIC X.
  1847                 88  DISPLAY-CAP             VALUE 'Y'.
  1848             20  PI-MODIFY-CAP           PIC X.
  1849                 88  MODIFY-CAP              VALUE 'Y'.
  1850             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1851                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1852             20  PI-FORCE-CAP            PIC X.
  1853                 88  FORCE-CAP               VALUE 'Y'.
  1854
  1855         16  PI-PROGRAM-CONTROLS.
  1856             20  PI-PGM-PRINT-OPT        PIC X.
  1857             20  PI-PGM-FORMAT-OPT       PIC X.
  1858             20  PI-PGM-PROCESS-OPT      PIC X.
  1859             20  PI-PGM-TOTALS-OPT       PIC X.
  1860
  1861         16  PI-HELP-INTERFACE.
  1862             20  PI-LAST-ERROR-NO        PIC X(4).
  1863             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1864
  1865         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1866             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1867
  1868         16  PI-CR-CONTROL-IN-PROGRESS.
  1869             20  PI-CR-CARRIER           PIC X.
  1870             20  PI-CR-GROUPING          PIC X(6).
  1871             20  PI-CR-STATE             PIC XX.
  1872             20  PI-CR-ACCOUNT           PIC X(10).
  1873             20  PI-CR-FIN-RESP          PIC X(10).
  1874             20  PI-CR-TYPE              PIC X.
  1875
  1876         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1877
  1878         16  PI-CR-MONTH-END-DT          PIC XX.
  1879
  1880         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1881             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1882             88  PI-ZERO-CARRIER             VALUE '1'.
  1883             88  PI-ZERO-GROUPING            VALUE '2'.
  1884             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1885
  1886         16  PI-CARRIER-SECURITY         PIC X.
  1887             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1888
  1889         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1890             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1891             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  38
* EL152.cbl
  1892
  1893         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1894             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1895                                         INDEXED BY PI-ACCESS-NDX
  1896                                         PIC X.
  1897
  1898         16  PI-GA-BILLING-CONTROL       PIC X.
  1899             88  PI-GA-BILLING               VALUE '1'.
  1900
  1901         16  PI-MAIL-PROCESSING          PIC X.
  1902             88  PI-MAIL-YES                 VALUE 'Y'.
  1903
  1904         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1905
  1906         16  PI-AR-SYSTEM.
  1907             20  PI-AR-PROCESSING-CNTL   PIC X.
  1908                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1909             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1910             20  PI-AR-MONTH-END-DT      PIC XX.
  1911
  1912         16  PI-MP-SYSTEM.
  1913             20  PI-MORTGAGE-USER            PIC X.
  1914                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1915                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1916             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1917                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1918                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1919                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1920                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1921                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1922             20  PI-MP-MONTH-END-DT          PIC XX.
  1923             20  PI-MP-REFERENCE-NO.
  1924                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1925                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1926
  1927         16  PI-LABEL-CONTROL            PIC X(01).
  1928             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1929             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1930
  1931         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1932             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1933
  1934         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1935             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1936             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1937
  1938         16  FILLER                      PIC X(14).
  1939
  1940     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1941******************************************************************
  1942     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1943*        COPY ELC1042.
  1944******************************************************************
  1945*                                                                *
  1946*                                                                *
  1947*                           ELC1042                              *
  1948*                            VMOD=2.002                          *
  1949*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  39
* EL152.cbl
  1950*    NOTE                                                        *
  1951*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1952*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1953*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1954*        TO THESE PROGRAMS.                                      *
  1955*                                                                *
  1956*    NOTE                                                        *
  1957*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1958*        USE ONLY!                                               *
  1959*                                                                *
  1960******************************************************************
  1961
  1962         16  PI-1042-WA.
  1963             20  PI-ACTION       PIC  X(01).
  1964                 88 PI-SHOW-MODE           VALUE '1'.
  1965                 88 PI-CLEAR-MODE          VALUE '2'.
  1966                 88 PI-CREATE-MODE         VALUE '3'.
  1967             20  PI-COMM-CONTROL PIC  X(12).
  1968             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1969             20  PI-EOF-SW       PIC  X(01).
  1970                 88  PI-FILE-EOF           VALUE 'Y'.
  1971             20  PI-FILETYP      PIC  X(01).
  1972             20  PI-FORM-SQUEEZE-CONTROL
  1973                                 PIC  X(01).
  1974                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1975                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1976             20  PI-LAST-CONTROL PIC  X(12).
  1977             20  PI-TEMP-STOR-ITEMS
  1978                                 PIC S9(04) COMP.
  1979             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1980             20  PI-UPDATE-SW    PIC  9(01).
  1981                 88 ANY-UPDATES            VALUE 1.
  1982             20  PI-104-SCREEN-SENT-IND
  1983                                 PIC  X(01).
  1984                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1985                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1986             20  PI-1042-SCREEN-SENT-IND
  1987                                 PIC  X(01).
  1988                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1989                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1990             20  PI-1042-ARCHIVE-IND
  1991                                 PIC  X(01).
  1992                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1993             20  FILLER          PIC  X(29).
  1994**********************************************************
  1995*    NOTE                                                *
  1996*        THE WORK AREA IS USED BY EL152 AND EL1522       *
  1997*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
  1998*        BOTH PROGRAMS.                                  *
  1999*                                                        *
  2000**********************************************************
  2001         16  PI-EL152-WA.
  2002             20  PI-ALT-PRINTER-ID        PIC X(4).
  2003             20  PI-ARCHIVE-NUMBER        PIC 9(8).
  2004             20  PI-FORM-NUMBER           PIC X(4).
  2005             20  PI-ADDR-TYPE             PIC XX.
  2006             20  PI-TEMP-STOR-ID          PIC X(8).
  2007             20  PI-NUM-PRINT-COPIES      PIC 9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  40
* EL152.cbl
  2008             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
  2009             20  PI-PRINT-SW              PIC X.
  2010                 88 PRINT-PERFORMED  VALUE '1'.
  2011             20  PI-LETTER-ADDRESS-TYPE   PIC XX.
  2012             20  PI-RESEND-FORM-NUMBER    PIC X(4).
  2013             20  PI-PROMPT-LETTER         PIC X.
  2014             20  PI-ENCLOSURE-CD          PIC X(3).
  2015             20  PI-AUTO-CLOSE-IND        PIC X(1).
  2016             20  PI-LETTER-TO-BENE        PIC X(1).
  2017             20  PI-FILLER                PIC X(528).
  2018             20  PI-FORCE-7840            PIC X.
  2019                 88 FORCE-7840       VALUE '1'.
  2020
  2021             20  PI-BSR-LETTER-IND        PIC XX.
  2022                 88  PI-BSR-AUTOMATED VALUE 'BA'.
  2023             20  FILLER REDEFINES PI-BSR-LETTER-IND.
  2024                 22  PI-ELLETR-BSR        PIC X.
  2025                 22  PI-ELBENE-BSR        PIC X.
  2026
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  41
* EL152.cbl
  2028*                            COPY DFHBMSCA.
  2029*****************************************************************
  2030*                                                               *
  2031* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2032* All rights reserved.                                          *
  2033*                                                               *
  2034*****************************************************************
  2035 01    DFHBMSCA.
  2036*        VARIABLE  PROTECTION    INTENSITY    MODIFIED
  2037*                                             DATA TAG
  2038*
  2039*        DFHBMUNP  Unprotected   Normal       Off
  2040     02  DFHBMUNP PIC X VALUE SPACE.
  2041*        DFHBMUNN  Numeric       Normal       Off
  2042     02  DFHBMUNN PIC X VALUE "&".
  2043*        DFHBMPRO  Protected     Normal       Off
  2044     02  DFHBMPRO PIC X VALUE "-".
  2045*        DFHBMASK  Autoskip      Normal       Off
  2046     02  DFHBMASK PIC X VALUE "0".
  2047*************************************************
  2048*        DFHBMBRY  Unprotected   Bright       Off
  2049     02  DFHBMBRY PIC X VALUE "H".
  2050*        DFHPROTI  Protected     Bright       Off
  2051     02  DFHPROTI PIC X VALUE "Y".
  2052*        DFHBMASB  Autoskip      Bright       Off
  2053     02  DFHBMASB PIC X VALUE "8".
  2054*************************************************
  2055*        DFHBMDAR  Unprotected   Non-Display  Off
  2056     02  DFHBMDAR PIC X VALUE "<".
  2057*        DFHPROTN  Protected     Non-Display  Off
  2058     02  DFHPROTN PIC X VALUE "%".
  2059*************************************************
  2060*        DFHBMFSE  Unprotected   Normal       On
  2061     02  DFHBMFSE PIC X VALUE "A".
  2062*        DFHBMASF  Autoskip      Normal       On
  2063     02  DFHBMASF  PIC X VALUE "1".
  2064*        DFHUNNUM  Numeric       Normal       On
  2065     02  DFHUNNUM PIC X VALUE "J".
  2066*        DFHBMPRF  Protected     Normal       On
  2067     02  DFHBMPRF PIC X VALUE "/".
  2068*************************************************
  2069*        DFHUNIMD  Unprotected   Bright       On
  2070     02  DFHUNIMD PIC X VALUE "I".
  2071*        DFHUNINT  Numeric       Bright       On
  2072     02  DFHUNINT PIC X VALUE "R".
  2073*************************************************
  2074*        DFHUNNOD  Unprotected   Non-Display  On
  2075     02  DFHUNNOD PIC X VALUE "(".
  2076*        DFHUNNON  Numeric       Non-Display  On
  2077     02  DFHUNNON PIC X VALUE ")".
  2078*************************************************
  2079*
  2080*     COLOURS
  2081*
  2082     02  DFHDFCOL PIC X VALUE X"00".
  2083     02  DFHBLUE  PIC X VALUE "1".
  2084     02  DFHRED   PIC X VALUE "2".
  2085     02  DFHPINK  PIC X VALUE "3".
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  42
* EL152.cbl
  2086     02  DFHGREEN PIC X VALUE "4".
  2087     02  DFHTURQ  PIC X VALUE "5".
  2088     02  DFHYELLO PIC X VALUE "6".
  2089     02  DFHNEUTR PIC X VALUE "7".
  2090     02  DFH3270  PIC X VALUE "{".
  2091     02  DFHALL   PIC X VALUE LOW-VALUE.
  2092     02  DFHBASE  PIC X VALUE LOW-VALUE.
  2093     02  DFHBLINK PIC X VALUE "1".
  2094     02  DFHBMDET PIC X VALUE LOW-VALUE.
  2095     02  DFHBMEOF PIC X VALUE X"80".
  2096     02  DFHBMPEM PIC X VALUE X"19".
  2097* Newline, DFHBMPNL, is changed to be an ASCII 0x0A
  2098     02  DFHBMPNL PIC X VALUE X"0A".
  2099     02  DFHCOLOR PIC X VALUE "!".
  2100     02  DFHDFHI  PIC X VALUE LOW-VALUE.
  2101     02  DFHDFT   PIC X VALUE X"FF".
  2102     02  DFHERROR PIC X VALUE X"1A".
  2103     02  DFHHLT   PIC X VALUE " ".
  2104     02  DFHMENT  PIC X VALUE X"02".
  2105     02  DFHBMCUR  PIC X VALUE X"02".
  2106     02  DFHBMFLG  PIC X.
  2107         88 DFHCURSR VALUES ARE X"02" , X"82".
  2108     02  DFHMET   PIC X VALUE X"03".
  2109     02  DFHMFE   PIC X VALUE X"06".
  2110     02  DFHMFET  PIC X VALUE LOW-VALUE.
  2111     02  DFHMFIL  PIC X VALUE X"1C".
  2112     02  DFHMFT   PIC X VALUE X"09".
  2113     02  DFHMT    PIC X VALUE X"01".
  2114     02  DFHPS    PIC X VALUE '"'.
  2115     02  DFHREVRS PIC X VALUE "2".
  2116     02  DFHSA    PIC X VALUE X"08".
  2117     02  DFHUNDLN PIC X VALUE "4".
  2118     02  DFHVAL   PIC X VALUE "A".
  2119     02  DFHLEFT  PIC X VALUE X"97".
  2120     02  DFHOVER  PIC X VALUE X"9C".
  2121     02  DFHRIGHT PIC X VALUE X"02".
  2122     02  DFHUNDER PIC X VALUE X"01".
  2123     02  DFHBOX-BIN  PIC 9(4) COMP VALUE 15.
  2124     02  FILLER REDEFINES DFHBOX-BIN.
  2125         03  FILLER PIC X.
  2126         03  DFHBOX PIC X.
  2127     02  DFHSOSI  PIC X VALUE X"01".
  2128     02  DFHBMPSO-BIN    PIC 9(4) COMP VALUE 3599.
  2129     02  FILLER REDEFINES DFHBMPSO-BIN.
  2130         03 DFHBMPSO  PIC X.
  2131         03 DFHBMPSI  PIC X.
  2132     02  DFHBMEC  PIC X VALUE X"82".
  2133*    02  DFHDFFR  PIC X VALUE X"00".
  2134*    02  DFHOPAQ  PIC X VALUE X"00".
  2135*    02  DFHOUTLN PIC X VALUE X"00".
  2136*    02  DFHTRANS PIC X VALUE X"00".
  2137*    02  DFHBKTRN PIC X VALUE X"00".
  2138*                            COPY ELCAID.
  2139******************************************************************
  2140*                                                                *
  2141*                            ELCAID.                             *
  2142*                            VMOD=2.001                          *
  2143*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  43
* EL152.cbl
  2144*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2145*                                                                *
  2146*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2147*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2148******************************************************************
  2149
  2150 01  DFHAID.
  2151   02  DFHNULL   PIC  X  VALUE  ' '.
  2152   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2153   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2154   02  DFHPEN    PIC  X  VALUE  '='.
  2155   02  DFHOPID   PIC  X  VALUE  'W'.
  2156   02  DFHPA1    PIC  X  VALUE  '%'.
  2157   02  DFHPA2    PIC  X  VALUE  '>'.
  2158   02  DFHPA3    PIC  X  VALUE  ','.
  2159   02  DFHPF1    PIC  X  VALUE  '1'.
  2160   02  DFHPF2    PIC  X  VALUE  '2'.
  2161   02  DFHPF3    PIC  X  VALUE  '3'.
  2162   02  DFHPF4    PIC  X  VALUE  '4'.
  2163   02  DFHPF5    PIC  X  VALUE  '5'.
  2164   02  DFHPF6    PIC  X  VALUE  '6'.
  2165   02  DFHPF7    PIC  X  VALUE  '7'.
  2166   02  DFHPF8    PIC  X  VALUE  '8'.
  2167   02  DFHPF9    PIC  X  VALUE  '9'.
  2168   02  DFHPF10   PIC  X  VALUE  ':'.
  2169   02  DFHPF11   PIC  X  VALUE  '#'.
  2170   02  DFHPF12   PIC  X  VALUE  '@'.
  2171   02  DFHPF13   PIC  X  VALUE  'A'.
  2172   02  DFHPF14   PIC  X  VALUE  'B'.
  2173   02  DFHPF15   PIC  X  VALUE  'C'.
  2174   02  DFHPF16   PIC  X  VALUE  'D'.
  2175   02  DFHPF17   PIC  X  VALUE  'E'.
  2176   02  DFHPF18   PIC  X  VALUE  'F'.
  2177   02  DFHPF19   PIC  X  VALUE  'G'.
  2178   02  DFHPF20   PIC  X  VALUE  'H'.
  2179   02  DFHPF21   PIC  X  VALUE  'I'.
  2180*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2181   02  DFHPF22   PIC  X  VALUE  '['.
  2182   02  DFHPF23   PIC  X  VALUE  '.'.
  2183   02  DFHPF24   PIC  X  VALUE  '<'.
  2184   02  DFHMSRE   PIC  X  VALUE  'X'.
  2185   02  DFHSTRF   PIC  X  VALUE  'h'.
  2186   02  DFHTRIG   PIC  X  VALUE  '"'.
  2187 01  FILLER    REDEFINES DFHAID.
  2188     12  FILLER              PIC X(8).
  2189     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  44
* EL152.cbl
  2191*                            COPY EL152S.
  2192 01  EL152AI.
  2193     05  FILLER            PIC  X(0012).
  2194*    -------------------------------
  2195     05  DATEAL PIC S9(0004) COMP.
  2196     05  DATEAF PIC  X(0001).
  2197     05  FILLER REDEFINES DATEAF.
  2198         10  DATEAA PIC  X(0001).
  2199     05  DATEAI PIC  X(0008).
  2200*    -------------------------------
  2201     05  TIMEAL PIC S9(0004) COMP.
  2202     05  TIMEAF PIC  X(0001).
  2203     05  FILLER REDEFINES TIMEAF.
  2204         10  TIMEAA PIC  X(0001).
  2205     05  TIMEAI PIC  X(0005).
  2206*    -------------------------------
  2207     05  CARRL PIC S9(0004) COMP.
  2208     05  CARRF PIC  X(0001).
  2209     05  FILLER REDEFINES CARRF.
  2210         10  CARRA PIC  X(0001).
  2211     05  CARRI PIC  X(0001).
  2212*    -------------------------------
  2213     05  CLMNOL PIC S9(0004) COMP.
  2214     05  CLMNOF PIC  X(0001).
  2215     05  FILLER REDEFINES CLMNOF.
  2216         10  CLMNOA PIC  X(0001).
  2217     05  CLMNOI PIC  X(0007).
  2218*    -------------------------------
  2219     05  CRTNOL PIC S9(0004) COMP.
  2220     05  CRTNOF PIC  X(0001).
  2221     05  FILLER REDEFINES CRTNOF.
  2222         10  CRTNOA PIC  X(0001).
  2223     05  CRTNOI PIC  X(0011).
  2224*    -------------------------------
  2225     05  PROCL PIC S9(0004) COMP.
  2226     05  PROCF PIC  X(0001).
  2227     05  FILLER REDEFINES PROCF.
  2228         10  PROCA PIC  X(0001).
  2229     05  PROCI PIC  X(0004).
  2230*    -------------------------------
  2231     05  COMPIDL PIC S9(0004) COMP.
  2232     05  COMPIDF PIC  X(0001).
  2233     05  FILLER REDEFINES COMPIDF.
  2234         10  COMPIDA PIC  X(0001).
  2235     05  COMPIDI PIC  X(0003).
  2236*    -------------------------------
  2237     05  CLEANL PIC S9(0004) COMP.
  2238     05  CLEANF PIC  X(0001).
  2239     05  FILLER REDEFINES CLEANF.
  2240         10  CLEANA PIC  X(0001).
  2241     05  CLEANI PIC  X(0001).
  2242*    -------------------------------
  2243     05  SYSL PIC S9(0004) COMP.
  2244     05  SYSF PIC  X(0001).
  2245     05  FILLER REDEFINES SYSF.
  2246         10  SYSA PIC  X(0001).
  2247     05  SYSI PIC  X(0008).
  2248*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  45
* EL152.cbl
  2249     05  MAINTL PIC S9(0004) COMP.
  2250     05  MAINTF PIC  X(0001).
  2251     05  FILLER REDEFINES MAINTF.
  2252         10  MAINTA PIC  X(0001).
  2253     05  MAINTI PIC  X(0001).
  2254*    -------------------------------
  2255     05  ARCHNUML PIC S9(0004) COMP.
  2256     05  ARCHNUMF PIC  X(0001).
  2257     05  FILLER REDEFINES ARCHNUMF.
  2258         10  ARCHNUMA PIC  X(0001).
  2259     05  ARCHNUMI PIC  99999999.
  2260*    -------------------------------
  2261     05  FORML PIC S9(0004) COMP.
  2262     05  FORMF PIC  X(0001).
  2263     05  FILLER REDEFINES FORMF.
  2264         10  FORMA PIC  X(0001).
  2265     05  FORMI PIC  X(0004).
  2266*    -------------------------------
  2267     05  FOLLOWL PIC S9(0004) COMP.
  2268     05  FOLLOWF PIC  X(0001).
  2269     05  FILLER REDEFINES FOLLOWF.
  2270         10  FOLLOWA PIC  X(0001).
  2271     05  FOLLOWI PIC  X(0008).
  2272*    -------------------------------
  2273     05  RESENDL PIC S9(0004) COMP.
  2274     05  RESENDF PIC  X(0001).
  2275     05  FILLER REDEFINES RESENDF.
  2276         10  RESENDA PIC  X(0001).
  2277     05  RESENDI PIC  X(0008).
  2278*    -------------------------------
  2279     05  PRINTL PIC S9(0004) COMP.
  2280     05  PRINTF PIC  X(0001).
  2281     05  FILLER REDEFINES PRINTF.
  2282         10  PRINTA PIC  X(0001).
  2283     05  PRINTI PIC  X(0001).
  2284*    -------------------------------
  2285     05  COPIESL PIC S9(0004) COMP.
  2286     05  COPIESF PIC  X(0001).
  2287     05  FILLER REDEFINES COPIESF.
  2288         10  COPIESA PIC  X(0001).
  2289     05  COPIESI PIC  X(0001).
  2290*    -------------------------------
  2291     05  ENCL PIC S9(0004) COMP.
  2292     05  ENCF PIC  X(0001).
  2293     05  FILLER REDEFINES ENCF.
  2294         10  ENCA PIC  X(0001).
  2295     05  ENCI PIC  X(0003).
  2296*    -------------------------------
  2297     05  ADDRL PIC S9(0004) COMP.
  2298     05  ADDRF PIC  X(0001).
  2299     05  FILLER REDEFINES ADDRF.
  2300         10  ADDRA PIC  X(0001).
  2301     05  ADDRI PIC  X(0002).
  2302*    -------------------------------
  2303     05  ACTL PIC S9(0004) COMP.
  2304     05  ACTF PIC  X(0001).
  2305     05  FILLER REDEFINES ACTF.
  2306         10  ACTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  46
* EL152.cbl
  2307     05  ACTI PIC  X(0001).
  2308*    -------------------------------
  2309     05  BENL PIC S9(0004) COMP.
  2310     05  BENF PIC  X(0001).
  2311     05  FILLER REDEFINES BENF.
  2312         10  BENA PIC  X(0001).
  2313     05  BENI PIC  X(0001).
  2314*    -------------------------------
  2315     05  EMPL PIC S9(0004) COMP.
  2316     05  EMPF PIC  X(0001).
  2317     05  FILLER REDEFINES EMPF.
  2318         10  EMPA PIC  X(0001).
  2319     05  EMPI PIC  X(0001).
  2320*    -------------------------------
  2321     05  INSL PIC S9(0004) COMP.
  2322     05  INSF PIC  X(0001).
  2323     05  FILLER REDEFINES INSF.
  2324         10  INSA PIC  X(0001).
  2325     05  INSI PIC  X(0001).
  2326*    -------------------------------
  2327     05  PHYSL PIC S9(0004) COMP.
  2328     05  PHYSF PIC  X(0001).
  2329     05  FILLER REDEFINES PHYSF.
  2330         10  PHYSA PIC  X(0001).
  2331     05  PHYSI PIC  X(0001).
  2332*    -------------------------------
  2333     05  OTHR1L PIC S9(0004) COMP.
  2334     05  OTHR1F PIC  X(0001).
  2335     05  FILLER REDEFINES OTHR1F.
  2336         10  OTHR1A PIC  X(0001).
  2337     05  OTHR1I PIC  X(0001).
  2338*    -------------------------------
  2339     05  OTHR2L PIC S9(0004) COMP.
  2340     05  OTHR2F PIC  X(0001).
  2341     05  FILLER REDEFINES OTHR2F.
  2342         10  OTHR2A PIC  X(0001).
  2343     05  OTHR2I PIC  X(0001).
  2344*    -------------------------------
  2345     05  REL PIC S9(0004) COMP.
  2346     05  REF PIC  X(0001).
  2347     05  FILLER REDEFINES REF.
  2348         10  REA PIC  X(0001).
  2349     05  REI PIC  X(0070).
  2350*    -------------------------------
  2351     05  L1L PIC S9(0004) COMP.
  2352     05  L1F PIC  X(0001).
  2353     05  FILLER REDEFINES L1F.
  2354         10  L1A PIC  X(0001).
  2355     05  L1I PIC  X(0003).
  2356*    -------------------------------
  2357     05  TEXT1L PIC S9(0004) COMP.
  2358     05  TEXT1F PIC  X(0001).
  2359     05  FILLER REDEFINES TEXT1F.
  2360         10  TEXT1A PIC  X(0001).
  2361     05  TEXT1I PIC  X(0070).
  2362*    -------------------------------
  2363     05  L2L PIC S9(0004) COMP.
  2364     05  L2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  47
* EL152.cbl
  2365     05  FILLER REDEFINES L2F.
  2366         10  L2A PIC  X(0001).
  2367     05  L2I PIC  X(0003).
  2368*    -------------------------------
  2369     05  TEXT2L PIC S9(0004) COMP.
  2370     05  TEXT2F PIC  X(0001).
  2371     05  FILLER REDEFINES TEXT2F.
  2372         10  TEXT2A PIC  X(0001).
  2373     05  TEXT2I PIC  X(0070).
  2374*    -------------------------------
  2375     05  L3L PIC S9(0004) COMP.
  2376     05  L3F PIC  X(0001).
  2377     05  FILLER REDEFINES L3F.
  2378         10  L3A PIC  X(0001).
  2379     05  L3I PIC  X(0003).
  2380*    -------------------------------
  2381     05  TEXT3L PIC S9(0004) COMP.
  2382     05  TEXT3F PIC  X(0001).
  2383     05  FILLER REDEFINES TEXT3F.
  2384         10  TEXT3A PIC  X(0001).
  2385     05  TEXT3I PIC  X(0070).
  2386*    -------------------------------
  2387     05  L4L PIC S9(0004) COMP.
  2388     05  L4F PIC  X(0001).
  2389     05  FILLER REDEFINES L4F.
  2390         10  L4A PIC  X(0001).
  2391     05  L4I PIC  X(0003).
  2392*    -------------------------------
  2393     05  TEXT4L PIC S9(0004) COMP.
  2394     05  TEXT4F PIC  X(0001).
  2395     05  FILLER REDEFINES TEXT4F.
  2396         10  TEXT4A PIC  X(0001).
  2397     05  TEXT4I PIC  X(0070).
  2398*    -------------------------------
  2399     05  L5L PIC S9(0004) COMP.
  2400     05  L5F PIC  X(0001).
  2401     05  FILLER REDEFINES L5F.
  2402         10  L5A PIC  X(0001).
  2403     05  L5I PIC  X(0003).
  2404*    -------------------------------
  2405     05  TEXT5L PIC S9(0004) COMP.
  2406     05  TEXT5F PIC  X(0001).
  2407     05  FILLER REDEFINES TEXT5F.
  2408         10  TEXT5A PIC  X(0001).
  2409     05  TEXT5I PIC  X(0070).
  2410*    -------------------------------
  2411     05  L6L PIC S9(0004) COMP.
  2412     05  L6F PIC  X(0001).
  2413     05  FILLER REDEFINES L6F.
  2414         10  L6A PIC  X(0001).
  2415     05  L6I PIC  X(0003).
  2416*    -------------------------------
  2417     05  TEXT6L PIC S9(0004) COMP.
  2418     05  TEXT6F PIC  X(0001).
  2419     05  FILLER REDEFINES TEXT6F.
  2420         10  TEXT6A PIC  X(0001).
  2421     05  TEXT6I PIC  X(0070).
  2422*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  48
* EL152.cbl
  2423     05  L7L PIC S9(0004) COMP.
  2424     05  L7F PIC  X(0001).
  2425     05  FILLER REDEFINES L7F.
  2426         10  L7A PIC  X(0001).
  2427     05  L7I PIC  X(0003).
  2428*    -------------------------------
  2429     05  TEXT7L PIC S9(0004) COMP.
  2430     05  TEXT7F PIC  X(0001).
  2431     05  FILLER REDEFINES TEXT7F.
  2432         10  TEXT7A PIC  X(0001).
  2433     05  TEXT7I PIC  X(0070).
  2434*    -------------------------------
  2435     05  L8L PIC S9(0004) COMP.
  2436     05  L8F PIC  X(0001).
  2437     05  FILLER REDEFINES L8F.
  2438         10  L8A PIC  X(0001).
  2439     05  L8I PIC  X(0003).
  2440*    -------------------------------
  2441     05  TEXT8L PIC S9(0004) COMP.
  2442     05  TEXT8F PIC  X(0001).
  2443     05  FILLER REDEFINES TEXT8F.
  2444         10  TEXT8A PIC  X(0001).
  2445     05  TEXT8I PIC  X(0070).
  2446*    -------------------------------
  2447     05  L9L PIC S9(0004) COMP.
  2448     05  L9F PIC  X(0001).
  2449     05  FILLER REDEFINES L9F.
  2450         10  L9A PIC  X(0001).
  2451     05  L9I PIC  X(0003).
  2452*    -------------------------------
  2453     05  TEXT9L PIC S9(0004) COMP.
  2454     05  TEXT9F PIC  X(0001).
  2455     05  FILLER REDEFINES TEXT9F.
  2456         10  TEXT9A PIC  X(0001).
  2457     05  TEXT9I PIC  X(0070).
  2458*    -------------------------------
  2459     05  L10L PIC S9(0004) COMP.
  2460     05  L10F PIC  X(0001).
  2461     05  FILLER REDEFINES L10F.
  2462         10  L10A PIC  X(0001).
  2463     05  L10I PIC  X(0003).
  2464*    -------------------------------
  2465     05  TEXT10L PIC S9(0004) COMP.
  2466     05  TEXT10F PIC  X(0001).
  2467     05  FILLER REDEFINES TEXT10F.
  2468         10  TEXT10A PIC  X(0001).
  2469     05  TEXT10I PIC  X(0070).
  2470*    -------------------------------
  2471     05  L11L PIC S9(0004) COMP.
  2472     05  L11F PIC  X(0001).
  2473     05  FILLER REDEFINES L11F.
  2474         10  L11A PIC  X(0001).
  2475     05  L11I PIC  X(0003).
  2476*    -------------------------------
  2477     05  TEXT11L PIC S9(0004) COMP.
  2478     05  TEXT11F PIC  X(0001).
  2479     05  FILLER REDEFINES TEXT11F.
  2480         10  TEXT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  49
* EL152.cbl
  2481     05  TEXT11I PIC  X(0070).
  2482*    -------------------------------
  2483     05  L12L PIC S9(0004) COMP.
  2484     05  L12F PIC  X(0001).
  2485     05  FILLER REDEFINES L12F.
  2486         10  L12A PIC  X(0001).
  2487     05  L12I PIC  X(0003).
  2488*    -------------------------------
  2489     05  TEXT12L PIC S9(0004) COMP.
  2490     05  TEXT12F PIC  X(0001).
  2491     05  FILLER REDEFINES TEXT12F.
  2492         10  TEXT12A PIC  X(0001).
  2493     05  TEXT12I PIC  X(0070).
  2494*    -------------------------------
  2495     05  L13L PIC S9(0004) COMP.
  2496     05  L13F PIC  X(0001).
  2497     05  FILLER REDEFINES L13F.
  2498         10  L13A PIC  X(0001).
  2499     05  L13I PIC  X(0003).
  2500*    -------------------------------
  2501     05  TEXT13L PIC S9(0004) COMP.
  2502     05  TEXT13F PIC  X(0001).
  2503     05  FILLER REDEFINES TEXT13F.
  2504         10  TEXT13A PIC  X(0001).
  2505     05  TEXT13I PIC  X(0070).
  2506*    -------------------------------
  2507     05  ERRMSGL PIC S9(0004) COMP.
  2508     05  ERRMSGF PIC  X(0001).
  2509     05  FILLER REDEFINES ERRMSGF.
  2510         10  ERRMSGA PIC  X(0001).
  2511     05  ERRMSGI PIC  X(0072).
  2512*    -------------------------------
  2513     05  ENTERPFL PIC S9(0004) COMP.
  2514     05  ENTERPFF PIC  X(0001).
  2515     05  FILLER REDEFINES ENTERPFF.
  2516         10  ENTERPFA PIC  X(0001).
  2517     05  ENTERPFI PIC  99.
  2518*    -------------------------------
  2519     05  PRINTERL PIC S9(0004) COMP.
  2520     05  PRINTERF PIC  X(0001).
  2521     05  FILLER REDEFINES PRINTERF.
  2522         10  PRINTERA PIC  X(0001).
  2523     05  PRINTERI PIC  X(0004).
  2524*    -------------------------------
  2525     05  PFKEY9L PIC S9(0004) COMP.
  2526     05  PFKEY9F PIC  X(0001).
  2527     05  FILLER REDEFINES PFKEY9F.
  2528         10  PFKEY9A PIC  X(0001).
  2529     05  PFKEY9I PIC  X(0014).
  2530 01  EL152AO REDEFINES EL152AI.
  2531     05  FILLER            PIC  X(0012).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
  2534     05  DATEAO PIC  X(0008).
  2535*    -------------------------------
  2536     05  FILLER            PIC  X(0003).
  2537     05  TIMEAO PIC  99.99.
  2538*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  50
* EL152.cbl
  2539     05  FILLER            PIC  X(0003).
  2540     05  CARRO PIC  X(0001).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  CLMNOO PIC  X(0007).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  CRTNOO PIC  X(0011).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  PROCO PIC  X(0004).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  COMPIDO PIC  X(0003).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  CLEANO PIC  X(0001).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  SYSO PIC  X(0008).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  MAINTO PIC  X(0001).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
  2564     05  ARCHNUMO PIC  X(0008).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  FORMO PIC  X(0004).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  FOLLOWO PIC  X(0008).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  RESENDO PIC  X(0008).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  PRINTO PIC  X(0001).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  COPIESO PIC  X(0001).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  ENCO PIC  X(0003).
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  ADDRO PIC  X(0002).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  ACTO PIC  X(0001).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  BENO PIC  X(0001).
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
  2594     05  EMPO PIC  X(0001).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  51
* EL152.cbl
  2597     05  INSO PIC  X(0001).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  PHYSO PIC  X(0001).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  OTHR1O PIC  X(0001).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  OTHR2O PIC  X(0001).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  REO PIC  X(0070).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  L1O PIC  X(0003).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  TEXT1O PIC  X(0070).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  L2O PIC  X(0003).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  TEXT2O PIC  X(0070).
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  L3O PIC  X(0003).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  TEXT3O PIC  X(0070).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  L4O PIC  X(0003).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  TEXT4O PIC  X(0070).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  L5O PIC  X(0003).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  TEXT5O PIC  X(0070).
  2640*    -------------------------------
  2641     05  FILLER            PIC  X(0003).
  2642     05  L6O PIC  X(0003).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  TEXT6O PIC  X(0070).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  L7O PIC  X(0003).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  TEXT7O PIC  X(0070).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  L8O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  52
* EL152.cbl
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  TEXT8O PIC  X(0070).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  L9O PIC  X(0003).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  TEXT9O PIC  X(0070).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  L10O PIC  X(0003).
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  TEXT10O PIC  X(0070).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  L11O PIC  X(0003).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  TEXT11O PIC  X(0070).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  L12O PIC  X(0003).
  2679*    -------------------------------
  2680     05  FILLER            PIC  X(0003).
  2681     05  TEXT12O PIC  X(0070).
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  L13O PIC  X(0003).
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  TEXT13O PIC  X(0070).
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  ERRMSGO PIC  X(0072).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  ENTERPFO PIC  X(0002).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  PRINTERO PIC  X(0004).
  2697*    -------------------------------
  2698     05  FILLER            PIC  X(0003).
  2699     05  PFKEY9O PIC  X(0014).
  2700*    -------------------------------
  2701 01  MAP-REDEF REDEFINES EL152AI.
  2702     12  FILLER              PIC X(251).
  2703*    12  FILLER              PIC X(189).
  2704     12  EL152RI.
  2705       14  TEXT-LINES OCCURS 13 TIMES INDEXED BY SC-INDX.
  2706         16  SC-LINEL        PIC S9(4)  COMP.
  2707         16  SC-LINEA        PIC X.
  2708         16  SC-LINE         PIC XXX.
  2709         16  SC-TEXTL        PIC S9(4)  COMP.
  2710         16  SC-TEXTA        PIC X.
  2711         16  SC-TEXT         PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  53
* EL152.cbl
  2713 01  RECORD-TABLE            PIC X(21900) VALUE SPACES.
  2714
  2715 01  REC-TABLE REDEFINES RECORD-TABLE.
  2716     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX
  2717                             PIC X(3650).
  2718
  2719 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2720     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2721         16  REC-TEXT        PIC X(70).
  2722         16  REC-PC          PIC 99.
  2723         16  FILLER          PIC X.
  2724
  2725 01  TS-WORK-AREA            PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  54
* EL152.cbl
  2727****************************************************************
  2728*
  2729* Copyright (c) 2007 by Clerity Solutions, Inc.
  2730* All rights reserved.
  2731*
  2732****************************************************************
  2733 01  DFHEIV.
  2734   02  DFHEIV0               PIC X(35).
  2735   02  DFHEIV1               PIC X(08).
  2736   02  DFHEIV2               PIC X(08).
  2737   02  DFHEIV3               PIC X(08).
  2738   02  DFHEIV4               PIC X(06).
  2739   02  DFHEIV5               PIC X(04).
  2740   02  DFHEIV6               PIC X(04).
  2741   02  DFHEIV7               PIC X(02).
  2742   02  DFHEIV8               PIC X(02).
  2743   02  DFHEIV9               PIC X(01).
  2744   02  DFHEIV10              PIC S9(7) COMP-3.
  2745   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2746   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2747   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2748   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2749   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2750   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2751   02  DFHEIV17              PIC X(04).
  2752   02  DFHEIV18              PIC X(04).
  2753   02  DFHEIV19              PIC X(04).
  2754   02  DFHEIV20              USAGE IS POINTER.
  2755   02  DFHEIV21              USAGE IS POINTER.
  2756   02  DFHEIV22              USAGE IS POINTER.
  2757   02  DFHEIV23              USAGE IS POINTER.
  2758   02  DFHEIV24              USAGE IS POINTER.
  2759   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2760   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2761   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2762   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2763   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2764   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2765   02  FILLER                PIC X(02).
  2766   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2767   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2768   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2769   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2770   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2771 LINKAGE  SECTION.
  2772*****************************************************************
  2773*                                                               *
  2774* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2775* All rights reserved.                                          *
  2776*                                                               *
  2777*****************************************************************
  2778 01  dfheiblk.
  2779     02  eibtime          pic s9(7) comp-3.
  2780     02  eibdate          pic s9(7) comp-3.
  2781     02  eibtrnid         pic x(4).
  2782     02  eibtaskn         pic s9(7) comp-3.
  2783     02  eibtrmid         pic x(4).
  2784     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  55
* EL152.cbl
  2785     02  eibcposn         pic s9(4) comp.
  2786     02  eibcalen         pic s9(4) comp.
  2787     02  eibaid           pic x(1).
  2788     02  eibfiller1       pic x(1).
  2789     02  eibfn            pic x(2).
  2790     02  eibfiller2       pic x(2).
  2791     02  eibrcode         pic x(6).
  2792     02  eibfiller3       pic x(2).
  2793     02  eibds            pic x(8).
  2794     02  eibreqid         pic x(8).
  2795     02  eibrsrce         pic x(8).
  2796     02  eibsync          pic x(1).
  2797     02  eibfree          pic x(1).
  2798     02  eibrecv          pic x(1).
  2799     02  eibsend          pic x(1).
  2800     02  eibatt           pic x(1).
  2801     02  eibeoc           pic x(1).
  2802     02  eibfmh           pic x(1).
  2803     02  eibcompl         pic x(1).
  2804     02  eibsig           pic x(1).
  2805     02  eibconf          pic x(1).
  2806     02  eiberr           pic x(1).
  2807     02  eibrldbk         pic x(1).
  2808     02  eiberrcd         pic x(4).
  2809     02  eibsynrb         pic x(1).
  2810     02  eibnodat         pic x(1).
  2811     02  eibfiller5       pic x(2).
  2812     02  eibresp          pic 9(09) comp.
  2813     02  eibresp2         pic 9(09) comp.
  2814     02  dfheigdj         pic s9(4) comp.
  2815     02  dfheigdk         pic s9(4) comp.
  2816 01  DFHCOMMAREA                 PIC X(1024).
  2817
  2818 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  56
* EL152.cbl
  2820*                                COPY ELCMSTR.
  2821******************************************************************
  2822*                                                                *
  2823*                            ELCMSTR.                            *
  2824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2825*                            VMOD=2.012                          *
  2826*                                                                *
  2827*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  2828*                                                                *
  2829*   FILE TYPE = VSAM,KSDS                                        *
  2830*   RECORD SIZE = 350  RECFORM = FIXED                           *
  2831*                                                                *
  2832*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  2833*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  2834*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  2835*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  2836*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  2837*                                                 RKP=75,LEN=21  *
  2838*                                                                *
  2839*   **** NOTE ****                                               *
  2840*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  2841*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  2842*                                                                *
  2843*   LOG = YES                                                    *
  2844*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2845******************************************************************
  2846*                   C H A N G E   L O G
  2847*
  2848* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2849*-----------------------------------------------------------------
  2850*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2851* EFFECTIVE    NUMBER
  2852*-----------------------------------------------------------------
  2853* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2854* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2855* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  2856* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2857* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2858******************************************************************
  2859 01  CLAIM-MASTER.
  2860     12  CL-RECORD-ID                PIC XX.
  2861         88  VALID-CL-ID         VALUE 'CL'.
  2862
  2863     12  CL-CONTROL-PRIMARY.
  2864         16  CL-COMPANY-CD           PIC X.
  2865         16  CL-CARRIER              PIC X.
  2866         16  CL-CLAIM-NO             PIC X(7).
  2867         16  CL-CERT-NO.
  2868             20  CL-CERT-PRIME       PIC X(10).
  2869             20  CL-CERT-SFX         PIC X.
  2870
  2871     12  CL-CONTROL-BY-NAME.
  2872         16  CL-COMPANY-CD-A1        PIC X.
  2873         16  CL-INSURED-LAST-NAME    PIC X(15).
  2874         16  CL-INSURED-NAME.
  2875             20  CL-INSURED-1ST-NAME PIC X(12).
  2876             20  CL-INSURED-MID-INIT PIC X.
  2877
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  57
* EL152.cbl
  2878     12  CL-CONTROL-BY-SSN.
  2879         16  CL-COMPANY-CD-A2        PIC X.
  2880         16  CL-SOC-SEC-NO.
  2881             20  CL-SSN-STATE        PIC XX.
  2882             20  CL-SSN-ACCOUNT      PIC X(6).
  2883             20  CL-SSN-LN3          PIC X(3).
  2884
  2885     12  CL-CONTROL-BY-CERT-NO.
  2886         16  CL-COMPANY-CD-A4        PIC X.
  2887         16  CL-CERT-NO-A4.
  2888             20  CL-CERT-A4-PRIME    PIC X(10).
  2889             20  CL-CERT-A4-SFX      PIC X.
  2890
  2891     12  CL-CONTROL-BY-CCN.
  2892         16  CL-COMPANY-CD-A5        PIC X.
  2893         16  CL-CCN-A5.
  2894             20  CL-CCN.
  2895                 24  CL-CCN-PREFIX-A5 PIC X(4).
  2896                 24  CL-CCN-PRIME-A5 PIC X(12).
  2897             20  CL-CCN-FILLER-A5    PIC X(4).
  2898
  2899     12  CL-INSURED-PROFILE-DATA.
  2900         16  CL-INSURED-BIRTH-DT     PIC XX.
  2901         16  CL-INSURED-SEX-CD       PIC X.
  2902             88  INSURED-IS-MALE        VALUE 'M'.
  2903             88  INSURED-IS-FEMALE      VALUE 'F'.
  2904             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  2905         16  CL-INSURED-OCC-CD       PIC X(6).
  2906         16  FILLER                  PIC X(5).
  2907
  2908     12  CL-PROCESSING-INFO.
  2909         16  CL-PROCESSOR-ID         PIC X(4).
  2910         16  CL-CLAIM-STATUS         PIC X.
  2911             88  CLAIM-IS-OPEN          VALUE 'O'.
  2912             88  CLAIM-IS-CLOSED        VALUE 'C'.
  2913         16  CL-CLAIM-TYPE           PIC X.
  2914*            88  AH-CLAIM               VALUE 'A'.
  2915*            88  LIFE-CLAIM             VALUE 'L'.
  2916*            88  PROPERTY-CLAIM         VALUE 'P'.
  2917*            88  IUI-CLAIM              VALUE 'I'.
  2918*            88  GAP-CLAIM              VALUE 'G'.
  2919*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  2920         16  CL-CLAIM-PREM-TYPE      PIC X.
  2921             88  SINGLE-PREMIUM         VALUE '1'.
  2922             88  O-B-COVERAGE           VALUE '2'.
  2923             88  OPEN-END-COVERAGE      VALUE '3'.
  2924         16  CL-INCURRED-DT          PIC XX.
  2925         16  CL-REPORTED-DT          PIC XX.
  2926         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2927         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2928         16  CL-LAST-PMT-DT          PIC XX.
  2929         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2930         16  CL-PAID-THRU-DT         PIC XX.
  2931         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2932         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2933         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2934         16  CL-PMT-CALC-METHOD      PIC X.
  2935             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  58
* EL152.cbl
  2936             88  CL-365-DAY-YR          VALUE '2'.
  2937             88  CL-FULL-MONTHS         VALUE '3'.
  2938         16  CL-CAUSE-CD             PIC X(6).
  2939
  2940         16  CL-PRIME-CERT-NO.
  2941             20  CL-PRIME-CERT-PRIME PIC X(10).
  2942             20  CL-PRIME-CERT-SFX   PIC X.
  2943
  2944         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2945             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2946             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2947
  2948         16  CL-MICROFILM-NO         PIC X(10).
  2949         16  FILLER REDEFINES CL-MICROFILM-NO.
  2950             20  CL-BENEFIT-PERIOD   PIC 99.
  2951             20  FILLER              PIC X(8).
  2952         16  CL-PROG-FORM-TYPE       PIC X.
  2953         16  CL-LAST-ADD-ON-DT       PIC XX.
  2954
  2955         16  CL-LAST-REOPEN-DT       PIC XX.
  2956         16  CL-LAST-CLOSE-DT        PIC XX.
  2957         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2958             88  FINAL-PAID             VALUE '1'.
  2959             88  CLAIM-DENIED           VALUE '2'.
  2960             88  AUTO-CLOSE             VALUE '3'.
  2961             88  MANUAL-CLOSE           VALUE '4'.
  2962             88  BENEFITS-CHANGED       VALUE 'C'.
  2963             88  SETUP-ERRORS           VALUE 'E'.
  2964         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2965         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2966         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2967             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2968         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2969         16  FILLER                  PIC X.
  2970
  2971     12  CL-CERTIFICATE-DATA.
  2972         16  CL-CERT-ORIGIN          PIC X.
  2973             88  CERT-WAS-ONLINE        VALUE '1'.
  2974             88  CERT-WAS-CREATED       VALUE '2'.
  2975             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2976         16  CL-CERT-KEY-DATA.
  2977             20  CL-CERT-CARRIER     PIC X.
  2978             20  CL-CERT-GROUPING    PIC X(6).
  2979             20  CL-CERT-STATE       PIC XX.
  2980             20  CL-CERT-ACCOUNT.
  2981                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2982                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2983             20  CL-CERT-EFF-DT      PIC XX.
  2984
  2985     12  CL-STATUS-CONTROLS.
  2986         16  CL-PRIORITY-CD          PIC X.
  2987             88  CONFIDENTIAL-DATA      VALUE '8'.
  2988             88  HIGHEST-PRIORITY       VALUE '9'.
  2989         16  CL-SUPV-ATTN-CD         PIC X.
  2990             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2991             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2992         16  CL-PURGED-DT            PIC XX.
  2993         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  59
* EL152.cbl
  2994         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2995         16  CL-NEXT-RESEND-DT       PIC XX.
  2996         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2997         16  CL-CRITICAL-PERIOD      PIC 99.
  2998*        16  FILLER                  PIC XX.
  2999         16  CL-LAST-MAINT-DT        PIC XX.
  3000         16  CL-LAST-MAINT-USER      PIC X(4).
  3001         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3002         16  CL-LAST-MAINT-TYPE      PIC X.
  3003             88  CLAIM-SET-UP           VALUE ' '.
  3004             88  PAYMENT-MADE           VALUE '1'.
  3005             88  LETTER-SENT            VALUE '2'.
  3006             88  MASTER-WAS-ALTERED     VALUE '3'.
  3007             88  MASTER-WAS-RESTORED    VALUE '4'.
  3008             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3009             88  FILE-CONVERTED         VALUE '6'.
  3010             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3011             88  ERROR-CORRECTION       VALUE 'E'.
  3012         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3013         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3014         16  CL-BENEFICIARY          PIC X(10).
  3015         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3016         16  CL-DENIAL-TYPE          PIC X.
  3017             88  CL-TYPE-DENIAL          VALUE '1'.
  3018             88  CL-TYPE-RESCISSION      VALUE '2'.
  3019             88  CL-TYPE-REFORMATION     VALUE '3'.
  3020             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3021             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3022         16  filler                  pic x(5).
  3023*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3024*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3025*        16  CL-RTW-DT               PIC XX.
  3026
  3027     12  CL-TRAILER-CONTROLS.
  3028         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3029             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3030             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3031             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3032         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3033         16  FILLER                  PIC XX.
  3034         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3035         16  CL-ADDRESS-TRAILER-CNT.
  3036             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3037                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3038             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3039                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3040             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3041                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3042             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3043                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3044             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3045                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3046             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3047                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3048             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3049                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3050
  3051     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  60
* EL152.cbl
  3052         16  CL-CV-REFNO-PRIME       PIC X(18).
  3053         16  CL-CV-REFNO-SFX         PIC XX.
  3054
  3055     12  CL-FILE-LOCATION            PIC X(4).
  3056
  3057     12  CL-PROCESS-ERRORS.
  3058         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3059             88  NO-FATAL-ERRORS        VALUE ZERO.
  3060         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3061             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3062
  3063     12  CL-PRODUCT-CD               PIC X.
  3064
  3065     12  CL-CURRENT-KEY-DATA.
  3066         16  CL-CURRENT-CARRIER      PIC X.
  3067         16  CL-CURRENT-GROUPING     PIC X(6).
  3068         16  CL-CURRENT-STATE        PIC XX.
  3069         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3070
  3071     12  CL-ASSOCIATES               PIC X.
  3072         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3073         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3074         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3075         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3076
  3077     12  CL-ACTIVITY-CODE            PIC 99.
  3078     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3079     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3080
  3081     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3082     12  CL-LAG-REPORT-CODE          PIC 9.
  3083     12  CL-LOAN-TYPE                PIC XX.
  3084     12  CL-LEGAL-STATE              PIC XX.
  3085
  3086     12  CL-YESNOSW                  PIC X.
  3087     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3088         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3089         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3090         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3091     12  cl-insured-type             pic x.
  3092         88  cl-claim-on-primary         value 'P'.
  3093         88  cl-claim-on-co-borrower     value 'C'.
  3094     12  cl-benefit-expiration-dt    PIC XX.
  3095
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  61
* EL152.cbl
  3097*                                COPY ELCCNTL.
  3098******************************************************************
  3099*                                                                *
  3100*                                                                *
  3101*                            ELCCNTL.                            *
  3102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3103*                            VMOD=2.059                          *
  3104*                                                                *
  3105*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3106*                                                                *
  3107*   FILE TYPE = VSAM,KSDS                                        *
  3108*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3109*                                                                *
  3110*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3111*       ALTERNATE INDEX = NONE                                   *
  3112*                                                                *
  3113*   LOG = YES                                                    *
  3114*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3115******************************************************************
  3116*                   C H A N G E   L O G
  3117*
  3118* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3119*-----------------------------------------------------------------
  3120*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3121* EFFECTIVE    NUMBER
  3122*-----------------------------------------------------------------
  3123* 082503                   PEMA  ADD BENEFIT GROUP
  3124* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3125* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3126* 092705    2005050300006  PEMA  ADD SPP LEASES
  3127* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3128* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3129* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3130* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3131* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3132* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3133* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3134* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3135* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3136* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3137******************************************************************
  3138*
  3139 01  CONTROL-FILE.
  3140     12  CF-RECORD-ID                       PIC XX.
  3141         88  VALID-CF-ID                        VALUE 'CF'.
  3142
  3143     12  CF-CONTROL-PRIMARY.
  3144         16  CF-COMPANY-ID                  PIC XXX.
  3145         16  CF-RECORD-TYPE                 PIC X.
  3146             88  CF-COMPANY-MASTER              VALUE '1'.
  3147             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3148             88  CF-STATE-MASTER                VALUE '3'.
  3149             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3150             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3151             88  CF-CARRIER-MASTER              VALUE '6'.
  3152             88  CF-MORTALITY-MASTER            VALUE '7'.
  3153             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3154             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  62
* EL152.cbl
  3155             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3156             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3157             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3158             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3159             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3160             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3161             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3162             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3163             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3164         16  CF-ACCESS-CD-GENL              PIC X(4).
  3165         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3166             20  CF-PROCESSOR               PIC X(4).
  3167         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3168             20  CF-STATE-CODE              PIC XX.
  3169             20  FILLER                     PIC XX.
  3170         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3171             20  FILLER                     PIC XX.
  3172             20  CF-HI-BEN-IN-REC           PIC XX.
  3173         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3174             20  FILLER                     PIC XXX.
  3175             20  CF-CARRIER-CNTL            PIC X.
  3176         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3177             20  FILLER                     PIC XX.
  3178             20  CF-HI-TYPE-IN-REC          PIC 99.
  3179         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3180             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3181                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3182             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3183             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3184         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3185             20  FILLER                     PIC X.
  3186             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3187         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3188             20  FILLER                     PIC XX.
  3189             20  CF-MORTGAGE-PLAN           PIC XX.
  3190         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3191
  3192     12  CF-LAST-MAINT-DT                   PIC XX.
  3193     12  CF-LAST-MAINT-BY                   PIC X(4).
  3194     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3195
  3196     12  CF-RECORD-BODY                     PIC X(728).
  3197
  3198
  3199****************************************************************
  3200*             COMPANY MASTER RECORD                            *
  3201****************************************************************
  3202
  3203     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3204         16  CF-COMPANY-ADDRESS.
  3205             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3206             20  CF-CL-IN-CARE-OF           PIC X(30).
  3207             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3208             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3209             20  CF-CL-CITY-STATE           PIC X(30).
  3210             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3211             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3212         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  63
* EL152.cbl
  3213         16  CF-COMPANY-PASSWORD            PIC X(8).
  3214         16  CF-SECURITY-OPTION             PIC X.
  3215             88  ALL-SECURITY                   VALUE '1'.
  3216             88  COMPANY-VERIFY                 VALUE '2'.
  3217             88  PROCESSOR-VERIFY               VALUE '3'.
  3218             88  NO-SECURITY                    VALUE '4'.
  3219             88  ALL-BUT-TERM                   VALUE '5'.
  3220         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3221             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3222         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3223             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3224         16  CF-INFORCE-LOCATION            PIC X.
  3225             88  CERTS-ARE-ONLINE               VALUE '1'.
  3226             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3227             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3228         16  CF-LOWER-CASE-LETTERS          PIC X.
  3229         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3230             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3231             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3232             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3233             88  CF-ACCNT-CNTL                  VALUE '3'.
  3234             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3235
  3236         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3237         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3238
  3239         16  CF-LGX-CREDIT-USER             PIC X.
  3240             88  CO-IS-NOT-USER                 VALUE 'N'.
  3241             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3242
  3243         16 CF-CREDIT-CALC-CODES.
  3244             20  CF-CR-REM-TERM-CALC PIC X.
  3245               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3246               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3247               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3248               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3249               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3250               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3251               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3252             20  CF-CR-R78-METHOD           PIC X.
  3253               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3254               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3255
  3256         16  CF-CLAIM-CONTROL-COUNTS.
  3257             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3258                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3259
  3260             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3261                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3262
  3263             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3264                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3265
  3266             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3267                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3268
  3269         16  CF-CURRENT-MONTH-END           PIC XX.
  3270
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  64
* EL152.cbl
  3271         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3272             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3273             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3274             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3275             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3276                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3277                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3278             20  CF-CO-PREM-REJECT-SW       PIC X.
  3279                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3280                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3281             20  CF-CO-REF-REJECT-SW        PIC X.
  3282                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3283                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3284
  3285         16  CF-CO-REPORTING-DT             PIC XX.
  3286         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3287         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3288           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3289           88  CF-CO-MONTH-END                  VALUE '1'.
  3290
  3291         16  CF-LGX-CLAIM-USER              PIC X.
  3292             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3293             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3294
  3295         16  CF-CREDIT-EDIT-CONTROLS.
  3296             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3297             20  CF-MIN-AGE                 PIC 99.
  3298             20  CF-DEFAULT-AGE             PIC 99.
  3299             20  CF-MIN-TERM                PIC S999      COMP-3.
  3300             20  CF-MAX-TERM                PIC S999      COMP-3.
  3301             20  CF-DEFAULT-SEX             PIC X.
  3302             20  CF-JOINT-AGE-INPUT         PIC X.
  3303                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3304             20  CF-BIRTH-DATE-INPUT        PIC X.
  3305                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3306             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3307                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3308                 88  CF-ZERO-CARRIER            VALUE '1'.
  3309                 88  CF-ZERO-GROUPING           VALUE '2'.
  3310                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3311             20  CF-EDIT-SW                 PIC X.
  3312                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3313             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3314             20  CF-CR-PR-METHOD            PIC X.
  3315               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3316               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3317             20  FILLER                     PIC X.
  3318
  3319         16  CF-CREDIT-MISC-CONTROLS.
  3320             20  CF-REIN-TABLE-SW           PIC X.
  3321                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3322             20  CF-COMP-TABLE-SW           PIC X.
  3323                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3324             20  CF-EXPERIENCE-RETENTION-AGE
  3325                                            PIC S9        COMP-3.
  3326             20  CF-CONVERSION-DT           PIC XX.
  3327             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3328             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  65
* EL152.cbl
  3329                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3330                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3331
  3332             20  CF-CR-CHECK-NO-CONTROL.
  3333                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3334                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3335                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3336                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3337                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3338                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3339
  3340                 24  CF-CR-CHECK-COUNT       REDEFINES
  3341                     CF-CR-CHECK-COUNTER      PIC X(4).
  3342
  3343                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3344                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3345
  3346                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3347                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3348                 24  CF-MAIL-PROCESSING       PIC X.
  3349                     88  MAIL-PROCESSING          VALUE 'Y'.
  3350
  3351         16  CF-MISC-SYSTEM-CONTROL.
  3352             20  CF-SYSTEM-C                 PIC X.
  3353                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3354             20  CF-SYSTEM-D                 PIC X.
  3355                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3356             20  CF-SOC-SEC-NO-SW            PIC X.
  3357                 88  SOC-SEC-NO-USED             VALUE '1'.
  3358             20  CF-MEMBER-NO-SW             PIC X.
  3359                 88  MEMBER-NO-USED              VALUE '1'.
  3360             20  CF-TAX-ID-NUMBER            PIC X(11).
  3361             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3362             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3363                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3364                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3365                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3366                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3367             20  CF-SYSTEM-E                 PIC X.
  3368                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3369
  3370         16  CF-LGX-LIFE-USER               PIC X.
  3371             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3372             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3373
  3374         16  CF-CR-MONTH-END-DT             PIC XX.
  3375
  3376         16  CF-FILE-MAINT-DATES.
  3377             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3378                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3379             20  CF-LAST-BATCH       REDEFINES
  3380                 CF-LAST-BATCH-NO               PIC X(4).
  3381             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3382             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3383             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3384             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3385             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3386             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  66
* EL152.cbl
  3387             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3388             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3389             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3390             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3391
  3392         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3393         16  FILLER                         PIC X.
  3394
  3395         16  CF-ALT-MORT-CODE               PIC X(4).
  3396         16  CF-MEMBER-CAPTION              PIC X(10).
  3397
  3398         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3399             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3400             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3401             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3402             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3403             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3404
  3405         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3406
  3407         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3408         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3409         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3410         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3411
  3412         16  CF-AH-OVERRIDE-L1              PIC X.
  3413         16  CF-AH-OVERRIDE-L2              PIC XX.
  3414         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3415         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3416
  3417         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3418         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3419
  3420         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3421         16  CF-AR-LAST-EL860-DT            PIC XX.
  3422         16  CF-MP-MONTH-END-DT             PIC XX.
  3423
  3424         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3425         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3426             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3427
  3428         16  CF-AR-MONTH-END-DT             PIC XX.
  3429
  3430         16  CF-CRDTCRD-USER                PIC X.
  3431             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3432             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3433
  3434         16  CF-CC-MONTH-END-DT             PIC XX.
  3435
  3436         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3437
  3438         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3439             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3440             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3441             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3442         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3443         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3444         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  67
* EL152.cbl
  3445         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3446             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3447             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3448         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3449         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3450         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3451             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3452         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3453
  3454         16  CF-CL-ZIP-CODE.
  3455             20  CF-CL-ZIP-PRIME.
  3456                 24  CF-CL-ZIP-1ST          PIC X.
  3457                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3458                 24  FILLER                 PIC X(4).
  3459             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3460         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3461             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3462             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3463             20  FILLER                     PIC XXX.
  3464
  3465         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3466         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3467         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3468         16  CF-CO-OPTION-START-DATE        PIC XX.
  3469         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3470           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3471                                                      '3' '4'.
  3472           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3473           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3474           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3475           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3476           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3477           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3478
  3479         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3480
  3481         16  CF-PAYMENT-APPROVAL-LEVELS.
  3482             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3483             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3484             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3485             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3486             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3487             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3488
  3489         16  CF-END-USER-REPORTING-USER     PIC X.
  3490             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3491             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3492
  3493         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3494             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3495             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3496
  3497         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3498
  3499         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3500         16  FILLER                         PIC X.
  3501
  3502         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  68
* EL152.cbl
  3503             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3504             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3505             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3506
  3507         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3508
  3509         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3510             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3511             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3512
  3513         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3514             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3515             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3516
  3517         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3518
  3519         16  CF-CO-ACH-ID-CODE              PIC  X.
  3520             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3521             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3522             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3523         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3524         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3525         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3526         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3527         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3528         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3529         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3530         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3531         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3532                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3533         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3534                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3535
  3536         16  CF-CO-OVER-SHORT.
  3537             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3538             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3539
  3540*         16  FILLER                         PIC X(102).
  3541         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3542             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3543             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3544
  3545         16  CF-AH-APPROVAL-DAYS.
  3546             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3547             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3548             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3549             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3550
  3551         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3552
  3553         16  CF-APPROV-LEV-5.
  3554             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3555             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3556             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3557
  3558         16  FILLER                         PIC X(68).
  3559****************************************************************
  3560*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  69
* EL152.cbl
  3561****************************************************************
  3562
  3563     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3564         16  CF-PROCESSOR-NAME              PIC X(30).
  3565         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3566         16  CF-PROCESSOR-TITLE             PIC X(26).
  3567         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3568                 88  MESSAGE-YES                VALUE 'Y'.
  3569                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3570
  3571*****************************************************
  3572****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3573****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3574****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3575****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3576*****************************************************
  3577
  3578         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3579             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3580             20  CF-APPLICATION-FORCE       PIC X.
  3581             20  CF-INDIVIDUAL-APP.
  3582                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3583                     28  CF-BROWSE-APP      PIC X.
  3584                     28  CF-UPDATE-APP      PIC X.
  3585
  3586         16  CF-CURRENT-TERM-ON             PIC X(4).
  3587         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3588             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3589             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3590             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3591             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3592             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3593             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3594             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3595         16  CF-PROCESSOR-CARRIER           PIC X.
  3596             88  NO-CARRIER-SECURITY            VALUE ' '.
  3597         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3598             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3599         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3600             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3601         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3602             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3603
  3604         16  CF-PROC-SYS-ACCESS-SW.
  3605             20  CF-PROC-CREDIT-CLAIMS-SW.
  3606                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3607                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3608                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3609                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3610             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3611                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3612                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3613             20  CF-PROC-LIFE-GNRLDGR-SW.
  3614                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3615                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3616                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3617                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3618             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  70
* EL152.cbl
  3619                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3620                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3621         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3622             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3623             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3624         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3625
  3626         16  CF-APPROVAL-LEVEL                  PIC X.
  3627             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3628             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3629             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3630             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3631             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3632
  3633         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3634
  3635         16  CF-LANGUAGE-TYPE                   PIC X.
  3636             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3637             88  CF-LANG-IS-FR                      VALUE 'F'.
  3638
  3639         16  CF-CSR-IND                         PIC X.
  3640         16  FILLER                             PIC X(239).
  3641
  3642****************************************************************
  3643*             PROCESSOR/REMINDERS RECORD                       *
  3644****************************************************************
  3645
  3646     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3647         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3648             20  CF-START-REMIND-DT         PIC XX.
  3649             20  CF-END-REMIND-DT           PIC XX.
  3650             20  CF-REMINDER-TEXT           PIC X(50).
  3651         16  FILLER                         PIC X(296).
  3652
  3653
  3654****************************************************************
  3655*             STATE MASTER RECORD                              *
  3656****************************************************************
  3657
  3658     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3659         16  CF-STATE-ABBREVIATION          PIC XX.
  3660         16  CF-STATE-NAME                  PIC X(25).
  3661         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3662         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3663             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3664             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3665             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3666             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3667                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3668                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3669             20  CF-ST-PREM-REJECT-SW       PIC X.
  3670                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3671                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3672             20  CF-ST-REF-REJECT-SW        PIC X.
  3673                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3674                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3675         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3676         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  71
* EL152.cbl
  3677         16  CF-ST-REFUND-RULES.
  3678             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3679             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3680             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3681         16  CF-ST-FST-PMT-EXTENSION.
  3682             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3683             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3684                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3685                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3686                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3687                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3688         16  CF-ST-STATE-CALL.
  3689             20  CF-ST-CALL-UNEARNED        PIC X.
  3690             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3691             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3692         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3693             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3694             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3695         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3696         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3697         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3698         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3699         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3700         16  FILLER                         PIC X.
  3701         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3702             20  CF-ST-BENEFIT-CD           PIC XX.
  3703             20  CF-ST-BENEFIT-KIND         PIC X.
  3704                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3705                 88  CF-ST-AH-KIND              VALUE 'A'.
  3706             20  CF-ST-REM-TERM-CALC        PIC X.
  3707                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3708                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3709                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3710                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3711                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3712                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3713                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3714                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3715
  3716             20  CF-ST-REFUND-CALC          PIC X.
  3717                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3718                 88  ST-REFD-BY-R78             VALUE '1'.
  3719                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3720                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3721                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3722                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3723                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3724                 88  ST-REFD-UTAH               VALUE '7'.
  3725                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3726                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3727                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3728
  3729             20  CF-ST-EARNING-CALC         PIC X.
  3730                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3731                 88  ST-EARN-BY-R78             VALUE '1'.
  3732                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3733                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3734                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  72
* EL152.cbl
  3735                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3736                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3737                 88  ST-EARN-MEAN               VALUE '8'.
  3738                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3739
  3740             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3741                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3742                 88  ST-OVRD-BY-R78             VALUE '1'.
  3743                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3744                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3745                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3746                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3747                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3748                 88  ST-OVRD-MEAN               VALUE '8'.
  3749                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3750             20  FILLER                     PIC X.
  3751
  3752         16  CF-ST-COMMISSION-CAPS.
  3753             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3754             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3755             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3756             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3757         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3758                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3759
  3760         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3761
  3762         16  CF-ST-STATUTORY-INTEREST.
  3763             20  CF-ST-STAT-DATE-FROM       PIC X.
  3764                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3765                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3766             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3767             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3768             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3769             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3770             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3771
  3772         16  CF-ST-OVER-SHORT.
  3773             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3774             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3775
  3776         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3777
  3778         16  CF-ST-RT-CALC                  PIC X.
  3779
  3780         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3781         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3782         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3783         16  CF-ST-RF-LR-CALC               PIC X.
  3784         16  CF-ST-RF-LL-CALC               PIC X.
  3785         16  CF-ST-RF-LN-CALC               PIC X.
  3786         16  CF-ST-RF-AH-CALC               PIC X.
  3787         16  CF-ST-RF-CP-CALC               PIC X.
  3788*        16  FILLER                         PIC X(206).
  3789*CIDMOD         16  FILLER                         PIC X(192).
  3790         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3791             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3792         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  73
* EL152.cbl
  3793         16  CF-ST-VFY-2ND-BENE             PIC X.
  3794         16  CF-ST-CAUSAL-STATE             PIC X.
  3795         16  FILLER                         PIC X(185).
  3796
  3797****************************************************************
  3798*             BENEFIT MASTER RECORD                            *
  3799****************************************************************
  3800
  3801     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3802         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3803             20  CF-BENEFIT-CODE            PIC XX.
  3804             20  CF-BENEFIT-NUMERIC  REDEFINES
  3805                 CF-BENEFIT-CODE            PIC XX.
  3806             20  CF-BENEFIT-ALPHA           PIC XXX.
  3807             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3808             20  CF-BENEFIT-COMMENT         PIC X(10).
  3809
  3810             20  CF-LF-COVERAGE-TYPE        PIC X.
  3811                 88  CF-REDUCING                VALUE 'R'.
  3812                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3813
  3814             20  CF-SPECIAL-CALC-CD         PIC X.
  3815                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3816                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3817                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3818                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3819                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3820                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3821                 88  CF-FARM-PLAN               VALUE 'F'.
  3822                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3823                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3824                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3825                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3826                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3827                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3828                 88  CF-PRUDENTIAL              VALUE 'P'.
  3829                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3830                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3831                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3832                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3833                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3834                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3835
  3836             20  CF-JOINT-INDICATOR         PIC X.
  3837                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3838
  3839*            20  FILLER                     PIC X(12).
  3840             20  cf-maximum-benefits        pic s999 comp-3.
  3841             20  FILLER                     PIC X(09).
  3842             20  CF-BENEFIT-CATEGORY        PIC X.
  3843             20  CF-LOAN-TYPE               PIC X(8).
  3844
  3845             20  CF-CO-REM-TERM-CALC        PIC X.
  3846                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3847                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3848                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3849                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3850                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  74
* EL152.cbl
  3851
  3852             20  CF-CO-EARNINGS-CALC        PIC X.
  3853                 88  CO-EARN-BY-R78             VALUE '1'.
  3854                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3855                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3856                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3857                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3858                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3859                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3860                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3861
  3862             20  CF-CO-REFUND-CALC          PIC X.
  3863                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3864                 88  CO-REFD-BY-R78             VALUE '1'.
  3865                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3866                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3867                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3868                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3869                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3870                 88  CO-REFD-MEAN               VALUE '8'.
  3871                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3872                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3873                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3874
  3875             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3876                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3877                 88  CO-OVRD-BY-R78             VALUE '1'.
  3878                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3879                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3880                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3881                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3882                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3883                 88  CO-OVRD-MEAN               VALUE '8'.
  3884                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3885
  3886             20  CF-CO-BEN-I-G-CD           PIC X.
  3887                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3888                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3889                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3890
  3891         16  FILLER                         PIC X(304).
  3892
  3893
  3894****************************************************************
  3895*             CARRIER MASTER RECORD                            *
  3896****************************************************************
  3897
  3898     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3899         16  CF-ADDRESS-DATA.
  3900             20  CF-MAIL-TO-NAME            PIC X(30).
  3901             20  CF-IN-CARE-OF              PIC X(30).
  3902             20  CF-ADDRESS-LINE-1          PIC X(30).
  3903             20  CF-ADDRESS-LINE-2          PIC X(30).
  3904             20  CF-CITY-STATE              PIC X(30).
  3905             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3906             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3907
  3908         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  75
* EL152.cbl
  3909             20  CF-CLAIM-NO-METHOD         PIC X.
  3910                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3911                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3912                 88  CLAIM-NO-SEQ               VALUE '3'.
  3913                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3914             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3915                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3916                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3917                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3918
  3919         16  CF-CHECK-NO-CONTROL.
  3920             20  CF-CHECK-NO-METHOD         PIC X.
  3921                 88  CHECK-NO-MANUAL            VALUE '1'.
  3922                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3923                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3924                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3925             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3926                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3927
  3928         16  CF-DOMICILE-STATE              PIC XX.
  3929
  3930         16  CF-EXPENSE-CONTROLS.
  3931             20  CF-EXPENSE-METHOD          PIC X.
  3932                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3933                 88  DOLLARS-PER-PMT            VALUE '2'.
  3934                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3935                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3936             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3937             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3938
  3939         16  CF-CORRESPONDENCE-CONTROL.
  3940             20  CF-LETTER-RESEND-OPT       PIC X.
  3941                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3942                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3943             20  FILLER                     PIC X(4).
  3944
  3945         16  CF-RESERVE-CONTROLS.
  3946             20  CF-MANUAL-SW               PIC X.
  3947                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3948             20  CF-FUTURE-SW               PIC X.
  3949                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3950             20  CF-PTC-SW                  PIC X.
  3951                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3952             20  CF-IBNR-SW                 PIC X.
  3953                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3954             20  CF-PTC-LF-SW               PIC X.
  3955                 88  CF-LF-PTC-USED             VALUE '1'.
  3956             20  CF-CDT-ACCESS-METHOD       PIC X.
  3957                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3958                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3959                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3960             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3961
  3962         16  CF-CLAIM-CALC-METHOD           PIC X.
  3963             88  360-PLUS-MONTHS                VALUE '1'.
  3964             88  365-PLUS-MONTHS                VALUE '2'.
  3965             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3966             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  76
* EL152.cbl
  3967             88  365-DAILY                      VALUE '5'.
  3968
  3969         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3970         16  FILLER                         PIC X(11).
  3971
  3972         16  CF-LIMIT-AMOUNTS.
  3973             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3974             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3975             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3976             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3977             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3978             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3979             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3980             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3981             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3982             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3983
  3984         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3985         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3986         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3987
  3988         16  CF-ZIP-CODE.
  3989             20  CF-ZIP-PRIME.
  3990                 24  CF-ZIP-1ST             PIC X.
  3991                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3992                 24  FILLER                 PIC X(4).
  3993             20  CF-ZIP-PLUS4               PIC X(4).
  3994         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3995             20  CF-CAN-POSTAL-1            PIC XXX.
  3996             20  CF-CAN-POSTAL-2            PIC XXX.
  3997             20  FILLER                     PIC XXX.
  3998
  3999         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4000         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4001         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4002
  4003         16  CF-RATING-SWITCH               PIC X.
  4004             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4005             88  CF-NO-RATING                   VALUE 'N'.
  4006
  4007         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4008
  4009         16  CF-CARRIER-OVER-SHORT.
  4010             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4011             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4012
  4013         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4014         16  CF-SECPAY-SWITCH               PIC X.
  4015             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4016             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4017         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4018         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4019         16  FILLER                         PIC X(444).
  4020*        16  FILLER                         PIC X(452).
  4021
  4022
  4023****************************************************************
  4024*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  77
* EL152.cbl
  4025****************************************************************
  4026
  4027     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4028         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4029                                INDEXED BY CF-MORT-NDX.
  4030             20  CF-MORT-TABLE              PIC X(5).
  4031             20  CF-MORT-TABLE-TYPE         PIC X.
  4032                 88  CF-MORT-JOINT              VALUE 'J'.
  4033                 88  CF-MORT-SINGLE             VALUE 'S'.
  4034                 88  CF-MORT-COMBINED           VALUE 'C'.
  4035                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4036                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4037             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4038             20  CF-MORT-AGE-METHOD         PIC XX.
  4039                 88  CF-AGE-LAST                VALUE 'AL'.
  4040                 88  CF-AGE-NEAR                VALUE 'AN'.
  4041             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4042             20  CF-MORT-ADJUSTMENT-DIRECTION
  4043                                            PIC X.
  4044                 88  CF-MINUS                   VALUE '-'.
  4045                 88  CF-PLUS                    VALUE '+'.
  4046             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4047             20  CF-MORT-JOINT-CODE         PIC X.
  4048                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4049             20  CF-MORT-PC-Q               PIC X.
  4050                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4051             20  CF-MORT-TABLE-CODE         PIC X(4).
  4052             20  CF-MORT-COMMENTS           PIC X(15).
  4053             20  FILLER                     PIC X(14).
  4054
  4055         16  FILLER                         PIC X(251).
  4056
  4057
  4058****************************************************************
  4059*             BUSSINESS TYPE MASTER RECORD                     *
  4060****************************************************************
  4061
  4062     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4063* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4064* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4065* AND RECORD 05 IS TYPES 81-99
  4066         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4067             20  CF-BUSINESS-TITLE          PIC  X(19).
  4068             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4069                                            PIC S9V9(4) COMP-3.
  4070             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4071             20  FILLER                     PIC  X.
  4072         16  FILLER                         PIC  X(248).
  4073
  4074
  4075****************************************************************
  4076*             TERMINAL MASTER RECORD                           *
  4077****************************************************************
  4078
  4079     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4080
  4081         16  CF-COMPANY-TERMINALS.
  4082             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  78
* EL152.cbl
  4083                                  PIC X(4).
  4084         16  FILLER               PIC X(248).
  4085
  4086
  4087****************************************************************
  4088*             LIFE EDIT MASTER RECORD                          *
  4089****************************************************************
  4090
  4091     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4092         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4093             20  CF-LIFE-CODE-IN            PIC XX.
  4094             20  CF-LIFE-CODE-OUT           PIC XX.
  4095         16  FILLER                         PIC X(248).
  4096
  4097
  4098****************************************************************
  4099*             AH EDIT MASTER RECORD                            *
  4100****************************************************************
  4101
  4102     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4103         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4104             20  CF-AH-CODE-IN              PIC XXX.
  4105             20  CF-AH-CODE-OUT             PIC XX.
  4106         16  FILLER                         PIC X(248).
  4107
  4108
  4109****************************************************************
  4110*             CREDIBILITY TABLES                               *
  4111****************************************************************
  4112
  4113     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4114         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4115                             INDEXED BY CF-CRDB-NDX.
  4116             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4117             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4118             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4119         16  FILLER                         PIC  X(332).
  4120
  4121
  4122****************************************************************
  4123*             REPORT CUSTOMIZATION RECORD                      *
  4124****************************************************************
  4125
  4126     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4127         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4128             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4129             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4130             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4131**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4132****       A T-TRANSFER.                                   ****
  4133             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4134
  4135         16  FILLER                         PIC XX.
  4136
  4137         16  CF-CARRIER-CNTL-OPT.
  4138             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4139                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4140                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  79
* EL152.cbl
  4141             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4142                                            PIC X.
  4143         16  CF-GROUP-CNTL-OPT.
  4144             20  CF-GROUP-OPT-SEQ           PIC 9.
  4145                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4146                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4147             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4148                                            PIC X(6).
  4149         16  CF-STATE-CNTL-OPT.
  4150             20  CF-STATE-OPT-SEQ           PIC 9.
  4151                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4152                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4153             20  CF-STATE-SELECT OCCURS 3 TIMES
  4154                                            PIC XX.
  4155         16  CF-ACCOUNT-CNTL-OPT.
  4156             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4157                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4158                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4159             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4160                                            PIC X(10).
  4161         16  CF-BUS-TYP-CNTL-OPT.
  4162             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4163                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4164                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4165             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4166                                            PIC XX.
  4167         16  CF-LF-TYP-CNTL-OPT.
  4168             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4169                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4170                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4171             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4172                                            PIC XX.
  4173         16  CF-AH-TYP-CNTL-OPT.
  4174             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4175                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4176                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4177             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4178                                            PIC XX.
  4179         16  CF-REPTCD1-CNTL-OPT.
  4180             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4181                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4182                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4183             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4184                                            PIC X(10).
  4185         16  CF-REPTCD2-CNTL-OPT.
  4186             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4187                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4188                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4189             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4190                                            PIC X(10).
  4191         16  CF-USER1-CNTL-OPT.
  4192             20  CF-USER1-OPT-SEQ           PIC 9.
  4193                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4194                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4195             20  CF-USER1-SELECT OCCURS 3 TIMES
  4196                                            PIC X(10).
  4197         16  CF-USER2-CNTL-OPT.
  4198             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  80
* EL152.cbl
  4199                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4200                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4201             20  CF-USER2-SELECT OCCURS 3 TIMES
  4202                                            PIC X(10).
  4203         16  CF-USER3-CNTL-OPT.
  4204             20  CF-USER3-OPT-SEQ           PIC 9.
  4205                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4206                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4207             20  CF-USER3-SELECT OCCURS 3 TIMES
  4208                                            PIC X(10).
  4209         16  CF-USER4-CNTL-OPT.
  4210             20  CF-USER4-OPT-SEQ           PIC 9.
  4211                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4212                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4213             20  CF-USER4-SELECT OCCURS 3 TIMES
  4214                                            PIC X(10).
  4215         16  CF-USER5-CNTL-OPT.
  4216             20  CF-USER5-OPT-SEQ           PIC 9.
  4217                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4218                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4219             20  CF-USER5-SELECT OCCURS 3 TIMES
  4220                                            PIC X(10).
  4221         16  CF-REINS-CNTL-OPT.
  4222             20  CF-REINS-OPT-SEQ           PIC 9.
  4223                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4224                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4225             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4226                 24  CF-REINS-PRIME         PIC XXX.
  4227                 24  CF-REINS-SUB           PIC XXX.
  4228
  4229         16  CF-AGENT-CNTL-OPT.
  4230             20  CF-AGENT-OPT-SEQ           PIC 9.
  4231                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4232                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4233             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4234                                            PIC X(10).
  4235
  4236         16  FILLER                         PIC X(43).
  4237
  4238         16  CF-LOSS-RATIO-SELECT.
  4239             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4240             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4241         16  CF-ENTRY-DATE-SELECT.
  4242             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4243             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4244         16  CF-EFFECTIVE-DATE-SELECT.
  4245             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4246             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4247
  4248         16  CF-EXCEPTION-LIST-IND          PIC X.
  4249             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4250
  4251         16  FILLER                         PIC X(318).
  4252
  4253****************************************************************
  4254*                  EXCEPTION REPORTING RECORD                  *
  4255****************************************************************
  4256
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  81
* EL152.cbl
  4257     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4258         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4259             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4260
  4261         16  CF-COMBINED-LIFE-AH-OPT.
  4262             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4263             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4264             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4265             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4266
  4267         16  CF-LIFE-OPT.
  4268             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4269             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4270             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4271             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4272             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4273             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4274             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4275             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4276             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4277             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4278
  4279         16  CF-AH-OPT.
  4280             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4281             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4282             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4283             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4284             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4285             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4286             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4287             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4288             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4289             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4290
  4291         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4292             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4293             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4294             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4295
  4296         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4297
  4298         16  FILLER                         PIC X(673).
  4299
  4300
  4301****************************************************************
  4302*             MORTGAGE SYSTEM PLAN RECORD                      *
  4303****************************************************************
  4304
  4305     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4306         16  CF-PLAN-TYPE                   PIC X.
  4307             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4308             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4309             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4310         16  CF-PLAN-ABBREV                 PIC XXX.
  4311         16  CF-PLAN-DESCRIPT               PIC X(10).
  4312         16  CF-PLAN-NOTES                  PIC X(20).
  4313         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4314         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  82
* EL152.cbl
  4315             20  CF-PLAN-TERM-DATA.
  4316                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4317                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4318             20  CF-PLAN-AGE-DATA.
  4319                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4320                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4321                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4322             20  CF-PLAN-BENEFIT-DATA.
  4323                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4324                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4325                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4326                                            PIC S9(7)V99  COMP-3.
  4327         16  CF-PLAN-POLICY-FORMS.
  4328             20  CF-POLICY-FORM             PIC X(12).
  4329             20  CF-MASTER-APPLICATION      PIC X(12).
  4330             20  CF-MASTER-POLICY           PIC X(12).
  4331         16  CF-PLAN-RATING.
  4332             20  CF-RATE-CODE               PIC X(5).
  4333             20  CF-SEX-RATING              PIC X.
  4334                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4335                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4336             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4337             20  CF-SUB-STD-TYPE            PIC X.
  4338                 88  CF-PCT-OF-PREM            VALUE '1'.
  4339                 88  CF-PCT-OF-BENE            VALUE '2'.
  4340         16  CF-PLAN-PREM-TOLERANCES.
  4341             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4342             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4343         16  CF-PLAN-PYMT-TOLERANCES.
  4344             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4345             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4346         16  CF-PLAN-MISC-DATA.
  4347             20  FILLER                     PIC X.
  4348             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4349             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4350         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4351         16  CF-PLAN-IND-GRP                PIC X.
  4352             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4353                                                     '1'.
  4354             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4355                                                     '2'.
  4356         16  CF-MIB-SEARCH-SW               PIC X.
  4357             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4358             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4359             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4360             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4361         16  CF-ALPHA-SEARCH-SW             PIC X.
  4362             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4363             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4364             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4365             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4366             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4367             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4368             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4369             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4370             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4371             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4372                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  83
* EL152.cbl
  4373                                                     'X' 'Y' 'Z'.
  4374         16  CF-EFF-DT-RULE-SW              PIC X.
  4375             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4376             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4377             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4378             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4379             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4380         16  FILLER                         PIC X(4).
  4381         16  CF-HEALTH-QUESTIONS            PIC X.
  4382             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4383         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4384         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4385         16  CF-PLAN-SNGL-JNT               PIC X.
  4386             88  CF-COMBINED-PLAN              VALUE 'C'.
  4387             88  CF-JNT-PLAN                   VALUE 'J'.
  4388             88  CF-SNGL-PLAN                  VALUE 'S'.
  4389         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4390         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4391         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4392         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4393         16  CF-RERATE-CNTL                 PIC  X.
  4394             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4395             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4396             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4397             88  CF-AUTO-RECALC                 VALUE '4'.
  4398         16  CF-BENEFIT-TYPE                PIC  X.
  4399             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4400             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4401         16  CF-POLICY-FEE                  PIC S999V99
  4402                                                    COMP-3.
  4403         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4404         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4405         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4406         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4407         16  FILLER                         PIC  X(32).
  4408         16  CF-TERMINATION-FORM            PIC  X(04).
  4409         16  FILLER                         PIC  X(08).
  4410         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4411                                                       COMP-3.
  4412         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4413         16  CF-ISSUE-LETTER                PIC  X(4).
  4414         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4415         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4416             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4417             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4418         16  CF-MP-REFUND-CALC              PIC X.
  4419             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4420             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4421             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4422             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4423             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4424             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4425             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4426             88  CF-MP-REFD-MEAN                VALUE '8'.
  4427         16  CF-ALT-RATE-CODE               PIC  X(5).
  4428
  4429
  4430         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  84
* EL152.cbl
  4431****************************************************************
  4432*             MORTGAGE COMPANY MASTER RECORD                   *
  4433****************************************************************
  4434
  4435     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4436         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4437         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4438             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4439             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4440             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4441             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4442             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4443
  4444         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4445         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4446         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4447         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4448         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4449
  4450         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4451             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4452         16  CF-MP-RECON-USE-IND            PIC X(1).
  4453             88  CF-MP-USE-RECON             VALUE 'Y'.
  4454         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4455             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4456         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4457             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4458             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4459         16  FILLER                         PIC X(1).
  4460         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4461             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4462         16  CF-MORTG-MIB-VERSION           PIC X.
  4463             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4464             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4465             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4466         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4467             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4468                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4469             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4470                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4471             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4472                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4473             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4474                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4475             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4476                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4477             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4478                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4479         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4480         16  FILLER                         PIC X(7).
  4481         16  CF-MORTG-DESTINATION-SYMBOL.
  4482             20  CF-MORTG-MIB-COMM          PIC X(5).
  4483             20  CF-MORTG-MIB-TERM          PIC X(5).
  4484         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4485             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4486         16  FILLER                         PIC X(03).
  4487         16  CF-MP-CHECK-NO-CONTROL.
  4488             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  85
* EL152.cbl
  4489                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4490                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4491                                                ' ' LOW-VALUES.
  4492                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4493                                               VALUE '3'.
  4494         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4495         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4496         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4497             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4498                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4499             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4500                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4501             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4502                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4503             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4504                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4505             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4506                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4507             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4508                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4509         16  CF-MORTG-BILLING-AREA.
  4510             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4511                                            PIC X.
  4512         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4513         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4514         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4515         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4516             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4517             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4518         16  FILLER                         PIC X.
  4519         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4520             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4521             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4522         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4523         16  FILLER                         PIC X(8).
  4524         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4525         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4526         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4527         16  CF-ACH-COMPANY-ID.
  4528             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4529                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4530                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4531                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4532             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4533         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4534             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4535         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4536             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4537             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4538         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4539         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4540         16  FILLER                         PIC X(536).
  4541
  4542****************************************************************
  4543*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4544****************************************************************
  4545
  4546     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  86
* EL152.cbl
  4547         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4548             20  CF-FEMALE-HEIGHT.
  4549                 24  CF-FEMALE-FT           PIC 99.
  4550                 24  CF-FEMALE-IN           PIC 99.
  4551             20  CF-FEMALE-MIN-WT           PIC 999.
  4552             20  CF-FEMALE-MAX-WT           PIC 999.
  4553         16  FILLER                         PIC X(428).
  4554
  4555     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4556         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4557             20  CF-MALE-HEIGHT.
  4558                 24  CF-MALE-FT             PIC 99.
  4559                 24  CF-MALE-IN             PIC 99.
  4560             20  CF-MALE-MIN-WT             PIC 999.
  4561             20  CF-MALE-MAX-WT             PIC 999.
  4562         16  FILLER                         PIC X(428).
  4563******************************************************************
  4564*             AUTOMATIC ACTIVITY RECORD                          *
  4565******************************************************************
  4566     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4567         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4568             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4569             20  CF-SYS-LETTER-ID           PIC X(04).
  4570             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4571             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4572             20  CF-SYS-RESET-SW            PIC X(01).
  4573             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4574             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4575
  4576         16  FILLER                         PIC X(50).
  4577
  4578         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4579             20  CF-USER-ACTIVE-SW          PIC X(01).
  4580             20  CF-USER-LETTER-ID          PIC X(04).
  4581             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4582             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4583             20  CF-USER-RESET-SW           PIC X(01).
  4584             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4585             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4586             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4587
  4588         16  FILLER                         PIC X(246).
  4589
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  87
* EL152.cbl
  4591*                                COPY ELCARCH.
  4592******************************************************************
  4593*                                                                *
  4594*                            ELCARCH.                            *
  4595*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4596*                            VMOD=2.007                          *
  4597*                                                                *
  4598*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4599*                                                                *
  4600*   FILE TYPE = VSAM,KSDS                                        *
  4601*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4602*                                                                *
  4603*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  4604*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  4605*                                                                *
  4606*   LOG = NO                                                     *
  4607*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4608*                                                                *
  4609*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  4610******************************************************************
  4611 01  LETTER-ARCHIVE.
  4612     12  LA-RECORD-ID                PIC XX.
  4613         88  VALID-LA-ID                VALUE 'LA'.
  4614
  4615     12  LA-CONTROL-PRIMARY.
  4616         16  LA-COMPANY-CD           PIC X.
  4617         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  4618         16  LA-RECORD-TYPE          PIC X.
  4619             88  LA-HEADER-DATA         VALUE '1'.
  4620             88  LA-ADDRESS-DATA        VALUE '2'.
  4621             88  LA-TEXT-DATA           VALUE '3'.
  4622             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  4623         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  4624
  4625     12  LA-CONTROL-BY-TYPE.
  4626         16  LA-COMPANY-CD-A1        PIC X.
  4627         16  LA-RECORD-TYPE-A1       PIC X.
  4628         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4629         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4630
  4631     12  LA-TEXT-RECORD.
  4632         16  LA-SKIP-CONTROL         PIC XX.
  4633             88  NO-LINES-SKIPPED       VALUE SPACES.
  4634             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  4635         16  LA-TEXT-LINE            PIC X(70).
  4636
  4637     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  4638         16  FILLER                  PIC XX.
  4639         16  LA-ADDRESS-LINE         PIC X(30).
  4640         16  FILLER                  PIC X(40).
  4641
  4642     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  4643         16  FILLER                  PIC XX.
  4644         16  LA-CARRIER              PIC X.
  4645         16  LA-CLAIM-NO             PIC X(7).
  4646         16  LA-CERT-NO.
  4647             20  LA-CERT-PRIME       PIC X(10).
  4648             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  88
* EL152.cbl
  4649         16  LA-NO-OF-COPIES         PIC S9.
  4650         16  LA-RESEND-DATE          PIC XX.
  4651         16  LA-PROCESSOR-CD         PIC X(4).
  4652         16  LA-CREATION-DT          PIC XX.
  4653         16  LA-INITIAL-PRINT-DATE   PIC XX.
  4654         16  LA-RESEND-PRINT-DATE    PIC XX.
  4655         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4656         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  4657*
  4658* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  4659*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  4660*   I        20  LA-DMD-PROD-CODE        PIC XX.
  4661*   I        20  LA-DMD-RES-ST           PIC XX.
  4662*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4663*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  4664*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  4665*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  4666*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  4667*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  4668*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  4669*   I        20  LA-DMD-UND-CODE         PIC XX.
  4670*   I        20  LA-DMD-BEN-CODE         PIC XX.
  4671*   V    16  FILLER                  PIC X(15).
  4672* -----
  4673*
  4674* REINSERTED  CSO  MODS
  4675*
  4676         16  FILLER.
  4677             20  FILLER                  PIC X(29).
  4678             20  LA-CSO-LETTER-STATUS    PIC X.
  4679                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  4680                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  4681                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  4682             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  4683             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  4684*
  4685
  4686     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  4687         16  FILLER                  PIC XX.
  4688         16  LA4-CARRIER             PIC X.
  4689         16  LA4-CLAIM-NO            PIC X(7).
  4690         16  LA4-CERT-NO.
  4691             20  LA4-CERT-PRIME      PIC X(10).
  4692             20  LA4-CERT-SFX        PIC X.
  4693         16  LA4-NO-OF-COPIES        PIC S9.
  4694         16  LA4-RESEND-DATE         PIC XX.
  4695         16  LA4-PROCESSOR-CD        PIC X(4).
  4696         16  LA4-CREATION-DT         PIC XX.
  4697         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  4698         16  LA4-RESEND-PRINT-DATE   PIC XX.
  4699         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4700         16  LA4-FORM-TYPE           PIC X.
  4701             88  LA4-INITIAL-FORM    VALUE '1'.
  4702             88  LA4-PROGRESS-FORM   VALUE '2'.
  4703         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  4704         16  LA4-STATE               PIC X(02).
  4705         16  FILLER                  PIC X(31).
  4706******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  89
* EL152.cbl
  4707
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  90
* EL152.cbl
  4709*                                COPY ELCARCT.
  4710******************************************************************
  4711*                                                                *
  4712*                            ELCARCT.                            *
  4713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4714*                            VMOD=2.003                          *
  4715*                                                                *
  4716*   FILE DESCRIPTION = TEMPORARY LETTER ARCHIVE FILE             *
  4717*                                                                *
  4718*   FILE TYPE = VSAM,KSDS                                        *
  4719*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4720*                                                                *
  4721*   BASE CLUSTER = ELARCT                        RKP=2,LEN=8     *
  4722*       ALTERNATE PATH1 = ELARCT2  (RECORD TYPE) RKP=10,LEN=8    *
  4723*                                                                *
  4724*   LOG = NO                                                     *
  4725*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4726*                                                                *
  4727*  NO  CID  MODS  IN  COPYBOOK  ELCARCT                          *
  4728******************************************************************
  4729 01  LETTER-ARCHIVE-TEMP.
  4730     12  LT-RECORD-ID                PIC XX.
  4731         88  VALID-LT-ID                VALUE 'LT'.
  4732
  4733     12  LT-CONTROL-PRIMARY.
  4734         16  LT-COMPANY-CD           PIC X.
  4735         16  LT-ARCHIVE-NO           PIC S9(8)     COMP.
  4736         16  LT-RECORD-TYPE          PIC X.
  4737             88  LT-HEADER-DATA         VALUE '1'.
  4738             88  LT-ADDRESS-DATA        VALUE '2'.
  4739             88  LT-TEXT-DATA           VALUE '3'.
  4740             88  LT-FORM-CONTROL-HDR    VALUE '4'.
  4741         16  LT-LINE-SEQ-NO          PIC S9(4)     COMP.
  4742
  4743     12  LT-CONTROL-BY-TYPE.
  4744         16  LT-COMPANY-CD-A1        PIC X.
  4745         16  LT-RECORD-TYPE-A1       PIC X.
  4746         16  LT-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4747         16  LT-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4748
  4749     12  LT-TEXT-RECORD.
  4750         16  LT-SKIP-CONTROL         PIC XX.
  4751         16  LT-TEXT-LINE            PIC X(70).
  4752
  4753     12  LT-ADDRESS-RECORD  REDEFINES  LT-TEXT-RECORD.
  4754         16  FILLER                  PIC XX.
  4755         16  LT-ADDRESS-LINE         PIC X(30).
  4756         16  FILLER                  PIC X(40).
  4757
  4758     12  LT-HEADER-RECORD  REDEFINES  LT-TEXT-RECORD.
  4759         16  FILLER                  PIC XX.
  4760         16  LT-CARRIER              PIC X.
  4761         16  LT-CLAIM-NO             PIC X(7).
  4762         16  LT-CERT-NO.
  4763             20  LT-CERT-PRIME       PIC X(10).
  4764             20  LT-CERT-SFX         PIC X.
  4765         16  LT-NO-OF-COPIES         PIC S9.
  4766         16  LT-RESEND-DATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  91
* EL152.cbl
  4767         16  LT-PROCESSOR-CD         PIC X(4).
  4768         16  LT-CREATION-DT          PIC XX.
  4769         16  LT-INITIAL-PRINT-DATE   PIC XX.
  4770         16  LT-RESEND-PRINT-DATE    PIC XX.
  4771         16  LT-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4772         16  LT-1ST-RESEND-PRINT-DT  PIC XX.
  4773         16  LT-DMD-ADDITIONAL-FIELDS.
  4774             20  LT-DMD-LETTER-FORM      PIC X(4).
  4775             20  LT-DMD-PROD-CODE        PIC XX.
  4776             20  LT-DMD-RES-ST           PIC XX.
  4777             20  LT-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4778             20  LT-DMD-LETTER-STATUS    PIC X.
  4779                 88  LT-DMD-LETTER-ONLINE   VALUE '1'.
  4780                 88  LT-DMD-LETTER-PURGED   VALUE '2'.
  4781                 88  LT-DMD-LETTER-RELOADED VALUE '3'.
  4782             20  LT-DMD-LETTER-PURGE-DT  PIC XX.
  4783             20  LT-DMD-LETTER-RELOAD-DT PIC XX.
  4784             20  LT-DMD-UND-CODE         PIC XX.
  4785             20  LT-DMD-BEN-CODE         PIC XX.
  4786         16  FILLER                  PIC X(15).
  4787
  4788     12  LT-FORM-CONTROL-HEADER REDEFINES  LT-TEXT-RECORD.
  4789         16  FILLER                  PIC XX.
  4790         16  LT4-CARRIER             PIC X.
  4791         16  LT4-CLAIM-NO            PIC X(7).
  4792         16  LT4-CERT-NO.
  4793             20  LT4-CERT-PRIME      PIC X(10).
  4794             20  LT4-CERT-SFX        PIC X.
  4795         16  LT4-NO-OF-COPIES        PIC S9.
  4796         16  LT4-RESEND-DATE         PIC XX.
  4797         16  LT4-PROCESSOR-CD        PIC X(4).
  4798         16  LT4-CREATION-DT         PIC XX.
  4799         16  LT4-INITIAL-PRINT-DATE  PIC XX.
  4800         16  LT4-RESEND-PRINT-DATE   PIC XX.
  4801         16  LT4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4802         16  LT4-FORM-TYPE           PIC X.
  4803             88  LT4-INITIAL-FORM    VALUE '1'.
  4804             88  LT4-PROGRESS-FORM   VALUE '2'.
  4805         16  LT4-FORM-REM-PRINT-DT   PIC XX.
  4806         16  LT4-STATE               PIC XX.
  4807         16  FILLER                  PIC X(31).
  4808******************************************************************
  4809
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  92
* EL152.cbl
  4811*                                COPY ELCCERT.
  4812******************************************************************
  4813*                                                                *
  4814*                            ELCCERT.                            *
  4815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4816*                            VMOD=2.013                          *
  4817*                                                                *
  4818*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4819*                                                                *
  4820*   FILE TYPE = VSAM,KSDS                                        *
  4821*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4822*                                                                *
  4823*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4824*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4825*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4826*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4827*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4828*                                                                *
  4829*   LOG = YES                                                    *
  4830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4831******************************************************************
  4832*                   C H A N G E   L O G
  4833*
  4834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4835*-----------------------------------------------------------------
  4836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4837* EFFECTIVE    NUMBER
  4838*-----------------------------------------------------------------
  4839* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4840* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4841* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4842* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4843* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4844* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4845* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4846* 032612  CR2011110200001  PEMA  AHL CHANGES
  4847******************************************************************
  4848
  4849 01  CERTIFICATE-MASTER.
  4850     12  CM-RECORD-ID                      PIC XX.
  4851         88  VALID-CM-ID                      VALUE 'CM'.
  4852
  4853     12  CM-CONTROL-PRIMARY.
  4854         16  CM-COMPANY-CD                 PIC X.
  4855         16  CM-CARRIER                    PIC X.
  4856         16  CM-GROUPING.
  4857             20  CM-GROUPING-PREFIX        PIC X(3).
  4858             20  CM-GROUPING-PRIME         PIC X(3).
  4859         16  CM-STATE                      PIC XX.
  4860         16  CM-ACCOUNT.
  4861             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4862             20  CM-ACCOUNT-PRIME          PIC X(6).
  4863         16  CM-CERT-EFF-DT                PIC XX.
  4864         16  CM-CERT-NO.
  4865             20  CM-CERT-PRIME             PIC X(10).
  4866             20  CM-CERT-SFX               PIC X.
  4867
  4868     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  93
* EL152.cbl
  4869         16  CM-COMPANY-CD-A1              PIC X.
  4870         16  CM-INSURED-LAST-NAME          PIC X(15).
  4871         16  CM-INSURED-INITIALS.
  4872             20  CM-INSURED-INITIAL1       PIC X.
  4873             20  CM-INSURED-INITIAL2       PIC X.
  4874
  4875     12  CM-CONTROL-BY-SSN.
  4876         16  CM-COMPANY-CD-A2              PIC X.
  4877         16  CM-SOC-SEC-NO.
  4878             20  CM-SSN-STATE              PIC XX.
  4879             20  CM-SSN-ACCOUNT            PIC X(6).
  4880             20  CM-SSN-LN3.
  4881                 25  CM-INSURED-INITIALS-A2.
  4882                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4883                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4884                 25 CM-PART-LAST-NAME-A2         PIC X.
  4885
  4886     12  CM-CONTROL-BY-CERT-NO.
  4887         16  CM-COMPANY-CD-A4              PIC X.
  4888         16  CM-CERT-NO-A4                 PIC X(11).
  4889
  4890     12  CM-CONTROL-BY-MEMB.
  4891         16  CM-COMPANY-CD-A5              PIC X.
  4892         16  CM-MEMBER-NO.
  4893             20  CM-MEMB-STATE             PIC XX.
  4894             20  CM-MEMB-ACCOUNT           PIC X(6).
  4895             20  CM-MEMB-LN4.
  4896                 25  CM-INSURED-INITIALS-A5.
  4897                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4898                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4899                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4900
  4901     12  CM-INSURED-PROFILE-DATA.
  4902         16  CM-INSURED-FIRST-NAME.
  4903             20  CM-INSURED-1ST-INIT       PIC X.
  4904             20  FILLER                    PIC X(9).
  4905         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4906         16  CM-INSURED-SEX                PIC X.
  4907             88  CM-SEX-MALE                  VALUE 'M'.
  4908             88  CM-SEX-FEMAL                 VALUE 'F'.
  4909         16  CM-INSURED-JOINT-AGE          PIC 99.
  4910         16  CM-JOINT-INSURED-NAME.
  4911             20  CM-JT-LAST-NAME           PIC X(15).
  4912             20  CM-JT-FIRST-NAME.
  4913                 24  CM-JT-1ST-INIT        PIC X.
  4914                 24  FILLER                PIC X(9).
  4915             20  CM-JT-INITIAL             PIC X.
  4916
  4917     12  CM-LIFE-DATA.
  4918         16  CM-LF-BENEFIT-CD              PIC XX.
  4919         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4920         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4921         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4922         16  CM-LF-DEV-CODE                PIC XXX.
  4923         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4924         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4925         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4926         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  94
* EL152.cbl
  4927         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4928         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4929         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4930         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4931         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4932         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4933         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4934         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4935         16  FILLER                        PIC XX.
  4936
  4937     12  CM-AH-DATA.
  4938         16  CM-AH-BENEFIT-CD              PIC XX.
  4939         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4940         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4941         16  CM-AH-DEV-CODE                PIC XXX.
  4942         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4943         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4944         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4945         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4946         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4947         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4948         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4949         16  CM-AH-PAID-THRU-DT            PIC XX.
  4950             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4951         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4952         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4953         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4954         16  FILLER                        PIC X.
  4955
  4956     12  CM-LOAN-INFORMATION.
  4957         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4958         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4959                                           PIC S9(5)V99  COMP-3.
  4960         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4961         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4962         16  CM-PAY-FREQUENCY              PIC S99.
  4963         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4964         16  CM-RATE-CLASS                 PIC XX.
  4965         16  CM-BENEFICIARY                PIC X(25).
  4966         16  CM-POLICY-FORM-NO             PIC X(12).
  4967         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4968         16  CM-LAST-ADD-ON-DT             PIC XX.
  4969         16  CM-DEDUCTIBLE-AMOUNTS.
  4970             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4971             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4972         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4973             20  CM-RESIDENT-STATE         PIC XX.
  4974             20  CM-RATE-CODE              PIC X(4).
  4975             20  FILLER                    PIC XX.
  4976         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4977             20  CM-LOAN-OFFICER           PIC X(5).
  4978             20  FILLER                    PIC XXX.
  4979         16  CM-CSR-CODE                   PIC XXX.
  4980         16  CM-UNDERWRITING-CODE          PIC X.
  4981             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4982         16  CM-POST-CARD-IND              PIC X.
  4983         16  CM-NH-INTERFACE-SW            PIC X.
  4984         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  95
* EL152.cbl
  4985             88  CM-SING-PRM                  VALUE '1'.
  4986             88  CM-O-B-COVERAGE              VALUE '2'.
  4987             88  CM-OPEN-END                  VALUE '3'.
  4988         16  CM-IND-GRP-TYPE               PIC X.
  4989             88  CM-INDIVIDUAL                VALUE 'I'.
  4990             88  CM-GROUP                     VALUE 'G'.
  4991         16  CM-SKIP-CODE                  PIC X.
  4992             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4993             88  SKIP-JULY                    VALUE '1'.
  4994             88  SKIP-AUGUST                  VALUE '2'.
  4995             88  SKIP-SEPTEMBER               VALUE '3'.
  4996             88  SKIP-JULY-AUG                VALUE '4'.
  4997             88  SKIP-AUG-SEPT                VALUE '5'.
  4998             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4999             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5000             88  SKIP-JUNE                    VALUE '8'.
  5001             88  SKIP-JUNE-JULY               VALUE '9'.
  5002             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5003             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5004         16  CM-PAYMENT-MODE               PIC X.
  5005             88  PAY-MONTHLY                  VALUE SPACE.
  5006             88  PAY-WEEKLY                   VALUE '1'.
  5007             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5008             88  PAY-BI-WEEKLY                VALUE '3'.
  5009             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5010         16  CM-LOAN-NUMBER                PIC X(8).
  5011         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5012         16  CM-OLD-LOF                    PIC XXX.
  5013*        16  CM-LOAN-OFFICER               PIC XXX.
  5014         16  CM-REIN-TABLE                 PIC XXX.
  5015         16  CM-SPECIAL-REIN-CODE          PIC X.
  5016         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5017         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5018         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5019
  5020     12  CM-STATUS-DATA.
  5021         16  CM-ENTRY-STATUS               PIC X.
  5022         16  CM-ENTRY-DT                   PIC XX.
  5023
  5024         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5025         16  CM-LF-CANCEL-DT               PIC XX.
  5026         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5027
  5028         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5029         16  CM-LF-DEATH-DT                PIC XX.
  5030         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5031
  5032         16  CM-LF-CURRENT-STATUS          PIC X.
  5033             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5034                                                'M' '4' '5' '9'.
  5035             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5036             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5037             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5038             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5039             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5040             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5041             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5042             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  96
* EL152.cbl
  5043             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5044             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5045             88  CM-LF-DECLINED               VALUE 'D'.
  5046             88  CM-LF-VOIDED                 VALUE 'V'.
  5047
  5048         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5049         16  CM-AH-CANCEL-DT               PIC XX.
  5050         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5051
  5052         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5053         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5054         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5055
  5056         16  CM-AH-CURRENT-STATUS          PIC X.
  5057             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5058                                                'M' '4' '5' '9'.
  5059             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5060             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5061             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5062             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5063             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5064             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5065             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5066             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5067             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5068             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5069             88  CM-AH-DECLINED               VALUE 'D'.
  5070             88  CM-AH-VOIDED                 VALUE 'V'.
  5071
  5072         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5073             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5074             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5075             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5076         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5077
  5078         16  CM-ENTRY-BATCH                PIC X(6).
  5079         16  CM-LF-EXIT-BATCH              PIC X(6).
  5080         16  CM-AH-EXIT-BATCH              PIC X(6).
  5081         16  CM-LAST-MONTH-END             PIC XX.
  5082
  5083     12  CM-NOTE-SW                        PIC X.
  5084         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5085         88  CERT-NOTES-PRESENT               VALUE '1'.
  5086         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5087         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5088         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5089         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5090         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5091         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5092     12  CM-COMP-EXCP-SW                   PIC X.
  5093         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5094         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5095     12  CM-INSURED-ADDRESS-SW             PIC X.
  5096         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5097         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5098
  5099*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5100     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  97
* EL152.cbl
  5101     12  FILLER                            PIC X.
  5102
  5103*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5104     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5105     12  FILLER                            PIC X.
  5106*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5107     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5108
  5109     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5110         88  CERT-ADDED-BATCH                 VALUE ' '.
  5111         88  CERT-ADDED-ONLINE                VALUE '1'.
  5112         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5113         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5114         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5115     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5116         88  CERT-AS-LOADED                   VALUE ' '.
  5117         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5118         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5119         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5120         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5121         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5122         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5123         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5124
  5125     12  CM-ACCOUNT-COMM-PCTS.
  5126         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5127         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5128
  5129     12  CM-USER-FIELD                     PIC X.
  5130     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5131     12  CM-CLP-STATE                      PIC XX.
  5132     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5133     12  CM-USER-RESERVED                  PIC XXX.
  5134     12  FILLER REDEFINES CM-USER-RESERVED.
  5135         16  CM-AH-CLASS-CD                PIC XX.
  5136         16  F                             PIC X.
  5137******************************************************************
  5138
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  98
* EL152.cbl
  5140*                                COPY ERCACCT.
  5141******************************************************************
  5142*                                                                *
  5143*                                                                *
  5144*                            ERCACCT                             *
  5145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5146*                            VMOD=2.031                          *
  5147*                                                                *
  5148*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5149*                                                                *
  5150*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5151*   VSAM ACCOUNT MASTER FILES.                                   *
  5152*                                                                *
  5153*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5154*                                                                *
  5155*   FILE TYPE = VSAM,KSDS                                        *
  5156*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5157*                                                                *
  5158*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5159*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5160*                                                                *
  5161*   LOG = NO                                                     *
  5162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5163*                                                                *
  5164*                                                                *
  5165******************************************************************
  5166*                   C H A N G E   L O G
  5167*
  5168* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5169*-----------------------------------------------------------------
  5170*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5171* EFFECTIVE    NUMBER
  5172*-----------------------------------------------------------------
  5173* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5174* 092705    2005050300006  PEMA  ADD SPP LEASES
  5175* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5176* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5177* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5178* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5179* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5180******************************************************************
  5181
  5182 01  ACCOUNT-MASTER.
  5183     12  AM-RECORD-ID                      PIC XX.
  5184         88  VALID-AM-ID                      VALUE 'AM'.
  5185
  5186     12  AM-CONTROL-PRIMARY.
  5187         16  AM-COMPANY-CD                 PIC X.
  5188         16  AM-MSTR-CNTRL.
  5189             20  AM-CONTROL-A.
  5190                 24  AM-CARRIER            PIC X.
  5191                 24  AM-GROUPING.
  5192                     28 AM-GROUPING-PREFIX PIC XXX.
  5193                     28 AM-GROUPING-PRIME  PIC XXX.
  5194                 24  AM-STATE              PIC XX.
  5195                 24  AM-ACCOUNT.
  5196                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5197                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  99
* EL152.cbl
  5198             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5199                                           PIC X(19).
  5200             20  AM-CNTRL-B.
  5201                 24  AM-EXPIRATION-DT      PIC XX.
  5202                 24  FILLER                PIC X(4).
  5203             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5204                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5205
  5206     12  AM-CONTROL-BY-VAR-GRP.
  5207         16  AM-COMPANY-CD-A1              PIC X.
  5208         16  AM-VG-CARRIER                 PIC X.
  5209         16  AM-VG-GROUPING                PIC X(6).
  5210         16  AM-VG-STATE                   PIC XX.
  5211         16  AM-VG-ACCOUNT                 PIC X(10).
  5212         16  AM-VG-DATE.
  5213             20  AM-VG-EXPIRATION-DT       PIC XX.
  5214             20  FILLER                    PIC X(4).
  5215         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5216                                           PIC 9(11)      COMP-3.
  5217     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5218         16  FILLER                        PIC X(10).
  5219         16  AM-VG-KEY3.
  5220             20  AM-VG3-ACCOUNT            PIC X(10).
  5221             20  AM-VG3-EXP-DT             PIC XX.
  5222         16  FILLER                        PIC X(4).
  5223     12  AM-MAINT-INFORMATION.
  5224         16  AM-LAST-MAINT-DT              PIC XX.
  5225         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5226         16  AM-LAST-MAINT-USER            PIC X(4).
  5227         16  FILLER                        PIC XX.
  5228
  5229     12  AM-EFFECTIVE-DT                   PIC XX.
  5230     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5231
  5232     12  AM-PREV-DATES  COMP-3.
  5233         16  AM-PREV-EXP-DT                PIC 9(11).
  5234         16  AM-PREV-EFF-DT                PIC 9(11).
  5235
  5236     12  AM-REPORT-CODE-1                  PIC X(10).
  5237     12  AM-REPORT-CODE-2                  PIC X(10).
  5238
  5239     12  AM-CITY-CODE                      PIC X(4).
  5240     12  AM-COUNTY-PARISH                  PIC X(6).
  5241
  5242     12  AM-NAME                           PIC X(30).
  5243     12  AM-PERSON                         PIC X(30).
  5244     12  AM-ADDRS                          PIC X(30).
  5245     12  AM-CITY.
  5246         16  AM-ADDR-CITY                  PIC X(28).
  5247         16  AM-ADDR-STATE                 PIC XX.
  5248     12  AM-ZIP.
  5249         16  AM-ZIP-PRIME.
  5250             20  AM-ZIP-PRI-1ST            PIC X.
  5251                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5252             20  FILLER                    PIC X(4).
  5253         16  AM-ZIP-PLUS4                  PIC X(4).
  5254     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5255         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 100
* EL152.cbl
  5256         16  AM-CAN-POSTAL-2               PIC XXX.
  5257         16  FILLER                        PIC XXX.
  5258     12  AM-TEL-NO.
  5259         16  AM-AREA-CODE                  PIC 999.
  5260         16  AM-TEL-PRE                    PIC 999.
  5261         16  AM-TEL-NBR                    PIC 9(4).
  5262     12  AM-TEL-LOC                        PIC X.
  5263         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5264         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5265
  5266     12  AM-COMM-STRUCTURE.
  5267         16  AM-DEFN-1.
  5268             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5269                 24  AM-AGT.
  5270                     28  AM-AGT-PREFIX     PIC X(4).
  5271                     28  AM-AGT-PRIME      PIC X(6).
  5272                 24  AM-COM-TYP            PIC X.
  5273                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5274                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5275                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5276                 24  AM-RECALC-LV-INDIC    PIC X.
  5277                 24  AM-RETRO-LV-INDIC     PIC X.
  5278                 24  AM-GL-CODES           PIC X.
  5279                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5280                 24  FILLER                PIC X(01).
  5281         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5282             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5283                 24  FILLER                PIC X(11).
  5284                 24  AM-L-COMA             PIC XXX.
  5285                 24  AM-J-COMA             PIC XXX.
  5286                 24  AM-A-COMA             PIC XXX.
  5287                 24  FILLER                PIC X(6).
  5288
  5289     12  AM-COMM-CHANGE-STATUS             PIC X.
  5290         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5291
  5292     12  AM-CSR-CODE                       PIC X(4).
  5293
  5294     12  AM-BILLING-STATUS                 PIC X.
  5295         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5296         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5297     12  AM-AUTO-REFUND-SW                 PIC X.
  5298         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5299         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5300     12  AM-GPCD                           PIC 99.
  5301     12  AM-IG                             PIC X.
  5302         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5303         88  AM-HAS-GROUP                     VALUE '2'.
  5304     12  AM-STATUS                         PIC X.
  5305         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5306         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5307         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5308         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5309         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5310         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5311     12  AM-REMIT-TO                       PIC 99.
  5312     12  AM-ID-NO                          PIC X(11).
  5313
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 101
* EL152.cbl
  5314     12  AM-CAL-TABLE                      PIC XX.
  5315     12  AM-LF-DEVIATION                   PIC XXX.
  5316     12  AM-AH-DEVIATION                   PIC XXX.
  5317     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5318     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5319     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5320     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5321     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5322     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5323
  5324     12  AM-USER-FIELDS.
  5325         16  AM-FLD-1                      PIC XX.
  5326         16  AM-FLD-2                      PIC XX.
  5327         16  AM-FLD-3                      PIC XX.
  5328         16  AM-FLD-4                      PIC XX.
  5329         16  AM-FLD-5                      PIC XX.
  5330
  5331     12  AM-1ST-PROD-DATE.
  5332         16  AM-1ST-PROD-YR                PIC XX.
  5333         16  AM-1ST-PROD-MO                PIC XX.
  5334         16  AM-1ST-PROD-DA                PIC XX.
  5335     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5336     12  AM-CERTS-PURGED-DATE.
  5337         16  AM-PUR-YR                     PIC XX.
  5338         16  AM-PUR-MO                     PIC XX.
  5339         16  AM-PUR-DA                     PIC XX.
  5340     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5341     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5342     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5343     12  AM-INACTIVE-DATE.
  5344         16  AM-INA-MO                     PIC 99.
  5345         16  AM-INA-DA                     PIC 99.
  5346         16  AM-INA-YR                     PIC 99.
  5347     12  AM-AR-HI-CERT-DATE                PIC XX.
  5348
  5349     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5350     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5351
  5352     12  AM-OB-PAYMENT-MODE                PIC X.
  5353         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5354         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5355         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5356         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5357
  5358     12  AM-AH-ONLY-INDICATOR              PIC X.
  5359         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5360         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5361
  5362     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5363
  5364     12  AM-OVER-SHORT.
  5365         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5366         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5367
  5368     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5369     12  AM-DCC-CLP-STATE                  PIC XX.
  5370
  5371     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 102
* EL152.cbl
  5372     12  AM-RECALC-REIN                    PIC X.
  5373
  5374     12  AM-REI-TABLE                      PIC XXX.
  5375     12  AM-REI-ET-LF                      PIC X.
  5376     12  AM-REI-ET-AH                      PIC X.
  5377     12  AM-REI-PE-LF                      PIC X.
  5378     12  AM-REI-PE-AH                      PIC X.
  5379     12  AM-REI-PRT-ST                     PIC X.
  5380     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5381     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5382     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5383     12  AM-REI-GROUP-A                    PIC X(6).
  5384     12  AM-REI-MORT                       PIC X(4).
  5385     12  AM-REI-PRT-OW                     PIC X.
  5386     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5387     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5388     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5389     12  AM-REI-GROUP-B                    PIC X(6).
  5390
  5391     12  AM-TRUST-TYPE                     PIC X(2).
  5392
  5393     12  AM-EMPLOYER-STMT-USED             PIC X.
  5394     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5395
  5396     12  AM-STD-AH-TYPE                    PIC XX.
  5397     12  AM-EARN-METHODS.
  5398         16  AM-EARN-METHOD-R              PIC X.
  5399             88 AM-REF-RL-R78                 VALUE 'R'.
  5400             88 AM-REF-RL-PR                  VALUE 'P'.
  5401             88 AM-REF-RL-MEAN                VALUE 'M'.
  5402             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5403         16  AM-EARN-METHOD-L              PIC X.
  5404             88 AM-REF-LL-R78                 VALUE 'R'.
  5405             88 AM-REF-LL-PR                  VALUE 'P'.
  5406             88 AM-REF-LL-MEAN                VALUE 'M'.
  5407             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5408         16  AM-EARN-METHOD-A              PIC X.
  5409             88 AM-REF-AH-R78                 VALUE 'R'.
  5410             88 AM-REF-AH-PR                  VALUE 'P'.
  5411             88 AM-REF-AH-MEAN                VALUE 'M'.
  5412             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5413             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5414             88 AM-REF-AH-NET                 VALUE 'N'.
  5415
  5416     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5417     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5418     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5419
  5420     12  AM-RET-Y-N                        PIC X.
  5421     12  AM-RET-P-E                        PIC X.
  5422     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5423     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5424     12  AM-RET-GRP                        PIC X(6).
  5425     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5426         16  AM-POOL-PRIME                 PIC XXX.
  5427         16  AM-POOL-SUB                   PIC XXX.
  5428     12  AM-RETRO-EARNINGS.
  5429         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 103
* EL152.cbl
  5430         16  AM-RET-EARN-L                 PIC X.
  5431         16  AM-RET-EARN-A                 PIC X.
  5432     12  AM-RET-ST-TAX-USE                 PIC X.
  5433         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5434         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5435     12  AM-RETRO-BEG-EARNINGS.
  5436         16  AM-RET-BEG-EARN-R             PIC X.
  5437         16  AM-RET-BEG-EARN-L             PIC X.
  5438         16  AM-RET-BEG-EARN-A             PIC X.
  5439     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5440     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5441
  5442     12  AM-USER-SELECT-OPTIONS.
  5443         16  AM-USER-SELECT-1              PIC X(10).
  5444         16  AM-USER-SELECT-2              PIC X(10).
  5445         16  AM-USER-SELECT-3              PIC X(10).
  5446         16  AM-USER-SELECT-4              PIC X(10).
  5447         16  AM-USER-SELECT-5              PIC X(10).
  5448
  5449     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5450
  5451     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5452
  5453     12  AM-RPT045A-SWITCH                 PIC X.
  5454         88  RPT045A-OFF                   VALUE 'N'.
  5455
  5456     12  AM-INSURANCE-LIMITS.
  5457         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5458         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5459
  5460     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5461         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5462
  5463     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5464         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5465         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5466
  5467     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5468
  5469     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5470     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5471     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5472     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5473     12  AM-DCC-UEF-STATE                  PIC XX.
  5474     12  FILLER                            PIC XXX.
  5475     12  AM-REPORT-CODE-3                  PIC X(10).
  5476*    12  FILLER                            PIC X(22).
  5477
  5478     12  AM-RESERVE-DATE.
  5479         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5480         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5481         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5482
  5483     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5484     12  AM-NOTIFICATION-TYPES.
  5485         16  AM-NOTIF-OF-LETTERS           PIC X.
  5486         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5487         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 104
* EL152.cbl
  5488         16  AM-NOTIF-OF-STATUS            PIC X.
  5489
  5490     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5491         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5492         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5493         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5494         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5495
  5496     12  AM-BENEFIT-CONTROLS.
  5497         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5498             20  AM-BENEFIT-CODE           PIC XX.
  5499             20  AM-BENEFIT-TYPE           PIC X.
  5500             20  AM-BENEFIT-REVISION       PIC XXX.
  5501             20  AM-BENEFIT-REM-TERM       PIC X.
  5502             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5503             20  FILLER                    PIC XX.
  5504         16  FILLER                        PIC X(80).
  5505
  5506     12  AM-TRANSFER-DATA.
  5507         16  AM-TRANSFERRED-FROM.
  5508             20  AM-TRNFROM-CARRIER        PIC X.
  5509             20  AM-TRNFROM-GROUPING.
  5510                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5511                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5512             20  AM-TRNFROM-STATE          PIC XX.
  5513             20  AM-TRNFROM-ACCOUNT.
  5514                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5515                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5516             20  AM-TRNFROM-DTE            PIC XX.
  5517         16  AM-TRANSFERRED-TO.
  5518             20  AM-TRNTO-CARRIER          PIC X.
  5519             20  AM-TRNTO-GROUPING.
  5520                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5521                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5522             20  AM-TRNTO-STATE            PIC XX.
  5523             20  AM-TRNTO-ACCOUNT.
  5524                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5525                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5526             20  AM-TRNTO-DTE              PIC XX.
  5527         16  FILLER                        PIC X(10).
  5528
  5529     12  AM-SAVED-REMIT-TO                 PIC 99.
  5530
  5531     12  AM-COMM-STRUCTURE-SAVED.
  5532         16  AM-DEFN-1-SAVED.
  5533             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5534                 24  AM-AGT-SV             PIC X(10).
  5535                 24  AM-COM-TYP-SV         PIC X.
  5536                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5537                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5538                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5539                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5540                 24  FILLER                PIC X.
  5541                 24  AM-GL-CODES-SV        PIC X.
  5542                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5543                 24  FILLER                PIC X.
  5544         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5545             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 105
* EL152.cbl
  5546                 24  FILLER                PIC X(11).
  5547                 24  AM-L-COMA-SV          PIC XXX.
  5548                 24  AM-J-COMA-SV          PIC XXX.
  5549                 24  AM-A-COMA-SV          PIC XXX.
  5550                 24  FILLER                PIC X(6).
  5551
  5552     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5553         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5554            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5555            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5556            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5557
  5558     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5559     12  FILLER                            PIC X(120).
  5560
  5561     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5562         16  AM-CONTROL-NAME               PIC X(30).
  5563         16  AM-EXECUTIVE-ONE.
  5564             20  AM-EXEC1-NAME             PIC X(15).
  5565             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5566                                                          COMP-3.
  5567             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5568                                                          COMP-3.
  5569         16  AM-EXECUTIVE-TWO.
  5570             20  AM-EXEC2-NAME             PIC X(15).
  5571             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5572                                                          COMP-3.
  5573             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5574                                                          COMP-3.
  5575
  5576     12  AM-RETRO-ADDITIONAL-DATA.
  5577         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5578         16  AM-RETRO-PREM-P-E             PIC X.
  5579         16  AM-RETRO-CLMS-P-I             PIC X.
  5580         16  AM-RETRO-RET-BRACKET-LF.
  5581             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5582                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5583                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5584             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5585                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5586                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5587             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5588                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5589                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5590         16  AM-RETRO-RET-BRACKET-AH.
  5591             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5592                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5593                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5594                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5595             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5596                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5597                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5598             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5599                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5600                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5601
  5602     12  AM-COMMENTS.
  5603         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 106
* EL152.cbl
  5604
  5605     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5606         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5607         16  AM-FLI-BILLING-CODE           PIC X.
  5608         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5609         16  AM-FLI-UNITED-IDENT           PIC X.
  5610         16  AM-FLI-INTEREST-LOST-DATA.
  5611             20  AM-FLI-BANK-NO            PIC X(5).
  5612             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5613             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5614             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5615         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5616             20  AM-FLI-AGT                PIC X(9).
  5617             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5618             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5619         16  FILLER                        PIC X(102).
  5620
  5621     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5622         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5623             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5624             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5625             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5626             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5627             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5628         16  FILLER                          PIC X(10).
  5629******************************************************************
  5630
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 107
* EL152.cbl
  5632*                                COPY ELCTEXT.
  5633******************************************************************
  5634*                                                                *
  5635*                                                                *
  5636*                            ELCTEXT.                            *
  5637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5638*                            VMOD=2.008                          *
  5639*                                                                *
  5640*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5641*                                     FORM LETTERS,              *
  5642*                                     CERT FORM DISPLAY.
  5643*                                                                *
  5644*   FILE TYPE = VSAM,KSDS                                        *
  5645*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5646*                                                                *
  5647*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5648*       ALTERNATE INDEX = NONE                                   *
  5649*                                                                *
  5650*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5651*       ALTERNATE INDEX = NONE                                   *
  5652*                                                                *
  5653*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5654*       ALTERNATE INDEX = NONE                                   *
  5655*                                                                *
  5656*   LOG = NO                                                     *
  5657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5658******************************************************************
  5659 01  TEXT-FILES.
  5660     12  TEXT-FILE-ID                PIC XX.
  5661         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5662         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5663         88  HELP-FILE-TEXT             VALUE 'TH'.
  5664
  5665     12  TX-CONTROL-PRIMARY.
  5666         16  TX-COMPANY-CD           PIC X.
  5667             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5668         16  TX-ACCESS-CD-GENL       PIC X(12).
  5669
  5670         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5671             20  TX-LETTER-NO        PIC X(4).
  5672             20  FILLER              PIC X(8).
  5673
  5674         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5675             20  TX-FORM-NO          PIC X(12).
  5676
  5677         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5678             20  TX-HELP-TYPE        PIC X.
  5679                 88  HELP-FOR-GENERAL   VALUE ' '.
  5680                 88  HELP-BY-SCREEN     VALUE 'S'.
  5681                 88  HELP-BY-ERROR      VALUE 'E'.
  5682             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5683                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5684             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5685                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5686             20  FILLER              PIC X(4).
  5687
  5688         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5689
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 108
* EL152.cbl
  5690     12  TX-PROCESS-CONTROL          PIC XX.
  5691         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5692
  5693     12  TX-TEXT-LINE                PIC X(70).
  5694
  5695     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5696         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5697         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5698         88  TX-VALID-FORM-SQUEEZE-VALUE
  5699                                        VALUE 'Y' ' '.
  5700
  5701     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5702         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5703         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5704         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5705         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5706         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5707         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5708         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5709                                              'K' 'N' ' '
  5710                                              'Z'.
  5711
  5712     12  TX-ARCHIVE-SW               PIC X.
  5713         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5714         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5715         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5716
  5717     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5718     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5719
  5720     12  TX-BSR-CODE                 PIC X.
  5721         88  TX-BSR-LETTER              VALUE 'B'.
  5722         88  TX-NON-BSR-LETTER          VALUE ' '.
  5723
  5724     12  FILLER                      PIC X.
  5725*****************************************************************
  5726
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 109
* EL152.cbl
  5728*                                COPY ELCTRLR.
  5729******************************************************************
  5730*                                                                *
  5731*                            ELCTRLR.                            *
  5732*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5733*                            VMOD=2.014                          *
  5734*                                                                *
  5735*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5736*                                                                *
  5737*   FILE TYPE = VSAM,KSDS                                        *
  5738*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5739*                                                                *
  5740*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5741*       ALTERNATE INDEX = NONE                                   *
  5742*                                                                *
  5743*   LOG = YES                                                    *
  5744*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5745******************************************************************
  5746*                   C H A N G E   L O G
  5747*
  5748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5749*-----------------------------------------------------------------
  5750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5751* EFFECTIVE    NUMBER
  5752*-----------------------------------------------------------------
  5753* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5754* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5755* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5756* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5757* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5758* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5759* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5760* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5761* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5762* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5763* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5764* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5765* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5766* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5767* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5768* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5769* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5770* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5771* 040814    2014030500002  AJRA  ADD ICD CODES
  5772* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5773******************************************************************
  5774 01  ACTIVITY-TRAILERS.
  5775     12  AT-RECORD-ID                    PIC XX.
  5776         88  VALID-AT-ID                       VALUE 'AT'.
  5777
  5778     12  AT-CONTROL-PRIMARY.
  5779         16  AT-COMPANY-CD               PIC X.
  5780         16  AT-CARRIER                  PIC X.
  5781         16  AT-CLAIM-NO                 PIC X(7).
  5782         16  AT-CERT-NO.
  5783             20  AT-CERT-PRIME           PIC X(10).
  5784             20  AT-CERT-SFX             PIC X.
  5785         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 110
* EL152.cbl
  5786             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5787             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5788             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5789             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5790             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5791             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5792             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5793             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5794             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5795             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5796             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5797             88  AT-BENEFICIARY-TRL           VALUE +91.
  5798             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5799             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5800             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5801             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5802
  5803     12  AT-TRAILER-TYPE                 PIC X.
  5804         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5805         88  PAYMENT-TR                       VALUE '2'.
  5806         88  AUTO-PAY-TR                      VALUE '3'.
  5807         88  CORRESPONDENCE-TR                VALUE '4'.
  5808         88  ADDRESS-TR                       VALUE '5'.
  5809         88  GENERAL-INFO-TR                  VALUE '6'.
  5810         88  AUTO-PROMPT-TR                   VALUE '7'.
  5811         88  DENIAL-TR                        VALUE '8'.
  5812         88  INCURRED-CHG-TR                  VALUE '9'.
  5813         88  FORM-CONTROL-TR                  VALUE 'A'.
  5814
  5815     12  AT-RECORDED-DT                  PIC XX.
  5816     12  AT-RECORDED-BY                  PIC X(4).
  5817     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5818
  5819     12  AT-TRAILER-BODY                 PIC X(165).
  5820
  5821     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5822         16  AT-RESERVE-CONTROLS.
  5823             20  AT-MANUAL-SW            PIC X.
  5824                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5825             20  AT-FUTURE-SW            PIC X.
  5826                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5827             20  AT-PTC-SW               PIC X.
  5828                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5829             20  AT-IBNR-SW              PIC X.
  5830                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5831             20  AT-PTC-LF-SW            PIC X.
  5832                 88  AT-LF-PTC-USED          VALUE '1'.
  5833             20  AT-CDT-ACCESS-METHOD    PIC X.
  5834                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5835                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5836                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5837             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5838         16  AT-LAST-COMPUTED-DT         PIC XX.
  5839         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5840         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5841         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5842         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5843         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 111
* EL152.cbl
  5844         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5845         16  AT-EXPENSE-CONTROLS.
  5846             20  AT-EXPENSE-METHOD       PIC X.
  5847                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5848                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5849                 88  PERCENT-OF-PMT           VALUE '3'.
  5850                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5851             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5852             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5853         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5854         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5855
  5856         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5857         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5858
  5859*        16  FILLER                      PIC X(53).
  5860         16  FILLER                      PIC X(47).
  5861
  5862         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5863         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5864
  5865         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5866             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5867             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5868*                    C = CLOSED
  5869*                    O = OPEN
  5870             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5871*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5872
  5873     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5874         16  AT-PAYMENT-TYPE             PIC X.
  5875             88  PARTIAL-PAYMENT                VALUE '1'.
  5876             88  FINAL-PAYMENT                  VALUE '2'.
  5877             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5878             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5879             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5880             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5881             88  VOIDED-PAYMENT                 VALUE '9'.
  5882             88  TRANSFER                       VALUE 'T'.
  5883             88  LIFE-INTEREST                  VALUE 'I'.
  5884
  5885         16  AT-CLAIM-TYPE               PIC X.
  5886             88  PAID-FOR-AH                    VALUE 'A'.
  5887             88  PAID-FOR-LIFE                  VALUE 'L'.
  5888             88  PAID-FOR-IUI                   VALUE 'I'.
  5889             88  PAID-FOR-GAP                   VALUE 'G'.
  5890             88  PAID-FOR-FAM                   VALUE 'F'.
  5891         16  AT-CLAIM-PREM-TYPE          PIC X.
  5892             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5893             88  AT-O-B-COVERAGE                VALUE '2'.
  5894             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5895         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5896         16  AT-CHECK-NO                 PIC X(7).
  5897         16  AT-PAID-FROM-DT             PIC XX.
  5898         16  AT-PAID-THRU-DT             PIC XX.
  5899         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5900         16  FILLER                      PIC X.
  5901         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 112
* EL152.cbl
  5902         16  AT-PAYMENT-ORIGIN           PIC X.
  5903             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5904             88  ONLINE-AUTO-PMT                VALUE '2'.
  5905             88  OFFLINE-PMT                    VALUE '3'.
  5906         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5907         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5908         16  AT-VOID-DATA.
  5909             20  AT-VOID-DT              PIC XX.
  5910*00144       20  AT-VOID-REASON          PIC X(30).
  5911             20  AT-VOID-REASON          PIC X(26).
  5912         16  AT-PMT-APPROVED-BY          PIC X(04).
  5913         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5914         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5915         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5916                                         PIC S99V9(5)  COMP-3.
  5917         16  AT-CREDIT-INTERFACE.
  5918             20  AT-PMT-SELECT-DT        PIC XX.
  5919                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5920             20  AT-PMT-ACCEPT-DT        PIC XX.
  5921                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5922             20  AT-VOID-SELECT-DT       PIC XX.
  5923                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5924             20  AT-VOID-ACCEPT-DT       PIC XX.
  5925                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5926
  5927         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5928                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5929                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5930         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5931
  5932         16  AT-FORCE-CONTROL            PIC X.
  5933             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5934         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5935         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5936         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5937         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5938         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5939         16  AT-BENEFIT-TYPE             PIC X.
  5940
  5941         16  AT-EXPENSE-TYPE             PIC X.
  5942         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5943
  5944         16  AT-PAYEE-TYPE-CD.
  5945             20  AT-PAYEE-TYPE           PIC X.
  5946                 88  INSURED-PAID           VALUE 'I'.
  5947                 88  BENEFICIARY-PAID       VALUE 'B'.
  5948                 88  ACCOUNT-PAID           VALUE 'A'.
  5949                 88  OTHER-1-PAID           VALUE 'O'.
  5950                 88  OTHER-2-PAID           VALUE 'Q'.
  5951                 88  DOCTOR-PAID            VALUE 'P'.
  5952                 88  EMPLOYER-PAID          VALUE 'E'.
  5953             20  AT-PAYEE-SEQ            PIC X.
  5954
  5955         16  AT-CASH-PAYMENT             PIC X.
  5956         16  AT-GROUPED-PAYMENT          PIC X.
  5957         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5958         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5959         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 113
* EL152.cbl
  5960         16  AT-VOID-TYPE                PIC X.
  5961             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5962             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5963         16  AT-AIG-UNEMP-IND            PIC X.
  5964             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5965         16  AT-ASSOCIATES               PIC X.
  5966             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5967             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5968
  5969         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5970         16  AT-CV-PMT-CODE              PIC X.
  5971             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5972             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5973             88  FULL-ADD-PAYMENT           VALUE '3'.
  5974             88  HALF-ADD-PAYMENT           VALUE '4'.
  5975             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5976             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5977             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5978             88  ADDL-PAYMENT               VALUE '8'.
  5979
  5980         16  AT-EOB-CODE1                PIC XXX.
  5981         16  AT-EOB-CODE2                PIC XXX.
  5982         16  AT-EOB-CODE3                PIC XXX.
  5983         16  FILLER REDEFINES AT-EOB-CODE3.
  5984             20  AT-PRINT-CLM-FORM       PIC X.
  5985             20  AT-PRINT-SURVEY         PIC X.
  5986             20  AT-SPECIAL-RELEASE      PIC X.
  5987         16  AT-EOB-CODE4                PIC XXX.
  5988         16  FILLER REDEFINES AT-EOB-CODE4.
  5989             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5990             20  FILLER                  PIC X.
  5991         16  AT-EOB-CODE5                PIC XXX.
  5992         16  FILLER REDEFINES AT-EOB-CODE5.
  5993             20  AT-PMT-PROOF-DT         PIC XX.
  5994             20  FILLER                  PIC X.
  5995
  5996         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5997             88  AT-PRINT-EOB            VALUE 'Y'.
  5998
  5999         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6000         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6001
  6002     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6003         16  AT-SCHEDULE-START-DT        PIC XX.
  6004         16  AT-SCHEDULE-END-DT          PIC XX.
  6005         16  AT-TERMINATED-DT            PIC XX.
  6006         16  AT-LAST-PMT-TYPE            PIC X.
  6007             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6008             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6009         16  AT-FIRST-PMT-DATA.
  6010             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6011             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6012             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6013         16  AT-REGULAR-PMT-DATA.
  6014             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6015             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6016             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6017         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 114
* EL152.cbl
  6018             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6019                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6020                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6021                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6022                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6023                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6024             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6025         16  AT-AUTO-PAY-DAY             PIC 99.
  6026         16  AT-AUTO-CASH                PIC X.
  6027             88  AT-CASH                      VALUE 'Y'.
  6028             88  AT-NON-CASH                  VALUE 'N'.
  6029*        16  FILLER                      PIC X(129).
  6030         16  AT-AUTO-END-LETTER          PIC X(4).
  6031         16  FILLER                      PIC X(125).
  6032
  6033         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6034         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6035
  6036     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6037         16  AT-LETTER-SENT-DT           PIC XX.
  6038         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6039         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6040         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6041         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6042         16  AT-LETTER-ORIGIN            PIC X.
  6043             88  ONLINE-CREATION              VALUE '1' '3'.
  6044             88  OFFLINE-CREATION             VALUE '2' '4'.
  6045             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6046             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6047         16  AT-STD-LETTER-FORM          PIC X(4).
  6048         16  AT-REASON-TEXT              PIC X(70).
  6049         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6050         16  AT-ADDRESEE-TYPE            PIC X.
  6051              88  INSURED-ADDRESEE            VALUE 'I'.
  6052              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6053              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6054              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6055              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6056              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6057              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6058         16  AT-ADDRESSEE-NAME           PIC X(30).
  6059         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6060         16  AT-RESEND-PRINT-DATE        PIC XX.
  6061         16  AT-CORR-SOL-UNSOL           PIC X.
  6062         16  AT-LETTER-PURGED-DT         PIC XX.
  6063*
  6064*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6065*
  6066         16  AT-CSO-REDEFINITION.
  6067             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6068             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6069             20  AT-LETTER-TO-BENE       PIC X(1).
  6070             20  AT-STOP-LETTER-DT       PIC X(2).
  6071             20  FILLER                  PIC X(19).
  6072*             20  FILLER                  PIC X(27).
  6073             20  AT-CSO-LETTER-STATUS    PIC X.
  6074                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6075                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 115
* EL152.cbl
  6076                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6077             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6078             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6079*
  6080*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6081*
  6082*        16  FILLER                      PIC X(26).
  6083*
  6084*        16  AT-DMD-BSR-CODE             PIC X.
  6085*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6086*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6087*
  6088*        16  AT-DMD-LETTER-STATUS        PIC X.
  6089*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6090*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6091*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6092*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6093*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6094
  6095         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6096         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6097
  6098     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6099         16  AT-ADDRESS-TYPE             PIC X.
  6100             88  INSURED-ADDRESS               VALUE 'I'.
  6101             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6102             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6103             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6104             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6105             88  OTHER-ADDRESS-1               VALUE 'O'.
  6106             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6107         16  AT-MAIL-TO-NAME             PIC X(30).
  6108         16  AT-ADDRESS-LINE-1           PIC X(30).
  6109         16  AT-ADDRESS-LINE-2           PIC X(30).
  6110         16  AT-CITY-STATE.
  6111             20  AT-CITY                 PIC X(28).
  6112             20  AT-STATE                PIC XX.
  6113         16  AT-ZIP.
  6114             20  AT-ZIP-CODE.
  6115                 24  AT-ZIP-1ST          PIC X.
  6116                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6117                 24  FILLER              PIC X(4).
  6118             20  AT-ZIP-PLUS4            PIC X(4).
  6119         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6120             20  AT-CAN-POSTAL-1         PIC XXX.
  6121             20  AT-CAN-POSTAL-2         PIC XXX.
  6122             20  FILLER                  PIC XXX.
  6123         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6124*         16  FILLER                      PIC X(23).
  6125         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6126         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6127         16  FILLER                      PIC X(13).
  6128         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6129         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6130
  6131     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6132         16  AT-INFO-LINE-1              PIC X(60).
  6133         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 116
* EL152.cbl
  6134             20  AT-NOTE-ERROR-NO OCCURS 15
  6135                                         PIC X(4).
  6136         16  AT-INFO-LINE-2              PIC X(60).
  6137         16  FILLER REDEFINES AT-INFO-LINE-2.
  6138             20  AT-ICD-CODE-1           PIC X(8).
  6139             20  AT-ICD-CODE-2           PIC X(8).
  6140             20  FILLER                  PIC X(44).
  6141         16  AT-INFO-TRAILER-TYPE        PIC X.
  6142             88  AT-ERRORS-NOTE          VALUE 'E'.
  6143             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6144             88  AT-CALL-NOTE            VALUE 'C'.
  6145             88  AT-MAINT-NOTE           VALUE 'M'.
  6146             88  AT-CERT-CHANGE          VALUE 'X'.
  6147             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6148             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6149             88  AT-CERT-CANCELLED       VALUE 'T'.
  6150         16  AT-CALL-TYPE                PIC X.
  6151             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6152             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6153         16  AT-NOTE-CONTINUATION        PIC X.
  6154             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6155         16  AT-EOB-CODES-EXIST          PIC X.
  6156             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6157         16  FILLER                      PIC X(35).
  6158         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6159         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6160
  6161     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6162         16  AT-PROMPT-LINE-1            PIC X(60).
  6163         16  AT-PROMPT-LINE-2            PIC X(60).
  6164         16  AT-PROMPT-START-DT          PIC XX.
  6165         16  AT-PROMPT-END-DT            PIC XX.
  6166         16  FILLER                      PIC X(35).
  6167         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6168         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6169
  6170     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6171         16  AT-DENIAL-INFO-1            PIC X(60).
  6172         16  AT-DENIAL-INFO-2            PIC X(60).
  6173         16  AT-DENIAL-DT                PIC XX.
  6174         16  AT-RETRACTION-DT            PIC XX.
  6175         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6176*         16  FILLER                      PIC X(31).
  6177         16  AT-DENIAL-PROOF-DT          PIC XX.
  6178         16  FILLER                      PIC X(29).
  6179         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6180         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6181
  6182     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6183         16  AT-OLD-INCURRED-DT          PIC XX.
  6184         16  AT-OLD-REPORTED-DT          PIC XX.
  6185         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6186         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6187         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6188         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6189         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6190         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6191         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 117
* EL152.cbl
  6192         16  AT-OLD-DIAG-CODE            PIC X(6).
  6193         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6194         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6195         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6196         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6197         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6198         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6199         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6200         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6201         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6202         16  FILLER                      PIC X(9).
  6203         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6204
  6205     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6206         16  AT-FORM-SEND-ON-DT          PIC XX.
  6207         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6208         16  AT-FORM-RE-SEND-DT          PIC XX.
  6209         16  AT-FORM-ANSWERED-DT         PIC XX.
  6210         16  AT-FORM-PRINTED-DT          PIC XX.
  6211         16  AT-FORM-REPRINT-DT          PIC XX.
  6212         16  AT-FORM-TYPE                PIC X.
  6213             88  INITIAL-FORM                  VALUE '1'.
  6214             88  PROGRESS-FORM                 VALUE '2'.
  6215         16  AT-INSTRUCT-LN-1            PIC X(28).
  6216         16  AT-INSTRUCT-LN-2            PIC X(28).
  6217         16  AT-INSTRUCT-LN-3            PIC X(28).
  6218         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6219         16  AT-FORM-ADDRESS             PIC X.
  6220             88  FORM-TO-INSURED              VALUE 'I'.
  6221             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6222             88  FORM-TO-OTHER-1              VALUE 'O'.
  6223             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6224         16  AT-RELATED-1.
  6225             20 AT-REL-CARR-1            PIC X.
  6226             20 AT-REL-CLAIM-1           PIC X(7).
  6227             20 AT-REL-CERT-1            PIC X(11).
  6228         16  AT-RELATED-2.
  6229             20 AT-REL-CARR-2            PIC X.
  6230             20 AT-REL-CLAIM-2           PIC X(7).
  6231             20 AT-REL-CERT-2            PIC X(11).
  6232         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6233         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6234         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6235         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6236         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6237         16  AT-STOP-FORM-DT             PIC X(2).
  6238
  6239         16  FILLER                      PIC X(09).
  6240         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6241         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6242******************************************************************
  6243
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 118
* EL152.cbl
  6245*                                COPY ELCBENE.
  6246******************************************************************
  6247*                                                                *
  6248*                            ELCBENE.                            *
  6249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6250*                            VMOD=2.006                          *
  6251*                                                                *
  6252*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6253*                                                                *
  6254*   FILE TYPE = VSAM,KSDS                                        *
  6255*   RECORD SIZE = 500   RECFORM = FIX                            *
  6256*                                                                *
  6257*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6258*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6259*                                                                *
  6260*   LOG = YES                                                    *
  6261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6262*                                                                *
  6263*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6264******************************************************************
  6265
  6266 01  BENEFICIARY-MASTER.
  6267     12  BE-RECORD-ID                PIC XX.
  6268         88  VALID-BE-ID                VALUE 'BE'.
  6269
  6270     12  BE-CONTROL-PRIMARY.
  6271         16  BE-COMPANY-CD           PIC X.
  6272         16  BE-RECORD-TYPE          PIC X.
  6273             88  BENEFICIARY-RECORD  VALUE 'B'.
  6274             88  ADJUSTOR-RECORD     VALUE 'A'.
  6275         16  BE-BENEFICIARY          PIC X(10).
  6276     12  BE-CONTROL-BY-NAME.
  6277         16  BE-COMPANY-CD-A1        PIC X.
  6278         16  BE-RECORD-TYPE-A1       PIC X.
  6279         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6280         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6281
  6282     12  BE-LAST-MAINT-DT            PIC XX.
  6283     12  BE-LAST-MAINT-BY            PIC X(4).
  6284     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6285
  6286     12  BE-ADDRESS-DATA.
  6287         16  BE-MAIL-TO-NAME         PIC X(30).
  6288         16  BE-ADDRESS-LINE-1       PIC X(30).
  6289         16  BE-ADDRESS-LINE-2       PIC X(30).
  6290         16  BE-ADDRESS-LINE-3       PIC X(30).
  6291         16  BE-CITY-STATE.
  6292             20  BE-CITY             PIC X(28).
  6293             20  BE-STATE            PIC XX.
  6294         16  BE-ZIP-CODE.
  6295             20  BE-ZIP-PRIME.
  6296                 24  BE-ZIP-1ST      PIC X.
  6297                     88  BE-CANADIAN-POST-CODE
  6298                                         VALUE 'A' THRU 'Z'.
  6299                 24  FILLER          PIC X(4).
  6300             20  BE-ZIP-PLUS4        PIC X(4).
  6301         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6302             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 119
* EL152.cbl
  6303             20  BE-CAN-POSTAL-2     PIC XXX.
  6304             20  FILLER              PIC XXX.
  6305         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6306         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6307
  6308******************************************************************
  6309*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6310*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6311******************************************************************
  6312     12  BE-CARRIER                  PIC X.
  6313
  6314     12  BE-ADDRESS-DATA2.
  6315         16  BE-MAIL-TO-NAME2        PIC X(30).
  6316         16  BE-ADDRESS-LINE-12      PIC X(30).
  6317         16  BE-ADDRESS-LINE-22      PIC X(30).
  6318         16  BE-ADDRESS-LINE-32      PIC X(30).
  6319         16  BE-CITY-STATE2.
  6320             20  BE-CITY2            PIC X(28).
  6321             20  BE-STATE2           PIC XX.
  6322         16  BE-ZIP-CODE2.
  6323             20  BE-ZIP-PRIME2.
  6324                 24  BE-ZIP-1ST2     PIC X.
  6325                     88  BE-CANADIAN-POST-CODE2
  6326                                         VALUE 'A' THRU 'Z'.
  6327                 24  FILLER          PIC X(4).
  6328             20  BE-ZIP-PLUS42       PIC X(4).
  6329         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6330             20  BE-CAN-POSTAL-12    PIC XXX.
  6331             20  BE-CAN-POSTAL-22    PIC XXX.
  6332             20  FILLER              PIC XXX.
  6333         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6334         16  BE-BILLING-STMT-DATA.
  6335             20  BE-BSR              PIC X.
  6336                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6337                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6338             20  BE-BSR-FROM         PIC X(30).
  6339             20  BE-BSR-DEPT         PIC X(30).
  6340             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6341             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6342             20  BE-OUTPUT-TYPE      PIC X.
  6343                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6344                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6345
  6346     12  FILLER                      PIC X(28).
  6347******************************************************************
  6348
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 120
* EL152.cbl
  6350*                                COPY ERCCOMP.
  6351******************************************************************
  6352*                                                                *
  6353*                                                                *
  6354*                            ERCCOMP                             *
  6355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6356*                            VMOD=2.019                          *
  6357*                                                                *
  6358*   ONLINE CREDIT SYSTEM                                         *
  6359*                                                                *
  6360*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6361*                                                                *
  6362*   FILE TYPE = VSAM,KSDS                                        *
  6363*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6364*                                                                *
  6365*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6366*       ALTERNATE PATH = NONE                                    *
  6367*                                                                *
  6368*   LOG = NO                                                     *
  6369*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6370*                                                                *
  6371******************************************************************
  6372*                   C H A N G E   L O G
  6373*
  6374* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6375*-----------------------------------------------------------------
  6376*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6377* EFFECTIVE    NUMBER
  6378*-----------------------------------------------------------------
  6379* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6380* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6381* 092205    2005050300006  PEMA  ADD LEASE FEE
  6382* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6383* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6384* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6385* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6386* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6387* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6388******************************************************************
  6389
  6390 01  COMPENSATION-MASTER.
  6391     12  CO-RECORD-ID                          PIC XX.
  6392         88  VALID-CO-ID                          VALUE 'CO'.
  6393
  6394     12  CO-CONTROL-PRIMARY.
  6395         16  CO-COMPANY-CD                     PIC X.
  6396         16  CO-CONTROL.
  6397             20  CO-CTL-1.
  6398                 24  CO-CARR-GROUP.
  6399                     28  CO-CARRIER            PIC X.
  6400                     28  CO-GROUPING.
  6401                         32  CO-GROUP-PREFIX   PIC XXX.
  6402                         32  CO-GROUP-PRIME    PIC XXX.
  6403                 24  CO-RESP-NO.
  6404                     28  CO-RESP-PREFIX        PIC X(4).
  6405                     28  CO-RESP-PRIME         PIC X(6).
  6406             20  CO-CTL-2.
  6407                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 121
* EL152.cbl
  6408                     28  CO-ACCT-PREFIX        PIC X(4).
  6409                     28  CO-ACCT-PRIME         PIC X(6).
  6410         16  CO-TYPE                           PIC X.
  6411             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6412             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6413             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6414
  6415     12  CO-MAINT-INFORMATION.
  6416         16  CO-LAST-MAINT-DT                  PIC XX.
  6417         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6418         16  CO-LAST-MAINT-USER                PIC X(4).
  6419     12  FILLER                                PIC XX.
  6420     12  CO-STMT-TYPE                          PIC XXX.
  6421     12  CO-COMP-TYPE                          PIC X.
  6422         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6423     12  CO-STMT-OWNER                         PIC X(4).
  6424     12  CO-BALANCE-CONTROL                    PIC X.
  6425         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6426         88  CO-NO-BALANCE                        VALUE 'N'.
  6427
  6428     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6429         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6430         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6431         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6432
  6433     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6434         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6435         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6436
  6437     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6438     12  CO-GA-DIRECT-DEP                      PIC X.
  6439     12  CO-FUTURE-SPACE                       PIC X.
  6440         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6441
  6442     12  CO-ACCT-NAME                          PIC X(30).
  6443     12  CO-MAIL-NAME                          PIC X(30).
  6444     12  CO-ADDR-1                             PIC X(30).
  6445     12  CO-ADDR-2                             PIC X(30).
  6446     12  CO-ADDR-3.
  6447         16  CO-ADDR-CITY                      PIC X(27).
  6448         16  CO-ADDR-STATE                     PIC XX.
  6449     12  CO-CSO-1099                           PIC X.
  6450     12  CO-ZIP.
  6451         16  CO-ZIP-PRIME.
  6452             20  CO-ZIP-PRI-1ST                PIC X.
  6453                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6454             20  FILLER                        PIC X(4).
  6455         16  CO-ZIP-PLUS4                      PIC X(4).
  6456     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6457         16  CO-CAN-POSTAL-1                   PIC XXX.
  6458         16  CO-CAN-POSTAL-2                   PIC XXX.
  6459         16  FILLER                            PIC XXX.
  6460     12  CO-SOC-SEC                            PIC X(13).
  6461     12  CO-TELEPHONE.
  6462         16  CO-AREA-CODE                      PIC XXX.
  6463         16  CO-PREFIX                         PIC XXX.
  6464         16  CO-PHONE                          PIC X(4).
  6465
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 122
* EL152.cbl
  6466     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6467
  6468     12  CO-AR-BAL-LEVEL                       PIC X.
  6469         88  CO-AR-REF-LVL                        VALUE '1'.
  6470         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6471         88  CO-AR-BILL-LVL                       VALUE '2'.
  6472         88  CO-AR-AGT-LVL                        VALUE '3'.
  6473         88  CO-AR-FR-LVL                         VALUE '4'.
  6474
  6475     12  CO-AR-NORMAL-PRINT                    PIC X.
  6476         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6477         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6478
  6479     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6480
  6481     12  CO-AR-REPORTING                       PIC X.
  6482         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6483         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6484
  6485     12  CO-AR-PULL-CHECK                      PIC X.
  6486         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6487         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6488
  6489     12  CO-AR-BALANCE-PRINT                   PIC X.
  6490         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6491
  6492     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6493         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6494         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6495         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6496
  6497     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6498
  6499     12  CO-USER-CODE                          PIC X.
  6500     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6501
  6502******************************************************************
  6503*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6504*    THE LAST MONTH END RUN.
  6505******************************************************************
  6506
  6507     12  CO-LAST-ACTIVITY-DATE.
  6508         16  CO-ACT-YEAR                       PIC 99.
  6509         16  CO-ACT-MONTH                      PIC 99.
  6510         16  CO-ACT-DAY                        PIC 99.
  6511
  6512     12  CO-LAST-STMT-DT.
  6513         16  CO-LAST-STMT-YEAR                 PIC 99.
  6514         16  CO-LAST-STMT-MONTH                PIC 99.
  6515         16  CO-LAST-STMT-DAY                  PIC 99.
  6516
  6517     12  CO-MO-END-TOTALS.
  6518         16  CO-MONTHLY-TOTALS.
  6519             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6520             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6521             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6522             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6523             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 123
* EL152.cbl
  6524
  6525         16  CO-AGING-TOTALS.
  6526             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6527             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6528             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6529             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6530
  6531         16  CO-YTD-TOTALS.
  6532             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6533             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6534
  6535         16  CO-OVER-UNDER-TOTALS.
  6536             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6537             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6538
  6539     12  CO-MISCELLANEOUS-TOTALS.
  6540         16  CO-FICA-TOTALS.
  6541             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6542             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6543
  6544         16  CO-CLAIM-TOTALS.
  6545             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6546             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6547
  6548******************************************************************
  6549*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6550*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6551******************************************************************
  6552
  6553     12  CO-CURRENT-TOTALS.
  6554         16  CO-CURRENT-LAST-STMT-DT.
  6555             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6556             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6557             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6558
  6559         16  CO-CURRENT-MONTHLY-TOTALS.
  6560             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6561             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6562             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6563             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6564             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6565
  6566         16  CO-CURRENT-AGING-TOTALS.
  6567             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6568             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6569             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6570             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6571
  6572         16  CO-CURRENT-YTD-TOTALS.
  6573             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6574             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6575
  6576     12  CO-PAID-COMM-TOTALS.
  6577         16  CO-YTD-PAID-COMMS.
  6578             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6579             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6580
  6581     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 124
* EL152.cbl
  6582         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6583         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6584
  6585     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6586         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6587         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6588         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6589         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6590         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6591         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6592         88  CO-FINAL-LETTER                  VALUE 'F'.
  6593         88  CO-RECONCILING                   VALUE 'R'.
  6594         88  CO-PHONE-CALL                    VALUE 'P'.
  6595         88  CO-LEGAL                         VALUE 'L'.
  6596         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6597         88  CO-WRITE-OFF                     VALUE 'W'.
  6598         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6599
  6600     12  CO-CSR-CODE                       PIC X(4).
  6601
  6602     12  CO-GA-STATUS-INFO.
  6603         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6604         16  CO-GA-TERMINATION-DT          PIC XX.
  6605         16  CO-GA-STATUS-CODE             PIC X.
  6606             88  CO-GA-ACTIVE                 VALUE 'A'.
  6607             88  CO-GA-INACTIVE               VALUE 'I'.
  6608             88  CO-GA-PENDING                VALUE 'P'.
  6609         16  CO-GA-COMMENTS.
  6610             20  CO-GA-COMMENT-1           PIC X(40).
  6611             20  CO-GA-COMMENT-2           PIC X(40).
  6612             20  CO-GA-COMMENT-3           PIC X(40).
  6613             20  CO-GA-COMMENT-4           PIC X(40).
  6614
  6615     12  CO-RPTCD2                         PIC X(10).
  6616     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6617         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6618         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6619
  6620     12  CO-TYPE-AGENT                     PIC X(01).
  6621         88  CO-CORPORATION                   VALUE 'C'.
  6622         88  CO-PARTNERSHIP                   VALUE 'P'.
  6623         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6624         88  CO-TRUST                         VALUE 'T'.
  6625         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6626
  6627     12  CO-FAXNO.
  6628         16  CO-FAX-AREA-CODE                  PIC XXX.
  6629         16  CO-FAX-PREFIX                     PIC XXX.
  6630         16  CO-FAX-PHONE                      PIC X(4).
  6631
  6632     12  CO-BANK-INFORMATION.
  6633         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6634         16  CO-BANK-TRANSIT-NON REDEFINES
  6635             CO-BANK-TRANSIT-NO                PIC 9(8).
  6636
  6637         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6638     12  CO-MISC-DEDUCT-INFO REDEFINES
  6639                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 125
* EL152.cbl
  6640         16  CO-MD-GL-ACCT                     PIC X(10).
  6641         16  CO-MD-DIV                         PIC XX.
  6642         16  CO-MD-CENTER                      PIC X(4).
  6643         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6644         16  CO-CREATE-AP-CHECK                PIC X.
  6645         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6646         16  FILLER                            PIC XXX.
  6647     12  CO-ACH-STATUS                         PIC X.
  6648         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6649         88  CO-ACH-PENDING                        VALUE 'P'.
  6650
  6651     12  CO-BILL-SW                            PIC X.
  6652     12  CO-CONTROL-NAME                       PIC X(30).
  6653     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6654     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6655     12  CO-CLP-STATE                          PIC XX.
  6656     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6657     12  CO-SPP-REFUND-EDIT                    PIC X.
  6658
  6659******************************************************************
  6660
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 126
* EL152.cbl
  6662*                                COPY MPCPROD.
  6663*    EJECT
  6664*                                COPY MPCPLCY.
  6665*    EJECT
  6666*                                COPY MPCPLAN.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 127
* EL152.cbl
  6668*                                COPY ELCNAPS.
  6669******************************************************************
  6670*                                                                *
  6671*                            ELCNAPS                             *
  6672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6673*                            VMOD=2.003                          *
  6674*                                                                *
  6675*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  6676*                                                                *
  6677*        FILE TYPE= VSAM,KSDS                                    *
  6678*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6679*                                                                *
  6680*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  6681*                                                                *
  6682*        LOG = YES                                               *
  6683*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6684*                                                                *
  6685******************************************************************
  6686*                   C H A N G E   L O G
  6687*
  6688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6689*-----------------------------------------------------------------
  6690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6691* EFFECTIVE    NUMBER
  6692*-----------------------------------------------------------------
  6693* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  6694******************************************************************
  6695
  6696 01  NAPERSOFT-FILE.
  6697     12  NA-RECORD-ID                PIC  XX.
  6698         88  VALID-NA-ID                  VALUE 'NA'.
  6699
  6700     12  NA-CONTROL-PRIMARY.
  6701         16  NA-COMPANY-CD           PIC X.
  6702         16  NA-CARRIER              PIC X.
  6703         16  NA-CLAIM-NO             PIC X(7).
  6704         16  NA-CERT-NO.
  6705             20  NA-CERT-PRIME       PIC X(10).
  6706             20  NA-CERT-SFX         PIC X.
  6707         16  NA-ARCHIVE-NO           PIC 9(8).
  6708
  6709     12  NA-LETTER-INFORMATION.
  6710         16  NA-LETTER-ID            PIC X(4).
  6711         16  NA-PROCESSOR-ID         PIC X(4).
  6712         16  NA-CREATION-DT          PIC X(2).
  6713         16  NA-INITIAL-PRINT-DT     PIC X(2).
  6714         16  NA-FOLLOW-UP-DT         PIC X(2).
  6715         16  NA-RESEND-DT            PIC X(2).
  6716         16  NA-RESEND-LETTER-ID     PIC X(4).
  6717         16  NA-NO-OF-COPIES         PIC 9(2).
  6718         16  NA-ADDRESS-TYPE         PIC X(2).
  6719         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  6720         16  NA-RESEND-PRINT-DT      PIC X(2).
  6721         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  6722         16  NA-NEXT-DUE-DT          PIC X(2).
  6723         16  NA-AUTOPYDT             PIC X(2).
  6724         16  NA-ENCLOSURE-CD         PIC X(3).
  6725         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 128
* EL152.cbl
  6726         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  6727         16  NA-RESEND-PROMPT-IND    PIC X(1).
  6728         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  6729         16  FILLER                  PIC X(67).
  6730******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 129
* EL152.cbl
  6732*                                COPY ELCENCC.
  6733******************************************************************
  6734*                                                                *
  6735*                                                                *
  6736*                            ELCENCC                             *
  6737*                            VMOD=2.001                          *
  6738*                                                                *
  6739*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  6740*                                                                *
  6741*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  6742*   A NAPERSOFT DOCUMENT                                         *
  6743*                                                                *
  6744*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  6745*                                                                *
  6746*   FILE TYPE = VSAM,KSDS                                        *
  6747*   RECORD SIZE = 400   RECFORM = FIX                            *
  6748*                                                                *
  6749*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  6750*                                                                *
  6751*   LOG = NO                                                     *
  6752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6753*                                                                *
  6754*                                                                *
  6755******************************************************************
  6756*                   C H A N G E   L O G
  6757*
  6758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6759*-----------------------------------------------------------------
  6760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6761* EFFECTIVE    NUMBER
  6762*-----------------------------------------------------------------
  6763* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  6764******************************************************************
  6765 01  ENCLOSURE-CODES.
  6766     12  NC-RECORD-ID                      PIC XX.
  6767         88  VALID-NC-ID                      VALUE 'NC'.
  6768     12  NC-CONTROL-PRIMARY.
  6769         16  NC-COMPANY-CD                 PIC X.
  6770         16  NC-REC-TYPE                   PIC X.
  6771             88  NC-CLAIMS                   VALUE '1'.
  6772             88  NC-ADMIN                    VALUE '2'.
  6773         16  NC-ENC-CODE                   PIC X(5).
  6774         16  FILLER                        PIC X(09).
  6775     12  NC-MAINT-INFORMATION.
  6776         16  NC-LAST-MAINT-DT              PIC XX.
  6777         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6778         16  NC-LAST-MAINT-USER            PIC X(4).
  6779         16  FILLER                        PIC XX.
  6780     12  NC-OUTPUT-STACK                   PIC XXX.
  6781     12  NC-ENCLOSURE-LINE                 PIC X(100).
  6782     12  NC-ATTACHMENTS                    PIC X(100).
  6783     12  NC-FUTURE                         PIC X(50).
  6784     12  FILLER                            PIC X(117).
  6785******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 130
* EL152.cbl
  6787*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  6788*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  6789
  6790*01  SYSTEM-VARIABLES            PIC X(3851).
  6791*01  SYS-VAR-ENTRY REDEFINES SYSTEM-VARIABLES.
  6792*    12  SYS-VAR-CODE            PIC X(4).
  6793*    12  SYS-VAR-LEN             PIC 99.
  6794*    12  SYS-VAR-DATA            PIC X(100).
  6795
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 131
* EL152.cbl
  6797 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CLAIM-MASTER
  6798                          CONTROL-FILE LETTER-ARCHIVE
  6799                          LETTER-ARCHIVE-TEMP
  6800                          CERTIFICATE-MASTER ACCOUNT-MASTER
  6801                          TEXT-FILES ACTIVITY-TRAILERS
  6802                          BENEFICIARY-MASTER
  6803                          COMPENSATION-MASTER NAPERSOFT-FILE
  6804                          ENCLOSURE-CODES.
  6805 0000-DFHEXIT SECTION.
  6806     MOVE '9#                    $   ' TO DFHEIV0.
  6807     MOVE 'EL152' TO DFHEIV1.
  6808     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6809
  6810     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6811     MOVE '5'                   TO DC-OPTION-CODE.
  6812     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  6813     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  6814     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  6815
  6816     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  6817     MOVE 1                     TO EMI-NUMBER-OF-LINES.
  6818     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  6819                                TO EMI-SAVE-AREA.
  6820
  6821     MOVE EIBTRMID              TO TS-TERM-TEXT
  6822                                   TS-TERM-SCREEN
  6823                                   QID-TERM.
  6824
  6825     MOVE SAVE-BIN-DATE       TO CURRENT-SAVE.
  6826
  6827*    IF PI-COMPANY-ID = 'DMD'
  6828*       MOVE CURRENT-SAVE           TO DC-BIN-DATE-1
  6829*       MOVE '6'                    TO DC-OPTION-CODE
  6830*       MOVE +3                     TO DC-ELAPSED-MONTHS
  6831*       MOVE +0                     TO DC-ELAPSED-DAYS
  6832*       PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6833*       MOVE DC-BIN-DATE-2          TO CURRENT-PLUS3-SAVE.
  6834
  6835
  6836* EXEC CICS HANDLE CONDITION
  6837*        PGMIDERR (9600-PGMID-ERROR)
  6838*        MAPFAIL  (0325-MAPFAIL)
  6839*        ERROR    (9990-ABEND)
  6840*    END-EXEC.
  6841*    MOVE '"$L?.                 ! " #00006831' TO DFHEIV0
  6842     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  6843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6844     MOVE X'2220233030303036383331' TO DFHEIV0(25:11)
  6845     CALL 'kxdfhei1' USING DFHEIV0
  6846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6847
  6848
  6849     IF PI-PROCESSOR-ID NOT = 'LGXX'
  6850
  6851* EXEC CICS READQ TS
  6852*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6853*            INTO    (SECURITY-CONTROL)
  6854*            LENGTH  (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 132
* EL152.cbl
  6855*            ITEM    (SC-ITEM)
  6856*        END-EXEC
  6857*    MOVE '*$II   L              ''   #00006838' TO DFHEIV0
  6858     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6859     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6860     MOVE X'2020233030303036383338' TO DFHEIV0(25:11)
  6861     CALL 'kxdfhei1' USING DFHEIV0,
  6862           PI-SECURITY-TEMP-STORE-ID,
  6863           SECURITY-CONTROL,
  6864           SC-COMM-LENGTH,
  6865           SC-ITEM,
  6866           DFHEIV99,
  6867           DFHEIV99
  6868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6869         MOVE SC-CLAIMS-DISPLAY (7)  TO  PI-DISPLAY-CAP
  6870         MOVE SC-CLAIMS-UPDATE  (7)  TO  PI-MODIFY-CAP.
  6871
  6872     set P to address of KIXSYS
  6873     CALL "getenv" using by value P returning var-ptr
  6874     if var-ptr = null then
  6875        display ' kixsys not set '
  6876     else
  6877        set address of var to var-ptr
  6878        move 0 to env-var-len
  6879        inspect var tallying env-var-len
  6880          for characters before X'00'
  6881        unstring var (1:env-var-len) delimited by '/'
  6882           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6883              WS-KIX-SYS
  6884        end-unstring
  6885     end-if
  6886     IF EIBCALEN = 0
  6887         GO TO 8800-UNAUTHORIZED-ACCESS.
  6888
  6889     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6890         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6891             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6892             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6893             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6894             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6895             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6896             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6897             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6898             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6899             PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
  6900             PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
  6901             PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
  6902             MOVE SPACES              TO PI-WA
  6903                                         PI-FORCE-7840
  6904             MOVE ZEROS               TO PI-TOTAL-LINES
  6905                                         PI-CURRENT-LINE
  6906                                         PI-TEMP-STOR-ITEMS
  6907                                         PI-UPDATE-SW
  6908                                         PI-ADDR-SEQ
  6909             MOVE '2'                 TO PI-ACTION
  6910             MOVE LOW-VALUES          TO EL152AO
  6911                                         PI-ADDR-TYPE
  6912             GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 133
* EL152.cbl
  6913         ELSE
  6914             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6915             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6916             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6917             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6918             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6919             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6920             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6921             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6922             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6923             PERFORM 7500-READ-TS           THRU 7599-EXIT
  6924             PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT
  6925             IF PGM-NAME = PGM-EL141
  6926                PERFORM 500-RECOVER-PI-TEMP-STORAGE THRU 599-EXIT
  6927                SET TB-INDX TO PI-CURRENT-LINE
  6928                PERFORM 400-SET-CODES       THRU 499-EXIT
  6929                PERFORM 7000-READ-ADDR      THRU 7099-EXIT
  6930                PERFORM 7170-FORMAT-SCREEN  THRU 7170-EXIT
  6931                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6932                        SC-INDX > NUM-LINES-PER-SCREEN
  6933                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6934                MOVE AL-UANON           TO PRINTERA
  6935                GO TO 8100-SEND-INITIAL-MAP
  6936             ELSE
  6937                SET TB-INDX TO PI-CURRENT-LINE
  6938                PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6939                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6940                        SC-INDX > NUM-LINES-PER-SCREEN
  6941                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6942                MOVE AL-UANON           TO PRINTERA
  6943                GO TO 8100-SEND-INITIAL-MAP.
  6944
  6945*0100-PA.
  6946*    MOVE ER-0008                TO EMI-ERROR.
  6947*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6948*    MOVE -1                     TO MAINTL.
  6949*    GO TO 8200-SEND-DATAONLY.
  6950
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 134
* EL152.cbl
  6952 0200-RECEIVE.
  6953     MOVE TRANS-ID         TO EIBTRNID.
  6954     MOVE EMI-SAVE-AREA    TO ERROR-MESSAGE-INTERFACE-BLOCK.
  6955     MOVE LOW-VALUES       TO EL152AI.
  6956     MOVE '104A'           TO TS-ID-TEXT.
  6957     MOVE EIBTRMID         TO TS-TERM-TEXT
  6958                              TS-TERM-SCREEN
  6959                              QID-TERM.
  6960
  6961
  6962* EXEC CICS HANDLE AID
  6963*        CLEAR    (9400-CLEAR)
  6964*        PA1      (0100-PA)
  6965*        PA2      (0100-PA)
  6966*        PA3      (0100-PA)
  6967*    END-EXEC.
  6968*    MOVE '"&=!"#               V! # #00006936' TO DFHEIV0
  6969     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  6970     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  6971     MOVE X'2320233030303036393336' TO DFHEIV0(25:11)
  6972     CALL 'kxdfhei1' USING DFHEIV0
  6973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6974
  6975
  6976
  6977* EXEC CICS HANDLE CONDITION
  6978*        MAPFAIL  (0325-MAPFAIL)
  6979*    END-EXEC.
  6980*    MOVE '"$?                   ! $ #00006943' TO DFHEIV0
  6981     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6983     MOVE X'2420233030303036393433' TO DFHEIV0(25:11)
  6984     CALL 'kxdfhei1' USING DFHEIV0
  6985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6986
  6987
  6988
  6989* EXEC CICS SYNCPOINT
  6990*    END-EXEC.
  6991*    MOVE '6"                    !   #00006947' TO DFHEIV0
  6992     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6994     MOVE X'2020233030303036393437' TO DFHEIV0(25:11)
  6995     CALL 'kxdfhei1' USING DFHEIV0
  6996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6997
  6998
  6999     IF LOWER-CASE-LETTERS-USED
  7000
  7001* EXEC CICS RECEIVE
  7002*            MAP      (MAP-NAME)
  7003*            MAPSET   (MAPSET-NAME)
  7004*            INTO     (EL152AI)
  7005*            ASIS
  7006*       END-EXEC
  7007     MOVE LENGTH OF
  7008      EL152AI
  7009       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 135
* EL152.cbl
  7010*    MOVE '8"TAI  L              ''   #00006951' TO DFHEIV0
  7011     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7013     MOVE X'2020233030303036393531' TO DFHEIV0(25:11)
  7014     CALL 'kxdfhei1' USING DFHEIV0,
  7015           MAP-NAME,
  7016           EL152AI,
  7017           DFHEIV11,
  7018           MAPSET-NAME,
  7019           DFHEIV99,
  7020           DFHEIV99
  7021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7022      ELSE
  7023
  7024* EXEC CICS RECEIVE
  7025*            MAP      (MAP-NAME)
  7026*            MAPSET   (MAPSET-NAME)
  7027*            INTO     (EL152AI)
  7028*       END-EXEC.
  7029     MOVE LENGTH OF
  7030      EL152AI
  7031       TO DFHEIV11
  7032*    MOVE '8"T I  L              ''   #00006958' TO DFHEIV0
  7033     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7034     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7035     MOVE X'2020233030303036393538' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           MAP-NAME,
  7038           EL152AI,
  7039           DFHEIV11,
  7040           MAPSET-NAME,
  7041           DFHEIV99,
  7042           DFHEIV99
  7043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7044
  7045
  7046     IF NOT DISPLAY-CAP AND PI-PROCESSOR-ID NOT = 'LGXX'
  7047         MOVE 'READ'             TO  SM-READ
  7048         PERFORM 9995-SECURITY-VIOLATION
  7049         MOVE ER-0070            TO  EMI-ERROR
  7050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7051         GO TO 8100-SEND-INITIAL-MAP.
  7052
  7053     INSPECT MAINTI CONVERTING LOWER-CASE TO UPPER-CASE.
  7054     MOVE 'N'                    TO CLEANI
  7055
  7056     IF ENTERPFL = 0
  7057         GO TO 0300-CHECK-PFKEYS.
  7058     IF EIBAID NOT = DFHENTER
  7059         MOVE ER-0004            TO EMI-ERROR
  7060         GO TO 0320-INPUT-ERROR.
  7061     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7062         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7063     ELSE
  7064         MOVE ER-0029            TO EMI-ERROR
  7065         GO TO 0320-INPUT-ERROR.
  7066
  7067 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 136
* EL152.cbl
  7068     IF EIBAID = DFHPF23
  7069         GO TO 8810-PF23.
  7070     IF EIBAID = DFHPF24
  7071         GO TO 9200-RETURN-MAIN-MENU.
  7072*    IF EIBAID = DFHPF12
  7073*        GO TO 9500-PF12.
  7074     IF EIBAID = DFHPF1
  7075         MOVE 7                  TO ROLL-COUNTER
  7076         GO TO 7900-ROLL-PAGE.
  7077     IF EIBAID = DFHPF2
  7078         MOVE -7                 TO ROLL-COUNTER
  7079         GO TO 7900-ROLL-PAGE.
  7080     IF EIBAID = DFHPF3
  7081         GO TO 6100-ADDR-MAINT.
  7082     IF EIBAID = DFHPF4
  7083         IF MODIFY-CAP
  7084             GO TO 6200-EDIT-MODE
  7085         ELSE
  7086             MOVE 'UPDATE'       TO  SM-READ
  7087             PERFORM 9995-SECURITY-VIOLATION
  7088             MOVE ER-0070        TO  EMI-ERROR
  7089             GO TO 0320-INPUT-ERROR.
  7090
  7091     IF EIBAID = DFHPF5
  7092         GO TO 0330-FUNCTION-CHECK.
  7093
  7094     IF EIBAID = DFHPF6
  7095         GO TO 0330-FUNCTION-CHECK.
  7096
  7097     IF EIBAID = DFHPF7
  7098        COMPUTE ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  7099        GO TO 7900-ROLL-PAGE.
  7100
  7101     IF EIBAID = DFHPF8
  7102        MOVE PI-TOTAL-LINES TO ROLL-COUNTER
  7103        GO TO 7900-ROLL-PAGE.
  7104
  7105*    IF EIBAID = DFHPF9 AND
  7106*       PI-COMPANY-ID = 'DMD'
  7107*        MOVE '1'           TO PI-FORCE-7840
  7108*        GO TO 0330-FUNCTION-CHECK.
  7109
  7110     IF EIBAID = DFHENTER
  7111         GO TO 0330-FUNCTION-CHECK.
  7112
  7113     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7114
  7115     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  7116     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7117             VARYING SC-INDX FROM 1 BY 1
  7118             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7119
  7120     MOVE ER-0029                TO EMI-ERROR.
  7121 0320-INPUT-ERROR.
  7122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7123     MOVE AL-UNBON               TO ENTERPFA.
  7124     IF ENTERPFL = 0
  7125         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 137
* EL152.cbl
  7126     ELSE
  7127         MOVE -1                 TO ENTERPFL.
  7128
  7129     GO TO 8200-SEND-DATAONLY.
  7130
  7131 0100-PA.
  7132     MOVE ER-0008                TO EMI-ERROR.
  7133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7134     MOVE -1                     TO MAINTL.
  7135     GO TO 8200-SEND-DATAONLY.
  7136
  7137 0325-MAPFAIL.
  7138***********************************************************
  7139*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  7140*      LETTERS ON A 3275 PRINTER.                         *
  7141***********************************************************
  7142
  7143     PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT.
  7144
  7145     SET TB-INDX         TO PI-CURRENT-LINE.
  7146     PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  7147                  VARYING SC-INDX FROM 1 BY 1 UNTIL
  7148                  SC-INDX > NUM-LINES-PER-SCREEN.
  7149
  7150     GO TO 8100-SEND-INITIAL-MAP.
  7151
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 138
* EL152.cbl
  7153 0330-FUNCTION-CHECK.
  7154     IF NOT MODIFY-CAP
  7155         IF MAINTI = 'S'
  7156             NEXT SENTENCE
  7157         ELSE
  7158             MOVE 'UPDATE'           TO  SM-READ
  7159             PERFORM 9995-SECURITY-VIOLATION
  7160             MOVE ER-0070            TO  EMI-ERROR
  7161             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7162             GO TO 8100-SEND-INITIAL-MAP.
  7163
  7164     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  7165
  7166     IF EIBAID = DFHPF5
  7167      IF PI-PROMPT-LETTER = 'Y'
  7168         MOVE ER-0894            TO EMI-ERROR
  7169         MOVE -1             TO MAINTL
  7170         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7171         MOVE AL-UABON       TO MAINTA
  7172         GO TO 8200-SEND-DATAONLY
  7173      ELSE
  7174         IF MAINTI NOT = 'C'
  7175             MOVE ER-0716        TO EMI-ERROR
  7176             MOVE -1             TO MAINTL
  7177             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7178             MOVE AL-UABON       TO MAINTA
  7179             GO TO 8200-SEND-DATAONLY
  7180         ELSE
  7181             IF MODIFY-CAP
  7182                 GO TO 6400-LETTER-RELEASE
  7183             ELSE
  7184                 IF PRINT-PERFORMED
  7185                     GO TO 6400-LETTER-RELEASE
  7186                 ELSE
  7187                     MOVE AL-UNBON TO ENTERPFA
  7188                     MOVE -1       TO ENTERPFL
  7189                     MOVE ER-2398 TO EMI-ERROR
  7190                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7191                     GO TO 8200-SEND-DATAONLY.
  7192
  7193     IF EIBAID = DFHPF6
  7194      IF PI-PROMPT-LETTER = 'Y'
  7195         MOVE ER-0894            TO EMI-ERROR
  7196         MOVE -1             TO MAINTL
  7197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7198         MOVE AL-UABON       TO MAINTA
  7199         GO TO 8200-SEND-DATAONLY
  7200      ELSE
  7201         GO TO 7800-PRINT-LETTER-NOW.
  7202
  7203     IF MAINTI = 'S'
  7204         GO TO 1000-SHOW.
  7205
  7206     IF MAINTI = 'C'
  7207         GO TO 2000-CREATE.
  7208
  7209     IF MAINTI = 'R'
  7210        IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 139
* EL152.cbl
  7211           MOVE ER-0070          TO EMI-ERROR
  7212           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7213           MOVE LOW-VALUES       TO EL152AO
  7214           GO TO 8100-SEND-INITIAL-MAP
  7215          ELSE
  7216           GO TO 3000-RECORD.
  7217
  7218     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7219     PERFORM 7950-SET-INDX       THRU 7950-EXIT
  7220     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN
  7221                                 THRU 7960-EXIT
  7222        VARYING SC-INDX FROM 1 BY 1 UNTIL
  7223        SC-INDX > NUM-LINES-PER-SCREEN
  7224     MOVE ER-0023                TO EMI-ERROR.
  7225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7226     MOVE -1                     TO MAINTL.
  7227     MOVE AL-UABON               TO MAINTA.
  7228     GO TO 8200-SEND-DATAONLY.
  7229
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 140
* EL152.cbl
  7231 0350-EDIT-ROUTINE.
  7232     PERFORM 400-SET-CODES THRU 499-EXIT.
  7233     MOVE PI-CLAIM-NO    TO CLAM-CLAIM
  7234                            ACTV-CLAIM.
  7235
  7236     IF ADDRL NOT = +0
  7237        INSPECT ADDRI CONVERTING LOWER-CASE TO UPPER-CASE
  7238        MOVE ADDRI           TO WS-ADDR-TYPE-CD
  7239        IF WS-ADDR-TYPE = 'I' OR 'B' OR 'A' OR 'P' OR
  7240                          'O' OR 'Q' OR 'E'
  7241           MOVE AL-UANON         TO ADDRA
  7242        ELSE
  7243           MOVE -1               TO ADDRL
  7244           MOVE AL-UABON         TO ADDRA
  7245           MOVE ER-0176          TO EMI-ERROR
  7246           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7247*     ELSE
  7248*       IF PI-COMPANY-ID = 'DMD'
  7249*        IF MAINTI = 'C' OR 'R'
  7250*          MOVE -1               TO ADDRL
  7251*          MOVE AL-UABON         TO ADDRA
  7252*          MOVE ER-0861          TO EMI-ERROR
  7253*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7254
  7255     IF ADDRL NOT = +0
  7256        IF WS-ADDR-SEQ NOT NUMERIC
  7257           MOVE -1               TO ADDRL
  7258           MOVE AL-UABON         TO ADDRA
  7259           MOVE ER-0176          TO EMI-ERROR
  7260           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7261
  7262*    IF ADDRL NOT = +0
  7263*       IF PI-COMPANY-ID = 'DMD'
  7264*          IF WS-ADDR-TYPE = 'B' AND
  7265*             WS-ADDR-SEQ NOT = '9'
  7266*                MOVE -1               TO ADDRL
  7267*                MOVE AL-UABON         TO ADDRA
  7268*                MOVE ER-7842          TO EMI-ERROR
  7269*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7270
  7271     IF FORML NOT = ZEROS
  7272        INSPECT FORMI CONVERTING LOWER-CASE TO UPPER-CASE.
  7273
  7274     IF MAINTI = 'C' AND FORML = ZEROS
  7275        MOVE -1                  TO FORML
  7276        MOVE ER-0177             TO EMI-ERROR
  7277        MOVE AL-UABON            TO FORMA
  7278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7279
  7280     IF FOLLOWL NOT = ZEROS
  7281        MOVE FOLLOWI             TO DEEDIT-FIELD
  7282        PERFORM 8600-DEEDIT
  7283        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7284        MOVE '4'                 TO DC-OPTION-CODE
  7285        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7286        IF DATE-CONVERSION-ERROR
  7287           MOVE ER-0182          TO EMI-ERROR
  7288           MOVE -1               TO FOLLOWL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 141
* EL152.cbl
  7289           MOVE AL-UABON         TO FOLLOWA
  7290           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7291        ELSE
  7292*          IF (PI-COMPANY-ID = 'DMD') AND
  7293*             (NOT FORCE-7840)        AND
  7294*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7295*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7296*              MOVE AL-SABON         TO PFKEY9A
  7297*              MOVE ER-7840          TO EMI-ERROR
  7298*              MOVE -1               TO FOLLOWL
  7299*              MOVE AL-UABON         TO FOLLOWA
  7300*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7301*          ELSE
  7302             MOVE SPACES                TO PFKEY9O
  7303             MOVE AL-SADON              TO PFKEY9A
  7304             MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWO
  7305             MOVE AL-UANON              TO FOLLOWA
  7306             MOVE DC-BIN-DATE-1         TO FOLLOW-UP-SAVE
  7307     ELSE
  7308        MOVE LOW-VALUES                 TO FOLLOW-UP-SAVE.
  7309
  7310     IF FOLLOW-UP-SAVE NOT = LOW-VALUES
  7311        IF FOLLOW-UP-SAVE NOT > CURRENT-SAVE
  7312           MOVE ER-0533          TO EMI-ERROR
  7313           MOVE AL-UABON         TO FOLLOWA
  7314           MOVE -1               TO FOLLOWL
  7315           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7316
  7317     IF RESENDL NOT = ZEROS
  7318        MOVE RESENDI             TO DEEDIT-FIELD
  7319        PERFORM 8600-DEEDIT
  7320        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7321        MOVE '4'                 TO DC-OPTION-CODE
  7322        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7323        IF DATE-CONVERSION-ERROR
  7324           MOVE ER-0185          TO EMI-ERROR
  7325           MOVE -1               TO RESENDL
  7326           MOVE AL-UABON         TO RESENDA
  7327           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7328         ELSE
  7329*          IF (PI-COMPANY-ID = 'DMD') AND
  7330*             (NOT FORCE-7840)        AND
  7331*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7332*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7333*              MOVE AL-SABON         TO PFKEY9A
  7334*              MOVE ER-7840          TO EMI-ERROR
  7335*              MOVE -1               TO RESENDL
  7336*              MOVE AL-UABON         TO RESENDA
  7337*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7338*          ELSE
  7339             MOVE SPACES                 TO PFKEY9O
  7340             MOVE AL-SADON               TO PFKEY9A
  7341             MOVE DC-GREG-DATE-1-EDIT    TO RESENDO
  7342             MOVE AL-UANON               TO RESENDA
  7343             MOVE DC-BIN-DATE-1          TO RESEND-SAVE
  7344     ELSE
  7345        MOVE LOW-VALUE                   TO RESEND-SAVE.
  7346
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 142
* EL152.cbl
  7347     IF RESEND-SAVE NOT = LOW-VALUES
  7348        IF RESEND-SAVE NOT > CURRENT-SAVE
  7349           MOVE ER-0537          TO EMI-ERROR
  7350           MOVE AL-UABON         TO RESENDA
  7351           MOVE -1               TO RESENDL
  7352           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7353
  7354     IF PRINTL NOT = ZEROS
  7355        INSPECT PRINTI CONVERTING LOWER-CASE TO UPPER-CASE
  7356        IF PRINTI = 'Y' OR = ' '
  7357           MOVE AL-UANON         TO PRINTA
  7358        ELSE
  7359           MOVE ER-0183          TO EMI-ERROR
  7360           MOVE -1               TO PRINTL
  7361           MOVE AL-UABON         TO PRINTA
  7362           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7363
  7364     MOVE 'Y'                    TO CLEANO
  7365     IF ENCL <= ZEROS
  7366        MOVE 'N'                 TO CLEANO
  7367     END-IF
  7368     IF ENCL > ZEROS
  7369        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  7370                                          PI-ENCLOSURE-CD
  7371        MOVE SPACES             TO ELENCC-KEY
  7372        MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  7373        MOVE '1'                TO ELENCC-REC-TYPE
  7374        MOVE ENCI               TO ELENCC-ENC-CODE
  7375
  7376
  7377* EXEC CICS READ
  7378*           DATASET    (ENCC-ID)
  7379*           SET        (ADDRESS OF ENCLOSURE-CODES)
  7380*           RIDFLD     (ELENCC-KEY)
  7381*           RESP       (WS-RESPONSE)
  7382*       END-EXEC
  7383*    MOVE '&"S        E          (  N#00007294' TO DFHEIV0
  7384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7386     MOVE X'204E233030303037323934' TO DFHEIV0(25:11)
  7387     CALL 'kxdfhei1' USING DFHEIV0,
  7388           ENCC-ID,
  7389           DFHEIV20,
  7390           DFHEIV99,
  7391           ELENCC-KEY,
  7392           DFHEIV99,
  7393           DFHEIV99,
  7394           DFHEIV99
  7395     SET ADDRESS OF ENCLOSURE-CODES TO
  7396         DFHEIV20
  7397     MOVE EIBRESP  TO WS-RESPONSE
  7398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7399
  7400        IF RESP-NORMAL
  7401           MOVE ENCI             TO PI-ENCLOSURE-CD
  7402                                    W-ENCLOSURE-CD
  7403           MOVE AL-UANON         TO ENCA
  7404        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 143
* EL152.cbl
  7405           MOVE 'N'              TO CLEANO
  7406           MOVE ER-1560          TO EMI-ERROR
  7407           MOVE -1               TO ENCL
  7408           MOVE AL-UABON         TO ENCA
  7409           PERFORM 9900-ERROR-FORMAT
  7410                                 THRU 9900-EXIT
  7411        END-IF
  7412     END-IF
  7413     IF COPIESL NOT = ZEROS
  7414        IF COPIESI NOT NUMERIC OR
  7415           COPIESI = '0'
  7416           MOVE ER-0184          TO EMI-ERROR
  7417           MOVE -1               TO COPIESL
  7418           MOVE AL-UABON         TO COPIESA
  7419           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7420        ELSE
  7421           MOVE AL-UANON         TO COPIESA.
  7422
  7423     IF PI-PROCESSOR-PRINTER NOT = SPACES
  7424         MOVE PI-PROCESSOR-PRINTER   TO  PI-ALT-PRINTER-ID.
  7425
  7426     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  7427
  7428     IF PRINTERL > ZERO
  7429        INSPECT PRINTERI CONVERTING LOWER-CASE TO UPPER-CASE
  7430        MOVE AL-UANON            TO PRINTERA
  7431        MOVE PRINTERI            TO PI-ALT-PRINTER-ID
  7432                                    PI-ALT-DMD-PRT-ID
  7433     ELSE
  7434        IF (PI-NO-CARRIER-SECURITY AND
  7435            PI-NO-ACCOUNT-SECURITY) OR
  7436            PI-PROCESSOR-PRINTER NOT = SPACES
  7437             NEXT SENTENCE
  7438        ELSE
  7439            MOVE AL-UABON       TO PRINTERA
  7440            MOVE -1             TO PRINTERL
  7441            MOVE ER-2397        TO EMI-ERROR
  7442            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7443
  7444     IF ACTL NOT = +0
  7445         MOVE ZEROS              TO W-ACCOUNT
  7446         IF ACTI > SPACES
  7447             IF ACTI NUMERIC
  7448                     AND
  7449                ACTI NOT < 1
  7450                     AND
  7451                ACTI NOT > 9
  7452                 MOVE AL-UANON   TO ACTA
  7453                 MOVE ACTI       TO W-ACCOUNT
  7454                                    W-LETTER-ADDR-SEQ
  7455                 MOVE 'A'        TO W-LETTER-ADDR-TYPE
  7456             ELSE
  7457                 MOVE -1         TO ACTL
  7458                 MOVE AL-UABON   TO ACTA
  7459                 MOVE ER-3547    TO EMI-ERROR
  7460                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7461
  7462     IF BENL NOT = +0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 144
* EL152.cbl
  7463         MOVE ZEROS              TO W-BENEFICIARY
  7464         IF BENI > SPACES
  7465             IF BENI NUMERIC
  7466                     AND
  7467                BENI NOT < 1
  7468                     AND
  7469                BENI NOT > 9
  7470                 MOVE AL-UANON   TO BENA
  7471                 MOVE BENI       TO W-BENEFICIARY
  7472                                    W-LETTER-ADDR-SEQ
  7473                 MOVE 'B'        TO W-LETTER-ADDR-TYPE
  7474             ELSE
  7475                 MOVE -1         TO BENL
  7476                 MOVE AL-UABON   TO BENA
  7477                 MOVE ER-3547    TO EMI-ERROR
  7478                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7479
  7480     IF EMPL NOT = +0
  7481         MOVE ZEROS              TO W-EMPLOYER
  7482         IF EMPI > SPACES
  7483             IF EMPI NUMERIC
  7484                     AND
  7485                EMPI NOT < 1
  7486                     AND
  7487                EMPI NOT > 9
  7488                 MOVE AL-UANON   TO EMPA
  7489                 MOVE EMPI       TO W-EMPLOYER
  7490                                    W-LETTER-ADDR-SEQ
  7491                 MOVE 'E'        TO W-LETTER-ADDR-TYPE
  7492             ELSE
  7493                 MOVE -1         TO EMPL
  7494                 MOVE AL-UABON   TO EMPA
  7495                 MOVE ER-3547    TO EMI-ERROR
  7496                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7497
  7498     IF INSL NOT = +0
  7499         MOVE ZEROS              TO W-INSURED
  7500         IF INSI > SPACES
  7501             IF INSI NUMERIC
  7502                     AND
  7503                INSI NOT < 1
  7504                     AND
  7505                INSI NOT > 9
  7506                 MOVE AL-UANON   TO INSA
  7507                 MOVE INSI       TO W-INSURED
  7508                                    W-LETTER-ADDR-SEQ
  7509                 MOVE 'I'        TO W-LETTER-ADDR-TYPE
  7510             ELSE
  7511                 MOVE -1         TO INSL
  7512                 MOVE AL-UABON   TO INSA
  7513                 MOVE ER-3547    TO EMI-ERROR
  7514                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7515
  7516     IF PHYSL NOT = +0
  7517         MOVE ZEROS              TO W-PHYSICIAN
  7518         IF PHYSI > SPACES
  7519             IF PHYSI NUMERIC
  7520                     AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 145
* EL152.cbl
  7521                PHYSI NOT < 1
  7522                     AND
  7523                PHYSI NOT > 9
  7524                 MOVE AL-UANON   TO PHYSA
  7525                 MOVE PHYSI      TO W-PHYSICIAN
  7526                                    W-LETTER-ADDR-SEQ
  7527                 MOVE 'P'        TO W-LETTER-ADDR-TYPE
  7528             ELSE
  7529                 MOVE -1         TO PHYSL
  7530                 MOVE AL-UABON   TO PHYSA
  7531                 MOVE ER-3547    TO EMI-ERROR
  7532                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7533
  7534     IF OTHR1L NOT = +0
  7535         MOVE ZEROS              TO W-OTHER-1
  7536         IF OTHR1I > SPACES
  7537             IF OTHR1I NUMERIC
  7538                     AND
  7539                OTHR1I NOT < 1
  7540                     AND
  7541                OTHR1I NOT > 9
  7542                 MOVE AL-UANON   TO OTHR1A
  7543                 MOVE OTHR1I     TO W-OTHER-1
  7544                                    W-LETTER-ADDR-SEQ
  7545                 MOVE 'O'        TO W-LETTER-ADDR-TYPE
  7546             ELSE
  7547                 MOVE -1         TO OTHR1L
  7548                 MOVE AL-UABON   TO OTHR1A
  7549                 MOVE ER-3547    TO EMI-ERROR
  7550                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7551
  7552     IF OTHR2L NOT = +0
  7553         MOVE ZEROS              TO W-OTHER-2
  7554         IF OTHR2I > SPACES
  7555             IF OTHR2I NUMERIC
  7556                     AND
  7557                OTHR2I NOT < 1
  7558                     AND
  7559                OTHR2I NOT > 9
  7560                 MOVE AL-UANON   TO OTHR2A
  7561                 MOVE OTHR2I     TO W-OTHER-2
  7562                                    W-LETTER-ADDR-SEQ
  7563                 MOVE 'Q'        TO W-LETTER-ADDR-TYPE
  7564             ELSE
  7565                 MOVE -1         TO OTHR2L
  7566                 MOVE AL-UABON   TO OTHR2A
  7567                 MOVE ER-3547    TO EMI-ERROR
  7568                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7569
  7570     IF NOT EMI-NO-ERRORS
  7571        GO TO 8200-SEND-DATAONLY.
  7572
  7573 0350-EXIT.
  7574      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 146
* EL152.cbl
  7576 400-SET-CODES.
  7577     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7578     MOVE PI-COMPANY-CD          TO CLAM-CO
  7579                                    TEXT-CO
  7580                                    ACTV-CO
  7581                                    CERT-CO
  7582                                    ACCT-CO
  7583                                    ARCH-CO
  7584                                    PROD-CO
  7585                                    PLCY-CO
  7586                                    PLAN-CO.
  7587
  7588     MOVE PI-CARRIER             TO CLAM-CARRIER
  7589                                    ACTV-CARRIER
  7590                                    CERT-CARRIER
  7591                                    ACCT-CARRIER
  7592                                    PROD-CARRIER
  7593                                    PLCY-CARRIER
  7594                                    PLAN-CARRIER.
  7595
  7596     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  7597                                    ACTV-CERT-NUM
  7598                                    CERT-CERT-NUM.
  7599 499-EXIT.
  7600      EXIT.
  7601
  7602 500-RECOVER-PI-TEMP-STORAGE.
  7603
  7604
  7605* EXEC CICS HANDLE CONDITION
  7606*        QIDERR   (590-QIDERR)
  7607*    END-EXEC.
  7608*    MOVE '"$N                   ! % #00007505' TO DFHEIV0
  7609     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7611     MOVE X'2520233030303037353035' TO DFHEIV0(25:11)
  7612     CALL 'kxdfhei1' USING DFHEIV0
  7613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7614
  7615
  7616
  7617* EXEC CICS READQ TS
  7618*        QUEUE    (WS-PI-QID)
  7619*        INTO     (PROGRAM-INTERFACE-BLOCK)
  7620*        LENGTH   (PI-COMM-LENGTH)
  7621*    END-EXEC.
  7622*    MOVE '*$I    L              ''   #00007509' TO DFHEIV0
  7623     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7624     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7625     MOVE X'2020233030303037353039' TO DFHEIV0(25:11)
  7626     CALL 'kxdfhei1' USING DFHEIV0,
  7627           WS-PI-QID,
  7628           PROGRAM-INTERFACE-BLOCK,
  7629           PI-COMM-LENGTH,
  7630           DFHEIV99,
  7631           DFHEIV99,
  7632           DFHEIV99
  7633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 147
* EL152.cbl
  7634
  7635
  7636     PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT.
  7637
  7638     GO TO 599-EXIT.
  7639
  7640 590-QIDERR.
  7641
  7642     IF EIBTRNID = TRANS-ID
  7643         MOVE ER-0033                   TO  EMI-ERROR
  7644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7645         GO TO 8200-SEND-DATAONLY.
  7646
  7647 599-EXIT.
  7648     EXIT.
  7649
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 148
* EL152.cbl
  7651 1000-SHOW.
  7652***************************************************************
  7653*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  7654*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN. THE TEXT      *
  7655*     WILL BE INSERTED INTO THE TS-TABLE AND DISPLAYED TO     *
  7656*     OPERATOR.                                               *
  7657***************************************************************
  7658
  7659     MOVE SPACES                 TO RECORD-TABLE.
  7660     IF ARCHNUML = ZEROS
  7661        MOVE -1                  TO ARCHNUML
  7662        MOVE AL-UNBON            TO ARCHNUMA
  7663        MOVE ER-0174             TO EMI-ERROR
  7664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7665        GO TO 8200-SEND-DATAONLY.
  7666
  7667     IF ARCHNUMI NOT NUMERIC
  7668        MOVE -1                  TO ARCHNUML
  7669        MOVE AL-UNBON            TO ARCHNUMA
  7670        MOVE ER-0175             TO EMI-ERROR
  7671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7672        GO TO 8200-SEND-DATAONLY.
  7673
  7674     IF PI-SHOW-MODE
  7675*       IF PI-ARCHIVE-NUMBER = ARCHNUMI
  7676*          MOVE -1               TO MAINTL
  7677*          GO TO 8200-SEND-DATAONLY
  7678*       ELSE
  7679           PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
  7680
  7681     MOVE ARCHNUMI               TO ARCH-NUMBER
  7682                                    PI-ARCHIVE-NUMBER.
  7683     MOVE ' '                    TO ARCH-REC-TYPE.
  7684     MOVE '1'                    TO PI-ACTION.
  7685     MOVE ZEROS                  TO PI-ADDR-SEQ.
  7686     MOVE LOW-VALUES             TO PI-ADDR-TYPE.
  7687     MOVE SPACES                 TO PI-PRINT-SW
  7688                                    PI-FORM-NUMBER.
  7689     SET TB-INDX TO 1.
  7690
  7691     MOVE SPACE                  TO WS-LETTER-STATUS.
  7692
  7693
  7694* EXEC CICS HANDLE CONDITION
  7695*         NOTOPEN    (8850-ARCH-NOT-OPEN)
  7696*         NOTFND     (1020-ENDBR)
  7697*         ENDFILE    (1020-ENDBR)
  7698*    END-EXEC.
  7699*    MOVE '"$JI''                 ! & #00007572' TO DFHEIV0
  7700     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  7701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7702     MOVE X'2620233030303037353732' TO DFHEIV0(25:11)
  7703     CALL 'kxdfhei1' USING DFHEIV0
  7704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7705
  7706
  7707     MOVE ARCH-PARTIAL-KEY       TO ARCH-SAVE-KEY.
  7708
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 149
* EL152.cbl
  7709
  7710* EXEC CICS STARTBR
  7711*         DATASET    (ARCH-ID)
  7712*         RIDFLD     (ARCH-KEY)
  7713*         GTEQ
  7714*    END-EXEC
  7715     MOVE 0
  7716       TO DFHEIV11
  7717*    MOVE '&,         G          &   #00007580' TO DFHEIV0
  7718     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7720     MOVE X'2020233030303037353830' TO DFHEIV0(25:11)
  7721     CALL 'kxdfhei1' USING DFHEIV0,
  7722           ARCH-ID,
  7723           ARCH-KEY,
  7724           DFHEIV99,
  7725           DFHEIV11,
  7726           DFHEIV99
  7727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7728
  7729     MOVE 'Y'                    TO ARCH-BROWSE-STARTED.
  7730
  7731 1010-READ-NEXT.
  7732
  7733* EXEC CICS READNEXT
  7734*         SET       (ADDRESS OF LETTER-ARCHIVE)
  7735*         DATASET   (ARCH-ID)
  7736*         RIDFLD    (ARCH-KEY)
  7737*    END-EXEC.
  7738     MOVE 0
  7739       TO DFHEIV11
  7740*    MOVE '&.S                   )   #00007589' TO DFHEIV0
  7741     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7742     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7743     MOVE X'2020233030303037353839' TO DFHEIV0(25:11)
  7744     CALL 'kxdfhei1' USING DFHEIV0,
  7745           ARCH-ID,
  7746           DFHEIV20,
  7747           DFHEIV99,
  7748           ARCH-KEY,
  7749           DFHEIV99,
  7750           DFHEIV11,
  7751           DFHEIV99,
  7752           DFHEIV99
  7753     SET ADDRESS OF LETTER-ARCHIVE TO
  7754         DFHEIV20
  7755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7756
  7757
  7758     IF LA-FORM-CONTROL-HDR
  7759        GO TO 1020-ENDBR.
  7760
  7761
  7762     IF NOT LA-HEADER-DATA
  7763         NEXT SENTENCE
  7764     ELSE
  7765         IF NOT LA-CSO-LETTER-PURGED
  7766             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 150
* EL152.cbl
  7767         ELSE
  7768             MOVE 'P'            TO WS-LETTER-STATUS
  7769             GO TO 1020-ENDBR.
  7770
  7771     IF ARCH-PARTIAL-KEY = ARCH-SAVE-KEY
  7772        IF LA-HEADER-DATA
  7773           PERFORM 1040-FORMAT-RESEND
  7774           MOVE LA-NO-OF-COPIES    TO COPIESO
  7775           PERFORM 1050-GET-CORRESPOND THRU 1059-EXIT
  7776           GO TO 1010-READ-NEXT
  7777        ELSE
  7778           IF LA-ADDRESS-DATA
  7779              MOVE LA-ADDRESS-LINE   TO REC-TEXT (TB-INDX)
  7780              MOVE ZEROS             TO REC-PC (TB-INDX)
  7781              SET TB-INDX UP BY 1
  7782              GO TO 1010-READ-NEXT
  7783           ELSE
  7784              PERFORM 1030-TEXT-BUILD
  7785              GO TO 1010-READ-NEXT.
  7786
  7787 1020-ENDBR.
  7788     IF ARCH-BROWSE-STARTED = 'Y'
  7789        MOVE 'N'                TO ARCH-BROWSE-STARTED
  7790
  7791* EXEC CICS ENDBR
  7792*            DATASET   (ARCH-ID)
  7793*       END-EXEC
  7794     MOVE 0
  7795       TO DFHEIV11
  7796*    MOVE '&2                    $   #00007627' TO DFHEIV0
  7797     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7798     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7799     MOVE X'2020233030303037363237' TO DFHEIV0(25:11)
  7800     CALL 'kxdfhei1' USING DFHEIV0,
  7801           ARCH-ID,
  7802           DFHEIV11,
  7803           DFHEIV99
  7804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7805     END-IF.
  7806
  7807*    IF PI-COMPANY-ID = 'CID'
  7808         IF TB-INDX = 1
  7809             IF WS-LETTER-STATUS EQUAL 'P'
  7810                 MOVE 9021           TO EMI-ERROR
  7811                 MOVE -1             TO ARCHNUML
  7812                 MOVE AL-UNBON       TO ARCHNUMA
  7813                 PERFORM 9900-ERROR-FORMAT THRU
  7814                         9900-EXIT
  7815                 GO TO 8200-SEND-DATAONLY
  7816             ELSE
  7817                 MOVE ER-0006             TO EMI-ERROR
  7818                 MOVE -1                  TO ARCHNUML
  7819                 MOVE AL-UNBON            TO ARCHNUMA
  7820                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7821                 GO TO 8200-SEND-DATAONLY
  7822             END-IF
  7823         END-IF
  7824*    ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 151
* EL152.cbl
  7825*        IF TB-INDX = 1
  7826*            MOVE ER-0006             TO EMI-ERROR
  7827*            MOVE -1                  TO ARCHNUML
  7828*            MOVE AL-UNBON            TO ARCHNUMA
  7829*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7830*            GO TO 8200-SEND-DATAONLY
  7831*        END-IF
  7832*    END-IF
  7833
  7834
  7835     SET TB-INDX DOWN BY 1.
  7836     SET PI-TOTAL-LINES          TO TB-INDX.
  7837     MOVE 1                      TO PI-CURRENT-LINE.
  7838     SET TB-INDX TO 1.
  7839
  7840     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7841             VARYING SC-INDX FROM 1 BY 1
  7842               UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7843
  7844     MOVE SPACES                 TO PI-ADDR-TYPE
  7845                                    MAINTI.
  7846     MOVE -1                     TO MAINTL.
  7847
  7848     GO TO 8100-SEND-INITIAL-MAP.
  7849
  7850 1030-TEXT-BUILD.
  7851***** IF THERE ARE NO ADDRESS LINES OR LESS THAN 6 LINES, SET TO
  7852***** TOP OF FORM.
  7853     IF TB-INDX < 7
  7854        SET TB-INDX   TO 7.
  7855
  7856     IF TB-INDX = 7
  7857        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7858        SET TB-INDX UP BY 1.
  7859
  7860     MOVE LA-TEXT-LINE           TO REC-TEXT (TB-INDX).
  7861     MOVE LA-SKIP-CONTROL        TO REC-PC (TB-INDX)
  7862                                    INDX-WORK.
  7863
  7864     IF INDX-WORK NOT = 99
  7865        SET TB-INDX UP BY 1
  7866        SET TB-INDX UP BY INDX-WORK
  7867     ELSE
  7868        SET TB-INDX UP BY 1
  7869        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7870        SET TB-INDX UP BY 1.
  7871
  7872 1040-FORMAT-RESEND.
  7873     IF LA-RESEND-DATE = LOW-VALUES
  7874        MOVE SPACES                 TO RESENDI
  7875       ELSE
  7876        MOVE LA-RESEND-DATE         TO DC-BIN-DATE-1
  7877        MOVE ' '                    TO DC-OPTION-CODE
  7878        PERFORM 9700-DATE-LINK  THRU 9700-EXIT
  7879        MOVE DC-GREG-DATE-1-EDIT    TO RESENDO.
  7880
  7881 1050-GET-CORRESPOND.
  7882     MOVE LA-CARRIER             TO ACTV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 152
* EL152.cbl
  7883     MOVE LA-CLAIM-NO            TO ACTV-CLAIM.
  7884     MOVE LA-CERT-NO             TO ACTV-CERT-NUM.
  7885     MOVE LA-CORR-TRLR-SEQ       TO ACTV-SEQ.
  7886
  7887
  7888* EXEC CICS READ
  7889*         DATASET     (ACTV-ID)
  7890*         RIDFLD      (ACTV-KEY)
  7891*         SET         (ADDRESS OF ACTIVITY-TRAILERS)
  7892*    END-EXEC.
  7893*    MOVE '&"S        E          (   #00007712' TO DFHEIV0
  7894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7896     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  7897     CALL 'kxdfhei1' USING DFHEIV0,
  7898           ACTV-ID,
  7899           DFHEIV20,
  7900           DFHEIV99,
  7901           ACTV-KEY,
  7902           DFHEIV99,
  7903           DFHEIV99,
  7904           DFHEIV99
  7905     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7906         DFHEIV20
  7907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7908
  7909
  7910     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  7911        MOVE SPACES                TO FOLLOWI
  7912     ELSE
  7913        MOVE SPACES                TO DC-OPTION-CODE
  7914        MOVE AT-RECEIPT-FOLLOW-UP  TO DC-BIN-DATE-1
  7915        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7916        MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWI.
  7917
  7918     MOVE SPACES                 TO ADDRI
  7919     MOVE AT-STD-LETTER-FORM     TO FORMI
  7920     MOVE AT-REASON-TEXT         TO REI.
  7921
  7922 1059-EXIT.
  7923      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 153
* EL152.cbl
  7925 2000-CREATE.
  7926***************************************************************
  7927*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  7928*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  7929*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  7930*    WILL BE DISPLAYED ONTO THE SCREEN.                       *
  7931*                                                             *
  7932***************************************************************
  7933
  7934***************************************************************
  7935*    CHECK TO SEE IF SAME REQUEST OR NOT.                     *
  7936*    IF NEW REQUEST AND A LETTER WAS PRINTED, FORCE AN ERROR  *
  7937***************************************************************
  7938
  7939     IF PI-CREATE-MODE
  7940        IF PI-FORM-NUMBER = FORMI AND PI-ADDR-TYPE = ADDRI AND
  7941           PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7942           PERFORM 7500-READ-TS  THRU 7599-EXIT
  7943           PERFORM 7950-SET-INDX THRU 7950-EXIT
  7944           PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7945             VARYING SC-INDX FROM 1 BY 1
  7946             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  7947           MOVE -1               TO MAINTL
  7948*          MOVE 'Y'              TO CLEANO
  7949           GO TO 8200-SEND-DATAONLY
  7950        ELSE
  7951           IF PRINT-PERFORMED AND
  7952              PI-RETURN-TO-PROGRAM  =  PGM-EL150 AND
  7953              FORMI NOT = 9999
  7954              MOVE ER-0279           TO EMI-ERROR
  7955              MOVE -1                TO MAINTL
  7956              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7957              GO TO 8200-SEND-DATAONLY.
  7958
  7959***************************************************************
  7960*   IF THE FORM NUMBER IS THE SAME BUT THE ADDRESS TYPE       *
  7961*   HAS CHANGED, THEN SAVE THE CURRENT SCREEN AND REBUILD     *
  7962*   THE ADDRESS DATA.                                         *
  7963***************************************************************
  7964
  7965     IF PI-FORM-NUMBER = FORMI AND
  7966        PI-ADDR-TYPE  =  ADDRI AND
  7967        PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7968           MOVE -1                  TO MAINTL
  7969           GO TO 8200-SEND-DATAONLY.
  7970
  7971     IF PI-LETTER-ADDRESS-TYPE NOT = W-LETTER-ADDRESS-TYPE
  7972         MOVE 0                  TO GETMAIN-SWITCH
  7973         MOVE 'N'                TO WS-ACCT-READ-SW
  7974                                    WS-PROD-READ-SW
  7975                                    WS-COMP-READ-SW.
  7976
  7977     MOVE SPACES                 TO RECORD-TABLE.
  7978
  7979     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  7980
  7981     SET TB-INDX TO 1
  7982     MOVE TOP-FORM               TO REC-TEXT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 154
* EL152.cbl
  7983     SET TB-INDX UP BY 1.
  7984
  7985***************************************************************
  7986*    IF A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE      *
  7987*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  7988***************************************************************
  7989
  7990     IF FORMI = '9999'
  7991        MOVE 16                  TO PI-TOTAL-LINES
  7992        MOVE 1                   TO PI-CURRENT-LINE
  7993        PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
  7994        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT
  7995        MOVE '3'                 TO PI-ACTION
  7996        MOVE FORMI               TO PI-FORM-NUMBER
  7997                                    PI-COMM-CONTROL
  7998        MOVE ZEROS               TO PI-UPDATE-SW
  7999        MOVE PGM-EL1042          TO PGM-NAME
  8000        GO TO 9300-XCTL.
  8001
  8002     MOVE FORMI                  TO TEXT-LETTER.
  8003     MOVE TEXT-PARTIAL-KEY       TO TEXT-SAVE-KEY.
  8004
  8005
  8006* EXEC CICS HANDLE CONDITION
  8007*         NOTFND     (2120-ENDBR)
  8008*         ENDFILE    (2120-ENDBR)
  8009*         NOTOPEN    (8890-TEXT-NOT-OPEN)
  8010*    END-EXEC
  8011*    MOVE '"$I''J                 ! '' #00007813' TO DFHEIV0
  8012     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  8013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8014     MOVE X'2720233030303037383133' TO DFHEIV0(25:11)
  8015     CALL 'kxdfhei1' USING DFHEIV0
  8016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8017
  8018
  8019* EXEC CICS STARTBR
  8020*         DATASET    (TEXT-ID)
  8021*         RIDFLD     (TEXT-KEY)
  8022*         GTEQ
  8023*    END-EXEC.
  8024     MOVE 0
  8025       TO DFHEIV11
  8026*    MOVE '&,         G          &   #00007819' TO DFHEIV0
  8027     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8029     MOVE X'2020233030303037383139' TO DFHEIV0(25:11)
  8030     CALL 'kxdfhei1' USING DFHEIV0,
  8031           TEXT-ID,
  8032           TEXT-KEY,
  8033           DFHEIV99,
  8034           DFHEIV11,
  8035           DFHEIV99
  8036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8037
  8038
  8039     MOVE 'Y'                    TO TEXT-BROWSE-STARTED.
  8040
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 155
* EL152.cbl
  8041 2110-READ-NEXT.
  8042     IF TB-INDX > MAX-LINES
  8043        MOVE ER-0051             TO EMI-ERROR
  8044        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8045        GO TO 2120-ENDBR.
  8046
  8047
  8048* EXEC CICS READNEXT
  8049*         DATASET    (TEXT-ID)
  8050*         SET        (ADDRESS OF TEXT-FILES)
  8051*         RIDFLD     (TEXT-KEY)
  8052*    END-EXEC.
  8053     MOVE 0
  8054       TO DFHEIV11
  8055*    MOVE '&.S                   )   #00007833' TO DFHEIV0
  8056     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8057     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8058     MOVE X'2020233030303037383333' TO DFHEIV0(25:11)
  8059     CALL 'kxdfhei1' USING DFHEIV0,
  8060           TEXT-ID,
  8061           DFHEIV20,
  8062           DFHEIV99,
  8063           TEXT-KEY,
  8064           DFHEIV99,
  8065           DFHEIV11,
  8066           DFHEIV99,
  8067           DFHEIV99
  8068     SET ADDRESS OF TEXT-FILES TO
  8069         DFHEIV20
  8070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8071
  8072
  8073     IF TEXT-PARTIAL-KEY NOT = TEXT-SAVE-KEY
  8074        IF TB-INDX = +2
  8075           MOVE SPACES           TO PI-FORM-NUMBER
  8076           MOVE -1               TO FORML
  8077           MOVE AL-UABON         TO FORMA
  8078           MOVE ER-1236          TO EMI-ERROR
  8079           MOVE 'N'              TO CLEANO
  8080           PERFORM 9900-ERROR-FORMAT
  8081                                 THRU 9900-EXIT
  8082        END-IF
  8083        GO TO 2120-ENDBR
  8084     END-IF
  8085
  8086     MOVE FORMI                  TO PI-FORM-NUMBER.
  8087     IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  8088         PERFORM 2800-PROCESS-Z-CONTROLS THRU 2800-EXIT
  8089         GO TO 2110-READ-NEXT.
  8090
  8091      MOVE TX-BSR-CODE           TO PI-ELLETR-BSR.
  8092
  8093      IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  8094         AND (PI-CARRIER NOT = '8')
  8095         PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  8096            B1 > +20
  8097            IF TX-TEXT-LINE (B1:5) = '@03.1'
  8098               GO TO 2110-READ-NEXT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 156
* EL152.cbl
  8099            END-IF
  8100         END-PERFORM
  8101      END-IF
  8102      MOVE TX-TEXT-LINE          TO REC-TEXT (TB-INDX).
  8103      MOVE TX-PROCESS-CONTROL    TO REC-PC (TB-INDX)
  8104                                    INDX-WORK.
  8105      SET TB-INDX UP BY 1.
  8106      IF INDX-WORK = 99
  8107         MOVE TOP-FORM           TO REC-TEXT (TB-INDX)
  8108         SET TB-INDX UP BY 1
  8109         GO TO 2110-READ-NEXT
  8110      ELSE
  8111         SET TB-INDX UP BY INDX-WORK
  8112         GO TO 2110-READ-NEXT.
  8113
  8114 2120-ENDBR.
  8115     IF TEXT-BROWSE-STARTED = 'Y'
  8116        MOVE 'N'                 TO TEXT-BROWSE-STARTED
  8117
  8118* EXEC CICS ENDBR
  8119*            DATASET     (TEXT-ID)
  8120*       END-EXEC.
  8121     MOVE 0
  8122       TO DFHEIV11
  8123*    MOVE '&2                    $   #00007883' TO DFHEIV0
  8124     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8125     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8126     MOVE X'2020233030303037383833' TO DFHEIV0(25:11)
  8127     CALL 'kxdfhei1' USING DFHEIV0,
  8128           TEXT-ID,
  8129           DFHEIV11,
  8130           DFHEIV99
  8131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8132
  8133
  8134*02160      IF TB-INDX = 8
  8135*02161         MOVE ER-0006             TO EMI-ERROR
  8136*02162         MOVE -1                  TO FORML
  8137*02163         MOVE AL-UABON            TO FORMA
  8138*02164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8139*02165         GO TO 8200-SEND-DATAONLY-ERASEAUP.
  8140
  8141     SET TB-INDX DOWN BY 1.
  8142     SET PI-TOTAL-LINES          TO TB-INDX.
  8143     MOVE 1                      TO PI-CURRENT-LINE.
  8144
  8145***************************************************************
  8146*    IF IT IS A DESIGNATED CLAIM, THEN RESOLVE ALL            *
  8147*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
  8148***************************************************************
  8149
  8150     IF PI-RETURN-TO-PROGRAM = PGM-EL150
  8151        PERFORM 7200-RESOLVE-VARIABLES THRU 7269-EXIT
  8152        MOVE SPACES              TO W-REVERSE-DATE-SW
  8153        PERFORM 7300-VARIABLE-SEARCH   THRU 7399-EXIT
  8154                VARYING TB-INDX FROM 7 BY 1 UNTIL
  8155                TB-INDX > PI-TOTAL-LINES
  8156     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 157
* EL152.cbl
  8157        MOVE ER-0373             TO EMI-ERROR
  8158        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8159
  8160     SET TB-INDX TO 1.
  8161     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  8162             VARYING SC-INDX FROM 1 BY 1 UNTIL
  8163             SC-INDX > NUM-LINES-PER-SCREEN.
  8164
  8165     MOVE '3'                    TO PI-ACTION.
  8166*    MOVE FORMI                  TO PI-FORM-NUMBER.
  8167     MOVE W-LETTER-ADDRESS-TYPE  TO PI-LETTER-ADDRESS-TYPE.
  8168     MOVE -1                     TO MAINTL.
  8169     GO TO 8200-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 158
* EL152.cbl
  8171 2800-PROCESS-Z-CONTROLS.
  8172
  8173     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
  8174
  8175     IF RESEND-SAVE = LOW-VALUES
  8176         IF W-DAYS-TO-RESEND-1 NUMERIC
  8177             IF W-DAYS-TO-RESEND-1 > ZEROS
  8178                 MOVE '6'                    TO DC-OPTION-CODE
  8179                 MOVE SAVE-BIN-DATE          TO DC-BIN-DATE-1
  8180                 MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8181                 MOVE W-DAYS-TO-RESEND-1     TO DC-ELAPSED-DAYS
  8182                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8183                 IF NO-CONVERSION-ERROR
  8184                     MOVE DC-BIN-DATE-2       TO RESEND-SAVE
  8185                     MOVE DC-GREG-DATE-1-EDIT TO RESENDO
  8186                     MOVE AL-UANON            TO RESENDA
  8187                     MOVE +8                  TO RESENDL
  8188                 ELSE
  8189                     MOVE ER-3770             TO EMI-ERROR
  8190                     MOVE -1                  TO MAINTL
  8191                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8192                     GO TO 8200-SEND-DATAONLY.
  8193
  8194     IF FOLLOW-UP-SAVE = LOW-VALUES
  8195         IF W-DAYS-TO-FOLLOW-UP NUMERIC
  8196             IF W-DAYS-TO-FOLLOW-UP > ZEROS
  8197                 MOVE '6'                 TO DC-OPTION-CODE
  8198                 MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  8199                 MOVE ZEROS               TO DC-ELAPSED-MONTHS
  8200                 MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  8201                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8202                 IF NO-CONVERSION-ERROR
  8203                     MOVE DC-BIN-DATE-2       TO FOLLOW-UP-SAVE
  8204                     MOVE DC-GREG-DATE-1-EDIT TO FOLLOWO
  8205                     MOVE AL-UANON            TO FOLLOWA
  8206                     MOVE +8                  TO FOLLOWL
  8207                 ELSE
  8208                     MOVE ER-3771             TO EMI-ERROR
  8209                     MOVE -1                  TO MAINTL
  8210                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8211                     GO TO 8200-SEND-DATAONLY.
  8212
  8213     IF COPIESI NOT NUMERIC
  8214         IF W-NUMBER-OF-COPIES NUMERIC
  8215             IF W-NUMBER-OF-COPIES > ZEROS
  8216                 MOVE W-NUMBER-OF-COPIES  TO COPIESI
  8217                 MOVE AL-UNNON            TO COPIESA
  8218                 MOVE +1                  TO COPIESL
  8219             ELSE
  8220                 MOVE +1                  TO COPIESI
  8221                 MOVE AL-UNNON            TO COPIESA
  8222                 MOVE +1                  TO COPIESL.
  8223
  8224     IF W-FORM-TO-RESEND > SPACES
  8225         MOVE W-FORM-TO-RESEND          TO PI-RESEND-FORM-NUMBER
  8226     ELSE
  8227         MOVE LOW-VALUES                TO PI-RESEND-FORM-NUMBER
  8228     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 159
* EL152.cbl
  8229
  8230     IF W-PROMPT-LETTER = 'Y'
  8231         MOVE W-PROMPT-LETTER           TO PI-PROMPT-LETTER
  8232         MOVE ER-0894                   TO EMI-ERROR
  8233         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8234     ELSE
  8235         MOVE 'N'                       TO PI-PROMPT-LETTER
  8236     END-IF.
  8237
  8238     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
  8239                                           ENCO
  8240     MOVE AL-UANON                      TO ENCA
  8241     MOVE +3                            TO ENCL
  8242     MOVE 'N'                           TO CLEANO
  8243     MOVE W-AUTO-CLOSE-IND              TO PI-AUTO-CLOSE-IND.
  8244     MOVE W-LETTER-TO-BENE              TO PI-LETTER-TO-BENE.
  8245
  8246 2800-EXIT.
  8247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 160
* EL152.cbl
  8249 3000-RECORD.
  8250***************************************************************
  8251*    THIS ROUTINE WILL SAVE THE LETTER TEXT (IF ANY) AND      *
  8252*    BUILD A CORRESPONDENCE TRAILER WITH THE DATA FROM        *
  8253*    THE SCREEN.                                              *
  8254***************************************************************
  8255
  8256     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8257        MOVE ER-0211             TO EMI-ERROR
  8258        MOVE -1                  TO MAINTL
  8259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8260        GO TO 8200-SEND-DATAONLY.
  8261
  8262
  8263* EXEC CICS HANDLE CONDITION
  8264*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  8265*         NOTFND     (3010-NOT-FOUND)
  8266*    END-EXEC.
  8267*    MOVE '"$JI                  ! ( #00008015' TO DFHEIV0
  8268     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8269     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8270     MOVE X'2820233030303038303135' TO DFHEIV0(25:11)
  8271     CALL 'kxdfhei1' USING DFHEIV0
  8272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8273
  8274
  8275     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8276     PERFORM 7950-SET-INDX     THRU 7950-EXIT.
  8277
  8278     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8279             VARYING SC-INDX FROM 1 BY 1
  8280             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8281
  8282     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8283
  8284     IF NOT EMI-NO-ERRORS
  8285        GO TO 8200-SEND-DATAONLY.
  8286
  8287     MOVE ZEROS               TO ARCH-NUMBER.
  8288     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8289     MOVE ER-0000             TO EMI-ERROR.
  8290     MOVE -1                  TO MAINTL.
  8291     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8292     GO TO 8200-SEND-DATAONLY.
  8293
  8294 3010-NOT-FOUND.
  8295     MOVE ER-0133             TO EMI-ERROR.
  8296     MOVE -1                  TO MAINTL.
  8297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8298     GO TO 8200-SEND-DATAONLY.
  8299
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 161
* EL152.cbl
  8301*4000-SET-BSR. Remove as dead code
  8302*4001-READ-NEXT. Remove as dead code
  8303*4002-ENDBR. Remove as dead code
  8304*4000-EXIT. Remove as dead code
  8305
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 162
* EL152.cbl
  8307 5000-MOVE-NAME.
  8308*    COPY ELCMNS.
  8309*****************************************************************
  8310*                                                               *
  8311*                                                               *
  8312*                            ELCMNS.                            *
  8313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8314*                            VMOD=2.002                         *
  8315*                                                               *
  8316*                     M O V E   N A M E   R O U T I N E         *
  8317*                                                               *
  8318*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8319*            NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8320*            NO EMBEDDED BLANKS.                                *
  8321*                                                               *
  8322*                  FIELD               VALUE                    *
  8323*                                                               *
  8324*                LAST NAME (CL15)      SMITH                    *
  8325*                1ST NAME  (CL12)      JOHN                     *
  8326*                MID NAME  (CL12)      ALLEN                    *
  8327*                                                               *
  8328*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8329*                                                               *
  8330*                        SMITH, JOHN ALLEN                      *
  8331*                                                               *
  8332*                TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8333*            STORAGE COPYBOOK:                                  *
  8334*                                                               *
  8335*                01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8336*                                                               *
  8337*****************************************************************.
  8338
  8339     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8340     MOVE ZERO                   TO  WS-NAME-SW.
  8341     SET NWA-INDEX TO +1.
  8342
  8343     IF CL-INSURED-1ST-NAME = SPACES  AND
  8344        CL-INSURED-MID-INIT = SPACES
  8345         MOVE +1                 TO  WS-NAME-SW.
  8346
  8347     MOVE CL-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8348     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8349
  8350     MOVE CL-INSURED-1ST-NAME   TO  WS-NAME-WORK2.
  8351     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8352
  8353     SET NWA-INDEX UP BY +1.
  8354     MOVE CL-INSURED-MID-INIT   TO  WS-NAME-WORK2.
  8355     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8356
  8357 5000-EXIT.
  8358     EXIT.
  8359
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 163
* EL152.cbl
  8361 5100-MOVE-NAME SECTION.
  8362     IF WS-NAME-SW GREATER THAN +1
  8363         GO TO 5190-EXIT.
  8364
  8365     IF WS-NAME-WORK2 = SPACES
  8366         GO TO 5190-EXIT.
  8367
  8368     SET NWA-INDEX2 TO +1.
  8369     SET NWA-INDEX3 TO +2.
  8370
  8371 5110-MOVE-NAME.
  8372     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8373
  8374     IF NWA-INDEX LESS THAN +30
  8375         SET NWA-INDEX UP BY +1
  8376       ELSE
  8377         ADD +2  TO  WS-NAME-SW
  8378         GO TO 5190-EXIT.
  8379
  8380     IF NWA-INDEX2 LESS THAN +20
  8381         SET NWA-INDEX3 UP BY +1
  8382         SET NWA-INDEX2 UP BY +1.
  8383
  8384     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8385        WS-NW2 (NWA-INDEX3) = SPACES
  8386         IF WS-NAME-SW = ZERO
  8387             MOVE ','            TO  WS-NW (NWA-INDEX)
  8388             SET NWA-INDEX UP BY +2
  8389             MOVE +1             TO  WS-NAME-SW
  8390             GO TO 5190-EXIT
  8391           ELSE
  8392             GO TO 5190-EXIT.
  8393
  8394     GO TO 5110-MOVE-NAME.
  8395
  8396 5190-EXIT.
  8397     EXIT.
  8398
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 164
* EL152.cbl
  8400 5200-MOVE-NAME.
  8401*    NOTE *******************************************************
  8402*         *           M O V E   N A M E   R O U T I N E         *
  8403*         *                                                     *
  8404*         *      THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8405*         *  NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8406*         *  NO EMBEDDED BLANKS.                                *
  8407*         *                                                     *
  8408*         *        FIELD               VALUE                    *
  8409*         *                                                     *
  8410*         *      LAST NAME (CL15)      SMITH                    *
  8411*         *      1ST NAME  (CL12)      JOHN                     *
  8412*         *      MID NAME  (CL1)       A                        *
  8413*         *                                                     *
  8414*         *      AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8415*         *                                                     *
  8416*         *              JOHN A. SMITH                          *
  8417*         *                                                     *
  8418*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8419*         *  STORAGE COPYBOOK:                                  *
  8420*         *                                                     *
  8421*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8422*         *                                                     *
  8423*         *******************************************************.
  8424
  8425     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8426     MOVE ZERO                   TO  WS-NAME-SW.
  8427     SET NWA-INDEX TO +1.
  8428
  8429     IF W-FIRST-NAME = SPACES
  8430             AND
  8431        W-MIDDLE-NAME = SPACES
  8432         MOVE W-LAST-NAME        TO WS-NAME-WORK
  8433         GO TO 5200-EXIT.
  8434
  8435     MOVE W-FIRST-NAME           TO  WS-NAME-WORK2.
  8436     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8437
  8438     SET NWA-INDEX UP BY +1.
  8439
  8440     IF W-MIDDLE-NAME NOT = SPACES
  8441        MOVE W-MIDDLE-NAME       TO  WS-NW (NWA-INDEX)
  8442        SET NWA-INDEX UP BY +1
  8443        MOVE '.'                 TO  WS-NW (NWA-INDEX)
  8444        SET NWA-INDEX UP BY +2.
  8445
  8446     MOVE W-LAST-NAME            TO  WS-NAME-WORK2.
  8447     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8448
  8449 5200-EXIT.
  8450     EXIT.
  8451
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 165
* EL152.cbl
  8453 5300-MOVE-NAME.
  8454     IF WS-NAME-SW > +1
  8455         GO TO 5390-EXIT.
  8456
  8457     IF WS-NAME-WORK2 = SPACES
  8458         GO TO 5390-EXIT.
  8459
  8460     SET NWA-INDEX2 TO +1.
  8461     SET NWA-INDEX3 TO +2.
  8462
  8463 5310-MOVE-NAME.
  8464     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8465
  8466     IF NWA-INDEX < +30
  8467        SET NWA-INDEX UP BY +1
  8468     ELSE
  8469        ADD +2  TO  WS-NAME-SW
  8470        GO TO 5390-EXIT.
  8471
  8472     IF NWA-INDEX2 < +20
  8473         SET NWA-INDEX2 UP BY +1
  8474         SET NWA-INDEX3 UP BY +1.
  8475
  8476     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8477        WS-NW2 (NWA-INDEX3) = SPACES
  8478        GO TO 5390-EXIT.
  8479
  8480     GO TO 5310-MOVE-NAME.
  8481
  8482 5390-EXIT.
  8483     EXIT.
  8484
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 166
* EL152.cbl
  8486 6100-ADDR-MAINT.
  8487***************************************************************
  8488*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8489*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8490*    IT WILL THEN XCTL TO THE ADDRESS MAINT PROGRAM.          *
  8491***************************************************************
  8492
  8493     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8494
  8495     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8496     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8497             VARYING SC-INDX FROM 1 BY 1
  8498             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8499
  8500     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8501        MOVE ER-0343             TO EMI-ERROR
  8502        MOVE -1                  TO MAINTL
  8503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8504        GO TO 8200-SEND-DATAONLY.
  8505
  8506*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8507*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8508*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8509*            VARYING SC-INDX FROM 1 BY 1
  8510*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8511
  8512     PERFORM 7700-PUT-TEMP-STOR    THRU 7749-EXIT.
  8513     PERFORM 7790-WRITE-SCREEN-TS  THRU 7790-EXIT.
  8514     PERFORM 7795-WRITE-PI-AREA-TS THRU 7795-EXIT.
  8515     MOVE PGM-EL141 TO PGM-NAME.
  8516
  8517     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 167
* EL152.cbl
  8519 6200-EDIT-MODE.
  8520***************************************************************
  8521*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8522*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8523*    IT WILL THEN XCTL TO THE TEXT-EDITOR PROGRAM.            *
  8524***************************************************************
  8525     IF PI-SHOW-MODE
  8526        MOVE ER-0188             TO EMI-ERROR
  8527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8528        MOVE -1                  TO MAINTL
  8529        MOVE AL-UABON            TO MAINTA
  8530        GO TO 8200-SEND-DATAONLY
  8531     END-IF
  8532
  8533*    IF PI-COMPANY-ID = 'DMD'
  8534*        IF PI-BSR-AUTOMATED
  8535*            MOVE ER-0912        TO EMI-ERROR
  8536*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8537*            MOVE -1             TO MAINTL
  8538*            MOVE AL-UABON       TO MAINTA
  8539*            GO TO 8200-SEND-DATAONLY.
  8540
  8541     IF PI-CURRENT-LINE = ZEROS
  8542        MOVE ER-0187             TO EMI-ERROR
  8543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8544        MOVE -1                  TO MAINTL
  8545        GO TO 8200-SEND-DATAONLY.
  8546
  8547     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8548     PERFORM 7750-DELETE-TEMP-STOR
  8549                                 THRU 7750-EXIT
  8550     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8551     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8552             VARYING SC-INDX FROM 1 BY 1
  8553             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8554
  8555     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT.
  8556     PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
  8557
  8558     MOVE PI-FORM-NUMBER         TO PI-COMM-CONTROL.
  8559     MOVE ZEROS                  TO PI-UPDATE-SW.
  8560     MOVE '1'                    TO PI-ENTRY-CD-1.
  8561     MOVE PGM-EL1042             TO PGM-NAME.
  8562     GO TO 9300-XCTL.
  8563
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 168
* EL152.cbl
  8565 6400-LETTER-RELEASE.
  8566***************************************************************
  8567*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
  8568*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS ONTO     *
  8569*    THE ARCHIVE FILE.                                        *
  8570*    THE FOLLOWING FUNCTIONS WILL BE PERFORMED                *
  8571*        1. CHECK SECURITY AND IF IT IS A DESIGNATED LETTER.  *
  8572*        2. RE-EDIT DATA AND UPDATE TS-TABLE WITH CHANGES     *
  8573*        3. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS         *
  8574*        4. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
  8575*        5. WRITE THE NEW ARCHIVE RECORDS FROM TS-TABLE.      *
  8576*        7. BUILD A CORRESPONDENCE TRAILER                    *
  8577*        8. BUILD OR UPDATE THE ACTIVITY QUE FILE WITH THE    *
  8578*                 ARCHIVE NUMBER IF IT IS TO BE PRINTED LATER.*
  8579*        4. RESET ALL CONTROL FIELDS AND RETURN THE           *
  8580*                 ARCHIVE NUMBER USED TO FILE THE RECORDS.    *
  8581***************************************************************
  8582
  8583     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8584
  8585     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8586     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8587             VARYING SC-INDX FROM 1 BY 1
  8588             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8589
  8590     IF NOT MODIFY-CAP
  8591        MOVE ER-0070             TO EMI-ERROR
  8592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8593        MOVE -1                  TO MAINTL
  8594        GO TO 8200-SEND-DATAONLY.
  8595
  8596     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8597        MOVE ER-0211             TO EMI-ERROR
  8598        MOVE -1                  TO MAINTL
  8599        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8600        GO TO 8200-SEND-DATAONLY.
  8601
  8602*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8603*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8604*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8605*            VARYING SC-INDX FROM 1 BY 1
  8606*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8607
  8608     IF PI-ADDR-TYPE  NOT =  ADDRI
  8609        PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8610
  8611     IF NOT EMI-NO-ERRORS
  8612        GO TO 8200-SEND-DATAONLY.
  8613
  8614     MOVE +0                     TO TALLY.
  8615     INSPECT RECORD-TABLE TALLYING TALLY
  8616                                 FOR CHARACTERS BEFORE '@'.
  8617
  8618     IF TALLY < +21900
  8619        COMPUTE PI-CURRENT-LINE = TALLY / 73
  8620        MOVE ZEROS               TO ROLL-COUNTER
  8621        MOVE ER-0191             TO EMI-ERROR
  8622        MOVE -1                  TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 169
* EL152.cbl
  8623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8624        GO TO 7900-ROLL-PAGE.
  8625
  8626     MOVE '1'                    TO CNTL-RECORD-TYPE.
  8627     MOVE ZEROS                  TO CNTL-SEQ.
  8628     MOVE SPACES                 TO CNTL-GENL.
  8629
  8630* EXEC CICS READ
  8631*         DATASET    (CNTL-ID)
  8632*         SET        (ADDRESS OF CONTROL-FILE)
  8633*         RIDFLD     (CNTL-KEY)
  8634*         UPDATE
  8635*    END-EXEC.
  8636*    MOVE '&"S        EU         (   #00008374' TO DFHEIV0
  8637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8638     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8639     MOVE X'2020233030303038333734' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0,
  8641           CNTL-ID,
  8642           DFHEIV20,
  8643           DFHEIV99,
  8644           CNTL-KEY,
  8645           DFHEIV99,
  8646           DFHEIV99,
  8647           DFHEIV99
  8648     SET ADDRESS OF CONTROL-FILE TO
  8649         DFHEIV20
  8650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8651
  8652
  8653     ADD 1                       TO CF-CO-ARCHIVE-COUNTER.
  8654     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
  8655     MOVE CF-PRINT-ADDRESS-LABELS   TO  WS-LABELS-SW.
  8656
  8657
  8658* EXEC CICS REWRITE
  8659*         FROM      (CONTROL-FILE)
  8660*         DATASET   (CNTL-ID)
  8661*    END-EXEC
  8662     MOVE LENGTH OF
  8663      CONTROL-FILE
  8664       TO DFHEIV11
  8665*    MOVE '&& L                  %   #00008385' TO DFHEIV0
  8666     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8667     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8668     MOVE X'2020233030303038333835' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           CNTL-ID,
  8671           CONTROL-FILE,
  8672           DFHEIV11,
  8673           DFHEIV99
  8674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8675
  8676     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8677
  8678
  8679* EXEC CICS HANDLE CONDITION
  8680*         NOTOPEN   (9990-ABEND)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 170
* EL152.cbl
  8681*    END-EXEC.
  8682*    MOVE '"$J                   ! ) #00008392' TO DFHEIV0
  8683     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  8684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8685     MOVE X'2920233030303038333932' TO DFHEIV0(25:11)
  8686     CALL 'kxdfhei1' USING DFHEIV0
  8687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8688
  8689
  8690
  8691* EXEC CICS GETMAIN
  8692*         SET      (ADDRESS OF LETTER-ARCHIVE)
  8693*         LENGTH   (ARCH-LENGTH)
  8694*    END-EXEC.
  8695*    MOVE '," L                  $   #00008396' TO DFHEIV0
  8696     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8697     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8698     MOVE X'2020233030303038333936' TO DFHEIV0(25:11)
  8699     CALL 'kxdfhei1' USING DFHEIV0,
  8700           DFHEIV20,
  8701           ARCH-LENGTH,
  8702           DFHEIV99
  8703     SET ADDRESS OF LETTER-ARCHIVE TO
  8704         DFHEIV20
  8705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8706
  8707
  8708     MOVE SPACES                 TO LETTER-ARCHIVE.
  8709     MOVE 'LA'                   TO LA-RECORD-ID.
  8710     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8711                                    LA-ARCHIVE-NO-A1.
  8712     MOVE '1'                    TO LA-RECORD-TYPE
  8713                                    LA-RECORD-TYPE-A1.
  8714     MOVE ZEROS                  TO LA-LINE-SEQ-NO
  8715                                    LA-LINE-SEQ-NO-A1.
  8716     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8717                                    LA-COMPANY-CD-A1.
  8718     MOVE CLAM-CARRIER           TO LA-CARRIER.
  8719     MOVE PI-CLAIM-NO            TO LA-CLAIM-NO.
  8720     MOVE PI-CERT-NO             TO LA-CERT-NO.
  8721
  8722*    IF PI-COMPANY-ID = 'DMD'
  8723*        MOVE WS-DMD-CERT-STATE    TO LA-DMD-UND-CODE
  8724*        MOVE WS-DMD-CERT-GROUPING TO LA-DMD-PROD-CODE
  8725*        MOVE WS-DMD-BEN-CODE      TO LA-DMD-BEN-CODE
  8726*        MOVE WS-DMD-CORR-TRLR-SEQ TO LA-DMD-CORR-TRLR-SEQ
  8727*        MOVE WS-DMD-LETTER-FORM   TO LA-DMD-LETTER-FORM
  8728*        MOVE WS-DMD-RES-ST        TO LA-DMD-RES-ST
  8729*        MOVE LOW-VALUES           TO LA-DMD-LETTER-PURGE-DT
  8730*                                     LA-DMD-LETTER-RELOAD-DT
  8731*        MOVE '1'                  TO LA-DMD-LETTER-STATUS
  8732*        EXEC CICS GETMAIN
  8733*            SET    (ADDRESS OF LETTER-ARCHIVE-TEMP)
  8734*            LENGTH (ARCT-LENGTH)
  8735*        END-EXEC.
  8736
  8737     IF COPIESL NOT = ZEROS
  8738        MOVE COPIESI             TO LA-NO-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 171
* EL152.cbl
  8739     ELSE
  8740        MOVE  1                  TO LA-NO-OF-COPIES.
  8741
  8742     IF RESENDL NOT = ZEROS
  8743        MOVE RESEND-SAVE         TO LA-RESEND-DATE
  8744     ELSE
  8745        MOVE LOW-VALUES          TO LA-RESEND-DATE.
  8746
  8747     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
  8748     MOVE CURRENT-SAVE           TO LA-CREATION-DT.
  8749
  8750     IF PRINT-PERFORMED
  8751        MOVE CURRENT-SAVE        TO LA-INITIAL-PRINT-DATE
  8752     ELSE
  8753        MOVE LOW-VALUES          TO LA-INITIAL-PRINT-DATE.
  8754
  8755     MOVE LOW-VALUES             TO LA-RESEND-PRINT-DATE.
  8756     MOVE CORR-TRLR-SEQ          TO LA-CORR-TRLR-SEQ.
  8757     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8758
  8759     IF PI-PROMPT-LETTER NOT EQUAL 'Y'
  8760         PERFORM 6700-BUILD-NAPERSOFT THRU 6799-EXIT
  8761     END-IF.
  8762
  8763     IF WS-LABELS-SW = 'N'
  8764         NEXT SENTENCE
  8765     ELSE
  8766         SET TB-INDX TO 1
  8767         MOVE ZEROS                  TO SEQ-COUNTER
  8768         PERFORM 6480-FORMAT-ADDRESS
  8769               VARYING TB-INDX FROM 1 BY 1 UNTIL
  8770               TB-INDX > 6.
  8771
  8772     MOVE ZEROS                  TO SEQ-COUNTER.
  8773     MOVE 'N'                    TO WS-SKIP-EMAIL
  8774     PERFORM 6470-FORMAT-TEXT THRU 6479-EXIT
  8775             VARYING TB-INDX FROM 8 BY 1
  8776             UNTIL TB-INDX > PI-TOTAL-LINES.
  8777     MOVE 'Y'                    TO WS-SKIP-EMAIL.
  8778     IF SEQ-COUNTER < +15
  8779      AND WS-SKIP-EMAIL EQUAL 'N'
  8780        MOVE ARCH-NUMBER         TO TRAN-DL2-ARCHNO
  8781        MOVE PI-PROCESSOR-ID     TO TRAN-DL2-USER
  8782        MOVE SPACES              TO TRAN-DL2-CCC
  8783        STRING PI-CARRIER ' ' PI-CLAIM-NO ' ' PI-CERT-NO
  8784           DELIMITED BY SIZE
  8785           INTO TRAN-DL2-CCC
  8786        END-STRING
  8787
  8788* EXEC CICS WRITEQ TD
  8789*          QUEUE ('BTCH')
  8790*          FROM (TRAN-DATA-LINE1)
  8791*          LENGTH (80)
  8792*       END-EXEC
  8793     MOVE 80
  8794       TO DFHEIV11
  8795     MOVE 'BTCH' TO DFHEIV5
  8796*    MOVE '(" L                  &   #00008480' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 172
* EL152.cbl
  8797     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8798     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8799     MOVE X'2020233030303038343830' TO DFHEIV0(25:11)
  8800     CALL 'kxdfhei1' USING DFHEIV0,
  8801           DFHEIV5,
  8802           TRAN-DATA-LINE1,
  8803           DFHEIV11,
  8804           DFHEIV99,
  8805           DFHEIV99
  8806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8807
  8808* EXEC CICS WRITEQ TD
  8809*          QUEUE ('BTCH')
  8810*          FROM (TRAN-DATA-LINE2)
  8811*          LENGTH (80)
  8812*       END-EXEC
  8813     MOVE 80
  8814       TO DFHEIV11
  8815     MOVE 'BTCH' TO DFHEIV5
  8816*    MOVE '(" L                  &   #00008485' TO DFHEIV0
  8817     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8819     MOVE X'2020233030303038343835' TO DFHEIV0(25:11)
  8820     CALL 'kxdfhei1' USING DFHEIV0,
  8821           DFHEIV5,
  8822           TRAN-DATA-LINE2,
  8823           DFHEIV11,
  8824           DFHEIV99,
  8825           DFHEIV99
  8826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8827
  8828* EXEC CICS WRITEQ TD
  8829*          QUEUE ('BTCH')
  8830*          FROM (TRAN-DATA-LINE3)
  8831*          LENGTH (80)
  8832*       END-EXEC
  8833     MOVE 80
  8834       TO DFHEIV11
  8835     MOVE 'BTCH' TO DFHEIV5
  8836*    MOVE '(" L                  &   #00008490' TO DFHEIV0
  8837     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8838     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8839     MOVE X'2020233030303038343930' TO DFHEIV0(25:11)
  8840     CALL 'kxdfhei1' USING DFHEIV0,
  8841           DFHEIV5,
  8842           TRAN-DATA-LINE3,
  8843           DFHEIV11,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8847     END-IF
  8848     MOVE ER-0280                TO EMI-ERROR.
  8849
  8850     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8851     MOVE ARCH-NUMBER            TO ARCH-SUPPRESS
  8852     MOVE ARCH-EDIT              TO EMI-TEXT-VARIABLE (1).
  8853
  8854     GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 173
* EL152.cbl
  8855
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 174
* EL152.cbl
  8857 6470-FORMAT-TEXT.
  8858
  8859     IF REC-TEXT (TB-INDX) (1:16) = NAPERSOFT-LETTER
  8860         MOVE 'Y'                TO WS-SKIP-EMAIL
  8861     END-IF.
  8862
  8863     MOVE SPACES                 TO LETTER-ARCHIVE.
  8864     MOVE '3'                    TO LA-RECORD-TYPE
  8865                                    LA-RECORD-TYPE-A1.
  8866     MOVE 'LA'                   TO LA-RECORD-ID.
  8867     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8868                                    LA-ARCHIVE-NO-A1.
  8869     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8870                                    LA-LINE-SEQ-NO-A1.
  8871     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8872                                    LA-COMPANY-CD-A1.
  8873     MOVE REC-TEXT (TB-INDX)     TO LA-TEXT-LINE.
  8874     SET TB-INDX1 TO TB-INDX.
  8875     SET TB-INDX1 UP BY 1.
  8876     MOVE ZEROS                  TO INDX-WORK.
  8877
  8878 6472-LOOP.
  8879     IF TB-INDX1 < PI-TOTAL-LINES AND
  8880        REC-TEXT (TB-INDX1) = SPACES
  8881           SET TB-INDX1 UP BY 1
  8882           ADD 1                 TO INDX-WORK
  8883           GO TO 6472-LOOP.
  8884
  8885     IF REC-TEXT (TB-INDX1) = TOP-FORM
  8886        MOVE '99'                TO LA-SKIP-CONTROL
  8887        SET TB-INDX1 UP BY 1
  8888     ELSE
  8889        MOVE INDX-WORK           TO LA-SKIP-CONTROL.
  8890
  8891     SET TB-INDX TO TB-INDX1.
  8892     SET TB-INDX DOWN BY 1.
  8893     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8894     ADD 1 TO SEQ-COUNTER.
  8895
  8896 6479-EXIT.
  8897      EXIT.
  8898
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 175
* EL152.cbl
  8900 6480-FORMAT-ADDRESS.
  8901     MOVE SPACES                 TO LETTER-ARCHIVE.
  8902     MOVE '2'                    TO LA-RECORD-TYPE
  8903                                    LA-RECORD-TYPE-A1.
  8904     MOVE 'LA'                   TO LA-RECORD-ID.
  8905     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8906                                    LA-ARCHIVE-NO-A1.
  8907     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8908                                    LA-LINE-SEQ-NO-A1.
  8909     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8910                                    LA-COMPANY-CD-A1.
  8911     MOVE REC-TEXT (TB-INDX)     TO LA-ADDRESS-LINE.
  8912
  8913     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8914     ADD 1 TO SEQ-COUNTER.
  8915
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 176
* EL152.cbl
  8917 6490-WRITE-ARCHIVE.
  8918
  8919* EXEC CICS HANDLE CONDITION
  8920*        DUPKEY    (6499-EXIT)
  8921*    END-EXEC.
  8922*    MOVE '"$$                   ! * #00008566' TO DFHEIV0
  8923     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8925     MOVE X'2A20233030303038353636' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0
  8927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8928
  8929
  8930*    IF PI-COMPANY-ID = 'DMD'
  8931*        MOVE LETTER-ARCHIVE     TO LETTER-ARCHIVE-TEMP
  8932*        MOVE 'LT'               TO LT-RECORD-ID
  8933*        EXEC CICS WRITE
  8934*            DATASET   (ARCT-ID)
  8935*            FROM      (LETTER-ARCHIVE-TEMP)
  8936*            RIDFLD    (LT-CONTROL-PRIMARY)
  8937*        END-EXEC.
  8938
  8939
  8940* EXEC CICS WRITE
  8941*         DATASET   (ARCH-ID)
  8942*         FROM      (LETTER-ARCHIVE)
  8943*         RIDFLD    (LA-CONTROL-PRIMARY)
  8944*    END-EXEC.
  8945     MOVE LENGTH OF
  8946      LETTER-ARCHIVE
  8947       TO DFHEIV11
  8948*    MOVE '&$ L                  ''   #00008579' TO DFHEIV0
  8949     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8950     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8951     MOVE X'2020233030303038353739' TO DFHEIV0(25:11)
  8952     CALL 'kxdfhei1' USING DFHEIV0,
  8953           ARCH-ID,
  8954           LETTER-ARCHIVE,
  8955           DFHEIV11,
  8956           LA-CONTROL-PRIMARY,
  8957           DFHEIV99,
  8958           DFHEIV99
  8959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8960
  8961
  8962 6499-EXIT.
  8963     EXIT.
  8964
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 177
* EL152.cbl
  8966 6500-BUILD-CORRESPOND.
  8967***************************************************************
  8968*    THIS ROUTINE WILL GET THE TRAILER SEQUENCE NUMBER FROM   *
  8969*    THE CLAIM MASTER AND BUILD A CORRESPONDENCE TRAILER      *
  8970*    USING THE NEW SEQUENCE NUMBER.                           *
  8971*    INPUT DATA FROM THE SCREEN IS USED TO CREATE THE NEW     *
  8972*    TRAILER RECORD.                                          *
  8973***************************************************************
  8974
  8975     MOVE PI-CLAIM-NO            TO CLAM-CLAIM.
  8976
  8977
  8978* EXEC CICS READ
  8979*         DATASET    (CLAM-ID)
  8980*         SET        (ADDRESS OF CLAIM-MASTER)
  8981*         RIDFLD     (CLAM-KEY)
  8982*         UPDATE
  8983*    END-EXEC.
  8984*    MOVE '&"S        EU         (   #00008600' TO DFHEIV0
  8985     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8986     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8987     MOVE X'2020233030303038363030' TO DFHEIV0(25:11)
  8988     CALL 'kxdfhei1' USING DFHEIV0,
  8989           CLAM-ID,
  8990           DFHEIV20,
  8991           DFHEIV99,
  8992           CLAM-KEY,
  8993           DFHEIV99,
  8994           DFHEIV99,
  8995           DFHEIV99
  8996     SET ADDRESS OF CLAIM-MASTER TO
  8997         DFHEIV20
  8998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8999
  9000
  9001     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  9002
  9003     IF FOLLOW-UP-SAVE > CL-NEXT-FOLLOWUP-DT
  9004        MOVE FOLLOW-UP-SAVE      TO CL-NEXT-FOLLOWUP-DT.
  9005
  9006     IF RESEND-SAVE > CL-NEXT-FOLLOWUP-DT
  9007        MOVE RESEND-SAVE         TO CL-NEXT-FOLLOWUP-DT.
  9008
  9009     IF MAINTI = 'C'
  9010        MOVE '2'                 TO CL-LAST-MAINT-TYPE.
  9011
  9012     IF MAINTI = 'R'
  9013        PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT
  9014        MOVE ACTV-SEQ            TO PI-ADDR-SEQ.
  9015
  9016*    IF PI-COMPANY-ID = 'DMD'
  9017*        MOVE 04                 TO CL-ACTIVITY-CODE.
  9018
  9019
  9020* EXEC CICS GETMAIN
  9021*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9022*         INITIMG   (GETMAIN-SPACE)
  9023*         LENGTH    (ACTV-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 178
* EL152.cbl
  9024*    END-EXEC.
  9025*    MOVE ',"IL                  $   #00008625' TO DFHEIV0
  9026     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9027     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9028     MOVE X'2020233030303038363235' TO DFHEIV0(25:11)
  9029     CALL 'kxdfhei1' USING DFHEIV0,
  9030           DFHEIV20,
  9031           ACTV-LENGTH,
  9032           GETMAIN-SPACE
  9033     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9034         DFHEIV20
  9035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9036
  9037
  9038     MOVE 'AT'                   TO AT-RECORD-ID.
  9039     MOVE  4                     TO AT-TRAILER-TYPE.
  9040     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  9041                                    CL-LAST-MAINT-DT
  9042                                    AT-CORR-LAST-MAINT-DT
  9043     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9044                                    CL-LAST-MAINT-USER
  9045                                    AT-CORR-LAST-UPDATED-BY
  9046     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  9047                                    CL-LAST-MAINT-HHMMSS.
  9048     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  9049     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  9050     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  9051                                    CORR-TRLR-SEQ.
  9052     MOVE CURRENT-SAVE           TO AT-LETTER-SENT-DT.
  9053     MOVE FOLLOW-UP-SAVE         TO AT-RECEIPT-FOLLOW-UP.
  9054     MOVE RESEND-SAVE            TO AT-AUTO-RE-SEND-DT.
  9055     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  9056                                    AT-LETTER-PURGED-DT.
  9057     MOVE ARCH-NUMBER            TO AT-LETTER-ARCHIVE-NO.
  9058     MOVE '1'                    TO AT-LETTER-ORIGIN.
  9059     MOVE PI-RESEND-FORM-NUMBER  TO AT-RESEND-LETTER-FORM.
  9060     MOVE PI-AUTO-CLOSE-IND      TO AT-AUTO-CLOSE-IND.
  9061     MOVE PI-LETTER-TO-BENE      TO AT-LETTER-TO-BENE.
  9062
  9063*    IF PI-COMPANY-ID = 'DMD'
  9064*        MOVE '1'                TO AT-DMD-LETTER-STATUS
  9065*        IF PI-BSR-AUTOMATED
  9066*            MOVE 'A'            TO AT-DMD-BSR-CODE.
  9067*
  9068     IF FORML  NOT = ZEROS
  9069        MOVE FORMI               TO AT-STD-LETTER-FORM
  9070     ELSE
  9071        MOVE SPACES              TO AT-STD-LETTER-FORM.
  9072
  9073     IF REL NOT = ZEROS
  9074        MOVE REI                 TO AT-REASON-TEXT
  9075     ELSE
  9076        MOVE SPACES              TO AT-REASON-TEXT.
  9077
  9078*    IF PI-COMPANY-ID = 'HAN'  OR  'JHL'
  9079*        MOVE AT-REASON-TEXT     TO WS-REASON-TEXT
  9080*        IF WS-RE-NDX NUMERIC  AND
  9081*           WS-RE-NDX > ZERO   AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 179
* EL152.cbl
  9082*           WS-RE-NDX < 33
  9083*            MOVE HAN-REASON-TEXT (WS-RE-NDX)
  9084*                                TO AT-REASON-TEXT.
  9085
  9086     MOVE PI-ADDR-SEQ            TO AT-ADDRESS-REC-SEQ-NO.
  9087
  9088     IF PI-ADDR-TYPE > SPACES
  9089         MOVE PI-ADDR-TYPE          TO AT-ADDRESEE-TYPE
  9090         MOVE REC-TEXT (1)          TO AT-ADDRESSEE-NAME
  9091     ELSE
  9092     IF W-ACCOUNT > ZEROS
  9093         MOVE 'A'                   TO AT-ADDRESEE-TYPE
  9094         MOVE SS06D                 TO AT-ADDRESSEE-NAME
  9095     ELSE
  9096     IF W-BENEFICIARY > ZEROS
  9097          MOVE 'B'                  TO AT-ADDRESEE-TYPE
  9098          IF W-BENEFICIARY = 9
  9099              MOVE SS61D            TO AT-ADDRESSEE-NAME
  9100            ELSE
  9101              MOVE SS43D            TO AT-ADDRESSEE-NAME
  9102     ELSE
  9103     IF W-EMPLOYER > ZEROS
  9104          MOVE 'E'                  TO AT-ADDRESEE-TYPE
  9105          MOVE SS48D                TO AT-ADDRESSEE-NAME
  9106     ELSE
  9107     IF W-INSURED > ZEROS
  9108          MOVE 'I'                  TO AT-ADDRESEE-TYPE
  9109          MOVE SS57D                TO AT-ADDRESSEE-NAME
  9110     ELSE
  9111     IF W-PHYSICIAN > ZEROS
  9112          MOVE 'P'                  TO AT-ADDRESEE-TYPE
  9113          MOVE SS47D                TO AT-ADDRESSEE-NAME
  9114     ELSE
  9115     IF W-OTHER-1 > ZEROS
  9116          MOVE 'O'                  TO AT-ADDRESEE-TYPE
  9117          MOVE SS49D                TO AT-ADDRESSEE-NAME
  9118     ELSE
  9119     IF W-OTHER-2 > ZEROS
  9120          MOVE 'Q'                  TO AT-ADDRESEE-TYPE
  9121          MOVE SS50D                TO AT-ADDRESSEE-NAME
  9122     ELSE
  9123          MOVE SPACES               TO AT-ADDRESEE-TYPE
  9124                                       AT-ADDRESSEE-NAME.
  9125     IF PRINT-PERFORMED
  9126        MOVE CURRENT-SAVE        TO AT-INITIAL-PRINT-DATE
  9127     ELSE
  9128        MOVE LOW-VALUES          TO AT-INITIAL-PRINT-DATE.
  9129
  9130     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE.
  9131
  9132*    IF PI-COMPANY-ID = 'DMD'
  9133*        MOVE CL-CERT-STATE          TO WS-DMD-CERT-STATE
  9134*        MOVE CL-CERT-GROUPING (5:2) TO WS-DMD-CERT-GROUPING
  9135*        MOVE BEN-HOLD               TO WS-DMD-BEN-CODE
  9136*        MOVE AT-SEQUENCE-NO         TO WS-DMD-CORR-TRLR-SEQ
  9137*        MOVE AT-STD-LETTER-FORM     TO WS-DMD-LETTER-FORM.
  9138
  9139
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 180
* EL152.cbl
  9140* EXEC CICS WRITE
  9141*         DATASET    (ACTV-ID)
  9142*         FROM       (ACTIVITY-TRAILERS)
  9143*         RIDFLD     (AT-CONTROL-PRIMARY)
  9144*    END-EXEC.
  9145     MOVE LENGTH OF
  9146      ACTIVITY-TRAILERS
  9147       TO DFHEIV11
  9148*    MOVE '&$ L                  ''   #00008732' TO DFHEIV0
  9149     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9150     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9151     MOVE X'2020233030303038373332' TO DFHEIV0(25:11)
  9152     CALL 'kxdfhei1' USING DFHEIV0,
  9153           ACTV-ID,
  9154           ACTIVITY-TRAILERS,
  9155           DFHEIV11,
  9156           AT-CONTROL-PRIMARY,
  9157           DFHEIV99,
  9158           DFHEIV99
  9159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9160
  9161
  9162
  9163* EXEC CICS HANDLE CONDITION
  9164*        DUPKEY      (6599-EXIT)
  9165*    END-EXEC.
  9166*    MOVE '"$$                   ! + #00008738' TO DFHEIV0
  9167     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9169     MOVE X'2B20233030303038373338' TO DFHEIV0(25:11)
  9170     CALL 'kxdfhei1' USING DFHEIV0
  9171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9172
  9173
  9174
  9175* EXEC CICS REWRITE
  9176*         DATASET    (CLAM-ID)
  9177*         FROM       (CLAIM-MASTER)
  9178*    END-EXEC.
  9179     MOVE LENGTH OF
  9180      CLAIM-MASTER
  9181       TO DFHEIV11
  9182*    MOVE '&& L                  %   #00008742' TO DFHEIV0
  9183     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9184     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9185     MOVE X'2020233030303038373432' TO DFHEIV0(25:11)
  9186     CALL 'kxdfhei1' USING DFHEIV0,
  9187           CLAM-ID,
  9188           CLAIM-MASTER,
  9189           DFHEIV11,
  9190           DFHEIV99
  9191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9192
  9193
  9194 6599-EXIT.
  9195      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 181
* EL152.cbl
  9197 6600-SET-ADDR-SEQ.
  9198     IF ADDRL = ZEROS
  9199        GO TO 6699-EXIT.
  9200
  9201     MOVE ADDRI                  TO PI-ADDR-TYPE
  9202                                    WS-ADDR-TYPE-CD.
  9203     IF WS-ADDR-SEQ NOT NUMERIC
  9204        GO TO 6699-EXIT.
  9205
  9206     MOVE ZEROS                  TO PI-ADDR-SEQ.
  9207
  9208     IF WS-ADDR-TYPE = 'I'
  9209        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9210     ELSE
  9211     IF WS-ADDR-TYPE = 'A'
  9212        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9213        ADD +20                  TO ACTV-SEQ
  9214     ELSE
  9215     IF WS-ADDR-TYPE = 'B'
  9216        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9217        ADD +10                  TO ACTV-SEQ
  9218     ELSE
  9219     IF WS-ADDR-TYPE = 'P'
  9220        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9221        ADD +30                  TO ACTV-SEQ
  9222     ELSE
  9223     IF WS-ADDR-TYPE = 'E'
  9224        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9225        ADD +40                  TO ACTV-SEQ
  9226     ELSE
  9227     IF WS-ADDR-TYPE = 'O'
  9228        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9229        ADD +50                  TO ACTV-SEQ
  9230     ELSE
  9231     IF WS-ADDR-TYPE = 'Q'
  9232        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9233        ADD +60                  TO ACTV-SEQ.
  9234
  9235 6699-EXIT.
  9236      EXIT.
  9237
  9238 6700-BUILD-NAPERSOFT.
  9239
  9240
  9241* EXEC CICS GETMAIN
  9242*         SET      (ADDRESS OF NAPERSOFT-FILE)
  9243*         LENGTH   (NAPS-LENGTH)
  9244*    END-EXEC.
  9245*    MOVE '," L                  $   #00008793' TO DFHEIV0
  9246     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9248     MOVE X'2020233030303038373933' TO DFHEIV0(25:11)
  9249     CALL 'kxdfhei1' USING DFHEIV0,
  9250           DFHEIV20,
  9251           NAPS-LENGTH,
  9252           DFHEIV99
  9253     SET ADDRESS OF NAPERSOFT-FILE TO
  9254         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 182
* EL152.cbl
  9255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9256
  9257
  9258     MOVE LOW-VALUES            TO  NAPERSOFT-FILE.
  9259     MOVE 'NA'                  TO  NA-RECORD-ID.
  9260     MOVE PI-COMPANY-CD         TO  NA-COMPANY-CD.
  9261     MOVE PI-CARRIER            TO  NA-CARRIER.
  9262     MOVE PI-CLAIM-NO           TO  NA-CLAIM-NO.
  9263     MOVE PI-CERT-NO            TO  NA-CERT-NO.
  9264     MOVE ARCH-NUMBER           TO  NA-ARCHIVE-NO.
  9265     MOVE FORMI                 TO  NA-LETTER-ID.
  9266     MOVE PI-PROCESSOR-ID       TO  NA-PROCESSOR-ID.
  9267     MOVE CURRENT-SAVE          TO  NA-CREATION-DT.
  9268     IF PRINT-PERFORMED
  9269         MOVE CURRENT-SAVE      TO  NA-INITIAL-PRINT-DT
  9270     ELSE
  9271         MOVE LOW-VALUES        TO  NA-INITIAL-PRINT-DT
  9272     END-IF.
  9273     MOVE FOLLOW-UP-SAVE        TO  NA-FOLLOW-UP-DT.
  9274     MOVE RESEND-SAVE           TO  NA-RESEND-DT
  9275     MOVE PI-RESEND-FORM-NUMBER TO  NA-RESEND-LETTER-ID.
  9276     IF COPIESL NOT = ZEROS
  9277         MOVE COPIESI           TO  NA-NO-OF-COPIES
  9278     ELSE
  9279         MOVE 1                 TO  NA-NO-OF-COPIES
  9280     END-IF.
  9281     IF PI-LETTER-ADDRESS-TYPE = ' 0'
  9282         MOVE LOW-VALUES        TO  NA-ADDRESS-TYPE
  9283     ELSE
  9284         MOVE PI-LETTER-ADDRESS-TYPE TO NA-ADDRESS-TYPE
  9285     END-IF.
  9286     MOVE CORR-TRLR-SEQ         TO  NA-CORR-TRLR-SEQ.
  9287     MOVE PI-ENCLOSURE-CD       TO  NA-ENCLOSURE-CD.
  9288
  9289
  9290* EXEC CICS WRITE
  9291*         DATASET    (NAPS-ID)
  9292*         FROM       (NAPERSOFT-FILE)
  9293*         RIDFLD     (NA-CONTROL-PRIMARY)
  9294*    END-EXEC.
  9295     MOVE LENGTH OF
  9296      NAPERSOFT-FILE
  9297       TO DFHEIV11
  9298*    MOVE '&$ L                  ''   #00008829' TO DFHEIV0
  9299     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9300     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9301     MOVE X'2020233030303038383239' TO DFHEIV0(25:11)
  9302     CALL 'kxdfhei1' USING DFHEIV0,
  9303           NAPS-ID,
  9304           NAPERSOFT-FILE,
  9305           DFHEIV11,
  9306           NA-CONTROL-PRIMARY,
  9307           DFHEIV99,
  9308           DFHEIV99
  9309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9310
  9311
  9312 6799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 183
* EL152.cbl
  9313      EXIT.
  9314
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 184
* EL152.cbl
  9316 7000-READ-ADDR.
  9317     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  9318        IF ADDRL = ZEROS
  9319           GO TO 7099-EXIT
  9320        ELSE
  9321           MOVE ER-0374             TO EMI-ERROR
  9322           MOVE -1                  TO ADDRL
  9323           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9324           GO TO 7099-EXIT.
  9325
  9326     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  9327                                    ACTV-CLAIM.
  9328
  9329
  9330* EXEC CICS HANDLE CONDITION
  9331*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  9332*         NOTFND     (7090-CLAIM-NOT-FOUND)
  9333*     END-EXEC.
  9334*    MOVE '"$JI                  ! , #00008852' TO DFHEIV0
  9335     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9337     MOVE X'2C20233030303038383532' TO DFHEIV0(25:11)
  9338     CALL 'kxdfhei1' USING DFHEIV0
  9339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9340
  9341
  9342
  9343* EXEC CICS READ
  9344*         DATASET    (CLAM-ID)
  9345*         SET        (ADDRESS OF CLAIM-MASTER)
  9346*         RIDFLD     (CLAM-KEY)
  9347*    END-EXEC.
  9348*    MOVE '&"S        E          (   #00008857' TO DFHEIV0
  9349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9351     MOVE X'2020233030303038383537' TO DFHEIV0(25:11)
  9352     CALL 'kxdfhei1' USING DFHEIV0,
  9353           CLAM-ID,
  9354           DFHEIV20,
  9355           DFHEIV99,
  9356           CLAM-KEY,
  9357           DFHEIV99,
  9358           DFHEIV99,
  9359           DFHEIV99
  9360     SET ADDRESS OF CLAIM-MASTER TO
  9361         DFHEIV20
  9362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9363
  9364
  9365*    IF PI-COMPANY-ID = 'DMD'
  9366*            AND
  9367*       NOT SYSTEM-MODIFY-CAP
  9368*            AND
  9369*        HIGHEST-PRIORITY
  9370*        IF MAINTI = 'R'
  9371*            MOVE ER-0909        TO EMI-ERROR
  9372*            MOVE -1             TO ADDRL
  9373*            MOVE AL-UABON       TO ADDRA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 185
* EL152.cbl
  9374*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9375*            GO TO 8200-SEND-DATAONLY
  9376*        ELSE
  9377*            MOVE ER-0900        TO EMI-ERROR
  9378*            MOVE -1             TO ADDRL
  9379*            MOVE AL-UABON       TO ADDRA
  9380*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9381*            GO TO 8200-SEND-DATAONLY.
  9382
  9383     IF ADDRL = ZEROS
  9384        GO TO 7099-EXIT.
  9385
  9386*    IF PI-COMPANY-ID = 'DMD'
  9387*        IF MAINTI = 'C'
  9388*           IF CL-BENEFICIARY = '0000B0CA10' OR '0000B0CAN0' OR
  9389*                               '0000B0CAS0' OR '0000B0CA50' OR
  9390*                               '0000B0CAA0' OR '0000B0CAB0' OR
  9391*                               '0000B0CAC0' OR '0000B0CAD0' OR
  9392*                               '0000B0CO20' OR '0000B0MN10' OR
  9393*                               '0000B0MN20' OR '0000B0MN30' OR
  9394*                               '0000B0MN40' OR '0000B0MN50' OR
  9395*                               '0000B0MN60' OR '0000B0MN70'
  9396*           IF ADDRI(1:1) = 'B'
  9397*              MOVE ER-8158     TO EMI-ERROR
  9398*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9399*              MOVE -1          TO MAINTL
  9400*              GO TO 8200-SEND-DATAONLY.
  9401*
  9402*    IF PI-COMPANY-ID = 'DMD'
  9403*      PERFORM 4000-SET-BSR THRU 4000-EXIT
  9404*      IF PI-BSR-AUTOMATED
  9405*        IF MAINTI = 'C'
  9406*           MOVE ER-7843          TO EMI-ERROR
  9407*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9408*           MOVE -1               TO MAINTL
  9409*           GO TO 8200-SEND-DATAONLY.
  9410
  9411     PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT.
  9412
  9413     MOVE ADDRI TO WS-ADDR-TYPE-CD.
  9414
  9415*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9416*        GO TO 7040-READ-PRODUCER.
  9417
  9418 7010-READ-ACCT.
  9419
  9420     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9421     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9422     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9423     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DATE.
  9424
  9425
  9426* EXEC CICS HANDLE CONDITION
  9427*         NOTOPEN    (8880-ACCT-NOT-OPEN)
  9428*         NOTFND     (7080-ACCT-NOT-FOUND)
  9429*    END-EXEC.
  9430*    MOVE '"$JI                  ! - #00008923' TO DFHEIV0
  9431     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 186
* EL152.cbl
  9432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9433     MOVE X'2D20233030303038393233' TO DFHEIV0(25:11)
  9434     CALL 'kxdfhei1' USING DFHEIV0
  9435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9436
  9437
  9438     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
  9439
  9440     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  9441
  9442 7020-READNEXT.
  9443
  9444     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
  9445
  9446     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  9447        IF WS-SAVE-ACCT-RECORD = SPACES
  9448            GO TO 7080-ACCT-NOT-FOUND
  9449        ELSE
  9450            MOVE 'Y'                 TO  WS-ACCT-READ-SW
  9451            MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
  9452            MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
  9453            GO TO 7030-CONTINUE-BUILD-ADDR.
  9454
  9455     IF AM-EXPIRATION-DT = HIGH-VALUES
  9456         NEXT SENTENCE
  9457     ELSE
  9458         MOVE ACCOUNT-MASTER         TO  WS-SAVE-ACCT-RECORD
  9459         GO TO 7020-READNEXT.
  9460
  9461     MOVE AM-CONTROL-PRIMARY TO ACCT-KEY.
  9462     MOVE 'Y'                TO WS-ACCT-READ-SW.
  9463
  9464 7030-CONTINUE-BUILD-ADDR.
  9465
  9466     MOVE SPACES             TO  WS-SAVE-ACCT-RECORD.
  9467
  9468     IF WS-ADDR-TYPE-CD = 'A0'
  9469        MOVE ZEROS               TO PI-ADDR-SEQ
  9470     ELSE
  9471        GO TO 7067-CHECK-BENE-ADDR.
  9472
  9473     MOVE SPACES             TO               WS-LABEL-HOLD-AREA.
  9474     MOVE AM-NAME            TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9475     MOVE AM-PERSON          TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9476     MOVE AM-ADDRS           TO  REC-TEXT (3) WS-LABEL-LINES (3).
  9477*    MOVE AM-CITY            TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9478     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
  9479        INTO WS-LABEL-LINES (4)
  9480     END-STRING
  9481     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9482     MOVE SPACES             TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9483
  9484     MOVE SPACES             TO  WS-ZIP-CODE.
  9485
  9486     IF AM-CANADIAN-POST-CODE
  9487         MOVE AM-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9488         MOVE AM-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9489     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 187
* EL152.cbl
  9490         MOVE AM-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9491         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9492             MOVE '-'            TO  WS-AM-ZIP-DASH
  9493             MOVE AM-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9494
  9495     MOVE WS-ZIP-CODE        TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9496
  9497     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9498
  9499     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9500     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9501     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9502     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9503     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9504     MOVE WS-LABEL-LINES (6) TO  REC-TEXT (6)    SS05-6D.
  9505
  9506     GO TO 7099-EXIT.
  9507
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 188
* EL152.cbl
  9509*7040-READ-PRODUCER. Remove as dead code
  9510*7050-READNEXT. Remove as dead code
  9511*7060-CONTINUE-BUILD-ADDR. Remove as dead code
  9512 7067-CHECK-BENE-ADDR.
  9513
  9514*    IF PI-COMPANY-ID = 'DMD'
  9515*        IF WS-ADDR-TYPE-CD = 'B9'
  9516*            GO TO 7067-CHECK-BENE-ADDR-9.
  9517
  9518     IF WS-ADDR-TYPE-CD NOT = 'B0'
  9519         GO TO 7068-CONTINUE-BUILD-ADDR.
  9520
  9521     IF CL-BENEFICIARY = SPACES
  9522         GO TO 7070-ACTV-NOT-FOUND.
  9523
  9524
  9525* EXEC CICS HANDLE CONDITION
  9526*         NOTFND     (7070-ACTV-NOT-FOUND)
  9527*    END-EXEC.
  9528*    MOVE '"$I                   ! . #00009014' TO DFHEIV0
  9529     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9531     MOVE X'2E20233030303039303134' TO DFHEIV0(25:11)
  9532     CALL 'kxdfhei1' USING DFHEIV0
  9533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9534
  9535
  9536     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9537     MOVE 'B'                    TO BENE-REC-TYPE.
  9538     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9539
  9540
  9541* EXEC CICS READ
  9542*         DATASET    (BENE-ID)
  9543*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9544*         RIDFLD     (BENE-KEY)
  9545*    END-EXEC.
  9546*    MOVE '&"S        E          (   #00009022' TO DFHEIV0
  9547     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9549     MOVE X'2020233030303039303232' TO DFHEIV0(25:11)
  9550     CALL 'kxdfhei1' USING DFHEIV0,
  9551           BENE-ID,
  9552           DFHEIV20,
  9553           DFHEIV99,
  9554           BENE-KEY,
  9555           DFHEIV99,
  9556           DFHEIV99,
  9557           DFHEIV99
  9558     SET ADDRESS OF BENEFICIARY-MASTER TO
  9559         DFHEIV20
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9561
  9562
  9563     MOVE SPACES              TO  WS-LABEL-HOLD-AREA.
  9564     MOVE BE-MAIL-TO-NAME     TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9565     MOVE BE-ADDRESS-LINE-1   TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9566     MOVE BE-ADDRESS-LINE-2   TO  REC-TEXT (3) WS-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 189
* EL152.cbl
  9567     MOVE BE-ADDRESS-LINE-3   TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9568*    MOVE BE-CITY-STATE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9569     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
  9570        INTO WS-LABEL-LINES (5)
  9571     END-STRING
  9572     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9573
  9574     MOVE SPACES              TO  WS-ZIP-CODE.
  9575     IF BE-CANADIAN-POST-CODE
  9576         MOVE BE-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9577         MOVE BE-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9578     ELSE
  9579         MOVE BE-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9580         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9581             MOVE '-'            TO  WS-AM-ZIP-DASH
  9582             MOVE BE-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9583
  9584     MOVE WS-ZIP-CODE         TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9585
  9586     GO TO 7069-SET-ADDR.
  9587
  9588 7067-CHECK-BENE-ADDR-9.
  9589
  9590     IF CL-BENEFICIARY = SPACES
  9591         GO TO 7070-ACTV-NOT-FOUND.
  9592
  9593
  9594* EXEC CICS HANDLE CONDITION
  9595*         NOTFND     (7070-ACTV-NOT-FOUND)
  9596*    END-EXEC.
  9597*    MOVE '"$I                   ! / #00009058' TO DFHEIV0
  9598     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9600     MOVE X'2F20233030303039303538' TO DFHEIV0(25:11)
  9601     CALL 'kxdfhei1' USING DFHEIV0
  9602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9603
  9604
  9605     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9606     MOVE 'B'                    TO BENE-REC-TYPE.
  9607     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9608
  9609
  9610* EXEC CICS READ
  9611*         DATASET    (BENE-ID)
  9612*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9613*         RIDFLD     (BENE-KEY)
  9614*    END-EXEC.
  9615*    MOVE '&"S        E          (   #00009066' TO DFHEIV0
  9616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9617     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9618     MOVE X'2020233030303039303636' TO DFHEIV0(25:11)
  9619     CALL 'kxdfhei1' USING DFHEIV0,
  9620           BENE-ID,
  9621           DFHEIV20,
  9622           DFHEIV99,
  9623           BENE-KEY,
  9624           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 190
* EL152.cbl
  9625           DFHEIV99,
  9626           DFHEIV99
  9627     SET ADDRESS OF BENEFICIARY-MASTER TO
  9628         DFHEIV20
  9629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9630
  9631
  9632     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
  9633     MOVE BE-MAIL-TO-NAME2       TO REC-TEXT (1)
  9634                                    WS-LABEL-LINES (1).
  9635     MOVE BE-ADDRESS-LINE-12     TO REC-TEXT (2)
  9636                                    WS-LABEL-LINES (2).
  9637     MOVE BE-ADDRESS-LINE-22     TO REC-TEXT (3)
  9638                                    WS-LABEL-LINES (3).
  9639     MOVE BE-ADDRESS-LINE-32     TO REC-TEXT (4)
  9640                                    WS-LABEL-LINES (4).
  9641*    MOVE BE-CITY-STATE2         TO REC-TEXT (5)
  9642*                                   WS-LABEL-LINES (5).
  9643     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
  9644        INTO WS-LABEL-LINES (5)
  9645     END-STRING
  9646     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9647
  9648     MOVE SPACES                 TO WS-ZIP-CODE.
  9649
  9650     IF BE-CANADIAN-POST-CODE2
  9651         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
  9652         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
  9653     ELSE
  9654         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
  9655         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
  9656             MOVE '-'            TO WS-AM-ZIP-DASH
  9657             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
  9658
  9659     MOVE WS-ZIP-CODE            TO REC-TEXT (6)
  9660                                    WS-LABEL-LINES (6).
  9661
  9662     GO TO 7069-SET-ADDR.
  9663
  9664 7068-CONTINUE-BUILD-ADDR.
  9665
  9666     IF ACTV-SEQ = ZEROS
  9667        GO TO 7070-ACTV-NOT-FOUND.
  9668
  9669     MOVE ACTV-SEQ               TO PI-ADDR-SEQ.
  9670
  9671
  9672* EXEC CICS HANDLE CONDITION
  9673*         NOTOPEN    (8870-ACTV-NOT-OPEN)
  9674*         NOTFND     (7070-ACTV-NOT-FOUND)
  9675*    END-EXEC.
  9676*    MOVE '"$JI                  ! 0 #00009111' TO DFHEIV0
  9677     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9679     MOVE X'3020233030303039313131' TO DFHEIV0(25:11)
  9680     CALL 'kxdfhei1' USING DFHEIV0
  9681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9682
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 191
* EL152.cbl
  9683
  9684
  9685* EXEC CICS READ
  9686*         DATASET    (ACTV-ID)
  9687*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
  9688*         RIDFLD     (ACTV-KEY)
  9689*    END-EXEC.
  9690*    MOVE '&"S        E          (   #00009116' TO DFHEIV0
  9691     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9693     MOVE X'2020233030303039313136' TO DFHEIV0(25:11)
  9694     CALL 'kxdfhei1' USING DFHEIV0,
  9695           ACTV-ID,
  9696           DFHEIV20,
  9697           DFHEIV99,
  9698           ACTV-KEY,
  9699           DFHEIV99,
  9700           DFHEIV99,
  9701           DFHEIV99
  9702     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9703         DFHEIV20
  9704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9705
  9706
  9707     MOVE SPACES            TO              WS-LABEL-HOLD-AREA.
  9708     MOVE AT-MAIL-TO-NAME   TO REC-TEXT (1) WS-LABEL-LINES (1).
  9709     MOVE AT-ADDRESS-LINE-1 TO REC-TEXT (2) WS-LABEL-LINES (2).
  9710     MOVE AT-ADDRESS-LINE-2 TO REC-TEXT (3) WS-LABEL-LINES (3).
  9711*    MOVE AT-CITY-STATE     TO REC-TEXT (4) WS-LABEL-LINES (4).
  9712     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
  9713        INTO WS-LABEL-LINES (4)
  9714     END-STRING
  9715     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9716
  9717     MOVE SPACES            TO  WS-ZIP-CODE.
  9718     IF AT-CANADIAN-POST-CODE
  9719         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9720         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9721     ELSE
  9722         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
  9723         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9724             MOVE '-'            TO  WS-AM-ZIP-DASH
  9725             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9726
  9727     MOVE WS-ZIP-CODE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9728
  9729     MOVE SPACES            TO  REC-TEXT (6).
  9730
  9731 7069-SET-ADDR.
  9732     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9733
  9734     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9735     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9736     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9737     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9738     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9739     MOVE SPACES             TO  REC-TEXT (6)    SS05-6D.
  9740
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 192
* EL152.cbl
  9741     GO TO 7099-EXIT.
  9742
  9743 7070-ACTV-NOT-FOUND.
  9744
  9745     IF ACTV-SEQ NOT = +29
  9746        GO TO 7075-CONTINUE-ACTV-ERROR.
  9747
  9748*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9749*        GO TO 7099-EXIT.
  9750
  9751     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9752        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
  9753        GO TO 7075-CONTINUE-ACTV-ERROR.
  9754
  9755     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
  9756        GO TO 7075-CONTINUE-ACTV-ERROR.
  9757
  9758     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD
  9759     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER
  9760     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING
  9761     MOVE 'A'             TO WS-ERCOMP-TYPE
  9762     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9763                          TO WS-ERCOMP-RESP-NO.
  9764
  9765     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
  9766         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
  9767                                       'G' OR 'B'
  9768             MOVE 'G'            TO WS-ERCOMP-TYPE
  9769             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
  9770         ELSE
  9771             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9772                                 TO WS-ERCOMP-ACCOUNT
  9773     ELSE
  9774         MOVE 'G'                TO WS-ERCOMP-TYPE
  9775         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
  9776
  9777     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  9778        MOVE ZEROS TO WS-ERCOMP-CARRIER.
  9779
  9780     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  9781        MOVE ZEROS TO WS-ERCOMP-GROUPING.
  9782
  9783
  9784* EXEC CICS HANDLE CONDITION
  9785*         NOTFND    (7075-CONTINUE-ACTV-ERROR)
  9786*    END-EXEC.
  9787*    MOVE '"$I                   ! 1 #00009198' TO DFHEIV0
  9788     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9790     MOVE X'3120233030303039313938' TO DFHEIV0(25:11)
  9791     CALL 'kxdfhei1' USING DFHEIV0
  9792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9793
  9794
  9795
  9796* EXEC CICS  READ
  9797*         SET      (ADDRESS OF COMPENSATION-MASTER)
  9798*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 193
* EL152.cbl
  9799*         RIDFLD   (WS-ERCOMP-KEY)
  9800*    END-EXEC.
  9801     MOVE 'ERCOMP' TO DFHEIV1
  9802*    MOVE '&"S        E          (   #00009202' TO DFHEIV0
  9803     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9805     MOVE X'2020233030303039323032' TO DFHEIV0(25:11)
  9806     CALL 'kxdfhei1' USING DFHEIV0,
  9807           DFHEIV1,
  9808           DFHEIV20,
  9809           DFHEIV99,
  9810           WS-ERCOMP-KEY,
  9811           DFHEIV99,
  9812           DFHEIV99,
  9813           DFHEIV99
  9814     SET ADDRESS OF COMPENSATION-MASTER TO
  9815         DFHEIV20
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9817
  9818
  9819     MOVE 'Y'                   TO WS-COMP-READ-SW.
  9820     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
  9821     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
  9822
  9823     IF CO-ACCT-NAME = SPACES
  9824        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
  9825
  9826     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
  9827     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
  9828     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
  9829
  9830     MOVE SPACES                TO  WS-ZIP-CODE.
  9831     IF CO-CANADIAN-POST-CODE
  9832         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
  9833         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
  9834     ELSE
  9835         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
  9836         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9837             MOVE '-'           TO  WS-AM-ZIP-DASH
  9838             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
  9839
  9840     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
  9841
  9842     MOVE ZEROS                 TO WS-PHONE-IN.
  9843     MOVE CO-AREA-CODE          TO WSPO-AREA.
  9844     MOVE CO-PREFIX             TO WSPO-PFX.
  9845     MOVE CO-PHONE              TO WSPO-SFX.
  9846     MOVE WS-PHONE-OUT          TO SS53-6D.
  9847
  9848     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9849
  9850     MOVE WS-LABEL-LINES (1)     TO REC-TEXT (1)    SS52D.
  9851     MOVE WS-LABEL-LINES (2)     TO REC-TEXT (2)    SS53-1D.
  9852     MOVE WS-LABEL-LINES (3)     TO REC-TEXT (3)    SS53-2D.
  9853     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)    SS53-3D.
  9854     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)    SS53-4D.
  9855     MOVE WS-LABEL-LINES (6)     TO REC-TEXT (6)    SS53-5D.
  9856
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 194
* EL152.cbl
  9857     GO TO 7099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 195
* EL152.cbl
  9859
  9860 7075-CONTINUE-ACTV-ERROR.
  9861     MOVE ER-0178                TO EMI-ERROR.
  9862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9863     MOVE -1                     TO ADDRL.
  9864     MOVE AL-UABON               TO ADDRA.
  9865     MOVE SPACES                 TO PI-ADDR-TYPE.
  9866     MOVE SPACES                 TO REC-TEXT (1)
  9867                                    REC-TEXT (2)
  9868                                    REC-TEXT (3)
  9869                                    REC-TEXT (4)
  9870                                    REC-TEXT (5)
  9871                                    REC-TEXT (6).
  9872     GO TO 7099-EXIT.
  9873
  9874 7080-ACCT-NOT-FOUND.
  9875     MOVE ER-0179                TO EMI-ERROR.
  9876     MOVE -1                     TO ADDRL.
  9877     MOVE AL-UABON               TO ADDRA.
  9878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879     GO TO 8200-SEND-DATAONLY.
  9880
  9881 7090-CLAIM-NOT-FOUND.
  9882     MOVE ER-0186                TO EMI-ERROR.
  9883     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9884     GO TO 8200-SEND-DATAONLY.
  9885
  9886*7095-PROD-NOT-FOUND. Remove as dead code
  9887
  9888 7099-EXIT.
  9889      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 196
* EL152.cbl
  9891
  9892 7170-FORMAT-SCREEN.
  9893     IF MAINTI = 'S'
  9894        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  9895       ELSE
  9896        MOVE AL-UANOF            TO SC-TEXTA (SC-INDX).
  9897
  9898     IF TB-INDX < 7
  9899        SET LINE23 TO TB-INDX
  9900        MOVE 'A'                 TO LINE1
  9901       ELSE
  9902        IF TB-INDX = 7
  9903           MOVE ZEROS            TO LINE-NUM
  9904        ELSE
  9905           SET LIN-NUM TO TB-INDX
  9906           SUBTRACT 7            FROM LIN-NUM.
  9907
  9908     MOVE LINE-NUM               TO SC-LINE (SC-INDX).
  9909     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  9910     SET TB-INDX UP BY 1.
  9911
  9912 7170-EXIT.
  9913      EXIT.
  9914
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 197
* EL152.cbl
  9916 7200-RESOLVE-VARIABLES.
  9917***************************************************************
  9918*    THIS ROUTINE WILL FORMAT THE SYSTEM-DEFINED SYMBOLS      *
  9919*    WITH DATA PERTAINING TO THE DESIGNATED CLAIM.            *
  9920*    THIS ROUTINE IS PERFORMED THRU 7269-EXIT TO              *
  9921*    RESOLVE ALL OF THE SYMBOLS.                              *
  9922***************************************************************
  9923
  9924*    IF PI-COMPANY-ID = 'AUK'
  9925*        MOVE 'Y'                TO W-REVERSE-DATE-SW.
  9926
  9927     MOVE PI-CLAIM-NO            TO SS34D.
  9928
  9929     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9930        MOVE PI-LIFE-OVERRIDE-L6 TO SS12D
  9931     ELSE
  9932        MOVE PI-AH-OVERRIDE-L6   TO SS12D.
  9933
  9934     MOVE CL-LAST-PMT-AMT        TO SS16D.
  9935     MOVE CL-TOTAL-PAID-AMT      TO SS18D.
  9936     MOVE CL-CAUSE-CD            TO SS19-1D.
  9937     MOVE CL-ASSOC-CERT-SEQU     TO SS54D.
  9938     MOVE CL-ASSOC-CERT-TOTAL    TO SS55D.
  9939
  9940*    IF PI-COMPANY-ID NOT = 'DMD'
  9941*        GO TO 7200-CONTINUE.
  9942
  9943     IF CL-CCN-PREFIX-A5 = '1111' OR '3333' OR '6666' OR
  9944                           '8888' OR '9876'
  9945         MOVE CL-CCN-PRIME-A5    TO WS-CCN-12
  9946         MOVE WS-CCN-12          TO CL-CCN.
  9947
  9948     IF CL-CERT-STATE NOT = '08' AND '09'
  9949         MOVE SPACES             TO SS62D
  9950                                    SS63D
  9951         GO TO 7200-CONTINUE.
  9952
  9953     MOVE WS-DMD-UND-STATEMENT   TO SS62D.
  9954
  9955     MOVE 'CL'                   TO DL23-SYSTEM-ID.
  9956     MOVE 'UN'                   TO DL23-RECORD-TYPE.
  9957     MOVE CL-CERT-STATE          TO DL23-RECORD-KEY.
  9958
  9959
  9960* EXEC CICS LINK
  9961*        PROGRAM    ('DLO023')
  9962*        COMMAREA   (WS-DLO-CODES-TABLE)
  9963*        LENGTH     (DL23-COMM-LENGTH)
  9964*    END-EXEC.
  9965     MOVE 'DLO023' TO DFHEIV1
  9966*    MOVE '."C                   (   #00009348' TO DFHEIV0
  9967     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9969     MOVE X'2020233030303039333438' TO DFHEIV0(25:11)
  9970     CALL 'kxdfhei1' USING DFHEIV0,
  9971           DFHEIV1,
  9972           WS-DLO-CODES-TABLE,
  9973           DL23-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 198
* EL152.cbl
  9974           DFHEIV99,
  9975           DFHEIV99,
  9976           DFHEIV99,
  9977           DFHEIV99
  9978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9979
  9980
  9981     IF DL23-RETURN-CODE = 'OK'
  9982         MOVE DL23-CODE-DESC     TO SS63D
  9983       ELSE
  9984         MOVE SPACES             TO SS63D.
  9985
  9986 7200-CONTINUE.
  9987     MOVE CL-CCN                 TO SS60D.
  9988
  9989     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  9990     MOVE SPACES                 TO DC-OPTION-CODE.
  9991     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9992     IF NO-CONVERSION-ERROR
  9993        MOVE DC-GREG-DATE-1-EDIT TO SS13D.
  9994
  9995     MOVE CL-REPORTED-DT         TO DC-BIN-DATE-1.
  9996     MOVE SPACES                 TO DC-OPTION-CODE.
  9997     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9998     IF NO-CONVERSION-ERROR
  9999        MOVE DC-GREG-DATE-1-EDIT TO SS14D.
 10000
 10001     MOVE CL-LAST-PMT-DT         TO DC-BIN-DATE-1.
 10002     MOVE SPACES                 TO DC-OPTION-CODE.
 10003     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10004     IF NO-CONVERSION-ERROR
 10005        MOVE DC-GREG-DATE-1-EDIT TO SS15D.
 10006
 10007     IF NOT PI-USES-PAID-TO
 10008        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
 10009        MOVE SPACES                 TO DC-OPTION-CODE
 10010        PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10011        IF NO-CONVERSION-ERROR
 10012           MOVE DC-GREG-DATE-1-EDIT TO SS17D
 10013        ELSE
 10014           MOVE SPACES TO SS17D
 10015     ELSE
 10016        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
 10017        MOVE '6'                    TO DC-OPTION-CODE
 10018        MOVE +1                     TO DC-ELAPSED-DAYS
 10019        MOVE +0                     TO DC-ELAPSED-MONTHS
 10020        PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10021        IF NO-CONVERSION-ERROR
 10022           MOVE DC-GREG-DATE-1-EDIT TO SS17D.
 10023
 10024     MOVE CL-INSURED-BIRTH-DT    TO DC-BIN-DATE-1.
 10025     MOVE SPACES                 TO DC-OPTION-CODE.
 10026     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10027     IF NO-CONVERSION-ERROR
 10028        MOVE DC-GREG-DATE-1-EDIT TO SS45D
 10029     ELSE
 10030        MOVE '@@DOB'             TO SS45D.
 10031
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 199
* EL152.cbl
 10032     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 10033        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 10034             NEXT SENTENCE
 10035         ELSE
 10036             MOVE CL-SOC-SEC-NO  TO SS46D.
 10037
 10038     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 10039                                    ACCT-GROUPING
 10040                                    PROD-GROUPING
 10041                                    PLCY-GROUPING
 10042                                    PLAN-GROUPING.
 10043     MOVE CL-CERT-STATE          TO CERT-STATE
 10044                                    ACCT-STATE
 10045                                    PROD-STATE
 10046                                    PLCY-STATE
 10047                                    PLAN-STATE.
 10048     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 10049                                    ACCT-ACCOUNT
 10050                                    PROD-PRODUCER
 10051                                    PLCY-PRODUCER
 10052                                    PLAN-PRODUCER.
 10053     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
 10054                                    PLCY-EFF-DT.
 10055     MOVE CL-CV-REFERENCE-NO     TO PLCY-REFERENCE-NO.
 10056
 10057     PERFORM 5000-MOVE-NAME THRU 5000-EXIT.
 10058
 10059*    IF PI-COMPANY-ID = 'DMD'
 10060*       MOVE WS-NAME-WORK           TO SS10D
 10061*       GO TO 7200-CONTINUE-2.
 10062
 10063     IF LOWER-CASE-LETTERS-USED
 10064        MOVE 'N'                    TO WS-STATE-LINE
 10065        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10066        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10067        MOVE WS-TEMP-AREA2          TO SS10D
 10068     ELSE
 10069        MOVE WS-NAME-WORK           TO SS10D.
 10070
 10071 7200-CONTINUE-2.
 10072     MOVE CL-INSURED-1ST-NAME     TO W-FIRST-NAME.
 10073     MOVE CL-INSURED-LAST-NAME    TO W-LAST-NAME.
 10074     MOVE CL-INSURED-MID-INIT     TO W-MIDDLE-NAME.
 10075     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10076
 10077     IF LOWER-CASE-LETTERS-USED
 10078        MOVE 'N'                    TO WS-STATE-LINE
 10079        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10080        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10081        MOVE WS-TEMP-AREA2          TO SS39D
 10082     ELSE
 10083        MOVE WS-NAME-WORK           TO SS39D.
 10084
 10085     MOVE CL-INSURED-LAST-NAME   TO SS40D.
 10086
 10087     IF INSURED-IS-FEMALE
 10088        MOVE 'MS.'               TO SS41D
 10089       ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 200
* EL152.cbl
 10090        MOVE 'MR.'               TO SS41D.
 10091
 10092*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10093*        PERFORM 7290-RESOLVE-CREDITOR THRU 7290-EXIT.
 10094
 10095*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10096*        GO TO 7200-READ-EMPLCY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 201
* EL152.cbl
 10098
 10099* EXEC CICS HANDLE CONDITION
 10100*         NOTOPEN   (8900-CERT-NOT-OPEN)
 10101*         NOTFND    (8910-CERT-NOT-FOUND)
 10102*    END-EXEC.
 10103*    MOVE '"$JI                  ! 2 #00009471' TO DFHEIV0
 10104     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10106     MOVE X'3220233030303039343731' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10109
 10110
 10111
 10112* EXEC CICS READ
 10113*         DATASET   (CERT-ID)
 10114*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10115*         RIDFLD    (CERT-KEY)
 10116*    END-EXEC.
 10117*    MOVE '&"S        E          (   #00009476' TO DFHEIV0
 10118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10120     MOVE X'2020233030303039343736' TO DFHEIV0(25:11)
 10121     CALL 'kxdfhei1' USING DFHEIV0,
 10122           CERT-ID,
 10123           DFHEIV20,
 10124           DFHEIV99,
 10125           CERT-KEY,
 10126           DFHEIV99,
 10127           DFHEIV99,
 10128           DFHEIV99
 10129     SET ADDRESS OF CERTIFICATE-MASTER TO
 10130         DFHEIV20
 10131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10132
 10133
 10134*    IF PI-COMPANY-ID = 'DMD'
 10135*        MOVE CM-RESIDENT-STATE  TO WS-DMD-RES-ST
 10136*        IF CM-POLICY-FORM-NO(6:1) = '1'
 10137*            MOVE WS-DMD-UND-COMPANYA    TO SS64D
 10138*          ELSE
 10139*        IF CM-POLICY-FORM-NO(6:1) = '2'
 10140*            MOVE WS-DMD-UND-COMPANYB    TO SS64D
 10141*          ELSE
 10142*            MOVE SPACES                 TO SS64D.
 10143
 10144     MOVE CM-CERT-NO             TO SS26D.
 10145     MOVE CM-INSURED-ISSUE-AGE   TO SS33D.
 10146
 10147*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10148*        MOVE CL-CURRENT-CARRIER TO SS23D
 10149*        MOVE CL-CURRENT-GROUPING
 10150*                                TO SS24D
 10151*        MOVE CL-CURRENT-ACCOUNT TO SS25D
 10152*        MOVE CM-MEMBER-NO       TO SS36D
 10153*        MOVE CM-GROUPING        TO W-GROUPING
 10154*        IF W-GROUP-3 = 'C01' OR 'C02'
 10155*            MOVE CM-MEMBER-NO   TO W-CURRENT-LOAN-NO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 202
* EL152.cbl
 10156*            MOVE CM-LOAN-NUMBER TO W-LOAN-NO
 10157*            MOVE W-CREDIT-CARD-LOAN-NO
 10158*                                TO SS36-1D
 10159*        ELSE
 10160*            MOVE CM-MEMBER-NO   TO SS36-1D
 10161*    ELSE
 10162         MOVE CM-CARRIER         TO SS23D.
 10163         MOVE CM-GROUPING        TO SS24D.
 10164         MOVE CM-ACCOUNT         TO SS25D.
 10165         MOVE CM-LOAN-NUMBER     TO SS36D.
 10166
 10167     MOVE CM-LOAN-BALANCE        TO SS37D.
 10168     MOVE CM-MEMBER-NO           TO SS38D.
 10169
 10170     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 10171     MOVE SPACES                 TO DC-OPTION-CODE.
 10172     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10173     IF NO-CONVERSION-ERROR
 10174        MOVE DC-GREG-DATE-1-EDIT TO SS27D.
 10175
 10176     MOVE CM-INSURED-FIRST-NAME  TO W-FIRST-NAME.
 10177     MOVE CM-INSURED-LAST-NAME   TO W-LAST-NAME.
 10178     MOVE CM-INSURED-INITIAL2    TO W-MIDDLE-NAME.
 10179     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10180
 10181     IF LOWER-CASE-LETTERS-USED
 10182         MOVE 'N'                TO WS-STATE-LINE
 10183         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10184         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10185         MOVE WS-TEMP-AREA2      TO SS57D
 10186     ELSE
 10187         MOVE WS-NAME-WORK       TO SS57D.
 10188
 10189     MOVE CM-JT-FIRST-NAME       TO W-FIRST-NAME.
 10190     MOVE CM-JT-LAST-NAME        TO W-LAST-NAME.
 10191     MOVE CM-JT-INITIAL          TO W-MIDDLE-NAME.
 10192     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10193
 10194     IF LOWER-CASE-LETTERS-USED
 10195         MOVE 'N'                TO WS-STATE-LINE
 10196         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10197         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10198         MOVE WS-TEMP-AREA2      TO SS58D
 10199     ELSE
 10200         MOVE WS-NAME-WORK       TO SS58D.
 10201
 10202     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10203        MOVE CM-LF-BENEFIT-CD    TO BEN-HOLD
 10204        MOVE CM-LF-ORIG-TERM     TO SS29D
 10205        MOVE CM-LF-BENEFIT-AMT   TO SS30D
 10206        MOVE CM-POLICY-FORM-NO   TO SS32D
 10207        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
 10208     ELSE
 10209        MOVE CM-AH-BENEFIT-CD    TO BEN-HOLD
 10210        MOVE CM-AH-ORIG-TERM     TO SS29D
 10211        MOVE CM-AH-BENEFIT-AMT   TO SS30D
 10212        MOVE CM-POLICY-FORM-NO   TO SS32D
 10213        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 203
* EL152.cbl
 10214
 10215     COMPUTE WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 10216
 10217     MOVE WORK-AMOUNT            TO SS51D.
 10218
 10219     MOVE SPACES                 TO DC-OPTION-CODE.
 10220     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10221     IF NO-CONVERSION-ERROR
 10222        MOVE DC-GREG-DATE-1-EDIT TO SS31D.
 10223
 10224     MOVE ' '                         TO  DC-OPTION-CODE.
 10225     MOVE +0                          TO  DC-ELAPSED-MONTHS
 10226                                          DC-ELAPSED-DAYS.
 10227
 10228     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10229         MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10230         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10231         IF NO-CONVERSION-ERROR
 10232             MOVE DC-GREG-DATE-1-EDIT TO  SS28D
 10233         ELSE
 10234             NEXT SENTENCE
 10235     ELSE
 10236         MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10237         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10238         IF NO-CONVERSION-ERROR
 10239             MOVE DC-GREG-DATE-1-EDIT TO  SS28D.
 10240
 10241*    GO TO 7200-READ-DIAGNOSIS.
 10242
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 204
* EL152.cbl
 10244*7200-READ-EMPLCY. Remove as dead code
 10245 7200-READ-DIAGNOSIS.
 10246
 10247* EXEC CICS HANDLE CONDITION
 10248*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10249*         NOTFND     (7200-READ-LOAN-NUMBER)
 10250*    END-EXEC.
 10251*    MOVE '"$JI                  ! 3 #00009594' TO DFHEIV0
 10252     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10254     MOVE X'3320233030303039353934' TO DFHEIV0(25:11)
 10255     CALL 'kxdfhei1' USING DFHEIV0
 10256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10257
 10258
 10259     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10260     MOVE +90                   TO ACTV-SEQ.
 10261
 10262
 10263* EXEC CICS READ
 10264*         DATASET  (ACTV-ID)
 10265*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10266*         RIDFLD   (ACTV-KEY)
 10267*    END-EXEC.
 10268*    MOVE '&"S        E          (   #00009602' TO DFHEIV0
 10269     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10271     MOVE X'2020233030303039363032' TO DFHEIV0(25:11)
 10272     CALL 'kxdfhei1' USING DFHEIV0,
 10273           ACTV-ID,
 10274           DFHEIV20,
 10275           DFHEIV99,
 10276           ACTV-KEY,
 10277           DFHEIV99,
 10278           DFHEIV99,
 10279           DFHEIV99
 10280     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10281         DFHEIV20
 10282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10283
 10284
 10285     IF AT-TRAILER-TYPE = '6'
 10286        MOVE AT-INFO-LINE-1         TO SS19D.
 10287
 10288 7200-READ-LOAN-NUMBER.
 10289
 10290
 10291* EXEC CICS HANDLE CONDITION
 10292*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10293*         NOTFND     (7201-READ-BENEFICIARY)
 10294*    END-EXEC.
 10295*    MOVE '"$JI                  ! 4 #00009613' TO DFHEIV0
 10296     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10298     MOVE X'3420233030303039363133' TO DFHEIV0(25:11)
 10299     CALL 'kxdfhei1' USING DFHEIV0
 10300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10301
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 205
* EL152.cbl
 10302
 10303     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10304     MOVE +91                   TO ACTV-SEQ.
 10305
 10306
 10307* EXEC CICS READ
 10308*         DATASET  (ACTV-ID)
 10309*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10310*         RIDFLD   (ACTV-KEY)
 10311*    END-EXEC.
 10312*    MOVE '&"S        E          (   #00009621' TO DFHEIV0
 10313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10315     MOVE X'2020233030303039363231' TO DFHEIV0(25:11)
 10316     CALL 'kxdfhei1' USING DFHEIV0,
 10317           ACTV-ID,
 10318           DFHEIV20,
 10319           DFHEIV99,
 10320           ACTV-KEY,
 10321           DFHEIV99,
 10322           DFHEIV99,
 10323           DFHEIV99
 10324     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10325         DFHEIV20
 10326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10327
 10328
 10329     IF AT-TRAILER-TYPE = '6'
 10330        MOVE AT-INFO-LINE-1         TO SS19-2D.
 10331
 10332 7201-READ-BENEFICIARY.
 10333     IF CL-BENIF-ADDR-CNT = +0  AND
 10334        CL-BENEFICIARY = SPACES
 10335          GO TO 7205-READ-PHYSICIAN-ADDR.
 10336
 10337     IF W-BENEFICIARY > ZERO
 10338         COMPUTE ACTV-SEQ = W-BENEFICIARY + 10
 10339     ELSE
 10340         MOVE CL-BENIF-ADDR-CNT  TO ACTV-SEQ
 10341         ADD +10                 TO ACTV-SEQ.
 10342
 10343
 10344* EXEC CICS HANDLE CONDITION
 10345*         NOTOPEN    (7290-BENE-NOT-OPEN)
 10346*         NOTFND     (7205-READ-PHYSICIAN-ADDR)
 10347*    END-EXEC.
 10348*    MOVE '"$JI                  ! 5 #00009641' TO DFHEIV0
 10349     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10351     MOVE X'3520233030303039363431' TO DFHEIV0(25:11)
 10352     CALL 'kxdfhei1' USING DFHEIV0
 10353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10354
 10355
 10356     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10357
 10358     IF ACTV-SEQ = +19
 10359         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 206
* EL152.cbl
 10360     ELSE
 10361         IF ACTV-SEQ NOT = +10
 10362             GO TO 7202-GET-FROM-ACTIVITY.
 10363
 10364     MOVE PI-COMPANY-CD        TO BENE-COMP-CD.
 10365     MOVE 'B'                  TO BENE-REC-TYPE.
 10366     MOVE CL-BENEFICIARY       TO BENE-NUMBER.
 10367
 10368
 10369* EXEC CICS READ
 10370*         DATASET    (BENE-ID)
 10371*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 10372*         RIDFLD     (BENE-KEY)
 10373*    END-EXEC.
 10374*    MOVE '&"S        E          (   #00009658' TO DFHEIV0
 10375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10377     MOVE X'2020233030303039363538' TO DFHEIV0(25:11)
 10378     CALL 'kxdfhei1' USING DFHEIV0,
 10379           BENE-ID,
 10380           DFHEIV20,
 10381           DFHEIV99,
 10382           BENE-KEY,
 10383           DFHEIV99,
 10384           DFHEIV99,
 10385           DFHEIV99
 10386     SET ADDRESS OF BENEFICIARY-MASTER TO
 10387         DFHEIV20
 10388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10389
 10390
 10391*    IF PI-COMPANY-ID = 'DMD'
 10392*        MOVE BE-BSR             TO PI-ELBENE-BSR.
 10393
 10394 7201-CONT.
 10395     MOVE BE-MAIL-TO-NAME2       TO WS-LABEL-LINES (1).
 10396     MOVE BE-ADDRESS-LINE-12     TO WS-LABEL-LINES (2).
 10397     MOVE BE-ADDRESS-LINE-22     TO WS-LABEL-LINES (3).
 10398     MOVE BE-ADDRESS-LINE-32     TO WS-LABEL-LINES (4).
 10399*    MOVE BE-CITY-STATE2         TO WS-LABEL-LINES (5).
 10400     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
 10401        INTO WS-LABEL-LINES (5)
 10402     END-STRING
 10403
 10404     MOVE SPACES                 TO WS-ZIP-CODE.
 10405
 10406     IF BE-CANADIAN-POST-CODE2
 10407         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
 10408         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
 10409     ELSE
 10410         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
 10411         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
 10412             MOVE '-'            TO WS-AM-ZIP-DASH
 10413             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
 10414
 10415     MOVE WS-ZIP-CODE            TO WS-LABEL-LINES (6).
 10416
 10417     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 207
* EL152.cbl
 10418
 10419     MOVE WS-LABEL-LINES (1)     TO SS61D.
 10420     MOVE WS-LABEL-LINES (2)     TO SS61-1D.
 10421     MOVE WS-LABEL-LINES (3)     TO SS61-2D.
 10422     MOVE WS-LABEL-LINES (4)     TO SS61-3D.
 10423     MOVE WS-LABEL-LINES (5)     TO SS61-4D.
 10424     MOVE WS-LABEL-LINES (6)     TO SS61-5D.
 10425
 10426     MOVE BE-PHONE-NO2           TO WS-PHONE-IN.
 10427     MOVE WSPI-AREA              TO WSPO-AREA.
 10428     MOVE WSPI-PFX               TO WSPO-PFX.
 10429     MOVE WSPI-SFX               TO WSPO-SFX.
 10430     MOVE WS-PHONE-OUT           TO SS61-6D.
 10431
 10432 7201-CONT-PROCESS.
 10433     MOVE BE-MAIL-TO-NAME      TO  WS-LABEL-LINES (1).
 10434     MOVE BE-ADDRESS-LINE-1    TO  WS-LABEL-LINES (2).
 10435     MOVE BE-ADDRESS-LINE-2    TO  WS-LABEL-LINES (3).
 10436     MOVE BE-ADDRESS-LINE-3    TO  WS-LABEL-LINES (4).
 10437*    MOVE BE-CITY-STATE        TO  WS-LABEL-LINES (5).
 10438     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
 10439        INTO WS-LABEL-LINES (5)
 10440     END-STRING
 10441
 10442     MOVE SPACES               TO  WS-ZIP-CODE.
 10443     IF BE-CANADIAN-POST-CODE
 10444         MOVE BE-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 10445         MOVE BE-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 10446     ELSE
 10447         MOVE BE-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 10448         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10449             MOVE '-'          TO  WS-AM-ZIP-DASH
 10450             MOVE BE-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 10451
 10452     MOVE WS-ZIP-CODE          TO  WS-LABEL-LINES (6).
 10453
 10454     MOVE BE-PHONE-NO          TO  WS-PHONE-IN.
 10455
 10456     GO TO 7204-SET-PHONE.
 10457
 10458 7202-GET-FROM-ACTIVITY.
 10459
 10460* EXEC CICS READ
 10461*         DATASET  (ACTV-ID)
 10462*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10463*         RIDFLD   (ACTV-KEY)
 10464*    END-EXEC.
 10465*    MOVE '&"S        E          (   #00009732' TO DFHEIV0
 10466     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10468     MOVE X'2020233030303039373332' TO DFHEIV0(25:11)
 10469     CALL 'kxdfhei1' USING DFHEIV0,
 10470           ACTV-ID,
 10471           DFHEIV20,
 10472           DFHEIV99,
 10473           ACTV-KEY,
 10474           DFHEIV99,
 10475           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 208
* EL152.cbl
 10476           DFHEIV99
 10477     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10478         DFHEIV20
 10479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10480
 10481
 10482     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10483     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10484     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10485*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10486     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10487        INTO WS-LABEL-LINES (4)
 10488     END-STRING
 10489
 10490     MOVE SPACES                 TO  WS-ZIP-CODE.
 10491     IF AT-CANADIAN-POST-CODE
 10492         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10493         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10494     ELSE
 10495         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10496         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10497             MOVE '-'            TO  WS-AM-ZIP-DASH
 10498             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10499
 10500     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10501
 10502     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10503
 10504 7204-SET-PHONE.
 10505     MOVE WSPI-AREA              TO WSPO-AREA.
 10506     MOVE WSPI-PFX               TO WSPO-PFX.
 10507     MOVE WSPI-SFX               TO WSPO-SFX.
 10508     MOVE WS-PHONE-OUT           TO SS44-5D.
 10509
 10510     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10511
 10512     MOVE WS-LABEL-LINES (1)     TO SS43D.
 10513     MOVE WS-LABEL-LINES (2)     TO SS44-1D.
 10514     MOVE WS-LABEL-LINES (3)     TO SS44-2D.
 10515     MOVE WS-LABEL-LINES (4)     TO SS44-3D.
 10516     MOVE WS-LABEL-LINES (5)     TO SS44-4D.
 10517     MOVE WS-LABEL-LINES (6)     TO SS44-6D.
 10518
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 209
* EL152.cbl
 10520 7205-READ-PHYSICIAN-ADDR.
 10521     IF W-PHYSICIAN > ZERO
 10522         COMPUTE ACTV-SEQ = W-PHYSICIAN + 30
 10523     ELSE
 10524         MOVE CL-DOCTOR-ADDR-CNT TO ACTV-SEQ
 10525         ADD +30                 TO ACTV-SEQ.
 10526
 10527     IF ACTV-SEQ = +30
 10528        GO TO 7210-READ-EMPLOYER-ADDR.
 10529
 10530
 10531* EXEC CICS HANDLE CONDITION
 10532*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10533*         NOTFND     (7210-READ-EMPLOYER-ADDR)
 10534*    END-EXEC.
 10535*    MOVE '"$JI                  ! 6 #00009786' TO DFHEIV0
 10536     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10538     MOVE X'3620233030303039373836' TO DFHEIV0(25:11)
 10539     CALL 'kxdfhei1' USING DFHEIV0
 10540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10541
 10542
 10543
 10544* EXEC CICS READ
 10545*         DATASET    (ACTV-ID)
 10546*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10547*         RIDFLD     (ACTV-KEY)
 10548*    END-EXEC.
 10549*    MOVE '&"S        E          (   #00009791' TO DFHEIV0
 10550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10552     MOVE X'2020233030303039373931' TO DFHEIV0(25:11)
 10553     CALL 'kxdfhei1' USING DFHEIV0,
 10554           ACTV-ID,
 10555           DFHEIV20,
 10556           DFHEIV99,
 10557           ACTV-KEY,
 10558           DFHEIV99,
 10559           DFHEIV99,
 10560           DFHEIV99
 10561     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10562         DFHEIV20
 10563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10564
 10565
 10566     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10567     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10568     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10569     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10570*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10571     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10572        INTO WS-LABEL-LINES (4)
 10573     END-STRING
 10574
 10575     MOVE SPACES                 TO  WS-ZIP-CODE.
 10576     IF AT-CANADIAN-POST-CODE
 10577         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 210
* EL152.cbl
 10578         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10579     ELSE
 10580         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10581         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10582             MOVE '-'            TO  WS-AM-ZIP-DASH
 10583             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10584
 10585     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10586
 10587     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10588     MOVE WSPI-AREA              TO WSPO-AREA.
 10589     MOVE WSPI-PFX               TO WSPO-PFX.
 10590     MOVE WSPI-SFX               TO WSPO-SFX.
 10591     MOVE WS-PHONE-OUT           TO SS47-5D.
 10592
 10593     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10594
 10595     MOVE WS-LABEL-LINES (1)     TO SS47D.
 10596     MOVE WS-LABEL-LINES (2)     TO SS47-1D.
 10597     MOVE WS-LABEL-LINES (3)     TO SS47-2D.
 10598     MOVE WS-LABEL-LINES (4)     TO SS47-3D.
 10599     MOVE WS-LABEL-LINES (5)     TO SS47-4D.
 10600
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 211
* EL152.cbl
 10602
 10603 7210-READ-EMPLOYER-ADDR.
 10604     IF W-EMPLOYER > ZERO
 10605         COMPUTE ACTV-SEQ = W-EMPLOYER + 40
 10606     ELSE
 10607         MOVE CL-EMPLOYER-ADDR-CNT
 10608                                 TO ACTV-SEQ
 10609         ADD +40                 TO ACTV-SEQ.
 10610
 10611     IF ACTV-SEQ = +40
 10612        GO TO 7220-READ-INSURED-ADDR.
 10613
 10614
 10615* EXEC CICS HANDLE CONDITION
 10616*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10617*         NOTFND     (7220-READ-INSURED-ADDR)
 10618*    END-EXEC.
 10619*    MOVE '"$JI                  ! 7 #00009845' TO DFHEIV0
 10620     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10622     MOVE X'3720233030303039383435' TO DFHEIV0(25:11)
 10623     CALL 'kxdfhei1' USING DFHEIV0
 10624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10625
 10626
 10627
 10628* EXEC CICS READ
 10629*         DATASET    (ACTV-ID)
 10630*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10631*         RIDFLD     (ACTV-KEY)
 10632*    END-EXEC.
 10633*    MOVE '&"S        E          (   #00009850' TO DFHEIV0
 10634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10636     MOVE X'2020233030303039383530' TO DFHEIV0(25:11)
 10637     CALL 'kxdfhei1' USING DFHEIV0,
 10638           ACTV-ID,
 10639           DFHEIV20,
 10640           DFHEIV99,
 10641           ACTV-KEY,
 10642           DFHEIV99,
 10643           DFHEIV99,
 10644           DFHEIV99
 10645     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10646         DFHEIV20
 10647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10648
 10649
 10650     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10651     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10652     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10653     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10654*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10655     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10656        INTO WS-LABEL-LINES (4)
 10657     END-STRING
 10658
 10659     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 212
* EL152.cbl
 10660     IF AT-CANADIAN-POST-CODE
 10661         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10662         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10663     ELSE
 10664         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10665         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10666             MOVE '-'            TO  WS-AM-ZIP-DASH
 10667             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10668
 10669     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10670
 10671     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10672     MOVE WSPI-AREA              TO WSPO-AREA.
 10673     MOVE WSPI-PFX               TO WSPO-PFX.
 10674     MOVE WSPI-SFX               TO WSPO-SFX.
 10675     MOVE WS-PHONE-OUT           TO SS48-5D.
 10676
 10677     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10678
 10679     MOVE WS-LABEL-LINES (1)     TO SS48D.
 10680     MOVE WS-LABEL-LINES (2)     TO SS48-1D.
 10681     MOVE WS-LABEL-LINES (3)     TO SS48-2D.
 10682     MOVE WS-LABEL-LINES (4)     TO SS48-3D.
 10683     MOVE WS-LABEL-LINES (5)     TO SS48-4D.
 10684
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 213
* EL152.cbl
 10686 7220-READ-INSURED-ADDR.
 10687
 10688     IF W-INSURED > ZERO
 10689         COMPUTE ACTV-SEQ = W-INSURED
 10690     ELSE
 10691         MOVE CL-INSURED-ADDR-CNT TO ACTV-SEQ.
 10692
 10693     IF ACTV-SEQ = +0
 10694        GO TO 7225-READ-OTHER1-ADDR.
 10695
 10696
 10697* EXEC CICS HANDLE CONDITION
 10698*         NOTOPEN   (8870-ACTV-NOT-OPEN)
 10699*         NOTFND    (7225-READ-OTHER1-ADDR)
 10700*    END-EXEC.
 10701*    MOVE '"$JI                  ! 8 #00009902' TO DFHEIV0
 10702     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10704     MOVE X'3820233030303039393032' TO DFHEIV0(25:11)
 10705     CALL 'kxdfhei1' USING DFHEIV0
 10706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10707
 10708
 10709
 10710* EXEC CICS READ
 10711*         DATASET   (ACTV-ID)
 10712*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10713*         RIDFLD    (ACTV-KEY)
 10714*    END-EXEC.
 10715*    MOVE '&"S        E          (   #00009907' TO DFHEIV0
 10716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10718     MOVE X'2020233030303039393037' TO DFHEIV0(25:11)
 10719     CALL 'kxdfhei1' USING DFHEIV0,
 10720           ACTV-ID,
 10721           DFHEIV20,
 10722           DFHEIV99,
 10723           ACTV-KEY,
 10724           DFHEIV99,
 10725           DFHEIV99,
 10726           DFHEIV99
 10727     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10728         DFHEIV20
 10729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10730
 10731
 10732     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10733     MOVE SS10D                  TO WS-LABEL-LINES (1).
 10734     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10735     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10736*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10737     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10738        INTO WS-LABEL-LINES (4)
 10739     END-STRING
 10740
 10741     MOVE SPACES                 TO  WS-ZIP-CODE.
 10742     IF AT-CANADIAN-POST-CODE
 10743         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 214
* EL152.cbl
 10744         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10745     ELSE
 10746         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10747         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10748             MOVE '-'            TO  WS-AM-ZIP-DASH
 10749             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10750
 10751     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10752
 10753     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10754
 10755     MOVE WS-LABEL-LINES (1)     TO SS10D.
 10756     MOVE WS-LABEL-LINES (2)     TO SS11-1D.
 10757     MOVE WS-LABEL-LINES (3)     TO SS11-2D.
 10758     MOVE WS-LABEL-LINES (4)     TO SS11-3D.
 10759     MOVE WS-LABEL-LINES (5)     TO SS11-4D.
 10760     MOVE AT-MAIL-TO-NAME        TO SS11-5D.
 10761
 10762     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10763     MOVE WSPI-AREA              TO WSPO-AREA.
 10764     MOVE WSPI-PFX               TO WSPO-PFX.
 10765     MOVE WSPI-SFX               TO WSPO-SFX.
 10766     MOVE WS-PHONE-OUT           TO SS11-6D.
 10767
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 215
* EL152.cbl
 10769
 10770 7225-READ-OTHER1-ADDR.
 10771
 10772     IF W-OTHER-1 > ZERO
 10773         COMPUTE ACTV-SEQ = W-OTHER-1 + 50
 10774     ELSE
 10775         MOVE CL-OTHER-1-ADDR-CNT TO ACTV-SEQ
 10776         ADD +50                  TO ACTV-SEQ.
 10777
 10778     IF ACTV-SEQ = +50
 10779        GO TO 7230-READ-OTHER2-ADDR.
 10780
 10781
 10782* EXEC CICS HANDLE CONDITION
 10783*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10784*         NOTFND     (7230-READ-OTHER2-ADDR)
 10785*    END-EXEC.
 10786*    MOVE '"$JI                  ! 9 #00009962' TO DFHEIV0
 10787     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10789     MOVE X'3920233030303039393632' TO DFHEIV0(25:11)
 10790     CALL 'kxdfhei1' USING DFHEIV0
 10791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10792
 10793
 10794
 10795* EXEC CICS READ
 10796*         DATASET    (ACTV-ID)
 10797*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10798*         RIDFLD     (ACTV-KEY)
 10799*    END-EXEC.
 10800*    MOVE '&"S        E          (   #00009967' TO DFHEIV0
 10801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10803     MOVE X'2020233030303039393637' TO DFHEIV0(25:11)
 10804     CALL 'kxdfhei1' USING DFHEIV0,
 10805           ACTV-ID,
 10806           DFHEIV20,
 10807           DFHEIV99,
 10808           ACTV-KEY,
 10809           DFHEIV99,
 10810           DFHEIV99,
 10811           DFHEIV99
 10812     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10813         DFHEIV20
 10814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10815
 10816
 10817     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10818     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10819     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10820     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10821*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10822     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10823        INTO WS-LABEL-LINES (4)
 10824     END-STRING
 10825
 10826     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 216
* EL152.cbl
 10827     IF AT-CANADIAN-POST-CODE
 10828         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10829         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10830     ELSE
 10831         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10832         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10833             MOVE '-'            TO  WS-AM-ZIP-DASH
 10834             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10835
 10836     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10837
 10838     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10839     MOVE WSPI-AREA              TO WSPO-AREA.
 10840     MOVE WSPI-PFX               TO WSPO-PFX.
 10841     MOVE WSPI-SFX               TO WSPO-SFX.
 10842     MOVE WS-PHONE-OUT           TO SS49-5D.
 10843
 10844     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10845
 10846     MOVE WS-LABEL-LINES (1)     TO SS49D.
 10847     MOVE WS-LABEL-LINES (2)     TO SS49-1D.
 10848     MOVE WS-LABEL-LINES (3)     TO SS49-2D.
 10849     MOVE WS-LABEL-LINES (4)     TO SS49-3D.
 10850     MOVE WS-LABEL-LINES (5)     TO SS49-4D.
 10851
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 217
* EL152.cbl
 10853 7230-READ-OTHER2-ADDR.
 10854
 10855     IF W-OTHER-2 > ZERO
 10856         COMPUTE ACTV-SEQ = W-OTHER-2 + 60
 10857     ELSE
 10858         MOVE CL-OTHER-2-ADDR-CNT TO ACTV-SEQ
 10859         ADD +60                  TO ACTV-SEQ.
 10860
 10861     IF ACTV-SEQ = +60
 10862        GO TO 7240-NOT-FOUND.
 10863
 10864
 10865* EXEC CICS HANDLE CONDITION
 10866*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10867*         NOTFND     (7240-NOT-FOUND)
 10868*    END-EXEC.
 10869*    MOVE '"$JI                  ! : #00010020' TO DFHEIV0
 10870     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10872     MOVE X'3A20233030303130303230' TO DFHEIV0(25:11)
 10873     CALL 'kxdfhei1' USING DFHEIV0
 10874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10875
 10876
 10877
 10878* EXEC CICS READ
 10879*         DATASET    (ACTV-ID)
 10880*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10881*         RIDFLD     (ACTV-KEY)
 10882*    END-EXEC.
 10883*    MOVE '&"S        E          (   #00010025' TO DFHEIV0
 10884     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10886     MOVE X'2020233030303130303235' TO DFHEIV0(25:11)
 10887     CALL 'kxdfhei1' USING DFHEIV0,
 10888           ACTV-ID,
 10889           DFHEIV20,
 10890           DFHEIV99,
 10891           ACTV-KEY,
 10892           DFHEIV99,
 10893           DFHEIV99,
 10894           DFHEIV99
 10895     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10896         DFHEIV20
 10897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10898
 10899
 10900     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10901     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10902     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10903     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10904*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10905     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10906        INTO WS-LABEL-LINES (4)
 10907     END-STRING
 10908
 10909     MOVE SPACES                 TO  WS-ZIP-CODE.
 10910     IF AT-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 218
* EL152.cbl
 10911         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10912         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10913     ELSE
 10914         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10915         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10916             MOVE '-'            TO  WS-AM-ZIP-DASH
 10917             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10918
 10919     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10920
 10921     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10922     MOVE WSPI-AREA              TO WSPO-AREA.
 10923     MOVE WSPI-PFX               TO WSPO-PFX.
 10924     MOVE WSPI-SFX               TO WSPO-SFX.
 10925     MOVE WS-PHONE-OUT           TO SS50-5D.
 10926
 10927     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10928
 10929     MOVE WS-LABEL-LINES (1)     TO SS50D.
 10930     MOVE WS-LABEL-LINES (2)     TO SS50-1D.
 10931     MOVE WS-LABEL-LINES (3)     TO SS50-2D.
 10932     MOVE WS-LABEL-LINES (4)     TO SS50-3D.
 10933     MOVE WS-LABEL-LINES (5)     TO SS50-4D.
 10934
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 219
* EL152.cbl
 10936 7240-NOT-FOUND.
 10937     IF ACCOUNT-IS-ONLINE
 10938        GO TO 7250-READ-ACCOUNT.
 10939
 10940     IF W-ACCOUNT > ZERO
 10941         COMPUTE ACTV-SEQ = W-ACCOUNT + 20
 10942     ELSE
 10943         MOVE CL-ACCOUNT-ADDR-CNT TO ACTV-SEQ
 10944         ADD +20                  TO ACTV-SEQ.
 10945
 10946     IF ACTV-SEQ = +20
 10947        GO TO 7250-READ-ACCOUNT.
 10948
 10949
 10950* EXEC CICS HANDLE CONDITION
 10951*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10952*         NOTFND     (7250-READ-ACCOUNT)
 10953*    END-EXEC.
 10954*    MOVE '"$JI                  ! ; #00010080' TO DFHEIV0
 10955     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10957     MOVE X'3B20233030303130303830' TO DFHEIV0(25:11)
 10958     CALL 'kxdfhei1' USING DFHEIV0
 10959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10960
 10961
 10962
 10963* EXEC CICS READ
 10964*         DATASET    (ACTV-ID)
 10965*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10966*         RIDFLD     (ACTV-KEY)
 10967*    END-EXEC.
 10968*    MOVE '&"S        E          (   #00010085' TO DFHEIV0
 10969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10971     MOVE X'2020233030303130303835' TO DFHEIV0(25:11)
 10972     CALL 'kxdfhei1' USING DFHEIV0,
 10973           ACTV-ID,
 10974           DFHEIV20,
 10975           DFHEIV99,
 10976           ACTV-KEY,
 10977           DFHEIV99,
 10978           DFHEIV99,
 10979           DFHEIV99
 10980     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10981         DFHEIV20
 10982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10983
 10984
 10985     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10986     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10987     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10988     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10989*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10990     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10991        INTO WS-LABEL-LINES (4)
 10992     END-STRING
 10993
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 220
* EL152.cbl
 10994     MOVE SPACES                 TO  WS-ZIP-CODE.
 10995     IF AT-CANADIAN-POST-CODE
 10996         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10997         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10998     ELSE
 10999         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11000         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11001             MOVE '-'            TO  WS-AM-ZIP-DASH
 11002             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11003
 11004     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11005
 11006     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11007     MOVE WSPI-AREA              TO WSPO-AREA.
 11008     MOVE WSPI-PFX               TO WSPO-PFX.
 11009     MOVE WSPI-SFX               TO WSPO-SFX.
 11010     MOVE WS-PHONE-OUT           TO SS07-6D.
 11011
 11012*    IF PI-COMPANY-ID NOT = 'FLA'
 11013*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11014
 11015     MOVE WS-LABEL-LINES (1)     TO SS06D.
 11016     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 11017     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 11018     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 11019     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 11020     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 11021
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 221
* EL152.cbl
 11023 7250-READ-ACCOUNT.
 11024*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11025*        GO TO 7250-READ-PRODUCER.
 11026
 11027     IF WS-ACCT-READ-SW = 'Y'
 11028        GO TO 7250-BUILD-ACCT-ADDR.
 11029
 11030     MOVE CM-CERT-EFF-DT TO ACCT-EXP-DATE.
 11031
 11032
 11033* EXEC CICS HANDLE CONDITION
 11034*         NOTOPEN   (8880-ACCT-NOT-OPEN)
 11035*         NOTFND    (7251-READ-3RD-PARTY)
 11036*    END-EXEC.
 11037*    MOVE '"$JI                  ! < #00010138' TO DFHEIV0
 11038     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11040     MOVE X'3C20233030303130313338' TO DFHEIV0(25:11)
 11041     CALL 'kxdfhei1' USING DFHEIV0
 11042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11043
 11044
 11045 7250-STARTBR-ACCOUNT.
 11046     MOVE ACCT-PARTIAL-KEY       TO  ACCT-SAVE-KEY.
 11047     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
 11048
 11049 7250-READNEXT-ACCOUNT.
 11050     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
 11051
 11052     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
 11053         IF WS-SAVE-ACCT-RECORD = SPACES
 11054             GO TO 7251-READ-3RD-PARTY
 11055         ELSE
 11056             MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
 11057             MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
 11058             GO TO 7250-BUILD-ACCT-ADDR.
 11059
 11060     IF AM-EXPIRATION-DT = HIGH-VALUES
 11061         MOVE AM-CONTROL-PRIMARY      TO  ACCT-KEY
 11062     ELSE
 11063         MOVE ACCOUNT-MASTER          TO  WS-SAVE-ACCT-RECORD
 11064         GO TO 7250-READNEXT-ACCOUNT.
 11065
 11066 7250-BUILD-ACCT-ADDR.
 11067     MOVE SPACES                TO  WS-SAVE-ACCT-RECORD.
 11068
 11069     IF NOT ACCOUNT-IS-ONLINE
 11070        GO TO 7251-READ-3RD-PARTY.
 11071
 11072     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11073     MOVE AM-NAME               TO WS-LABEL-LINES (1).
 11074     MOVE AM-PERSON             TO WS-LABEL-LINES (2).
 11075     MOVE AM-ADDRS              TO WS-LABEL-LINES (3).
 11076*    MOVE AM-CITY               TO WS-LABEL-LINES (4).
 11077     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
 11078        INTO WS-LABEL-LINES (4)
 11079     END-STRING
 11080
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 222
* EL152.cbl
 11081     MOVE SPACES                TO  WS-ZIP-CODE.
 11082     IF AM-CANADIAN-POST-CODE
 11083         MOVE AM-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11084         MOVE AM-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11085     ELSE
 11086         MOVE AM-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11087         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11088             MOVE '-'           TO  WS-AM-ZIP-DASH
 11089             MOVE AM-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11090
 11091     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11092
 11093     MOVE ZEROS                 TO WS-PHONE-IN.
 11094     MOVE AM-AREA-CODE          TO WSPO-AREA.
 11095     MOVE AM-TEL-PRE            TO WSPO-PFX.
 11096     MOVE AM-TEL-NBR            TO WSPO-SFX.
 11097     MOVE WS-PHONE-OUT          TO SS07-6D.
 11098
 11099*    IF PI-COMPANY-ID NOT = 'FLA'
 11100*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11101
 11102     MOVE WS-LABEL-LINES (1)     TO SS06D.
 11103     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 11104     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 11105     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 11106     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 11107     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 11108
 11109*    GO TO 7251-READ-3RD-PARTY.
 11110
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 223
* EL152.cbl
 11112*7250-READ-PRODUCER. Remove as dead code
 11113*7250-STARTBR-PRODUCER. Remove as dead code
 11114*7250-READNEXT-PRODUCER. Remove as dead code
 11115*7250-BUILD-PROD-ADDR. Remove as dead code
 11116 7251-READ-3RD-PARTY.
 11117
 11118     MOVE +29                    TO ACTV-SEQ.
 11119
 11120
 11121* EXEC CICS HANDLE CONDITION
 11122*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11123*         NOTFND     (7252-READ-COMP)
 11124*    END-EXEC.
 11125*    MOVE '"$JI                  ! = #00010218' TO DFHEIV0
 11126     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11127     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11128     MOVE X'3D20233030303130323138' TO DFHEIV0(25:11)
 11129     CALL 'kxdfhei1' USING DFHEIV0
 11130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11131
 11132
 11133
 11134* EXEC CICS READ
 11135*         DATASET    (ACTV-ID)
 11136*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11137*         RIDFLD     (ACTV-KEY)
 11138*    END-EXEC.
 11139*    MOVE '&"S        E          (   #00010223' TO DFHEIV0
 11140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11142     MOVE X'2020233030303130323233' TO DFHEIV0(25:11)
 11143     CALL 'kxdfhei1' USING DFHEIV0,
 11144           ACTV-ID,
 11145           DFHEIV20,
 11146           DFHEIV99,
 11147           ACTV-KEY,
 11148           DFHEIV99,
 11149           DFHEIV99,
 11150           DFHEIV99
 11151     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11152         DFHEIV20
 11153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11154
 11155
 11156     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11157     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 11158     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 11159     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 11160*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 11161     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 11162        INTO WS-LABEL-LINES (4)
 11163     END-STRING
 11164
 11165     MOVE SPACES                 TO  WS-ZIP-CODE.
 11166     IF AT-CANADIAN-POST-CODE
 11167         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 11168         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 11169     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 224
* EL152.cbl
 11170         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11171         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11172             MOVE '-'            TO  WS-AM-ZIP-DASH
 11173             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11174
 11175     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11176
 11177     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11178     MOVE WSPI-AREA              TO WSPO-AREA.
 11179     MOVE WSPI-PFX               TO WSPO-PFX.
 11180     MOVE WSPI-SFX               TO WSPO-SFX.
 11181     MOVE WS-PHONE-OUT           TO SS53-6D.
 11182
 11183     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11184
 11185     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11186     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11187     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11188     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11189     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11190     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11191
 11192     GO TO 7260-READ-DENIAL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 225
* EL152.cbl
 11194 7252-READ-COMP.
 11195
 11196     IF WS-COMP-READ-SW = 'Y'
 11197        GO TO 7255-BUILD-COMP-ADDR.
 11198
 11199     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 11200        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
 11201        GO TO 7260-READ-DENIAL.
 11202
 11203     IF AM-3RD-PARTY-NOTIF-LEVEL > 00 AND < 11
 11204        NEXT SENTENCE
 11205     ELSE
 11206        GO TO 7260-READ-DENIAL.
 11207
 11208     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
 11209        GO TO 7260-READ-DENIAL.
 11210
 11211     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD.
 11212     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER.
 11213     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING.
 11214     MOVE 'A'             TO WS-ERCOMP-TYPE.
 11215     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11216                          TO WS-ERCOMP-RESP-NO.
 11217
 11218     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 11219         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 11220                                       'G' OR 'B'
 11221             MOVE 'G'            TO WS-ERCOMP-TYPE
 11222             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
 11223         ELSE
 11224             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11225                                 TO WS-ERCOMP-ACCOUNT
 11226     ELSE
 11227         MOVE 'G'                TO WS-ERCOMP-TYPE
 11228         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
 11229
 11230     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
 11231        MOVE ZEROS TO WS-ERCOMP-CARRIER.
 11232
 11233     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
 11234        MOVE ZEROS TO WS-ERCOMP-GROUPING.
 11235
 11236
 11237* EXEC CICS HANDLE CONDITION
 11238*         NOTFND    (7260-READ-DENIAL)
 11239*    END-EXEC.
 11240*    MOVE '"$I                   ! > #00010309' TO DFHEIV0
 11241     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11243     MOVE X'3E20233030303130333039' TO DFHEIV0(25:11)
 11244     CALL 'kxdfhei1' USING DFHEIV0
 11245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11246
 11247
 11248
 11249* EXEC CICS  READ
 11250*         SET      (ADDRESS OF COMPENSATION-MASTER)
 11251*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 226
* EL152.cbl
 11252*         RIDFLD   (WS-ERCOMP-KEY)
 11253*    END-EXEC.
 11254     MOVE 'ERCOMP' TO DFHEIV1
 11255*    MOVE '&"S        E          (   #00010313' TO DFHEIV0
 11256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11258     MOVE X'2020233030303130333133' TO DFHEIV0(25:11)
 11259     CALL 'kxdfhei1' USING DFHEIV0,
 11260           DFHEIV1,
 11261           DFHEIV20,
 11262           DFHEIV99,
 11263           WS-ERCOMP-KEY,
 11264           DFHEIV99,
 11265           DFHEIV99,
 11266           DFHEIV99
 11267     SET ADDRESS OF COMPENSATION-MASTER TO
 11268         DFHEIV20
 11269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11270
 11271
 11272 7255-BUILD-COMP-ADDR.
 11273
 11274     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11275     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
 11276     IF CO-ACCT-NAME = SPACES
 11277        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
 11278     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
 11279     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
 11280     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
 11281
 11282     MOVE SPACES                TO  WS-ZIP-CODE.
 11283     IF CO-CANADIAN-POST-CODE
 11284         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11285         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11286     ELSE
 11287         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11288         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11289             MOVE '-'           TO  WS-AM-ZIP-DASH
 11290             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11291
 11292     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11293
 11294     MOVE ZEROS                 TO WS-PHONE-IN.
 11295     MOVE CO-AREA-CODE          TO WSPO-AREA.
 11296     MOVE CO-PREFIX             TO WSPO-PFX.
 11297     MOVE CO-PHONE              TO WSPO-SFX.
 11298     MOVE WS-PHONE-OUT          TO SS53-6D.
 11299
 11300     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11301
 11302     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11303     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11304     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11305     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11306     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11307     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11308
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 227
* EL152.cbl
 11310
 11311 7260-READ-DENIAL.
 11312
 11313     MOVE +93                    TO ACTV-SEQ
 11314
 11315
 11316* EXEC CICS HANDLE CONDITION
 11317*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11318*         NOTFND     (7265-READ-CNTL1)
 11319*         ENDFILE    (7265-READ-CNTL1)
 11320*    END-EXEC.
 11321*    MOVE '"$JI''                 ! ? #00010362' TO DFHEIV0
 11322     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 11323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11324     MOVE X'3F20233030303130333632' TO DFHEIV0(25:11)
 11325     CALL 'kxdfhei1' USING DFHEIV0
 11326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11327
 11328
 11329
 11330* EXEC CICS STARTBR
 11331*         DATASET    (ACTV-ID)
 11332*         RIDFLD     (ACTV-KEY)
 11333*         GTEQ
 11334*    END-EXEC.
 11335     MOVE 0
 11336       TO DFHEIV11
 11337*    MOVE '&,         G          &   #00010368' TO DFHEIV0
 11338     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11339     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11340     MOVE X'2020233030303130333638' TO DFHEIV0(25:11)
 11341     CALL 'kxdfhei1' USING DFHEIV0,
 11342           ACTV-ID,
 11343           ACTV-KEY,
 11344           DFHEIV99,
 11345           DFHEIV11,
 11346           DFHEIV99
 11347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11348
 11349
 11350     MOVE 'Y'                    TO ACTV-BROWSE-STARTED.
 11351     MOVE ACTV-PARTIAL-KEY       TO ACTV-SAVE-KEY.
 11352
 11353 7262-READ-NEXT.
 11354
 11355
 11356* EXEC CICS READNEXT
 11357*         SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11358*         RIDFLD  (ACTV-KEY)
 11359*         DATASET (ACTV-ID)
 11360*    END-EXEC.
 11361     MOVE 0
 11362       TO DFHEIV11
 11363*    MOVE '&.S                   )   #00010379' TO DFHEIV0
 11364     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11365     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11366     MOVE X'2020233030303130333739' TO DFHEIV0(25:11)
 11367     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 228
* EL152.cbl
 11368           ACTV-ID,
 11369           DFHEIV20,
 11370           DFHEIV99,
 11371           ACTV-KEY,
 11372           DFHEIV99,
 11373           DFHEIV11,
 11374           DFHEIV99,
 11375           DFHEIV99
 11376     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11377         DFHEIV20
 11378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11379
 11380
 11381     IF ACTV-PARTIAL-KEY  NOT = ACTV-SAVE-KEY
 11382        GO TO 7265-READ-CNTL1.
 11383     IF AT-TRAILER-TYPE = '2'
 11384        AND AT-PAYMENT-TYPE = 'I'
 11385        AND AT-INT-RATE NUMERIC
 11386        AND AT-INT-RATE NOT = ZEROS
 11387        COMPUTE WS-WORK-INT-RATE = AT-INT-RATE * 100
 11388        MOVE +1                  TO S2
 11389        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
 11390           (S1 > +6)
 11391           IF WS-WORK-INT (S1:1) NOT = '0'
 11392              MOVE WS-WORK-INT (S1:1)
 11393                                 TO SS16-1D (S2:1)
 11394              ADD +1             TO S2
 11395           END-IF
 11396        END-PERFORM
 11397        MOVE '%'                 TO SS16-1D (S2:1)
 11398        GO TO 7262-READ-NEXT
 11399     END-IF
 11400     IF AT-TRAILER-TYPE = '8'
 11401        MOVE AT-DENIAL-INFO-1    TO SS35-1D
 11402        MOVE AT-DENIAL-INFO-2    TO SS35-2D
 11403        IF (CL-TOTAL-INT-PAID = ZEROS)
 11404           OR (CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1)
 11405           GO TO 7265-READ-CNTL1
 11406        END-IF
 11407     END-IF
 11408     GO TO 7262-READ-NEXT
 11409     .
 11410 7265-READ-CNTL1.
 11411     IF ACTV-BROWSE-STARTED = 'Y'
 11412        MOVE 'N'                  TO ACTV-BROWSE-STARTED
 11413
 11414* EXEC CICS ENDBR
 11415*            DATASET    (ACTV-ID)
 11416*       END-EXEC.
 11417     MOVE 0
 11418       TO DFHEIV11
 11419*    MOVE '&2                    $   #00010417' TO DFHEIV0
 11420     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11421     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11422     MOVE X'2020233030303130343137' TO DFHEIV0(25:11)
 11423     CALL 'kxdfhei1' USING DFHEIV0,
 11424           ACTV-ID,
 11425           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 229
* EL152.cbl
 11426           DFHEIV99
 11427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11428
 11429
 11430     IF SS35-1D = ALL '*'
 11431         MOVE '@@DENIAL1'        TO SS35-1D.
 11432
 11433     IF SS35-2D = ALL '*'
 11434         MOVE '@@DENIAL2'        TO SS35-2D.
 11435
 11436     MOVE '1'                    TO CNTL-RECORD-TYPE.
 11437     MOVE ZEROS                  TO CNTL-SEQ.
 11438
 11439* EXEC CICS HANDLE CONDITION
 11440*         NOTOPEN   (8840-CNTL-NOT-OPEN)
 11441*         NOTFND    (7266-READ-CNTL2)
 11442*    END-EXEC.
 11443*    MOVE '"$JI                  ! @ #00010429' TO DFHEIV0
 11444     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11446     MOVE X'4020233030303130343239' TO DFHEIV0(25:11)
 11447     CALL 'kxdfhei1' USING DFHEIV0
 11448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11449
 11450
 11451
 11452* EXEC CICS READ
 11453*         DATASET   (CNTL-ID)
 11454*         SET       (ADDRESS OF CONTROL-FILE)
 11455*         RIDFLD    (CNTL-KEY)
 11456*    END-EXEC.
 11457*    MOVE '&"S        E          (   #00010434' TO DFHEIV0
 11458     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11460     MOVE X'2020233030303130343334' TO DFHEIV0(25:11)
 11461     CALL 'kxdfhei1' USING DFHEIV0,
 11462           CNTL-ID,
 11463           DFHEIV20,
 11464           DFHEIV99,
 11465           CNTL-KEY,
 11466           DFHEIV99,
 11467           DFHEIV99,
 11468           DFHEIV99
 11469     SET ADDRESS OF CONTROL-FILE TO
 11470         DFHEIV20
 11471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11472
 11473
 11474     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11475     MOVE CF-CL-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11476     MOVE CF-CL-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11477     MOVE CF-CL-ADDR-LINE-1      TO WS-LABEL-LINES (3).
 11478     MOVE CF-CL-ADDR-LINE-2      TO WS-LABEL-LINES (4).
 11479     MOVE CF-CL-CITY-STATE       TO WS-LABEL-LINES (5).
 11480
 11481     IF CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11482         MOVE ZEROS              TO  CF-CL-ZIP-CODE-NUM.
 11483     IF CF-CL-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 230
* EL152.cbl
 11484         MOVE CF-CL-ZIP-CODE-NUM TO  WS-ZIP-NUMERIC
 11485         MOVE WS-ZIP-NONNUM      TO  CF-CL-ZIP-CODE.
 11486
 11487     MOVE SPACES                 TO  WS-ZIP-CODE.
 11488     IF CF-CL-CAN-POST-CODE
 11489         MOVE CF-CL-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11490         MOVE CF-CL-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11491     ELSE
 11492         MOVE CF-CL-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11493         IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11494             MOVE '-'              TO  WS-AM-ZIP-DASH
 11495             MOVE CF-CL-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11496
 11497     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (6).
 11498
 11499     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11500
 11501     MOVE WS-LABEL-LINES (1)     TO SS01D.
 11502     MOVE WS-LABEL-LINES (2)     TO SS02-1D.
 11503     MOVE WS-LABEL-LINES (3)     TO SS02-2D.
 11504     MOVE WS-LABEL-LINES (4)     TO SS02-3D.
 11505     MOVE WS-LABEL-LINES (5)     TO SS02-4D.
 11506     MOVE WS-LABEL-LINES (6)     TO SS02-5D.
 11507
 11508 7266-READ-CNTL2.
 11509     IF PI-PROCESSOR-ID  =  LGXX-ID
 11510        GO TO 7267-READ-CNTL4.
 11511
 11512     MOVE '2'                    TO CNTL-RECORD-TYPE.
 11513     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
 11514     MOVE ZEROS                  TO CNTL-SEQ.
 11515
 11516
 11517* EXEC CICS HANDLE CONDITION
 11518*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11519*         NOTFND     (7267-READ-CNTL4)
 11520*    END-EXEC.
 11521*    MOVE '"$JI                  ! A #00010482' TO DFHEIV0
 11522     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11524     MOVE X'4120233030303130343832' TO DFHEIV0(25:11)
 11525     CALL 'kxdfhei1' USING DFHEIV0
 11526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11527
 11528
 11529
 11530* EXEC CICS READ
 11531*         DATASET    (CNTL-ID)
 11532*         SET        (ADDRESS OF CONTROL-FILE)
 11533*         RIDFLD     (CNTL-KEY)
 11534*    END-EXEC.
 11535*    MOVE '&"S        E          (   #00010487' TO DFHEIV0
 11536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11538     MOVE X'2020233030303130343837' TO DFHEIV0(25:11)
 11539     CALL 'kxdfhei1' USING DFHEIV0,
 11540           CNTL-ID,
 11541           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 231
* EL152.cbl
 11542           DFHEIV99,
 11543           CNTL-KEY,
 11544           DFHEIV99,
 11545           DFHEIV99,
 11546           DFHEIV99
 11547     SET ADDRESS OF CONTROL-FILE TO
 11548         DFHEIV20
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11550
 11551
 11552     MOVE CF-PROCESSOR-NAME      TO SS08D.
 11553     MOVE CF-PROCESSOR-TITLE     TO SS09D.
 11554
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 232
* EL152.cbl
 11556 7267-READ-CNTL4.
 11557*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11558*        GO TO 7267-READ-EMPLAN.
 11559
 11560     IF BEN-HOLD = ZEROS
 11561        GO TO 7267-READ-CNTL6.
 11562
 11563     MOVE BEN-HOLD               TO CNTL-GEN2.
 11564     MOVE SPACES                 TO CNTL-GEN1.
 11565
 11566     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11567        MOVE '4'                 TO CNTL-RECORD-TYPE
 11568     ELSE
 11569        MOVE '5'                 TO CNTL-RECORD-TYPE.
 11570
 11571     MOVE ZEROS                  TO CNTL-SEQ.
 11572
 11573
 11574* EXEC CICS HANDLE CONDITION
 11575*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11576*         NOTFND     (7267-READ-CNTL6)
 11577*    END-EXEC.
 11578*    MOVE '"$JI                  ! B #00010514' TO DFHEIV0
 11579     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11581     MOVE X'4220233030303130353134' TO DFHEIV0(25:11)
 11582     CALL 'kxdfhei1' USING DFHEIV0
 11583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11584
 11585
 11586
 11587* EXEC CICS READ
 11588*         DATASET    (CNTL-ID)
 11589*         SET        (ADDRESS OF CONTROL-FILE)
 11590*         RIDFLD     (CNTL-KEY)
 11591*         GTEQ
 11592*    END-EXEC.
 11593*    MOVE '&"S        G          (   #00010519' TO DFHEIV0
 11594     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11595     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11596     MOVE X'2020233030303130353139' TO DFHEIV0(25:11)
 11597     CALL 'kxdfhei1' USING DFHEIV0,
 11598           CNTL-ID,
 11599           DFHEIV20,
 11600           DFHEIV99,
 11601           CNTL-KEY,
 11602           DFHEIV99,
 11603           DFHEIV99,
 11604           DFHEIV99
 11605     SET ADDRESS OF CONTROL-FILE TO
 11606         DFHEIV20
 11607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11608
 11609
 11610     MOVE 1                      TO SUB.
 11611 7267-LOOP.
 11612     IF SUB = 9
 11613        GO TO 7267-READ-CNTL6.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 233
* EL152.cbl
 11614
 11615     IF CF-BENEFIT-CODE (SUB) < BEN-HOLD
 11616        ADD 1 TO SUB
 11617        GO TO 7267-LOOP.
 11618
 11619     IF BEN-HOLD = CF-BENEFIT-CODE (SUB)
 11620        MOVE CF-BENEFIT-DESCRIP (SUB) TO SS22D
 11621        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 11622           OR CL-CLAIM-TYPE = 'I'
 11623           OR CL-CLAIM-TYPE = 'G'
 11624           OR CL-CLAIM-TYPE = 'F'
 11625           MOVE CF-BENEFIT-ALPHA (SUB)   TO BENEFIT-WORK
 11626           MOVE ELIM-DAYS                TO SS42D.
 11627
 11628     GO TO 7267-READ-CNTL6.
 11629
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 234
* EL152.cbl
 11631*7267-READ-EMPLAN. Remove as dead code
 11632 7267-READ-CNTL6.
 11633     MOVE '6'                    TO CNTL-RECORD-TYPE.
 11634     MOVE SPACES                 TO CNTL-GENL.
 11635
 11636*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11637*        MOVE CL-CURRENT-CARRIER TO CNTL-GEN4
 11638*    ELSE
 11639         MOVE PI-CARRIER         TO CNTL-GEN4.
 11640
 11641     MOVE ZEROS                  TO CNTL-SEQ.
 11642
 11643
 11644* EXEC CICS HANDLE CONDITION
 11645*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11646*         NOTFND     (7268-SET-DATE)
 11647*    END-EXEC.
 11648*    MOVE '"$JI                  ! C #00010559' TO DFHEIV0
 11649     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11651     MOVE X'4320233030303130353539' TO DFHEIV0(25:11)
 11652     CALL 'kxdfhei1' USING DFHEIV0
 11653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11654
 11655
 11656
 11657* EXEC CICS READ
 11658*         DATASET    (CNTL-ID)
 11659*         SET        (ADDRESS OF CONTROL-FILE)
 11660*         RIDFLD     (CNTL-KEY)
 11661*    END-EXEC.
 11662*    MOVE '&"S        E          (   #00010564' TO DFHEIV0
 11663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11665     MOVE X'2020233030303130353634' TO DFHEIV0(25:11)
 11666     CALL 'kxdfhei1' USING DFHEIV0,
 11667           CNTL-ID,
 11668           DFHEIV20,
 11669           DFHEIV99,
 11670           CNTL-KEY,
 11671           DFHEIV99,
 11672           DFHEIV99,
 11673           DFHEIV99
 11674     SET ADDRESS OF CONTROL-FILE TO
 11675         DFHEIV20
 11676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11677
 11678
 11679     MOVE SPACES              TO WS-LABEL-HOLD-AREA.
 11680     MOVE CF-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11681     MOVE CF-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11682     MOVE CF-ADDRESS-LINE-1   TO WS-LABEL-LINES (3).
 11683     MOVE CF-ADDRESS-LINE-2   TO WS-LABEL-LINES (4).
 11684     MOVE CF-CITY-STATE       TO WS-LABEL-LINES (5).
 11685
 11686     IF CF-ZIP-CODE-NUM NOT NUMERIC
 11687         MOVE ZEROS              TO  CF-ZIP-CODE-NUM.
 11688     IF CF-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 235
* EL152.cbl
 11689         MOVE CF-ZIP-CODE-NUM    TO  WS-ZIP-NUMERIC
 11690         MOVE WS-ZIP-NONNUM      TO  CF-ZIP-CODE.
 11691
 11692     MOVE SPACES              TO  WS-ZIP-CODE.
 11693     IF CF-CANADIAN-POST-CODE
 11694         MOVE CF-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 11695         MOVE CF-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 11696     ELSE
 11697         MOVE CF-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 11698         IF CF-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11699             MOVE '-'          TO  WS-AM-ZIP-DASH
 11700             MOVE CF-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 11701
 11702     MOVE WS-ZIP-CODE         TO  WS-LABEL-LINES (6).
 11703
 11704     MOVE CF-PHONE-NO         TO WS-PHONE-IN.
 11705     MOVE WSPI-AREA           TO WSPO-AREA.
 11706     MOVE WSPI-PFX            TO WSPO-PFX.
 11707     MOVE WSPI-SFX            TO WSPO-SFX.
 11708     MOVE WS-PHONE-OUT        TO SS04-6D.
 11709
 11710     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11711
 11712     MOVE WS-LABEL-LINES (1)  TO SS03D
 11713     IF PI-CARRIER = '8'
 11714        MOVE 'as Administrator for Investors Heritage Life Insuran
 11715-     'ce Company'               TO SS03-1D
 11716     END-IF
 11717     MOVE WS-LABEL-LINES (2)  TO SS04-1D.
 11718     MOVE WS-LABEL-LINES (3)  TO SS04-2D.
 11719     MOVE WS-LABEL-LINES (4)  TO SS04-3D.
 11720     MOVE WS-LABEL-LINES (5)  TO SS04-4D.
 11721     MOVE WS-LABEL-LINES (6)  TO SS04-5D.
 11722
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 236
* EL152.cbl
 11724 7268-SET-DATE.
 11725     MOVE EIBDATE                TO DATE-WORK.
 11726     MOVE DT-WORK                TO DC-JULIAN-YYDDD.
 11727     MOVE '5'                    TO DC-OPTION-CODE.
 11728     PERFORM 9700-DATE-LINK  THRU  9700-EXIT.
 11729     MOVE DC-GREG-DATE-1-EDIT    TO SS20D.
 11730     MOVE DC-GREG-DATE-1-ALPHA   TO SS21D.
 11731
 11732     IF NOT LOWER-CASE-LETTERS-USED
 11733        GO TO 7269-EXIT.
 11734
 11735*    IF PI-COMPANY-ID = 'DMD'
 11736*        MOVE SS21D              TO WS-TEMP-AREA2
 11737*        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11738*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11739*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11740*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11741*        END-IF
 11742*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11743*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11744*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11745*        END-IF
 11746*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11747*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11748*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11749*        END-IF
 11750*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11751*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11752*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11753*        END-IF
 11754*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11755*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11756*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11757*        END-IF
 11758*        MOVE WS-TEMP-AREA2      TO SS21D
 11759*        GO TO 7269-EXIT.
 11760*
 11761     INSPECT SS19D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11762     INSPECT SS35-1D CONVERTING UPPER-CASE TO LOWER-CASE.
 11763     INSPECT SS35-2D CONVERTING UPPER-CASE TO LOWER-CASE.
 11764     INSPECT SS22D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11765
 11766     MOVE 'N'                    TO WS-STATE-LINE.
 11767
 11768     MOVE 'Y'                    TO WS-PROCESSOR-LINE.
 11769     MOVE SS08D                  TO WS-TEMP-AREA2.
 11770     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11771     MOVE WS-TEMP-AREA2          TO SS08D.
 11772     MOVE 'N'                    TO WS-PROCESSOR-LINE.
 11773     MOVE 'N'                    TO WS-CAPS-SW.
 11774
 11775     MOVE SS09D                  TO WS-TEMP-AREA2.
 11776     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11777     MOVE WS-TEMP-AREA2          TO SS09D.
 11778
 11779     MOVE SS11-5D                TO WS-TEMP-AREA2.
 11780     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11781     MOVE WS-TEMP-AREA2          TO SS11-5D.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 237
* EL152.cbl
 11782
 11783     MOVE SS21D                  TO WS-TEMP-AREA2.
 11784     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11785     MOVE WS-TEMP-AREA2          TO SS21D.
 11786
 11787     MOVE SS40D                  TO WS-TEMP-AREA2.
 11788     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11789     MOVE WS-TEMP-AREA2          TO SS40D.
 11790
 11791     MOVE SS41D                  TO WS-TEMP-AREA2.
 11792     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11793     MOVE WS-TEMP-AREA2          TO SS41D.
 11794
 11795 7269-EXIT.
 11796     EXIT.
 11797
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 238
* EL152.cbl
 11799*            COPY ELCNAMET.
 11800*****************************************************************
 11801*                                                               *
 11802*                                                               *
 11803*                            ELCNAMET                           *
 11804*                            VMOD=2.003                         *
 11805*                                                               *
 11806*            TRANSLATION ROUTINE USED MAINLY FOR CONVERTING     *
 11807*            NAMES AND ADDRESSES AND OTHER VARIABLES TO         *
 11808*            LOWER CASE.  THE FIRST CHARACTER OF EACH WORD      *
 11809*            IS LEFT AS UPPER AND ALL OTHER LOWER CASE.         *
 11810*                                                               *
 11811*                                                               *
 11812*****************************************************************.
 11813*                   C H A N G E   L O G
 11814*
 11815* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 11816*-----------------------------------------------------------------
 11817*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 11818* EFFECTIVE    NUMBER
 11819*-----------------------------------------------------------------
 11820* 102703                   SMVA  LEAVE CERTIFICATION DESIGNATION O
 11821*                                PROCESSOR NAME LINE IN CAPS
 11822******************************************************************
 11823
 11824 7270-LABEL-MOVE.
 11825     IF WS-LABEL-HOLD-AREA = SPACES
 11826        GO TO 7279-EXIT.
 11827
 11828     IF PI-COMPANY-ID NOT = 'DMD'
 11829         PERFORM 7280-TRANSLATE-LOWER THRU 7280-EXIT.
 11830
 11831 7270-LABEL-MOVE-1.
 11832
 11833     IF WS-LABEL-LINES (1) = SPACES
 11834        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
 11835        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11836        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11837        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11838        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11839        MOVE SPACES              TO WS-LABEL-LINES (6)
 11840        GO TO 7270-LABEL-MOVE-1.
 11841
 11842     IF WS-LABEL-LINES (2) = SPACES AND
 11843        WS-LABEL-LINES (3) = SPACES AND
 11844        WS-LABEL-LINES (4) = SPACES AND
 11845        WS-LABEL-LINES (5) = SPACES AND
 11846        WS-LABEL-LINES (6) = SPACES
 11847        SET WS-NDX               TO 1
 11848        GO TO 7275-MOVE-ZIP.
 11849
 11850 7270-LABEL-MOVE-2.
 11851
 11852     IF WS-LABEL-LINES (2) = SPACES
 11853        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11854        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11855        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11856        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 239
* EL152.cbl
 11857        MOVE SPACES              TO WS-LABEL-LINES (6)
 11858        GO TO 7270-LABEL-MOVE-2.
 11859
 11860     IF WS-LABEL-LINES (3) = SPACES AND
 11861        WS-LABEL-LINES (4) = SPACES AND
 11862        WS-LABEL-LINES (5) = SPACES AND
 11863        WS-LABEL-LINES (6) = SPACES
 11864        SET WS-NDX               TO 2
 11865        GO TO 7275-MOVE-ZIP.
 11866
 11867 7270-LABEL-MOVE-3.
 11868
 11869     IF WS-LABEL-LINES (3) = SPACES
 11870        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11871        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11872        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11873        MOVE SPACES              TO WS-LABEL-LINES (6)
 11874        GO TO 7270-LABEL-MOVE-3.
 11875
 11876     IF WS-LABEL-LINES (4) = SPACES AND
 11877        WS-LABEL-LINES (5) = SPACES AND
 11878        WS-LABEL-LINES (6) = SPACES
 11879        SET WS-NDX               TO 3
 11880        GO TO 7275-MOVE-ZIP.
 11881
 11882 7270-LABEL-MOVE-4.
 11883
 11884     IF WS-LABEL-LINES (4) = SPACES
 11885        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11886        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11887        MOVE SPACES              TO WS-LABEL-LINES (6)
 11888        GO TO 7270-LABEL-MOVE-4.
 11889
 11890     IF WS-LABEL-LINES (5) = SPACES AND
 11891        WS-LABEL-LINES (6) = SPACES
 11892        SET WS-NDX               TO 4
 11893        GO TO 7275-MOVE-ZIP.
 11894
 11895 7270-LABEL-MOVE-5.
 11896
 11897     IF WS-LABEL-LINES (5) = SPACES
 11898        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11899        MOVE SPACES              TO WS-LABEL-LINES (6)
 11900        SET WS-NDX               TO 5
 11901        GO TO 7275-MOVE-ZIP
 11902
 11903     ELSE
 11904        IF WS-LABEL-LINES (6) = SPACES
 11905           SET WS-NDX            TO 5
 11906           GO TO 7275-MOVE-ZIP
 11907
 11908        ELSE
 11909           SET WS-NDX            TO 6.
 11910
 11911 7275-MOVE-ZIP.
 11912
 11913     SET WS-NDX2                 TO WS-NDX.
 11914     SET WS-NDX2 DOWN BY +1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 240
* EL152.cbl
 11915
 11916     IF  WS-LAST-ZIP (WS-NDX2) = SPACES
 11917*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 11918         IF WS-LABEL-1ST-ZIP (WS-NDX) NUMERIC
 11919          IF PI-COMPANY-ID NOT = 'FLA'
 11920            MOVE WS-LABEL-ZIP (WS-NDX)
 11921                                     TO WS-LAST-ZIP (WS-NDX2)
 11922            MOVE SPACES              TO WS-LABEL-LINES (WS-NDX).
 11923
 11924 7279-EXIT.
 11925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 241
* EL152.cbl
 11927
 11928 7280-TRANSLATE-LOWER.
 11929     IF LOWER-CASE-LETTERS-USED
 11930        MOVE 'N'                     TO WS-STATE-LINE
 11931     ELSE
 11932        GO TO 7280-EXIT.
 11933
 11934     IF WS-LABEL-LINES (1) NOT = SPACES
 11935        MOVE WS-LABEL-LINES (1)      TO WS-TEMP-AREA2
 11936        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11937        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (1).
 11938
 11939     IF WS-LABEL-LINES (2) NOT = SPACES
 11940        MOVE WS-LABEL-LINES (2)      TO WS-TEMP-AREA2
 11941        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11942        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (2).
 11943
 11944     IF WS-LABEL-LINES (3) NOT = SPACES
 11945        MOVE WS-LABEL-LINES (3)      TO WS-TEMP-AREA2
 11946        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11947        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (3).
 11948
 11949*****THE CITY STATE WILL BE ON LINE FOUR OR FIVE DEPENDING
 11950*****ON THE FORMAT USED.  THE SIXTH LINE BEING BLANK WILL TELL.
 11951
 11952
 11953     IF WS-LABEL-LINES (4) NOT = SPACES
 11954        IF (WS-LABEL-LINES (6) = SPACES  OR
 11955           WS-LABEL-LINES (5) = SPACES)
 11956           MOVE 'Y'                     TO WS-STATE-LINE
 11957           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11958           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11959           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4)
 11960        ELSE
 11961           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11962           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11963           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4).
 11964
 11965     IF WS-LABEL-LINES (5) NOT = SPACES
 11966        IF WS-LABEL-LINES (6) NOT = SPACES
 11967           MOVE 'Y'                     TO WS-STATE-LINE
 11968           MOVE WS-LABEL-LINES (5)      TO WS-TEMP-AREA2
 11969           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11970           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (5).
 11971
 11972 7280-EXIT.
 11973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 242
* EL152.cbl
 11975
 11976 7281-SEARCH-AND-TRANSLATE.
 11977     SET TA1  TO +1.
 11978
 11979 7281-FIND-FIRST-NON-BLANK.
 11980     IF WS-TEMP-2 (TA1) = SPACES
 11981        SET TA1 UP BY 1
 11982        GO TO 7281-FIND-FIRST-NON-BLANK.
 11983
 11984*****SET INDEX TO THE NEXT CHAR TO START THE TRANSLATE.
 11985     SET TA2   TO TA1
 11986     SET TA2   UP BY 1
 11987     SET TA21  TO TA2
 11988     SET TA21  UP BY 1.
 11989
 11990     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11991     PERFORM 7282-FIND-NEXT-BLANK THRU 7282-EXIT.
 11992
 11993 7281-EXIT.
 11994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 243
* EL152.cbl
 11996
 11997 7282-FIND-NEXT-BLANK.
 11998     IF TA21 GREATER THAN 31
 11999        GO TO 7282-EXIT.
 12000
 12001     IF TA21 EQUAL TO 31
 12002        IF NO-CHARACTERS-FOUND
 12003           GO TO 7282-EXIT
 12004           ELSE
 12005           SET TA1   TO +1
 12006           MOVE SPACES             TO WS-TEMP-AREA1
 12007           PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 12008                   UNTIL MOVE-INDX EQUAL TO TA21
 12009           PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT
 12010           SET TA1   TO +1
 12011           PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 12012                   UNTIL MOVE-INDX EQUAL TO TA21
 12013           GO TO 7282-EXIT.
 12014
 12015     IF WS-TEMP-2 (TA2)  = SPACE OR ',' OR '/'
 12016         GO TO 7282-NEXT-GROUP-SEARCH.
 12017
 12018     IF WS-TEMP-2 (TA21) = SPACES OR ',' OR '/'
 12019         IF WS-TEMP-2 (TA21)  = ','
 12020            AND WS-PROCESSOR-LINE = 'Y'
 12021             SET THE-REST-R-CAPS TO TRUE
 12022         ELSE
 12023             CONTINUE
 12024     ELSE
 12025         MOVE 'Y'                  TO WS-DATA-FOUND-SW
 12026         SET TA21 UP BY +1
 12027         GO TO 7282-FIND-NEXT-BLANK.
 12028
 12029     SET TA1  TO +1
 12030     MOVE SPACES                   TO WS-TEMP-AREA1.
 12031     PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 12032             UNTIL MOVE-INDX EQUAL TO TA21
 12033     PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT.
 12034     SET TA1  TO +1
 12035     PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 12036             UNTIL MOVE-INDX EQUAL TO TA21
 12037     IF THE-REST-R-CAPS
 12038         GO TO 7282-EXIT.
 12039     SET TA2   TO TA21
 12040     SET TA21  UP BY 1
 12041     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 12042 7282-NEXT-GROUP-SEARCH.
 12043     IF WS-TEMP-2 (TA2) EQUAL TO SPACES OR ',' OR '/'
 12044        SET TA2   UP BY 1
 12045        IF TA2 = 30
 12046           GO TO 7282-EXIT
 12047           ELSE
 12048           GO TO 7282-NEXT-GROUP-SEARCH.
 12049
 12050     SET TA2    UP BY 1
 12051     SET TA21   TO TA2
 12052     SET TA21   UP BY 1
 12053     GO TO 7282-FIND-NEXT-BLANK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 244
* EL152.cbl
 12054
 12055 7282-EXIT.
 12056     EXIT.
 12057
 12058
 12059 7283-MOVE.
 12060     MOVE WS-TEMP-2 (MOVE-INDX) TO WS-TEMP-1 (TA1)
 12061     SET TA1 UP BY +1.
 12062
 12063
 12064 7284-MOVE-BACK.
 12065     MOVE WS-TEMP-1 (TA1)       TO WS-TEMP-2 (MOVE-INDX).
 12066     SET TA1 UP BY +1.
 12067
 12068 7285-TEST-AND-TRANSLATE.
 12069***BYPASS IF THE AREA MAY BE A PO BOX, OR RR NUMBER
 12070     IF WS-TEMP-AREA1 = '.O.' OR 'RR' OR 'O'
 12071        GO TO 7285-EXIT.
 12072
 12073***BYPASS IF IT IS A CITY/STATE LINE AND BEYOND CHARACTER 07
 12074***AND IT APPEARS THAT IT MAY BE A ABREVIATION.
 12075
 12076     SET WS-POSITION2   TO TA2
 12077     SET WS-POSITION21  TO TA21
 12078     COMPUTE WS-WORD-LENGTH = WS-POSITION21 - WS-POSITION2
 12079     IF WS-WORD-LENGTH LESS THAN 3 AND
 12080        WS-STATE-LINE = 'Y' AND
 12081        TA2 GREATER THAN 07
 12082        GO TO 7285-EXIT.
 12083
 12084     INSPECT WS-TEMP-AREA1 CONVERTING UPPER-CASE TO LOWER-CASE.
 12085
 12086 7285-EXIT.
 12087     EXIT.
 12088
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 245
* EL152.cbl
 12090 7290-RESOLVE-CREDITOR.
 12091
 12092
 12093* EXEC CICS HANDLE CONDITION
 12094*         NOTOPEN    (7290-BENE-NOT-OPEN)
 12095*         NOTFND     (7290-EXIT)
 12096*    END-EXEC.
 12097*    MOVE '"$JI                  ! D #00010983' TO DFHEIV0
 12098     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12100     MOVE X'4420233030303130393833' TO DFHEIV0(25:11)
 12101     CALL 'kxdfhei1' USING DFHEIV0
 12102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12103
 12104
 12105     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 12106
 12107     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12108     MOVE 'B'                    TO BENE-REC-TYPE.
 12109     MOVE SPACES                 TO BENE-NUMBER.
 12110     MOVE CL-CURRENT-GROUPING    TO BENE-CREDITOR.
 12111
 12112
 12113* EXEC CICS READ
 12114*         DATASET    (BENE-ID)
 12115*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 12116*         RIDFLD     (BENE-KEY)
 12117*    END-EXEC.
 12118*    MOVE '&"S        E          (   #00010995' TO DFHEIV0
 12119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12121     MOVE X'2020233030303130393935' TO DFHEIV0(25:11)
 12122     CALL 'kxdfhei1' USING DFHEIV0,
 12123           BENE-ID,
 12124           DFHEIV20,
 12125           DFHEIV99,
 12126           BENE-KEY,
 12127           DFHEIV99,
 12128           DFHEIV99,
 12129           DFHEIV99
 12130     SET ADDRESS OF BENEFICIARY-MASTER TO
 12131         DFHEIV20
 12132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12133
 12134
 12135     IF LOWER-CASE-LETTERS-USED
 12136         MOVE BE-MAIL-TO-NAME    TO WS-TEMP-AREA2
 12137         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 12138         MOVE WS-TEMP-AREA2      TO SS56D
 12139     ELSE
 12140         MOVE BE-MAIL-TO-NAME    TO SS56D.
 12141
 12142     GO TO 7290-EXIT.
 12143
 12144 7290-BENE-NOT-OPEN.
 12145
 12146     MOVE ER-7675                TO EMI-ERROR.
 12147     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 246
* EL152.cbl
 12148     MOVE -1                     TO MAINTL.
 12149     GO TO 8200-SEND-DATAONLY.
 12150
 12151 7290-EXIT.
 12152     EXIT.
 12153
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 247
* EL152.cbl
 12155 7300-VARIABLE-SEARCH.
 12156***************************************************************
 12157*    THIS ROUTINE SEARCHES THE NEWLY CREATED LETTER FOR ANY   *
 12158*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 12159*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 12160*    DATA THAT WAS GENERATED IN PARAGRAPHS 7200-7299.         *
 12161*                                                             *
 12162*    THE ADDRESSING OF THE VARIABLE TABLE IS ACCOMPLISHED     *
 12163*    BY DOING A GETMAIN, MOVING THE TABLE TO THE NEW STORAGE  *
 12164*    AND BY ADJUSTING THE BLL POINTER TO POINT AT THE DATA.   *
 12165***************************************************************
 12166
 12167     MOVE REC-TEXT (TB-INDX)     TO SINGLE-LINE.
 12168
 12169     SET INDX1 TO 1.
 12170 7301-LOOP.
 12171     IF INDX1 > 70
 12172        MOVE SINGLE-LINE         TO REC-TEXT (TB-INDX)
 12173        GO TO 7399-EXIT.
 12174
 12175     IF ONE-CHAR (INDX1) NOT = '@'
 12176        SET INDX1 UP BY 1
 12177        GO TO 7301-LOOP.
 12178
 12179     SET INDX2 TO INDX1.
 12180     SET INDX2 UP BY 1.
 12181
 12182     IF ONE-CHAR (INDX2) = '@'
 12183        SET INDX1 UP BY 2
 12184        GO TO 7301-LOOP.
 12185
 12186     MOVE ONE-CHAR (INDX2)       TO V1.
 12187     SET INDX2 UP BY 1.
 12188     MOVE ONE-CHAR (INDX2)       TO V2.
 12189     SET INDX2 UP BY 1.
 12190     MOVE ONE-CHAR (INDX2)       TO V3.
 12191     SET INDX2 UP BY 1.
 12192     MOVE ONE-CHAR (INDX2)       TO V4.
 12193
 12194     IF V-NUM NOT NUMERIC
 12195        GO TO 7330-VAR-ERROR.
 12196
 12197     IF V-PERIOD NOT = '.'
 12198        MOVE '.'                 TO V-PERIOD
 12199        MOVE ZERO                TO V-DECIMAL
 12200        GO TO 7340-TABLE-SEARCH.
 12201
 12202     IF V-DECIMAL NUMERIC
 12203        GO TO 7340-TABLE-SEARCH.
 12204
 12205 7330-VAR-ERROR.
 12206     MOVE ER-0180                TO EMI-ERROR.
 12207     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12208     SET INDX1 UP BY 1.
 12209     GO TO 7301-LOOP.
 12210
 12211 7340-TABLE-SEARCH.
 12212
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 248
* EL152.cbl
 12213     IF REFRESH-GETMAIN-AREA
 12214*        MOVE SAVE-VARIABLE-POINTER      TO LCP-WS-ADDR-COMP
 12215*        SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12216         MOVE SYSTEM-SUPPORTED-VARIABLES TO SYSTEM-VARIABLES
 12217         MOVE 2                          TO GETMAIN-SWITCH
 12218         MOVE 1                          TO SS-COUNTER
 12219                                            B1
 12220     ELSE
 12221         IF NO-GETMAIN-DONE-YET
 12222*            EXEC CICS GETMAIN
 12223*                 SET       (ADDRESS OF SYSTEM-VARIABLES)
 12224*                 LENGTH    (SS-WORK-AREA-LENGTH)
 12225*            END-EXEC
 12226             MOVE 2              TO GETMAIN-SWITCH
 12227*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12228*            MOVE LCP-WS-ADDR-COMP
 12229*                                TO SAVE-VARIABLE-POINTER
 12230             MOVE SYSTEM-SUPPORTED-VARIABLES
 12231                                 TO SYSTEM-VARIABLES
 12232             MOVE 1              TO SS-COUNTER
 12233                                    B1
 12234         ELSE
 12235             MOVE 1              TO SS-COUNTER
 12236                                    B1
 12237*            MOVE SAVE-VARIABLE-POINTER
 12238*                                TO LCP-WS-ADDR-COMP
 12239*            SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12240         END-IF
 12241     END-IF
 12242     .
 12243 7350-TABLE-LOOP.
 12244
 12245     IF SS-COUNTER  >  SS-NUM-ENTRIES
 12246        GO TO 7330-VAR-ERROR.
 12247
 12248     MOVE SYSTEM-VARIABLES (B1:106)
 12249                                 TO SYS-VAR-ENTRY
 12250     IF SYS-VAR-CODE NOT = VAR-HOLD
 12251        ADD SYS-VAR-LEN          TO B1
 12252*       SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12253*       ADD SYS-VAR-LEN          TO LCP-WS-ADDR-COMP
 12254*       SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12255        ADD 1                    TO SS-COUNTER
 12256        GO TO 7350-TABLE-LOOP
 12257     END-IF
 12258
 12259     MOVE SYS-VAR-ENTRY          TO VARIABLE-WORK-AREA.
 12260     SET INDXV TO 1.
 12261     SUBTRACT 6                  FROM VAR-LEN.
 12262     PERFORM 7400-MOVE-VAR-DATA VAR-LEN TIMES.
 12263     GO TO 7301-LOOP.
 12264
 12265 7399-EXIT.
 12266      EXIT.
 12267
 12268 7400-MOVE-VAR-DATA.
 12269     IF INDX1 > 70
 12270        MOVE ER-0181             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 249
* EL152.cbl
 12271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12272        GO TO 7301-LOOP.
 12273
 12274     MOVE VAR-ONE-CHAR (INDXV)   TO ONE-CHAR (INDX1).
 12275     SET INDXV UP BY 1.
 12276     SET INDX1 UP BY 1.
 12277
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 250
* EL152.cbl
 12279 7500-READ-TS.
 12280
 12281* EXEC CICS HANDLE CONDITION
 12282*         QIDERR     (7590-TS-QIDERR)
 12283*         ITEMERR    (7585-TS-ITEMERR)
 12284*    END-EXEC.
 12285*    MOVE '"$N<                  ! E #00011146' TO DFHEIV0
 12286     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12288     MOVE X'4520233030303131313436' TO DFHEIV0(25:11)
 12289     CALL 'kxdfhei1' USING DFHEIV0
 12290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12291
 12292
 12293     SET TS-INDX TO 1.
 12294     MOVE 1                      TO TS-ITEM.
 12295
 12296 7501-LOOP.
 12297
 12298* EXEC CICS READQ TS
 12299*         INTO     (TS-WORK-AREA)
 12300*         QUEUE    (TS-NAME-TEXT)
 12301*         LENGTH   (TS-LENGTH)
 12302*         ITEM     (TS-ITEM)
 12303*    END-EXEC.
 12304*    MOVE '*$II   L              ''   #00011155' TO DFHEIV0
 12305     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12306     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12307     MOVE X'2020233030303131313535' TO DFHEIV0(25:11)
 12308     CALL 'kxdfhei1' USING DFHEIV0,
 12309           TS-NAME-TEXT,
 12310           TS-WORK-AREA,
 12311           TS-LENGTH,
 12312           TS-ITEM,
 12313           DFHEIV99,
 12314           DFHEIV99
 12315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12316
 12317
 12318     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
 12319     SET TS-INDX UP BY 1.
 12320     ADD 1                       TO TS-ITEM.
 12321     GO TO 7501-LOOP.
 12322
 12323 7585-TS-ITEMERR.
 12324     IF EIBTRNID NOT = TRANS-ID
 12325        SUBTRACT 1               FROM TS-ITEM
 12326        MOVE TS-ITEM             TO PI-TEMP-STOR-ITEMS.
 12327
 12328     GO TO 7599-EXIT.
 12329
 12330 7590-TS-QIDERR.
 12331     IF EIBTRNID = TRANS-ID
 12332        MOVE ER-0033             TO EMI-ERROR
 12333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12334        GO TO 8200-SEND-DATAONLY.
 12335
 12336 7599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 251
* EL152.cbl
 12337      EXIT.
 12338
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 252
* EL152.cbl
 12340 7600-READ-SCREEN-TS.
 12341
 12342* EXEC CICS HANDLE CONDITION
 12343*         QIDERR     (7690-TS-QIDERR)
 12344*         ITEMERR    (7685-TS-ITEMERR)
 12345*    END-EXEC.
 12346*    MOVE '"$N<                  ! F #00011185' TO DFHEIV0
 12347     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12349     MOVE X'4620233030303131313835' TO DFHEIV0(25:11)
 12350     CALL 'kxdfhei1' USING DFHEIV0
 12351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12352
 12353
 12354     MOVE 1                      TO TS-ITEM.
 12355
 12356
 12357* EXEC CICS READQ TS
 12358*         INTO    (EL152AO)
 12359*         QUEUE   (TS-NAME-SCREEN)
 12360*         LENGTH  (TS-MAP-LENGTH)
 12361*         ITEM    (TS-ITEM)
 12362*    END-EXEC.
 12363*    MOVE '*$II   L              ''   #00011192' TO DFHEIV0
 12364     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12365     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12366     MOVE X'2020233030303131313932' TO DFHEIV0(25:11)
 12367     CALL 'kxdfhei1' USING DFHEIV0,
 12368           TS-NAME-SCREEN,
 12369           EL152AO,
 12370           TS-MAP-LENGTH,
 12371           TS-ITEM,
 12372           DFHEIV99,
 12373           DFHEIV99
 12374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12375
 12376
 12377     IF MAINTL NOT = ZEROS
 12378        MOVE AL-UANON            TO MAINTA.
 12379     IF ARCHNUML NOT = ZEROS
 12380        MOVE AL-UNNON            TO ARCHNUMA.
 12381     IF FORML NOT = ZEROS
 12382        MOVE AL-UANON            TO FORMA.
 12383     IF FOLLOWL NOT = ZEROS
 12384        MOVE AL-UANON            TO FOLLOWA.
 12385     IF RESENDL NOT = ZEROS
 12386        MOVE AL-UANON            TO RESENDA.
 12387     IF PRINTL NOT = ZEROS
 12388        MOVE AL-UANON            TO PRINTA.
 12389     IF COPIESL NOT = ZEROS
 12390        MOVE AL-UNNON            TO COPIESA.
 12391     IF ADDRL NOT = ZEROS
 12392        MOVE AL-UANON            TO ADDRA.
 12393     IF REL NOT = ZEROS
 12394        MOVE AL-UANON            TO REA.
 12395
 12396     GO TO 7699-EXIT.
 12397
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 253
* EL152.cbl
 12398 7685-TS-ITEMERR.
 12399     GO TO 7699-EXIT.
 12400
 12401 7690-TS-QIDERR.
 12402     IF EIBTRNID = TRANS-ID
 12403        MOVE ER-0033             TO EMI-ERROR
 12404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12405        GO TO 8200-SEND-DATAONLY.
 12406
 12407 7699-EXIT.
 12408      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 254
* EL152.cbl
 12410
 12411 7700-PUT-TEMP-STOR.
 12412     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 12413     PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT.
 12414     SET TS-INDX TO 1.
 12415     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12416     PERFORM 7780-WRITE-TS THRU 7780-EXIT
 12417             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12418             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES.
 12419
 12420 7749-EXIT.
 12421      EXIT.
 12422
 12423 7750-DELETE-TEMP-STOR.
 12424
 12425* EXEC CICS HANDLE CONDITION
 12426*         QIDERR      (7750-EXIT)
 12427*    END-EXEC.
 12428*    MOVE '"$N                   ! G #00011246' TO DFHEIV0
 12429     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12431     MOVE X'4720233030303131323436' TO DFHEIV0(25:11)
 12432     CALL 'kxdfhei1' USING DFHEIV0
 12433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12434
 12435
 12436
 12437* EXEC CICS DELETEQ TS
 12438*         QUEUE       (TS-NAME-TEXT)
 12439*    END-EXEC.
 12440*    MOVE '*&                    #   #00011250' TO DFHEIV0
 12441     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12442     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12443     MOVE X'2020233030303131323530' TO DFHEIV0(25:11)
 12444     CALL 'kxdfhei1' USING DFHEIV0,
 12445           TS-NAME-TEXT,
 12446           DFHEIV99
 12447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12448
 12449
 12450 7750-EXIT.
 12451     EXIT.
 12452
 12453 7760-DELETE-TEMP-STOR-SCREEN.
 12454
 12455* EXEC CICS HANDLE CONDITION
 12456*         QIDERR     (7760-EXIT)
 12457*    END-EXEC.
 12458*    MOVE '"$N                   ! H #00011258' TO DFHEIV0
 12459     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12461     MOVE X'4820233030303131323538' TO DFHEIV0(25:11)
 12462     CALL 'kxdfhei1' USING DFHEIV0
 12463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12464
 12465
 12466
 12467* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 255
* EL152.cbl
 12468*         QUEUE      (TS-NAME-SCREEN)
 12469*    END-EXEC.
 12470*    MOVE '*&                    #   #00011262' TO DFHEIV0
 12471     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12472     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12473     MOVE X'2020233030303131323632' TO DFHEIV0(25:11)
 12474     CALL 'kxdfhei1' USING DFHEIV0,
 12475           TS-NAME-SCREEN,
 12476           DFHEIV99
 12477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12478
 12479
 12480 7760-EXIT.
 12481     EXIT.
 12482
 12483 7770-DELETE-TEMP-STOR-PI-AREA.
 12484
 12485* EXEC CICS HANDLE CONDITION
 12486*        QIDERR   (7770-EXIT)
 12487*    END-EXEC.
 12488*    MOVE '"$N                   ! I #00011270' TO DFHEIV0
 12489     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12491     MOVE X'4920233030303131323730' TO DFHEIV0(25:11)
 12492     CALL 'kxdfhei1' USING DFHEIV0
 12493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12494
 12495
 12496
 12497* EXEC CICS DELETEQ TS
 12498*        QUEUE    (WS-PI-QID)
 12499*    END-EXEC.
 12500*    MOVE '*&                    #   #00011274' TO DFHEIV0
 12501     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12502     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12503     MOVE X'2020233030303131323734' TO DFHEIV0(25:11)
 12504     CALL 'kxdfhei1' USING DFHEIV0,
 12505           WS-PI-QID,
 12506           DFHEIV99
 12507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12508
 12509
 12510 7770-EXIT.
 12511     EXIT.
 12512
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 256
* EL152.cbl
 12514 7780-WRITE-TS.
 12515     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
 12516     SET TS-INDX UP BY 1.
 12517     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 12518
 12519
 12520* EXEC CICS WRITEQ TS
 12521*         FROM    (TS-WORK-AREA)
 12522*         QUEUE   (TS-NAME-TEXT)
 12523*         LENGTH  (TS-LENGTH)
 12524*         ITEM    (PI-TEMP-STOR-ITEMS)
 12525*    END-EXEC.
 12526*    MOVE '*" I                  ''   #00011287' TO DFHEIV0
 12527     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12528     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12529     MOVE X'2020233030303131323837' TO DFHEIV0(25:11)
 12530     CALL 'kxdfhei1' USING DFHEIV0,
 12531           TS-NAME-TEXT,
 12532           TS-WORK-AREA,
 12533           TS-LENGTH,
 12534           PI-TEMP-STOR-ITEMS,
 12535           DFHEIV99,
 12536           DFHEIV99
 12537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12538
 12539
 12540 7780-EXIT.
 12541     EXIT.
 12542
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 257
* EL152.cbl
 12544 7790-WRITE-SCREEN-TS.
 12545     MOVE 1                      TO TS-ITEM.
 12546
 12547
 12548* EXEC CICS WRITEQ TS
 12549*         FROM    (EL152AI)
 12550*         QUEUE   (TS-NAME-SCREEN)
 12551*         LENGTH  (TS-MAP-LENGTH)
 12552*         ITEM    (TS-ITEM)
 12553*    END-EXEC.
 12554*    MOVE '*" I                  ''   #00011301' TO DFHEIV0
 12555     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12556     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12557     MOVE X'2020233030303131333031' TO DFHEIV0(25:11)
 12558     CALL 'kxdfhei1' USING DFHEIV0,
 12559           TS-NAME-SCREEN,
 12560           EL152AI,
 12561           TS-MAP-LENGTH,
 12562           TS-ITEM,
 12563           DFHEIV99,
 12564           DFHEIV99
 12565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12566
 12567
 12568 7790-EXIT.
 12569     EXIT.
 12570
 12571 7795-WRITE-PI-AREA-TS.
 12572
 12573* EXEC CICS WRITEQ TS
 12574*        QUEUE    (WS-PI-QID)
 12575*        FROM     (PROGRAM-INTERFACE-BLOCK)
 12576*        LENGTH   (PI-COMM-LENGTH)
 12577*    END-EXEC.
 12578*    MOVE '*"                    ''   #00011312' TO DFHEIV0
 12579     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 12580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12581     MOVE X'2020233030303131333132' TO DFHEIV0(25:11)
 12582     CALL 'kxdfhei1' USING DFHEIV0,
 12583           WS-PI-QID,
 12584           PROGRAM-INTERFACE-BLOCK,
 12585           PI-COMM-LENGTH,
 12586           DFHEIV99,
 12587           DFHEIV99,
 12588           DFHEIV99
 12589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12590
 12591
 12592 7795-EXIT.
 12593     EXIT.
 12594
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 258
* EL152.cbl
 12596 7800-PRINT-LETTER-NOW.
 12597***************************************************************
 12598*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 12599*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 12600*        THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS,       *
 12601*        THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE,    *
 12602*        THE LETTER IS SAVED IN TEMP-STORAGE,                 *
 12603*        AND A START IS ISSUED FOR THE PRINT TRANSACTION.     *
 12604***************************************************************
 12605
 12606     PERFORM 400-SET-CODES THRU 499-EXIT.
 12607
 12608     PERFORM 7500-READ-TS        THRU 7599-EXIT
 12609     PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12610     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12611             VARYING SC-INDX FROM 1 BY 1
 12612             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12613
 12614     IF PI-TOTAL-LINES = 0
 12615        MOVE ER-0187             TO EMI-ERROR
 12616        MOVE -1                  TO MAINTL
 12617        MOVE AL-UABON            TO MAINTA
 12618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12619        GO TO 8200-SEND-DATAONLY.
 12620
 12621     IF COPIESL NOT = ZEROS
 12622        IF COPIESI NOT NUMERIC
 12623           MOVE ER-0184          TO EMI-ERROR
 12624           MOVE -1               TO COPIESL
 12625           MOVE AL-UNBON         TO COPIESA
 12626           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12627           GO TO 8200-SEND-DATAONLY
 12628         ELSE
 12629           MOVE COPIESI          TO PI-NUM-PRINT-COPIES
 12630       ELSE
 12631        MOVE 1                   TO PI-NUM-PRINT-COPIES.
 12632
 12633*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12634*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12635*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12636*            VARYING SC-INDX FROM 1 BY 1
 12637*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12638
 12639     MOVE +0                     TO TALLY.
 12640     INSPECT RECORD-TABLE TALLYING TALLY
 12641                                 FOR CHARACTERS BEFORE '@'.
 12642
 12643     IF TALLY < +21900
 12644        COMPUTE PI-CURRENT-LINE = TALLY / 73
 12645        MOVE ZEROS               TO ROLL-COUNTER
 12646        MOVE ER-0191             TO EMI-ERROR
 12647        MOVE -1                  TO MAINTL
 12648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12649        GO TO 7900-ROLL-PAGE.
 12650
 12651 7800-UPDATE-CLAIM.
 12652
 12653     IF PI-RETURN-TO-PROGRAM = PGM-EL126
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 259
* EL152.cbl
 12654         GO TO 7800-GET-PRINTER.
 12655
 12656     MOVE PI-COMPANY-CD          TO  CLAM-CO.
 12657     MOVE PI-CARRIER             TO  CLAM-CARRIER.
 12658     MOVE PI-CLAIM-NO            TO  CLAM-CLAIM.
 12659     MOVE PI-CERT-NO             TO  CLAM-CERT-NUM.
 12660
 12661
 12662* EXEC CICS HANDLE CONDITION
 12663*        NOTOPEN   (8860-CLAM-NOT-OPEN)
 12664*        NOTFND    (7800-CLAIM-NOT-FOUND)
 12665*    END-EXEC.
 12666*    MOVE '"$JI                  ! J #00011387' TO DFHEIV0
 12667     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12669     MOVE X'4A20233030303131333837' TO DFHEIV0(25:11)
 12670     CALL 'kxdfhei1' USING DFHEIV0
 12671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12672
 12673
 12674
 12675* EXEC CICS READ
 12676*        DATASET   (CLAM-ID)
 12677*        RIDFLD    (CLAM-KEY)
 12678*        SET       (ADDRESS OF CLAIM-MASTER)
 12679*        UPDATE
 12680*    END-EXEC.
 12681*    MOVE '&"S        EU         (   #00011392' TO DFHEIV0
 12682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12683     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12684     MOVE X'2020233030303131333932' TO DFHEIV0(25:11)
 12685     CALL 'kxdfhei1' USING DFHEIV0,
 12686           CLAM-ID,
 12687           DFHEIV20,
 12688           DFHEIV99,
 12689           CLAM-KEY,
 12690           DFHEIV99,
 12691           DFHEIV99,
 12692           DFHEIV99
 12693     SET ADDRESS OF CLAIM-MASTER TO
 12694         DFHEIV20
 12695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12696
 12697
 12698     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
 12699     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
 12700     MOVE CURRENT-SAVE           TO  CL-LAST-MAINT-DT.
 12701     MOVE '2'                    TO  CL-LAST-MAINT-TYPE.
 12702
 12703
 12704* EXEC CICS HANDLE CONDITION
 12705*        DUPKEY    (7800-GET-PRINTER)
 12706*    END-EXEC.
 12707*    MOVE '"$$                   ! K #00011404' TO DFHEIV0
 12708     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12710     MOVE X'4B20233030303131343034' TO DFHEIV0(25:11)
 12711     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 260
* EL152.cbl
 12712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12713
 12714
 12715
 12716* EXEC CICS REWRITE
 12717*        DATASET   (CLAM-ID)
 12718*        FROM      (CLAIM-MASTER)
 12719*    END-EXEC.
 12720     MOVE LENGTH OF
 12721      CLAIM-MASTER
 12722       TO DFHEIV11
 12723*    MOVE '&& L                  %   #00011408' TO DFHEIV0
 12724     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12725     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12726     MOVE X'2020233030303131343038' TO DFHEIV0(25:11)
 12727     CALL 'kxdfhei1' USING DFHEIV0,
 12728           CLAM-ID,
 12729           CLAIM-MASTER,
 12730           DFHEIV11,
 12731           DFHEIV99
 12732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12733
 12734
 12735     GO TO 7800-GET-PRINTER.
 12736
 12737 7800-CLAIM-NOT-FOUND.
 12738
 12739     MOVE ER-0133                TO  EMI-ERROR.
 12740     MOVE -1                     TO  MAINTL.
 12741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12742     GO TO 8200-SEND-DATAONLY.
 12743
 12744 7800-GET-PRINTER.
 12745
 12746     IF PI-ALT-PRINTER-ID NOT = SPACES
 12747        GO TO 7800-CNTL-BYPASS.
 12748
 12749     MOVE '1'                    TO CNTL-RECORD-TYPE.
 12750     MOVE SPACES                 TO CNTL-GENL.
 12751     MOVE ZEROS                  TO CNTL-SEQ.
 12752
 12753
 12754* EXEC CICS HANDLE CONDITION
 12755*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 12756*         NOTFND     (7890-NOT-FOUND)
 12757*    END-EXEC.
 12758*    MOVE '"$JI                  ! L #00011431' TO DFHEIV0
 12759     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12761     MOVE X'4C20233030303131343331' TO DFHEIV0(25:11)
 12762     CALL 'kxdfhei1' USING DFHEIV0
 12763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12764
 12765
 12766
 12767* EXEC CICS READ
 12768*         DATASET    (CNTL-ID)
 12769*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 261
* EL152.cbl
 12770*         RIDFLD     (CNTL-KEY)
 12771*    END-EXEC.
 12772*    MOVE '&"S        E          (   #00011436' TO DFHEIV0
 12773     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12775     MOVE X'2020233030303131343336' TO DFHEIV0(25:11)
 12776     CALL 'kxdfhei1' USING DFHEIV0,
 12777           CNTL-ID,
 12778           DFHEIV20,
 12779           DFHEIV99,
 12780           CNTL-KEY,
 12781           DFHEIV99,
 12782           DFHEIV99,
 12783           DFHEIV99
 12784     SET ADDRESS OF CONTROL-FILE TO
 12785         DFHEIV20
 12786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12787
 12788
 12789*    MOVE CF-FORMS-PRINTER-ID       TO TS-TERM-TEXT.
 12790     MOVE CF-FORMS-PRINTER-ID    TO WS-PRINTER-ID
 12791     GO TO 7800-SET-UP-TS.
 12792
 12793 7800-CNTL-BYPASS.
 12794*    MOVE PI-ALT-PRINTER-ID         TO TS-TERM-TEXT.
 12795     MOVE PI-ALT-PRINTER-ID      TO WS-PRINTER-ID.
 12796
 12797 7800-SET-UP-TS.
 12798
 12799***********************************************************
 12800*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 12801*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 12802***********************************************************
 12803
 12804     IF TS-TERM-PREFIX = 'DU'
 12805        PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT
 12806        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
 12807
 12808     SET TS-INDX TO 1.
 12809
 12810
 12811* EXEC CICS ASKTIME
 12812*    END-EXEC.
 12813*    MOVE '0"                    "   #00011463' TO DFHEIV0
 12814     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
 12815     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 12816     MOVE X'2020233030303131343633' TO DFHEIV0(25:11)
 12817     CALL 'kxdfhei1' USING DFHEIV0,
 12818           DFHEIV99
 12819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12820
 12821
 12822     MOVE EIBTIME                TO TS-ID-TIME.
 12823*    MOVE '152A'                 TO TS-ID-TEXT
 12824     MOVE TS-NAME-TEXT           TO PI-TEMP-STOR-ID.
 12825     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12826
 12827     PERFORM 7780-WRITE-TS THRU 7780-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 262
* EL152.cbl
 12828             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12829             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
 12830
 12831     IF NOT PI-SHOW-MODE
 12832        MOVE '1'                 TO PI-PRINT-SW.
 12833
 12834
 12835* EXEC CICS HANDLE CONDITION
 12836*         TERMIDERR  (8820-TERM-ERROR)
 12837*         TRANSIDERR (8830-TRAN-ERROR)
 12838*    END-EXEC.
 12839*    MOVE '"$[\                  ! M #00011478' TO DFHEIV0
 12840     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 12841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12842     MOVE X'4D20233030303131343738' TO DFHEIV0(25:11)
 12843     CALL 'kxdfhei1' USING DFHEIV0
 12844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12845
 12846
 12847*    IF PI-COMPANY-ID = 'DMD' OR 'XXX'
 12848*        MOVE EIBTRMID    TO TS-TERM-TEXT
 12849*        EXEC CICS START
 12850*             INTERVAL    (0)
 12851*             TRANSID     (PRINT-TRANS)
 12852*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12853*             LENGTH      (PI-COMM-LENGTH)
 12854*             TERMID      (TS-TERM-TEXT)
 12855*        END-EXEC
 12856*    ELSE
 12857
 12858* EXEC CICS START
 12859*             INTERVAL    (0)
 12860*             TRANSID     (PRINT-TRANS)
 12861*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12862*             LENGTH      (PI-COMM-LENGTH)
 12863*             TERMID      (TS-TERM-TEXT)
 12864*             TERMID      (WS-PRINTER-ID)
 12865*        END-EXEC.
 12866     MOVE 0 TO DFHEIV10
 12867*    MOVE '0(ILFT                1   #00011493' TO DFHEIV0
 12868     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 12869     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 12870     MOVE X'2020233030303131343933' TO DFHEIV0(25:11)
 12871     CALL 'kxdfhei1' USING DFHEIV0,
 12872           DFHEIV10,
 12873           PRINT-TRANS,
 12874           DFHEIV99,
 12875           PROGRAM-INTERFACE-BLOCK,
 12876           PI-COMM-LENGTH,
 12877           WS-PRINTER-ID,
 12878           DFHEIV99,
 12879           DFHEIV99,
 12880           DFHEIV99,
 12881           DFHEIV99,
 12882           DFHEIV99,
 12883           DFHEIV99,
 12884           DFHEIV99,
 12885           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 263
* EL152.cbl
 12886           DFHEIV99,
 12887           DFHEIV99
 12888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12889
 12890
 12891     MOVE '104A'                 TO TS-ID-TEXT
 12892     MOVE ER-0189                TO EMI-ERROR.
 12893     MOVE -1                     TO MAINTL.
 12894     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 12895     MOVE ' PRINT TRANS STARTED ' TO EMI-MESSAGE-AREA (1)
 12896     MOVE PI-TEMP-STOR-ID TO EMI-MESSAGE-AREA (1) (25:10)
 12897
 12898     GO TO 8200-SEND-DATAONLY.
 12899
 12900 7890-NOT-FOUND.
 12901     MOVE ER-0190                TO EMI-ERROR.
 12902     MOVE -1                     TO MAINTL.
 12903     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12904     GO TO 8200-SEND-DATAONLY.
 12905
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 264
* EL152.cbl
 12907 7900-ROLL-PAGE.
 12908     IF ENTERPFL NOT = ZEROS
 12909        MOVE -1                  TO ENTERPFL
 12910       ELSE
 12911        MOVE -1                  TO MAINTL.
 12912
 12913     PERFORM 7500-READ-TS     THRU 7599-EXIT
 12914     PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12915     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12916        VARYING SC-INDX FROM 1 BY 1 UNTIL
 12917        SC-INDX > NUM-LINES-PER-SCREEN
 12918     IF PI-TOTAL-LINES = 0
 12919        MOVE ER-0047             TO EMI-ERROR
 12920        MOVE -1                  TO MAINTL
 12921        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12922        GO TO 8200-SEND-DATAONLY.
 12923
 12924     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
 12925
 12926     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12927        MOVE ER-0067             TO EMI-ERROR
 12928        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12929        MOVE 1                   TO TEMP-CURR-LINE.
 12930
 12931     IF TEMP-CURR-LINE > PI-TOTAL-LINES
 12932        MOVE ER-0066             TO EMI-ERROR
 12933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12934        COMPUTE TEMP-CURR-LINE
 12935            = PI-TOTAL-LINES + 1 - NUM-LINES-PER-SCREEN
 12936        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12937            MOVE 1 TO TEMP-CURR-LINE.
 12938
 12939*    IF EMI-ERROR NOT = ER-0191
 12940*       PERFORM 7500-READ-TS     THRU 7599-EXIT
 12941*       PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12942*       PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12943*                VARYING SC-INDX FROM 1 BY 1 UNTIL
 12944*                SC-INDX > NUM-LINES-PER-SCREEN
 12945*    END-IF
 12946
 12947     IF EMI-ERROR = ER-0066 OR ER-0067 OR ER-0000 OR ER-0191
 12948        NEXT SENTENCE
 12949     ELSE
 12950        GO TO 8200-SEND-DATAONLY.
 12951
 12952*    PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12953     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
 12954     SET TB-INDX                 TO PI-CURRENT-LINE.
 12955     MOVE LOW-VALUES             TO EL152RI.
 12956
 12957*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12958     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
 12959             VARYING SC-INDX FROM 1 BY 1
 12960             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12961
 12962     GO TO 8200-SEND-DATAONLY.
 12963
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 265
* EL152.cbl
 12965 7950-SET-INDX.
 12966     IF PI-CURRENT-LINE = 0
 12967        SET TB-INDX TO 1
 12968       ELSE
 12969        SET TB-INDX              TO PI-CURRENT-LINE.
 12970
 12971 7950-EXIT.
 12972      EXIT.
 12973
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 266
* EL152.cbl
 12975 7960-UPDATE-TABLE-FROM-SCREEN.
 12976     IF SC-TEXTL (SC-INDX) NOT = ZEROS
 12977        IF TB-INDX > PI-TOTAL-LINES
 12978           IF PI-TOTAL-LINES = MAX-LINES
 12979              MOVE ER-0051       TO EMI-ERROR
 12980              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12981              GO TO 8200-SEND-DATAONLY
 12982           ELSE
 12983              MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX)
 12984              ADD 1              TO PI-TOTAL-LINES
 12985        ELSE
 12986           MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
 12987
 12988     SET TB-INDX UP BY 1.
 12989
 12990 7960-EXIT.
 12991      EXIT.
 12992
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 267
* EL152.cbl
 12994 8000-STARTBR-ERACCT.
 12995
 12996     IF WS-ACCT-READ-SW = 'Y'
 12997         NEXT SENTENCE
 12998     ELSE
 12999
 13000* EXEC CICS GETMAIN
 13001*             SET       (ADDRESS OF ACCOUNT-MASTER)
 13002*             LENGTH    (ACCT-LENGTH)
 13003*        END-EXEC.
 13004*    MOVE '," L                  $   #00011610' TO DFHEIV0
 13005     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 13006     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13007     MOVE X'2020233030303131363130' TO DFHEIV0(25:11)
 13008     CALL 'kxdfhei1' USING DFHEIV0,
 13009           DFHEIV20,
 13010           ACCT-LENGTH,
 13011           DFHEIV99
 13012     SET ADDRESS OF ACCOUNT-MASTER TO
 13013         DFHEIV20
 13014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13015
 13016
 13017
 13018* EXEC CICS STARTBR
 13019*        RIDFLD      (ACCT-KEY)
 13020*        DATASET     (ACCT-ID)
 13021*        KEYLENGTH   (20)
 13022*        GENERIC
 13023*    END-EXEC.
 13024     MOVE 20
 13025       TO DFHEIV11
 13026     MOVE 0
 13027       TO DFHEIV12
 13028*    MOVE '&,   KG    G          &   #00011615' TO DFHEIV0
 13029     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13030     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13031     MOVE X'2020233030303131363135' TO DFHEIV0(25:11)
 13032     CALL 'kxdfhei1' USING DFHEIV0,
 13033           ACCT-ID,
 13034           ACCT-KEY,
 13035           DFHEIV11,
 13036           DFHEIV12,
 13037           DFHEIV99
 13038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13039
 13040
 13041     MOVE 'Y'         TO ACCT-BROWSE-STARTED.
 13042 8000-STARTBR-EXIT.
 13043     EXIT.
 13044
 13045 8000-READNEXT-ERACCT.
 13046
 13047
 13048* EXEC CICS READNEXT
 13049*        DATASET   (ACCT-ID)
 13050*        INTO      (ACCOUNT-MASTER)
 13051*        RIDFLD    (ACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 268
* EL152.cbl
 13052*    END-EXEC.
 13053     MOVE LENGTH OF
 13054      ACCOUNT-MASTER
 13055       TO DFHEIV12
 13056     MOVE 0
 13057       TO DFHEIV11
 13058*    MOVE '&.IL                  )   #00011628' TO DFHEIV0
 13059     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13060     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13061     MOVE X'2020233030303131363238' TO DFHEIV0(25:11)
 13062     CALL 'kxdfhei1' USING DFHEIV0,
 13063           ACCT-ID,
 13064           ACCOUNT-MASTER,
 13065           DFHEIV12,
 13066           ACCT-KEY,
 13067           DFHEIV99,
 13068           DFHEIV11,
 13069           DFHEIV99,
 13070           DFHEIV99
 13071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13072
 13073
 13074 8000-READNEXT-EXIT.
 13075     EXIT.
 13076
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 269
* EL152.cbl
 13078*8050-STARTBR-EMPROD. Remove as dead code
 13079*8050-EXIT. Remove as dead code
 13080*8060-READNEXT-EMPROD. Remove as dead code
 13081*8060-EXIT. Remove as dead code
 13082
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 270
* EL152.cbl
 13084 8100-SEND-INITIAL-MAP.
 13085     PERFORM 7700-PUT-TEMP-STOR  THRU 7749-EXIT
 13086     MOVE SAVE-DATE              TO DATEAO.
 13087     MOVE EIBTIME                TO TIME-IN.
 13088     MOVE TIME-OUT               TO TIMEAO.
 13089
 13090     MOVE PI-CARRIER             TO CARRO
 13091     MOVE PI-CLAIM-NO            TO CLMNOO
 13092     MOVE PI-CERT-NO             TO CRTNOO
 13093     MOVE PI-PROCESSOR-ID        TO PROCO
 13094     MOVE PI-COMPANY-ID          TO COMPIDO
 13095     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 13096                                 TO SYSO
 13097     MOVE PI-ENCLOSURE-CD        TO ENCO
 13098     IF NOT EMI-NO-ERRORS
 13099         SET EMI-INDX TO 1
 13100         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSGO
 13101     ELSE
 13102         MOVE SPACES             TO ERRMSGO.
 13103
 13104     MOVE -1                     TO MAINTL.
 13105
 13106
 13107* EXEC CICS SEND
 13108*        MAP      (MAP-NAME)
 13109*        MAPSET   (MAPSET-NAME)
 13110*        FROM     (EL152AO)
 13111*        ERASE
 13112*        CURSOR
 13113*    END-EXEC.
 13114     MOVE LENGTH OF
 13115      EL152AO
 13116       TO DFHEIV12
 13117     MOVE -1
 13118       TO DFHEIV11
 13119*    MOVE '8$     CT  E    H L F ,   #00011666' TO DFHEIV0
 13120     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 13121     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13122     MOVE X'2020233030303131363636' TO DFHEIV0(25:11)
 13123     CALL 'kxdfhei1' USING DFHEIV0,
 13124           MAP-NAME,
 13125           EL152AO,
 13126           DFHEIV12,
 13127           MAPSET-NAME,
 13128           DFHEIV99,
 13129           DFHEIV99,
 13130           DFHEIV99,
 13131           DFHEIV11,
 13132           DFHEIV99,
 13133           DFHEIV99,
 13134           DFHEIV99
 13135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13136
 13137
 13138     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13139     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13140
 13141     GO TO 9000-RETURN-TRANS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 271
* EL152.cbl
 13142*    GO TO 0200-RECEIVE.
 13143
 13144 8200-SEND-DATAONLY.
 13145     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13146     MOVE PI-ENCLOSURE-CD        TO ENCO
 13147     MOVE SAVE-DATE              TO DATEAO.
 13148     MOVE EIBTIME                TO TIME-IN.
 13149     MOVE TIME-OUT               TO TIMEAO.
 13150     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13151
 13152*    IF PI-COMPANY-ID = 'DMD'
 13153*       IF FORCE-7840
 13154*          MOVE '7840 FORCED' TO PFKEY9O
 13155*          MOVE AL-SABON      TO PFKEY9A.
 13156
 13157
 13158* EXEC CICS SEND
 13159*        MAP      (MAP-NAME)
 13160*        MAPSET   (MAPSET-NAME)
 13161*        FROM     (EL152AO)
 13162*        DATAONLY
 13163*        CURSOR
 13164*    END-EXEC.
 13165     MOVE LENGTH OF
 13166      EL152AO
 13167       TO DFHEIV12
 13168     MOVE -1
 13169       TO DFHEIV11
 13170*    MOVE '8$D    CT       H L F ,   #00011693' TO DFHEIV0
 13171     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 13172     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13173     MOVE X'2020233030303131363933' TO DFHEIV0(25:11)
 13174     CALL 'kxdfhei1' USING DFHEIV0,
 13175           MAP-NAME,
 13176           EL152AO,
 13177           DFHEIV12,
 13178           MAPSET-NAME,
 13179           DFHEIV99,
 13180           DFHEIV99,
 13181           DFHEIV99,
 13182           DFHEIV11,
 13183           DFHEIV99,
 13184           DFHEIV99,
 13185           DFHEIV99
 13186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13187
 13188
 13189     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13190     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13191
 13192     GO TO 9000-RETURN-TRANS.
 13193*    GO TO 0200-RECEIVE.
 13194
 13195 8200-SEND-DATAONLY-ERASEAUP.
 13196     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13197     MOVE PI-ENCLOSURE-CD        TO ENCO
 13198     MOVE SAVE-DATE              TO DATEAO.
 13199     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 272
* EL152.cbl
 13200     MOVE TIME-OUT               TO TIMEAO.
 13201     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13202
 13203* EXEC CICS SEND
 13204*        MAP      (MAP-NAME)
 13205*        MAPSET   (MAPSET-NAME)
 13206*        FROM     (EL152AO)
 13207*        DATAONLY
 13208*        ERASEAUP
 13209*        CURSOR
 13210*    END-EXEC.
 13211     MOVE LENGTH OF
 13212      EL152AO
 13213       TO DFHEIV12
 13214     MOVE -1
 13215       TO DFHEIV11
 13216*    MOVE '8$D    CT  A    H L F ,   #00011714' TO DFHEIV0
 13217     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 13218     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13219     MOVE X'2020233030303131373134' TO DFHEIV0(25:11)
 13220     CALL 'kxdfhei1' USING DFHEIV0,
 13221           MAP-NAME,
 13222           EL152AO,
 13223           DFHEIV12,
 13224           MAPSET-NAME,
 13225           DFHEIV99,
 13226           DFHEIV99,
 13227           DFHEIV99,
 13228           DFHEIV11,
 13229           DFHEIV99,
 13230           DFHEIV99,
 13231           DFHEIV99
 13232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13233
 13234
 13235     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13236     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13237
 13238     GO TO 9000-RETURN-TRANS.
 13239*    GO TO 0200-RECEIVE.
 13240
 13241 8210-ENDBR.
 13242     IF ACCT-BROWSE-STARTED = 'Y'
 13243        MOVE 'N'                  TO ACCT-BROWSE-STARTED
 13244
 13245* EXEC CICS ENDBR
 13246*            DATASET    (ACCT-ID)
 13247*       END-EXEC.
 13248     MOVE 0
 13249       TO DFHEIV11
 13250*    MOVE '&2                    $   #00011732' TO DFHEIV0
 13251     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13252     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13253     MOVE X'2020233030303131373332' TO DFHEIV0(25:11)
 13254     CALL 'kxdfhei1' USING DFHEIV0,
 13255           ACCT-ID,
 13256           DFHEIV11,
 13257           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 273
* EL152.cbl
 13258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13259
 13260
 13261 8210-EXIT.
 13262     EXIT.
 13263
 13264 8220-ENDBR-EMPROD.
 13265     IF PROD-BROWSE-STARTED = 'Y'
 13266        MOVE 'N'                  TO PROD-BROWSE-STARTED
 13267
 13268* EXEC CICS ENDBR
 13269*            DATASET    (PROD-ID)
 13270*       END-EXEC.
 13271     MOVE 0
 13272       TO DFHEIV11
 13273*    MOVE '&2                    $   #00011742' TO DFHEIV0
 13274     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13275     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13276     MOVE X'2020233030303131373432' TO DFHEIV0(25:11)
 13277     CALL 'kxdfhei1' USING DFHEIV0,
 13278           PROD-ID,
 13279           DFHEIV11,
 13280           DFHEIV99
 13281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13282
 13283
 13284 8220-EXIT.
 13285     EXIT.
 13286
 13287 8300-SEND-TEXT.
 13288
 13289* EXEC CICS SEND TEXT
 13290*        FROM    (LOGOFF-TEXT)
 13291*        LENGTH  (LOGOFF-LENGTH)
 13292*        ERASE
 13293*        FREEKB
 13294*    END-EXEC.
 13295*    MOVE '8&      T  E F  H   F -   #00011750' TO DFHEIV0
 13296     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13297     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13298     MOVE X'2020233030303131373530' TO DFHEIV0(25:11)
 13299     CALL 'kxdfhei1' USING DFHEIV0,
 13300           LOGOFF-TEXT,
 13301           LOGOFF-LENGTH,
 13302           DFHEIV99,
 13303           DFHEIV99,
 13304           DFHEIV99,
 13305           DFHEIV99,
 13306           DFHEIV99,
 13307           DFHEIV99,
 13308           DFHEIV99,
 13309           DFHEIV99,
 13310           DFHEIV99,
 13311           DFHEIV99
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13313
 13314
 13315
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 274
* EL152.cbl
 13316* EXEC CICS RETURN
 13317*    END-EXEC.
 13318*    MOVE '.(                    ''   #00011757' TO DFHEIV0
 13319     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13321     MOVE X'2020233030303131373537' TO DFHEIV0(25:11)
 13322     CALL 'kxdfhei1' USING DFHEIV0,
 13323           DFHEIV99,
 13324           DFHEIV99,
 13325           DFHEIV99,
 13326           DFHEIV99,
 13327           DFHEIV99,
 13328           DFHEIV99
 13329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13330
 13331
 13332 8600-DEEDIT.
 13333
 13334* EXEC CICS BIF DEEDIT
 13335*         FIELD    (DEEDIT-FIELD)
 13336*         LENGTH   (15)
 13337*    END-EXEC.
 13338     MOVE 15
 13339       TO DFHEIV11
 13340*    MOVE '@"L                   #   #00011761' TO DFHEIV0
 13341     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13342     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13343     MOVE X'2020233030303131373631' TO DFHEIV0(25:11)
 13344     CALL 'kxdfhei1' USING DFHEIV0,
 13345           DEEDIT-FIELD,
 13346           DFHEIV11
 13347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13348
 13349
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 275
* EL152.cbl
 13351 8800-UNAUTHORIZED-ACCESS.
 13352     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13353     GO TO 8300-SEND-TEXT.
 13354
 13355 8810-PF23.
 13356     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13357     MOVE ZEROS                  TO PI-TOTAL-LINES.
 13358     MOVE ZEROS                  TO PI-CURRENT-LINE.
 13359     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13360     MOVE XCTL-005               TO PGM-NAME.
 13361     GO TO 9300-XCTL.
 13362
 13363 8820-TERM-ERROR.
 13364     MOVE ER-0412                TO EMI-ERROR.
 13365     MOVE SPACES                 TO PI-PRINT-SW.
 13366     GO TO 8999-OPEN-ERROR.
 13367
 13368 8830-TRAN-ERROR.
 13369     MOVE ER-0413                TO EMI-ERROR.
 13370     MOVE SPACES                 TO PI-PRINT-SW.
 13371     GO TO 8999-OPEN-ERROR.
 13372
 13373 8840-CNTL-NOT-OPEN.
 13374     MOVE ER-0042                TO EMI-ERROR.
 13375     GO TO 8999-OPEN-ERROR.
 13376
 13377 8850-ARCH-NOT-OPEN.
 13378     MOVE ER-0332                TO EMI-ERROR.
 13379     GO TO 8999-OPEN-ERROR.
 13380
 13381 8860-CLAM-NOT-OPEN.
 13382     MOVE ER-0154                TO EMI-ERROR.
 13383     GO TO 8999-OPEN-ERROR.
 13384
 13385 8870-ACTV-NOT-OPEN.
 13386     MOVE ER-0172                TO EMI-ERROR.
 13387     GO TO 8999-OPEN-ERROR.
 13388
 13389 8880-ACCT-NOT-OPEN.
 13390     MOVE ER-0168                TO EMI-ERROR.
 13391     GO TO 8999-OPEN-ERROR.
 13392
 13393 8890-TEXT-NOT-OPEN.
 13394     MOVE ER-0013                TO EMI-ERROR.
 13395     GO TO 8999-OPEN-ERROR.
 13396
 13397 8900-CERT-NOT-OPEN.
 13398     MOVE ER-0169                TO EMI-ERROR.
 13399     GO TO 8999-OPEN-ERROR.
 13400
 13401 8910-CERT-NOT-FOUND.
 13402     MOVE ER-0206                TO EMI-ERROR.
 13403     GO TO 8999-OPEN-ERROR.
 13404
 13405 8915-PROD-NOT-OPEN.
 13406     MOVE ER-9106                TO EMI-ERROR.
 13407     GO TO 8999-OPEN-ERROR.
 13408
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 276
* EL152.cbl
 13409 8920-PLCY-NOT-OPEN.
 13410     MOVE ER-9883                TO EMI-ERROR.
 13411     GO TO 8999-OPEN-ERROR.
 13412
 13413 8925-PLAN-NOT-OPEN.
 13414     MOVE ER-9808                TO EMI-ERROR.
 13415     GO TO 8999-OPEN-ERROR.
 13416
 13417 8930-PLCY-NOT-FOUND.
 13418     MOVE ER-9483                TO EMI-ERROR.
 13419     GO TO 8999-OPEN-ERROR.
 13420
 13421 8999-OPEN-ERROR.
 13422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13423     MOVE -1                     TO MAINTL.
 13424     GO TO 8200-SEND-DATAONLY.
 13425
 13426 9000-RETURN-TRANS.
 13427
 13428     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 13429
 13430* EXEC CICS RETURN
 13431*        TRANSID    (TRANS-ID)
 13432*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13433*        LENGTH     (PI-COMM-LENGTH)
 13434*    END-EXEC.
 13435*    MOVE '.(CT                  ''   #00011845' TO DFHEIV0
 13436     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13437     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13438     MOVE X'2020233030303131383435' TO DFHEIV0(25:11)
 13439     CALL 'kxdfhei1' USING DFHEIV0,
 13440           TRANS-ID,
 13441           PROGRAM-INTERFACE-BLOCK,
 13442           PI-COMM-LENGTH,
 13443           DFHEIV99,
 13444           DFHEIV99,
 13445           DFHEIV99
 13446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13447
 13448
 13449
 13450 9000-EXIT.
 13451     EXIT.
 13452 9200-RETURN-MAIN-MENU.
 13453     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13454
 13455     MOVE ZEROS                  TO PI-TOTAL-LINES
 13456                                    PI-CURRENT-LINE.
 13457     MOVE XCTL-126               TO PGM-NAME.
 13458
 13459     GO TO 9300-XCTL.
 13460
 13461 9300-XCTL.
 13462
 13463* EXEC CICS XCTL
 13464*        PROGRAM    (PGM-NAME)
 13465*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13466*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 277
* EL152.cbl
 13467*    END-EXEC.
 13468*    MOVE '.$C                   %   #00011864' TO DFHEIV0
 13469     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13470     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13471     MOVE X'2020233030303131383634' TO DFHEIV0(25:11)
 13472     CALL 'kxdfhei1' USING DFHEIV0,
 13473           PGM-NAME,
 13474           PROGRAM-INTERFACE-BLOCK,
 13475           PI-COMM-LENGTH,
 13476           DFHEIV99
 13477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13478
 13479
 13480 9400-CLEAR.
 13481     IF PI-CLEAR-MODE
 13482         MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
 13483         GO TO 9300-XCTL
 13484     ELSE
 13485         PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
 13486         PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
 13487         PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
 13488         MOVE SPACES             TO PI-WA
 13489                                    RECORD-TABLE
 13490                                    TS-WORK-AREA
 13491         MOVE ZEROS              TO PI-TOTAL-LINES
 13492                                    PI-CURRENT-LINE
 13493                                    PI-TEMP-STOR-ITEMS
 13494                                    PI-UPDATE-SW
 13495                                    PI-ADDR-SEQ
 13496         MOVE '2'                TO PI-ACTION
 13497         MOVE LOW-VALUES         TO EL152AO
 13498                                    PI-ADDR-TYPE
 13499         SET TS-INDX
 13500             TA1
 13501             TA2
 13502             TA21
 13503             TB-INDX
 13504             TB-INDX1
 13505             MOVE-INDX
 13506             SC-INDX             TO +1
 13507         IF GETMAIN-SWITCH = '2'
 13508             MOVE 1              TO GETMAIN-SWITCH
 13509             GO TO 8100-SEND-INITIAL-MAP
 13510         ELSE
 13511             GO TO 8100-SEND-INITIAL-MAP.
 13512
 13513 9600-PGMID-ERROR.
 13514
 13515* EXEC CICS HANDLE CONDITION
 13516*        PGMIDERR    (8300-SEND-TEXT)
 13517*    END-EXEC.
 13518*    MOVE '"$L                   ! N #00011904' TO DFHEIV0
 13519     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13521     MOVE X'4E20233030303131393034' TO DFHEIV0(25:11)
 13522     CALL 'kxdfhei1' USING DFHEIV0
 13523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13524
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 278
* EL152.cbl
 13525
 13526     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 13527     MOVE ' '                    TO PI-ENTRY-CD-1.
 13528     MOVE XCTL-005               TO PGM-NAME.
 13529     MOVE PGM-NAME               TO LOGOFF-PGM.
 13530     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13531     GO TO 9300-XCTL.
 13532
 13533 9700-DATE-LINK.
 13534     MOVE LINK-ELDATCV           TO PGM-NAME.
 13535
 13536* EXEC CICS LINK
 13537*        PROGRAM   (PGM-NAME)
 13538*        COMMAREA  (DATE-CONVERSION-DATA)
 13539*        LENGTH    (DC-COMM-LENGTH)
 13540*    END-EXEC.
 13541*    MOVE '."C                   (   #00011917' TO DFHEIV0
 13542     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13544     MOVE X'2020233030303131393137' TO DFHEIV0(25:11)
 13545     CALL 'kxdfhei1' USING DFHEIV0,
 13546           PGM-NAME,
 13547           DATE-CONVERSION-DATA,
 13548           DC-COMM-LENGTH,
 13549           DFHEIV99,
 13550           DFHEIV99,
 13551           DFHEIV99,
 13552           DFHEIV99
 13553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13554
 13555
 13556*    IF NO-CONVERSION-ERROR
 13557*            AND
 13558*       W-REVERSE-DATE
 13559*            AND
 13560*       PI-COMPANY-ID = 'AUK'
 13561*           MOVE DC-GREG-DATE-1-EDIT TO W-EDIT-DATE-1
 13562*           MOVE W-ED1-MM            TO W-ED2-MM
 13563*           MOVE W-ED1-DD            TO W-ED2-DD
 13564*           MOVE W-ED1-YY            TO W-ED2-YY
 13565*           MOVE W-EDIT-DATE-2       TO DC-GREG-DATE-1-EDIT.
 13566
 13567 9700-EXIT.
 13568      EXIT.
 13569
 13570 9900-ERROR-FORMAT.
 13571     IF NOT EMI-ERRORS-COMPLETE
 13572         MOVE LINK-001           TO PGM-NAME
 13573
 13574* EXEC CICS LINK
 13575*            PROGRAM   (PGM-NAME)
 13576*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 13577*            LENGTH    (EMI-COMM-LENGTH)
 13578*        END-EXEC.
 13579*    MOVE '."C                   (   #00011940' TO DFHEIV0
 13580     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13582     MOVE X'2020233030303131393430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 279
* EL152.cbl
 13583     CALL 'kxdfhei1' USING DFHEIV0,
 13584           PGM-NAME,
 13585           ERROR-MESSAGE-INTERFACE-BLOCK,
 13586           EMI-COMM-LENGTH,
 13587           DFHEIV99,
 13588           DFHEIV99,
 13589           DFHEIV99,
 13590           DFHEIV99
 13591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13592
 13593
 13594 9900-EXIT.
 13595     EXIT.
 13596
 13597 9990-ABEND.
 13598     MOVE LINK-004               TO PGM-NAME.
 13599     MOVE DFHEIBLK               TO EMI-LINE1.
 13600
 13601* EXEC CICS LINK
 13602*        PROGRAM   (PGM-NAME)
 13603*        COMMAREA  (EMI-LINE1)
 13604*        LENGTH    (72)
 13605*    END-EXEC.
 13606     MOVE 72
 13607       TO DFHEIV11
 13608*    MOVE '."C                   (   #00011952' TO DFHEIV0
 13609     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13611     MOVE X'2020233030303131393532' TO DFHEIV0(25:11)
 13612     CALL 'kxdfhei1' USING DFHEIV0,
 13613           PGM-NAME,
 13614           EMI-LINE1,
 13615           DFHEIV11,
 13616           DFHEIV99,
 13617           DFHEIV99,
 13618           DFHEIV99,
 13619           DFHEIV99
 13620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13621
 13622
 13623     GO TO 8200-SEND-DATAONLY.
 13624
 13625 9995-SECURITY-VIOLATION.
 13626*                            COPY ELCSCTP.
 13627******************************************************************
 13628*                                                                *
 13629*                            ELCSCTP                             *
 13630*                            VMOD=2.001                          *
 13631*                                                                *
 13632*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13633******************************************************************
 13634
 13635
 13636     MOVE EIBDATE          TO SM-JUL-DATE.
 13637     MOVE EIBTRMID         TO SM-TERMID.
 13638     MOVE THIS-PGM         TO SM-PGM.
 13639     MOVE EIBTIME          TO TIME-IN.
 13640     MOVE TIME-OUT         TO SM-TIME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 280
* EL152.cbl
 13641     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13642
 13643
 13644* EXEC CICS LINK
 13645*         PROGRAM  ('EL003')
 13646*         COMMAREA (SECURITY-MESSAGE)
 13647*         LENGTH   (80)
 13648*    END-EXEC.
 13649     MOVE 'EL003' TO DFHEIV1
 13650     MOVE 80
 13651       TO DFHEIV11
 13652*    MOVE '."C                   (   #00011978' TO DFHEIV0
 13653     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13655     MOVE X'2020233030303131393738' TO DFHEIV0(25:11)
 13656     CALL 'kxdfhei1' USING DFHEIV0,
 13657           DFHEIV1,
 13658           SECURITY-MESSAGE,
 13659           DFHEIV11,
 13660           DFHEIV99,
 13661           DFHEIV99,
 13662           DFHEIV99,
 13663           DFHEIV99
 13664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13665
 13666
 13667******************************************************************
 13668
 13669
 13670
 13671 9999-DFHBACK SECTION.
 13672     MOVE '9%                    "   ' TO DFHEIV0
 13673     MOVE 'EL152' TO DFHEIV1
 13674     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13675     GOBACK.
 13676 9999-DFHEXIT.
 13677     IF DFHEIGDJ EQUAL 0001
 13678         NEXT SENTENCE
 13679     ELSE IF DFHEIGDJ EQUAL 2
 13680         GO TO 9600-PGMID-ERROR,
 13681               0325-MAPFAIL,
 13682               9990-ABEND
 13683         DEPENDING ON DFHEIGDI
 13684     ELSE IF DFHEIGDJ EQUAL 3
 13685         GO TO 9400-CLEAR,
 13686               0100-PA,
 13687               0100-PA,
 13688               0100-PA
 13689         DEPENDING ON DFHEIGDI
 13690     ELSE IF DFHEIGDJ EQUAL 4
 13691         GO TO 0325-MAPFAIL
 13692         DEPENDING ON DFHEIGDI
 13693     ELSE IF DFHEIGDJ EQUAL 5
 13694         GO TO 590-QIDERR
 13695         DEPENDING ON DFHEIGDI
 13696     ELSE IF DFHEIGDJ EQUAL 6
 13697         GO TO 8850-ARCH-NOT-OPEN,
 13698               1020-ENDBR,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 281
* EL152.cbl
 13699               1020-ENDBR
 13700         DEPENDING ON DFHEIGDI
 13701     ELSE IF DFHEIGDJ EQUAL 7
 13702         GO TO 2120-ENDBR,
 13703               2120-ENDBR,
 13704               8890-TEXT-NOT-OPEN
 13705         DEPENDING ON DFHEIGDI
 13706     ELSE IF DFHEIGDJ EQUAL 8
 13707         GO TO 8860-CLAM-NOT-OPEN,
 13708               3010-NOT-FOUND
 13709         DEPENDING ON DFHEIGDI
 13710     ELSE IF DFHEIGDJ EQUAL 9
 13711         GO TO 9990-ABEND
 13712         DEPENDING ON DFHEIGDI
 13713     ELSE IF DFHEIGDJ EQUAL 10
 13714         GO TO 6499-EXIT
 13715         DEPENDING ON DFHEIGDI
 13716     ELSE IF DFHEIGDJ EQUAL 11
 13717         GO TO 6599-EXIT
 13718         DEPENDING ON DFHEIGDI
 13719     ELSE IF DFHEIGDJ EQUAL 12
 13720         GO TO 8860-CLAM-NOT-OPEN,
 13721               7090-CLAIM-NOT-FOUND
 13722         DEPENDING ON DFHEIGDI
 13723     ELSE IF DFHEIGDJ EQUAL 13
 13724         GO TO 8880-ACCT-NOT-OPEN,
 13725               7080-ACCT-NOT-FOUND
 13726         DEPENDING ON DFHEIGDI
 13727     ELSE IF DFHEIGDJ EQUAL 14
 13728         GO TO 7070-ACTV-NOT-FOUND
 13729         DEPENDING ON DFHEIGDI
 13730     ELSE IF DFHEIGDJ EQUAL 15
 13731         GO TO 7070-ACTV-NOT-FOUND
 13732         DEPENDING ON DFHEIGDI
 13733     ELSE IF DFHEIGDJ EQUAL 16
 13734         GO TO 8870-ACTV-NOT-OPEN,
 13735               7070-ACTV-NOT-FOUND
 13736         DEPENDING ON DFHEIGDI
 13737     ELSE IF DFHEIGDJ EQUAL 17
 13738         GO TO 7075-CONTINUE-ACTV-ERROR
 13739         DEPENDING ON DFHEIGDI
 13740     ELSE IF DFHEIGDJ EQUAL 18
 13741         GO TO 8900-CERT-NOT-OPEN,
 13742               8910-CERT-NOT-FOUND
 13743         DEPENDING ON DFHEIGDI
 13744     ELSE IF DFHEIGDJ EQUAL 19
 13745         GO TO 8870-ACTV-NOT-OPEN,
 13746               7200-READ-LOAN-NUMBER
 13747         DEPENDING ON DFHEIGDI
 13748     ELSE IF DFHEIGDJ EQUAL 20
 13749         GO TO 8870-ACTV-NOT-OPEN,
 13750               7201-READ-BENEFICIARY
 13751         DEPENDING ON DFHEIGDI
 13752     ELSE IF DFHEIGDJ EQUAL 21
 13753         GO TO 7290-BENE-NOT-OPEN,
 13754               7205-READ-PHYSICIAN-ADDR
 13755         DEPENDING ON DFHEIGDI
 13756     ELSE IF DFHEIGDJ EQUAL 22
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 282
* EL152.cbl
 13757         GO TO 8870-ACTV-NOT-OPEN,
 13758               7210-READ-EMPLOYER-ADDR
 13759         DEPENDING ON DFHEIGDI
 13760     ELSE IF DFHEIGDJ EQUAL 23
 13761         GO TO 8870-ACTV-NOT-OPEN,
 13762               7220-READ-INSURED-ADDR
 13763         DEPENDING ON DFHEIGDI
 13764     ELSE IF DFHEIGDJ EQUAL 24
 13765         GO TO 8870-ACTV-NOT-OPEN,
 13766               7225-READ-OTHER1-ADDR
 13767         DEPENDING ON DFHEIGDI
 13768     ELSE IF DFHEIGDJ EQUAL 25
 13769         GO TO 8870-ACTV-NOT-OPEN,
 13770               7230-READ-OTHER2-ADDR
 13771         DEPENDING ON DFHEIGDI
 13772     ELSE IF DFHEIGDJ EQUAL 26
 13773         GO TO 8870-ACTV-NOT-OPEN,
 13774               7240-NOT-FOUND
 13775         DEPENDING ON DFHEIGDI
 13776     ELSE IF DFHEIGDJ EQUAL 27
 13777         GO TO 8870-ACTV-NOT-OPEN,
 13778               7250-READ-ACCOUNT
 13779         DEPENDING ON DFHEIGDI
 13780     ELSE IF DFHEIGDJ EQUAL 28
 13781         GO TO 8880-ACCT-NOT-OPEN,
 13782               7251-READ-3RD-PARTY
 13783         DEPENDING ON DFHEIGDI
 13784     ELSE IF DFHEIGDJ EQUAL 29
 13785         GO TO 8870-ACTV-NOT-OPEN,
 13786               7252-READ-COMP
 13787         DEPENDING ON DFHEIGDI
 13788     ELSE IF DFHEIGDJ EQUAL 30
 13789         GO TO 7260-READ-DENIAL
 13790         DEPENDING ON DFHEIGDI
 13791     ELSE IF DFHEIGDJ EQUAL 31
 13792         GO TO 8870-ACTV-NOT-OPEN,
 13793               7265-READ-CNTL1,
 13794               7265-READ-CNTL1
 13795         DEPENDING ON DFHEIGDI
 13796     ELSE IF DFHEIGDJ EQUAL 32
 13797         GO TO 8840-CNTL-NOT-OPEN,
 13798               7266-READ-CNTL2
 13799         DEPENDING ON DFHEIGDI
 13800     ELSE IF DFHEIGDJ EQUAL 33
 13801         GO TO 8840-CNTL-NOT-OPEN,
 13802               7267-READ-CNTL4
 13803         DEPENDING ON DFHEIGDI
 13804     ELSE IF DFHEIGDJ EQUAL 34
 13805         GO TO 8840-CNTL-NOT-OPEN,
 13806               7267-READ-CNTL6
 13807         DEPENDING ON DFHEIGDI
 13808     ELSE IF DFHEIGDJ EQUAL 35
 13809         GO TO 8840-CNTL-NOT-OPEN,
 13810               7268-SET-DATE
 13811         DEPENDING ON DFHEIGDI
 13812     ELSE IF DFHEIGDJ EQUAL 36
 13813         GO TO 7290-BENE-NOT-OPEN,
 13814               7290-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 283
* EL152.cbl
 13815         DEPENDING ON DFHEIGDI
 13816     ELSE IF DFHEIGDJ EQUAL 37
 13817         GO TO 7590-TS-QIDERR,
 13818               7585-TS-ITEMERR
 13819         DEPENDING ON DFHEIGDI
 13820     ELSE IF DFHEIGDJ EQUAL 38
 13821         GO TO 7690-TS-QIDERR,
 13822               7685-TS-ITEMERR
 13823         DEPENDING ON DFHEIGDI
 13824     ELSE IF DFHEIGDJ EQUAL 39
 13825         GO TO 7750-EXIT
 13826         DEPENDING ON DFHEIGDI
 13827     ELSE IF DFHEIGDJ EQUAL 40
 13828         GO TO 7760-EXIT
 13829         DEPENDING ON DFHEIGDI
 13830     ELSE IF DFHEIGDJ EQUAL 41
 13831         GO TO 7770-EXIT
 13832         DEPENDING ON DFHEIGDI
 13833     ELSE IF DFHEIGDJ EQUAL 42
 13834         GO TO 8860-CLAM-NOT-OPEN,
 13835               7800-CLAIM-NOT-FOUND
 13836         DEPENDING ON DFHEIGDI
 13837     ELSE IF DFHEIGDJ EQUAL 43
 13838         GO TO 7800-GET-PRINTER
 13839         DEPENDING ON DFHEIGDI
 13840     ELSE IF DFHEIGDJ EQUAL 44
 13841         GO TO 8840-CNTL-NOT-OPEN,
 13842               7890-NOT-FOUND
 13843         DEPENDING ON DFHEIGDI
 13844     ELSE IF DFHEIGDJ EQUAL 45
 13845         GO TO 8820-TERM-ERROR,
 13846               8830-TRAN-ERROR
 13847         DEPENDING ON DFHEIGDI
 13848     ELSE IF DFHEIGDJ EQUAL 46
 13849         GO TO 8300-SEND-TEXT
 13850         DEPENDING ON DFHEIGDI.
 13851     MOVE '9%                    "   ' TO DFHEIV0
 13852     MOVE 'EL152' TO DFHEIV1
 13853     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13854     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       47192     Code:       43931
