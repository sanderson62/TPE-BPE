* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49******************************************************************
    50 environment division.
    51 data division.
    52 working-storage section.
    53 01  DFH-START PIC X(04).
    54*
    55* program buffers
    56*
    57 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    58     88  ALREADY-SENT              VALUE 'Y'.
    59 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    60 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    61     88  ELCERT-FINISHED            VALUE 'Y'.
    62 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    63 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    64     88  ERACCT-FOUND               VALUE 'Y'.
    65 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    66 77 ws-send-msg-size           pic s9(8) comp value 4096.
    67 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    68 77 ws-recv-buf                pic x(4096).
    69 77 ws-send-buf                pic x(4096) VALUE SPACES.
    70 77 ws-recv-total              pic s9(8) comp value 0.
    71 77 ws-recv-left               pic s9(8) comp value 0.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   3
* SOCK03.cbl
    72 77 ws-seq-num                 pic s9(8) comp value 0.
    73 77 ws-flags                   pic s9(8) comp value 0.
    74 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    75 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    76 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    77 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    78 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    79 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    80 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    81 77  ws-cancel-reason            pic x   value spaces.
    82 77  P1                          PIC S999 COMP-3 VALUE +0.
    83 77  P2                          PIC S999 COMP-3 VALUE +0.
    84 77  C0                          PIC S999 COMP-3 VALUE +0.
    85 77  C1                          PIC S999 COMP-3 VALUE +0.
    86 77  C2                          PIC S999 COMP-3 VALUE +0.
    87 77  C3                          PIC S999 COMP-3 VALUE +0.
    88 77 S1                           PIC S999 COMP-3 VALUE +0.
    89 77 S2                           PIC S999 COMP-3 VALUE +0.
    90 77 L1                           PIC S999 COMP-3 VALUE +0.
    91 77 L2                           PIC S999 COMP-3 VALUE +0.
    92 77 F1                           PIC S999 COMP-3 VALUE +0.
    93 77 WS-BUILD-SW                  PIC X.
    94    88  TIME-TO-BUILD               VALUE 'Y'.
    95 77 WS-SAVE-ERACCT               PIC X(2000).
    96 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    97 77 WS-STOP-SW                   PIC X  VALUE ' '.
    98    88  TOLD-TO-STOP               VALUE 'Y'.
    99 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   100    88  GET-RATES                    VALUE 'R'.
   101    88  GET-ACT-ACCTS                VALUE 'A'.
   102 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   103 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   104 77 ws-disp-rate                 pic z9.99999.
   105 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   106     88  END-OF-ERCTBL                 VALUE 'Y'.
   107 77  WS-STATUS                   PIC X.
   108 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   109 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   110 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   111 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   112 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   113 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   114 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   115 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   116 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   117 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   118 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   119 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   120     88  WS-ELCERT-FULL             VALUE '1'.
   121     88  WS-ELCERT-NAME             VALUE '2'.
   122     88  WS-ELCERT-CERT-NO          VALUE '3'.
   123     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   124 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   125 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   126     88  I-SAY-TO-STOP      VALUE 'Y'.
   127 77  WS-HEX-0A                   PIC X.
   128 77  WS-CALL-TYPE                PIC X(6).
   129 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   4
* SOCK03.cbl
   130 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   131 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   132 77  DD-IU-SW                    PIC X   VALUE ' '.
   133     88  DD-IU-PRESENT                 VALUE 'Y'.
   134 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   135 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   136 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   137 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   138 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   139 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   140 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   141 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   142 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   143     88  PDEF-FOUND                              VALUE 'Y'.
   144 77  ws-epiq-sw                  pic x  value ' '.
   145     88  ws-epiq-request           value 'Y'.
   146 77  ws-epiq-max                 pic s999 value +0 comp-3.
   147 01  WS-STRING-DATA.
   148     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   149     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   150     05  WS-CARRIER              PIC X        VALUE SPACES.
   151     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   152     05  WS-STATE                PIC XX       VALUE SPACES.
   153     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   154     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   155     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   156     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   157     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   158     05  WS-MID-INIT             PIC X        VALUE SPACES.
   159     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   160     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   161     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   162     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   163     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   164     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   165     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   166     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   167     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   168     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   169     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   170     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   171     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   172     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   173     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   174     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   175     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   176     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   177     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   178     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   179     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   180     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   181     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   182     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   183     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   184     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   185     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   186     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   187     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   5
* SOCK03.cbl
   188     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   189     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   190     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   191     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   192     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   193     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   194     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   195     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   196     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   197     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   198 01  ws-work-date.
   199     05  ws-work-ccyy            pic x(4).
   200     05  ws-work-mm              pic xx.
   201     05  ws-work-dd              pic xx.
   202 01  ws-work-date-num redefines ws-work-date
   203                                 pic 9(8).
   204 01  FILLER.
   205     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   206     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   207     12  WS-STATE-ABBREVIATION   PIC XX.
   208     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   209     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   210     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   211     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   212     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   213     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   214     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   215     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   216     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   217     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   218     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   219     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   220     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   221     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   222     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   223     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   224     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   225     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   226     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   227     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   228     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   229     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   230     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   231     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   232     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   233     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   234         88  WS-REDUCING                         VALUE 'R'.
   235         88  WS-LEVEL                            VALUE 'L'  'P'.
   236 01  ELMSTR-KEY.
   237     12  ELMSTR-COMP-CD          PIC X.
   238     12  ELMSTR-CERT-NO          PIC X(11).
   239 01  CTBL-KEY-SAVE               PIC X(5).
   240 01  CTBL-KEY.
   241     05  CTBL-COMPANY-CD         PIC X.
   242     05  CTBL-TABLE              PIC XXX.
   243     05  CTBL-BEN-TYPE           PIC X.
   244     05  CTBL-BEN-CODE           PIC XX.
   245 01  ERPDEF-KEY-SAVE             PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   6
* SOCK03.cbl
   246 01  ERPDEF-KEY.
   247     12  ERPDEF-COMPANY-CD       PIC X.
   248     12  ERPDEF-STATE            PIC XX.
   249     12  ERPDEF-PROD-CD          PIC XXX.
   250     12  F                       PIC X(7).
   251     12  ERPDEF-BEN-TYPE         PIC X.
   252     12  ERPDEF-BEN-CODE         PIC XX.
   253     12  ERPDEF-EXP-DT           PIC XX.
   254 01  WS-AM3-KEY.
   255     12  WS-AM3-ACCOUNT          PIC X(10).
   256     12  WS-AM3-EXP-DT           PIC XX.
   257 01  WS-AM-KEY.
   258     12  WS-AM-COMPANY-CD        PIC X.
   259     12  WS-AM-CARRIER           PIC X.
   260     12  WS-AM-GROUPING          PIC X(6).
   261     12  WS-AM-STATE             PIC XX.
   262     12  WS-AM-ACCOUNT           PIC X(10).
   263     12  WS-AM-EXPIRATION-DT     PIC XX.
   264     12  WS-AM-FILLER            PIC XXXX.
   265 01  WS-CO-DATA.
   266     05  WS-CO-NUM               PIC X(10).
   267     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   268     05  WS-CO-NAME              PIC X(30).
   269     05  WS-CO-MAIL-NAME         PIC X(30).
   270     05  WS-CO-ADDR1             PIC X(30).
   271     05  WS-CO-ADDR2             PIC X(30).
   272     05  WS-CO-ADDR3             PIC X(30).
   273     05  WS-CO-ZIP               PIC X(9).
   274     05  WS-CO-PHONE             PIC X(10).
   275 01  WS-CF-KEY.
   276     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   277     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   278*        88  COMPANY-MASTER                      VALUE '1'.
   279*        88  STATE-MASTER                        VALUE '3'.
   280*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   281*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   282     12  WS-CF-ACCESS.
   283         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   284         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   285             20  FILLER          PIC  X(01).
   286             20  WS-CF-CARRIER   PIC  X(01).
   287     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   288 01  WS-CM-KEY.
   289     05  WS-CM-COMPANY-CD        PIC X.
   290     05  WS-CM-CARRIER           PIC X.
   291     05  WS-CM-GROUP             PIC X(6).
   292     05  WS-CM-STATE             PIC XX.
   293     05  WS-CM-ACCOUNT           PIC X(10).
   294     05  WS-CM-EFF-DT            PIC XX.
   295     05  WS-CM-CERT-NO           PIC X(11).
   296 01  WS-CM-KEY-A1.
   297     05  WS-CM-COMPANY-CD-A1     PIC X.
   298     05  WS-CM-LAST-NAME         PIC X(15).
   299     05  WS-CM-INITIALS          PIC XX.
   300 01  WS-CM-KEY-A4.
   301     05  WS-CM-COMPANY-CD-A4     PIC X.
   302     05  WS-CM-CERT-NO-A4        PIC X(11).
   303 01  WS-CID-NO                   PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   7
* SOCK03.cbl
   304 01  WS-DISP-RESP                PIC 9(5).
   305 01  WS-RESPONSE                 PIC S9(8)   COMP.
   306     88  RESP-NORMAL                  VALUE +00.
   307     88  RESP-NOTFND                  VALUE +13.
   308     88  RESP-DUPKEY                  VALUE +15.
   309     88  RESP-NOTOPEN                 VALUE +19.
   310     88  RESP-ENDFILE                 VALUE +20.
   311*                                 COPY ELCCERT.
   312******************************************************************
   313*                                                                *
   314*                            ELCCERT.                            *
   315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   316*                            VMOD=2.013                          *
   317*                                                                *
   318*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   319*                                                                *
   320*   FILE TYPE = VSAM,KSDS                                        *
   321*   RECORD SIZE = 450  RECFORM = FIXED                           *
   322*                                                                *
   323*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   324*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   325*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   326*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   327*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   328*                                                                *
   329*   LOG = YES                                                    *
   330*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   331******************************************************************
   332*                   C H A N G E   L O G
   333*
   334* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   335*-----------------------------------------------------------------
   336*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   337* EFFECTIVE    NUMBER
   338*-----------------------------------------------------------------
   339* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   340* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   341* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   342* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   343* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   344* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   345* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   346* 032612  CR2011110200001  PEMA  AHL CHANGES
   347* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   348******************************************************************
   349
   350 01  CERTIFICATE-MASTER.
   351     12  CM-RECORD-ID                      PIC XX.
   352         88  VALID-CM-ID                      VALUE 'CM'.
   353
   354     12  CM-CONTROL-PRIMARY.
   355         16  CM-COMPANY-CD                 PIC X.
   356         16  CM-CARRIER                    PIC X.
   357         16  CM-GROUPING.
   358             20  CM-GROUPING-PREFIX        PIC X(3).
   359             20  CM-GROUPING-PRIME         PIC X(3).
   360         16  CM-STATE                      PIC XX.
   361         16  CM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   8
* SOCK03.cbl
   362             20  CM-ACCOUNT-PREFIX         PIC X(4).
   363             20  CM-ACCOUNT-PRIME          PIC X(6).
   364         16  CM-CERT-EFF-DT                PIC XX.
   365         16  CM-CERT-NO.
   366             20  CM-CERT-PRIME             PIC X(10).
   367             20  CM-CERT-SFX               PIC X.
   368
   369     12  CM-CONTROL-BY-NAME.
   370         16  CM-COMPANY-CD-A1              PIC X.
   371         16  CM-INSURED-LAST-NAME          PIC X(15).
   372         16  CM-INSURED-INITIALS.
   373             20  CM-INSURED-INITIAL1       PIC X.
   374             20  CM-INSURED-INITIAL2       PIC X.
   375
   376     12  CM-CONTROL-BY-SSN.
   377         16  CM-COMPANY-CD-A2              PIC X.
   378         16  CM-SOC-SEC-NO.
   379             20  CM-SSN-STATE              PIC XX.
   380             20  CM-SSN-ACCOUNT            PIC X(6).
   381             20  CM-SSN-LN3.
   382                 25  CM-INSURED-INITIALS-A2.
   383                     30 CM-INSURED-INITIAL1-A2   PIC X.
   384                     30 CM-INSURED-INITIAL2-A2   PIC X.
   385                 25 CM-PART-LAST-NAME-A2         PIC X.
   386
   387     12  CM-CONTROL-BY-CERT-NO.
   388         16  CM-COMPANY-CD-A4              PIC X.
   389         16  CM-CERT-NO-A4                 PIC X(11).
   390
   391     12  CM-CONTROL-BY-MEMB.
   392         16  CM-COMPANY-CD-A5              PIC X.
   393         16  CM-MEMBER-NO.
   394             20  CM-MEMB-STATE             PIC XX.
   395             20  CM-MEMB-ACCOUNT           PIC X(6).
   396             20  CM-MEMB-LN4.
   397                 25  CM-INSURED-INITIALS-A5.
   398                     30 CM-INSURED-INITIAL1-A5   PIC X.
   399                     30 CM-INSURED-INITIAL2-A5   PIC X.
   400                 25 CM-PART-LAST-NAME-A5         PIC XX.
   401
   402     12  CM-INSURED-PROFILE-DATA.
   403         16  CM-INSURED-FIRST-NAME.
   404             20  CM-INSURED-1ST-INIT       PIC X.
   405             20  FILLER                    PIC X(9).
   406         16  CM-INSURED-ISSUE-AGE          PIC 99.
   407         16  CM-INSURED-SEX                PIC X.
   408             88  CM-SEX-MALE                  VALUE 'M'.
   409             88  CM-SEX-FEMAL                 VALUE 'F'.
   410         16  CM-INSURED-JOINT-AGE          PIC 99.
   411         16  CM-JOINT-INSURED-NAME.
   412             20  CM-JT-LAST-NAME           PIC X(15).
   413             20  CM-JT-FIRST-NAME.
   414                 24  CM-JT-1ST-INIT        PIC X.
   415                 24  FILLER                PIC X(9).
   416             20  CM-JT-INITIAL             PIC X.
   417
   418     12  CM-LIFE-DATA.
   419         16  CM-LF-BENEFIT-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page   9
* SOCK03.cbl
   420         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   421         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   422         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   423         16  CM-LF-DEV-CODE                PIC XXX.
   424         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   425         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   426         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   427         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   428         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   429         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   430         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   431         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   432         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   433         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   434         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   435         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   436         16  cm-temp-epiq                  pic xx.
   437             88  EPIQ-CLASS                  value 'EQ'.
   438*        16  FILLER                        PIC XX.
   439
   440     12  CM-AH-DATA.
   441         16  CM-AH-BENEFIT-CD              PIC XX.
   442         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   443         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   444         16  CM-AH-DEV-CODE                PIC XXX.
   445         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   446         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   447         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   448         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   449         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   450         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   451         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   452         16  CM-AH-PAID-THRU-DT            PIC XX.
   453             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   454         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   455         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   456         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   457         16  FILLER                        PIC X.
   458
   459     12  CM-LOAN-INFORMATION.
   460         16  CM-LIVES                      PIC S9(7)     COMP-3.
   461         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   462                                           PIC S9(5)V99  COMP-3.
   463         16  CM-BILLED                     PIC S9(7)     COMP-3.
   464         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   465         16  CM-PAY-FREQUENCY              PIC S99.
   466         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   467         16  CM-RATE-CLASS                 PIC XX.
   468         16  CM-BENEFICIARY                PIC X(25).
   469         16  CM-POLICY-FORM-NO             PIC X(12).
   470         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   471         16  CM-LAST-ADD-ON-DT             PIC XX.
   472         16  CM-DEDUCTIBLE-AMOUNTS.
   473             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   474             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   475         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   476             20  CM-RESIDENT-STATE         PIC XX.
   477             20  CM-RATE-CODE              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  10
* SOCK03.cbl
   478             20  FILLER                    PIC XX.
   479         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   480             20  CM-LOAN-OFFICER           PIC X(5).
   481             20  FILLER                    PIC XXX.
   482         16  CM-CSR-CODE                   PIC XXX.
   483         16  CM-UNDERWRITING-CODE          PIC X.
   484             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   485         16  CM-POST-CARD-IND              PIC X.
   486         16  CM-NH-INTERFACE-SW            PIC X.
   487         16  CM-PREMIUM-TYPE               PIC X.
   488             88  CM-SING-PRM                  VALUE '1'.
   489             88  CM-O-B-COVERAGE              VALUE '2'.
   490             88  CM-OPEN-END                  VALUE '3'.
   491         16  CM-IND-GRP-TYPE               PIC X.
   492             88  CM-INDIVIDUAL                VALUE 'I'.
   493             88  CM-GROUP                     VALUE 'G'.
   494         16  CM-SKIP-CODE                  PIC X.
   495             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   496             88  SKIP-JULY                    VALUE '1'.
   497             88  SKIP-AUGUST                  VALUE '2'.
   498             88  SKIP-SEPTEMBER               VALUE '3'.
   499             88  SKIP-JULY-AUG                VALUE '4'.
   500             88  SKIP-AUG-SEPT                VALUE '5'.
   501             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   502             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   503             88  SKIP-JUNE                    VALUE '8'.
   504             88  SKIP-JUNE-JULY               VALUE '9'.
   505             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   506             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   507         16  CM-PAYMENT-MODE               PIC X.
   508             88  PAY-MONTHLY                  VALUE SPACE.
   509             88  PAY-WEEKLY                   VALUE '1'.
   510             88  PAY-SEMI-MONTHLY             VALUE '2'.
   511             88  PAY-BI-WEEKLY                VALUE '3'.
   512             88  PAY-SEMI-ANUALLY             VALUE '4'.
   513         16  CM-LOAN-NUMBER                PIC X(8).
   514         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   515         16  CM-OLD-LOF                    PIC XXX.
   516*        16  CM-LOAN-OFFICER               PIC XXX.
   517         16  CM-REIN-TABLE                 PIC XXX.
   518         16  CM-SPECIAL-REIN-CODE          PIC X.
   519         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   520         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   521         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   522
   523     12  CM-STATUS-DATA.
   524         16  CM-ENTRY-STATUS               PIC X.
   525         16  CM-ENTRY-DT                   PIC XX.
   526
   527         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   528         16  CM-LF-CANCEL-DT               PIC XX.
   529         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   530
   531         16  CM-LF-STATUS-AT-DEATH         PIC X.
   532         16  CM-LF-DEATH-DT                PIC XX.
   533         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   534
   535         16  CM-LF-CURRENT-STATUS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  11
* SOCK03.cbl
   536             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   537                                                'M' '4' '5' '9'.
   538             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   539             88  CM-LF-POLICY-PENDING         VALUE '2'.
   540             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   541             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   542             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   543             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   544             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   545             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   546             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   547             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   548             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   549             88  CM-LF-DECLINED               VALUE 'D'.
   550             88  CM-LF-VOIDED                 VALUE 'V'.
   551
   552         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   553         16  CM-AH-CANCEL-DT               PIC XX.
   554         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   555
   556         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   557         16  CM-AH-SETTLEMENT-DT           PIC XX.
   558         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   559
   560         16  CM-AH-CURRENT-STATUS          PIC X.
   561             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   562                                                'M' '4' '5' '9'.
   563             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   564             88  CM-AH-POLICY-PENDING         VALUE '2'.
   565             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   566             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   567             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   568             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   569             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   570             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   571             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   572             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   573             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   574             88  CM-AH-DECLINED               VALUE 'D'.
   575             88  CM-AH-VOIDED                 VALUE 'V'.
   576
   577         16  CM-CLAIM-INTERFACE-SW         PIC X.
   578             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   579             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   580             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   581         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   582
   583         16  CM-ENTRY-BATCH                PIC X(6).
   584         16  CM-LF-EXIT-BATCH              PIC X(6).
   585         16  CM-AH-EXIT-BATCH              PIC X(6).
   586         16  CM-LAST-MONTH-END             PIC XX.
   587
   588     12  CM-NOTE-SW                        PIC X.
   589         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   590         88  CERT-NOTES-PRESENT               VALUE '1'.
   591         88  BILLING-NOTES-PRESENT            VALUE '2'.
   592         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   593         88  CLAIM-NOTES-PRESENT              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  12
* SOCK03.cbl
   594         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   595         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   596         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   597     12  CM-COMP-EXCP-SW                   PIC X.
   598         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   599         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   600     12  CM-INSURED-ADDRESS-SW             PIC X.
   601         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   602         88  INSURED-ADDR-PRESENT             VALUE '1'.
   603
   604*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   605     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   606     12  FILLER                            PIC X.
   607
   608*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   609     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   610     12  FILLER                            PIC X.
   611*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   612     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   613
   614     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   615         88  CERT-ADDED-BATCH                 VALUE ' '.
   616         88  CERT-ADDED-ONLINE                VALUE '1'.
   617         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   618         88  CERT-PURGED-OFFLINE              VALUE '3'.
   619         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   620     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   621         88  CERT-AS-LOADED                   VALUE ' '.
   622         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   623         88  CERT-CLAIM-ONLINE                VALUE '2'.
   624         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   625         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   626         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   627         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   628         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   629
   630     12  CM-ACCOUNT-COMM-PCTS.
   631         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   632         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   633
   634     12  CM-USER-FIELD                     PIC X.
   635     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   636     12  CM-CLP-STATE                      PIC XX.
   637     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   638     12  CM-USER-RESERVED                  PIC XXX.
   639     12  FILLER REDEFINES CM-USER-RESERVED.
   640         16  CM-AH-CLASS-CD                PIC XX.
   641         16  F                             PIC X.
   642******************************************************************
   643*                                 COPY ELCMSTR.
   644******************************************************************
   645*                                                                *
   646*                            ELCMSTR.                            *
   647*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   648*                            VMOD=2.012                          *
   649*                                                                *
   650*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   651*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  13
* SOCK03.cbl
   652*   FILE TYPE = VSAM,KSDS                                        *
   653*   RECORD SIZE = 350  RECFORM = FIXED                           *
   654*                                                                *
   655*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   656*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   657*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   658*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   659*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   660*                                                 RKP=75,LEN=21  *
   661*                                                                *
   662*   **** NOTE ****                                               *
   663*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   664*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   665*                                                                *
   666*   LOG = YES                                                    *
   667*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   668******************************************************************
   669*                   C H A N G E   L O G
   670*
   671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   672*-----------------------------------------------------------------
   673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   674* EFFECTIVE    NUMBER
   675*-----------------------------------------------------------------
   676* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   677* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   678* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   679* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   680* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   681******************************************************************
   682 01  CLAIM-MASTER.
   683     12  CL-RECORD-ID                PIC XX.
   684         88  VALID-CL-ID         VALUE 'CL'.
   685
   686     12  CL-CONTROL-PRIMARY.
   687         16  CL-COMPANY-CD           PIC X.
   688         16  CL-CARRIER              PIC X.
   689         16  CL-CLAIM-NO             PIC X(7).
   690         16  CL-CERT-NO.
   691             20  CL-CERT-PRIME       PIC X(10).
   692             20  CL-CERT-SFX         PIC X.
   693
   694     12  CL-CONTROL-BY-NAME.
   695         16  CL-COMPANY-CD-A1        PIC X.
   696         16  CL-INSURED-LAST-NAME    PIC X(15).
   697         16  CL-INSURED-NAME.
   698             20  CL-INSURED-1ST-NAME PIC X(12).
   699             20  CL-INSURED-MID-INIT PIC X.
   700
   701     12  CL-CONTROL-BY-SSN.
   702         16  CL-COMPANY-CD-A2        PIC X.
   703         16  CL-SOC-SEC-NO.
   704             20  CL-SSN-STATE        PIC XX.
   705             20  CL-SSN-ACCOUNT      PIC X(6).
   706             20  CL-SSN-LN3          PIC X(3).
   707
   708     12  CL-CONTROL-BY-CERT-NO.
   709         16  CL-COMPANY-CD-A4        PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  14
* SOCK03.cbl
   710         16  CL-CERT-NO-A4.
   711             20  CL-CERT-A4-PRIME    PIC X(10).
   712             20  CL-CERT-A4-SFX      PIC X.
   713
   714     12  CL-CONTROL-BY-CCN.
   715         16  CL-COMPANY-CD-A5        PIC X.
   716         16  CL-CCN-A5.
   717             20  CL-CCN.
   718                 24  CL-CCN-PREFIX-A5 PIC X(4).
   719                 24  CL-CCN-PRIME-A5 PIC X(12).
   720             20  CL-CCN-FILLER-A5    PIC X(4).
   721
   722     12  CL-INSURED-PROFILE-DATA.
   723         16  CL-INSURED-BIRTH-DT     PIC XX.
   724         16  CL-INSURED-SEX-CD       PIC X.
   725             88  INSURED-IS-MALE        VALUE 'M'.
   726             88  INSURED-IS-FEMALE      VALUE 'F'.
   727             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   728         16  CL-INSURED-OCC-CD       PIC X(6).
   729         16  FILLER                  PIC X(5).
   730
   731     12  CL-PROCESSING-INFO.
   732         16  CL-PROCESSOR-ID         PIC X(4).
   733         16  CL-CLAIM-STATUS         PIC X.
   734             88  CLAIM-IS-OPEN          VALUE 'O'.
   735             88  CLAIM-IS-CLOSED        VALUE 'C'.
   736         16  CL-CLAIM-TYPE           PIC X.
   737*            88  AH-CLAIM               VALUE 'A'.
   738*            88  LIFE-CLAIM             VALUE 'L'.
   739*            88  PROPERTY-CLAIM         VALUE 'P'.
   740*            88  IUI-CLAIM              VALUE 'I'.
   741*            88  GAP-CLAIM              VALUE 'G'.
   742*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   743         16  CL-CLAIM-PREM-TYPE      PIC X.
   744             88  SINGLE-PREMIUM         VALUE '1'.
   745             88  O-B-COVERAGE           VALUE '2'.
   746             88  OPEN-END-COVERAGE      VALUE '3'.
   747         16  CL-INCURRED-DT          PIC XX.
   748         16  CL-REPORTED-DT          PIC XX.
   749         16  CL-FILE-ESTABLISH-DT    PIC XX.
   750         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   751         16  CL-LAST-PMT-DT          PIC XX.
   752         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   753         16  CL-PAID-THRU-DT         PIC XX.
   754         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   755         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   756         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   757         16  CL-PMT-CALC-METHOD      PIC X.
   758             88  CL-360-DAY-YR          VALUE '1'.
   759             88  CL-365-DAY-YR          VALUE '2'.
   760             88  CL-FULL-MONTHS         VALUE '3'.
   761         16  CL-CAUSE-CD             PIC X(6).
   762
   763         16  CL-PRIME-CERT-NO.
   764             20  CL-PRIME-CERT-PRIME PIC X(10).
   765             20  CL-PRIME-CERT-SFX   PIC X.
   766
   767         16  CL-SYSTEM-IDENTIFIER    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  15
* SOCK03.cbl
   768             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   769             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   770
   771         16  CL-MICROFILM-NO         PIC X(10).
   772         16  FILLER REDEFINES CL-MICROFILM-NO.
   773             20  CL-BENEFIT-PERIOD   PIC 99.
   774             20  FILLER              PIC X(8).
   775         16  CL-PROG-FORM-TYPE       PIC X.
   776         16  CL-LAST-ADD-ON-DT       PIC XX.
   777
   778         16  CL-LAST-REOPEN-DT       PIC XX.
   779         16  CL-LAST-CLOSE-DT        PIC XX.
   780         16  CL-LAST-CLOSE-REASON    PIC X(01).
   781             88  FINAL-PAID             VALUE '1'.
   782             88  CLAIM-DENIED           VALUE '2'.
   783             88  AUTO-CLOSE             VALUE '3'.
   784             88  MANUAL-CLOSE           VALUE '4'.
   785             88  BENEFITS-CHANGED       VALUE 'C'.
   786             88  SETUP-ERRORS           VALUE 'E'.
   787         16  CL-ASSOC-CERT-SEQU      PIC S99.
   788         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   789         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   790             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   791         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   792         16  FILLER                  PIC X.
   793
   794     12  CL-CERTIFICATE-DATA.
   795         16  CL-CERT-ORIGIN          PIC X.
   796             88  CERT-WAS-ONLINE        VALUE '1'.
   797             88  CERT-WAS-CREATED       VALUE '2'.
   798             88  COVERAGE-WAS-ADDED     VALUE '3'.
   799         16  CL-CERT-KEY-DATA.
   800             20  CL-CERT-CARRIER     PIC X.
   801             20  CL-CERT-GROUPING    PIC X(6).
   802             20  CL-CERT-STATE       PIC XX.
   803             20  CL-CERT-ACCOUNT.
   804                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   805                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   806             20  CL-CERT-EFF-DT      PIC XX.
   807
   808     12  CL-STATUS-CONTROLS.
   809         16  CL-PRIORITY-CD          PIC X.
   810             88  CONFIDENTIAL-DATA      VALUE '8'.
   811             88  HIGHEST-PRIORITY       VALUE '9'.
   812         16  CL-SUPV-ATTN-CD         PIC X.
   813             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   814             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   815         16  CL-PURGED-DT            PIC XX.
   816         16  CL-RESTORED-DT          PIC XX.
   817         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   818         16  CL-NEXT-RESEND-DT       PIC XX.
   819         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   820         16  CL-CRITICAL-PERIOD      PIC 99.
   821*        16  FILLER                  PIC XX.
   822         16  CL-LAST-MAINT-DT        PIC XX.
   823         16  CL-LAST-MAINT-USER      PIC X(4).
   824         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   825         16  CL-LAST-MAINT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  16
* SOCK03.cbl
   826             88  CLAIM-SET-UP           VALUE ' '.
   827             88  PAYMENT-MADE           VALUE '1'.
   828             88  LETTER-SENT            VALUE '2'.
   829             88  MASTER-WAS-ALTERED     VALUE '3'.
   830             88  MASTER-WAS-RESTORED    VALUE '4'.
   831             88  INCURRED-DATE-CHANGED  VALUE '5'.
   832             88  FILE-CONVERTED         VALUE '6'.
   833             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   834             88  ERROR-CORRECTION       VALUE 'E'.
   835         16  CL-RELATED-CLAIM-NO     PIC X(7).
   836         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   837         16  CL-BENEFICIARY          PIC X(10).
   838         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   839         16  CL-DENIAL-TYPE          PIC X.
   840             88  CL-TYPE-DENIAL          VALUE '1'.
   841             88  CL-TYPE-RESCISSION      VALUE '2'.
   842             88  CL-TYPE-REFORMATION     VALUE '3'.
   843             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   844             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   845         16  filler                  pic x(5).
   846*        16  CL-CRIT-PER-RECURRENT   PIC X.
   847*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   848*        16  CL-RTW-DT               PIC XX.
   849
   850     12  CL-TRAILER-CONTROLS.
   851         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   852             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   853             88  CL-LAST-TRL-AVAIL      VALUE +100.
   854             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   855         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   856         16  FILLER                  PIC XX.
   857         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   858         16  CL-ADDRESS-TRAILER-CNT.
   859             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   860                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   861             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   862                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   863             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   864                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   865             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   866                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   867             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   868                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   869             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   870                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   871             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   872                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   873
   874     12  CL-CV-REFERENCE-NO.
   875         16  CL-CV-REFNO-PRIME       PIC X(18).
   876         16  CL-CV-REFNO-SFX         PIC XX.
   877
   878     12  CL-FILE-LOCATION            PIC X(4).
   879
   880     12  CL-PROCESS-ERRORS.
   881         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   882             88  NO-FATAL-ERRORS        VALUE ZERO.
   883         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  17
* SOCK03.cbl
   884             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   885
   886     12  CL-PRODUCT-CD               PIC X.
   887
   888     12  CL-CURRENT-KEY-DATA.
   889         16  CL-CURRENT-CARRIER      PIC X.
   890         16  CL-CURRENT-GROUPING     PIC X(6).
   891         16  CL-CURRENT-STATE        PIC XX.
   892         16  CL-CURRENT-ACCOUNT      PIC X(10).
   893
   894     12  CL-ASSOCIATES               PIC X.
   895         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   896         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   897         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   898         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   899
   900     12  CL-ACTIVITY-CODE            PIC 99.
   901     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   902     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   903
   904     12  CL-LAPSE-REPORT-CODE        PIC 9.
   905     12  CL-LAG-REPORT-CODE          PIC 9.
   906     12  CL-LOAN-TYPE                PIC XX.
   907     12  CL-LEGAL-STATE              PIC XX.
   908
   909     12  CL-YESNOSW                  PIC X.
   910     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   911         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   912         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   913         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   914     12  cl-insured-type             pic x.
   915         88  cl-claim-on-primary         value 'P'.
   916         88  cl-claim-on-co-borrower     value 'C'.
   917     12  cl-benefit-expiration-dt    PIC XX.
   918*                                 COPY ERCPDEF.
   919******************************************************************
   920*                                                                *
   921*                                                                *
   922*                            ERCPDEF.                            *
   923*                                                                *
   924*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   925*                                                                *
   926*    FILE TYPE = VSAM,KSDS                                       *
   927*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   928*                                                                *
   929*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   930*                                                                *
   931*    LOG = YES                                                   *
   932*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   933******************************************************************
   934*                   C H A N G E   L O G
   935*
   936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   937*-----------------------------------------------------------------
   938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   939* EFFECTIVE    NUMBER
   940*-----------------------------------------------------------------
   941* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  18
* SOCK03.cbl
   942* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   943******************************************************************
   944 01  PRODUCT-MASTER.
   945    12  PD-RECORD-ID                 PIC X(02).
   946        88  VALID-PD-ID                  VALUE 'PD'.
   947    12  PD-CONTROL-PRIMARY.
   948        16  PD-COMPANY-CD            PIC X.
   949        16  PD-STATE                 PIC XX.
   950        16  PD-PRODUCT-CD            PIC XXX.
   951        16  PD-FILLER                PIC X(7).
   952        16  PD-BEN-TYPE              PIC X.
   953        16  PD-BEN-CODE              PIC XX.
   954        16  PD-PROD-EXP-DT           PIC XX.
   955    12  FILLER                       PIC X(50).
   956    12  PD-PRODUCT-DATA OCCURS 8.
   957        16  PD-PROD-CODE             PIC X.
   958            88  PD-PROD-LIFE           VALUE 'L'.
   959            88  PD-PROD-PROP           VALUE 'P'.
   960            88  PD-PROD-AH             VALUE 'A'.
   961            88  PD-PROD-IU             VALUE 'I'.
   962            88  PD-PROD-GAP            VALUE 'G'.
   963            88  PD-PROD-FAML           VALUE 'F'.
   964        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   965        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   966        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   967        16  PD-MAX-TERM              PIC S999        COMP-3.
   968        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   969        16  FILLER                   PIC X.
   970        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   971        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   972        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   973        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   974        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   975        16  PD-REC-CRIT-PERIOD       PIC 99.
   976        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   977            20  PD-RECURRING-YN      PIC X.
   978            20  FILLER               PIC X.
   979        16  PD-RTW-MOS               PIC 99.
   980        16  PD-MAX-EXTENSION         PIC 99.
   981        16  FILLER                   PIC XX.
   982    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   983    12  PD-TERM-LIMITS OCCURS 15.
   984        16  PD-LOW-TERM              PIC S999        COMP-3.
   985        16  PD-HI-TERM               PIC S999        COMP-3.
   986*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   987    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   988        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   989        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   990    12  PD-EARN-FACTORS.
   991        16  FILLER OCCURS 15.
   992            20  FILLER OCCURS 15.
   993                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   994    12  PD-PRODUCT-DESC              PIC X(80).
   995    12  PD-TRUNCATED                 PIC X.
   996    12  FILLER                       PIC X(59).
   997    12  PD-MAINT-INFORMATION.
   998        16  PD-LAST-MAINT-DT         PIC X(02).
   999        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  19
* SOCK03.cbl
  1000        16  PD-LAST-MAINT-BY         PIC X(04).
  1001*                                 COPY ERCCTBL.
  1002******************************************************************
  1003*                                                                *
  1004*                                                                *
  1005*                            ERCCTBL                             *
  1006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1007*                            VMOD=2.003
  1008*                                                                *
  1009*   ONLINE CREDIT SYSTEM                                         *
  1010*                                                                *
  1011*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1012*                                                                *
  1013*   FILE TYPE = VSAM,KSDS                                        *
  1014*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1015*                                                                *
  1016*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1017*       ALTERNATE PATH = NONE                                    *
  1018*                                                                *
  1019*   LOG = NO                                                     *
  1020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1021*                                                                *
  1022*                                                                *
  1023******************************************************************
  1024
  1025 01  COMM-TABLE-RECORD.
  1026     12  CT-RECORD-ID                      PIC XX.
  1027         88  VALID-CT-ID                      VALUE 'CT'.
  1028
  1029     12  CT-CONTROL-PRIMARY.
  1030         16  CT-COMPANY-CD                 PIC X.
  1031         16  CT-TABLE                      PIC XXX.
  1032         16  CT-CNTRL-2.
  1033             20  CT-BEN-TYPE               PIC X.
  1034             20  CT-BEN-CODE               PIC XX.
  1035
  1036     12  CT-MAINT-INFORMATION.
  1037         16  CT-LAST-MAINT-DT              PIC XX.
  1038         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1039         16  CT-LAST-MAINT-USER            PIC X(4).
  1040         16  FILLER                        PIC X(31).
  1041
  1042     12  CT-LIMITS.
  1043         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1044
  1045         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1046
  1047         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1048
  1049     12  CT-RATES.
  1050         16  CT-RTX          OCCURS 27 TIMES.
  1051             20  CT-RT                     PIC SV9(5)     COMP-3.
  1052             20  CT-RT-R   REDEFINES
  1053                 CT-RT                     PIC XXX.
  1054
  1055     12  FILLER                            PIC  X(42).
  1056
  1057******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  20
* SOCK03.cbl
  1058*                                 COPY ELCCNTL.
  1059******************************************************************
  1060*                                                                *
  1061*                                                                *
  1062*                            ELCCNTL.                            *
  1063*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1064*                            VMOD=2.059                          *
  1065*                                                                *
  1066*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1067*                                                                *
  1068*   FILE TYPE = VSAM,KSDS                                        *
  1069*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1070*                                                                *
  1071*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1072*       ALTERNATE INDEX = NONE                                   *
  1073*                                                                *
  1074*   LOG = YES                                                    *
  1075*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1076******************************************************************
  1077*                   C H A N G E   L O G
  1078*
  1079* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1080*-----------------------------------------------------------------
  1081*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1082* EFFECTIVE    NUMBER
  1083*-----------------------------------------------------------------
  1084* 082503                   PEMA  ADD BENEFIT GROUP
  1085* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1086* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1087* 092705    2005050300006  PEMA  ADD SPP LEASES
  1088* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1089* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1090* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1091* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1092* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1093* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1094* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1095* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1096* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1097* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1098******************************************************************
  1099*
  1100 01  CONTROL-FILE.
  1101     12  CF-RECORD-ID                       PIC XX.
  1102         88  VALID-CF-ID                        VALUE 'CF'.
  1103
  1104     12  CF-CONTROL-PRIMARY.
  1105         16  CF-COMPANY-ID                  PIC XXX.
  1106         16  CF-RECORD-TYPE                 PIC X.
  1107             88  CF-COMPANY-MASTER              VALUE '1'.
  1108             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1109             88  CF-STATE-MASTER                VALUE '3'.
  1110             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1111             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1112             88  CF-CARRIER-MASTER              VALUE '6'.
  1113             88  CF-MORTALITY-MASTER            VALUE '7'.
  1114             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1115             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  21
* SOCK03.cbl
  1116             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1117             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1118             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1119             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1120             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1121             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1122             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1123             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1124             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1125         16  CF-ACCESS-CD-GENL              PIC X(4).
  1126         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1127             20  CF-PROCESSOR               PIC X(4).
  1128         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1129             20  CF-STATE-CODE              PIC XX.
  1130             20  FILLER                     PIC XX.
  1131         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1132             20  FILLER                     PIC XX.
  1133             20  CF-HI-BEN-IN-REC           PIC XX.
  1134         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1135             20  FILLER                     PIC XXX.
  1136             20  CF-CARRIER-CNTL            PIC X.
  1137         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1138             20  FILLER                     PIC XX.
  1139             20  CF-HI-TYPE-IN-REC          PIC 99.
  1140         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1141             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1142                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1143             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1144             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1145         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1146             20  FILLER                     PIC X.
  1147             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1148         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1149             20  FILLER                     PIC XX.
  1150             20  CF-MORTGAGE-PLAN           PIC XX.
  1151         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1152
  1153     12  CF-LAST-MAINT-DT                   PIC XX.
  1154     12  CF-LAST-MAINT-BY                   PIC X(4).
  1155     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1156
  1157     12  CF-RECORD-BODY                     PIC X(728).
  1158
  1159
  1160****************************************************************
  1161*             COMPANY MASTER RECORD                            *
  1162****************************************************************
  1163
  1164     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1165         16  CF-COMPANY-ADDRESS.
  1166             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1167             20  CF-CL-IN-CARE-OF           PIC X(30).
  1168             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1169             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1170             20  CF-CL-CITY-STATE           PIC X(30).
  1171             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1172             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1173         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  22
* SOCK03.cbl
  1174         16  CF-COMPANY-PASSWORD            PIC X(8).
  1175         16  CF-SECURITY-OPTION             PIC X.
  1176             88  ALL-SECURITY                   VALUE '1'.
  1177             88  COMPANY-VERIFY                 VALUE '2'.
  1178             88  PROCESSOR-VERIFY               VALUE '3'.
  1179             88  NO-SECURITY                    VALUE '4'.
  1180             88  ALL-BUT-TERM                   VALUE '5'.
  1181         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1182             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1183         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1184             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1185         16  CF-INFORCE-LOCATION            PIC X.
  1186             88  CERTS-ARE-ONLINE               VALUE '1'.
  1187             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1188             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1189         16  CF-LOWER-CASE-LETTERS          PIC X.
  1190         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1191             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1192             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1193             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1194             88  CF-ACCNT-CNTL                  VALUE '3'.
  1195             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1196
  1197         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1198         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1199
  1200         16  CF-LGX-CREDIT-USER             PIC X.
  1201             88  CO-IS-NOT-USER                 VALUE 'N'.
  1202             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1203
  1204         16 CF-CREDIT-CALC-CODES.
  1205             20  CF-CR-REM-TERM-CALC PIC X.
  1206               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1207               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1208               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1209               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1210               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1211               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1212               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1213             20  CF-CR-R78-METHOD           PIC X.
  1214               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1215               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1216
  1217         16  CF-CLAIM-CONTROL-COUNTS.
  1218             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1219                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1220
  1221             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1222                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1223
  1224             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1225                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1226
  1227             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1228                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1229
  1230         16  CF-CURRENT-MONTH-END           PIC XX.
  1231
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  23
* SOCK03.cbl
  1232         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1233             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1234             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1235             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1236             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1237                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1238                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1239             20  CF-CO-PREM-REJECT-SW       PIC X.
  1240                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1241                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1242             20  CF-CO-REF-REJECT-SW        PIC X.
  1243                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1244                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1245
  1246         16  CF-CO-REPORTING-DT             PIC XX.
  1247         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1248         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1249           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1250           88  CF-CO-MONTH-END                  VALUE '1'.
  1251
  1252         16  CF-LGX-CLAIM-USER              PIC X.
  1253             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1254             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1255
  1256         16  CF-CREDIT-EDIT-CONTROLS.
  1257             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1258             20  CF-MIN-AGE                 PIC 99.
  1259             20  CF-DEFAULT-AGE             PIC 99.
  1260             20  CF-MIN-TERM                PIC S999      COMP-3.
  1261             20  CF-MAX-TERM                PIC S999      COMP-3.
  1262             20  CF-DEFAULT-SEX             PIC X.
  1263             20  CF-JOINT-AGE-INPUT         PIC X.
  1264                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1265             20  CF-BIRTH-DATE-INPUT        PIC X.
  1266                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1267             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1268                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1269                 88  CF-ZERO-CARRIER            VALUE '1'.
  1270                 88  CF-ZERO-GROUPING           VALUE '2'.
  1271                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1272             20  CF-EDIT-SW                 PIC X.
  1273                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1274             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1275             20  CF-CR-PR-METHOD            PIC X.
  1276               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1277               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1278             20  FILLER                     PIC X.
  1279
  1280         16  CF-CREDIT-MISC-CONTROLS.
  1281             20  CF-REIN-TABLE-SW           PIC X.
  1282                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1283             20  CF-COMP-TABLE-SW           PIC X.
  1284                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1285             20  CF-EXPERIENCE-RETENTION-AGE
  1286                                            PIC S9        COMP-3.
  1287             20  CF-CONVERSION-DT           PIC XX.
  1288             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1289             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  24
* SOCK03.cbl
  1290                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1291                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1292
  1293             20  CF-CR-CHECK-NO-CONTROL.
  1294                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1295                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1296                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1297                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1298                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1299                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1300
  1301                 24  CF-CR-CHECK-COUNT       REDEFINES
  1302                     CF-CR-CHECK-COUNTER      PIC X(4).
  1303
  1304                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1305                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1306
  1307                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1308                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1309                 24  CF-MAIL-PROCESSING       PIC X.
  1310                     88  MAIL-PROCESSING          VALUE 'Y'.
  1311
  1312         16  CF-MISC-SYSTEM-CONTROL.
  1313             20  CF-SYSTEM-C                 PIC X.
  1314                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1315             20  CF-SYSTEM-D                 PIC X.
  1316                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1317             20  CF-SOC-SEC-NO-SW            PIC X.
  1318                 88  SOC-SEC-NO-USED             VALUE '1'.
  1319             20  CF-MEMBER-NO-SW             PIC X.
  1320                 88  MEMBER-NO-USED              VALUE '1'.
  1321             20  CF-TAX-ID-NUMBER            PIC X(11).
  1322             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1323             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1324                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1325                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1326                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1327                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1328             20  CF-SYSTEM-E                 PIC X.
  1329                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1330
  1331         16  CF-LGX-LIFE-USER               PIC X.
  1332             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1333             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1334
  1335         16  CF-CR-MONTH-END-DT             PIC XX.
  1336
  1337         16  CF-FILE-MAINT-DATES.
  1338             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1339                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1340             20  CF-LAST-BATCH       REDEFINES
  1341                 CF-LAST-BATCH-NO               PIC X(4).
  1342             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1343             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1344             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1345             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1346             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1347             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  25
* SOCK03.cbl
  1348             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1349             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1350             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1351             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1352
  1353         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1354         16  FILLER                         PIC X.
  1355
  1356         16  CF-ALT-MORT-CODE               PIC X(4).
  1357         16  CF-MEMBER-CAPTION              PIC X(10).
  1358
  1359         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1360             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1361             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1362             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1363             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1364             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1365
  1366         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1367
  1368         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1369         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1370         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1371         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1372
  1373         16  CF-AH-OVERRIDE-L1              PIC X.
  1374         16  CF-AH-OVERRIDE-L2              PIC XX.
  1375         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1376         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1377
  1378         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1379         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1380
  1381         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1382         16  CF-AR-LAST-EL860-DT            PIC XX.
  1383         16  CF-MP-MONTH-END-DT             PIC XX.
  1384
  1385         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1386         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1387             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1388
  1389         16  CF-AR-MONTH-END-DT             PIC XX.
  1390
  1391         16  CF-CRDTCRD-USER                PIC X.
  1392             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1393             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1394
  1395         16  CF-CC-MONTH-END-DT             PIC XX.
  1396
  1397         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1398
  1399         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1400             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1401             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1402             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1403         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1404         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1405         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  26
* SOCK03.cbl
  1406         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1407             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1408             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1409         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1410         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1411         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1412             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1413         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1414
  1415         16  CF-CL-ZIP-CODE.
  1416             20  CF-CL-ZIP-PRIME.
  1417                 24  CF-CL-ZIP-1ST          PIC X.
  1418                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1419                 24  FILLER                 PIC X(4).
  1420             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1421         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1422             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1423             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1424             20  FILLER                     PIC XXX.
  1425
  1426         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1427         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1428         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1429         16  CF-CO-OPTION-START-DATE        PIC XX.
  1430         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1431           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1432                                                      '3' '4'.
  1433           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1434           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1435           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1436           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1437           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1438           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1439
  1440         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1441
  1442         16  CF-PAYMENT-APPROVAL-LEVELS.
  1443             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1444             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1445             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1446             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1447             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1448             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1449
  1450         16  CF-END-USER-REPORTING-USER     PIC X.
  1451             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1452             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1453
  1454         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1455             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1456             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1457
  1458         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1459
  1460         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1461         16  FILLER                         PIC X.
  1462
  1463         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  27
* SOCK03.cbl
  1464             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1465             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1466             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1467
  1468         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1469
  1470         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1471             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1472             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1473
  1474         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1475             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1476             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1477
  1478         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1479
  1480         16  CF-CO-ACH-ID-CODE              PIC  X.
  1481             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1482             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1483             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1484         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1485         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1486         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1487         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1488         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1489         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1490         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1491         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1492         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1493                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1494         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1495                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1496
  1497         16  CF-CO-OVER-SHORT.
  1498             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1499             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1500
  1501*         16  FILLER                         PIC X(102).
  1502         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1503             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1504             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1505
  1506         16  CF-AH-APPROVAL-DAYS.
  1507             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1508             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1509             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1510             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1511
  1512         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1513
  1514         16  CF-APPROV-LEV-5.
  1515             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1516             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1517             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1518
  1519         16  FILLER                         PIC X(68).
  1520****************************************************************
  1521*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  28
* SOCK03.cbl
  1522****************************************************************
  1523
  1524     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1525         16  CF-PROCESSOR-NAME              PIC X(30).
  1526         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1527         16  CF-PROCESSOR-TITLE             PIC X(26).
  1528         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1529                 88  MESSAGE-YES                VALUE 'Y'.
  1530                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1531
  1532*****************************************************
  1533****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1534****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1535****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1536****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1537*****************************************************
  1538
  1539         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1540             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1541             20  CF-APPLICATION-FORCE       PIC X.
  1542             20  CF-INDIVIDUAL-APP.
  1543                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1544                     28  CF-BROWSE-APP      PIC X.
  1545                     28  CF-UPDATE-APP      PIC X.
  1546
  1547         16  CF-CURRENT-TERM-ON             PIC X(4).
  1548         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1549             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1550             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1551             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1552             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1553             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1554             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1555             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1556         16  CF-PROCESSOR-CARRIER           PIC X.
  1557             88  NO-CARRIER-SECURITY            VALUE ' '.
  1558         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1559             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1560         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1561             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1562         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1563             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1564
  1565         16  CF-PROC-SYS-ACCESS-SW.
  1566             20  CF-PROC-CREDIT-CLAIMS-SW.
  1567                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1568                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1569                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1570                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1571             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1572                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1573                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1574             20  CF-PROC-LIFE-GNRLDGR-SW.
  1575                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1576                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1577                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1578                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1579             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  29
* SOCK03.cbl
  1580                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1581                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1582         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1583             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1584             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1585         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1586
  1587         16  CF-APPROVAL-LEVEL                  PIC X.
  1588             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1589             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1590             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1591             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1592             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1593
  1594         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1595
  1596         16  CF-LANGUAGE-TYPE                   PIC X.
  1597             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1598             88  CF-LANG-IS-FR                      VALUE 'F'.
  1599
  1600         16  CF-CSR-IND                         PIC X.
  1601         16  FILLER                             PIC X(239).
  1602
  1603****************************************************************
  1604*             PROCESSOR/REMINDERS RECORD                       *
  1605****************************************************************
  1606
  1607     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1608         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1609             20  CF-START-REMIND-DT         PIC XX.
  1610             20  CF-END-REMIND-DT           PIC XX.
  1611             20  CF-REMINDER-TEXT           PIC X(50).
  1612         16  FILLER                         PIC X(296).
  1613
  1614
  1615****************************************************************
  1616*             STATE MASTER RECORD                              *
  1617****************************************************************
  1618
  1619     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1620         16  CF-STATE-ABBREVIATION          PIC XX.
  1621         16  CF-STATE-NAME                  PIC X(25).
  1622         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1623         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1624             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1625             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1626             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1627             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1628                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1629                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1630             20  CF-ST-PREM-REJECT-SW       PIC X.
  1631                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1632                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1633             20  CF-ST-REF-REJECT-SW        PIC X.
  1634                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1635                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1636         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1637         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  30
* SOCK03.cbl
  1638         16  CF-ST-REFUND-RULES.
  1639             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1640             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1641             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1642         16  CF-ST-FST-PMT-EXTENSION.
  1643             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1644             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1645                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1646                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1647                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1648                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1649         16  CF-ST-STATE-CALL.
  1650             20  CF-ST-CALL-UNEARNED        PIC X.
  1651             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1652             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1653         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1654             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1655             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1656         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1657         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1658         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1659         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1660         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1661         16  FILLER                         PIC X.
  1662         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1663             20  CF-ST-BENEFIT-CD           PIC XX.
  1664             20  CF-ST-BENEFIT-KIND         PIC X.
  1665                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1666                 88  CF-ST-AH-KIND              VALUE 'A'.
  1667             20  CF-ST-REM-TERM-CALC        PIC X.
  1668                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1669                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1670                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1671                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1672                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1673                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1674                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1675                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1676
  1677             20  CF-ST-REFUND-CALC          PIC X.
  1678                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1679                 88  ST-REFD-BY-R78             VALUE '1'.
  1680                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1681                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1682                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1683                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1684                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1685                 88  ST-REFD-UTAH               VALUE '7'.
  1686                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1687                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1688                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1689
  1690             20  CF-ST-EARNING-CALC         PIC X.
  1691                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1692                 88  ST-EARN-BY-R78             VALUE '1'.
  1693                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1694                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1695                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  31
* SOCK03.cbl
  1696                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1697                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1698                 88  ST-EARN-MEAN               VALUE '8'.
  1699                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1700
  1701             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1702                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1703                 88  ST-OVRD-BY-R78             VALUE '1'.
  1704                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1705                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1706                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1707                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1708                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1709                 88  ST-OVRD-MEAN               VALUE '8'.
  1710                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1711             20  FILLER                     PIC X.
  1712
  1713         16  CF-ST-COMMISSION-CAPS.
  1714             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1715             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1716             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1717             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1718         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1719                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1720
  1721         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1722
  1723         16  CF-ST-STATUTORY-INTEREST.
  1724             20  CF-ST-STAT-DATE-FROM       PIC X.
  1725                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1726                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1727             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1728             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1729             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1730             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1731             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1732
  1733         16  CF-ST-OVER-SHORT.
  1734             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1735             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1736
  1737         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1738
  1739         16  CF-ST-RT-CALC                  PIC X.
  1740
  1741         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1742         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1743         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1744         16  CF-ST-RF-LR-CALC               PIC X.
  1745         16  CF-ST-RF-LL-CALC               PIC X.
  1746         16  CF-ST-RF-LN-CALC               PIC X.
  1747         16  CF-ST-RF-AH-CALC               PIC X.
  1748         16  CF-ST-RF-CP-CALC               PIC X.
  1749*        16  FILLER                         PIC X(206).
  1750*CIDMOD         16  FILLER                         PIC X(192).
  1751         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1752             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1753         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  32
* SOCK03.cbl
  1754         16  CF-ST-VFY-2ND-BENE             PIC X.
  1755         16  CF-ST-CAUSAL-STATE             PIC X.
  1756         16  FILLER                         PIC X(185).
  1757
  1758****************************************************************
  1759*             BENEFIT MASTER RECORD                            *
  1760****************************************************************
  1761
  1762     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1763         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1764             20  CF-BENEFIT-CODE            PIC XX.
  1765             20  CF-BENEFIT-NUMERIC  REDEFINES
  1766                 CF-BENEFIT-CODE            PIC XX.
  1767             20  CF-BENEFIT-ALPHA           PIC XXX.
  1768             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1769             20  CF-BENEFIT-COMMENT         PIC X(10).
  1770
  1771             20  CF-LF-COVERAGE-TYPE        PIC X.
  1772                 88  CF-REDUCING                VALUE 'R'.
  1773                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1774
  1775             20  CF-SPECIAL-CALC-CD         PIC X.
  1776                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1777                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1778                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1779                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1780                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1781                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1782                 88  CF-FARM-PLAN               VALUE 'F'.
  1783                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1784                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1785                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1786                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1787                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1788                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1789                 88  CF-PRUDENTIAL              VALUE 'P'.
  1790                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1791                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1792                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1793                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1794                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1795                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1796
  1797             20  CF-JOINT-INDICATOR         PIC X.
  1798                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1799
  1800*            20  FILLER                     PIC X(12).
  1801             20  cf-maximum-benefits        pic s999 comp-3.
  1802             20  FILLER                     PIC X(09).
  1803             20  CF-BENEFIT-CATEGORY        PIC X.
  1804             20  CF-LOAN-TYPE               PIC X(8).
  1805
  1806             20  CF-CO-REM-TERM-CALC        PIC X.
  1807                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1808                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1809                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1810                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1811                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  33
* SOCK03.cbl
  1812
  1813             20  CF-CO-EARNINGS-CALC        PIC X.
  1814                 88  CO-EARN-BY-R78             VALUE '1'.
  1815                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1816                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1817                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1818                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1819                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1820                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1821                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1822
  1823             20  CF-CO-REFUND-CALC          PIC X.
  1824                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1825                 88  CO-REFD-BY-R78             VALUE '1'.
  1826                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1827                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1828                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1829                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1830                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1831                 88  CO-REFD-MEAN               VALUE '8'.
  1832                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1833                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1834                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1835
  1836             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1837                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1838                 88  CO-OVRD-BY-R78             VALUE '1'.
  1839                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1840                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1841                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1842                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1843                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1844                 88  CO-OVRD-MEAN               VALUE '8'.
  1845                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1846
  1847             20  CF-CO-BEN-I-G-CD           PIC X.
  1848                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1849                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1850                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1851
  1852         16  FILLER                         PIC X(304).
  1853
  1854
  1855****************************************************************
  1856*             CARRIER MASTER RECORD                            *
  1857****************************************************************
  1858
  1859     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1860         16  CF-ADDRESS-DATA.
  1861             20  CF-MAIL-TO-NAME            PIC X(30).
  1862             20  CF-IN-CARE-OF              PIC X(30).
  1863             20  CF-ADDRESS-LINE-1          PIC X(30).
  1864             20  CF-ADDRESS-LINE-2          PIC X(30).
  1865             20  CF-CITY-STATE              PIC X(30).
  1866             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1867             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1868
  1869         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  34
* SOCK03.cbl
  1870             20  CF-CLAIM-NO-METHOD         PIC X.
  1871                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1872                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1873                 88  CLAIM-NO-SEQ               VALUE '3'.
  1874                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1875             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1876                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1877                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1878                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1879
  1880         16  CF-CHECK-NO-CONTROL.
  1881             20  CF-CHECK-NO-METHOD         PIC X.
  1882                 88  CHECK-NO-MANUAL            VALUE '1'.
  1883                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1884                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1885                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1886             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1887                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1888
  1889         16  CF-DOMICILE-STATE              PIC XX.
  1890
  1891         16  CF-EXPENSE-CONTROLS.
  1892             20  CF-EXPENSE-METHOD          PIC X.
  1893                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1894                 88  DOLLARS-PER-PMT            VALUE '2'.
  1895                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1896                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1897             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1898             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1899
  1900         16  CF-CORRESPONDENCE-CONTROL.
  1901             20  CF-LETTER-RESEND-OPT       PIC X.
  1902                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1903                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1904             20  FILLER                     PIC X(4).
  1905
  1906         16  CF-RESERVE-CONTROLS.
  1907             20  CF-MANUAL-SW               PIC X.
  1908                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1909             20  CF-FUTURE-SW               PIC X.
  1910                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1911             20  CF-PTC-SW                  PIC X.
  1912                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1913             20  CF-IBNR-SW                 PIC X.
  1914                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1915             20  CF-PTC-LF-SW               PIC X.
  1916                 88  CF-LF-PTC-USED             VALUE '1'.
  1917             20  CF-CDT-ACCESS-METHOD       PIC X.
  1918                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1919                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1920                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1921             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1922
  1923         16  CF-CLAIM-CALC-METHOD           PIC X.
  1924             88  360-PLUS-MONTHS                VALUE '1'.
  1925             88  365-PLUS-MONTHS                VALUE '2'.
  1926             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1927             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  35
* SOCK03.cbl
  1928             88  365-DAILY                      VALUE '5'.
  1929
  1930         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1931         16  FILLER                         PIC X(11).
  1932
  1933         16  CF-LIMIT-AMOUNTS.
  1934             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1935             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1936             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1937             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1938             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1939             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1940             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1941             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1942             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1943             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1944
  1945         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1946         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1947         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1948
  1949         16  CF-ZIP-CODE.
  1950             20  CF-ZIP-PRIME.
  1951                 24  CF-ZIP-1ST             PIC X.
  1952                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1953                 24  FILLER                 PIC X(4).
  1954             20  CF-ZIP-PLUS4               PIC X(4).
  1955         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1956             20  CF-CAN-POSTAL-1            PIC XXX.
  1957             20  CF-CAN-POSTAL-2            PIC XXX.
  1958             20  FILLER                     PIC XXX.
  1959
  1960         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1961         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1962         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1963
  1964         16  CF-RATING-SWITCH               PIC X.
  1965             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1966             88  CF-NO-RATING                   VALUE 'N'.
  1967
  1968         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1969
  1970         16  CF-CARRIER-OVER-SHORT.
  1971             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1972             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1973
  1974         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1975         16  CF-SECPAY-SWITCH               PIC X.
  1976             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1977             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1978         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1979         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1980         16  FILLER                         PIC X(444).
  1981*        16  FILLER                         PIC X(452).
  1982
  1983
  1984****************************************************************
  1985*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  36
* SOCK03.cbl
  1986****************************************************************
  1987
  1988     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1989         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1990                                INDEXED BY CF-MORT-NDX.
  1991             20  CF-MORT-TABLE              PIC X(5).
  1992             20  CF-MORT-TABLE-TYPE         PIC X.
  1993                 88  CF-MORT-JOINT              VALUE 'J'.
  1994                 88  CF-MORT-SINGLE             VALUE 'S'.
  1995                 88  CF-MORT-COMBINED           VALUE 'C'.
  1996                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1997                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1998             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1999             20  CF-MORT-AGE-METHOD         PIC XX.
  2000                 88  CF-AGE-LAST                VALUE 'AL'.
  2001                 88  CF-AGE-NEAR                VALUE 'AN'.
  2002             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2003             20  CF-MORT-ADJUSTMENT-DIRECTION
  2004                                            PIC X.
  2005                 88  CF-MINUS                   VALUE '-'.
  2006                 88  CF-PLUS                    VALUE '+'.
  2007             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2008             20  CF-MORT-JOINT-CODE         PIC X.
  2009                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2010             20  CF-MORT-PC-Q               PIC X.
  2011                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2012             20  CF-MORT-TABLE-CODE         PIC X(4).
  2013             20  CF-MORT-COMMENTS           PIC X(15).
  2014             20  FILLER                     PIC X(14).
  2015
  2016         16  FILLER                         PIC X(251).
  2017
  2018
  2019****************************************************************
  2020*             BUSSINESS TYPE MASTER RECORD                     *
  2021****************************************************************
  2022
  2023     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2024* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2025* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2026* AND RECORD 05 IS TYPES 81-99
  2027         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2028             20  CF-BUSINESS-TITLE          PIC  X(19).
  2029             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2030                                            PIC S9V9(4) COMP-3.
  2031             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2032             20  FILLER                     PIC  X.
  2033         16  FILLER                         PIC  X(248).
  2034
  2035
  2036****************************************************************
  2037*             TERMINAL MASTER RECORD                           *
  2038****************************************************************
  2039
  2040     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2041
  2042         16  CF-COMPANY-TERMINALS.
  2043             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  37
* SOCK03.cbl
  2044                                  PIC X(4).
  2045         16  FILLER               PIC X(248).
  2046
  2047
  2048****************************************************************
  2049*             LIFE EDIT MASTER RECORD                          *
  2050****************************************************************
  2051
  2052     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2053         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2054             20  CF-LIFE-CODE-IN            PIC XX.
  2055             20  CF-LIFE-CODE-OUT           PIC XX.
  2056         16  FILLER                         PIC X(248).
  2057
  2058
  2059****************************************************************
  2060*             AH EDIT MASTER RECORD                            *
  2061****************************************************************
  2062
  2063     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2064         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2065             20  CF-AH-CODE-IN              PIC XXX.
  2066             20  CF-AH-CODE-OUT             PIC XX.
  2067         16  FILLER                         PIC X(248).
  2068
  2069
  2070****************************************************************
  2071*             CREDIBILITY TABLES                               *
  2072****************************************************************
  2073
  2074     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2075         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2076                             INDEXED BY CF-CRDB-NDX.
  2077             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2078             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2079             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2080         16  FILLER                         PIC  X(332).
  2081
  2082
  2083****************************************************************
  2084*             REPORT CUSTOMIZATION RECORD                      *
  2085****************************************************************
  2086
  2087     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2088         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2089             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2090             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2091             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2092**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2093****       A T-TRANSFER.                                   ****
  2094             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2095
  2096         16  FILLER                         PIC XX.
  2097
  2098         16  CF-CARRIER-CNTL-OPT.
  2099             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2100                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2101                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  38
* SOCK03.cbl
  2102             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2103                                            PIC X.
  2104         16  CF-GROUP-CNTL-OPT.
  2105             20  CF-GROUP-OPT-SEQ           PIC 9.
  2106                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2107                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2108             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2109                                            PIC X(6).
  2110         16  CF-STATE-CNTL-OPT.
  2111             20  CF-STATE-OPT-SEQ           PIC 9.
  2112                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2113                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2114             20  CF-STATE-SELECT OCCURS 3 TIMES
  2115                                            PIC XX.
  2116         16  CF-ACCOUNT-CNTL-OPT.
  2117             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2118                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2119                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2120             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2121                                            PIC X(10).
  2122         16  CF-BUS-TYP-CNTL-OPT.
  2123             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2124                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2125                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2126             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2127                                            PIC XX.
  2128         16  CF-LF-TYP-CNTL-OPT.
  2129             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2130                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2131                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2132             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2133                                            PIC XX.
  2134         16  CF-AH-TYP-CNTL-OPT.
  2135             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2136                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2137                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2138             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2139                                            PIC XX.
  2140         16  CF-REPTCD1-CNTL-OPT.
  2141             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2142                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2143                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2144             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2145                                            PIC X(10).
  2146         16  CF-REPTCD2-CNTL-OPT.
  2147             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2148                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2149                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2150             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2151                                            PIC X(10).
  2152         16  CF-USER1-CNTL-OPT.
  2153             20  CF-USER1-OPT-SEQ           PIC 9.
  2154                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2155                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2156             20  CF-USER1-SELECT OCCURS 3 TIMES
  2157                                            PIC X(10).
  2158         16  CF-USER2-CNTL-OPT.
  2159             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  39
* SOCK03.cbl
  2160                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2161                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2162             20  CF-USER2-SELECT OCCURS 3 TIMES
  2163                                            PIC X(10).
  2164         16  CF-USER3-CNTL-OPT.
  2165             20  CF-USER3-OPT-SEQ           PIC 9.
  2166                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2167                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2168             20  CF-USER3-SELECT OCCURS 3 TIMES
  2169                                            PIC X(10).
  2170         16  CF-USER4-CNTL-OPT.
  2171             20  CF-USER4-OPT-SEQ           PIC 9.
  2172                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2173                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2174             20  CF-USER4-SELECT OCCURS 3 TIMES
  2175                                            PIC X(10).
  2176         16  CF-USER5-CNTL-OPT.
  2177             20  CF-USER5-OPT-SEQ           PIC 9.
  2178                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2179                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2180             20  CF-USER5-SELECT OCCURS 3 TIMES
  2181                                            PIC X(10).
  2182         16  CF-REINS-CNTL-OPT.
  2183             20  CF-REINS-OPT-SEQ           PIC 9.
  2184                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2185                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2186             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2187                 24  CF-REINS-PRIME         PIC XXX.
  2188                 24  CF-REINS-SUB           PIC XXX.
  2189
  2190         16  CF-AGENT-CNTL-OPT.
  2191             20  CF-AGENT-OPT-SEQ           PIC 9.
  2192                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2193                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2194             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2195                                            PIC X(10).
  2196
  2197         16  FILLER                         PIC X(43).
  2198
  2199         16  CF-LOSS-RATIO-SELECT.
  2200             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2201             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2202         16  CF-ENTRY-DATE-SELECT.
  2203             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2204             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2205         16  CF-EFFECTIVE-DATE-SELECT.
  2206             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2207             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2208
  2209         16  CF-EXCEPTION-LIST-IND          PIC X.
  2210             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2211
  2212         16  FILLER                         PIC X(318).
  2213
  2214****************************************************************
  2215*                  EXCEPTION REPORTING RECORD                  *
  2216****************************************************************
  2217
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  40
* SOCK03.cbl
  2218     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2219         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2220             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2221
  2222         16  CF-COMBINED-LIFE-AH-OPT.
  2223             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2224             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2225             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2226             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2227
  2228         16  CF-LIFE-OPT.
  2229             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2230             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2231             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2232             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2233             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2234             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2235             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2236             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2237             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2238             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2239
  2240         16  CF-AH-OPT.
  2241             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2242             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2243             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2244             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2245             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2246             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2247             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2248             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2249             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2250             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2251
  2252         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2253             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2254             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2255             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2256
  2257         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2258
  2259         16  FILLER                         PIC X(673).
  2260
  2261
  2262****************************************************************
  2263*             MORTGAGE SYSTEM PLAN RECORD                      *
  2264****************************************************************
  2265
  2266     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2267         16  CF-PLAN-TYPE                   PIC X.
  2268             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2269             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2270             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2271         16  CF-PLAN-ABBREV                 PIC XXX.
  2272         16  CF-PLAN-DESCRIPT               PIC X(10).
  2273         16  CF-PLAN-NOTES                  PIC X(20).
  2274         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2275         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  41
* SOCK03.cbl
  2276             20  CF-PLAN-TERM-DATA.
  2277                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2278                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2279             20  CF-PLAN-AGE-DATA.
  2280                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2281                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2282                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2283             20  CF-PLAN-BENEFIT-DATA.
  2284                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2285                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2286                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2287                                            PIC S9(7)V99  COMP-3.
  2288         16  CF-PLAN-POLICY-FORMS.
  2289             20  CF-POLICY-FORM             PIC X(12).
  2290             20  CF-MASTER-APPLICATION      PIC X(12).
  2291             20  CF-MASTER-POLICY           PIC X(12).
  2292         16  CF-PLAN-RATING.
  2293             20  CF-RATE-CODE               PIC X(5).
  2294             20  CF-SEX-RATING              PIC X.
  2295                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2296                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2297             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2298             20  CF-SUB-STD-TYPE            PIC X.
  2299                 88  CF-PCT-OF-PREM            VALUE '1'.
  2300                 88  CF-PCT-OF-BENE            VALUE '2'.
  2301         16  CF-PLAN-PREM-TOLERANCES.
  2302             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2303             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2304         16  CF-PLAN-PYMT-TOLERANCES.
  2305             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2306             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2307         16  CF-PLAN-MISC-DATA.
  2308             20  FILLER                     PIC X.
  2309             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2310             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2311         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2312         16  CF-PLAN-IND-GRP                PIC X.
  2313             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2314                                                     '1'.
  2315             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2316                                                     '2'.
  2317         16  CF-MIB-SEARCH-SW               PIC X.
  2318             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2319             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2320             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2321             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2322         16  CF-ALPHA-SEARCH-SW             PIC X.
  2323             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2324             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2325             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2326             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2327             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2328             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2329             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2330             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2331             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2332             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2333                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  42
* SOCK03.cbl
  2334                                                     'X' 'Y' 'Z'.
  2335         16  CF-EFF-DT-RULE-SW              PIC X.
  2336             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2337             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2338             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2339             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2340             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2341         16  FILLER                         PIC X(4).
  2342         16  CF-HEALTH-QUESTIONS            PIC X.
  2343             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2344         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2345         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2346         16  CF-PLAN-SNGL-JNT               PIC X.
  2347             88  CF-COMBINED-PLAN              VALUE 'C'.
  2348             88  CF-JNT-PLAN                   VALUE 'J'.
  2349             88  CF-SNGL-PLAN                  VALUE 'S'.
  2350         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2351         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2352         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2353         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2354         16  CF-RERATE-CNTL                 PIC  X.
  2355             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2356             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2357             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2358             88  CF-AUTO-RECALC                 VALUE '4'.
  2359         16  CF-BENEFIT-TYPE                PIC  X.
  2360             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2361             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2362         16  CF-POLICY-FEE                  PIC S999V99
  2363                                                    COMP-3.
  2364         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2365         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2366         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2367         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2368         16  FILLER                         PIC  X(32).
  2369         16  CF-TERMINATION-FORM            PIC  X(04).
  2370         16  FILLER                         PIC  X(08).
  2371         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2372                                                       COMP-3.
  2373         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2374         16  CF-ISSUE-LETTER                PIC  X(4).
  2375         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2376         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2377             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2378             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2379         16  CF-MP-REFUND-CALC              PIC X.
  2380             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2381             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2382             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2383             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2384             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2385             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2386             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2387             88  CF-MP-REFD-MEAN                VALUE '8'.
  2388         16  CF-ALT-RATE-CODE               PIC  X(5).
  2389
  2390
  2391         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  43
* SOCK03.cbl
  2392****************************************************************
  2393*             MORTGAGE COMPANY MASTER RECORD                   *
  2394****************************************************************
  2395
  2396     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2397         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2398         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2399             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2400             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2401             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2402             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2403             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2404
  2405         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2406         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2407         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2408         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2409         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2410
  2411         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2412             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2413         16  CF-MP-RECON-USE-IND            PIC X(1).
  2414             88  CF-MP-USE-RECON             VALUE 'Y'.
  2415         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2416             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2417         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2418             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2419             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2420         16  FILLER                         PIC X(1).
  2421         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2422             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2423         16  CF-MORTG-MIB-VERSION           PIC X.
  2424             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2425             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2426             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2427         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2428             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2429                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2430             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2431                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2432             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2433                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2434             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2435                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2436             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2437                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2438             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2439                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2440         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2441         16  FILLER                         PIC X(7).
  2442         16  CF-MORTG-DESTINATION-SYMBOL.
  2443             20  CF-MORTG-MIB-COMM          PIC X(5).
  2444             20  CF-MORTG-MIB-TERM          PIC X(5).
  2445         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2446             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2447         16  FILLER                         PIC X(03).
  2448         16  CF-MP-CHECK-NO-CONTROL.
  2449             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  44
* SOCK03.cbl
  2450                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2451                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2452                                                ' ' LOW-VALUES.
  2453                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2454                                               VALUE '3'.
  2455         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2456         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2457         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2458             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2459                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2460             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2461                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2462             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2463                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2464             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2465                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2466             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2467                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2468             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2469                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2470         16  CF-MORTG-BILLING-AREA.
  2471             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2472                                            PIC X.
  2473         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2474         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2475         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2476         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2477             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2478             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2479         16  FILLER                         PIC X.
  2480         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2481             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2482             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2483         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2484         16  FILLER                         PIC X(8).
  2485         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2486         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2487         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2488         16  CF-ACH-COMPANY-ID.
  2489             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2490                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2491                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2492                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2493             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2494         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2495             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2496         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2497             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2498             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2499         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2500         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2501         16  FILLER                         PIC X(536).
  2502
  2503****************************************************************
  2504*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2505****************************************************************
  2506
  2507     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  45
* SOCK03.cbl
  2508         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2509             20  CF-FEMALE-HEIGHT.
  2510                 24  CF-FEMALE-FT           PIC 99.
  2511                 24  CF-FEMALE-IN           PIC 99.
  2512             20  CF-FEMALE-MIN-WT           PIC 999.
  2513             20  CF-FEMALE-MAX-WT           PIC 999.
  2514         16  FILLER                         PIC X(428).
  2515
  2516     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2517         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2518             20  CF-MALE-HEIGHT.
  2519                 24  CF-MALE-FT             PIC 99.
  2520                 24  CF-MALE-IN             PIC 99.
  2521             20  CF-MALE-MIN-WT             PIC 999.
  2522             20  CF-MALE-MAX-WT             PIC 999.
  2523         16  FILLER                         PIC X(428).
  2524******************************************************************
  2525*             AUTOMATIC ACTIVITY RECORD                          *
  2526******************************************************************
  2527     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2528         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2529             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2530             20  CF-SYS-LETTER-ID           PIC X(04).
  2531             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2532             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2533             20  CF-SYS-RESET-SW            PIC X(01).
  2534             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2535             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2536
  2537         16  FILLER                         PIC X(50).
  2538
  2539         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2540             20  CF-USER-ACTIVE-SW          PIC X(01).
  2541             20  CF-USER-LETTER-ID          PIC X(04).
  2542             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2543             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2544             20  CF-USER-RESET-SW           PIC X(01).
  2545             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2546             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2547             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2548
  2549         16  FILLER                         PIC X(246).
  2550*                                 COPY ERCACCT.
  2551******************************************************************
  2552*                                                                *
  2553*                                                                *
  2554*                            ERCACCT                             *
  2555*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2556*                            VMOD=2.031                          *
  2557*                                                                *
  2558*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2559*                                                                *
  2560*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2561*   VSAM ACCOUNT MASTER FILES.                                   *
  2562*                                                                *
  2563*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2564*                                                                *
  2565*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  46
* SOCK03.cbl
  2566*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2567*                                                                *
  2568*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2569*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2570*                                                                *
  2571*   LOG = NO                                                     *
  2572*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2573*                                                                *
  2574*                                                                *
  2575******************************************************************
  2576*                   C H A N G E   L O G
  2577*
  2578* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2579*-----------------------------------------------------------------
  2580*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2581* EFFECTIVE    NUMBER
  2582*-----------------------------------------------------------------
  2583* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2584* 092705    2005050300006  PEMA  ADD SPP LEASES
  2585* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2586* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2587* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2588* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2589* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2590******************************************************************
  2591
  2592 01  ACCOUNT-MASTER.
  2593     12  AM-RECORD-ID                      PIC XX.
  2594         88  VALID-AM-ID                      VALUE 'AM'.
  2595
  2596     12  AM-CONTROL-PRIMARY.
  2597         16  AM-COMPANY-CD                 PIC X.
  2598         16  AM-MSTR-CNTRL.
  2599             20  AM-CONTROL-A.
  2600                 24  AM-CARRIER            PIC X.
  2601                 24  AM-GROUPING.
  2602                     28 AM-GROUPING-PREFIX PIC XXX.
  2603                     28 AM-GROUPING-PRIME  PIC XXX.
  2604                 24  AM-STATE              PIC XX.
  2605                 24  AM-ACCOUNT.
  2606                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2607                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2608             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2609                                           PIC X(19).
  2610             20  AM-CNTRL-B.
  2611                 24  AM-EXPIRATION-DT      PIC XX.
  2612                 24  FILLER                PIC X(4).
  2613             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2614                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2615
  2616     12  AM-CONTROL-BY-VAR-GRP.
  2617         16  AM-COMPANY-CD-A1              PIC X.
  2618         16  AM-VG-CARRIER                 PIC X.
  2619         16  AM-VG-GROUPING                PIC X(6).
  2620         16  AM-VG-STATE                   PIC XX.
  2621         16  AM-VG-ACCOUNT                 PIC X(10).
  2622         16  AM-VG-DATE.
  2623             20  AM-VG-EXPIRATION-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  47
* SOCK03.cbl
  2624             20  FILLER                    PIC X(4).
  2625         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2626                                           PIC 9(11)      COMP-3.
  2627     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2628         16  FILLER                        PIC X(10).
  2629         16  AM-VG-KEY3.
  2630             20  AM-VG3-ACCOUNT            PIC X(10).
  2631             20  AM-VG3-EXP-DT             PIC XX.
  2632         16  FILLER                        PIC X(4).
  2633     12  AM-MAINT-INFORMATION.
  2634         16  AM-LAST-MAINT-DT              PIC XX.
  2635         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2636         16  AM-LAST-MAINT-USER            PIC X(4).
  2637         16  FILLER                        PIC XX.
  2638
  2639     12  AM-EFFECTIVE-DT                   PIC XX.
  2640     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2641
  2642     12  AM-PREV-DATES  COMP-3.
  2643         16  AM-PREV-EXP-DT                PIC 9(11).
  2644         16  AM-PREV-EFF-DT                PIC 9(11).
  2645
  2646     12  AM-REPORT-CODE-1                  PIC X(10).
  2647     12  AM-REPORT-CODE-2                  PIC X(10).
  2648
  2649     12  AM-CITY-CODE                      PIC X(4).
  2650     12  AM-COUNTY-PARISH                  PIC X(6).
  2651
  2652     12  AM-NAME                           PIC X(30).
  2653     12  AM-PERSON                         PIC X(30).
  2654     12  AM-ADDRS                          PIC X(30).
  2655     12  AM-CITY.
  2656         16  AM-ADDR-CITY                  PIC X(28).
  2657         16  AM-ADDR-STATE                 PIC XX.
  2658     12  AM-ZIP.
  2659         16  AM-ZIP-PRIME.
  2660             20  AM-ZIP-PRI-1ST            PIC X.
  2661                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2662             20  FILLER                    PIC X(4).
  2663         16  AM-ZIP-PLUS4                  PIC X(4).
  2664     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2665         16  AM-CAN-POSTAL-1               PIC XXX.
  2666         16  AM-CAN-POSTAL-2               PIC XXX.
  2667         16  FILLER                        PIC XXX.
  2668     12  AM-TEL-NO.
  2669         16  AM-AREA-CODE                  PIC 999.
  2670         16  AM-TEL-PRE                    PIC 999.
  2671         16  AM-TEL-NBR                    PIC 9(4).
  2672     12  AM-TEL-LOC                        PIC X.
  2673         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2674         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2675
  2676     12  AM-COMM-STRUCTURE.
  2677         16  AM-DEFN-1.
  2678             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2679                 24  AM-AGT.
  2680                     28  AM-AGT-PREFIX     PIC X(4).
  2681                     28  AM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  48
* SOCK03.cbl
  2682                 24  AM-COM-TYP            PIC X.
  2683                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2684                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2685                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2686                 24  AM-RECALC-LV-INDIC    PIC X.
  2687                 24  AM-RETRO-LV-INDIC     PIC X.
  2688                 24  AM-GL-CODES           PIC X.
  2689                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2690                 24  FILLER                PIC X(01).
  2691         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2692             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2693                 24  FILLER                PIC X(11).
  2694                 24  AM-L-COMA             PIC XXX.
  2695                 24  AM-J-COMA             PIC XXX.
  2696                 24  AM-A-COMA             PIC XXX.
  2697                 24  FILLER                PIC X(6).
  2698
  2699     12  AM-COMM-CHANGE-STATUS             PIC X.
  2700         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2701
  2702     12  AM-CSR-CODE                       PIC X(4).
  2703
  2704     12  AM-BILLING-STATUS                 PIC X.
  2705         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2706         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2707     12  AM-AUTO-REFUND-SW                 PIC X.
  2708         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2709         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2710     12  AM-GPCD                           PIC 99.
  2711     12  AM-IG                             PIC X.
  2712         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2713         88  AM-HAS-GROUP                     VALUE '2'.
  2714     12  AM-STATUS                         PIC X.
  2715         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2716         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2717         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2718         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2719         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2720         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2721     12  AM-REMIT-TO                       PIC 99.
  2722     12  AM-ID-NO                          PIC X(11).
  2723
  2724     12  AM-CAL-TABLE                      PIC XX.
  2725     12  AM-LF-DEVIATION                   PIC XXX.
  2726     12  AM-AH-DEVIATION                   PIC XXX.
  2727     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2728     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2729     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2730     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2731     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2732     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2733
  2734     12  AM-USER-FIELDS.
  2735         16  AM-FLD-1                      PIC XX.
  2736         16  AM-FLD-2                      PIC XX.
  2737         16  AM-FLD-3                      PIC XX.
  2738         16  AM-FLD-4                      PIC XX.
  2739         16  AM-FLD-5                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  49
* SOCK03.cbl
  2740
  2741     12  AM-1ST-PROD-DATE.
  2742         16  AM-1ST-PROD-YR                PIC XX.
  2743         16  AM-1ST-PROD-MO                PIC XX.
  2744         16  AM-1ST-PROD-DA                PIC XX.
  2745     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2746     12  AM-CERTS-PURGED-DATE.
  2747         16  AM-PUR-YR                     PIC XX.
  2748         16  AM-PUR-MO                     PIC XX.
  2749         16  AM-PUR-DA                     PIC XX.
  2750     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2751     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2752     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2753     12  AM-INACTIVE-DATE.
  2754         16  AM-INA-MO                     PIC 99.
  2755         16  AM-INA-DA                     PIC 99.
  2756         16  AM-INA-YR                     PIC 99.
  2757     12  AM-AR-HI-CERT-DATE                PIC XX.
  2758
  2759     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2760     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2761
  2762     12  AM-OB-PAYMENT-MODE                PIC X.
  2763         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2764         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2765         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2766         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2767
  2768     12  AM-AH-ONLY-INDICATOR              PIC X.
  2769         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2770         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2771
  2772     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2773
  2774     12  AM-OVER-SHORT.
  2775         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2776         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2777
  2778     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2779     12  AM-DCC-CLP-STATE                  PIC XX.
  2780
  2781     12  AM-RECALC-COMM                    PIC X.
  2782     12  AM-RECALC-REIN                    PIC X.
  2783
  2784     12  AM-REI-TABLE                      PIC XXX.
  2785     12  AM-REI-ET-LF                      PIC X.
  2786     12  AM-REI-ET-AH                      PIC X.
  2787     12  AM-REI-PE-LF                      PIC X.
  2788     12  AM-REI-PE-AH                      PIC X.
  2789     12  AM-REI-PRT-ST                     PIC X.
  2790     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2791     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2792     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2793     12  AM-REI-GROUP-A                    PIC X(6).
  2794     12  AM-REI-MORT                       PIC X(4).
  2795     12  AM-REI-PRT-OW                     PIC X.
  2796     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2797     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  50
* SOCK03.cbl
  2798     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2799     12  AM-REI-GROUP-B                    PIC X(6).
  2800
  2801     12  AM-TRUST-TYPE                     PIC X(2).
  2802
  2803     12  AM-EMPLOYER-STMT-USED             PIC X.
  2804     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2805
  2806     12  AM-STD-AH-TYPE                    PIC XX.
  2807     12  AM-EARN-METHODS.
  2808         16  AM-EARN-METHOD-R              PIC X.
  2809             88 AM-REF-RL-R78                 VALUE 'R'.
  2810             88 AM-REF-RL-PR                  VALUE 'P'.
  2811             88 AM-REF-RL-MEAN                VALUE 'M'.
  2812             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2813         16  AM-EARN-METHOD-L              PIC X.
  2814             88 AM-REF-LL-R78                 VALUE 'R'.
  2815             88 AM-REF-LL-PR                  VALUE 'P'.
  2816             88 AM-REF-LL-MEAN                VALUE 'M'.
  2817             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2818         16  AM-EARN-METHOD-A              PIC X.
  2819             88 AM-REF-AH-R78                 VALUE 'R'.
  2820             88 AM-REF-AH-PR                  VALUE 'P'.
  2821             88 AM-REF-AH-MEAN                VALUE 'M'.
  2822             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2823             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2824             88 AM-REF-AH-NET                 VALUE 'N'.
  2825
  2826     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2827     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2828     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2829
  2830     12  AM-RET-Y-N                        PIC X.
  2831     12  AM-RET-P-E                        PIC X.
  2832     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2833     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2834     12  AM-RET-GRP                        PIC X(6).
  2835     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2836         16  AM-POOL-PRIME                 PIC XXX.
  2837         16  AM-POOL-SUB                   PIC XXX.
  2838     12  AM-RETRO-EARNINGS.
  2839         16  AM-RET-EARN-R                 PIC X.
  2840         16  AM-RET-EARN-L                 PIC X.
  2841         16  AM-RET-EARN-A                 PIC X.
  2842     12  AM-RET-ST-TAX-USE                 PIC X.
  2843         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2844         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2845     12  AM-RETRO-BEG-EARNINGS.
  2846         16  AM-RET-BEG-EARN-R             PIC X.
  2847         16  AM-RET-BEG-EARN-L             PIC X.
  2848         16  AM-RET-BEG-EARN-A             PIC X.
  2849     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2850     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2851
  2852     12  AM-USER-SELECT-OPTIONS.
  2853         16  AM-USER-SELECT-1              PIC X(10).
  2854         16  AM-USER-SELECT-2              PIC X(10).
  2855         16  AM-USER-SELECT-3              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  51
* SOCK03.cbl
  2856         16  AM-USER-SELECT-4              PIC X(10).
  2857         16  AM-USER-SELECT-5              PIC X(10).
  2858
  2859     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2860
  2861     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2862
  2863     12  AM-RPT045A-SWITCH                 PIC X.
  2864         88  RPT045A-OFF                   VALUE 'N'.
  2865
  2866     12  AM-INSURANCE-LIMITS.
  2867         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2868         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2869
  2870     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2871         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2872
  2873     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2874         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2875         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2876
  2877     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2878
  2879     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2880     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2881     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2882     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2883     12  AM-DCC-UEF-STATE                  PIC XX.
  2884     12  FILLER                            PIC XXX.
  2885     12  AM-REPORT-CODE-3                  PIC X(10).
  2886*    12  FILLER                            PIC X(22).
  2887
  2888     12  AM-RESERVE-DATE.
  2889         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2890         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2891         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2892
  2893     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2894     12  AM-NOTIFICATION-TYPES.
  2895         16  AM-NOTIF-OF-LETTERS           PIC X.
  2896         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2897         16  AM-NOTIF-OF-REPORTS           PIC X.
  2898         16  AM-NOTIF-OF-STATUS            PIC X.
  2899
  2900     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2901         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2902         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2903         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2904         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2905
  2906     12  AM-BENEFIT-CONTROLS.
  2907         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2908             20  AM-BENEFIT-CODE           PIC XX.
  2909             20  AM-BENEFIT-TYPE           PIC X.
  2910             20  AM-BENEFIT-REVISION       PIC XXX.
  2911             20  AM-BENEFIT-REM-TERM       PIC X.
  2912             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2913             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  52
* SOCK03.cbl
  2914         16  FILLER                        PIC X(80).
  2915
  2916     12  AM-TRANSFER-DATA.
  2917         16  AM-TRANSFERRED-FROM.
  2918             20  AM-TRNFROM-CARRIER        PIC X.
  2919             20  AM-TRNFROM-GROUPING.
  2920                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2921                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2922             20  AM-TRNFROM-STATE          PIC XX.
  2923             20  AM-TRNFROM-ACCOUNT.
  2924                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2925                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2926             20  AM-TRNFROM-DTE            PIC XX.
  2927         16  AM-TRANSFERRED-TO.
  2928             20  AM-TRNTO-CARRIER          PIC X.
  2929             20  AM-TRNTO-GROUPING.
  2930                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2931                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2932             20  AM-TRNTO-STATE            PIC XX.
  2933             20  AM-TRNTO-ACCOUNT.
  2934                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2935                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2936             20  AM-TRNTO-DTE              PIC XX.
  2937         16  FILLER                        PIC X(10).
  2938
  2939     12  AM-SAVED-REMIT-TO                 PIC 99.
  2940
  2941     12  AM-COMM-STRUCTURE-SAVED.
  2942         16  AM-DEFN-1-SAVED.
  2943             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2944                 24  AM-AGT-SV             PIC X(10).
  2945                 24  AM-COM-TYP-SV         PIC X.
  2946                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2947                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2948                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2949                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2950                 24  FILLER                PIC X.
  2951                 24  AM-GL-CODES-SV        PIC X.
  2952                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2953                 24  FILLER                PIC X.
  2954         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2955             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2956                 24  FILLER                PIC X(11).
  2957                 24  AM-L-COMA-SV          PIC XXX.
  2958                 24  AM-J-COMA-SV          PIC XXX.
  2959                 24  AM-A-COMA-SV          PIC XXX.
  2960                 24  FILLER                PIC X(6).
  2961
  2962     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2963         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2964            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2965            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2966            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2967
  2968     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2969     12  FILLER                            PIC X(120).
  2970
  2971     12  AM-ACCOUNT-EXECUTIVE-DATA.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  53
* SOCK03.cbl
  2972         16  AM-CONTROL-NAME               PIC X(30).
  2973         16  AM-EXECUTIVE-ONE.
  2974             20  AM-EXEC1-NAME             PIC X(15).
  2975             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2976                                                          COMP-3.
  2977             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2978                                                          COMP-3.
  2979         16  AM-EXECUTIVE-TWO.
  2980             20  AM-EXEC2-NAME             PIC X(15).
  2981             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2982                                                          COMP-3.
  2983             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2984                                                          COMP-3.
  2985
  2986     12  AM-RETRO-ADDITIONAL-DATA.
  2987         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2988         16  AM-RETRO-PREM-P-E             PIC X.
  2989         16  AM-RETRO-CLMS-P-I             PIC X.
  2990         16  AM-RETRO-RET-BRACKET-LF.
  2991             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2992                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2993                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2994             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2995                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2996                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2997             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2998                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2999                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3000         16  AM-RETRO-RET-BRACKET-AH.
  3001             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3002                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3003                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3004                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3005             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3006                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3007                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3008             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3009                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3010                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3011
  3012     12  AM-COMMENTS.
  3013         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3014
  3015     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3016         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3017         16  AM-FLI-BILLING-CODE           PIC X.
  3018         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3019         16  AM-FLI-UNITED-IDENT           PIC X.
  3020         16  AM-FLI-INTEREST-LOST-DATA.
  3021             20  AM-FLI-BANK-NO            PIC X(5).
  3022             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3023             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3024             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3025         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3026             20  AM-FLI-AGT                PIC X(9).
  3027             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3028             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3029         16  FILLER                        PIC X(102).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  54
* SOCK03.cbl
  3030
  3031     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3032         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3033             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3034             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3035             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3036             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3037             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3038         16  FILLER                          PIC X(10).
  3039******************************************************************
  3040*                                 COPY ELCDATE.
  3041******************************************************************
  3042*                                                                *
  3043*                                                                *
  3044*                            ELCDATE.                            *
  3045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3046*                            VMOD=2.003
  3047*                                                                *
  3048*                                                                *
  3049*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3050*                 LENGTH = 200                                   *
  3051******************************************************************
  3052
  3053 01  DATE-CONVERSION-DATA.
  3054     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3055     12  DC-OPTION-CODE                PIC X.
  3056         88  BIN-TO-GREG                VALUE ' '.
  3057         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3058         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3059         88  YMD-GREG-TO-BIN            VALUE '3'.
  3060         88  MDY-GREG-TO-BIN            VALUE '4'.
  3061         88  JULIAN-TO-BIN              VALUE '5'.
  3062         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3063         88  FIND-CENTURY               VALUE '7'.
  3064         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3065         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3066         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3067         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3068         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3069         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3070         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3071         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3072         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3073         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3074         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3075         88  BIN-3-TO-GREG              VALUE 'I'.
  3076         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3077         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3078         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3079         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3080         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3081         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3082         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3083         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3084         88  THREE-CHARACTER-BIN
  3085                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3086         88  GREGORIAN-TO-BIN
  3087                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  55
* SOCK03.cbl
  3088         88  BIN-TO-GREGORIAN
  3089                  VALUES ' ' '1' 'I' '8' 'G'.
  3090         88  JULIAN-TO-BINARY
  3091                  VALUES '5' 'C' 'E' 'F'.
  3092     12  DC-ERROR-CODE                 PIC X.
  3093         88  NO-CONVERSION-ERROR        VALUE ' '.
  3094         88  DATE-CONVERSION-ERROR
  3095                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3096         88  DATE-IS-ZERO               VALUE '1'.
  3097         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3098         88  DATE-IS-INVALID            VALUE '3'.
  3099         88  DATE1-GREATER-DATE2        VALUE '4'.
  3100         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3101         88  DATE-INVALID-OPTION        VALUE '9'.
  3102         88  INVALID-CENTURY            VALUE 'A'.
  3103         88  ONLY-CENTURY               VALUE 'B'.
  3104         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3105         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3106     12  DC-END-OF-MONTH               PIC X.
  3107         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3108     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3109         88  USE-NORMAL-PROCESS         VALUE ' '.
  3110         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3111         88  ADJUST-UP-100-YRS          VALUE '2'.
  3112     12  FILLER                        PIC X.
  3113     12  DC-CONVERSION-DATES.
  3114         16  DC-BIN-DATE-1             PIC XX.
  3115         16  DC-BIN-DATE-2             PIC XX.
  3116         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3117         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3118                       DC-GREG-DATE-1-EDIT.
  3119             20  DC-EDIT1-MONTH        PIC 99.
  3120             20  SLASH1-1              PIC X.
  3121             20  DC-EDIT1-DAY          PIC 99.
  3122             20  SLASH1-2              PIC X.
  3123             20  DC-EDIT1-YEAR         PIC 99.
  3124         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3125         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3126                     DC-GREG-DATE-2-EDIT.
  3127             20  DC-EDIT2-MONTH        PIC 99.
  3128             20  SLASH2-1              PIC X.
  3129             20  DC-EDIT2-DAY          PIC 99.
  3130             20  SLASH2-2              PIC X.
  3131             20  DC-EDIT2-YEAR         PIC 99.
  3132         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3133         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3134                     DC-GREG-DATE-1-YMD.
  3135             20  DC-YMD-YEAR           PIC 99.
  3136             20  DC-YMD-MONTH          PIC 99.
  3137             20  DC-YMD-DAY            PIC 99.
  3138         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3139         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3140                      DC-GREG-DATE-1-MDY.
  3141             20  DC-MDY-MONTH          PIC 99.
  3142             20  DC-MDY-DAY            PIC 99.
  3143             20  DC-MDY-YEAR           PIC 99.
  3144         16  DC-GREG-DATE-1-ALPHA.
  3145             20  DC-ALPHA-MONTH        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  56
* SOCK03.cbl
  3146             20  DC-ALPHA-DAY          PIC 99.
  3147             20  FILLER                PIC XX.
  3148             20  DC-ALPHA-CENTURY.
  3149                 24 DC-ALPHA-CEN-N     PIC 99.
  3150             20  DC-ALPHA-YEAR         PIC 99.
  3151         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3152         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3153         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3154         16  DC-JULIAN-DATE            PIC 9(05).
  3155         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3156                                       PIC 9(05).
  3157         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3158             20  DC-JULIAN-YEAR        PIC 99.
  3159             20  DC-JULIAN-DAYS        PIC 999.
  3160         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3161         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3162         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3163     12  DATE-CONVERSION-VARIBLES.
  3164         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3165         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3166             20  FILLER                PIC 9(3).
  3167             20  HOLD-CEN-1-CCYY.
  3168                 24  HOLD-CEN-1-CC     PIC 99.
  3169                 24  HOLD-CEN-1-YY     PIC 99.
  3170             20  HOLD-CEN-1-MO         PIC 99.
  3171             20  HOLD-CEN-1-DA         PIC 99.
  3172         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3173             20  HOLD-CEN-1-R-MO       PIC 99.
  3174             20  HOLD-CEN-1-R-DA       PIC 99.
  3175             20  HOLD-CEN-1-R-CCYY.
  3176                 24  HOLD-CEN-1-R-CC   PIC 99.
  3177                 24  HOLD-CEN-1-R-YY   PIC 99.
  3178             20  FILLER                PIC 9(3).
  3179         16  HOLD-CENTURY-1-X.
  3180             20  FILLER                PIC X(3)  VALUE SPACES.
  3181             20  HOLD-CEN-1-X-CCYY.
  3182                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3183                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3184             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3185             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3186         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3187             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3188             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3189             20  HOLD-CEN-1-R-X-CCYY.
  3190                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3191                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3192             20  FILLER                PIC XXX.
  3193         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3194         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3195         16  DC-JULIAN-DATE-1          PIC 9(07).
  3196         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3197             20  DC-JULIAN-1-CCYY.
  3198                 24  DC-JULIAN-1-CC    PIC 99.
  3199                 24  DC-JULIAN-1-YR    PIC 99.
  3200             20  DC-JULIAN-DA-1        PIC 999.
  3201         16  DC-JULIAN-DATE-2          PIC 9(07).
  3202         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3203             20  DC-JULIAN-2-CCYY.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  57
* SOCK03.cbl
  3204                 24  DC-JULIAN-2-CC    PIC 99.
  3205                 24  DC-JULIAN-2-YR    PIC 99.
  3206             20  DC-JULIAN-DA-2        PIC 999.
  3207         16  DC-GREG-DATE-A-EDIT.
  3208             20  DC-EDITA-MONTH        PIC 99.
  3209             20  SLASHA-1              PIC X VALUE '/'.
  3210             20  DC-EDITA-DAY          PIC 99.
  3211             20  SLASHA-2              PIC X VALUE '/'.
  3212             20  DC-EDITA-CCYY.
  3213                 24  DC-EDITA-CENT     PIC 99.
  3214                 24  DC-EDITA-YEAR     PIC 99.
  3215         16  DC-GREG-DATE-B-EDIT.
  3216             20  DC-EDITB-MONTH        PIC 99.
  3217             20  SLASHB-1              PIC X VALUE '/'.
  3218             20  DC-EDITB-DAY          PIC 99.
  3219             20  SLASHB-2              PIC X VALUE '/'.
  3220             20  DC-EDITB-CCYY.
  3221                 24  DC-EDITB-CENT     PIC 99.
  3222                 24  DC-EDITB-YEAR     PIC 99.
  3223         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3224         16  DC-GREG-DATE-CYMD-R REDEFINES
  3225                              DC-GREG-DATE-CYMD.
  3226             20  DC-CYMD-CEN           PIC 99.
  3227             20  DC-CYMD-YEAR          PIC 99.
  3228             20  DC-CYMD-MONTH         PIC 99.
  3229             20  DC-CYMD-DAY           PIC 99.
  3230         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3231         16  DC-GREG-DATE-MDCY-R REDEFINES
  3232                              DC-GREG-DATE-MDCY.
  3233             20  DC-MDCY-MONTH         PIC 99.
  3234             20  DC-MDCY-DAY           PIC 99.
  3235             20  DC-MDCY-CEN           PIC 99.
  3236             20  DC-MDCY-YEAR          PIC 99.
  3237    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3238        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3239    12  DC-EL310-DATE                  PIC X(21).
  3240    12  FILLER                         PIC X(28).
  3241*                                 COPY ELCCALC.
  3242******************************************************************
  3243*                                                                *
  3244*                           ELCCALC.                            *
  3245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3246*                            VMOD=2.025                          *
  3247*                                                                *
  3248*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3249*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3250*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3251*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3252*                                                                *
  3253*  PASSED TO ELRTRM                                              *
  3254*  -----------------                                             *
  3255*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3256*  ORIGINAL TERM                                                 *
  3257*  BEGINNING DATE                                                *
  3258*  ENDING DATE                                                   *
  3259*  COMPANY I.D.                                                  *
  3260*  ACCOUNT MASTER USER FIELD                                     *
  3261*  PROCESS SWITCH (CANCEL, CLAIM)                                *
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  58
* SOCK03.cbl
  3262*  FREE LOOK DAYS                                                *
  3263*                                                                *
  3264*  RETURNED FROM ELRTRM                                          *
  3265*  ---------------------                                         *
  3266*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3267*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3268*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3269*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3270*----------------------------------------------------------------*
  3271*  PASSED TO ELRAMT                                              *
  3272*  ----------------                                              *
  3273*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3274*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3275*  ORIGINAL AMOUNT                                               *
  3276*  ALTERNATE BENEFIT (BALLON)                                    *
  3277*  A.P.R. - NET PAY ONLY                                         *
  3278*  METHOD
  3279*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3280*  COMPANY I.D.                                                  *
  3281*  BENEFIT TYPE                                                  *
  3282*                                                                *
  3283*  RETURNED FROM ELRAMT                                          *
  3284*  --------------------                                          *
  3285*  REMAINING AMOUNT 1 - CURRENT                                  *
  3286*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3287*  REMAINING AMOUNT FACTOR
  3288*----------------------------------------------------------------*
  3289*  PASSED TO ELRESV                                              *
  3290*  -----------------                                             *
  3291*  CERTIFICATE EFFECTIVE DATE                                    *
  3292*  VALUATION DATE                                                *
  3293*  PAID THRU DATE                                                *
  3294*  BENEFIT                                                       *
  3295*  INCURRED DATE                                                 *
  3296*  REPORTED DATE                                                 *
  3297*  ISSUE AGE                                                     *
  3298*  TERM                                                          *
  3299*  CDT PERCENT                                                   *
  3300*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3301* *CLAIM TYPE (LIFE, A/H)                                        *
  3302* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3303* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3304*                                                                *
  3305*  RETURNED FROM ELRESV                                          *
  3306*  --------------------                                          *
  3307*  CDT TABLE USED                                                *
  3308*  CDT FACTOR USED                                               *
  3309*  PAY TO CURRENT RESERVE                                        *
  3310*  I.B.N.R. - A/H ONLY                                           *
  3311*  FUTURE (ACCRUED) AH ONLY                                      *
  3312*----------------------------------------------------------------*
  3313*  PASSED TO ELRATE                                              *
  3314*  ----------------                                              *
  3315*  CERT ISSUE DATE                                               *
  3316*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3317*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3318*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3319*  STATE CODE (CLIENT DEFINED)                                   *
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  59
* SOCK03.cbl
  3320*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3321*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3322*  DEVIATION CODE                                                *
  3323*  ISSUE AGE                                                     *
  3324*  ORIGINAL BENEFIT AMOUNT                                       *
  3325*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3326*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3327*  BENEFIT KIND (LIFE OR A/H)                                    *
  3328*  A.P.R.                                                        *
  3329*  METHOD
  3330*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3331*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3332*  COMPANY I.D. (3 CHARACTER)                                    *
  3333*  BENEFIT CODE                                                  *
  3334*  BENEFIT OVERRIDE CODE                                         *
  3335*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3336*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3337*  JOINT INDICATOR (CSL ONLY)                                    *
  3338*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3339*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3340*                                                                *
  3341*  RETURNED FROM ELRATE                                          *
  3342*  --------------------                                          *
  3343*  CALCULATED PREMIUM                                            *
  3344*  PREMIUM RATE                                                  *
  3345*  MORTALITY CODE                                                *
  3346*  MAX ATTAINED AGE                                              *
  3347*  MAX AGE                                                       *
  3348*  MAX TERM                                                      *
  3349*  MAX MONTHLY BENEFIT                                           *
  3350*  MAX TOTAL BENIFIT                                             *
  3351*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3352*----------------------------------------------------------------*
  3353*  PASSED TO ELRFND                                              *
  3354*  ----------------                                              *
  3355*  CERT ISSUE DATE                                               *
  3356*  REFUND DATE                                                   *
  3357*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3358*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3359*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3360*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3361*  STATE CODE (CLIENT DEFINED)                                   *
  3362*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3363*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3364*  DEVIATION CODE                                                *
  3365*  ISSUE AGE                                                     *
  3366*  ORIGINAL BENEFIT AMOUNT                                       *
  3367*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3368*  PROCESS TYPE (CANCEL)                                         *
  3369*  BENEFIT KIND (LIFE OR A/H)                                    *
  3370*  A.P.R.                                                        *
  3371*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3372*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3373*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3374*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3375*  COMPANY I.D. (3 CHARACTER)                                    *
  3376*  BENEFIT CODE                                                  *
  3377*  BENEFIT OVERRIDE CODE                                         *
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  60
* SOCK03.cbl
  3378*                                                                *
  3379*  RETURNED FROM ELRFND                                          *
  3380*  --------------------                                          *
  3381*  CALCULATED REFUND                                             *
  3382*----------------------------------------------------------------*
  3383*  PASSED TO ELEARN                                              *
  3384*  ----------------                                              *
  3385*  CERT ISSUE DATE                                               *
  3386*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3387*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3388*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3389*  STATE CODE (CLIENT DEFINED)                                   *
  3390*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3391*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3392*  DEVIATION CODE                                                *
  3393*  ISSUE AGE                                                     *
  3394*  ORIGINAL BENEFIT AMOUNT                                       *
  3395*  BENEFIT KIND (LIFE OR A/H)                                    *
  3396*  A.P.R.                                                        *
  3397*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3398*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3399*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3400*  COMPANY I.D. (3 CHARACTER)                                    *
  3401*  BENEFIT CODE                                                  *
  3402*  BENEFIT OVERRIDE CODE                                         *
  3403*                                                                *
  3404*  RETURNED FROM ELEARN                                          *
  3405*  --------------------                                          *
  3406*  INDICATED  EARNINGS                                           *
  3407*----------------------------------------------------------------*
  3408*                 LENGTH = 450                                   *
  3409*                                                                *
  3410******************************************************************
  3411******************************************************************
  3412*                   C H A N G E   L O G
  3413*
  3414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3415*-----------------------------------------------------------------
  3416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3417* EFFECTIVE    NUMBER
  3418*-----------------------------------------------------------------
  3419* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3420* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3421* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3422* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3423* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3424* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3425* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3426* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3427* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3428******************************************************************
  3429
  3430 01  CALCULATION-PASS-AREA.
  3431     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3432                                     COMP.
  3433
  3434     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3435       88  NO-CP-ERROR                             VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  61
* SOCK03.cbl
  3436       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3437                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3438       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3439       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3440       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3441       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3442       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3443       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3444       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3445       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3446       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3447       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3448       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3449       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3450       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3451       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3452       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3453       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3454       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3455
  3456     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3457       88  NO-CP-ERROR-2                           VALUE ZERO.
  3458***********************  INPUT AREAS ****************************
  3459
  3460     12  CP-CALCULATION-AREA.
  3461         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3462         16  CP-CERT-EFF-DT        PIC XX.
  3463         16  CP-VALUATION-DT       PIC XX.
  3464         16  CP-PAID-THRU-DT       PIC XX.
  3465         16  CP-BENEFIT-TYPE       PIC X.
  3466           88  CP-AH                               VALUE 'A' 'D'
  3467                                                   'I' 'U'.
  3468           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3469           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3470         16  CP-INCURRED-DT        PIC XX.
  3471         16  CP-REPORTED-DT        PIC XX.
  3472         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3473         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3474         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-CDT-METHOD         PIC X.
  3479           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3480           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3481           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3482         16  CP-CLAIM-TYPE         PIC X.
  3483           88  CP-AH-CLAIM                         VALUE 'A'.
  3484           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3485         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3486                                     COMP-3.
  3487         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3488                                     COMP-3.
  3489         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3490                                     COMP-3.
  3491         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  62
* SOCK03.cbl
  3494                                     COMP-3.
  3495         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-REM-TERM-METHOD    PIC X.
  3500           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3501           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3502           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3503           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3504           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3505           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3506           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3507         16  CP-EARNING-METHOD     PIC X.
  3508           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3509           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3510           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3511           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3512           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3513           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3514           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3515           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3516           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3517           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3518           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3519           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3520           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3521           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3522         16  CP-PROCESS-TYPE       PIC X.
  3523           88  CP-CLAIM                            VALUE '1'.
  3524           88  CP-CANCEL                           VALUE '2'.
  3525           88  CP-ISSUE                            VALUE '3'.
  3526         16  CP-SPECIAL-CALC-CD    PIC X.
  3527           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3528           88  CP-1-MTH-INTEREST               VALUE ' '.
  3529           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3530           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3531           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3532           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3533           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3534           88  CP-FARM-PLAN                    VALUE 'F'.
  3535           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3536           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3537           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3538           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3539           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3540           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3541           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3542           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3543           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3544           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3545                                                     'W' 'X'.
  3546           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3547           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3548           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3549           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3550           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3551           88  CP-SUMMARY-REC                  VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  63
* SOCK03.cbl
  3552           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3553           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3554           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3555           88  CP-CSL-METH-1                   VALUE '5'.
  3556           88  CP-CSL-METH-2                   VALUE '6'.
  3557           88  CP-CSL-METH-3                   VALUE '7'.
  3558           88  CP-CSL-METH-4                   VALUE '8'.
  3559
  3560         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3563         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3564         16  CP-STATE              PIC XX          VALUE SPACE.
  3565         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3566         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3567           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3568               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3569         16  CP-R78-OPTION         PIC X.
  3570           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3571           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3572
  3573         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3574         16  CP-IBNR-RESERVE-SW    PIC X.
  3575         16  CP-CLAIM-STATUS       PIC X.
  3576         16  CP-RATE-FILE          PIC X.
  3577         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3578                                     COMP-3.
  3579
  3580         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3581         16  CP-AH-OVERRIDE-CODE   PIC X.
  3582
  3583         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3586                                   PIC S9(5)V99 COMP-3.
  3587         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3594                                  PIC S9(7)V99 COMP-3.
  3595
  3596         16  CP-PAID-FROM-DATE     PIC X(02).
  3597         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3598         16  CP-EXT-DAYS-CALC      PIC X.
  3599           88  CP-EXT-NO-CHG                   VALUE ' '.
  3600           88  CP-EXT-CHG-LF                   VALUE '1'.
  3601           88  CP-EXT-CHG-AH                   VALUE '2'.
  3602           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3603         16  CP-DOMICILE-STATE     PIC XX.
  3604         16  CP-CARRIER            PIC X.
  3605         16  CP-REIN-FLAG          PIC X.
  3606         16  CP-REM-TRM-CALC-OPTION PIC X.
  3607           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3608                      '2' '3' '4' '5'.
  3609           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  64
* SOCK03.cbl
  3610           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3611           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3612           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3613           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3614           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3615           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3616           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3617         16  CP-SIG-SWITCH         PIC X.
  3618         16  CP-RATING-METHOD      PIC X.
  3619           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3620           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3621           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3622           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3623           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3624           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3625           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3626           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3627           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3628         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3629                                     COMP-3.
  3630         16  CP-BEN-CATEGORY       PIC X.
  3631         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3632         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3633                                   PIC S99V9(5) COMP-3.
  3634         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3635         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3636                                   PIC S99V9(5) COMP-3.
  3637         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3638         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3639         16  CP-EXPIRE-DT          PIC XX.
  3640         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3641         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3642         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3643         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3644         16  CP-DDF-SPEC-CALC      PIC X.
  3645             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3646             88  CP-CALC-CLP              VALUE 'C'.
  3647         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3648         16  CP-CANCEL-REASON      PIC X.
  3649         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3650         16  CP-PMT-MODE           PIC X.
  3651         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3652         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3653         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3654         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3655         16  FILLER                PIC X.
  3656
  3657***************    OUTPUT FROM ELRESV   ************************
  3658
  3659         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3660
  3661         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  65
* SOCK03.cbl
  3668                                     COMP-3.
  3669         16  FILLER                PIC X(09).
  3670***************    OUTPUT FROM ELRTRM   *************************
  3671
  3672         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3673                                     COMP-3.
  3674         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3675                                     COMP-3.
  3676         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3677                                     COMP-3.
  3678         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3679                                     COMP-3.
  3680         16  FILLER                PIC X(12).
  3681
  3682***************    OUTPUT FROM ELRAMT   *************************
  3683
  3684         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3687                                     COMP-3.
  3688         16  FILLER                PIC X(12).
  3689
  3690***************    OUTPUT FROM ELRATE   *************************
  3691
  3692         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-MORTALITY-CODE     PIC X(4).
  3697         16  CP-RATE-EDIT-FLAG     PIC X.
  3698             88  CP-RATES-NEED-APR                  VALUE '1'.
  3699         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3702         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3703         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3704                                   PIC S9(7)V99 COMP-3.
  3705         16  FILLER                PIC X(07).
  3706
  3707***************    OUTPUT FROM ELRFND   *************************
  3708
  3709         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-REFUND-TYPE-USED   PIC X.
  3712           88  CP-R-AS-R78                         VALUE '1'.
  3713           88  CP-R-AS-PRORATA                     VALUE '2'.
  3714           88  CP-R-AS-CALIF                       VALUE '3'.
  3715           88  CP-R-AS-TEXAS                       VALUE '4'.
  3716           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3717           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3718           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3719           88  CP-R-AS-MEAN                        VALUE '8'.
  3720           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3721           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3722           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3723           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3724           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3725           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  66
* SOCK03.cbl
  3726         16  FILLER                PIC X(12).
  3727
  3728***************    OUTPUT FROM ELEARN   *************************
  3729
  3730         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-EARNING-TYPE-USED  PIC X.
  3743           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3744           88  CP-E-AS-R78                         VALUE '1'.
  3745           88  CP-E-AS-PRORATA                     VALUE '2'.
  3746           88  CP-E-AS-TEXAS                       VALUE '4'.
  3747           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3748           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3749           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3750           88  CP-E-AS-MEAN                        VALUE '8'.
  3751           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3752         16  FILLER                PIC X(12).
  3753
  3754***************    OUTPUT FROM ELPMNT   *************************
  3755
  3756         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3759                                     COMP-3.
  3760         16  FILLER                PIC X(12).
  3761
  3762***************   MISC WORK AREAS    *****************************
  3763         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3776             88  OPEN-RATE-FILE                   VALUE 'O'.
  3777             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3778             88  IO-ERROR                         VALUE 'E'.
  3779
  3780         16  CP-FIRST-PAY-DATE     PIC XX.
  3781
  3782         16  CP-JOINT-INDICATOR    PIC X.
  3783
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  67
* SOCK03.cbl
  3784         16  CP-RESERVE-REMAINING-TERM
  3785                                   PIC S9(4)V9    VALUE ZERO
  3786                                     COMP-3.
  3787
  3788         16  CP-INSURED-BIRTH-DT   PIC XX.
  3789
  3790         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3791                                     COMP-3.
  3792
  3793         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3794                                     COMP-3.
  3795
  3796         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3806                                     COMP-3.
  3807
  3808         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3812             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3813
  3814         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3819         16  FILLER                PIC X(15).
  3820******************************************************************
  3821****************************************************************
  3822*
  3823* Copyright (c) 2007 by Clerity Solutions, Inc.
  3824* All rights reserved.
  3825*
  3826****************************************************************
  3827 01  DFHEIV.
  3828   02  DFHEIV0               PIC X(35).
  3829   02  DFHEIV1               PIC X(08).
  3830   02  DFHEIV2               PIC X(08).
  3831   02  DFHEIV3               PIC X(08).
  3832   02  DFHEIV4               PIC X(06).
  3833   02  DFHEIV5               PIC X(04).
  3834   02  DFHEIV6               PIC X(04).
  3835   02  DFHEIV7               PIC X(02).
  3836   02  DFHEIV8               PIC X(02).
  3837   02  DFHEIV9               PIC X(01).
  3838   02  DFHEIV10              PIC S9(7) COMP-3.
  3839   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3840   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3841   02  DFHEIV13              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  68
* SOCK03.cbl
  3842   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3843   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3844   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3845   02  DFHEIV17              PIC X(04).
  3846   02  DFHEIV18              PIC X(04).
  3847   02  DFHEIV19              PIC X(04).
  3848   02  DFHEIV20              USAGE IS POINTER.
  3849   02  DFHEIV21              USAGE IS POINTER.
  3850   02  DFHEIV22              USAGE IS POINTER.
  3851   02  DFHEIV23              USAGE IS POINTER.
  3852   02  DFHEIV24              USAGE IS POINTER.
  3853   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3854   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3855   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3856   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3857   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3858   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3859   02  FILLER                PIC X(02).
  3860   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3861   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3862   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3863   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3864   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3865 LINKAGE  SECTION.
  3866*****************************************************************
  3867*                                                               *
  3868* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3869* All rights reserved.                                          *
  3870*                                                               *
  3871*****************************************************************
  3872 01  dfheiblk.
  3873     02  eibtime          pic s9(7) comp-3.
  3874     02  eibdate          pic s9(7) comp-3.
  3875     02  eibtrnid         pic x(4).
  3876     02  eibtaskn         pic s9(7) comp-3.
  3877     02  eibtrmid         pic x(4).
  3878     02  dfheigdi         pic s9(4) comp.
  3879     02  eibcposn         pic s9(4) comp.
  3880     02  eibcalen         pic s9(4) comp.
  3881     02  eibaid           pic x(1).
  3882     02  eibfiller1       pic x(1).
  3883     02  eibfn            pic x(2).
  3884     02  eibfiller2       pic x(2).
  3885     02  eibrcode         pic x(6).
  3886     02  eibfiller3       pic x(2).
  3887     02  eibds            pic x(8).
  3888     02  eibreqid         pic x(8).
  3889     02  eibrsrce         pic x(8).
  3890     02  eibsync          pic x(1).
  3891     02  eibfree          pic x(1).
  3892     02  eibrecv          pic x(1).
  3893     02  eibsend          pic x(1).
  3894     02  eibatt           pic x(1).
  3895     02  eibeoc           pic x(1).
  3896     02  eibfmh           pic x(1).
  3897     02  eibcompl         pic x(1).
  3898     02  eibsig           pic x(1).
  3899     02  eibconf          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  69
* SOCK03.cbl
  3900     02  eiberr           pic x(1).
  3901     02  eibrldbk         pic x(1).
  3902     02  eiberrcd         pic x(4).
  3903     02  eibsynrb         pic x(1).
  3904     02  eibnodat         pic x(1).
  3905     02  eibfiller5       pic x(2).
  3906     02  eibresp          pic 9(09) comp.
  3907     02  eibresp2         pic 9(09) comp.
  3908     02  dfheigdj         pic s9(4) comp.
  3909     02  dfheigdk         pic s9(4) comp.
  3910 01  DFHCOMMAREA.
  3911   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3912   05 LSTN-NAME                PIC X(8).
  3913   05 LSTN-SUBNAME             PIC X(8).
  3914   05 CLIENT-IN-DATA.
  3915      15  CLIENT-CAR           PIC X.
  3916      15  CLIENT-GRP           PIC X(6).
  3917      15  CLIENT-STATE         PIC XX.
  3918      15  CLIENT-ACCOUNT       PIC X(10).
  3919*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3920      15  CLIENT-EFF-DT        PIC X(8).
  3921      15  CLIENT-CERT-NO       PIC X(11).
  3922      15  CLIENT-LAST-NAME     PIC X(15).
  3923      15  CLIENT-FIRST-NAME    PIC X(10).
  3924      15  CLIENT-VAL-DT        PIC X(8).
  3925      15  CLIENT-CAN-REASON    PIC X.
  3926   05 SOCKADDR-IN-PARM.
  3927     15 SIN-FAMILY             PIC 9(4) COMP.
  3928     15 SIN-PORT               PIC 9(4) COMP.
  3929     15 SIN-ADDRESS            PIC 9(8) COMP.
  3930     15 SIN-ZERO               PIC X(8).
  3931 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3932 0000-DFHEXIT SECTION.
  3933     MOVE '9#                    $   ' TO DFHEIV0.
  3934     MOVE 'SOCK03' TO DFHEIV1.
  3935     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3936     display '  BEGIN SOCK03 '
  3937     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3938     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3939     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3940        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3941        IF CLIENT-IN-DATA (8:3) = 'AHL'
  3942           MOVE X'06'            TO WS-COMP-CD
  3943           MOVE 'AHL'            TO WS-SEND-BUF (5:3)
  3944                                    WS-COMP-ID
  3945        ELSE
  3946           IF CLIENT-IN-DATA (8:3) = 'DCC'
  3947              MOVE X'05'         TO WS-COMP-CD
  3948              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3949                                    WS-COMP-ID
  3950           ELSE
  3951              MOVE X'04'         TO WS-COMP-CD
  3952              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3953                                    WS-COMP-ID
  3954           END-IF
  3955        END-IF
  3956        move 'CSO'               to ws-send-buf (1:3)
  3957        move +25                 to ws-send-msg-size
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  70
* SOCK03.cbl
  3958     END-IF
  3959     display 'SOCK03:sequence number  =', ws-seq-num.
  3960     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3961     call "send" using by value GIVE-TAKE-SOCKET,
  3962         by reference ws-send-buf,
  3963         by value ws-send-msg-size,
  3964         by value ws-flags.
  3965     if return-code <= zero
  3966         display 'SOCK03:send error ',
  3967         go to socket-error.
  3968     move low-values to ws-recv-buf.
  3969     set ws-recv-total to zero.
  3970     compute ws-recv-left = ws-recv-msg-size.
  3971     display 'SOCK03:About to recv '
  3972     call "recv" using by value GIVE-TAKE-SOCKET,
  3973         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3974         by value ws-recv-left,
  3975         by value ws-flags.
  3976     if return-code < zero
  3977        display 'SOCK03:recv error ',
  3978        go to socket-error.
  3979     if return-code = zero
  3980        display 'SOCK03:client disconnected',
  3981        go to socket-error.
  3982*
  3983     display 'SOCK03:Good recv  '
  3984     display 'SOCK03:return code      = ', return-code
  3985     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3986     move +4096                  to ws-send-msg-size
  3987*    move +750                   to ws-send-msg-size
  3988     move ws-recv-buf (1:72)     to client-in-data
  3989     MOVE SPACES                 TO WS-ELCERT-SW
  3990     MOVE X'0A'                  TO WS-HEX-0A
  3991     if client-account = 'EPIQ000001'
  3992        set ws-epiq-request to true
  3993        move spaces              to client-account
  3994     end-if
  3995     move +0 to ws-epiq-max
  3996     EVALUATE TRUE
  3997        WHEN (CLIENT-CAR NOT = SPACES)
  3998           AND (CLIENT-STATE NOT = SPACES)
  3999           AND (CLIENT-ACCOUNT NOT = SPACES)
  4000           AND (CLIENT-EFF-DT NOT = SPACES)
  4001           AND (CLIENT-CERT-NO NOT = SPACES)
  4002           SET WS-ELCERT-FULL    TO TRUE
  4003           DISPLAY ' SETTING FULL '
  4004        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4005           SET WS-ELCERT-CERT-NO TO TRUE
  4006           DISPLAY ' SETTING CERT NO '
  4007*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4008*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4009        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4010           AND (CLIENT-LAST-NAME NOT = SPACES)
  4011           SET WS-ELCERT-ACT-NAME TO TRUE
  4012        WHEN CLIENT-LAST-NAME NOT = SPACES
  4013           SET WS-ELCERT-NAME    TO TRUE
  4014           DISPLAY ' SETTING NAME '
  4015        WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  71
* SOCK03.cbl
  4016           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4017           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4018           MOVE ZEROS            TO WS-RESP
  4019           PERFORM 0030-BUILD-BUFFER
  4020                                 THRU 0030-EXIT
  4021           PERFORM 0020-SEND-BUFFER
  4022                                 THRU 0020-EXIT
  4023           PERFORM 0025-CLOSE-SOCKET
  4024                                 THRU 0025-EXIT
  4025           GO TO 0010-RETURN
  4026     END-EVALUATE
  4027     IF CLIENT-CAN-REASON = 'R'
  4028        MOVE 'R'                 TO WS-CANCEL-REASON
  4029     ELSE
  4030        MOVE ' '                 TO WS-CANCEL-REASON
  4031     END-IF
  4032     IF WS-ELCERT-KEY-SW NOT = SPACES
  4033        PERFORM 0050-BEGIN-REFUND-PROCESS
  4034                                 THRU 0050-EXIT
  4035     END-IF
  4036     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4037     .
  4038 0010-RETURN.
  4039
  4040* exec cics return end-exec.
  4041*    MOVE '.(                    ''   #00004035' TO DFHEIV0
  4042     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4043     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4044     MOVE X'2020233030303034303335' TO DFHEIV0(25:11)
  4045     CALL 'kxdfhei1' USING DFHEIV0,
  4046           DFHEIV99,
  4047           DFHEIV99,
  4048           DFHEIV99,
  4049           DFHEIV99,
  4050           DFHEIV99,
  4051           DFHEIV99
  4052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4053
  4054
  4055* goback.
  4056     MOVE '9%                    "   ' TO DFHEIV0
  4057     MOVE 'SOCK03' TO DFHEIV1
  4058     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4059     goback.
  4060*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4061     .
  4062 0020-SEND-BUFFER.
  4063     display 'SOCK03:About to send      '
  4064     display 'SOCK03:sequence number  =', ws-seq-num.
  4065     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4066     call "send" using by value GIVE-TAKE-SOCKET,
  4067         by reference ws-send-buf,
  4068         by value ws-send-msg-size,
  4069         by value ws-flags.
  4070     if return-code <= zero
  4071         display 'SOCK03:send error ' return-code,
  4072         go to socket-error.
  4073 0020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  72
* SOCK03.cbl
  4074     EXIT.
  4075 0025-CLOSE-SOCKET.
  4076     display 'SOCK03:closing socket'.
  4077     call "close" using by value GIVE-TAKE-SOCKET .
  4078     display 'SOCK03:done'.
  4079     .
  4080 0025-EXIT.
  4081     EXIT.
  4082*
  4083* set up the receive buffer
  4084*
  4085     move low-values to ws-recv-buf.
  4086     set ws-recv-total to zero.
  4087     compute ws-recv-left = ws-recv-msg-size.
  4088*
  4089* receive data
  4090*
  4091 recv-1.
  4092     call "recv" using by value GIVE-TAKE-SOCKET,
  4093         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4094         by value ws-recv-left,
  4095         by value ws-flags.
  4096*
  4097* test what was received and decide what we should do
  4098*
  4099     if return-code < zero
  4100        display 'SOCK03:recv error ',
  4101        go to socket-error.
  4102     if return-code = zero
  4103        display 'SOCK03:client disconnected',
  4104        go to socket-error.
  4105*
  4106* have we received all the data yet?
  4107*
  4108     compute ws-recv-total = ws-recv-total + return-code.
  4109     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4110*
  4111* not yet
  4112*
  4113     if ws-recv-left > 0 go to recv-1.
  4114*
  4115* received all the data
  4116*
  4117     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4118*
  4119* make sure what we received was what we sent
  4120*
  4121*    if ws-recv-buf <> ws-send-buf
  4122*        display "SOCK03:data doesn't match",
  4123*        go to socket-error.
  4124*
  4125* end of pass
  4126*
  4127*loop-end.
  4128*    if ws-seq-num = 5 go to socket-error.
  4129*    go to loop-1.
  4130*
  4131* program end
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  73
* SOCK03.cbl
  4132*
  4133 socket-error.
  4134     if ws-seq-num <> 0
  4135         display "SOCK03:did not complete".
  4136*
  4137* flush the send buffer and deallocate
  4138*
  4139*    display 'SOCK03:closing socket'.
  4140*    call "close" using by value GIVE-TAKE-SOCKET .
  4141*
  4142* finised return to cics
  4143*
  4144 socket-fin.
  4145     display 'SOCK03:closing socket'.
  4146     call "close" using by value GIVE-TAKE-SOCKET .
  4147     display 'SOCK03:done'.
  4148
  4149* exec cics return end-exec.
  4150*    MOVE '.(                    ''   #00004125' TO DFHEIV0
  4151     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4153     MOVE X'2020233030303034313235' TO DFHEIV0(25:11)
  4154     CALL 'kxdfhei1' USING DFHEIV0,
  4155           DFHEIV99,
  4156           DFHEIV99,
  4157           DFHEIV99,
  4158           DFHEIV99,
  4159           DFHEIV99,
  4160           DFHEIV99
  4161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4162
  4163
  4164* goback.
  4165     MOVE '9%                    "   ' TO DFHEIV0
  4166     MOVE 'SOCK03' TO DFHEIV1
  4167     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4168     goback.
  4169 0030-BUILD-BUFFER.
  4170     MOVE SPACES                 TO WS-SEND-BUF
  4171     IF WS-CALL-TYPE = 'NEWBUS'
  4172        STRING
  4173           WS-COMMENT            ';'
  4174           WS-RESP               ';'
  4175           WS-CARRIER            ';'
  4176           WS-GROUPING           ';'
  4177           WS-STATE              ';'
  4178           WS-ACCOUNT            ';'
  4179           WS-CERT-EFF-DATE      ';'
  4180           WS-CERT-NO            ';'
  4181           WS-LAST-NAME          ';'
  4182           WS-FIRST-NAME         ';'
  4183           WS-MID-INIT           ';'
  4184           WS-LAST-JNAME         ';'
  4185           WS-FIRST-JNAME        ';'
  4186           WS-MID-JINIT          ';'
  4187           WS-POST-CARD-SW       ';'
  4188           ws-lf-coverage-type   ';'
  4189           WS-LF-STATUS          ';'
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  74
* SOCK03.cbl
  4190           WS-LF-BEN-CODE        ';'
  4191           WS-LF-BEN-CODE-DESC   ';'
  4192           WS-LF-TERM            ';'
  4193           WS-LF-REM-TERM        ';'
  4194           WS-LF-PREM            ';'
  4195           WS-LF-REFUND          ';'
  4196           WS-LF-METHOD          ';'
  4197           WS-LF-ORIG-BENEFIT    ';'
  4198           WS-LF-REM-BEN         ';'
  4199           WS-LF-EXPIRE-DATE     ';'
  4200           WS-LF-COMM            ';'
  4201           WS-LF-UEC             ';'
  4202           WS-AH-COVERAGE-TYPE   ';'
  4203           WS-AH-STATUS          ';'
  4204           WS-AH-BEN-CODE        ';'
  4205           WS-AH-BEN-CODE-DESC   ';'
  4206           WS-AH-TERM            ';'
  4207           WS-AH-REM-TERM        ';'
  4208           WS-AH-PREM            ';'
  4209           WS-AH-REFUND          ';'
  4210           WS-AH-METHOD          ';'
  4211           WS-AH-ORIG-BENEFIT    ';'
  4212           WS-AH-REM-BEN         ';'
  4213           WS-AH-EXPIRE-DATE     ';'
  4214           WS-AH-COMM            ';'
  4215           WS-AH-UEC             ';'
  4216           WS-ACCOUNT-NAME       ';'
  4217           WS-REPORT-CODE-1      ';'
  4218           WS-REPORT-CODE-2      ';'
  4219           WS-REPORT-CODE-3      ';'
  4220           WS-CLM-PAID-THRU-DT   ';'
  4221           WS-HEX-0A
  4222            DELIMITED BY '  ' INTO WS-SEND-BUF
  4223        END-STRING
  4224     ELSE
  4225        STRING
  4226           WS-COMMENT            ';'
  4227           WS-RESP               ';'
  4228           WS-CARRIER            ';'
  4229           WS-GROUPING           ';'
  4230           WS-STATE              ';'
  4231           WS-ACCOUNT            ';'
  4232           WS-CERT-EFF-DATE      ';'
  4233           WS-CERT-NO            ';'
  4234           WS-LAST-NAME          ';'
  4235           WS-FIRST-NAME         ';'
  4236           WS-MID-INIT           ';'
  4237           WS-LAST-JNAME         ';'
  4238           WS-FIRST-JNAME        ';'
  4239           WS-MID-JINIT          ';'
  4240           WS-POST-CARD-SW       ';'
  4241           WS-LF-STATUS          ';'
  4242           WS-LF-BEN-CODE        ';'
  4243           WS-LF-BEN-CODE-DESC   ';'
  4244           WS-LF-TERM            ';'
  4245           WS-LF-REM-TERM        ';'
  4246           WS-LF-PREM            ';'
  4247           WS-LF-REFUND          ';'
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  75
* SOCK03.cbl
  4248           WS-LF-METHOD          ';'
  4249           WS-LF-ORIG-BENEFIT    ';'
  4250           WS-LF-REM-BEN         ';'
  4251           WS-LF-EXPIRE-DATE     ';'
  4252           WS-LF-COMM            ';'
  4253           WS-LF-UEC             ';'
  4254           WS-AH-STATUS          ';'
  4255           WS-AH-BEN-CODE        ';'
  4256           WS-AH-BEN-CODE-DESC   ';'
  4257           WS-AH-TERM            ';'
  4258           WS-AH-REM-TERM        ';'
  4259           WS-AH-PREM            ';'
  4260           WS-AH-REFUND          ';'
  4261           WS-AH-METHOD          ';'
  4262           WS-AH-ORIG-BENEFIT    ';'
  4263           WS-AH-REM-BEN         ';'
  4264           WS-AH-EXPIRE-DATE     ';'
  4265           WS-AH-COMM            ';'
  4266           WS-AH-UEC             ';'
  4267           WS-ACCOUNT-NAME       ';'
  4268           WS-REPORT-CODE-1      ';'
  4269           WS-REPORT-CODE-2      ';'
  4270           WS-REPORT-CODE-3      ';'
  4271           WS-CLM-PAID-THRU-DT   ';'
  4272           'E'                   ';'
  4273            DELIMITED BY '  ' INTO WS-SEND-BUF
  4274        END-STRING
  4275     END-IF
  4276     .
  4277 0030-EXIT.
  4278     EXIT.
  4279 0050-BEGIN-REFUND-PROCESS.
  4280     IF WS-ELCERT-ACT-NAME
  4281        PERFORM 0060-FIND-FULL-KEY
  4282                                 THRU 0060-EXIT
  4283        MOVE AM-CARRIER          TO CLIENT-CAR
  4284        MOVE AM-GROUPING         TO CLIENT-GRP
  4285        MOVE AM-STATE            TO CLIENT-STATE
  4286     END-IF
  4287     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4288     IF NOT RESP-NORMAL
  4289        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4290        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4291        MOVE WS-RESPONSE         TO WS-RESP
  4292        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4293        PERFORM 0020-SEND-BUFFER
  4294                                 THRU 0020-EXIT
  4295        PERFORM 0025-CLOSE-SOCKET
  4296                                 THRU 0025-EXIT
  4297        GO TO 0010-RETURN
  4298     END-IF
  4299     PERFORM 0150-READ-NEXT-ELCERT
  4300                                 THRU 0150-EXIT
  4301*    display ' came back from 0150 ' ws-response
  4302     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4303        DISPLAY ' CERT NOT FOUND '
  4304        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4305        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  76
* SOCK03.cbl
  4306        MOVE WS-RESPONSE         TO WS-RESP
  4307        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4308        PERFORM 0020-SEND-BUFFER
  4309                                 THRU 0020-EXIT
  4310        PERFORM 0025-CLOSE-SOCKET
  4311                                 THRU 0025-EXIT
  4312        GO TO 0010-RETURN
  4313     END-IF
  4314     PERFORM 0200-BEGIN-REFUND-PROCESS
  4315                                 THRU 0200-EXIT UNTIL
  4316        ELCERT-FINISHED
  4317     .
  4318 0050-EXIT.
  4319     EXIT.
  4320 0060-FIND-FULL-KEY.
  4321     MOVE ' ' TO WS-STOP-SW
  4322     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4323     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4324
  4325* EXEC CICS STARTBR
  4326*       DATASET  ('ERACCT3')
  4327*       RIDFLD   (WS-AM3-KEY)
  4328*       GTEQ
  4329*       RESP (WS-RESPONSE)
  4330*    END-EXEC
  4331     MOVE 'ERACCT3' TO DFHEIV1
  4332     MOVE 0
  4333       TO DFHEIV11
  4334*    MOVE '&,         G          &  N#00004282' TO DFHEIV0
  4335     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4336     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4337     MOVE X'204E233030303034323832' TO DFHEIV0(25:11)
  4338     CALL 'kxdfhei1' USING DFHEIV0,
  4339           DFHEIV1,
  4340           WS-AM3-KEY,
  4341           DFHEIV99,
  4342           DFHEIV11,
  4343           DFHEIV99
  4344     MOVE EIBRESP  TO WS-RESPONSE
  4345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4346     IF RESP-NORMAL
  4347        PERFORM UNTIL TOLD-TO-STOP
  4348
  4349* EXEC CICS READNEXT
  4350*             DATASET  ('ERACCT3')
  4351*             INTO     (ACCOUNT-MASTER)
  4352*             RIDFLD   (WS-AM3-KEY)
  4353*          END-EXEC
  4354     MOVE LENGTH OF
  4355      ACCOUNT-MASTER
  4356       TO DFHEIV12
  4357     MOVE 'ERACCT3' TO DFHEIV1
  4358     MOVE 0
  4359       TO DFHEIV11
  4360*    MOVE '&.IL                  )   #00004290' TO DFHEIV0
  4361     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4362     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4363     MOVE X'2020233030303034323930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  77
* SOCK03.cbl
  4364     CALL 'kxdfhei1' USING DFHEIV0,
  4365           DFHEIV1,
  4366           ACCOUNT-MASTER,
  4367           DFHEIV12,
  4368           WS-AM3-KEY,
  4369           DFHEIV99,
  4370           DFHEIV11,
  4371           DFHEIV99,
  4372           DFHEIV99
  4373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4374           EVALUATE TRUE
  4375              WHEN (RESP-NORMAL)
  4376                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4377                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4378                 SET TOLD-TO-STOP TO TRUE
  4379              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4380                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4381                 CONTINUE
  4382              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4383                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4384                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4385                 MOVE ZEROS      TO WS-RESP
  4386                 PERFORM 0030-BUILD-BUFFER
  4387                                 THRU 0030-EXIT
  4388                 PERFORM 0020-SEND-BUFFER
  4389                                 THRU 0020-EXIT
  4390                 PERFORM 0025-CLOSE-SOCKET
  4391                                 THRU 0025-EXIT
  4392                 GO TO 0010-RETURN
  4393           END-EVALUATE
  4394        END-PERFORM
  4395
  4396* EXEC CICS ENDBR
  4397*          DATASET   ('ERACCT3')
  4398*       END-EXEC
  4399     MOVE 'ERACCT3' TO DFHEIV1
  4400     MOVE 0
  4401       TO DFHEIV11
  4402*    MOVE '&2                    $   #00004316' TO DFHEIV0
  4403     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4404     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4405     MOVE X'2020233030303034333136' TO DFHEIV0(25:11)
  4406     CALL 'kxdfhei1' USING DFHEIV0,
  4407           DFHEIV1,
  4408           DFHEIV11,
  4409           DFHEIV99
  4410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4411     ELSE
  4412        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4413        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4414        MOVE ZEROS      TO WS-RESP
  4415        PERFORM 0030-BUILD-BUFFER
  4416                                 THRU 0030-EXIT
  4417        PERFORM 0020-SEND-BUFFER
  4418                                 THRU 0020-EXIT
  4419        PERFORM 0025-CLOSE-SOCKET
  4420                                 THRU 0025-EXIT
  4421        GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  78
* SOCK03.cbl
  4422     END-IF
  4423     .
  4424 0060-EXIT.
  4425     EXIT.
  4426 0100-START-ELCERT.
  4427*    DISPLAY ' MADE 0100 START '
  4428     MOVE SPACES                 TO WS-SEND-BUF
  4429     INITIALIZE WS-STRING-DATA
  4430     MOVE LOW-VALUES             TO WS-CM-KEY
  4431                                    WS-CM-KEY-A1
  4432                                    WS-CM-KEY-A4
  4433     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4434                                    WS-CM-COMPANY-CD-A1
  4435                                    WS-CM-COMPANY-CD-A4
  4436     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4437     MOVE 'L'                    TO DC-OPTION-CODE
  4438     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4439     IF NO-CONVERSION-ERROR
  4440        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4441     ELSE
  4442        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4443        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4444        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4445        PERFORM 0020-SEND-BUFFER
  4446                                 THRU 0020-EXIT
  4447        PERFORM 0025-CLOSE-SOCKET
  4448                                 THRU 0025-EXIT
  4449        GO TO 0010-RETURN
  4450     END-IF
  4451     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4452        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4453        MOVE 'L'                 TO DC-OPTION-CODE
  4454        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4455        IF NO-CONVERSION-ERROR
  4456           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4457        ELSE
  4458           MOVE 'BAD EFF DT CONVERT '
  4459                                 TO WS-COMMENT
  4460           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4461           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4462           PERFORM 0020-SEND-BUFFER
  4463                                 THRU 0020-EXIT
  4464           PERFORM 0025-CLOSE-SOCKET
  4465                                 THRU 0025-EXIT
  4466           GO TO 0010-RETURN
  4467        END-IF
  4468     END-IF
  4469     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4470        (F1 > +10)
  4471        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4472     END-PERFORM
  4473     IF F1 > +1
  4474        SUBTRACT +1 FROM F1
  4475     END-IF
  4476     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4477        (L1 > +15)
  4478        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4479     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  79
* SOCK03.cbl
  4480     IF L1 > +1
  4481        SUBTRACT +1 FROM L1
  4482     END-IF
  4483     EVALUATE TRUE
  4484        WHEN WS-ELCERT-FULL
  4485           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4486           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4487           MOVE CLIENT-STATE        TO WS-CM-STATE
  4488           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4489           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4490           MOVE CLIENT-CERT-NO (1:10)
  4491                                    TO WS-CM-CERT-NO
  4492
  4493* EXEC CICS READ
  4494*             INTO    (CERTIFICATE-MASTER)
  4495*             DATASET ('ELCERT')
  4496*             RIDFLD  (WS-CM-KEY)
  4497*             RESP    (WS-RESPONSE)
  4498*          END-EXEC
  4499     MOVE LENGTH OF
  4500      CERTIFICATE-MASTER
  4501       TO DFHEIV11
  4502     MOVE 'ELCERT' TO DFHEIV1
  4503*    MOVE '&"IL       E          (  N#00004400' TO DFHEIV0
  4504     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4506     MOVE X'204E233030303034343030' TO DFHEIV0(25:11)
  4507     CALL 'kxdfhei1' USING DFHEIV0,
  4508           DFHEIV1,
  4509           CERTIFICATE-MASTER,
  4510           DFHEIV11,
  4511           WS-CM-KEY,
  4512           DFHEIV99,
  4513           DFHEIV99,
  4514           DFHEIV99
  4515     MOVE EIBRESP  TO WS-RESPONSE
  4516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4517        WHEN WS-ELCERT-ACT-NAME
  4518           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4519           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4520           MOVE CLIENT-STATE        TO WS-CM-STATE
  4521           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4522           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4523           MOVE ZEROS               TO WS-CM-CERT-NO
  4524
  4525* EXEC CICS STARTBR
  4526*             DATASET ('ELCERT')
  4527*             RIDFLD  (WS-CM-KEY)
  4528*             RESP    (WS-RESPONSE)
  4529*          END-EXEC
  4530     MOVE 'ELCERT' TO DFHEIV1
  4531     MOVE 0
  4532       TO DFHEIV11
  4533*    MOVE '&,         G          &  N#00004413' TO DFHEIV0
  4534     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4536     MOVE X'204E233030303034343133' TO DFHEIV0(25:11)
  4537     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  80
* SOCK03.cbl
  4538           DFHEIV1,
  4539           WS-CM-KEY,
  4540           DFHEIV99,
  4541           DFHEIV11,
  4542           DFHEIV99
  4543     MOVE EIBRESP  TO WS-RESPONSE
  4544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4545        WHEN WS-ELCERT-NAME
  4546           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4547           MOVE SPACES           TO WS-CM-INITIALS
  4548           COMPUTE WS-LENGTH = L1 + +1
  4549
  4550* EXEC CICS STARTBR
  4551*             DATASET   ('ELCERT2')
  4552*             RIDFLD    (WS-CM-KEY-A1)
  4553*             GENERIC
  4554*             KEYLENGTH (WS-LENGTH)
  4555*             GTEQ
  4556*             RESP      (WS-RESPONSE)
  4557*          END-EXEC
  4558     MOVE 'ELCERT2' TO DFHEIV1
  4559     MOVE 0
  4560       TO DFHEIV11
  4561*    MOVE '&,   KG    G          &  N#00004422' TO DFHEIV0
  4562     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4563     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4564     MOVE X'204E233030303034343232' TO DFHEIV0(25:11)
  4565     CALL 'kxdfhei1' USING DFHEIV0,
  4566           DFHEIV1,
  4567           WS-CM-KEY-A1,
  4568           WS-LENGTH,
  4569           DFHEIV11,
  4570           DFHEIV99
  4571     MOVE EIBRESP  TO WS-RESPONSE
  4572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4573*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4574*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4575        WHEN WS-ELCERT-CERT-NO
  4576* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4577           MOVE +11 TO WS-LENGTH
  4578           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4579
  4580* EXEC CICS STARTBR
  4581*             DATASET   ('ELCERT5')
  4582*             RIDFLD    (WS-CM-KEY-A4)
  4583*             GENERIC
  4584*             KEYLENGTH (WS-LENGTH)
  4585*             GTEQ
  4586*             RESP      (WS-RESPONSE)
  4587*          END-EXEC
  4588     MOVE 'ELCERT5' TO DFHEIV1
  4589     MOVE 0
  4590       TO DFHEIV11
  4591*    MOVE '&,   KG    G          &  N#00004436' TO DFHEIV0
  4592     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4593     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4594     MOVE X'204E233030303034343336' TO DFHEIV0(25:11)
  4595     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  81
* SOCK03.cbl
  4596           DFHEIV1,
  4597           WS-CM-KEY-A4,
  4598           WS-LENGTH,
  4599           DFHEIV11,
  4600           DFHEIV99
  4601     MOVE EIBRESP  TO WS-RESPONSE
  4602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4603     END-EVALUATE
  4604     .
  4605 0100-EXIT.
  4606     EXIT.
  4607 0150-READ-NEXT-ELCERT.
  4608*    DISPLAY ' MADE 0150 NEXT '
  4609     EVALUATE TRUE
  4610        WHEN WS-ELCERT-ACT-NAME
  4611*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4612
  4613* EXEC CICS READNEXT
  4614*             DATASET   ('ELCERT')
  4615*             RIDFLD    (WS-CM-KEY)
  4616*             INTO      (CERTIFICATE-MASTER)
  4617*             RESP      (WS-RESPONSE)
  4618*          END-EXEC
  4619     MOVE LENGTH OF
  4620      CERTIFICATE-MASTER
  4621       TO DFHEIV12
  4622     MOVE 'ELCERT' TO DFHEIV1
  4623     MOVE 0
  4624       TO DFHEIV11
  4625*    MOVE '&.IL                  )  N#00004453' TO DFHEIV0
  4626     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4627     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4628     MOVE X'204E233030303034343533' TO DFHEIV0(25:11)
  4629     CALL 'kxdfhei1' USING DFHEIV0,
  4630           DFHEIV1,
  4631           CERTIFICATE-MASTER,
  4632           DFHEIV12,
  4633           WS-CM-KEY,
  4634           DFHEIV99,
  4635           DFHEIV11,
  4636           DFHEIV99,
  4637           DFHEIV99
  4638     MOVE EIBRESP  TO WS-RESPONSE
  4639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4640        WHEN WS-ELCERT-NAME
  4641*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4642
  4643* EXEC CICS READNEXT
  4644*             DATASET   ('ELCERT2')
  4645*             RIDFLD    (WS-CM-KEY-A1)
  4646*             INTO      (CERTIFICATE-MASTER)
  4647*             RESP      (WS-RESPONSE)
  4648*          END-EXEC
  4649     MOVE LENGTH OF
  4650      CERTIFICATE-MASTER
  4651       TO DFHEIV12
  4652     MOVE 'ELCERT2' TO DFHEIV1
  4653     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  82
* SOCK03.cbl
  4654       TO DFHEIV11
  4655*    MOVE '&.IL                  )  N#00004461' TO DFHEIV0
  4656     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4657     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4658     MOVE X'204E233030303034343631' TO DFHEIV0(25:11)
  4659     CALL 'kxdfhei1' USING DFHEIV0,
  4660           DFHEIV1,
  4661           CERTIFICATE-MASTER,
  4662           DFHEIV12,
  4663           WS-CM-KEY-A1,
  4664           DFHEIV99,
  4665           DFHEIV11,
  4666           DFHEIV99,
  4667           DFHEIV99
  4668     MOVE EIBRESP  TO WS-RESPONSE
  4669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4670        WHEN WS-ELCERT-CERT-NO
  4671
  4672* EXEC CICS READNEXT
  4673*             DATASET   ('ELCERT5')
  4674*             RIDFLD    (WS-CM-KEY-A4)
  4675*             INTO      (CERTIFICATE-MASTER)
  4676*             RESP      (WS-RESPONSE)
  4677*          END-EXEC
  4678     MOVE LENGTH OF
  4679      CERTIFICATE-MASTER
  4680       TO DFHEIV12
  4681     MOVE 'ELCERT5' TO DFHEIV1
  4682     MOVE 0
  4683       TO DFHEIV11
  4684*    MOVE '&.IL                  )  N#00004468' TO DFHEIV0
  4685     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4686     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4687     MOVE X'204E233030303034343638' TO DFHEIV0(25:11)
  4688     CALL 'kxdfhei1' USING DFHEIV0,
  4689           DFHEIV1,
  4690           CERTIFICATE-MASTER,
  4691           DFHEIV12,
  4692           WS-CM-KEY-A4,
  4693           DFHEIV99,
  4694           DFHEIV11,
  4695           DFHEIV99,
  4696           DFHEIV99
  4697     MOVE EIBRESP  TO WS-RESPONSE
  4698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4699     END-EVALUATE
  4700     .
  4701 0150-EXIT.
  4702     EXIT.
  4703 0200-BEGIN-REFUND-PROCESS.
  4704*    DISPLAY ' MADE 0200 BEGIN '
  4705     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4706                                    WS-ERACCT-SW
  4707     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4708                                    WS-NCB-DIFF-ODD-DAYS
  4709     INITIALIZE WS-STRING-DATA
  4710     IF RESP-NORMAL OR RESP-DUPKEY
  4711        EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  83
* SOCK03.cbl
  4712           WHEN WS-ELCERT-ACT-NAME
  4713              EVALUATE TRUE
  4714                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4715                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4716                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4717                    OR (CM-STATE NOT = CLIENT-STATE)
  4718                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4719                    SET ELCERT-FINISHED TO TRUE
  4720                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4721                    CLIENT-LAST-NAME (1:L1))
  4722                    GO TO 0200-CONTINUE
  4723                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4724                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4725                    GO TO 0200-CONTINUE
  4726                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4727                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4728                     CLIENT-FIRST-NAME (1:F1)))
  4729                    GO TO 0200-CONTINUE
  4730                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4731                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4732                    GO TO 0200-CONTINUE
  4733              END-EVALUATE
  4734           WHEN WS-ELCERT-CERT-NO
  4735              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4736                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4737                 SET ELCERT-FINISHED TO TRUE
  4738              ELSE
  4739                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4740                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4741                              OR
  4742                    ((CLIENT-LAST-NAME NOT = SPACES)
  4743                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4744                        CLIENT-LAST-NAME (1:L1)))
  4745                              OR
  4746                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4747                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4748                        CLIENT-FIRST-NAME (1:F1)))
  4749                              OR
  4750                    ((CLIENT-ACCOUNT NOT = SPACES)
  4751                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4752                     GO TO 0200-CONTINUE
  4753                 END-IF
  4754              END-IF
  4755           WHEN WS-ELCERT-NAME
  4756              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4757                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4758                    CLIENT-LAST-NAME (1:L1))
  4759                  SET ELCERT-FINISHED TO TRUE
  4760              ELSE
  4761                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4762                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4763                           OR
  4764                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4765                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4766                     CLIENT-FIRST-NAME (1:F1)))
  4767                           OR
  4768                 ((CLIENT-ACCOUNT NOT = SPACES)
  4769                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  84
* SOCK03.cbl
  4770                  GO TO 0200-CONTINUE
  4771                 END-IF
  4772              END-IF
  4773           WHEN OTHER
  4774              SET ELCERT-FINISHED   TO TRUE
  4775        END-EVALUATE
  4776     ELSE
  4777        SET ELCERT-FINISHED TO TRUE
  4778     END-IF
  4779*       IF WS-ELCERT-CERT-NO
  4780*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4781*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4782*                          OR
  4783*                ((CLIENT-EFF-DT NOT = SPACES)
  4784*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4785*                          OR
  4786*                ((CLIENT-LAST-NAME NOT = SPACES)
  4787*                 AND (CM-INSURED-LAST-NAME NOT =
  4788*                    CLIENT-LAST-NAME))
  4789*                 SET ELCERT-FINISHED TO TRUE
  4790*          END-IF
  4791*          IF WS-ELCERT-NAME
  4792*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4793*                OR (CM-INSURED-LAST-NAME NOT =
  4794*                   CLIENT-LAST-NAME)
  4795*                            OR
  4796*                ((CLIENT-EFF-DT NOT = SPACES)
  4797*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4798*                 SET ELCERT-FINISHED TO TRUE
  4799*             END-IF
  4800*          ELSE
  4801*             SET ELCERT-FINISHED   TO TRUE
  4802*          END-IF
  4803     IF NOT WS-ELCERT-FULL
  4804        IF ELCERT-FINISHED
  4805           GO TO 0200-EXIT
  4806        END-IF
  4807     END-IF
  4808     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4809        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4810        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4811        PERFORM 0030-BUILD-BUFFER
  4812                                 THRU 0030-EXIT
  4813        PERFORM 0020-SEND-BUFFER
  4814                                 THRU 0020-EXIT
  4815        GO TO 0200-CONTINUE
  4816     END-IF
  4817     if (ws-epiq-request)
  4818        and (not EPIQ-CLASS)
  4819        go to 0200-continue
  4820     end-if
  4821
  4822     if ws-epiq-request
  4823        add +1 to ws-epiq-max
  4824        if ws-epiq-max > +100
  4825           go to 0200-continue
  4826        end-if
  4827     end-if
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  85
* SOCK03.cbl
  4828     PERFORM 0300-GET-ELCNTL-RECORDS
  4829                                 THRU 0300-EXIT
  4830     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4831     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4832     MOVE +0                     TO DC-ELAPSED-MONTHS
  4833                                    DC-ELAPSED-DAYS
  4834     MOVE '1'                    TO DC-OPTION-CODE
  4835     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4836     IF NO-CONVERSION-ERROR
  4837        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4838        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4839     END-IF
  4840     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4841     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4842     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4843     IF NOT ALREADY-SENT
  4844        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4845     END-IF
  4846     .
  4847 0200-CONTINUE.
  4848     PERFORM 0150-READ-NEXT-ELCERT
  4849                                 THRU 0150-EXIT
  4850     .
  4851 0200-EXIT.
  4852     EXIT.
  4853 0300-GET-ELCNTL-RECORDS.
  4854     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4855     IF NOT RESP-NORMAL
  4856        MOVE ' COMPANY RECORD NOT FOUND '
  4857                                 TO WS-COMMENT
  4858        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4859        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4860        PERFORM 0020-SEND-BUFFER
  4861                                 THRU 0020-EXIT
  4862        PERFORM 0025-CLOSE-SOCKET
  4863                                 THRU 0025-EXIT
  4864        GO TO 0010-RETURN
  4865     END-IF
  4866     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4867        PERFORM 0320-GET-LIFE-RECORD
  4868                                 THRU 0320-EXIT
  4869        IF NOT RESP-NORMAL
  4870           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4871                                 TO WS-COMMENT
  4872           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4873           PERFORM 0030-BUILD-BUFFER
  4874                                 THRU 0030-EXIT
  4875           PERFORM 0020-SEND-BUFFER
  4876                                 THRU 0020-EXIT
  4877           PERFORM 0025-CLOSE-SOCKET
  4878                                 THRU 0025-EXIT
  4879           GO TO 0010-RETURN
  4880        END-IF
  4881     END-IF
  4882     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4883        PERFORM 0330-GET-AH-RECORD
  4884                                 THRU 0330-EXIT
  4885        IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  86
* SOCK03.cbl
  4886           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4887                                 TO WS-COMMENT
  4888           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4889           PERFORM 0030-BUILD-BUFFER
  4890                                 THRU 0030-EXIT
  4891           PERFORM 0020-SEND-BUFFER
  4892                                 THRU 0020-EXIT
  4893           PERFORM 0025-CLOSE-SOCKET
  4894                                 THRU 0025-EXIT
  4895           GO TO 0010-RETURN
  4896        END-IF
  4897     END-IF
  4898     PERFORM 0340-GET-STATE-RECORD
  4899                                 THRU 0340-EXIT
  4900     IF NOT RESP-NORMAL
  4901        MOVE ' STATE RECORD NOT FOUND '
  4902                                 TO WS-COMMENT
  4903        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4904        PERFORM 0030-BUILD-BUFFER
  4905                                 THRU 0030-EXIT
  4906        PERFORM 0020-SEND-BUFFER
  4907                                 THRU 0020-EXIT
  4908        PERFORM 0025-CLOSE-SOCKET
  4909                                 THRU 0025-EXIT
  4910        GO TO 0010-RETURN
  4911     END-IF
  4912     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4913     IF NOT ERACCT-FOUND
  4914        MOVE ' ACCOUNT NOT FOUND '
  4915                                 TO WS-COMMENT
  4916        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4917        PERFORM 0030-BUILD-BUFFER
  4918                                 THRU 0030-EXIT
  4919        PERFORM 0020-SEND-BUFFER
  4920                                 THRU 0020-EXIT
  4921        PERFORM 0025-CLOSE-SOCKET
  4922                                 THRU 0025-EXIT
  4923        GO TO 0010-RETURN
  4924     ELSE
  4925        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4926        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4927        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4928        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4929     END-IF
  4930     .
  4931 0300-EXIT.
  4932     EXIT.
  4933 0310-GET-COMPANY.
  4934     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4935     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4936     MOVE SPACES                 TO  WS-CF-ACCESS
  4937     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4938
  4939* EXEC CICS READ
  4940*       INTO    (CONTROL-FILE)
  4941*       DATASET ('ELCNTL')
  4942*       RIDFLD  (WS-CF-KEY)
  4943*       RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  87
* SOCK03.cbl
  4944*    END-EXEC
  4945     MOVE LENGTH OF
  4946      CONTROL-FILE
  4947       TO DFHEIV11
  4948     MOVE 'ELCNTL' TO DFHEIV1
  4949*    MOVE '&"IL       E          (  N#00004713' TO DFHEIV0
  4950     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4952     MOVE X'204E233030303034373133' TO DFHEIV0(25:11)
  4953     CALL 'kxdfhei1' USING DFHEIV0,
  4954           DFHEIV1,
  4955           CONTROL-FILE,
  4956           DFHEIV11,
  4957           WS-CF-KEY,
  4958           DFHEIV99,
  4959           DFHEIV99,
  4960           DFHEIV99
  4961     MOVE EIBRESP  TO WS-RESPONSE
  4962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4963     IF (RESP-NORMAL)
  4964        AND (CF-COMPANY-ID = WS-COMP-ID)
  4965        AND (CF-RECORD-TYPE = '1')
  4966        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4967        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4968        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4969        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4970        IF CF-DEFAULT-APR NUMERIC
  4971           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4972        ELSE
  4973           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4974        END-IF
  4975        IF CF-VALID-REM-TRM-OPTION
  4976           MOVE CF-REM-TRM-CALC-OPTION
  4977                                 TO WS-CF-REM-TRM-CALC-OPTION
  4978        ELSE
  4979           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4980        END-IF
  4981     END-IF
  4982     .
  4983 0310-EXIT.
  4984     EXIT.
  4985 0320-GET-LIFE-RECORD.
  4986     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4987     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4988                                    WS-LF-BEN-CODE
  4989     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4990
  4991* EXEC CICS READ
  4992*       INTO    (CONTROL-FILE)
  4993*       DATASET ('ELCNTL')
  4994*       RIDFLD  (WS-CF-KEY)
  4995*       GTEQ
  4996*       RESP    (WS-RESPONSE)
  4997*    END-EXEC
  4998     MOVE LENGTH OF
  4999      CONTROL-FILE
  5000       TO DFHEIV11
  5001     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  88
* SOCK03.cbl
  5002*    MOVE '&"IL       G          (  N#00004746' TO DFHEIV0
  5003     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5005     MOVE X'204E233030303034373436' TO DFHEIV0(25:11)
  5006     CALL 'kxdfhei1' USING DFHEIV0,
  5007           DFHEIV1,
  5008           CONTROL-FILE,
  5009           DFHEIV11,
  5010           WS-CF-KEY,
  5011           DFHEIV99,
  5012           DFHEIV99,
  5013           DFHEIV99
  5014     MOVE EIBRESP  TO WS-RESPONSE
  5015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5016     IF RESP-NORMAL
  5017        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5018        AND (CF-RECORD-TYPE = '4')
  5019        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5020           (S1 > +8)
  5021           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5022        END-PERFORM
  5023        IF S1 > +8
  5024           CONTINUE
  5025        ELSE
  5026           MOVE CF-BENEFIT-DESCRIP (S1)
  5027                                 TO WS-LF-BEN-CODE-DESC
  5028           MOVE CF-LF-COVERAGE-TYPE (S1)
  5029                                 TO WS-CF-LF-COVERAGE-TYPE
  5030           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5031              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5032           ELSE
  5033              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5034           END-IF
  5035           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5036               MOVE CF-CO-REM-TERM-CALC (S1)
  5037                                 TO WS-LF-CO-REM-TERM-CALC
  5038           END-IF
  5039           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5040               MOVE CF-CO-EARNINGS-CALC (S1)
  5041                                 TO WS-LF-CO-EARNINGS-CALC
  5042                                    WS-LF-CO-REFUND-CALC
  5043           END-IF
  5044           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5045               MOVE CF-SPECIAL-CALC-CD (S1)
  5046                                 TO WS-LF-SPECIAL-CALC-CD
  5047           END-IF
  5048           IF CF-CO-REFUND-CALC (S1) > '0'
  5049               MOVE CF-CO-REFUND-CALC (S1)
  5050                                 TO WS-LF-CO-REFUND-CALC
  5051        END-IF
  5052     END-IF
  5053     .
  5054 0320-EXIT.
  5055     EXIT.
  5056 0330-GET-AH-RECORD.
  5057     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5058     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5059     MOVE +0                     TO WS-CF-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  89
* SOCK03.cbl
  5060
  5061* EXEC CICS READ
  5062*       INTO    (CONTROL-FILE)
  5063*       DATASET ('ELCNTL')
  5064*       RIDFLD  (WS-CF-KEY)
  5065*       GTEQ
  5066*       RESP    (WS-RESPONSE)
  5067*    END-EXEC
  5068     MOVE LENGTH OF
  5069      CONTROL-FILE
  5070       TO DFHEIV11
  5071     MOVE 'ELCNTL' TO DFHEIV1
  5072*    MOVE '&"IL       G          (  N#00004797' TO DFHEIV0
  5073     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5075     MOVE X'204E233030303034373937' TO DFHEIV0(25:11)
  5076     CALL 'kxdfhei1' USING DFHEIV0,
  5077           DFHEIV1,
  5078           CONTROL-FILE,
  5079           DFHEIV11,
  5080           WS-CF-KEY,
  5081           DFHEIV99,
  5082           DFHEIV99,
  5083           DFHEIV99
  5084     MOVE EIBRESP  TO WS-RESPONSE
  5085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5086     IF RESP-NORMAL
  5087        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5088        AND (CF-RECORD-TYPE = '5')
  5089        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5090           (S1 > +8)
  5091           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5092        END-PERFORM
  5093        IF S1 > +8
  5094           CONTINUE
  5095        ELSE
  5096           MOVE CF-BENEFIT-DESCRIP (S1)
  5097                                 TO WS-AH-BEN-CODE-DESC
  5098           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5099              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5100           ELSE
  5101              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5102           END-IF
  5103           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5104              MOVE CF-CO-REM-TERM-CALC (S1)
  5105                                 TO WS-AH-CO-REM-TERM-CALC
  5106           END-IF
  5107           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5108              MOVE CF-CO-EARNINGS-CALC (S1)
  5109                                 TO WS-AH-CO-EARNINGS-CALC
  5110                                    WS-AH-CO-REFUND-CALC
  5111           END-IF
  5112           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5113              MOVE CF-SPECIAL-CALC-CD (S1)
  5114                                 TO WS-AH-SPECIAL-CALC-CD
  5115           END-IF
  5116           IF CF-CO-REFUND-CALC (S1) > '0'
  5117              MOVE CF-CO-REFUND-CALC (S1)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  90
* SOCK03.cbl
  5118                                 TO WS-AH-CO-REFUND-CALC
  5119           END-IF
  5120           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5121              MOVE CF-BENEFIT-CATEGORY (S1)
  5122                                 TO WS-AH-BEN-CATEGORY
  5123           END-IF
  5124        END-IF
  5125     END-IF
  5126     .
  5127 0330-EXIT.
  5128     EXIT.
  5129 0340-GET-STATE-RECORD.
  5130     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5131     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5132     MOVE CM-STATE               TO WS-CF-ACCESS
  5133     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5134
  5135* EXEC CICS READ
  5136*       INTO    (CONTROL-FILE)
  5137*       DATASET ('ELCNTL')
  5138*       RIDFLD  (WS-CF-KEY)
  5139*       RESP    (WS-RESPONSE)
  5140*    END-EXEC
  5141     MOVE LENGTH OF
  5142      CONTROL-FILE
  5143       TO DFHEIV11
  5144     MOVE 'ELCNTL' TO DFHEIV1
  5145*    MOVE '&"IL       E          (  N#00004852' TO DFHEIV0
  5146     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5148     MOVE X'204E233030303034383532' TO DFHEIV0(25:11)
  5149     CALL 'kxdfhei1' USING DFHEIV0,
  5150           DFHEIV1,
  5151           CONTROL-FILE,
  5152           DFHEIV11,
  5153           WS-CF-KEY,
  5154           DFHEIV99,
  5155           DFHEIV99,
  5156           DFHEIV99
  5157     MOVE EIBRESP  TO WS-RESPONSE
  5158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5159     IF (RESP-NORMAL)
  5160        AND (CF-COMPANY-ID = WS-COMP-ID)
  5161        AND (CF-RECORD-TYPE = '3')
  5162        AND (CF-STATE-CODE = CM-STATE)
  5163        MOVE CF-ST-FREE-LOOK-PERIOD
  5164                                 TO WS-FREE-LOOK
  5165        MOVE CF-STATE-ABBREVIATION
  5166                                 TO WS-STATE-ABBREVIATION
  5167        MOVE CF-ST-FST-PMT-DAYS-CHG
  5168                                 TO  WS-STATE-EXT-DAYS-CHG
  5169        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5170           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5171           IF CF-ST-RT-CALC NOT = SPACES
  5172              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5173           END-IF
  5174           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5175              IF CF-ST-RF-LR-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  91
* SOCK03.cbl
  5176                 MOVE CF-ST-RF-LR-CALC
  5177                                 TO WS-LF-ST-REFUND-CALC
  5178              END-IF
  5179              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5180                 IF CF-ST-RF-LN-CALC > '0'
  5181                    MOVE CF-ST-RF-LN-CALC
  5182                                 TO WS-LF-ST-REFUND-CALC
  5183                 END-IF
  5184              END-IF
  5185           ELSE
  5186              IF CF-ST-RF-LL-CALC > '0'
  5187                 MOVE CF-ST-RF-LL-CALC
  5188                                 TO WS-LF-ST-REFUND-CALC
  5189              END-IF
  5190           END-IF
  5191           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5192              (S1 > 50)
  5193              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5194                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5195           END-PERFORM
  5196           IF S1 < +51
  5197              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5198                 MOVE CF-ST-REM-TERM-CALC (S1)
  5199                                 TO WS-LF-ST-REM-TERM-CALC
  5200              END-IF
  5201              IF CF-ST-REFUND-CALC (S1) > '0'
  5202                 MOVE CF-ST-REFUND-CALC (S1)
  5203                                 TO WS-LF-ST-REFUND-CALC
  5204              END-IF
  5205           END-IF
  5206        END-IF
  5207        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5208           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5209           IF CF-ST-RT-CALC NOT = SPACES
  5210              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5211           END-IF
  5212           IF CF-ST-RF-AH-CALC > '0'
  5213              MOVE CF-ST-RF-AH-CALC
  5214                                 TO WS-AH-ST-REFUND-CALC
  5215           END-IF
  5216           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5217              IF CF-ST-RF-CP-CALC > '0'
  5218                 MOVE CF-ST-RF-CP-CALC
  5219                                 TO WS-AH-ST-REFUND-CALC
  5220              END-IF
  5221           END-IF
  5222           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5223              (S1 > 50)
  5224              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5225                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5226           END-PERFORM
  5227           IF S1 < +51
  5228              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5229                 MOVE CF-ST-REM-TERM-CALC (S1)
  5230                                 TO WS-AH-ST-REM-TERM-CALC
  5231              END-IF
  5232              IF CF-ST-REFUND-CALC (S1) > '0'
  5233                 MOVE CF-ST-REFUND-CALC (S1)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  92
* SOCK03.cbl
  5234                                 TO WS-AH-ST-REFUND-CALC
  5235              END-IF
  5236           END-IF
  5237        END-IF
  5238     END-IF
  5239     .
  5240 0340-EXIT.
  5241     EXIT.
  5242 0350-GET-ERACCT.
  5243     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5244                                    WS-AM-EARN-METHOD-R
  5245                                    WS-AM-EARN-METHOD-A
  5246                                    WS-LF-AM-REM-TERM-CALC
  5247                                    WS-AH-AM-REM-TERM-CALC
  5248     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5249     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5250     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5251     MOVE CM-STATE               TO WS-AM-STATE
  5252     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5253     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5254     MOVE LOW-VALUES             TO WS-AM-FILLER
  5255     MOVE ' '                    TO WS-STOP-SW
  5256
  5257* EXEC CICS STARTBR
  5258*       DATASET  ('ERACCT')
  5259*       RIDFLD   (WS-AM-KEY)
  5260*       GTEQ
  5261*       RESP (WS-RESPONSE)
  5262*    END-EXEC
  5263     MOVE 'ERACCT' TO DFHEIV1
  5264     MOVE 0
  5265       TO DFHEIV11
  5266*    MOVE '&,         G          &  N#00004955' TO DFHEIV0
  5267     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5268     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5269     MOVE X'204E233030303034393535' TO DFHEIV0(25:11)
  5270     CALL 'kxdfhei1' USING DFHEIV0,
  5271           DFHEIV1,
  5272           WS-AM-KEY,
  5273           DFHEIV99,
  5274           DFHEIV11,
  5275           DFHEIV99
  5276     MOVE EIBRESP  TO WS-RESPONSE
  5277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5278     IF RESP-NORMAL
  5279        PERFORM UNTIL TOLD-TO-STOP
  5280
  5281* EXEC CICS READNEXT
  5282*             DATASET  ('ERACCT')
  5283*             INTO     (ACCOUNT-MASTER)
  5284*             RIDFLD   (WS-AM-KEY)
  5285*          END-EXEC
  5286     MOVE LENGTH OF
  5287      ACCOUNT-MASTER
  5288       TO DFHEIV12
  5289     MOVE 'ERACCT' TO DFHEIV1
  5290     MOVE 0
  5291       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  93
* SOCK03.cbl
  5292*    MOVE '&.IL                  )   #00004963' TO DFHEIV0
  5293     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5294     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5295     MOVE X'2020233030303034393633' TO DFHEIV0(25:11)
  5296     CALL 'kxdfhei1' USING DFHEIV0,
  5297           DFHEIV1,
  5298           ACCOUNT-MASTER,
  5299           DFHEIV12,
  5300           WS-AM-KEY,
  5301           DFHEIV99,
  5302           DFHEIV11,
  5303           DFHEIV99,
  5304           DFHEIV99
  5305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5306           IF RESP-NORMAL
  5307              EVALUATE TRUE
  5308                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5309                    CM-CONTROL-PRIMARY (1:20)
  5310                    SET TOLD-TO-STOP TO TRUE
  5311                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5312                    CM-CONTROL-PRIMARY (1:20))
  5313                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5314                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5315                    SET ERACCT-FOUND      TO TRUE
  5316                    SET TOLD-TO-STOP TO TRUE
  5317              END-EVALUATE
  5318           ELSE
  5319              SET TOLD-TO-STOP TO TRUE
  5320           END-IF
  5321        END-PERFORM
  5322
  5323* EXEC CICS ENDBR
  5324*          DATASET   ('ERACCT')
  5325*       END-EXEC
  5326     MOVE 'ERACCT' TO DFHEIV1
  5327     MOVE 0
  5328       TO DFHEIV11
  5329*    MOVE '&2                    $   #00004984' TO DFHEIV0
  5330     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5331     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5332     MOVE X'2020233030303034393834' TO DFHEIV0(25:11)
  5333     CALL 'kxdfhei1' USING DFHEIV0,
  5334           DFHEIV1,
  5335           DFHEIV11,
  5336           DFHEIV99
  5337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5338     END-IF
  5339     .
  5340 0350-EXIT.
  5341     EXIT.
  5342 0400-PROCESS-LIFE.
  5343     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5344     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5345     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5346     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5347     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5348     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5349     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  94
* SOCK03.cbl
  5350     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5351     MOVE CM-CARRIER             TO WS-CARRIER
  5352     MOVE CM-GROUPING            TO WS-GROUPING
  5353     MOVE CM-STATE               TO WS-STATE
  5354     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5355     MOVE CM-CERT-NO             TO WS-CERT-NO
  5356     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5357     MOVE ' '                    TO  DC-OPTION-CODE.
  5358     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5359     IF NO-CONVERSION-ERROR
  5360        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5361     ELSE
  5362        MOVE 99999999            TO WS-CERT-EFF-DATE
  5363     END-IF
  5364     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5365        GO TO 0400-EXIT
  5366     END-IF
  5367     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5368                                    WS-TOT-LF-PREM
  5369                                    WS-TOT-LF-COMM
  5370     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5371     MOVE ' '                    TO  DC-OPTION-CODE
  5372     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5373     IF NO-CONVERSION-ERROR
  5374        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5375     ELSE
  5376        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5377     END-IF
  5378     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5379     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5380     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5381     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5382     MOVE CM-STATE               TO CP-STATE
  5383     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5384     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5385     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5386     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5387     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5388     MOVE '2'                    TO CP-PROCESS-TYPE
  5389     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5390     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5391     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5392     MOVE WS-CF-REM-TRM-CALC-OPTION
  5393                                 TO CP-REM-TRM-CALC-OPTION
  5394     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5395     IF WS-LF-CO-REM-TERM-CALC > '0'
  5396        MOVE WS-LF-CO-REM-TERM-CALC
  5397                                 TO CP-REM-TERM-METHOD
  5398     END-IF
  5399     IF WS-LF-ST-REM-TERM-CALC > '0'
  5400         MOVE WS-LF-ST-REM-TERM-CALC
  5401                                 TO  CP-REM-TERM-METHOD.
  5402     IF WS-LF-AM-REM-TERM-CALC > '0'
  5403         MOVE WS-LF-AM-REM-TERM-CALC
  5404                                 TO  CP-REM-TERM-METHOD.
  5405     IF (WS-COMP-ID = 'CID')
  5406        AND (CP-STATE-STD-ABBRV = 'WI')
  5407        MOVE '7'                 TO CP-REM-TERM-METHOD
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  95
* SOCK03.cbl
  5408        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5409     END-IF
  5410     IF (WS-COMP-ID = 'CID')
  5411        AND (CP-STATE-STD-ABBRV = 'MO')
  5412        AND (CM-CERT-EFF-DT >= X'9B41')
  5413        AND (CM-CERT-EFF-DT <= X'A2FB')
  5414        MOVE '7'                 TO CP-REM-TERM-METHOD
  5415        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5416     END-IF
  5417     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5418                                    CP-LOAN-TERM
  5419                                    WS-LF-TERM
  5420     IF CP-TRUNCATED-LIFE
  5421         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5422     IF CP-TERM-IS-DAYS
  5423        IF CM-LF-TERM-IN-DAYS NUMERIC
  5424           MOVE CM-LF-TERM-IN-DAYS
  5425                                 TO CP-TERM-OR-EXT-DAYS
  5426        ELSE
  5427           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5428        END-IF
  5429     ELSE
  5430        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5431           MOVE CM-PMT-EXTENSION-DAYS
  5432                                 TO CP-TERM-OR-EXT-DAYS
  5433        ELSE
  5434           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5435        END-IF
  5436     END-IF
  5437     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5438     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5439        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5440        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5441     END-IF
  5442     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5443     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5444     MOVE ' '                    TO WS-CLM-STOP-SW
  5445     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5446     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5447
  5448* EXEC CICS STARTBR
  5449*       DATASET     ('ELMSTR5')
  5450*       RIDFLD      (ELMSTR-KEY)
  5451*       RESP        (WS-RESPONSE)
  5452*    END-EXEC
  5453     MOVE 'ELMSTR5' TO DFHEIV1
  5454     MOVE 0
  5455       TO DFHEIV11
  5456*    MOVE '&,         G          &  N#00005096' TO DFHEIV0
  5457     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5458     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5459     MOVE X'204E233030303035303936' TO DFHEIV0(25:11)
  5460     CALL 'kxdfhei1' USING DFHEIV0,
  5461           DFHEIV1,
  5462           ELMSTR-KEY,
  5463           DFHEIV99,
  5464           DFHEIV11,
  5465           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  96
* SOCK03.cbl
  5466     MOVE EIBRESP  TO WS-RESPONSE
  5467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5468     DISPLAY ' AFTER START ' WS-RESPONSE
  5469     IF RESP-NORMAL
  5470        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5471
  5472* EXEC CICS READNEXT
  5473*             DATASET   ('ELMSTR5')
  5474*             RIDFLD    (ELMSTR-KEY)
  5475*             INTO      (CLAIM-MASTER)
  5476*             RESP      (WS-RESPONSE)
  5477*          END-EXEC
  5478     MOVE LENGTH OF
  5479      CLAIM-MASTER
  5480       TO DFHEIV12
  5481     MOVE 'ELMSTR5' TO DFHEIV1
  5482     MOVE 0
  5483       TO DFHEIV11
  5484*    MOVE '&.IL                  )  N#00005104' TO DFHEIV0
  5485     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5486     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5487     MOVE X'204E233030303035313034' TO DFHEIV0(25:11)
  5488     CALL 'kxdfhei1' USING DFHEIV0,
  5489           DFHEIV1,
  5490           CLAIM-MASTER,
  5491           DFHEIV12,
  5492           ELMSTR-KEY,
  5493           DFHEIV99,
  5494           DFHEIV11,
  5495           DFHEIV99,
  5496           DFHEIV99
  5497     MOVE EIBRESP  TO WS-RESPONSE
  5498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5499        IF (RESP-NORMAL OR RESP-DUPKEY)
  5500           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5501           AND (CM-CERT-NO = CL-CERT-NO)
  5502           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5503              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5504              IF CL-CLAIM-TYPE = 'L'
  5505                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5506                    MOVE 'D'     TO WS-AH-STATUS
  5507                 END-IF
  5508                 IF CLAIM-IS-OPEN
  5509                    MOVE ' OPEN LIFE CLAIM '
  5510                                 TO WS-COMMENT
  5511                    MOVE 'L'     TO WS-LF-STATUS
  5512                    GO TO 0400-EXIT
  5513                 ELSE
  5514                    MOVE ' DEATH CLAIM APPLIED '
  5515                                 TO WS-COMMENT
  5516                    MOVE 'D'     TO WS-LF-STATUS
  5517*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5518*                      MOVE CL-PAID-THRU-DT
  5519*                                TO WS-LF-BIN-PAID-THRU-DT
  5520*                   END-IF
  5521                 END-IF
  5522              END-IF
  5523           END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  97
* SOCK03.cbl
  5524        ELSE
  5525           SET I-SAY-TO-STOP TO TRUE
  5526        END-IF
  5527        END-PERFORM
  5528
  5529* EXEC CICS ENDBR
  5530*          DATASET   ('ELMSTR5')
  5531*       END-EXEC
  5532     MOVE 'ELMSTR5' TO DFHEIV1
  5533     MOVE 0
  5534       TO DFHEIV11
  5535*    MOVE '&2                    $   #00005139' TO DFHEIV0
  5536     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5537     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5538     MOVE X'2020233030303035313339' TO DFHEIV0(25:11)
  5539     CALL 'kxdfhei1' USING DFHEIV0,
  5540           DFHEIV1,
  5541           DFHEIV11,
  5542           DFHEIV99
  5543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5544     END-IF
  5545     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5546*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5547        MOVE WS-LF-BIN-PAID-THRU-DT
  5548                                 TO DC-BIN-DATE-1
  5549        MOVE ' '                 TO DC-OPTION-CODE
  5550        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5551        IF NO-CONVERSION-ERROR
  5552           MOVE DC-GREG-DATE-CYMD
  5553                                 TO WS-CLM-PAID-THRU-DT
  5554        ELSE
  5555           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5556        END-IF
  5557*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5558*          MOVE 'CAN DT =< CLM PD THRU DT'
  5559*                                TO WS-COMMENT
  5560*          MOVE 'P'              TO WS-LF-STATUS
  5561*          GO TO 0400-EXIT
  5562*       END-IF
  5563        GO TO 0400-EXIT
  5564     END-IF
  5565     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5566     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5567        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5568        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5569        COMPUTE CP-REMAINING-TERM-1 =
  5570                CP-REMAINING-TERM-1 - +1
  5571        COMPUTE CP-REMAINING-TERM-2 =
  5572                CP-REMAINING-TERM-2 - +1
  5573     END-IF
  5574     IF CP-REMAINING-TERM-1 NEGATIVE
  5575        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5576     END-IF
  5577     IF CP-REMAINING-TERM-2 NEGATIVE
  5578        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5579     END-IF
  5580     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5581        MOVE ZERO                TO CM-LIFE-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  98
* SOCK03.cbl
  5582     END-IF
  5583     IF CM-LIFE-COMM-PCT > ZEROS
  5584        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5585           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5586     END-IF
  5587     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5588     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5589     IF CM-LF-CURRENT-STATUS = '8'
  5590        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5591           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5592                                 TO WS-COMMENT
  5593           MOVE 'C'              TO WS-LF-STATUS
  5594*          PERFORM 0030-BUILD-BUFFER
  5595*                                THRU 0030-EXIT
  5596*          PERFORM 0020-SEND-BUFFER
  5597*                                THRU 0020-EXIT
  5598*          SET ALREADY-SENT      TO TRUE
  5599*          MOVE SPACES           TO WS-COMMENT
  5600           GO TO 0400-EXIT
  5601*          PERFORM 0025-CLOSE-SOCKET
  5602*                                THRU 0025-EXIT
  5603*          GO TO 0010-RETURN
  5604        END-IF
  5605     END-IF
  5606     IF CM-LF-CURRENT-STATUS = '7'
  5607        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5608           MOVE ' DEATH CLAIM APPLIED '
  5609                                 TO WS-COMMENT
  5610           MOVE 'D'              TO WS-LF-STATUS
  5611*          PERFORM 0030-BUILD-BUFFER
  5612*                                THRU 0030-EXIT
  5613*          IF NOT ALREADY-SENT
  5614*             PERFORM 0020-SEND-BUFFER
  5615*                                THRU 0020-EXIT
  5616*             SET ALREADY-SENT   TO TRUE
  5617*          END-IF
  5618           GO TO 0400-EXIT
  5619*          PERFORM 0025-CLOSE-SOCKET
  5620*                                THRU 0025-EXIT
  5621*          GO TO 0010-RETURN
  5622        END-IF
  5623     END-IF
  5624     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5625        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5626        MOVE 'LF COVERAGE EXPIRED '
  5627                                 TO WS-COMMENT
  5628        MOVE 'E'                 TO WS-LF-STATUS
  5629        GO TO 0400-EXIT
  5630     END-IF
  5631     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5632        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5633        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5634     ELSE
  5635        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5636     END-IF
  5637     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5638     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5639*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page  99
* SOCK03.cbl
  5640     if ws-comp-id = 'AHL'
  5641        move cm-lf-class-cd      to cp-class-code
  5642        if cp-class-code = spaces
  5643           move zeros            to cp-class-code
  5644        end-if
  5645     else
  5646        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5647     end-if
  5648     IF (ws-comp-id = 'DCC')
  5649        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5650        MOVE ' '                 TO WS-PDEF-RECORD-SW
  5651        PERFORM 0730-GET-DDF-FACTORS
  5652                                 THRU 0730-EXIT
  5653        IF PDEF-FOUND
  5654           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5655              (P1 > +8)
  5656              OR (PD-PROD-CODE (P1) = 'L')
  5657           END-PERFORM
  5658           IF P1 < +9
  5659              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  5660           END-IF
  5661        END-IF
  5662     END-IF
  5663     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5664*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5665     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5666        CM-LF-ALT-BENEFIT-AMT
  5667*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5668     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5669                                    WS-LF-REM-BEN
  5670     move cm-lf-premium-amt      to ws-tot-lf-prem
  5671     if ws-lf-co-earnings-calc = 'B'
  5672        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  5673           + CM-LF-ALT-PREMIUM-AMT
  5674     end-if
  5675     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5676     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5677        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5678        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5679     ELSE
  5680        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5681     END-IF
  5682     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5683     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5684     IF WS-LF-ST-REFUND-CALC > ZERO
  5685         MOVE WS-LF-ST-REFUND-CALC
  5686                                 TO  CP-EARNING-METHOD.
  5687     IF WS-LF-FO-REFUND-CALC > ZERO
  5688         MOVE WS-LF-FO-REFUND-CALC
  5689                                 TO  CP-EARNING-METHOD.
  5690     IF CP-RATING-METHOD = '4'
  5691        MOVE '4'                 TO CP-EARNING-METHOD
  5692     END-IF
  5693*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5694     if ws-comp-id = 'AHL'
  5695        move cm-lf-class-cd      to cp-class-code
  5696        if cp-class-code = spaces
  5697           move zeros            to cp-class-code
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 100
* SOCK03.cbl
  5698        end-if
  5699     else
  5700        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5701     end-if
  5702     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5703     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5704                                     CP-RATING-BENEFIT-AMT.
  5705     IF CP-STATE-STD-ABBRV = 'OR'
  5706         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5707                                         CM-LF-ALT-BENEFIT-AMT.
  5708****   N O T E   ****
  5709*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5710*      THE OH HARD CODING IN ELCRFNDP
  5711     IF WS-COMP-ID = 'CID'
  5712        IF CP-STATE-STD-ABBRV = 'OH'
  5713           MOVE WS-LF-CO-EARNINGS-CALC
  5714                                 TO CP-EARNING-METHOD
  5715        END-IF
  5716     END-IF
  5717****   N O T E   ****
  5718     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5719     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5720     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5721     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5722     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5723     IF CP-EARN-AS-NET-PAY
  5724        IF CP-LOAN-APR <= ZEROS
  5725           IF WS-CF-DEFAULT-APR > ZEROS
  5726              MOVE WS-CF-DEFAULT-APR
  5727                                 TO  CP-LOAN-APR
  5728           END-IF
  5729        END-IF
  5730     END-IF
  5731*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5732*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5733*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5734*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5735*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5736*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5737*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5738*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5739*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5740*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5741*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5742*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5743*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5744*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5745*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5746*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5747*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5748*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5749     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5750     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5751     DISPLAY ' MADE IT BACK FROM ELRFND '
  5752     IF (CP-ERROR-RATE-IS-ZERO)
  5753        OR (CP-ERROR-RATE-NOT-FOUND)
  5754        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5755        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 101
* SOCK03.cbl
  5756          DELIMITED BY SIZE INTO WS-COMMENT
  5757        END-STRING
  5758        MOVE 'X'                 TO WS-LF-STATUS
  5759        GO TO 0400-EXIT
  5760*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5761*       IF NOT ALREADY-SENT
  5762*          PERFORM 0020-SEND-BUFFER
  5763*                                THRU 0020-EXIT
  5764*          SET ALREADY-SENT      TO TRUE
  5765*       END-IF
  5766*       PERFORM 0025-CLOSE-SOCKET
  5767*                                THRU 0025-EXIT
  5768*       GO TO 0010-RETURN
  5769     END-IF
  5770     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5771                                    WS-TOT-LF-RFND
  5772     IF (WS-LF-STATUS = SPACES)
  5773        OR (CP-CALC-REFUND > ZEROS)
  5774        MOVE 'A'                 TO WS-LF-STATUS
  5775     END-IF
  5776     EVALUATE TRUE
  5777        WHEN CP-R-AS-R78
  5778           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5779        WHEN  CP-R-AS-PRORATA
  5780           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5781        WHEN CP-R-AS-CALIF
  5782           MOVE 'CALIF'            TO  WS-LF-METHOD
  5783        WHEN CP-R-AS-TEXAS
  5784           MOVE 'IRREG'            TO  WS-LF-METHOD
  5785        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5786           MOVE 'UTAH'             TO  WS-LF-METHOD
  5787        WHEN CP-R-AS-FARM-PLAN
  5788           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5789        WHEN CP-R-AS-NET-PAY
  5790           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5791        WHEN CP-R-AS-ANTICIPATION
  5792           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5793        WHEN CP-R-AS-MEAN
  5794           MOVE 'MEAN'             TO  WS-LF-METHOD
  5795        WHEN CP-R-AS-SUM-OF-DIGITS
  5796           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5797     END-EVALUATE
  5798     IF WS-TOT-LF-RFND > ZEROS
  5799        COMPUTE WS-WORK-FACTOR ROUNDED =
  5800           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5801        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5802           WS-TOT-LF-COMM
  5803     END-IF
  5804     IF ERACCT-FOUND
  5805        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5806           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5807        END-IF
  5808        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5809           IF (AM-COMM-CHARGEBACK (1) = 99)
  5810                     OR
  5811              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5812                     OR
  5813              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 102
* SOCK03.cbl
  5814              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5815              MOVE ZEROS         TO WS-LF-UEC
  5816           END-IF
  5817        END-IF
  5818     END-IF
  5819     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5820        GO TO 0400-EXIT
  5821     END-IF
  5822     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5823     MOVE '2'                    TO  CP-EARNING-METHOD
  5824                                     CP-RATING-METHOD.
  5825     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5826                                     CP-REMAINING-BENEFIT
  5827                                     CP-RATING-BENEFIT-AMT.
  5828     IF CP-STATE-STD-ABBRV = 'OR'
  5829         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5830                                         CM-LF-ALT-BENEFIT-AMT.
  5831     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5832     IF ws-comp-id = 'CID'
  5833        IF (CP-STATE-STD-ABBRV = 'MN')
  5834           AND (CM-CERT-EFF-DT > X'A4FF')
  5835           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  5836           MOVE '5'              TO CP-EARNING-METHOD
  5837           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  5838        END-IF
  5839     END-IF
  5840     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5841     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5842     IF (CP-ERROR-RATE-IS-ZERO)
  5843        OR (CP-ERROR-RATE-NOT-FOUND)
  5844        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5845        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5846          DELIMITED BY SIZE INTO WS-COMMENT
  5847        END-STRING
  5848        MOVE 'X'              TO WS-LF-STATUS
  5849        GO TO 0400-EXIT
  5850*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5851*       IF NOT ALREADY-SENT
  5852*          PERFORM 0020-SEND-BUFFER
  5853*                                THRU 0020-EXIT
  5854*          SET ALREADY-SENT      TO TRUE
  5855*       END-IF
  5856*       PERFORM 0025-CLOSE-SOCKET
  5857*                                THRU 0025-EXIT
  5858*       GO TO 0010-RETURN
  5859     END-IF
  5860     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5861     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5862     IF WS-TOT-LF-RFND > ZEROS
  5863        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5864           WS-TOT-LF-COMM
  5865     END-IF
  5866     IF ERACCT-FOUND
  5867        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5868           IF (AM-COMM-CHARGEBACK (1) = 99)
  5869                     OR
  5870              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5871                     OR
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 103
* SOCK03.cbl
  5872              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5873              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5874              MOVE ZEROS         TO WS-LF-UEC
  5875           END-IF
  5876        END-IF
  5877     END-IF
  5878     .
  5879 0400-EXIT.
  5880     EXIT.
  5881 0500-PROCESS-AH.
  5882     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5883        GO TO 0500-EXIT
  5884     END-IF
  5885     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5886                                    WS-TOT-AH-PREM
  5887                                    WS-TOT-AH-COMM
  5888     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5889     MOVE ' '                    TO  DC-OPTION-CODE
  5890     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5891     IF NO-CONVERSION-ERROR
  5892        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5893     ELSE
  5894        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5895     END-IF
  5896     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  5897     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5898     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5899     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5900     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5901     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5902     MOVE CM-STATE               TO  CP-STATE.
  5903     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5904     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5905     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5906     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5907     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5908     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5909     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5910     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5911     MOVE WS-CF-CR-REM-TERM-CALC
  5912                                 TO  CP-REM-TERM-METHOD.
  5913     IF WS-AH-CO-REM-TERM-CALC > '0'
  5914         MOVE WS-AH-CO-REM-TERM-CALC
  5915                                 TO  CP-REM-TERM-METHOD.
  5916     IF WS-AH-ST-REM-TERM-CALC > '0'
  5917         MOVE WS-AH-ST-REM-TERM-CALC
  5918                                 TO  CP-REM-TERM-METHOD.
  5919     IF WS-AH-AM-REM-TERM-CALC > '0'
  5920         MOVE WS-AH-AM-REM-TERM-CALC
  5921                                 TO  CP-REM-TERM-METHOD.
  5922     IF (WS-COMP-ID = 'CID')
  5923        AND (CP-STATE-STD-ABBRV = 'WI')
  5924        MOVE '7'                 TO CP-REM-TERM-METHOD
  5925        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5926     END-IF
  5927     IF (WS-COMP-ID = 'CID')
  5928        AND (CP-STATE-STD-ABBRV = 'MO')
  5929        AND (CM-CERT-EFF-DT >= X'9B41')
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 104
* SOCK03.cbl
  5930        AND (CM-CERT-EFF-DT <= X'A2FB')
  5931        MOVE '7'                 TO CP-REM-TERM-METHOD
  5932        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5933     END-IF
  5934     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5935                                     CP-LOAN-TERM.
  5936     IF  NOT  CP-TERM-IS-DAYS
  5937         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5938             MOVE CM-PMT-EXTENSION-DAYS
  5939                                 TO  CP-TERM-OR-EXT-DAYS
  5940         ELSE
  5941             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5942     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5943     IF CM-AH-COMM-PCT > ZEROS
  5944        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5945           CM-AH-PREMIUM-AMT
  5946     END-IF
  5947     IF (ws-comp-id = 'DCC')
  5948        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5949        compute ws-tot-ah-comm = cm-ah-premium-amt -
  5950           (cm-ah-clp + cm-addl-clp)
  5951     end-if
  5952     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5953     IF WS-AH-STATUS = 'D'
  5954        GO TO 0500-EXIT
  5955     END-IF
  5956     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5957     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5958     MOVE ' '                    TO WS-CLM-STOP-SW
  5959     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5960     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5961
  5962* EXEC CICS STARTBR
  5963*       DATASET     ('ELMSTR5')
  5964*       RIDFLD      (ELMSTR-KEY)
  5965*       RESP        (WS-RESPONSE)
  5966*    END-EXEC
  5967     MOVE 'ELMSTR5' TO DFHEIV1
  5968     MOVE 0
  5969       TO DFHEIV11
  5970*    MOVE '&,         G          &  N#00005559' TO DFHEIV0
  5971     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5972     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5973     MOVE X'204E233030303035353539' TO DFHEIV0(25:11)
  5974     CALL 'kxdfhei1' USING DFHEIV0,
  5975           DFHEIV1,
  5976           ELMSTR-KEY,
  5977           DFHEIV99,
  5978           DFHEIV11,
  5979           DFHEIV99
  5980     MOVE EIBRESP  TO WS-RESPONSE
  5981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5982     DISPLAY ' AFTER START ' WS-RESPONSE
  5983     IF RESP-NORMAL
  5984        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5985           DISPLAY ' AH READNEXT '
  5986
  5987* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 105
* SOCK03.cbl
  5988*             DATASET   ('ELMSTR5')
  5989*             RIDFLD    (ELMSTR-KEY)
  5990*             INTO      (CLAIM-MASTER)
  5991*             RESP      (WS-RESPONSE)
  5992*          END-EXEC
  5993     MOVE LENGTH OF
  5994      CLAIM-MASTER
  5995       TO DFHEIV12
  5996     MOVE 'ELMSTR5' TO DFHEIV1
  5997     MOVE 0
  5998       TO DFHEIV11
  5999*    MOVE '&.IL                  )  N#00005568' TO DFHEIV0
  6000     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6001     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6002     MOVE X'204E233030303035353638' TO DFHEIV0(25:11)
  6003     CALL 'kxdfhei1' USING DFHEIV0,
  6004           DFHEIV1,
  6005           CLAIM-MASTER,
  6006           DFHEIV12,
  6007           ELMSTR-KEY,
  6008           DFHEIV99,
  6009           DFHEIV11,
  6010           DFHEIV99,
  6011           DFHEIV99
  6012     MOVE EIBRESP  TO WS-RESPONSE
  6013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6014        IF (RESP-NORMAL OR RESP-DUPKEY)
  6015           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6016           AND (CM-CERT-NO = CL-CERT-NO)
  6017           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6018              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6019              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6020                 IF CLAIM-IS-OPEN
  6021                    DISPLAY ' FOUND OPEN AH CLAIM '
  6022                    MOVE ' OPEN HEALTH CLAIM '
  6023                                 TO WS-COMMENT
  6024                    MOVE 'H'     TO WS-AH-STATUS
  6025                 ELSE
  6026                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6027                    MOVE ' CLOSED HEALTH CLAIM '
  6028                                 TO WS-COMMENT
  6029                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6030                       MOVE CL-PAID-THRU-DT
  6031                                 TO WS-AH-BIN-PAID-THRU-DT
  6032                    END-IF
  6033                 END-IF
  6034              END-IF
  6035           END-IF
  6036        ELSE
  6037           SET I-SAY-TO-STOP TO TRUE
  6038        END-IF
  6039        END-PERFORM
  6040
  6041* EXEC CICS ENDBR
  6042*          DATASET   ('ELMSTR5')
  6043*       END-EXEC
  6044     MOVE 'ELMSTR5' TO DFHEIV1
  6045     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 106
* SOCK03.cbl
  6046       TO DFHEIV11
  6047*    MOVE '&2                    $   #00005600' TO DFHEIV0
  6048     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6049     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6050     MOVE X'2020233030303035363030' TO DFHEIV0(25:11)
  6051     CALL 'kxdfhei1' USING DFHEIV0,
  6052           DFHEIV1,
  6053           DFHEIV11,
  6054           DFHEIV99
  6055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6056     END-IF
  6057     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6058*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6059        MOVE WS-AH-BIN-PAID-THRU-DT
  6060                                 TO DC-BIN-DATE-1
  6061        MOVE ' '                 TO DC-OPTION-CODE
  6062        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6063        IF NO-CONVERSION-ERROR
  6064           MOVE DC-GREG-DATE-CYMD
  6065                                 TO WS-CLM-PAID-THRU-DT
  6066        ELSE
  6067           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6068        END-IF
  6069        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6070           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6071                                 TO WS-COMMENT
  6072           MOVE 'P'              TO WS-AH-STATUS
  6073           GO TO 0500-EXIT
  6074        END-IF
  6075     END-IF
  6076     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6077     IF CM-AH-CURRENT-STATUS = '8'
  6078        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6079           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6080                                 TO WS-COMMENT
  6081           MOVE 'C'              TO WS-AH-STATUS
  6082           GO TO 0500-EXIT
  6083        END-IF
  6084     END-IF
  6085     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6086        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6087           MOVE ' SETTLEMENT CLAIM APPLIED '
  6088                                 TO WS-COMMENT
  6089           MOVE 'S'              TO WS-AH-STATUS
  6090*          PERFORM 0030-BUILD-BUFFER
  6091*                                THRU 0030-EXIT
  6092*          IF NOT ALREADY-SENT
  6093*             PERFORM 0020-SEND-BUFFER
  6094*                                THRU 0020-EXIT
  6095*             SET ALREADY-SENT   TO TRUE
  6096*          END-IF
  6097           GO TO 0500-EXIT
  6098*          PERFORM 0025-CLOSE-SOCKET
  6099*                                THRU 0025-EXIT
  6100*          GO TO 0010-RETURN
  6101        END-IF
  6102     END-IF
  6103     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 107
* SOCK03.cbl
  6104        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6105        MOVE 'AH COVERAGE EXPIRED '
  6106                                 TO WS-COMMENT
  6107        MOVE 'E'                 TO WS-AH-STATUS
  6108        GO TO 0500-EXIT
  6109     END-IF
  6110     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6111                                    WS-AH-PREM
  6112     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6113     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6114        * CP-REMAINING-TERM-1
  6115     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6116                                     WS-AH-REM-TERM
  6117     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6118     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6119     IF WS-AH-ST-REFUND-CALC > ZERO
  6120         MOVE WS-AH-ST-REFUND-CALC
  6121                                 TO  CP-EARNING-METHOD.
  6122     IF WS-AH-FO-REFUND-CALC > ZERO
  6123         MOVE WS-AH-FO-REFUND-CALC
  6124                                 TO  CP-EARNING-METHOD.
  6125*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6126     if ws-comp-id = 'AHL'
  6127        move cm-ah-class-cd      to cp-class-code
  6128        if cp-class-code = spaces
  6129           move zeros            to cp-class-code
  6130        end-if
  6131     else
  6132        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6133     end-if
  6134     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6135     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6136                                     CP-RATING-BENEFIT-AMT.
  6137     IF CP-STATE-STD-ABBRV = 'OR'
  6138         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6139                                         CM-AH-ORIG-TERM.
  6140     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6141     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6142     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6143     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6144     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6145     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6146     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6147     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6148     MOVE ' '                    TO  DC-OPTION-CODE.
  6149     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6150     IF CP-STATE-STD-ABBRV = 'OH'
  6151        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6152         IF (CP-ORIGINAL-TERM > 60)
  6153           AND (DC-GREG-DATE-1-YMD > '831101')
  6154           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6155             MOVE '6'            TO  CP-EARNING-METHOD
  6156         END-IF
  6157        END-IF
  6158        IF WS-COMP-ID = 'CID'
  6159           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6160                           LOW-VALUES)
  6161              IF CP-CRITICAL-PERIOD
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 108
* SOCK03.cbl
  6162                 MOVE '2'       TO CP-EARNING-METHOD
  6163              ELSE
  6164                 MOVE '6'       TO CP-EARNING-METHOD
  6165              END-IF
  6166           ELSE
  6167              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6168                 MOVE '2'       TO CP-EARNING-METHOD
  6169              ELSE
  6170                 IF ((CM-LF-ORIG-TERM > 60) AND
  6171                    (CM-RATE-CLASS NOT = 'L '))
  6172                               OR
  6173                    (WS-LF-CO-EARNINGS-CALC = '5')
  6174                    IF CP-CRITICAL-PERIOD
  6175                       MOVE '2'  TO CP-EARNING-METHOD
  6176                    ELSE
  6177                       MOVE '6'  TO CP-EARNING-METHOD
  6178                    END-IF
  6179                 ELSE
  6180                    MOVE '1'     TO CP-EARNING-METHOD
  6181                 END-IF
  6182              END-IF
  6183           END-IF
  6184        END-IF
  6185     END-IF
  6186     IF CP-STATE-STD-ABBRV = 'VA'
  6187       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6188         IF DC-GREG-DATE-1-YMD > '921231'
  6189            IF CP-ORIGINAL-TERM > 61
  6190                MOVE '6'            TO  CP-EARNING-METHOD
  6191            ELSE
  6192                MOVE '1'            TO  CP-EARNING-METHOD.
  6193     IF CP-EARN-AS-NET-PAY
  6194        IF CP-LOAN-APR <= ZEROS
  6195           IF WS-CF-DEFAULT-APR > ZEROS
  6196              MOVE WS-CF-DEFAULT-APR
  6197                                 TO  CP-LOAN-APR
  6198           END-IF
  6199        END-IF
  6200     END-IF
  6201     IF WS-COMP-ID = 'DCC'
  6202        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6203           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6204           MOVE 'S'              TO CP-EARNING-METHOD
  6205        END-IF
  6206     END-IF
  6207     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6208     IF (WS-COMP-ID = 'DCC')
  6209        AND (CP-EARNING-METHOD = 'D')
  6210        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6211                                    WS-DDF-CSO-ADMIN-FEE
  6212                                    WS-DDF-1ST-YR-TOT-EXP
  6213                                    WS-DDF-COMM-AND-MFEE
  6214        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6215           S1 > +10
  6216           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6217              IF (AM-A-COM (S1) NUMERIC)
  6218                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6219                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 109
* SOCK03.cbl
  6220              ELSE
  6221                 MOVE +0         TO WS-COMM-PCT C0
  6222                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6223                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6224              END-IF
  6225              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6226                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6227                    + WS-COMM-PCT
  6228              END-IF
  6229              IF AM-COM-TYP (S1) = 'N'
  6230                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6231                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6232              END-IF
  6233              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6234                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6235                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6236              END-IF
  6237              IF AM-COM-TYP (S1) = 'I'
  6238                 COMPUTE WS-DDF-COMM-AND-MFEE
  6239                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6240              END-IF
  6241           END-IF
  6242        END-PERFORM
  6243        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6244        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6245        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6246           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6247     END-IF
  6248     IF (WS-COMP-ID = 'DCC')
  6249        AND (CP-EARNING-METHOD = 'D')
  6250        AND (ws-CANCEL-REASON NOT = 'R')
  6251        PERFORM 0730-GET-DDF-FACTORS
  6252                                 THRU 0730-EXIT
  6253        IF NOT PDEF-FOUND
  6254           MOVE ' DDF UE FACTORS  NOT FOUND '
  6255                                 TO WS-COMMENT
  6256           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6257           PERFORM 0030-BUILD-BUFFER
  6258                                 THRU 0030-EXIT
  6259           PERFORM 0020-SEND-BUFFER
  6260                                 THRU 0020-EXIT
  6261           PERFORM 0025-CLOSE-SOCKET
  6262                                 THRU 0025-EXIT
  6263           GO TO 0010-RETURN
  6264        END-IF
  6265*       IF NOT PDEF-FOUND
  6266*          MOVE ER-9999          TO EMI-ERROR
  6267*          PERFORM 9700-ERROR-FORMAT
  6268*                                THRU 9799-EXIT
  6269*          GO TO 8200-SEND-DATAONLY
  6270*       END-IF
  6271        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6272                                 TO CP-DDF-LO-FACT
  6273        MOVE PD-UEP-FACTOR (P1 P2)
  6274                                 TO CP-DDF-HI-FACT
  6275        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6276        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6277        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 110
* SOCK03.cbl
  6278        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6279           + PD-1ST-YR-ADMIN-ALLOW
  6280        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6281*       IF PI-CLP-YN = 'Y'
  6282*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6283*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6284*                                   CP-DDF-CLP
  6285*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6286*       END-IF
  6287        IF DD-IU-PRESENT
  6288           MOVE 'I'              TO CP-EARNING-METHOD
  6289        END-IF
  6290        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6291                                    CP-CLP-RATE-UP
  6292        IF (CP-CALC-GROSS-FEE)
  6293           AND (CP-IU-RATE-UP NOT = ZEROS)
  6294           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6295              / CP-ORIGINAL-PREMIUM)
  6296           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6297              / (1 - TEX-FACT-8)
  6298        END-IF
  6299     END-IF
  6300     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6301     IF (CP-ERROR-RATE-IS-ZERO)
  6302        OR (CP-ERROR-RATE-NOT-FOUND)
  6303        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6304        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6305          DELIMITED BY SIZE INTO WS-COMMENT
  6306        END-STRING
  6307        IF WS-AH-STATUS NOT = 'H'
  6308           MOVE 'X'                 TO WS-AH-STATUS
  6309        END-IF
  6310        GO TO 0500-EXIT
  6311*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6312*       IF NOT ALREADY-SENT
  6313*          PERFORM 0020-SEND-BUFFER
  6314*                                THRU 0020-EXIT
  6315*          SET ALREADY-SENT      TO TRUE
  6316*       END-IF
  6317*       PERFORM 0025-CLOSE-SOCKET
  6318*                                THRU 0025-EXIT
  6319*       GO TO 0010-RETURN
  6320     END-IF
  6321     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6322                                    WS-TOT-AH-RFND
  6323     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6324     IF ((WS-AH-STATUS = SPACES)
  6325        OR (CP-CALC-REFUND > ZEROS))
  6326                  AND
  6327          (WS-AH-STATUS NOT = 'H')
  6328        MOVE 'A'                 TO WS-AH-STATUS
  6329     END-IF
  6330     IF WS-COMP-ID = 'DCC'
  6331        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6332        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6333        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6334        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6335        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 111
* SOCK03.cbl
  6336        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6337        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6338        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6339        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6340     END-IF
  6341     EVALUATE TRUE
  6342        WHEN CP-R-AS-R78
  6343           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6344        WHEN CP-R-AS-PRORATA
  6345           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6346        WHEN CP-REFUND-TYPE-USED = '3'
  6347           MOVE 'CALIF'            TO  WS-AH-METHOD
  6348        WHEN CP-R-AS-TEXAS
  6349           MOVE 'IRREG'            TO  WS-AH-METHOD
  6350        WHEN CP-R-AS-FARM-PLAN
  6351           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6352        WHEN CP-R-AS-NET-PAY
  6353           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6354        WHEN CP-R-AS-ANTICIPATION
  6355           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6356        WHEN CP-R-AS-MEAN
  6357           MOVE 'MEAN'             TO  WS-AH-METHOD
  6358        WHEN CP-R-AS-SUM-OF-DIGITS
  6359           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6360        WHEN CP-GAP-ACTUARIAL
  6361           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6362     END-EVALUATE
  6363     IF WS-TOT-AH-RFND > ZEROS
  6364        IF (ws-comp-id = 'DCC')
  6365           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6366           compute ws-work-factor rounded =
  6367              ws-ah-rfnd-clp / cm-ah-clp
  6368        else
  6369           COMPUTE WS-WORK-FACTOR ROUNDED =
  6370              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6371        end-if
  6372        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6373           WS-TOT-AH-COMM
  6374     END-IF
  6375     IF ERACCT-FOUND
  6376        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6377           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6378        END-IF
  6379        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6380           IF (AM-COMM-CHARGEBACK (1) = 99)
  6381                     OR
  6382              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6383                     OR
  6384              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6385              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6386              MOVE ZEROS         TO WS-AH-UEC
  6387           END-IF
  6388        END-IF
  6389     END-IF
  6390     .
  6391 0500-EXIT.
  6392     EXIT.
  6393 0700-LINK-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 112
* SOCK03.cbl
  6394
  6395* EXEC CICS LINK
  6396*        PROGRAM   ('ELRTRM')
  6397*        COMMAREA  (CALCULATION-PASS-AREA)
  6398*        LENGTH    (CP-COMM-LENGTH)
  6399*    END-EXEC.
  6400     MOVE 'ELRTRM' TO DFHEIV1
  6401*    MOVE '."C                   (   #00005941' TO DFHEIV0
  6402     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6403     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6404     MOVE X'2020233030303035393431' TO DFHEIV0(25:11)
  6405     CALL 'kxdfhei1' USING DFHEIV0,
  6406           DFHEIV1,
  6407           CALCULATION-PASS-AREA,
  6408           CP-COMM-LENGTH,
  6409           DFHEIV99,
  6410           DFHEIV99,
  6411           DFHEIV99,
  6412           DFHEIV99
  6413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6414
  6415 0700-EXIT.
  6416     EXIT.
  6417 0710-LINK-REM-AMOUNT.
  6418
  6419* EXEC CICS LINK
  6420*        PROGRAM   ('ELRAMT')
  6421*        COMMAREA  (CALCULATION-PASS-AREA)
  6422*        LENGTH    (CP-COMM-LENGTH)
  6423*    END-EXEC
  6424     MOVE 'ELRAMT' TO DFHEIV1
  6425*    MOVE '."C                   (   #00005949' TO DFHEIV0
  6426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6428     MOVE X'2020233030303035393439' TO DFHEIV0(25:11)
  6429     CALL 'kxdfhei1' USING DFHEIV0,
  6430           DFHEIV1,
  6431           CALCULATION-PASS-AREA,
  6432           CP-COMM-LENGTH,
  6433           DFHEIV99,
  6434           DFHEIV99,
  6435           DFHEIV99,
  6436           DFHEIV99
  6437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6438     .
  6439 0710-EXIT.
  6440     EXIT.
  6441 0720-LINK-REFUND.
  6442
  6443* EXEC CICS LINK
  6444*        PROGRAM   ('ELRFND')
  6445*        COMMAREA  (CALCULATION-PASS-AREA)
  6446*        LENGTH    (CP-COMM-LENGTH)
  6447*    END-EXEC
  6448     MOVE 'ELRFND' TO DFHEIV1
  6449*    MOVE '."C                   (   #00005958' TO DFHEIV0
  6450     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 113
* SOCK03.cbl
  6452     MOVE X'2020233030303035393538' TO DFHEIV0(25:11)
  6453     CALL 'kxdfhei1' USING DFHEIV0,
  6454           DFHEIV1,
  6455           CALCULATION-PASS-AREA,
  6456           CP-COMM-LENGTH,
  6457           DFHEIV99,
  6458           DFHEIV99,
  6459           DFHEIV99,
  6460           DFHEIV99
  6461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6462     .
  6463 0720-EXIT.
  6464     EXIT.
  6465 0730-GET-DDF-FACTORS.
  6466     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6467     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6468     MOVE CM-STATE               TO ERPDEF-STATE
  6469     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6470     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6471     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6472     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6473     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6474
  6475* EXEC CICS STARTBR
  6476*        DATASET  ('ERPDEF')
  6477*        RIDFLD   (ERPDEF-KEY)
  6478*        GTEQ
  6479*        RESP     (WS-RESPONSE)
  6480*    END-EXEC
  6481     MOVE 'ERPDEF' TO DFHEIV1
  6482     MOVE 0
  6483       TO DFHEIV11
  6484*    MOVE '&,         G          &  N#00005975' TO DFHEIV0
  6485     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6486     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6487     MOVE X'204E233030303035393735' TO DFHEIV0(25:11)
  6488     CALL 'kxdfhei1' USING DFHEIV0,
  6489           DFHEIV1,
  6490           ERPDEF-KEY,
  6491           DFHEIV99,
  6492           DFHEIV11,
  6493           DFHEIV99
  6494     MOVE EIBRESP  TO WS-RESPONSE
  6495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6496     IF NOT RESP-NORMAL
  6497        GO TO 0730-EXIT
  6498     END-IF
  6499     .
  6500 0730-READNEXT.
  6501
  6502* EXEC CICS READNEXT
  6503*       DATASET  ('ERPDEF')
  6504*       INTO     (PRODUCT-MASTER)
  6505*       RIDFLD   (ERPDEF-KEY)
  6506*       RESP     (WS-RESPONSE)
  6507*    END-EXEC
  6508     MOVE LENGTH OF
  6509      PRODUCT-MASTER
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 114
* SOCK03.cbl
  6510       TO DFHEIV12
  6511     MOVE 'ERPDEF' TO DFHEIV1
  6512     MOVE 0
  6513       TO DFHEIV11
  6514*    MOVE '&.IL                  )  N#00005986' TO DFHEIV0
  6515     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6516     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6517     MOVE X'204E233030303035393836' TO DFHEIV0(25:11)
  6518     CALL 'kxdfhei1' USING DFHEIV0,
  6519           DFHEIV1,
  6520           PRODUCT-MASTER,
  6521           DFHEIV12,
  6522           ERPDEF-KEY,
  6523           DFHEIV99,
  6524           DFHEIV11,
  6525           DFHEIV99,
  6526           DFHEIV99
  6527     MOVE EIBRESP  TO WS-RESPONSE
  6528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6529     IF NOT RESP-NORMAL
  6530        GO TO 0730-ENDBR
  6531     END-IF
  6532     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6533        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6534           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6535        ELSE
  6536           GO TO 0730-READNEXT
  6537        END-IF
  6538     ELSE
  6539        GO TO 0730-ENDBR
  6540     END-IF
  6541     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6542        (P1 > +8)
  6543        OR (PD-PROD-CODE (P1) = 'I')
  6544     END-PERFORM
  6545     IF P1 < +9
  6546        SET DD-IU-PRESENT        TO TRUE
  6547     END-IF
  6548     IF CM-LOAN-TERM = ZEROS
  6549        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  6550     END-IF
  6551     IF PD-TRUNCATED = 'Y'
  6552        MOVE CM-LOAN-TERM        TO WS-TERM
  6553     ELSE
  6554        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  6555     END-IF
  6556     EVALUATE TRUE
  6557        WHEN WS-TERM > +168
  6558           MOVE 15               TO P1
  6559        WHEN WS-TERM > +156
  6560           MOVE 14               TO P1
  6561        WHEN WS-TERM > +144
  6562           MOVE 13               TO P1
  6563        WHEN WS-TERM > +132
  6564           MOVE 12               TO P1
  6565        WHEN WS-TERM > +120
  6566           MOVE 11               TO P1
  6567        WHEN WS-TERM > +108
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 115
* SOCK03.cbl
  6568           MOVE 10               TO P1
  6569        WHEN WS-TERM > +96
  6570           MOVE 9                TO P1
  6571        WHEN WS-TERM > +84
  6572           MOVE 8                TO P1
  6573        WHEN WS-TERM > +72
  6574           MOVE 7                TO P1
  6575        WHEN WS-TERM > +60
  6576           MOVE 6                TO P1
  6577        WHEN WS-TERM > +48
  6578           MOVE 5                TO P1
  6579        WHEN WS-TERM > +36
  6580           MOVE 4                TO P1
  6581        WHEN WS-TERM > +24
  6582           MOVE 3                TO P1
  6583        WHEN WS-TERM > +12
  6584           MOVE 2                TO P1
  6585        WHEN OTHER
  6586           MOVE 1                TO P1
  6587     END-EVALUATE
  6588     EVALUATE TRUE
  6589*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  6590*          AND (DD-IU-PRESENT)
  6591*          MOVE 2                TO P2
  6592*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  6593*          MOVE 1                TO P2
  6594        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  6595           MOVE 2                TO P2
  6596        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  6597           MOVE 3                TO P2
  6598        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  6599           MOVE 4                TO P2
  6600        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  6601           MOVE 5                TO P2
  6602        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  6603           MOVE 6                TO P2
  6604        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  6605           MOVE 7                TO P2
  6606        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  6607           MOVE 8                TO P2
  6608        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  6609           MOVE 9                TO P2
  6610        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  6611           MOVE 10               TO P2
  6612        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  6613           MOVE 11               TO P2
  6614        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  6615           MOVE 12               TO P2
  6616        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  6617           MOVE 13               TO P2
  6618        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  6619           MOVE 14               TO P2
  6620        WHEN OTHER
  6621           MOVE 15               TO P2
  6622     END-EVALUATE
  6623     .
  6624 0730-ENDBR.
  6625
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 116
* SOCK03.cbl
  6626* EXEC CICS ENDBR
  6627*       DATASET  ('ERPDEF')
  6628*    END-EXEC
  6629     MOVE 'ERPDEF' TO DFHEIV1
  6630     MOVE 0
  6631       TO DFHEIV11
  6632*    MOVE '&2                    $   #00006088' TO DFHEIV0
  6633     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6634     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6635     MOVE X'2020233030303036303838' TO DFHEIV0(25:11)
  6636     CALL 'kxdfhei1' USING DFHEIV0,
  6637           DFHEIV1,
  6638           DFHEIV11,
  6639           DFHEIV99
  6640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6641     .
  6642 0730-EXIT.
  6643     EXIT.
  6644 0740-GET-ERCTBL.
  6645     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6646     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6647     MOVE 'A'                    TO CTBL-BEN-TYPE
  6648     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  6649     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6650     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6651     IF RESP-NORMAL
  6652        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6653     ELSE
  6654        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6655        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6656        MOVE 'A'                    TO CTBL-BEN-TYPE
  6657        MOVE 'AA'                   TO CTBL-BEN-CODE
  6658        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6659        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6660        IF RESP-NORMAL
  6661           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6662        END-IF
  6663     END-IF
  6664     .
  6665 0740-EXIT.
  6666     EXIT.
  6667 0750-READ-ERCTBL.
  6668
  6669* EXEC CICS READ
  6670*         INTO    (COMM-TABLE-RECORD)
  6671*         DATASET ('ERCTBL')
  6672*         RIDFLD  (CTBL-KEY)
  6673*         RESP    (WS-RESPONSE)
  6674*    END-EXEC
  6675     MOVE LENGTH OF
  6676      COMM-TABLE-RECORD
  6677       TO DFHEIV11
  6678     MOVE 'ERCTBL' TO DFHEIV1
  6679*    MOVE '&"IL       E          (  N#00006118' TO DFHEIV0
  6680     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6681     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6682     MOVE X'204E233030303036313138' TO DFHEIV0(25:11)
  6683     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 117
* SOCK03.cbl
  6684           DFHEIV1,
  6685           COMM-TABLE-RECORD,
  6686           DFHEIV11,
  6687           CTBL-KEY,
  6688           DFHEIV99,
  6689           DFHEIV99,
  6690           DFHEIV99
  6691     MOVE EIBRESP  TO WS-RESPONSE
  6692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6693     .
  6694 0750-EXIT.
  6695     EXIT.
  6696 0760-FIND-COMM.
  6697     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  6698        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  6699        OR (C1 > +3)
  6700     END-PERFORM
  6701     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  6702        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  6703        OR (C2 > +3)
  6704     END-PERFORM
  6705     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  6706        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  6707        OR (C3 > +3)
  6708     END-PERFORM
  6709     IF C1 > +3
  6710        MOVE +1                  TO C1
  6711     END-IF
  6712     IF C2 > +3
  6713        MOVE +1                  TO C2
  6714     END-IF
  6715     IF C3 > +3
  6716        MOVE +1                  TO C3
  6717     END-IF
  6718     IF C1 = +3
  6719        MOVE +18                 TO C0
  6720     ELSE
  6721        IF C1 = +2
  6722           MOVE +9               TO C0
  6723        END-IF
  6724     END-IF
  6725     IF C2 = +3
  6726        ADD +6                   TO C0
  6727     ELSE
  6728        IF C2 = +2
  6729           ADD +3                TO C0
  6730        END-IF
  6731     END-IF
  6732     ADD C3                      TO C0
  6733     MOVE CT-RT (C0)             TO WS-COMM-PCT
  6734     .
  6735 0760-EXIT.
  6736     EXIT.
  6737 9700-DATE-LINK.
  6738
  6739* EXEC CICS LINK
  6740*         PROGRAM  ('ELDATCV')
  6741*         COMMAREA (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 04-Sep-14 09:33 Page 118
* SOCK03.cbl
  6742*         LENGTH   (DC-COMM-LENGTH)
  6743*    END-EXEC.
  6744     MOVE 'ELDATCV' TO DFHEIV1
  6745*    MOVE '."C                   (   #00006169' TO DFHEIV0
  6746     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6748     MOVE X'2020233030303036313639' TO DFHEIV0(25:11)
  6749     CALL 'kxdfhei1' USING DFHEIV0,
  6750           DFHEIV1,
  6751           DATE-CONVERSION-DATA,
  6752           DC-COMM-LENGTH,
  6753           DFHEIV99,
  6754           DFHEIV99,
  6755           DFHEIV99,
  6756           DFHEIV99
  6757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6758
  6759 9700-EXIT.
  6760      EXIT.
  6761
  6762 9999-DFHBACK SECTION.
  6763     MOVE '9%                    "   ' TO DFHEIV0
  6764     MOVE 'SOCK03' TO DFHEIV1
  6765     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6766     GOBACK.
  6767 9999-DFHEXIT.
  6768     IF DFHEIGDJ EQUAL 0001
  6769         NEXT SENTENCE.
  6770     MOVE '9%                    "   ' TO DFHEIV0
  6771     MOVE 'SOCK03' TO DFHEIV1
  6772     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6773     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18424     Code:       28522
