* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   1
* EL050.cbl
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43******************************************************************
    44 ENVIRONMENT DIVISION.
    45
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   2
* EL050.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50
    51 77  FILLER   PIC X(32) VALUE '********************************'.
    52 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    53 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    54
    55 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    56 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    57                                   USAGE POINTER.
    58 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    59 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    60 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    61                                   USAGE IS POINTER.
    62 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    63 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    64                                   USAGE IS POINTER.
    65 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    71                                   USAGE IS POINTER.
    72
    73*    COPY ELC50WS.
    74*****************************************************************
    75*                                                               *
    76*                            ELC50WS.                           *
    77*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    78*                            VMOD=2.061.                        *
    79*                                                               *
    80*   THIS IS THE WORKING STORAGE FOR EL050                       *
    81*                                   EL517                       *
    82*****************************************************************
    83******************************************************************
    84*                   C H A N G E   L O G
    85*
    86* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    87*-----------------------------------------------------------------
    88*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    89* EFFECTIVE    NUMBER
    90*-----------------------------------------------------------------
    91* 123102                   PEMA  ADD DCC PROCESSING
    92* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    93* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    94* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    95* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    96* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    97* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    98* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    99* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   100* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   101* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   102* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   103* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   104* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   105* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   3
* EL050.cbl
   106* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   107* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   108* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   109* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   110* 030309  CR2009021700001  PEMA  ADD ER-2883
   111* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   113* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   114* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   115* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   116* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   117* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   118* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   119* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   120* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   121* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   122* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   123* 061412  CR2011022800001  AJRA  NAPERSOFT
   124*-----------------------------------------------------------------
   125
   126 01  WORK-AREAS.
   127
   128*****************************************************************
   129*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   130*****************************************************************
   131
   132     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   133     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   134     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   135     12  WS-NAME-EDIT-WORK-AREA.
   136         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   137         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   138             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   139         16  WS-WORK-NAME.
   140             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   141             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   142             20  FILLER           PIC X(10)     VALUE SPACES.
   143         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   144             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   145
   146*****************************************************************
   147*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   148*****************************************************************
   149
   150     12  WS-ERRESC-KEY.
   151         16 WS-ERRESC-SEARCH-KEY.
   152             20  WS-ERRESC-COMPANY-CD PIC  X.
   153             20  WS-ERRESC-CARRIER    PIC  X.
   154             20  WS-ERRESC-GROUP      PIC X(6).
   155             20  WS-ERRESC-STATE      PIC XX.
   156             20  WS-ERRESC-ACCOUNT    PIC X(10).
   157         16 WS-ERRESC-RESIDUAL-KEY.
   158             20  WS-ERRESC-AGENT      PIC X(10).
   159             20  WS-ERRESC-RES-STATE  PIC XX.
   160             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   161*                                          YYYYMMDD
   162     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   163     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   4
* EL050.cbl
   164
   165*RESIDENT STATE TAX MASTER(ERRESS)
   166*
   167     12  WS-ERRESS-KEY.
   168         16  WS-ERRESS-COMPANY-CD      PIC  X.
   169         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   170         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   171         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   172*                                          YYYYMMDD
   173
   174     12  WS-CONTRACT-DATE              PIC 9(8).
   175*                                          YYYYMMDD
   176     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   177     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   178         16 WS-YEAR-YY                 PIC   9999.
   179         16 FILLER                     PIC 9(4).
   180*                                          YYYYMMDD
   181     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   182     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   183     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   184     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   185
   186     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   187         88  DPRB-1ST-TIME                      VALUE ' '.
   188
   189*****************************************************************
   190*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   191*****************************************************************
   192
   193     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   194     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   195     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   196     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   197     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   198     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   199     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   200     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   201     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   202     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   203         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   204         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   205     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   206         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   207         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   208     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   209
   210     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   211     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   212
   213     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   214     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   215     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   218     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   5
* EL050.cbl
   222     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   224     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   226     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   227     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   228     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   249     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   250     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   251     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   252     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   256     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   261     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   262     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   263     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   264     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   265     12  WS-2671-SW               PIC X         VALUE SPACE.
   266     12  WS-2672-SW               PIC X         VALUE SPACE.
   267     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   268         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   269     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   270         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   271     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   272
   273     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   274         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   275         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   276         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   277         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   278
   279     12  WS-CREDIT-EDIT-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   6
* EL050.cbl
   280         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   281         16  WS-MIN-AGE           PIC 99                VALUE  0.
   282         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   283         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   284         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   285         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   286
   287     12  WS-SAVE-ALLOWABLE-BENEFIT.
   288         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   289         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   290         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   291         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   292         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   293         16  FILLER                      PIC XX.
   294
   295     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   296     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   297     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   298     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   299     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   300     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   301     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   302     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   303     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   304     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   305
   306     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   307     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   308     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   309     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   310     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   311     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   312     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   313     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   314         88  WS-REDUCING              VALUE 'R'.
   315         88  WS-LEVEL                 VALUE 'L' 'P'.
   316     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   317
   318     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   319     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   320     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   321     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   322     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   323     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   324     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   325     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   326     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   327
   328     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   329     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   330     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   332     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   333     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   334     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   335     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   336     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   337     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   7
* EL050.cbl
   338     12  WS-ACCT-SIG-SW.
   339         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   340         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   341     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   342     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   343     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   345     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   346     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   347     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   348     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   349     12  WS-INITIALS.
   350         16  WS-INIT-1            PIC X         VALUE SPACES.
   351         16  WS-INIT-2            PIC X         VALUE SPACES.
   352
   353     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   354     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   355     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   356     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   357     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   358*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   359     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   361     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   362     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   363     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   364     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   365     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   366     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   367     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   369     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   370     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   371     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   372     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   373     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   374     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   377     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   378     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   379     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   380     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   381******** FLA
   382     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   383     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   386     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   387********
   388     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   389     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   390     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   391     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   392     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   393     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   394     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   395     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   8
* EL050.cbl
   396     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   397     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   398
   399     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   400         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   401                                         '0' THRU '9'.
   402
   403     12  NUMBER-OF-MONTHS.
   404         16  SK-MO OCCURS 12 TIMES PIC X.
   405
   406     12  WS-WORK-DATE.
   407         16  WS-YEAR            PIC 99    VALUE 00.
   408         16  WS-MONTH           PIC 99    VALUE 00.
   409         16  WS-DAY             PIC 99    VALUE 00.
   410
   411     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   412     12  WS-WORK-CRIT-DEV       REDEFINES
   413         WS-WORK-LF-CRIT-PER    PIC X(03).
   414
   415     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   416     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   417
   418     12  WS-WORK-DATE-FROM.
   419         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   420         16  FILLER             PIC X  VALUE SPACE.
   421         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   424
   425     12  WS-WORK-DATE-THRU.
   426         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   427         16  FILLER             PIC X         VALUE SPACE.
   428         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   429         16  FILLER             PIC X         VALUE SPACE.
   430         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   431
   432     12  WS-LF-INPUT-CD.
   433         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   434         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   435
   436     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   437     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   438         16  WS-AH-INPUT-CD-1   PIC X.
   439         16  WS-AH-INPUT-CD-2-3 PIC XX.
   440
   441     12  WS-SWITCHES.
   442         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   443         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   444             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   445         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   446             88  BANK-ACCT-FOUND          VALUE 'Y'.
   447         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   448             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   449         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   450             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   451         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   452             88  COMP-MASTER-FOUND        VALUE 'Y'.
   453         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page   9
* EL050.cbl
   454             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   455         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   456             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   457         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   458             88  STAT-MASTER-FOUND        VALUE 'Y'.
   459         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   460             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   461         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   462             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   463         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   464             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   465         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   466             88  FORM-MASTER-FOUND        VALUE 'Y'.
   467         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   468             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   469         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   470             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   471         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   472             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   473         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   474             88  NO-BENEFIT-FOUND         VALUE 'N'.
   475         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   476             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   477         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   478             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   479         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   480             88  AH-BENEFIT-FOUND         VALUE ' '.
   481             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   482         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   483             88  LF-BENEFIT-FOUND         VALUE ' '.
   484             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   485         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   486             88  NO-STATE-RECORD          VALUE '1'.
   487         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   488             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   489         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   490             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   491         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   492             88  CERT-WAS-FOUND           VALUE ' '.
   493             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   494         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   495             88  BROWSE-STARTED           VALUE 'Y'.
   496         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   497             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   498         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   499             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   500         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   501             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   502         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   503             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   504         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   505             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   506         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   507             88  APP-CERT-USED            VALUE 'Y' 'A'.
   508         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   509             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   510             88  FIRST-TIME-THROUGH       VALUE '1'.
   511             88  CTBL-NOT-FOUND           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  10
* EL050.cbl
   512
   513         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   514             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   515
   516         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   517             88  DLO-ERROR-FOUND          VALUE 'Y'.
   518
   519********FLA
   520     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   521     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   522********
   523     12  RC-SW-1                  PIC X           VALUE '0'.
   524     12  RC-SW-2                  PIC X           VALUE '0'.
   525     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   526     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   527     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   530     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   531     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   532     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   533     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   534     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   535     12  LIT-SPACES               PIC X           VALUE SPACES.
   536     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   537     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   538     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   539     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   540     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   541     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   542     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   543         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   544         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   545     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   546         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   547
   548 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   549     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   550     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   551 01  WS-CRI-SSN-WORK-AREA.
   552     05  WS-CRI-SOC-SEC-NO.
   553         10  WS-SS-REPT-CD       PIC X(5).
   554         10  WS-SS-LAST-NAME     PIC X(5).
   555         10  WS-SS-INITIAL       PIC X.
   556
   557     05  WS-CRI-REPORT-CODE.
   558         10  FILLER              PIC X(5).
   559         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   560
   561     05  WS-CRI-LAST-NAME.
   562         10  WS-CRI-NAME-MOVE    PIC X(5).
   563         10  FILLER              PIC X(10).
   564
   565 01  WS-NUM-TABLE                PIC X(26)  VALUE
   566     '12345678012345070923456789'.
   567 01  FILLER REDEFINES WS-NUM-TABLE.
   568     05  WS-NUM OCCURS 26        PIC 9.
   569 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  11
* EL050.cbl
   570 01  V1                          PIC S999 COMP-3.
   571 01  V2                          PIC S999 COMP-3.
   572 01  V3                          PIC S999 COMP-3.
   573 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   574 01  FILLER REDEFINES WS-WORK-VIN.
   575     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   576 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   577 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   578 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   579 01  WS-HEX-WORK.
   580     05  FILLER                  PIC X  VALUE LOW-VALUES.
   581     05  WS-HEX-BYTE             PIC X.
   582 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   583 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   584 01  WS-WORK-HIN-ROW-B.
   585     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   586
   587 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   588 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   589     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   590 01  WS-ROW-D-TABLE.
   591     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   592
   593 01  WS-HIN-TABLE-B.
   594     05  F                       PIC XX VALUE 'A2'.
   595     05  F                       PIC XX VALUE 'B3'.
   596     05  F                       PIC XX VALUE 'C4'.
   597     05  F                       PIC XX VALUE 'D5'.
   598     05  F                       PIC XX VALUE 'E6'.
   599     05  F                       PIC XX VALUE 'F7'.
   600     05  F                       PIC XX VALUE 'G8'.
   601     05  F                       PIC XX VALUE 'H9'.
   602     05  F                       PIC XX VALUE 'I1'.
   603     05  F                       PIC XX VALUE 'J2'.
   604     05  F                       PIC XX VALUE 'K3'.
   605     05  F                       PIC XX VALUE 'L4'.
   606     05  F                       PIC XX VALUE 'M5'.
   607     05  F                       PIC XX VALUE 'N6'.
   608     05  F                       PIC XX VALUE 'O0'.
   609     05  F                       PIC XX VALUE 'P7'.
   610     05  F                       PIC XX VALUE 'Q0'.
   611     05  F                       PIC XX VALUE 'R8'.
   612     05  F                       PIC XX VALUE 'S9'.
   613     05  F                       PIC XX VALUE 'T2'.
   614     05  F                       PIC XX VALUE 'U3'.
   615     05  F                       PIC XX VALUE 'V4'.
   616     05  F                       PIC XX VALUE 'W5'.
   617     05  F                       PIC XX VALUE 'X6'.
   618     05  F                       PIC XX VALUE 'Y7'.
   619     05  F                       PIC XX VALUE 'Z8'.
   620 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   621     05  WS-VAL-IN               PIC X.
   622     05  WS-VAL-OUT              PIC 9.
   623 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   624 01  WS-COMPARE-BINARY-DATES.
   625     05  WS-971231                PIC XX VALUE X'92FF'.
   626     05  WS-931231                PIC XX VALUE X'8CFF'.
   627     05  WS-791231                PIC XX VALUE X'77FF'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  12
* EL050.cbl
   628     05  WS-771001                PIC XX VALUE X'74A1'.
   629     05  WS-820301                PIC XX VALUE X'7B41'.
   630     05  WS-831031                PIC XX VALUE X'7DBF'.
   631     05  WS-831231                PIC XX VALUE X'7DFF'.
   632     05  WS-810831                PIC XX VALUE X'7A7F'.
   633     05  WS-830901                PIC XX VALUE X'7D81'.
   634
   635 01  FILE-ACCESS-IDS.
   636     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   637     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   638     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   639     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   640     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   641     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   642     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   643     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   644     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   645     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   646     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   647     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   648     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   649     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   650     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   651     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   652     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   653 01  DD-IU-SW                    PIC X   VALUE ' '.
   654     88  DD-IU-PRESENT                 VALUE 'Y'.
   655
   656 01  ACCESS-KEYS.
   657     12  ELMSTR-KEY.
   658         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   659         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   660     12  W-CLAIM-KEY.
   661         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   662         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   663
   664     12  ELCNTL-KEY.
   665         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   666         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   667         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   668         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   669
   670     12  ELCERT-KEY.
   671         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   672         16  CERT-CARRIER         PIC X       VALUE SPACE.
   673         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   674         16  CERT-STATE           PIC XX      VALUE SPACES.
   675         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   676         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   677         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   678
   679     12  ELCERT2-KEY.
   680         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   681         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   682
   683     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   684
   685     12  ELCERT-SAVE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  13
* EL050.cbl
   686         16  FILLER                      PIC XX    VALUE SPACES.
   687
   688         16  WCS-CONTROL-PRIMARY.
   689             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   690             20  WCS-CARRIER             PIC X     VALUE SPACE.
   691             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   692             20  WCS-STATE               PIC XX    VALUE SPACES.
   693             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   694             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   695             20  WCS-CERT-NO.
   696                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   697                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   698
   699         16  CS-CONTROL-BY-NAME.
   700             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   701             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   702             20  CS-INSURED-INITIALS.
   703                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   704                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   705
   706         16  CS-CONTROL-BY-SSN.
   707             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   708             20  CS-SOC-SEC-NO.
   709                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   710                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   711                 24  CS-SSN-LN3.
   712                     28 CS-INSURED-INITIALS-A2   PIC XX
   713                                     VALUE SPACES.
   714                     28 CS-PART-LAST-NAME-A2     PIC X
   715                                     VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-CERT-NO.
   718             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   719             20  CS-CERT-NO-A4           PIC X(11)
   720                                     VALUE SPACES.
   721
   722         16  CS-CONTROL-BY-MEMB.
   723             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   724             20  CS-MEMBER-NO.
   725                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   726                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   727                 24  CS-MEMB-LN4.
   728                     28 CS-INSURED-INITIALS-A5   PIC XX
   729                                      VALUE SPACES.
   730                     28 CS-PART-LAST-NAME-A5     PIC XX
   731                                      VALUE SPACES.
   732
   733         16  FILLER              PIC X(360) VALUE SPACES.
   734
   735     12  ERACCT-KEY.
   736         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   737         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   738         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   739         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   740         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   741         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   742
   743     12  ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  14
* EL050.cbl
   744         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   745         16  COMP-CARRIER         PIC X     VALUE SPACES.
   746         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   747         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   748         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   749         16  COMP-TYPE            PIC X     VALUE SPACES.
   750
   751     12  ERLOFC-KEY.
   752         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   753         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   754         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   755         16  LOFC-STATE           PIC XX    VALUE SPACES.
   756         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   757         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   758
   759     12  WS-ELCRTT-KEY.
   760         16  WS-ELCRTT-PRIMARY       PIC X(33).
   761         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   762
   763     12  ERBXRF-KEY.
   764         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   766         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   767         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   768
   769     12  ERAGTC-KEY.
   770         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   771         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   772         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   773         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   774         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   775         16  AGTC-TYPE            PIC X     VALUE SPACES.
   776
   777     12  ERPLAN-KEY.
   778         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   779         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   780         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   781         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   782         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   783         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   784         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   785         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   786
   787     12  ERFORM-KEY.
   788         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   789         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   790         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   791         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   792
   793     12  ERREIN-KEY.
   794         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   795         16  REIN-TYPE            PIC X     VALUE SPACES.
   796         16  REIN-TABLE-CO.
   797             20  REIN-CODE-1      PIC X     VALUE SPACE.
   798             20  REIN-CODE-2      PIC X     VALUE SPACE.
   799             20  REIN-CODE-3      PIC X     VALUE SPACE.
   800         16  FILLER               PIC X(3)  VALUE SPACES.
   801
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  15
* EL050.cbl
   802     12  ERCTBL-KEY.
   803         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   804         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   805         16  CTBL-CNTRL-2.
   806             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   807             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   808
   809     12  ELCRTO-KEY.
   810         16  ELCRTO-COMPANY-CD       PIC X.
   811         16  ELCRTO-CARRIER          PIC X.
   812         16  ELCRTO-GROUPING         PIC X(6).
   813         16  ELCRTO-STATE            PIC XX.
   814         16  ELCRTO-ACCOUNT          PIC X(10).
   815         16  ELCRTO-CERT-EFF-DT      PIC XX.
   816         16  ELCRTO-CERT-NO.
   817             20  ELCRTO-CERT-PRIME   PIC X(10).
   818             20  ELCRTO-CERT-SFX     PIC X.
   819         16  ELCRTO-RECORD-TYPE      PIC X.
   820         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   821
   822
   823     12  WS-ACCESS.
   824         16  FILLER               PIC XX    VALUE SPACES.
   825         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   826
   827     12  WS-CARR-ACCESS.
   828         16  FILLER               PIC X(3)  VALUE SPACES.
   829         16  WS-CARR              PIC X     VALUE SPACE.
   830*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   831*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   832     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   833         88  WS-DMD-LF-RATING   VALUE 'Y'.
   834         88  WS-DMD-AH-RATING   VALUE 'Y'.
   835         88  WS-DMD-NO-RATING   VALUE 'N'.
   836
   837     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   838         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   839                                         'NJ' 'NL'
   840                                         'PJ' 'PL'
   841                                         'SJ' 'SL'.
   842     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   843         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   844                                         'NI' 'NJ' 'NL' 'NU'
   845                                         'PJ' 'PL' 'PI' 'PU'
   846                                         'SI' 'SJ' 'SL' 'SU'
   847                                         'MX' 'MY' 'MZ'.
   848 01  ERPDEF-KEY-SAVE             PIC X(18).
   849 01  ERPDEF-KEY.
   850     12  ERPDEF-COMPANY-CD       PIC X.
   851     12  ERPDEF-STATE            PIC XX.
   852     12  ERPDEF-PROD-CD          PIC XXX.
   853     12  F                       PIC X(7).
   854     12  ERPDEF-BEN-TYPE         PIC X.
   855     12  ERPDEF-BEN-CODE         PIC XX.
   856     12  ERPDEF-EXP-DT           PIC XX.
   857
   858 01  ELSTAT-KEY-SAVE             PIC X(20).
   859 01  ELSTAT-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  16
* EL050.cbl
   860     12  ELSTAT-COMPANY-ID       PIC XXX.
   861     12  ELSTAT-CARRIER          PIC X.
   862     12  ELSTAT-GROUP            PIC X(6).
   863     12  ELSTAT-STATE            PIC XX.
   864     12  ELSTAT-EXP-DT           PIC 9(8).
   865 01  WS-ERROR-VALUES.
   866     12  ER-1570                     PIC S9(4)   VALUE +1570.
   867     12  ER-1571                     PIC S9(4)   VALUE +1571.
   868     12  ER-1575                     PIC S9(4)   VALUE +1575.
   869     12  ER-1891                     PIC S9(4)   VALUE +1891.
   870     12  ER-1892                     PIC S9(4)   VALUE +1892.
   871     12  ER-1893                     PIC S9(4)   VALUE +1893.
   872     12  ER-1894                     PIC S9(4)   VALUE +1894.
   873     12  ER-1895                     PIC S9(4)   VALUE +1895.
   874     12  ER-1896                     PIC S9(4)   VALUE +1896.
   875     12  ER-1897                     PIC S9(4)   VALUE +1897.
   876     12  ER-1898                     PIC S9(4)   VALUE +1898.
   877     12  ER-1899                     PIC S9(4)   VALUE +1899.
   878     12  ER-1900                     PIC S9(4)   VALUE +1900.
   879     12  ER-1901                     PIC S9(4)   VALUE +1901.
   880     12  ER-1902                     PIC S9(4)   VALUE +1902.
   881     12  ER-1903                     PIC S9(4)   VALUE +1903.
   882     12  ER-1904                     PIC S9(4)   VALUE +1904.
   883     12  ER-1905                     PIC S9(4)   VALUE +1905.
   884     12  ER-1906                     PIC S9(4)   VALUE +1906.
   885     12  ER-1907                     PIC S9(4)   VALUE +1907.
   886     12  ER-1909                     PIC S9(4)   VALUE +1909.
   887     12  ER-1910                     PIC S9(4)   VALUE +1910.
   888     12  ER-1911                     PIC S9(4)   VALUE +1911.
   889     12  ER-1912                     PIC S9(4)   VALUE +1912.
   890     12  ER-1913                     PIC S9(4)   VALUE +1913.
   891     12  ER-1914                     PIC S9(4)   VALUE +1914.
   892     12  ER-1915                     PIC S9(4)   VALUE +1915.
   893     12  ER-1916                     PIC S9(4)   VALUE +1916.
   894     12  ER-1917                     PIC S9(4)   VALUE +1917.
   895     12  ER-1918                     PIC S9(4)   VALUE +1918.
   896     12  ER-1919                     PIC S9(4)   VALUE +1919.
   897     12  ER-1920                     PIC S9(4)   VALUE +1920.
   898     12  ER-1921                     PIC S9(4)   VALUE +1921.
   899     12  ER-1922                     PIC S9(4)   VALUE +1922.
   900     12  ER-1923                     PIC S9(4)   VALUE +1923.
   901     12  ER-1924                     PIC S9(4)   VALUE +1924.
   902     12  ER-1925                     PIC S9(4)   VALUE +1925.
   903     12  ER-1926                     PIC S9(4)   VALUE +1926.
   904     12  ER-1927                     PIC S9(4)   VALUE +1927.
   905     12  ER-2393                     PIC S9(4)   VALUE +2393.
   906     12  ER-2600                     PIC S9(4)   VALUE +2600.
   907     12  ER-2601                     PIC S9(4)   VALUE +2601.
   908     12  ER-2602                     PIC S9(4)   VALUE +2602.
   909     12  ER-2603                     PIC S9(4)   VALUE +2603.
   910     12  ER-2604                     PIC S9(4)   VALUE +2604.
   911     12  ER-2605                     PIC S9(4)   VALUE +2605.
   912     12  ER-2606                     PIC S9(4)   VALUE +2606.
   913     12  ER-2607                     PIC S9(4)   VALUE +2607.
   914     12  ER-2608                     PIC S9(4)   VALUE +2608.
   915     12  ER-2609                     PIC S9(4)   VALUE +2609.
   916     12  ER-2610                     PIC S9(4)   VALUE +2610.
   917     12  ER-2611                     PIC S9(4)   VALUE +2611.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  17
* EL050.cbl
   918     12  ER-2612                     PIC S9(4)   VALUE +2612.
   919     12  ER-2613                     PIC S9(4)   VALUE +2613.
   920     12  ER-2614                     PIC S9(4)   VALUE +2614.
   921     12  ER-2615                     PIC S9(4)   VALUE +2615.
   922     12  ER-2616                     PIC S9(4)   VALUE +2616.
   923     12  ER-2617                     PIC S9(4)   VALUE +2617.
   924     12  ER-2618                     PIC S9(4)   VALUE +2618.
   925     12  ER-2619                     PIC S9(4)   VALUE +2619.
   926     12  ER-2620                     PIC S9(4)   VALUE +2620.
   927     12  ER-2621                     PIC S9(4)   VALUE +2621.
   928     12  ER-2622                     PIC S9(4)   VALUE +2622.
   929     12  ER-2623                     PIC S9(4)   VALUE +2623.
   930     12  ER-2624                     PIC S9(4)   VALUE +2624.
   931     12  ER-2625                     PIC S9(4)   VALUE +2625.
   932     12  ER-2626                     PIC S9(4)   VALUE +2626.
   933     12  ER-2627                     PIC S9(4)   VALUE +2627.
   934     12  ER-2628                     PIC S9(4)   VALUE +2628.
   935     12  ER-2629                     PIC S9(4)   VALUE +2629.
   936     12  ER-2630                     PIC S9(4)   VALUE +2630.
   937     12  ER-2631                     PIC S9(4)   VALUE +2631.
   938     12  ER-2632                     PIC S9(4)   VALUE +2632.
   939     12  ER-2633                     PIC S9(4)   VALUE +2633.
   940     12  ER-2634                     PIC S9(4)   VALUE +2634.
   941     12  ER-2635                     PIC S9(4)   VALUE +2635.
   942     12  ER-2636                     PIC S9(4)   VALUE +2636.
   943     12  ER-2637                     PIC S9(4)   VALUE +2637.
   944     12  ER-2638                     PIC S9(4)   VALUE +2638.
   945     12  ER-2639                     PIC S9(4)   VALUE +2639.
   946     12  ER-2640                     PIC S9(4)   VALUE +2640.
   947     12  ER-2641                     PIC S9(4)   VALUE +2641.
   948     12  ER-2642                     PIC S9(4)   VALUE +2642.
   949     12  ER-2643                     PIC S9(4)   VALUE +2643.
   950     12  ER-2644                     PIC S9(4)   VALUE +2644.
   951     12  ER-2645                     PIC S9(4)   VALUE +2645.
   952     12  ER-2646                     PIC S9(4)   VALUE +2646.
   953     12  ER-2647                     PIC S9(4)   VALUE +2647.
   954     12  ER-2648                     PIC S9(4)   VALUE +2648.
   955     12  ER-2649                     PIC S9(4)   VALUE +2649.
   956     12  ER-2650                     PIC S9(4)   VALUE +2650.
   957     12  ER-2651                     PIC S9(4)   VALUE +2651.
   958     12  ER-2652                     PIC S9(4)   VALUE +2652.
   959     12  ER-2653                     PIC S9(4)   VALUE +2653.
   960     12  ER-2654                     PIC S9(4)   VALUE +2654.
   961     12  ER-2655                     PIC S9(4)   VALUE +2655.
   962     12  ER-2656                     PIC S9(4)   VALUE +2656.
   963     12  ER-2657                     PIC S9(4)   VALUE +2657.
   964     12  ER-2658                     PIC S9(4)   VALUE +2658.
   965     12  ER-2659                     PIC S9(4)   VALUE +2659.
   966     12  ER-2660                     PIC S9(4)   VALUE +2660.
   967     12  ER-2661                     PIC S9(4)   VALUE +2661.
   968     12  ER-2662                     PIC S9(4)   VALUE +2662.
   969     12  ER-2663                     PIC S9(4)   VALUE +2663.
   970     12  ER-2664                     PIC S9(4)   VALUE +2664.
   971     12  ER-2665                     PIC S9(4)   VALUE +2665.
   972     12  ER-2666                     PIC S9(4)   VALUE +2666.
   973     12  ER-2667                     PIC S9(4)   VALUE +2667.
   974     12  ER-2668                     PIC S9(4)   VALUE +2668.
   975     12  ER-2669                     PIC S9(4)   VALUE +2669.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  18
* EL050.cbl
   976     12  ER-2670                     PIC S9(4)   VALUE +2670.
   977     12  ER-2671                     PIC S9(4)   VALUE +2671.
   978     12  ER-2672                     PIC S9(4)   VALUE +2672.
   979     12  ER-2673                     PIC S9(4)   VALUE +2673.
   980     12  ER-2674                     PIC S9(4)   VALUE +2674.
   981     12  ER-2675                     PIC S9(4)   VALUE +2675.
   982     12  ER-2676                     PIC S9(4)   VALUE +2676.
   983     12  ER-2677                     PIC S9(4)   VALUE +2677.
   984     12  ER-2678                     PIC S9(4)   VALUE +2678.
   985     12  ER-2679                     PIC S9(4)   VALUE +2679.
   986     12  ER-2680                     PIC S9(4)   VALUE +2680.
   987     12  ER-2681                     PIC S9(4)   VALUE +2681.
   988     12  ER-2682                     PIC S9(4)   VALUE +2682.
   989     12  ER-2683                     PIC S9(4)   VALUE +2683.
   990     12  ER-2684                     PIC S9(4)   VALUE +2684.
   991     12  ER-2685                     PIC S9(4)   VALUE +2685.
   992     12  ER-2686                     PIC S9(4)   VALUE +2686.
   993     12  ER-2687                     PIC S9(4)   VALUE +2687.
   994     12  ER-2688                     PIC S9(4)   VALUE +2688.
   995     12  ER-2689                     PIC S9(4)   VALUE +2689.
   996     12  ER-2690                     PIC S9(4)   VALUE +2690.
   997     12  ER-2691                     PIC S9(4)   VALUE +2691.
   998     12  ER-2692                     PIC S9(4)   VALUE +2692.
   999     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1000     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1001     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1002     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1003     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1004     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1005     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1006     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1007     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1008     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1009     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1010     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1011     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1012     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1013     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1014     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1015     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1016     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1017     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1018     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1019     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1020     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1021     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1022     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1023     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1024     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1025     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1026     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1027     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1028     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1029     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1030     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1031     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1032     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1033     12  ER-2737                     PIC S9(4)   VALUE +2737.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  19
* EL050.cbl
  1034     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1035     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1036     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1037     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1038     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1039     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1040     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1041     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1042     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1043     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1044     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1045     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1046     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1047     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1048     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1049     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1050     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1051     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1052     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1053     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1054     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1055     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1056     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1057     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1058     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1059     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1060     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1061     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1062     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1063     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1064     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1065     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1066     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1067     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1068     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1069     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1070     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1071     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1072     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1073     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1074     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1075     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1076     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1077     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1078     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1079     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1080     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1081     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1082     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1083     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1084     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1085     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1086     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1087     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1088     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1089     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1090     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1091     12  ER-2869                     PIC S9(4)   VALUE +2869.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  20
* EL050.cbl
  1092     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1093     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1094     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1095     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1096     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1097     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1098     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1099     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1100     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1101     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1102     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1103     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1104     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1105     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1106     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1107     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1108     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1109     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1110     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1111     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1112     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1113     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1114     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1115     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1116     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1117     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1118     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1119     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1120     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1121     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1122     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1123     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1124     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1125     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1126     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1127     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1128     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1129     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1130     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1131     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1132     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1133     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1134     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1135     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1136     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1137     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1138     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1139     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1140     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1141     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1142     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1143     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1144     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1145     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1146     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1147     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1148     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1149     12  ER-8069                     PIC S9(4)   VALUE +8069.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  21
* EL050.cbl
  1150     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1151     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1152     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1153     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1154     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1155     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1156     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1157     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1158     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1159     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1160     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1161     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1162     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1163     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1164     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1165     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1166     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1167     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1168     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1169     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1170     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1171     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1172     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1173     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1174     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1175     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1176     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1177     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1178     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1179     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1180     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1181     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1182     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1183     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1184     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1185     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1186     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1187     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1188     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1189     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1190     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1191     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1192     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1193     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1194     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1195     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1196     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1197     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1198     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1199     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1200     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1201     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1202     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1203     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1204     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1205     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1206******************************************************************
  1207***************   END OF ELC50WS     ****************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  22
* EL050.cbl
  1208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  23
* EL050.cbl
  1211 01  WORKING-STORAGE-WORK-AREAS.
  1212     12  WS-RESPONSE             PIC S9(8)  COMP.
  1213         88  WS-RESP-NORMAL           VALUE +00.
  1214         88  WS-RESP-ERROR            VALUE +01.
  1215         88  WS-RESP-NOTFND           VALUE +13.
  1216         88  WS-RESP-DUPREC           VALUE +14.
  1217         88  WS-RESP-ENDFILE          VALUE +20.
  1218     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1219     12  WORK-AREAS.
  1220         16  WK-CONV-GREG.
  1221             24  WCG-CENT             PIC XX.
  1222             24  WCG-REST             PIC X(4).
  1223         16  WORK-GREGORIAN-DATE.
  1224             24  WK-GREG-CENT         PIC XX.
  1225             24  WK-GREG-DATE-YYMMDD.
  1226                 28  WK-GREG-YYMM     PIC X(4).
  1227                 28  WK-GREG-DD       PIC XX.
  1228
  1229         16  WORK-SELECT-DATE.
  1230             24  WK-SELECT-CENT            PIC XX.
  1231             24  WK-SELECT-DATE-YYMMDD.
  1232                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1233                 28  FILLER                PIC XX.
  1234
  1235         16  WK-FORM-NO.
  1236             24  WK-FORM-BANK-ID       PIC X(5).
  1237             24  WK-FORM-UNDRWRTR      PIC X(1).
  1238             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1239
  1240         16  WK-MEMBER-NO.
  1241             24  WK-MEMBER-1-6        PIC X(6).
  1242             24  WK-MEMBER-7-12       PIC X(6).
  1243
  1244         16  WK-FULL-CERT-NO.
  1245             24  WK-CERT-POS-1-2      PIC X(2).
  1246             24  WK-CERT-POS-3        PIC X(1).
  1247             24  WK-CERT-POS-4        PIC X(1).
  1248             24  WK-CERT-POS-5-6      PIC X(2).
  1249             24  WK-CERT-POS-7        PIC X(1).
  1250             24  WK-CERT-POS-8-11     PIC X(4).
  1251
  1252         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1253             88  VALID-RATE-CODE        VALUE 'Y'.
  1254             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1255
  1256         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1257         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1258         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1259         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1260         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1261         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1262         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1263         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1264         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1265         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1266
  1267* DLO001
  1268 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  24
* EL050.cbl
  1269     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1270     12  DMPF-RETURN-CODE          PIC XX.
  1271         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1272         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1273         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1274         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1275         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1276         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1277
  1278* DLO002
  1279 01  WS-DLO-INTERNAL-POLICY-FORM.
  1280     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1281     12  DIPF-RETURN-CODE          PIC XX.
  1282         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1283         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1284         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1285         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1286         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1287         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1288
  1289* DLO003
  1290 01  WS-DLO-VALID-BANK-ID.
  1291     12  DVBI-BANK-ID              PIC X(5).
  1292     12  DVBI-BANK-ID-TYPE         PIC X.
  1293         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1294         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1295         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1296         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1297         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1298     12  DVBI-RETURN-CODE          PIC XX.
  1299         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1300         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1301         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1302         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1303         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1304         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1305         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1306         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1307         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1308
  1309* DLO007
  1310 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1311     12  DCUA-RES-STATE            PIC XX.
  1312     12  DCUA-BEN-TYPE             PIC XX.
  1313     12  DCUA-SYS-IDENT            PIC X.
  1314         88  DCUA-CLAIM                        VALUE 'C'.
  1315         88  DCUA-PREMIUM                      VALUE 'P'.
  1316     12  DCUA-COVERAGE-RULE        PIC X.
  1317     12  DCUA-CLIENT-ID            PIC X(10).
  1318     12  DCUA-EFF-DATE             PIC X(8).
  1319     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1320     12  DCUA-RETURN-CODE          PIC XX.
  1321         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1322     12  DCUA-CERT-NUMBER          PIC X(11).
  1323     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1324     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1325
  1326* DLO011
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  25
* EL050.cbl
  1327 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1328     12  DPRB-RATE-CODE            PIC X(4).
  1329     12  DPRB-COVERAGE-CATEG       PIC X.
  1330     12  DPRB-RETURN-CODE          PIC XX.
  1331         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1332         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1333         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1334         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1335         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1336         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1337         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1338         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1339         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1340     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1341     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1342     12  DPRB-BEN-TYPE             PIC XX.
  1343
  1344* DLO017
  1345 01  WS-DLO-VALID-RATE-CODE.
  1346     12  DVRC-RATE-CODE            PIC X(4).
  1347     12  DVRC-RETURN-CODE          PIC XX.
  1348         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1349         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1350         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1351         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1352         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1353         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1354
  1355* DLO019
  1356 01  WS-DLO-ORIG-COV-CAT.
  1357     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1358     12  DOCC-RETURN-CODE          PIC XX.
  1359     12  DOCC-ORIG-COV-CAT         PIC X.
  1360     12  DOCC-UNDERWITER           PIC XX.
  1361     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1362     12  DOCC-FILLER               PIC X(6).
  1363
  1364* DLO021
  1365 01  WS-DLO-VALID-LOAN-OFFICER.
  1366     12  DVLO-LOAN-OFFICER.
  1367         16  DVLO-BILL-TYPE        PIC X.
  1368         16  DVLO-BILL-SOURCE      PIC X.
  1369         16  DVLO-BATCH-TYPE       PIC X.
  1370     12  DVLO-RETURN-CODE          PIC XX.
  1371         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1372         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1373         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1374         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1375         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1376         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1377
  1378* DLO022
  1379 01  WS-DLO-VALID-STATE-CODE.
  1380     12  DVSC-STATE-CODE           PIC XX.
  1381     12  DVSC-RETURN-CODE          PIC XX.
  1382         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1383
  1384* DLO023
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  26
* EL050.cbl
  1385 01  WS-DLO-VALID-CODE-VALUES.
  1386     12  DVCV-SYSTEM-ID            PIC XX.
  1387         88  DVCV-CLAIMS                       VALUE 'CL'.
  1388         88  DVCV-CREDIT                       VALUE 'CR'.
  1389     12  DVCV-RECORD-TYPE          PIC XX.
  1390         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1391         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1392         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1393         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1394         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1395         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1396         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1397         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1398     12  DVCV-RECORD-KEY           PIC X(6).
  1399     12  DVCV-RETURN-CODE          PIC XX.
  1400         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1401         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1402         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1403         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1404         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1405         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1406         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1407     12  DVCV-CODE-DESC            PIC X(60).
  1408     12  DVCV-GEN-DESC-1           PIC X(20).
  1409     12  DVCV-GEN-DESC-2           PIC X(20).
  1410     12  DVCV-GEN-DESC-3           PIC X(20).
  1411
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  27
* EL050.cbl
  1413*    COPY ERCBXRF.
  1414******************************************************************
  1415*                                                                *
  1416*                                                                *
  1417*                            ERCBXRF                             *
  1418*                                                                *
  1419*   ONLINE CREDIT SYSTEM                                         *
  1420*                                                                *
  1421*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1422*                                                                *
  1423*   FILE TYPE = VSAM,KSDS                                        *
  1424*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1425*                                                                *
  1426*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1427*       ALTERNATE PATH = NONE                                    *
  1428*                                                                *
  1429*   LOG = NO                                                     *
  1430*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1431*                                                                *
  1432******************************************************************
  1433
  1434 01  BANK-CROSS-REFERENCE.
  1435     12  BK-RECORD-ID                PIC XX.
  1436         88  VALID-BK-ID             VALUE 'BK'.
  1437
  1438     12  BK-CONTROL-PRIMARY.
  1439         16  BK-COMPANY-CD           PIC X.
  1440         16  BK-CARRIER              PIC X.
  1441         16  BK-GROUPING             PIC X(6).
  1442         16  BK-BANK-NO              PIC X(10).
  1443
  1444     12  BK-MAINT-INFORMATION.
  1445         16  BK-LAST-MAINT-DT        PIC XX.
  1446         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1447         16  BK-LAST-MAINT-USER      PIC X(4).
  1448         16  FILLER                  PIC X(9).
  1449
  1450     12  FILLER                      PIC X(37).
  1451
  1452     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1453
  1454     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1455                            DEPENDING ON BK-BANK-POINTER-CNT.
  1456         16  BK-AM-ACCOUNT           PIC X(10).
  1457         16  BK-AM-EXP-DT            PIC XX.
  1458         16  BK-AM-EFF-DT            PIC XX.
  1459         16  BK-AM-STATE             PIC XX.
  1460         16  FILLER                  PIC X(20).
  1461
  1462******************************************************************
  1463
  1464*    COPY ERCCOMP.
  1465******************************************************************
  1466*                                                                *
  1467*                                                                *
  1468*                            ERCCOMP                             *
  1469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1470*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  28
* EL050.cbl
  1471*                                                                *
  1472*   ONLINE CREDIT SYSTEM                                         *
  1473*                                                                *
  1474*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1475*                                                                *
  1476*   FILE TYPE = VSAM,KSDS                                        *
  1477*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1478*                                                                *
  1479*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1480*       ALTERNATE PATH = NONE                                    *
  1481*                                                                *
  1482*   LOG = NO                                                     *
  1483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1484*                                                                *
  1485******************************************************************
  1486*                   C H A N G E   L O G
  1487*
  1488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1489*-----------------------------------------------------------------
  1490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1491* EFFECTIVE    NUMBER
  1492*-----------------------------------------------------------------
  1493* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1494* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1495* 092205    2005050300006  PEMA  ADD LEASE FEE
  1496* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1497* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1498* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1499* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1500* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1501* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1502******************************************************************
  1503
  1504 01  COMPENSATION-MASTER.
  1505     12  CO-RECORD-ID                          PIC XX.
  1506         88  VALID-CO-ID                          VALUE 'CO'.
  1507
  1508     12  CO-CONTROL-PRIMARY.
  1509         16  CO-COMPANY-CD                     PIC X.
  1510         16  CO-CONTROL.
  1511             20  CO-CTL-1.
  1512                 24  CO-CARR-GROUP.
  1513                     28  CO-CARRIER            PIC X.
  1514                     28  CO-GROUPING.
  1515                         32  CO-GROUP-PREFIX   PIC XXX.
  1516                         32  CO-GROUP-PRIME    PIC XXX.
  1517                 24  CO-RESP-NO.
  1518                     28  CO-RESP-PREFIX        PIC X(4).
  1519                     28  CO-RESP-PRIME         PIC X(6).
  1520             20  CO-CTL-2.
  1521                 24  CO-ACCOUNT.
  1522                     28  CO-ACCT-PREFIX        PIC X(4).
  1523                     28  CO-ACCT-PRIME         PIC X(6).
  1524         16  CO-TYPE                           PIC X.
  1525             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1526             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1527             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1528
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  29
* EL050.cbl
  1529     12  CO-MAINT-INFORMATION.
  1530         16  CO-LAST-MAINT-DT                  PIC XX.
  1531         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1532         16  CO-LAST-MAINT-USER                PIC X(4).
  1533     12  FILLER                                PIC XX.
  1534     12  CO-STMT-TYPE                          PIC XXX.
  1535     12  CO-COMP-TYPE                          PIC X.
  1536         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1537     12  CO-STMT-OWNER                         PIC X(4).
  1538     12  CO-BALANCE-CONTROL                    PIC X.
  1539         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1540         88  CO-NO-BALANCE                        VALUE 'N'.
  1541
  1542     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1543         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1544         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1545         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1546
  1547     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1548         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1549         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1550
  1551     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1552     12  CO-GA-DIRECT-DEP                      PIC X.
  1553     12  CO-FUTURE-SPACE                       PIC X.
  1554         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1555
  1556     12  CO-ACCT-NAME                          PIC X(30).
  1557     12  CO-MAIL-NAME                          PIC X(30).
  1558     12  CO-ADDR-1                             PIC X(30).
  1559     12  CO-ADDR-2                             PIC X(30).
  1560     12  CO-ADDR-3.
  1561         16  CO-ADDR-CITY                      PIC X(27).
  1562         16  CO-ADDR-STATE                     PIC XX.
  1563     12  CO-CSO-1099                           PIC X.
  1564     12  CO-ZIP.
  1565         16  CO-ZIP-PRIME.
  1566             20  CO-ZIP-PRI-1ST                PIC X.
  1567                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1568             20  FILLER                        PIC X(4).
  1569         16  CO-ZIP-PLUS4                      PIC X(4).
  1570     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1571         16  CO-CAN-POSTAL-1                   PIC XXX.
  1572         16  CO-CAN-POSTAL-2                   PIC XXX.
  1573         16  FILLER                            PIC XXX.
  1574     12  CO-SOC-SEC                            PIC X(13).
  1575     12  CO-TELEPHONE.
  1576         16  CO-AREA-CODE                      PIC XXX.
  1577         16  CO-PREFIX                         PIC XXX.
  1578         16  CO-PHONE                          PIC X(4).
  1579
  1580     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1581
  1582     12  CO-AR-BAL-LEVEL                       PIC X.
  1583         88  CO-AR-REF-LVL                        VALUE '1'.
  1584         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1585         88  CO-AR-BILL-LVL                       VALUE '2'.
  1586         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  30
* EL050.cbl
  1587         88  CO-AR-FR-LVL                         VALUE '4'.
  1588
  1589     12  CO-AR-NORMAL-PRINT                    PIC X.
  1590         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1591         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1592
  1593     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1594
  1595     12  CO-AR-REPORTING                       PIC X.
  1596         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1597         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1598
  1599     12  CO-AR-PULL-CHECK                      PIC X.
  1600         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1601         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1602
  1603     12  CO-AR-BALANCE-PRINT                   PIC X.
  1604         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1605
  1606     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1607         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1608         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1609         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1610
  1611     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1612
  1613     12  CO-USER-CODE                          PIC X.
  1614     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1615
  1616******************************************************************
  1617*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1618*    THE LAST MONTH END RUN.
  1619******************************************************************
  1620
  1621     12  CO-LAST-ACTIVITY-DATE.
  1622         16  CO-ACT-YEAR                       PIC 99.
  1623         16  CO-ACT-MONTH                      PIC 99.
  1624         16  CO-ACT-DAY                        PIC 99.
  1625
  1626     12  CO-LAST-STMT-DT.
  1627         16  CO-LAST-STMT-YEAR                 PIC 99.
  1628         16  CO-LAST-STMT-MONTH                PIC 99.
  1629         16  CO-LAST-STMT-DAY                  PIC 99.
  1630
  1631     12  CO-MO-END-TOTALS.
  1632         16  CO-MONTHLY-TOTALS.
  1633             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1634             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1635             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1636             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1637             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1638
  1639         16  CO-AGING-TOTALS.
  1640             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1641             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1642             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1643             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1644
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  31
* EL050.cbl
  1645         16  CO-YTD-TOTALS.
  1646             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1647             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1648
  1649         16  CO-OVER-UNDER-TOTALS.
  1650             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1651             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1652
  1653     12  CO-MISCELLANEOUS-TOTALS.
  1654         16  CO-FICA-TOTALS.
  1655             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1656             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-CLAIM-TOTALS.
  1659             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1660             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1661
  1662******************************************************************
  1663*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1664*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1665******************************************************************
  1666
  1667     12  CO-CURRENT-TOTALS.
  1668         16  CO-CURRENT-LAST-STMT-DT.
  1669             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1670             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1671             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1672
  1673         16  CO-CURRENT-MONTHLY-TOTALS.
  1674             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1675             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1676             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1677             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1678             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1679
  1680         16  CO-CURRENT-AGING-TOTALS.
  1681             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1682             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1683             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1684             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1685
  1686         16  CO-CURRENT-YTD-TOTALS.
  1687             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1689
  1690     12  CO-PAID-COMM-TOTALS.
  1691         16  CO-YTD-PAID-COMMS.
  1692             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1693             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1694
  1695     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1696         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1697         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1698
  1699     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1700         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1701         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1702         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  32
* EL050.cbl
  1703         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1704         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1705         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1706         88  CO-FINAL-LETTER                  VALUE 'F'.
  1707         88  CO-RECONCILING                   VALUE 'R'.
  1708         88  CO-PHONE-CALL                    VALUE 'P'.
  1709         88  CO-LEGAL                         VALUE 'L'.
  1710         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1711         88  CO-WRITE-OFF                     VALUE 'W'.
  1712         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1713
  1714     12  CO-CSR-CODE                       PIC X(4).
  1715
  1716     12  CO-GA-STATUS-INFO.
  1717         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1718         16  CO-GA-TERMINATION-DT          PIC XX.
  1719         16  CO-GA-STATUS-CODE             PIC X.
  1720             88  CO-GA-ACTIVE                 VALUE 'A'.
  1721             88  CO-GA-INACTIVE               VALUE 'I'.
  1722             88  CO-GA-PENDING                VALUE 'P'.
  1723         16  CO-GA-COMMENTS.
  1724             20  CO-GA-COMMENT-1           PIC X(40).
  1725             20  CO-GA-COMMENT-2           PIC X(40).
  1726             20  CO-GA-COMMENT-3           PIC X(40).
  1727             20  CO-GA-COMMENT-4           PIC X(40).
  1728
  1729     12  CO-RPTCD2                         PIC X(10).
  1730     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1731         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1732         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1733
  1734     12  CO-TYPE-AGENT                     PIC X(01).
  1735         88  CO-CORPORATION                   VALUE 'C'.
  1736         88  CO-PARTNERSHIP                   VALUE 'P'.
  1737         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1738         88  CO-TRUST                         VALUE 'T'.
  1739         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1740
  1741     12  CO-FAXNO.
  1742         16  CO-FAX-AREA-CODE                  PIC XXX.
  1743         16  CO-FAX-PREFIX                     PIC XXX.
  1744         16  CO-FAX-PHONE                      PIC X(4).
  1745
  1746     12  CO-BANK-INFORMATION.
  1747         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1748         16  CO-BANK-TRANSIT-NON REDEFINES
  1749             CO-BANK-TRANSIT-NO                PIC 9(8).
  1750
  1751         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1752     12  CO-MISC-DEDUCT-INFO REDEFINES
  1753                  CO-BANK-INFORMATION.
  1754         16  CO-MD-GL-ACCT                     PIC X(10).
  1755         16  CO-MD-DIV                         PIC XX.
  1756         16  CO-MD-CENTER                      PIC X(4).
  1757         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1758         16  CO-CREATE-AP-CHECK                PIC X.
  1759         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1760         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  33
* EL050.cbl
  1761     12  CO-ACH-STATUS                         PIC X.
  1762         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1763         88  CO-ACH-PENDING                        VALUE 'P'.
  1764
  1765     12  CO-BILL-SW                            PIC X.
  1766     12  CO-CONTROL-NAME                       PIC X(30).
  1767     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1768     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1769     12  CO-CLP-STATE                          PIC XX.
  1770     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1771     12  CO-SPP-REFUND-EDIT                    PIC X.
  1772
  1773******************************************************************
  1774
  1775*    COPY ERCAGTC.
  1776******************************************************************
  1777*                                                                *
  1778*                                                                *
  1779*                            ERCAGTC                             *
  1780*                            VMOD=2.001                          *
  1781*                                                                *
  1782*   ONLINE CREDIT SYSTEM                                         *
  1783*                                                                *
  1784*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1785*                                                                *
  1786*   FILE TYPE = VSAM,KSDS                                        *
  1787*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1788*                                                                *
  1789*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1790*       ALTERNATE PATH = NONE                                    *
  1791*                                                                *
  1792*   LOG = NO                                                     *
  1793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1794*                                                                *
  1795******************************************************************
  1796*                   C H A N G E   L O G
  1797*
  1798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1799*-----------------------------------------------------------------
  1800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1801* EFFECTIVE    NUMBER
  1802*-----------------------------------------------------------------
  1803* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1804* 111004                         NEW FILE AND COPYBOOK
  1805* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1806******************************************************************
  1807 01  AGENT-COMMISSIONS.
  1808     12  AG-RECORD-ID                          PIC XX.
  1809         88  VALID-CO-ID                          VALUE 'AG'.
  1810     12  AG-CONTROL-PRIMARY.
  1811         16  AG-COMPANY-CD                     PIC X.
  1812         16  AG-CONTROL.
  1813             20  AG-CTL-1.
  1814                 24  AG-CARR-GROUP.
  1815                     28  AG-CARRIER            PIC X.
  1816                     28  AG-GROUPING           PIC X(6).
  1817                 24  AG-BANK                   PIC X(10).
  1818             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  34
* EL050.cbl
  1819                 24  AG-EXP-DT                 PIC XX.
  1820         16  AG-TYPE                           PIC X.
  1821             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1822             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1823     12  AG-MAINT-INFORMATION.
  1824         16  AG-LAST-MAINT-DT                  PIC XX.
  1825         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1826         16  AG-LAST-MAINT-USER                PIC X(4).
  1827         16  FILLER                            PIC X(10).
  1828     12  AG-EFF-DT                             PIC XX.
  1829     12  AG-COMM-STRUCTURE.
  1830         16  AG-AGT-COMMS OCCURS 10.
  1831             20  AG-AGT                PIC X(10).
  1832             20  AG-COM-TYP            PIC X.
  1833             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1834             20  AG-RECALC-LV-INDIC    PIC X.
  1835             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1836             20  AG-LRCALC-LV-INDIC    PIC X.
  1837             20  FILLER                PIC X(05).
  1838     12  FILLER                  PIC X(145).
  1839******************************************************************
  1840*    COPY ERCRESS.
  1841******************************************************************
  1842*                                                                *
  1843*                            ERCRESS                             *
  1844*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1845*                            VMOD=2.002                          *
  1846*                                                                *
  1847*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1848*                                                                *
  1849*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1850*   VSAM RESIDENT STATE TAX MASTER                              *
  1851*                                                                *
  1852*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1853*                                                                *
  1854*   FILE TYPE = VSAM,KSDS                                        *
  1855*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1856*                                                                *
  1857*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1858*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1859*                                                                *
  1860*   LOG = NO                                                     *
  1861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1862*                                                                *
  1863*                                                                *
  1864******************************************************************
  1865
  1866 01  RESIDENT-STATE-TAX-MASTER.
  1867
  1868     10  ERRESS-PRIMARY-KEY.
  1869         15  RES-COMPANY-CD        PIC X.
  1870         15  RES-RESIDENT-STATE    PIC XX.
  1871         15  RES-COVERAGE-CATEGORY PIC X.
  1872         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1873*                                      YYYYMMDD
  1874*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1875
  1876     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  35
* EL050.cbl
  1877
  1878         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1879         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1880         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1881         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1882
  1883     10 RES-RECALC-SW              PIC   X.
  1884         88 RECALC                VALUE 'Y'.
  1885         88 NO-RECALC             VALUE 'N'.
  1886     10  RES-MAINT-BY              PIC X(4).
  1887     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1888     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1889*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  36
* EL050.cbl
  1891*    COPY ERCRESC.
  1892******************************************************************
  1893*                                                                *
  1894*                            ERCRESC                             *
  1895*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1896*                            VMOD=2.003                          *
  1897*                                                                *
  1898*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1899*                                                                *
  1900*   FILE TYPE = VSAM,KSDS                                        *
  1901*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1902*                                                                *
  1903*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1904*       ALTERNATE PATH1 = NONE                                   *
  1905*                                                                *
  1906*   LOG = NO                                                     *
  1907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1908*                                                                *
  1909******************************************************************
  1910
  1911 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1912
  1913     10  ERRESC-RECORD-KEY.
  1914         15  RESC-COMPANY-CD           PIC   X.
  1915         15  RESC-CARRIER              PIC   X.
  1916         15  RESC-GROUP                PIC   X(6).
  1917         15  RESC-STATE                PIC   XX.
  1918         15  RESC-ACCOUNT              PIC   X(10).
  1919         15  RESC-AGENT                PIC   X(10).
  1920         15  RESC-RESIDENT-STATE       PIC   XX.
  1921         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1922*                                           YYYYMMDD
  1923     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1924
  1925     10  RESC-COMM-RECORD-DATA.
  1926         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1927             20 RESC-COVERAGE-CAT      PIC    X.
  1928             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1929             20 RESC-COMMISSION-TAB REDEFINES
  1930                RESC-COMMISSION-PER    PIC  XXX.
  1931
  1932     10  RESC-MAINT-BY                 PIC X(4).
  1933     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1934     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1935*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  37
* EL050.cbl
  1937*    COPY ERCPLAN.
  1938******************************************************************
  1939*                                                                *
  1940*                                                                *
  1941*                            ERCPLAN                             *
  1942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1943*                            VMOD=2.003                          *
  1944*                                                                *
  1945*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1946*                                                                *
  1947*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1948*   PLAN MASTER                                                  *
  1949*                                                                *
  1950*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1951*                                                                *
  1952*   FILE TYPE = VSAM,KSDS                                        *
  1953*   RECORD SIZE = 420   RECFORM = FIX                            *
  1954*                                                                *
  1955*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1956*       ALTERNATE PATH1 = N/A                                    *
  1957*                                                                *
  1958*   LOG = NO                                                     *
  1959*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1960*                                                                *
  1961*                                                                *
  1962******************************************************************
  1963
  1964 01  PLAN-MASTER.
  1965     12  PL-RECORD-ID                      PIC XX.
  1966         88  VALID-PL-ID                      VALUE 'PL'.
  1967
  1968     12  PL-CONTROL-PRIMARY.
  1969         16  PL-COMPANY-CD                 PIC X.
  1970         16  PL-MSTR-CNTRL.
  1971             20  PL-CONTROL-A.
  1972                 24  PL-CARRIER            PIC X.
  1973                 24  PL-GROUPING           PIC X(6).
  1974                 24  PL-STATE              PIC XX.
  1975                 24  PL-ACCOUNT            PIC X(10).
  1976             20  PL-BENEFIT-TYPE           PIC X.
  1977             20  PL-BENEFIT-CODE           PIC XX.
  1978             20  PL-REVISION-NO            PIC X(3).
  1979
  1980     12  PL-CONTROL-BY-VAR-GRP.
  1981         16  PL-COMPANY-CD-A1              PIC X.
  1982         16  PL-VG-CARRIER                 PIC X.
  1983         16  PL-VG-GROUPING                PIC X(6).
  1984         16  PL-VG-STATE                   PIC XX.
  1985         16  PL-VG-ACCOUNT                 PIC X(10).
  1986         16  PL-BENEFIT-TYPE-A1            PIC X.
  1987         16  PL-BENEFIT-CODE-A1            PIC XX.
  1988         16  PL-REVISION-NO-A1             PIC 999.
  1989
  1990     12  PL-MAINT-INFORMATION.
  1991         16  PL-LAST-MAINT-DT              PIC XX.
  1992         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1993         16  PL-LAST-MAINT-USER            PIC X(4).
  1994         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  38
* EL050.cbl
  1995
  1996     12  PL-LIABILITY-LIMITS.
  1997         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1998         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1999             20  PL-LM-AGE                 PIC S99        COMP-3.
  2000             20  PL-LM-DUR                 PIC S999       COMP-3.
  2001             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2002             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2003
  2004     12  FILLER                            PIC X(30).
  2005
  2006     12  PL-GL-ACCOUNT-NOS.
  2007         16  PL-PREMIUM-GL                 PIC X(8).
  2008         16  PL-COMM-GL                    PIC X(8).
  2009         16  PL-CLAIM-GL                   PIC X(8).
  2010     12  FILLER                            PIC X(24).
  2011     12  PL-TOLERANCES.
  2012         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2013         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2014         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2015         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2016         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2017         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2018     12  PL-OVER-SHORT.
  2019         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2020         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2021     12  FILLER                            PIC X(24).
  2022     12  PLAN-MISC.
  2023         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2024         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2025         16  PL-IG                         PIC X.
  2026         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2027         16  PL-POLICY-FORM                PIC X(12).
  2028         16  PL-EDIT-FOR-FORM              PIC X(01).
  2029         16  PL-DEV-CODE                   PIC XXX.
  2030         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2031         16  PL-CALC-METHOD                PIC X.
  2032         16  PL-BENEFIT-GROUP              PIC X(05).
  2033         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2034
  2035         16  FILLER                        PIC X(99).
  2036******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  39
* EL050.cbl
  2038*    COPY ELCCERT.
  2039******************************************************************
  2040*                                                                *
  2041*                            ELCCERT.                            *
  2042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2043*                            VMOD=2.013                          *
  2044*                                                                *
  2045*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2046*                                                                *
  2047*   FILE TYPE = VSAM,KSDS                                        *
  2048*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2049*                                                                *
  2050*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2051*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2052*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2053*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2054*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2055*                                                                *
  2056*   LOG = YES                                                    *
  2057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2058******************************************************************
  2059*                   C H A N G E   L O G
  2060*
  2061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2062*-----------------------------------------------------------------
  2063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2064* EFFECTIVE    NUMBER
  2065*-----------------------------------------------------------------
  2066* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2067* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2068* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2069* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2070* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2071* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2072* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2073* 032612  CR2011110200001  PEMA  AHL CHANGES
  2074******************************************************************
  2075
  2076 01  CERTIFICATE-MASTER.
  2077     12  CM-RECORD-ID                      PIC XX.
  2078         88  VALID-CM-ID                      VALUE 'CM'.
  2079
  2080     12  CM-CONTROL-PRIMARY.
  2081         16  CM-COMPANY-CD                 PIC X.
  2082         16  CM-CARRIER                    PIC X.
  2083         16  CM-GROUPING.
  2084             20  CM-GROUPING-PREFIX        PIC X(3).
  2085             20  CM-GROUPING-PRIME         PIC X(3).
  2086         16  CM-STATE                      PIC XX.
  2087         16  CM-ACCOUNT.
  2088             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2089             20  CM-ACCOUNT-PRIME          PIC X(6).
  2090         16  CM-CERT-EFF-DT                PIC XX.
  2091         16  CM-CERT-NO.
  2092             20  CM-CERT-PRIME             PIC X(10).
  2093             20  CM-CERT-SFX               PIC X.
  2094
  2095     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  40
* EL050.cbl
  2096         16  CM-COMPANY-CD-A1              PIC X.
  2097         16  CM-INSURED-LAST-NAME          PIC X(15).
  2098         16  CM-INSURED-INITIALS.
  2099             20  CM-INSURED-INITIAL1       PIC X.
  2100             20  CM-INSURED-INITIAL2       PIC X.
  2101
  2102     12  CM-CONTROL-BY-SSN.
  2103         16  CM-COMPANY-CD-A2              PIC X.
  2104         16  CM-SOC-SEC-NO.
  2105             20  CM-SSN-STATE              PIC XX.
  2106             20  CM-SSN-ACCOUNT            PIC X(6).
  2107             20  CM-SSN-LN3.
  2108                 25  CM-INSURED-INITIALS-A2.
  2109                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2110                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2111                 25 CM-PART-LAST-NAME-A2         PIC X.
  2112
  2113     12  CM-CONTROL-BY-CERT-NO.
  2114         16  CM-COMPANY-CD-A4              PIC X.
  2115         16  CM-CERT-NO-A4                 PIC X(11).
  2116
  2117     12  CM-CONTROL-BY-MEMB.
  2118         16  CM-COMPANY-CD-A5              PIC X.
  2119         16  CM-MEMBER-NO.
  2120             20  CM-MEMB-STATE             PIC XX.
  2121             20  CM-MEMB-ACCOUNT           PIC X(6).
  2122             20  CM-MEMB-LN4.
  2123                 25  CM-INSURED-INITIALS-A5.
  2124                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2125                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2126                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2127
  2128     12  CM-INSURED-PROFILE-DATA.
  2129         16  CM-INSURED-FIRST-NAME.
  2130             20  CM-INSURED-1ST-INIT       PIC X.
  2131             20  FILLER                    PIC X(9).
  2132         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2133         16  CM-INSURED-SEX                PIC X.
  2134             88  CM-SEX-MALE                  VALUE 'M'.
  2135             88  CM-SEX-FEMAL                 VALUE 'F'.
  2136         16  CM-INSURED-JOINT-AGE          PIC 99.
  2137         16  CM-JOINT-INSURED-NAME.
  2138             20  CM-JT-LAST-NAME           PIC X(15).
  2139             20  CM-JT-FIRST-NAME.
  2140                 24  CM-JT-1ST-INIT        PIC X.
  2141                 24  FILLER                PIC X(9).
  2142             20  CM-JT-INITIAL             PIC X.
  2143
  2144     12  CM-LIFE-DATA.
  2145         16  CM-LF-BENEFIT-CD              PIC XX.
  2146         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2147         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2148         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2149         16  CM-LF-DEV-CODE                PIC XXX.
  2150         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2151         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2152         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2153         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  41
* EL050.cbl
  2154         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2155         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2156         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2157         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2158         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2159         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2160         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2161         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2162         16  FILLER                        PIC XX.
  2163
  2164     12  CM-AH-DATA.
  2165         16  CM-AH-BENEFIT-CD              PIC XX.
  2166         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2167         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2168         16  CM-AH-DEV-CODE                PIC XXX.
  2169         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2170         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2171         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2172         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2173         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2174         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2175         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2176         16  CM-AH-PAID-THRU-DT            PIC XX.
  2177             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2178         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2179         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2180         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2181         16  FILLER                        PIC X.
  2182
  2183     12  CM-LOAN-INFORMATION.
  2184         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2185         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2186                                           PIC S9(5)V99  COMP-3.
  2187         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2188         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2189         16  CM-PAY-FREQUENCY              PIC S99.
  2190         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2191         16  CM-RATE-CLASS                 PIC XX.
  2192         16  CM-BENEFICIARY                PIC X(25).
  2193         16  CM-POLICY-FORM-NO             PIC X(12).
  2194         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2195         16  CM-LAST-ADD-ON-DT             PIC XX.
  2196         16  CM-DEDUCTIBLE-AMOUNTS.
  2197             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2198             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2199         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2200             20  CM-RESIDENT-STATE         PIC XX.
  2201             20  CM-RATE-CODE              PIC X(4).
  2202             20  FILLER                    PIC XX.
  2203         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2204             20  CM-LOAN-OFFICER           PIC X(5).
  2205             20  FILLER                    PIC XXX.
  2206         16  CM-CSR-CODE                   PIC XXX.
  2207         16  CM-UNDERWRITING-CODE          PIC X.
  2208             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2209         16  CM-POST-CARD-IND              PIC X.
  2210         16  CM-NH-INTERFACE-SW            PIC X.
  2211         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  42
* EL050.cbl
  2212             88  CM-SING-PRM                  VALUE '1'.
  2213             88  CM-O-B-COVERAGE              VALUE '2'.
  2214             88  CM-OPEN-END                  VALUE '3'.
  2215         16  CM-IND-GRP-TYPE               PIC X.
  2216             88  CM-INDIVIDUAL                VALUE 'I'.
  2217             88  CM-GROUP                     VALUE 'G'.
  2218         16  CM-SKIP-CODE                  PIC X.
  2219             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2220             88  SKIP-JULY                    VALUE '1'.
  2221             88  SKIP-AUGUST                  VALUE '2'.
  2222             88  SKIP-SEPTEMBER               VALUE '3'.
  2223             88  SKIP-JULY-AUG                VALUE '4'.
  2224             88  SKIP-AUG-SEPT                VALUE '5'.
  2225             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2226             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2227             88  SKIP-JUNE                    VALUE '8'.
  2228             88  SKIP-JUNE-JULY               VALUE '9'.
  2229             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2230             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2231         16  CM-PAYMENT-MODE               PIC X.
  2232             88  PAY-MONTHLY                  VALUE SPACE.
  2233             88  PAY-WEEKLY                   VALUE '1'.
  2234             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2235             88  PAY-BI-WEEKLY                VALUE '3'.
  2236             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2237         16  CM-LOAN-NUMBER                PIC X(8).
  2238         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2239         16  CM-OLD-LOF                    PIC XXX.
  2240*        16  CM-LOAN-OFFICER               PIC XXX.
  2241         16  CM-REIN-TABLE                 PIC XXX.
  2242         16  CM-SPECIAL-REIN-CODE          PIC X.
  2243         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2244         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2245         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2246
  2247     12  CM-STATUS-DATA.
  2248         16  CM-ENTRY-STATUS               PIC X.
  2249         16  CM-ENTRY-DT                   PIC XX.
  2250
  2251         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2252         16  CM-LF-CANCEL-DT               PIC XX.
  2253         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2254
  2255         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2256         16  CM-LF-DEATH-DT                PIC XX.
  2257         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2258
  2259         16  CM-LF-CURRENT-STATUS          PIC X.
  2260             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2261                                                'M' '4' '5' '9'.
  2262             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2263             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2264             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2265             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2266             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2267             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2268             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2269             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  43
* EL050.cbl
  2270             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2271             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2272             88  CM-LF-DECLINED               VALUE 'D'.
  2273             88  CM-LF-VOIDED                 VALUE 'V'.
  2274
  2275         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2276         16  CM-AH-CANCEL-DT               PIC XX.
  2277         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2278
  2279         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2280         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2281         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2282
  2283         16  CM-AH-CURRENT-STATUS          PIC X.
  2284             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2285                                                'M' '4' '5' '9'.
  2286             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2287             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2288             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2289             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2290             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2291             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2292             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2293             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2294             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2295             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2296             88  CM-AH-DECLINED               VALUE 'D'.
  2297             88  CM-AH-VOIDED                 VALUE 'V'.
  2298
  2299         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2300             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2301             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2302             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2303         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2304
  2305         16  CM-ENTRY-BATCH                PIC X(6).
  2306         16  CM-LF-EXIT-BATCH              PIC X(6).
  2307         16  CM-AH-EXIT-BATCH              PIC X(6).
  2308         16  CM-LAST-MONTH-END             PIC XX.
  2309
  2310     12  CM-NOTE-SW                        PIC X.
  2311         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2312         88  CERT-NOTES-PRESENT               VALUE '1'.
  2313         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2314         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2315         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2316         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2317         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2318         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2319     12  CM-COMP-EXCP-SW                   PIC X.
  2320         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2321         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2322     12  CM-INSURED-ADDRESS-SW             PIC X.
  2323         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2324         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2325
  2326*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2327     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  44
* EL050.cbl
  2328     12  FILLER                            PIC X.
  2329
  2330*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2331     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2332     12  FILLER                            PIC X.
  2333*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2334     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2335
  2336     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2337         88  CERT-ADDED-BATCH                 VALUE ' '.
  2338         88  CERT-ADDED-ONLINE                VALUE '1'.
  2339         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2340         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2341         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2342     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2343         88  CERT-AS-LOADED                   VALUE ' '.
  2344         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2345         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2346         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2347         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2348         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2349         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2350         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2351
  2352     12  CM-ACCOUNT-COMM-PCTS.
  2353         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2354         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2355
  2356     12  CM-USER-FIELD                     PIC X.
  2357     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2358     12  CM-CLP-STATE                      PIC XX.
  2359     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2360     12  CM-USER-RESERVED                  PIC XXX.
  2361     12  FILLER REDEFINES CM-USER-RESERVED.
  2362         16  CM-AH-CLASS-CD                PIC XX.
  2363         16  F                             PIC X.
  2364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  45
* EL050.cbl
  2366*    COPY ERCMAIL.
  2367******************************************************************
  2368*                                                                *
  2369*                                                                *
  2370*                            ERCMAIL                             *
  2371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2372*                            VMOD=2.003                          *
  2373*                                                                *
  2374*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2375*                                                                *
  2376*   FILE TYPE = VSAM,KSDS                                        *
  2377*   RECORD SIZE = 374   RECFORM = FIX                            *
  2378*                                                                *
  2379*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2380*   ALTERNATE PATH    = NOT USED                                 *
  2381*                                                                *
  2382*   LOG = YES                                                    *
  2383*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2384******************************************************************
  2385*                   C H A N G E   L O G
  2386*
  2387* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2388*-----------------------------------------------------------------
  2389*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2390* EFFECTIVE    NUMBER
  2391*-----------------------------------------------------------------
  2392* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2393* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2394* 111108                   PEMA  ADD CRED BENE ADDR2
  2395******************************************************************
  2396
  2397 01  MAILING-DATA.
  2398     12  MA-RECORD-ID                      PIC XX.
  2399         88  VALID-MA-ID                       VALUE 'MA'.
  2400
  2401     12  MA-CONTROL-PRIMARY.
  2402         16  MA-COMPANY-CD                 PIC X.
  2403         16  MA-CARRIER                    PIC X.
  2404         16  MA-GROUPING.
  2405             20  MA-GROUPING-PREFIX        PIC XXX.
  2406             20  MA-GROUPING-PRIME         PIC XXX.
  2407         16  MA-STATE                      PIC XX.
  2408         16  MA-ACCOUNT.
  2409             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2410             20  MA-ACCOUNT-PRIME          PIC X(6).
  2411         16  MA-CERT-EFF-DT                PIC XX.
  2412         16  MA-CERT-NO.
  2413             20  MA-CERT-PRIME             PIC X(10).
  2414             20  MA-CERT-SFX               PIC X.
  2415
  2416     12  FILLER                            PIC XX.
  2417
  2418     12  MA-ACCESS-CONTROL.
  2419         16  MA-SOURCE-SYSTEM              PIC XX.
  2420             88  MA-FROM-CREDIT                VALUE 'CR'.
  2421             88  MA-FROM-VSI                   VALUE 'VS'.
  2422             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2423             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  46
* EL050.cbl
  2424         16  MA-RECORD-ADD-DT              PIC XX.
  2425         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2426         16  MA-LAST-MAINT-DT              PIC XX.
  2427         16  MA-LAST-MAINT-BY              PIC XXXX.
  2428         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2429
  2430     12  MA-PROFILE-INFO.
  2431         16  MA-QUALIFY-CODE-1             PIC XX.
  2432         16  MA-QUALIFY-CODE-2             PIC XX.
  2433         16  MA-QUALIFY-CODE-3             PIC XX.
  2434         16  MA-QUALIFY-CODE-4             PIC XX.
  2435         16  MA-QUALIFY-CODE-5             PIC XX.
  2436
  2437         16  MA-INSURED-LAST-NAME          PIC X(15).
  2438         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2439         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2440         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2441         16  MA-INSURED-BIRTH-DT           PIC XX.
  2442         16  MA-INSURED-SEX                PIC X.
  2443             88  MA-SEX-MALE                   VALUE 'M'.
  2444             88  MA-SEX-FEMALE                 VALUE 'F'.
  2445         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2446
  2447         16  MA-ADDRESS-CORRECTED          PIC X.
  2448         16  MA-JOINT-BIRTH-DT             PIC XX.
  2449*        16  FILLER                        PIC X(12).
  2450
  2451         16  MA-ADDRESS-LINE-1             PIC X(30).
  2452         16  MA-ADDRESS-LINE-2             PIC X(30).
  2453         16  MA-CITY-STATE.
  2454             20  MA-CITY                   PIC X(28).
  2455             20  MA-ADDR-STATE             PIC XX.
  2456         16  MA-ZIP.
  2457             20  MA-ZIP-CODE.
  2458                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2459                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2460                 24  FILLER                PIC X(4).
  2461             20  MA-ZIP-PLUS4              PIC X(4).
  2462         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2463             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2464             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2465             20  FILLER                    PIC X(3).
  2466
  2467         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2468
  2469         16  FILLER                        PIC XXX.
  2470*        16  FILLER                        PIC X(10).
  2471
  2472     12  MA-CRED-BENE-INFO.
  2473         16  MA-CRED-BENE-NAME                 PIC X(25).
  2474         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2475         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2476         16  MA-CRED-BENE-CTYST.
  2477             20  MA-CRED-BENE-CITY             PIC X(28).
  2478             20  MA-CRED-BENE-STATE            PIC XX.
  2479         16  MA-CRED-BENE-ZIP.
  2480             20  MA-CB-ZIP-CODE.
  2481                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  47
* EL050.cbl
  2482                     88  MA-CB-CANADIAN-POST-CODE
  2483                                           VALUE 'A' THRU 'Z'.
  2484                 24  FILLER                    PIC X(4).
  2485             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2486         16  MA-CB-CANADIAN-POSTAL-CODE
  2487                            REDEFINES MA-CRED-BENE-ZIP.
  2488             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2489             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2490             20  FILLER                        PIC X(3).
  2491     12  MA-POST-CARD-MAIL-DATA.
  2492         16  MA-MAIL-DATA OCCURS 7.
  2493             20  MA-MAIL-TYPE              PIC X.
  2494                 88  MA-12MO-MAILING           VALUE '1'.
  2495                 88  MA-EXP-MAILING            VALUE '2'.
  2496             20  MA-MAIL-STATUS            PIC X.
  2497                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2498                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2499                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2500             20  MA-MAIL-DATE              PIC XX.
  2501     12  FILLER                            PIC XX.
  2502     12  FILLER                            PIC XX.
  2503*    12  FILLER                            PIC X(30).
  2504******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  48
* EL050.cbl
  2506*    COPY ERCPNDM.
  2507******************************************************************
  2508*                                                                *
  2509*                                                                *
  2510*                            ERCPNDM                             *
  2511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2512*                            VMOD=2.003                          *
  2513*                                                                *
  2514*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2515*                                                                *
  2516*   FILE TYPE = VSAM,KSDS                                        *
  2517*   RECORD SIZE = 374   RECFORM = FIX                            *
  2518*                                                                *
  2519*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2520*   ALTERNATE PATH    = NOT USED                                 *
  2521*                                                                *
  2522*   LOG = YES                                                    *
  2523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2524******************************************************************
  2525*                   C H A N G E   L O G
  2526*
  2527* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2528*-----------------------------------------------------------------
  2529*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2530* EFFECTIVE    NUMBER
  2531*-----------------------------------------------------------------
  2532* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2533* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2534* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2535******************************************************************
  2536
  2537 01  PENDING-MAILING-DATA.
  2538     12  PM-RECORD-ID                      PIC XX.
  2539         88  VALID-MA-ID                       VALUE 'PM'.
  2540
  2541     12  PM-CONTROL-PRIMARY.
  2542         16  PM-COMPANY-CD                 PIC X.
  2543         16  PM-ENTRY-BATCH                PIC X(6).
  2544         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2545         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2546
  2547     12  FILLER                            PIC X(14).
  2548
  2549     12  PM-ACCESS-CONTROL.
  2550         16  PM-SOURCE-SYSTEM              PIC XX.
  2551             88  PM-FROM-CREDIT                VALUE 'CR'.
  2552             88  PM-FROM-VSI                   VALUE 'VS'.
  2553             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2554             88  PM-FROM-OTHER                 VALUE 'OT'.
  2555         16  PM-RECORD-ADD-DT              PIC XX.
  2556         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2557         16  PM-LAST-MAINT-DT              PIC XX.
  2558         16  PM-LAST-MAINT-BY              PIC XXXX.
  2559         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2560
  2561     12  PM-PROFILE-INFO.
  2562         16  PM-QUALIFY-CODE-1             PIC XX.
  2563         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  49
* EL050.cbl
  2564         16  PM-QUALIFY-CODE-3             PIC XX.
  2565         16  PM-QUALIFY-CODE-4             PIC XX.
  2566         16  PM-QUALIFY-CODE-5             PIC XX.
  2567
  2568         16  PM-INSURED-LAST-NAME          PIC X(15).
  2569         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2570         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2571         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2572         16  PM-INSURED-BIRTH-DT           PIC XX.
  2573         16  PM-INSURED-SEX                PIC X.
  2574             88  PM-SEX-MALE                   VALUE 'M'.
  2575             88  PM-SEX-FEMALE                 VALUE 'F'.
  2576         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2577
  2578         16  PM-ADDRESS-CORRECTED          PIC X.
  2579         16  PM-JOINT-BIRTH-DT             PIC XX.
  2580*        16  FILLER                        PIC X(12).
  2581
  2582         16  PM-ADDRESS-LINE-1             PIC X(30).
  2583         16  PM-ADDRESS-LINE-2             PIC X(30).
  2584         16  PM-CITY-STATE.
  2585             20  PM-CITY                   PIC X(28).
  2586             20  PM-STATE                  PIC XX.
  2587         16  PM-ZIP.
  2588             20  PM-ZIP-CODE.
  2589                 24  PM-ZIP-1              PIC X.
  2590                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2591                 24  FILLER                PIC X(4).
  2592             20  PM-ZIP-PLUS4              PIC X(4).
  2593         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2594             20  PM-CAN-POST1              PIC XXX.
  2595             20  PM-CAN-POST2              PIC XXX.
  2596             20  FILLER                    PIC XXX.
  2597
  2598         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2599
  2600         16  FILLER                        PIC X(03).
  2601
  2602     12  PM-CRED-BENE-INFO.
  2603         16  PM-CRED-BENE-NAME             PIC X(25).
  2604         16  PM-CRED-BENE-ADDR             PIC X(30).
  2605         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2606         16  PM-CRED-BENE-CTYST.
  2607             20  PM-CRED-BENE-CITY         PIC X(28).
  2608             20  PM-CRED-BENE-STATE        PIC XX.
  2609         16  PM-CRED-BENE-ZIP.
  2610             20  PM-CB-ZIP-CODE.
  2611                 24  PM-CB-ZIP-1           PIC X.
  2612                     88  PM-CB-CANADIAN-POST-CODE
  2613                                  VALUE 'A' THRU 'Z'.
  2614                 24  FILLER                PIC X(4).
  2615             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2616         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2617             20  PM-CB-CAN-POST1           PIC XXX.
  2618             20  PM-CB-CAN-POST2           PIC XXX.
  2619             20  FILLER                    PIC XXX.
  2620     12  PM-POST-CARD-MAIL-DATA.
  2621         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  50
* EL050.cbl
  2622             20  PM-MAIL-TYPE              PIC X.
  2623                 88  PM-12MO-MAILING           VALUE '1'.
  2624                 88  PM-EXP-MAILING            VALUE '2'.
  2625             20  PM-MAIL-STATUS            PIC X.
  2626                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2627                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2628                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2629             20  PM-MAIL-DATE              PIC XX.
  2630     12  FILLER                            PIC XX.
  2631     12  FILLER                            PIC X(12).
  2632*    12  FILLER                            PIC X(30).
  2633
  2634******************************************************************
  2635*                                COPY ERCLOFC.
  2636******************************************************************
  2637*                                                                *
  2638*                                                                *
  2639*                            ERCLOFC                             *
  2640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2641*                            VMOD=2.003                          *
  2642*                                                                *
  2643*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2644*                                                                *
  2645*   FILE TYPE = VSAM,KSDS                                        *
  2646*   RECORD SIZE = 670   RECFORM = FIX                            *
  2647*                                                                *
  2648*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2649*                                                                *
  2650*   LOG = YES                                                    *
  2651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2652*                                                                *
  2653******************************************************************
  2654
  2655 01  LOAN-OFFICER-MASTER.
  2656     12  LO-RECORD-ID                PIC XX.
  2657         88  VALID-LO-ID                VALUE 'LO'.
  2658
  2659     12  LO-CONTROL-PRIMARY.
  2660         16  LO-COMPANY-CD           PIC X.
  2661         16  LO-CARRIER              PIC X.
  2662         16  LO-GROUPING.
  2663             20  LO-GROUPING-PREFIX  PIC XXX.
  2664             20  LO-GROUPING-PRIME   PIC XXX.
  2665         16  LO-STATE                PIC XX.
  2666         16  LO-ACCOUNT.
  2667             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2668             20  LO-ACCOUNT-PRIME    PIC X(6).
  2669         16  LO-OFFICER-CODE         PIC X(5).
  2670
  2671     12  LO-OFFICER-NAME             PIC X(30).
  2672
  2673     12  LO-LAST-MAINT-DT            PIC XX.
  2674     12  LO-LAST-USER                PIC X(4).
  2675     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2676
  2677     12  LO-COMP-CONTROL             PIC X.
  2678             88  LO-SHOW-COMP           VALUE 'Y'.
  2679             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  51
* EL050.cbl
  2680     12  LO-DETAIL-CONTROL           PIC X.
  2681             88  LO-PRINT-DETAIL        VALUE 'D'.
  2682             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2683
  2684     12  LO-SV-CARRIER               PIC X.
  2685     12  LO-SV-GROUPING              PIC X(6).
  2686     12  LO-SV-STATE                 PIC XX.
  2687
  2688     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2689     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2690
  2691     12  LO-OFFICER-INFO.
  2692         16  FILLER OCCURS 12 TIMES.
  2693             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2694             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2695             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2696             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2697             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2698             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2699             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2700             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2701     12  FILLER                      PIC X(198).
  2702******************************************************************
  2703*                                COPY ERCPDEF.
  2704******************************************************************
  2705*                                                                *
  2706*                                                                *
  2707*                            ERCPDEF.                            *
  2708*                                                                *
  2709*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2710*                                                                *
  2711*    FILE TYPE = VSAM,KSDS                                       *
  2712*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2713*                                                                *
  2714*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2715*                                                                *
  2716*    LOG = YES                                                   *
  2717*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2718******************************************************************
  2719 01  PRODUCT-MASTER.
  2720    12  PD-RECORD-ID                 PIC X(02).
  2721        88  VALID-PD-ID                  VALUE 'PD'.
  2722    12  PD-CONTROL-PRIMARY.
  2723        16  PD-COMPANY-CD            PIC X.
  2724        16  PD-STATE                 PIC XX.
  2725        16  PD-PRODUCT-CD            PIC XXX.
  2726        16  PD-FILLER                PIC X(7).
  2727        16  PD-BEN-TYPE              PIC X.
  2728        16  PD-BEN-CODE              PIC XX.
  2729        16  PD-PROD-EXP-DT           PIC XX.
  2730    12  FILLER                       PIC X(50).
  2731    12  PD-PRODUCT-DATA OCCURS 8.
  2732        16  PD-PROD-CODE             PIC X.
  2733            88  PD-PROD-LIFE           VALUE 'L'.
  2734            88  PD-PROD-PROP           VALUE 'P'.
  2735            88  PD-PROD-AH             VALUE 'A'.
  2736            88  PD-PROD-IU             VALUE 'I'.
  2737            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  52
* EL050.cbl
  2738        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2739        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2740        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2741        16  PD-MAX-TERM              PIC S999        COMP-3.
  2742        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2743        16  FILLER                   PIC X.
  2744        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2745        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2746        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2747        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2748        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2749        16  PD-REC-CRIT-PERIOD       PIC X.
  2750        16  PD-RTW-MOS               PIC 99.
  2751        16  FILLER                   PIC X(5).
  2752    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2753    12  PD-TERM-LIMITS OCCURS 15.
  2754        16  PD-LOW-TERM              PIC S999        COMP-3.
  2755        16  PD-HI-TERM               PIC S999        COMP-3.
  2756*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2757    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2758        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2759        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2760    12  PD-EARN-FACTORS.
  2761        16  FILLER OCCURS 15.
  2762            20  FILLER OCCURS 15.
  2763                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2764    12  PD-PRODUCT-DESC              PIC X(80).
  2765    12  PD-TRUNCATED                 PIC X.
  2766    12  FILLER                       PIC X(59).
  2767    12  PD-MAINT-INFORMATION.
  2768        16  PD-LAST-MAINT-DT         PIC X(02).
  2769        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2770        16  PD-LAST-MAINT-BY         PIC X(04).
  2771*                                COPY ELCSTATE.
  2772******************************************************************
  2773*                                                                *
  2774*                                                                *
  2775*                            ELCSTATE.                           *
  2776*                                                                *
  2777*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2778*                                                                *
  2779*   FILE TYPE = VSAM,KSDS                                        *
  2780*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2781*                                                                *
  2782*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2783*       ALTERNATE INDEX = NONE                                   *
  2784*                                                                *
  2785*   LOG = YES                                                    *
  2786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2787******************************************************************
  2788*                   C H A N G E   L O G
  2789*
  2790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2791*-----------------------------------------------------------------
  2792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2793* EFFECTIVE    NUMBER
  2794*-----------------------------------------------------------------
  2795* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  53
* EL050.cbl
  2796******************************************************************
  2797*
  2798 01  STATE-FILE.
  2799     12  SF-RECORD-ID                       PIC XX.
  2800         88  VALID-CF-ID                        VALUE 'SF'.
  2801     12  SF-CONTROL-PRIMARY.
  2802         16  SF-COMPANY-ID                  PIC XXX.
  2803         16  SF-CARRIER-CODE                PIC X.
  2804         16  SF-GROUPING                    PIC X(6).
  2805         16  SF-STATE-CODE                  PIC XX.
  2806         16  SF-EXPIRE-DATE                 PIC 9(8).
  2807****************************************************************
  2808*             STATE CONTROLS
  2809****************************************************************
  2810     12  SF-LAST-MAINT-DT                   PIC XX.
  2811     12  SF-LAST-MAINT-BY                   PIC X(4).
  2812     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2813     12  SF-STATE-RT-CONTROLS.
  2814         16  SF-ST-RT-CALC                  PIC X.
  2815     12  SF-ST-TAX-CONTROLS.
  2816         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2817         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2818         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2819     12  SF-ST-REFUND-OPTIONS.
  2820         16  SF-ST-RF-LR-CALC               PIC X.
  2821         16  SF-ST-RF-LL-CALC               PIC X.
  2822         16  SF-ST-RF-LN-CALC               PIC X.
  2823         16  SF-ST-RF-AH-CALC               PIC X.
  2824         16  SF-ST-RF-CP-CALC               PIC X.
  2825     12  SF-ST-UNEARN-PREM-OPTIONS.
  2826         16  SF-ST-LUEP-R78                 PIC X.
  2827         16  SF-ST-LUEP-PRO                 PIC X.
  2828         16  SF-ST-LUEP-ST                  PIC X.
  2829         16  SF-ST-LUEP-DOM                 PIC X.
  2830         16  SF-ST-AUEP-R78                 PIC X.
  2831         16  SF-ST-AUEP-PRO                 PIC X.
  2832         16  SF-ST-AUEP-ST                  PIC X.
  2833         16  SF-ST-AUEP-DOM                 PIC X.
  2834         16  SF-ST-CUEP-R78                 PIC X.
  2835         16  SF-ST-CUEP-PRO                 PIC X.
  2836         16  SF-ST-CUEP-ST                  PIC X.
  2837         16  SF-ST-CUEP-DOM                 PIC X.
  2838     12  SF-ST-EARN-PREM-OPTIONS.
  2839         16  SF-ST-LEP-R78                  PIC X.
  2840         16  SF-ST-LEP-PRO                  PIC X.
  2841         16  SF-ST-LEP-ST                   PIC X.
  2842         16  SF-ST-LEP-DOM                  PIC X.
  2843         16  SF-ST-AEP-R78                  PIC X.
  2844         16  SF-ST-AEP-PRO                  PIC X.
  2845         16  SF-ST-AEP-ST                   PIC X.
  2846         16  SF-ST-AEP-DOM                  PIC X.
  2847         16  SF-ST-CEP-R78                  PIC X.
  2848         16  SF-ST-CEP-PRO                  PIC X.
  2849         16  SF-ST-CEP-ST                   PIC X.
  2850         16  SF-ST-CEP-DOM                  PIC X.
  2851     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  54
* EL050.cbl
  2853*    COPY ELCCRTT.
  2854******************************************************************
  2855*                                                                *
  2856*                            ELCCRTT.                            *
  2857*                                                                *
  2858*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2859*                                                                *
  2860*   FILE TYPE = VSAM,KSDS                                        *
  2861*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2862*                                                                *
  2863*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2864*                                                                *
  2865*   LOG = YES                                                    *
  2866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2867******************************************************************
  2868*                   C H A N G E   L O G
  2869*
  2870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2871*-----------------------------------------------------------------
  2872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2873* EFFECTIVE    NUMBER
  2874*-----------------------------------------------------------------
  2875* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2876* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2877* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2878******************************************************************
  2879
  2880 01  CERTIFICATE-TRAILERS.
  2881     12  CS-RECORD-ID                      PIC XX.
  2882         88  VALID-CS-ID                      VALUE 'CS'.
  2883
  2884     12  CS-CONTROL-PRIMARY.
  2885         16  CS-COMPANY-CD                 PIC X.
  2886         16  CS-CARRIER                    PIC X.
  2887         16  CS-GROUPING                   PIC X(6).
  2888         16  CS-STATE                      PIC XX.
  2889         16  CS-ACCOUNT                    PIC X(10).
  2890         16  CS-CERT-EFF-DT                PIC XX.
  2891         16  CS-CERT-NO.
  2892             20  CS-CERT-PRIME             PIC X(10).
  2893             20  CS-CERT-SFX               PIC X.
  2894         16  CS-TRAILER-TYPE               PIC X.
  2895             88  COMM-TRLR           VALUE 'A'.
  2896             88  FUTURE-TRLR         VALUE 'B'.
  2897             88  CERT-DATA-TRLR      VALUE 'C'.
  2898
  2899     12  CS-DATA-AREA                      PIC X(516).
  2900
  2901     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2902         16  CS-BANK-COMMISSION-AREA.
  2903             20  CS-BANK-COMMS       OCCURS 10.
  2904                 24  CS-AGT                PIC X(10).
  2905                 24  CS-COM-TYP            PIC X.
  2906                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2907                 24  CS-RECALC-LV-INDIC    PIC X.
  2908                 24  FILLER                PIC X(10).
  2909         16  FILLER                        PIC X(256).
  2910
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  55
* EL050.cbl
  2911     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2912         16  CS-VIN-NUMBER                 PIC X(17).
  2913         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2914         16  FILLER                        PIC X(498).
  2915******************************************************************
  2916*    COPY ELCCRTO.
  2917******************************************************************
  2918*                                                                *
  2919*                            ELCCRTO.                            *
  2920*                                                                *
  2921*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2922*                                                                *
  2923*   FILE TYPE = VSAM,KSDS                                        *
  2924*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2925*                                                                *
  2926*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2927*                                                                *
  2928*   LOG = YES                                                    *
  2929*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2930******************************************************************
  2931*                   C H A N G E   L O G
  2932*
  2933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2934*-----------------------------------------------------------------
  2935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2936* EFFECTIVE    NUMBER
  2937*-----------------------------------------------------------------
  2938* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2939* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2940* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2941******************************************************************
  2942 01  ORIGINAL-CERTIFICATE.
  2943     12  OC-RECORD-ID                      PIC XX.
  2944         88  VALID-OC-ID                      VALUE 'OC'.
  2945     12  OC-CONTROL-PRIMARY.
  2946         16  OC-COMPANY-CD                 PIC X.
  2947         16  OC-CARRIER                    PIC X.
  2948         16  OC-GROUPING                   PIC X(6).
  2949         16  OC-STATE                      PIC XX.
  2950         16  OC-ACCOUNT                    PIC X(10).
  2951         16  OC-CERT-EFF-DT                PIC XX.
  2952         16  OC-CERT-NO.
  2953             20  OC-CERT-PRIME             PIC X(10).
  2954             20  OC-CERT-SFX               PIC X.
  2955         16  OC-RECORD-TYPE                PIC X.
  2956         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2957     12  OC-LAST-MAINT-DT                  PIC XX.
  2958     12  OC-LAST-MAINT-BY                  PIC X(4).
  2959     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2960     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2961     12  FILLER                            PIC X(49).
  2962     12  OC-ORIG-REC.
  2963         16  OC-INS-LAST-NAME              PIC X(15).
  2964         16  OC-INS-FIRST-NAME             PIC X(10).
  2965         16  OC-INS-MIDDLE-INIT            PIC X.
  2966         16  OC-INS-AGE                    PIC S999     COMP-3.
  2967         16  OC-JNT-LAST-NAME              PIC X(15).
  2968         16  OC-JNT-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  56
* EL050.cbl
  2969         16  OC-JNT-MIDDLE-INIT            PIC X.
  2970         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2971         16  OC-LF-BENCD                   PIC XX.
  2972         16  OC-LF-TERM                    PIC S999      COMP-3.
  2973         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2974         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2975         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2976         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2977         16  OC-LF-EXP-DT                  PIC XX.
  2978         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2979         16  OC-LF-CANCEL-DT               PIC XX.
  2980         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2981         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2982         16  OC-AH-BENCD                   PIC XX.
  2983         16  OC-AH-TERM                    PIC S999      COMP-3.
  2984         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2985         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2986         16  OC-AH-EXP-DT                  PIC XX.
  2987         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2988         16  OC-AH-CP                      PIC 99.
  2989         16  OC-AH-CANCEL-DT               PIC XX.
  2990         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2991         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2992         16  OC-CRED-BENE-NAME             PIC X(25).
  2993         16  OC-1ST-PMT-DT                 PIC XX.
  2994         16  FILLER                        PIC X(215).
  2995
  2996     12  FILLER                            PIC X(50).
  2997******************************************************************
  2998
  2999*    COPY ELCDATE.
  3000******************************************************************
  3001*                                                                *
  3002*                                                                *
  3003*                            ELCDATE.                            *
  3004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3005*                            VMOD=2.003
  3006*                                                                *
  3007*                                                                *
  3008*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3009*                 LENGTH = 200                                   *
  3010******************************************************************
  3011
  3012 01  DATE-CONVERSION-DATA.
  3013     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3014     12  DC-OPTION-CODE                PIC X.
  3015         88  BIN-TO-GREG                VALUE ' '.
  3016         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3017         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3018         88  YMD-GREG-TO-BIN            VALUE '3'.
  3019         88  MDY-GREG-TO-BIN            VALUE '4'.
  3020         88  JULIAN-TO-BIN              VALUE '5'.
  3021         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3022         88  FIND-CENTURY               VALUE '7'.
  3023         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3024         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3025         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3026         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  57
* EL050.cbl
  3027         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3028         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3029         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3030         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3031         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3032         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3033         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3034         88  BIN-3-TO-GREG              VALUE 'I'.
  3035         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3036         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3037         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3038         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3039         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3040         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3041         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3042         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3043         88  THREE-CHARACTER-BIN
  3044                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3045         88  GREGORIAN-TO-BIN
  3046                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3047         88  BIN-TO-GREGORIAN
  3048                  VALUES ' ' '1' 'I' '8' 'G'.
  3049         88  JULIAN-TO-BINARY
  3050                  VALUES '5' 'C' 'E' 'F'.
  3051     12  DC-ERROR-CODE                 PIC X.
  3052         88  NO-CONVERSION-ERROR        VALUE ' '.
  3053         88  DATE-CONVERSION-ERROR
  3054                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3055         88  DATE-IS-ZERO               VALUE '1'.
  3056         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3057         88  DATE-IS-INVALID            VALUE '3'.
  3058         88  DATE1-GREATER-DATE2        VALUE '4'.
  3059         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3060         88  DATE-INVALID-OPTION        VALUE '9'.
  3061         88  INVALID-CENTURY            VALUE 'A'.
  3062         88  ONLY-CENTURY               VALUE 'B'.
  3063         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3064         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3065     12  DC-END-OF-MONTH               PIC X.
  3066         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3067     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3068         88  USE-NORMAL-PROCESS         VALUE ' '.
  3069         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3070         88  ADJUST-UP-100-YRS          VALUE '2'.
  3071     12  FILLER                        PIC X.
  3072     12  DC-CONVERSION-DATES.
  3073         16  DC-BIN-DATE-1             PIC XX.
  3074         16  DC-BIN-DATE-2             PIC XX.
  3075         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3076         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3077                       DC-GREG-DATE-1-EDIT.
  3078             20  DC-EDIT1-MONTH        PIC 99.
  3079             20  SLASH1-1              PIC X.
  3080             20  DC-EDIT1-DAY          PIC 99.
  3081             20  SLASH1-2              PIC X.
  3082             20  DC-EDIT1-YEAR         PIC 99.
  3083         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3084         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  58
* EL050.cbl
  3085                     DC-GREG-DATE-2-EDIT.
  3086             20  DC-EDIT2-MONTH        PIC 99.
  3087             20  SLASH2-1              PIC X.
  3088             20  DC-EDIT2-DAY          PIC 99.
  3089             20  SLASH2-2              PIC X.
  3090             20  DC-EDIT2-YEAR         PIC 99.
  3091         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3092         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3093                     DC-GREG-DATE-1-YMD.
  3094             20  DC-YMD-YEAR           PIC 99.
  3095             20  DC-YMD-MONTH          PIC 99.
  3096             20  DC-YMD-DAY            PIC 99.
  3097         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3098         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3099                      DC-GREG-DATE-1-MDY.
  3100             20  DC-MDY-MONTH          PIC 99.
  3101             20  DC-MDY-DAY            PIC 99.
  3102             20  DC-MDY-YEAR           PIC 99.
  3103         16  DC-GREG-DATE-1-ALPHA.
  3104             20  DC-ALPHA-MONTH        PIC X(10).
  3105             20  DC-ALPHA-DAY          PIC 99.
  3106             20  FILLER                PIC XX.
  3107             20  DC-ALPHA-CENTURY.
  3108                 24 DC-ALPHA-CEN-N     PIC 99.
  3109             20  DC-ALPHA-YEAR         PIC 99.
  3110         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3111         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3112         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3113         16  DC-JULIAN-DATE            PIC 9(05).
  3114         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3115                                       PIC 9(05).
  3116         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3117             20  DC-JULIAN-YEAR        PIC 99.
  3118             20  DC-JULIAN-DAYS        PIC 999.
  3119         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3120         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3121         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3122     12  DATE-CONVERSION-VARIBLES.
  3123         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3124         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3125             20  FILLER                PIC 9(3).
  3126             20  HOLD-CEN-1-CCYY.
  3127                 24  HOLD-CEN-1-CC     PIC 99.
  3128                 24  HOLD-CEN-1-YY     PIC 99.
  3129             20  HOLD-CEN-1-MO         PIC 99.
  3130             20  HOLD-CEN-1-DA         PIC 99.
  3131         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3132             20  HOLD-CEN-1-R-MO       PIC 99.
  3133             20  HOLD-CEN-1-R-DA       PIC 99.
  3134             20  HOLD-CEN-1-R-CCYY.
  3135                 24  HOLD-CEN-1-R-CC   PIC 99.
  3136                 24  HOLD-CEN-1-R-YY   PIC 99.
  3137             20  FILLER                PIC 9(3).
  3138         16  HOLD-CENTURY-1-X.
  3139             20  FILLER                PIC X(3)  VALUE SPACES.
  3140             20  HOLD-CEN-1-X-CCYY.
  3141                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3142                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  59
* EL050.cbl
  3143             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3144             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3145         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3146             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3147             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3148             20  HOLD-CEN-1-R-X-CCYY.
  3149                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3150                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3151             20  FILLER                PIC XXX.
  3152         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3153         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3154         16  DC-JULIAN-DATE-1          PIC 9(07).
  3155         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3156             20  DC-JULIAN-1-CCYY.
  3157                 24  DC-JULIAN-1-CC    PIC 99.
  3158                 24  DC-JULIAN-1-YR    PIC 99.
  3159             20  DC-JULIAN-DA-1        PIC 999.
  3160         16  DC-JULIAN-DATE-2          PIC 9(07).
  3161         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3162             20  DC-JULIAN-2-CCYY.
  3163                 24  DC-JULIAN-2-CC    PIC 99.
  3164                 24  DC-JULIAN-2-YR    PIC 99.
  3165             20  DC-JULIAN-DA-2        PIC 999.
  3166         16  DC-GREG-DATE-A-EDIT.
  3167             20  DC-EDITA-MONTH        PIC 99.
  3168             20  SLASHA-1              PIC X VALUE '/'.
  3169             20  DC-EDITA-DAY          PIC 99.
  3170             20  SLASHA-2              PIC X VALUE '/'.
  3171             20  DC-EDITA-CCYY.
  3172                 24  DC-EDITA-CENT     PIC 99.
  3173                 24  DC-EDITA-YEAR     PIC 99.
  3174         16  DC-GREG-DATE-B-EDIT.
  3175             20  DC-EDITB-MONTH        PIC 99.
  3176             20  SLASHB-1              PIC X VALUE '/'.
  3177             20  DC-EDITB-DAY          PIC 99.
  3178             20  SLASHB-2              PIC X VALUE '/'.
  3179             20  DC-EDITB-CCYY.
  3180                 24  DC-EDITB-CENT     PIC 99.
  3181                 24  DC-EDITB-YEAR     PIC 99.
  3182         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3183         16  DC-GREG-DATE-CYMD-R REDEFINES
  3184                              DC-GREG-DATE-CYMD.
  3185             20  DC-CYMD-CEN           PIC 99.
  3186             20  DC-CYMD-YEAR          PIC 99.
  3187             20  DC-CYMD-MONTH         PIC 99.
  3188             20  DC-CYMD-DAY           PIC 99.
  3189         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3190         16  DC-GREG-DATE-MDCY-R REDEFINES
  3191                              DC-GREG-DATE-MDCY.
  3192             20  DC-MDCY-MONTH         PIC 99.
  3193             20  DC-MDCY-DAY           PIC 99.
  3194             20  DC-MDCY-CEN           PIC 99.
  3195             20  DC-MDCY-YEAR          PIC 99.
  3196    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3197        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3198    12  DC-EL310-DATE                  PIC X(21).
  3199    12  FILLER                         PIC X(28).
  3200
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  60
* EL050.cbl
  3202*    COPY ELCCALC.
  3203******************************************************************
  3204*                                                                *
  3205*                           ELCCALC.                            *
  3206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3207*                            VMOD=2.025                          *
  3208*                                                                *
  3209*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3210*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3211*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3212*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3213*                                                                *
  3214*  PASSED TO ELRTRM                                              *
  3215*  -----------------                                             *
  3216*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3217*  ORIGINAL TERM                                                 *
  3218*  BEGINNING DATE                                                *
  3219*  ENDING DATE                                                   *
  3220*  COMPANY I.D.                                                  *
  3221*  ACCOUNT MASTER USER FIELD                                     *
  3222*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3223*  FREE LOOK DAYS                                                *
  3224*                                                                *
  3225*  RETURNED FROM ELRTRM                                          *
  3226*  ---------------------                                         *
  3227*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3228*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3229*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3230*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3231*----------------------------------------------------------------*
  3232*  PASSED TO ELRAMT                                              *
  3233*  ----------------                                              *
  3234*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3235*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3236*  ORIGINAL AMOUNT                                               *
  3237*  ALTERNATE BENEFIT (BALLON)                                    *
  3238*  A.P.R. - NET PAY ONLY                                         *
  3239*  METHOD
  3240*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3241*  COMPANY I.D.                                                  *
  3242*  BENEFIT TYPE                                                  *
  3243*                                                                *
  3244*  RETURNED FROM ELRAMT                                          *
  3245*  --------------------                                          *
  3246*  REMAINING AMOUNT 1 - CURRENT                                  *
  3247*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3248*  REMAINING AMOUNT FACTOR
  3249*----------------------------------------------------------------*
  3250*  PASSED TO ELRESV                                              *
  3251*  -----------------                                             *
  3252*  CERTIFICATE EFFECTIVE DATE                                    *
  3253*  VALUATION DATE                                                *
  3254*  PAID THRU DATE                                                *
  3255*  BENEFIT                                                       *
  3256*  INCURRED DATE                                                 *
  3257*  REPORTED DATE                                                 *
  3258*  ISSUE AGE                                                     *
  3259*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  61
* EL050.cbl
  3260*  CDT PERCENT                                                   *
  3261*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3262* *CLAIM TYPE (LIFE, A/H)                                        *
  3263* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3264* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3265*                                                                *
  3266*  RETURNED FROM ELRESV                                          *
  3267*  --------------------                                          *
  3268*  CDT TABLE USED                                                *
  3269*  CDT FACTOR USED                                               *
  3270*  PAY TO CURRENT RESERVE                                        *
  3271*  I.B.N.R. - A/H ONLY                                           *
  3272*  FUTURE (ACCRUED) AH ONLY                                      *
  3273*----------------------------------------------------------------*
  3274*  PASSED TO ELRATE                                              *
  3275*  ----------------                                              *
  3276*  CERT ISSUE DATE                                               *
  3277*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3278*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3279*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3280*  STATE CODE (CLIENT DEFINED)                                   *
  3281*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3282*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3283*  DEVIATION CODE                                                *
  3284*  ISSUE AGE                                                     *
  3285*  ORIGINAL BENEFIT AMOUNT                                       *
  3286*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3287*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3288*  BENEFIT KIND (LIFE OR A/H)                                    *
  3289*  A.P.R.                                                        *
  3290*  METHOD
  3291*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3292*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3293*  COMPANY I.D. (3 CHARACTER)                                    *
  3294*  BENEFIT CODE                                                  *
  3295*  BENEFIT OVERRIDE CODE                                         *
  3296*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3297*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3298*  JOINT INDICATOR (CSL ONLY)                                    *
  3299*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3300*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3301*                                                                *
  3302*  RETURNED FROM ELRATE                                          *
  3303*  --------------------                                          *
  3304*  CALCULATED PREMIUM                                            *
  3305*  PREMIUM RATE                                                  *
  3306*  MORTALITY CODE                                                *
  3307*  MAX ATTAINED AGE                                              *
  3308*  MAX AGE                                                       *
  3309*  MAX TERM                                                      *
  3310*  MAX MONTHLY BENEFIT                                           *
  3311*  MAX TOTAL BENIFIT                                             *
  3312*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3313*----------------------------------------------------------------*
  3314*  PASSED TO ELRFND                                              *
  3315*  ----------------                                              *
  3316*  CERT ISSUE DATE                                               *
  3317*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  62
* EL050.cbl
  3318*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3319*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3320*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3321*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3322*  STATE CODE (CLIENT DEFINED)                                   *
  3323*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3324*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3325*  DEVIATION CODE                                                *
  3326*  ISSUE AGE                                                     *
  3327*  ORIGINAL BENEFIT AMOUNT                                       *
  3328*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3329*  PROCESS TYPE (CANCEL)                                         *
  3330*  BENEFIT KIND (LIFE OR A/H)                                    *
  3331*  A.P.R.                                                        *
  3332*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3333*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3334*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3335*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3336*  COMPANY I.D. (3 CHARACTER)                                    *
  3337*  BENEFIT CODE                                                  *
  3338*  BENEFIT OVERRIDE CODE                                         *
  3339*                                                                *
  3340*  RETURNED FROM ELRFND                                          *
  3341*  --------------------                                          *
  3342*  CALCULATED REFUND                                             *
  3343*----------------------------------------------------------------*
  3344*  PASSED TO ELEARN                                              *
  3345*  ----------------                                              *
  3346*  CERT ISSUE DATE                                               *
  3347*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3348*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3349*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3350*  STATE CODE (CLIENT DEFINED)                                   *
  3351*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3352*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3353*  DEVIATION CODE                                                *
  3354*  ISSUE AGE                                                     *
  3355*  ORIGINAL BENEFIT AMOUNT                                       *
  3356*  BENEFIT KIND (LIFE OR A/H)                                    *
  3357*  A.P.R.                                                        *
  3358*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3359*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3360*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3361*  COMPANY I.D. (3 CHARACTER)                                    *
  3362*  BENEFIT CODE                                                  *
  3363*  BENEFIT OVERRIDE CODE                                         *
  3364*                                                                *
  3365*  RETURNED FROM ELEARN                                          *
  3366*  --------------------                                          *
  3367*  INDICATED  EARNINGS                                           *
  3368*----------------------------------------------------------------*
  3369*                 LENGTH = 450                                   *
  3370*                                                                *
  3371******************************************************************
  3372******************************************************************
  3373*                   C H A N G E   L O G
  3374*
  3375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  63
* EL050.cbl
  3376*-----------------------------------------------------------------
  3377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3378* EFFECTIVE    NUMBER
  3379*-----------------------------------------------------------------
  3380* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3381* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3382* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3383* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3384* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3385* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3386* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3387* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3388* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3389******************************************************************
  3390
  3391 01  CALCULATION-PASS-AREA.
  3392     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3393                                     COMP.
  3394
  3395     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3396       88  NO-CP-ERROR                             VALUE ZERO.
  3397       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3398                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3399       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3400       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3401       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3402       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3403       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3404       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3405       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3406       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3407       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3408       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3409       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3410       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3411       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3412       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3413       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3414       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3415       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3416
  3417     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3418       88  NO-CP-ERROR-2                           VALUE ZERO.
  3419***********************  INPUT AREAS ****************************
  3420
  3421     12  CP-CALCULATION-AREA.
  3422         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3423         16  CP-CERT-EFF-DT        PIC XX.
  3424         16  CP-VALUATION-DT       PIC XX.
  3425         16  CP-PAID-THRU-DT       PIC XX.
  3426         16  CP-BENEFIT-TYPE       PIC X.
  3427           88  CP-AH                               VALUE 'A' 'D'
  3428                                                   'I' 'U'.
  3429           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3430           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3431         16  CP-INCURRED-DT        PIC XX.
  3432         16  CP-REPORTED-DT        PIC XX.
  3433         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  64
* EL050.cbl
  3434         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3435         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3436                                     COMP-3.
  3437         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3438                                     COMP-3.
  3439         16  CP-CDT-METHOD         PIC X.
  3440           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3441           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3442           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3443         16  CP-CLAIM-TYPE         PIC X.
  3444           88  CP-AH-CLAIM                         VALUE 'A'.
  3445           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3446         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3447                                     COMP-3.
  3448         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3449                                     COMP-3.
  3450         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3451                                     COMP-3.
  3452         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3453                                     COMP-3.
  3454         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3455                                     COMP-3.
  3456         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3457                                     COMP-3.
  3458         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3459                                     COMP-3.
  3460         16  CP-REM-TERM-METHOD    PIC X.
  3461           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3462           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3463           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3464           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3465           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3466           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3467           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3468         16  CP-EARNING-METHOD     PIC X.
  3469           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3470           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3471           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3472           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3473           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3474           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3475           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3476           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3477           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3478           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3479           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3480           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3481           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3482           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3483         16  CP-PROCESS-TYPE       PIC X.
  3484           88  CP-CLAIM                            VALUE '1'.
  3485           88  CP-CANCEL                           VALUE '2'.
  3486           88  CP-ISSUE                            VALUE '3'.
  3487         16  CP-SPECIAL-CALC-CD    PIC X.
  3488           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3489           88  CP-1-MTH-INTEREST               VALUE ' '.
  3490           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3491           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  65
* EL050.cbl
  3492           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3493           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3494           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3495           88  CP-FARM-PLAN                    VALUE 'F'.
  3496           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3497           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3498           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3499           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3500           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3501           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3502           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3503           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3504           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3505           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3506                                                     'W' 'X'.
  3507           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3508           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3509           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3510           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3511           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3512           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3513           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3514           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3515           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3516           88  CP-CSL-METH-1                   VALUE '5'.
  3517           88  CP-CSL-METH-2                   VALUE '6'.
  3518           88  CP-CSL-METH-3                   VALUE '7'.
  3519           88  CP-CSL-METH-4                   VALUE '8'.
  3520
  3521         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3524         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3525         16  CP-STATE              PIC XX          VALUE SPACE.
  3526         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3527         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3528           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3529               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3530         16  CP-R78-OPTION         PIC X.
  3531           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3532           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3533
  3534         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3535         16  CP-IBNR-RESERVE-SW    PIC X.
  3536         16  CP-CLAIM-STATUS       PIC X.
  3537         16  CP-RATE-FILE          PIC X.
  3538         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3539                                     COMP-3.
  3540
  3541         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3542         16  CP-AH-OVERRIDE-CODE   PIC X.
  3543
  3544         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3547                                   PIC S9(5)V99 COMP-3.
  3548         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3549                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  66
* EL050.cbl
  3550         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3553                                     COMP-3.
  3554         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3555                                  PIC S9(7)V99 COMP-3.
  3556
  3557         16  CP-PAID-FROM-DATE     PIC X(02).
  3558         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3559         16  CP-EXT-DAYS-CALC      PIC X.
  3560           88  CP-EXT-NO-CHG                   VALUE ' '.
  3561           88  CP-EXT-CHG-LF                   VALUE '1'.
  3562           88  CP-EXT-CHG-AH                   VALUE '2'.
  3563           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3564         16  CP-DOMICILE-STATE     PIC XX.
  3565         16  CP-CARRIER            PIC X.
  3566         16  CP-REIN-FLAG          PIC X.
  3567         16  CP-REM-TRM-CALC-OPTION PIC X.
  3568           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3569                      '2' '3' '4' '5'.
  3570           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3571           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3572           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3573           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3574           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3575           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3576           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3577           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3578         16  CP-SIG-SWITCH         PIC X.
  3579         16  CP-RATING-METHOD      PIC X.
  3580           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3581           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3582           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3583           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3584           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3585           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3586           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3587           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3588           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3589         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3590                                     COMP-3.
  3591         16  CP-BEN-CATEGORY       PIC X.
  3592         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3593         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3594                                   PIC S99V9(5) COMP-3.
  3595         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3596         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3597                                   PIC S99V9(5) COMP-3.
  3598         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3599         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3600         16  CP-EXPIRE-DT          PIC XX.
  3601         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3602         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3603         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3604         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3605         16  CP-DDF-SPEC-CALC      PIC X.
  3606             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3607             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  67
* EL050.cbl
  3608         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3609         16  CP-CANCEL-REASON      PIC X.
  3610         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3611         16  CP-PMT-MODE           PIC X.
  3612         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3613         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3614         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3615         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3616         16  FILLER                PIC X.
  3617
  3618***************    OUTPUT FROM ELRESV   ************************
  3619
  3620         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3621
  3622         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3623                                     COMP-3.
  3624         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3625                                     COMP-3.
  3626         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3627                                     COMP-3.
  3628         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3629                                     COMP-3.
  3630         16  FILLER                PIC X(09).
  3631***************    OUTPUT FROM ELRTRM   *************************
  3632
  3633         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3636                                     COMP-3.
  3637         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3638                                     COMP-3.
  3639         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3640                                     COMP-3.
  3641         16  FILLER                PIC X(12).
  3642
  3643***************    OUTPUT FROM ELRAMT   *************************
  3644
  3645         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3648                                     COMP-3.
  3649         16  FILLER                PIC X(12).
  3650
  3651***************    OUTPUT FROM ELRATE   *************************
  3652
  3653         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-MORTALITY-CODE     PIC X(4).
  3658         16  CP-RATE-EDIT-FLAG     PIC X.
  3659             88  CP-RATES-NEED-APR                  VALUE '1'.
  3660         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3663         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3664         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3665                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  68
* EL050.cbl
  3666         16  FILLER                PIC X(07).
  3667
  3668***************    OUTPUT FROM ELRFND   *************************
  3669
  3670         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-REFUND-TYPE-USED   PIC X.
  3673           88  CP-R-AS-R78                         VALUE '1'.
  3674           88  CP-R-AS-PRORATA                     VALUE '2'.
  3675           88  CP-R-AS-CALIF                       VALUE '3'.
  3676           88  CP-R-AS-TEXAS                       VALUE '4'.
  3677           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3678           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3679           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3680           88  CP-R-AS-MEAN                        VALUE '8'.
  3681           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3682           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3683           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3684           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3685           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3686           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3687         16  FILLER                PIC X(12).
  3688
  3689***************    OUTPUT FROM ELEARN   *************************
  3690
  3691         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3702                                     COMP-3.
  3703         16  CP-EARNING-TYPE-USED  PIC X.
  3704           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3705           88  CP-E-AS-R78                         VALUE '1'.
  3706           88  CP-E-AS-PRORATA                     VALUE '2'.
  3707           88  CP-E-AS-TEXAS                       VALUE '4'.
  3708           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3709           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3710           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3711           88  CP-E-AS-MEAN                        VALUE '8'.
  3712           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3713         16  FILLER                PIC X(12).
  3714
  3715***************    OUTPUT FROM ELPMNT   *************************
  3716
  3717         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  FILLER                PIC X(12).
  3722
  3723***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  69
* EL050.cbl
  3724         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3737             88  OPEN-RATE-FILE                   VALUE 'O'.
  3738             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3739             88  IO-ERROR                         VALUE 'E'.
  3740
  3741         16  CP-FIRST-PAY-DATE     PIC XX.
  3742
  3743         16  CP-JOINT-INDICATOR    PIC X.
  3744
  3745         16  CP-RESERVE-REMAINING-TERM
  3746                                   PIC S9(4)V9    VALUE ZERO
  3747                                     COMP-3.
  3748
  3749         16  CP-INSURED-BIRTH-DT   PIC XX.
  3750
  3751         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3752                                     COMP-3.
  3753
  3754         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3755                                     COMP-3.
  3756
  3757         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3758                                     COMP-3.
  3759
  3760         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3761                                     COMP-3.
  3762
  3763         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3764                                     COMP-3.
  3765
  3766         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3767                                     COMP-3.
  3768
  3769         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3770                                     COMP-3.
  3771
  3772         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3773             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3774
  3775         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3780         16  FILLER                PIC X(15).
  3781******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  70
* EL050.cbl
  3783******************************************************************
  3784*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3785*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3786*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3787*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3788*** MODIFICATION.                                              ***
  3789*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3790*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3791******************************************************************
  3792*    COPY ERCPNDB.
  3793******************************************************************
  3794*                                                                *
  3795*                                                                *
  3796*                            ERCPNDB.                            *
  3797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3798*                            VMOD=2.025                          *
  3799*                                                                *
  3800*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3801*                                                                *
  3802******************************************************************
  3803*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3804*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3805******************************************************************
  3806*                                                                *
  3807*                                                                *
  3808*   FILE TYPE = VSAM,KSDS                                        *
  3809*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3810*                                                                *
  3811*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3812*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3813*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3814*                                                 RKP=13,LEN=36  *
  3815*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3816*                                      AND CHG-SEQ.)             *
  3817*                                                RKP=49,LEN=11   *
  3818*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3819*                                      AND CHG-SEQ.)             *
  3820*                                                RKP=60,LEN=15   *
  3821*                                                                *
  3822*   LOG = NO                                                     *
  3823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3824******************************************************************
  3825******************************************************************
  3826*                   C H A N G E   L O G
  3827*
  3828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3829*-----------------------------------------------------------------
  3830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3831* EFFECTIVE    NUMBER
  3832*-----------------------------------------------------------------
  3833* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3834* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3835* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3836* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3837* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3838* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3839* 032306                   PEMA  ADD BOW LOAN NUMBER
  3840* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  71
* EL050.cbl
  3841* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3842* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3843* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3844* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3845* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3846* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3847* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3848******************************************************************
  3849
  3850 01  PENDING-BUSINESS.
  3851     12  PB-RECORD-ID                     PIC XX.
  3852         88  VALID-PB-ID                        VALUE 'PB'.
  3853
  3854     12  PB-CONTROL-PRIMARY.
  3855         16  PB-COMPANY-CD                PIC X.
  3856         16  PB-ENTRY-BATCH               PIC X(6).
  3857         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3858         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3859
  3860     12  PB-CONTROL-BY-ACCOUNT.
  3861         16  PB-COMPANY-CD-A1             PIC X.
  3862         16  PB-CARRIER                   PIC X.
  3863         16  PB-GROUPING.
  3864             20  PB-GROUPING-PREFIX       PIC XXX.
  3865             20  PB-GROUPING-PRIME        PIC XXX.
  3866         16  PB-STATE                     PIC XX.
  3867         16  PB-ACCOUNT.
  3868             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3869             20  PB-ACCOUNT-PRIME         PIC X(6).
  3870         16  PB-CERT-EFF-DT               PIC XX.
  3871         16  PB-CERT-NO.
  3872             20  PB-CERT-PRIME            PIC X(10).
  3873             20  PB-CERT-SFX              PIC X.
  3874         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3875
  3876         16  PB-RECORD-TYPE               PIC X.
  3877             88  PB-MAILING-DATA                VALUE '0'.
  3878             88  PB-ISSUE                       VALUE '1'.
  3879             88  PB-CANCELLATION                VALUE '2'.
  3880             88  PB-BATCH-TRAILER               VALUE '9'.
  3881
  3882     12  PB-CONTROL-BY-ORIG-BATCH.
  3883         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3884         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3885         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3886         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3887
  3888     12  PB-CONTROL-BY-CSR.
  3889         16  PB-CSR-COMPANY-CD            PIC X.
  3890         16  PB-CSR-ID                    PIC X(4).
  3891         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3892         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3893         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3894******************************************************************
  3895*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3896******************************************************************
  3897
  3898     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  72
* EL050.cbl
  3899     12  PB-LAST-MAINT-BY                 PIC X(4).
  3900     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3901
  3902     12  PB-RECORD-BODY                   PIC X(375).
  3903
  3904     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3905         16  PB-CERT-ORIGIN               PIC X.
  3906             88  CLASIC-CREATED-CERT         VALUE '1'.
  3907         16  PB-I-NAME.
  3908             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3909             20  PB-I-INSURED-FIRST-NAME.
  3910                 24  PB-I-INSURED-1ST-INIT PIC X.
  3911                 24  FILLER                PIC X(9).
  3912             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3913         16  PB-I-AGE                     PIC S99   COMP-3.
  3914         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3915         16  PB-I-BIRTHDAY                PIC XX.
  3916         16  PB-I-INSURED-SEX             PIC X.
  3917             88  PB-SEX-MALE     VALUE 'M'.
  3918             88  PB-SEX-FEMALE   VALUE 'F'.
  3919
  3920         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3921         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3922         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3923         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3924         16  PB-I-SKIP-CODE               PIC X.
  3925             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3926             88  PB-SKIP-JULY              VALUE '1'.
  3927             88  PB-SKIP-AUGUST            VALUE '2'.
  3928             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3929             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3930             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3931             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3932             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3933             88  PB-SKIP-JUNE              VALUE '8'.
  3934             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3935             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3936             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3937         16  PB-I-TERM-TYPE               PIC X.
  3938             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3939             88  PB-PAID-WEEKLY            VALUE 'W'.
  3940             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3941             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3942             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3943         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3944         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3945         16  PB-I-DATA-ENTRY-SW           PIC X.
  3946             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3947             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3948             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3949             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3950         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3951         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3952*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3953         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3954         16  FILLER                       PIC X.
  3955
  3956         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  73
* EL050.cbl
  3957             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3958             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3959                                                   '90' THRU '99'.
  3960         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3961                                          PIC XX.
  3962         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3963         16  PB-I-AMOUNT-FINANCED REDEFINES
  3964                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3965         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3966         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3967                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3968         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3969         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3970         16  PB-I-CLP-AMOUNT REDEFINES
  3971                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3972         16  PB-I-LF-CALC-FLAG            PIC X.
  3973             88 PB-COMP-LF-PREM               VALUE '?'.
  3974         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3975         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3976         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3977         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3978         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3979         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3980         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3981         16  PB-I-LF-ABBR                 PIC XXX.
  3982         16  PB-I-LF-INPUT-CD             PIC XX.
  3983
  3984         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3985             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3986             88  PB-INVALID-AH               VALUE '  ' '00'
  3987                                                   '90' THRU '99'.
  3988         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3989         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3990         16  PB-I-AH-CALC-FLAG            PIC X.
  3991             88 PB-COMP-AH-PREM                  VALUE '?'.
  3992         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3993         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3994         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3995         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3996         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3997         16  PB-I-AH-ABBR                 PIC XXX.
  3998         16  PB-I-AH-INPUT-CD             PIC XXX.
  3999
  4000         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4001         16  PB-I-REIN-TABLE              PIC XXX.
  4002         16  PB-I-BUSINESS-TYPE           PIC 99.
  4003         16  PB-I-INDV-GRP-CD             PIC X.
  4004         16  PB-I-MORT-CODE.
  4005             20  PB-I-TABLE               PIC X.
  4006             20  PB-I-INTEREST            PIC XX.
  4007             20  PB-I-MORT-TYP            PIC X.
  4008         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4009         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4010         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4011         16  PB-I-INDV-GRP-OVRD           PIC X.
  4012         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4013         16  PB-I-SIG-SW                  PIC X.
  4014             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  74
* EL050.cbl
  4015         16  PB-I-RATE-CLASS              PIC XX.
  4016         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4017         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4018         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4019         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4020         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4021         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4022         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4023         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4024         16  PB-I-OB-FLAG                 PIC X.
  4025             88  PB-I-OB                      VALUE 'B'.
  4026             88  PB-I-SUMMARY                 VALUE 'Z'.
  4027         16  PB-I-ENTRY-STATUS            PIC X.
  4028             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4029                                              'M' '5' '9' '2'.
  4030             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4031             88  PB-I-POLICY-PENDING          VALUE '2'.
  4032             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4033             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4034             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4035             88  PB-I-REIN-ONLY               VALUE '9'.
  4036             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4037             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4038             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4039             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4040         16  PB-I-INT-CODE                PIC X.
  4041             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4042             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4043         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4044         16  PB-I-SOC-SEC-NO              PIC X(11).
  4045         16  PB-I-MEMBER-NO               PIC X(12).
  4046         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4047*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4048         16  PB-I-OLD-LOF                 PIC XXX.
  4049         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4050         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4051         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4052         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4053         16  PB-I-LIFE-INDICATOR          PIC X.
  4054             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4055         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4056         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4057                                          PIC S9(5)V99    COMP-3.
  4058         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4059             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4060             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4061         16  PB-I-1ST-PMT-DT              PIC XX.
  4062         16  PB-I-JOINT-INSURED.
  4063             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4064             20 PB-I-JOINT-FIRST-NAME.
  4065                24  PB-I-JOINT-FIRST-INIT PIC X.
  4066                24  FILLER                PIC X(9).
  4067             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4068*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4069         16  PB-I-BENEFICIARY-NAME.
  4070             20  PB-I-BANK-NUMBER         PIC X(10).
  4071             20  FILLER                   PIC X(15).
  4072         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  75
* EL050.cbl
  4073         16  PB-I-REFERENCE               PIC X(12).
  4074         16  FILLER REDEFINES PB-I-REFERENCE.
  4075             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4076             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4077             20  PB-I-CLP-STATE           PIC XX.
  4078         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4079             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4080             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4081             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4082         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4083         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4084         16  PB-I-RESIDENT-STATE          PIC XX.
  4085         16  PB-I-RATE-CODE               PIC X(4).
  4086         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4087         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4088         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4089         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4090         16  PB-I-BANK-NOCHRGB            PIC 99.
  4091         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4092         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4093
  4094     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4095         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4096             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4097         16  PB-C-CANCEL-ORIGIN           PIC X.
  4098             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4099         16  PB-C-LF-CANCEL-DT            PIC XX.
  4100         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4101         16  PB-C-LF-CALC-REQ             PIC X.
  4102             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4103         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4104         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4105         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4106             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4107         16  PB-C-AH-CANCEL-DT            PIC XX.
  4108         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4109         16  PB-C-AH-CALC-REQ             PIC X.
  4110             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4111         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4112         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4113         16  PB-C-LAST-NAME               PIC X(15).
  4114         16  PB-C-REFUND-SW               PIC X.
  4115             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4116             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4117         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4118         16  PB-C-PAYEE-CODE              PIC X(6).
  4119         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4120         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4121         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4122         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4123         16  PB-C-REFERENCE               PIC X(12).
  4124         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4125         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4126         16  PB-C-POST-CARD-IND           PIC X.
  4127         16  PB-C-CANCEL-REASON           PIC X.
  4128         16  PB-C-REF-INTERFACE-SW        PIC X.
  4129         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4130         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  76
* EL050.cbl
  4131         16  FILLER                       PIC X(01).
  4132*        16  FILLER                       PIC X(18).
  4133         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4134*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4135         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4136         16  PB-CANCELED-CERT-DATA.
  4137             20  PB-CI-INSURED-NAME.
  4138                 24  PB-CI-LAST-NAME      PIC X(15).
  4139                 24  PB-CI-INITIALS       PIC XX.
  4140             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4141             20  PB-CI-INSURED-SEX        PIC X.
  4142             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4143             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4144             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4145             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4146             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4147             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4148             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4149             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4150             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4151             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4152             20  PB-CI-RATE-CLASS         PIC XX.
  4153             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4154             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4155             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4156             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4157             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4158             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4159             20  PB-CI-LF-ABBR            PIC X(3).
  4160             20  PB-CI-AH-ABBR            PIC X(3).
  4161             20  PB-CI-OB-FLAG            PIC X.
  4162                 88  PB-CI-OB                VALUE 'B'.
  4163             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4164                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4165                                           'M' '4' '5' '9' '2'.
  4166                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4167                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4168                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4169                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4170                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4171                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4172                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4173                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4174                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4175                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4176                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4177                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4178             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4179                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4180                                           'M' '4' '5' '9' '2'.
  4181                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4182                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4183                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4184                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4185                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4186                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4187                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4188                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  77
* EL050.cbl
  4189                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4190                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4191                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4192                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4193             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4194             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4195             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4196             20  PB-CI-MEMBER-NO          PIC X(12).
  4197             20  PB-CI-INT-CODE           PIC X.
  4198                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4199                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4200             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4201             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4202             20  PB-CI-COMP-EXCP-SW       PIC X.
  4203                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4204                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4205             20  PB-CI-ENTRY-STATUS       PIC X.
  4206             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4207             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4208             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4209             20  PB-CI-DEATH-DT           PIC XX.
  4210             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4211             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4212             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4213             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4214             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4215             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4216             20  PB-CI-ENTRY-DT              PIC XX.
  4217             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4218             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4219             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4220             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4221             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4222             20  PB-CI-OLD-LOF               PIC XXX.
  4223*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4224             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4225             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4226             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4227             20  PB-CI-INDV-GRP-CD           PIC X.
  4228             20  PB-CI-BENEFICIARY-NAME.
  4229                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4230                 24  FILLER                  PIC X(15).
  4231             20  PB-CI-NOTE-SW               PIC X.
  4232             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4233             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4234             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4235             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4236             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4237             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4238             20  PB-CI-FIRST-NAME            PIC X(10).
  4239             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4240
  4241         16  FILLER                       PIC X(13).
  4242*032306  16  FILLER                       PIC X(27).
  4243*        16  FILLER                       PIC X(46).
  4244
  4245     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4246         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  78
* EL050.cbl
  4247         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4248         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4249         16  PB-M-INSURED-MID-INIT        PIC X.
  4250         16  PB-M-INSURED-AGE             PIC 99.
  4251         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4252         16  PB-M-INSURED-SEX             PIC X.
  4253         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4254         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4255         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4256         16  PB-M-INSURED-CITY-STATE.
  4257             20  PB-M-INSURED-CITY        PIC X(28).
  4258             20  PB-M-INSURED-STATE       PIC XX.
  4259         16  PB-M-INSURED-ZIP-CODE.
  4260             20  PB-M-INSURED-ZIP-PRIME.
  4261                 24  PB-M-INSURED-ZIP-1   PIC X.
  4262                     88  PB-M-CANADIAN-POST-CODE
  4263                                             VALUE 'A' THRU 'Z'.
  4264                 24  FILLER               PIC X(4).
  4265             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4266         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4267                                        PB-M-INSURED-ZIP-CODE.
  4268             20  PM-M-INS-CAN-POST1       PIC XXX.
  4269             20  PM-M-INS-CAN-POST2       PIC XXX.
  4270             20  FILLER                   PIC XXX.
  4271         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4272         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4273         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4274         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4275         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4276         16  PB-M-CRED-BENE-CITYST.
  4277             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4278             20  PB-M-CRED-BENE-STATE     PIC XX.
  4279         16  FILLER                       PIC X(92).
  4280
  4281     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4282         16  FILLER                       PIC X(10).
  4283         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4284         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4285         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4286         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4287         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4288         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4289         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4290         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4291         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4292         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4293         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4294         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4295         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4296         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4297         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4298         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4299         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4300         16  PB-ACCOUNT-NAME              PIC X(30).
  4301         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4302         16  PB-REFERENCE                 PIC X(12).
  4303         16  PB-B-RECEIVED-DT             PIC XX.
  4304         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  79
* EL050.cbl
  4305
  4306     12  PB-RECORD-STATUS.
  4307         16  PB-CREDIT-SELECT-DT          PIC XX.
  4308         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4309         16  PB-BILLED-DT                 PIC XX.
  4310         16  PB-BILLING-STATUS            PIC X.
  4311             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4312             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4313             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4314         16  PB-RECORD-BILL               PIC X.
  4315             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4316             88  PB-RECORD-RETURNED           VALUE 'R'.
  4317             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4318             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4319             88  PB-OVERRIDE-AH               VALUE 'A'.
  4320             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4321         16  PB-BATCH-ENTRY               PIC X.
  4322             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4323             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4324             88  PB-REISSUED-CERT             VALUE 'E'.
  4325             88  PB-MONTHLY-CERT              VALUE 'M'.
  4326             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4327             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4328             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4329         16  PB-FORCE-CODE                PIC X.
  4330             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4331             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4332             88  PB-CANCEL-FORCE              VALUE '8'.
  4333             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4334             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4335             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4336             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4337             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4338             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4339             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4340         16  PB-FATAL-FLAG                PIC X.
  4341             88  PB-FATAL-ERRORS              VALUE 'X'.
  4342         16  PB-FORCE-ER-CD               PIC X.
  4343             88  PB-FORCE-ERRORS              VALUE 'F'.
  4344             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4345         16  PB-WARN-ER-CD                PIC X.
  4346             88  PB-WARNING-ERRORS            VALUE 'W'.
  4347         16  FILLER                       PIC X.
  4348         16  PB-OUT-BAL-CD                PIC X.
  4349             88  PB-OUT-OF-BAL                VALUE 'O'.
  4350         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4351         16  PB-AH-OVERRIDE-L1            PIC X.
  4352         16  PB-INPUT-DT                  PIC XX.
  4353         16  PB-INPUT-BY                  PIC X(4).
  4354         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4355         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4356         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4357         16  PB-LF-EARNING-METHOD         PIC X.
  4358         16  PB-AH-EARNING-METHOD         PIC X.
  4359         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4360         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4361         16  PB-REIN-CD                   PIC XXX.
  4362         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  80
* EL050.cbl
  4363         16  PB-AH-REFUND-TYPE            PIC X.
  4364         16  PB-ACCT-EFF-DT               PIC XX.
  4365         16  PB-ACCT-EXP-DT               PIC XX.
  4366         16  PB-COMPANY-ID                PIC X(3).
  4367         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4368         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4369         16  PB-SV-CARRIER                PIC X.
  4370         16  PB-SV-GROUPING               PIC X(6).
  4371         16  PB-SV-STATE                  PIC XX.
  4372         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4373         16  PB-GA-BILLING-INFO.
  4374             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4375                                          PIC XX.
  4376         16  PB-SV-REMIT-TO  REDEFINES
  4377             PB-GA-BILLING-INFO           PIC X(10).
  4378         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4379         16  PB-I-LOAN-OFFICER            PIC X(5).
  4380         16  PB-I-VIN                     PIC X(17).
  4381
  4382         16  FILLER                       PIC X(04).
  4383         16  IMNET-BYPASS-SW              PIC X.
  4384
  4385******************************************************************
  4386*                COMMON EDIT ERRORS                              *
  4387******************************************************************
  4388
  4389     12  PB-COMMON-ERRORS.
  4390         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4391                                           PIC S9(4)     COMP.
  4392
  4393******************************************************************
  4394
  4395* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4396*    COPY ELC50W1.
  4397******************************************************************
  4398*                                                                *
  4399*                                                                *
  4400*                             ELC50W1                            *
  4401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4402*                            VMOD=2.004                          *
  4403*                                                                *
  4404*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4405*                                                                *
  4406*                                                                *
  4407******************************************************************
  4408
  4409     12  WK-WORK-AREA.
  4410         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4411         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4412         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4413         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4414         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4415         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4416         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4417         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4418         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4419         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4420         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  81
* EL050.cbl
  4421         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4422         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4423         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4424         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4425         16  WK-CREDIT-EDIT-CONTROLS.
  4426             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4427             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4428             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4429             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4430             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4431             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4432         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4433         16  WK-SAVE-REIN-DATA.
  4434             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4435             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4436             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4437         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4438             88  ENTRY-FROM-EL6311       VALUE '6'.
  4439         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4440         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4441     12  WK-RECORD-ADDRESSES.
  4442         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4443         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4444         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4445         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4446         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4447         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4448         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4449         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4450     12  WK-OVER-SHORT-AREA.
  4451         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4452         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4453         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4454             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4455         16  FILLER                   PIC X(5) VALUE SPACES.
  4456
  4457*    COPY ELCEDITC.
  4458******************************************************************
  4459*                                                                *
  4460*                                                                *
  4461*                            ELCEDITC                            *
  4462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4463*                            VMOD=2.012                          *
  4464*                                                                *
  4465*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4466*                     EL6313, EL050 AND EL517.                   *
  4467*                                                                *
  4468******************************************************************
  4469******************************************************************
  4470*                   C H A N G E   L O G
  4471*
  4472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4473*-----------------------------------------------------------------
  4474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4475* EFFECTIVE    NUMBER
  4476*-----------------------------------------------------------------
  4477* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4478******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  82
* EL050.cbl
  4479
  4480     12  EDIT-CRITERIA-DATA.
  4481         16  EC-CO-MONTH-END-DT       PIC XX.
  4482         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4483         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4484         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4485         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4486         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4487         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4488         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4489         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4490         16  EC-CO-REM-TERM-CALC      PIC X.
  4491               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4492               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4493               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4494               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4495
  4496         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4497               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4498               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4499               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4500               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4501               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4502               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4503               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4504               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4505               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4506               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4507
  4508         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4509               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4510               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4511               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4512               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4513               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4514               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4515               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4516               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4517
  4518         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4519                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4520                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4521
  4522         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4523                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4524                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4525                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4526                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4527                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4528                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4529                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4530                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4531
  4532         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4533               88  EC-BR-REDUCING                   VALUE 'R'.
  4534               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4535
  4536         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  83
* EL050.cbl
  4537         16  EC-BR-LF-DESC             PIC X(10).
  4538         16  EC-BR-AH-DESC             PIC X(10).
  4539         16  EC-BR-LF-COMMENT          PIC X(10).
  4540         16  EC-BR-AH-COMMENT          PIC X(10).
  4541
  4542         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4543               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4544               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4545               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4546               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4547
  4548         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4549               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4550               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4551               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4552               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4553
  4554         16  EC-BR-LF-REFUND-CALC      PIC X.
  4555                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4556                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4557                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4558                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4559                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4560                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4561                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4562
  4563         16  EC-BR-AH-REFUND-CALC      PIC X.
  4564                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4565                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4566                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4567                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4568                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4569                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4570                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4571                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4572
  4573         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4574                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4575                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4576                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4577
  4578         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4579                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4580                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4581                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4582
  4583         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4584         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4585         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4586         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4587
  4588         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4589         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4590                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4591                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4592                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4593                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4594
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  84
* EL050.cbl
  4595         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4596               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4597               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4598               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4599               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4600               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4601
  4602         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4603               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4604               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4605               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4606               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4607               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4608
  4609         16  EC-ST-LF-REFUND-CALC      PIC X.
  4610                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4611                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4612                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4613                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4614                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4615                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4616                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4617                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4618
  4619         16  EC-ST-AH-REFUND-CALC      PIC X.
  4620                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4621                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4622                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4623                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4624                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4625                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4626                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4627                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4628
  4629         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4630         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4631         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4632         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4633         16  EC-AM-EXPIRATION-DT       PIC XX.
  4634         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4635         16  EC-AM-CLASS-CD            PIC XX.
  4636         16  EC-AM-LF-DEVIATION        PIC XXX.
  4637         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4638         16  EC-AM-AH-DEVIATION        PIC XXX.
  4639         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4640         16  EC-AM-PHONE-NO            PIC X(10).
  4641
  4642         16  EC-AM-LF-REFUND-CALC      PIC X.
  4643                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4644                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4645                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4646                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4647                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4648                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4649                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4650
  4651         16  EC-AM-AH-REFUND-CALC      PIC X.
  4652                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  85
* EL050.cbl
  4653                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4654                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4655                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4656                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4657                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4658                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4659
  4660         16  EC-AM-BEN-I-G-CD          PIC X.
  4661                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4662                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4663                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4664
  4665         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4666         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4667         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4668         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4669         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4670         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4671         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4672         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4673         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4674
  4675         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4676         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4677         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4678         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4679         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4680         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4681         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4682         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4683         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4684         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4685         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4686         16  EC-RT-LF-NSP-ST           PIC XX.
  4687         16  EC-RT-AH-NSP-ST           PIC XX.
  4688         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4689         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4690
  4691         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4692             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4693                                             'M' '5' '9' '2'.
  4694             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4695             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4696             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4697             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4698             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4699             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4700             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4701             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4702             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4703             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4704
  4705         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4706             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4707                                             'M' '5' '9' '2'.
  4708             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4709             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4710             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  86
* EL050.cbl
  4711             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4712             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4713             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4714             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4715             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4716             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4717             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4718
  4719         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4720         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4721         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4722         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4723         16  EC-CM-DEATH-DT            PIC XX.
  4724
  4725*DMD CUSTOM CODING FIELDS BELOW
  4726*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4727         16  EC-BR-DMD-RATING-SW       PIC X.
  4728                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4729                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4730                 88  NO-DMD-RATING               VALUE 'N'.
  4731
  4732         16  EC-NEW-CERT               PIC X(11).
  4733         16  EC-NEW-STATE              PIC XX.
  4734         16  FILLER                    PIC X.
  4735*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4736         16  OVER-SHORT-EDIT-FIELDS.
  4737             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4738             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4739             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4740             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4741             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4742             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4743             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4744             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4745             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4746         16  FILLER                    PIC X(71).
  4747******************************************************************
  4748
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  87
* EL050.cbl
  4750*    COPY ELCDIFRD.
  4751******************************************************************
  4752*                                                                *
  4753*                                                                *
  4754*                            ELCDIFRD.                           *
  4755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4756*                            VMOD=2.004                          *
  4757*                                                                *
  4758*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4759*                                                                *
  4760******************************************************************
  4761*
  4762  01  WS-DIFFERENCE-CALCULATION.
  4763        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4764        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4765        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4766        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4767        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4768        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4769        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4770        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4771        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4772        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4773        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4774
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  88
* EL050.cbl
  4776****************************************************************
  4777*
  4778* Copyright (c) 2007 by Clerity Solutions, Inc.
  4779* All rights reserved.
  4780*
  4781****************************************************************
  4782 01  DFHEIV.
  4783   02  DFHEIV0               PIC X(35).
  4784   02  DFHEIV1               PIC X(08).
  4785   02  DFHEIV2               PIC X(08).
  4786   02  DFHEIV3               PIC X(08).
  4787   02  DFHEIV4               PIC X(06).
  4788   02  DFHEIV5               PIC X(04).
  4789   02  DFHEIV6               PIC X(04).
  4790   02  DFHEIV7               PIC X(02).
  4791   02  DFHEIV8               PIC X(02).
  4792   02  DFHEIV9               PIC X(01).
  4793   02  DFHEIV10              PIC S9(7) COMP-3.
  4794   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4795   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4796   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4797   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4798   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4799   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4800   02  DFHEIV17              PIC X(04).
  4801   02  DFHEIV18              PIC X(04).
  4802   02  DFHEIV19              PIC X(04).
  4803   02  DFHEIV20              USAGE IS POINTER.
  4804   02  DFHEIV21              USAGE IS POINTER.
  4805   02  DFHEIV22              USAGE IS POINTER.
  4806   02  DFHEIV23              USAGE IS POINTER.
  4807   02  DFHEIV24              USAGE IS POINTER.
  4808   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4809   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4810   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4811   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4812   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4813   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4814   02  FILLER                PIC X(02).
  4815   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4816   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4817   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4818   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4819   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4820 LINKAGE  SECTION.
  4821*****************************************************************
  4822*                                                               *
  4823* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4824* All rights reserved.                                          *
  4825*                                                               *
  4826*****************************************************************
  4827 01  dfheiblk.
  4828     02  eibtime          pic s9(7) comp-3.
  4829     02  eibdate          pic s9(7) comp-3.
  4830     02  eibtrnid         pic x(4).
  4831     02  eibtaskn         pic s9(7) comp-3.
  4832     02  eibtrmid         pic x(4).
  4833     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  89
* EL050.cbl
  4834     02  eibcposn         pic s9(4) comp.
  4835     02  eibcalen         pic s9(4) comp.
  4836     02  eibaid           pic x(1).
  4837     02  eibfiller1       pic x(1).
  4838     02  eibfn            pic x(2).
  4839     02  eibfiller2       pic x(2).
  4840     02  eibrcode         pic x(6).
  4841     02  eibfiller3       pic x(2).
  4842     02  eibds            pic x(8).
  4843     02  eibreqid         pic x(8).
  4844     02  eibrsrce         pic x(8).
  4845     02  eibsync          pic x(1).
  4846     02  eibfree          pic x(1).
  4847     02  eibrecv          pic x(1).
  4848     02  eibsend          pic x(1).
  4849     02  eibatt           pic x(1).
  4850     02  eibeoc           pic x(1).
  4851     02  eibfmh           pic x(1).
  4852     02  eibcompl         pic x(1).
  4853     02  eibsig           pic x(1).
  4854     02  eibconf          pic x(1).
  4855     02  eiberr           pic x(1).
  4856     02  eibrldbk         pic x(1).
  4857     02  eiberrcd         pic x(4).
  4858     02  eibsynrb         pic x(1).
  4859     02  eibnodat         pic x(1).
  4860     02  eibfiller5       pic x(2).
  4861     02  eibresp          pic 9(09) comp.
  4862     02  eibresp2         pic 9(09) comp.
  4863     02  dfheigdj         pic s9(4) comp.
  4864     02  dfheigdk         pic s9(4) comp.
  4865
  4866 01  DFHCOMMAREA                   PIC X(1036).
  4867
  4868*01 PARMLIST .
  4869*    02  FILLER                    PIC S9(8)   COMP.
  4870*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4871*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4872*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4873*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4874*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4875*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4876*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4877
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  90
* EL050.cbl
  4879*    COPY ELCCNTL.
  4880******************************************************************
  4881*                                                                *
  4882*                                                                *
  4883*                            ELCCNTL.                            *
  4884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4885*                            VMOD=2.059                          *
  4886*                                                                *
  4887*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4888*                                                                *
  4889*   FILE TYPE = VSAM,KSDS                                        *
  4890*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4891*                                                                *
  4892*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4893*       ALTERNATE INDEX = NONE                                   *
  4894*                                                                *
  4895*   LOG = YES                                                    *
  4896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4897******************************************************************
  4898*                   C H A N G E   L O G
  4899*
  4900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4901*-----------------------------------------------------------------
  4902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4903* EFFECTIVE    NUMBER
  4904*-----------------------------------------------------------------
  4905* 082503                   PEMA  ADD BENEFIT GROUP
  4906* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4907* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4908* 092705    2005050300006  PEMA  ADD SPP LEASES
  4909* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4910* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4911* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4912* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4913* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4914* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4915******************************************************************
  4916*
  4917 01  CONTROL-FILE.
  4918     12  CF-RECORD-ID                       PIC XX.
  4919         88  VALID-CF-ID                        VALUE 'CF'.
  4920
  4921     12  CF-CONTROL-PRIMARY.
  4922         16  CF-COMPANY-ID                  PIC XXX.
  4923         16  CF-RECORD-TYPE                 PIC X.
  4924             88  CF-COMPANY-MASTER              VALUE '1'.
  4925             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4926             88  CF-STATE-MASTER                VALUE '3'.
  4927             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4928             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4929             88  CF-CARRIER-MASTER              VALUE '6'.
  4930             88  CF-MORTALITY-MASTER            VALUE '7'.
  4931             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4932             88  CF-TERMINAL-MASTER             VALUE '9'.
  4933             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4934             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4935             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4936             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  91
* EL050.cbl
  4937             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4938             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4939             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4940             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4941             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4942         16  CF-ACCESS-CD-GENL              PIC X(4).
  4943         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4944             20  CF-PROCESSOR               PIC X(4).
  4945         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4946             20  CF-STATE-CODE              PIC XX.
  4947             20  FILLER                     PIC XX.
  4948         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4949             20  FILLER                     PIC XX.
  4950             20  CF-HI-BEN-IN-REC           PIC XX.
  4951         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4952             20  FILLER                     PIC XXX.
  4953             20  CF-CARRIER-CNTL            PIC X.
  4954         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4955             20  FILLER                     PIC XX.
  4956             20  CF-HI-TYPE-IN-REC          PIC 99.
  4957         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4958             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4959                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4960             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4961             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4962         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4963             20  FILLER                     PIC X.
  4964             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4965         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4966             20  FILLER                     PIC XX.
  4967             20  CF-MORTGAGE-PLAN           PIC XX.
  4968         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4969
  4970     12  CF-LAST-MAINT-DT                   PIC XX.
  4971     12  CF-LAST-MAINT-BY                   PIC X(4).
  4972     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4973
  4974     12  CF-RECORD-BODY                     PIC X(728).
  4975
  4976
  4977****************************************************************
  4978*             COMPANY MASTER RECORD                            *
  4979****************************************************************
  4980
  4981     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4982         16  CF-COMPANY-ADDRESS.
  4983             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4984             20  CF-CL-IN-CARE-OF           PIC X(30).
  4985             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4986             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4987             20  CF-CL-CITY-STATE           PIC X(30).
  4988             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4989             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4990         16  CF-COMPANY-CD                  PIC X.
  4991         16  CF-COMPANY-PASSWORD            PIC X(8).
  4992         16  CF-SECURITY-OPTION             PIC X.
  4993             88  ALL-SECURITY                   VALUE '1'.
  4994             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  92
* EL050.cbl
  4995             88  PROCESSOR-VERIFY               VALUE '3'.
  4996             88  NO-SECURITY                    VALUE '4'.
  4997             88  ALL-BUT-TERM                   VALUE '5'.
  4998         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4999             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5000         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5001             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5002         16  CF-INFORCE-LOCATION            PIC X.
  5003             88  CERTS-ARE-ONLINE               VALUE '1'.
  5004             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5005             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5006         16  CF-LOWER-CASE-LETTERS          PIC X.
  5007         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5008             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5009             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5010             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5011             88  CF-ACCNT-CNTL                  VALUE '3'.
  5012             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5013
  5014         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5015         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5016
  5017         16  CF-LGX-CREDIT-USER             PIC X.
  5018             88  CO-IS-NOT-USER                 VALUE 'N'.
  5019             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5020
  5021         16 CF-CREDIT-CALC-CODES.
  5022             20  CF-CR-REM-TERM-CALC PIC X.
  5023               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5024               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5025               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5026               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5027               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5028               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5029               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5030             20  CF-CR-R78-METHOD           PIC X.
  5031               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5032               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5033
  5034         16  CF-CLAIM-CONTROL-COUNTS.
  5035             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5036                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5037
  5038             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5039                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5040
  5041             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5042                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5043
  5044             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5045                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5046
  5047         16  CF-CURRENT-MONTH-END           PIC XX.
  5048
  5049         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5050             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5051             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5052             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  93
* EL050.cbl
  5053             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5054                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5055                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5056             20  CF-CO-PREM-REJECT-SW       PIC X.
  5057                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5058                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5059             20  CF-CO-REF-REJECT-SW        PIC X.
  5060                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5061                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5062
  5063         16  CF-CO-REPORTING-DT             PIC XX.
  5064         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5065         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5066           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5067           88  CF-CO-MONTH-END                  VALUE '1'.
  5068
  5069         16  CF-LGX-CLAIM-USER              PIC X.
  5070             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5071             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5072
  5073         16  CF-CREDIT-EDIT-CONTROLS.
  5074             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5075             20  CF-MIN-AGE                 PIC 99.
  5076             20  CF-DEFAULT-AGE             PIC 99.
  5077             20  CF-MIN-TERM                PIC S999      COMP-3.
  5078             20  CF-MAX-TERM                PIC S999      COMP-3.
  5079             20  CF-DEFAULT-SEX             PIC X.
  5080             20  CF-JOINT-AGE-INPUT         PIC X.
  5081                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5082             20  CF-BIRTH-DATE-INPUT        PIC X.
  5083                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5084             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5085                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5086                 88  CF-ZERO-CARRIER            VALUE '1'.
  5087                 88  CF-ZERO-GROUPING           VALUE '2'.
  5088                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5089             20  CF-EDIT-SW                 PIC X.
  5090                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5091             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5092             20  CF-CR-PR-METHOD            PIC X.
  5093               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5094               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5095             20  FILLER                     PIC X.
  5096
  5097         16  CF-CREDIT-MISC-CONTROLS.
  5098             20  CF-REIN-TABLE-SW           PIC X.
  5099                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5100             20  CF-COMP-TABLE-SW           PIC X.
  5101                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5102             20  CF-EXPERIENCE-RETENTION-AGE
  5103                                            PIC S9        COMP-3.
  5104             20  CF-CONVERSION-DT           PIC XX.
  5105             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5106             20  CF-RUN-FREQUENCY-SW        PIC X.
  5107                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5108                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5109
  5110             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  94
* EL050.cbl
  5111                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5112                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5113                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5114                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5115                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5116                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5117
  5118                 24  CF-CR-CHECK-COUNT       REDEFINES
  5119                     CF-CR-CHECK-COUNTER      PIC X(4).
  5120
  5121                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5122                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5123
  5124                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5125                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5126                 24  CF-MAIL-PROCESSING       PIC X.
  5127                     88  MAIL-PROCESSING          VALUE 'Y'.
  5128
  5129         16  CF-MISC-SYSTEM-CONTROL.
  5130             20  CF-SYSTEM-C                 PIC X.
  5131                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5132             20  CF-SYSTEM-D                 PIC X.
  5133                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5134             20  CF-SOC-SEC-NO-SW            PIC X.
  5135                 88  SOC-SEC-NO-USED             VALUE '1'.
  5136             20  CF-MEMBER-NO-SW             PIC X.
  5137                 88  MEMBER-NO-USED              VALUE '1'.
  5138             20  CF-TAX-ID-NUMBER            PIC X(11).
  5139             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5140             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5141                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5142                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5143                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5144                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5145             20  CF-SYSTEM-E                 PIC X.
  5146                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5147
  5148         16  CF-LGX-LIFE-USER               PIC X.
  5149             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5150             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5151
  5152         16  CF-CR-MONTH-END-DT             PIC XX.
  5153
  5154         16  CF-FILE-MAINT-DATES.
  5155             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5156                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5157             20  CF-LAST-BATCH       REDEFINES
  5158                 CF-LAST-BATCH-NO               PIC X(4).
  5159             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5160             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5161             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5162             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5163             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5164             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5165             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5166             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5167             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5168             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  95
* EL050.cbl
  5169
  5170         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5171         16  FILLER                         PIC X.
  5172
  5173         16  CF-ALT-MORT-CODE               PIC X(4).
  5174         16  CF-MEMBER-CAPTION              PIC X(10).
  5175
  5176         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5177             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5178             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5179             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5180             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5181             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5182
  5183         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5184
  5185         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5186         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5187         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5188         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5189
  5190         16  CF-AH-OVERRIDE-L1              PIC X.
  5191         16  CF-AH-OVERRIDE-L2              PIC XX.
  5192         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5193         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5194
  5195         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5196         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5197
  5198         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5199         16  CF-AR-LAST-EL860-DT            PIC XX.
  5200         16  CF-MP-MONTH-END-DT             PIC XX.
  5201
  5202         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5203         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5204             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5205
  5206         16  CF-AR-MONTH-END-DT             PIC XX.
  5207
  5208         16  CF-CRDTCRD-USER                PIC X.
  5209             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5210             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5211
  5212         16  CF-CC-MONTH-END-DT             PIC XX.
  5213
  5214         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5215
  5216         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5217             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5218             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5219             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5220         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5221         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5222         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5223         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5224             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5225             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5226         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  96
* EL050.cbl
  5227         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5228         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5229             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5230         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5231
  5232         16  CF-CL-ZIP-CODE.
  5233             20  CF-CL-ZIP-PRIME.
  5234                 24  CF-CL-ZIP-1ST          PIC X.
  5235                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5236                 24  FILLER                 PIC X(4).
  5237             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5238         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5239             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5240             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5241             20  FILLER                     PIC XXX.
  5242
  5243         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5244         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5245         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5246         16  CF-CO-OPTION-START-DATE        PIC XX.
  5247         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5248           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5249                                                      '3' '4'.
  5250           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5251           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5252           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5253           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5254           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5255           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5256
  5257         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5258
  5259         16  CF-PAYMENT-APPROVAL-LEVELS.
  5260             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5261             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5262             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5263             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5264             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5265             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5266
  5267         16  CF-END-USER-REPORTING-USER     PIC X.
  5268             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5269             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5270
  5271         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5272             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5273             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5274
  5275         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5276
  5277         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5278         16  FILLER                         PIC X.
  5279
  5280         16  CF-CREDIT-ARCHIVE-CNTL.
  5281             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5282             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5283             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5284
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  97
* EL050.cbl
  5285         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5286
  5287         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5288             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5289             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5290
  5291         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5292             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5293             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5294
  5295         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5296
  5297         16  CF-CO-ACH-ID-CODE              PIC  X.
  5298             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5299             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5300             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5301         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5302         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5303         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5304         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5305         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5306         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5307         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5308         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5309         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5310                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5311         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5312                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5313
  5314         16  CF-CO-OVER-SHORT.
  5315             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5316             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5317
  5318*         16  FILLER                         PIC X(102).
  5319         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5320             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5321             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5322
  5323         16  CF-AH-APPROVAL-DAYS.
  5324             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5325             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5326             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5327             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5328
  5329         16  FILLER                         PIC X(82).
  5330****************************************************************
  5331*             PROCESSOR/USER RECORD                            *
  5332****************************************************************
  5333
  5334     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5335         16  CF-PROCESSOR-NAME              PIC X(30).
  5336         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5337         16  CF-PROCESSOR-TITLE             PIC X(26).
  5338         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5339                 88  MESSAGE-YES                VALUE 'Y'.
  5340                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5341
  5342*****************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  98
* EL050.cbl
  5343****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5344****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5345****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5346****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5347*****************************************************
  5348
  5349         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5350             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5351             20  CF-APPLICATION-FORCE       PIC X.
  5352             20  CF-INDIVIDUAL-APP.
  5353                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5354                     28  CF-BROWSE-APP      PIC X.
  5355                     28  CF-UPDATE-APP      PIC X.
  5356
  5357         16  CF-CURRENT-TERM-ON             PIC X(4).
  5358         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5359             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5360             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5361             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5362             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5363             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5364             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5365             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5366         16  CF-PROCESSOR-CARRIER           PIC X.
  5367             88  NO-CARRIER-SECURITY            VALUE ' '.
  5368         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5369             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5370         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5371             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5372         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5373             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5374
  5375         16  CF-PROC-SYS-ACCESS-SW.
  5376             20  CF-PROC-CREDIT-CLAIMS-SW.
  5377                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5378                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5379                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5380                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5381             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5382                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5383                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5384             20  CF-PROC-LIFE-GNRLDGR-SW.
  5385                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5386                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5387                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5388                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5389             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5390                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5391                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5392         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5393             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5394             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5395         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5396
  5397         16  CF-APPROVAL-LEVEL                  PIC X.
  5398             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5399             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5400             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page  99
* EL050.cbl
  5401             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5402
  5403         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5404
  5405         16  CF-LANGUAGE-TYPE                   PIC X.
  5406             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5407             88  CF-LANG-IS-FR                      VALUE 'F'.
  5408
  5409         16  CF-CSR-IND                         PIC X.
  5410         16  FILLER                             PIC X(239).
  5411
  5412****************************************************************
  5413*             PROCESSOR/REMINDERS RECORD                       *
  5414****************************************************************
  5415
  5416     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5417         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5418             20  CF-START-REMIND-DT         PIC XX.
  5419             20  CF-END-REMIND-DT           PIC XX.
  5420             20  CF-REMINDER-TEXT           PIC X(50).
  5421         16  FILLER                         PIC X(296).
  5422
  5423
  5424****************************************************************
  5425*             STATE MASTER RECORD                              *
  5426****************************************************************
  5427
  5428     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5429         16  CF-STATE-ABBREVIATION          PIC XX.
  5430         16  CF-STATE-NAME                  PIC X(25).
  5431         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5432         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5433             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5434             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5435             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5436             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5437                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5438                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5439             20  CF-ST-PREM-REJECT-SW       PIC X.
  5440                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5441                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5442             20  CF-ST-REF-REJECT-SW        PIC X.
  5443                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5444                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5445         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5446         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5447         16  CF-ST-REFUND-RULES.
  5448             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5449             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5450             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5451         16  CF-ST-FST-PMT-EXTENSION.
  5452             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5453             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5454                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5455                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5456                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5457                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5458         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 100
* EL050.cbl
  5459             20  CF-ST-CALL-UNEARNED        PIC X.
  5460             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5461             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5462         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5463             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5464             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5465         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5466         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5467         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5468         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5469         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5470         16  FILLER                         PIC X.
  5471         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5472             20  CF-ST-BENEFIT-CD           PIC XX.
  5473             20  CF-ST-BENEFIT-KIND         PIC X.
  5474                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5475                 88  CF-ST-AH-KIND              VALUE 'A'.
  5476             20  CF-ST-REM-TERM-CALC        PIC X.
  5477                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5478                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5479                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5480                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5481                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5482                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5483                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5484                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5485
  5486             20  CF-ST-REFUND-CALC          PIC X.
  5487                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5488                 88  ST-REFD-BY-R78             VALUE '1'.
  5489                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5490                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5491                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5492                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5493                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5494                 88  ST-REFD-UTAH               VALUE '7'.
  5495                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5496                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5497                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5498
  5499             20  CF-ST-EARNING-CALC         PIC X.
  5500                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5501                 88  ST-EARN-BY-R78             VALUE '1'.
  5502                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5503                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5504                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5505                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5506                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5507                 88  ST-EARN-MEAN               VALUE '8'.
  5508                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5509
  5510             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5511                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5512                 88  ST-OVRD-BY-R78             VALUE '1'.
  5513                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5514                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5515                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5516                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 101
* EL050.cbl
  5517                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5518                 88  ST-OVRD-MEAN               VALUE '8'.
  5519                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5520             20  FILLER                     PIC X.
  5521
  5522         16  CF-ST-COMMISSION-CAPS.
  5523             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5524             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5525             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5526             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5527         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5528                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5529
  5530         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5531
  5532         16  CF-ST-STATUTORY-INTEREST.
  5533             20  CF-ST-STAT-DATE-FROM       PIC X.
  5534                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5535                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5536             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5537             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5538             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5539             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5540             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5541
  5542         16  CF-ST-OVER-SHORT.
  5543             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5544             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5545
  5546         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5547
  5548         16  CF-ST-RT-CALC                  PIC X.
  5549
  5550         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5551         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5552         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5553         16  CF-ST-RF-LR-CALC               PIC X.
  5554         16  CF-ST-RF-LL-CALC               PIC X.
  5555         16  CF-ST-RF-LN-CALC               PIC X.
  5556         16  CF-ST-RF-AH-CALC               PIC X.
  5557         16  CF-ST-RF-CP-CALC               PIC X.
  5558*        16  FILLER                         PIC X(206).
  5559*CIDMOD         16  FILLER                         PIC X(192).
  5560         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5561             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5562         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5563         16  CF-ST-VFY-2ND-BENE             PIC X.
  5564         16  FILLER                         PIC X(186).
  5565
  5566****************************************************************
  5567*             BENEFIT MASTER RECORD                            *
  5568****************************************************************
  5569
  5570     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5571         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5572             20  CF-BENEFIT-CODE            PIC XX.
  5573             20  CF-BENEFIT-NUMERIC  REDEFINES
  5574                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 102
* EL050.cbl
  5575             20  CF-BENEFIT-ALPHA           PIC XXX.
  5576             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5577             20  CF-BENEFIT-COMMENT         PIC X(10).
  5578
  5579             20  CF-LF-COVERAGE-TYPE        PIC X.
  5580                 88  CF-REDUCING                VALUE 'R'.
  5581                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5582
  5583             20  CF-SPECIAL-CALC-CD         PIC X.
  5584                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5585                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5586                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5587                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5588                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5589                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5590                 88  CF-FARM-PLAN               VALUE 'F'.
  5591                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5592                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5593                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5594                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5595                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5596                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5597                 88  CF-PRUDENTIAL              VALUE 'P'.
  5598                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5599                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5600                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5601                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5602                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5603                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5604
  5605             20  CF-JOINT-INDICATOR         PIC X.
  5606                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5607
  5608*            20  FILLER                     PIC X(12).
  5609             20  FILLER                     PIC X(11).
  5610             20  CF-BENEFIT-CATEGORY        PIC X.
  5611             20  CF-LOAN-TYPE               PIC X(8).
  5612
  5613             20  CF-CO-REM-TERM-CALC        PIC X.
  5614                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5615                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5616                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5617                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5618                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5619
  5620             20  CF-CO-EARNINGS-CALC        PIC X.
  5621                 88  CO-EARN-BY-R78             VALUE '1'.
  5622                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5623                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5624                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5625                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5626                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5627                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5628                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5629
  5630             20  CF-CO-REFUND-CALC          PIC X.
  5631                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5632                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 103
* EL050.cbl
  5633                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5634                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5635                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5636                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5637                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5638                 88  CO-REFD-MEAN               VALUE '8'.
  5639                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5640                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5641                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5642
  5643             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5644                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5645                 88  CO-OVRD-BY-R78             VALUE '1'.
  5646                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5647                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5648                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5649                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5650                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5651                 88  CO-OVRD-MEAN               VALUE '8'.
  5652                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5653
  5654             20  CF-CO-BEN-I-G-CD           PIC X.
  5655                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5656                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5657                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5658
  5659         16  FILLER                         PIC X(304).
  5660
  5661
  5662****************************************************************
  5663*             CARRIER MASTER RECORD                            *
  5664****************************************************************
  5665
  5666     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5667         16  CF-ADDRESS-DATA.
  5668             20  CF-MAIL-TO-NAME            PIC X(30).
  5669             20  CF-IN-CARE-OF              PIC X(30).
  5670             20  CF-ADDRESS-LINE-1          PIC X(30).
  5671             20  CF-ADDRESS-LINE-2          PIC X(30).
  5672             20  CF-CITY-STATE              PIC X(30).
  5673             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5674             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5675
  5676         16  CF-CLAIM-NO-CONTROL.
  5677             20  CF-CLAIM-NO-METHOD         PIC X.
  5678                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5679                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5680                 88  CLAIM-NO-SEQ               VALUE '3'.
  5681                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5682             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5683                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5684                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5685                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5686
  5687         16  CF-CHECK-NO-CONTROL.
  5688             20  CF-CHECK-NO-METHOD         PIC X.
  5689                 88  CHECK-NO-MANUAL            VALUE '1'.
  5690                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 104
* EL050.cbl
  5691                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5692                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5693             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5694                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5695
  5696         16  CF-DOMICILE-STATE              PIC XX.
  5697
  5698         16  CF-EXPENSE-CONTROLS.
  5699             20  CF-EXPENSE-METHOD          PIC X.
  5700                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5701                 88  DOLLARS-PER-PMT            VALUE '2'.
  5702                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5703                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5704             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5705             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5706
  5707         16  CF-CORRESPONDENCE-CONTROL.
  5708             20  CF-LETTER-RESEND-OPT       PIC X.
  5709                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5710                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5711             20  FILLER                     PIC X(4).
  5712
  5713         16  CF-RESERVE-CONTROLS.
  5714             20  CF-MANUAL-SW               PIC X.
  5715                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5716             20  CF-FUTURE-SW               PIC X.
  5717                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5718             20  CF-PTC-SW                  PIC X.
  5719                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5720             20  CF-IBNR-SW                 PIC X.
  5721                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5722             20  CF-PTC-LF-SW               PIC X.
  5723                 88  CF-LF-PTC-USED             VALUE '1'.
  5724             20  CF-CDT-ACCESS-METHOD       PIC X.
  5725                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5726                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5727                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5728             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5729
  5730         16  CF-CLAIM-CALC-METHOD           PIC X.
  5731             88  360-PLUS-MONTHS                VALUE '1'.
  5732             88  365-PLUS-MONTHS                VALUE '2'.
  5733             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5734             88  360-DAILY                      VALUE '4'.
  5735             88  365-DAILY                      VALUE '5'.
  5736
  5737         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5738         16  FILLER                         PIC X(11).
  5739
  5740         16  CF-LIMIT-AMOUNTS.
  5741             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5742             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5743             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5744             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5745             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5746             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5747             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5748             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 105
* EL050.cbl
  5749             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5750             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5751
  5752         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5753         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5754         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5755
  5756         16  CF-ZIP-CODE.
  5757             20  CF-ZIP-PRIME.
  5758                 24  CF-ZIP-1ST             PIC X.
  5759                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5760                 24  FILLER                 PIC X(4).
  5761             20  CF-ZIP-PLUS4               PIC X(4).
  5762         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5763             20  CF-CAN-POSTAL-1            PIC XXX.
  5764             20  CF-CAN-POSTAL-2            PIC XXX.
  5765             20  FILLER                     PIC XXX.
  5766
  5767         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5768         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5769         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5770
  5771         16  CF-RATING-SWITCH               PIC X.
  5772             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5773             88  CF-NO-RATING                   VALUE 'N'.
  5774
  5775         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5776
  5777         16  CF-CARRIER-OVER-SHORT.
  5778             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5779             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5780
  5781         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5782         16  CF-SECPAY-SWITCH               PIC X.
  5783             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5784             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5785         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5786         16  FILLER                         PIC X(448).
  5787*        16  FILLER                         PIC X(452).
  5788
  5789
  5790****************************************************************
  5791*             MORTALITY MASTER RECORD                          *
  5792****************************************************************
  5793
  5794     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5795         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5796                                INDEXED BY CF-MORT-NDX.
  5797             20  CF-MORT-TABLE              PIC X(5).
  5798             20  CF-MORT-TABLE-TYPE         PIC X.
  5799                 88  CF-MORT-JOINT              VALUE 'J'.
  5800                 88  CF-MORT-SINGLE             VALUE 'S'.
  5801                 88  CF-MORT-COMBINED           VALUE 'C'.
  5802                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5803                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5804             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5805             20  CF-MORT-AGE-METHOD         PIC XX.
  5806                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 106
* EL050.cbl
  5807                 88  CF-AGE-NEAR                VALUE 'AN'.
  5808             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5809             20  CF-MORT-ADJUSTMENT-DIRECTION
  5810                                            PIC X.
  5811                 88  CF-MINUS                   VALUE '-'.
  5812                 88  CF-PLUS                    VALUE '+'.
  5813             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5814             20  CF-MORT-JOINT-CODE         PIC X.
  5815                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5816             20  CF-MORT-PC-Q               PIC X.
  5817                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5818             20  CF-MORT-TABLE-CODE         PIC X(4).
  5819             20  CF-MORT-COMMENTS           PIC X(15).
  5820             20  FILLER                     PIC X(14).
  5821
  5822         16  FILLER                         PIC X(251).
  5823
  5824
  5825****************************************************************
  5826*             BUSSINESS TYPE MASTER RECORD                     *
  5827****************************************************************
  5828
  5829     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5830* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5831* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5832* AND RECORD 05 IS TYPES 81-99
  5833         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5834             20  CF-BUSINESS-TITLE          PIC  X(19).
  5835             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5836                                            PIC S9V9(4) COMP-3.
  5837             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5838             20  FILLER                     PIC  X.
  5839         16  FILLER                         PIC  X(248).
  5840
  5841
  5842****************************************************************
  5843*             TERMINAL MASTER RECORD                           *
  5844****************************************************************
  5845
  5846     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5847
  5848         16  CF-COMPANY-TERMINALS.
  5849             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5850                                  PIC X(4).
  5851         16  FILLER               PIC X(248).
  5852
  5853
  5854****************************************************************
  5855*             LIFE EDIT MASTER RECORD                          *
  5856****************************************************************
  5857
  5858     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5859         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5860             20  CF-LIFE-CODE-IN            PIC XX.
  5861             20  CF-LIFE-CODE-OUT           PIC XX.
  5862         16  FILLER                         PIC X(248).
  5863
  5864
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 107
* EL050.cbl
  5865****************************************************************
  5866*             AH EDIT MASTER RECORD                            *
  5867****************************************************************
  5868
  5869     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5870         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5871             20  CF-AH-CODE-IN              PIC XXX.
  5872             20  CF-AH-CODE-OUT             PIC XX.
  5873         16  FILLER                         PIC X(248).
  5874
  5875
  5876****************************************************************
  5877*             CREDIBILITY TABLES                               *
  5878****************************************************************
  5879
  5880     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5881         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5882                             INDEXED BY CF-CRDB-NDX.
  5883             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5884             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5885             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5886         16  FILLER                         PIC  X(332).
  5887
  5888
  5889****************************************************************
  5890*             REPORT CUSTOMIZATION RECORD                      *
  5891****************************************************************
  5892
  5893     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5894         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5895             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5896             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5897             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5898**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5899****       A T-TRANSFER.                                   ****
  5900             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5901
  5902         16  FILLER                         PIC XX.
  5903
  5904         16  CF-CARRIER-CNTL-OPT.
  5905             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5906                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5907                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5908             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5909                                            PIC X.
  5910         16  CF-GROUP-CNTL-OPT.
  5911             20  CF-GROUP-OPT-SEQ           PIC 9.
  5912                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5913                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5914             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5915                                            PIC X(6).
  5916         16  CF-STATE-CNTL-OPT.
  5917             20  CF-STATE-OPT-SEQ           PIC 9.
  5918                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5919                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5920             20  CF-STATE-SELECT OCCURS 3 TIMES
  5921                                            PIC XX.
  5922         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 108
* EL050.cbl
  5923             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5924                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5925                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5926             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5927                                            PIC X(10).
  5928         16  CF-BUS-TYP-CNTL-OPT.
  5929             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5930                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5931                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5932             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5933                                            PIC XX.
  5934         16  CF-LF-TYP-CNTL-OPT.
  5935             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5936                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5937                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5938             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5939                                            PIC XX.
  5940         16  CF-AH-TYP-CNTL-OPT.
  5941             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5942                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5943                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5944             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5945                                            PIC XX.
  5946         16  CF-REPTCD1-CNTL-OPT.
  5947             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5948                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5949                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5950             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5951                                            PIC X(10).
  5952         16  CF-REPTCD2-CNTL-OPT.
  5953             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5954                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5955                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5956             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5957                                            PIC X(10).
  5958         16  CF-USER1-CNTL-OPT.
  5959             20  CF-USER1-OPT-SEQ           PIC 9.
  5960                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5961                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5962             20  CF-USER1-SELECT OCCURS 3 TIMES
  5963                                            PIC X(10).
  5964         16  CF-USER2-CNTL-OPT.
  5965             20  CF-USER2-OPT-SEQ           PIC 9.
  5966                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5967                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5968             20  CF-USER2-SELECT OCCURS 3 TIMES
  5969                                            PIC X(10).
  5970         16  CF-USER3-CNTL-OPT.
  5971             20  CF-USER3-OPT-SEQ           PIC 9.
  5972                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5973                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5974             20  CF-USER3-SELECT OCCURS 3 TIMES
  5975                                            PIC X(10).
  5976         16  CF-USER4-CNTL-OPT.
  5977             20  CF-USER4-OPT-SEQ           PIC 9.
  5978                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5979                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5980             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 109
* EL050.cbl
  5981                                            PIC X(10).
  5982         16  CF-USER5-CNTL-OPT.
  5983             20  CF-USER5-OPT-SEQ           PIC 9.
  5984                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5985                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5986             20  CF-USER5-SELECT OCCURS 3 TIMES
  5987                                            PIC X(10).
  5988         16  CF-REINS-CNTL-OPT.
  5989             20  CF-REINS-OPT-SEQ           PIC 9.
  5990                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5991                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5992             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5993                 24  CF-REINS-PRIME         PIC XXX.
  5994                 24  CF-REINS-SUB           PIC XXX.
  5995
  5996         16  CF-AGENT-CNTL-OPT.
  5997             20  CF-AGENT-OPT-SEQ           PIC 9.
  5998                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5999                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6000             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6001                                            PIC X(10).
  6002
  6003         16  FILLER                         PIC X(43).
  6004
  6005         16  CF-LOSS-RATIO-SELECT.
  6006             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6007             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6008         16  CF-ENTRY-DATE-SELECT.
  6009             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6010             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6011         16  CF-EFFECTIVE-DATE-SELECT.
  6012             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6013             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6014
  6015         16  CF-EXCEPTION-LIST-IND          PIC X.
  6016             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6017
  6018         16  FILLER                         PIC X(318).
  6019
  6020****************************************************************
  6021*                  EXCEPTION REPORTING RECORD                  *
  6022****************************************************************
  6023
  6024     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6025         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6026             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6027
  6028         16  CF-COMBINED-LIFE-AH-OPT.
  6029             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6030             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6031             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6032             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6033
  6034         16  CF-LIFE-OPT.
  6035             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6036             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6037             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6038             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 110
* EL050.cbl
  6039             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6040             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6041             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6042             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6043             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6044             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6045
  6046         16  CF-AH-OPT.
  6047             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6048             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6049             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6050             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6051             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6052             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6053             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6054             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6055             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6056             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6057
  6058         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6059             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6060             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6061             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6062
  6063         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6064
  6065         16  FILLER                         PIC X(673).
  6066
  6067
  6068****************************************************************
  6069*             MORTGAGE SYSTEM PLAN RECORD                      *
  6070****************************************************************
  6071
  6072     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6073         16  CF-PLAN-TYPE                   PIC X.
  6074             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6075             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6076             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6077         16  CF-PLAN-ABBREV                 PIC XXX.
  6078         16  CF-PLAN-DESCRIPT               PIC X(10).
  6079         16  CF-PLAN-NOTES                  PIC X(20).
  6080         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6081         16  CF-PLAN-UNDERWRITING.
  6082             20  CF-PLAN-TERM-DATA.
  6083                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6084                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6085             20  CF-PLAN-AGE-DATA.
  6086                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6087                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6088                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6089             20  CF-PLAN-BENEFIT-DATA.
  6090                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6091                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6092                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6093                                            PIC S9(7)V99  COMP-3.
  6094         16  CF-PLAN-POLICY-FORMS.
  6095             20  CF-POLICY-FORM             PIC X(12).
  6096             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 111
* EL050.cbl
  6097             20  CF-MASTER-POLICY           PIC X(12).
  6098         16  CF-PLAN-RATING.
  6099             20  CF-RATE-CODE               PIC X(5).
  6100             20  CF-SEX-RATING              PIC X.
  6101                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6102                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6103             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6104             20  CF-SUB-STD-TYPE            PIC X.
  6105                 88  CF-PCT-OF-PREM            VALUE '1'.
  6106                 88  CF-PCT-OF-BENE            VALUE '2'.
  6107         16  CF-PLAN-PREM-TOLERANCES.
  6108             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6109             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6110         16  CF-PLAN-PYMT-TOLERANCES.
  6111             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6112             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6113         16  CF-PLAN-MISC-DATA.
  6114             20  FILLER                     PIC X.
  6115             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6116             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6117         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6118         16  CF-PLAN-IND-GRP                PIC X.
  6119             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6120                                                     '1'.
  6121             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6122                                                     '2'.
  6123         16  CF-MIB-SEARCH-SW               PIC X.
  6124             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6125             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6126             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6127             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6128         16  CF-ALPHA-SEARCH-SW             PIC X.
  6129             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6130             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6131             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6132             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6133             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6134             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6135             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6136             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6137             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6138             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6139                                                     'A' 'B' 'C'
  6140                                                     'X' 'Y' 'Z'.
  6141         16  CF-EFF-DT-RULE-SW              PIC X.
  6142             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6143             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6144             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6145             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6146             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6147         16  FILLER                         PIC X(4).
  6148         16  CF-HEALTH-QUESTIONS            PIC X.
  6149             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6150         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6151         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6152         16  CF-PLAN-SNGL-JNT               PIC X.
  6153             88  CF-COMBINED-PLAN              VALUE 'C'.
  6154             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 112
* EL050.cbl
  6155             88  CF-SNGL-PLAN                  VALUE 'S'.
  6156         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6157         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6158         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6159         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6160         16  CF-RERATE-CNTL                 PIC  X.
  6161             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6162             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6163             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6164             88  CF-AUTO-RECALC                 VALUE '4'.
  6165         16  CF-BENEFIT-TYPE                PIC  X.
  6166             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6167             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6168         16  CF-POLICY-FEE                  PIC S999V99
  6169                                                    COMP-3.
  6170         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6171         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6172         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6173         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6174         16  FILLER                         PIC  X(32).
  6175         16  CF-TERMINATION-FORM            PIC  X(04).
  6176         16  FILLER                         PIC  X(08).
  6177         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6178                                                       COMP-3.
  6179         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6180         16  CF-ISSUE-LETTER                PIC  X(4).
  6181         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6182         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6183             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6184             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6185         16  CF-MP-REFUND-CALC              PIC X.
  6186             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6187             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6188             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6189             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6190             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6191             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6192             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6193             88  CF-MP-REFD-MEAN                VALUE '8'.
  6194         16  CF-ALT-RATE-CODE               PIC  X(5).
  6195
  6196
  6197         16  FILLER                         PIC X(498).
  6198****************************************************************
  6199*             MORTGAGE COMPANY MASTER RECORD                   *
  6200****************************************************************
  6201
  6202     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6203         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6204         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6205             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6206             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6207             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6208             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6209             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6210
  6211         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6212         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 113
* EL050.cbl
  6213         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6214         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6215         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6216
  6217         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6218             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6219         16  CF-MP-RECON-USE-IND            PIC X(1).
  6220             88  CF-MP-USE-RECON             VALUE 'Y'.
  6221         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6222             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6223         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6224             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6225             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6226         16  FILLER                         PIC X(1).
  6227         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6228             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6229         16  CF-MORTG-MIB-VERSION           PIC X.
  6230             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6231             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6232             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6233         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6234             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6235                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6236             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6237                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6238             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6239                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6240             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6241                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6242             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6243                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6244             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6245                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6246         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6247         16  FILLER                         PIC X(7).
  6248         16  CF-MORTG-DESTINATION-SYMBOL.
  6249             20  CF-MORTG-MIB-COMM          PIC X(5).
  6250             20  CF-MORTG-MIB-TERM          PIC X(5).
  6251         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6252             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6253         16  FILLER                         PIC X(03).
  6254         16  CF-MP-CHECK-NO-CONTROL.
  6255             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6256                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6257                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6258                                                ' ' LOW-VALUES.
  6259                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6260                                               VALUE '3'.
  6261         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6262         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6263         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6264             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6265                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6266             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6267                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6268             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6269                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6270             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 114
* EL050.cbl
  6271                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6272             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6273                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6274             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6275                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6276         16  CF-MORTG-BILLING-AREA.
  6277             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6278                                            PIC X.
  6279         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6280         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6281         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6282         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6283             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6284             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6285         16  FILLER                         PIC X.
  6286         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6287             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6288             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6289         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6290         16  FILLER                         PIC X(8).
  6291         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6292         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6293         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6294         16  CF-ACH-COMPANY-ID.
  6295             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6296                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6297                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6298                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6299             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6300         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6301             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6302         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6303             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6304             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6305         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6306         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6307         16  FILLER                         PIC X(536).
  6308
  6309****************************************************************
  6310*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6311****************************************************************
  6312
  6313     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6314         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6315             20  CF-FEMALE-HEIGHT.
  6316                 24  CF-FEMALE-FT           PIC 99.
  6317                 24  CF-FEMALE-IN           PIC 99.
  6318             20  CF-FEMALE-MIN-WT           PIC 999.
  6319             20  CF-FEMALE-MAX-WT           PIC 999.
  6320         16  FILLER                         PIC X(428).
  6321
  6322     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6323         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6324             20  CF-MALE-HEIGHT.
  6325                 24  CF-MALE-FT             PIC 99.
  6326                 24  CF-MALE-IN             PIC 99.
  6327             20  CF-MALE-MIN-WT             PIC 999.
  6328             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 115
* EL050.cbl
  6329         16  FILLER                         PIC X(428).
  6330******************************************************************
  6331*             AUTOMATIC ACTIVITY RECORD                          *
  6332******************************************************************
  6333     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6334         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6335             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6336             20  CF-SYS-LETTER-ID           PIC X(04).
  6337             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6338             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6339             20  CF-SYS-RESET-SW            PIC X(01).
  6340             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6341             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6342
  6343         16  FILLER                         PIC X(50).
  6344
  6345         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6346             20  CF-USER-ACTIVE-SW          PIC X(01).
  6347             20  CF-USER-LETTER-ID          PIC X(04).
  6348             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6349             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6350             20  CF-USER-RESET-SW           PIC X(01).
  6351             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6352             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6353             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6354
  6355         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 116
* EL050.cbl
  6357*    COPY ERCACCT.
  6358******************************************************************
  6359*                                                                *
  6360*                                                                *
  6361*                            ERCACCT                             *
  6362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6363*                            VMOD=2.031                          *
  6364*                                                                *
  6365*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6366*                                                                *
  6367*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6368*   VSAM ACCOUNT MASTER FILES.                                   *
  6369*                                                                *
  6370*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6371*                                                                *
  6372*   FILE TYPE = VSAM,KSDS                                        *
  6373*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6374*                                                                *
  6375*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6376*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6377*                                                                *
  6378*   LOG = NO                                                     *
  6379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6380*                                                                *
  6381*                                                                *
  6382******************************************************************
  6383*                   C H A N G E   L O G
  6384*
  6385* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6386*-----------------------------------------------------------------
  6387*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6388* EFFECTIVE    NUMBER
  6389*-----------------------------------------------------------------
  6390* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6391* 092705    2005050300006  PEMA  ADD SPP LEASES
  6392* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6393* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6394* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6395* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6396* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6397******************************************************************
  6398
  6399 01  ACCOUNT-MASTER.
  6400     12  AM-RECORD-ID                      PIC XX.
  6401         88  VALID-AM-ID                      VALUE 'AM'.
  6402
  6403     12  AM-CONTROL-PRIMARY.
  6404         16  AM-COMPANY-CD                 PIC X.
  6405         16  AM-MSTR-CNTRL.
  6406             20  AM-CONTROL-A.
  6407                 24  AM-CARRIER            PIC X.
  6408                 24  AM-GROUPING.
  6409                     28 AM-GROUPING-PREFIX PIC XXX.
  6410                     28 AM-GROUPING-PRIME  PIC XXX.
  6411                 24  AM-STATE              PIC XX.
  6412                 24  AM-ACCOUNT.
  6413                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6414                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 117
* EL050.cbl
  6415             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6416                                           PIC X(19).
  6417             20  AM-CNTRL-B.
  6418                 24  AM-EXPIRATION-DT      PIC XX.
  6419                 24  FILLER                PIC X(4).
  6420             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6421                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6422
  6423     12  AM-CONTROL-BY-VAR-GRP.
  6424         16  AM-COMPANY-CD-A1              PIC X.
  6425         16  AM-VG-CARRIER                 PIC X.
  6426         16  AM-VG-GROUPING                PIC X(6).
  6427         16  AM-VG-STATE                   PIC XX.
  6428         16  AM-VG-ACCOUNT                 PIC X(10).
  6429         16  AM-VG-DATE.
  6430             20  AM-VG-EXPIRATION-DT       PIC XX.
  6431             20  FILLER                    PIC X(4).
  6432         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6433                                           PIC 9(11)      COMP-3.
  6434     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6435         16  FILLER                        PIC X(10).
  6436         16  AM-VG-KEY3.
  6437             20  AM-VG3-ACCOUNT            PIC X(10).
  6438             20  AM-VG3-EXP-DT             PIC XX.
  6439         16  FILLER                        PIC X(4).
  6440     12  AM-MAINT-INFORMATION.
  6441         16  AM-LAST-MAINT-DT              PIC XX.
  6442         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6443         16  AM-LAST-MAINT-USER            PIC X(4).
  6444         16  FILLER                        PIC XX.
  6445
  6446     12  AM-EFFECTIVE-DT                   PIC XX.
  6447     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6448
  6449     12  AM-PREV-DATES  COMP-3.
  6450         16  AM-PREV-EXP-DT                PIC 9(11).
  6451         16  AM-PREV-EFF-DT                PIC 9(11).
  6452
  6453     12  AM-REPORT-CODE-1                  PIC X(10).
  6454     12  AM-REPORT-CODE-2                  PIC X(10).
  6455
  6456     12  AM-CITY-CODE                      PIC X(4).
  6457     12  AM-COUNTY-PARISH                  PIC X(6).
  6458
  6459     12  AM-NAME                           PIC X(30).
  6460     12  AM-PERSON                         PIC X(30).
  6461     12  AM-ADDRS                          PIC X(30).
  6462     12  AM-CITY.
  6463         16  AM-ADDR-CITY                  PIC X(28).
  6464         16  AM-ADDR-STATE                 PIC XX.
  6465     12  AM-ZIP.
  6466         16  AM-ZIP-PRIME.
  6467             20  AM-ZIP-PRI-1ST            PIC X.
  6468                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6469             20  FILLER                    PIC X(4).
  6470         16  AM-ZIP-PLUS4                  PIC X(4).
  6471     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6472         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 118
* EL050.cbl
  6473         16  AM-CAN-POSTAL-2               PIC XXX.
  6474         16  FILLER                        PIC XXX.
  6475     12  AM-TEL-NO.
  6476         16  AM-AREA-CODE                  PIC 999.
  6477         16  AM-TEL-PRE                    PIC 999.
  6478         16  AM-TEL-NBR                    PIC 9(4).
  6479     12  AM-TEL-LOC                        PIC X.
  6480         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6481         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6482
  6483     12  AM-COMM-STRUCTURE.
  6484         16  AM-DEFN-1.
  6485             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6486                 24  AM-AGT.
  6487                     28  AM-AGT-PREFIX     PIC X(4).
  6488                     28  AM-AGT-PRIME      PIC X(6).
  6489                 24  AM-COM-TYP            PIC X.
  6490                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6491                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6492                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6493                 24  AM-RECALC-LV-INDIC    PIC X.
  6494                 24  AM-RETRO-LV-INDIC     PIC X.
  6495                 24  AM-GL-CODES           PIC X.
  6496                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6497                 24  FILLER                PIC X(01).
  6498         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6499             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6500                 24  FILLER                PIC X(11).
  6501                 24  AM-L-COMA             PIC XXX.
  6502                 24  AM-J-COMA             PIC XXX.
  6503                 24  AM-A-COMA             PIC XXX.
  6504                 24  FILLER                PIC X(6).
  6505
  6506     12  AM-COMM-CHANGE-STATUS             PIC X.
  6507         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6508
  6509     12  AM-CSR-CODE                       PIC X(4).
  6510
  6511     12  AM-BILLING-STATUS                 PIC X.
  6512         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6513         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6514     12  AM-AUTO-REFUND-SW                 PIC X.
  6515         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6516         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6517     12  AM-GPCD                           PIC 99.
  6518     12  AM-IG                             PIC X.
  6519         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6520         88  AM-HAS-GROUP                     VALUE '2'.
  6521     12  AM-STATUS                         PIC X.
  6522         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6523         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6524         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6525         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6526         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6527         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6528     12  AM-REMIT-TO                       PIC 99.
  6529     12  AM-ID-NO                          PIC X(11).
  6530
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 119
* EL050.cbl
  6531     12  AM-CAL-TABLE                      PIC XX.
  6532     12  AM-LF-DEVIATION                   PIC XXX.
  6533     12  AM-AH-DEVIATION                   PIC XXX.
  6534     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6535     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6536     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6537     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6538     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6539     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6540
  6541     12  AM-USER-FIELDS.
  6542         16  AM-FLD-1                      PIC XX.
  6543         16  AM-FLD-2                      PIC XX.
  6544         16  AM-FLD-3                      PIC XX.
  6545         16  AM-FLD-4                      PIC XX.
  6546         16  AM-FLD-5                      PIC XX.
  6547
  6548     12  AM-1ST-PROD-DATE.
  6549         16  AM-1ST-PROD-YR                PIC XX.
  6550         16  AM-1ST-PROD-MO                PIC XX.
  6551         16  AM-1ST-PROD-DA                PIC XX.
  6552     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6553     12  AM-CERTS-PURGED-DATE.
  6554         16  AM-PUR-YR                     PIC XX.
  6555         16  AM-PUR-MO                     PIC XX.
  6556         16  AM-PUR-DA                     PIC XX.
  6557     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6558     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6559     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6560     12  AM-INACTIVE-DATE.
  6561         16  AM-INA-MO                     PIC 99.
  6562         16  AM-INA-DA                     PIC 99.
  6563         16  AM-INA-YR                     PIC 99.
  6564     12  AM-AR-HI-CERT-DATE                PIC XX.
  6565
  6566     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6567     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6568
  6569     12  AM-OB-PAYMENT-MODE                PIC X.
  6570         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6571         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6572         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6573         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6574
  6575     12  AM-AH-ONLY-INDICATOR              PIC X.
  6576         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6577         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6578
  6579     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6580
  6581     12  AM-OVER-SHORT.
  6582         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6583         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6584
  6585     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6586     12  AM-DCC-CLP-STATE                  PIC XX.
  6587
  6588     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 120
* EL050.cbl
  6589     12  AM-RECALC-REIN                    PIC X.
  6590
  6591     12  AM-REI-TABLE                      PIC XXX.
  6592     12  AM-REI-ET-LF                      PIC X.
  6593     12  AM-REI-ET-AH                      PIC X.
  6594     12  AM-REI-PE-LF                      PIC X.
  6595     12  AM-REI-PE-AH                      PIC X.
  6596     12  AM-REI-PRT-ST                     PIC X.
  6597     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6598     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6599     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6600     12  AM-REI-GROUP-A                    PIC X(6).
  6601     12  AM-REI-MORT                       PIC X(4).
  6602     12  AM-REI-PRT-OW                     PIC X.
  6603     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6604     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6605     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6606     12  AM-REI-GROUP-B                    PIC X(6).
  6607
  6608     12  AM-TRUST-TYPE                     PIC X(2).
  6609
  6610     12  AM-EMPLOYER-STMT-USED             PIC X.
  6611     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6612
  6613     12  AM-STD-AH-TYPE                    PIC XX.
  6614     12  AM-EARN-METHODS.
  6615         16  AM-EARN-METHOD-R              PIC X.
  6616             88 AM-REF-RL-R78                 VALUE 'R'.
  6617             88 AM-REF-RL-PR                  VALUE 'P'.
  6618             88 AM-REF-RL-MEAN                VALUE 'M'.
  6619             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6620         16  AM-EARN-METHOD-L              PIC X.
  6621             88 AM-REF-LL-R78                 VALUE 'R'.
  6622             88 AM-REF-LL-PR                  VALUE 'P'.
  6623             88 AM-REF-LL-MEAN                VALUE 'M'.
  6624             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6625         16  AM-EARN-METHOD-A              PIC X.
  6626             88 AM-REF-AH-R78                 VALUE 'R'.
  6627             88 AM-REF-AH-PR                  VALUE 'P'.
  6628             88 AM-REF-AH-MEAN                VALUE 'M'.
  6629             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6630             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6631             88 AM-REF-AH-NET                 VALUE 'N'.
  6632
  6633     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6634     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6635     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6636
  6637     12  AM-RET-Y-N                        PIC X.
  6638     12  AM-RET-P-E                        PIC X.
  6639     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6640     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6641     12  AM-RET-GRP                        PIC X(6).
  6642     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6643         16  AM-POOL-PRIME                 PIC XXX.
  6644         16  AM-POOL-SUB                   PIC XXX.
  6645     12  AM-RETRO-EARNINGS.
  6646         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 121
* EL050.cbl
  6647         16  AM-RET-EARN-L                 PIC X.
  6648         16  AM-RET-EARN-A                 PIC X.
  6649     12  AM-RET-ST-TAX-USE                 PIC X.
  6650         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6651         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6652     12  AM-RETRO-BEG-EARNINGS.
  6653         16  AM-RET-BEG-EARN-R             PIC X.
  6654         16  AM-RET-BEG-EARN-L             PIC X.
  6655         16  AM-RET-BEG-EARN-A             PIC X.
  6656     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6657     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6658
  6659     12  AM-USER-SELECT-OPTIONS.
  6660         16  AM-USER-SELECT-1              PIC X(10).
  6661         16  AM-USER-SELECT-2              PIC X(10).
  6662         16  AM-USER-SELECT-3              PIC X(10).
  6663         16  AM-USER-SELECT-4              PIC X(10).
  6664         16  AM-USER-SELECT-5              PIC X(10).
  6665
  6666     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6667
  6668     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6669
  6670     12  AM-RPT045A-SWITCH                 PIC X.
  6671         88  RPT045A-OFF                   VALUE 'N'.
  6672
  6673     12  AM-INSURANCE-LIMITS.
  6674         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6675         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6676
  6677     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6678         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6679
  6680     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6681         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6682         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6683
  6684     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6685
  6686     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6687     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6688     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6689     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6690     12  AM-DCC-UEF-STATE                  PIC XX.
  6691     12  FILLER                            PIC XXX.
  6692     12  AM-REPORT-CODE-3                  PIC X(10).
  6693*    12  FILLER                            PIC X(22).
  6694
  6695     12  AM-RESERVE-DATE.
  6696         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6697         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6698         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6699
  6700     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6701     12  AM-NOTIFICATION-TYPES.
  6702         16  AM-NOTIF-OF-LETTERS           PIC X.
  6703         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6704         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 122
* EL050.cbl
  6705         16  AM-NOTIF-OF-STATUS            PIC X.
  6706
  6707     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6708         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6709         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6710         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6711         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6712
  6713     12  AM-BENEFIT-CONTROLS.
  6714         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6715             20  AM-BENEFIT-CODE           PIC XX.
  6716             20  AM-BENEFIT-TYPE           PIC X.
  6717             20  AM-BENEFIT-REVISION       PIC XXX.
  6718             20  AM-BENEFIT-REM-TERM       PIC X.
  6719             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6720             20  FILLER                    PIC XX.
  6721         16  FILLER                        PIC X(80).
  6722
  6723     12  AM-TRANSFER-DATA.
  6724         16  AM-TRANSFERRED-FROM.
  6725             20  AM-TRNFROM-CARRIER        PIC X.
  6726             20  AM-TRNFROM-GROUPING.
  6727                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6728                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6729             20  AM-TRNFROM-STATE          PIC XX.
  6730             20  AM-TRNFROM-ACCOUNT.
  6731                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6732                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6733             20  AM-TRNFROM-DTE            PIC XX.
  6734         16  AM-TRANSFERRED-TO.
  6735             20  AM-TRNTO-CARRIER          PIC X.
  6736             20  AM-TRNTO-GROUPING.
  6737                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6738                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6739             20  AM-TRNTO-STATE            PIC XX.
  6740             20  AM-TRNTO-ACCOUNT.
  6741                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6742                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6743             20  AM-TRNTO-DTE              PIC XX.
  6744         16  FILLER                        PIC X(10).
  6745
  6746     12  AM-SAVED-REMIT-TO                 PIC 99.
  6747
  6748     12  AM-COMM-STRUCTURE-SAVED.
  6749         16  AM-DEFN-1-SAVED.
  6750             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6751                 24  AM-AGT-SV             PIC X(10).
  6752                 24  AM-COM-TYP-SV         PIC X.
  6753                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6754                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6755                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6756                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6757                 24  FILLER                PIC X.
  6758                 24  AM-GL-CODES-SV        PIC X.
  6759                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6760                 24  FILLER                PIC X.
  6761         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6762             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 123
* EL050.cbl
  6763                 24  FILLER                PIC X(11).
  6764                 24  AM-L-COMA-SV          PIC XXX.
  6765                 24  AM-J-COMA-SV          PIC XXX.
  6766                 24  AM-A-COMA-SV          PIC XXX.
  6767                 24  FILLER                PIC X(6).
  6768
  6769     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6770         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6771            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6772            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6773            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6774
  6775     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6776     12  FILLER                            PIC X(120).
  6777
  6778     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6779         16  AM-CONTROL-NAME               PIC X(30).
  6780         16  AM-EXECUTIVE-ONE.
  6781             20  AM-EXEC1-NAME             PIC X(15).
  6782             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6783                                                          COMP-3.
  6784             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6785                                                          COMP-3.
  6786         16  AM-EXECUTIVE-TWO.
  6787             20  AM-EXEC2-NAME             PIC X(15).
  6788             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6789                                                          COMP-3.
  6790             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6791                                                          COMP-3.
  6792
  6793     12  AM-RETRO-ADDITIONAL-DATA.
  6794         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6795         16  AM-RETRO-PREM-P-E             PIC X.
  6796         16  AM-RETRO-CLMS-P-I             PIC X.
  6797         16  AM-RETRO-RET-BRACKET-LF.
  6798             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6799                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6800                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6801             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6802                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6803                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6804             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6805                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6806                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6807         16  AM-RETRO-RET-BRACKET-AH.
  6808             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6809                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6810                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6811                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6812             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6813                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6814                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6815             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6816                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6817                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6818
  6819     12  AM-COMMENTS.
  6820         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 124
* EL050.cbl
  6821
  6822     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6823         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6824         16  AM-FLI-BILLING-CODE           PIC X.
  6825         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6826         16  AM-FLI-UNITED-IDENT           PIC X.
  6827         16  AM-FLI-INTEREST-LOST-DATA.
  6828             20  AM-FLI-BANK-NO            PIC X(5).
  6829             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6830             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6831             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6832         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6833             20  AM-FLI-AGT                PIC X(9).
  6834             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6835             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6836         16  FILLER                        PIC X(102).
  6837
  6838     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6839         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6840             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6841             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6842             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6843             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6844             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6845         16  FILLER                          PIC X(10).
  6846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 125
* EL050.cbl
  6848*    COPY ERCREIN.
  6849******************************************************************
  6850*                                                                *
  6851*                            ERCREIN                             *
  6852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6853*                            VMOD=2.010                          *
  6854*                                                                *
  6855*   ONLINE CREDIT SYSTEM                                         *
  6856*                                                                *
  6857*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6858*                                                                *
  6859*   FILE TYPE = VSAM,KSDS                                        *
  6860*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6861*                                                                *
  6862*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6863*       ALTERNATE PATH = NONE                                    *
  6864*                                                                *
  6865*   LOG = NO                                                     *
  6866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6867*                                                                *
  6868******************************************************************
  6869*                   C H A N G E   L O G
  6870*
  6871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6872*-----------------------------------------------------------------
  6873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6874* EFFECTIVE    NUMBER
  6875*-----------------------------------------------------------------
  6876* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6877* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6878******************************************************************
  6879 01  REINSURANCE-RECORD.
  6880     12  RE-RECORD-ID                      PIC XX.
  6881         88  VALID-RE-ID                      VALUE 'RE'.
  6882
  6883     12  RE-CONTROL-PRIMARY.
  6884         16  RE-COMPANY-CD                 PIC X.
  6885         16  RE-KEY.
  6886             20  RE-CODE                   PIC X.
  6887                 88  RE-TABLE-RECORD          VALUE 'A'.
  6888                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6889             20  RE-TABLE                  PIC XXX.
  6890             20  FILLER                    PIC XXX.
  6891         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6892             20  FILLER                    PIC X.
  6893             20  RE-COMPANY.
  6894                 24  RE-COMP-PRIME         PIC XXX.
  6895                 24  RE-COMP-SUB           PIC XXX.
  6896
  6897     12  RE-MAINT-INFORMATION.
  6898         16  RE-LAST-MAINT-DT              PIC XX.
  6899         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6900         16  RE-LAST-MAINT-USER            PIC X(4).
  6901         16  FILLER                        PIC X(10).
  6902
  6903     12  RE-TABLE-DATA.
  6904         16  RE-100-COMP                   PIC 99.
  6905
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 126
* EL050.cbl
  6906         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6907             20  RE-REI-COMP-NO.
  6908                 24  RE-REI-COMP           PIC XXX.
  6909                 24  RE-REI-COMP-SUB       PIC XXX.
  6910             20  RE-LF-QC                  PIC X.
  6911             20  RE-AH-QC                  PIC X.
  6912             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6913             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6914             20  RE-LFAGE-LO               PIC 99.
  6915             20  RE-LFAGE-HI               PIC 99.
  6916             20  RE-AHAGE-LO               PIC 99.
  6917             20  RE-AHAGE-HI               PIC 99.
  6918             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6919             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6920             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6921             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6922             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6923             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6924             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6925             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6926             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6927             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6928             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6929             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6930             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6931             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6932             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6933             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6934             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6935             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6936             20  RE-LF-BEN-CODE            PIC X.
  6937             20  RE-AH-BEN-CODE            PIC X.
  6938             20  RE-INTERACTIVE            PIC X.
  6939             20  RE-REMAINING              PIC X.
  6940             20  RE-LF-RUNOFF-SW           PIC X.
  6941             20  RE-AH-RUNOFF-SW           PIC X.
  6942             20  FILLER                    PIC X(19).
  6943
  6944         16  RE-COMP-INFO-END              PIC X(6).
  6945         16  RE-NSP-ST-CD-LF               PIC XX.
  6946         16  RE-NSP-ST-CD-AH               PIC XX.
  6947         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6948             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6949
  6950         16  FILLER                        PIC X(27).
  6951
  6952     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6953         16  RE-NAME                       PIC X(30).
  6954         16  RE-LF-PE                      PIC X.
  6955         16  RE-AH-PE                      PIC X.
  6956         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6957         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6958         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6959         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6960         16  RE-PRT-ST                     PIC X.
  6961         16  RE-PRT-OW                     PIC X.
  6962         16  RE-MORT-CODE                  PIC X(4).
  6963         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 127
* EL050.cbl
  6964         16  RE-ZERO-LF-FEE                PIC X.
  6965         16  RE-ZERO-AH-FEE                PIC X.
  6966         16  RE-CEDE-NAME                  PIC X(30).
  6967         16  RE-LF-COMM                    PIC X.
  6968         16  RE-AH-COMM                    PIC X.
  6969         16  RE-LF-TAX                     PIC X.
  6970         16  RE-AH-TAX                     PIC X.
  6971         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6972         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6973         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6974
  6975         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6976             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6977
  6978         16  RE-LF-CEDING-FEE-BRACKETS.
  6979             20  RE-LF-FEE-METHOD          PIC X.
  6980                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6981                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6982                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6983                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6984             20  RE-LF-FEE-BASIS           PIC X.
  6985                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6986                 88  RE-LF-NET-CEDED               VALUE '2'.
  6987                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6988                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6989                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6990                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6991                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6992                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6993             20  FILLER                    PIC XXX.
  6994             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6995                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6996                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6997
  6998         16  RE-AH-CEDING-FEE-BRACKETS.
  6999             20  RE-AH-FEE-METHOD          PIC X.
  7000                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7001                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7002                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7003                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7004             20  RE-AH-FEE-BASIS           PIC X.
  7005                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7006                 88  RE-AH-NET-CEDED               VALUE '2'.
  7007                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7008                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7009                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7010                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7011                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7012                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7013             20  FILLER                    PIC XXX.
  7014             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7015                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7016                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7017
  7018         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7019
  7020         16  RE-OLD-CEDING-STMT            PIC X.
  7021
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 128
* EL050.cbl
  7022         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7023         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7024         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7025         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7026         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7027         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7028         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7029         16  RE-MORT-SW                    PIC X.
  7030         16  RE-CEDING-TYPE-FLAG           PIC X.
  7031             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7032             88  RE-CEDED                          VALUE 'C'.
  7033             88  RE-ASSUMED                        VALUE 'A'.
  7034             88  RE-PHANTOM                        VALUE 'P'.
  7035
  7036         16  RE-CEDING-STMT-OPT-A          PIC X.
  7037             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7038         16  RE-CEDING-STMT-OPT-B          PIC X.
  7039             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7040         16  RE-CEDING-STMT-OPT-C          PIC X.
  7041             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7042         16  RE-CEDING-STMT-OPT-D          PIC X.
  7043             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7044         16  RE-CEDING-STMT-OPT-E          PIC X.
  7045             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7046
  7047         16  RE-PRT-CRSV                   PIC X.
  7048
  7049         16  RE-GL-CENTER                  PIC X(4).
  7050
  7051         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7052
  7053         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7054
  7055         16  RE-EARN-STOP-CODE             PIC X.
  7056             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7057             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7058
  7059         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7060             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7061
  7062         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7063         16  FILLER                        PIC X(2281).
  7064
  7065         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7066
  7067******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 129
* EL050.cbl
  7069*    COPY ERCCTBL.
  7070******************************************************************
  7071*                                                                *
  7072*                                                                *
  7073*                            ERCCTBL                             *
  7074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7075*                            VMOD=2.003
  7076*                                                                *
  7077*   ONLINE CREDIT SYSTEM                                         *
  7078*                                                                *
  7079*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7080*                                                                *
  7081*   FILE TYPE = VSAM,KSDS                                        *
  7082*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7083*                                                                *
  7084*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7085*       ALTERNATE PATH = NONE                                    *
  7086*                                                                *
  7087*   LOG = NO                                                     *
  7088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7089*                                                                *
  7090*                                                                *
  7091******************************************************************
  7092
  7093 01  COMM-TABLE-RECORD.
  7094     12  CT-RECORD-ID                      PIC XX.
  7095         88  VALID-CT-ID                      VALUE 'CT'.
  7096
  7097     12  CT-CONTROL-PRIMARY.
  7098         16  CT-COMPANY-CD                 PIC X.
  7099         16  CT-TABLE                      PIC XXX.
  7100         16  CT-CNTRL-2.
  7101             20  CT-BEN-TYPE               PIC X.
  7102             20  CT-BEN-CODE               PIC XX.
  7103
  7104     12  CT-MAINT-INFORMATION.
  7105         16  CT-LAST-MAINT-DT              PIC XX.
  7106         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7107         16  CT-LAST-MAINT-USER            PIC X(4).
  7108         16  FILLER                        PIC X(31).
  7109
  7110     12  CT-LIMITS.
  7111         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7112
  7113         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7114
  7115         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7116
  7117     12  CT-RATES.
  7118         16  CT-RTX          OCCURS 27 TIMES.
  7119             20  CT-RT                     PIC SV9(5)     COMP-3.
  7120             20  CT-RT-R   REDEFINES
  7121                 CT-RT                     PIC XXX.
  7122
  7123     12  FILLER                            PIC  X(42).
  7124
  7125******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 130
* EL050.cbl
  7127*    COPY ERCFORM.
  7128******************************************************************
  7129*                                                                *
  7130*                                                                *
  7131*                            ERCFORM.                            *
  7132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7133*                            VMOD=2.003                          *
  7134*                                                                *
  7135*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7136*                                                                *
  7137*    FILE TYPE = VSAM,KSDS                                       *
  7138*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7139*                                                                *
  7140*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7141*                                                                *
  7142*    LOG = YES                                                   *
  7143*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7144******************************************************************
  7145 01  FORM-MASTER.
  7146    12  FO-RECORD-ID                 PIC X(02).
  7147        88  VALID-FO-ID                  VALUE 'FO'.
  7148
  7149    12  FO-CONTROL-PRIMARY.
  7150        16  FO-COMPANY-CD            PIC X(01).
  7151        16  FO-STATE                 PIC X(02).
  7152        16  FO-FORM-ID               PIC X(12).
  7153        16  FO-FORM-EXP-DT           PIC X(02).
  7154
  7155    12  FO-POLICY-FORM-DATA.
  7156        16  FO-IND-GRP-CD            PIC X(01).
  7157        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7158        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7159        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7160        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7161        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7162        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7163        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7164        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7165        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7166        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7167        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7168        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7169        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7170        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7171        16  FO-APP-CERT-USE-CD       PIC X(01).
  7172
  7173    12  FILLER                       PIC X(29).
  7174
  7175    12  FO-FORM-PLAN-TABLE.
  7176        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7177            20  FO-PLAN-TYPE         PIC X(01).
  7178            20  FO-PLAN-ID           PIC X(02).
  7179            20  FO-PLAN-TERM         PIC 9(03).
  7180            20  FO-PLAN-REFUND-METHOD
  7181                                     PIC X.
  7182
  7183    12  FILLER                       PIC X(30).
  7184
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 131
* EL050.cbl
  7185    12  FO-COMMENTS-AREA.
  7186        16  FO-COMMENT-LINE-1        PIC X(78).
  7187
  7188    12  FILLER                       PIC X(20).
  7189
  7190    12  FO-MAINT-INFORMATION.
  7191        16  FO-LAST-MAINT-DT         PIC X(02).
  7192        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7193        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 132
* EL050.cbl
  7195*    COPY ELCMSTR.
  7196******************************************************************
  7197*                                                                *
  7198*                            ELCMSTR.                            *
  7199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7200*                            VMOD=2.012                          *
  7201*                                                                *
  7202*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7203*                                                                *
  7204*   FILE TYPE = VSAM,KSDS                                        *
  7205*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7206*                                                                *
  7207*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7208*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7209*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7210*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7211*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7212*                                                 RKP=75,LEN=21  *
  7213*                                                                *
  7214*   **** NOTE ****                                               *
  7215*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7216*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7217*                                                                *
  7218*   LOG = YES                                                    *
  7219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7220******************************************************************
  7221*                   C H A N G E   L O G
  7222*
  7223* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7224*-----------------------------------------------------------------
  7225*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7226* EFFECTIVE    NUMBER
  7227*-----------------------------------------------------------------
  7228* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7229* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7230******************************************************************
  7231 01  CLAIM-MASTER.
  7232     12  CL-RECORD-ID                PIC XX.
  7233         88  VALID-CL-ID         VALUE 'CL'.
  7234
  7235     12  CL-CONTROL-PRIMARY.
  7236         16  CL-COMPANY-CD           PIC X.
  7237         16  CL-CARRIER              PIC X.
  7238         16  CL-CLAIM-NO             PIC X(7).
  7239         16  CL-CERT-NO.
  7240             20  CL-CERT-PRIME       PIC X(10).
  7241             20  CL-CERT-SFX         PIC X.
  7242
  7243     12  CL-CONTROL-BY-NAME.
  7244         16  CL-COMPANY-CD-A1        PIC X.
  7245         16  CL-INSURED-LAST-NAME    PIC X(15).
  7246         16  CL-INSURED-NAME.
  7247             20  CL-INSURED-1ST-NAME PIC X(12).
  7248             20  CL-INSURED-MID-INIT PIC X.
  7249
  7250     12  CL-CONTROL-BY-SSN.
  7251         16  CL-COMPANY-CD-A2        PIC X.
  7252         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 133
* EL050.cbl
  7253             20  CL-SSN-STATE        PIC XX.
  7254             20  CL-SSN-ACCOUNT      PIC X(6).
  7255             20  CL-SSN-LN3          PIC X(3).
  7256
  7257     12  CL-CONTROL-BY-CERT-NO.
  7258         16  CL-COMPANY-CD-A4        PIC X.
  7259         16  CL-CERT-NO-A4.
  7260             20  CL-CERT-A4-PRIME    PIC X(10).
  7261             20  CL-CERT-A4-SFX      PIC X.
  7262
  7263     12  CL-CONTROL-BY-CCN.
  7264         16  CL-COMPANY-CD-A5        PIC X.
  7265         16  CL-CCN-A5.
  7266             20  CL-CCN.
  7267                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7268                 24  CL-CCN-PRIME-A5 PIC X(12).
  7269             20  CL-CCN-FILLER-A5    PIC X(4).
  7270
  7271     12  CL-INSURED-PROFILE-DATA.
  7272         16  CL-INSURED-BIRTH-DT     PIC XX.
  7273         16  CL-INSURED-SEX-CD       PIC X.
  7274             88  INSURED-IS-MALE        VALUE 'M'.
  7275             88  INSURED-IS-FEMALE      VALUE 'F'.
  7276             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7277         16  CL-INSURED-OCC-CD       PIC X(6).
  7278         16  FILLER                  PIC X(5).
  7279
  7280     12  CL-PROCESSING-INFO.
  7281         16  CL-PROCESSOR-ID         PIC X(4).
  7282         16  CL-CLAIM-STATUS         PIC X.
  7283             88  CLAIM-IS-OPEN          VALUE 'O'.
  7284             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7285         16  CL-CLAIM-TYPE           PIC X.
  7286*            88  AH-CLAIM               VALUE 'A'.
  7287*            88  LIFE-CLAIM             VALUE 'L'.
  7288*            88  PROPERTY-CLAIM         VALUE 'P'.
  7289*            88  IUI-CLAIM              VALUE 'I'.
  7290*            88  GAP-CLAIM              VALUE 'G'.
  7291         16  CL-CLAIM-PREM-TYPE      PIC X.
  7292             88  SINGLE-PREMIUM         VALUE '1'.
  7293             88  O-B-COVERAGE           VALUE '2'.
  7294             88  OPEN-END-COVERAGE      VALUE '3'.
  7295         16  CL-INCURRED-DT          PIC XX.
  7296         16  CL-REPORTED-DT          PIC XX.
  7297         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7298         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7299         16  CL-LAST-PMT-DT          PIC XX.
  7300         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7301         16  CL-PAID-THRU-DT         PIC XX.
  7302         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7303         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7304         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7305         16  CL-PMT-CALC-METHOD      PIC X.
  7306             88  CL-360-DAY-YR          VALUE '1'.
  7307             88  CL-365-DAY-YR          VALUE '2'.
  7308             88  CL-FULL-MONTHS         VALUE '3'.
  7309         16  CL-CAUSE-CD             PIC X(6).
  7310
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 134
* EL050.cbl
  7311         16  CL-PRIME-CERT-NO.
  7312             20  CL-PRIME-CERT-PRIME PIC X(10).
  7313             20  CL-PRIME-CERT-SFX   PIC X.
  7314
  7315         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7316             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7317             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7318
  7319         16  CL-MICROFILM-NO         PIC X(10).
  7320         16  CL-PROG-FORM-TYPE       PIC X.
  7321         16  CL-LAST-ADD-ON-DT       PIC XX.
  7322
  7323         16  CL-LAST-REOPEN-DT       PIC XX.
  7324         16  CL-LAST-CLOSE-DT        PIC XX.
  7325         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7326             88  FINAL-PAID             VALUE '1'.
  7327             88  CLAIM-DENIED           VALUE '2'.
  7328             88  AUTO-CLOSE             VALUE '3'.
  7329             88  MANUAL-CLOSE           VALUE '4'.
  7330             88  BENEFITS-CHANGED       VALUE 'C'.
  7331             88  SETUP-ERRORS           VALUE 'E'.
  7332         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7333         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7334         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7335             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7336         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7337         16  FILLER                  PIC X.
  7338
  7339     12  CL-CERTIFICATE-DATA.
  7340         16  CL-CERT-ORIGIN          PIC X.
  7341             88  CERT-WAS-ONLINE        VALUE '1'.
  7342             88  CERT-WAS-CREATED       VALUE '2'.
  7343             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7344         16  CL-CERT-KEY-DATA.
  7345             20  CL-CERT-CARRIER     PIC X.
  7346             20  CL-CERT-GROUPING    PIC X(6).
  7347             20  CL-CERT-STATE       PIC XX.
  7348             20  CL-CERT-ACCOUNT.
  7349                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7350                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7351             20  CL-CERT-EFF-DT      PIC XX.
  7352
  7353     12  CL-STATUS-CONTROLS.
  7354         16  CL-PRIORITY-CD          PIC X.
  7355             88  CONFIDENTIAL-DATA      VALUE '8'.
  7356             88  HIGHEST-PRIORITY       VALUE '9'.
  7357         16  CL-SUPV-ATTN-CD         PIC X.
  7358             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7359             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7360         16  CL-PURGED-DT            PIC XX.
  7361         16  CL-RESTORED-DT          PIC XX.
  7362         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7363         16  CL-NEXT-RESEND-DT       PIC XX.
  7364         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7365         16  FILLER                  PIC XX.
  7366         16  CL-LAST-MAINT-DT        PIC XX.
  7367         16  CL-LAST-MAINT-USER      PIC X(4).
  7368         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 135
* EL050.cbl
  7369         16  CL-LAST-MAINT-TYPE      PIC X.
  7370             88  CLAIM-SET-UP           VALUE ' '.
  7371             88  PAYMENT-MADE           VALUE '1'.
  7372             88  LETTER-SENT            VALUE '2'.
  7373             88  MASTER-WAS-ALTERED     VALUE '3'.
  7374             88  MASTER-WAS-RESTORED    VALUE '4'.
  7375             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7376             88  FILE-CONVERTED         VALUE '6'.
  7377             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7378             88  ERROR-CORRECTION       VALUE 'E'.
  7379         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7380         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7381         16  CL-BENEFICIARY          PIC X(10).
  7382         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7383         16  CL-DENIAL-TYPE          PIC X.
  7384             88  CL-TYPE-DENIAL          VALUE '1'.
  7385             88  CL-TYPE-RESCISSION      VALUE '2'.
  7386             88  CL-TYPE-REFORMATION     VALUE '3'.
  7387             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7388             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7389         16  FILLER                  PIC X(5).
  7390
  7391     12  CL-TRAILER-CONTROLS.
  7392         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7393             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7394             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7395             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7396         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7397         16  FILLER                  PIC XX.
  7398         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7399         16  CL-ADDRESS-TRAILER-CNT.
  7400             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7401                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7402             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7403                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7404             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7405                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7406             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7407                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7408             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7409                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7410             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7411                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7412             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7413                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7414
  7415     12  CL-CV-REFERENCE-NO.
  7416         16  CL-CV-REFNO-PRIME       PIC X(18).
  7417         16  CL-CV-REFNO-SFX         PIC XX.
  7418
  7419     12  CL-FILE-LOCATION            PIC X(4).
  7420
  7421     12  CL-PROCESS-ERRORS.
  7422         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7423             88  NO-FATAL-ERRORS        VALUE ZERO.
  7424         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7425             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7426
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 136
* EL050.cbl
  7427     12  CL-PRODUCT-CD               PIC X.
  7428
  7429     12  CL-CURRENT-KEY-DATA.
  7430         16  CL-CURRENT-CARRIER      PIC X.
  7431         16  CL-CURRENT-GROUPING     PIC X(6).
  7432         16  CL-CURRENT-STATE        PIC XX.
  7433         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7434
  7435     12  CL-ASSOCIATES               PIC X.
  7436         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7437         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7438         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7439         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7440
  7441     12  CL-ACTIVITY-CODE            PIC 99.
  7442     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7443     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7444
  7445     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7446     12  CL-LAG-REPORT-CODE          PIC 9.
  7447     12  CL-LOAN-TYPE                PIC XX.
  7448     12  CL-LEGAL-STATE              PIC XX.
  7449
  7450*    12  FILLER                      PIC X(5).
  7451     12  CL-YESNOSW                  PIC X.
  7452     12  FILLER                      PIC X(4).
  7453
  7454 01  PLAN-RECORDS.
  7455     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7456     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7457
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 137
* EL050.cbl
  7459 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7460                          ACCOUNT-MASTER REINSURANCE-RECORD
  7461                          COMM-TABLE-RECORD FORM-MASTER
  7462                          CLAIM-MASTER PLAN-RECORDS.
  7463 0000-DFHEXIT SECTION.
  7464     MOVE '9#                    $   ' TO DFHEIV0.
  7465     MOVE 'EL050' TO DFHEIV1.
  7466     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7467
  7468     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7469
  7470
  7471* EXEC CICS  HANDLE CONDITION
  7472*           ERROR    (9300-ABEND)
  7473*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7474*    END-EXEC.
  7475*    MOVE '"$.J                  ! " #00007466' TO DFHEIV0
  7476     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7478     MOVE X'2220233030303037343636' TO DFHEIV0(25:11)
  7479     CALL 'kxdfhei1' USING DFHEIV0
  7480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7481
  7482
  7483 0000-COPY-PROCEDURE-DIV.
  7484*                          COPY ELC50PD.
  7485******************************************************************
  7486*                                                                *
  7487*                            ELC50PD                             *
  7488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7489*                            VMOD=2.188                          *
  7490*                                                                *
  7491******************************************************************
  7492*                   C H A N G E   L O G
  7493*
  7494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7495*-----------------------------------------------------------------
  7496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7497* EFFECTIVE    NUMBER
  7498*-----------------------------------------------------------------
  7499* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7500* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7501* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7502*                             2709 AND 2718
  7503* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7504* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7505* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7506* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7507* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7508*                                IS OPEN OR CNC DT < PD THRU
  7509* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7510* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7511* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7512* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7513* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7514* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7515* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7516* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 138
* EL050.cbl
  7517* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7518* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7519* 020906                   PEMA  EXPAND LOAN OFFICER
  7520* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7521* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7522* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7523* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7524* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7525* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7526* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7527* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7528* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7529* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7530* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7531* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7532* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7533* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7534* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7535* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7536* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7537* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7538* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7539* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7540* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7541* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7542* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7543* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7544* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7545*                                UPDATE VIN ON CERT TRAILER
  7546* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7547* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7548* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7549* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7550* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7551* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7552* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7553* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7554* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7555* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7556* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7557* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7558* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7559* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7560* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7561* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7562* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7563* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7564* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7565* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7566* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7567* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7568* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7569* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7570* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7571* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7572* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7573* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7574* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 139
* EL050.cbl
  7575* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7576* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7577* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7578* 032912  CR2011110200001  PEMA  AHL CHANGES
  7579* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7580* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7581* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7582* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7583* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7584* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7585* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7586******************************************************************
  7587************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7588******************************************************************
  7589
  7590     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7591
  7592     MOVE SPACES                 TO PB-FATAL-FLAG
  7593                                    PB-FORCE-ER-CD
  7594                                    PB-WARN-ER-CD
  7595                                    PB-OUT-BAL-CD.
  7596
  7597     MOVE SPACE                  TO WS-IG-OVRD-AH
  7598                                    WS-IG-OVRD-LF
  7599                                    WS-IG-OVRD-AM
  7600                                    WS-IG-OVRD
  7601                                    WS-IG-OVRD-AH-PL
  7602                                    WS-IG-OVRD-LF-PL
  7603                                    WS-IG-OVRD-AH-BEN
  7604                                    WS-IG-OVRD-LF-BEN.
  7605
  7606******************************************************************
  7607*************       INITIALIZE COMMON ERRORS       ***************
  7608******************************************************************
  7609
  7610     MOVE +0                     TO PB-NO-OF-ERRORS.
  7611     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7612
  7613******************************************************************
  7614
  7615     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7616     SET JULIAN-TO-BIN           TO TRUE.
  7617*    MOVE 5                      TO DC-OPTION-CODE.
  7618     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7619     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7620
  7621     MOVE ZERO                   TO  SUB4.
  7622
  7623 0040-INITIALIZE-GA-BILL-DT.
  7624
  7625     ADD +1                      TO  SUB4.
  7626
  7627     IF  SUB4 GREATER THAN +5
  7628         GO TO 0050-CHECK-CNTL-FOUND.
  7629
  7630     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7631         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7632
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 140
* EL050.cbl
  7633     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7634
  7635 0050-CHECK-CNTL-FOUND.
  7636
  7637     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7638        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7639                                         WS-AH-REM-TERM-CALC
  7640                                         EC-CO-REM-TERM-CALC
  7641        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7642        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7643        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7644                                         WS-TOL-AH-CLAIM
  7645        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7646                                         WS-TOL-AH-PREM
  7647                                         EC-CO-TOL-PREM
  7648        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7649                                         WS-TOL-AH-REFUND
  7650                                         EC-CO-TOL-REFUND
  7651        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7652                                         WS-AH-REFUND-OVS-AMT
  7653                                         EC-CO-OVR-SHT-AMT
  7654        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7655                                         WS-TOL-AH-PREM-PCT
  7656                                         EC-CO-TOL-PREM-PCT
  7657        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7658                                         WS-TOL-AH-REFUND-PCT
  7659                                         EC-CO-TOL-REFUND-PCT
  7660        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7661                                         WS-AH-REFUND-OVS-PCT
  7662                                         EC-CO-OVR-SHT-PCT
  7663        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7664        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7665        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7666        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7667        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7668        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7669        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7670        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7671        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7672        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7673        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7674        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7675                                         EC-CO-MONTH-END-DT
  7676        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7677          GO TO 0100-READ-ACCT.
  7678
  7679     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7680     MOVE SPACES                 TO CNTL-ACCESS.
  7681     MOVE '1'                    TO CNTL-REC-TYPE.
  7682     MOVE +0                     TO CNTL-SEQ-NO.
  7683
  7684     MOVE '1' TO RC-SW-1.
  7685     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7686     IF NOT CF-COMPANY-MASTER
  7687         MOVE ZEROS             TO WK-CO-TOL-PREM
  7688                                   WK-CO-TOL-CLAIM
  7689                                   WK-CO-TOL-REFUND
  7690                                   WK-REFUND-OVS-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 141
* EL050.cbl
  7691                                   WK-REFUND-OVS-PCT
  7692                                   WK-CO-TOL-PREM-PCT
  7693                                   WK-CO-TOL-REFUND-PCT
  7694                                   WK-DEFAULT-APR
  7695                                   WK-CO-MAX-CAP
  7696        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7697                                   WK-CR-R78-METHOD
  7698                                   WK-CO-REF-REJECT-SW
  7699                                   WK-CO-PREM-REJECT-SW
  7700                                   WK-REM-TRM-CALC-OPTION
  7701                                   WK-BIRTH-DATE-INPUT
  7702                                   WK-JOINT-AGE-INPUT
  7703        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7704        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7705        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7706        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7707          GO TO 0099-COMPANY-NOT-FOUND.
  7708
  7709     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7710        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7711     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7712        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7713     IF CF-CO-TOL-CAP NOT NUMERIC
  7714        MOVE +0                    TO CF-CO-TOL-CAP.
  7715     IF CF-DEFAULT-APR NOT NUMERIC
  7716        MOVE +0                    TO CF-DEFAULT-APR.
  7717
  7718     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7719     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7720     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7721     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7722     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7723     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7724     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7725     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7726     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7727     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7728     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7729     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7730
  7731     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7732          CF-CO-OVR-SHT-AMT > +0
  7733        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7734
  7735     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7736          CF-CO-OVR-SHT-PCT > +0
  7737        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7738
  7739     IF CF-VALID-REM-TRM-OPTION
  7740         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7741     ELSE
  7742         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7743
  7744     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7745     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7746     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7747     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7748
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 142
* EL050.cbl
  7749     GO TO 0050-CHECK-CNTL-FOUND.
  7750
  7751 0099-COMPANY-NOT-FOUND.
  7752
  7753     MOVE ER-2616                TO WS-ERROR.
  7754     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7755
  7756 0100-READ-ACCT.
  7757
  7758     MOVE SPACES                 TO DATE-RANGE-SW.
  7759
  7760     IF WK-ACCT-ADDR = ZEROS
  7761        GO TO 0102-ACCT-GETMAIN.
  7762
  7763     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7764     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7765     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7766
  7767     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7768        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7769        GO TO 0105-READ-ACCT
  7770     END-IF
  7771
  7772     IF PB-CARRIER NOT = SPACES
  7773        IF PB-CARRIER NOT = AM-VG-CARRIER
  7774           GO TO 0105-READ-ACCT.
  7775
  7776     IF PB-STATE NOT = SPACES
  7777        IF PB-STATE NOT = AM-VG-STATE
  7778           GO TO 0105-READ-ACCT.
  7779
  7780     IF PB-GROUPING NOT = SPACES
  7781        IF PB-GROUPING NOT = AM-VG-GROUPING
  7782           GO TO 0105-READ-ACCT.
  7783
  7784     MOVE 'X'                 TO DATE-RANGE-SW.
  7785
  7786     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7787        MOVE 'X'                 TO DATE-RANGE-SW
  7788        GO TO 0105-READ-ACCT.
  7789
  7790     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7791        GO TO 0105-READ-ACCT.
  7792
  7793     GO TO 0180-ACCOUNT-FOUND.
  7794
  7795 0102-ACCT-GETMAIN.
  7796     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7797     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7798
  7799 0105-READ-ACCT.
  7800     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7801     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7802     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7803     MOVE PB-STATE               TO ACCT-STATE.
  7804     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7805     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7806
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 143
* EL050.cbl
  7807     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7808
  7809     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7810
  7811 0110-FIND-ACCT-TOLERANCES-LOOP.
  7812     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7813
  7814     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7815        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7816        GO TO 0199-ACCT-NOT-FOUND
  7817     END-IF
  7818     IF PB-CARRIER NOT = SPACES
  7819        IF PB-CARRIER NOT = AM-VG-CARRIER
  7820           GO TO 0199-ACCT-NOT-FOUND.
  7821
  7822     IF PB-STATE NOT = SPACES
  7823        IF PB-STATE NOT = AM-VG-STATE
  7824           GO TO 0199-ACCT-NOT-FOUND.
  7825
  7826     IF PB-GROUPING NOT = SPACES
  7827        IF PB-GROUPING NOT = AM-VG-GROUPING
  7828           GO TO 0199-ACCT-NOT-FOUND.
  7829
  7830     MOVE 'X'                    TO DATE-RANGE-SW.
  7831
  7832     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7833        MOVE 'X'                 TO DATE-RANGE-SW
  7834        GO TO 0199-ACCT-NOT-FOUND.
  7835
  7836     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7837        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7838
  7839 0180-ACCOUNT-FOUND.
  7840     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7841     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7842     MOVE AM-STATE               TO PB-SV-STATE.
  7843     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7844
  7845     IF AM-CANCEL-FEE  NOT NUMERIC
  7846        MOVE ZEROS TO AM-CANCEL-FEE.
  7847
  7848     IF AM-MAX-MON-BEN NOT NUMERIC
  7849        MOVE ZEROS TO AM-MAX-MON-BEN.
  7850
  7851     IF AM-MAX-TOT-BEN NOT NUMERIC
  7852        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7853
  7854     IF AM-CLP-TOL-PCT NOT NUMERIC
  7855        MOVE +0                  TO AM-CLP-TOL-PCT
  7856     END-IF
  7857     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7858        MOVE +0                  TO AM-SPP-LEASE-COMM
  7859     END-IF
  7860     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7861        MOVE ER-2611             TO   WS-ERROR
  7862        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7863
  7864     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 144
* EL050.cbl
  7865        MOVE ER-2621             TO   WS-ERROR
  7866        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7867
  7868     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7869        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7870        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7871        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7872         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7873
  7874     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7875     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7876     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7877     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7878     IF AM-CLP-TOL-PCT NOT = ZEROS
  7879        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7880     END-IF
  7881     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7882        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7883     END-IF
  7884*    IF PB-COMPANY-ID = 'DCC'
  7885*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7886*                                   WS-ADMIN-FEES
  7887*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7888*          (SUB5 > +10)
  7889*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7890*             AND (AM-A-COM (SUB5) NUMERIC)
  7891*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7892*                + (AM-A-COM (SUB5) * 1000)
  7893*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7894*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7895*                + (AM-A-COM (SUB5) * 1000)
  7896*             END-IF
  7897*             IF AM-COM-TYP (SUB5) = 'N'
  7898*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7899*                + (AM-A-COM (SUB5) * 1000)
  7900*             END-IF
  7901*          END-IF
  7902*       END-PERFORM
  7903*    END-IF
  7904     IF (PB-COMPANY-ID = 'DCC')
  7905        AND (PB-ISSUE)
  7906        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7907        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7908           (SUB5 > +10)
  7909           MOVE +0 TO WS-WK-RATE
  7910           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7911              IF (AM-A-COM (SUB5) NUMERIC)
  7912                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7913                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7914              ELSE
  7915                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7916                 IF PB-ISSUE
  7917                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7918                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7919                 ELSE
  7920                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7921                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7922                 END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 145
* EL050.cbl
  7923                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7924                 MOVE ZEROS             TO WS-SUB1
  7925                                           WS-COMMISSION
  7926                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7927                 MOVE '0530'               TO CTBL-SW
  7928                 MOVE ' '                  TO WS-CTBL-READ-SW
  7929                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7930                 IF FIRST-TIME-THROUGH
  7931                    MOVE 'AA'              TO CTBL-BEN-CODE
  7932                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7933                 END-IF
  7934                 IF CTBL-TABLE-FOUND
  7935                    IF PB-ISSUE
  7936                       COMPUTE WS-COMM-CK-AMT =
  7937                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7938                    ELSE
  7939                       COMPUTE WS-COMM-CK-AMT =
  7940                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7941                    END-IF
  7942                    PERFORM 8800-GET-COMP-RATE
  7943                              THRU 8800-EXIT
  7944                 END-IF
  7945              END-IF
  7946              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7947                + (WS-WK-RATE * 1000)
  7948           END-IF
  7949        END-PERFORM
  7950     END-IF
  7951     IF PB-COMPANY-ID EQUAL 'CRI'
  7952         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7953
  7954     IF PB-COMPANY-ID EQUAL 'NCL'
  7955         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7956     END-IF
  7957
  7958     GO TO 0200-READ-CERT.
  7959
  7960 0199-ACCT-NOT-FOUND.
  7961
  7962     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7963
  7964     IF DATE-RANGE-SW NOT = SPACES
  7965        MOVE ER-2601             TO WS-ERROR
  7966        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7967     ELSE
  7968        MOVE ER-2619             TO WS-ERROR
  7969        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7970
  7971     GO TO 9990-RETURN.
  7972
  7973 0200-READ-CERT.
  7974
  7975     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7976     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7977     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7978     MOVE PB-SV-STATE            TO CERT-STATE.
  7979     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7980     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 146
* EL050.cbl
  7981     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7982
  7983     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7984
  7985     IF CERT-WAS-NOT-FOUND
  7986        GO TO 0299-CERT-NOT-FOUND.
  7987
  7988     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7989        MOVE ER-2759             TO WS-ERROR
  7990        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7991        GO TO 0298-UNLOCK-RETURN.
  7992
  7993     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7994         MOVE ER-2758            TO WS-ERROR
  7995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7996         GO TO 0298-UNLOCK-RETURN.
  7997
  7998     IF PB-ISSUE
  7999        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8000           IF CERT-WAS-CREATED-FOR-CLAIM
  8001              NEXT SENTENCE
  8002            ELSE
  8003              MOVE ER-2626       TO WS-ERROR
  8004              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8005              GO TO 0298-UNLOCK-RETURN.
  8006
  8007     IF NOT PB-CANCELLATION
  8008        GO TO 0300-CONTINUE-EDIT.
  8009
  8010     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8011     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8012     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8013     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8014     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8015     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8016
  8017     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8018     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8019     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8020     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8021     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8022     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8023     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8024     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8025     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8026
  8027     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8028     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8029     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8030     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8031     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8032     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8033     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8034
  8035     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8036     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8037
  8038     MOVE CM-CREDIT-INTERFACE-SW-1
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 147
* EL050.cbl
  8039                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8040     MOVE CM-CREDIT-INTERFACE-SW-2
  8041                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8042
  8043     IF CM-O-B-COVERAGE
  8044         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8045
  8046     IF CM-LIVES NOT NUMERIC
  8047         MOVE ZERO                TO CM-LIVES.
  8048
  8049     IF CM-BILLED NOT NUMERIC
  8050         MOVE ZERO                TO CM-BILLED.
  8051
  8052     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8053         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8054         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8055         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8056         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8057         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8058         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8059         MOVE CM-LIVES             TO PB-CI-LIVES
  8060*The next line causes a problem with my change  I dont think it is
  8061*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8062
  8063     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8064     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8065     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8066     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8067     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8068     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8069
  8070     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8071     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8072     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8073     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8074
  8075     IF CM-LIFE-COMM-PCT NUMERIC
  8076         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8077     ELSE
  8078         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8079
  8080     IF CM-AH-COMM-PCT NUMERIC
  8081         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8082     ELSE
  8083         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8084
  8085     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8086
  8087     IF CM-LOAN-APR       NOT NUMERIC
  8088           MOVE ZERO               TO CM-LOAN-APR.
  8089
  8090     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8091           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8092
  8093     IF CM-LOAN-TERM      NOT NUMERIC
  8094           MOVE ZERO               TO CM-LOAN-TERM.
  8095
  8096     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 148
* EL050.cbl
  8097           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8098
  8099     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8100           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8101
  8102     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8103     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8104     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8105     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8106     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8107     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8108     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8109     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8110     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8111     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8112     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8113     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8114
  8115     IF CM-STATE = CM-SSN-STATE
  8116         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8117
  8118     IF CM-STATE NOT = CM-MEMB-STATE
  8119         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8120
  8121     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8122
  8123     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8124        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8125        IF CM-ADDL-CLP NOT NUMERIC
  8126           MOVE +0               TO CM-ADDL-CLP
  8127        END-IF
  8128        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8129        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8130           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8131        END-IF
  8132     END-IF
  8133     IF PB-COMPANY-ID = 'DCC'
  8134        MOVE +0                  TO WS-ADMIN-FEES
  8135                                    WS-CSO-ADMIN-FEE
  8136                                    WS-COMM-AND-MFEE
  8137                                    WS-1ST-YR-ALLOW
  8138        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8139           (SUB5 > +10)
  8140           MOVE +0 TO WS-WK-RATE
  8141           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8142              IF (AM-A-COM (SUB5) NUMERIC)
  8143                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8144                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8145              ELSE
  8146                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8147                 IF PB-ISSUE
  8148                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8149                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8150                 ELSE
  8151                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8152                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8153                 END-IF
  8154                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 149
* EL050.cbl
  8155                 MOVE ZEROS             TO WS-SUB1
  8156                                           WS-COMMISSION
  8157                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8158                 MOVE '0530'               TO CTBL-SW
  8159                 MOVE ' '                  TO WS-CTBL-READ-SW
  8160                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8161                 IF FIRST-TIME-THROUGH
  8162                    MOVE 'AA'              TO CTBL-BEN-CODE
  8163                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8164                 END-IF
  8165                 IF CTBL-TABLE-FOUND
  8166                    IF PB-ISSUE
  8167                       COMPUTE WS-COMM-CK-AMT =
  8168                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8169                    ELSE
  8170                       COMPUTE WS-COMM-CK-AMT =
  8171                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8172                    END-IF
  8173                    PERFORM 8800-GET-COMP-RATE
  8174                              THRU 8800-EXIT
  8175                 END-IF
  8176              END-IF
  8177              IF AM-COM-TYP (SUB5) = 'I'
  8178                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8179                   + (WS-WK-RATE * 1000)
  8180              END-IF
  8181              IF AM-COM-TYP (SUB5) = 'N'
  8182                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8183                   + (WS-WK-RATE * 1000)
  8184              END-IF
  8185              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8186                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8187                   + (WS-WK-RATE * 1000)
  8188              END-IF
  8189              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8190                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8191                   + (WS-WK-RATE * 1000)
  8192              END-IF
  8193           END-IF
  8194        END-PERFORM
  8195     END-IF
  8196     GO TO 0300-CONTINUE-EDIT.
  8197
  8198 0298-UNLOCK-RETURN.
  8199      PERFORM 9250-UNLOCK-RETURN
  8200      GO TO 9990-RETURN.
  8201
  8202 0299-CERT-NOT-FOUND.
  8203
  8204     MOVE '1'                     TO CERT-STATUS-SW.
  8205
  8206     IF PB-COMPANY-ID = 'UCL'
  8207         IF WS-ERROR = ER-2799
  8208             GO TO 3000-CONTINUE-EDIT.
  8209
  8210     IF NOT PB-CANCELLATION
  8211         GO TO 0300-CONTINUE-EDIT.
  8212
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 150
* EL050.cbl
  8213     MOVE ER-2726                  TO  WS-ERROR.
  8214     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8215     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8216     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8217                                    PB-CI-LF-TERM
  8218                                    PB-C-LF-REM-TERM
  8219                                    PB-CI-AH-TERM
  8220                                    PB-C-AH-REM-TERM
  8221                                    PB-CI-LF-BENEFIT-CD
  8222                                    PB-CI-LF-BENEFIT-AMT
  8223                                    PB-CI-LF-ALT-BENEFIT-AMT
  8224                                    PB-CI-LF-PREMIUM-AMT
  8225                                    PB-CI-LF-ALT-PREMIUM-AMT
  8226                                    PB-CI-AH-BENEFIT-CD
  8227                                    PB-CI-AH-BENEFIT-AMT
  8228                                    PB-CI-AH-PREMIUM-AMT
  8229                                    PB-CI-PAY-FREQUENCY
  8230                                    PB-CI-LOAN-APR
  8231                                    PB-CI-LOAN-TERM
  8232                                    PB-CI-LIFE-COMMISSION
  8233                                    PB-CI-AH-COMMISSION
  8234                                    PB-CI-CURR-SEQ
  8235                                    PB-CI-AH-CANCEL-AMT
  8236                                    PB-CI-LF-CANCEL-AMT
  8237                                    PB-CI-RATE-DEV-PCT-LF
  8238                                    PB-CI-RATE-DEV-PCT-AH
  8239                                    PB-CI-EXTENTION-DAYS
  8240                                    PB-CI-TERM-IN-DAYS
  8241                                    PB-CI-LIVES
  8242                                    PB-CI-LF-CRIT-PER
  8243                                    PB-CI-AH-CRIT-PER
  8244                                    PB-CI-ADDL-CLP
  8245                                    PB-CI-DDF-IU-RATE-UP.
  8246
  8247     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8248                                    PB-CI-AH-SETTLEMENT-DT
  8249                                    PB-CI-DEATH-DT
  8250                                    PB-CI-LF-PRIOR-CANCEL-DT
  8251                                    PB-CI-AH-PRIOR-CANCEL-DT
  8252                                    PB-CI-ENTRY-DT
  8253                                    PB-CI-LF-EXPIRE-DT
  8254                                    PB-CI-AH-EXPIRE-DT
  8255                                    PB-CI-LOAN-1ST-PMT-DT.
  8256
  8257     IF ACCOUNT-MAST-FOUND
  8258        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8259        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8260
  8261     GO TO 3000-CONTINUE-EDIT.
  8262
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 151
* EL050.cbl
  8264
  8265 0300-CONTINUE-EDIT.
  8266
  8267     IF PB-ISSUE
  8268        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8269            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8270
  8271     IF PB-ISSUE
  8272        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8273            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8274
  8275     IF PB-ISSUE
  8276       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8277          (AM-NO-AH-ONLY)
  8278           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8279               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8280                   MOVE ER-2679 TO WS-ERROR
  8281                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8282
  8283     IF PB-ISSUE
  8284        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8285        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8286        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8287     ELSE
  8288        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8289        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8290        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8291
  8292     MOVE 'N'                    TO PLAN-MASTER-SW
  8293                                    PLAN-MASTER-LIFE-SW
  8294                                    FORM-MASTER-SW
  8295                                    WS-APP-CERT-SW.
  8296
  8297     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8298                                    WS-PL-TOL-LF-REFUND
  8299                                    WS-PL-REF-OVS-AMT
  8300                                    WS-PL-TOL-LF-PREM-PCT
  8301                                    WS-PL-TOL-LF-REFUND-PCT
  8302                                    WS-PL-REF-OVS-PCT
  8303                                    WS-PL-TOL-LF-CLAIM.
  8304
  8305     IF PB-COMPANY-ID = 'NCL'
  8306       IF PB-ISSUE
  8307         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8308             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8309             IF FORM-MASTER-FOUND
  8310                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8311
  8312     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8313        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8314
  8315********************** MON CODE **********************
  8316     IF PB-COMPANY-ID = 'MON'
  8317     IF PB-ISSUE
  8318     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8319        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8320             PB-I-LOAN-APR = ZERO)
  8321               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 152
* EL050.cbl
  8322******************************************************
  8323
  8324     IF PB-COMPANY-ID = 'NCL'
  8325       IF PB-ISSUE
  8326           IF FORM-MASTER-FOUND
  8327             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8328                AM-DISMBR-COVERAGE
  8329                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8330                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8331                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8332                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8333                                           PB-I-LIFE-BENEFIT-CD.
  8334
  8335     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8336
  8337     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8338         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8339         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8340         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8341         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8342         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8343           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8344             GO TO 0301-LIFE-BENEFIT-SEARCH
  8345         ELSE
  8346             NEXT SENTENCE
  8347     ELSE
  8348         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8349
  8350     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8351     MOVE '4'                    TO CNTL-REC-TYPE.
  8352     MOVE +0                     TO CNTL-SEQ-NO.
  8353     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8354
  8355     MOVE '1' TO RC-SW-2.
  8356     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8357
  8358     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8359        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8360         GO TO 0305-BENEFIT-NOT-FOUND.
  8361
  8362     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8363
  8364 0301-LIFE-BENEFIT-SEARCH.
  8365
  8366     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8367
  8368     IF NO-BENEFIT-FOUND
  8369        GO TO 0305-BENEFIT-NOT-FOUND.
  8370
  8371     IF WS-BEN-CD = '99'
  8372        GO TO 0305-BENEFIT-NOT-FOUND.
  8373
  8374     IF PB-COMPANY-ID = 'NCL'
  8375         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8376             GO TO 0304-LIFE-BENEFIT-FOUND.
  8377
  8378     MOVE +1                     TO SUB5.
  8379     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 153
* EL050.cbl
  8380
  8381* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8382* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8383     IF PB-COMPANY-ID = 'DMD'
  8384         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8385
  8386 0302-EDIT-ACCT-LF-BENEFITS.
  8387
  8388     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8389        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8390           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8391                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8392           GO TO 03XX-GET-LIFE-ERPLAN.
  8393
  8394     IF SUB5 LESS THAN +20
  8395        ADD +1                   TO SUB5
  8396        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8397
  8398     MOVE +1                     TO SUB5.
  8399
  8400     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8401        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8402
  8403 0303-EDIT-DMD-EXTRA-BENEFITS.
  8404
  8405     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8406        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8407           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8408                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8409           GO TO 03XX-GET-LIFE-ERPLAN.
  8410
  8411     IF SUB5 LESS THAN +30
  8412        ADD +1                   TO SUB5
  8413        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8414
  8415     MOVE +1                     TO SUB5.
  8416
  8417 03XX-EDIT-FOR-NINETY-LF.
  8418
  8419***************************************************************
  8420*                                                             *
  8421*    NINETY BENEFIT PLAN TYPES:                               *
  8422*                                                             *
  8423*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8424*      92 = ALL GROUP REDUCING BENEFITS                       *
  8425*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8426*      94 = ALL GROUP LEVEL BENEFITS                          *
  8427*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8428*           BENEFIT CONTROLS.                                 *
  8429*      99 = ALL BENEFITS                                      *
  8430*                                                             *
  8431***************************************************************
  8432
  8433     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8434                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8435
  8436     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8437       AND
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 154
* EL050.cbl
  8438        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8439        GO TO 03XX-GET-LIFE-ERPLAN.
  8440
  8441     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8442       AND
  8443        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8444        IF CF-REDUCING (SUB3)
  8445           IF (PB-I-INDV-GRP-OVRD = 'I')
  8446              OR
  8447           ((AM-IG = '1') AND
  8448           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8449              OR
  8450           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8451           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8452           (AM-IG NOT = '2'))
  8453              GO TO 03XX-GET-LIFE-ERPLAN.
  8454
  8455     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8456       AND
  8457        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8458        IF CF-REDUCING (SUB3)
  8459           IF (PB-I-INDV-GRP-OVRD = 'G')
  8460              OR
  8461           ((AM-IG = '2') AND
  8462           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8463              OR
  8464           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8465           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8466           (AM-IG NOT = '1'))
  8467              GO TO 03XX-GET-LIFE-ERPLAN.
  8468
  8469     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8470       AND
  8471        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8472        IF CF-LEVEL    (SUB3)
  8473           IF (PB-I-INDV-GRP-OVRD = 'I')
  8474              OR
  8475           ((AM-IG = '1') AND
  8476           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8477              OR
  8478           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8479           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8480            (AM-IG NOT = '2'))
  8481              GO TO 03XX-GET-LIFE-ERPLAN.
  8482
  8483     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8484       AND
  8485        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8486        IF CF-LEVEL    (SUB3)
  8487           IF (PB-I-INDV-GRP-OVRD = 'G')
  8488              OR
  8489           ((AM-IG = '2') AND
  8490           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8491              OR
  8492           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8493           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8494           (AM-IG NOT = '1'))
  8495              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 155
* EL050.cbl
  8496
  8497     IF SUB5 LESS THAN +20
  8498        ADD +1                   TO SUB5
  8499        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8500
  8501     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8502
  8503     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8504        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8505
  8506     MOVE +1                     TO SUB5.
  8507
  8508 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8509
  8510     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8511                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8512
  8513     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8514       AND
  8515        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8516        GO TO 03XX-GET-LIFE-ERPLAN.
  8517
  8518     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8519       AND
  8520        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8521        IF CF-REDUCING (SUB3)
  8522           IF (PB-I-INDV-GRP-OVRD = 'I')
  8523              OR
  8524           ((AM-IG = '1') AND
  8525           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8526              OR
  8527           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8528           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8529           (AM-IG NOT = '2'))
  8530              GO TO 03XX-GET-LIFE-ERPLAN.
  8531
  8532     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8533       AND
  8534        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8535        IF CF-REDUCING (SUB3)
  8536           IF (PB-I-INDV-GRP-OVRD = 'G')
  8537              OR
  8538           ((AM-IG = '2') AND
  8539           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8540              OR
  8541           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8542           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8543           (AM-IG NOT = '1'))
  8544              GO TO 03XX-GET-LIFE-ERPLAN.
  8545
  8546     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8547       AND
  8548        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8549        IF CF-LEVEL    (SUB3)
  8550           IF (PB-I-INDV-GRP-OVRD = 'I')
  8551              OR
  8552           ((AM-IG = '1') AND
  8553           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 156
* EL050.cbl
  8554              OR
  8555           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8556           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8557            (AM-IG NOT = '2'))
  8558              GO TO 03XX-GET-LIFE-ERPLAN.
  8559
  8560     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8561       AND
  8562        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8563        IF CF-LEVEL    (SUB3)
  8564           IF (PB-I-INDV-GRP-OVRD = 'G')
  8565              OR
  8566           ((AM-IG = '2') AND
  8567           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8568              OR
  8569           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8570           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8571           (AM-IG NOT = '1'))
  8572              GO TO 03XX-GET-LIFE-ERPLAN.
  8573
  8574     IF SUB5 LESS THAN +30
  8575        ADD +1                   TO SUB5
  8576        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8577
  8578     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8579
  8580 03XX-EDIT-FOR-NINETY-LF-CONT.
  8581
  8582     MOVE +99                    TO SUB5.
  8583
  8584     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8585        IF PB-ISSUE
  8586           MOVE ER-1924          TO  WS-ERROR
  8587           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8588
  8589     GO TO 0304-LIFE-BENEFIT-FOUND.
  8590
  8591 03XX-GET-LIFE-ERPLAN.
  8592
  8593     IF WK-PLAN-ADDR EQUAL +0
  8594        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8595
  8596     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8597     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8598     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8599     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8600     MOVE 'Y'                    TO PLAN-MASTER-SW
  8601                                    PLAN-MASTER-LIFE-SW.
  8602     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8603
  8604 03XX-ERPLAN-LIFE-GETMAIN.
  8605
  8606     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8607     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8608
  8609 03XX-ERPLAN-LIFE-READ.
  8610
  8611     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 157
* EL050.cbl
  8612     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8613     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8614     MOVE PB-SV-STATE            TO PLAN-STATE.
  8615     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8616     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8617     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8618     MOVE WS-SAVE-BENEFIT-REVISION
  8619                                 TO PLAN-REVISION-NO.
  8620
  8621     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8622     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8623
  8624     IF PB-COMPANY-ID = 'NCL'
  8625       IF NOT LF-PLAN-MASTER-FOUND
  8626         IF NOT PB-POLICY-IS-DECLINED  AND
  8627            NOT PB-POLICY-IS-VOIDED
  8628             MOVE  ER-1921         TO  WS-ERROR
  8629             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8630             GO TO 0304-LIFE-BENEFIT-FOUND.
  8631
  8632     IF NOT LF-PLAN-MASTER-FOUND
  8633        GO TO 0304-LIFE-BENEFIT-FOUND.
  8634
  8635 XXXX-CHECK-LF-PLAN-KEY.
  8636
  8637     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8638        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8639        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8640        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8641        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8642        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8643        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8644        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8645        MOVE 'N'                 TO PLAN-MASTER-SW
  8646          GO TO 03XX-ERPLAN-LIFE-READ.
  8647
  8648     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8649
  8650     IF  PB-CANCELLATION
  8651         GO TO  0303-LF-ACCT-BEN-FOUND.
  8652
  8653     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8654        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8655           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8656           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8657              MOVE ER-2644             TO WS-ERROR
  8658              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8659           ELSE
  8660              NEXT SENTENCE
  8661        ELSE
  8662           IF PB-COMPANY-ID NOT = 'NCL'
  8663              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8664                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8665
  8666 0303-LF-ACCT-BEN-FOUND.
  8667
  8668     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8669
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 158
* EL050.cbl
  8670     IF PL-DEV-CODE NOT = SPACES
  8671        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8672
  8673     IF PL-DEV-PCT NUMERIC AND
  8674        PL-DEV-PCT NOT = ZEROS
  8675        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8676
  8677     IF PL-TOL-PREM-AMT GREATER THAN +0
  8678        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8679
  8680     IF PL-TOL-REF-AMT GREATER THAN +0
  8681        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8682
  8683     IF PL-TOL-PREM-PCT GREATER THAN +0
  8684        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8685
  8686     IF PL-TOL-REF-PCT GREATER THAN +0
  8687        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8688
  8689     IF PL-TOL-CLM-AMT GREATER THAN +0
  8690        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8691
  8692     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8693                          PL-OVER-SHORT-AMT > +0
  8694        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8695
  8696     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8697                          PL-OVER-SHORT-PCT > +0
  8698        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8699
  8700     IF PL-SALES-TAX NUMERIC AND
  8701                          PL-SALES-TAX > +0
  8702         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8703
  8704     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8705        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8706                                    WS-IG-OVRD-AM.
  8707
  8708 0304-LIFE-BENEFIT-FOUND.
  8709
  8710     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8711
  8712     IF PB-ISSUE
  8713        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8714     ELSE
  8715        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8716
  8717     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8718     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8719     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8720     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8721     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8722                                         WS-LF-REFUND-CALC.
  8723
  8724     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8725        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8726
  8727     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 159
* EL050.cbl
  8728        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8729     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8730
  8731     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8732     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8733     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8734     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8735     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8736     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8737
  8738     IF PB-COMPANY-ID = 'NCL'  AND
  8739        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8740         NEXT SENTENCE
  8741     ELSE
  8742         IF SUB5 NOT GREATER THAN +20
  8743            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8744               MOVE WS-SAVE-BENEFIT-REM-TERM
  8745                                      TO WS-AM-LF-BENE-REM-TERM
  8746                                         EC-BR-LF-REM-TERM-CALC.
  8747
  8748     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8749     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8750
  8751     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8752
  8753 0305-BENEFIT-NOT-FOUND.
  8754
  8755     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8756     MOVE ER-2604                TO WS-ERROR.
  8757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8758
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 160
* EL050.cbl
  8760
  8761 0310-FIND-AH-BENEFIT-RECORD.
  8762
  8763     MOVE 'N'                    TO PLAN-MASTER-SW
  8764                                    PLAN-MASTER-AH-SW.
  8765
  8766     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8767                                    WS-PL-TOL-AH-REFUND
  8768                                    WS-AH-PL-REF-OVS-AMT
  8769                                    WS-PL-TOL-AH-PREM-PCT
  8770                                    WS-PL-TOL-AH-REFUND-PCT
  8771                                    WS-AH-PL-REF-OVS-PCT
  8772                                    WS-PL-TOL-AH-CLAIM.
  8773     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8774
  8775
  8776     if pb-issue
  8777        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8778           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8779        end-if
  8780        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8781           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8782           GO TO 0399-BENEFIT-NOT-FOUND
  8783        end-if
  8784     end-if
  8785
  8786     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8787        GO TO 0400-FIND-CARRIER.
  8788
  8789     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8790
  8791     IF WK-AH-BEN-ADDR NOT = ZEROS
  8792         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8793         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8794         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8795         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8796           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8797             GO TO 0311-AH-BENEFIT-SEARCH
  8798         ELSE
  8799             NEXT SENTENCE
  8800     ELSE
  8801         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8802
  8803     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8804     MOVE '5'                    TO CNTL-REC-TYPE.
  8805     MOVE +0                     TO CNTL-SEQ-NO.
  8806     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8807
  8808     MOVE '2' TO RC-SW-2.
  8809     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8810
  8811     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8812        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8813          GO TO 0399-BENEFIT-NOT-FOUND.
  8814
  8815     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8816
  8817 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 161
* EL050.cbl
  8818
  8819     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8820
  8821     IF NO-BENEFIT-FOUND
  8822         GO TO 0399-BENEFIT-NOT-FOUND.
  8823
  8824     IF WS-BEN-CD = '99'
  8825        GO TO 0399-BENEFIT-NOT-FOUND.
  8826
  8827     IF PB-COMPANY-ID  =  'NCL'
  8828         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8829             GO TO 0314-A-H-BENEFIT-FOUND.
  8830
  8831     MOVE +1                     TO SUB5.
  8832     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8833
  8834* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8835* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8836     IF PB-COMPANY-ID = 'DMD'
  8837         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8838
  8839 0312-EDIT-ACCT-AH-BENEFITS.
  8840
  8841     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8842        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8843           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8844                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8845           GO TO 03XX-GET-AH-ERPLAN.
  8846
  8847     IF SUB5 LESS THAN +20
  8848        ADD +1                   TO SUB5
  8849        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8850
  8851     MOVE +1                     TO SUB5.
  8852
  8853     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8854        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8855
  8856 0313-EDIT-DMD-EXTRA-BENEFITS.
  8857
  8858     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8859        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8860           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8861                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8862           GO TO 03XX-GET-AH-ERPLAN.
  8863
  8864     IF SUB5 LESS THAN +30
  8865        ADD +1                   TO SUB5
  8866        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8867
  8868     MOVE +1                     TO SUB5.
  8869
  8870 03XX-EDIT-FOR-NINETY-AH.
  8871
  8872***************************************************************
  8873*                                                             *
  8874*    NINETY BENEFIT PLAN TYPES:                               *
  8875*                                                             *
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 162
* EL050.cbl
  8876*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8877*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8878*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8879*           BENEFIT CONTROLS.                                 *
  8880*      99 = ALL BENEFITS.                                     *
  8881*                                                             *
  8882***************************************************************
  8883
  8884     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8885                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8886
  8887     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8888       AND
  8889        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8890        GO TO 03XX-GET-AH-ERPLAN.
  8891
  8892     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8893       AND
  8894        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8895           IF (PB-I-INDV-GRP-OVRD = 'I')
  8896              OR
  8897           ((AM-IG = '1') AND
  8898           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8899              OR
  8900           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8901           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8902           (AM-IG NOT = '2'))
  8903              GO TO 03XX-GET-AH-ERPLAN.
  8904
  8905     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8906       AND
  8907        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8908           IF (PB-I-INDV-GRP-OVRD = 'G')
  8909              OR
  8910           ((AM-IG = '2') AND
  8911           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8912              OR
  8913           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8914           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8915           (AM-IG NOT = '1'))
  8916              GO TO 03XX-GET-AH-ERPLAN.
  8917
  8918     IF SUB5 LESS THAN +20
  8919        ADD +1                   TO SUB5
  8920        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8921
  8922     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8923        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8924
  8925     MOVE +1                    TO SUB5.
  8926
  8927 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8928
  8929     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8930                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8931
  8932     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8933       AND
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 163
* EL050.cbl
  8934        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8935        GO TO 03XX-GET-AH-ERPLAN.
  8936
  8937     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8938       AND
  8939        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8940           IF (PB-I-INDV-GRP-OVRD = 'I')
  8941              OR
  8942           ((AM-IG = '1') AND
  8943           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8944              OR
  8945           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8946           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8947           (AM-IG NOT = '2'))
  8948              GO TO 03XX-GET-AH-ERPLAN.
  8949
  8950     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8951       AND
  8952        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8953           IF (PB-I-INDV-GRP-OVRD = 'G')
  8954              OR
  8955           ((AM-IG = '2') AND
  8956           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8957              OR
  8958           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8959           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8960           (AM-IG NOT = '1'))
  8961              GO TO 03XX-GET-AH-ERPLAN.
  8962
  8963     IF SUB5 LESS THAN +30
  8964        ADD +1                   TO SUB5
  8965        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8966
  8967 03XX-EDIT-FOR-NINETY-AH-CONT.
  8968
  8969     MOVE +99                    TO SUB5.
  8970
  8971     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8972
  8973     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8974        IF PB-ISSUE
  8975           MOVE ER-1925          TO  WS-ERROR
  8976           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8977
  8978     GO TO 0314-A-H-BENEFIT-FOUND.
  8979
  8980 03XX-GET-AH-ERPLAN.
  8981
  8982     IF WK-PLAN-ADDR EQUAL +0
  8983         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8984
  8985     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8986     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8987     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8988     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8989     MOVE 'Y'                    TO PLAN-MASTER-SW
  8990                                    PLAN-MASTER-AH-SW.
  8991*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 164
* EL050.cbl
  8992     GO TO 03XX-ERPLAN-AH-READ.
  8993
  8994 03XX-ERPLAN-AH-GETMAIN.
  8995
  8996     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8997     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8998
  8999 03XX-ERPLAN-AH-READ.
  9000
  9001     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9002     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9003     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9004     MOVE PB-SV-STATE            TO PLAN-STATE.
  9005     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9006     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9007     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9008     MOVE WS-SAVE-BENEFIT-REVISION
  9009                                 TO PLAN-REVISION-NO.
  9010
  9011     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9012     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9013
  9014     IF PB-COMPANY-ID = 'NCL'
  9015       IF NOT AH-PLAN-MASTER-FOUND
  9016         IF NOT PB-POLICY-IS-DECLINED  AND
  9017            NOT PB-POLICY-IS-VOIDED
  9018             MOVE  ER-1922         TO  WS-ERROR
  9019             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9020             GO TO 0314-A-H-BENEFIT-FOUND.
  9021
  9022     IF NOT AH-PLAN-MASTER-FOUND
  9023        GO TO 0314-A-H-BENEFIT-FOUND.
  9024
  9025 XXXX-CHECK-AH-PLAN-KEY.
  9026
  9027     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9028        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9029        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9030        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9031        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9032        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9033        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9034        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9035        MOVE 'N'                 TO PLAN-MASTER-SW
  9036          GO TO 03XX-ERPLAN-AH-READ.
  9037
  9038     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9039
  9040     IF  PB-CANCELLATION
  9041         GO TO  0313-AH-ACCT-BEN-FOUND.
  9042
  9043     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9044       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9045          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9046          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9047             MOVE ER-2644             TO WS-ERROR
  9048             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9049          ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 165
* EL050.cbl
  9050             NEXT SENTENCE
  9051       ELSE
  9052          IF PB-COMPANY-ID NOT = 'NCL'
  9053             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9054                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9055
  9056 0313-AH-ACCT-BEN-FOUND.
  9057
  9058     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9059
  9060     IF PL-DEV-CODE NOT = SPACES
  9061        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9062
  9063     IF PL-DEV-PCT NUMERIC AND
  9064        PL-DEV-PCT NOT = ZEROS
  9065        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9066
  9067     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9068        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9069
  9070     IF PL-TOL-REF-AMT NOT EQUAL +0
  9071        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9072
  9073     IF PL-TOL-PREM-PCT GREATER THAN +0
  9074        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9075
  9076     IF PL-TOL-REF-PCT GREATER THAN +0
  9077        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9078
  9079     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9080        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9081
  9082     IF PL-OVER-SHORT-AMT NUMERIC AND
  9083                          PL-OVER-SHORT-AMT > +0
  9084        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9085
  9086     IF PL-OVER-SHORT-PCT NUMERIC AND
  9087                          PL-OVER-SHORT-PCT > +0
  9088        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9089
  9090     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9091        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9092        IF WS-IG-OVRD-AM EQUAL SPACES
  9093            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9094
  9095 0314-A-H-BENEFIT-FOUND.
  9096
  9097     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9098
  9099     IF PB-ISSUE
  9100        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9101       ELSE
  9102        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9103
  9104     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9105     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9106     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9107     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 166
* EL050.cbl
  9108                                         WS-AH-REFUND-CALC.
  9109
  9110     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9111        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9112
  9113     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9114        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9115     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9116
  9117     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9118     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9119     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9120     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9121     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9122     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9123
  9124     IF PB-COMPANY-ID = 'NCL'  AND
  9125        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9126         NEXT SENTENCE
  9127     ELSE
  9128         IF SUB5 NOT GREATER THAN +20
  9129            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9130                MOVE WS-SAVE-BENEFIT-REM-TERM
  9131                                      TO WS-AM-AH-BENE-REM-TERM
  9132                                         EC-BR-AH-REM-TERM-CALC.
  9133
  9134     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9135     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9136
  9137     GO TO 0400-FIND-CARRIER.
  9138
  9139 0399-BENEFIT-NOT-FOUND.
  9140
  9141     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9142     MOVE ER-2605                TO WS-ERROR.
  9143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9144
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 167
* EL050.cbl
  9146
  9147 0400-FIND-CARRIER.
  9148
  9149     MOVE PB-SV-CARRIER          TO WS-CARR.
  9150
  9151     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9152     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9153     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9154     MOVE '6'                    TO CNTL-REC-TYPE.
  9155
  9156*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9157     MOVE SPACE                  TO WS-DMD-RATING-SW
  9158                                    EC-BR-DMD-RATING-SW.
  9159
  9160     MOVE '2'                    TO RC-SW-1.
  9161     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9162
  9163     IF NOT CF-CARRIER-MASTER
  9164        GO TO 0400-CARRIER-NOT-FOUND.
  9165
  9166 0400-BUILD-CARR-TOL.
  9167
  9168     IF CF-CR-TOL-PREM NUMERIC AND
  9169        CF-CR-TOL-PREM GREATER THAN +0
  9170        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9171                                    WS-TOL-AH-PREM.
  9172
  9173     IF CF-CR-TOL-REFUND NUMERIC AND
  9174        CF-CR-TOL-REFUND GREATER THAN +0
  9175        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9176                                    WS-TOL-AH-REFUND.
  9177
  9178     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9179        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9180        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9181                                    WS-AH-REFUND-OVS-AMT.
  9182
  9183     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9184        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9185        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9186                                    WS-AH-REFUND-OVS-PCT.
  9187
  9188     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9189        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9190        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9191                                    WS-TOL-AH-PREM-PCT.
  9192
  9193     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9194        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9195        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9196                                     WS-TOL-AH-REFUND-PCT.
  9197
  9198     IF CF-COMPANY-ID EQUAL 'DMD'
  9199         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9200                                    EC-BR-DMD-RATING-SW.
  9201
  9202     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9203     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 168
* EL050.cbl
  9204        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9205     END-IF
  9206     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9207        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9208     END-IF
  9209     IF WS-TOL-CLP-PCT = ZEROS
  9210        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9211     END-IF
  9212
  9213     IF WS-SPP-LEASE-COMM = ZEROS
  9214        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9215     END-IF
  9216     GO TO 0400-FIND-ERPDEF.
  9217
  9218 0400-CARRIER-NOT-FOUND.
  9219
  9220     MOVE ER-2602                TO WS-ERROR.
  9221     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9222
  9223 0400-FIND-ERPDEF.
  9224     IF PB-COMPANY-ID = 'DCC'
  9225        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9226        CONTINUE
  9227     ELSE
  9228        GO TO 0400-FIND-ERCOMP
  9229     END-IF
  9230     MOVE ' '                    TO PDEF-MASTER-SW
  9231     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9232     MOVE PB-STATE               TO ERPDEF-STATE
  9233     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9234     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9235     IF PB-ISSUE
  9236        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9237     ELSE
  9238        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9239     END-IF
  9240     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9241     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9242     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9243     IF PDEF-MASTER-FOUND
  9244        MOVE 'N'                 TO PDEF-MASTER-SW
  9245        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9246        IF PDEF-MASTER-FOUND
  9247           IF (ERPDEF-KEY-SAVE (1:16) =
  9248                        PD-CONTROL-PRIMARY (1:16))
  9249              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9250              CONTINUE
  9251           ELSE
  9252              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9253              IF (ERPDEF-KEY-SAVE (1:16) =
  9254                        PD-CONTROL-PRIMARY (1:16))
  9255                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9256                 CONTINUE
  9257              ELSE
  9258                 MOVE 'N'        TO PDEF-MASTER-SW
  9259              END-IF
  9260           END-IF
  9261        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 169
* EL050.cbl
  9262        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9263     END-IF
  9264     IF PDEF-MASTER-FOUND
  9265        IF PD-TRUNCATED = 'Y'
  9266           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9267        END-IF
  9268     END-IF
  9269     .
  9270 0400-FIND-ERCOMP.
  9271     IF PB-COMPANY-ID = 'DCC'
  9272        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9273           (WS-SUB1 > +10)
  9274           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9275                 OR 'A' OR 'N'
  9276              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9277              MOVE PB-CARRIER    TO COMP-CARRIER
  9278              MOVE PB-GROUPING   TO COMP-GROUPING
  9279              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9280              MOVE AM-AGT (WS-SUB1)
  9281                                 TO COMP-FIN-RESP
  9282              MOVE 'G'           TO COMP-TYPE
  9283              PERFORM 8582-READ-COMPENSATION-MASTER
  9284                                 THRU 8582-EXIT
  9285              IF COMP-MASTER-FOUND
  9286                 IF CO-GA-INACTIVE
  9287                    MOVE ER-2763 TO WS-ERROR
  9288                    PERFORM 9900-ERROR-FORMAT
  9289                                 THRU 9900-EXIT
  9290                    MOVE +11     TO WS-SUB1
  9291                 END-IF
  9292                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9293                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9294                    MOVE ER-2788 TO WS-ERROR
  9295                    PERFORM 9900-ERROR-FORMAT
  9296                                 THRU 9900-EXIT
  9297                    MOVE +11     TO WS-SUB1
  9298                 END-IF
  9299              END-IF
  9300           END-IF
  9301        END-PERFORM
  9302     END-IF
  9303     IF PB-COMPANY-ID = 'DCC'
  9304        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9305           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9306                                    WS-CLP-STATE
  9307        ELSE
  9308           MOVE SPACES           TO PB-I-CLP-STATE
  9309                                    WS-CLP-STATE
  9310        END-IF
  9311     END-IF
  9312
  9313     IF (PB-COMPANY-ID = 'DCC')
  9314        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9315        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9316        CONTINUE
  9317     ELSE
  9318        GO TO 0400-FIND-STATE-RECORD
  9319     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 170
* EL050.cbl
  9320     MOVE SPACES                 TO WS-CLP-STATE
  9321     MOVE +0                     TO WS-BANK-FEE
  9322                                    WS-BANK-LFEE
  9323                                    WS-BANK-NOCHRGB
  9324
  9325     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9326     IF (PB-ISSUE)
  9327        AND (PB-I-BANK-NUMBER NOT =
  9328            SPACES AND ZEROS AND LOW-VALUES)
  9329        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9330     ELSE
  9331        IF (PB-CANCELLATION)
  9332           AND (PB-CI-BANK-NUMBER NOT =
  9333                SPACES AND ZEROS AND LOW-VALUES)
  9334           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9335        END-IF
  9336     END-IF
  9337     IF COMP-FIN-RESP NOT = LOW-VALUES
  9338        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9339        MOVE PB-CARRIER          TO COMP-CARRIER
  9340        MOVE PB-GROUPING         TO COMP-GROUPING
  9341        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9342        MOVE 'B'                 TO COMP-TYPE
  9343        PERFORM 8582-READ-COMPENSATION-MASTER
  9344                                 THRU 8582-EXIT
  9345        IF COMP-MASTER-FOUND
  9346           IF CO-MAX-BANK-FEE NOT NUMERIC
  9347              MOVE +0            TO CO-MAX-BANK-FEE
  9348           END-IF
  9349           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9350              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9351           END-IF
  9352           IF CO-GA-INACTIVE
  9353              MOVE ER-2763       TO WS-ERROR
  9354              PERFORM 9900-ERROR-FORMAT
  9355                                 THRU 9900-EXIT
  9356           END-IF
  9357           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9358              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9359              MOVE ER-2788 TO WS-ERROR
  9360              PERFORM 9900-ERROR-FORMAT
  9361                                 THRU 9900-EXIT
  9362              MOVE +11     TO WS-SUB1
  9363           END-IF
  9364           IF WS-AH-BEN-CATEGORY = 'G'
  9365              MOVE CO-MAX-BANK-FEE
  9366                                 TO WS-BANK-FEE
  9367                                    PB-I-BANK-FEE
  9368           ELSE
  9369              MOVE CO-MAX-BANK-FEE-LEASE
  9370                                 TO WS-BANK-LFEE
  9371                                    PB-I-BANK-FEE
  9372           END-IF
  9373           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9374              AND (WS-AH-REFUND-CALC = 'G'))
  9375                        OR
  9376              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9377              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 171
* EL050.cbl
  9378              CONTINUE
  9379           ELSE
  9380              MOVE ER-2789 TO WS-ERROR
  9381              PERFORM 9900-ERROR-FORMAT
  9382                                 THRU 9900-EXIT
  9383           END-IF
  9384           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9385                                    PB-I-CLP-STATE
  9386           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9387           MOVE CO-CARRIER       TO BXRF-CARRIER
  9388           MOVE CO-GROUPING      TO BXRF-GROUPING
  9389           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9390           MOVE BXRF-MAX-REC-LENGTH
  9391                                 TO BXRF-REC-LENGTH
  9392           PERFORM 8584-READ-BANK-CROSS-REF
  9393                                 THRU 8584-EXIT
  9394           IF BXRF-MASTER-FOUND
  9395              MOVE ' '           TO BANK-ACCT-SW
  9396              MOVE BK-BANK-POINTER-CNT
  9397                                 TO BK-BANK-POINTER-CNT
  9398              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9399                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9400                 OR (BANK-ACCT-FOUND)
  9401                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9402                    AND (BK-AM-EXP-DT (WS-SUB1)
  9403                                 > PB-CERT-EFF-DT)
  9404                    AND (BK-AM-EFF-DT (WS-SUB1)
  9405                                 NOT > PB-CERT-EFF-DT)
  9406                    SET BANK-ACCT-FOUND TO TRUE
  9407                 END-IF
  9408              END-PERFORM
  9409              IF NOT BANK-ACCT-FOUND
  9410                 MOVE ZEROS      TO WS-BANK-FEE
  9411                                    WS-BANK-LFEE
  9412                 MOVE ER-2869    TO WS-ERROR
  9413                 PERFORM 9900-ERROR-FORMAT
  9414                                 THRU 9900-EXIT
  9415              ELSE
  9416                 PERFORM 5000-PROCESS-REPS
  9417                                 THRU 5000-EXIT
  9418                 IF AGENT-MASTER-FOUND
  9419                    MOVE +0      TO WS-BANK-FEE
  9420                                    WS-BANK-LFEE
  9421*                   MOVE AG-SPP-FEES (1)
  9422*                                TO PB-I-BANK-FEE
  9423*                                   WS-BANK-FEE
  9424                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9425                       (WS-SUB1 > +10)
  9426                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9427                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9428                       END-IF
  9429                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9430                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9431                       END-IF
  9432                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9433                          AG-SPP-FEES (WS-SUB1)
  9434                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9435                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 172
* EL050.cbl
  9436                    END-PERFORM
  9437                    IF WS-AH-BEN-CATEGORY = 'G'
  9438                       MOVE WS-BANK-FEE
  9439                                 TO PB-I-BANK-FEE
  9440                    ELSE
  9441                       MOVE WS-BANK-LFEE
  9442                                 TO PB-I-BANK-FEE
  9443                    END-IF
  9444                 END-IF
  9445              END-IF
  9446           END-IF
  9447        ELSE
  9448           MOVE ER-2879          TO WS-ERROR
  9449           PERFORM 9900-ERROR-FORMAT
  9450                                 THRU 9900-EXIT
  9451        END-IF
  9452     ELSE
  9453        MOVE ER-2879             TO WS-ERROR
  9454        PERFORM 9900-ERROR-FORMAT
  9455                                 THRU 9900-EXIT
  9456     END-IF
  9457     IF WS-AH-BEN-CATEGORY = 'G'
  9458        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9459        + WS-BANK-FEE
  9460     ELSE
  9461        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9462        + WS-BANK-LFEE
  9463     END-IF
  9464     .
  9465 0400-FIND-STATE-RECORD.
  9466
  9467     IF WK-STATE-ADDR NOT = ZEROS
  9468         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9469         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9470         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9471         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9472         IF PB-SV-STATE = CF-STATE-CODE
  9473             GO TO 0405-CONTINUE-EDIT
  9474         ELSE
  9475             NEXT SENTENCE
  9476     ELSE
  9477         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9478
  9479     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9480     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9481     MOVE '3'                    TO CNTL-REC-TYPE.
  9482     MOVE +0                     TO CNTL-SEQ-NO.
  9483
  9484     MOVE '3'                    TO RC-SW-2.
  9485     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9486
  9487     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9488        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9489        PB-SV-STATE   NOT = CF-STATE-CODE)
  9490        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9491                                    WS-TOL-AH-CLAIM
  9492                                    WS-MINIMUM-REFUND
  9493                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 173
* EL050.cbl
  9494                                    WS-TOL-AH-PREM
  9495                                    WS-TOL-LF-REFUND
  9496                                    WS-TOL-AH-REFUND
  9497                                    EC-ST-TOL-PREM-PCT
  9498                                    WS-TOL-LF-PREM-PCT
  9499                                    WS-TOL-AH-PREM-PCT
  9500                                    EC-ST-TOL-REFUND-PCT
  9501                                    WS-TOL-LF-REFUND-PCT
  9502                                    WS-TOL-AH-REFUND-PCT
  9503                                    EC-ST-TOL-PREM
  9504                                    EC-ST-TOL-REFUND
  9505                                    EC-ST-FST-PMT-DAYS-MAX
  9506                                    WS-FREE-LOOK-PERIOD
  9507                                    WS-ST-LF-PREM-TAX
  9508                                    WS-ST-AH-PREM-TAX-I
  9509                                    WS-ST-AH-PREM-TAX-G
  9510                                    WS-BANK-FEE
  9511                                    WS-BANK-LFEE
  9512                                    WS-TOL-CLP-PCT
  9513                                    WS-SPP-LEASE-COMM
  9514        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9515                                    EC-ST-FST-PMT-DAYS-CHG
  9516                                    WS-LF-REM-TERM-CALC
  9517                                    WS-LF-REFUND-CALC
  9518                                    EC-ST-LF-REM-TERM-CALC
  9519                                    EC-ST-LF-REFUND-CALC
  9520                                    WS-AH-REM-TERM-CALC
  9521                                    WS-AH-REFUND-CALC
  9522                                    WS-LF-BEN-CATEGORY
  9523                                    WS-AH-BEN-CATEGORY
  9524                                    WS-CLP-STATE
  9525                                    WS-ST-REFUND-CLAIM-FLAG
  9526                                    EC-ST-AH-REM-TERM-CALC
  9527                                    EC-ST-AH-REFUND-CALC
  9528          GO TO 0499-STATE-NOT-FOUND.
  9529
  9530     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9531
  9532 0405-CONTINUE-EDIT.
  9533
  9534     if pb-company-id = 'AHL'
  9535        continue
  9536     else
  9537        IF PB-CERT-PRIME NOT NUMERIC
  9538           MOVE ER-2722          TO WS-ERROR
  9539           PERFORM 9900-ERROR-FORMAT
  9540                                 THRU 9900-EXIT
  9541        end-if
  9542     END-IF
  9543*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9544*       MOVE +0                  TO SUB3
  9545*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9546*       IF SUB3 > +0
  9547*          MOVE ER-2722          TO WS-ERROR
  9548*          PERFORM 9900-ERROR-FORMAT
  9549*                                THRU 9900-EXIT
  9550*       END-IF
  9551*    END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 174
* EL050.cbl
  9552*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9553*       IF PB-CERT-PRIME NOT NUMERIC
  9554*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9555*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9556*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9557*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9558*
  9559*          MOVE ER-2722          TO WS-ERROR
  9560*          PERFORM 9900-ERROR-FORMAT
  9561*                                THRU 9900-EXIT
  9562*       END-IF
  9563*    END-IF
  9564
  9565     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9566
  9567     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9568        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9569                                    WS-TOL-AH-CLAIM.
  9570
  9571     IF CF-ST-REFUND-MIN NOT NUMERIC
  9572        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9573
  9574     IF CF-ST-REFUND-MIN NOT = ZEROS
  9575        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9576
  9577     IF CF-ST-TOL-PREM  NOT = ZEROS
  9578        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9579                                    WS-TOL-AH-PREM
  9580        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9581
  9582     IF CF-ST-TOL-REFUND NOT = ZEROS
  9583        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9584                                    WS-TOL-AH-REFUND
  9585        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9586
  9587     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9588        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9589        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9590                                    WS-AH-REFUND-OVS-AMT
  9591                                    EC-ST-OVR-SHT-AMT.
  9592
  9593     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9594        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9595        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9596                                    WS-TOL-LF-PREM-PCT
  9597                                    WS-TOL-AH-PREM-PCT.
  9598
  9599     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9600        CF-ST-TOL-REF-PCT GREATER THAN +0
  9601        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9602                                    WS-TOL-LF-REFUND-PCT
  9603                                    WS-TOL-AH-REFUND-PCT.
  9604
  9605     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9606        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9607        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9608                                    WS-AH-REFUND-OVS-PCT
  9609                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 175
* EL050.cbl
  9610
  9611     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9612     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9613
  9614     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9615          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9616
  9617     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9618     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9619     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9620
  9621     IF CF-ST-LF-PREM-TAX NUMERIC
  9622        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9623     END-IF
  9624     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9625        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9626     END-IF
  9627     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9628        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9629     END-IF
  9630
  9631     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9632         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9633     END-IF.
  9634
  9635     IF WS-LF-BENEFIT-CD = ZEROS
  9636        GO TO 0410-CHECK-AH.
  9637
  9638     IF CF-ST-RT-CALC NOT = SPACES
  9639        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9640                                    EC-ST-LF-REM-TERM-CALC
  9641     END-IF
  9642
  9643     IF WS-LF-COVERAGE-TYPE = 'R'
  9644        IF WS-LF-EARNINGS-CALC = '5'
  9645           IF CF-ST-RF-LN-CALC > '0'
  9646              MOVE CF-ST-RF-LN-CALC
  9647                                 TO WS-LF-REFUND-CALC
  9648                                    EC-ST-LF-REFUND-CALC
  9649           END-IF
  9650        ELSE
  9651           IF CF-ST-RF-LR-CALC > '0'
  9652              MOVE CF-ST-RF-LR-CALC
  9653                                 TO WS-LF-REFUND-CALC
  9654                                    EC-ST-LF-REFUND-CALC
  9655           END-IF
  9656        END-IF
  9657     ELSE
  9658        IF CF-ST-RF-LL-CALC > '0'
  9659           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9660                                    EC-ST-LF-REFUND-CALC
  9661        END-IF
  9662     END-IF
  9663
  9664     IF CF-ST-RT-CALC NOT = SPACES
  9665        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9666                                    EC-ST-LF-REM-TERM-CALC
  9667     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 176
* EL050.cbl
  9668
  9669     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9670     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9671
  9672     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9673
  9674     IF NO-BENEFIT-FOUND
  9675        GO TO 0410-CHECK-AH.
  9676
  9677     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9678        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9679                                 TO EC-ST-LF-REM-TERM-CALC
  9680                                    WS-LF-REM-TERM-CALC
  9681     END-IF
  9682
  9683     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9684        MOVE CF-ST-REFUND-CALC (SUB3)
  9685                                 TO WS-LF-REFUND-CALC
  9686                                    EC-ST-LF-REFUND-CALC
  9687     END-IF
  9688*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9689
  9690     .
  9691 0410-CHECK-AH.
  9692
  9693     IF WS-AH-BENEFIT-CD = ZEROS
  9694        GO TO 0500-SET-ACCOUNT.
  9695
  9696     IF CF-ST-RT-CALC NOT = SPACES
  9697        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9698                                    EC-ST-AH-REM-TERM-CALC
  9699     END-IF
  9700
  9701     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9702        IF CF-ST-RF-CP-CALC > '0'
  9703           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9704                                    EC-ST-AH-REFUND-CALC
  9705        END-IF
  9706     ELSE
  9707        IF CF-ST-RF-AH-CALC > '0'
  9708           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9709                                    EC-ST-AH-REFUND-CALC
  9710        END-IF
  9711     END-IF
  9712     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9713     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9714
  9715     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9716
  9717     IF NO-BENEFIT-FOUND
  9718        GO TO 0500-SET-ACCOUNT.
  9719
  9720     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9721        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9722                                 TO WS-AH-REM-TERM-CALC
  9723                                    EC-ST-AH-REM-TERM-CALC
  9724     END-IF
  9725
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 177
* EL050.cbl
  9726     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9727        MOVE CF-ST-REFUND-CALC (SUB3)
  9728                                 TO WS-AH-REFUND-CALC
  9729                                    EC-ST-AH-REFUND-CALC
  9730     END-IF
  9731
  9732*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9733
  9734     GO TO 0500-SET-ACCOUNT.
  9735
  9736 0499-STATE-NOT-FOUND.
  9737
  9738     MOVE ER-2603                TO WS-ERROR.
  9739     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9740
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 178
* EL050.cbl
  9742
  9743 0500-SET-ACCOUNT.
  9744*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9745     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9746        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9747        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9748        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9749        MOVE '3'                 TO CNTL-REC-TYPE
  9750        MOVE +0                  TO CNTL-SEQ-NO
  9751
  9752        MOVE '3'                 TO RC-SW-2
  9753        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9754
  9755        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9756           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9757           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9758           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9759                                    WS-ST-AH-PREM-TAX-I
  9760                                    WS-ST-AH-PREM-TAX-G
  9761        ELSE
  9762           IF CF-ST-LF-PREM-TAX NUMERIC
  9763              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9764           END-IF
  9765           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9766              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9767           END-IF
  9768           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9769              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9770           END-IF
  9771        END-IF
  9772        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9773     END-IF
  9774*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9775*  FOR DCC ONLY
  9776     IF PB-COMPANY-ID = 'DCC'
  9777
  9778     MOVE ' '                    TO STAT-MASTER-SW
  9779     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9780     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9781     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9782     MOVE PB-STATE               TO ELSTAT-STATE
  9783     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9784        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9785     END-IF
  9786
  9787     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9788     SET BIN-TO-GREG             TO TRUE
  9789     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9790     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9791     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9792
  9793     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9794     IF STAT-MASTER-FOUND
  9795        MOVE 'N'                 TO STAT-MASTER-SW
  9796        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9797        IF STAT-MASTER-FOUND
  9798           IF (ELSTAT-KEY-SAVE (1:12) =
  9799                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 179
* EL050.cbl
  9800              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9801                 MOVE 'F'        TO STAT-MASTER-SW
  9802              ELSE
  9803                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9804                 IF (STAT-MASTER-FOUND)
  9805                    AND (ELSTAT-KEY-SAVE (1:12) =
  9806                        SF-CONTROL-PRIMARY (1:12))
  9807                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9808                    MOVE 'F'     TO STAT-MASTER-SW
  9809                 END-IF
  9810              END-IF
  9811           END-IF
  9812        END-IF
  9813     END-IF
  9814
  9815     IF STAT-MASTER-SW = 'F'
  9816        IF SF-ST-LF-PREM-TAX NUMERIC
  9817           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9818        END-IF
  9819        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9820           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9821        END-IF
  9822        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9823           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9824        END-IF
  9825     END-IF
  9826
  9827     END-IF
  9828     IF (PB-COMPANY-ID = 'DCC')
  9829        AND (PB-ISSUE)
  9830        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9831        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9832        AND (AM-GPCD = 06)
  9833        MOVE 'Y'                 TO WS-GOOD-HIN
  9834        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9835           MOVE PB-I-VIN         TO WS-WORK-VIN
  9836           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9837              (V1 > 16)
  9838              IF WS-WORK-VIN (V1:1) NUMERIC
  9839                 MOVE WS-WORK-VIN-N (V1)
  9840                                 TO WS-ROW-B-VAL (V1)
  9841              ELSE
  9842                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9843                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9844                    OR (V2 > 26)
  9845                 END-PERFORM
  9846                 IF V2 < 27
  9847                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9848                 ELSE
  9849                    MOVE 'N'     TO WS-GOOD-HIN
  9850                 END-IF
  9851              END-IF
  9852              COMPUTE WS-ROW-D-VAL (V1) =
  9853                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9854              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9855                 WS-ROW-D-VAL (V1)
  9856           END-PERFORM
  9857           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 180
* EL050.cbl
  9858           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9859             REMAINDER WS-VIN-REMAINDER
  9860           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9861              CONTINUE
  9862           ELSE
  9863              MOVE 'N'           TO WS-GOOD-HIN
  9864           END-IF
  9865        ELSE
  9866           MOVE 'N'              TO WS-GOOD-HIN
  9867        END-IF
  9868        IF WS-GOOD-HIN NOT = 'Y'
  9869           MOVE ER-3826           TO WS-ERROR
  9870           PERFORM 9900-ERROR-FORMAT
  9871                                 THRU 9900-EXIT
  9872        END-IF
  9873     END-IF
  9874     IF (PB-COMPANY-ID = 'DCC')
  9875        AND (PB-ISSUE)
  9876        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9877        AND (AM-GPCD NOT = 06)
  9878        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9879          MOVE PB-I-VIN          TO WS-WORK-VIN
  9880          MOVE +8                TO V2
  9881          MOVE ZEROS             TO WS-VIN-TOTAL
  9882          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9883           (V1 > 17)
  9884             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9885                MOVE ER-3825     TO WS-ERROR
  9886                PERFORM 9900-ERROR-FORMAT
  9887                                 THRU 9900-EXIT
  9888             ELSE
  9889                IF V1 = 8
  9890                   MOVE 10       TO V2
  9891                END-IF
  9892                IF V1 = 9
  9893                   MOVE 0        TO V2
  9894                END-IF
  9895                IF V1 = 10
  9896                   MOVE 9        TO V2
  9897                END-IF
  9898                IF WS-WORK-VIN (V1:1) NUMERIC
  9899                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9900                    + (WS-WORK-VIN-N (V1) * V2)
  9901                ELSE
  9902                   MOVE WS-WORK-VIN (V1:1)
  9903                                 TO WS-HEX-BYTE
  9904                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9905                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9906                    + (WS-NUM (V3) * V2)
  9907                END-IF
  9908                COMPUTE V2 = V2 - 1
  9909             END-IF
  9910          END-PERFORM
  9911          MOVE ZEROS TO WS-VIN-REMAINDER
  9912          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9913             REMAINDER WS-VIN-REMAINDER
  9914          IF ((WS-WORK-VIN (9:1) = 'X')
  9915             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 181
* EL050.cbl
  9916                     OR
  9917             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9918             CONTINUE
  9919          ELSE
  9920             MOVE ER-3826        TO WS-ERROR
  9921             PERFORM 9900-ERROR-FORMAT
  9922                                 THRU 9900-EXIT
  9923          END-IF
  9924        ELSE
  9925          MOVE ER-3826           TO WS-ERROR
  9926          PERFORM 9900-ERROR-FORMAT
  9927                                 THRU 9900-EXIT
  9928        END-IF
  9929     END-IF
  9930******************************************************************
  9931******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9932******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9933******* METHODS.
  9934******************************************************************
  9935     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9936        IF PB-CANCELLATION
  9937           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9938              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9939                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9940                IF FORM-MASTER-FOUND
  9941                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9942******************************************************************
  9943
  9944     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9945     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9946
  9947     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9948     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9949     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9950     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9951
  9952
  9953     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9954     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9955     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9956
  9957     IF AM-LF-OB-RATE NOT NUMERIC
  9958         MOVE ZERO               TO AM-LF-OB-RATE.
  9959
  9960     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9961         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9962
  9963     IF AM-AH-OB-RATE NOT NUMERIC
  9964         MOVE ZERO               TO AM-AH-OB-RATE.
  9965
  9966     IF WS-LF-JOINT-INDICATOR = 'J'
  9967         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9968     ELSE
  9969         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9970
  9971     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9972
  9973     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 182
* EL050.cbl
  9974         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9975
  9976     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9977         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9978                                       WS-IG-OVRD
  9979     ELSE
  9980         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9981             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9982                                       WS-IG-OVRD
  9983         ELSE
  9984             MOVE AM-IG             TO WS-IG-OVRD-AH
  9985                                       WS-IG-OVRD.
  9986
  9987     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9988         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9989                                       WS-IG-OVRD
  9990     ELSE
  9991         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9992             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9993                                       WS-IG-OVRD
  9994         ELSE
  9995             MOVE AM-IG             TO WS-IG-OVRD-LF
  9996                                       WS-IG-OVRD.
  9997
  9998     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9999     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10000     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10001     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10002     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10003
 10004     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10005     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10006     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10007     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10008
 10009     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10010     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10011     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10012     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10013     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10014     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10015     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10016
 10017     IF WS-ACCT-AH-DEV-PCT > +0
 10018        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10019     ELSE
 10020        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10021
 10022     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10023        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10024     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10025        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10026
 10027        IF AM-EARN-METHOD-L = 'S'
 10028            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10029                                        WS-LF-REFUND-CALC.
 10030
 10031        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 183
* EL050.cbl
 10032            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10033                                        WS-LF-REFUND-CALC.
 10034
 10035     IF WS-LF-COVERAGE-TYPE = 'R'
 10036         IF AM-EARN-METHOD-R = 'R'
 10037            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10038                                    WS-LF-REFUND-CALC.
 10039     IF WS-LF-COVERAGE-TYPE = 'R'
 10040         IF AM-EARN-METHOD-R = 'P'
 10041            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10042                                    WS-LF-REFUND-CALC.
 10043     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10044         IF AM-EARN-METHOD-L = 'R'
 10045            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10046                                    WS-LF-REFUND-CALC.
 10047     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10048         IF AM-EARN-METHOD-L = 'P'
 10049            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10050                                    WS-LF-REFUND-CALC.
 10051     IF WS-LF-COVERAGE-TYPE = 'R'
 10052         IF AM-EARN-METHOD-R = 'A'
 10053            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10054                                    WS-LF-REFUND-CALC.
 10055     IF WS-LF-COVERAGE-TYPE = 'R'
 10056         IF AM-EARN-METHOD-R = 'M'
 10057            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10058                                    WS-LF-REFUND-CALC.
 10059     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10060         IF AM-EARN-METHOD-L = 'A'
 10061            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10062                                    WS-LF-REFUND-CALC.
 10063     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10064         IF AM-EARN-METHOD-L = 'M'
 10065            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10066                                    WS-LF-REFUND-CALC.
 10067
 10068     IF AM-EARN-METHOD-A = 'R'
 10069        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10070                                    WS-AH-REFUND-CALC.
 10071     IF AM-EARN-METHOD-A = 'P'
 10072        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10073                                    WS-AH-REFUND-CALC.
 10074     IF AM-EARN-METHOD-A = 'C'
 10075        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10076                                    WS-AH-REFUND-CALC.
 10077     IF AM-EARN-METHOD-A = 'A'
 10078        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10079                                    WS-AH-REFUND-CALC.
 10080     IF AM-EARN-METHOD-A = 'M'
 10081        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10082                                    WS-AH-REFUND-CALC.
 10083     IF AM-EARN-METHOD-A = 'N'
 10084        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10085                                    WS-AH-REFUND-CALC.
 10086     IF AM-EARN-METHOD-A = 'S'
 10087        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10088                                    WS-AH-REFUND-CALC.
 10089
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 184
* EL050.cbl
 10090     IF AM-TOL-PREM NOT = ZEROS
 10091        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10092                                    WS-TOL-AH-PREM.
 10093
 10094     IF AM-OVR-SHT-AMT NUMERIC AND
 10095                  AM-OVR-SHT-AMT > 0
 10096        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10097                                    EC-AM-LF-OVR-SHT-AMT
 10098                                    WS-AH-REFUND-OVS-AMT
 10099                                    EC-AM-AH-OVR-SHT-AMT.
 10100
 10101     IF AM-OVR-SHT-PCT NUMERIC AND
 10102                    AM-OVR-SHT-PCT > 0
 10103        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10104                                    EC-AM-LF-OVR-SHT-PCT
 10105                                    WS-AH-REFUND-OVS-PCT
 10106                                    EC-AM-AH-OVR-SHT-PCT.
 10107
 10108     IF AM-TOL-REF-PCT NUMERIC AND
 10109                  AM-TOL-REF-PCT > 0
 10110        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10111                                    WS-TOL-AH-REFUND-PCT.
 10112
 10113     IF AM-TOL-REF  NOT = ZEROS  AND
 10114                  AM-TOL-REF NUMERIC
 10115        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10116                                    EC-AM-LF-TOL-REFUND
 10117                                    WS-TOL-AH-REFUND
 10118                                    EC-AM-AH-TOL-REFUND.
 10119
 10120     IF AM-TOL-CLM  NOT = ZEROS
 10121        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10122                                    WS-TOL-AH-CLAIM.
 10123
 10124     IF AM-CLP-TOL-PCT NOT NUMERIC
 10125        MOVE +0                  TO AM-CLP-TOL-PCT
 10126     END-IF
 10127
 10128     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10129        MOVE +0                  TO AM-SPP-LEASE-COMM
 10130     END-IF
 10131     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10132        MOVE WS-PL-TOL-LF-PREM-PCT
 10133                                 TO WS-TOL-LF-PREM-PCT.
 10134
 10135     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10136        MOVE WS-PL-TOL-AH-PREM-PCT
 10137                                 TO WS-TOL-AH-PREM-PCT.
 10138
 10139     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10140        MOVE WS-PL-TOL-LF-REFUND-PCT
 10141                                 TO WS-TOL-LF-REFUND-PCT.
 10142
 10143     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10144        MOVE WS-PL-TOL-AH-REFUND-PCT
 10145                                 TO WS-TOL-AH-REFUND-PCT.
 10146
 10147     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 185
* EL050.cbl
 10148        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10149
 10150     IF WS-PL-REF-OVS-PCT > +0
 10151        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10152
 10153     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10154        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10155     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10156        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10157     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10158        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10159     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10160        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10161     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10162        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10163     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10164        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10165
 10166     IF WS-AH-PL-REF-OVS-AMT > +0
 10167        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10168
 10169     IF WS-AH-PL-REF-OVS-PCT > +0
 10170        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10171
 10172     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10173     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10174
 10175     IF PB-CANCELLATION
 10176        GO TO 3000-CONTINUE-EDIT.
 10177
 10178     MOVE +1 TO SUB1.
 10179     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10180     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10181
 10182     IF CF-COMPANY-ID = 'DMD'
 10183       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10184         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10185        ELSE
 10186         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10187
 10188  0525-FIND-ACCT-COMM.
 10189     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10190        NEXT SENTENCE
 10191      ELSE
 10192         ADD +1 TO SUB1
 10193         IF SUB1 LESS +11
 10194            GO TO 0525-FIND-ACCT-COMM
 10195          ELSE
 10196             GO TO 0560-EDIT-CONTINUE.
 10197
 10198     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10199     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10200                                    PB-I-LIFE-COMMISSION.
 10201***  IF PB-COMPANY-ID = 'CRI'
 10202     IF PB-PREM-ACCTNG-ONLY
 10203         GO TO 0560-EDIT-CONTINUE.
 10204
 10205     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 186
* EL050.cbl
 10206     MOVE ' '    TO WS-CTBL-READ-SW.
 10207
 10208
 10209 0530-GET-AH-COMP.
 10210     IF NO-AH-COVERAGE  OR
 10211        NO-AH-BENEFIT-MATCH
 10212           GO TO 0540-NEXT-READ-STEP.
 10213
 10214     IF AM-A-COM (SUB1) NUMERIC
 10215        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10216         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10217         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10218         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10219         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10220     ELSE
 10221          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10222          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10223          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10224          MOVE ZEROS             TO WS-SUB1
 10225                                    WS-COMMISSION
 10226          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10227          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10228          IF WS-COMMISSION > ZEROS
 10229             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10230             GO TO 0540-NEXT-READ-STEP
 10231          END-IF
 10232          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10233          IF CTBL-TABLE-FOUND
 10234             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10235                                        PB-I-AH-TERM
 10236             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10237             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10238             GO TO 0540-NEXT-READ-STEP
 10239          ELSE
 10240             IF FIRST-TIME-THROUGH
 10241                 GO TO 0530-GET-AH-COMP
 10242             ELSE
 10243                 MOVE ER-2609                TO WS-ERROR
 10244                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10245
 10246 0540-NEXT-READ-STEP.
 10247     MOVE '0540' TO CTBL-SW.
 10248     MOVE ' '    TO WS-CTBL-READ-SW.
 10249
 10250 0540-GET-LF-COMP.
 10251     IF NO-LIFE-COVERAGE  OR
 10252        NO-LF-BENEFIT-MATCH
 10253           GO TO 0560-EDIT-CONTINUE.
 10254
 10255     IF WS-LF-JOINT-INDICATOR = 'J'
 10256        IF AM-J-COM (SUB1) NUMERIC
 10257           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10258           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10259           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10260           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10261           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10262        ELSE
 10263           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 187
* EL050.cbl
 10264           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10265           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10266           MOVE ZEROS                TO WS-SUB1
 10267                                        WS-COMMISSION
 10268           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10269           IF WS-COMMISSION > ZEROS
 10270              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10271              GO TO 0560-EDIT-CONTINUE
 10272           END-IF
 10273           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10274           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10275           IF CTBL-TABLE-FOUND
 10276              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10277              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10278              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10279              GO TO 0560-EDIT-CONTINUE
 10280           ELSE
 10281              IF FIRST-TIME-THROUGH
 10282                  GO TO 0540-GET-LF-COMP
 10283              ELSE
 10284                  MOVE ER-2609                TO WS-ERROR
 10285                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10286                  GO TO 0560-EDIT-CONTINUE.
 10287
 10288     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10289        IF AM-L-COM (SUB1) NUMERIC
 10290           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10291           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10292           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10293           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10294           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10295        ELSE
 10296           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10297           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10298           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10299           MOVE ZEROS                TO WS-SUB1
 10300                                        WS-COMMISSION
 10301           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10302           IF WS-COMMISSION IS GREATER THAN ZEROS
 10303              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10304              GO TO 0560-EDIT-CONTINUE
 10305           END-IF
 10306           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10307           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10308           IF CTBL-TABLE-FOUND
 10309              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10310              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10311              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10312              GO TO 0560-EDIT-CONTINUE
 10313           ELSE
 10314              IF FIRST-TIME-THROUGH
 10315                  GO TO 0540-GET-LF-COMP
 10316              ELSE
 10317                  MOVE ER-2609                TO WS-ERROR
 10318                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10319
 10320*    GO TO 0560-EDIT-CONTINUE.
 10321
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 188
* EL050.cbl
 10322 0560-EDIT-CONTINUE.
 10323     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10324                                    WS-AH-PMF-COMM
 10325*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10326*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10327     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10328        (SUB1 > +10)
 10329        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10330           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10331           MOVE '0530'           TO CTBL-SW
 10332           MOVE ' '              TO WS-CTBL-READ-SW
 10333           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10334           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10335           MOVE '0540'           TO CTBL-SW
 10336           MOVE ' '              TO WS-CTBL-READ-SW
 10337           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10338        END-IF
 10339     END-PERFORM
 10340     GO TO 0564-EDIT-CONTINUE
 10341     .
 10342 0561-CHECK-AH.
 10343     IF (NO-AH-COVERAGE)
 10344        OR (NO-AH-BENEFIT-MATCH)
 10345        CONTINUE
 10346     ELSE
 10347        IF (AM-A-COM (SUB1) NUMERIC)
 10348           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10349           IF (AM-COM-TYP (SUB1) = 'A')
 10350              AND (WS-AH-PMF-COMM = ZEROS)
 10351              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10352           END-IF
 10353           CONTINUE
 10354        ELSE
 10355           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10356           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10357           MOVE PB-AH-OVERRIDE-L1
 10358                                 TO CTBL-BEN-TYPE
 10359           MOVE ZEROS            TO WS-SUB1
 10360                                    WS-COMMISSION
 10361           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10362           PERFORM 8300-READ-CTBL-TABLE
 10363                                 THRU 8300-EXIT
 10364           IF CTBL-TABLE-FOUND
 10365              IF (AM-COM-TYP (SUB1) = 'A')
 10366                 AND (WS-AH-PMF-COMM = ZEROS)
 10367                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10368                                        PB-I-AH-TERM
 10369                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10370                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10371              END-IF
 10372              CONTINUE
 10373           ELSE
 10374              IF FIRST-TIME-THROUGH
 10375                 GO TO 0561-CHECK-AH
 10376              ELSE
 10377                 MOVE ER-2609    TO WS-ERROR
 10378                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10379              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 189
* EL050.cbl
 10380           END-IF
 10381        END-IF
 10382     END-IF
 10383     .
 10384 0561-EXIT.
 10385     EXIT.
 10386 0563-CHECK-LF.
 10387     IF (NO-LIFE-COVERAGE)
 10388        OR (NO-LF-BENEFIT-MATCH)
 10389        CONTINUE
 10390     ELSE
 10391        IF WS-LF-JOINT-INDICATOR = 'J'
 10392           IF AM-J-COM (SUB1) NUMERIC
 10393              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10394              IF (AM-COM-TYP (SUB1) = 'A')
 10395                 AND (WS-LF-PMF-COMM = ZEROS)
 10396                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10397              END-IF
 10398              CONTINUE
 10399           ELSE
 10400              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10401              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10402              MOVE PB-LIFE-OVERRIDE-L1
 10403                                 TO CTBL-BEN-TYPE
 10404              MOVE ZEROS         TO WS-SUB1
 10405                                    WS-COMMISSION
 10406              MOVE AM-J-COMA (SUB1)
 10407                                 TO CTBL-TABLE
 10408              PERFORM 8300-READ-CTBL-TABLE
 10409                                 THRU 8300-EXIT
 10410              IF CTBL-TABLE-FOUND
 10411                 IF (AM-COM-TYP (SUB1) = 'A')
 10412                    AND (WS-LF-PMF-COMM = ZEROS)
 10413                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10414                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10415                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10416                 END-IF
 10417                 CONTINUE
 10418              ELSE
 10419                 IF FIRST-TIME-THROUGH
 10420                    GO TO 0563-CHECK-LF
 10421                 ELSE
 10422                    MOVE ER-2609 TO WS-ERROR
 10423                    PERFORM 9900-ERROR-FORMAT
 10424                                 THRU 9900-EXIT
 10425*                   GO TO 0560-EDIT-CONTINUE
 10426                 END-IF
 10427              END-IF
 10428           END-IF
 10429        ELSE
 10430           IF AM-L-COM (SUB1) NUMERIC
 10431              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10432              IF (AM-COM-TYP (SUB1) = 'A')
 10433                 AND (WS-LF-PMF-COMM = ZEROS)
 10434                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10435              END-IF
 10436              CONTINUE
 10437           ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 190
* EL050.cbl
 10438              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10439              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10440              MOVE PB-LIFE-OVERRIDE-L1
 10441                                 TO CTBL-BEN-TYPE
 10442              MOVE ZEROS         TO WS-SUB1
 10443                                    WS-COMMISSION
 10444              MOVE AM-L-COMA (SUB1)
 10445                                 TO CTBL-TABLE
 10446              PERFORM 8300-READ-CTBL-TABLE
 10447                                 THRU 8300-EXIT
 10448              IF CTBL-TABLE-FOUND
 10449                 CONTINUE
 10450              ELSE
 10451                 IF FIRST-TIME-THROUGH
 10452                    GO TO 0563-CHECK-LF
 10453                 ELSE
 10454                    MOVE ER-2609 TO WS-ERROR
 10455                    PERFORM 9900-ERROR-FORMAT
 10456                                 THRU 9900-EXIT
 10457                 END-IF
 10458              END-IF
 10459           END-IF
 10460        END-IF
 10461     END-IF
 10462     .
 10463 0563-EXIT.
 10464     EXIT.
 10465 0564-EDIT-CONTINUE.
 10466
 10467     IF  PB-COMPANY-ID EQUAL 'DMD'
 10468         IF PB-I-NUM-BILLED EQUAL ZEROS
 10469            MOVE ER-8148       TO WS-ERROR
 10470            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10471
 10472*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10473*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10474*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10475*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10476*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10477*         IF NO-CONVERSION-ERROR
 10478*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10479*         ELSE
 10480*             IF PB-COMPANY-ID EQUAL 'HAN'
 10481*                 MOVE ZEROS     TO PB-I-AGE.
 10482     IF PB-I-BIRTHDAY > LOW-VALUES
 10483        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10484        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10485        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10486        PERFORM 8500-DATE-CONVERT
 10487                                 THRU 8500-EXIT
 10488        IF NO-CONVERSION-ERROR
 10489           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10490           IF PB-I-AGE > ZEROS
 10491              IF WS-WORK-AGE NOT = PB-I-AGE
 10492                 MOVE ER-9501    TO WS-ERROR
 10493                 PERFORM 9900-ERROR-FORMAT
 10494                                 THRU 9900-EXIT
 10495              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 191
* EL050.cbl
 10496           ELSE
 10497              MOVE WS-WORK-AGE   TO PB-I-AGE
 10498           END-IF
 10499        END-IF
 10500     END-IF
 10501     IF PB-I-AGE = ZEROS
 10502        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10503           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10504
 10505     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10506                                   WS-AH-EDIT-AGE.
 10507
 10508     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10509        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10510        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10511        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10512        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10513        IF NO-CONVERSION-ERROR
 10514           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10515           IF PB-I-JOINT-AGE > 0
 10516              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10517                 MOVE ER-9503    TO WS-ERROR
 10518                 PERFORM 9900-ERROR-FORMAT
 10519                                 THRU 9900-EXIT
 10520              END-IF
 10521           ELSE
 10522              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10523           END-IF
 10524        ELSE
 10525           MOVE ZEROS            TO PB-I-JOINT-AGE
 10526        END-IF
 10527     END-IF
 10528     IF PB-I-JOINT-AGE NOT NUMERIC
 10529        MOVE ZERO               TO PB-I-JOINT-AGE.
 10530
 10531     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10532        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10533           (WS-AH-JOINT-INDICATOR = 'J')
 10534           IF PB-I-JOINT-AGE = ZEROS
 10535               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10536           END-IF
 10537        END-IF
 10538     END-IF
 10539
 10540     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10541     IF WS-LF-JOINT-INDICATOR = 'J'
 10542        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10543        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10544            IF  PB-I-JOINT-AGE = ZERO
 10545                MOVE ER-2686       TO WS-ERROR
 10546                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10547            ELSE
 10548                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10549                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10550                    IF PB-COMPANY-ID NOT = 'LBL'
 10551                        MOVE ER-2685    TO WS-ERROR
 10552                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10553
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 192
* EL050.cbl
 10554     IF WS-AH-JOINT-INDICATOR = 'J'
 10555        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10556            IF  PB-I-JOINT-AGE = ZERO
 10557                MOVE ER-2686       TO WS-ERROR
 10558                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10559            ELSE
 10560                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10561                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10562                                           WS-EDIT-AGE
 10563                    IF PB-COMPANY-ID NOT = 'LBL'
 10564                        MOVE ER-2685    TO WS-ERROR
 10565                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10566
 10567******************************************************************
 10568*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10569******************************************************************
 10570
 10571     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10572        (WS-AH-SPECIAL-CALC-CD = 'O')
 10573        NEXT SENTENCE
 10574     ELSE
 10575        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10576          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10577           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10578            WS-AH-JOINT-INDICATOR = 'J')  AND
 10579           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10580            MOVE ER-2627             TO WS-ERROR
 10581            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10582
 10583     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10584        (WS-AH-SPECIAL-CALC-CD = 'O')
 10585         NEXT SENTENCE
 10586     ELSE
 10587         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10588            WS-AH-JOINT-INDICATOR = 'J'
 10589             IF PB-I-JOINT-INSURED = SPACES
 10590                 IF PB-COMPANY-ID NOT = 'JAL'
 10591                     MOVE ER-2696    TO WS-ERROR
 10592                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10593
 10594     IF PB-COMPANY-ID NOT = 'BOA'
 10595        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10596           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10597           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10598               PB-I-JOINT-INSURED NOT = SPACES)
 10599                MOVE ER-2691         TO WS-ERROR
 10600                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10601
 10602     IF PB-COMPANY-ID = 'BOA'
 10603        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10604           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10605            IF PB-I-JOINT-AGE NOT = ZEROS
 10606                MOVE ER-2691         TO WS-ERROR
 10607                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10608
 10609     IF PB-COMPANY-ID = 'CRI'
 10610        IF PB-I-SIG-SW = 'J'
 10611           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 193
* EL050.cbl
 10612              WS-AH-JOINT-INDICATOR NOT = 'J'
 10613              MOVE ER-2675       TO WS-ERROR
 10614              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10615
 10616     IF PB-COMPANY-ID = 'CRI'
 10617        IF PB-I-SIG-SW = 'S'
 10618           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10619              WS-AH-JOINT-INDICATOR = 'J'
 10620              MOVE ER-2676       TO WS-ERROR
 10621              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10622
 10623     IF PB-COMPANY-ID = 'CVL'
 10624         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10625            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10626              MOVE ER-2783           TO WS-ERROR
 10627              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10628     IF (WS-LF-JOINT-INDICATOR = 'J')
 10629        AND (WS-AH-JOINT-INDICATOR = 'J')
 10630        AND (PB-I-LF-TERM > 120)
 10631        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10632        MOVE ER-2783             TO WS-ERROR
 10633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10634     END-IF
 10635     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10636
 10637     IF PB-I-INDV-GRP-OVRD = 'I'
 10638        MOVE ER-2666             TO WS-ERROR
 10639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10640        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10641
 10642     IF PB-I-INDV-GRP-OVRD = 'G'
 10643        MOVE ER-2666             TO WS-ERROR
 10644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10645        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10646
 10647     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10648        NEXT SENTENCE
 10649     ELSE
 10650        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10651
 10652     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10653        IF WS-ERROR = ER-2666
 10654           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10655           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10656
 10657     IF PB-COMPANY-ID = 'CID'
 10658        IF PB-STATE = 'UT' OR 'MO'
 10659           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10660                 OR '76' OR '77')
 10661                      OR
 10662               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10663                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10664                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10665                   OR '2K' OR '2L'))
 10666              AND PB-I-INDV-GRP-CD = 'I'
 10667              MOVE ER-2721             TO WS-ERROR
 10668              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10669           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 194
* EL050.cbl
 10670        END-IF
 10671     END-IF
 10672
 10673     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10674     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10675        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10676     ELSE
 10677        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10678     END-IF
 10679
 10680*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10681*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10682     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10683                                    ACCOUNT-AH-CK-SW.
 10684
 10685     IF PB-REISSUED-CERT       OR
 10686        PB-REIN-ONLY-CERT      OR
 10687        PB-POLICY-IS-DECLINED  OR
 10688        PB-POLICY-IS-VOIDED
 10689*       OR PB-MONTHLY-CERT
 10690         GO TO 3000-CONTINUE-EDIT.
 10691
 10692     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10693        IF WS-EDIT-AGE           > +65
 10694           MOVE ER-2709          TO WS-ERROR
 10695           PERFORM 9900-ERROR-FORMAT
 10696                                 THRU 9900-EXIT
 10697        ELSE
 10698           IF WS-EDIT-AGE        > +55
 10699              MOVE ER-2718       TO WS-ERROR
 10700              PERFORM 9900-ERROR-FORMAT
 10701                                 THRU 9900-EXIT
 10702           END-IF
 10703        END-IF
 10704     IF PB-COMPANY-ID = 'DCC'
 10705        IF WS-EDIT-AGE           > +65
 10706           MOVE ER-2709          TO WS-ERROR
 10707           PERFORM 9900-ERROR-FORMAT
 10708                                 THRU 9900-EXIT
 10709        END-IF
 10710     END-IF
 10711     .
 10712
 10713 0565-LIFE-PLAN-LIMIT-EDITS.
 10714
 10715     IF NOT LF-PLAN-MASTER-FOUND
 10716        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10717                                    EC-AM-LF-MAX-TOT-BEN
 10718        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10719
 10720     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10721
 10722     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10723         IF PL-LM-AGE (1) = ZEROS
 10724             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10725
 10726     IF NO-LF-BENEFIT-MATCH          OR
 10727        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 195
* EL050.cbl
 10728        WS-LF-SPECIAL-CALC-CD = 'M'
 10729        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10730
 10731     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10732     MOVE +1                     TO SUB2.
 10733
 10734     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10735        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10736           MOVE +5   TO SUB2
 10737           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10738              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10739              (PL-LM-AGE (SUB2) EQUAL +0)
 10740              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10741              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10742
 10743     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10744
 10745     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10746                               + PB-I-LF-ALT-BENEFIT-AMT.
 10747
 10748 0568-CHECK-LIFE-ATT-AGE.
 10749
 10750     IF PL-ATT-AGE NUMERIC AND
 10751        PL-ATT-AGE > +0
 10752        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10753     END-IF
 10754*    IF PL-ATT-AGE NUMERIC AND
 10755*       PL-ATT-AGE > +0
 10756*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10757*       IF PB-I-BIRTHDAY > LOW-VALUES
 10758*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10759*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10760*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10761*          SET BIN-PLUS-ELAPSED  TO TRUE
 10762*          PERFORM 8500-DATE-CONVERT
 10763*                                THRU 8500-EXIT
 10764*          IF NO-CONVERSION-ERROR
 10765*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10766*             MOVE ER-2669       TO WS-ERROR
 10767*             PERFORM 9900-ERROR-FORMAT
 10768*                                THRU 9900-EXIT
 10769*          END-IF
 10770*       ELSE
 10771*          IF WS-ATT-AGE >= PL-ATT-AGE
 10772*             MOVE ER-2669       TO WS-ERROR
 10773*             PERFORM 9900-ERROR-FORMAT
 10774*                                THRU 9900-EXIT
 10775*          END-IF
 10776*       END-IF
 10777*    END-IF
 10778     .
 10779 0570-CHECK-LIFE-LIMITS.
 10780
 10781     IF PB-COMPANY-ID EQUAL 'CRI'
 10782        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10783           IF SUB2 GREATER THAN +4
 10784              MOVE ER-2637 TO WS-ERROR
 10785              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 196
* EL050.cbl
 10786              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10787
 10788     IF PB-COMPANY-ID  =  'NCL'
 10789        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10790            SUB2 GREATER THAN +8
 10791             MOVE 'U'         TO PB-BATCH-ENTRY
 10792             MOVE ER-2637     TO WS-ERROR
 10793             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10794             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10795
 10796     IF SUB2 > +8
 10797        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10798           AND (PB-I-SIG-SW = 'Y')
 10799           CONTINUE
 10800        ELSE
 10801           MOVE ER-2637          TO WS-ERROR
 10802           PERFORM 9900-ERROR-FORMAT
 10803                                 THRU 9900-EXIT
 10804        END-IF
 10805        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10806     END-IF
 10807     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10808     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10809     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10810
 10811     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10812        ADD +1  TO SUB2
 10813        GO TO 0570-CHECK-LIFE-LIMITS.
 10814
 10815     IF PB-COMPANY-ID = 'NCL'
 10816         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10817
 10818     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10819        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10820        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10821           AND (PB-I-SIG-SW = 'Y')
 10822           CONTINUE
 10823        ELSE
 10824           MOVE ER-2637          TO WS-ERROR
 10825           PERFORM 9900-ERROR-FORMAT
 10826                                 THRU 9900-EXIT
 10827        END-IF
 10828     END-IF
 10829     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10830
 10831
 10832 0570-CHECK-NCL-LIFE-LIMITS.
 10833
 10834     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10835        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10836         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10837
 10838     IF APP-CERT-USED
 10839         IF SUB2  LESS THAN  +5
 10840             MOVE +5          TO SUB2
 10841             GO TO 0570-CHECK-LIFE-LIMITS.
 10842
 10843     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 197
* EL050.cbl
 10844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10845
 10846     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10847
 10848 0575-CHECK-NCL-SIG-SWITCH.
 10849
 10850     IF NOT APP-CERT-USED
 10851         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10852
 10853     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10854        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10855        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10856        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10857         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10858
 10859     IF SUB2 GREATER THAN +4
 10860         IF PL-LM-AGE (5) = ZEROS  AND
 10861            PL-LM-AGE (6) = ZEROS  AND
 10862            PL-LM-AGE (7) = ZEROS  AND
 10863            PL-LM-AGE (8) = ZEROS
 10864             MOVE  ER-1927        TO WS-ERROR
 10865             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10866             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10867         ELSE
 10868             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10869                 MOVE  ER-1920    TO WS-ERROR
 10870                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10871
 10872     IF PB-I-SIG-SW  = 'Y'
 10873       IF NOT PB-I-POLICY-ACCEPTED  AND
 10874          NOT PB-I-POLICY-DECLINED
 10875           MOVE 'U'               TO PB-BATCH-ENTRY
 10876           MOVE  ER-1926          TO WS-ERROR
 10877           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10878
 10879
 10880 0580-AH-PLAN-LIMIT-EDITS.
 10881
 10882     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10883        IF PB-I-AH-BENEFIT-AMT > +1250
 10884           MOVE ER-2702          TO WS-ERROR
 10885           PERFORM 9900-ERROR-FORMAT
 10886                                 THRU 9900-EXIT
 10887        END-IF
 10888     END-IF
 10889
 10890     IF (PB-COMPANY-ID = 'DCC')
 10891        AND (PB-MONTHLY-CERT)
 10892        IF PB-I-AH-BENEFIT-AMT > +3000
 10893           MOVE ER-2881          TO WS-ERROR
 10894           PERFORM 9900-ERROR-FORMAT
 10895                                 THRU 9900-EXIT
 10896        END-IF
 10897     END-IF
 10898     IF NOT AH-PLAN-MASTER-FOUND
 10899        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10900        GO TO 3000-CONTINUE-EDIT.
 10901
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 198
* EL050.cbl
 10902     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10903
 10904     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10905         IF PL-LM-AGE (1) = ZEROS
 10906             GO TO 3000-CONTINUE-EDIT.
 10907
 10908     IF NO-AH-BENEFIT-MATCH          OR
 10909        WS-AH-BENEFIT-CD = ZEROS     OR
 10910        WS-AH-SPECIAL-CALC-CD = 'M'
 10911        GO TO 3000-CONTINUE-EDIT.
 10912
 10913     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10914     MOVE +1                     TO SUB2.
 10915
 10916     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10917        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10918           MOVE +5 TO SUB2
 10919           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10920              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10921              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10922              (PL-LM-AGE (SUB2) EQUAL +0)
 10923              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10924              GO TO 3000-CONTINUE-EDIT.
 10925
 10926     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10927
 10928 0590-CHECK-AH-ATT-AGE.
 10929
 10930     IF PL-ATT-AGE NUMERIC AND
 10931        PL-ATT-AGE GREATER THAN +0
 10932        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10933     END-IF
 10934*       IF WS-ATT-AGE >= PL-ATT-AGE
 10935*          MOVE ER-3054          TO WS-ERROR
 10936*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10937     .
 10938 0597-CHECK-AH-LIMITS.
 10939
 10940     IF PB-COMPANY-ID EQUAL 'CRI'
 10941        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10942           IF SUB2 GREATER THAN +4
 10943              MOVE ER-2638       TO WS-ERROR
 10944              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10945              GO TO 3000-CONTINUE-EDIT.
 10946
 10947     IF PB-COMPANY-ID  =  'NCL'
 10948        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10949            SUB2 GREATER THAN +8
 10950             MOVE 'U'            TO PB-BATCH-ENTRY
 10951             MOVE ER-2638        TO WS-ERROR
 10952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10953             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10954
 10955     IF SUB2 > +8
 10956        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10957           AND (PB-I-SIG-SW = 'Y')
 10958           CONTINUE
 10959        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 199
* EL050.cbl
 10960           MOVE ER-2638          TO WS-ERROR
 10961           PERFORM 9900-ERROR-FORMAT
 10962                                 THRU 9900-EXIT
 10963        END-IF
 10964        GO TO 3000-CONTINUE-EDIT
 10965     END-IF
 10966
 10967     IF PB-COMPANY-ID = 'CRI'
 10968        IF WS-ERROR = ER-2638
 10969           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10970
 10971     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10972     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10973     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10974     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10975
 10976     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10977        ADD +1                   TO SUB2
 10978        GO TO 0597-CHECK-AH-LIMITS.
 10979
 10980     IF PB-COMPANY-ID = 'NCL'
 10981         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10982
 10983     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10984        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10985        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10986                                 > PL-LM-AMT (SUB2))
 10987        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10988           AND (PB-I-SIG-SW = 'Y')
 10989           CONTINUE
 10990        ELSE
 10991           MOVE ER-2638          TO WS-ERROR
 10992           PERFORM 9900-ERROR-FORMAT
 10993                                 THRU 9900-EXIT
 10994        END-IF
 10995     END-IF
 10996
 10997     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10998         IF  WS-ERROR    EQUAL    ER-2638
 10999             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11000                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11001                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11002                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11003                MOVE  ER-1910    TO  WS-ERROR
 11004                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11005
 11006     IF PB-COMPANY-ID = 'CRI'
 11007        IF WS-ERROR = ER-2638
 11008            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11009            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11010            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11011
 11012     GO TO 3000-CONTINUE-EDIT.
 11013
 11014 0597-CHECK-NCL-AH-LIMITS.
 11015
 11016     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11017        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 200
* EL050.cbl
 11018        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11019                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11020         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11021
 11022     IF APP-CERT-USED
 11023         IF SUB2  LESS THAN  +5
 11024             MOVE +5             TO SUB2
 11025             GO TO 0597-CHECK-AH-LIMITS.
 11026
 11027     MOVE ER-2638                TO WS-ERROR.
 11028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11029
 11030     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11031
 11032 0599-CHECK-NCL-SIG-SWITCH.
 11033
 11034     IF NOT APP-CERT-USED
 11035         GO TO 3000-CONTINUE-EDIT.
 11036
 11037     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11038        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11039        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11040        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11041         GO TO 3000-CONTINUE-EDIT.
 11042
 11043     IF SUB2 GREATER THAN +4
 11044         IF PL-LM-AGE (5) = ZEROS  AND
 11045            PL-LM-AGE (6) = ZEROS  AND
 11046            PL-LM-AGE (7) = ZEROS  AND
 11047            PL-LM-AGE (8) = ZEROS
 11048             MOVE  ER-1927        TO WS-ERROR
 11049             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11050             GO TO 3000-CONTINUE-EDIT
 11051         ELSE
 11052             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11053                 MOVE  ER-1920    TO WS-ERROR
 11054                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11055
 11056     IF PB-I-SIG-SW  = 'Y'
 11057       IF NOT PB-I-POLICY-ACCEPTED  AND
 11058          NOT PB-I-POLICY-DECLINED
 11059           MOVE 'U'               TO PB-BATCH-ENTRY
 11060           MOVE  ER-1926          TO WS-ERROR
 11061           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11062
 11063******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 201
* EL050.cbl
 11065
 11066 3000-CONTINUE-EDIT.
 11067
 11068     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11069     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11070     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11071     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11072     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11073
 11074     IF BROWSE-STARTED
 11075        PERFORM 9990-RETURN THRU 9990-EXIT
 11076        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11077
 11078     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11079        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11080        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11081        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11082*       MOVE 1                   TO DC-OPTION-CODE
 11083        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11084        IF DATE-CONVERSION-ERROR
 11085           MOVE ER-2622          TO WS-ERROR
 11086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11087        ELSE
 11088           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11089              MOVE ER-2623       TO WS-ERROR
 11090              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11091           ELSE
 11092              MOVE ER-2622       TO WS-ERROR
 11093              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11094
 11095     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11096     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11097     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11098*    MOVE 1                      TO DC-OPTION-CODE.
 11099     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11100     IF DATE-CONVERSION-ERROR
 11101        GO TO 3005-EDIT-CONTINUE
 11102     ELSE
 11103        IF DC-ELAPSED-DAYS GREATER +180
 11104           MOVE ER-2613          TO WS-ERROR
 11105           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11106        ELSE
 11107           IF DC-ELAPSED-DAYS GREATER +90
 11108              MOVE ER-2612       TO WS-ERROR
 11109              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11110           ELSE
 11111             IF DC-ELAPSED-DAYS GREATER +60
 11112                MOVE ER-2614     TO WS-ERROR
 11113                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11114
 11115 3005-EDIT-CONTINUE.
 11116
 11117     IF PB-CANCELLATION
 11118         GO TO 3700-EDIT-CANCEL.
 11119
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 202
* EL050.cbl
 11121******************************************************************
 11122*                  E D I T   I S S U E                           *
 11123******************************************************************
 11124
 11125 3020-EDIT-ISSUE.
 11126
 11127      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11128      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11129      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11130      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11131      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11132
 11133     IF PB-ISSUE-FORCE
 11134        OR PB-ISSUE-DATE-FORCED
 11135        OR PB-FORCE-OFF
 11136        OR PB-OVERCHARGE-FORCE
 11137        CONTINUE
 11138     ELSE
 11139        MOVE ER-2670             TO WS-ERROR
 11140        PERFORM 9900-ERROR-FORMAT
 11141                                 THRU 9900-EXIT
 11142     END-IF
 11143     .
 11144 3022-SET-POLICY-STATUS.
 11145
 11146     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11147
 11148     IF (PB-REISSUED-CERT)
 11149             OR
 11150        ((PB-COMPANY-ID NOT = 'DCC')
 11151         AND (PB-MONTHLY-CERT))
 11152         MOVE '5'                TO PB-I-ENTRY-STATUS
 11153         MOVE 'E'                TO PB-BATCH-ENTRY
 11154     END-IF
 11155
 11156     IF PB-COMPANY-ID = 'DCC'
 11157        IF PB-MONTHLY-CERT
 11158           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11159        END-IF
 11160     END-IF
 11161     IF PB-POLICY-IS-DECLINED
 11162         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11163     IF PB-POLICY-IS-VOIDED
 11164         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11165     IF PB-NEEDS-UNDERWRITING
 11166         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11167     IF PB-REIN-ONLY-CERT
 11168         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11169     IF PB-PREM-ACCTNG-ONLY
 11170         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11171
 11172     MOVE SPACE                  TO PB-I-OB-FLAG.
 11173
 11174     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11175         MOVE ER-2665            TO WS-ERROR
 11176         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11177         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11178
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 203
* EL050.cbl
 11179     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11180        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11181           MOVE 'Z'             TO PB-I-OB-FLAG.
 11182
 11183     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11184        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11185           MOVE 'Z'             TO PB-I-OB-FLAG.
 11186
 11187     IF ACCOUNT-MAST-FOUND
 11188         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11189         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11190         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11191         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11192         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11193         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11194         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11195     END-IF
 11196
 11197     IF ACCOUNT-MAST-FOUND
 11198        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11199         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11200
 11201     IF (ACCOUNT-MAST-FOUND)
 11202        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11203        IF PB-REISSUED-CERT
 11204           CONTINUE
 11205        ELSE
 11206           MOVE ER-2608          TO WS-ERROR
 11207           PERFORM 9900-ERROR-FORMAT
 11208                                 THRU 9900-EXIT
 11209         END-IF
 11210     END-IF
 11211
 11212     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11213        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11214        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11215
 11216**********   DMD CUSTOM CODE FOLLOWS  **********
 11217 3024-EDIT-DMD-FIELDS.
 11218     IF PB-COMPANY-ID NOT = 'DMD'
 11219        GO TO 3025-EDIT-REINSURANCE.
 11220
 11221*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11222*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11223*** ERROR IF THEY ARE NOT EQUAL.
 11224
 11225     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11226     SET BIN-TO-GREG               TO TRUE.
 11227     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11228     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11229**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11230
 11231     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11232     SET BIN-TO-GREG               TO TRUE.
 11233     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11234     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11235**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11236
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 204
* EL050.cbl
 11237     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11238        MOVE ER-8116               TO WS-ERROR
 11239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11240
 11241     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11242
 11243     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11244                                      WK-FULL-CERT-NO.
 11245     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11246
 11247     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11248
 11249     IF PB-VALID-LIFE
 11250        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11251     ELSE
 11252        IF PB-VALID-AH
 11253          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11254
 11255
 11256     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11257     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11258     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11259                                      DCUA-UNDRWRTR-CODE
 11260                                      DCUA-UNDRWRTR-GROUP-CODE
 11261                                      DCUA-RETURN-CODE.
 11262
 11263****************************************************************
 11264*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11265***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11266***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11267***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11268***   TO THIS RECORD.                                        ***
 11269****************************************************************
 11270     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11271     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11272     IF DCUA-SUCCESSFUL-PROCESS
 11273        GO TO 3024-EDIT-DL7-CONT.
 11274
 11275     IF DCUA-RETURN-CODE EQUAL '01'
 11276        MOVE ER-8110               TO WS-ERROR
 11277        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11279        GO TO 3024-EDIT-DL7-CONT.
 11280
 11281     IF DCUA-RETURN-CODE EQUAL '02'
 11282        MOVE ER-8111               TO WS-ERROR
 11283        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11285        GO TO 3024-EDIT-DL7-CONT.
 11286
 11287     IF DCUA-RETURN-CODE EQUAL '03'
 11288        MOVE ER-8074               TO WS-ERROR
 11289        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11290        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11291        GO TO 3024-EDIT-DL7-CONT.
 11292
 11293     IF DCUA-RETURN-CODE EQUAL '04'
 11294        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 205
* EL050.cbl
 11295        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11297        GO TO 3024-EDIT-DL7-CONT.
 11298
 11299     IF DCUA-RETURN-CODE EQUAL '05'
 11300        MOVE ER-8076               TO WS-ERROR
 11301        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11303        GO TO 3024-EDIT-DL7-CONT.
 11304
 11305     IF DCUA-RETURN-CODE EQUAL '06'
 11306        MOVE ER-8077               TO WS-ERROR
 11307        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11309        GO TO 3024-EDIT-DL7-CONT.
 11310
 11311     IF DCUA-RETURN-CODE EQUAL '07'
 11312        MOVE ER-8078               TO WS-ERROR
 11313        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11315        GO TO 3024-EDIT-DL7-CONT.
 11316
 11317     IF DCUA-RETURN-CODE EQUAL 'E1'
 11318        MOVE ER-8079               TO WS-ERROR
 11319        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11321        GO TO 3024-EDIT-DL7-CONT.
 11322
 11323     IF DCUA-RETURN-CODE EQUAL 'E2'
 11324        MOVE ER-8080               TO WS-ERROR
 11325        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11327        GO TO 3024-EDIT-DL7-CONT.
 11328
 11329     IF DCUA-RETURN-CODE EQUAL 'E3'
 11330        MOVE ER-8098               TO WS-ERROR
 11331        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11333        GO TO 3024-EDIT-DL7-CONT.
 11334
 11335     IF DCUA-RETURN-CODE EQUAL 'C1'
 11336        MOVE ER-8099               TO WS-ERROR
 11337        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11339        GO TO 3024-EDIT-DL7-CONT.
 11340
 11341     IF DCUA-RETURN-CODE EQUAL 'U1'
 11342        MOVE ER-8109               TO WS-ERROR
 11343        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11345        GO TO 3024-EDIT-DL7-CONT.
 11346
 11347     IF DCUA-RETURN-CODE EQUAL 'N1'
 11348        MOVE ER-8112               TO WS-ERROR
 11349        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11350        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11351        GO TO 3024-EDIT-DL7-CONT.
 11352
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 206
* EL050.cbl
 11353     IF DCUA-RETURN-CODE EQUAL 'N2'
 11354        MOVE ER-8113               TO WS-ERROR
 11355        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357        GO TO 3024-EDIT-DL7-CONT.
 11358
 11359     IF DCUA-RETURN-CODE EQUAL 'N3'
 11360        MOVE ER-8114               TO WS-ERROR
 11361        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363        GO TO 3024-EDIT-DL7-CONT.
 11364
 11365     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11366     MOVE ER-8097                  TO WS-ERROR.
 11367     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11368     GO TO 3024-EDIT-DL7-CONT.
 11369
 11370 3024-EDIT-DL7-CONT.
 11371
 11372     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11373     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11374     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11375        NEXT SENTENCE
 11376     ELSE
 11377        MOVE ER-9263               TO WS-ERROR
 11378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11379
 11380******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11381******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11382     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11383        NEXT SENTENCE
 11384     ELSE
 11385        MOVE ER-8039               TO WS-ERROR
 11386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11387
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 207
* EL050.cbl
 11389****************************************************************
 11390*** VALIDATE STATE  : DLO022                                 ***
 11391****************************************************************
 11392     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11393     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11394
 11395     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11396     IF DVSC-SUCCESSFUL-EDIT
 11397        GO TO 3024-EDIT-DL22-CONT.
 11398
 11399     IF DVSC-RETURN-CODE EQUAL '01'
 11400        MOVE ER-8300               TO WS-ERROR
 11401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11402        GO TO 3024-EDIT-DL22-CONT.
 11403
 11404     IF DVSC-RETURN-CODE EQUAL '02'
 11405        MOVE ER-8301               TO WS-ERROR
 11406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11407        GO TO 3024-EDIT-DL22-CONT.
 11408
 11409     IF DVSC-RETURN-CODE EQUAL '03'
 11410        MOVE ER-8302               TO WS-ERROR
 11411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11412        GO TO 3024-EDIT-DL22-CONT.
 11413
 11414     IF DVSC-RETURN-CODE EQUAL 'N1'
 11415        MOVE ER-8304               TO WS-ERROR
 11416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11417        GO TO 3024-EDIT-DL22-CONT.
 11418
 11419     MOVE ER-8303                  TO WS-ERROR
 11420     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11421
 11422 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 208
* EL050.cbl
 11424****************************************************************
 11425*** VALIDATE LOAN OFFICER : DLO021                           ***
 11426****************************************************************
 11427
 11428     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11429     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11430     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11431     IF DVLO-SUCCESSFUL-EDIT
 11432        GO TO 3024-EDIT-DL21-CONT.
 11433
 11434     IF DVLO-RETURN-CODE EQUAL '01'
 11435        MOVE ER-8081               TO WS-ERROR
 11436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11437        GO TO 3024-EDIT-DL21-CONT.
 11438
 11439     IF DVLO-RETURN-CODE EQUAL '02'
 11440        MOVE ER-8082               TO WS-ERROR
 11441        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11442        GO TO 3024-EDIT-DL21-CONT.
 11443
 11444     IF DVLO-RETURN-CODE EQUAL '03'
 11445        MOVE ER-8083               TO WS-ERROR
 11446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11447        GO TO 3024-EDIT-DL21-CONT.
 11448
 11449     IF DVLO-RETURN-CODE EQUAL '04'
 11450        MOVE ER-8084               TO WS-ERROR
 11451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11452        GO TO 3024-EDIT-DL21-CONT.
 11453
 11454     IF DVLO-RETURN-CODE EQUAL '05'
 11455        MOVE ER-8085               TO WS-ERROR
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11457        GO TO 3024-EDIT-DL21-CONT.
 11458
 11459     MOVE ER-7825                  TO WS-ERROR
 11460     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11461     GO TO 3024-EDIT-DL21-CONT.
 11462
 11463 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 209
* EL050.cbl
 11465
 11466****************************************************************
 11467*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11468****************************************************************
 11469
 11470     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11471     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11472     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11473     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11474     IF DIPF-SUCCESSFUL-EDIT
 11475        GO TO 3024-EDIT-DL02-CONT.
 11476
 11477     IF DIPF-RETURN-CODE EQUAL '01'
 11478        MOVE ER-8086               TO WS-ERROR
 11479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11480        GO TO 3024-EDIT-DL02-CONT.
 11481
 11482     IF DIPF-RETURN-CODE EQUAL '02'
 11483        MOVE ER-8087               TO WS-ERROR
 11484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11485        GO TO 3024-EDIT-DL02-CONT.
 11486
 11487     IF DIPF-RETURN-CODE EQUAL '03'
 11488        MOVE ER-8088               TO WS-ERROR
 11489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11490        GO TO 3024-EDIT-DL02-CONT.
 11491
 11492     MOVE ER-8095                  TO WS-ERROR
 11493     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11494     GO TO 3024-EDIT-DL02-CONT.
 11495
 11496 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 210
* EL050.cbl
 11498
 11499****************************************************************
 11500*** VALIDATE BANK ID : DLO003                                ***
 11501****************************************************************
 11502
 11503     MOVE WK-GREG-CENT           TO WCG-CENT.
 11504     MOVE WK-GREG-YYMM           TO WCG-REST.
 11505     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11506        MOVE ER-8040               TO WS-ERROR
 11507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11508
 11509     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11510     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11511     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11512     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11513     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11514     IF DVBI-SUCCESSFUL-EDIT
 11515        GO TO 3024-EDIT-DL03-CONT.
 11516
 11517     IF DVBI-RETURN-CODE EQUAL '01'
 11518        MOVE ER-8089               TO WS-ERROR
 11519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11520        GO TO 3024-EDIT-DL03-CONT.
 11521
 11522     IF DVBI-RETURN-CODE EQUAL '02'
 11523        MOVE ER-8090               TO WS-ERROR
 11524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11525        GO TO 3024-EDIT-DL03-CONT.
 11526
 11527     IF DVBI-RETURN-CODE EQUAL '03'
 11528        MOVE ER-8091               TO WS-ERROR
 11529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11530        GO TO 3024-EDIT-DL03-CONT.
 11531
 11532     IF DVBI-RETURN-CODE EQUAL '04'
 11533        MOVE ER-8092               TO WS-ERROR
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535        GO TO 3024-EDIT-DL03-CONT.
 11536
 11537     IF DVBI-RETURN-CODE EQUAL '05'
 11538        MOVE ER-8093               TO WS-ERROR
 11539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11540        GO TO 3024-EDIT-DL03-CONT.
 11541
 11542     IF DVBI-RETURN-CODE EQUAL '06'
 11543        MOVE ER-8094               TO WS-ERROR
 11544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11545        GO TO 3024-EDIT-DL03-CONT.
 11546
 11547     MOVE ER-8096                  TO WS-ERROR
 11548     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11549     GO TO 3024-EDIT-DL03-CONT.
 11550
 11551 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 211
* EL050.cbl
 11553
 11554     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11555        NEXT SENTENCE
 11556     ELSE
 11557        MOVE ER-8042               TO WS-ERROR
 11558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11559
 11560     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11561     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11562     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11563
 11564     IF DMPF-RETURN-CODE = '01'
 11565        MOVE ER-8067               TO WS-ERROR
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567        GO TO 3024-EDIT-DL01-CONT.
 11568
 11569     IF DMPF-RETURN-CODE = '02'
 11570        MOVE ER-8068               TO WS-ERROR
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL01-CONT.
 11573
 11574     IF DMPF-RETURN-CODE = '03'
 11575        MOVE ER-8069               TO WS-ERROR
 11576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11577        GO TO 3024-EDIT-DL01-CONT.
 11578
 11579     IF DMPF-RETURN-CODE = 'E1'
 11580        MOVE ER-8070               TO WS-ERROR
 11581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        GO TO 3024-EDIT-DL01-CONT.
 11583
 11584     IF DMPF-RETURN-CODE = 'N1'
 11585        MOVE ER-8071               TO WS-ERROR
 11586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587        GO TO 3024-EDIT-DL01-CONT.
 11588
 11589     IF DMPF-RETURN-CODE NOT = 'OK'
 11590        MOVE ER-8072               TO WS-ERROR
 11591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11592
 11593 3024-EDIT-DL01-CONT.
 11594******************************************************************
 11595***  VALIDATES RATE CODES : DLO017                             ***
 11596******************************************************************
 11597
 11598      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11599      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11600      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11601      IF DVRC-SUCCESSFUL-EDIT
 11602        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11603        GO TO 3024-CHECK-VALID-RATE.
 11604
 11605      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11606
 11607      IF DVRC-RETURN-CODE EQUAL '01'
 11608         MOVE ER-7817                   TO WS-ERROR
 11609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11610         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 212
* EL050.cbl
 11611
 11612      IF DVRC-RETURN-CODE EQUAL '02'
 11613         MOVE ER-7818                   TO WS-ERROR
 11614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615         GO TO 3025-EDIT-REINSURANCE.
 11616
 11617      IF DVRC-RETURN-CODE EQUAL '03'
 11618         MOVE ER-7819                   TO WS-ERROR
 11619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620         GO TO 3025-EDIT-REINSURANCE.
 11621
 11622       MOVE ER-7820                     TO WS-ERROR.
 11623       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11624       GO TO 3025-EDIT-REINSURANCE.
 11625
 11626******************************************************************
 11627***  GET PREMIUM RATES : DLO011                                ***
 11628******************************************************************
 11629
 11630 3024-CHECK-VALID-RATE.
 11631
 11632     IF VALID-RATE-CODE
 11633        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11634        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11635        MOVE SPACES                TO DPRB-RETURN-CODE
 11636        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11637     ELSE
 11638         GO TO 3025-EDIT-REINSURANCE.
 11639
 11640      IF DPRB-SUCCESSFUL-PROCESS
 11641         IF PB-VALID-LIFE
 11642             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11643             GO TO 3025-EDIT-REINSURANCE
 11644         ELSE
 11645             IF PB-VALID-AH
 11646                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11647                 GO TO 3025-EDIT-REINSURANCE.
 11648
 11649      IF DPRB-RETURN-CODE EQUAL '01'
 11650         MOVE ER-7812                   TO WS-ERROR
 11651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11652         GO TO 3025-EDIT-REINSURANCE.
 11653
 11654      IF DPRB-RETURN-CODE EQUAL '02'
 11655         MOVE ER-7813                   TO WS-ERROR
 11656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11657         GO TO 3025-EDIT-REINSURANCE.
 11658
 11659      IF DPRB-RETURN-CODE EQUAL '03'
 11660         MOVE ER-7814                   TO WS-ERROR
 11661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11662         GO TO 3025-EDIT-REINSURANCE.
 11663
 11664      IF DPRB-RETURN-CODE EQUAL '04'
 11665         IF NOT DPRB-1ST-TIME
 11666            MOVE ER-7815                   TO WS-ERROR
 11667            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11668            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 213
* EL050.cbl
 11669          ELSE
 11670         IF PB-VALID-LIFE
 11671            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11672          ELSE
 11673            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11674         END-IF
 11675         MOVE SPACES                TO DOCC-RETURN-CODE
 11676         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11677         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11678         IF DOCC-RETURN-CODE = 'OK'
 11679             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11680             GO TO 3024-CHECK-VALID-RATE
 11681           ELSE
 11682             MOVE ER-7823               TO WS-ERROR
 11683             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11684             GO TO 3025-EDIT-REINSURANCE.
 11685
 11686       MOVE ER-7816                     TO WS-ERROR.
 11687       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11688       GO TO 3025-EDIT-REINSURANCE.
 11689
 11690**********   DMD CUSTOM CODE ABOVE    **********
 11691
 11692 3025-EDIT-REINSURANCE.
 11693     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11694         GO TO 3027-EDIT-CONTINUE.
 11695
 11696     MOVE LOW-VALUES               TO ERREIN-KEY.
 11697     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11698     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11699                                      REIN-CODE-2
 11700                                      REIN-CODE-3.
 11701     MOVE 'A'                      TO REIN-TYPE.
 11702
 11703     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11704
 11705     MOVE '3026' TO REIN-SW.
 11706     MOVE ' '                   TO WS-REIN-READ-SW.
 11707
 11708     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11709     IF REIN-TABLE-NOT-FOUND
 11710         GO TO 3026-NO-SPEC-TABLE.
 11711
 11712     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11713     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11714                                   WS-NSP-ST-CD-LF.
 11715     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11716                                   WS-NSP-ST-CD-AH.
 11717
 11718     GO TO 3040-EDIT-CONTINUE.
 11719
 11720 3026-NO-SPEC-TABLE.
 11721
 11722     MOVE ER-2664                TO WS-ERROR.
 11723     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11724     GO TO 3040-EDIT-CONTINUE.
 11725
 11726 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 214
* EL050.cbl
 11727
 11728     IF PB-I-REIN-TABLE = SPACES
 11729       GO TO 3040-EDIT-CONTINUE.
 11730
 11731     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11732          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11733          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11734           GO TO 3040-EDIT-CONTINUE.
 11735
 11736     MOVE LOW-VALUES            TO ERREIN-KEY.
 11737     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11738     MOVE 'A'                   TO REIN-TYPE.
 11739     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11740
 11741     MOVE '3028'                TO REIN-SW.
 11742     MOVE ' '                   TO WS-REIN-READ-SW.
 11743
 11744     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11745     IF REIN-TABLE-NOT-FOUND
 11746         GO TO 3028-NO-REIN-TABLE.
 11747
 11748     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11749     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11750                                   WS-NSP-ST-CD-LF.
 11751     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11752                                   WS-NSP-ST-CD-AH.
 11753
 11754     GO TO 3040-EDIT-CONTINUE.
 11755
 11756 3028-NO-REIN-TABLE.
 11757
 11758     MOVE ER-2615                TO WS-ERROR.
 11759     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11760     GO TO 3040-EDIT-CONTINUE.
 11761
 11762 3040-EDIT-CONTINUE.
 11763
 11764     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11765         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11766
 11767     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11768         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11769
 11770     IF (NOT PB-REISSUED-CERT)
 11771        AND (NOT PB-MONTHLY-CERT)
 11772        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11773            MOVE '001'           TO PB-I-LF-TERM
 11774            MOVE 'M'             TO PB-I-INSURED-SEX.
 11775
 11776     IF (NOT PB-REISSUED-CERT)
 11777        AND (NOT PB-MONTHLY-CERT)
 11778        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11779            MOVE '001'           TO PB-I-AH-TERM
 11780            MOVE 'M'             TO PB-I-INSURED-SEX.
 11781
 11782 3040-EDIT-1ST-PMT-DT.
 11783     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11784     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 215
* EL050.cbl
 11785         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11786
 11787******************************************************************
 11788*                                                                *
 11789*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11790*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11791*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11792*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11793*                                                                *
 11794******************************************************************
 11795
 11796     IF PB-EFF-DT-PROCESSING
 11797        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11798                                    PB-I-LF-EXPIRE-DT
 11799                                    PB-I-AH-EXPIRE-DT
 11800        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11801        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11802        MOVE ZERO                TO DC-ELAPSED-DAYS
 11803        MOVE +1                  TO DC-ELAPSED-MONTHS
 11804        SET BIN-PLUS-ELAPSED     TO TRUE
 11805*       MOVE 6                   TO DC-OPTION-CODE
 11806        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11807        IF NO-CONVERSION-ERROR
 11808           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11809
 11810******************************************************************
 11811*                                                                *
 11812*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11813*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11814*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11815*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11816*                                                                *
 11817******************************************************************
 11818
 11819     IF PB-EXT-DAYS-PROCESSING
 11820          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11821                                         PB-I-LF-EXPIRE-DT
 11822                                         PB-I-AH-EXPIRE-DT
 11823          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11824          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11825          MOVE +1                     TO DC-ELAPSED-MONTHS
 11826          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11827          SET BIN-PLUS-ELAPSED        TO TRUE
 11828*         MOVE 6                      TO DC-OPTION-CODE
 11829          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11830          IF NO-CONVERSION-ERROR
 11831             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11832
 11833******************************************************************
 11834*                                                                *
 11835*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11836*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11837*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11838*        (EXPIRE DATE - (TERM -1))  *  -1.
 11839*                                                                *
 11840******************************************************************
 11841
 11842     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 216
* EL050.cbl
 11843        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11844           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11845              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11846              MOVE PB-I-AH-TERM      TO WS-TERM
 11847           ELSE
 11848              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11849              MOVE PB-I-LF-TERM      TO WS-TERM
 11850        ELSE
 11851           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11852              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11853              MOVE PB-I-LF-TERM      TO WS-TERM
 11854           ELSE
 11855              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11856              MOVE PB-I-AH-TERM      TO WS-TERM.
 11857
 11858     IF PB-EXPIRE-DT-PROCESSING
 11859        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11860        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11861        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11862        MOVE ZERO                TO DC-ELAPSED-DAYS
 11863                                    DC-ODD-DAYS-OVER
 11864          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11865          SET BIN-PLUS-ELAPSED    TO TRUE
 11866*         MOVE 6                  TO DC-OPTION-CODE
 11867          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11868          IF NO-CONVERSION-ERROR
 11869             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11870
 11871******************************************************************
 11872*                                                                *
 11873*            1ST PAYMENT DATE PROCESSING                         *
 11874*                                                                *
 11875******************************************************************
 11876
 11877     IF PB-1ST-PMT-DT-PROCESSING
 11878        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11879                                    PB-I-AH-EXPIRE-DT
 11880        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11881
 11882     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11883         NEXT SENTENCE
 11884     ELSE
 11885         MOVE ER-2680                 TO WS-ERROR
 11886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11887         GO TO 3060-ORIG-TERM-CHECK.
 11888
 11889     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11890     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11891     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11892*    MOVE 1                      TO DC-OPTION-CODE.
 11893     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11894                                    DC-ELAPSED-DAYS
 11895                                    DC-ODD-DAYS-OVER.
 11896
 11897     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11898
 11899     IF DATE-CONVERSION-ERROR
 11900        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 217
* EL050.cbl
 11901
 11902     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11903     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11904        AND (WS-LF-COVERAGE-TYPE = 'L')
 11905        IF (DC-ELAPSED-MONTHS > 1)
 11906                      OR
 11907           ((DC-ELAPSED-MONTHS = 1)
 11908           AND (DC-ODD-DAYS-OVER > 0))
 11909           MOVE ER-2882          TO WS-ERROR
 11910           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11911        END-IF
 11912     END-IF
 11913     IF PB-EXT-DAYS-PROCESSING
 11914        CONTINUE
 11915     ELSE
 11916        IF DC-ELAPSED-MONTHS = +0
 11917           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11918        ELSE
 11919           IF (WS-LF-EARNINGS-CALC = '4')
 11920              AND (DC-ELAPSED-MONTHS > ZERO)
 11921              AND (DC-ELAPSED-DAYS > ZERO)
 11922              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11923           ELSE
 11924              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11925                                 THRU 6499-EXIT
 11926              MOVE WS-ODD-DAYS-OVER
 11927                                 TO PB-I-EXTENTION-DAYS
 11928           END-IF
 11929        END-IF
 11930     END-IF
 11931******************************************************************
 11932*                                                                *
 11933*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11934*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11935*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11936*            AND ANY ODD DAYS.                                   *
 11937*                                                                *
 11938******************************************************************
 11939
 11940     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11941                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11942     IF WS-LF-EARNINGS-CALC NOT = '4'
 11943        IF DC-ELAPSED-DAYS > ZEROS
 11944           MOVE ER-2681          TO WS-ERROR
 11945           PERFORM 9900-ERROR-FORMAT
 11946                                 THRU 9900-EXIT
 11947        END-IF
 11948     END-IF
 11949
 11950     IF WS-LF-EARNINGS-CALC NOT = '4'
 11951        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11952           MOVE ER-2681          TO WS-ERROR
 11953           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11954
 11955     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11956        (PB-I-LF-TERM NOT = ZERO) AND
 11957         NOT NO-LIFE-COVERAGE
 11958          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 218
* EL050.cbl
 11959          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11960          IF WS-LF-EARNINGS-CALC = '4'
 11961             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11962             PB-I-PAY-FREQUENCY
 11963          END-IF
 11964          MOVE ZERO              TO DC-ELAPSED-DAYS
 11965                                    DC-ODD-DAYS-OVER
 11966          MOVE 1                 TO DC-END-OF-MONTH
 11967          SET BIN-PLUS-ELAPSED        TO TRUE
 11968*         MOVE 6                 TO DC-OPTION-CODE
 11969          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11970          IF NO-CONVERSION-ERROR
 11971             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11972             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11973                (WS-LF-SPECIAL-CALC-CD = 'L')
 11974                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11975                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11976                  MOVE +1             TO DC-ELAPSED-MONTHS
 11977                  SET BIN-PLUS-ELAPSED  TO TRUE
 11978*                 MOVE 6              TO DC-OPTION-CODE
 11979                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11980                  IF NO-CONVERSION-ERROR
 11981                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11982
 11983* okay, i had to move the new att age edit down here because the
 11984* expiration date could get recalculated and i need the exp date
 11985     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11986        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11987        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11988        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11989           AND ZEROS
 11990           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11991           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11992           SET ELAPSED-BETWEEN-BIN TO TRUE
 11993           PERFORM 8500-DATE-CONVERT
 11994                                 THRU 8500-EXIT
 11995           IF NO-CONVERSION-ERROR
 11996              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11997                 MOVE ER-2669       TO WS-ERROR
 11998*                PERFORM 9900-ERROR-FORMAT
 11999*                                THRU 9900-EXIT
 12000              END-IF
 12001           END-IF
 12002        ELSE
 12003           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12004           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12005              MOVE ER-2669       TO WS-ERROR
 12006*             PERFORM 9900-ERROR-FORMAT
 12007*                                THRU 9900-EXIT
 12008           ELSE
 12009              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12010                 MOVE ER-1570    TO WS-ERROR
 12011                 PERFORM 9900-ERROR-FORMAT
 12012                                 THRU 9900-EXIT
 12013              END-IF
 12014           END-IF
 12015        END-IF
 12016        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 219
* EL050.cbl
 12017           AND ZEROS
 12018           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12019           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12020           SET ELAPSED-BETWEEN-BIN TO TRUE
 12021           PERFORM 8500-DATE-CONVERT
 12022                                 THRU 8500-EXIT
 12023           IF NO-CONVERSION-ERROR
 12024              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12025                 MOVE ER-2669       TO WS-ERROR
 12026*                PERFORM 9900-ERROR-FORMAT
 12027*                                THRU 9900-EXIT
 12028              END-IF
 12029           END-IF
 12030        ELSE
 12031           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12032             (PB-I-LF-TERM / 12)
 12033           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12034              MOVE ER-2669       TO WS-ERROR
 12035*             PERFORM 9900-ERROR-FORMAT
 12036*                                THRU 9900-EXIT
 12037           ELSE
 12038              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12039                 MOVE ER-1571    TO WS-ERROR
 12040                 PERFORM 9900-ERROR-FORMAT
 12041                                 THRU 9900-EXIT
 12042              END-IF
 12043           END-IF
 12044        END-IF
 12045        IF WS-ERROR = ER-2669
 12046           PERFORM 9900-ERROR-FORMAT
 12047                                 THRU 9900-EXIT
 12048        END-IF
 12049     END-IF
 12050     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12051        (PB-I-AH-TERM NOT = ZERO) AND
 12052         NOT NO-AH-COVERAGE
 12053          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12054             AND (PB-COMPANY-ID = 'DCC')
 12055             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12056             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12057          ELSE
 12058             IF WS-LF-EARNINGS-CALC = '4'
 12059                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12060                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12061                PB-I-PAY-FREQUENCY
 12062             ELSE
 12063                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12064                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12065             END-IF
 12066          END-IF
 12067          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12068                                         DC-ODD-DAYS-OVER
 12069          MOVE 1                      TO DC-END-OF-MONTH
 12070          SET BIN-PLUS-ELAPSED        TO TRUE
 12071*         MOVE 6                      TO DC-OPTION-CODE
 12072          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12073          IF NO-CONVERSION-ERROR
 12074             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 220
* EL050.cbl
 12075     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12076        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12077        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12078        IF PB-I-BIRTHDAY > LOW-VALUES
 12079           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12080           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12081           SET ELAPSED-BETWEEN-BIN TO TRUE
 12082           PERFORM 8500-DATE-CONVERT
 12083                                 THRU 8500-EXIT
 12084           IF NO-CONVERSION-ERROR
 12085              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12086                 MOVE ER-3054       TO WS-ERROR
 12087*                PERFORM 9900-ERROR-FORMAT
 12088*                                THRU 9900-EXIT
 12089              END-IF
 12090           END-IF
 12091        ELSE
 12092           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12093           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12094              MOVE ER-3054       TO WS-ERROR
 12095*             PERFORM 9900-ERROR-FORMAT
 12096*                                THRU 9900-EXIT
 12097           END-IF
 12098        END-IF
 12099        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12100           AND ZEROS
 12101           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12102           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12103           SET ELAPSED-BETWEEN-BIN TO TRUE
 12104           PERFORM 8500-DATE-CONVERT
 12105                                 THRU 8500-EXIT
 12106           IF NO-CONVERSION-ERROR
 12107              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12108                 MOVE ER-3054       TO WS-ERROR
 12109*                PERFORM 9900-ERROR-FORMAT
 12110*                                THRU 9900-EXIT
 12111              END-IF
 12112           END-IF
 12113        ELSE
 12114           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12115             (PB-I-AH-TERM / 12)
 12116           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12117              MOVE ER-3054       TO WS-ERROR
 12118*             PERFORM 9900-ERROR-FORMAT
 12119*                                THRU 9900-EXIT
 12120           END-IF
 12121        END-IF
 12122        IF WS-ERROR = ER-3054
 12123           PERFORM 9900-ERROR-FORMAT
 12124                                 THRU 9900-EXIT
 12125        END-IF
 12126     END-IF
 12127     MOVE SPACE                       TO DC-END-OF-MONTH.
 12128
 12129     IF PB-COMPANY-ID = 'NCB'
 12130        GO TO 3040-EDIT-EXTENSION-DAYS.
 12131
 12132     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 221
* EL050.cbl
 12133       AND
 12134        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12135        NEXT SENTENCE
 12136     ELSE
 12137        GO TO 3040-EDIT-EXTENSION-DAYS.
 12138
 12139     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12140        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12141        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12142     ELSE
 12143        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12144        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12145
 12146     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12147*    MOVE '1'      TO DC-OPTION-CODE
 12148     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12149     IF (NO-CONVERSION-ERROR)
 12150        AND (DC-ELAPSED-MONTHS > +1)
 12151        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12152        MOVE ER-2668   TO WS-ERROR
 12153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12154
 12155 3040-EDIT-EXTENSION-DAYS.
 12156
 12157     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12158        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12159         GO TO 3050-EDIT-TERM-IN-DAYS
 12160     ELSE
 12161         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12162
 12163     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12164         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12165     ELSE
 12166        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12167           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12168           MOVE ER-2681         TO WS-ERROR
 12169           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12170
 12171     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12172        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12173        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12174         GO TO 3060-ORIG-TERM-CHECK.
 12175
 12176     GO TO 3060-ORIG-TERM-CHECK.
 12177
 12178 3050-EDIT-TERM-IN-DAYS.
 12179
 12180     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12181
 12182     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12183         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12184     ELSE
 12185         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12186            MOVE ER-2682         TO WS-ERROR
 12187            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12188
 12189     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12190                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 222
* EL050.cbl
 12191     IF WS-WORK-TERM GREATER THAN ZERO
 12192         ADD +1 TO PB-I-LF-TERM.
 12193
 12194     IF NOT NO-AH-COVERAGE
 12195         MOVE ER-2684            TO WS-ERROR
 12196         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12197
 12198
 12199 3060-ORIG-TERM-CHECK.
 12200
 12201******************************************************************
 12202*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12203******************************************************************
 12204
 12205     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12206        NEXT SENTENCE
 12207     ELSE
 12208        IF NOT NO-LIFE-COVERAGE
 12209           IF PB-I-LF-TERM NUMERIC
 12210              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12211              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12212              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12213                  NEXT SENTENCE
 12214           ELSE
 12215              MOVE ER-2647       TO WS-ERROR
 12216              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12217
 12218     IF NOT NO-AH-COVERAGE
 12219         IF PB-I-AH-TERM NUMERIC
 12220            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12221            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12222            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12223             NEXT SENTENCE
 12224          ELSE
 12225              MOVE ER-2658       TO WS-ERROR
 12226              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12227
 12228     IF PB-COMPANY-ID = 'NCB'
 12229        GO TO 3070-LOAN-TERM-CHECK.
 12230
 12231     IF POLICY-HAS-AH
 12232       AND
 12233        POLICY-HAS-LIFE
 12234       AND
 12235        PB-I-LF-TERM NUMERIC
 12236       AND
 12237        PB-I-AH-TERM NUMERIC
 12238        NEXT SENTENCE
 12239     ELSE
 12240        GO TO 3070-LOAN-TERM-CHECK.
 12241
 12242     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12243     IF WS-TEX-FACT-2 LESS THAN +0
 12244        MULTIPLY +1 BY WS-TEX-FACT-2.
 12245
 12246     IF WS-TEX-FACT-2 GREATER THAN +1
 12247        MOVE ER-2668             TO WS-ERROR
 12248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 223
* EL050.cbl
 12249
 12250 3070-LOAN-TERM-CHECK.
 12251
 12252     IF (WS-LF-BENEFIT-CD = ZERO)
 12253         OR (NO-LF-BENEFIT-MATCH)
 12254            GO TO 3125-EDIT-PMT-FREQ.
 12255*    IF PB-COMPANY-ID NOT = 'DCC'
 12256*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12257*          AND 'V' AND 'W' AND 'X'
 12258*          GO TO 3125-EDIT-PMT-FREQ
 12259*       END-IF
 12260*    ELSE
 12261*       IF WS-AH-DCC-TRUNC = 'T'
 12262*          CONTINUE
 12263*       ELSE
 12264*          GO TO 3125-EDIT-PMT-FREQ
 12265*       END-IF
 12266*    END-IF
 12267     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12268                    OR
 12269        ((PB-COMPANY-ID = 'DCC')
 12270        AND (WS-AH-DCC-TRUNC = 'T'))
 12271        CONTINUE
 12272     ELSE
 12273        GO TO 3125-EDIT-PMT-FREQ
 12274     END-IF
 12275     IF PB-I-LOAN-TERM NOT NUMERIC
 12276         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12277
 12278     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12279        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12280        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12281        PB-I-LOAN-TERM NOT GREATER THAN +360
 12282         NEXT SENTENCE
 12283     ELSE
 12284         MOVE ER-2648            TO WS-ERROR
 12285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12286
 12287     IF WS-STATE-ABBREVIATION = 'NC'
 12288        IF PB-I-LOAN-TERM > +59
 12289           CONTINUE
 12290        ELSE
 12291           MOVE ER-2792          TO WS-ERROR
 12292           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12293        END-IF
 12294     END-IF
 12295
 12296     .
 12297 3125-EDIT-PMT-FREQ.
 12298     IF (WS-LF-BENEFIT-CD = ZERO)
 12299         OR (NO-LF-BENEFIT-MATCH)
 12300            GO TO 3127-EDIT-LOAN-OFFICER.
 12301     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12302                    OR
 12303        ((PB-COMPANY-ID = 'DCC')
 12304        AND (WS-AH-DCC-TRUNC = 'T'))
 12305                    OR
 12306         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 224
* EL050.cbl
 12307        CONTINUE
 12308     ELSE
 12309        IF (PB-I-LOAN-TERM > ZEROS)
 12310           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12311           MOVE ER-1575          TO WS-ERROR
 12312           PERFORM 9900-ERROR-FORMAT
 12313                                 THRU 9900-EXIT
 12314        END-IF
 12315     END-IF
 12316     IF WS-LF-EARNINGS-CALC NOT = '4'
 12317         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12318            MOVE ER-2653         TO WS-ERROR
 12319            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12320            GO TO 3127-EDIT-LOAN-OFFICER
 12321         ELSE
 12322            GO TO 3127-EDIT-LOAN-OFFICER.
 12323
 12324     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12325         MOVE ER-2655            TO WS-ERROR
 12326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12327         GO TO 3127-EDIT-LOAN-OFFICER.
 12328
 12329     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12330         MOVE ER-2654            TO WS-ERROR
 12331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12332         GO TO 3127-EDIT-LOAN-OFFICER.
 12333
 12334     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12335         GIVING WS-TEX-FACT-2
 12336             REMAINDER WS-TEX-FACT-3.
 12337
 12338*    IF WS-TEX-FACT-3 NOT = ZERO
 12339*       MOVE ER-2654             TO WS-ERROR
 12340*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12341
 12342
 12343 3127-EDIT-LOAN-OFFICER.
 12344
 12345     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12346        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12347           MOVE ER-2690          TO WS-ERROR
 12348           PERFORM 9900-ERROR-FORMAT
 12349                                 THRU 9900-EXIT
 12350        ELSE
 12351           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12352           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12353           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12354           MOVE PB-SV-STATE      TO LOFC-STATE
 12355           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12356           MOVE PB-I-LOAN-OFFICER
 12357                                 TO LOFC-CODE
 12358           PERFORM 8586-READ-LOAN-OFFICER
 12359                                 THRU 8586-EXIT
 12360           IF (NOT LOFC-MASTER-FOUND)
 12361              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12362              MOVE ER-3006       TO WS-ERROR
 12363              PERFORM 9900-ERROR-FORMAT
 12364                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 225
* EL050.cbl
 12365           END-IF
 12366        END-IF
 12367     END-IF
 12368     .
 12369 3129-EDIT-APR.
 12370
 12371     IF (WS-LF-BENEFIT-CD = ZERO)
 12372        OR (NO-LF-BENEFIT-MATCH)
 12373        IF PB-COMPANY-ID NOT = 'DCC'
 12374           GO TO 3130-EDIT-AGE
 12375*       ELSE
 12376*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12377*             GO TO 3130-EDIT-AGE
 12378*          END-IF
 12379        END-IF
 12380     END-IF
 12381
 12382     IF (WS-STATE-ABBREVIATION = 'OH')
 12383         AND (PB-I-RATE-CLASS NOT = 'L ')
 12384         AND (PB-I-LF-TERM GREATER THAN 60)
 12385         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12386         GO TO 3129-APR-CONT.
 12387
 12388     IF (WS-STATE-ABBREVIATION = 'RI')
 12389         AND (PB-I-LF-TERM GREATER THAN 60)
 12390         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12391         GO TO 3129-APR-CONT.
 12392
 12393     IF (WS-STATE-ABBREVIATION = 'UT')
 12394         AND (PB-I-LF-TERM GREATER THAN 62)
 12395         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12396         AND (PB-CERT-EFF-DT LESS WS-830901)
 12397         GO TO 3129-APR-CONT.
 12398
 12399     IF PB-COMPANY-ID = 'LAP'
 12400        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12401           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12402              MOVE ER-2656         TO WS-ERROR
 12403              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12404              GO TO 3130-EDIT-AGE.
 12405
 12406     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12407        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12408        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12409        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12410        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12411        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12412         GO TO 3130-EDIT-AGE.
 12413
 12414 3129-APR-CONT.
 12415     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12416         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12417         GO TO 3130-EDIT-AGE.
 12418
 12419     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12420         WS-AH-BENEFIT-CD (1:1) = 'S')
 12421        AND (PB-COMPANY-ID = 'DCC')
 12422        AND (PB-I-LOAN-APR = ZERO)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 226
* EL050.cbl
 12423        MOVE ER-2657             TO WS-ERROR
 12424        PERFORM 9900-ERROR-FORMAT
 12425                                 THRU 9900-EXIT
 12426        GO TO 3130-EDIT-AGE
 12427     END-IF
 12428     IF PB-I-LOAN-APR = ZERO
 12429        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12430     END-IF
 12431
 12432     IF PB-I-LOAN-APR = ZERO
 12433        MOVE ER-2656             TO WS-ERROR
 12434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12435        GO TO 3130-EDIT-AGE.
 12436
 12437*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12438     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12439        MOVE ER-2657             TO WS-ERROR
 12440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12441
 12442 3130-EDIT-AGE.
 12443
 12444******************************************************************
 12445*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12446******************************************************************
 12447
 12448     IF NOT NO-LIFE-COVERAGE
 12449        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12450           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12451               MOVE ER-2628             TO WS-ERROR
 12452               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12453
 12454     IF NOT NO-AH-COVERAGE
 12455        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12456           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12457               MOVE ER-2628         TO WS-ERROR
 12458               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12459
 12460 3133-SEX-CODE.
 12461     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12462         IF WS-DEFAULT-SEX = 'M'
 12463             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12464          ELSE
 12465             IF WS-DEFAULT-SEX = 'F'
 12466             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12467
 12468     IF PB-I-INSURED-SEX = '1'
 12469         MOVE 'M' TO PB-I-INSURED-SEX.
 12470
 12471     IF PB-I-INSURED-SEX = '2'
 12472         MOVE 'F' TO PB-I-INSURED-SEX.
 12473
 12474 3134-SIG-SW-EDIT.
 12475     IF PB-I-SIG-SW = SPACE
 12476         MOVE 'N'                TO  PB-I-SIG-SW.
 12477
 12478     IF PB-COMPANY-ID = 'NCL'
 12479         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12480             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 227
* EL050.cbl
 12481         ELSE
 12482             MOVE ER-1923        TO  WS-ERROR
 12483             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12484     ELSE
 12485     IF PB-COMPANY-ID = 'CRI'
 12486         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12487             NEXT SENTENCE
 12488         ELSE
 12489             MOVE ER-2606        TO  WS-ERROR
 12490             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12491     ELSE
 12492     IF PB-COMPANY-ID = 'TMS'
 12493         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12494             NEXT SENTENCE
 12495         ELSE
 12496             MOVE ER-2689        TO  WS-ERROR
 12497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12498     ELSE
 12499         IF PB-I-SIG-SW = 'Y' OR 'N'
 12500             NEXT SENTENCE
 12501         ELSE
 12502             MOVE ER-2651        TO  WS-ERROR
 12503             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12504
 12505     IF PB-COMPANY-ID = 'FLA'
 12506         IF (WS-EDIT-AGE GREATER 54  OR
 12507             WS-AH-EDIT-AGE GREATER 54)  AND
 12508            PB-I-SIG-SW = 'N'
 12509            MOVE ER-2651         TO  WS-ERROR
 12510            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12511
 12512 3135-NAME-EDIT.
 12513
 12514     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12515        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12516        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12517           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12518                                 TO PB-I-JOINT-FIRST-NAME
 12519        END-PERFORM
 12520     END-IF
 12521     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12522        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12523        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12524           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12525                                 TO PB-I-JOINT-LAST-NAME
 12526        END-PERFORM
 12527     END-IF
 12528     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12529        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12530        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12531           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12532                                 TO PB-I-INSURED-FIRST-NAME
 12533        END-PERFORM
 12534     END-IF
 12535     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12536        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12537        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12538           MOVE PB-I-INSURED-LAST-NAME (2:14)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 228
* EL050.cbl
 12539                                 TO PB-I-INSURED-LAST-NAME
 12540        END-PERFORM
 12541     END-IF
 12542     IF PB-I-INSURED-LAST-NAME = SPACES
 12543       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12544       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12545           MOVE ER-2660    TO WS-ERROR
 12546           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12547
 12548 3136-EDIT-SEX.
 12549
 12550******************************************************************
 12551*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12552******************************************************************
 12553
 12554     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12555        (WS-AH-SPECIAL-CALC-CD = 'O')
 12556        NEXT SENTENCE
 12557     ELSE
 12558        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12559           NEXT SENTENCE
 12560        ELSE
 12561           MOVE ER-2629            TO WS-ERROR
 12562           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12563
 12564 3137-EDIT-EFF-DATE.
 12565
 12566     IF PB-REISSUED-CERT       OR
 12567        PB-POLICY-IS-DECLINED  OR
 12568        PB-POLICY-IS-VOIDED
 12569         GO TO 3139-EDIT-COVERAGE-CODES.
 12570
 12571     MOVE SPACE                  TO WS-2671-SW
 12572                                    WS-2672-SW.
 12573
 12574     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12575         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12576             MOVE ER-2703        TO WS-ERROR
 12577             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12578             GO TO 3139-EDIT-COVERAGE-CODES.
 12579
 12580     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12581         GO TO 3139-EDIT-COVERAGE-CODES.
 12582
 12583     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12584     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12585*    MOVE '1'                    TO DC-OPTION-CODE.
 12586     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12587     MOVE +0                     TO DC-ELAPSED-MONTHS
 12588                                    DC-ELAPSED-DAYS.
 12589     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12590
 12591     IF DATE-CONVERSION-ERROR
 12592         GO TO 3139-EDIT-COVERAGE-CODES.
 12593
 12594     IF DC-ELAPSED-DAYS GREATER +180
 12595         MOVE ER-2672            TO WS-ERROR
 12596         MOVE 'Y'                TO WS-2672-SW
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 229
* EL050.cbl
 12597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12598     END-IF
 12599
 12600     IF WS-ERROR = ER-2671  AND
 12601        PB-COMPANY-ID  = 'LBL'
 12602        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12603        MOVE SPACE               TO WS-2671-SW
 12604        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12605
 12606     IF PB-ISSUE-DATE-FORCED  AND
 12607      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12608         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12609         MOVE ER-2673            TO WS-ERROR
 12610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12611         MOVE SPACE              TO WS-2671-SW
 12612                                    WS-2672-SW.
 12613
 12614     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12615         IF PB-ISSUE-DATE-FORCED
 12616             MOVE ER-2600          TO  WS-ERROR
 12617             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12618         ELSE
 12619             MOVE ER-2692          TO  WS-ERROR
 12620             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12621
 12622
 12623 3139-EDIT-COVERAGE-CODES.
 12624
 12625     if pb-company-id not = 'AHL'
 12626        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12627           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12628           MOVE ER-2787          TO WS-ERROR
 12629           PERFORM 9900-ERROR-FORMAT
 12630                                 THRU 9900-EXIT
 12631        END-IF
 12632     end-if
 12633     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12634        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12635                                 > 250000.00
 12636           MOVE ER-2719          TO WS-ERROR
 12637           PERFORM 9900-ERROR-FORMAT
 12638                                 THRU 9900-EXIT
 12639        END-IF
 12640     END-IF
 12641
 12642     IF PB-POLICY-IS-DECLINED  OR
 12643        PB-POLICY-IS-VOIDED
 12644         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12645
 12646     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12647        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12648         MOVE ER-2630                TO WS-ERROR
 12649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12650
 12651     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12652        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12653        PB-I-LF-PREMIUM-AMT = ZERO
 12654         GO TO 3140-CHECK-AH-FOR-ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 230
* EL050.cbl
 12655
 12656     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12657        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12658        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12659         GO TO 3140-CHECK-AH-FOR-ZERO.
 12660
 12661     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12662        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12663        MOVE ER-2631             TO WS-ERROR
 12664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12665     END-IF
 12666
 12667
 12668******************************************************************
 12669*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12670******************************************************************
 12671
 12672     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12673        NEXT SENTENCE
 12674     ELSE
 12675        IF PB-I-LF-BENEFIT-AMT = ZERO
 12676           MOVE ER-2632             TO WS-ERROR
 12677           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12678
 12679
 12680******************************************************************
 12681*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12682******************************************************************
 12683
 12684     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12685        CONTINUE
 12686     ELSE
 12687        IF PB-I-LF-PREMIUM-AMT = ZERO
 12688           IF (NOT PB-COMP-LF-PREM)
 12689              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12690              MOVE ER-2633       TO WS-ERROR
 12691              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12692           END-IF
 12693        END-IF
 12694     END-IF
 12695     .
 12696 3140-CHECK-AH-FOR-ZERO.
 12697
 12698     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12699        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12700        PB-I-AH-PREMIUM-AMT = ZERO
 12701         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12702
 12703     IF PB-COMPANY-ID = 'CSL'  AND
 12704        PB-I-AH-BENEFIT-CD = ZERO  AND
 12705        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12706        PB-I-AH-PREMIUM-AMT = ZERO
 12707         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12708
 12709     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12710        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12711        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12712         GO TO 3140-EDIT-MAX-AMT-SIZES.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 231
* EL050.cbl
 12713
 12714     IF PB-I-AH-BENEFIT-CD = ZERO
 12715         MOVE ER-2634            TO WS-ERROR
 12716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12717
 12718******************************************************************
 12719*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12720******************************************************************
 12721
 12722     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12723        NEXT SENTENCE
 12724     ELSE
 12725        IF PB-I-AH-BENEFIT-AMT = ZERO
 12726           MOVE ER-2635             TO WS-ERROR
 12727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12728
 12729******************************************************************
 12730*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12731******************************************************************
 12732
 12733     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12734        NEXT SENTENCE
 12735     ELSE
 12736        IF PB-I-AH-PREMIUM-AMT = ZERO
 12737            IF NOT PB-COMP-AH-PREM
 12738                MOVE ER-2636    TO WS-ERROR
 12739                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12740
 12741
 12742 3140-EDIT-MAX-AMT-SIZES.
 12743* CUSTOM CODE FOR CLIENT    'DMD'
 12744     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12745                                     WS-RES-MUNI-TAX
 12746                                     PB-I-STATE-TAX
 12747                                     PB-I-MUNI-TAX.
 12748
 12749     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12750
 12751     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12752        GO TO 3150-RATE-OUTSTAND-BAL.
 12753
 12754     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12755        GO TO 3150-RATE-OUTSTAND-BAL.
 12756
 12757     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12758        GO TO 3150-RATE-OUTSTAND-BAL.
 12759
 12760     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12761                             OR 'RIC')
 12762        GO TO 3150-RATE-OUTSTAND-BAL.
 12763
 12764     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12765        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12766            GO TO 3150-RATE-OUTSTAND-BAL
 12767        ELSE
 12768           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12769               GO TO 3150-RATE-OUTSTAND-BAL.
 12770
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 232
* EL050.cbl
 12771     IF NOT PB-NO-MONTHS-SKIPPED
 12772        GO TO 3150-RATE-OUTSTAND-BAL.
 12773
 12774     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12775        GO TO 3150-RATE-OUTSTAND-BAL.
 12776
 12777     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12778        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12779           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12780             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12781           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12782           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12783              MOVE ER-2693     TO WS-ERROR
 12784              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12785              GO TO 3150-RATE-OUTSTAND-BAL
 12786           ELSE
 12787              GO TO 3150-RATE-OUTSTAND-BAL.
 12788
 12789 3150-RATE-OUTSTAND-BAL.
 12790
 12791* DMD RATING TEST
 12792     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12793         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12794         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12795         MOVE ER-2687                 TO WS-ERROR
 12796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12797         MOVE 'B'                     TO PB-I-OB-FLAG
 12798         GO TO 3260-EDIT-CONTINUE.
 12799
 12800     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12801         IF  WS-ERROR    EQUAL    ER-2693
 12802             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12803                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12804                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12805                 MOVE  +0            TO  WS-ERROR.
 12806
 12807     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12808         IF  WS-ERROR    EQUAL    ER-2693
 12809             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12810                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12811                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12812                 MOVE  +0            TO  WS-ERROR.
 12813
 12814     IF PLAN-MASTER-AH-SW = 'Y'
 12815        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12816            IF  WS-ERROR    EQUAL    ER-2693
 12817              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12818                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12819                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12820                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12821                 MOVE  ER-1910           TO  WS-ERROR
 12822                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12823
 12824     IF PLAN-MASTER-AH-SW = 'Y'
 12825        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12826            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12827               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12828               MOVE  ER-1910           TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 233
* EL050.cbl
 12829               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12830
 12831     IF PLAN-MASTER-AH-SW = 'Y'
 12832        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12833            IF  WS-ERROR    EQUAL    ER-2693
 12834                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12835                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12836                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12837                 MOVE  +0       TO  WS-ERROR.
 12838
 12839     IF WS-ERROR = ER-2693
 12840        IF PB-COMPANY-ID = 'JAL' AND
 12841           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12842           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12843           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12844
 12845     IF WS-ERROR = ER-2693
 12846        IF PB-COMPANY-ID = 'NCL'  AND
 12847           PB-I-AH-BENEFIT-CD = 'OA'
 12848           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12849           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12850
 12851     IF WS-ERROR = ER-2693
 12852        IF PB-COMPANY-ID = 'CNL' AND
 12853           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12854           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12855           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12856
 12857     IF WS-ERROR = ER-2693
 12858        IF PB-COMPANY-ID = 'HER'
 12859           IF WS-LEVEL
 12860              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12861              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12862
 12863     IF ((LF-BENEFIT-FOUND) AND
 12864         (NOT NO-LIFE-COVERAGE)  AND
 12865         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12866       OR   ((AH-BENEFIT-FOUND) AND
 12867             (NOT NO-AH-COVERAGE)    AND
 12868             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12869         NEXT SENTENCE
 12870     ELSE
 12871         GO TO 3215-EDIT-RATES.
 12872
 12873     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12874        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12875           MOVE ER-2674          TO WS-ERROR
 12876           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12877           GO TO 3215-EDIT-RATES.
 12878
 12879     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12880        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12881           MOVE ER-2674          TO WS-ERROR
 12882           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12883           GO TO 3215-EDIT-RATES.
 12884
 12885     MOVE 'B'                    TO PB-I-OB-FLAG.
 12886
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 234
* EL050.cbl
 12887     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12888         NEXT SENTENCE
 12889     ELSE
 12890         IF NOT NO-LIFE-COVERAGE
 12891             IF WS-ACCT-LF-OB-RT = ZERO
 12892                MOVE ER-2641    TO WS-ERROR
 12893                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12894
 12895     IF PB-COMPANY-ID = 'CRI'
 12896       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12897         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12898         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12899         IF WS-ERROR = ER-2675
 12900            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12901            MOVE ER-2687              TO WS-ERROR
 12902            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12903         ELSE
 12904            MOVE ER-2687              TO WS-ERROR
 12905            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12906
 12907
 12908     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12909         NEXT SENTENCE
 12910     ELSE
 12911       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12912            NEXT SENTENCE
 12913       ELSE
 12914         IF NOT NO-AH-COVERAGE
 12915             IF WS-ACCT-AH-OB-RT = ZERO
 12916                MOVE ER-2642    TO WS-ERROR
 12917                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12918
 12919     IF PB-COMPANY-ID = 'CRI'
 12920       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12921         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12922         IF WS-ERROR = ER-2676
 12923            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12924            MOVE ER-2687              TO WS-ERROR
 12925            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12926         ELSE
 12927            MOVE ER-2687              TO WS-ERROR
 12928            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12929
 12930     IF PB-COMPANY-ID NOT = 'GIC'
 12931         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12932            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12933     ELSE
 12934         IF PB-I-LF-PREM-CALC = ZEROS
 12935             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12936                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12937
 12938     IF PB-COMPANY-ID NOT = 'GIC'
 12939         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12940            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12941     ELSE
 12942         IF PB-I-AH-PREM-CALC = ZEROS
 12943             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12944                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 235
* EL050.cbl
 12945
 12946     MOVE ZEROS TO PB-I-MORT-CODE.
 12947
 12948     GO TO 3260-EDIT-CONTINUE.
 12949
 12950
 12951 3215-EDIT-RATES.
 12952     IF ACCOUNT-MAST-FOUND
 12953         NEXT SENTENCE
 12954     ELSE
 12955         GO TO 3999-END-EDIT.
 12956
 12957 3220-CHECK-LF-RATES.
 12958
 12959     IF PB-COMPANY-ID = 'DCC'
 12960        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12961        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12962        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12963           AND (NOT WS-LF-CASH))
 12964                           OR
 12965           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12966           AND (NOT WS-AH-CASH)))
 12967                       AND
 12968           (PB-I-ENTRY-STATUS NOT = '5')
 12969           MOVE 'M'              TO PB-BATCH-ENTRY
 12970                                    PB-I-ENTRY-STATUS
 12971        END-IF
 12972     END-IF
 12973     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12974                                    PB-I-AH-PREM-CALC
 12975                                    PB-I-LF-ALT-PREM-CALC
 12976                                    PB-I-LF-ALT-RATE
 12977                                    PB-I-LF-REI-RATE
 12978                                    PB-I-LF-ALT-REI-RATE
 12979                                    PB-I-AH-REI-RATE
 12980                                    PB-I-TOT-FEES-CALC.
 12981
 12982     IF PB-COMPANY-ID EQUAL 'DMD'
 12983        NEXT SENTENCE
 12984     ELSE
 12985        MOVE ZEROS               TO PB-I-LF-RATE
 12986                                    PB-I-AH-RATE.
 12987
 12988     IF PB-I-TOT-FEES NOT NUMERIC
 12989        MOVE ZEROS               TO PB-I-TOT-FEES
 12990     END-IF
 12991     IF PB-I-LIVES NOT NUMERIC
 12992         MOVE ZERO               TO PB-I-LIVES.
 12993
 12994     IF PB-I-NUM-BILLED NOT NUMERIC
 12995         MOVE ZERO               TO PB-I-NUM-BILLED.
 12996
 12997     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12998        MOVE +0                  TO PB-I-LF-PREM-TAX
 12999     END-IF
 13000
 13001     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13002        MOVE +0                  TO PB-I-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 236
* EL050.cbl
 13003     END-IF
 13004
 13005     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13006        PB-I-PAY-FREQUENCY = ZEROS
 13007            MOVE 12 TO CP-PAY-FREQUENCY
 13008     ELSE
 13009            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13010
 13011     IF PB-I-STATE-TAX NOT NUMERIC
 13012         MOVE ZEROS               TO PB-I-STATE-TAX.
 13013
 13014     IF PB-I-MUNI-TAX NOT NUMERIC
 13015         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13016
 13017     MOVE SPACES                 TO CP-BEN-CATEGORY
 13018     IF PB-COMPANY-ID  = 'CSL'  AND
 13019        PB-I-LF-TERM NOT = ZERO
 13020        COMPUTE WS-PAYMENT-AMT =
 13021             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13022        COMPUTE WS-CSL-AMT1 =
 13023             PB-I-LF-TERM * AM-MAX-MON-BEN
 13024        COMPUTE WS-CSL-AMT2 =
 13025             WS-PAYMENT-AMT * PB-I-LF-TERM
 13026        IF CP-PAY-FREQUENCY NOT = 12
 13027           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13028           MOVE '8' TO WS-CSL-CALC-CD
 13029        ELSE
 13030           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13031              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13032               AM-MAX-TOT-BEN
 13033               MOVE '6' TO WS-CSL-CALC-CD
 13034           ELSE
 13035              IF (WS-CSL-AMT1  GREATER THAN
 13036                 AM-MAX-TOT-BEN) AND
 13037                 (WS-CSL-AMT2  GREATER THAN
 13038                 AM-MAX-TOT-BEN)
 13039                 MOVE '7' TO WS-CSL-CALC-CD
 13040              ELSE
 13041                 MOVE '5' TO WS-CSL-CALC-CD.
 13042
 13043     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13044         NEXT SENTENCE
 13045     ELSE
 13046         GO TO 3300-CHECK-AH-RATES.
 13047
 13048*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13049
 13050     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13051        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13052              OR
 13053           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13054           MOVE ER-2618          TO WS-ERROR
 13055           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13056           GO TO 3300-CHECK-AH-RATES.
 13057
 13058     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13059           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13060                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 237
* EL050.cbl
 13061
 13062     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13063         MOVE ER-2687             TO WS-ERROR
 13064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13065         MOVE 'Z000'              TO PB-I-MORT-CODE
 13066         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13067         GO TO 3300-CHECK-AH-RATES.
 13068
 13069     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13070        IF PB-I-LIVES = ZERO
 13071           MOVE ER-2688          TO WS-ERROR
 13072           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13073
 13074     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13075
 13076     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13077     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13078     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13079     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13080     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13081     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13082     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13083     MOVE '3'                    TO CP-PROCESS-TYPE.
 13084     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13085     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13086
 13087******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13088     IF PB-COMPANY-ID EQUAL 'CDL'
 13089         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13090            CP-EARN-AS-NET-PAY)
 13091             IF PB-CERT-EFF-DT GREATER  WS-931231
 13092                 MOVE '1'        TO CP-EARNING-METHOD.
 13093*******
 13094
 13095     MOVE PB-SV-STATE            TO CP-STATE.
 13096     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13097     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13098     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13099     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13100     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13101                                    CP-RATING-BENEFIT-AMT.
 13102     IF CP-STATE-STD-ABBRV = 'OR'
 13103         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13104                                         PB-I-LF-ALT-BENEFIT-AMT.
 13105     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13106     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13107     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13108     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13109     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13110     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13111     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13112     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13113     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13114                                    CP-REMAINING-TERM
 13115                                    CP-LOAN-TERM.
 13116
 13117     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13118         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 238
* EL050.cbl
 13119     ELSE
 13120         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13121             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13122                                           PB-I-LF-PREMIUM-AMT.
 13123
 13124     IF PB-COMPANY-ID EQUAL 'CSL'
 13125        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13126           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13127                                         PB-I-LF-PREMIUM-AMT.
 13128
 13129     IF PB-COMPANY-ID EQUAL 'NCB'
 13130         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13131            CP-EARN-AS-NET-PAY
 13132             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13133                 PB-I-LF-PREMIUM-AMT.
 13134
 13135     IF (CP-TRUNCATED-LIFE)
 13136        or ((pb-company-id = 'AHL')
 13137           and (pb-i-loan-term > pb-i-lf-term))
 13138        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13139
 13140     IF PB-COMPANY-ID EQUAL 'CRI'
 13141        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13142
 13143     IF CP-TERM-IS-DAYS
 13144         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13145     ELSE
 13146         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13147     IF PB-COMPANY-ID = 'DCC'
 13148        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13149        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13150        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13151        IF WS-LF-BEN-CATEGORY = 'D'
 13152           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13153           MOVE PB-I-LIFE-COMMISSION
 13154                                 TO CP-DCC-ACT-COMM
 13155           MOVE WS-LF-BEN-CATEGORY
 13156                                 TO CP-BEN-CATEGORY
 13157        END-IF
 13158        IF (CP-BENEFIT-CD (1:1) = 'P')
 13159           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13160           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13161        END-IF
 13162     END-IF
 13163     IF PB-COMPANY-ID = 'CSL'
 13164         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13165         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13166         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13167
 13168     IF PB-COMPANY-ID = 'CSL'
 13169        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13170
 13171     IF (CP-SPECIAL-CALC-CD = 'H')
 13172        OR (PB-COMPANY-ID = 'DCC')
 13173         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13174                                    TO CP-ALTERNATE-BENEFIT
 13175         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13176
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 239
* EL050.cbl
 13177     IF (PB-COMPANY-ID = 'CID')
 13178        AND (WS-LF-EARNINGS-CALC = 'B')
 13179        AND (CP-STATE-STD-ABBRV = 'MN')
 13180        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13181                                 TO CP-ALTERNATE-BENEFIT
 13182        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13183     END-IF
 13184     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13185     MOVE 'R'                   TO CP-RATE-FILE.
 13186     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13187
 13188     IF CP-ERROR-RATE-NOT-FOUND
 13189        MOVE ER-2641            TO WS-ERROR
 13190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13191        GO TO 3300-CHECK-AH-RATES.
 13192
 13193     IF PB-COMPANY-ID EQUAL 'CRI'
 13194        IF CP-ERROR-NO-LIMITS-CRI
 13195           IF NOT ACCOUNT-LIFE-CHECKED
 13196              MOVE ER-2607      TO WS-ERROR
 13197              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13198
 13199******************************************************************
 13200*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13201*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13202******************************************************************
 13203
 13204* CALC LIFE AGE AT EXPIRATION.
 13205
 13206     COMPUTE WS-AGE-AT-EXPIRE =
 13207          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13208
 13209*    IF PB-STATE = 'CO' OR 'UT'
 13210*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13211*        MOVE 'F'            TO PB-FATAL-FLAG
 13212*        MOVE ER-2709        TO WS-ERROR
 13213*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13214*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13215
 13216*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13217*        MOVE 'X'            TO PB-FATAL-FLAG
 13218*        MOVE ER-2718        TO WS-ERROR
 13219*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13220*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13221
 13222* CALC A & H AGE AT EXPIRATION.
 13223
 13224     COMPUTE WS-AGE-AT-EXPIRE =
 13225          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13226
 13227*    IF PB-STATE = 'CO' OR 'UT'
 13228*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13229*        MOVE 'F'            TO PB-FATAL-FLAG
 13230*        MOVE ER-2709        TO WS-ERROR
 13231*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13232*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13233
 13234*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 240
* EL050.cbl
 13235*        MOVE 'X'            TO PB-FATAL-FLAG
 13236*        MOVE ER-2718        TO WS-ERROR
 13237*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13238*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13239
 13240     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13241        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13242
 13243     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13244        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13245
 13246     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13247        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13248
 13249     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13250         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13251         MOVE ER-2639        TO WS-ERROR
 13252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13253
 13254
 13255******************************************************************
 13256*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13257******************************************************************
 13258
 13259 PREMIUM-EDITING-IS-BYPASSED.
 13260     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13261        AND (CP-R-MAX-ATT-AGE > +0)
 13262        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13263        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13264           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13265           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13266           MOVE '1'              TO DC-OPTION-CODE
 13267           PERFORM 8500-DATE-CONVERT
 13268                                 THRU 8500-EXIT
 13269           IF NO-CONVERSION-ERROR
 13270              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13271                 MOVE ER-2661       TO WS-ERROR
 13272*                PERFORM 9900-ERROR-FORMAT
 13273*                                THRU 9900-EXIT
 13274              END-IF
 13275           END-IF
 13276        ELSE
 13277           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13278           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13279              MOVE ER-2661       TO WS-ERROR
 13280*             PERFORM 9900-ERROR-FORMAT
 13281*                                THRU 9900-EXIT
 13282           ELSE
 13283              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13284                 MOVE ER-1570    TO WS-ERROR
 13285                 PERFORM 9900-ERROR-FORMAT
 13286                                 THRU 9900-EXIT
 13287              END-IF
 13288           END-IF
 13289        END-IF
 13290        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13291           MOVE PB-I-JOINT-BIRTHDAY
 13292                                 TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 241
* EL050.cbl
 13293           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13294           MOVE '1'              TO DC-OPTION-CODE
 13295           PERFORM 8500-DATE-CONVERT
 13296                                 THRU 8500-EXIT
 13297           IF NO-CONVERSION-ERROR
 13298              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13299                 MOVE ER-2661       TO WS-ERROR
 13300*                PERFORM 9900-ERROR-FORMAT
 13301*                                THRU 9900-EXIT
 13302              END-IF
 13303           ELSE
 13304              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13305           END-IF
 13306        ELSE
 13307           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13308             (PB-I-LF-TERM / 12)
 13309           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13310              MOVE ER-2661       TO WS-ERROR
 13311*             PERFORM 9900-ERROR-FORMAT
 13312*                                THRU 9900-EXIT
 13313           ELSE
 13314              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13315                 MOVE ER-1571    TO WS-ERROR
 13316                 PERFORM 9900-ERROR-FORMAT
 13317                                 THRU 9900-EXIT
 13318              END-IF
 13319           END-IF
 13320        END-IF
 13321        IF WS-ERROR = ER-2661
 13322           PERFORM 9900-ERROR-FORMAT
 13323                                 THRU 9900-EXIT
 13324        END-IF
 13325     END-IF
 13326*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13327*       MOVE ER-2661             TO WS-ERROR
 13328*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13329
 13330     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13331        MOVE ER-2662             TO WS-ERROR
 13332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13333
 13334     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13335        MOVE ER-2677             TO WS-ERROR
 13336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13337
 13338     IF CP-ERROR-LOAN-TERM
 13339        MOVE ER-2648             TO WS-ERROR
 13340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13341
 13342 3221-CHECK-ERROR-RATE-OPEN.
 13343
 13344     IF CP-ERROR-RATE-FILE-NOTOPEN
 13345         GO TO 3990-FILES-NOT-OPEN.
 13346
 13347     IF PB-COMPANY-ID NOT = 'DMD'
 13348        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13349     END-IF
 13350     .
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 242
* EL050.cbl
 13351 3221-CONTINUE.
 13352     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13353                                    WS-DCC-AH-RATE
 13354     IF PB-COMPANY-ID = 'DCC'
 13355        IF WS-LF-BEN-CATEGORY = 'D'
 13356           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13357              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13358        END-IF
 13359     END-IF
 13360     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13361*   X'A4FF' = 12/31/2009
 13362     IF (PB-COMPANY-ID = 'CID')
 13363        AND (WS-LF-EARNINGS-CALC = 'B')
 13364        AND (CP-STATE-STD-ABBRV = 'MN')
 13365        AND (PB-CERT-EFF-DT > X'A4FF')
 13366        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13367     END-IF
 13368     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13369
 13370     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13371     IF (PB-COMPANY-ID = 'DCC')
 13372        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13373        AND (PB-I-POLICY-IS-MONTHLY)
 13374        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13375        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13376     END-IF
 13377     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13378     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13379     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13380     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13381     IF (PB-COMPANY-ID = 'DCC')
 13382        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13383        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13384        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13385        MOVE ER-2786             TO WS-ERROR
 13386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13387     END-IF
 13388
 13389     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13390
 13391******************************************************************
 13392*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13393******************************************************************
 13394     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13395        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13396
 13397     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13398        GO TO 3225-CHECK-ALT-LIFE-RATE
 13399     ELSE
 13400       IF PB-I-LF-RATE = ZERO
 13401          MOVE ER-2641          TO WS-ERROR
 13402          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13403
 13404 3225-CHECK-ALT-LIFE-RATE.
 13405
 13406     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13407        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13408        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 243
* EL050.cbl
 13409         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13410
 13411     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13412         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13413             AND PB-COMPANY-ID NOT = 'DCC')
 13414                   OR
 13415              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13416              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13417              AND PB-COMPANY-ID NOT = 'DCC')
 13418             MOVE ER-2720        TO  WS-ERROR
 13419             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13420             GO TO 3225-RATING-CONT
 13421         ELSE
 13422             GO TO 3225-RATING-CONT.
 13423     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13424        AND (AM-GPCD = 01 OR 06 OR 15)
 13425        MOVE ER-2798             TO WS-ERROR
 13426        PERFORM 9900-ERROR-FORMAT
 13427                                 THRU 9900-EXIT
 13428*       GO TO 3225-RATING-CONT
 13429     END-IF
 13430     IF (PB-COMPANY-ID = 'CID')
 13431        AND (WS-LF-EARNINGS-CALC = 'B')
 13432        AND (CP-STATE-STD-ABBRV = 'MN')
 13433        AND (PB-CERT-EFF-DT > X'A4FF')
 13434        GO TO 3225-RATING-CONT
 13435     END-IF
 13436     IF PB-COMPANY-ID = 'DCC'
 13437        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13438           AND (PB-I-POLICY-IS-MONTHLY)
 13439           GO TO 3225-RATING-CONT
 13440        END-IF
 13441     END-IF
 13442
 13443     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13444        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13445        CP-EARN-AS-REG-BALLOON
 13446        NEXT SENTENCE
 13447     ELSE
 13448        MOVE '2'                 TO CP-EARNING-METHOD.
 13449
 13450 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13451
 13452     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13453
 13454     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13455        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13456        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13457         NEXT SENTENCE
 13458     ELSE
 13459         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13460
 13461     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13462     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13463     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13464                                     CP-RATING-BENEFIT-AMT.
 13465     IF CP-STATE-STD-ABBRV = 'OR'
 13466         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 244
* EL050.cbl
 13467                                         PB-I-LF-ALT-BENEFIT-AMT.
 13468     IF PB-COMPANY-ID = 'DCC'
 13469        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13470     END-IF
 13471     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13472     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13473     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13474                                    CP-REMAINING-TERM
 13475                                    CP-LOAN-TERM.
 13476     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13477        ADD +1                   TO CP-ORIGINAL-TERM
 13478                                    CP-REMAINING-TERM
 13479                                    CP-LOAN-TERM.
 13480
 13481     MOVE 'R'                   TO CP-RATE-FILE.
 13482     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13483
 13484     IF CP-ERROR-RATE-NOT-FOUND
 13485         MOVE ER-2641            TO WS-ERROR
 13486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13487         GO TO 3300-CHECK-AH-RATES.
 13488
 13489     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13490     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13491
 13492     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13493         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13494
 13495     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13496                               + PB-I-LF-ALT-BENEFIT-AMT.
 13497
 13498     IF ACCOUNT-LIFE-CHECKED  OR
 13499        PB-POLICY-IS-VOIDED   OR
 13500        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13501        GO TO 3225-CONTINUE.
 13502
 13503     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13504        GO TO 3225-CONTINUE.
 13505
 13506     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13507                             EC-RT-LF-MAX-TOT-BEN
 13508        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13509        MOVE ER-2639       TO WS-ERROR
 13510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13511
 13512 3225-CONTINUE.
 13513     IF PB-I-LF-ALT-RATE = ZERO
 13514         MOVE ER-2659            TO WS-ERROR
 13515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13516
 13517     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13518        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13519        MOVE ER-2698             TO WS-ERROR
 13520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13521
 13522 3225-RATING-CONT.
 13523
 13524     IF WS-LF-SPECIAL-CALC-CD = 'E'
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 245
* EL050.cbl
 13525         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13526         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13527         IF (PB-COMPANY-ID = 'DCC')
 13528            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13529            CONTINUE
 13530         ELSE
 13531            MOVE ER-2687         TO WS-ERROR
 13532            PERFORM 9900-ERROR-FORMAT
 13533                                 THRU 9900-EXIT
 13534         END-IF
 13535         GO TO 3290-EDIT-LF-REIN-RATE
 13536     END-IF
 13537
 13538* DMD RATING TEST
 13539     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13540         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13541         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13542         MOVE ER-2687                 TO WS-ERROR
 13543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13544         GO TO 3290-EDIT-LF-REIN-RATE.
 13545
 13546 3230-CLIENT-MORT-CD-SPECIALS.
 13547
 13548     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13549     SET BIN-TO-GREG          TO TRUE.
 13550*    MOVE ' '                 TO DC-OPTION-CODE.
 13551     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13552     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13553
 13554 C-POS-3230-MORT-CD.
 13555     IF PB-COMPANY-ID = 'POS' AND
 13556        PB-SV-CARRIER = '2'
 13557         NEXT SENTENCE
 13558     ELSE
 13559         GO TO C-POS-3240-MORT-CD.
 13560
 13561     IF PB-SV-GROUPING = '030'
 13562        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13563         MOVE '2350' TO PB-I-MORT-CODE
 13564      ELSE
 13565         MOVE '3300' TO PB-I-MORT-CODE.
 13566
 13567
 13568 C-POS-3240-MORT-CD.
 13569     IF PB-COMPANY-ID = 'POS' AND
 13570        PB-SV-CARRIER = '1'
 13571         NEXT SENTENCE
 13572     ELSE
 13573         GO TO 3230-CONTINUE.
 13574
 13575     IF PB-SV-STATE = '45' OR '47'
 13576        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13577         MOVE '5200' TO PB-I-MORT-CODE
 13578     ELSE
 13579         MOVE '8300' TO PB-I-MORT-CODE.
 13580
 13581 3230-CONTINUE.
 13582
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 246
* EL050.cbl
 13583     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13584        GO TO 3240-CONTINUE
 13585     END-IF
 13586
 13587     IF PB-CERT-EFF-DT > WS-971231
 13588        GO TO 3240-CONTINUE
 13589     END-IF
 13590
 13591     IF LF-BENEFIT-FOUND AND
 13592        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13593         MOVE 'F250'       TO PB-I-MORT-CODE
 13594     ELSE
 13595         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13596             MOVE '7250'   TO PB-I-MORT-CODE
 13597         ELSE
 13598             MOVE '4251'   TO PB-I-MORT-CODE
 13599         END-IF
 13600     END-IF
 13601
 13602     .
 13603 3240-CONTINUE.
 13604
 13605     IF PB-COMPANY-ID NOT = 'GNL'
 13606         GO TO 3256-CONTINUE.
 13607
 13608     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13609         MOVE 'A300' TO PB-I-MORT-CODE
 13610     ELSE
 13611         MOVE '8350' TO PB-I-MORT-CODE.
 13612
 13613 3256-CONTINUE.
 13614     IF PB-COMPANY-ID NOT = 'ABL'
 13615         GO TO 3260-EDIT-CONTINUE.
 13616
 13617     IF PB-I-LF-TERM GREATER THAN 59
 13618         MOVE 'F550' TO PB-I-MORT-CODE
 13619     ELSE
 13620         MOVE 'E550' TO PB-I-MORT-CODE.
 13621
 13622 3260-EDIT-CONTINUE.
 13623     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13624
 13625 3290-EDIT-LF-REIN-RATE.
 13626     IF LF-REIN-NSP-NOT-USED
 13627         GO TO 3290-RATING-CONT.
 13628
 13629     IF PB-COMPANY-ID = 'DCC'
 13630        GO TO 3290-RATING-CONT.
 13631     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13632     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13633     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13634     MOVE '3'                   TO CP-PROCESS-TYPE.
 13635     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13636
 13637******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13638     IF PB-COMPANY-ID EQUAL 'CDL'
 13639         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13640            CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 247
* EL050.cbl
 13641             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13642*            MOVE SPACE          TO DC-OPTION-CODE
 13643             SET BIN-TO-GREG     TO TRUE
 13644             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13645***  Y2K PROJ 7744
 13646             IF DC-GREG-DATE-CYMD GREATER 19931231
 13647                 MOVE '1'        TO CP-EARNING-METHOD.
 13648***  Y2K PROJ 7744
 13649*******
 13650
 13651     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13652     MOVE PB-SV-STATE           TO CP-STATE.
 13653     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13654     MOVE ZERO                  TO CP-DEVIATION-CODE
 13655                                   CP-RATE-DEV-PCT.
 13656     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13657     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13658                                   CP-RATING-BENEFIT-AMT.
 13659
 13660************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13661     IF PB-COMPANY-ID EQUAL 'NCB'
 13662         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13663            CP-EARN-AS-NET-PAY
 13664             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13665                 PB-I-LF-PREMIUM-AMT.
 13666************
 13667
 13668     IF CP-STATE-STD-ABBRV = 'OR'
 13669         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13670                                         PB-I-LF-ALT-BENEFIT-AMT.
 13671     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13672     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13673     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13674     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13675     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13676     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13677     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13678     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13679                                   CP-REMAINING-TERM
 13680                                   CP-LOAN-TERM.
 13681     IF CP-TRUNCATED-LIFE
 13682        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13683
 13684     IF CP-TERM-IS-DAYS
 13685         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13686     ELSE
 13687         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13688
 13689     IF PB-COMPANY-ID = 'DCC'
 13690        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13691     END-IF
 13692     IF PB-COMPANY-ID NOT = 'TIC'
 13693          MOVE ZERO          TO CP-CLASS-CODE.
 13694
 13695     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13696
 13697     MOVE 'R'                   TO CP-RATE-FILE.
 13698     PERFORM 7000-GET-RATE THRU 7000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 248
* EL050.cbl
 13699
 13700     IF CP-ERROR-RATE-NOT-FOUND
 13701        IF PB-I-OB
 13702           MOVE ER-2625      TO WS-ERROR
 13703           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13704           GO TO 3299-EDIT-CONTINUE
 13705        ELSE
 13706           MOVE ER-2643      TO WS-ERROR
 13707           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13708           GO TO 3299-EDIT-CONTINUE.
 13709
 13710     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13711
 13712     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13713     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13714
 13715     IF PB-I-LF-REI-RATE = ZERO
 13716         MOVE ER-2643        TO WS-ERROR
 13717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13718
 13719 3290-CHECK-ALT-REIN-RATE.
 13720
 13721     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13722        GO TO 3290-RATING-CONT.
 13723
 13724     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13725     MOVE '2'                    TO CP-EARNING-METHOD.
 13726     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13727     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13728     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13729     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13730                                     CP-RATING-BENEFIT-AMT.
 13731     IF CP-STATE-STD-ABBRV = 'OR'
 13732         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13733                                         PB-I-LF-ALT-BENEFIT-AMT.
 13734     IF PB-COMPANY-ID = 'DCC'
 13735        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13736     END-IF
 13737     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13738     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13739     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13740                                    CP-REMAINING-TERM
 13741                                    CP-LOAN-TERM.
 13742     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13743        ADD +1                   TO CP-ORIGINAL-TERM
 13744                                    CP-REMAINING-TERM
 13745                                    CP-LOAN-TERM.
 13746
 13747     MOVE 'R'                   TO CP-RATE-FILE.
 13748     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13749
 13750     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13751
 13752     IF PB-I-LF-ALT-REI-RATE = ZERO
 13753         MOVE ER-2643            TO WS-ERROR
 13754         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13755
 13756 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 249
* EL050.cbl
 13757
 13758     IF PB-I-OB
 13759*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13760        GO TO 3300-CHECK-AH-RATES.
 13761
 13762 3299-EDIT-CONTINUE.
 13763
 13764     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13765         NEXT SENTENCE
 13766     ELSE
 13767         MOVE ER-2620           TO WS-ERROR
 13768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13769
 13770 3300-CHECK-AH-RATES.
 13771     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13772         NEXT SENTENCE
 13773     ELSE
 13774         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13775
 13776     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13777        ((CF-COMPANY-ID = 'DMD') AND
 13778                (NO-DMD-RATING))
 13779         IF (PB-COMPANY-ID = 'DCC')
 13780            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13781            CONTINUE
 13782         ELSE
 13783            MOVE ER-2687         TO WS-ERROR
 13784            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13785         END-IF
 13786         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13787         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13788     END-IF
 13789
 13790     IF PB-I-OB
 13791        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13792
 13793     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13794         MOVE ER-2687             TO WS-ERROR
 13795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13796         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13797         GO TO 3999-END-EDIT.
 13798
 13799*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13800
 13801     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13802        IF PB-I-AH-CRIT-PER = ZERO
 13803           IF PB-COMPANY-ID = 'DCC'
 13804              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13805              CONTINUE
 13806           ELSE
 13807              MOVE ER-2618       TO WS-ERROR
 13808              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13809              GO TO 3999-END-EDIT
 13810           END-IF
 13811        END-IF
 13812     END-IF
 13813     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13814     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 250
* EL050.cbl
 13815     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13816     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13817     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13818     MOVE PB-SV-STATE            TO CP-STATE.
 13819     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13820     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13821     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13822*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13823     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13824     MOVE '3'                    TO CP-PROCESS-TYPE.
 13825     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13826     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13827                                    CP-RATING-BENEFIT-AMT.
 13828     IF PB-COMPANY-ID = 'CID'
 13829               OR
 13830        CP-STATE-STD-ABBRV = 'OR'
 13831         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13832                                         PB-I-AH-TERM.
 13833     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13834        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13835           AND (PB-I-POLICY-IS-MONTHLY)
 13836           MOVE PB-I-LF-BENEFIT-AMT
 13837                                 TO CP-NET-BENEFIT-AMT
 13838           move pb-i-ah-premium-amt to cp-original-premium
 13839        END-IF
 13840     END-IF
 13841     MOVE SPACES                 TO CP-BEN-CATEGORY
 13842     IF PB-COMPANY-ID = 'DCC'
 13843        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13844        EVALUATE TRUE
 13845           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13846              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13847              MOVE PB-I-LF-BENEFIT-AMT
 13848                                 TO CP-RATING-BENEFIT-AMT
 13849              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13850           WHEN WS-AH-BEN-CATEGORY = 'G'
 13851              MOVE PB-I-UNPAID-CASH-PRICE
 13852                                 TO CP-RATING-BENEFIT-AMT
 13853           WHEN WS-AH-BEN-CATEGORY = 'D'
 13854              MOVE WS-AH-PMF-COMM
 13855                                 TO CP-DCC-PMF-COMM
 13856              MOVE PB-I-AH-COMMISSION
 13857                                 TO CP-DCC-ACT-COMM
 13858        END-EVALUATE
 13859     END-IF
 13860     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13861     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13862     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13863     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13864     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13865     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13866     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13867                                    CP-REMAINING-TERM
 13868                                    WS-WORK-TERM.
 13869     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13870
 13871     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13872     SET BIN-TO-GREG             TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 251
* EL050.cbl
 13873*    MOVE ' '                    TO DC-OPTION-CODE.
 13874     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13875     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13876
 13877     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13878     IF NOT VALID-SKIP-CODE
 13879         MOVE ER-2683            TO WS-ERROR
 13880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13881         GO TO 3320-RATE-CONTINUE.
 13882
 13883     IF PB-NO-MONTHS-SKIPPED
 13884         GO TO 3320-RATE-CONTINUE.
 13885
 13886     MOVE SPACE TO NUMBER-OF-MONTHS.
 13887
 13888     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13889         MOVE 'S'                TO SK-MO (6).
 13890     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13891         MOVE 'S'                TO SK-MO (7).
 13892     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13893         MOVE 'S'                TO SK-MO (8).
 13894     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13895         MOVE 'S'                TO SK-MO (9).
 13896     IF PB-I-SKIP-CODE = 'A'
 13897         MOVE 'S'                TO SK-MO (10).
 13898
 13899     MOVE 1                      TO SUB2.
 13900     MOVE PB-I-AH-TERM           TO SUB3.
 13901     MOVE WS-MONTH               TO SUB1.
 13902     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13903     GO TO 3320-RATE-CONTINUE.
 13904
 13905 3310-GET-SKIP-MO.
 13906     IF SUB1 = 13
 13907         MOVE 1                  TO SUB1.
 13908
 13909     IF SK-MO (SUB1) = 'S'
 13910         SUBTRACT 1 FROM WS-WORK-TERM.
 13911
 13912     ADD 1 TO SUB2
 13913              SUB1.
 13914
 13915 3320-RATE-CONTINUE.
 13916
 13917     IF WS-WORK-TERM = ZERO
 13918         MOVE 1                  TO WS-WORK-TERM.
 13919
 13920     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13921                                    CP-LOAN-TERM.
 13922
 13923     IF PB-COMPANY-ID EQUAL 'DMD'
 13924         NEXT SENTENCE
 13925     ELSE
 13926         MOVE ZERO               TO PB-I-AH-RATE
 13927                                    PB-I-AH-REI-RATE.
 13928
 13929
 13930     IF PB-COMPANY-ID EQUAL 'CRI'
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 252
* EL050.cbl
 13931        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13932
 13933     IF PB-COMPANY-ID = 'CSL'
 13934         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13935         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13936         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13937         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13938
 13939     IF PB-COMPANY-ID = 'DCC'
 13940        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13941           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13942              PB-I-RATE-DEV-PCT-LF
 13943        END-IF
 13944        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13945                                 TO CP-ALTERNATE-BENEFIT
 13946        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13947        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13948        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13949     END-IF
 13950     IF (PB-COMPANY-ID = 'CID')
 13951        AND (WS-LF-EARNINGS-CALC = 'B')
 13952        AND (CP-STATE-STD-ABBRV = 'MN')
 13953        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13954     ELSE
 13955        MOVE ' '                 TO CP-AH-BALLOON-SW
 13956     END-IF
 13957     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13958     MOVE 'R'                   TO CP-RATE-FILE.
 13959     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13960
 13961     IF CP-ERROR-RATE-NOT-FOUND
 13962        IF PB-I-OB
 13963           MOVE ER-2624          TO WS-ERROR
 13964           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13965           GO TO 3340-CALCULATE-PREMIUM-AMT
 13966        ELSE
 13967          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13968              NEXT SENTENCE
 13969          ELSE
 13970           MOVE ER-2642          TO WS-ERROR
 13971           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13972           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13973
 13974     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13975        CP-ERROR-DIV-BY-ZERO
 13976           MOVE ER-3782          TO WS-ERROR
 13977           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13978
 13979     IF PB-COMPANY-ID EQUAL 'CRI'
 13980        IF CP-ERROR-NO-LIMITS-CRI
 13981           IF NOT ACCOUNT-AH-CHECKED
 13982              MOVE ER-2607          TO WS-ERROR
 13983              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13984
 13985     IF ACCOUNT-AH-CHECKED
 13986        NEXT SENTENCE
 13987     ELSE
 13988       IF CP-ERROR-AMT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 253
* EL050.cbl
 13989          MOVE ER-2640           TO WS-ERROR
 13990          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13991
 13992     IF PB-COMPANY-ID = 'CRI'
 13993         IF WS-ERROR = ER-2640
 13994             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13995     IF ACCOUNT-AH-CHECKED
 13996        CONTINUE
 13997     ELSE
 13998        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13999           AND (CP-R-MAX-ATT-AGE > +0)
 14000           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14001           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14002              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14003              MOVE PB-I-AH-EXPIRE-DT
 14004                                 TO DC-BIN-DATE-2
 14005              MOVE '1'           TO DC-OPTION-CODE
 14006              PERFORM 8500-DATE-CONVERT
 14007                                 THRU 8500-EXIT
 14008              IF NO-CONVERSION-ERROR
 14009                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14010                    MOVE ER-2661       TO WS-ERROR
 14011*                   PERFORM 9900-ERROR-FORMAT
 14012*                                THRU 9900-EXIT
 14013                 END-IF
 14014              END-IF
 14015           ELSE
 14016              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14017              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14018                 MOVE ER-2661    TO WS-ERROR
 14019*                PERFORM 9900-ERROR-FORMAT
 14020*                                THRU 9900-EXIT
 14021              ELSE
 14022                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14023                    MOVE ER-1570 TO WS-ERROR
 14024                    PERFORM 9900-ERROR-FORMAT
 14025                                 THRU 9900-EXIT
 14026                 END-IF
 14027              END-IF
 14028           END-IF
 14029           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14030              MOVE PB-I-JOINT-BIRTHDAY
 14031                                    TO DC-BIN-DATE-1
 14032              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14033              MOVE '1'              TO DC-OPTION-CODE
 14034              PERFORM 8500-DATE-CONVERT
 14035                                    THRU 8500-EXIT
 14036              IF NO-CONVERSION-ERROR
 14037                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14038                    MOVE ER-2661       TO WS-ERROR
 14039*                   PERFORM 9900-ERROR-FORMAT
 14040*                                   THRU 9900-EXIT
 14041                 END-IF
 14042              END-IF
 14043           ELSE
 14044              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14045                (PB-I-AH-TERM / 12)
 14046              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 254
* EL050.cbl
 14047                 MOVE ER-2661       TO WS-ERROR
 14048*                PERFORM 9900-ERROR-FORMAT
 14049*                                   THRU 9900-EXIT
 14050              ELSE
 14051                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14052                    MOVE ER-1571 TO WS-ERROR
 14053                    PERFORM 9900-ERROR-FORMAT
 14054                                 THRU 9900-EXIT
 14055                 END-IF
 14056              END-IF
 14057           END-IF
 14058           IF WS-ERROR = ER-2661
 14059              PERFORM 9900-ERROR-FORMAT
 14060                                    THRU 9900-EXIT
 14061           END-IF
 14062        END-IF
 14063     END-IF
 14064*    IF ACCOUNT-AH-CHECKED
 14065*       NEXT SENTENCE
 14066*    ELSE
 14067*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14068*          MOVE ER-2661          TO WS-ERROR
 14069*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14070
 14071     IF ACCOUNT-AH-CHECKED
 14072        NEXT SENTENCE
 14073     ELSE
 14074        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14075           MOVE ER-2663          TO WS-ERROR
 14076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14077
 14078     IF ACCOUNT-AH-CHECKED OR
 14079        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14080         PB-POLICY-IS-VOIDED
 14081        NEXT SENTENCE
 14082     ELSE
 14083        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14084           MOVE ER-2667            TO WS-ERROR
 14085           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14086
 14087     IF PB-COMPANY-ID = 'CRI'
 14088         IF WS-ERROR = ER-2667
 14089             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14090
 14091     IF ACCOUNT-AH-CHECKED
 14092        NEXT SENTENCE
 14093     ELSE
 14094        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14095           MOVE ER-2678            TO WS-ERROR
 14096           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14097
 14098     IF CP-ERROR-RATE-FILE-NOTOPEN
 14099         GO TO 3990-FILES-NOT-OPEN.
 14100
 14101 3321-CONTINUE.
 14102     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14103     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14104     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 255
* EL050.cbl
 14105        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14106        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14107                                    PB-I-LF-ALT-PREM-CALC
 14108        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14109        IF WS-AH-BEN-CATEGORY = 'G'
 14110           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14111           + PB-I-ADDL-CLP)
 14112           * (1 + WS-TOL-CLP-PCT)
 14113*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14114        ELSE
 14115           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14116           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14117*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14118        END-IF
 14119        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14120                                 TO PB-I-AH-PREM-CALC
 14121        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14122           MOVE ER-8152          TO WS-ERROR
 14123           PERFORM 9900-ERROR-FORMAT
 14124                                 THRU 9900-EXIT
 14125        ELSE
 14126           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14127                 PB-I-ADDL-CLP)
 14128              MOVE ER-8148       TO WS-ERROR
 14129              PERFORM 9900-ERROR-FORMAT
 14130                                 THRU 9900-EXIT
 14131           END-IF
 14132        END-IF
 14133     END-IF
 14134     IF (PB-COMPANY-ID = 'DCC')
 14135        AND (PB-I-POLICY-IS-MONTHLY)
 14136        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14137        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14138        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14139           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14140        END-IF
 14141     END-IF
 14142     IF (PB-COMPANY-ID = 'DCC')
 14143        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14144        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14145        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14146        MOVE ER-2786             TO WS-ERROR
 14147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14148     END-IF
 14149     MOVE +0                     TO PB-I-AH-CLP
 14150     IF PB-COMPANY-ID = 'DCC'
 14151        IF WS-AH-BEN-CATEGORY = 'D'
 14152           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14153              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14154        ELSE
 14155           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14156              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14157           END-IF
 14158        END-IF
 14159     END-IF
 14160     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14161
 14162     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 256
* EL050.cbl
 14163         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14164
 14165     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14166         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14167
 14168     IF PB-COMPANY-ID = 'CRI'
 14169         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14170            PB-I-PAYMENT-AMOUNT = ZERO
 14171             NEXT SENTENCE
 14172         ELSE
 14173             COMPUTE PB-I-AH-PREM-CALC =
 14174                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14175                 (CP-PREMIUM-RATE / 100)
 14176             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14177                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14178                                             PB-I-RATE-DEV-PCT-AH.
 14179
 14180     IF PB-I-AH-RATE  = ZERO
 14181       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14182           NEXT SENTENCE
 14183       ELSE
 14184         MOVE ER-2642            TO WS-ERROR
 14185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14186
 14187     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14188     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14189     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14190     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14191     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14192     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14193
 14194     IF (PB-COMPANY-ID = 'DCC')
 14195        AND (WS-AH-BEN-CATEGORY = 'G')
 14196        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14197        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14198        IF CP-DEVIATION-CODE NOT = '000'
 14199           MOVE '000'            TO CP-DEVIATION-CODE
 14200           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14201           IF NO-CP-ERROR
 14202              COMPUTE PB-I-DDF-IU-RATE-UP =
 14203              PB-I-AH-CLP - CP-CALC-PREMIUM
 14204           ELSE
 14205              MOVE ER-3057        TO WS-ERROR
 14206              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14207           END-IF
 14208        END-IF
 14209     END-IF
 14210     .
 14211 3335-EDIT-AH-REIN-NSP-RATE.
 14212     IF AH-REIN-NSP-NOT-USED
 14213         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14214
 14215     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14216     IF PB-COMPANY-ID = 'DCC'
 14217         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14218     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14219     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14220     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 257
* EL050.cbl
 14221     MOVE PB-SV-STATE            TO CP-STATE.
 14222     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14223     MOVE ZERO                   TO CP-DEVIATION-CODE
 14224                                    CP-RATE-DEV-PCT.
 14225*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14226     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14227     MOVE '3'                    TO CP-PROCESS-TYPE.
 14228     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14229     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14230                                    CP-RATING-BENEFIT-AMT.
 14231     IF CP-STATE-STD-ABBRV = 'OR'
 14232         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14233                                         PB-I-AH-TERM.
 14234     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14235     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14236     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14237     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14238     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14239     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14240                                    CP-REMAINING-TERM
 14241                                    WS-WORK-TERM.
 14242     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14243     IF PB-COMPANY-ID = 'DCC'
 14244        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14245     END-IF
 14246     IF  PB-COMPANY-ID = 'TIC'
 14247         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14248            MOVE ZERO TO CP-CLASS-CODE.
 14249
 14250     IF PB-COMPANY-ID NOT = 'TIC'
 14251          MOVE ZERO          TO CP-CLASS-CODE.
 14252
 14253     MOVE ZERO               TO CP-DEVIATION-CODE.
 14254
 14255     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14256
 14257     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14258
 14259     MOVE 'R'                   TO CP-RATE-FILE.
 14260     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14261
 14262     IF CP-ERROR-RATE-NOT-FOUND
 14263         MOVE ER-2645        TO WS-ERROR
 14264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14265         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14266
 14267     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14268
 14269     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14270     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14271
 14272     IF PB-I-AH-REI-RATE = ZERO
 14273         MOVE ER-2645        TO WS-ERROR
 14274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14275
 14276
 14277 3340-CALCULATE-PREMIUM-AMT.
 14278
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 258
* EL050.cbl
 14279     IF PB-COMPANY-ID = 'NCL'
 14280         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14281             WS-AH-SPECIAL-CALC-CD = 'O')
 14282             GO TO 3999-END-EDIT.
 14283
 14284     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14285                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14286                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14287                         OR 'AHL'
 14288         NEXT SENTENCE
 14289     ELSE
 14290         IF WS-STATE-ABBREVIATION = 'CT'
 14291             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14292                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14293                 COMPUTE PB-I-LF-PREM-CALC =
 14294                                     PB-I-LF-PREM-CALC * .90
 14295                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14296                                     PB-I-LF-ALT-PREM-CALC * .90
 14297                 COMPUTE PB-I-AH-PREM-CALC =
 14298                                     PB-I-AH-PREM-CALC * .90.
 14299
 14300     IF PB-COMP-LF-PREM
 14301        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14302        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14303
 14304     IF PB-COMP-AH-PREM
 14305        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14306
 14307 3340-CHECK-DCC-TOT-FEES.
 14308     IF (PB-COMPANY-ID = 'DCC')
 14309        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14310        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14311        AND (PB-I-POLICY-IS-MONTHLY)
 14312        CONTINUE
 14313     ELSE
 14314        GO TO 3340-EDIT-LF-AH-TOL
 14315     END-IF
 14316     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14317     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14318     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14319        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14320           PB-I-RATE-DEV-PCT-LF
 14321     END-IF
 14322     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14323        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14324           PB-I-RATE-DEV-PCT-AH
 14325     END-IF
 14326     MOVE 'N'                    TO CP-BEN-CATEGORY
 14327     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14328
 14329     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14330     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14331     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14332     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14333     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14334     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14335     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14336     MOVE '3'                    TO CP-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 259
* EL050.cbl
 14337     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14338     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14339
 14340     MOVE PB-SV-STATE            TO CP-STATE.
 14341     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14342     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14343     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14344     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14345     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14346                                    CP-RATING-BENEFIT-AMT.
 14347     IF CP-STATE-STD-ABBRV = 'OR'
 14348         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14349                                         PB-I-LF-ALT-BENEFIT-AMT.
 14350     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14351     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14352     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14353     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14354     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14355     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14356     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14357     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14358     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14359                                    CP-REMAINING-TERM
 14360                                    CP-LOAN-TERM.
 14361
 14362     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14363         NEXT SENTENCE
 14364     ELSE
 14365         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14366             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14367                                           PB-I-LF-PREMIUM-AMT.
 14368
 14369     IF CP-TRUNCATED-LIFE
 14370        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14371
 14372     IF CP-TERM-IS-DAYS
 14373         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14374     ELSE
 14375         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14376
 14377     IF PB-COMPANY-ID = 'DCC'
 14378        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14379     END-IF
 14380     IF CP-SPECIAL-CALC-CD = 'H'
 14381         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14382                                    TO CP-ALTERNATE-BENEFIT
 14383         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14384     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14385     MOVE 'R'                    TO CP-RATE-FILE
 14386     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14387     IF NOT CP-ERROR-RATE-NOT-FOUND
 14388        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14389        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14390           AND (CP-BENEFIT-CD (1:1) = 'S')
 14391           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14392                                    PB-I-LF-PREMIUM-AMT
 14393        END-IF
 14394     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 260
* EL050.cbl
 14395        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14396     END-IF
 14397     .
 14398 3340-EDIT-LF-AH-TOL.
 14399
 14400***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14401***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14402***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14403***
 14404     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14405         PB-I-AH-PREMIUM-AMT
 14406          GIVING WS-CALC-WORK.
 14407
 14408     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14409        AND WS-CALC-WORK NOT = ZERO
 14410         MOVE ER-2649            TO WS-ERROR
 14411         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14412
 14413     SUBTRACT PB-I-LF-PREM-CALC
 14414             FROM PB-I-LF-PREMIUM-AMT
 14415                 GIVING WS-UNSIGN-WRK1.
 14416
 14417     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14418             FROM PB-I-LF-ALT-PREMIUM-AMT
 14419                 GIVING WS-UNSIGN-WRK4.
 14420
 14421     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14422                                + WS-UNSIGN-WRK4.
 14423
 14424     SUBTRACT PB-I-AH-PREM-CALC
 14425             FROM PB-I-AH-PREMIUM-AMT
 14426                 GIVING WS-UNSIGN-WRK2.
 14427
 14428******************************************************************
 14429*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14430******************************************************************
 14431
 14432     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14433         MOVE ZERO TO WS-UNSIGN-WRK1.
 14434
 14435     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14436         MOVE ZERO TO WS-UNSIGN-WRK2.
 14437
 14438     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14439             GIVING WS-UNSIGN-WRK3.
 14440
 14441 3342-CONTINUE.
 14442
 14443     IF (PB-I-LF-RATE = ZERO  AND
 14444         PB-I-AH-RATE = ZERO)
 14445         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14446            WS-AH-SPECIAL-CALC-CD = 'O'
 14447              NEXT SENTENCE
 14448         ELSE
 14449             GO TO 3345-EDIT-CONTINUE.
 14450
 14451     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14452         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 261
* EL050.cbl
 14453     ELSE
 14454     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14455        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14456           IF (PB-REISSUED-CERT         OR
 14457               PB-POLICY-IS-DECLINED    OR
 14458               PB-POLICY-IS-VOIDED)
 14459              NEXT SENTENCE
 14460           ELSE
 14461              IF WS-PREM-REJECT-SW = SPACE
 14462                 MOVE ER-2652    TO WS-ERROR
 14463                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14464                 GO TO 3344-CHECK-AH
 14465              ELSE
 14466                 MOVE ER-2650    TO WS-ERROR
 14467                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14468                 GO TO 3344-CHECK-AH.
 14469
 14470***
 14471***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14472***
 14473
 14474     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14475         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14476            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14477             (1 + WS-TOL-LF-PREM-PCT)
 14478         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14479            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14480             (1 - WS-TOL-LF-PREM-PCT)
 14481     ELSE
 14482         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14483         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14484
 14485***
 14486***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14487***
 14488
 14489     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14490         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14491          WS-TOL-LF-PREM.
 14492
 14493     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14494         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14495          WS-TOL-LF-PREM.
 14496
 14497     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14498        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14499
 14500     IF (PB-REISSUED-CERT        OR
 14501         PB-POLICY-IS-DECLINED   OR
 14502         PB-POLICY-IS-VOIDED)
 14503        NEXT SENTENCE
 14504     ELSE
 14505     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14506           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14507       OR
 14508        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14509           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14510       AND
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 262
* EL050.cbl
 14511        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14512           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14513         OR
 14514          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14515           LESS WS-TOL-LF-LOW-PREM-PCT))
 14516              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14517                  MOVE ER-2652   TO  WS-ERROR
 14518                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14519              ELSE
 14520                  MOVE ER-2650   TO  WS-ERROR
 14521                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14522
 14523*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14524*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14525*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14526*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14527
 14528     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14529        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14530                      OR
 14531           ((PB-COMPANY-ID = 'DCC')
 14532           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14533           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14534           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14535        END-IF
 14536     END-IF
 14537
 14538     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14539        IF WS-COMP-MAX-CAP GREATER THAN +0
 14540           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14541              IF (PB-REISSUED-CERT         OR
 14542                  PB-POLICY-IS-DECLINED    OR
 14543                  PB-POLICY-IS-VOIDED)
 14544                 NEXT SENTENCE
 14545              ELSE
 14546                  MOVE ER-2646   TO  WS-ERROR
 14547                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14548
 14549 3344-CVL-TOLERANCE-CHECK.
 14550
 14551      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14552          GO TO 3344-CHECK-AH.
 14553
 14554      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14555          GO TO 3344-CHECK-AH.
 14556
 14557      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14558                                     WS-UNSIGN-WRK6.
 14559
 14560      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14561          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14562                                 + PB-I-LF-PREMIUM-AMT
 14563                                 - PB-I-LF-PREM-CALC.
 14564
 14565      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14566          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14567                                 + PB-I-LF-ALT-PREMIUM-AMT
 14568                                 - PB-I-LF-ALT-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 263
* EL050.cbl
 14569
 14570      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14571          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14572              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14573                 MOVE ER-2652    TO  WS-ERROR
 14574                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14575              ELSE
 14576                 MOVE ER-2650    TO  WS-ERROR
 14577                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14578
 14579      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14580          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14581              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14582                 MOVE ER-2652    TO  WS-ERROR
 14583                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14584              ELSE
 14585                 MOVE ER-2650    TO  WS-ERROR
 14586                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14587
 14588 3344-CHECK-AH.
 14589
 14590****************************************************************
 14591***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14592***
 14593
 14594     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14595         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14596             (1 + WS-TOL-AH-PREM-PCT)
 14597         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14598             (1 - WS-TOL-AH-PREM-PCT)
 14599     ELSE
 14600         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14601         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14602
 14603***
 14604***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14605***
 14606
 14607     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14608         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14609
 14610     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14611         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14612
 14613     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14614        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14615
 14616     IF (PB-REISSUED-CERT)
 14617        OR (PB-POLICY-IS-DECLINED)
 14618        OR (PB-POLICY-IS-VOIDED)
 14619        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14620        CONTINUE
 14621     ELSE
 14622        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14623            OR
 14624           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14625           AND
 14626           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 264
* EL050.cbl
 14627           OR
 14628           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14629           IF WS-PREM-REJECT-SW = SPACE
 14630              MOVE ER-3052       TO WS-ERROR
 14631              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14632           ELSE
 14633              MOVE ER-3050       TO WS-ERROR
 14634              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14635           END-IF
 14636        END-IF
 14637     END-IF
 14638
 14639     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14640         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14641             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14642             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14643
 14644     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14645        IF WS-COMP-MAX-CAP GREATER THAN +0
 14646           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14647              IF (PB-REISSUED-CERT         OR
 14648                  PB-POLICY-IS-DECLINED    OR
 14649                  PB-POLICY-IS-VOIDED)
 14650                 NEXT SENTENCE
 14651              ELSE
 14652                  MOVE ER-2646   TO  WS-ERROR
 14653                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14654
 14655     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14656        (WS-COMP-MAX-CAP EQUAL +0)
 14657           GO TO 3345-EDIT-CONTINUE.
 14658
 14659     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14660        GREATER THAN WS-COMP-MAX-CAP
 14661           MOVE ER-2646          TO  WS-ERROR
 14662           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14663
 14664 3345-EDIT-CONTINUE.
 14665
 14666*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14667*       IF PB-ENTRY-BATCH   NUMERIC
 14668*          IF PB-ISSUE
 14669*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14670*          ELSE
 14671*              IF PB-CANCELLATION
 14672*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14673
 14674*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14675*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14676*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14677*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14678*        ELSE
 14679*            MOVE  ER-1909            TO  WS-ERROR
 14680*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14681
 14682     IF PB-I-POLICY-ACCEPTED
 14683        IF PB-POLICY-IS-DECLINED  OR
 14684           PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 265
* EL050.cbl
 14685           PB-REIN-ONLY-CERT  OR
 14686           PB-POLICY-IS-VOIDED
 14687            MOVE  ER-1891         TO  WS-ERROR
 14688            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14689        ELSE
 14690            MOVE SPACE            TO  PB-BATCH-ENTRY
 14691            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14692
 14693     IF PB-I-POLICY-DECLINED
 14694        IF PB-REISSUED-CERT  OR
 14695           PB-REIN-ONLY-CERT  OR
 14696           PB-POLICY-IS-VOIDED
 14697            MOVE  ER-1906         TO  WS-ERROR
 14698            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14699        ELSE
 14700            MOVE  'D'             TO  PB-BATCH-ENTRY
 14701                                      PB-I-ENTRY-STATUS.
 14702
 14703     IF PB-I-NEEDS-UNDERWRITING
 14704        IF PB-POLICY-IS-DECLINED OR
 14705           PB-REISSUED-CERT  OR
 14706           PB-REIN-ONLY-CERT  OR
 14707           PB-POLICY-IS-VOIDED
 14708            MOVE  ER-1907         TO  WS-ERROR
 14709            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14710        ELSE
 14711            MOVE 'U'              TO  PB-BATCH-ENTRY
 14712                                      PB-I-ENTRY-STATUS.
 14713
 14714     IF PB-NEEDS-UNDERWRITING
 14715        MOVE  ER-1901             TO  WS-ERROR
 14716        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14717     IF PB-COMPANY-ID = 'DCC'
 14718        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14719        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14720        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14721           AND (NOT WS-LF-CASH))
 14722                           OR
 14723           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14724           AND (NOT WS-AH-CASH)))
 14725                       AND
 14726           (PB-I-ENTRY-STATUS NOT = '5')
 14727           MOVE 'M'              TO PB-BATCH-ENTRY
 14728                                    PB-I-ENTRY-STATUS
 14729        END-IF
 14730     END-IF
 14731     IF  PB-COMPANY-ID NOT = 'NCL'
 14732         GO TO 3999-END-EDIT.
 14733
 14734     IF PB-REISSUED-CERT  OR
 14735        PB-POLICY-IS-DECLINED  OR
 14736        PB-POLICY-IS-VOIDED  OR
 14737        PB-I-OB
 14738         GO TO 3999-END-EDIT.
 14739
 14740     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14741         MOVE  ER-2644            TO  WS-ERROR
 14742         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 266
* EL050.cbl
 14743         GO TO 3999-END-EDIT.
 14744
 14745     MOVE 'N'                     TO  FORM-MASTER-SW.
 14746     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14747
 14748     IF NOT FORM-MASTER-FOUND
 14749         GO TO 3999-END-EDIT.
 14750
 14751     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14752                                      FORM-MASTER-AH-SW.
 14753
 14754     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14755         MOVE  +1                 TO SUB6
 14756         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14757
 14758     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14759         MOVE  +1                 TO SUB6
 14760         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14761
 14762     IF LF-FORM-MASTER-FOUND  OR
 14763        AH-FORM-MASTER-FOUND
 14764         GO TO 3360-CHECK-FORM-LIMITS
 14765     ELSE
 14766         GO TO 3999-END-EDIT.
 14767
 14768******************************************************************
 14769*                  3350-GET-ERFORM                               *
 14770*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14771*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14772******************************************************************
 14773
 14774 3350-GET-ERFORM.
 14775
 14776     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14777         GO TO  3350-ERFORM-GETMAIN.
 14778
 14779     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14780     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14781     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14782     MOVE 'Y'                     TO FORM-MASTER-SW.
 14783
 14784     IF PB-CANCELLATION
 14785         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14786            PB-SV-STATE          EQUAL   FO-STATE       AND
 14787            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14788              GO TO 3350-EXIT
 14789         ELSE
 14790             NEXT SENTENCE
 14791     ELSE
 14792         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14793            PB-SV-STATE          EQUAL   FO-STATE       AND
 14794            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14795              GO TO 3350-EXIT.
 14796
 14797 3350-ERFORM-GETMAIN.
 14798
 14799     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14800     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 267
* EL050.cbl
 14801
 14802 3350-ERFORM-READ.
 14803
 14804     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14805     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14806     IF PB-CANCELLATION
 14807         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14808     ELSE
 14809         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14810     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14811
 14812     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14813
 14814     IF FORM-MASTER-FOUND
 14815       IF PB-CANCELLATION
 14816          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14817             PB-SV-STATE          EQUAL   FO-STATE       AND
 14818             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14819              GO  TO 3350-EXIT
 14820          ELSE
 14821              NEXT SENTENCE
 14822       ELSE
 14823          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14824             PB-SV-STATE          EQUAL   FO-STATE       AND
 14825             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14826              GO  TO 3350-EXIT.
 14827
 14828     MOVE  'N'                    TO  FORM-MASTER-SW.
 14829     MOVE  ER-1895                TO  WS-ERROR.
 14830     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14831
 14832 3350-EXIT.
 14833      EXIT.
 14834
 14835******************************************************************
 14836*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14837*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14838*   VALID FOR THE POLICY FORM USED.                              *
 14839******************************************************************
 14840
 14841 3355-EDIT-FORM-LF-BENEFITS.
 14842
 14843     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14844        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14845         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14846         GO TO   3355-EXIT.
 14847
 14848     IF  SUB6    LESS THAN   +40
 14849         ADD  +1      TO  SUB6
 14850         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14851
 14852     MOVE  ER-1896         TO  WS-ERROR.
 14853     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14854
 14855 3355-EXIT.
 14856      EXIT.
 14857
 14858******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 268
* EL050.cbl
 14859*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14860*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14861*   VALID FOR THE POLICY FORM USED.                              *
 14862******************************************************************
 14863
 14864 3356-EDIT-FORM-AH-BENEFITS.
 14865
 14866     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14867        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14868         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14869         GO TO  3356-EXIT.
 14870
 14871      IF  SUB6    LESS THAN     +40
 14872          ADD  +1      TO  SUB6
 14873          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14874
 14875     MOVE  ER-1897         TO  WS-ERROR.
 14876     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14877
 14878 3356-EXIT.
 14879      EXIT.
 14880
 14881******************************************************************
 14882*                  3357-BENEFIT-SEARCH                           *
 14883*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14884*   CANCELLATIONS ONLY.                                          *
 14885******************************************************************
 14886 3357-BENEFIT-SEARCH.
 14887     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14888         MOVE +1                          TO SUB6
 14889         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14890
 14891     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14892         MOVE +1                          TO SUB6
 14893         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14894
 14895 3357-EXIT.
 14896     EXIT.
 14897
 14898******************************************************************
 14899*                  3358-BENEFIT-LIFE-SEARCH                      *
 14900*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14901*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14902*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14903******************************************************************
 14904 3358-BENEFIT-LIFE-SEARCH.
 14905     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14906       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14907         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14908           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14909              IF FO-PLAN-REFUND-METHOD (SUB6)
 14910                     IS GREATER THAN SPACES
 14911                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14912                                          WS-LF-REFUND-CALC
 14913                 GO TO 3358-EXIT.
 14914
 14915     IF SUB6 LESS THAN +40
 14916         ADD +1                 TO SUB6
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 269
* EL050.cbl
 14917         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14918
 14919 3358-EXIT.
 14920     EXIT.
 14921******************************************************************
 14922*                  3359-BENEFIT-AH-SEARCH                        *
 14923*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14924*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14925*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14926******************************************************************
 14927 3359-BENEFIT-AH-SEARCH.
 14928     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14929       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14930         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14931           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14932              IF FO-PLAN-REFUND-METHOD (SUB6)
 14933                      IS GREATER THAN SPACES
 14934                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14935                                          WS-AH-REFUND-CALC
 14936                 GO TO 3359-EXIT.
 14937
 14938     IF SUB6 LESS THAN +40
 14939         ADD +1                 TO SUB6
 14940         GO TO 3359-BENEFIT-AH-SEARCH.
 14941
 14942 3359-EXIT.
 14943     EXIT.
 14944
 14945******************************************************************
 14946*                  3360-CHECK-FORM-LIMITS                        *
 14947*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14948*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14949******************************************************************
 14950
 14951 3360-CHECK-FORM-LIMITS.
 14952
 14953     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14954         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14955
 14956     IF NOT LF-FORM-MASTER-FOUND
 14957         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14958
 14959 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14960
 14961     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14962       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14963        WS-LF-JOINT-INDICATOR = 'J'  AND
 14964        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14965         IF PB-COMPANY-ID = 'NCL'
 14966            MOVE  ER-1911          TO  WS-ERROR
 14967            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14968         ELSE
 14969            MOVE  ER-1892          TO  WS-ERROR
 14970            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14971
 14972 3360-CHECK-FORM-LF-ATT-AGE.
 14973
 14974     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 270
* EL050.cbl
 14975
 14976     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14977         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14978         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14979            IF PB-COMPANY-ID = 'NCL'
 14980                MOVE  ER-1913      TO  WS-ERROR
 14981                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14982            ELSE
 14983                MOVE  ER-1894      TO  WS-ERROR
 14984                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14985
 14986 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14987
 14988     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14989         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14990         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14991            IF PB-COMPANY-ID = 'NCL'
 14992                MOVE  ER-1914      TO  WS-ERROR
 14993                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14994            ELSE
 14995                MOVE  ER-1899      TO  WS-ERROR
 14996                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14997
 14998 3360-CHECK-FORM-LF-TERM-BAMT.
 14999
 15000     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15001         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15002         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15003           IF  PB-COMPANY-ID = 'NCL'
 15004               MOVE  ER-1916       TO  WS-ERROR
 15005               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15006           ELSE
 15007               MOVE  ER-1902       TO  WS-ERROR
 15008               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15009
 15010     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15011                                    PB-I-LF-ALT-BENEFIT-AMT.
 15012
 15013     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15014         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15015         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15016             IF  PB-COMPANY-ID = 'NCL'
 15017                 MOVE  ER-1918     TO  WS-ERROR
 15018                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15019             ELSE
 15020                 MOVE  ER-1904     TO  WS-ERROR
 15021                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15022
 15023******************************************************************
 15024*                  3360-CHECK-FORM-AH-LIMITS                     *
 15025*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15026*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15027******************************************************************
 15028
 15029 3360-CHECK-FORM-AH-LIMITS.
 15030
 15031     IF NOT AH-FORM-MASTER-FOUND
 15032         GO TO 3999-END-EDIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 271
* EL050.cbl
 15033
 15034 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15035
 15036     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15037       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15038        WS-AH-JOINT-INDICATOR = 'J'  AND
 15039        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15040         IF PB-COMPANY-ID = 'NCL'
 15041            MOVE  ER-1912          TO  WS-ERROR
 15042            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15043         ELSE
 15044            MOVE  ER-1893          TO  WS-ERROR
 15045            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15046
 15047 3360-CHECK-FORM-AH-ATT-AGE.
 15048
 15049     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15050
 15051     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15052         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15053         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15054            IF PB-COMPANY-ID = 'NCL'
 15055                MOVE  ER-1913      TO  WS-ERROR
 15056                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15057            ELSE
 15058                MOVE  ER-1894      TO  WS-ERROR
 15059                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15060
 15061 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15062
 15063     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15064         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15065         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15066            IF PB-COMPANY-ID = 'NCL'
 15067                MOVE  ER-1915      TO  WS-ERROR
 15068                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15069            ELSE
 15070                MOVE  ER-1900      TO  WS-ERROR
 15071                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15072
 15073 3360-CHECK-FORM-AH-TERM-BAMT.
 15074
 15075     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15076         FO-AH-MAX-TERM    GREATER THAN  +0
 15077         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15078             IF  PB-COMPANY-ID = 'NCL'
 15079                 MOVE  ER-1917     TO  WS-ERROR
 15080                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15081             ELSE
 15082                  MOVE  ER-1903    TO  WS-ERROR
 15083                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15084
 15085     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15086         FO-MAX-AH-AMT    GREATER THAN  +0
 15087         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15088             IF  PB-COMPANY-ID = 'NCL'
 15089                 MOVE  ER-1919     TO  WS-ERROR
 15090                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 272
* EL050.cbl
 15091             ELSE
 15092                 MOVE  ER-1905     TO  WS-ERROR
 15093                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15094
 15095     GO TO 3999-END-EDIT.
 15096
 15097******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 273
* EL050.cbl
 15099******************************************************************
 15100*                  E D I T   C A N C E L                         *
 15101******************************************************************
 15102
 15103 3700-EDIT-CANCEL.
 15104     IF PB-COMPANY-ID = 'DMD'
 15105         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15106                                         WS-RES-MUNI-TAX
 15107                                         PB-CI-STATE-TAX
 15108                                         PB-CI-MUNI-TAX
 15109         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15110
 15111*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15112*       IF PB-ENTRY-BATCH  NUMERIC
 15113*          IF PB-CANCELLATION
 15114*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15115*          ELSE
 15116*             IF PB-ISSUE
 15117*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15118
 15119     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15120        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15121     END-IF
 15122*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15123*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15124
 15125     IF CM-ENTRY-STATUS = 'V'
 15126        MOVE ER-2780             TO WS-ERROR
 15127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15128        GO TO 3999-END-EDIT.
 15129
 15130     IF CM-ENTRY-STATUS = 'D'
 15131        MOVE ER-2781             TO WS-ERROR
 15132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15133        GO TO 3999-END-EDIT.
 15134
 15135     IF CM-ENTRY-STATUS = 'U'
 15136        MOVE ER-2782             TO WS-ERROR
 15137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15138
 15139***************************************************************
 15140*                                                             *
 15141*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15142*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15143*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15144*   OF ANOTHER COVERAGE.                                      *
 15145*                                                             *
 15146***************************************************************
 15147
 15148     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15149                                    PB-C-AH-CANCEL-VOID-SW.
 15150
 15151     IF PB-C-LF-CANCEL-AMT = ZERO
 15152        NEXT SENTENCE
 15153     ELSE
 15154        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15155           AND
 15156           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 274
* EL050.cbl
 15157               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15158               MOVE ER-2745           TO WS-ERROR
 15159               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15160
 15161     IF PB-C-AH-CANCEL-AMT = ZERO
 15162        NEXT SENTENCE
 15163     ELSE
 15164        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15165           AND
 15166           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15167               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15168               MOVE ER-2745           TO WS-ERROR
 15169               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15170
 15171     IF WS-LF-EARNINGS-CALC = '4'
 15172        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15173
 15174     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15175     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15176     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15177     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15178     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15179     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15180
 15181     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15182                                      PB-C-AH-REF-CALC.
 15183     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15184
 15185******************************************************************
 15186*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15187*             TO VALIDATE COVERAGE.                              *
 15188******************************************************************
 15189
 15190     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15191        PB-C-LF-CANCEL-AMT = ZEROS
 15192          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15193      ELSE
 15194          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15195
 15196     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15197        PB-C-AH-CANCEL-AMT = ZEROS
 15198          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15199      ELSE
 15200          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15201
 15202     EVALUATE TRUE
 15203         WHEN PB-CANCEL-FORCE             OR
 15204              PB-CANCEL-DATE-FORCED       OR
 15205              PB-FORCE-OFF
 15206                  IF PB-COMPANY-ID = 'ACE'
 15207                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15208                  END-IF
 15209         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15210               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15211              (PB-COMPANY-ID = 'ACE' )
 15212                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15213         WHEN OTHER
 15214              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 275
* EL050.cbl
 15215                 MOVE ER-2794              TO WS-ERROR
 15216              ELSE
 15217                 MOVE ER-2749              TO WS-ERROR
 15218              END-IF
 15219              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15220     END-EVALUATE.
 15221
 15222
 15223*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15224*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15225*            MOVE  ER-1909            TO  WS-ERROR
 15226*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15227*        ELSE
 15228*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15229
 15230     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15231     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15232        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15233     ELSE
 15234        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15235     END-IF
 15236     .
 15237 3705-EDIT-CANCEL-DT.
 15238
 15239     IF LF-COVERAGE-CANCELLED
 15240        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15241         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15242         MOVE WS-CURRENT-MONTH-END
 15243                                 TO DC-BIN-DATE-2
 15244         SET ELAPSED-BETWEEN-BIN TO TRUE
 15245*        MOVE 1                  TO DC-OPTION-CODE
 15246         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15247         IF DATE-CONVERSION-ERROR
 15248            NEXT SENTENCE
 15249          ELSE
 15250             IF DC-ELAPSED-DAYS GREATER +180
 15251                IF PB-CANCEL-DATE-FORCED  OR
 15252                   PB-CANCEL-DATE-FORCED-NO-FEE
 15253                      MOVE ER-2751  TO WS-ERROR
 15254                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15255                 ELSE
 15256                   MOVE ER-2752  TO WS-ERROR
 15257                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15258
 15259     IF AH-COVERAGE-CANCELLED
 15260        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15261         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15262         MOVE WS-CURRENT-MONTH-END
 15263                                 TO DC-BIN-DATE-2
 15264         SET ELAPSED-BETWEEN-BIN TO TRUE
 15265*        MOVE 1                  TO DC-OPTION-CODE
 15266         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15267         IF DATE-CONVERSION-ERROR
 15268            NEXT SENTENCE
 15269          ELSE
 15270             IF DC-ELAPSED-DAYS GREATER +180
 15271                IF PB-CANCEL-DATE-FORCED OR
 15272                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 276
* EL050.cbl
 15273                      MOVE ER-2751  TO WS-ERROR
 15274                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15275                 ELSE
 15276                   MOVE ER-2752  TO WS-ERROR
 15277                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15278
 15279     IF WS-ERROR = ER-2752
 15280        AND (PB-COMPANY-ID = 'ABL'
 15281         OR  PB-COMPANY-ID = 'FGL'
 15282         OR  PB-COMPANY-ID = 'IST'
 15283         OR  PB-COMPANY-ID = 'JHL'
 15284         OR  PB-COMPANY-ID = 'LAP'
 15285         OR  PB-COMPANY-ID = 'LBL'
 15286         OR  PB-COMPANY-ID = 'NCB'
 15287         OR  PB-COMPANY-ID = 'NLI'
 15288         OR  PB-COMPANY-ID = 'OFI'
 15289         OR  PB-COMPANY-ID = 'PLI'
 15290         OR  PB-COMPANY-ID = 'TAO'
 15291         OR  PB-COMPANY-ID = 'TIC'
 15292         OR  PB-COMPANY-ID = 'HER'
 15293         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15294         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15295            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15296            MOVE ER-2762     TO WS-ERROR
 15297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15298
 15299     IF LF-COVERAGE-CANCELLED
 15300        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15301        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15302             MOVE ER-2733         TO WS-ERROR
 15303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15304
 15305     IF AH-COVERAGE-CANCELLED
 15306        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15307        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15308              MOVE ER-2733        TO WS-ERROR
 15309              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15310
 15311     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15312        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15313        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15314           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15315            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15316              IF PB-COMPANY-ID NOT = 'LAP'
 15317               MOVE ER-2704            TO WS-ERROR
 15318               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15319
 15320     IF CERT-WAS-NOT-FOUND
 15321         GO TO 3999-END-EDIT.
 15322
 15323     IF PB-COMPANY-ID EQUAL 'CDC'
 15324        IF LF-COVERAGE-CANCELLED
 15325           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15326            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15327            MOVE PB-C-LF-CANCEL-DT
 15328                                 TO DC-BIN-DATE-2
 15329            SET ELAPSED-BETWEEN-BIN TO TRUE
 15330*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 277
* EL050.cbl
 15331            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15332            IF DATE-CONVERSION-ERROR
 15333               NEXT SENTENCE
 15334             ELSE
 15335                IF DC-ELAPSED-DAYS GREATER +60
 15336                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15337
 15338     IF PB-COMPANY-ID EQUAL 'CDC'
 15339        IF AH-COVERAGE-CANCELLED
 15340           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15341            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15342            MOVE PB-C-AH-CANCEL-DT
 15343                                 TO DC-BIN-DATE-2
 15344            MOVE +0              TO DC-ELAPSED-DAYS
 15345                                    DC-ELAPSED-MONTHS
 15346            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15347*           MOVE 1               TO DC-OPTION-CODE
 15348            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15349            IF DATE-CONVERSION-ERROR
 15350               NEXT SENTENCE
 15351             ELSE
 15352                IF DC-ELAPSED-DAYS GREATER +60
 15353                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15354
 15355     MOVE +0                     TO DC-ELAPSED-DAYS
 15356                                    DC-ELAPSED-MONTHS.
 15357
 15358     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15359        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15360          MOVE 'Z'                TO PB-CI-OB-FLAG
 15361          MOVE ER-2767            TO WS-ERROR
 15362          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15363          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15364          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15365          GO TO 3775-OVER-REF-CHK
 15366        ELSE
 15367          MOVE ZEROS              TO PB-CI-LIVES
 15368                                     PB-C-LIVES
 15369          IF PB-CI-OB-FLAG NOT = 'B'
 15370             MOVE SPACE           TO PB-CI-OB-FLAG.
 15371
 15372     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15373         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15374     ELSE
 15375         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15376
 15377     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15378        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15379            MOVE ER-2760         TO WS-ERROR
 15380            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15381
 15382     IF LF-COVERAGE-CANCELLED
 15383        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15384         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15385            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15386               MOVE ER-2774       TO WS-ERROR
 15387               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15388
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 278
* EL050.cbl
 15389     IF AH-COVERAGE-CANCELLED
 15390        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15391         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15392            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15393               MOVE ER-2775       TO WS-ERROR
 15394               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15395
 15396     IF LF-COVERAGE-CANCELLED
 15397        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15398         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15399            MOVE ER-2776         TO WS-ERROR
 15400            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15401
 15402     IF AH-COVERAGE-CANCELLED
 15403        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15404         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15405            MOVE ER-2777         TO WS-ERROR
 15406            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15407
 15408     IF LF-COVERAGE-CANCELLED
 15409        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15410         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15411         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15412         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15413*        MOVE 6                    TO DC-OPTION-CODE
 15414         SET BIN-PLUS-ELAPSED      TO TRUE
 15415         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15416         IF DATE-CONVERSION-ERROR
 15417            NEXT SENTENCE
 15418          ELSE
 15419            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15420              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15421                             OR  'FIA'
 15422                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15423               ELSE
 15424                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15425                MOVE ER-2731       TO WS-ERROR
 15426                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15427
 15428 3705-EDIT-AH-CANCEL-DT.
 15429
 15430     IF AH-COVERAGE-CANCELLED
 15431        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15432         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15433         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15434         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15435*        MOVE 6                    TO DC-OPTION-CODE
 15436         SET BIN-PLUS-ELAPSED      TO TRUE
 15437         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15438         IF DATE-CONVERSION-ERROR
 15439            NEXT SENTENCE
 15440          ELSE
 15441            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15442              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15443                              OR 'FIA'
 15444                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15445              ELSE
 15446               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 279
* EL050.cbl
 15447               MOVE ER-2771       TO WS-ERROR
 15448               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15449
 15450 3705-EDIT-CONTINUED.
 15451
 15452*    IF LF-COVERAGE-CANCELLED
 15453*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15454*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15455*            MOVE ER-2727         TO WS-ERROR
 15456*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15457*
 15458*    IF AH-COVERAGE-CANCELLED
 15459*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15460*        IF PB-COMPANY-ID = 'ACE'
 15461*           MOVE ER-2727        TO WS-ERROR
 15462*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15463*        ELSE
 15464*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15465*              MOVE ER-2727     TO WS-ERROR
 15466*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15467
 15468     IF PB-COMPANY-ID = 'ACE'
 15469       IF AH-COVERAGE-CANCELLED
 15470         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15471           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15472              MOVE ER-2732      TO WS-ERROR
 15473              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15474
 15475     IF PB-COMPANY-ID      EQUAL   'HER'
 15476        IF WS-ERROR        EQUAL   ER-2727
 15477            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15478            MOVE  ER-2725          TO  WS-ERROR
 15479            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15480
 15481     IF PB-C-CLAIM-CREATED-CANCEL
 15482            MOVE ER-2748         TO WS-ERROR
 15483            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15484
 15485     IF PB-C-LAST-NAME NOT = SPACES
 15486         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15487            MOVE ER-2747         TO WS-ERROR
 15488            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15489
 15490 3710-EDIT-LUMP-SUM-PRIOR.
 15491
 15492     IF AH-COVERAGE-CANCELLED
 15493         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15494             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15495                MOVE ER-2735    TO WS-ERROR
 15496                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15497
 15498     IF LF-COVERAGE-CANCELLED
 15499         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15500             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15501                MOVE ER-2735    TO WS-ERROR
 15502                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15503
 15504 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 280
* EL050.cbl
 15505
 15506*    IF LF-COVERAGE-CANCELLED
 15507*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15508*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15509*           (NOT PB-CI-OB)
 15510*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15511*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15512*                   MOVE ER-2732  TO WS-ERROR
 15513*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15514*
 15515*    IF AH-COVERAGE-CANCELLED
 15516*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15517*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15518*           (NOT PB-CI-OB)
 15519*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15520*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15521*                   MOVE ER-2732  TO WS-ERROR
 15522*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15523
 15524     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15525         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15526            (NOT PB-COMP-LF-CANCEL)
 15527             NEXT SENTENCE
 15528         ELSE
 15529           IF PB-C-LF-CANCEL-VOIDED
 15530              NEXT SENTENCE
 15531           ELSE
 15532              MOVE ER-2753      TO WS-ERROR
 15533              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15534
 15535     IF CANCEL-FUTURE-DT
 15536         GO TO 3999-END-EDIT.
 15537
 15538 3715-GET-REMAIN-TERM-LF.
 15539
 15540     IF NO-LF-BENEFIT-MATCH  OR
 15541        WS-LF-BENEFIT-CD = ZEROS
 15542        GO TO 3730-GET-AH-REMAIN-TERM.
 15543
 15544     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15545     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15546     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15547     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15548     MOVE PB-SV-STATE            TO CP-STATE.
 15549     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15550     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15551     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15552     MOVE '2'                    TO CP-PROCESS-TYPE.
 15553     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15554     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15555     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15556     IF (PB-COMPANY-ID = 'CID')
 15557        AND (CP-STATE-STD-ABBRV = 'WI')
 15558        MOVE '7'                 TO CP-REM-TERM-METHOD
 15559        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15560     ELSE
 15561        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15562        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 281
* EL050.cbl
 15563                                 TO CP-REM-TRM-CALC-OPTION
 15564     END-IF
 15565**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15566     IF (PB-COMPANY-ID = 'CID')
 15567        AND (CP-STATE-STD-ABBRV = 'MO')
 15568        AND (PB-CERT-EFF-DT >= X'9B41')
 15569        AND (PB-CERT-EFF-DT <= X'A2FB')
 15570        MOVE '7'                 TO CP-REM-TERM-METHOD
 15571        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15572     END-IF
 15573     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15574                                    CP-LOAN-TERM.
 15575     IF CP-TRUNCATED-LIFE
 15576        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15577
 15578     IF CP-TERM-IS-DAYS
 15579         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15580     ELSE
 15581         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15582
 15583     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15584
 15585     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15586
 15587     IF LF-COVERAGE-CANCELLED
 15588        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15589        NEXT SENTENCE
 15590      ELSE
 15591          GO TO 3730-GET-AH-REMAIN-TERM.
 15592
 15593 3720-GET-LF-REFUND.
 15594
 15595     IF PB-C-LF-CANCEL-VOIDED OR
 15596        PB-C-AH-CANCEL-VOIDED
 15597        GO TO 3780-UPDATE-CANCEL-CERT.
 15598
 15599     IF PB-COMPANY-ID EQUAL 'BOA'
 15600         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15601         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15602         GO TO 3730-GET-AH-REMAIN-TERM.
 15603
 15604     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15605        (WS-AH-SPECIAL-CALC-CD = 'M')
 15606         MOVE ER-2767            TO WS-ERROR
 15607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15608         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15609         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15610         GO TO 3780-UPDATE-CANCEL-CERT.
 15611
 15612     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15613
 15614     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15615     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15616     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15617     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15618     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15619     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15620     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 282
* EL050.cbl
 15621        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15622        IF PDEF-MASTER-FOUND
 15623           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15624              (V1 > +8)
 15625              OR (PD-PROD-CODE (V1) = 'L')
 15626           END-PERFORM
 15627           IF V1 < +9
 15628              MOVE PD-MAX-AMT (V1)
 15629                           TO CP-R-MAX-TOT-BEN
 15630                              EC-AM-LF-MAX-TOT-BEN
 15631           END-IF
 15632        ELSE
 15633        MOVE ' '                 TO PDEF-MASTER-SW
 15634        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15635        MOVE PB-STATE            TO ERPDEF-STATE
 15636        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15637        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15638        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15639        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15640        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15641        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15642        IF PDEF-MASTER-FOUND
 15643           MOVE 'N'              TO PDEF-MASTER-SW
 15644           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15645           IF PDEF-MASTER-FOUND
 15646              IF (ERPDEF-KEY-SAVE (1:16) =
 15647                           PD-CONTROL-PRIMARY (1:16))
 15648                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15649                 CONTINUE
 15650              ELSE
 15651                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15652                 IF (ERPDEF-KEY-SAVE (1:16) =
 15653                           PD-CONTROL-PRIMARY (1:16))
 15654                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15655                    CONTINUE
 15656                 ELSE
 15657                    MOVE 'N'     TO PDEF-MASTER-SW
 15658                 END-IF
 15659              END-IF
 15660              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15661
 15662              IF PDEF-MASTER-FOUND
 15663                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15664                    (V1 > +8)
 15665                    OR (PD-PROD-CODE (V1) = 'L')
 15666                 END-PERFORM
 15667                 IF V1 < +9
 15668                    MOVE PD-MAX-AMT (V1)
 15669                                 TO CP-R-MAX-TOT-BEN
 15670                                    EC-AM-LF-MAX-TOT-BEN
 15671                 END-IF
 15672              END-IF
 15673           END-IF
 15674           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15675        END-IF
 15676        END-IF
 15677     END-IF
 15678     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 283
* EL050.cbl
 15679
 15680     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15681
 15682     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15683                                    PB-C-LF-REM-TERM.
 15684
 15685     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15686     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15687
 15688     IF PB-COMPANY-ID EQUAL 'FLC'
 15689        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15690           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15691           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15692                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15693                    - CM-LF-ITD-DEATH-AMT
 15694           IF PB-C-LF-REF-CALC LESS THAN +0
 15695              MOVE +0            TO PB-C-LF-REF-CALC
 15696              GO TO 3730-GET-AH-REMAIN-TERM
 15697           ELSE
 15698              GO TO 3730-GET-AH-REMAIN-TERM.
 15699
 15700     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15701                            OR '4' OR '5' OR '6' OR '8'
 15702                            OR '9' OR 'G'
 15703        MOVE PB-C-LF-REFUND-OVERRIDE
 15704                                 TO CP-EARNING-METHOD.
 15705
 15706     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15707     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15708     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15709                                    CP-RATING-BENEFIT-AMT.
 15710     IF CP-STATE-STD-ABBRV = 'OR'
 15711         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15712                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15713     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15714     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15715     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15716     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15717     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15718     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15719     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15720     IF WS-DEFAULT-APR NOT NUMERIC
 15721         MOVE ZEROS TO WS-DEFAULT-APR.
 15722****   N O T E   ****
 15723*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15724*      THE OH HARD CODING IN ELCRFNDP
 15725
 15726     IF PB-COMPANY-ID = 'CID'
 15727        IF CP-STATE-STD-ABBRV = 'OH'
 15728           MOVE WS-LF-EARNINGS-CALC
 15729                                 TO CP-EARNING-METHOD
 15730        END-IF
 15731     END-IF
 15732
 15733****   N O T E   ****
 15734
 15735     IF CP-EARN-AS-NET-PAY
 15736         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 284
* EL050.cbl
 15737            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15738                MOVE WS-DEFAULT-APR
 15739                                 TO  CP-LOAN-APR
 15740                MOVE ER-3780     TO  WS-ERROR
 15741                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15742            ELSE
 15743                MOVE ER-3781     TO  WS-ERROR
 15744                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15745     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15746     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15747
 15748     IF CP-REFUND-TYPE-USED NOT = SPACE
 15749         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15750
 15751     IF CP-ERROR-RATE-IS-ZERO OR
 15752        CP-ERROR-RATE-NOT-FOUND
 15753        MOVE ER-2740             TO WS-ERROR
 15754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15755
 15756     IF CP-ERROR-RATE-FILE-NOTOPEN
 15757        MOVE ER-2617             TO WS-ERROR
 15758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15759
 15760     IF PB-COMPANY-ID = 'DCC'
 15761        AND PB-CI-ENTRY-STATUS = 'M'
 15762        MOVE +0                  TO PB-C-LF-REF-CALC
 15763     ELSE
 15764        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15765     END-IF
 15766
 15767     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15768         GO TO 3730-GET-AH-REMAIN-TERM.
 15769
 15770*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15771*       ADD +1                   TO PB-C-LF-REM-TERM
 15772*                                   CP-REMAINING-TERM
 15773*                                   CP-ORIGINAL-TERM.
 15774
 15775     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15776     MOVE '2'                    TO CP-EARNING-METHOD
 15777                                    CP-RATING-METHOD.
 15778     IF PB-COMPANY-ID = 'CID'
 15779        IF (CP-STATE-STD-ABBRV = 'MN')
 15780           AND (PB-CERT-EFF-DT > X'A4FF')
 15781           AND (WS-LF-EARNINGS-CALC = 'B')
 15782           MOVE '5'              TO CP-EARNING-METHOD
 15783           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15784        END-IF
 15785     END-IF
 15786     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15787                                        CP-REMAINING-BENEFIT
 15788                                        CP-RATING-BENEFIT-AMT.
 15789     IF CP-STATE-STD-ABBRV = 'OR'
 15790         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15791                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15792     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15793     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15794
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 285
* EL050.cbl
 15795     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15796
 15797     IF CP-ERROR-RATE-IS-ZERO OR
 15798        CP-ERROR-RATE-NOT-FOUND
 15799        MOVE ER-2740             TO WS-ERROR
 15800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15801
 15802     IF CP-ERROR-RATE-FILE-NOTOPEN
 15803        MOVE ER-2617             TO WS-ERROR
 15804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15805
 15806     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15807
 15808******************************************************************
 15809
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 286
* EL050.cbl
 15811 3730-GET-AH-REMAIN-TERM.
 15812     IF NO-AH-BENEFIT-MATCH  OR
 15813        WS-AH-BENEFIT-CD = ZEROS
 15814         GO TO 3770-CHECK-REFUNDS.
 15815
 15816     IF PB-CI-AH-LUMP-SUM-DISAB
 15817         IF  PB-C-AH-CANCEL-AMT = ZERO
 15818            IF NOT PB-COMP-AH-CANCEL
 15819             GO TO 3770-CHECK-REFUNDS.
 15820
 15821     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15822     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15823     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15824     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15825     MOVE PB-SV-STATE            TO CP-STATE.
 15826     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15827     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15828     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15829     MOVE '2'                    TO CP-PROCESS-TYPE.
 15830     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15831     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15832     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15833     IF (PB-COMPANY-ID = 'CID')
 15834        AND (CP-STATE-STD-ABBRV = 'WI')
 15835        MOVE '7'                 TO CP-REM-TERM-METHOD
 15836        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15837     ELSE
 15838        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15839        MOVE WS-REM-TRM-CALC-OPTION
 15840                                 TO CP-REM-TRM-CALC-OPTION
 15841     END-IF
 15842     IF (PB-COMPANY-ID = 'CID')
 15843        AND (CP-STATE-STD-ABBRV = 'MO')
 15844        AND (PB-CERT-EFF-DT >= X'9B41')
 15845        AND (PB-CERT-EFF-DT <= X'A2FB')
 15846        MOVE '7'                 TO CP-REM-TERM-METHOD
 15847        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15848     END-IF
 15849     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15850                                    CP-LOAN-TERM.
 15851     IF NOT CP-TERM-IS-DAYS
 15852         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15853
 15854     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15855
 15856     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15857
 15858     IF AH-COVERAGE-CANCELLED
 15859        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15860        NEXT SENTENCE
 15861      ELSE
 15862         GO TO 3770-CHECK-REFUNDS.
 15863
 15864 3740-GET-AH-REFUND.
 15865
 15866     IF PB-C-LF-CANCEL-VOIDED OR
 15867        PB-C-AH-CANCEL-VOIDED
 15868        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 287
* EL050.cbl
 15869
 15870     IF PB-COMPANY-ID = 'BOA'
 15871         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15872         GO TO 3770-CHECK-REFUNDS.
 15873
 15874     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15875*    MOVE ' '                    TO DC-OPTION-CODE
 15876     SET BIN-TO-GREG             TO TRUE
 15877     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15878     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15879                                    PB-C-AH-REM-TERM.
 15880     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15881     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15882
 15883     IF PB-COMPANY-ID EQUAL 'FLC'
 15884        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15885           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15886           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15887                    - CM-AH-ITD-AH-PMT)
 15888           IF PB-C-AH-REF-CALC LESS THAN +0
 15889              MOVE +0            TO PB-C-AH-REF-CALC
 15890              GO TO 3770-CHECK-REFUNDS
 15891           ELSE
 15892              GO TO 3770-CHECK-REFUNDS.
 15893
 15894     IF PB-COMPANY-ID = 'DCC'
 15895        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15896            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15897           MOVE 'S'              TO CP-EARNING-METHOD
 15898        END-IF
 15899     END-IF
 15900     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15901                            OR '4' OR '5' OR '6' OR '8'
 15902                            OR '9' OR 'G' OR 'S'
 15903        MOVE PB-C-AH-REFUND-OVERRIDE
 15904                                 TO CP-EARNING-METHOD.
 15905
 15906     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15907     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15908     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15909                                    CP-RATING-BENEFIT-AMT.
 15910     IF CP-STATE-STD-ABBRV = 'OR'
 15911         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15912                                         PB-CI-AH-TERM.
 15913     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15914     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15915     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15916     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15917     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15918     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15919
 15920     IF CP-STATE-STD-ABBRV = 'OH'
 15921        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15922                                AND 'CID' AND 'DCC' AND 'AHL')
 15923           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15924              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15925              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15926              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 288
* EL050.cbl
 15927           END-IF
 15928        END-IF
 15929        IF PB-COMPANY-ID = 'CID'
 15930           IF NO-LIFE-COVERAGE
 15931              IF CP-CRITICAL-PERIOD
 15932                 MOVE '2'       TO CP-EARNING-METHOD
 15933              ELSE
 15934                 MOVE '6'       TO CP-EARNING-METHOD
 15935              END-IF
 15936           ELSE
 15937              IF WS-LF-COVERAGE-TYPE = 'L'
 15938                 MOVE '2'       TO CP-EARNING-METHOD
 15939              ELSE
 15940                 IF (PB-CI-LF-TERM > +60) OR
 15941                    (WS-LF-EARNINGS-CALC = '5')
 15942                    IF CP-CRITICAL-PERIOD
 15943                       MOVE '2'  TO CP-EARNING-METHOD
 15944                    ELSE
 15945                       MOVE '6'  TO CP-EARNING-METHOD
 15946                    END-IF
 15947                 ELSE
 15948                    MOVE '1'     TO CP-EARNING-METHOD
 15949                 END-IF
 15950              END-IF
 15951           END-IF
 15952        END-IF
 15953     END-IF
 15954
 15955*    IF CP-STATE-STD-ABBRV = 'VA'
 15956*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15957*          IF CP-ORIGINAL-TERM GREATER 61
 15958*             MOVE '6' TO CP-EARNING-METHOD
 15959*          ELSE
 15960*             MOVE '1' TO CP-EARNING-METHOD.
 15961
 15962     IF WS-DEFAULT-APR NOT NUMERIC
 15963         MOVE ZEROS TO WS-DEFAULT-APR.
 15964     IF CP-EARN-AS-NET-PAY
 15965         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15966            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15967                MOVE WS-DEFAULT-APR
 15968                                 TO  CP-LOAN-APR
 15969                MOVE ER-3780     TO  WS-ERROR
 15970                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15971            ELSE
 15972                MOVE ER-3781     TO  WS-ERROR
 15973                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15974     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15975     IF PB-COMPANY-ID = 'DCC'
 15976        AND CP-CANCEL-REASON = 'R'
 15977        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15978        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15979     END-IF
 15980     IF PB-COMPANY-ID = 'DCC'
 15981        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15982        AND (CP-EARNING-METHOD = 'D')
 15983        AND (CP-CANCEL-REASON NOT = 'R')
 15984        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 289
* EL050.cbl
 15985     ELSE
 15986        GO TO 3750-CONTINUE
 15987     END-IF
 15988     MOVE ' '                    TO DD-IU-SW
 15989     IF NOT PDEF-MASTER-FOUND
 15990        MOVE ' '                 TO PDEF-MASTER-SW
 15991        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15992        MOVE PB-STATE            TO ERPDEF-STATE
 15993        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15994        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15995        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15996        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15997        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15998        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15999        IF PDEF-MASTER-FOUND
 16000           MOVE 'N'              TO PDEF-MASTER-SW
 16001           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16002           IF PDEF-MASTER-FOUND
 16003              IF (ERPDEF-KEY-SAVE (1:16) =
 16004                           PD-CONTROL-PRIMARY (1:16))
 16005                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16006                 CONTINUE
 16007              ELSE
 16008                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16009                 IF (ERPDEF-KEY-SAVE (1:16) =
 16010                           PD-CONTROL-PRIMARY (1:16))
 16011                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16012                    CONTINUE
 16013                 ELSE
 16014                    MOVE ER-2740 TO WS-ERROR
 16015                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16016                    GO TO 3770-CHECK-REFUNDS
 16017                 END-IF
 16018              END-IF
 16019           END-IF
 16020           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16021        END-IF
 16022     END-IF
 16023     IF PDEF-MASTER-FOUND
 16024        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16025           (V1 > +8)
 16026           OR (PD-PROD-CODE (V1) = 'I')
 16027        END-PERFORM
 16028        IF V1 < +9
 16029           SET DD-IU-PRESENT        TO TRUE
 16030        END-IF
 16031        IF WS-AH-DCC-TRUNC = 'T'
 16032           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16033        ELSE
 16034           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16035        END-IF
 16036        EVALUATE TRUE
 16037           WHEN WS-TERM > +168
 16038              MOVE 15               TO V1
 16039           WHEN WS-TERM > +156
 16040              MOVE 14               TO V1
 16041           WHEN WS-TERM > +144
 16042              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 290
* EL050.cbl
 16043           WHEN WS-TERM > +132
 16044              MOVE 12               TO V1
 16045           WHEN WS-TERM > +120
 16046              MOVE 11               TO V1
 16047           WHEN WS-TERM > +108
 16048              MOVE 10               TO V1
 16049           WHEN WS-TERM > +96
 16050              MOVE 9                TO V1
 16051           WHEN WS-TERM > +84
 16052              MOVE 8                TO V1
 16053           WHEN WS-TERM > +72
 16054              MOVE 7                TO V1
 16055           WHEN WS-TERM > +60
 16056              MOVE 6                TO V1
 16057           WHEN WS-TERM > +48
 16058              MOVE 5                TO V1
 16059           WHEN WS-TERM > +36
 16060              MOVE 4                TO V1
 16061           WHEN WS-TERM > +24
 16062              MOVE 3                TO V1
 16063           WHEN WS-TERM > +12
 16064              MOVE 2                TO V1
 16065           WHEN OTHER
 16066              MOVE 1                TO V1
 16067        END-EVALUATE
 16068
 16069        EVALUATE TRUE
 16070*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16071*             < +13)
 16072*             AND (DD-IU-PRESENT)
 16073*             MOVE 2                TO V2
 16074*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16075*             MOVE 1                TO V2
 16076           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16077              MOVE 2                TO V2
 16078           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16079              MOVE 3                TO V2
 16080           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16081              MOVE 4                TO V2
 16082           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16083              MOVE 5                TO V2
 16084           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16085              MOVE 6                TO V2
 16086           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16087              MOVE 7                TO V2
 16088           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16089              MOVE 8                TO V2
 16090           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16091              MOVE 9                TO V2
 16092           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16093              MOVE 10               TO V2
 16094           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16095              MOVE 11               TO V2
 16096           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16097              MOVE 12               TO V2
 16098           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16099              MOVE 13               TO V2
 16100           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 291
* EL050.cbl
 16101              MOVE 14               TO V2
 16102           WHEN OTHER
 16103              MOVE 15               TO V2
 16104        END-EVALUATE
 16105
 16106        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16107                                 TO CP-DDF-LO-FACT
 16108        MOVE PD-UEP-FACTOR (V1 V2)
 16109                                 TO CP-DDF-HI-FACT
 16110
 16111        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16112        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16113        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16114           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16115        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16116        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16117        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16118           + PD-1ST-YR-ADMIN-ALLOW
 16119
 16120        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16121*       IF PI-CLP-YN = 'Y'
 16122*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16123*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16124*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16125*       END-IF
 16126
 16127        IF DD-IU-PRESENT
 16128           MOVE 'I'              TO CP-EARNING-METHOD
 16129        END-IF
 16130        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16131                                     CP-CLP-RATE-UP
 16132        IF CP-IU-RATE-UP NOT = ZEROS
 16133           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16134              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16135           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16136              / (1 - WS-WORK-FACT)
 16137        END-IF
 16138     END-IF
 16139     .
 16140 3750-CONTINUE.
 16141     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16142
 16143     IF CP-REFUND-TYPE-USED NOT = SPACE
 16144         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16145
 16146     IF CP-ERROR-RATE-IS-ZERO OR
 16147        CP-ERROR-RATE-NOT-FOUND
 16148        MOVE ER-2740             TO WS-ERROR
 16149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16150
 16151     IF CP-ERROR-RATE-FILE-NOTOPEN
 16152        MOVE ER-2617             TO WS-ERROR
 16153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16154     IF PB-COMPANY-ID = 'DCC'
 16155        AND PB-CI-ENTRY-STATUS = 'M'
 16156        MOVE +0                  TO PB-C-AH-REF-CALC
 16157     ELSE
 16158        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 292
* EL050.cbl
 16159     END-IF
 16160     IF PB-COMPANY-ID = 'DCC'
 16161        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16162        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16163        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16164        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16165        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16166        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16167        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16168        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16169        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16170     END-IF
 16171     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 293
* EL050.cbl
 16173
 16174 3770-CHECK-REFUNDS.
 16175
 16176     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16177        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16178           MOVE ER-2766          TO WS-ERROR
 16179           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16180           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16181           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16182              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16183
 16184     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16185        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16186           MOVE ER-2766          TO WS-ERROR
 16187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16188           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16189           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16190              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16191
 16192     IF PB-COMP-LF-CANCEL
 16193        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16194        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16195           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16196              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16197
 16198     IF PB-COMP-AH-CANCEL
 16199        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16200        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16201           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16202              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16203
 16204     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16205             GIVING WS-UNSIGN-WRK1
 16206     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16207             GIVING WS-UNSIGN-WRK2.
 16208
 16209     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16210         MOVE ZERO TO WS-UNSIGN-WRK1.
 16211
 16212     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16213         MOVE ZERO TO WS-UNSIGN-WRK2.
 16214
 16215     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16216
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 294
* EL050.cbl
 16218
 16219 3772-CONTINUE.
 16220
 16221**********************************
 16222*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16223*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16224*** DOUBLES THE TOLERANCE AMOUNT.
 16225***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16226**********************************
 16227     IF PB-COMPANY-ID = 'MON'
 16228     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16229         IF WS-REF-REJECT-SW = SPACE
 16230             MOVE ER-2754        TO WS-ERROR
 16231             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16232           ELSE
 16233             MOVE ER-2736        TO WS-ERROR
 16234             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16235**********************************
 16236
 16237 3773-CONTINUE.
 16238
 16239     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16240        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16241           MOVE ER-2723          TO WS-ERROR
 16242           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16243
 16244     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16245        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16246           MOVE ER-2724          TO WS-ERROR
 16247           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16248
 16249     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16250         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16251             (1 + WS-LF-REFUND-OVS-PCT)
 16252     ELSE
 16253         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16254
 16255     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16256         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16257             (1 - WS-TOL-LF-REFUND-PCT)
 16258     ELSE
 16259         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16260
 16261     IF (PB-COMPANY-ID = 'DCC')
 16262        AND (PB-CI-ENTRY-STATUS = 'M')
 16263        AND (PB-C-LF-CANCEL-AMT > +0)
 16264        MOVE ER-3843             TO WS-ERROR
 16265        PERFORM 9900-ERROR-FORMAT
 16266                                 THRU 9900-EXIT
 16267     END-IF
 16268     EVALUATE TRUE
 16269        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16270           CONTINUE
 16271        WHEN PB-C-LF-CANCEL-AMT = +0
 16272                 AND PB-C-LF-REF-CALC > +0
 16273           CONTINUE
 16274        WHEN WS-LF-REFUND-OVS-AMT = 0
 16275                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 295
* EL050.cbl
 16276           CONTINUE
 16277        WHEN OTHER
 16278           IF WS-TOL-LF-REFUND  = +0
 16279              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16280           END-IF
 16281           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16282                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16283                          (PB-C-LF-CANCEL-AMT))
 16284              CONTINUE
 16285           ELSE
 16286              IF WS-LF-REFUND-OVS-AMT = +0
 16287                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16288              END-IF
 16289              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16290                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16291                                       PB-C-LF-CANCEL-AMT)
 16292                 CONTINUE
 16293              ELSE
 16294                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16295                   MOVE ER-2754   TO  WS-ERROR
 16296                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16297                 ELSE
 16298                    MOVE ER-2736   TO  WS-ERROR
 16299                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16300                 END-IF
 16301              END-IF
 16302           END-IF
 16303     END-EVALUATE.
 16304
 16305     EVALUATE TRUE
 16306        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16307           CONTINUE
 16308        WHEN PB-C-LF-CANCEL-AMT = +0
 16309                 AND PB-C-LF-REF-CALC > +0
 16310           CONTINUE
 16311        WHEN OTHER
 16312           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16313               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16314              CONTINUE
 16315           ELSE
 16316              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16317               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16318                CONTINUE
 16319              ELSE
 16320                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16321                     MOVE ER-2754   TO  WS-ERROR
 16322                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16323                 ELSE
 16324                     MOVE ER-2736   TO  WS-ERROR
 16325                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16326                 END-IF
 16327              END-IF
 16328           END-IF
 16329     END-EVALUATE.
 16330
 16331     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16332         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16333             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 296
* EL050.cbl
 16334     ELSE
 16335         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16336
 16337     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16338         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16339             (1 - WS-TOL-AH-REFUND-PCT)
 16340     ELSE
 16341         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16342
 16343     IF (PB-COMPANY-ID = 'DCC')
 16344        AND (PB-CI-ENTRY-STATUS = 'M')
 16345        AND (PB-C-AH-CANCEL-AMT > +0)
 16346        MOVE ER-3843             TO WS-ERROR
 16347        PERFORM 9900-ERROR-FORMAT
 16348                                 THRU 9900-EXIT
 16349     END-IF
 16350     EVALUATE TRUE
 16351        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16352           CONTINUE
 16353*       WHEN PB-C-AH-REF-CALC = +0 AND
 16354*                  PB-C-AH-CANCEL-AMT > +0
 16355        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16356                   PB-C-AH-REF-CALC > +0
 16357           CONTINUE
 16358        WHEN WS-AH-REFUND-OVS-AMT = +0
 16359                AND WS-TOL-AH-REFUND = +0
 16360           CONTINUE
 16361        WHEN OTHER
 16362           IF WS-TOL-AH-REFUND = +0
 16363              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16364           END-IF
 16365           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16366               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16367                                         PB-C-AH-CANCEL-AMT)
 16368              CONTINUE
 16369           ELSE
 16370              IF WS-AH-REFUND-OVS-AMT = +0
 16371                 MOVE +9999999.99 TO
 16372                         WS-AH-REFUND-OVS-AMT
 16373              END-IF
 16374              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16375                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16376                                         PB-C-AH-CANCEL-AMT)
 16377                 CONTINUE
 16378              ELSE
 16379                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16380                    MOVE ER-2754   TO  WS-ERROR
 16381                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16382                 ELSE
 16383                    MOVE ER-2736   TO  WS-ERROR
 16384                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16385                 END-IF
 16386              END-IF
 16387           END-IF
 16388     END-EVALUATE.
 16389
 16390     EVALUATE TRUE
 16391        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 297
* EL050.cbl
 16392           CONTINUE
 16393*       WHEN PB-C-AH-REF-CALC > +0 AND
 16394*                  PB-C-AH-CANCEL-AMT = +0
 16395        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16396                   PB-C-AH-REF-CALC = +0
 16397           CONTINUE
 16398        WHEN OTHER
 16399           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16400               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16401              CONTINUE
 16402           ELSE
 16403              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16404                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16405                 CONTINUE
 16406              ELSE
 16407                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16408                     MOVE ER-2754   TO  WS-ERROR
 16409                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16410                 ELSE
 16411                     MOVE ER-2736   TO  WS-ERROR
 16412                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16413                 END-IF
 16414              END-IF
 16415           END-IF
 16416     END-EVALUATE.
 16417
 16418     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16419        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16420        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16421           AND  PB-C-LF-REF-CALC < +1.00
 16422           AND  PB-C-AH-REF-CALC < +1.00
 16423           CONTINUE
 16424        ELSE
 16425           IF (PB-COMPANY-ID = 'DCC')
 16426              AND (PB-CI-ENTRY-STATUS = 'M')
 16427              CONTINUE
 16428           ELSE
 16429              MOVE ER-2741       TO WS-ERROR
 16430              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16431           END-IF
 16432        END-IF
 16433     END-IF
 16434
 16435     IF (PB-C-LF-CANCEL-AMT = ZERO
 16436        AND WS-LF-BENEFIT-CD NOT = ZERO
 16437        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16438        AND PB-C-LF-REF-CALC NOT = ZERO)
 16439        OR
 16440        (PB-C-LF-CANCEL-AMT = ZERO
 16441        AND WS-LF-BENEFIT-CD NOT = ZERO
 16442        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16443             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16444                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16445                NEXT SENTENCE
 16446             ELSE
 16447                MOVE ER-2739        TO WS-ERROR
 16448                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16449
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 298
* EL050.cbl
 16450     IF (PB-C-AH-CANCEL-AMT = ZERO
 16451        AND WS-AH-BENEFIT-CD NOT = ZERO
 16452        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16453        AND PB-C-AH-REF-CALC NOT = ZERO)
 16454        OR
 16455        (PB-C-AH-CANCEL-AMT = ZERO
 16456        AND WS-AH-BENEFIT-CD NOT = ZERO
 16457        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16458             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16459                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16460                NEXT SENTENCE
 16461             ELSE
 16462                MOVE ER-2738        TO WS-ERROR
 16463                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16464
 16465 3775-OVER-REF-CHK.
 16466
 16467     IF PB-CI-ENTRY-STATUS = '5'
 16468        GO TO 3780-UPDATE-CANCEL-CERT.
 16469
 16470     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16471                              PB-CI-LF-ALT-PREMIUM-AMT.
 16472
 16473     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16474        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16475                                 PB-C-LF-REF-CALC
 16476      ELSE
 16477        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16478                                 PB-C-LF-CANCEL-AMT.
 16479
 16480     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16481        MOVE ER-2755             TO WS-ERROR
 16482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16483
 16484     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16485
 16486     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16487        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16488                                 PB-C-AH-REF-CALC
 16489      ELSE
 16490        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16491                                 PB-C-AH-CANCEL-AMT.
 16492
 16493     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16494        MOVE ER-2778             TO WS-ERROR
 16495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16496
 16497     IF PB-CI-OB-FLAG NOT = 'Z'
 16498        NEXT SENTENCE
 16499       ELSE
 16500         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16501            MOVE ER-2757           TO WS-ERROR
 16502            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16503
 16504 3780-UPDATE-CANCEL-CERT.
 16505
 16506     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16507        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 299
* EL050.cbl
 16508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16509
 16510     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16511         MOVE ER-2729              TO WS-ERROR
 16512         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513
 16514     IF PB-CI-LF-BENEFIT-CD = ZERO
 16515         GO TO 3780-UPDATE-CONT-1.
 16516
 16517     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16518         GO TO 3780-UPDATE-CONT-1.
 16519
 16520     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16521       AND
 16522        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16523       AND
 16524        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16525       AND
 16526        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16527            NEXT SENTENCE
 16528       ELSE
 16529        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16530          AND
 16531***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16532***       AND
 16533           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16534            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16535               MOVE ER-2730      TO WS-ERROR
 16536               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16537               GO TO 3999-END-EDIT
 16538            ELSE
 16539               GO TO 3999-END-EDIT
 16540        ELSE
 16541            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16542               MOVE ER-2765           TO WS-ERROR
 16543               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16544               GO TO 3785-CHECK-NH.
 16545*              GO TO 3999-END-EDIT.
 16546
 16547 3780-UPDATE-CONT-1.
 16548     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16549
 16550     IF PB-CI-AH-BENEFIT-CD = ZERO
 16551         GO TO 3780-UPDATE-CONT-2.
 16552
 16553     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16554         GO TO 3780-UPDATE-CONT-2.
 16555
 16556     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16557
 16558     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16559       AND
 16560        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16561       AND
 16562        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16563       AND
 16564        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16565            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 300
* EL050.cbl
 16566       ELSE
 16567        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16568          AND
 16569***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16570***       AND
 16571           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16572           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16573            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16574               MOVE ER-2773      TO WS-ERROR
 16575               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16576               GO TO 3999-END-EDIT
 16577            ELSE
 16578               GO TO 3999-END-EDIT
 16579            END-IF
 16580           ELSE
 16581             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16582                MOVE ER-2890 TO WS-ERROR
 16583                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16584                GO TO 3999-END-EDIT
 16585             ELSE
 16586                GO TO 3785-CHECK-NH
 16587             END-IF
 16588           END-IF
 16589          ELSE
 16590            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16591              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16592                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16593                   MOVE ER-2890 TO WS-ERROR
 16594                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16595                   GO TO 3999-END-EDIT
 16596                ELSE
 16597                   MOVE ER-2765 TO WS-ERROR
 16598                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16599                   GO TO 3785-CHECK-NH
 16600                END-IF
 16601              ELSE
 16602               MOVE ER-2765      TO WS-ERROR
 16603               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16604               GO TO 3785-CHECK-NH.
 16605*              GO TO 3999-END-EDIT.
 16606
 16607 3780-UPDATE-CONT-2.
 16608
 16609     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16610        AND WS-LF-BENEFIT-CD = ZERO
 16611           MOVE ER-2743           TO WS-ERROR
 16612           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16613
 16614     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16615        AND WS-AH-BENEFIT-CD = ZERO
 16616           MOVE ER-2744           TO WS-ERROR
 16617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16618
 16619     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16620        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16621        AND
 16622        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16623         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 301
* EL050.cbl
 16624           MOVE ER-2746           TO WS-ERROR
 16625           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16626
 16627     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16628       AND
 16629        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16630             MOVE ER-2737        TO WS-ERROR
 16631             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16632
 16633     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16634       AND
 16635        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16636             MOVE ER-2737        TO WS-ERROR
 16637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16638
 16639     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16640         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16641             OR 'CID' OR 'DCC' OR 'AHL'
 16642             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16643         ELSE
 16644             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16645                 MOVE ER-2768    TO WS-ERROR
 16646                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16647             ELSE
 16648                 MOVE ER-2756    TO WS-ERROR
 16649                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16650
 16651     IF CERT-PEND-ISSUE-RETURNED
 16652        MOVE ER-2772             TO WS-ERROR
 16653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16654 3785-CHECK-NH.
 16655     IF PB-STATE NOT = 'NH'
 16656        GO TO 3999-END-EDIT
 16657     END-IF
 16658
 16659     MOVE ER-2796                TO WS-ERROR
 16660     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16661     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16662        OR (CM-NH-INTERFACE-SW = 'Y')
 16663        MOVE ER-2793             TO WS-ERROR
 16664        PERFORM 9900-ERROR-FORMAT
 16665                                 THRU 9900-EXIT
 16666     END-IF
 16667     MOVE +0                     TO WS-PAYMENT-AMT
 16668     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16669        GO TO 3999-END-EDIT
 16670     END-IF
 16671     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16672        GO TO 3999-END-EDIT
 16673     END-IF
 16674     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16675     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16676     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16677        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16678     END-IF
 16679     MOVE '1'                    TO DC-OPTION-CODE
 16680     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16681     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 302
* EL050.cbl
 16682        IF DC-ELAPSED-DAYS < +16
 16683           GO TO 3999-END-EDIT
 16684        END-IF
 16685     END-IF
 16686     MOVE +0                     TO DC-ELAPSED-DAYS
 16687     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16688     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16689     MOVE '1'                    TO DC-OPTION-CODE
 16690     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16691     IF NO-CONVERSION-ERROR
 16692        IF DC-ELAPSED-DAYS > +30
 16693           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16694        ELSE
 16695           GO TO 3999-END-EDIT
 16696        END-IF
 16697     ELSE
 16698        GO TO 3999-END-EDIT
 16699     END-IF
 16700     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16701        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16702           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16703     IF WS-PAYMENT-AMT < 600.00
 16704        GO TO 3999-END-EDIT
 16705     END-IF
 16706     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16707
 16708     IF (ERMAIL-FOUND = ' ')
 16709         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16710         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16711        GO TO 3999-END-EDIT
 16712     END-IF
 16713     MOVE ER-2795                TO WS-ERROR
 16714     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16715
 16716     GO TO 3999-END-EDIT.
 16717******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 303
* EL050.cbl
 16719 3990-FILES-NOT-OPEN.
 16720
 16721     MOVE ER-2617                TO WS-ERROR.
 16722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16723     GO TO 9990-RETURN.
 16724
 16725 3999-END-EDIT.
 16726
 16727     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16728
 16729     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16730         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16731         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16732             PERFORM 9250-UNLOCK-RETURN
 16733             GO TO 9990-RETURN
 16734          ELSE
 16735             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16736             GO TO 9990-RETURN.
 16737
 16738     IF PB-CANCELLATION
 16739          GO TO 9990-RETURN.
 16740
 16741     IF CERT-WAS-NOT-FOUND
 16742        MOVE SPACES              TO CERTIFICATE-MASTER.
 16743
 16744     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16745
 16746     IF CERT-WAS-FOUND
 16747         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16748             PERFORM 9250-UNLOCK-RETURN
 16749          ELSE
 16750            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16751      ELSE
 16752         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16753
 16754     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16755        IF PB-COMPANY-ID = 'DCC' AND
 16756           (PB-CARRIER = '2' OR '4' OR '6')
 16757              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16758        END-IF
 16759     END-IF.
 16760
 16761     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16762     IF ((PB-COMPANY-ID = 'DCC')
 16763        AND (WS-NO-SECURE-PAY))
 16764                  OR
 16765        (WS-LF-SPECIAL-CALC-CD = 'O'
 16766        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16767        SET SKIP-ADDR-EDIT       TO TRUE
 16768     END-IF
 16769     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16770        AND (NOT SKIP-ADDR-EDIT)
 16771        MOVE ER-2963             TO WS-ERROR
 16772        PERFORM 9900-ERROR-FORMAT
 16773                                 THRU 9900-EXIT
 16774        GO TO 9990-RETURN
 16775     END-IF
 16776     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 304
* EL050.cbl
 16777     IF ERPNDM-FOUND NOT = 'X'
 16778        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16779           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16780           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16781           AND (NOT SKIP-ADDR-EDIT)
 16782           MOVE ER-2694          TO WS-ERROR
 16783           PERFORM 9900-ERROR-FORMAT
 16784                                 THRU 9900-EXIT
 16785        END-IF
 16786        MOVE ' '                 TO STATE-RECORD-ERROR
 16787        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16788        MOVE PM-STATE            TO CNTL-ACCESS
 16789        MOVE '3'                 TO CNTL-REC-TYPE
 16790        MOVE +0                  TO CNTL-SEQ-NO
 16791        MOVE '0'                 TO RC-SW-2
 16792        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16793        IF (NO-STATE-RECORD)
 16794           OR (CF-RECORD-TYPE NOT = '3')
 16795           OR (PM-STATE NOT = CF-STATE-CODE)
 16796           IF (PM-STATE = SPACES)
 16797              AND (SKIP-ADDR-EDIT)
 16798              CONTINUE
 16799           ELSE
 16800              MOVE ER-2963       TO WS-ERROR
 16801              PERFORM 9900-ERROR-FORMAT
 16802                                 THRU 9900-EXIT
 16803           END-IF
 16804        END-IF
 16805        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16806           MOVE ER-2883          TO WS-ERROR
 16807           PERFORM 9900-ERROR-FORMAT
 16808                                 THRU 9900-EXIT
 16809        END-IF
 16810        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16811           MOVE ' '                 TO STATE-RECORD-ERROR
 16812           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16813           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16814           MOVE '3'                 TO CNTL-REC-TYPE
 16815           MOVE +0                  TO CNTL-SEQ-NO
 16816           MOVE '0'                 TO RC-SW-2
 16817           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16818           IF NO-STATE-RECORD
 16819              OR (CF-RECORD-TYPE NOT = '3')
 16820              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16821              MOVE ER-2964          TO WS-ERROR
 16822              PERFORM 9900-ERROR-FORMAT
 16823                                    THRU 9900-EXIT
 16824           END-IF
 16825        END-IF
 16826     ELSE
 16827        IF NOT SKIP-ADDR-EDIT
 16828           MOVE ER-2393          TO WS-ERROR
 16829           PERFORM 9900-ERROR-FORMAT
 16830                                 THRU 9900-EXIT
 16831        END-IF
 16832     END-IF
 16833
 16834     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 305
* EL050.cbl
 16835
 16836     IF (ERMAIL-FOUND = ' ' AND
 16837        ERPNDM-FOUND = ' ')
 16838        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16839           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16840           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16841          OR
 16842           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16843          OR
 16844           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16845           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16846           GO TO 3999-UNLOCK-ERMAIL.
 16847
 16848     IF ERPNDM-FOUND = 'X'
 16849        GO TO 3999-UNLOCK-ERMAIL.
 16850
 16851     IF PM-INSURED-LAST-NAME      = SPACES
 16852        AND PM-INSURED-FIRST-NAME = SPACES
 16853        AND PM-ADDRESS-LINE-1     = SPACES
 16854        AND PM-ADDRESS-LINE-2     = SPACES
 16855        AND PM-CITY-STATE         = SPACES
 16856        AND PM-CRED-BENE-NAME     = SPACES
 16857        AND PM-CRED-BENE-ADDR     = SPACES
 16858        AND PM-CRED-BENE-CTYST    = SPACES
 16859        GO TO 3999-UNLOCK-ERMAIL
 16860     END-IF
 16861
 16862     MOVE SPACES                 TO MAILING-DATA.
 16863
 16864     MOVE 'MA'                   TO MA-RECORD-ID.
 16865     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16866     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16867     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16868     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16869     MOVE PB-SV-STATE            TO MA-STATE.
 16870     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16871     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16872
 16873     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16874     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16875
 16876     IF ERMAIL-FOUND = ' '
 16877        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16878     ELSE
 16879        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16880        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16881        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16882
 16883     GO TO 9990-RETURN.
 16884
 16885 3999-UNLOCK-ERMAIL.
 16886     IF ERMAIL-FOUND = ' '
 16887        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16888
 16889     GO TO 9990-RETURN.
 16890******************************************************************
 16891
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 306
* EL050.cbl
 16893 4000-UPDATE-CANCELLED-CERT.
 16894     IF CERT-WAS-NOT-FOUND
 16895        GO TO 4299-EXIT.
 16896
 16897*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16898     IF PB-C-NH-INT-ON-REFS > ZEROS
 16899        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16900     END-IF
 16901     IF PB-C-REF-INTERFACE-SW = 'Y'
 16902        MOVE PB-C-REF-INTERFACE-SW
 16903                                 TO CM-NH-INTERFACE-SW
 16904     END-IF
 16905     IF PB-C-POST-CARD-IND = 'Y'
 16906        MOVE +8                  TO SUB
 16907        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16908        IF ERMAIL-FOUND = ' '
 16909           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16910              (SUB > +7)
 16911              OR (MA-MAIL-STATUS (SUB) = '1')
 16912           END-PERFORM
 16913        END-IF
 16914        IF (SUB > +7)
 16915           OR (ERMAIL-FOUND = 'X')
 16916           MOVE ER-3789          TO WS-ERROR
 16917           PERFORM 9900-ERROR-FORMAT
 16918                                 THRU 9900-EXIT
 16919        END-IF
 16920     ELSE
 16921        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16922     END-IF
 16923     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16924
 16925     IF PB-CI-OB-FLAG = 'Z'
 16926        GO TO 4150-SUMMARY-CERT-CANCEL.
 16927
 16928     IF PB-C-LF-CANCEL-VOIDED
 16929         PERFORM 4200-REVERSE-LF-CANCEL.
 16930     IF PB-C-AH-CANCEL-VOIDED
 16931         PERFORM 4200-REVERSE-AH-CANCEL.
 16932
 16933 4100-APPLY-LF-CANCEL.
 16934
 16935     MOVE +0                     TO WS-SUB.
 16936
 16937 4100-CHECK-LF-ERRORS.
 16938
 16939     ADD +1                       TO WS-SUB.
 16940
 16941     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16942        IF LF-COVERAGE-CANCELLED
 16943           GO TO 4100-LF-CANCEL-CONT
 16944        ELSE
 16945           GO TO 4100-UPDATE-LF-COVERAGE.
 16946
 16947     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16948                                   ER-2729 OR
 16949                                   ER-2730 OR
 16950                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 307
* EL050.cbl
 16951                                   ER-2732 OR
 16952                                   ER-2737 OR
 16953                                   ER-2740 OR
 16954                                   ER-2743 OR
 16955                                   ER-2749 OR
 16956                                   ER-2750 OR
 16957                                   ER-2755 OR
 16958                                   ER-2757 OR
 16959                                   ER-2760 OR
 16960                                   ER-2772 OR
 16961                                   ER-2774 OR
 16962                                   ER-2776 OR
 16963                                   ER-2794
 16964        GO TO 4100-UPDATE-LF-COVERAGE.
 16965
 16966     GO TO 4100-CHECK-LF-ERRORS.
 16967
 16968 4100-UPDATE-LF-COVERAGE.
 16969
 16970     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16971     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16972     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16973        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16974     END-IF
 16975     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16976                                      TO CM-CREDIT-INTERFACE-SW-2.
 16977     IF CM-LF-CANCEL-DT = LOW-VALUE
 16978         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16979
 16980     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16981         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16982                                         CM-LF-STATUS-AT-CANCEL.
 16983
 16984     GO TO 4100-APPLY-AH-CANCEL.
 16985
 16986 4100-LF-CANCEL-CONT.
 16987     IF PB-C-LF-CANCEL-VOIDED
 16988         GO TO 4100-APPLY-AH-CANCEL.
 16989
 16990     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16991         GO TO 4100-APPLY-AH-CANCEL.
 16992
 16993     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16994        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16995           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16996        ELSE
 16997           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16998
 16999     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17000     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17001
 17002     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17003         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17004
 17005     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17006        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17007         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17008         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 308
* EL050.cbl
 17009
 17010     IF PB-RECORD-RETURNED
 17011        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17012      ELSE
 17013        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17014
 17015 4100-APPLY-AH-CANCEL.
 17016
 17017     MOVE +0                      TO WS-SUB.
 17018
 17019 4100-CHECK-AH-ERRORS.
 17020
 17021     ADD +1                       TO WS-SUB.
 17022
 17023     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17024        IF AH-COVERAGE-CANCELLED
 17025           GO TO 4100-AH-CANCEL-CONT
 17026        ELSE
 17027           GO TO 4100-UPDATE-AH-COVERAGE.
 17028
 17029     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17030                                   ER-2729 OR
 17031                                   ER-2732 OR
 17032                                   ER-2737 OR
 17033                                   ER-2740 OR
 17034                                   ER-2744 OR
 17035                                   ER-2749 OR
 17036                                   ER-2750 OR
 17037                                   ER-2755 OR
 17038                                   ER-2757 OR
 17039                                   ER-2760 OR
 17040                                   ER-2771 OR
 17041                                   ER-2772 OR
 17042                                   ER-2773 OR
 17043                                   ER-2775 OR
 17044                                   ER-2777 OR
 17045                                   ER-2794
 17046        GO TO 4100-UPDATE-AH-COVERAGE.
 17047
 17048     GO TO 4100-CHECK-AH-ERRORS.
 17049
 17050 4100-UPDATE-AH-COVERAGE.
 17051
 17052     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17053     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17054     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17055     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17056                                      TO CM-CREDIT-INTERFACE-SW-2.
 17057     IF CM-AH-CANCEL-DT = LOW-VALUE
 17058         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17059
 17060     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17061         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17062                                         CM-AH-STATUS-AT-CANCEL.
 17063
 17064     IF LF-COVERAGE-CANCELLED
 17065         IF PB-RECORD-RETURNED
 17066              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 309
* EL050.cbl
 17067          ELSE
 17068              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17069
 17070     GO TO 4299-EXIT.
 17071
 17072 4100-AH-CANCEL-CONT.
 17073     IF PB-C-AH-CANCEL-VOIDED
 17074         GO TO 4299-EXIT.
 17075
 17076     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17077         GO TO 4299-EXIT.
 17078
 17079     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17080        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17081           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17082        ELSE
 17083           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17084
 17085     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17086     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17087
 17088     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17089         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17090
 17091     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17092         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17093         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17094
 17095     IF PB-RECORD-RETURNED
 17096        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17097      ELSE
 17098        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17099
 17100     GO TO 4299-EXIT.
 17101
 17102 4150-SUMMARY-CERT-CANCEL.
 17103     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17104
 17105     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17106        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17107                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17108     ELSE
 17109        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17110                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17111
 17112     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17113        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17114                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17115     ELSE
 17116        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17117                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17118
 17119     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17120        NEXT SENTENCE
 17121     ELSE
 17122        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17123
 17124     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 310
* EL050.cbl
 17125
 17126 4200-REVERSE-LF-CANCEL.
 17127     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17128
 17129     IF CM-LF-CANCEL-APPLIED
 17130        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17131        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17132        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17133
 17134     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17135
 17136     IF PB-RECORD-RETURNED
 17137        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17138       ELSE
 17139        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17140
 17141 4200-REVERSE-LF-EXIT.
 17142       EXIT.
 17143
 17144 4200-REVERSE-AH-CANCEL.
 17145     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17146
 17147     IF CM-AH-CANCEL-APPLIED
 17148        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17149        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17150        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17151
 17152     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17153
 17154     IF PB-RECORD-RETURNED
 17155        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17156       ELSE
 17157        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17158
 17159 4200-REVERSE-AH-EXIT.
 17160       EXIT.
 17161
 17162 4299-EXIT.
 17163       EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 311
* EL050.cbl
 17165
 17166 4500-UPDATE-NEW-CERT.
 17167     IF CERT-WAS-FOUND
 17168         NEXT SENTENCE
 17169       ELSE
 17170         GO TO 4520-BUILD-NEW-KEY.
 17171
 17172     IF  CLASIC-CREATED-CERT
 17173         GO TO 4999-EXIT.
 17174
 17175     IF  CERT-WAS-CREATED-FOR-CLAIM
 17176         GO TO 4520-BUILD-NEW-KEY.
 17177
 17178     IF CERT-ADDED-BATCH
 17179        IF CM-RECORD-ID = 'CM'
 17180            GO TO 4999-EXIT.
 17181
 17182 4520-BUILD-NEW-KEY.
 17183* BUILD CONTROL PRIMARY
 17184
 17185     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17186                                       CM-COMPANY-CD-A1
 17187                                       CM-COMPANY-CD-A2
 17188                                       CM-COMPANY-CD-A4
 17189                                       CM-COMPANY-CD-A5.
 17190
 17191     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17192     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17193     MOVE PB-SV-STATE               TO CM-STATE.
 17194     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17195     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17196     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17197     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17198
 17199     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17200
 17201     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17202     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17203     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17204     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17205
 17206     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17207        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17208
 17209     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17210         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17211         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17212         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17213         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17214     ELSE
 17215         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17216
 17217     IF PB-COMPANY-ID   EQUAL  'CRI'
 17218         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17219         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17220         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17221         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17222         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 312
* EL050.cbl
 17223
 17224     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17225        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17226         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17227
 17228     IF PB-COMPANY-ID  = 'LBL'
 17229        IF PB-I-JOINT-COVERAGE
 17230            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17231                                           PB-I-MEMBER-NO
 17232            GO TO 4550-CONT-CERT-PROCESS.
 17233
 17234     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17235        NEXT SENTENCE
 17236     ELSE
 17237        GO TO 4540-BUILD-MEMBER-NO.
 17238
 17239******************************************************************
 17240*                                                                *
 17241*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17242*    FOR 'MON'.                                                  *
 17243*                                                                *
 17244******************************************************************
 17245
 17246     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17247     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17248     MOVE +1                     TO WS-SUB1
 17249                                    WS-SUB2.
 17250
 17251 4530-EDIT-MEMB-NAME.
 17252
 17253     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17254        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17255        ADD +1                       TO WS-SUB2.
 17256
 17257     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17258        ADD +1                       TO WS-SUB1
 17259        GO TO 4530-EDIT-MEMB-NAME.
 17260
 17261     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17262     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17263     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17264*    MOVE SPACE                      TO DC-OPTION-CODE.
 17265     SET  BIN-TO-GREG                TO TRUE.
 17266     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17267     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17268
 17269     GO TO 4550-CONT-CERT-PROCESS.
 17270
 17271******************************************************************
 17272*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17273******************************************************************
 17274
 17275 4540-BUILD-MEMBER-NO.
 17276
 17277     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17278         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17279         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17280         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 313
* EL050.cbl
 17281         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17282     ELSE
 17283         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17284
 17285     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17286        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17287         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17288
 17289 4550-CONT-CERT-PROCESS.
 17290
 17291*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17292*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17293*    ELSE
 17294*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17295
 17296     IF CERT-WAS-CREATED-FOR-CLAIM
 17297        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17298        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17299
 17300     IF CERT-AND-CLAIM-ONLINE
 17301        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17302        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17303
 17304     MOVE 'CM'                     TO CM-RECORD-ID.
 17305     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17306
 17307     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17308        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17309        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17310     ELSE
 17311        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17312        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17313
 17314     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17315     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17316     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17317     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17318     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17319     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17320     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17321                                      CM-LF-ITD-CANCEL-AMT
 17322                                      CM-LF-ITD-DEATH-AMT
 17323                                      CM-AH-ITD-AH-PMT
 17324                                      CM-AH-ITD-LUMP-PMT
 17325                                      CM-AH-ITD-CANCEL-AMT
 17326                                      CM-LF-NSP-PREMIUM-AMT
 17327                                      CM-AH-NSP-PREMIUM-AMT.
 17328*                                     CM-CLAIM-DEDUCT-WITHHELD
 17329*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17330     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17331     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17332     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17333     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17334     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17335     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17336     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17337     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17338     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 314
* EL050.cbl
 17339     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17340     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17341     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17342
 17343     IF PB-I-LIVES NOT NUMERIC
 17344         MOVE ZERO                 TO PB-I-LIVES.
 17345
 17346     IF PB-I-NUM-BILLED NOT NUMERIC
 17347         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17348
 17349     MOVE PB-I-LIVES               TO CM-LIVES.
 17350     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17351
 17352     IF PB-COMPANY-ID EQUAL  'DMD'
 17353         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17354         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17355
 17356     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17357     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17358     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17359     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17360     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17361     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17362
 17363     IF PB-I-LF-POLICY-FEE NUMERIC
 17364        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17365     ELSE
 17366        MOVE +0                    TO CM-LF-POLICY-FEE.
 17367
 17368     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17369        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17370        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17371     ELSE
 17372        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17373
 17374     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17375     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17376     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17377     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17378     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17379     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17380     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17381     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17382     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17383
 17384     IF PB-I-AH-POLICY-FEE NUMERIC
 17385        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17386     ELSE
 17387        MOVE +0                    TO CM-AH-POLICY-FEE.
 17388
 17389     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17390        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17391     ELSE
 17392        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17393
 17394     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17395     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17396
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 315
* EL050.cbl
 17397     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17398                                      CM-LF-DEATH-EXIT-DT
 17399                                      CM-AH-SETTLEMENT-EXIT-DT.
 17400
 17401*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17402*                       'TIH' OR 'OFL' OR 'FLA' OR
 17403*                       'TII' OR 'TMS' OR 'CRI' OR
 17404*                       'NCL'
 17405     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17406
 17407     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17408         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17409            MOVE '2'                TO CM-PREMIUM-TYPE.
 17410
 17411     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17412         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17413            MOVE '2'                TO CM-PREMIUM-TYPE.
 17414
 17415     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17416         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17417     ELSE
 17418         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17419         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17420
 17421     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17422     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17423     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17424     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17425     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17426     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17427     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17428     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17429
 17430     IF PB-NO-MONTHS-SKIPPED
 17431         MOVE SPACE                 TO CM-SKIP-CODE
 17432     ELSE
 17433         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17434
 17435     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17436     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17437                                       CM-LF-STATUS-AT-CANCEL.
 17438
 17439     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17440     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17441                                       CM-AH-STATUS-AT-CANCEL.
 17442
 17443     MOVE '1'                       TO CM-ENTRY-STATUS.
 17444
 17445     IF PB-REISSUED-CERT
 17446        MOVE '5'                    TO CM-ENTRY-STATUS.
 17447
 17448     IF PB-MONTHLY-CERT
 17449        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17450
 17451     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17452     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17453     IF PB-POLICY-IS-DECLINED
 17454        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 316
* EL050.cbl
 17455
 17456     IF PB-POLICY-IS-VOIDED
 17457        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17458
 17459     IF PB-NEEDS-UNDERWRITING
 17460        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17461
 17462     IF PB-REIN-ONLY-CERT
 17463        MOVE '9'                    TO CM-ENTRY-STATUS.
 17464
 17465     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17466         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17467     ELSE
 17468         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17469
 17470     IF PB-RECORD-RETURNED
 17471        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17472      ELSE
 17473        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17474
 17475     IF PB-I-MAIL-ADDRS-PRESENT
 17476        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17477
 17478     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17479                                       CM-ENTRY-DT.
 17480
 17481 4999-EXIT.
 17482     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 317
* EL050.cbl
 17484
 17485 5000-PROCESS-REPS.
 17486     MOVE ' '                    TO AGTC-MASTER-SW
 17487     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17488     MOVE CO-TYPE                TO AGTC-TYPE
 17489     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17490     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17491     IF (AGTC-MASTER-SW NOT = 'N')
 17492        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17493        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17494        PERFORM 8583-READ-ERAGTC-NEXT
 17495                                 THRU 8583-EXIT
 17496     END-IF
 17497     IF AGTC-MASTER-SW = 'N'
 17498        CONTINUE
 17499     ELSE
 17500        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17501           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17502              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17503              MOVE 'Y'           TO AGTC-MASTER-SW
 17504           END-IF
 17505        END-IF
 17506     END-IF
 17507     .
 17508 5000-EXIT.
 17509     EXIT.
 17510 6370-EDIT-INPUT-LF-CODE.
 17511     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17512        MOVE +1                  TO SUB
 17513        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17514        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17515        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17516        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17517        GO TO 6370-SEARCH-LOOP.
 17518
 17519     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17520
 17521     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17522     MOVE SPACES                 TO CNTL-ACCESS.
 17523*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17524     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17525     MOVE +0                     TO CNTL-SEQ-NO.
 17526     MOVE '4' TO RC-SW-2.
 17527     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17528
 17529     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17530        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17531        GO TO 6370-NO-LF-FOUND.
 17532
 17533     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17534     MOVE +1                     TO SUB.
 17535
 17536 6370-SEARCH-LOOP.
 17537     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17538         GO TO 6370-NO-LF-FOUND.
 17539
 17540     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17541         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 318
* EL050.cbl
 17542         GO TO 6370-HER-NET-PAY-CHECK.
 17543
 17544     ADD 1   TO SUB.
 17545*    IF SUB GREATER 120
 17546     IF SUB GREATER 200
 17547         GO TO 6370-NO-LF-FOUND.
 17548
 17549     GO TO 6370-SEARCH-LOOP.
 17550
 17551 6370-NO-LF-FOUND.
 17552
 17553     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17554
 17555 6370-HER-NET-PAY-CHECK.
 17556
 17557     IF PB-COMPANY-ID = 'CID'
 17558        IF PB-SV-STATE = 'CA' OR 'MN'
 17559           IF PB-I-LF-BENEFIT-CD = '02'
 17560              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17561           ELSE
 17562              IF PB-I-LF-BENEFIT-CD = '04'
 17563                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17564              END-IF
 17565           END-IF
 17566        END-IF
 17567     END-IF
 17568
 17569     IF PB-COMPANY-ID NOT = 'HER'
 17570         GO TO 6370-EXIT.
 17571
 17572     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17573         GO TO 6370-EXIT.
 17574
 17575     IF PB-I-LF-TERM NOT NUMERIC
 17576         MOVE ZEROS              TO PB-I-LF-TERM.
 17577
 17578     IF PB-I-LOAN-TERM NOT NUMERIC
 17579         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17580
 17581     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17582         GO TO 6370-EXIT.
 17583
 17584     IF PB-I-LF-BENEFIT-CD = '33'
 17585         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17586
 17587     IF PB-I-LF-BENEFIT-CD = '34'
 17588         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17589
 17590 6370-EXIT.
 17591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 319
* EL050.cbl
 17593
 17594 6380-EDIT-INPUT-AH-CODE.
 17595     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17596        MOVE +1                  TO SUB
 17597        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17598        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17599        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17600        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17601        GO TO 6380-SEARCH-LOOP.
 17602
 17603     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17604
 17605     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17606     MOVE SPACES                 TO CNTL-ACCESS.
 17607     MOVE 'A'                    TO CNTL-REC-TYPE.
 17608*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17609     MOVE +0                     TO CNTL-SEQ-NO.
 17610     MOVE '5' TO RC-SW-2.
 17611     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17612
 17613     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17614        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17615        GO TO 6380-NO-AH-FOUND.
 17616
 17617     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17618     MOVE +1 TO SUB.
 17619
 17620 6380-SEARCH-LOOP.
 17621     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17622         GO TO 6380-NO-AH-FOUND.
 17623
 17624     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17625         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17626         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17627
 17628     ADD 1   TO SUB.
 17629     IF SUB GREATER THAN 96
 17630*    IF SUB GREATER THAN 300
 17631         GO TO 6380-NO-AH-FOUND.
 17632
 17633     GO TO 6380-SEARCH-LOOP.
 17634
 17635 6380-NO-AH-FOUND.
 17636
 17637     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17638
 17639     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17640         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17641     ELSE
 17642         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17643
 17644 6380-CSO-AH-ONLY-CHECKS.
 17645
 17646     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17647        NEXT SENTENCE
 17648      ELSE
 17649        GO TO 6380-EXIT.
 17650
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 320
* EL050.cbl
 17651     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17652         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17653
 17654
 17655     GO TO 6380-EXIT
 17656     .
 17657 6380-CSO-LIFE-WITH-AH-CHECKS.
 17658
 17659
 17660     .
 17661 6380-EXIT.
 17662     EXIT.
 17663
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 321
* EL050.cbl
 17665
 17666 6400-COMPUTE-EXTENSION-DAYS.
 17667
 17668******************************************************************
 17669*                                                                *
 17670*                   COMPUTE EXTENSION DAYS                       *
 17671*                                                                *
 17672*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17673*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17674*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17675*    THE EXTENSION DAYS.                                         *
 17676*                                                                *
 17677******************************************************************
 17678
 17679     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17680     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17681
 17682******************************************************************
 17683*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17684*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17685******************************************************************
 17686
 17687     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17688        COMPUTE WS-ODD-DAYS-OVER =
 17689               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17690     ELSE
 17691        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17692
 17693     IF WS-ODD-DAYS-OVER = ZEROS
 17694           GO TO 6499-EXIT
 17695     ELSE
 17696        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17697           IF WS-WDF-MONTH = 02
 17698              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17699              ADD 2       TO  WS-ODD-DAYS-OVER
 17700              GO TO 6499-EXIT
 17701           ELSE
 17702              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17703                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17704                 GO TO 6499-EXIT
 17705               ELSE
 17706                 GO TO 6499-EXIT
 17707        ELSE
 17708           GO TO 6499-EXIT.
 17709
 17710 6412-CHECK-TO-DAY.
 17711
 17712        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17713           IF WS-WDT-DAY = 28
 17714              ADD 2              TO WS-ODD-DAYS-OVER
 17715           ELSE
 17716              IF WS-WDT-DAY = 29
 17717                 ADD 1           TO WS-ODD-DAYS-OVER
 17718              ELSE
 17719                 NEXT SENTENCE
 17720        ELSE
 17721           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17722              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 322
* EL050.cbl
 17723
 17724     GO TO 6499-EXIT.
 17725
 17726
 17727 6415-CHECK-LEAP-YEAR.
 17728
 17729     IF DC-DAYS-IN-MONTH = 29
 17730        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17731
 17732 6415-EXIT.
 17733     EXIT.
 17734
 17735 6499-EXIT.
 17736      EXIT.
 17737
 17738 6500-END.
 17739     EXIT.
 17740
 17741
 17742******************************************************************
 17743************* PROCEDURE DIVISION FOR EL050 ***********************
 17744********************** ELC50PD END *******************************
 17745
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 323
* EL050.cbl
 17747
 17748**START***********************************************************
 17749*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17750*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17751******************************************************************
 17752*
 17753 6600-GET-STATE-MUNICIPAL-TAX.
 17754
 17755     IF PB-COMPANY-ID NOT = 'DMD'
 17756         GO TO 6640-EXIT.
 17757
 17758     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17759     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17760     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17761*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17762*
 17763***  Y2K PROJ 7744
 17764     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17765     SET BIN-TO-GREG          TO TRUE.
 17766     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17767
 17768     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17769
 17770     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17771     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17772
 17773
 17774* EXEC CICS HANDLE CONDITION
 17775*        INVREQ    (6610-START-BROWSE)
 17776*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17777*        NOTFND    (6630-END-OF-FILE)
 17778*    END-EXEC.
 17779*    MOVE '"$8JI                 ! # #00017761' TO DFHEIV0
 17780     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17782     MOVE X'2320233030303137373631' TO DFHEIV0(25:11)
 17783     CALL 'kxdfhei1' USING DFHEIV0
 17784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17785
 17786
 17787 6610-START-BROWSE.
 17788
 17789
 17790* EXEC CICS HANDLE CONDITION
 17791*        NOTFND    (6630-END-OF-FILE)
 17792*        DISABLED  (6630-ERRESS-PROBLEM)
 17793*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17794*        ENDFILE   (6630-END-OF-FILE)
 17795*    END-EXEC.
 17796*    MOVE '"$IcJ''                ! $ #00017769' TO DFHEIV0
 17797     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17799     MOVE X'2420233030303137373639' TO DFHEIV0(25:11)
 17800     CALL 'kxdfhei1' USING DFHEIV0
 17801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17802
 17803
 17804
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 324
* EL050.cbl
 17805* EXEC CICS STARTBR
 17806*        DATASET (FILE-ID-ERRESS)
 17807*        RIDFLD  (WS-ERRESS-KEY)
 17808*        GTEQ
 17809*    END-EXEC.
 17810     MOVE 0
 17811       TO DFHEIV11
 17812*    MOVE '&,         G          &   #00017776' TO DFHEIV0
 17813     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17815     MOVE X'2020233030303137373736' TO DFHEIV0(25:11)
 17816     CALL 'kxdfhei1' USING DFHEIV0,
 17817           FILE-ID-ERRESS,
 17818           WS-ERRESS-KEY,
 17819           DFHEIV99,
 17820           DFHEIV11,
 17821           DFHEIV99
 17822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17823
 17824
 17825 6620-READ-NEXT-ERRESS-MASTER.
 17826
 17827
 17828* EXEC CICS HANDLE CONDITION
 17829*        NOTFND    (6630-END-OF-FILE)
 17830*        ENDFILE   (6630-END-OF-FILE)
 17831*        DISABLED  (6630-ERRESS-PROBLEM)
 17832*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17833*    END-EXEC.
 17834*    MOVE '"$I''cJ                ! % #00017784' TO DFHEIV0
 17835     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17837     MOVE X'2520233030303137373834' TO DFHEIV0(25:11)
 17838     CALL 'kxdfhei1' USING DFHEIV0
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
 17842
 17843* EXEC CICS READNEXT
 17844*        DATASET (FILE-ID-ERRESS)
 17845*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17846*        RIDFLD  (WS-ERRESS-KEY)
 17847*    END-EXEC.
 17848     MOVE LENGTH OF
 17849      RESIDENT-STATE-TAX-MASTER
 17850       TO DFHEIV12
 17851     MOVE 0
 17852       TO DFHEIV11
 17853*    MOVE '&.IL                  )   #00017791' TO DFHEIV0
 17854     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17855     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17856     MOVE X'2020233030303137373931' TO DFHEIV0(25:11)
 17857     CALL 'kxdfhei1' USING DFHEIV0,
 17858           FILE-ID-ERRESS,
 17859           RESIDENT-STATE-TAX-MASTER,
 17860           DFHEIV12,
 17861           WS-ERRESS-KEY,
 17862           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 325
* EL050.cbl
 17863           DFHEIV11,
 17864           DFHEIV99,
 17865           DFHEIV99
 17866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17867
 17868
 17869     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17870
 17871* EXEC CICS ENDBR
 17872*            DATASET (FILE-ID-ERRESS)
 17873*       END-EXEC
 17874     MOVE 0
 17875       TO DFHEIV11
 17876*    MOVE '&2                    $   #00017798' TO DFHEIV0
 17877     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17878     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17879     MOVE X'2020233030303137373938' TO DFHEIV0(25:11)
 17880     CALL 'kxdfhei1' USING DFHEIV0,
 17881           FILE-ID-ERRESS,
 17882           DFHEIV11,
 17883           DFHEIV99
 17884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17885        GO TO 6630-END-OF-FILE.
 17886
 17887     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17888        NEXT SENTENCE
 17889      ELSE
 17890        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17891
 17892*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17893*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17894*
 17895     MOVE +2                     TO WS-SUB1.
 17896
 17897     IF PB-ISSUE
 17898     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17899        MOVE +1                  TO WS-SUB1.
 17900
 17901     IF PB-CANCELLATION
 17902     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17903        MOVE +1                  TO WS-SUB1.
 17904*
 17905*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17906*
 17907***  Y2K PROJ 7744
 17908     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17909***  Y2K PROJ 7744
 17910
 17911*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17912* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17913* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17914
 17915     ADD 1                    TO WS-YEAR-YY.
 17916
 17917     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17918         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17919                              TO WS-RES-STATE-TAX
 17920         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 326
* EL050.cbl
 17921                              TO WS-RES-MUNI-TAX
 17922     ELSE
 17923         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17924                              TO WS-RES-STATE-TAX
 17925         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17926                              TO WS-RES-MUNI-TAX.
 17927
 17928*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17929
 17930     IF PB-CANCELLATION
 17931         GO TO 6640-CANCEL-TAX.
 17932
 17933     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17934         COMPUTE PB-I-STATE-TAX ROUNDED =
 17935                                   PB-I-LF-PREMIUM-AMT
 17936                                 * WS-RES-STATE-TAX
 17937         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17938                                   PB-I-LF-PREMIUM-AMT
 17939                                 * WS-RES-MUNI-TAX
 17940     ELSE
 17941     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17942         COMPUTE PB-I-STATE-TAX ROUNDED =
 17943                                   PB-I-AH-PREMIUM-AMT
 17944                                 * WS-RES-STATE-TAX
 17945         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17946                                   PB-I-AH-PREMIUM-AMT
 17947                                 * WS-RES-MUNI-TAX.
 17948
 17949
 17950* EXEC CICS ENDBR
 17951*         DATASET (FILE-ID-ERRESS)
 17952*    END-EXEC.
 17953     MOVE 0
 17954       TO DFHEIV11
 17955*    MOVE '&2                    $   #00017865' TO DFHEIV0
 17956     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17957     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17958     MOVE X'2020233030303137383635' TO DFHEIV0(25:11)
 17959     CALL 'kxdfhei1' USING DFHEIV0,
 17960           FILE-ID-ERRESS,
 17961           DFHEIV11,
 17962           DFHEIV99
 17963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17964
 17965
 17966     GO TO 6640-EXIT.
 17967
 17968 6640-CANCEL-TAX.
 17969     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17970
 17971     IF PB-C-LF-CANCEL-AMT > ZEROS
 17972         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17973                                   PB-C-LF-CANCEL-AMT
 17974                                 * WS-RES-STATE-TAX
 17975         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17976                                   PB-C-LF-CANCEL-AMT
 17977                                *  WS-RES-MUNI-TAX
 17978     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 327
* EL050.cbl
 17979     IF PB-C-AH-CANCEL-AMT > ZEROS
 17980         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17981                                   PB-C-AH-CANCEL-AMT
 17982                                 * WS-RES-STATE-TAX
 17983         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17984                                   PB-C-AH-CANCEL-AMT
 17985                                *  WS-RES-MUNI-TAX.
 17986
 17987
 17988* EXEC CICS ENDBR
 17989*         DATASET (FILE-ID-ERRESS)
 17990*    END-EXEC.
 17991     MOVE 0
 17992       TO DFHEIV11
 17993*    MOVE '&2                    $   #00017890' TO DFHEIV0
 17994     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17995     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17996     MOVE X'2020233030303137383930' TO DFHEIV0(25:11)
 17997     CALL 'kxdfhei1' USING DFHEIV0,
 17998           FILE-ID-ERRESS,
 17999           DFHEIV11,
 18000           DFHEIV99
 18001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18002
 18003
 18004     GO TO 6640-EXIT.
 18005
 18006 6630-END-OF-FILE.
 18007     MOVE ER-8002              TO WS-ERROR.
 18008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18009
 18010     GO TO 6640-EXIT.
 18011
 18012 6630-ERRESS-PROBLEM.
 18013     MOVE ER-8044              TO WS-ERROR.
 18014     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18015
 18016 6640-EXIT.
 18017     EXIT.
 18018
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 328
* EL050.cbl
 18020 6650-GET-RES-STATE-COMM.
 18021
 18022     IF PB-COMPANY-ID NOT = 'DMD'
 18023         GO TO 6700-COMM-EXIT.
 18024
 18025     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18026     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18027     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18028     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18029     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18030     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18031     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18032
 18033*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18034*
 18035***  Y2K PROJ 7744
 18036     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18037     SET BIN-TO-GREG          TO TRUE.
 18038     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18039
 18040     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18041***  Y2K PROJ 7744
 18042
 18043     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18044
 18045
 18046* EXEC CICS HANDLE CONDITION
 18047*        INVREQ    (6660-START-BROWSE)
 18048*        DISABLED  (6690-ERRESC-PROBLEM)
 18049*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18050*        NOTFND    (6690-END-OF-FILE)
 18051*    END-EXEC.
 18052*    MOVE '"$8cJI                ! & #00017935' TO DFHEIV0
 18053     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18055     MOVE X'2620233030303137393335' TO DFHEIV0(25:11)
 18056     CALL 'kxdfhei1' USING DFHEIV0
 18057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18058
 18059
 18060
 18061* EXEC CICS RESETBR
 18062*        DATASET (FILE-ID-ERRESC)
 18063*        RIDFLD  (WS-ERRESC-KEY)
 18064*    END-EXEC.
 18065     MOVE 0
 18066       TO DFHEIV11
 18067*    MOVE '&4         G          &   #00017942' TO DFHEIV0
 18068     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18070     MOVE X'2020233030303137393432' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0,
 18072           FILE-ID-ERRESC,
 18073           WS-ERRESC-KEY,
 18074           DFHEIV99,
 18075           DFHEIV11,
 18076           DFHEIV99
 18077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 329
* EL050.cbl
 18078
 18079
 18080 6660-START-BROWSE.
 18081
 18082
 18083* EXEC CICS HANDLE CONDITION
 18084*        NOTFND    (6690-END-OF-FILE)
 18085*        DISABLED  (6690-ERRESC-PROBLEM)
 18086*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18087*        ENDFILE   (6690-END-OF-FILE)
 18088*    END-EXEC.
 18089*    MOVE '"$IcJ''                ! '' #00017949' TO DFHEIV0
 18090     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18092     MOVE X'2720233030303137393439' TO DFHEIV0(25:11)
 18093     CALL 'kxdfhei1' USING DFHEIV0
 18094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18095
 18096
 18097
 18098* EXEC CICS STARTBR
 18099*        DATASET (FILE-ID-ERRESC)
 18100*        RIDFLD  (WS-ERRESC-KEY)
 18101*        GTEQ
 18102*    END-EXEC.
 18103     MOVE 0
 18104       TO DFHEIV11
 18105*    MOVE '&,         G          &   #00017956' TO DFHEIV0
 18106     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18107     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18108     MOVE X'2020233030303137393536' TO DFHEIV0(25:11)
 18109     CALL 'kxdfhei1' USING DFHEIV0,
 18110           FILE-ID-ERRESC,
 18111           WS-ERRESC-KEY,
 18112           DFHEIV99,
 18113           DFHEIV11,
 18114           DFHEIV99
 18115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18116
 18117
 18118     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18119
 18120 6670-READ-NEXT-ERRESC-MASTER.
 18121
 18122
 18123* EXEC CICS HANDLE CONDITION
 18124*        NOTFND    (6690-END-OF-FILE)
 18125*        DISABLED  (6690-ERRESC-PROBLEM)
 18126*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18127*        ENDFILE   (6690-END-OF-FILE)
 18128*    END-EXEC.
 18129*    MOVE '"$IcJ''                ! ( #00017966' TO DFHEIV0
 18130     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18132     MOVE X'2820233030303137393636' TO DFHEIV0(25:11)
 18133     CALL 'kxdfhei1' USING DFHEIV0
 18134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18135
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 330
* EL050.cbl
 18136
 18137
 18138* EXEC CICS READNEXT
 18139*        DATASET (FILE-ID-ERRESC)
 18140*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18141*        RIDFLD  (ERRESC-RECORD-KEY)
 18142*    END-EXEC.
 18143     MOVE LENGTH OF
 18144      ACCOUNT-RESIDENT-ST-COMMISSION
 18145       TO DFHEIV12
 18146     MOVE 0
 18147       TO DFHEIV11
 18148*    MOVE '&.IL                  )   #00017973' TO DFHEIV0
 18149     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18150     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18151     MOVE X'2020233030303137393733' TO DFHEIV0(25:11)
 18152     CALL 'kxdfhei1' USING DFHEIV0,
 18153           FILE-ID-ERRESC,
 18154           ACCOUNT-RESIDENT-ST-COMMISSION,
 18155           DFHEIV12,
 18156           ERRESC-RECORD-KEY,
 18157           DFHEIV99,
 18158           DFHEIV11,
 18159           DFHEIV99,
 18160           DFHEIV99
 18161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18162
 18163
 18164     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18165        NEXT SENTENCE
 18166     ELSE
 18167
 18168* EXEC CICS ENDBR
 18169*            DATASET (FILE-ID-ERRESC)
 18170*       END-EXEC
 18171     MOVE 0
 18172       TO DFHEIV11
 18173*    MOVE '&2                    $   #00017982' TO DFHEIV0
 18174     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18175     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18176     MOVE X'2020233030303137393832' TO DFHEIV0(25:11)
 18177     CALL 'kxdfhei1' USING DFHEIV0,
 18178           FILE-ID-ERRESC,
 18179           DFHEIV11,
 18180           DFHEIV99
 18181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18182        GO TO 6690-END-OF-FILE.
 18183
 18184     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18185
 18186* EXEC CICS ENDBR
 18187*            DATASET (FILE-ID-ERRESC)
 18188*       END-EXEC
 18189     MOVE 0
 18190       TO DFHEIV11
 18191*    MOVE '&2                    $   #00017988' TO DFHEIV0
 18192     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18193     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 331
* EL050.cbl
 18194     MOVE X'2020233030303137393838' TO DFHEIV0(25:11)
 18195     CALL 'kxdfhei1' USING DFHEIV0,
 18196           FILE-ID-ERRESC,
 18197           DFHEIV11,
 18198           DFHEIV99
 18199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18200        GO TO 6690-END-OF-FILE.
 18201
 18202     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18203        NEXT SENTENCE
 18204      ELSE
 18205        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18206
 18207* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18208*
 18209     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18210
 18211     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18212
 18213     IF WS-SUB1 > ZERO
 18214         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18215             PERFORM 6680-SET-COMMISSION
 18216         ELSE
 18217             PERFORM 6680-SET-TABLE-CODE.
 18218
 18219
 18220* EXEC CICS ENDBR
 18221*         DATASET (FILE-ID-ERRESC)
 18222*    END-EXEC.
 18223     MOVE 0
 18224       TO DFHEIV11
 18225*    MOVE '&2                    $   #00018010' TO DFHEIV0
 18226     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18227     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18228     MOVE X'2020233030303138303130' TO DFHEIV0(25:11)
 18229     CALL 'kxdfhei1' USING DFHEIV0,
 18230           FILE-ID-ERRESC,
 18231           DFHEIV11,
 18232           DFHEIV99
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18234
 18235
 18236     GO TO 6700-COMM-EXIT.
 18237
 18238 6680-SET-TABLE-CODE.
 18239     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18240        MOVE ZEROS             TO WS-SUB1
 18241     ELSE
 18242* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18243* TO COMPUTE AH COMMISSION.
 18244        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18245        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18246        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18247        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18248        PERFORM 6680-READ-CTBL-TABLE
 18249        IF WS-CTBL-READ-SW NOT = 'Y'
 18250           MOVE ZEROS          TO WS-SUB1.
 18251
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 332
* EL050.cbl
 18252 6680-READ-CTBL-TABLE.
 18253*
 18254* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18255* TO COMPUTE LIFE COMMISSION
 18256
 18257     IF CTBL-SW = '0540'
 18258        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18259        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18260        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18261
 18262     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18263
 18264     IF CTBL-TABLE-FOUND
 18265        IF CTBL-SW = '0530'
 18266             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18267                                    * PB-I-AH-TERM
 18268             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18269             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18270        ELSE
 18271             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18272             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18273             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18274     ELSE
 18275        IF FIRST-TIME-THROUGH
 18276            GO TO 6680-READ-CTBL-TABLE
 18277        ELSE
 18278            MOVE ZEROS         TO WS-SUB1.
 18279
 18280 6680-SET-COMMISSION.
 18281     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18282           MOVE ZEROS          TO WS-SUB1
 18283       ELSE
 18284           MOVE RESC-COMMISSION-PER (WS-SUB)
 18285                               TO WS-COMMISSION
 18286           IF CTBL-SW = '0530'
 18287               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18288           ELSE
 18289               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18290
 18291 6680-SEARCH-CATEGORY.
 18292     ADD +1                   TO WS-SUB.
 18293     IF WS-SUB > +12
 18294         GO TO 6680-EXIT.
 18295
 18296     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18297          MOVE WS-SUB         TO WS-SUB1
 18298          GO TO 6680-EXIT.
 18299
 18300     GO TO 6680-SEARCH-CATEGORY.
 18301
 18302 6680-EXIT.
 18303     EXIT.
 18304
 18305 6690-END-OF-FILE.
 18306     GO TO 6700-COMM-EXIT.
 18307
 18308 6690-ERRESC-PROBLEM.
 18309      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 333
* EL050.cbl
 18310      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18311
 18312      GO TO 6700-COMM-EXIT.
 18313
 18314 6700-COMM-EXIT.
 18315     EXIT.
 18316
 18317 7000-GET-RATE.
 18318
 18319* EXEC CICS LINK
 18320*        PROGRAM    ('ELRATE')
 18321*        COMMAREA   (CALCULATION-PASS-AREA)
 18322*        LENGTH     (CP-COMM-LENGTH)
 18323*    END-EXEC.
 18324     MOVE 'ELRATE' TO DFHEIV1
 18325*    MOVE '."C                   (   #00018096' TO DFHEIV0
 18326     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18327     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18328     MOVE X'2020233030303138303936' TO DFHEIV0(25:11)
 18329     CALL 'kxdfhei1' USING DFHEIV0,
 18330           DFHEIV1,
 18331           CALCULATION-PASS-AREA,
 18332           CP-COMM-LENGTH,
 18333           DFHEIV99,
 18334           DFHEIV99,
 18335           DFHEIV99,
 18336           DFHEIV99
 18337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18338
 18339
 18340 7000-EXIT.
 18341     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 334
* EL050.cbl
 18343 7100-FIND-BENEFIT-IN-STATE.
 18344     MOVE 'N'                    TO BEN-SEARCH-SW.
 18345
 18346     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18347         VARYING SUB3 FROM 1 BY 1 UNTIL
 18348            ((SUB3 GREATER 50) OR
 18349              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18350               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18351
 18352     IF SUB3 NOT = 51
 18353         MOVE 'Y'                TO BEN-SEARCH-SW.
 18354
 18355     GO TO 7199-EXIT.
 18356
 18357 7100-BENEFIT-DUMMY.
 18358
 18359 7100-DUMMY-EXIT.
 18360     EXIT.
 18361
 18362 7199-EXIT.
 18363     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 335
* EL050.cbl
 18365 7200-FIND-BENEFIT.
 18366     MOVE 'N'                    TO BEN-SEARCH-SW.
 18367
 18368     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18369         VARYING SUB3 FROM 1 BY 1 UNTIL
 18370            ((SUB3 GREATER 8) OR
 18371            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18372
 18373     IF SUB3 NOT = 9
 18374         MOVE 'Y'                TO BEN-SEARCH-SW.
 18375
 18376     GO TO 7200-EXIT.
 18377
 18378 7200-BENEFIT-DUMMY.
 18379
 18380 7200-DUMMY-EXIT.
 18381     EXIT.
 18382
 18383 7200-EXIT.
 18384     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 336
* EL050.cbl
 18386 7250-LOOK-FOR-RESCINDED-CLAIM.
 18387     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18388                                    W-CL-COMP-CD.
 18389     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18390                                    W-CL-CERT-NO.
 18391
 18392
 18393* EXEC CICS HANDLE CONDITION
 18394*        NOTFND  (7250-CONTINUE)
 18395*        ENDFILE (7250-CONTINUE)
 18396*    END-EXEC.
 18397*    MOVE '"$I''                  ! ) #00018154' TO DFHEIV0
 18398     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18400     MOVE X'2920233030303138313534' TO DFHEIV0(25:11)
 18401     CALL 'kxdfhei1' USING DFHEIV0
 18402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18403
 18404
 18405
 18406* EXEC CICS IGNORE CONDITION
 18407*        DUPKEY
 18408*    END-EXEC.
 18409*    MOVE '"*$                   !   #00018159' TO DFHEIV0
 18410     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18412     MOVE X'2020233030303138313539' TO DFHEIV0(25:11)
 18413     CALL 'kxdfhei1' USING DFHEIV0
 18414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18415
 18416
 18417
 18418* EXEC CICS STARTBR
 18419*        DATASET   (CLMS-ID)
 18420*        RIDFLD    (ELMSTR-KEY)
 18421*        GENERIC   EQUAL
 18422*        KEYLENGTH (ELMSTR-LENGTH)
 18423*    END-EXEC.
 18424     MOVE 0
 18425       TO DFHEIV11
 18426*    MOVE '&,   KG    E          &   #00018163' TO DFHEIV0
 18427     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18428     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18429     MOVE X'2020233030303138313633' TO DFHEIV0(25:11)
 18430     CALL 'kxdfhei1' USING DFHEIV0,
 18431           CLMS-ID,
 18432           ELMSTR-KEY,
 18433           ELMSTR-LENGTH,
 18434           DFHEIV11,
 18435           DFHEIV99
 18436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18437
 18438
 18439     MOVE 'Y'                    TO W-BROWSE-SW.
 18440
 18441 7250-NEXT-CLAIM.
 18442
 18443
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 337
* EL050.cbl
 18444* EXEC CICS READNEXT
 18445*        DATASET   (CLMS-ID)
 18446*        RIDFLD    (ELMSTR-KEY)
 18447*        SET       (ADDRESS OF CLAIM-MASTER)
 18448*    END-EXEC.
 18449     MOVE 0
 18450       TO DFHEIV11
 18451*    MOVE '&.S                   )   #00018174' TO DFHEIV0
 18452     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18453     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18454     MOVE X'2020233030303138313734' TO DFHEIV0(25:11)
 18455     CALL 'kxdfhei1' USING DFHEIV0,
 18456           CLMS-ID,
 18457           DFHEIV20,
 18458           DFHEIV99,
 18459           ELMSTR-KEY,
 18460           DFHEIV99,
 18461           DFHEIV11,
 18462           DFHEIV99,
 18463           DFHEIV99
 18464     SET ADDRESS OF CLAIM-MASTER TO
 18465         DFHEIV20
 18466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18467
 18468
 18469     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18470        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18471         GO TO 7250-CONTINUE
 18472     END-IF.
 18473
 18474     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18475        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18476        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18477        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18478        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18479         GO TO 7250-NEXT-CLAIM
 18480     END-IF.
 18481
 18482     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18483        OR (CL-CLAIM-TYPE = 'I')
 18484        OR (CL-CLAIM-TYPE = 'G')
 18485          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18486              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18487              GO TO 7250-CONTINUE
 18488          END-IF
 18489     END-IF.
 18490
 18491     GO TO 7250-NEXT-CLAIM.
 18492
 18493 7250-CONTINUE.
 18494
 18495     IF W-BROWSE-SW = 'Y'
 18496
 18497* EXEC CICS ENDBR
 18498*            DATASET   (CLMS-ID)
 18499*        END-EXEC
 18500     MOVE 0
 18501       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 338
* EL050.cbl
 18502*    MOVE '&2                    $   #00018207' TO DFHEIV0
 18503     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18504     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18505     MOVE X'2020233030303138323037' TO DFHEIV0(25:11)
 18506     CALL 'kxdfhei1' USING DFHEIV0,
 18507           CLMS-ID,
 18508           DFHEIV11,
 18509           DFHEIV99
 18510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18511         MOVE 'N' TO W-BROWSE-SW
 18512     END-IF.
 18513
 18514 7250-EXIT.
 18515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 339
* EL050.cbl
 18517 7300-CHECK-FOR-OPEN-CLMS.
 18518
 18519*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18520*    MOVE SPACES                 TO CNTL-ACCESS.
 18521*    MOVE '1'                    TO CNTL-REC-TYPE.
 18522*    MOVE +0                     TO CNTL-SEQ-NO.
 18523
 18524*    MOVE '3'                    TO RC-SW-1.
 18525*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18526
 18527*    IF NOT CF-COMPANY-MASTER
 18528*         PERFORM 0099-COMPANY-NOT-FOUND
 18529*         GO TO 7300-EXIT.
 18530
 18531     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18532                                    W-CL-COMP-CD.
 18533     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18534                                    W-CL-CERT-NO.
 18535
 18536
 18537* EXEC CICS HANDLE CONDITION
 18538*        NOTFND  (7300-CONTINUE)
 18539*        ENDFILE (7300-CONTINUE)
 18540*    END-EXEC.
 18541*    MOVE '"$I''                  ! * #00018235' TO DFHEIV0
 18542     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18544     MOVE X'2A20233030303138323335' TO DFHEIV0(25:11)
 18545     CALL 'kxdfhei1' USING DFHEIV0
 18546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18547
 18548
 18549
 18550* EXEC CICS IGNORE CONDITION
 18551*        DUPKEY
 18552*    END-EXEC.
 18553*    MOVE '"*$                   !   #00018240' TO DFHEIV0
 18554     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18556     MOVE X'2020233030303138323430' TO DFHEIV0(25:11)
 18557     CALL 'kxdfhei1' USING DFHEIV0
 18558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18559
 18560
 18561
 18562* EXEC CICS STARTBR
 18563*        DATASET   (CLMS-ID)
 18564*        RIDFLD    (ELMSTR-KEY)
 18565*        GENERIC   EQUAL
 18566*        KEYLENGTH (ELMSTR-LENGTH)
 18567*    END-EXEC.
 18568     MOVE 0
 18569       TO DFHEIV11
 18570*    MOVE '&,   KG    E          &   #00018244' TO DFHEIV0
 18571     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18572     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18573     MOVE X'2020233030303138323434' TO DFHEIV0(25:11)
 18574     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 340
* EL050.cbl
 18575           CLMS-ID,
 18576           ELMSTR-KEY,
 18577           ELMSTR-LENGTH,
 18578           DFHEIV11,
 18579           DFHEIV99
 18580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18581
 18582
 18583     MOVE 'Y'                    TO W-BROWSE-SW.
 18584
 18585 7300-NEXT-CLAIM.
 18586
 18587
 18588* EXEC CICS READNEXT
 18589*        DATASET   (CLMS-ID)
 18590*        RIDFLD    (ELMSTR-KEY)
 18591*        SET       (ADDRESS OF CLAIM-MASTER)
 18592*    END-EXEC.
 18593     MOVE 0
 18594       TO DFHEIV11
 18595*    MOVE '&.S                   )   #00018255' TO DFHEIV0
 18596     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18597     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18598     MOVE X'2020233030303138323535' TO DFHEIV0(25:11)
 18599     CALL 'kxdfhei1' USING DFHEIV0,
 18600           CLMS-ID,
 18601           DFHEIV20,
 18602           DFHEIV99,
 18603           ELMSTR-KEY,
 18604           DFHEIV99,
 18605           DFHEIV11,
 18606           DFHEIV99,
 18607           DFHEIV99
 18608     SET ADDRESS OF CLAIM-MASTER TO
 18609         DFHEIV20
 18610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18611
 18612
 18613     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18614        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18615         GO TO 7300-CONTINUE.
 18616
 18617     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18618        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18619        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18620        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18621        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18622         GO TO 7300-NEXT-CLAIM.
 18623
 18624*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18625     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18626        OR (CL-CLAIM-TYPE = 'I')
 18627        OR (CL-CLAIM-TYPE = 'G')
 18628        IF CLAIM-IS-OPEN
 18629           EVALUATE TRUE
 18630             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18631                 MOVE ER-2884      TO WS-ERROR
 18632             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 341
* EL050.cbl
 18633                 MOVE ER-2887      TO WS-ERROR
 18634             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18635                 MOVE ER-2886      TO WS-ERROR
 18636             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18637                 MOVE ER-2888      TO WS-ERROR
 18638             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18639                 MOVE ER-2885      TO WS-ERROR
 18640             WHEN OTHER
 18641                 MOVE ER-2768      TO WS-ERROR
 18642           END-EVALUATE
 18643           IF PB-C-AH-CANCEL-VOIDED OR
 18644              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18645                NOT AH-COVERAGE-CANCELLED)
 18646               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18647               MOVE ER-2768      TO WS-ERROR
 18648           END-IF
 18649           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18650           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18651              PB-FORCE-CODE NOT EQUAL '8'
 18652               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18653           END-IF
 18654           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18655           GO TO 7300-CONTINUE
 18656        ELSE
 18657           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18658*****THIS IS A RESCISSION OR REFORMATION
 18659              IF (AH-COVERAGE-CANCELLED AND
 18660                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18661                    MOVE ER-2890 TO WS-ERROR
 18662                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18663                    GO TO 7300-CONTINUE
 18664              END-IF
 18665           ELSE
 18666              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18667               AND PB-C-AH-CANCEL-DT > SPACES
 18668                 MOVE ER-2756        TO WS-ERROR
 18669                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18670                 GO TO 7300-CONTINUE
 18671              END-IF
 18672           END-IF
 18673        END-IF
 18674     ELSE
 18675*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18676        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18677           IF CLAIM-IS-OPEN
 18678              MOVE ER-2889      TO WS-ERROR
 18679              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18680              GO TO 7300-CONTINUE
 18681           ELSE
 18682              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18683*****THIS IS A RESCISSION OR REFORMATION
 18684                 IF (LF-COVERAGE-CANCELLED AND
 18685                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18686                       MOVE ER-2890 TO WS-ERROR
 18687                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18688                       GO TO 7300-CONTINUE
 18689                 END-IF
 18690              ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 342
* EL050.cbl
 18691                 IF (AH-COVERAGE-CANCELLED AND
 18692                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18693                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18694                    (LF-COVERAGE-CANCELLED AND
 18695                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18696                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18697                       MOVE ER-2965 TO WS-ERROR
 18698                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18699                       GO TO 7300-CONTINUE
 18700                 END-IF
 18701                 IF LF-COVERAGE-CANCELLED
 18702                  IF CL-TOTAL-PAID-AMT > 0
 18703                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18704                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18705                        MOVE ER-2891 TO WS-ERROR
 18706                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18707                        GO TO 7300-CONTINUE
 18708                      END-IF
 18709                    ELSE
 18710                      MOVE ER-2892 TO WS-ERROR
 18711                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18712                      GO TO 7300-CONTINUE
 18713                    END-IF
 18714                  END-IF
 18715                 END-IF
 18716              END-IF
 18717           END-IF
 18718        END-IF
 18719     END-IF
 18720
 18721     GO TO 7300-NEXT-CLAIM.
 18722
 18723 7300-CONTINUE.
 18724
 18725     IF W-BROWSE-SW = 'Y'
 18726
 18727* EXEC CICS ENDBR
 18728*            DATASET   (CLMS-ID)
 18729*        END-EXEC.
 18730     MOVE 0
 18731       TO DFHEIV11
 18732*    MOVE '&2                    $   #00018374' TO DFHEIV0
 18733     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18734     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18735     MOVE X'2020233030303138333734' TO DFHEIV0(25:11)
 18736     CALL 'kxdfhei1' USING DFHEIV0,
 18737           CLMS-ID,
 18738           DFHEIV11,
 18739           DFHEIV99
 18740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18741
 18742
 18743 7300-EXIT.
 18744     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 343
* EL050.cbl
 18746
 18747 7400-GET-REMAIN-TERM.
 18748
 18749* EXEC CICS LINK
 18750*        PROGRAM    ('ELRTRM')
 18751*        COMMAREA   (CALCULATION-PASS-AREA)
 18752*        LENGTH     (CP-COMM-LENGTH)
 18753*    END-EXEC.
 18754     MOVE 'ELRTRM' TO DFHEIV1
 18755*    MOVE '."C                   (   #00018383' TO DFHEIV0
 18756     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18758     MOVE X'2020233030303138333833' TO DFHEIV0(25:11)
 18759     CALL 'kxdfhei1' USING DFHEIV0,
 18760           DFHEIV1,
 18761           CALCULATION-PASS-AREA,
 18762           CP-COMM-LENGTH,
 18763           DFHEIV99,
 18764           DFHEIV99,
 18765           DFHEIV99,
 18766           DFHEIV99
 18767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18768
 18769
 18770 7400-EXIT.
 18771     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 344
* EL050.cbl
 18773
 18774 7500-GET-REMAIN-AMOUNT.
 18775
 18776* EXEC CICS LINK
 18777*        PROGRAM    ('ELRAMT')
 18778*        COMMAREA   (CALCULATION-PASS-AREA)
 18779*        LENGTH     (CP-COMM-LENGTH)
 18780*    END-EXEC.
 18781     MOVE 'ELRAMT' TO DFHEIV1
 18782*    MOVE '."C                   (   #00018394' TO DFHEIV0
 18783     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18785     MOVE X'2020233030303138333934' TO DFHEIV0(25:11)
 18786     CALL 'kxdfhei1' USING DFHEIV0,
 18787           DFHEIV1,
 18788           CALCULATION-PASS-AREA,
 18789           CP-COMM-LENGTH,
 18790           DFHEIV99,
 18791           DFHEIV99,
 18792           DFHEIV99,
 18793           DFHEIV99
 18794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18795
 18796
 18797 7500-EXIT.
 18798     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 345
* EL050.cbl
 18800
 18801 7600-GET-REFUND.
 18802
 18803* EXEC CICS LINK
 18804*        PROGRAM    ('ELRFND')
 18805*        COMMAREA   (CALCULATION-PASS-AREA)
 18806*        LENGTH     (CP-COMM-LENGTH)
 18807*    END-EXEC.
 18808     MOVE 'ELRFND' TO DFHEIV1
 18809*    MOVE '."C                   (   #00018405' TO DFHEIV0
 18810     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18811     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18812     MOVE X'2020233030303138343035' TO DFHEIV0(25:11)
 18813     CALL 'kxdfhei1' USING DFHEIV0,
 18814           DFHEIV1,
 18815           CALCULATION-PASS-AREA,
 18816           CP-COMM-LENGTH,
 18817           DFHEIV99,
 18818           DFHEIV99,
 18819           DFHEIV99,
 18820           DFHEIV99
 18821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18822
 18823
 18824 7600-EXIT.
 18825     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 346
* EL050.cbl
 18827 7700-CALL-DL1.
 18828
 18829* EXEC CICS LINK
 18830*        PROGRAM    ('DLO001')
 18831*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18832*        LENGTH     (DLO001-COMM-LENGTH)
 18833*    END-EXEC.
 18834     MOVE 'DLO001' TO DFHEIV1
 18835*    MOVE '."C                   (   #00018415' TO DFHEIV0
 18836     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18838     MOVE X'2020233030303138343135' TO DFHEIV0(25:11)
 18839     CALL 'kxdfhei1' USING DFHEIV0,
 18840           DFHEIV1,
 18841           WS-DLO-MASTER-POLICY-FORM,
 18842           DLO001-COMM-LENGTH,
 18843           DFHEIV99,
 18844           DFHEIV99,
 18845           DFHEIV99,
 18846           DFHEIV99
 18847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18848
 18849
 18850 7700-EXIT.
 18851     EXIT.
 18852
 18853 7710-CALL-DL2.
 18854
 18855* EXEC CICS LINK
 18856*        PROGRAM    ('DLO002')
 18857*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18858*        LENGTH     (DLO002-COMM-LENGTH)
 18859*    END-EXEC.
 18860     MOVE 'DLO002' TO DFHEIV1
 18861*    MOVE '."C                   (   #00018425' TO DFHEIV0
 18862     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18863     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18864     MOVE X'2020233030303138343235' TO DFHEIV0(25:11)
 18865     CALL 'kxdfhei1' USING DFHEIV0,
 18866           DFHEIV1,
 18867           WS-DLO-INTERNAL-POLICY-FORM,
 18868           DLO002-COMM-LENGTH,
 18869           DFHEIV99,
 18870           DFHEIV99,
 18871           DFHEIV99,
 18872           DFHEIV99
 18873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18874
 18875
 18876 7710-EXIT.
 18877     EXIT.
 18878
 18879 7720-CALL-DL3.
 18880
 18881* EXEC CICS LINK
 18882*        PROGRAM    ('DLO003')
 18883*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18884*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 347
* EL050.cbl
 18885*    END-EXEC.
 18886     MOVE 'DLO003' TO DFHEIV1
 18887*    MOVE '."C                   (   #00018435' TO DFHEIV0
 18888     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18890     MOVE X'2020233030303138343335' TO DFHEIV0(25:11)
 18891     CALL 'kxdfhei1' USING DFHEIV0,
 18892           DFHEIV1,
 18893           WS-DLO-VALID-BANK-ID,
 18894           DLO003-COMM-LENGTH,
 18895           DFHEIV99,
 18896           DFHEIV99,
 18897           DFHEIV99,
 18898           DFHEIV99
 18899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18900
 18901
 18902 7720-EXIT.
 18903     EXIT.
 18904
 18905 7730-CALL-DL7.
 18906
 18907* EXEC CICS LINK
 18908*        PROGRAM    ('DLO007')
 18909*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18910*        LENGTH     (DLO007-COMM-LENGTH)
 18911*    END-EXEC.
 18912     MOVE 'DLO007' TO DFHEIV1
 18913*    MOVE '."C                   (   #00018445' TO DFHEIV0
 18914     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18916     MOVE X'2020233030303138343435' TO DFHEIV0(25:11)
 18917     CALL 'kxdfhei1' USING DFHEIV0,
 18918           DFHEIV1,
 18919           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18920           DLO007-COMM-LENGTH,
 18921           DFHEIV99,
 18922           DFHEIV99,
 18923           DFHEIV99,
 18924           DFHEIV99
 18925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18926
 18927
 18928 7730-EXIT.
 18929     EXIT.
 18930
 18931 7740-CALL-DL11.
 18932
 18933* EXEC CICS LINK
 18934*        PROGRAM    ('DLO011')
 18935*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18936*        LENGTH     (DLO011-COMM-LENGTH)
 18937*    END-EXEC.
 18938     MOVE 'DLO011' TO DFHEIV1
 18939*    MOVE '."C                   (   #00018455' TO DFHEIV0
 18940     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18942     MOVE X'2020233030303138343535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 348
* EL050.cbl
 18943     CALL 'kxdfhei1' USING DFHEIV0,
 18944           DFHEIV1,
 18945           WS-DLO-PREM-RATES-BEN-TYPE,
 18946           DLO011-COMM-LENGTH,
 18947           DFHEIV99,
 18948           DFHEIV99,
 18949           DFHEIV99,
 18950           DFHEIV99
 18951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18952
 18953
 18954 7740-EXIT.
 18955     EXIT.
 18956
 18957 7750-CALL-DL17.
 18958
 18959* EXEC CICS LINK
 18960*        PROGRAM    ('DLO017')
 18961*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18962*        LENGTH     (DLO017-COMM-LENGTH)
 18963*    END-EXEC.
 18964     MOVE 'DLO017' TO DFHEIV1
 18965*    MOVE '."C                   (   #00018465' TO DFHEIV0
 18966     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18968     MOVE X'2020233030303138343635' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0,
 18970           DFHEIV1,
 18971           WS-DLO-VALID-RATE-CODE,
 18972           DLO017-COMM-LENGTH,
 18973           DFHEIV99,
 18974           DFHEIV99,
 18975           DFHEIV99,
 18976           DFHEIV99
 18977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18978
 18979
 18980 7750-EXIT.
 18981     EXIT.
 18982
 18983 7755-CALL-DL19.
 18984
 18985* EXEC CICS LINK
 18986*        PROGRAM    ('DLO019')
 18987*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18988*        LENGTH     (DLO019-COMM-LENGTH)
 18989*    END-EXEC.
 18990     MOVE 'DLO019' TO DFHEIV1
 18991*    MOVE '."C                   (   #00018475' TO DFHEIV0
 18992     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18993     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18994     MOVE X'2020233030303138343735' TO DFHEIV0(25:11)
 18995     CALL 'kxdfhei1' USING DFHEIV0,
 18996           DFHEIV1,
 18997           WS-DLO-ORIG-COV-CAT,
 18998           DLO019-COMM-LENGTH,
 18999           DFHEIV99,
 19000           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 349
* EL050.cbl
 19001           DFHEIV99,
 19002           DFHEIV99
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19004
 19005
 19006 7755-EXIT.
 19007     EXIT.
 19008
 19009 7760-CALL-DL21.
 19010
 19011* EXEC CICS LINK
 19012*        PROGRAM    ('DLO021')
 19013*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19014*        LENGTH     (DLO021-COMM-LENGTH)
 19015*    END-EXEC.
 19016     MOVE 'DLO021' TO DFHEIV1
 19017*    MOVE '."C                   (   #00018485' TO DFHEIV0
 19018     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19019     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19020     MOVE X'2020233030303138343835' TO DFHEIV0(25:11)
 19021     CALL 'kxdfhei1' USING DFHEIV0,
 19022           DFHEIV1,
 19023           WS-DLO-VALID-LOAN-OFFICER,
 19024           DLO021-COMM-LENGTH,
 19025           DFHEIV99,
 19026           DFHEIV99,
 19027           DFHEIV99,
 19028           DFHEIV99
 19029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19030
 19031
 19032 7760-EXIT.
 19033     EXIT.
 19034
 19035 7770-CALL-DL22.
 19036
 19037* EXEC CICS LINK
 19038*        PROGRAM    ('DLO022')
 19039*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19040*        LENGTH     (DLO022-COMM-LENGTH)
 19041*    END-EXEC.
 19042     MOVE 'DLO022' TO DFHEIV1
 19043*    MOVE '."C                   (   #00018495' TO DFHEIV0
 19044     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19046     MOVE X'2020233030303138343935' TO DFHEIV0(25:11)
 19047     CALL 'kxdfhei1' USING DFHEIV0,
 19048           DFHEIV1,
 19049           WS-DLO-VALID-STATE-CODE,
 19050           DLO022-COMM-LENGTH,
 19051           DFHEIV99,
 19052           DFHEIV99,
 19053           DFHEIV99,
 19054           DFHEIV99
 19055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19056
 19057
 19058 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 350
* EL050.cbl
 19059     EXIT.
 19060
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 351
* EL050.cbl
 19062
 19063 7800-REWRITE-CERT.
 19064******************************************************************
 19065*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19066*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19067******************************************************************
 19068
 19069     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19070        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19071        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19072        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19073
 19074* EXEC CICS REWRITE
 19075*                  DATASET (CERT-ID)
 19076*                  FROM    (CERTIFICATE-MASTER)
 19077*              END-EXEC
 19078     MOVE LENGTH OF
 19079      CERTIFICATE-MASTER
 19080       TO DFHEIV11
 19081*    MOVE '&& L                  %   #00018516' TO DFHEIV0
 19082     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19083     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19084     MOVE X'2020233030303138353136' TO DFHEIV0(25:11)
 19085     CALL 'kxdfhei1' USING DFHEIV0,
 19086           CERT-ID,
 19087           CERTIFICATE-MASTER,
 19088           DFHEIV11,
 19089           DFHEIV99
 19090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19091        GO TO 7800-EXIT.
 19092
 19093       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19094       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19095
 19096 7800-EXIT.
 19097      EXIT.
 19098
 19099 7900-DELETE-CERT.
 19100
 19101* EXEC CICS DELETE
 19102*        DATASET (CERT-ID)
 19103*    END-EXEC.
 19104*    MOVE '&(                    &   #00018529' TO DFHEIV0
 19105     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19106     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19107     MOVE X'2020233030303138353239' TO DFHEIV0(25:11)
 19108     CALL 'kxdfhei1' USING DFHEIV0,
 19109           CERT-ID,
 19110           DFHEIV99,
 19111           DFHEIV99,
 19112           DFHEIV99,
 19113           DFHEIV99
 19114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19115
 19116
 19117 7900-EXIT.
 19118     EXIT.
 19119
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 352
* EL050.cbl
 19120 8000-WRITE-CERT.
 19121
 19122* EXEC CICS HANDLE CONDITION
 19123*        DUPKEY    (8000-FREE-MAIN)
 19124*    END-EXEC.
 19125*    MOVE '"$$                   ! + #00018537' TO DFHEIV0
 19126     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19127     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19128     MOVE X'2B20233030303138353337' TO DFHEIV0(25:11)
 19129     CALL 'kxdfhei1' USING DFHEIV0
 19130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19131
 19132
 19133
 19134* EXEC CICS WRITE
 19135*        DATASET     (CERT-ID)
 19136*        FROM        (CERTIFICATE-MASTER)
 19137*        RIDFLD      (ELCERT-KEY)
 19138*    END-EXEC.
 19139     MOVE LENGTH OF
 19140      CERTIFICATE-MASTER
 19141       TO DFHEIV11
 19142*    MOVE '&$ L                  ''   #00018541' TO DFHEIV0
 19143     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19145     MOVE X'2020233030303138353431' TO DFHEIV0(25:11)
 19146     CALL 'kxdfhei1' USING DFHEIV0,
 19147           CERT-ID,
 19148           CERTIFICATE-MASTER,
 19149           DFHEIV11,
 19150           ELCERT-KEY,
 19151           DFHEIV99,
 19152           DFHEIV99
 19153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19154
 19155
 19156 8000-FREE-MAIN.
 19157
 19158 8000-EXIT.
 19159      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 353
* EL050.cbl
 19161
 19162 8100-READ-ERPNDM.
 19163
 19164* EXEC CICS HANDLE CONDITION
 19165*         NOTFND     (8100-NOTFND)
 19166*         ENDFILE    (8100-NOTFND)
 19167*    END-EXEC.
 19168*    MOVE '"$I''                  ! , #00018554' TO DFHEIV0
 19169     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19171     MOVE X'2C20233030303138353534' TO DFHEIV0(25:11)
 19172     CALL 'kxdfhei1' USING DFHEIV0
 19173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19174
 19175
 19176     MOVE SPACES                 TO ERPNDM-FOUND.
 19177     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19178
 19179
 19180* EXEC CICS READ
 19181*         DATASET   (FILE-ERPNDM)
 19182*         RIDFLD    (PM-CONTROL-PRIMARY)
 19183*         INTO      (PENDING-MAILING-DATA)
 19184*    END-EXEC.
 19185     MOVE LENGTH OF
 19186      PENDING-MAILING-DATA
 19187       TO DFHEIV11
 19188*    MOVE '&"IL       E          (   #00018562' TO DFHEIV0
 19189     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19191     MOVE X'2020233030303138353632' TO DFHEIV0(25:11)
 19192     CALL 'kxdfhei1' USING DFHEIV0,
 19193           FILE-ERPNDM,
 19194           PENDING-MAILING-DATA,
 19195           DFHEIV11,
 19196           PM-CONTROL-PRIMARY,
 19197           DFHEIV99,
 19198           DFHEIV99,
 19199           DFHEIV99
 19200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19201
 19202
 19203     GO TO 8100-EXIT.
 19204
 19205 8100-NOTFND.
 19206
 19207     MOVE 'X'                    TO ERPNDM-FOUND.
 19208     MOVE ER-2694                TO WS-ERROR.
 19209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19210     MOVE ER-2883                TO WS-ERROR
 19211     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19212     .
 19213 8100-EXIT.
 19214     EXIT.
 19215
 19216 8110-READ-ERMAIL.
 19217
 19218* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 354
* EL050.cbl
 19219*         NOTFND     (8110-NOTFND)
 19220*         ENDFILE    (8110-NOTFND)
 19221*    END-EXEC.
 19222*    MOVE '"$I''                  ! - #00018582' TO DFHEIV0
 19223     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19225     MOVE X'2D20233030303138353832' TO DFHEIV0(25:11)
 19226     CALL 'kxdfhei1' USING DFHEIV0
 19227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19228
 19229
 19230     MOVE SPACES                 TO ERMAIL-FOUND.
 19231     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19232     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19233     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19234     MOVE PB-SV-STATE            TO MA-STATE.
 19235
 19236
 19237* EXEC CICS READ
 19238*         UPDATE
 19239*         DATASET   (FILE-ERMAIL)
 19240*         RIDFLD    (MA-CONTROL-PRIMARY)
 19241*         INTO      (MAILING-DATA)
 19242*    END-EXEC.
 19243     MOVE LENGTH OF
 19244      MAILING-DATA
 19245       TO DFHEIV11
 19246*    MOVE '&"IL       EU         (   #00018593' TO DFHEIV0
 19247     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19249     MOVE X'2020233030303138353933' TO DFHEIV0(25:11)
 19250     CALL 'kxdfhei1' USING DFHEIV0,
 19251           FILE-ERMAIL,
 19252           MAILING-DATA,
 19253           DFHEIV11,
 19254           MA-CONTROL-PRIMARY,
 19255           DFHEIV99,
 19256           DFHEIV99,
 19257           DFHEIV99
 19258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19259
 19260
 19261     GO TO 8110-EXIT.
 19262
 19263 8110-NOTFND.
 19264     MOVE 'X'                    TO ERMAIL-FOUND.
 19265
 19266 8110-EXIT.
 19267     EXIT.
 19268
 19269 8120-REWRITE-ERMAIL.
 19270
 19271* EXEC CICS REWRITE
 19272*         DATASET    (FILE-ERMAIL)
 19273*         FROM       (MAILING-DATA)
 19274*    END-EXEC.
 19275     MOVE LENGTH OF
 19276      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 355
* EL050.cbl
 19277       TO DFHEIV11
 19278*    MOVE '&& L                  %   #00018609' TO DFHEIV0
 19279     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19281     MOVE X'2020233030303138363039' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0,
 19283           FILE-ERMAIL,
 19284           MAILING-DATA,
 19285           DFHEIV11,
 19286           DFHEIV99
 19287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19288
 19289
 19290 8120-EXIT.
 19291     EXIT.
 19292
 19293 8130-WRITE-ERMAIL.
 19294
 19295* EXEC CICS HANDLE CONDITION
 19296*         DUPKEY   (8130-EXIT)
 19297*    END-EXEC.
 19298*    MOVE '"$$                   ! . #00018618' TO DFHEIV0
 19299     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19301     MOVE X'2E20233030303138363138' TO DFHEIV0(25:11)
 19302     CALL 'kxdfhei1' USING DFHEIV0
 19303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19304
 19305
 19306
 19307* EXEC CICS WRITE
 19308*         DATASET     (FILE-ERMAIL)
 19309*         RIDFLD      (MA-CONTROL-PRIMARY)
 19310*         FROM        (MAILING-DATA)
 19311*    END-EXEC.
 19312     MOVE LENGTH OF
 19313      MAILING-DATA
 19314       TO DFHEIV11
 19315*    MOVE '&$ L                  ''   #00018622' TO DFHEIV0
 19316     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19317     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19318     MOVE X'2020233030303138363232' TO DFHEIV0(25:11)
 19319     CALL 'kxdfhei1' USING DFHEIV0,
 19320           FILE-ERMAIL,
 19321           MAILING-DATA,
 19322           DFHEIV11,
 19323           MA-CONTROL-PRIMARY,
 19324           DFHEIV99,
 19325           DFHEIV99
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329 8130-EXIT.
 19330     EXIT.
 19331
 19332 8140-UNLOCK-ERMAIL.
 19333
 19334* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 356
* EL050.cbl
 19335*         DATASET   (FILE-ERMAIL)
 19336*    END-EXEC.
 19337*    MOVE '&*                    #   #00018632' TO DFHEIV0
 19338     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19339     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19340     MOVE X'2020233030303138363332' TO DFHEIV0(25:11)
 19341     CALL 'kxdfhei1' USING DFHEIV0,
 19342           FILE-ERMAIL,
 19343           DFHEIV99
 19344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19345
 19346
 19347 8140-EXIT.
 19348     EXIT.
 19349
 19350 8180-UPDATE-VIN-NUMBER.
 19351
 19352* EXEC CICS HANDLE CONDITION
 19353*        NOTFND   (8180-NOTFND)
 19354*    END-EXEC.
 19355*    MOVE '"$I                   ! / #00018640' TO DFHEIV0
 19356     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19358     MOVE X'2F20233030303138363430' TO DFHEIV0(25:11)
 19359     CALL 'kxdfhei1' USING DFHEIV0
 19360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19361
 19362
 19363     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19364     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19365
 19366
 19367* EXEC CICS READ
 19368*        UPDATE
 19369*        DATASET  (CRTT-ID)
 19370*        RIDFLD   (WS-ELCRTT-KEY)
 19371*        INTO     (CERTIFICATE-TRAILERS)
 19372*    END-EXEC.
 19373     MOVE LENGTH OF
 19374      CERTIFICATE-TRAILERS
 19375       TO DFHEIV11
 19376*    MOVE '&"IL       EU         (   #00018647' TO DFHEIV0
 19377     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19378     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303138363437' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0,
 19381           CRTT-ID,
 19382           CERTIFICATE-TRAILERS,
 19383           DFHEIV11,
 19384           WS-ELCRTT-KEY,
 19385           DFHEIV99,
 19386           DFHEIV99,
 19387           DFHEIV99
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19389
 19390
 19391     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19392         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 357
* EL050.cbl
 19393
 19394* EXEC CICS REWRITE
 19395*           DATASET  (CRTT-ID)
 19396*           FROM     (CERTIFICATE-TRAILERS)
 19397*        END-EXEC
 19398     MOVE LENGTH OF
 19399      CERTIFICATE-TRAILERS
 19400       TO DFHEIV11
 19401*    MOVE '&& L                  %   #00018656' TO DFHEIV0
 19402     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19403     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19404     MOVE X'2020233030303138363536' TO DFHEIV0(25:11)
 19405     CALL 'kxdfhei1' USING DFHEIV0,
 19406           CRTT-ID,
 19407           CERTIFICATE-TRAILERS,
 19408           DFHEIV11,
 19409           DFHEIV99
 19410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19411     ELSE
 19412
 19413* EXEC CICS UNLOCK
 19414*          DATASET  (CRTT-ID)
 19415*       END-EXEC
 19416*    MOVE '&*                    #   #00018661' TO DFHEIV0
 19417     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19418     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19419     MOVE X'2020233030303138363631' TO DFHEIV0(25:11)
 19420     CALL 'kxdfhei1' USING DFHEIV0,
 19421           CRTT-ID,
 19422           DFHEIV99
 19423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19424     END-IF.
 19425
 19426     GO TO 8180-EXIT.
 19427
 19428 8180-NOTFND.
 19429
 19430     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19431     MOVE 'CS'         TO CS-RECORD-ID.
 19432     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19433     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19434     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19435     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19436
 19437* EXEC CICS WRITE
 19438*       DATASET  (CRTT-ID)
 19439*       RIDFLD   (WS-ELCRTT-KEY)
 19440*       FROM     (CERTIFICATE-TRAILERS)
 19441*    END-EXEC.
 19442     MOVE LENGTH OF
 19443      CERTIFICATE-TRAILERS
 19444       TO DFHEIV11
 19445*    MOVE '&$ L                  ''   #00018676' TO DFHEIV0
 19446     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19447     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19448     MOVE X'2020233030303138363736' TO DFHEIV0(25:11)
 19449     CALL 'kxdfhei1' USING DFHEIV0,
 19450           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 358
* EL050.cbl
 19451           CERTIFICATE-TRAILERS,
 19452           DFHEIV11,
 19453           WS-ELCRTT-KEY,
 19454           DFHEIV99,
 19455           DFHEIV99
 19456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19457
 19458
 19459 8180-EXIT.
 19460     EXIT.
 19461
 19462 8190-UPDATE-REFUND-CLAIM-FLAG.
 19463
 19464* EXEC CICS HANDLE CONDITION
 19465*        NOTFND   (8190-NOTFND)
 19466*    END-EXEC.
 19467*    MOVE '"$I                   ! 0 #00018686' TO DFHEIV0
 19468     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19470     MOVE X'3020233030303138363836' TO DFHEIV0(25:11)
 19471     CALL 'kxdfhei1' USING DFHEIV0
 19472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19473
 19474
 19475     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19476     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19477
 19478
 19479* EXEC CICS READ
 19480*        UPDATE
 19481*        DATASET  (CRTT-ID)
 19482*        RIDFLD   (WS-ELCRTT-KEY)
 19483*        INTO     (CERTIFICATE-TRAILERS)
 19484*    END-EXEC.
 19485     MOVE LENGTH OF
 19486      CERTIFICATE-TRAILERS
 19487       TO DFHEIV11
 19488*    MOVE '&"IL       EU         (   #00018693' TO DFHEIV0
 19489     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19490     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19491     MOVE X'2020233030303138363933' TO DFHEIV0(25:11)
 19492     CALL 'kxdfhei1' USING DFHEIV0,
 19493           CRTT-ID,
 19494           CERTIFICATE-TRAILERS,
 19495           DFHEIV11,
 19496           WS-ELCRTT-KEY,
 19497           DFHEIV99,
 19498           DFHEIV99,
 19499           DFHEIV99
 19500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19501
 19502
 19503     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19504
 19505* EXEC CICS REWRITE
 19506*       DATASET  (CRTT-ID)
 19507*       FROM     (CERTIFICATE-TRAILERS)
 19508*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 359
* EL050.cbl
 19509     MOVE LENGTH OF
 19510      CERTIFICATE-TRAILERS
 19511       TO DFHEIV11
 19512*    MOVE '&& L                  %   #00018701' TO DFHEIV0
 19513     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19514     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19515     MOVE X'2020233030303138373031' TO DFHEIV0(25:11)
 19516     CALL 'kxdfhei1' USING DFHEIV0,
 19517           CRTT-ID,
 19518           CERTIFICATE-TRAILERS,
 19519           DFHEIV11,
 19520           DFHEIV99
 19521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19522
 19523
 19524     GO TO 8190-EXIT.
 19525
 19526 8190-NOTFND.
 19527
 19528     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19529     MOVE 'CS'         TO CS-RECORD-ID.
 19530     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19531     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19532     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19533     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19534
 19535* EXEC CICS WRITE
 19536*       DATASET  (CRTT-ID)
 19537*       RIDFLD   (WS-ELCRTT-KEY)
 19538*       FROM     (CERTIFICATE-TRAILERS)
 19539*    END-EXEC.
 19540     MOVE LENGTH OF
 19541      CERTIFICATE-TRAILERS
 19542       TO DFHEIV11
 19543*    MOVE '&$ L                  ''   #00018716' TO DFHEIV0
 19544     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19545     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19546     MOVE X'2020233030303138373136' TO DFHEIV0(25:11)
 19547     CALL 'kxdfhei1' USING DFHEIV0,
 19548           CRTT-ID,
 19549           CERTIFICATE-TRAILERS,
 19550           DFHEIV11,
 19551           WS-ELCRTT-KEY,
 19552           DFHEIV99,
 19553           DFHEIV99
 19554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19555
 19556
 19557 8190-EXIT.
 19558     EXIT.
 19559
 19560 8200-READ-REIN-TABLE.
 19561
 19562* EXEC CICS HANDLE CONDITION
 19563*         NOTFND   (8200-NOTFND)
 19564*    END-EXEC.
 19565*    MOVE '"$I                   ! 1 #00018726' TO DFHEIV0
 19566     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 360
* EL050.cbl
 19567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19568     MOVE X'3120233030303138373236' TO DFHEIV0(25:11)
 19569     CALL 'kxdfhei1' USING DFHEIV0
 19570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19571
 19572
 19573
 19574* EXEC CICS READ
 19575*        DATASET     (REIN-ID)
 19576*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19577*        RIDFLD      (ERREIN-KEY)
 19578*    END-EXEC.
 19579*    MOVE '&"S        E          (   #00018730' TO DFHEIV0
 19580     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19582     MOVE X'2020233030303138373330' TO DFHEIV0(25:11)
 19583     CALL 'kxdfhei1' USING DFHEIV0,
 19584           REIN-ID,
 19585           DFHEIV20,
 19586           DFHEIV99,
 19587           ERREIN-KEY,
 19588           DFHEIV99,
 19589           DFHEIV99,
 19590           DFHEIV99
 19591     SET ADDRESS OF REINSURANCE-RECORD TO
 19592         DFHEIV20
 19593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19594
 19595
 19596     GO TO 8200-EXIT.
 19597
 19598 8200-NOTFND.
 19599     MOVE 'N'             TO WS-REIN-READ-SW.
 19600
 19601 8200-EXIT.
 19602      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 361
* EL050.cbl
 19604
 19605 8300-READ-CTBL-TABLE.
 19606
 19607* EXEC CICS HANDLE CONDITION
 19608*        NOTFND    (8300-NOTFND)
 19609*        DISABLED  (8300-ERRESS-PROBLEM)
 19610*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19611*        ENDFILE   (8300-NOTFND)
 19612*    END-EXEC.
 19613*    MOVE '"$IcJ''                ! 2 #00018746' TO DFHEIV0
 19614     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19616     MOVE X'3220233030303138373436' TO DFHEIV0(25:11)
 19617     CALL 'kxdfhei1' USING DFHEIV0
 19618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19619
 19620
 19621
 19622* EXEC CICS READ
 19623*        DATASET     (CTBL-ID)
 19624*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19625*        RIDFLD      (ERCTBL-KEY)
 19626*    END-EXEC.
 19627*    MOVE '&"S        E          (   #00018753' TO DFHEIV0
 19628     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19629     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19630     MOVE X'2020233030303138373533' TO DFHEIV0(25:11)
 19631     CALL 'kxdfhei1' USING DFHEIV0,
 19632           CTBL-ID,
 19633           DFHEIV20,
 19634           DFHEIV99,
 19635           ERCTBL-KEY,
 19636           DFHEIV99,
 19637           DFHEIV99,
 19638           DFHEIV99
 19639     SET ADDRESS OF COMM-TABLE-RECORD TO
 19640         DFHEIV20
 19641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19642
 19643
 19644     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19645
 19646     GO TO 8300-EXIT.
 19647
 19648 8300-NOTFND.
 19649
 19650     IF CTBL-SW = '0530'
 19651         MOVE 'AA'                     TO WS-AH-COMP-CD
 19652         MOVE '0550'                   TO CTBL-SW
 19653         MOVE '1'                      TO WS-CTBL-READ-SW
 19654         GO TO 8300-EXIT.
 19655
 19656     IF CTBL-SW = '0540'
 19657         MOVE 'AA'                     TO WS-LF-COMP-CD
 19658         MOVE '0550'                   TO CTBL-SW
 19659         MOVE '1'                      TO WS-CTBL-READ-SW
 19660         GO TO 8300-EXIT.
 19661
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 362
* EL050.cbl
 19662     IF CTBL-SW = '0550'
 19663         MOVE '2'                      TO WS-CTBL-READ-SW
 19664         GO TO 8300-EXIT.
 19665
 19666     GO TO 8300-EXIT.
 19667
 19668 8300-ERRESS-PROBLEM.
 19669
 19670      MOVE ER-8050              TO WS-ERROR.
 19671      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19672
 19673     GO TO 8300-EXIT.
 19674
 19675 8300-EXIT.
 19676      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 363
* EL050.cbl
 19678
 19679
 19680 8400-GETMAIN-ERFORM.
 19681
 19682
 19683* EXEC CICS   GETMAIN
 19684*        LENGTH  (500)
 19685*        SET     (ADDRESS OF FORM-MASTER)
 19686*    END-EXEC.
 19687     MOVE 500
 19688       TO DFHEIV11
 19689*    MOVE '," L                  $   #00018797' TO DFHEIV0
 19690     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19691     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19692     MOVE X'2020233030303138373937' TO DFHEIV0(25:11)
 19693     CALL 'kxdfhei1' USING DFHEIV0,
 19694           DFHEIV20,
 19695           DFHEIV11,
 19696           DFHEIV99
 19697     SET ADDRESS OF FORM-MASTER TO
 19698         DFHEIV20
 19699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19700
 19701
 19702     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19703
 19704 8400-EXIT.
 19705      EXIT.
 19706
 19707 8450-READ-FORM-MASTER.
 19708
 19709
 19710* EXEC CICS  HANDLE CONDITION
 19711*        NOTFND   (8450-FORM-NOT-FOUND)
 19712*        ENDFILE  (8450-FORM-NOT-FOUND)
 19713*    END-EXEC.
 19714*    MOVE '"$I''                  ! 3 #00018809' TO DFHEIV0
 19715     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19717     MOVE X'3320233030303138383039' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0
 19719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19720
 19721
 19722
 19723* EXEC CICS   READ
 19724*        DATASET   (FORM-ID)
 19725*        RIDFLD    (ERFORM-KEY)
 19726*        INTO      (FORM-MASTER)
 19727*        GTEQ
 19728*    END-EXEC.
 19729     MOVE LENGTH OF
 19730      FORM-MASTER
 19731       TO DFHEIV11
 19732*    MOVE '&"IL       G          (   #00018814' TO DFHEIV0
 19733     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19735     MOVE X'2020233030303138383134' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 364
* EL050.cbl
 19736     CALL 'kxdfhei1' USING DFHEIV0,
 19737           FORM-ID,
 19738           FORM-MASTER,
 19739           DFHEIV11,
 19740           ERFORM-KEY,
 19741           DFHEIV99,
 19742           DFHEIV99,
 19743           DFHEIV99
 19744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19745
 19746
 19747     MOVE  'Y'           TO  FORM-MASTER-SW.
 19748
 19749     GO TO  8450-EXIT.
 19750
 19751 8450-FORM-NOT-FOUND.
 19752
 19753     MOVE  'N'           TO  FORM-MASTER-SW.
 19754
 19755 8450-EXIT.
 19756      EXIT.
 19757
 19758 8500-DATE-CONVERT.
 19759
 19760* EXEC CICS LINK
 19761*        PROGRAM    ('ELDATCV')
 19762*        COMMAREA   (DATE-CONVERSION-DATA)
 19763*        LENGTH     (DC-COMM-LENGTH)
 19764*    END-EXEC.
 19765     MOVE 'ELDATCV' TO DFHEIV1
 19766*    MOVE '."C                   (   #00018833' TO DFHEIV0
 19767     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19769     MOVE X'2020233030303138383333' TO DFHEIV0(25:11)
 19770     CALL 'kxdfhei1' USING DFHEIV0,
 19771           DFHEIV1,
 19772           DATE-CONVERSION-DATA,
 19773           DC-COMM-LENGTH,
 19774           DFHEIV99,
 19775           DFHEIV99,
 19776           DFHEIV99,
 19777           DFHEIV99
 19778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19779
 19780
 19781 8500-EXIT.
 19782     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 365
* EL050.cbl
 19784
 19785 8555-RELOAD-CONTROL-FILE.
 19786     CONTINUE.
 19787
 19788 8555-EXIT.
 19789     EXIT.
 19790
 19791 8557-GETMAIN-ERPLAN.
 19792
 19793
 19794* EXEC CICS GETMAIN
 19795*        LENGTH    (840)
 19796*        SET       (ADDRESS OF PLAN-RECORDS)
 19797*    END-EXEC.
 19798     MOVE 840
 19799       TO DFHEIV11
 19800*    MOVE '," L                  $   #00018851' TO DFHEIV0
 19801     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19802     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19803     MOVE X'2020233030303138383531' TO DFHEIV0(25:11)
 19804     CALL 'kxdfhei1' USING DFHEIV0,
 19805           DFHEIV20,
 19806           DFHEIV11,
 19807           DFHEIV99
 19808     SET ADDRESS OF PLAN-RECORDS TO
 19809         DFHEIV20
 19810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19811
 19812
 19813     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19814
 19815 8557-EXIT.
 19816     EXIT.
 19817
 19818 8560-GETMAIN.
 19819
 19820* EXEC CICS GETMAIN
 19821*        LENGTH    (2000)
 19822*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19823*    END-EXEC.
 19824     MOVE 2000
 19825       TO DFHEIV11
 19826*    MOVE '," L                  $   #00018862' TO DFHEIV0
 19827     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19829     MOVE X'2020233030303138383632' TO DFHEIV0(25:11)
 19830     CALL 'kxdfhei1' USING DFHEIV0,
 19831           DFHEIV20,
 19832           DFHEIV11,
 19833           DFHEIV99
 19834     SET ADDRESS OF ACCOUNT-MASTER TO
 19835         DFHEIV20
 19836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19837
 19838
 19839     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19840
 19841 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 366
* EL050.cbl
 19842     EXIT.
 19843
 19844 8570-START-ACCOUNT-MASTER.
 19845
 19846* EXEC CICS HANDLE CONDITION
 19847*        NOTFND    (0199-ACCT-NOT-FOUND)
 19848*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19849*    END-EXEC.
 19850*    MOVE '"$I''                  ! 4 #00018873' TO DFHEIV0
 19851     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19853     MOVE X'3420233030303138383733' TO DFHEIV0(25:11)
 19854     CALL 'kxdfhei1' USING DFHEIV0
 19855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19856
 19857
 19858
 19859* EXEC CICS STARTBR
 19860*        DATASET    (ACCT-ID)
 19861*        RIDFLD     (ERACCT-KEY)
 19862*        GTEQ
 19863*    END-EXEC.
 19864     MOVE 0
 19865       TO DFHEIV11
 19866*    MOVE '&,         G          &   #00018878' TO DFHEIV0
 19867     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19869     MOVE X'2020233030303138383738' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0,
 19871           ACCT-ID,
 19872           ERACCT-KEY,
 19873           DFHEIV99,
 19874           DFHEIV11,
 19875           DFHEIV99
 19876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19877
 19878
 19879 8570-EXIT.
 19880     EXIT.
 19881
 19882 8580-READ-ACCOUNT-MASTER.
 19883
 19884* EXEC CICS HANDLE CONDITION
 19885*        NOTFND    (0199-ACCT-NOT-FOUND)
 19886*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19887*    END-EXEC.
 19888*    MOVE '"$I''                  ! 5 #00018888' TO DFHEIV0
 19889     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19891     MOVE X'3520233030303138383838' TO DFHEIV0(25:11)
 19892     CALL 'kxdfhei1' USING DFHEIV0
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19894
 19895
 19896
 19897* EXEC CICS READNEXT
 19898*        DATASET     (ACCT-ID)
 19899*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 367
* EL050.cbl
 19900*        RIDFLD      (ERACCT-KEY)
 19901*    END-EXEC.
 19902     MOVE LENGTH OF
 19903      ACCOUNT-MASTER
 19904       TO DFHEIV12
 19905     MOVE 0
 19906       TO DFHEIV11
 19907*    MOVE '&.IL                  )   #00018893' TO DFHEIV0
 19908     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19909     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19910     MOVE X'2020233030303138383933' TO DFHEIV0(25:11)
 19911     CALL 'kxdfhei1' USING DFHEIV0,
 19912           ACCT-ID,
 19913           ACCOUNT-MASTER,
 19914           DFHEIV12,
 19915           ERACCT-KEY,
 19916           DFHEIV99,
 19917           DFHEIV11,
 19918           DFHEIV99,
 19919           DFHEIV99
 19920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19921
 19922
 19923 8580-EXIT.
 19924     EXIT.
 19925
 19926 8582-READ-COMPENSATION-MASTER.
 19927
 19928* EXEC CICS HANDLE CONDITION
 19929*        NOTFND    (8582-COMP-NOT-FOUND)
 19930*        ENDFILE   (8582-COMP-NOT-FOUND)
 19931*    END-EXEC.
 19932*    MOVE '"$I''                  ! 6 #00018903' TO DFHEIV0
 19933     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19935     MOVE X'3620233030303138393033' TO DFHEIV0(25:11)
 19936     CALL 'kxdfhei1' USING DFHEIV0
 19937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19938
 19939
 19940
 19941* EXEC CICS READ
 19942*        DATASET     (COMP-ID)
 19943*        INTO        (COMPENSATION-MASTER)
 19944*        RIDFLD      (ERCOMP-KEY)
 19945*    END-EXEC.
 19946     MOVE LENGTH OF
 19947      COMPENSATION-MASTER
 19948       TO DFHEIV11
 19949*    MOVE '&"IL       E          (   #00018908' TO DFHEIV0
 19950     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19952     MOVE X'2020233030303138393038' TO DFHEIV0(25:11)
 19953     CALL 'kxdfhei1' USING DFHEIV0,
 19954           COMP-ID,
 19955           COMPENSATION-MASTER,
 19956           DFHEIV11,
 19957           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 368
* EL050.cbl
 19958           DFHEIV99,
 19959           DFHEIV99,
 19960           DFHEIV99
 19961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19962
 19963
 19964     MOVE 'Y'                    TO COMP-MASTER-SW
 19965
 19966     GO TO 8582-EXIT
 19967     .
 19968 8582-COMP-NOT-FOUND.
 19969
 19970     MOVE 'N'                    TO COMP-MASTER-SW.
 19971
 19972 8582-EXIT.
 19973     EXIT.
 19974
 19975 8583-READ-ERAGTC.
 19976
 19977* EXEC CICS HANDLE CONDITION
 19978*        NOTFND    (8583-AGTC-NOT-FOUND)
 19979*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19980*    END-EXEC.
 19981*    MOVE '"$I''                  ! 7 #00018926' TO DFHEIV0
 19982     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19984     MOVE X'3720233030303138393236' TO DFHEIV0(25:11)
 19985     CALL 'kxdfhei1' USING DFHEIV0
 19986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19987
 19988
 19989
 19990* EXEC CICS STARTBR
 19991*        DATASET    (AGTC-ID)
 19992*        RIDFLD     (ERAGTC-KEY)
 19993*        GTEQ
 19994*    END-EXEC.
 19995     MOVE 0
 19996       TO DFHEIV11
 19997*    MOVE '&,         G          &   #00018931' TO DFHEIV0
 19998     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19999     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20000     MOVE X'2020233030303138393331' TO DFHEIV0(25:11)
 20001     CALL 'kxdfhei1' USING DFHEIV0,
 20002           AGTC-ID,
 20003           ERAGTC-KEY,
 20004           DFHEIV99,
 20005           DFHEIV11,
 20006           DFHEIV99
 20007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20008
 20009
 20010 8583-READ-ERAGTC-NEXT.
 20011
 20012* EXEC CICS READNEXT
 20013*        DATASET     (AGTC-ID)
 20014*        INTO        (AGENT-COMMISSIONS)
 20015*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 369
* EL050.cbl
 20016*    END-EXEC.
 20017     MOVE LENGTH OF
 20018      AGENT-COMMISSIONS
 20019       TO DFHEIV12
 20020     MOVE 0
 20021       TO DFHEIV11
 20022*    MOVE '&.IL                  )   #00018938' TO DFHEIV0
 20023     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20024     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20025     MOVE X'2020233030303138393338' TO DFHEIV0(25:11)
 20026     CALL 'kxdfhei1' USING DFHEIV0,
 20027           AGTC-ID,
 20028           AGENT-COMMISSIONS,
 20029           DFHEIV12,
 20030           ERAGTC-KEY,
 20031           DFHEIV99,
 20032           DFHEIV11,
 20033           DFHEIV99,
 20034           DFHEIV99
 20035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20036
 20037
 20038*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20039
 20040     GO TO 8583-EXIT
 20041     .
 20042 8583-AGTC-NOT-FOUND.
 20043
 20044     MOVE 'N'                    TO AGTC-MASTER-SW.
 20045
 20046 8583-EXIT.
 20047     EXIT.
 20048
 20049 8584-READ-BANK-CROSS-REF.
 20050
 20051* EXEC CICS HANDLE CONDITION
 20052*        NOTFND    (8584-BXRF-NOT-FOUND)
 20053*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20054*    END-EXEC.
 20055*    MOVE '"$I''                  ! 8 #00018956' TO DFHEIV0
 20056     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20058     MOVE X'3820233030303138393536' TO DFHEIV0(25:11)
 20059     CALL 'kxdfhei1' USING DFHEIV0
 20060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20061
 20062
 20063
 20064* EXEC CICS READ
 20065*        DATASET     (BXRF-ID)
 20066*        INTO        (BANK-CROSS-REFERENCE)
 20067*        RIDFLD      (ERBXRF-KEY)
 20068*        LENGTH      (BXRF-REC-LENGTH)
 20069*    END-EXEC.
 20070*    MOVE '&"IL       E          (   #00018961' TO DFHEIV0
 20071     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20073     MOVE X'2020233030303138393631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 370
* EL050.cbl
 20074     CALL 'kxdfhei1' USING DFHEIV0,
 20075           BXRF-ID,
 20076           BANK-CROSS-REFERENCE,
 20077           BXRF-REC-LENGTH,
 20078           ERBXRF-KEY,
 20079           DFHEIV99,
 20080           DFHEIV99,
 20081           DFHEIV99
 20082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20083
 20084
 20085     MOVE 'Y'                    TO BXRF-MASTER-SW
 20086
 20087     GO TO 8584-EXIT
 20088     .
 20089 8584-BXRF-NOT-FOUND.
 20090
 20091     MOVE 'N'                    TO BXRF-MASTER-SW.
 20092
 20093 8584-EXIT.
 20094     EXIT.
 20095
 20096 8585-READ-PLAN-MASTER.
 20097
 20098
 20099* EXEC CICS HANDLE CONDITION
 20100*        NOTFND    (8585-PLAN-NOT-FOUND)
 20101*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20102*    END-EXEC.
 20103*    MOVE '"$I''                  ! 9 #00018981' TO DFHEIV0
 20104     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20106     MOVE X'3920233030303138393831' TO DFHEIV0(25:11)
 20107     CALL 'kxdfhei1' USING DFHEIV0
 20108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20109
 20110
 20111
 20112* EXEC CICS READ
 20113*        DATASET     (PLAN-ID)
 20114*        INTO        (PLAN-MASTER)
 20115*        RIDFLD      (ERPLAN-KEY)
 20116*    END-EXEC.
 20117     MOVE LENGTH OF
 20118      PLAN-MASTER
 20119       TO DFHEIV11
 20120*    MOVE '&"IL       E          (   #00018986' TO DFHEIV0
 20121     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20123     MOVE X'2020233030303138393836' TO DFHEIV0(25:11)
 20124     CALL 'kxdfhei1' USING DFHEIV0,
 20125           PLAN-ID,
 20126           PLAN-MASTER,
 20127           DFHEIV11,
 20128           ERPLAN-KEY,
 20129           DFHEIV99,
 20130           DFHEIV99,
 20131           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 371
* EL050.cbl
 20132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20133
 20134
 20135     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20136
 20137     GO TO 8585-EXIT.
 20138
 20139 8585-PLAN-NOT-FOUND.
 20140
 20141     MOVE 'N'                    TO PLAN-MASTER-SW.
 20142
 20143 8585-EXIT.
 20144     EXIT.
 20145
 20146 8586-READ-LOAN-OFFICER.
 20147
 20148* EXEC CICS READ
 20149*        DATASET     (LOFC-ID)
 20150*        INTO        (LOAN-OFFICER-MASTER)
 20151*        RIDFLD      (ERLOFC-KEY)
 20152*        RESP        (WS-RESPONSE)
 20153*    END-EXEC
 20154     MOVE LENGTH OF
 20155      LOAN-OFFICER-MASTER
 20156       TO DFHEIV11
 20157*    MOVE '&"IL       E          (  N#00019004' TO DFHEIV0
 20158     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20160     MOVE X'204E233030303139303034' TO DFHEIV0(25:11)
 20161     CALL 'kxdfhei1' USING DFHEIV0,
 20162           LOFC-ID,
 20163           LOAN-OFFICER-MASTER,
 20164           DFHEIV11,
 20165           ERLOFC-KEY,
 20166           DFHEIV99,
 20167           DFHEIV99,
 20168           DFHEIV99
 20169     MOVE EIBRESP  TO WS-RESPONSE
 20170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20171
 20172     IF WS-RESP-NORMAL
 20173        MOVE 'Y'                 TO LOFC-MASTER-SW
 20174     ELSE
 20175        MOVE 'N'                 TO LOFC-MASTER-SW
 20176     END-IF
 20177     .
 20178 8586-EXIT.
 20179     EXIT.
 20180 8587-START-ERPDEF.
 20181
 20182* EXEC CICS STARTBR
 20183*       DATASET   (PDEF-ID)
 20184*       RIDFLD    (ERPDEF-KEY)
 20185*       GTEQ
 20186*       RESP      (WS-RESPONSE)
 20187*    END-EXEC
 20188     MOVE 0
 20189       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 372
* EL050.cbl
 20190*    MOVE '&,         G          &  N#00019020' TO DFHEIV0
 20191     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20192     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20193     MOVE X'204E233030303139303230' TO DFHEIV0(25:11)
 20194     CALL 'kxdfhei1' USING DFHEIV0,
 20195           PDEF-ID,
 20196           ERPDEF-KEY,
 20197           DFHEIV99,
 20198           DFHEIV11,
 20199           DFHEIV99
 20200     MOVE EIBRESP  TO WS-RESPONSE
 20201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20202     IF WS-RESP-NORMAL
 20203        MOVE 'Y'                 TO PDEF-MASTER-SW
 20204     ELSE
 20205        MOVE 'N'                 TO PDEF-MASTER-SW
 20206     END-IF
 20207     .
 20208 8587-EXIT.
 20209     EXIT.
 20210 8588-READ-ERPDEF.
 20211
 20212* EXEC CICS READNEXT
 20213*       DATASET   (PDEF-ID)
 20214*       RIDFLD    (ERPDEF-KEY)
 20215*       INTO      (PRODUCT-MASTER)
 20216*       RESP      (WS-RESPONSE)
 20217*    END-EXEC
 20218     MOVE LENGTH OF
 20219      PRODUCT-MASTER
 20220       TO DFHEIV12
 20221     MOVE 0
 20222       TO DFHEIV11
 20223*    MOVE '&.IL                  )  N#00019035' TO DFHEIV0
 20224     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20225     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20226     MOVE X'204E233030303139303335' TO DFHEIV0(25:11)
 20227     CALL 'kxdfhei1' USING DFHEIV0,
 20228           PDEF-ID,
 20229           PRODUCT-MASTER,
 20230           DFHEIV12,
 20231           ERPDEF-KEY,
 20232           DFHEIV99,
 20233           DFHEIV11,
 20234           DFHEIV99,
 20235           DFHEIV99
 20236     MOVE EIBRESP  TO WS-RESPONSE
 20237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20238     IF WS-RESP-NORMAL
 20239        MOVE 'Y'                 TO PDEF-MASTER-SW
 20240     ELSE
 20241        MOVE 'N'                 TO PDEF-MASTER-SW
 20242     END-IF
 20243     .
 20244 8588-EXIT.
 20245     EXIT.
 20246 8589-ENDBR-ERPDEF.
 20247
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 373
* EL050.cbl
 20248* EXEC CICS ENDBR
 20249*       DATASET   (PDEF-ID)
 20250*    END-EXEC
 20251     MOVE 0
 20252       TO DFHEIV11
 20253*    MOVE '&2                    $   #00019050' TO DFHEIV0
 20254     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20255     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20256     MOVE X'2020233030303139303530' TO DFHEIV0(25:11)
 20257     CALL 'kxdfhei1' USING DFHEIV0,
 20258           PDEF-ID,
 20259           DFHEIV11,
 20260           DFHEIV99
 20261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20262     .
 20263 8589-EXIT.
 20264     EXIT.
 20265 8590-READ-CERT-MASTER.
 20266     IF PB-COMPANY-ID = 'UCL'
 20267         GO TO 8690-READ-CERT-MASTER-UCL.
 20268
 20269
 20270* EXEC CICS HANDLE CONDITION
 20271*         NOTFND    (0299-CERT-NOT-FOUND)
 20272*    END-EXEC.
 20273*    MOVE '"$I                   ! : #00019060' TO DFHEIV0
 20274     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20276     MOVE X'3A20233030303139303630' TO DFHEIV0(25:11)
 20277     CALL 'kxdfhei1' USING DFHEIV0
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281
 20282* EXEC CICS READ
 20283*        DATASET     (CERT-ID)
 20284*        INTO        (CERTIFICATE-MASTER)
 20285*        RIDFLD      (ELCERT-KEY)
 20286*        UPDATE
 20287*    END-EXEC.
 20288     MOVE LENGTH OF
 20289      CERTIFICATE-MASTER
 20290       TO DFHEIV11
 20291*    MOVE '&"IL       EU         (   #00019064' TO DFHEIV0
 20292     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20293     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20294     MOVE X'2020233030303139303634' TO DFHEIV0(25:11)
 20295     CALL 'kxdfhei1' USING DFHEIV0,
 20296           CERT-ID,
 20297           CERTIFICATE-MASTER,
 20298           DFHEIV11,
 20299           ELCERT-KEY,
 20300           DFHEIV99,
 20301           DFHEIV99,
 20302           DFHEIV99
 20303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20304
 20305
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 374
* EL050.cbl
 20306 8590-EXIT.
 20307     EXIT.
 20308
 20309 8690-READ-CERT-MASTER-UCL.
 20310
 20311* EXEC CICS HANDLE CONDITION
 20312*         NOTFND    (8700-READ-CERT-MASTER)
 20313*    END-EXEC.
 20314*    MOVE '"$I                   ! ; #00019075' TO DFHEIV0
 20315     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20317     MOVE X'3B20233030303139303735' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0
 20319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20320
 20321
 20322 8690-READ-CERT-CONT.
 20323
 20324* EXEC CICS READ
 20325*        DATASET     (CERT-ID)
 20326*        INTO        (CERTIFICATE-MASTER)
 20327*        RIDFLD      (ELCERT-KEY)
 20328*        UPDATE
 20329*    END-EXEC.
 20330     MOVE LENGTH OF
 20331      CERTIFICATE-MASTER
 20332       TO DFHEIV11
 20333*    MOVE '&"IL       EU         (   #00019080' TO DFHEIV0
 20334     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20335     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20336     MOVE X'2020233030303139303830' TO DFHEIV0(25:11)
 20337     CALL 'kxdfhei1' USING DFHEIV0,
 20338           CERT-ID,
 20339           CERTIFICATE-MASTER,
 20340           DFHEIV11,
 20341           ELCERT-KEY,
 20342           DFHEIV99,
 20343           DFHEIV99,
 20344           DFHEIV99
 20345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20346
 20347
 20348     GO TO 8590-EXIT.
 20349
 20350 8700-READ-CERT-MASTER.
 20351     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20352     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20353
 20354* EXEC CICS HANDLE CONDITION
 20355*         DUPKEY    (8720-COMP-ACCOUNTS)
 20356*         ENDFILE   (8730-END-BROWSE)
 20357*         NOTFND    (8740-NOT-FOUND)
 20358*    END-EXEC.
 20359*    MOVE '"$$''I                 ! < #00019092' TO DFHEIV0
 20360     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20362     MOVE X'3C20233030303139303932' TO DFHEIV0(25:11)
 20363     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 375
* EL050.cbl
 20364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20365
 20366
 20367
 20368* EXEC CICS STARTBR
 20369*        DATASET     ('ELCERT5')
 20370*        RIDFLD      (ELCERT2-KEY)
 20371*        EQUAL
 20372*    END-EXEC.
 20373     MOVE 'ELCERT5' TO DFHEIV1
 20374     MOVE 0
 20375       TO DFHEIV11
 20376*    MOVE '&,         E          &   #00019098' TO DFHEIV0
 20377     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20378     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20379     MOVE X'2020233030303139303938' TO DFHEIV0(25:11)
 20380     CALL 'kxdfhei1' USING DFHEIV0,
 20381           DFHEIV1,
 20382           ELCERT2-KEY,
 20383           DFHEIV99,
 20384           DFHEIV11,
 20385           DFHEIV99
 20386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20387
 20388
 20389 8710-READ-NEXT.
 20390
 20391* EXEC CICS READNEXT
 20392*        DATASET     ('ELCERT5')
 20393*        INTO        (CERTIFICATE-MASTER)
 20394*        RIDFLD      (ELCERT2-KEY)
 20395*    END-EXEC.
 20396     MOVE LENGTH OF
 20397      CERTIFICATE-MASTER
 20398       TO DFHEIV12
 20399     MOVE 'ELCERT5' TO DFHEIV1
 20400     MOVE 0
 20401       TO DFHEIV11
 20402*    MOVE '&.IL                  )   #00019105' TO DFHEIV0
 20403     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20404     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20405     MOVE X'2020233030303139313035' TO DFHEIV0(25:11)
 20406     CALL 'kxdfhei1' USING DFHEIV0,
 20407           DFHEIV1,
 20408           CERTIFICATE-MASTER,
 20409           DFHEIV12,
 20410           ELCERT2-KEY,
 20411           DFHEIV99,
 20412           DFHEIV11,
 20413           DFHEIV99,
 20414           DFHEIV99
 20415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20416
 20417
 20418 8720-COMP-ACCOUNTS.
 20419
 20420* EXEC CICS ENTER
 20421*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 376
* EL050.cbl
 20422*         FROM (PB-C-LAST-NAME)
 20423*    END-EXEC.
 20424     MOVE 001
 20425       TO DFHEIV11
 20426*    MOVE ':$F                   %   #00019112' TO DFHEIV0
 20427     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20428     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20429     MOVE X'2020233030303139313132' TO DFHEIV0(25:11)
 20430     CALL 'kxdfhei1' USING DFHEIV0,
 20431           DFHEIV11,
 20432           PB-C-LAST-NAME,
 20433           DFHEIV99,
 20434           DFHEIV99
 20435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20436
 20437
 20438
 20439* EXEC CICS ENTER
 20440*         TRACEID (002)
 20441*         FROM (CM-INSURED-LAST-NAME)
 20442*    END-EXEC.
 20443     MOVE 002
 20444       TO DFHEIV11
 20445*    MOVE ':$F                   %   #00019117' TO DFHEIV0
 20446     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20448     MOVE X'2020233030303139313137' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0,
 20450           DFHEIV11,
 20451           CM-INSURED-LAST-NAME,
 20452           DFHEIV99,
 20453           DFHEIV99
 20454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20455
 20456
 20457     IF PB-CERT-NO NOT = CM-CERT-NO
 20458         GO TO 8730-END-BROWSE.
 20459
 20460     IF PB-ACCOUNT = CM-ACCOUNT
 20461         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20462             MOVE ER-2799        TO WS-ERROR
 20463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20464             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20465             GO TO 8730-END-BROWSE.
 20466
 20467     GO TO 8710-READ-NEXT.
 20468
 20469 8730-END-BROWSE.
 20470
 20471* EXEC CICS ENDBR
 20472*         DATASET    ('ELCERT5')
 20473*    END-EXEC.
 20474     MOVE 'ELCERT5' TO DFHEIV1
 20475     MOVE 0
 20476       TO DFHEIV11
 20477*    MOVE '&2                    $   #00019135' TO DFHEIV0
 20478     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20479     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 377
* EL050.cbl
 20480     MOVE X'2020233030303139313335' TO DFHEIV0(25:11)
 20481     CALL 'kxdfhei1' USING DFHEIV0,
 20482           DFHEIV1,
 20483           DFHEIV11,
 20484           DFHEIV99
 20485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20486
 20487
 20488 8740-NOT-FOUND.
 20489     GO TO 0299-CERT-NOT-FOUND.
 20490
 20491 8750-START-ELSTAT.
 20492
 20493* EXEC CICS STARTBR
 20494*       DATASET   (STAT-ID)
 20495*       RIDFLD    (ELSTAT-KEY)
 20496*       GTEQ
 20497*       RESP      (WS-RESPONSE)
 20498*    END-EXEC
 20499     MOVE 0
 20500       TO DFHEIV11
 20501*    MOVE '&,         G          &  N#00019143' TO DFHEIV0
 20502     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20503     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20504     MOVE X'204E233030303139313433' TO DFHEIV0(25:11)
 20505     CALL 'kxdfhei1' USING DFHEIV0,
 20506           STAT-ID,
 20507           ELSTAT-KEY,
 20508           DFHEIV99,
 20509           DFHEIV11,
 20510           DFHEIV99
 20511     MOVE EIBRESP  TO WS-RESPONSE
 20512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20513     IF WS-RESP-NORMAL
 20514        MOVE 'Y'                 TO STAT-MASTER-SW
 20515     ELSE
 20516        MOVE 'N'                 TO STAT-MASTER-SW
 20517     END-IF
 20518     .
 20519 8750-EXIT.
 20520     EXIT.
 20521 8752-READ-ELSTAT.
 20522
 20523* EXEC CICS READNEXT
 20524*       DATASET   (STAT-ID)
 20525*       RIDFLD    (ELSTAT-KEY)
 20526*       INTO      (STATE-FILE)
 20527*       RESP      (WS-RESPONSE)
 20528*    END-EXEC
 20529     MOVE LENGTH OF
 20530      STATE-FILE
 20531       TO DFHEIV12
 20532     MOVE 0
 20533       TO DFHEIV11
 20534*    MOVE '&.IL                  )  N#00019158' TO DFHEIV0
 20535     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20536     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20537     MOVE X'204E233030303139313538' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 378
* EL050.cbl
 20538     CALL 'kxdfhei1' USING DFHEIV0,
 20539           STAT-ID,
 20540           STATE-FILE,
 20541           DFHEIV12,
 20542           ELSTAT-KEY,
 20543           DFHEIV99,
 20544           DFHEIV11,
 20545           DFHEIV99,
 20546           DFHEIV99
 20547     MOVE EIBRESP  TO WS-RESPONSE
 20548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20549     IF WS-RESP-NORMAL
 20550        MOVE 'Y'                 TO STAT-MASTER-SW
 20551     ELSE
 20552        MOVE 'N'                 TO STAT-MASTER-SW
 20553     END-IF
 20554     .
 20555 8752-EXIT.
 20556     EXIT.
 20557 8800-GET-COMP-RATE.
 20558     MOVE +1 TO IB.
 20559     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20560         ADD +9 TO IB
 20561         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20562             ADD +9 TO IB
 20563             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20564                MOVE ZEROS       TO WS-WK-RATE
 20565                GO TO 8800-EXIT.
 20566
 20567     IF PB-I-AGE GREATER CT-AGE (1)
 20568         ADD +3 TO IB
 20569         IF PB-I-AGE GREATER CT-AGE (2)
 20570             ADD +3 TO IB
 20571             IF PB-I-AGE GREATER CT-AGE (3)
 20572                MOVE ZEROS       TO WS-WK-RATE
 20573                GO TO 8800-EXIT.
 20574
 20575     IF WS-WORK-TERM GREATER CT-TRM (1)
 20576         ADD +1 TO IB
 20577         IF WS-WORK-TERM GREATER CT-TRM (2)
 20578             ADD +1 TO IB
 20579             IF WS-WORK-TERM GREATER CT-TRM (3)
 20580                MOVE ZEROS       TO WS-WK-RATE
 20581                GO TO 8800-EXIT.
 20582
 20583     IF CT-RT (IB) NOT NUMERIC
 20584         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20585         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20586         GO TO 8800-GET-COMP-RATE.
 20587
 20588     MOVE CT-RT (IB) TO WS-WK-RATE.
 20589
 20590 8800-EXIT.
 20591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 379
* EL050.cbl
 20593 8900-ADDRESS-FILE.
 20594     IF ERACCT-FILE-ADDRESSED
 20595         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20596         GO TO 8900-ADDRESS-EXIT.
 20597
 20598     IF ELCNTL-FILE-ADDRESSED
 20599         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20600         GO TO 8900-ADDRESS-EXIT.
 20601
 20602     IF ERPLAN-FILE-ADDRESSED
 20603         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20604         GO TO 8900-ADDRESS-EXIT.
 20605
 20606     IF ERFORM-FILE-ADDRESSED
 20607         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20608         GO TO 8900-ADDRESS-EXIT.
 20609
 20610 8900-ADDRESS-EXIT.
 20611     EXIT.
 20612
 20613 9000-READ-CONTROL.
 20614
 20615* EXEC CICS HANDLE CONDITION
 20616*        NOTFND    (9000-NOTFND)
 20617*    END-EXEC.
 20618*    MOVE '"$I                   ! = #00019229' TO DFHEIV0
 20619     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20621     MOVE X'3D20233030303139323239' TO DFHEIV0(25:11)
 20622     CALL 'kxdfhei1' USING DFHEIV0
 20623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20624
 20625
 20626
 20627* EXEC CICS READ
 20628*        DATASET     (CNTL-ID)
 20629*        SET         (ADDRESS OF CONTROL-FILE)
 20630*        RIDFLD      (ELCNTL-KEY)
 20631*        GTEQ
 20632*    END-EXEC.
 20633*    MOVE '&"S        G          (   #00019233' TO DFHEIV0
 20634     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20636     MOVE X'2020233030303139323333' TO DFHEIV0(25:11)
 20637     CALL 'kxdfhei1' USING DFHEIV0,
 20638           CNTL-ID,
 20639           DFHEIV20,
 20640           DFHEIV99,
 20641           ELCNTL-KEY,
 20642           DFHEIV99,
 20643           DFHEIV99,
 20644           DFHEIV99
 20645     SET ADDRESS OF CONTROL-FILE TO
 20646         DFHEIV20
 20647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20648
 20649
 20650     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 380
* EL050.cbl
 20651
 20652 9000-NOTFND.
 20653     IF RC-SW-1 = '1'
 20654        MOVE ER-2616              TO WS-ERROR
 20655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20656        GO TO 9000-EXIT.
 20657
 20658     IF RC-SW-1 = '2'
 20659        MOVE ER-2602              TO WS-ERROR
 20660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20661
 20662 9000-EXIT.
 20663      EXIT.
 20664
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 381
* EL050.cbl
 20666 9100-READ-CONTROL.
 20667
 20668* EXEC CICS HANDLE CONDITION
 20669*        NOTFND  (9100-NOTFND)
 20670*        ENDFILE (9100-NOTFND)
 20671*    END-EXEC.
 20672*    MOVE '"$I''                  ! > #00019257' TO DFHEIV0
 20673     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20674     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20675     MOVE X'3E20233030303139323537' TO DFHEIV0(25:11)
 20676     CALL 'kxdfhei1' USING DFHEIV0
 20677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20678
 20679
 20680
 20681* EXEC CICS READ
 20682*        DATASET     (CNTL-ID)
 20683*        INTO        (CONTROL-FILE)
 20684*        RIDFLD      (ELCNTL-KEY)
 20685*        GTEQ
 20686*    END-EXEC.
 20687     MOVE LENGTH OF
 20688      CONTROL-FILE
 20689       TO DFHEIV11
 20690*    MOVE '&"IL       G          (   #00019262' TO DFHEIV0
 20691     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20693     MOVE X'2020233030303139323632' TO DFHEIV0(25:11)
 20694     CALL 'kxdfhei1' USING DFHEIV0,
 20695           CNTL-ID,
 20696           CONTROL-FILE,
 20697           DFHEIV11,
 20698           ELCNTL-KEY,
 20699           DFHEIV99,
 20700           DFHEIV99,
 20701           DFHEIV99
 20702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20703
 20704
 20705     GO TO 9100-EXIT.
 20706
 20707 9100-NOTFND.
 20708     IF RC-SW-2 = '0'
 20709        MOVE '1'                  TO STATE-RECORD-ERROR
 20710        GO TO 9100-EXIT
 20711     END-IF
 20712     IF RC-SW-2 = '1'
 20713        MOVE '1'                  TO LF-BENEFIT-ERROR
 20714        MOVE ER-2604              TO WS-ERROR
 20715        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20716        GO TO 9100-EXIT.
 20717
 20718     IF RC-SW-2 = '2'
 20719        MOVE '1'                  TO AH-BENEFIT-ERROR
 20720        MOVE ER-2605              TO WS-ERROR
 20721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20722        GO TO 9100-EXIT.
 20723
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 382
* EL050.cbl
 20724     IF RC-SW-2 = '3'
 20725         MOVE ER-2603           TO WS-ERROR
 20726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20727         GO TO 9100-EXIT.
 20728
 20729     IF RC-SW-2 = '4'
 20730         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20731         GO TO 9100-EXIT.
 20732
 20733     IF RC-SW-2 = '5'
 20734         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20735         IF WS-AH-INPUT-CD-1 = SPACE
 20736             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20737         ELSE
 20738             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20739
 20740 9100-EXIT.
 20741      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 383
* EL050.cbl
 20743 9200-CONTROL-GETMAIN.
 20744
 20745* EXEC CICS GETMAIN
 20746*         LENGTH   (750)
 20747*         SET      (ADDRESS OF CONTROL-FILE)
 20748*    END-EXEC.
 20749     MOVE 750
 20750       TO DFHEIV11
 20751*    MOVE '," L                  $   #00019308' TO DFHEIV0
 20752     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20754     MOVE X'2020233030303139333038' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0,
 20756           DFHEIV20,
 20757           DFHEIV11,
 20758           DFHEIV99
 20759     SET ADDRESS OF CONTROL-FILE TO
 20760         DFHEIV20
 20761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20762
 20763
 20764     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20765
 20766 9200-EXIT.
 20767     EXIT.
 20768
 20769 9250-UNLOCK-RETURN.
 20770
 20771* EXEC CICS UNLOCK
 20772*        DATASET   (CERT-ID)
 20773*    END-EXEC.
 20774*    MOVE '&*                    #   #00019319' TO DFHEIV0
 20775     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20776     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20777     MOVE X'2020233030303139333139' TO DFHEIV0(25:11)
 20778     CALL 'kxdfhei1' USING DFHEIV0,
 20779           CERT-ID,
 20780           DFHEIV99
 20781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20782
 20783
 20784 9300-ABEND.
 20785     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20786
 20787
 20788* EXEC CICS LINK
 20789*        PROGRAM   ('EL004')
 20790*        COMMAREA  (WS-ERROR-LINE)
 20791*        LENGTH    (72)
 20792*    END-EXEC.
 20793     MOVE 'EL004' TO DFHEIV1
 20794     MOVE 72
 20795       TO DFHEIV11
 20796*    MOVE '."C                   (   #00019326' TO DFHEIV0
 20797     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20799     MOVE X'2020233030303139333236' TO DFHEIV0(25:11)
 20800     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 384
* EL050.cbl
 20801           DFHEIV1,
 20802           WS-ERROR-LINE,
 20803           DFHEIV11,
 20804           DFHEIV99,
 20805           DFHEIV99,
 20806           DFHEIV99,
 20807           DFHEIV99
 20808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20809
 20810
 20811     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20812
 20813
 20814* EXEC CICS ABEND
 20815*        ABCODE ('EL50')
 20816*    END-EXEC.
 20817     MOVE 'EL50' TO DFHEIV5
 20818*    MOVE '.,A                   "   #00019334' TO DFHEIV0
 20819     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20820     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20821     MOVE X'2020233030303139333334' TO DFHEIV0(25:11)
 20822     CALL 'kxdfhei1' USING DFHEIV0,
 20823           DFHEIV5
 20824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20825
 20826
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 385
* EL050.cbl
 20828
 20829******************************************************************
 20830*                                                                *
 20831*            E R R O R   F O R M A T   R O U T I N E             *
 20832*                                                                *
 20833******************************************************************
 20834
 20835 9900-ERROR-FORMAT.
 20836
 20837     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20838                    PB-COMMON-ERROR (2) OR
 20839                    PB-COMMON-ERROR (3) OR
 20840                    PB-COMMON-ERROR (4) OR
 20841                    PB-COMMON-ERROR (5) OR
 20842                    PB-COMMON-ERROR (6) OR
 20843                    PB-COMMON-ERROR (7) OR
 20844                    PB-COMMON-ERROR (8) OR
 20845                    PB-COMMON-ERROR (9) OR
 20846                    PB-COMMON-ERROR (10)
 20847        GO TO 9900-EXIT.
 20848
 20849     IF PB-NO-OF-ERRORS = +10
 20850        GO TO 9900-EXIT.
 20851
 20852     ADD +1  TO PB-NO-OF-ERRORS.
 20853     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20854                                       (PB-NO-OF-ERRORS).
 20855 9900-EXIT.
 20856     EXIT.
 20857
 20858 9990-RETURN.
 20859     IF BROWSE-STARTED
 20860
 20861* EXEC CICS ENDBR
 20862*            DATASET  (ACCT-ID)
 20863*       END-EXEC.
 20864     MOVE 0
 20865       TO DFHEIV11
 20866*    MOVE '&2                    $   #00019371' TO DFHEIV0
 20867     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20868     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20869     MOVE X'2020233030303139333731' TO DFHEIV0(25:11)
 20870     CALL 'kxdfhei1' USING DFHEIV0,
 20871           ACCT-ID,
 20872           DFHEIV11,
 20873           DFHEIV99
 20874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20875
 20876
 20877 9990-EXIT.
 20878     EXIT.
 20879
 20880
 20881****Check for CRTO record, add one if not found.
 20882 9991-CHECK-FOR-ELCRTO.
 20883
 20884* EXEC CICS HANDLE CONDITION
 20885*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 386
* EL050.cbl
 20886*         ENDFILE (9991-CRTO-NOT-FOUND)
 20887*     END-EXEC.
 20888*    MOVE '"$I''                  ! ? #00019381' TO DFHEIV0
 20889     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20891     MOVE X'3F20233030303139333831' TO DFHEIV0(25:11)
 20892     CALL 'kxdfhei1' USING DFHEIV0
 20893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20894
 20895     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 20896     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 20897     MOVE +0                     TO ELCRTO-SEQ-NO
 20898
 20899
 20900* EXEC CICS READ
 20901*       DATASET   ('ELCRTO')
 20902*       INTO      (ORIGINAL-CERTIFICATE)
 20903*       RIDFLD    (ELCRTO-KEY)
 20904*       GTEQ
 20905*       RESP      (WS-RESPONSE)
 20906*    END-EXEC
 20907     MOVE LENGTH OF
 20908      ORIGINAL-CERTIFICATE
 20909       TO DFHEIV11
 20910     MOVE 'ELCRTO' TO DFHEIV1
 20911*    MOVE '&"IL       G          (  N#00019389' TO DFHEIV0
 20912     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20914     MOVE X'204E233030303139333839' TO DFHEIV0(25:11)
 20915     CALL 'kxdfhei1' USING DFHEIV0,
 20916           DFHEIV1,
 20917           ORIGINAL-CERTIFICATE,
 20918           DFHEIV11,
 20919           ELCRTO-KEY,
 20920           DFHEIV99,
 20921           DFHEIV99,
 20922           DFHEIV99
 20923     MOVE EIBRESP  TO WS-RESPONSE
 20924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20925
 20926     IF WS-RESP-NORMAL
 20927        AND (OC-CONTROL-PRIMARY (1:33) =
 20928                 PB-CONTROL-BY-ACCOUNT (1:33))
 20929        AND (OC-RECORD-TYPE =  'I')
 20930           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 20931               GO TO 9991-EXIT
 20932           ELSE
 20933               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 20934               GO TO 9991-CRTO-ADD-REC
 20935           END-IF
 20936     END-IF.
 20937
 20938 9991-CRTO-NOT-FOUND.
 20939
 20940     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 20941     MOVE 'OC'                TO OC-RECORD-ID
 20942     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 20943                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 387
* EL050.cbl
 20944     MOVE +4096               TO OC-KEY-SEQ-NO.
 20945
 20946 9991-CRTO-ADD-REC.
 20947
 20948     MOVE 'E050'              TO OC-LAST-MAINT-BY
 20949     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 20950     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 20951     MOVE 'I'                 TO OC-RECORD-TYPE
 20952     IF PB-ISSUE
 20953         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 20954         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 20955         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 20956         MOVE PB-I-AGE               TO OC-INS-AGE
 20957         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 20958         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 20959         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 20960         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 20961         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 20962         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 20963         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 20964         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 20965         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 20966         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 20967         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 20968         IF PB-I-JOINT-COMMISSION > +0
 20969             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 20970         ELSE
 20971             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 20972         END-IF
 20973         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 20974         MOVE +0                     TO OC-LF-CANCEL-AMT
 20975                                        OC-LF-ITD-CANCEL-AMT
 20976         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 20977         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 20978         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 20979         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 20980         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 20981         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 20982         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 20983         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 20984         MOVE +0                     TO OC-AH-CANCEL-AMT
 20985                                        OC-AH-ITD-CANCEL-AMT
 20986         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 20987     ELSE
 20988         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 20989         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 20990         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 20991         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 20992         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 20993         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 20994         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 20995         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 20996         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 20997          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 20998             MOVE SPACES             TO OC-LF-BENCD
 20999             MOVE ZEROS              TO OC-LF-TERM
 21000                                        OC-LF-BEN-AMT
 21001                                        OC-LF-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 388
* EL050.cbl
 21002                                        OC-LF-ALT-BEN-AMT
 21003                                        OC-LF-ALT-PRM-AMT
 21004                                        OC-LF-COMM-PCT
 21005                                        OC-LF-CANCEL-AMT
 21006             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21007             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21008         ELSE
 21009             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21010             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21011             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21012             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21013             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21014             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21015             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21016             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21017             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21018             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21019         END-IF
 21020         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21021         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21022          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21023             MOVE SPACES             TO OC-AH-BENCD
 21024             MOVE ZEROS              TO OC-AH-TERM
 21025                                        OC-AH-BEN-AMT
 21026                                        OC-AH-PRM-AMT
 21027                                        OC-AH-COMM-PCT
 21028                                        OC-AH-CANCEL-AMT
 21029                                        OC-AH-CP
 21030             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21031             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21032         ELSE
 21033             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21034             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21035             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21036             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21037             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21038             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21039             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21040             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21041             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21042         END-IF
 21043         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21044         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21045     END-IF
 21046     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21047
 21048     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21049
 21050
 21051* EXEC CICS READ
 21052*         DATASET   (FILE-ERMAIL)
 21053*         RIDFLD    (MA-CONTROL-PRIMARY)
 21054*         INTO      (MAILING-DATA)
 21055*         RESP      (WS-RESPONSE)
 21056*    END-EXEC
 21057     MOVE LENGTH OF
 21058      MAILING-DATA
 21059       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 389
* EL050.cbl
 21060*    MOVE '&"IL       E          (  N#00019521' TO DFHEIV0
 21061     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21063     MOVE X'204E233030303139353231' TO DFHEIV0(25:11)
 21064     CALL 'kxdfhei1' USING DFHEIV0,
 21065           FILE-ERMAIL,
 21066           MAILING-DATA,
 21067           DFHEIV11,
 21068           MA-CONTROL-PRIMARY,
 21069           DFHEIV99,
 21070           DFHEIV99,
 21071           DFHEIV99
 21072     MOVE EIBRESP  TO WS-RESPONSE
 21073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21074
 21075     IF WS-RESP-NORMAL
 21076         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21077     END-IF.
 21078
 21079
 21080* EXEC CICS WRITE
 21081*       DATASET   ('ELCRTO')
 21082*       FROM      (ORIGINAL-CERTIFICATE)
 21083*       RIDFLD    (OC-CONTROL-PRIMARY)
 21084*       RESP      (WS-RESPONSE)
 21085*    END-EXEC.
 21086     MOVE LENGTH OF
 21087      ORIGINAL-CERTIFICATE
 21088       TO DFHEIV11
 21089     MOVE 'ELCRTO' TO DFHEIV1
 21090*    MOVE '&$ L                  ''  N#00019532' TO DFHEIV0
 21091     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21092     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21093     MOVE X'204E233030303139353332' TO DFHEIV0(25:11)
 21094     CALL 'kxdfhei1' USING DFHEIV0,
 21095           DFHEIV1,
 21096           ORIGINAL-CERTIFICATE,
 21097           DFHEIV11,
 21098           OC-CONTROL-PRIMARY,
 21099           DFHEIV99,
 21100           DFHEIV99
 21101     MOVE EIBRESP  TO WS-RESPONSE
 21102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21103
 21104
 21105 9991-EXIT.
 21106     EXIT.
 21107
 21108
 21109 9999-RETURN.
 21110     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21111
 21112
 21113* EXEC CICS RETURN
 21114*    END-EXEC.
 21115*    MOVE '.(                    ''   #00019546' TO DFHEIV0
 21116     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 390
* EL050.cbl
 21118     MOVE X'2020233030303139353436' TO DFHEIV0(25:11)
 21119     CALL 'kxdfhei1' USING DFHEIV0,
 21120           DFHEIV99,
 21121           DFHEIV99,
 21122           DFHEIV99,
 21123           DFHEIV99,
 21124           DFHEIV99,
 21125           DFHEIV99
 21126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21127
 21128
 21129
 21130* GOBACK.
 21131     MOVE '9%                    "   ' TO DFHEIV0
 21132     MOVE 'EL050' TO DFHEIV1
 21133     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21134     GOBACK.
 21135
 21136 9999-DFHBACK SECTION.
 21137     MOVE '9%                    "   ' TO DFHEIV0
 21138     MOVE 'EL050' TO DFHEIV1
 21139     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21140     GOBACK.
 21141 9999-DFHEXIT.
 21142     IF DFHEIGDJ EQUAL 0001
 21143         NEXT SENTENCE
 21144     ELSE IF DFHEIGDJ EQUAL 2
 21145         GO TO 9300-ABEND,
 21146               3990-FILES-NOT-OPEN
 21147         DEPENDING ON DFHEIGDI
 21148     ELSE IF DFHEIGDJ EQUAL 3
 21149         GO TO 6610-START-BROWSE,
 21150               6630-ERRESS-PROBLEM,
 21151               6630-END-OF-FILE
 21152         DEPENDING ON DFHEIGDI
 21153     ELSE IF DFHEIGDJ EQUAL 4
 21154         GO TO 6630-END-OF-FILE,
 21155               6630-ERRESS-PROBLEM,
 21156               6630-ERRESS-PROBLEM,
 21157               6630-END-OF-FILE
 21158         DEPENDING ON DFHEIGDI
 21159     ELSE IF DFHEIGDJ EQUAL 5
 21160         GO TO 6630-END-OF-FILE,
 21161               6630-END-OF-FILE,
 21162               6630-ERRESS-PROBLEM,
 21163               6630-ERRESS-PROBLEM
 21164         DEPENDING ON DFHEIGDI
 21165     ELSE IF DFHEIGDJ EQUAL 6
 21166         GO TO 6660-START-BROWSE,
 21167               6690-ERRESC-PROBLEM,
 21168               6690-ERRESC-PROBLEM,
 21169               6690-END-OF-FILE
 21170         DEPENDING ON DFHEIGDI
 21171     ELSE IF DFHEIGDJ EQUAL 7
 21172         GO TO 6690-END-OF-FILE,
 21173               6690-ERRESC-PROBLEM,
 21174               6690-ERRESC-PROBLEM,
 21175               6690-END-OF-FILE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 391
* EL050.cbl
 21176         DEPENDING ON DFHEIGDI
 21177     ELSE IF DFHEIGDJ EQUAL 8
 21178         GO TO 6690-END-OF-FILE,
 21179               6690-ERRESC-PROBLEM,
 21180               6690-ERRESC-PROBLEM,
 21181               6690-END-OF-FILE
 21182         DEPENDING ON DFHEIGDI
 21183     ELSE IF DFHEIGDJ EQUAL 9
 21184         GO TO 7250-CONTINUE,
 21185               7250-CONTINUE
 21186         DEPENDING ON DFHEIGDI
 21187     ELSE IF DFHEIGDJ EQUAL 10
 21188         GO TO 7300-CONTINUE,
 21189               7300-CONTINUE
 21190         DEPENDING ON DFHEIGDI
 21191     ELSE IF DFHEIGDJ EQUAL 11
 21192         GO TO 8000-FREE-MAIN
 21193         DEPENDING ON DFHEIGDI
 21194     ELSE IF DFHEIGDJ EQUAL 12
 21195         GO TO 8100-NOTFND,
 21196               8100-NOTFND
 21197         DEPENDING ON DFHEIGDI
 21198     ELSE IF DFHEIGDJ EQUAL 13
 21199         GO TO 8110-NOTFND,
 21200               8110-NOTFND
 21201         DEPENDING ON DFHEIGDI
 21202     ELSE IF DFHEIGDJ EQUAL 14
 21203         GO TO 8130-EXIT
 21204         DEPENDING ON DFHEIGDI
 21205     ELSE IF DFHEIGDJ EQUAL 15
 21206         GO TO 8180-NOTFND
 21207         DEPENDING ON DFHEIGDI
 21208     ELSE IF DFHEIGDJ EQUAL 16
 21209         GO TO 8190-NOTFND
 21210         DEPENDING ON DFHEIGDI
 21211     ELSE IF DFHEIGDJ EQUAL 17
 21212         GO TO 8200-NOTFND
 21213         DEPENDING ON DFHEIGDI
 21214     ELSE IF DFHEIGDJ EQUAL 18
 21215         GO TO 8300-NOTFND,
 21216               8300-ERRESS-PROBLEM,
 21217               8300-ERRESS-PROBLEM,
 21218               8300-NOTFND
 21219         DEPENDING ON DFHEIGDI
 21220     ELSE IF DFHEIGDJ EQUAL 19
 21221         GO TO 8450-FORM-NOT-FOUND,
 21222               8450-FORM-NOT-FOUND
 21223         DEPENDING ON DFHEIGDI
 21224     ELSE IF DFHEIGDJ EQUAL 20
 21225         GO TO 0199-ACCT-NOT-FOUND,
 21226               0199-ACCT-NOT-FOUND
 21227         DEPENDING ON DFHEIGDI
 21228     ELSE IF DFHEIGDJ EQUAL 21
 21229         GO TO 0199-ACCT-NOT-FOUND,
 21230               0199-ACCT-NOT-FOUND
 21231         DEPENDING ON DFHEIGDI
 21232     ELSE IF DFHEIGDJ EQUAL 22
 21233         GO TO 8582-COMP-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-12 09:46 Page 392
* EL050.cbl
 21234               8582-COMP-NOT-FOUND
 21235         DEPENDING ON DFHEIGDI
 21236     ELSE IF DFHEIGDJ EQUAL 23
 21237         GO TO 8583-AGTC-NOT-FOUND,
 21238               8583-AGTC-NOT-FOUND
 21239         DEPENDING ON DFHEIGDI
 21240     ELSE IF DFHEIGDJ EQUAL 24
 21241         GO TO 8584-BXRF-NOT-FOUND,
 21242               8584-BXRF-NOT-FOUND
 21243         DEPENDING ON DFHEIGDI
 21244     ELSE IF DFHEIGDJ EQUAL 25
 21245         GO TO 8585-PLAN-NOT-FOUND,
 21246               8585-PLAN-NOT-FOUND
 21247         DEPENDING ON DFHEIGDI
 21248     ELSE IF DFHEIGDJ EQUAL 26
 21249         GO TO 0299-CERT-NOT-FOUND
 21250         DEPENDING ON DFHEIGDI
 21251     ELSE IF DFHEIGDJ EQUAL 27
 21252         GO TO 8700-READ-CERT-MASTER
 21253         DEPENDING ON DFHEIGDI
 21254     ELSE IF DFHEIGDJ EQUAL 28
 21255         GO TO 8720-COMP-ACCOUNTS,
 21256               8730-END-BROWSE,
 21257               8740-NOT-FOUND
 21258         DEPENDING ON DFHEIGDI
 21259     ELSE IF DFHEIGDJ EQUAL 29
 21260         GO TO 9000-NOTFND
 21261         DEPENDING ON DFHEIGDI
 21262     ELSE IF DFHEIGDJ EQUAL 30
 21263         GO TO 9100-NOTFND,
 21264               9100-NOTFND
 21265         DEPENDING ON DFHEIGDI
 21266     ELSE IF DFHEIGDJ EQUAL 31
 21267         GO TO 9991-CRTO-NOT-FOUND,
 21268               9991-CRTO-NOT-FOUND
 21269         DEPENDING ON DFHEIGDI.
 21270     MOVE '9%                    "   ' TO DFHEIV0
 21271     MOVE 'EL050' TO DFHEIV1
 21272     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21273     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39896     Code:       83923
