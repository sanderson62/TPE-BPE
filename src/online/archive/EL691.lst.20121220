* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL691.cbl
* Options: int("EL691.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL691.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL691.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL691.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL691.
     4*
     5*AUTHOR.    LOGIC, INC.
     6*           DALLAS, TEXAS.
     7
     8*DATE-COMPILED.
     9
    10*REMARKS.
    11*        THIS PROGRAM PROVIDES THE FUNCTIONS TO BROWSE AND EDIT
    12*    THE DETAIL OF AN ARCHIVED LETTER.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL691.cbl
    14*    TRANS ID = EXN1
    15
    16******************************************************************
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 071111    2011022800001  AJRA  NAPERSOFT - NEW SCREEN
    25* 100312    2011022800001  AJRA  CHANGE RECEIVED MSG
    26******************************************************************
    27
    28 DATA DIVISION.
    29 WORKING-STORAGE SECTION.
    30 01  DFH-START PIC X(04).
    31 77  FILLER  PIC X(32) VALUE '********************************'.
    32 77  FILLER  PIC X(32) VALUE '*    EL691 WORKING STORAGE     *'.
    33 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL691.cbl
    35
    36 01  W-WORK-AREAS.
    37     12  FILLER                  PIC  X(18)
    38                                      VALUE 'PROGRAM WORK AREA:'.
    39     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
    40     12  W-CALL-PGM              PIC  X(08).
    41     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
    42     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
    43     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
    44
    45     12  W-TIME-IN               PIC S9(07).
    46     12  FILLER REDEFINES W-TIME-IN.
    47         16  FILLER              PIC  X(01).
    48         16  W-TIME-OUT          PIC  9(02)V9(02).
    49         16  FILLER              PIC  X(02).
    50
    51     12  W-DEEDIT-FIELD          PIC  X(15).
    52     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
    53
    54     12  W-ERROR-COUNT           PIC S9(3)       VALUE ZERO.
    55     12  W-UPDATE-SW             PIC S9          VALUE ZERO.
    56     12  W-RESEND-DATE           PIC XX    VALUE LOW-VALUES.
    57     12  W-SENT-DATE             PIC XX    VALUE LOW-VALUES.
    58     12  W-FINAL-ACT-DATE        PIC XX    VALUE LOW-VALUES.
    59     12  W-RECEIVED-DATE         PIC XX    VALUE LOW-VALUES.
    60     12  W-STOP-LETTER-DATE      PIC XX    VALUE LOW-VALUES.
    61     12  W-RESPONSE              PIC S9(8)   COMP.
    62         88  RESP-NORMAL                  VALUE +00.
    63         88  RESP-NOTFND                  VALUE +13.
    64         88  RESP-DUPREC                  VALUE +14.
    65         88  RESP-DUPKEY                  VALUE +15.
    66         88  RESP-NOTOPEN                 VALUE +19.
    67         88  RESP-ENDFILE                 VALUE +20.
    68
    69     12  W-ARCH-SAVE-KEY         PIC  X(03).
    70     12  W-ARCH-KEY.
    71         16  W-ARCH-COMPANY-CD   PIC  X(01).
    72         16  W-ARCH-NUMBER       PIC S9(08)      COMP.
    73
    74     12  W-ARCT-KEY.
    75         16  W-ARCT-COMPANY-CD   PIC  X(01).
    76         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
    77         16  W-ARCT-RECORD-TYPE  PIC  X(01).
    78             88  W-ARCT-COMMENT-DATA   VALUE '3'.
    79         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
    80
    81     12  W-CERT-NOTE-MSG.
    82         16  FILLER              PIC X(29)
    83             VALUE 'REQUESTED DOCUMENT RECEIVED  '.
    84         16  W-CERT-NOTE-RECV-DT PIC X(8).
    85
    86     12  ELCERT-FILE-ID          PIC  X(08)  VALUE 'ELCERT'.
    87     12  ERCNOT-FILE-ID          PIC  X(08)  VALUE 'ERCNOT'.
    88     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
    89     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
    90     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
    91     12  ERCNOT-KEY.
    92         16  ERCNOT-PARTIAL-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL691.cbl
    93             20 ERCNOT-COMPANY-CD    PIC X.
    94             20 ERCNOT-CARRIER       PIC X.
    95             20 ERCNOT-GROUPING      PIC X(06).
    96             20 ERCNOT-STATE         PIC XX.
    97             20 ERCNOT-ACCOUNT       PIC X(10).
    98             20 ERCNOT-EFF-DT        PIC XX.
    99             20 ERCNOT-CERT-NO.
   100                25 ERCNOT-CERT-PRIME PIC X(10).
   101                25 ERCNOT-CERT-SFX   PIC X.
   102             20 ERCNOT-REC-TYP       PIC X.
   103         16 ERCNOT-SEQ           PIC S9(4) COMP.
   104     12  SV-PRIOR-KEY.
   105         16 SV-COMPANY-CD            PIC X.
   106         16 SV-CARRIER               PIC X.
   107         16 SV-GROUPING              PIC X(06).
   108         16 SV-STATE                 PIC XX.
   109         16 SV-ACCOUNT               PIC X(10).
   110         16 SV-EFF-DT                PIC XX.
   111         16 SV-CERT-NO.
   112            20 SV-CERT-PRIME         PIC X(10).
   113            20 SV-CERT-SFX           PIC X(1).
   114         16 SV-REC-TYP               PIC X.
   115         16  SV-NOTE-SEQUENCE        PIC S9(4) COMP.
   116     12  ELCERT-KEY.
   117         16  ELCERT-COMPANY-CD        PIC X.
   118         16  ELCERT-CARRIER           PIC X.
   119         16  ELCERT-GROUPING          PIC X(6).
   120         16  ELCERT-STATE             PIC XX.
   121         16  ELCERT-ACCOUNT           PIC X(10).
   122         16  ELCERT-EFF-DT            PIC XX.
   123         16  ELCERT-CERT-NO.
   124             20  ELCERT-CERT-PRIME    PIC X(10).
   125             20  ELCERT-CERT-SFX      PIC X.
   126
   127
   128 01  FILLER                      PIC  X(22)
   129                                 VALUE 'INTERFACE AREA STARTS:'.
   130*    COPY ELCINTF.
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCINTF.                            *
   135*                            VMOD=2.017                          *
   136*                                                                *
   137*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   138*                                                                *
   139*       LENGTH = 1024                                            *
   140*                                                                *
   141******************************************************************
   142*                   C H A N G E   L O G
   143*
   144* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   145*-----------------------------------------------------------------
   146*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   147* EFFECTIVE    NUMBER
   148*-----------------------------------------------------------------
   149* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   150******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL691.cbl
   151 01  PROGRAM-INTERFACE-BLOCK.
   152     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   153     12  PI-CALLING-PROGRAM              PIC X(8).
   154     12  PI-SAVED-PROGRAM-1              PIC X(8).
   155     12  PI-SAVED-PROGRAM-2              PIC X(8).
   156     12  PI-SAVED-PROGRAM-3              PIC X(8).
   157     12  PI-SAVED-PROGRAM-4              PIC X(8).
   158     12  PI-SAVED-PROGRAM-5              PIC X(8).
   159     12  PI-SAVED-PROGRAM-6              PIC X(8).
   160     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   161     12  PI-COMPANY-ID                   PIC XXX.
   162     12  PI-COMPANY-CD                   PIC X.
   163
   164     12  PI-COMPANY-PASSWORD             PIC X(8).
   165
   166     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   167
   168     12  PI-CONTROL-IN-PROGRESS.
   169         16  PI-CARRIER                  PIC X.
   170         16  PI-GROUPING                 PIC X(6).
   171         16  PI-STATE                    PIC XX.
   172         16  PI-ACCOUNT                  PIC X(10).
   173         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   174                                         PIC X(10).
   175         16  PI-CLAIM-CERT-GRP.
   176             20  PI-CLAIM-NO             PIC X(7).
   177             20  PI-CERT-NO.
   178                 25  PI-CERT-PRIME       PIC X(10).
   179                 25  PI-CERT-SFX         PIC X.
   180             20  PI-CERT-EFF-DT          PIC XX.
   181         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   182             20  PI-PLAN-CODE            PIC X(2).
   183             20  PI-REVISION-NUMBER      PIC X(3).
   184             20  PI-PLAN-EFF-DT          PIC X(2).
   185             20  PI-PLAN-EXP-DT          PIC X(2).
   186             20  FILLER                  PIC X(11).
   187         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   188             20  PI-OE-REFERENCE-1.
   189                 25  PI-OE-REF-1-PRIME   PIC X(18).
   190                 25  PI-OE-REF-1-SUFF    PIC XX.
   191
   192     12  PI-SESSION-IN-PROGRESS          PIC X.
   193         88  CLAIM-SESSION                   VALUE '1'.
   194         88  CREDIT-SESSION                  VALUE '2'.
   195         88  WARRANTY-SESSION                VALUE '3'.
   196         88  MORTGAGE-SESSION                VALUE '4'.
   197         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   198
   199
   200*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   201
   202     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   203     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   204
   205     12  PI-CREDIT-USER                  PIC X.
   206         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   207         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   208
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL691.cbl
   209     12  PI-CLAIM-USER                   PIC X.
   210         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   211         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   212
   213     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   214         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   215         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   216         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   217         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   218         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   219
   220     12  PI-PROCESSOR-ID                 PIC X(4).
   221
   222     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   223
   224     12  PI-MEMBER-CAPTION               PIC X(10).
   225
   226     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   227         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   228
   229     12  PI-LIFE-OVERRIDE-L1             PIC X.
   230     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   231     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   232     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   233
   234     12  PI-AH-OVERRIDE-L1               PIC X.
   235     12  PI-AH-OVERRIDE-L2               PIC XX.
   236     12  PI-AH-OVERRIDE-L6               PIC X(6).
   237     12  PI-AH-OVERRIDE-L12              PIC X(12).
   238
   239     12  PI-NEW-SYSTEM                   PIC X(2).
   240
   241     12  PI-PRIMARY-CERT-NO              PIC X(11).
   242     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   243         88  PI-USES-PAID-TO                 VALUE '1'.
   244     12  PI-CRDTCRD-SYSTEM.
   245         16  PI-CRDTCRD-USER             PIC X.
   246             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   247             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   248         16  PI-CC-MONTH-END-DT          PIC XX.
   249     12  PI-PROCESSOR-PRINTER            PIC X(4).
   250
   251     12  PI-OE-REFERENCE-2.
   252         16  PI-OE-REF-2-PRIME           PIC X(10).
   253         16  PI-OE-REF-2-SUFF            PIC X.
   254
   255     12  PI-REM-TRM-CALC-OPTION          PIC X.
   256
   257     12  PI-LANGUAGE-TYPE                PIC X.
   258             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   259             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   260             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   261
   262     12  PI-POLICY-LINKAGE-IND           PIC X.
   263         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   264         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   265                                                   LOW-VALUES.
   266
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL691.cbl
   267     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   268     12  PI-CLAIM-PW-SESSION             PIC X(1).
   269         88  PI-CLAIM-CREDIT                 VALUE '1'.
   270         88  PI-CLAIM-CONVEN                 VALUE '2'.
   271
   272     12  PI-PROCESSOR-CSR-IND            PIC X.
   273         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   274         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   275
   276     12  FILLER                          PIC X(3).
   277
   278     12  PI-SYSTEM-LEVEL                 PIC X(145).
   279
   280     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   281         PI-SYSTEM-LEVEL.
   282
   283         16  PI-ENTRY-CODES.
   284             20  PI-ENTRY-CD-1           PIC X.
   285             20  PI-ENTRY-CD-2           PIC X.
   286
   287         16  PI-RETURN-CODES.
   288             20  PI-RETURN-CD-1          PIC X.
   289             20  PI-RETURN-CD-2          PIC X.
   290
   291         16  PI-UPDATE-STATUS-SAVE.
   292             20  PI-UPDATE-BY            PIC X(4).
   293             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   294
   295         16  PI-LOWER-CASE-LETTERS       PIC X.
   296             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   297
   298*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   299*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   300*            88  CARRIER-CLM-CNTL            VALUE '2'.
   301
   302         16  PI-CERT-ACCESS-CONTROL      PIC X.
   303             88  ST-ACCNT-CNTL               VALUE ' '.
   304             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   305             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   306             88  ACCNT-CNTL                  VALUE '3'.
   307             88  CARR-ACCNT-CNTL             VALUE '4'.
   308
   309         16  PI-PROCESSOR-CAP-LIST.
   310             20  PI-SYSTEM-CONTROLS.
   311                24 PI-SYSTEM-DISPLAY     PIC X.
   312                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   313                24 PI-SYSTEM-MODIFY      PIC X.
   314                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   315             20  FILLER                  PIC XX.
   316             20  PI-DISPLAY-CAP          PIC X.
   317                 88  DISPLAY-CAP             VALUE 'Y'.
   318             20  PI-MODIFY-CAP           PIC X.
   319                 88  MODIFY-CAP              VALUE 'Y'.
   320             20  PI-MSG-AT-LOGON-CAP     PIC X.
   321                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   322             20  PI-FORCE-CAP            PIC X.
   323                 88  FORCE-CAP               VALUE 'Y'.
   324
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL691.cbl
   325         16  PI-PROGRAM-CONTROLS.
   326             20  PI-PGM-PRINT-OPT        PIC X.
   327             20  PI-PGM-FORMAT-OPT       PIC X.
   328             20  PI-PGM-PROCESS-OPT      PIC X.
   329             20  PI-PGM-TOTALS-OPT       PIC X.
   330
   331         16  PI-HELP-INTERFACE.
   332             20  PI-LAST-ERROR-NO        PIC X(4).
   333             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   334
   335         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   336             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   337
   338         16  PI-CR-CONTROL-IN-PROGRESS.
   339             20  PI-CR-CARRIER           PIC X.
   340             20  PI-CR-GROUPING          PIC X(6).
   341             20  PI-CR-STATE             PIC XX.
   342             20  PI-CR-ACCOUNT           PIC X(10).
   343             20  PI-CR-FIN-RESP          PIC X(10).
   344             20  PI-CR-TYPE              PIC X.
   345
   346         16  PI-CR-BATCH-NUMBER          PIC X(6).
   347
   348         16  PI-CR-MONTH-END-DT          PIC XX.
   349
   350         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   351             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   352             88  PI-ZERO-CARRIER             VALUE '1'.
   353             88  PI-ZERO-GROUPING            VALUE '2'.
   354             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   355
   356         16  PI-CARRIER-SECURITY         PIC X.
   357             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   358
   359         16  PI-ACCOUNT-SECURITY         PIC X(10).
   360             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   361             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   362
   363         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   364             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   365                                         INDEXED BY PI-ACCESS-NDX
   366                                         PIC X.
   367
   368         16  PI-GA-BILLING-CONTROL       PIC X.
   369             88  PI-GA-BILLING               VALUE '1'.
   370
   371         16  PI-MAIL-PROCESSING          PIC X.
   372             88  PI-MAIL-YES                 VALUE 'Y'.
   373
   374         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   375
   376         16  PI-AR-SYSTEM.
   377             20  PI-AR-PROCESSING-CNTL   PIC X.
   378                 88  PI-AR-PROCESSING        VALUE 'Y'.
   379             20  PI-AR-SUMMARY-CODE      PIC X(6).
   380             20  PI-AR-MONTH-END-DT      PIC XX.
   381
   382         16  PI-MP-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL691.cbl
   383             20  PI-MORTGAGE-USER            PIC X.
   384                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   385                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   386             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   387                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   388                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   389                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   390                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   391                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   392             20  PI-MP-MONTH-END-DT          PIC XX.
   393             20  PI-MP-REFERENCE-NO.
   394                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   395                 24  PI-MP-REFERENCE-SFX     PIC XX.
   396
   397         16  PI-LABEL-CONTROL            PIC X(01).
   398             88  PI-CREATE-LABELS                    VALUE 'Y'.
   399             88  PI-BYPASS-LABELS                    VALUE 'N'.
   400
   401         16  PI-BILL-GROUPING-CODE       PIC X(01).
   402             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   403
   404         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   405             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   406             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   407
   408         16  FILLER                      PIC X(14).
   409
   410     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   411******************************************************************
   412     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   413*    COPY ELC1042.
   414******************************************************************
   415*                                                                *
   416*                                                                *
   417*                           ELC1042                              *
   418*                            VMOD=2.002                          *
   419*                                                                *
   420*    NOTE                                                        *
   421*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   422*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   423*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   424*        TO THESE PROGRAMS.                                      *
   425*                                                                *
   426*    NOTE                                                        *
   427*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   428*        USE ONLY!                                               *
   429*                                                                *
   430******************************************************************
   431
   432         16  PI-1042-WA.
   433             20  PI-ACTION       PIC  X(01).
   434                 88 PI-SHOW-MODE           VALUE '1'.
   435                 88 PI-CLEAR-MODE          VALUE '2'.
   436                 88 PI-CREATE-MODE         VALUE '3'.
   437             20  PI-COMM-CONTROL PIC  X(12).
   438             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   439             20  PI-EOF-SW       PIC  X(01).
   440                 88  PI-FILE-EOF           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL691.cbl
   441             20  PI-FILETYP      PIC  X(01).
   442             20  PI-FORM-SQUEEZE-CONTROL
   443                                 PIC  X(01).
   444                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   445                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   446             20  PI-LAST-CONTROL PIC  X(12).
   447             20  PI-TEMP-STOR-ITEMS
   448                                 PIC S9(04) COMP.
   449             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   450             20  PI-UPDATE-SW    PIC  9(01).
   451                 88 ANY-UPDATES            VALUE 1.
   452             20  PI-104-SCREEN-SENT-IND
   453                                 PIC  X(01).
   454                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   455                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   456             20  PI-1042-SCREEN-SENT-IND
   457                                 PIC  X(01).
   458                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   459                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   460             20  PI-1042-ARCHIVE-IND
   461                                 PIC  X(01).
   462                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   463             20  FILLER          PIC  X(29).
   464*    COPY ELC689PI.
   465******************************************************************
   466*                                                                *
   467*                            ELC689PI                            *
   468*                            VMOD=2.003                          *
   469*                                                                *
   470*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   471*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   472*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   473*                                                                *
   474*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   475*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   476*    BETWEEN PROGRAMS.                                           *
   477*                                                                *
   478*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   479*                                                                *
   480*               EL631 - EL689  - EL6891 - EL6892                 *
   481*                                                                *
   482******************************************************************
   483*                   C H A N G E   L O G
   484*
   485* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   486*-----------------------------------------------------------------
   487*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   488* EFFECTIVE    NUMBER
   489*-----------------------------------------------------------------
   490* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   491* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   492* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   493******************************************************************
   494
   495
   496         16  PI-689-WORK-AREA.
   497             20  PI-689-ALT-PRINTER-ID
   498                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL691.cbl
   499             20  PI-689-ARCHIVE-NUMBER
   500                                 PIC  9(08).
   501             20  PI-689-ARCHIVE-SW
   502                                 PIC  X(01).
   503                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   504             20  PI-689-DATA-SOURCE
   505                                 PIC  X(01).
   506                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   507                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   508                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   509                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   510                 88  PI-689-SRC-CHECKS         VALUE '5'.
   511             20  PI-689-ERROR-IND
   512                                 PIC  X(01).
   513                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   514             20  PI-689-ERROR    PIC  9(04).
   515                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   516                 88  PI-689-FATAL-ERROR
   517                     VALUES 0004 0006 0008 0013 0023 0029 0033
   518                            0042 0047 0051 0066 0067 0070
   519                            0168 0169 0174 0175 0176 0177 0179
   520                            0180 0181 0182 0184 0185 0189 0190
   521                            0191
   522                            0215 0279 0280
   523                            0412 0413 0454
   524                            0533 0537
   525                            2055 2114 2208 2209 2216 2232 2369
   526                            2398 2433 2908 2999
   527                            3000 3770 3771 3775
   528                            7250 7365 7367 7368 7369 7370 7371
   529                            7272 7373 7374 7376 7377 7378 7379
   530                            7381 7388 7390 7393 7395 7396 7398
   531                            9095 9096 9281 9298 9299 9320 9327
   532                            9426 9427.
   533                 88  PI-689-STOP-ERROR
   534                     VALUES 0004 0008 0013 0023 0029 0033
   535                            0042 0047 0066 0067 0070
   536                            0168 0169 0174 0175 0176 0177
   537                            0181 0182 0184 0185 0189 0190
   538                            0279 0280
   539                            0412 0413 0454
   540                            2055 2208 2209 2216 2232
   541                            2398 2999
   542                            3000 3770 3771 3775
   543                            7250 7365 7369 7370 7371
   544                            7272 7373 7374 7376 7377 7378 7379
   545                            7381 7388 7390 7393 7396 7398
   546                            9095 9096 9299 9320 9426.
   547             20  PI-689-FOLLOW-UP-DATE
   548                                 PIC  X(02).
   549             20  PI-689-FORM-NUMBER
   550                                 PIC  X(04).
   551             20  PI-689-LABEL-SOURCE
   552                                 PIC X(01).
   553                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   554                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   555                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   556                 88  PI-689-SOURCE-COMP     VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL691.cbl
   557                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   558                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   559                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   560             20  PI-689-NUMBER-COPIES
   561                                 PIC  9(01).
   562             20  PI-689-NUMBER-LABEL-LINES
   563                                 PIC  9(01).
   564             20  PI-689-NUMBER-TEXT-RECORDS
   565                                 PIC  9(03).
   566             20  PI-689-PRINT-ORDER-SW
   567                                 PIC  X(01).
   568                 88  PI-689-PRINT-FIRST     VALUE '1'.
   569                 88  PI-689-PRINT-SECOND    VALUE '2'.
   570                 88  PI-689-PRINT-LATER     VALUE '3'.
   571                 88  PI-689-PRINT-ONLY      VALUE '4'.
   572             20  PI-689-PRINT-RESTRICTION
   573                                 PIC  X(01).
   574                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   575                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
   576                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   577             20  PI-689-PRINT-SW PIC  X(01).
   578                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   579             20  PI-689-RESEND-DATE-1
   580                                 PIC  X(02).
   581             20  PI-689-RESEND-LETR-1
   582                                 PIC X(4).
   583             20  PI-689-TEMP-STOR-ID
   584                                 PIC  X(08).
   585             20  PI-689-USE-SCREEN-IND
   586                                 PIC  X(01).
   587                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   588             20  PI-689-ARCH-POINTER
   589                                 PIC S9(08) COMP.
   590                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   591             20  PI-689-ARCT-POINTER
   592                                 PIC S9(08) COMP.
   593                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   594             20  PI-689-VARIABLE-DATA-GRP.
   595                 24  PI-689-VARIABLE-DATA-1
   596                                 PIC  X(30).
   597                 24  PI-689-VARIABLE-DATA-2
   598                                 PIC  X(30).
   599                 24  PI-689-VARIABLE-DATA-3
   600                                 PIC  X(30).
   601                 24  PI-689-VARIABLE-DATA-4
   602                                 PIC  X(30).
   603
   604         16  PI-689-KEY-DATA-FIELDS.
   605             20  PI-689-ACCOUNT  PIC  X(10).
   606             20  PI-689-CARRIER  PIC  X(01).
   607             20  PI-689-CERT-NO.
   608                 24  PI-689-CERT-PRIME
   609                                 PIC  X(10).
   610                 24  PI-689-CERT-SFX
   611                                 PIC  X(01).
   612             20  PI-689-CHG-SEQ-NO
   613                                 PIC S9(04)    COMP.
   614             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL691.cbl
   615                                 PIC  X(02).
   616             20  PI-689-ENTRY-BATCH
   617                                 PIC  X(06).
   618             20  PI-689-EFF-DATE PIC  X(02).
   619             20  PI-689-EXP-DATE PIC  X(02).
   620             20  PI-689-GROUPING PIC  X(06).
   621             20  PI-689-RESP-PERSON
   622                                 PIC  X(10).
   623             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   624             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   625                                 PIC  X(04).
   626             20  PI-689-STATE    PIC  X(02).
   627             20  PI-689-TYPE     PIC  X(01).
   628             20  PI-689-CONTROL  PIC S9(08)    COMP.
   629             20  PI-689-ALT-SEQ-NO
   630                                 PIC S9(04)    COMP.
   631         16  PI-689-DATE-EDIT    PIC  X(08).
   632         16  PI-689-FOLLOW-UP-EDIT
   633                                 PIC  X(08).
   634         16  PI-689-RESEND1-EDIT PIC  X(08).
   635         16  PI-689-SEQ-EDIT     PIC  X(08).
   636         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   637         16  PI-689-LBL-OVERRIDE PIC  X(01).
   638             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   639         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   640         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   641         16  PI-690-WORK-AREA.
   642             20  PI-690-ARCHIVE-TABLE.
   643                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
   644                                 PIC S9(08) COMP.
   645             20  PI-690-CURSOR   PIC S9(04) COMP.
   646             20  PI-690-FIRST-DATA.
   647                 24  PI-690-FIRST-CERT-NO.
   648                     28  PI-690-FIRST-CERT-PRIME
   649                                 PIC  X(10).
   650                     28  PI-690-FIRST-SUFFIX
   651                                 PIC  X(01).
   652                 24  PI-690-FIRST-CARRIER
   653                                 PIC  X(01).
   654                 24  PI-690-FIRST-GROUPING
   655                                 PIC  X(06).
   656                 24  PI-690-FIRST-STATE
   657                                 PIC  X(02).
   658                 24  PI-690-FIRST-ACCOUNT
   659                                 PIC  X(10).
   660                 24  PI-690-FIRST-EFFECT-DATE
   661                                 PIC  X(02).
   662                 24  PI-690-FIRST-ENTRY.
   663                     28  PI-690-FIRST-CONTROL-PREFIX
   664                                 PIC  X(02).
   665                     28  PI-690-FIRST-CONTROL
   666                                 PIC S9(08) COMP.
   667                 24  PI-690-FIRST-FORM
   668                                 PIC  X(04).
   669                 24  PI-690-FIRST-PROCESSOR
   670                                 PIC  X(04).
   671                 24  PI-690-FIRST-ARCHIVE-NO
   672                                 PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL691.cbl
   673             20  PI-690-INIT-DATA.
   674                 24  PI-690-INIT-CERT-NO.
   675                     28  PI-690-INIT-CERT-PRIME
   676                                 PIC  X(10).
   677                     28  PI-690-INIT-SUFFIX
   678                                 PIC  X(01).
   679                 24  PI-690-INIT-CARRIER
   680                                 PIC  X(01).
   681                 24  PI-690-INIT-GROUPING
   682                                 PIC  X(06).
   683                 24  PI-690-INIT-STATE
   684                                 PIC  X(02).
   685                 24  PI-690-INIT-ACCOUNT
   686                                 PIC  X(10).
   687                 24  PI-690-INIT-EFFECT-DATE
   688                                 PIC  X(02).
   689                 24  PI-690-INIT-EFF-DTE
   690                                 PIC  X(08).
   691                 24  PI-690-INIT-ENTRY.
   692                     28  PI-690-INIT-CONTROL-PREFIX
   693                                 PIC  X(02).
   694                     28  PI-690-INIT-CONTROL
   695                                 PIC S9(08) COMP.
   696                 24  PI-690-INIT-FORM
   697                                 PIC  X(04).
   698                 24  PI-690-INIT-PROCESSOR
   699                                 PIC  X(04).
   700                 24  PI-690-INIT-ARCHIVE-NO
   701                                 PIC S9(08) COMP.
   702             20  PI-690-LAST-DATA.
   703                 24  PI-690-LAST-CERT-NO.
   704                     28  PI-690-LAST-CERT-PRIME
   705                                 PIC  X(10).
   706                     28  PI-690-LAST-SUFFIX
   707                                 PIC  X(01).
   708                 24  PI-690-LAST-CARRIER
   709                                 PIC  X(01).
   710                 24  PI-690-LAST-GROUPING
   711                                 PIC  X(06).
   712                 24  PI-690-LAST-STATE
   713                                 PIC  X(02).
   714                 24  PI-690-LAST-ACCOUNT
   715                                 PIC  X(10).
   716                 24  PI-690-LAST-EFFECT-DATE
   717                                 PIC  X(02).
   718                 24  PI-690-LAST-ENTRY.
   719                     28  PI-690-LAST-CONTROL-PREFIX
   720                                 PIC  X(02).
   721                     28  PI-690-LAST-CONTROL
   722                                 PIC S9(08) COMP.
   723                 24  PI-690-LAST-FORM
   724                                 PIC  X(04).
   725                 24  PI-690-LAST-PROCESSOR
   726                                 PIC  X(04).
   727                 24  PI-690-LAST-ARCHIVE-NO
   728                                 PIC S9(08) COMP.
   729             20  PI-690-LAST-ARCH-NDX
   730                                 PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL691.cbl
   731             20  PI-690-BRWS-TYPE-IND
   732                                 PIC  9(01).
   733                 88  PI-690-BRWS-CERTRP               VALUE 1.
   734                 88  PI-690-BRWS-FORM                 VALUE 2.
   735                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
   736                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
   737                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
   738                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
   739             20  PI-690-LAST-BROWSE-IND
   740                                 PIC  X(01).
   741                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
   742                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
   743             20  PI-690-STATUS-SELECTION-IND
   744                                 PIC  X(01).
   745                 88  PI-690-SELECT-ALL       VALUE 'N'.
   746                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
   747                                               'X' 'P' 'V' 'N'.
   748         16  PI-ARCHIVE-COMPLETE    PIC X(01).
   749         16  PI-ARCHIVE-RECEIVED    PIC X(01).
   750         16  PI-ARCHIVE-STOPPED     PIC X(01).
   751         16  PI-ARCHIVE-FINAL       PIC X(01).
   752         16  PI-COMMENT-INDEX       PIC S9(4) COMP.
   753         16  FILLER              PIC X(63).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL691.cbl
   755
   756 01  W-CONSTANT-AREA.
   757     12  FILLER                  PIC  X(18)
   758                                 VALUE 'PROGRAM CONSTANTS:'.
   759     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
   760
   761     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
   762     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
   763     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
   764     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
   765     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
   766     12  W-MAP                   PIC  X(08)  VALUE 'EL691A'.
   767     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
   768         16  FILLER              PIC  X(02).
   769         16  W-MAP-NUM           PIC  X(06).
   770     12  W-MAPSET                PIC  X(08)  VALUE 'EL691S'.
   771     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL691'.
   772     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXN1'.
   773     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
   774     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
   775     12  SLASH                   PIC X       VALUE '/'.
   776     12  W-ZEROS                 PIC  S9(03) VALUE +0 COMP-3.
   777     12  W-ADD-ARCT              PIC  X      VALUE 'N'.
   778     12  W-DONE-ADDING           PIC  X      VALUE 'N'.
   779     12  W-NEED-COMMENT          PIC  X      VALUE 'N'.
   780
   781 01  ERROR-MESSAGES.
   782     12  ER-0000                 PIC  X(04) VALUE '0000'.
   783     12  ER-0004                 PIC  X(04) VALUE '0004'.
   784     12  ER-0029                 PIC  X(04) VALUE '0029'.
   785     12  ER-0051                 PIC  X(04) VALUE '0051'.
   786     12  ER-0070                 PIC  X(04) VALUE '0070'.
   787     12  ER-0295                 PIC  X(04) VALUE '0295'.
   788     12  ER-0296                 PIC  X(04) VALUE '0296'.
   789     12  ER-0539                 PIC  X(04) VALUE '0539'.
   790     12  ER-0895                 PIC  X(04) VALUE '0895'.
   791     12  ER-0897                 PIC  X(04) VALUE '0897'.
   792     12  ER-3112                 PIC  X(04) VALUE '3112'.
   793     12  ER-7008                 PIC  X(04) VALUE '7008'.
   794     12  ER-7363                 PIC  X(04) VALUE '7363'.
   795     12  ER-7371                 PIC  X(04) VALUE '7371'.
   796     12  ER-7373                 PIC  X(04) VALUE '7373'.
   797     12  ER-7388                 PIC  X(04) VALUE '7388'.
   798     12  ER-9097                 PIC  X(04) VALUE '9097'.
   799     12  ER-9245                 PIC  X(04) VALUE '9245'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL691.cbl
   801*    COPY ELCAID.
   802******************************************************************
   803*                                                                *
   804*                            ELCAID.                             *
   805*                            VMOD=2.001                          *
   806*                                                                *
   807*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   808*                                                                *
   809*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   810*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   811******************************************************************
   812
   813 01  DFHAID.
   814   02  DFHNULL   PIC  X  VALUE  ' '.
   815   02  DFHENTER  PIC  X  VALUE  QUOTE.
   816   02  DFHCLEAR  PIC  X  VALUE  '_'.
   817   02  DFHPEN    PIC  X  VALUE  '='.
   818   02  DFHOPID   PIC  X  VALUE  'W'.
   819   02  DFHPA1    PIC  X  VALUE  '%'.
   820   02  DFHPA2    PIC  X  VALUE  '>'.
   821   02  DFHPA3    PIC  X  VALUE  ','.
   822   02  DFHPF1    PIC  X  VALUE  '1'.
   823   02  DFHPF2    PIC  X  VALUE  '2'.
   824   02  DFHPF3    PIC  X  VALUE  '3'.
   825   02  DFHPF4    PIC  X  VALUE  '4'.
   826   02  DFHPF5    PIC  X  VALUE  '5'.
   827   02  DFHPF6    PIC  X  VALUE  '6'.
   828   02  DFHPF7    PIC  X  VALUE  '7'.
   829   02  DFHPF8    PIC  X  VALUE  '8'.
   830   02  DFHPF9    PIC  X  VALUE  '9'.
   831   02  DFHPF10   PIC  X  VALUE  ':'.
   832   02  DFHPF11   PIC  X  VALUE  '#'.
   833   02  DFHPF12   PIC  X  VALUE  '@'.
   834   02  DFHPF13   PIC  X  VALUE  'A'.
   835   02  DFHPF14   PIC  X  VALUE  'B'.
   836   02  DFHPF15   PIC  X  VALUE  'C'.
   837   02  DFHPF16   PIC  X  VALUE  'D'.
   838   02  DFHPF17   PIC  X  VALUE  'E'.
   839   02  DFHPF18   PIC  X  VALUE  'F'.
   840   02  DFHPF19   PIC  X  VALUE  'G'.
   841   02  DFHPF20   PIC  X  VALUE  'H'.
   842   02  DFHPF21   PIC  X  VALUE  'I'.
   843*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   844   02  DFHPF22   PIC  X  VALUE  '['.
   845   02  DFHPF23   PIC  X  VALUE  '.'.
   846   02  DFHPF24   PIC  X  VALUE  '<'.
   847   02  DFHMSRE   PIC  X  VALUE  'X'.
   848   02  DFHSTRF   PIC  X  VALUE  'h'.
   849   02  DFHTRIG   PIC  X  VALUE  '"'.
   850 01  FILLER    REDEFINES DFHAID.
   851     12  FILLER                  PIC  X(08).
   852     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL691.cbl
   854*    COPY ELCATTR.
   855******************************************************************
   856*                                                                *
   857*                            ELCATTR.                            *
   858*                            VMOD=2.001                          *
   859*                                                                *
   860*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   861*                                                                *
   862*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   863*                                                                *
   864*                   POS 1   P=PROTECTED                          *
   865*                           U=UNPROTECTED                        *
   866*                           S=ASKIP                              *
   867*                   POS 2   A=ALPHA/NUMERIC                      *
   868*                           N=NUMERIC                            *
   869*                   POS 3   N=NORMAL                             *
   870*                           B=BRIGHT                             *
   871*                           D=DARK                               *
   872*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   873*                           OF=MODIFIED DATA TAG OFF             *
   874*                                                                *
   875*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   876******************************************************************
   877 01  ATTRIBUTE-LIST.
   878     12  AL-PABOF            PIC X       VALUE 'Y'.
   879     12  AL-PABON            PIC X       VALUE 'Z'.
   880     12  AL-PADOF            PIC X       VALUE '%'.
   881     12  AL-PADON            PIC X       VALUE '_'.
   882     12  AL-PANOF            PIC X       VALUE '-'.
   883     12  AL-PANON            PIC X       VALUE '/'.
   884     12  AL-SABOF            PIC X       VALUE '8'.
   885     12  AL-SABON            PIC X       VALUE '9'.
   886     12  AL-SADOF            PIC X       VALUE '@'.
   887     12  AL-SADON            PIC X       VALUE QUOTE.
   888     12  AL-SANOF            PIC X       VALUE '0'.
   889     12  AL-SANON            PIC X       VALUE '1'.
   890     12  AL-UABOF            PIC X       VALUE 'H'.
   891     12  AL-UABON            PIC X       VALUE 'I'.
   892     12  AL-UADOF            PIC X       VALUE '<'.
   893     12  AL-UADON            PIC X       VALUE '('.
   894     12  AL-UANOF            PIC X       VALUE ' '.
   895     12  AL-UANON            PIC X       VALUE 'A'.
   896     12  AL-UNBOF            PIC X       VALUE 'Q'.
   897     12  AL-UNBON            PIC X       VALUE 'R'.
   898     12  AL-UNDOF            PIC X       VALUE '*'.
   899     12  AL-UNDON            PIC X       VALUE ')'.
   900     12  AL-UNNOF            PIC X       VALUE '&'.
   901     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL691.cbl
   903*    COPY ELCDATE.
   904******************************************************************
   905*                                                                *
   906*                                                                *
   907*                            ELCDATE.                            *
   908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   909*                            VMOD=2.003
   910*                                                                *
   911*                                                                *
   912*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   913*                 LENGTH = 200                                   *
   914******************************************************************
   915
   916 01  DATE-CONVERSION-DATA.
   917     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   918     12  DC-OPTION-CODE                PIC X.
   919         88  BIN-TO-GREG                VALUE ' '.
   920         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   921         88  EDIT-GREG-TO-BIN           VALUE '2'.
   922         88  YMD-GREG-TO-BIN            VALUE '3'.
   923         88  MDY-GREG-TO-BIN            VALUE '4'.
   924         88  JULIAN-TO-BIN              VALUE '5'.
   925         88  BIN-PLUS-ELAPSED           VALUE '6'.
   926         88  FIND-CENTURY               VALUE '7'.
   927         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   928         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   929         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   930         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   931         88  JULIAN-TO-BIN-3            VALUE 'C'.
   932         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   933         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   934         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   935         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   936         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   937         88  CHECK-LEAP-YEAR            VALUE 'H'.
   938         88  BIN-3-TO-GREG              VALUE 'I'.
   939         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   940         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   941         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   942         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   943         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   944         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   945         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   946         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   947         88  THREE-CHARACTER-BIN
   948                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   949         88  GREGORIAN-TO-BIN
   950                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   951         88  BIN-TO-GREGORIAN
   952                  VALUES ' ' '1' 'I' '8' 'G'.
   953         88  JULIAN-TO-BINARY
   954                  VALUES '5' 'C' 'E' 'F'.
   955     12  DC-ERROR-CODE                 PIC X.
   956         88  NO-CONVERSION-ERROR        VALUE ' '.
   957         88  DATE-CONVERSION-ERROR
   958                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   959         88  DATE-IS-ZERO               VALUE '1'.
   960         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL691.cbl
   961         88  DATE-IS-INVALID            VALUE '3'.
   962         88  DATE1-GREATER-DATE2        VALUE '4'.
   963         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   964         88  DATE-INVALID-OPTION        VALUE '9'.
   965         88  INVALID-CENTURY            VALUE 'A'.
   966         88  ONLY-CENTURY               VALUE 'B'.
   967         88  ONLY-LEAP-YEAR             VALUE 'C'.
   968         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   969     12  DC-END-OF-MONTH               PIC X.
   970         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   971     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   972         88  USE-NORMAL-PROCESS         VALUE ' '.
   973         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   974         88  ADJUST-UP-100-YRS          VALUE '2'.
   975     12  FILLER                        PIC X.
   976     12  DC-CONVERSION-DATES.
   977         16  DC-BIN-DATE-1             PIC XX.
   978         16  DC-BIN-DATE-2             PIC XX.
   979         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   980         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   981                       DC-GREG-DATE-1-EDIT.
   982             20  DC-EDIT1-MONTH        PIC 99.
   983             20  SLASH1-1              PIC X.
   984             20  DC-EDIT1-DAY          PIC 99.
   985             20  SLASH1-2              PIC X.
   986             20  DC-EDIT1-YEAR         PIC 99.
   987         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   988         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   989                     DC-GREG-DATE-2-EDIT.
   990             20  DC-EDIT2-MONTH        PIC 99.
   991             20  SLASH2-1              PIC X.
   992             20  DC-EDIT2-DAY          PIC 99.
   993             20  SLASH2-2              PIC X.
   994             20  DC-EDIT2-YEAR         PIC 99.
   995         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   996         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   997                     DC-GREG-DATE-1-YMD.
   998             20  DC-YMD-YEAR           PIC 99.
   999             20  DC-YMD-MONTH          PIC 99.
  1000             20  DC-YMD-DAY            PIC 99.
  1001         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1002         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1003                      DC-GREG-DATE-1-MDY.
  1004             20  DC-MDY-MONTH          PIC 99.
  1005             20  DC-MDY-DAY            PIC 99.
  1006             20  DC-MDY-YEAR           PIC 99.
  1007         16  DC-GREG-DATE-1-ALPHA.
  1008             20  DC-ALPHA-MONTH        PIC X(10).
  1009             20  DC-ALPHA-DAY          PIC 99.
  1010             20  FILLER                PIC XX.
  1011             20  DC-ALPHA-CENTURY.
  1012                 24 DC-ALPHA-CEN-N     PIC 99.
  1013             20  DC-ALPHA-YEAR         PIC 99.
  1014         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1015         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1016         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1017         16  DC-JULIAN-DATE            PIC 9(05).
  1018         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL691.cbl
  1019                                       PIC 9(05).
  1020         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1021             20  DC-JULIAN-YEAR        PIC 99.
  1022             20  DC-JULIAN-DAYS        PIC 999.
  1023         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1024         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1025         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1026     12  DATE-CONVERSION-VARIBLES.
  1027         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1028         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1029             20  FILLER                PIC 9(3).
  1030             20  HOLD-CEN-1-CCYY.
  1031                 24  HOLD-CEN-1-CC     PIC 99.
  1032                 24  HOLD-CEN-1-YY     PIC 99.
  1033             20  HOLD-CEN-1-MO         PIC 99.
  1034             20  HOLD-CEN-1-DA         PIC 99.
  1035         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1036             20  HOLD-CEN-1-R-MO       PIC 99.
  1037             20  HOLD-CEN-1-R-DA       PIC 99.
  1038             20  HOLD-CEN-1-R-CCYY.
  1039                 24  HOLD-CEN-1-R-CC   PIC 99.
  1040                 24  HOLD-CEN-1-R-YY   PIC 99.
  1041             20  FILLER                PIC 9(3).
  1042         16  HOLD-CENTURY-1-X.
  1043             20  FILLER                PIC X(3)  VALUE SPACES.
  1044             20  HOLD-CEN-1-X-CCYY.
  1045                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1046                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1047             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1048             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1049         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1050             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1051             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1052             20  HOLD-CEN-1-R-X-CCYY.
  1053                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1054                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1055             20  FILLER                PIC XXX.
  1056         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1057         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1058         16  DC-JULIAN-DATE-1          PIC 9(07).
  1059         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1060             20  DC-JULIAN-1-CCYY.
  1061                 24  DC-JULIAN-1-CC    PIC 99.
  1062                 24  DC-JULIAN-1-YR    PIC 99.
  1063             20  DC-JULIAN-DA-1        PIC 999.
  1064         16  DC-JULIAN-DATE-2          PIC 9(07).
  1065         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1066             20  DC-JULIAN-2-CCYY.
  1067                 24  DC-JULIAN-2-CC    PIC 99.
  1068                 24  DC-JULIAN-2-YR    PIC 99.
  1069             20  DC-JULIAN-DA-2        PIC 999.
  1070         16  DC-GREG-DATE-A-EDIT.
  1071             20  DC-EDITA-MONTH        PIC 99.
  1072             20  SLASHA-1              PIC X VALUE '/'.
  1073             20  DC-EDITA-DAY          PIC 99.
  1074             20  SLASHA-2              PIC X VALUE '/'.
  1075             20  DC-EDITA-CCYY.
  1076                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL691.cbl
  1077                 24  DC-EDITA-YEAR     PIC 99.
  1078         16  DC-GREG-DATE-B-EDIT.
  1079             20  DC-EDITB-MONTH        PIC 99.
  1080             20  SLASHB-1              PIC X VALUE '/'.
  1081             20  DC-EDITB-DAY          PIC 99.
  1082             20  SLASHB-2              PIC X VALUE '/'.
  1083             20  DC-EDITB-CCYY.
  1084                 24  DC-EDITB-CENT     PIC 99.
  1085                 24  DC-EDITB-YEAR     PIC 99.
  1086         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1087         16  DC-GREG-DATE-CYMD-R REDEFINES
  1088                              DC-GREG-DATE-CYMD.
  1089             20  DC-CYMD-CEN           PIC 99.
  1090             20  DC-CYMD-YEAR          PIC 99.
  1091             20  DC-CYMD-MONTH         PIC 99.
  1092             20  DC-CYMD-DAY           PIC 99.
  1093         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1094         16  DC-GREG-DATE-MDCY-R REDEFINES
  1095                              DC-GREG-DATE-MDCY.
  1096             20  DC-MDCY-MONTH         PIC 99.
  1097             20  DC-MDCY-DAY           PIC 99.
  1098             20  DC-MDCY-CEN           PIC 99.
  1099             20  DC-MDCY-YEAR          PIC 99.
  1100    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1101        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1102    12  DC-EL310-DATE                  PIC X(21).
  1103    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL691.cbl
  1105*    COPY ELCNWA.
  1106*****************************************************************
  1107*                                                               *
  1108*                                                               *
  1109*                            ELCNWA.                            *
  1110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1111*                            VMOD=2.003                         *
  1112*                                                               *
  1113*            M O V E   N A M E   W O R K   A R E A.             *
  1114*                                                               *
  1115*****************************************************************.
  1116
  1117 01  WS-NAME-WORK-AREA.
  1118     05  WS-INSURED-LAST-NAME        PIC X(15).
  1119     05  WS-INSURED-1ST-NAME         PIC X(12).
  1120     05  WS-INSURED-MID-INIT         PIC X.
  1121
  1122     05  WS-NAME-WORK.
  1123         10  WS-NW                   PIC X
  1124             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1125
  1126     05  WS-NAME-WORK2.
  1127         10  WS-NW2                  PIC X
  1128             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1129                                        NWA-INDEX0.
  1130
  1131     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1132                                     COMP-3.
  1133
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL691.cbl
  1135*    COPY ELCEMIB.
  1136******************************************************************
  1137*                                                                *
  1138*                                                                *
  1139*                            ELCEMIB.                            *
  1140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1141*                            VMOD=2.005                          *
  1142*                                                                *
  1143*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1144*                                                                *
  1145******************************************************************
  1146 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1147     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1148     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1149     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1150     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1151     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1152     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1153     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1154     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1155     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1156         88  EMI-NO-ERRORS                    VALUE '1'.
  1157         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1158         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1159     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1160         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1161     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1162         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1163         88  EMI-AREA1-FULL                   VALUE '2'.
  1164     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1165         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1166         88  EMI-AREA2-FULL                   VALUE '2'.
  1167     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1168         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1169         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1170         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1171         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1172         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1173     12  EMI-ERROR-LINES.
  1174         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1175         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1176         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1177         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1178             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1179                 24  EMI-ERR-NUM         PIC X(4).
  1180                 24  EMI-FILLER          PIC X.
  1181                 24  EMI-SEV             PIC X.
  1182                 24  FILLER              PIC X.
  1183             20  FILLER                  PIC X(02).
  1184     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1185         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1186             20  EMI-ERROR-NUMBER    PIC X(4).
  1187             20  EMI-FILL            PIC X.
  1188             20  EMI-SEVERITY        PIC X.
  1189             20  FILLER              PIC X.
  1190             20  EMI-ERROR-TEXT.
  1191                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1192                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL691.cbl
  1193     12  EMI-SEVERITY-SAVE           PIC X.
  1194         88  EMI-NOTE                    VALUE 'N'.
  1195         88  EMI-WARNING                 VALUE 'W'.
  1196         88  EMI-FORCABLE                VALUE 'F'.
  1197         88  EMI-FATAL                   VALUE 'X'.
  1198     12  EMI-MESSAGE-FLAG            PIC X.
  1199         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1200         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1201     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1202     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1203         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1204         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1205         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1206     12  FILLER                      PIC X(137)  VALUE SPACES.
  1207     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1208     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1209     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1210     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1211 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL691.cbl
  1213*    COPY ELCLOGOF.
  1214******************************************************************
  1215*                                                                *
  1216*                                                                *
  1217*                            ELCLOGOF.                           *
  1218*                            VMOD=2.001                          *
  1219*                                                                *
  1220*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1221*                                                                *
  1222******************************************************************
  1223 01  CLASIC-LOGOFF.
  1224     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1225     12  LOGOFF-TEXT.
  1226         16  FILLER          PIC X(5)    VALUE SPACES.
  1227         16  LOGOFF-MSG.
  1228             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1229             20  FILLER      PIC X       VALUE SPACES.
  1230             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1231         16  FILLER          PIC X(80)
  1232           VALUE '* YOU ARE NOW LOGGED OFF'.
  1233         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1234         16  FILLER          PIC X       VALUE QUOTE.
  1235         16  LOGOFF-SYS-MSG  PIC X(17)
  1236           VALUE 'S CLAS-IC SYSTEM '.
  1237     12  TEXT-MESSAGES.
  1238         16  UNACCESS-MSG    PIC X(29)
  1239             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1240         16  PGMIDERR-MSG    PIC X(17)
  1241             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL691.cbl
  1243*    COPY ELCSCTM.
  1244******************************************************************
  1245*                                                                *
  1246*                                                                *
  1247*                            ELCSCTM                             *
  1248*                            VMOD=2.001                          *
  1249*                                                                *
  1250*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  1251*                                                                *
  1252******************************************************************
  1253 01  SECURITY-MESSAGE.
  1254     12  FILLER                          PIC X(30)
  1255            VALUE '** LOGIC SECURITY VIOLATION -'.
  1256     12  SM-READ                         PIC X(6).
  1257     12  FILLER                          PIC X(5)
  1258            VALUE ' PGM='.
  1259     12  SM-PGM                          PIC X(6).
  1260     12  FILLER                          PIC X(5)
  1261            VALUE ' OPR='.
  1262     12  SM-PROCESSOR-ID                 PIC X(4).
  1263     12  FILLER                          PIC X(6)
  1264            VALUE ' TERM='.
  1265     12  SM-TERMID                       PIC X(4).
  1266     12  FILLER                          PIC XX   VALUE SPACE.
  1267     12  SM-JUL-DATE                     PIC 9(5).
  1268     12  FILLER                          PIC X    VALUE SPACE.
  1269     12  SM-TIME                         PIC 99.99.
  1270
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL691.cbl
  1272*    COPY ELCSCRTY.
  1273******************************************************************
  1274*                                                                *
  1275*                                                                *
  1276*                            ELCSCRTY                            *
  1277*                            VMOD=2.001                          *
  1278*                                                                *
  1279*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1280*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1281*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1282*                                                                *
  1283******************************************************************
  1284 01  SECURITY-CONTROL.
  1285     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1286     12  FILLER                       PIC XX    VALUE 'SC'.
  1287     12  SC-CREDIT-CODES.
  1288         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1289             20  SC-CREDIT-DISPLAY    PIC X.
  1290             20  SC-CREDIT-UPDATE     PIC X.
  1291     12  SC-CLAIMS-CODES.
  1292         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1293             20  SC-CLAIMS-DISPLAY    PIC X.
  1294             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL691.cbl
  1296
  1297*    COPY EL691S.
  1298 01  EL691AI.
  1299     05  FILLER            PIC  X(0012).
  1300*    -------------------------------
  1301     05  RUNDTEL PIC S9(0004) COMP.
  1302     05  RUNDTEF PIC  X(0001).
  1303     05  FILLER REDEFINES RUNDTEF.
  1304         10  RUNDTEA PIC  X(0001).
  1305     05  RUNDTEI PIC  X(0008).
  1306*    -------------------------------
  1307     05  RUNTIMEL PIC S9(0004) COMP.
  1308     05  RUNTIMEF PIC  X(0001).
  1309     05  FILLER REDEFINES RUNTIMEF.
  1310         10  RUNTIMEA PIC  X(0001).
  1311     05  RUNTIMEI PIC  X(0005).
  1312*    -------------------------------
  1313     05  COMPANYL PIC S9(0004) COMP.
  1314     05  COMPANYF PIC  X(0001).
  1315     05  FILLER REDEFINES COMPANYF.
  1316         10  COMPANYA PIC  X(0001).
  1317     05  COMPANYI PIC  X(0003).
  1318*    -------------------------------
  1319     05  USERIDL PIC S9(0004) COMP.
  1320     05  USERIDF PIC  X(0001).
  1321     05  FILLER REDEFINES USERIDF.
  1322         10  USERIDA PIC  X(0001).
  1323     05  USERIDI PIC  X(0004).
  1324*    -------------------------------
  1325     05  CARRIERL PIC S9(0004) COMP.
  1326     05  CARRIERF PIC  X(0001).
  1327     05  FILLER REDEFINES CARRIERF.
  1328         10  CARRIERA PIC  X(0001).
  1329     05  CARRIERI PIC  X(0001).
  1330*    -------------------------------
  1331     05  GROUPL PIC S9(0004) COMP.
  1332     05  GROUPF PIC  X(0001).
  1333     05  FILLER REDEFINES GROUPF.
  1334         10  GROUPA PIC  X(0001).
  1335     05  GROUPI PIC  X(0006).
  1336*    -------------------------------
  1337     05  STATEL PIC S9(0004) COMP.
  1338     05  STATEF PIC  X(0001).
  1339     05  FILLER REDEFINES STATEF.
  1340         10  STATEA PIC  X(0001).
  1341     05  STATEI PIC  X(0002).
  1342*    -------------------------------
  1343     05  ACCTL PIC S9(0004) COMP.
  1344     05  ACCTF PIC  X(0001).
  1345     05  FILLER REDEFINES ACCTF.
  1346         10  ACCTA PIC  X(0001).
  1347     05  ACCTI PIC  X(0010).
  1348*    -------------------------------
  1349     05  CERTL PIC S9(0004) COMP.
  1350     05  CERTF PIC  X(0001).
  1351     05  FILLER REDEFINES CERTF.
  1352         10  CERTA PIC  X(0001).
  1353     05  CERTI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL691.cbl
  1354*    -------------------------------
  1355     05  SFXL PIC S9(0004) COMP.
  1356     05  SFXF PIC  X(0001).
  1357     05  FILLER REDEFINES SFXF.
  1358         10  SFXA PIC  X(0001).
  1359     05  SFXI PIC  X(0001).
  1360*    -------------------------------
  1361     05  MAINTL PIC S9(0004) COMP.
  1362     05  MAINTF PIC  X(0001).
  1363     05  FILLER REDEFINES MAINTF.
  1364         10  MAINTA PIC  X(0001).
  1365     05  MAINTI PIC  X(0001).
  1366*    -------------------------------
  1367     05  MAINTBYL PIC S9(0004) COMP.
  1368     05  MAINTBYF PIC  X(0001).
  1369     05  FILLER REDEFINES MAINTBYF.
  1370         10  MAINTBYA PIC  X(0001).
  1371     05  MAINTBYI PIC  X(0004).
  1372*    -------------------------------
  1373     05  MAINTDTL PIC S9(0004) COMP.
  1374     05  MAINTDTF PIC  X(0001).
  1375     05  FILLER REDEFINES MAINTDTF.
  1376         10  MAINTDTA PIC  X(0001).
  1377     05  MAINTDTI PIC  X(0008).
  1378*    -------------------------------
  1379     05  MAINTTML PIC S9(0004) COMP.
  1380     05  MAINTTMF PIC  X(0001).
  1381     05  FILLER REDEFINES MAINTTMF.
  1382         10  MAINTTMA PIC  X(0001).
  1383     05  MAINTTMI PIC  X(0005).
  1384*    -------------------------------
  1385     05  ARCHNOL PIC S9(0004) COMP.
  1386     05  ARCHNOF PIC  X(0001).
  1387     05  FILLER REDEFINES ARCHNOF.
  1388         10  ARCHNOA PIC  X(0001).
  1389     05  ARCHNOI PIC  X(0008).
  1390*    -------------------------------
  1391     05  FORMNOL PIC S9(0004) COMP.
  1392     05  FORMNOF PIC  X(0001).
  1393     05  FILLER REDEFINES FORMNOF.
  1394         10  FORMNOA PIC  X(0001).
  1395     05  FORMNOI PIC  X(0004).
  1396*    -------------------------------
  1397     05  RESFORML PIC S9(0004) COMP.
  1398     05  RESFORMF PIC  X(0001).
  1399     05  FILLER REDEFINES RESFORMF.
  1400         10  RESFORMA PIC  X(0001).
  1401     05  RESFORMI PIC  X(0004).
  1402*    -------------------------------
  1403     05  CREATDTL PIC S9(0004) COMP.
  1404     05  CREATDTF PIC  X(0001).
  1405     05  FILLER REDEFINES CREATDTF.
  1406         10  CREATDTA PIC  X(0001).
  1407     05  CREATDTI PIC  X(0008).
  1408*    -------------------------------
  1409     05  RESENDL PIC S9(0004) COMP.
  1410     05  RESENDF PIC  X(0001).
  1411     05  FILLER REDEFINES RESENDF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL691.cbl
  1412         10  RESENDA PIC  X(0001).
  1413     05  RESENDI PIC  X(0008).
  1414*    -------------------------------
  1415     05  CREATBYL PIC S9(0004) COMP.
  1416     05  CREATBYF PIC  X(0001).
  1417     05  FILLER REDEFINES CREATBYF.
  1418         10  CREATBYA PIC  X(0001).
  1419     05  CREATBYI PIC  X(0004).
  1420*    -------------------------------
  1421     05  PRINTDTL PIC S9(0004) COMP.
  1422     05  PRINTDTF PIC  X(0001).
  1423     05  FILLER REDEFINES PRINTDTF.
  1424         10  PRINTDTA PIC  X(0001).
  1425     05  PRINTDTI PIC  X(0008).
  1426*    -------------------------------
  1427     05  RESPRNTL PIC S9(0004) COMP.
  1428     05  RESPRNTF PIC  X(0001).
  1429     05  FILLER REDEFINES RESPRNTF.
  1430         10  RESPRNTA PIC  X(0001).
  1431     05  RESPRNTI PIC  X(0008).
  1432*    -------------------------------
  1433     05  STCOMPL PIC S9(0004) COMP.
  1434     05  STCOMPF PIC  X(0001).
  1435     05  FILLER REDEFINES STCOMPF.
  1436         10  STCOMPA PIC  X(0001).
  1437     05  STCOMPI PIC  X(0019).
  1438*    -------------------------------
  1439     05  REPLYL PIC S9(0004) COMP.
  1440     05  REPLYF PIC  X(0001).
  1441     05  FILLER REDEFINES REPLYF.
  1442         10  REPLYA PIC  X(0001).
  1443     05  REPLYI PIC  X(0008).
  1444*    -------------------------------
  1445     05  STRECVL PIC S9(0004) COMP.
  1446     05  STRECVF PIC  X(0001).
  1447     05  FILLER REDEFINES STRECVF.
  1448         10  STRECVA PIC  X(0001).
  1449     05  STRECVI PIC  X(0019).
  1450*    -------------------------------
  1451     05  STOPDTEL PIC S9(0004) COMP.
  1452     05  STOPDTEF PIC  X(0001).
  1453     05  FILLER REDEFINES STOPDTEF.
  1454         10  STOPDTEA PIC  X(0001).
  1455     05  STOPDTEI PIC  X(0008).
  1456*    -------------------------------
  1457     05  STSTOPL PIC S9(0004) COMP.
  1458     05  STSTOPF PIC  X(0001).
  1459     05  FILLER REDEFINES STSTOPF.
  1460         10  STSTOPA PIC  X(0001).
  1461     05  STSTOPI PIC  X(0019).
  1462*    -------------------------------
  1463     05  FINDATEL PIC S9(0004) COMP.
  1464     05  FINDATEF PIC  X(0001).
  1465     05  FILLER REDEFINES FINDATEF.
  1466         10  FINDATEA PIC  X(0001).
  1467     05  FINDATEI PIC  X(0008).
  1468*    -------------------------------
  1469     05  STFINLL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL691.cbl
  1470     05  STFINLF PIC  X(0001).
  1471     05  FILLER REDEFINES STFINLF.
  1472         10  STFINLA PIC  X(0001).
  1473     05  STFINLI PIC  X(0019).
  1474*    -------------------------------
  1475     05  FINLACTL PIC S9(0004) COMP.
  1476     05  FINLACTF PIC  X(0001).
  1477     05  FILLER REDEFINES FINLACTF.
  1478         10  FINLACTA PIC  X(0001).
  1479     05  FINLACTI PIC  X(0001).
  1480*    -------------------------------
  1481     05  COMMENTL PIC S9(0004) COMP.
  1482     05  COMMENTF PIC  X(0001).
  1483     05  FILLER REDEFINES COMMENTF.
  1484         10  COMMENTA PIC  X(0001).
  1485     05  COMMENTI PIC  X(0069).
  1486*    -------------------------------
  1487     05  ERRMSG1L PIC S9(0004) COMP.
  1488     05  ERRMSG1F PIC  X(0001).
  1489     05  FILLER REDEFINES ERRMSG1F.
  1490         10  ERRMSG1A PIC  X(0001).
  1491     05  ERRMSG1I PIC  X(0079).
  1492*    -------------------------------
  1493     05  ERRMSG2L PIC S9(0004) COMP.
  1494     05  ERRMSG2F PIC  X(0001).
  1495     05  FILLER REDEFINES ERRMSG2F.
  1496         10  ERRMSG2A PIC  X(0001).
  1497     05  ERRMSG2I PIC  X(0079).
  1498 01  EL691AO REDEFINES EL691AI.
  1499     05  FILLER            PIC  X(0012).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  RUNDTEO PIC  X(0008).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  RUNTIMEO PIC  99.99.
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  COMPANYO PIC  X(0003).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  USERIDO PIC  X(0004).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  CARRIERO PIC  X(0001).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  GROUPO PIC  X(0006).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  STATEO PIC  X(0002).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  ACCTO PIC  X(0010).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  CERTO PIC  X(0010).
  1527*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL691.cbl
  1528     05  FILLER            PIC  X(0003).
  1529     05  SFXO PIC  X(0001).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  MAINTO PIC  X(0001).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  MAINTBYO PIC  X(0004).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  MAINTDTO PIC  99B99B99.
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  MAINTTMO PIC  99.99.
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  ARCHNOO PIC  X(0008).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  FORMNOO PIC  X(0004).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  RESFORMO PIC  X(0004).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  CREATDTO PIC  99B99B99.
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  RESENDO PIC  99B99B99.
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  CREATBYO PIC  X(0004).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  PRINTDTO PIC  99B99B99.
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  RESPRNTO PIC  99B99B99.
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  STCOMPO PIC  X(0019).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  REPLYO PIC  99B99B99.
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  STRECVO PIC  X(0019).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  STOPDTEO PIC  99B99B99.
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  STSTOPO PIC  X(0019).
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  FINDATEO PIC  99B99B99.
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL691.cbl
  1586     05  STFINLO PIC  X(0019).
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  FINLACTO PIC  X(0001).
  1590*    -------------------------------
  1591     05  FILLER            PIC  X(0003).
  1592     05  COMMENTO PIC  X(0069).
  1593*    -------------------------------
  1594     05  FILLER            PIC  X(0003).
  1595     05  ERRMSG1O PIC  X(0079).
  1596*    -------------------------------
  1597     05  FILLER            PIC  X(0003).
  1598     05  ERRMSG2O PIC  X(0079).
  1599*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL691.cbl
  1601****************************************************************
  1602*
  1603* Copyright (c) 2007 by Clerity Solutions, Inc.
  1604* All rights reserved.
  1605*
  1606****************************************************************
  1607 01  DFHEIV.
  1608   02  DFHEIV0               PIC X(35).
  1609   02  DFHEIV1               PIC X(08).
  1610   02  DFHEIV2               PIC X(08).
  1611   02  DFHEIV3               PIC X(08).
  1612   02  DFHEIV4               PIC X(06).
  1613   02  DFHEIV5               PIC X(04).
  1614   02  DFHEIV6               PIC X(04).
  1615   02  DFHEIV7               PIC X(02).
  1616   02  DFHEIV8               PIC X(02).
  1617   02  DFHEIV9               PIC X(01).
  1618   02  DFHEIV10              PIC S9(7) COMP-3.
  1619   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1620   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1621   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1622   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1623   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1624   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1625   02  DFHEIV17              PIC X(04).
  1626   02  DFHEIV18              PIC X(04).
  1627   02  DFHEIV19              PIC X(04).
  1628   02  DFHEIV20              USAGE IS POINTER.
  1629   02  DFHEIV21              USAGE IS POINTER.
  1630   02  DFHEIV22              USAGE IS POINTER.
  1631   02  DFHEIV23              USAGE IS POINTER.
  1632   02  DFHEIV24              USAGE IS POINTER.
  1633   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1634   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1635   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1636   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1637   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1638   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1639   02  FILLER                PIC X(02).
  1640   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1641   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1642   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1643   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1644   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1645 LINKAGE  SECTION.
  1646*****************************************************************
  1647*                                                               *
  1648* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1649* All rights reserved.                                          *
  1650*                                                               *
  1651*****************************************************************
  1652 01  dfheiblk.
  1653     02  eibtime          pic s9(7) comp-3.
  1654     02  eibdate          pic s9(7) comp-3.
  1655     02  eibtrnid         pic x(4).
  1656     02  eibtaskn         pic s9(7) comp-3.
  1657     02  eibtrmid         pic x(4).
  1658     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL691.cbl
  1659     02  eibcposn         pic s9(4) comp.
  1660     02  eibcalen         pic s9(4) comp.
  1661     02  eibaid           pic x(1).
  1662     02  eibfiller1       pic x(1).
  1663     02  eibfn            pic x(2).
  1664     02  eibfiller2       pic x(2).
  1665     02  eibrcode         pic x(6).
  1666     02  eibfiller3       pic x(2).
  1667     02  eibds            pic x(8).
  1668     02  eibreqid         pic x(8).
  1669     02  eibrsrce         pic x(8).
  1670     02  eibsync          pic x(1).
  1671     02  eibfree          pic x(1).
  1672     02  eibrecv          pic x(1).
  1673     02  eibsend          pic x(1).
  1674     02  eibatt           pic x(1).
  1675     02  eibeoc           pic x(1).
  1676     02  eibfmh           pic x(1).
  1677     02  eibcompl         pic x(1).
  1678     02  eibsig           pic x(1).
  1679     02  eibconf          pic x(1).
  1680     02  eiberr           pic x(1).
  1681     02  eibrldbk         pic x(1).
  1682     02  eiberrcd         pic x(4).
  1683     02  eibsynrb         pic x(1).
  1684     02  eibnodat         pic x(1).
  1685     02  eibfiller5       pic x(2).
  1686     02  eibresp          pic 9(09) comp.
  1687     02  eibresp2         pic 9(09) comp.
  1688     02  dfheigdj         pic s9(4) comp.
  1689     02  dfheigdk         pic s9(4) comp.
  1690 01  DFHCOMMAREA                 PIC X(1024).
  1691
  1692*    COPY ERCARCH.
  1693******************************************************************
  1694*                                                                *
  1695*                            ERCARCH.                            *
  1696*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1697*                            VMOD=2.002                          *
  1698*                                                                *
  1699*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  1700*                                                                *
  1701*   FILE TYPE = VSAM,KSDS                                        *
  1702*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1703*                                                                *
  1704*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1705*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1706*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1707*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1708*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1709*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1710*                                                                *
  1711*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1712******************************************************************
  1713*                   C H A N G E   L O G
  1714*
  1715* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1716*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL691.cbl
  1717*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1718* EFFECTIVE    NUMBER
  1719*-----------------------------------------------------------------
  1720* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1721* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1722******************************************************************
  1723 01  LETTER-ARCHIVE.
  1724     12  LA-RECORD-ID                PIC  X(02).
  1725         88  LA-VALID-ID                VALUE 'LA'.
  1726
  1727     12  LA-CONTROL-PRIMARY.
  1728         16  LA-COMPANY-CD           PIC  X(01).
  1729         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1730
  1731     12  LA-CONTROL-BY-CERT-RESP.
  1732         16  LA-COMPANY-CD-A2        PIC  X(01).
  1733         16  LA-CERT-NO-A2.
  1734             20  LA-CERT-PRIME-A2    PIC  X(10).
  1735             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1736         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1737             20  LA-RESP-PERSON-A2   PIC  X(10).
  1738             20  LA-TYPE-A2          PIC  X(01).
  1739         16  LA-CARRIER-A2           PIC  X(01).
  1740         16  LA-GROUPING-A2          PIC  X(06).
  1741         16  LA-STATE-A2             PIC  X(02).
  1742         16  LA-ACCOUNT-A2           PIC  X(10).
  1743         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1744         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1745
  1746     12  LA-CONTROL-BY-FORM.
  1747         16  LA-COMPANY-CD-A3        PIC  X(01).
  1748         16  LA-FORM-A3              PIC  X(04).
  1749         16  LA-CARRIER-A3           PIC  X(01).
  1750         16  LA-GROUPING-A3          PIC  X(06).
  1751         16  LA-STATE-A3             PIC  X(02).
  1752         16  LA-ACCOUNT-A3           PIC  X(10).
  1753         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1754
  1755     12  LA-CONTROL-BY-PROCESSOR.
  1756         16  LA-COMPANY-CD-A4        PIC  X(01).
  1757         16  LA-PROCESSOR-CD         PIC  X(04).
  1758         16  LA-CARRIER-A4           PIC  X(01).
  1759         16  LA-GROUPING-A4          PIC  X(06).
  1760         16  LA-STATE-A4             PIC  X(02).
  1761         16  LA-ACCOUNT-A4           PIC  X(10).
  1762         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1763
  1764     12  LA-CONTROL-BY-KEY-FIELDS.
  1765         16  LA-COMPANY-CD-A5        PIC  X(01).
  1766         16  LA-CARRIER-A5           PIC  X(01).
  1767         16  LA-GROUPING-A5          PIC  X(06).
  1768         16  LA-STATE-A5             PIC  X(02).
  1769         16  LA-ACCOUNT-A5           PIC  X(10).
  1770         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1771
  1772     12  LA-CONTROL-BY-GROUP-CODE.
  1773         16  LA-COMPANY-CD-A6        PIC  X(01).
  1774         16  LA-ENTRY-A6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL691.cbl
  1775             20  LA-FILLER           PIC  X(02).
  1776             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1777         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1778
  1779     12  FILLER                      PIC  X(09).
  1780
  1781     12  LA-HEADER-RECORD.
  1782         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1783         16  LA-CREATION-DATE        PIC  X(02).
  1784         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1785         16  LA-FINAL-ACT-DATE       REDEFINES
  1786               LA-FOLLOW-UP-DATE     PIC  X(02).
  1787         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1788         16  LA-NO-OF-COPIES         PIC S9(01).
  1789         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1790         16  LA-REPLY-DATE           PIC  X(02).
  1791         16  LA-RESEND-DATES.
  1792             20  LA-RESEND-DATE      PIC  X(02).
  1793             20  LA-SENT-DATE        PIC  X(02).
  1794             20  FILLER              PIC  X(08).
  1795         16  LA-SOURCE-INFORMATION.
  1796             20  LA-DATA-SOURCE      PIC  X(01).
  1797             20  LA-ADDR-SOURCE      PIC  X(01).
  1798         16  LA-STATUS               PIC  X(01).
  1799             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1800             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1801             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1802             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1803             88  LA-STATUS-PURGED         VALUE 'P'.
  1804             88  LA-STATUS-VOIDED         VALUE 'V'.
  1805         16  LA-LAST-RESENT-PRINT-DATE
  1806                                     PIC  X(02).
  1807         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1808             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1809                                          VALUE 'C'.
  1810             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1811                                          VALUE 'F'.
  1812             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1813                                          VALUE 'P'.
  1814         16  LA-PURGED-DATE          PIC  X(02).
  1815         16  LA-VOIDED-DATE          PIC  X(02).
  1816         16  LA-RESEND-LETR          PIC  X(4).
  1817         16  FILLER                  PIC  X(08).
  1818*        16  LA-RESEND-LETR-2        PIC  X(4).
  1819*        16  LA-RESEND-LETR-3        PIC  X(4).
  1820*        16  FILLER                  PIC  X(59).
  1821         16  LA-ARCHIVE-STATUS       PIC  X.
  1822             88  LA-TEMP                VALUE 'T'.
  1823             88  LA-QWS                 VALUE 'Q'.
  1824             88  LA-BATCH               VALUE 'B'.
  1825         16  LA-FINAL-ACT-IND        PIC  X(1).
  1826         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1827         16  FILLER                  PIC  X(46).
  1828*        16  FILLER                  PIC  X(71).
  1829         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1830         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1831         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1832                                     PIC  X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL691.cbl
  1833         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1834
  1835******************************************************************
  1836
  1837*    COPY ERCARCT.
  1838******************************************************************
  1839*                                                                *
  1840*                            ERCARCT.                            *
  1841*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1842*                            VMOD=2.002                          *
  1843*                                                                *
  1844*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  1845*                                                                *
  1846*   FILE TYPE = VSAM,KSDS                                        *
  1847*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  1848*                                                                *
  1849*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  1850*                                                                *
  1851*   LOG = NO                                                     *
  1852*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1853******************************************************************
  1854*                   C H A N G E   L O G
  1855*
  1856* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1857*-----------------------------------------------------------------
  1858*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1859* EFFECTIVE    NUMBER
  1860*-----------------------------------------------------------------
  1861* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1862******************************************************************
  1863 01  LETTER-ARCHIVE-TEXT.
  1864     12  LT-RECORD-ID                PIC  X(02).
  1865         88  LT-VALID-ID                VALUE 'LT'.
  1866
  1867     12  LT-CONTROL-PRIMARY.
  1868         16  LT-COMPANY-CD           PIC  X(01).
  1869         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  1870         16  LT-RECORD-TYPE          PIC  X(01).
  1871             88  LT-ADDRESS-DATA        VALUE '1'.
  1872             88  LT-TEXT-DATA           VALUE '2'.
  1873             88  LT-COMMENT-DATA        VALUE '3'.
  1874         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  1875
  1876     12  FILLER                      PIC  X(28).
  1877     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  1878
  1879     12  LT-TEXT-RECORD.
  1880         16  LT-LETTER-TEXT OCCURS 20 TIMES
  1881                            INDEXED BY LT-NDX.
  1882             20  LT-TEXT-LINE        PIC  X(70).
  1883             20  LT-SKIP-CONTROL     PIC  X(02).
  1884                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  1885                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  1886             20  FILLER              PIC  X(08).
  1887
  1888     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  1889         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  1890             20  LT-COMMENT-LINE     PIC X(69).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL691.cbl
  1891             20  LT-COMMENT-CHG-DT   PIC X(02).
  1892             20  LT-COMMENT-CHG-BY   PIC X(04).
  1893             20  FILLER              PIC X(05).
  1894
  1895
  1896*    COPY ERCCNOT.
  1897******************************************************************
  1898*                                                                *
  1899*                            ERCCNOT                             *
  1900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1901*                            VMOD=2.003                          *
  1902*                                                                *
  1903*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1904*                                                                *
  1905*        FILE TYPE= VSAM,KSDS                                    *
  1906*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1907*                                                                *
  1908*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1909*                                                                *
  1910*        LOG = YES                                               *
  1911*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1912*                                                                *
  1913******************************************************************
  1914*                   C H A N G E   L O G
  1915*
  1916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1917*-----------------------------------------------------------------
  1918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1919* EFFECTIVE    NUMBER
  1920*-----------------------------------------------------------------
  1921* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1922******************************************************************
  1923
  1924 01  CERT-NOTE-FILE.
  1925     12  CZ-RECORD-ID                PIC  XX.
  1926         88  VALID-CZ-ID                  VALUE 'CZ'.
  1927
  1928     12  CZ-CONTROL-PRIMARY.
  1929         16  CZ-COMPANY-CD           PIC X.
  1930         16  CZ-CARRIER              PIC X.
  1931         16  CZ-GROUPING.
  1932             20 CZ-GROUPING-PREFIX   PIC XXX.
  1933             20 CZ-GROUPING-PRIME    PIC XXX.
  1934         16  CZ-STATE                PIC XX.
  1935         16  CZ-ACCOUNT.
  1936             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1937             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1938         16  CZ-CERT-EFF-DT          PIC XX.
  1939         16  CZ-CERT-NO.
  1940             20  CZ-CERT-PRIME       PIC X(10).
  1941             20  CZ-CERT-SFX         PIC X.
  1942         16  CZ-RECORD-TYPE          PIC X.
  1943             88  CERT-NOTE           VALUE '1'.
  1944             88  CLAIM-CERT-NOTE     VALUE '2'.
  1945         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1946
  1947     12  CZ-LAST-MAINT-DT            PIC XX.
  1948     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL691.cbl
  1949     12  CZ-LAST-MAINT-USER          PIC X(4).
  1950
  1951     12  CZ-NOTE-INFORMATION.
  1952         16  CZ-NOTE                 PIC X(63).
  1953         16  FILLER                  PIC X(39).
  1954******************************************************************
  1955
  1956*    COPY ELCCERT.
  1957******************************************************************
  1958*                                                                *
  1959*                            ELCCERT.                            *
  1960*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1961*                            VMOD=2.013                          *
  1962*                                                                *
  1963*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1967*                                                                *
  1968*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1969*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1970*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1971*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1972*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1973*                                                                *
  1974*   LOG = YES                                                    *
  1975*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1976******************************************************************
  1977*                   C H A N G E   L O G
  1978*
  1979* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1980*-----------------------------------------------------------------
  1981*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1982* EFFECTIVE    NUMBER
  1983*-----------------------------------------------------------------
  1984* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1985* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1986* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1987* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1988* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1989* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1990* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1991* 032612  CR2011110200001  PEMA  AHL CHANGES
  1992******************************************************************
  1993
  1994 01  CERTIFICATE-MASTER.
  1995     12  CM-RECORD-ID                      PIC XX.
  1996         88  VALID-CM-ID                      VALUE 'CM'.
  1997
  1998     12  CM-CONTROL-PRIMARY.
  1999         16  CM-COMPANY-CD                 PIC X.
  2000         16  CM-CARRIER                    PIC X.
  2001         16  CM-GROUPING.
  2002             20  CM-GROUPING-PREFIX        PIC X(3).
  2003             20  CM-GROUPING-PRIME         PIC X(3).
  2004         16  CM-STATE                      PIC XX.
  2005         16  CM-ACCOUNT.
  2006             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL691.cbl
  2007             20  CM-ACCOUNT-PRIME          PIC X(6).
  2008         16  CM-CERT-EFF-DT                PIC XX.
  2009         16  CM-CERT-NO.
  2010             20  CM-CERT-PRIME             PIC X(10).
  2011             20  CM-CERT-SFX               PIC X.
  2012
  2013     12  CM-CONTROL-BY-NAME.
  2014         16  CM-COMPANY-CD-A1              PIC X.
  2015         16  CM-INSURED-LAST-NAME          PIC X(15).
  2016         16  CM-INSURED-INITIALS.
  2017             20  CM-INSURED-INITIAL1       PIC X.
  2018             20  CM-INSURED-INITIAL2       PIC X.
  2019
  2020     12  CM-CONTROL-BY-SSN.
  2021         16  CM-COMPANY-CD-A2              PIC X.
  2022         16  CM-SOC-SEC-NO.
  2023             20  CM-SSN-STATE              PIC XX.
  2024             20  CM-SSN-ACCOUNT            PIC X(6).
  2025             20  CM-SSN-LN3.
  2026                 25  CM-INSURED-INITIALS-A2.
  2027                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2028                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2029                 25 CM-PART-LAST-NAME-A2         PIC X.
  2030
  2031     12  CM-CONTROL-BY-CERT-NO.
  2032         16  CM-COMPANY-CD-A4              PIC X.
  2033         16  CM-CERT-NO-A4                 PIC X(11).
  2034
  2035     12  CM-CONTROL-BY-MEMB.
  2036         16  CM-COMPANY-CD-A5              PIC X.
  2037         16  CM-MEMBER-NO.
  2038             20  CM-MEMB-STATE             PIC XX.
  2039             20  CM-MEMB-ACCOUNT           PIC X(6).
  2040             20  CM-MEMB-LN4.
  2041                 25  CM-INSURED-INITIALS-A5.
  2042                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2043                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2044                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2045
  2046     12  CM-INSURED-PROFILE-DATA.
  2047         16  CM-INSURED-FIRST-NAME.
  2048             20  CM-INSURED-1ST-INIT       PIC X.
  2049             20  FILLER                    PIC X(9).
  2050         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2051         16  CM-INSURED-SEX                PIC X.
  2052             88  CM-SEX-MALE                  VALUE 'M'.
  2053             88  CM-SEX-FEMAL                 VALUE 'F'.
  2054         16  CM-INSURED-JOINT-AGE          PIC 99.
  2055         16  CM-JOINT-INSURED-NAME.
  2056             20  CM-JT-LAST-NAME           PIC X(15).
  2057             20  CM-JT-FIRST-NAME.
  2058                 24  CM-JT-1ST-INIT        PIC X.
  2059                 24  FILLER                PIC X(9).
  2060             20  CM-JT-INITIAL             PIC X.
  2061
  2062     12  CM-LIFE-DATA.
  2063         16  CM-LF-BENEFIT-CD              PIC XX.
  2064         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL691.cbl
  2065         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2066         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2067         16  CM-LF-DEV-CODE                PIC XXX.
  2068         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2069         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2070         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2071         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2072         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2073         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2074         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2075         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2076         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2077         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2078         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2079         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2080         16  FILLER                        PIC XX.
  2081
  2082     12  CM-AH-DATA.
  2083         16  CM-AH-BENEFIT-CD              PIC XX.
  2084         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2085         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2086         16  CM-AH-DEV-CODE                PIC XXX.
  2087         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2088         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2089         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2090         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2091         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2092         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2093         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2094         16  CM-AH-PAID-THRU-DT            PIC XX.
  2095             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2096         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2097         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2098         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2099         16  FILLER                        PIC X.
  2100
  2101     12  CM-LOAN-INFORMATION.
  2102         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2103         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2104                                           PIC S9(5)V99  COMP-3.
  2105         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2106         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2107         16  CM-PAY-FREQUENCY              PIC S99.
  2108         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2109         16  CM-RATE-CLASS                 PIC XX.
  2110         16  CM-BENEFICIARY                PIC X(25).
  2111         16  CM-POLICY-FORM-NO             PIC X(12).
  2112         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2113         16  CM-LAST-ADD-ON-DT             PIC XX.
  2114         16  CM-DEDUCTIBLE-AMOUNTS.
  2115             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2116             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2117         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2118             20  CM-RESIDENT-STATE         PIC XX.
  2119             20  CM-RATE-CODE              PIC X(4).
  2120             20  FILLER                    PIC XX.
  2121         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2122             20  CM-LOAN-OFFICER           PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL691.cbl
  2123             20  FILLER                    PIC XXX.
  2124         16  CM-CSR-CODE                   PIC XXX.
  2125         16  CM-UNDERWRITING-CODE          PIC X.
  2126             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2127         16  CM-POST-CARD-IND              PIC X.
  2128         16  CM-NH-INTERFACE-SW            PIC X.
  2129         16  CM-PREMIUM-TYPE               PIC X.
  2130             88  CM-SING-PRM                  VALUE '1'.
  2131             88  CM-O-B-COVERAGE              VALUE '2'.
  2132             88  CM-OPEN-END                  VALUE '3'.
  2133         16  CM-IND-GRP-TYPE               PIC X.
  2134             88  CM-INDIVIDUAL                VALUE 'I'.
  2135             88  CM-GROUP                     VALUE 'G'.
  2136         16  CM-SKIP-CODE                  PIC X.
  2137             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2138             88  SKIP-JULY                    VALUE '1'.
  2139             88  SKIP-AUGUST                  VALUE '2'.
  2140             88  SKIP-SEPTEMBER               VALUE '3'.
  2141             88  SKIP-JULY-AUG                VALUE '4'.
  2142             88  SKIP-AUG-SEPT                VALUE '5'.
  2143             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2144             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2145             88  SKIP-JUNE                    VALUE '8'.
  2146             88  SKIP-JUNE-JULY               VALUE '9'.
  2147             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2148             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2149         16  CM-PAYMENT-MODE               PIC X.
  2150             88  PAY-MONTHLY                  VALUE SPACE.
  2151             88  PAY-WEEKLY                   VALUE '1'.
  2152             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2153             88  PAY-BI-WEEKLY                VALUE '3'.
  2154             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2155         16  CM-LOAN-NUMBER                PIC X(8).
  2156         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2157         16  CM-OLD-LOF                    PIC XXX.
  2158*        16  CM-LOAN-OFFICER               PIC XXX.
  2159         16  CM-REIN-TABLE                 PIC XXX.
  2160         16  CM-SPECIAL-REIN-CODE          PIC X.
  2161         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2162         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2163         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2164
  2165     12  CM-STATUS-DATA.
  2166         16  CM-ENTRY-STATUS               PIC X.
  2167         16  CM-ENTRY-DT                   PIC XX.
  2168
  2169         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2170         16  CM-LF-CANCEL-DT               PIC XX.
  2171         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2172
  2173         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2174         16  CM-LF-DEATH-DT                PIC XX.
  2175         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2176
  2177         16  CM-LF-CURRENT-STATUS          PIC X.
  2178             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2179                                                'M' '4' '5' '9'.
  2180             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL691.cbl
  2181             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2182             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2183             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2184             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2185             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2186             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2187             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2188             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2189             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2190             88  CM-LF-DECLINED               VALUE 'D'.
  2191             88  CM-LF-VOIDED                 VALUE 'V'.
  2192
  2193         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2194         16  CM-AH-CANCEL-DT               PIC XX.
  2195         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2196
  2197         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2198         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2199         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2200
  2201         16  CM-AH-CURRENT-STATUS          PIC X.
  2202             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2203                                                'M' '4' '5' '9'.
  2204             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2205             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2206             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2207             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2208             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2209             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2210             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2211             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2212             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2213             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2214             88  CM-AH-DECLINED               VALUE 'D'.
  2215             88  CM-AH-VOIDED                 VALUE 'V'.
  2216
  2217         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2218             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2219             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2220             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2221         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2222
  2223         16  CM-ENTRY-BATCH                PIC X(6).
  2224         16  CM-LF-EXIT-BATCH              PIC X(6).
  2225         16  CM-AH-EXIT-BATCH              PIC X(6).
  2226         16  CM-LAST-MONTH-END             PIC XX.
  2227
  2228     12  CM-NOTE-SW                        PIC X.
  2229         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2230         88  CERT-NOTES-PRESENT               VALUE '1'.
  2231         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2232         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2233         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2234         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2235         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2236         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2237     12  CM-COMP-EXCP-SW                   PIC X.
  2238         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL691.cbl
  2239         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2240     12  CM-INSURED-ADDRESS-SW             PIC X.
  2241         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2242         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2243
  2244*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2245     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2246     12  FILLER                            PIC X.
  2247
  2248*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2249     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2250     12  FILLER                            PIC X.
  2251*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2252     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2253
  2254     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2255         88  CERT-ADDED-BATCH                 VALUE ' '.
  2256         88  CERT-ADDED-ONLINE                VALUE '1'.
  2257         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2258         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2259         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2260     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2261         88  CERT-AS-LOADED                   VALUE ' '.
  2262         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2263         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2264         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2265         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2266         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2267         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2268         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2269
  2270     12  CM-ACCOUNT-COMM-PCTS.
  2271         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2272         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2273
  2274     12  CM-USER-FIELD                     PIC X.
  2275     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2276     12  CM-CLP-STATE                      PIC XX.
  2277     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2278     12  CM-USER-RESERVED                  PIC XXX.
  2279     12  FILLER REDEFINES CM-USER-RESERVED.
  2280         16  CM-AH-CLASS-CD                PIC XX.
  2281         16  F                             PIC X.
  2282******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL691.cbl
  2284
  2285 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  2286                          LETTER-ARCHIVE-TEXT CERT-NOTE-FILE
  2287                          CERTIFICATE-MASTER.
  2288 0000-DFHEXIT SECTION.
  2289     MOVE '9#                    $   ' TO DFHEIV0.
  2290     MOVE 'EL691' TO DFHEIV1.
  2291     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2292     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2293
  2294     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2295     MOVE '5'                    TO DC-OPTION-CODE.
  2296     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  2297     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  2298     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  2299                                    W-CURRENT-SAVE.
  2300
  2301     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2302     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2303                                 TO EMI-SAVE-AREA.
  2304
  2305     IF  EIBCALEN EQUAL 0
  2306         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  2307         GO TO 8300-SEND-TEXT
  2308     END-IF.
  2309
  2310     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  2311         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  2312             MOVE PI-SAVED-PROGRAM-5
  2313                                 TO PI-SAVED-PROGRAM-6
  2314             MOVE PI-SAVED-PROGRAM-4
  2315                                 TO PI-SAVED-PROGRAM-5
  2316             MOVE PI-SAVED-PROGRAM-3
  2317                                 TO PI-SAVED-PROGRAM-4
  2318             MOVE PI-SAVED-PROGRAM-2
  2319                                 TO PI-SAVED-PROGRAM-3
  2320             MOVE PI-SAVED-PROGRAM-1
  2321                                 TO PI-SAVED-PROGRAM-2
  2322             MOVE PI-RETURN-TO-PROGRAM
  2323                                 TO PI-SAVED-PROGRAM-1
  2324             MOVE PI-CALLING-PROGRAM
  2325                                 TO PI-RETURN-TO-PROGRAM
  2326             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  2327         ELSE
  2328             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  2329             MOVE PI-RETURN-TO-PROGRAM
  2330                                     TO PI-CALLING-PROGRAM
  2331             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  2332             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  2333             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  2334             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  2335             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  2336             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  2337             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  2338         END-IF
  2339     ELSE
  2340         GO TO 0200-RECEIVE
  2341     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL691.cbl
  2342
  2343     GO TO 1000-SHOW.
  2344
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL691.cbl
  2346
  2347 0200-RECEIVE.
  2348
  2349
  2350* EXEC CICS HANDLE AID
  2351*        CLEAR    (9300-DFHCLEAR)
  2352*        PA1      (9200-PA)
  2353*        PA2      (9200-PA)
  2354*        PA3      (9200-PA)
  2355*    END-EXEC.
  2356*    MOVE '"&=!"#               V! " #00002345' TO DFHEIV0
  2357     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2358     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2359     MOVE X'2220233030303032333435' TO DFHEIV0(25:11)
  2360     CALL 'kxdfhei1' USING DFHEIV0
  2361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2362
  2363
  2364
  2365* EXEC CICS HANDLE CONDITION
  2366*        PGMIDERR (9700-PGMID-ERROR)
  2367*        ERROR    (9800-ABEND)
  2368*    END-EXEC.
  2369*    MOVE '"$L.                  ! # #00002352' TO DFHEIV0
  2370     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2372     MOVE X'2320233030303032333532' TO DFHEIV0(25:11)
  2373     CALL 'kxdfhei1' USING DFHEIV0
  2374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2375
  2376
  2377
  2378* EXEC CICS RECEIVE
  2379*        MAP      (W-MAP)
  2380*        MAPSET   (W-MAPSET)
  2381*        INTO     (EL691AI)
  2382*    END-EXEC.
  2383     MOVE LENGTH OF
  2384      EL691AI
  2385       TO DFHEIV11
  2386*    MOVE '8"T I  L              ''   #00002357' TO DFHEIV0
  2387     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2389     MOVE X'2020233030303032333537' TO DFHEIV0(25:11)
  2390     CALL 'kxdfhei1' USING DFHEIV0,
  2391           W-MAP,
  2392           EL691AI,
  2393           DFHEIV11,
  2394           W-MAPSET,
  2395           DFHEIV99,
  2396           DFHEIV99
  2397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2398
  2399
  2400     IF  NOT DISPLAY-CAP
  2401         MOVE 'READ'             TO SM-READ
  2402         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2403         MOVE ER-9097            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL691.cbl
  2404         MOVE -1                 TO MAINTL
  2405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2406         GO TO 8100-SEND-INITIAL-MAP
  2407     END-IF.
  2408
  2409
  2410 0300-CHECK-PFKEYS.
  2411
  2412     IF  EIBAID EQUAL DFHPF23
  2413         MOVE EIBAID             TO PI-ENTRY-CD-1
  2414         MOVE W-XCTL-005         TO W-CALL-PGM
  2415         GO TO 9400-XCTL
  2416     END-IF.
  2417
  2418     IF  EIBAID EQUAL DFHPF24
  2419         MOVE W-XCTL-626         TO W-CALL-PGM
  2420         GO TO 9400-XCTL
  2421     END-IF.
  2422
  2423     IF  MAINTI EQUAL 'C'  AND
  2424         EIBAID EQUAL DFHENTER
  2425          GO TO 0700-PROCESS-CHANGES
  2426     END-IF.
  2427
  2428     MOVE ER-0029                TO EMI-ERROR.
  2429
  2430
  2431 0320-INPUT-ERROR.
  2432
  2433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2434     MOVE -1                     TO  MAINTL.
  2435     GO TO 8200-SEND-DATAONLY.
  2436
  2437
  2438 0700-PROCESS-CHANGES.
  2439
  2440     IF  NOT MODIFY-CAP
  2441         MOVE 'UPDATE'           TO SM-READ
  2442         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2443         MOVE ER-0070            TO EMI-ERROR
  2444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2445         MOVE -1                 TO MAINTL
  2446         GO TO 8100-SEND-INITIAL-MAP
  2447     END-IF.
  2448
  2449     MOVE 'N'                    TO W-NEED-COMMENT.
  2450
  2451     IF RESENDL GREATER ZERO
  2452         MOVE 'Y'                TO W-NEED-COMMENT
  2453         IF RESENDI = SPACES
  2454             MOVE AL-UANON       TO  RESENDA
  2455             MOVE +1             TO  W-UPDATE-SW
  2456             MOVE LOW-VALUES     TO  W-RESEND-DATE
  2457         ELSE
  2458             MOVE RESENDI       TO  W-DEEDIT-FIELD
  2459             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2460             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2461                 MOVE W-DEEDIT-FIELD-V0  TO  RESENDO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL691.cbl
  2462                 INSPECT RESENDI CONVERTING SPACES TO SLASH
  2463                 MOVE '4'        TO  DC-OPTION-CODE
  2464                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2465                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2466                 IF DC-ERROR-CODE NOT = SPACES
  2467                     MOVE ER-0295         TO  EMI-ERROR
  2468                     MOVE -1              TO  RESENDL
  2469                     MOVE AL-UABON        TO  RESENDA
  2470                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2471                 ELSE
  2472                     MOVE AL-UANON       TO  RESENDA
  2473                     MOVE +1             TO  W-UPDATE-SW
  2474                     MOVE DC-BIN-DATE-1  TO  W-RESEND-DATE
  2475                 END-IF
  2476             ELSE
  2477                 MOVE ER-0295    TO  EMI-ERROR
  2478                 MOVE -1         TO  RESENDL
  2479                 MOVE AL-UABON   TO  RESENDA
  2480                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2481             END-IF
  2482         END-IF
  2483     END-IF.
  2484
  2485     IF FINDATEL GREATER ZERO
  2486         IF FINDATEI = SPACES
  2487             MOVE AL-UANON       TO  FINDATEA
  2488             MOVE +1             TO  W-UPDATE-SW
  2489             MOVE LOW-VALUES     TO  W-FINAL-ACT-DATE
  2490             MOVE SPACES         TO  PI-ARCHIVE-FINAL
  2491         ELSE
  2492             MOVE 'Y'             TO  PI-ARCHIVE-FINAL
  2493             MOVE FINDATEI        TO  W-DEEDIT-FIELD
  2494             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2495             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2496                 MOVE W-DEEDIT-FIELD-V0  TO  FINDATEO
  2497                 INSPECT FINDATEI CONVERTING SPACES TO SLASH
  2498                 MOVE '4'                 TO  DC-OPTION-CODE
  2499                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2500                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2501                 IF DC-ERROR-CODE NOT = SPACES
  2502                     MOVE ER-0296        TO  EMI-ERROR
  2503                     MOVE -1             TO  FINDATEL
  2504                     MOVE AL-UABON       TO  FINDATEA
  2505                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2506                 ELSE
  2507                     MOVE AL-UANON       TO  FINDATEA
  2508                     MOVE +1             TO  W-UPDATE-SW
  2509                     MOVE DC-BIN-DATE-1  TO  W-FINAL-ACT-DATE
  2510                 END-IF
  2511             ELSE
  2512                 MOVE ER-0296    TO  EMI-ERROR
  2513                 MOVE -1         TO  FINDATEL
  2514                 MOVE AL-UABON   TO  FINDATEA
  2515                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2516             END-IF
  2517         END-IF
  2518     END-IF.
  2519
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL691.cbl
  2520     IF REPLYL GREATER ZERO
  2521         IF REPLYI = SPACES
  2522             MOVE AL-UANON       TO  REPLYA
  2523             MOVE +1             TO  W-UPDATE-SW
  2524             MOVE LOW-VALUES     TO  W-RECEIVED-DATE
  2525             MOVE SPACES         TO  PI-ARCHIVE-RECEIVED
  2526         ELSE
  2527             MOVE 'Y'            TO  PI-ARCHIVE-RECEIVED
  2528             MOVE REPLYI         TO  W-DEEDIT-FIELD
  2529             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2530             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2531                 MOVE W-DEEDIT-FIELD-V0  TO  REPLYO
  2532                 INSPECT REPLYI CONVERTING SPACES TO SLASH
  2533                 MOVE '4'        TO  DC-OPTION-CODE
  2534                 MOVE W-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  2535                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2536                 IF DC-ERROR-CODE NOT = SPACES
  2537                     MOVE ER-9245        TO  EMI-ERROR
  2538                     MOVE -1             TO  REPLYL
  2539                     MOVE AL-UABON       TO  REPLYA
  2540                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2541                 ELSE
  2542                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2543                       MOVE ER-0539      TO  EMI-ERROR
  2544                       MOVE -1           TO  REPLYL
  2545                       MOVE AL-UABON     TO  REPLYA
  2546                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2547                   ELSE
  2548                       MOVE AL-UANON     TO  REPLYA
  2549                       MOVE +1           TO  W-UPDATE-SW
  2550                       MOVE DC-BIN-DATE-1 TO W-RECEIVED-DATE
  2551                       MOVE DC-GREG-DATE-1-EDIT TO
  2552                                        W-CERT-NOTE-RECV-DT
  2553                   END-IF
  2554                 END-IF
  2555             ELSE
  2556                 MOVE ER-9245    TO  EMI-ERROR
  2557                 MOVE -1         TO  REPLYL
  2558                 MOVE AL-UABON   TO  REPLYA
  2559                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2560             END-IF
  2561         END-IF
  2562     END-IF.
  2563
  2564     IF STOPDTEL GREATER ZERO
  2565         IF STOPDTEI = SPACES
  2566             MOVE AL-UANON       TO  STOPDTEA
  2567             MOVE +1             TO  W-UPDATE-SW
  2568             MOVE LOW-VALUES     TO  W-STOP-LETTER-DATE
  2569             MOVE SPACES         TO  PI-ARCHIVE-STOPPED
  2570             MOVE AL-UANOF       TO  RESENDA
  2571                                     RESFORMA
  2572                                     FINDATEA
  2573                                     FINLACTA
  2574                                     REPLYA
  2575                                     COMMENTA
  2576         ELSE
  2577             MOVE 'Y'            TO  PI-ARCHIVE-STOPPED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL691.cbl
  2578             MOVE 'Y'            TO  W-NEED-COMMENT
  2579             MOVE STOPDTEI       TO  W-DEEDIT-FIELD
  2580             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2581             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2582                 MOVE W-DEEDIT-FIELD-V0  TO  STOPDTEO
  2583                 INSPECT STOPDTEI CONVERTING SPACES TO SLASH
  2584                 MOVE '4'        TO  DC-OPTION-CODE
  2585                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2586                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2587                 IF DC-ERROR-CODE NOT = SPACES
  2588                     MOVE ER-0897         TO  EMI-ERROR
  2589                     MOVE -1              TO  STOPDTEL
  2590                     MOVE AL-UABON        TO  STOPDTEA
  2591                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2592                 ELSE
  2593                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2594                       MOVE ER-0895      TO  EMI-ERROR
  2595                       MOVE -1           TO  STOPDTEL
  2596                       MOVE AL-UABON     TO  STOPDTEA
  2597                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2598                   ELSE
  2599                     MOVE AL-UANON       TO  STOPDTEA
  2600                     MOVE +1             TO  W-UPDATE-SW
  2601                     MOVE DC-BIN-DATE-1  TO  W-STOP-LETTER-DATE
  2602                   END-IF
  2603                 END-IF
  2604             ELSE
  2605                 MOVE ER-0897    TO  EMI-ERROR
  2606                 MOVE -1         TO  STOPDTEL
  2607                 MOVE AL-UABON   TO  STOPDTEA
  2608                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2609             END-IF
  2610         END-IF
  2611     END-IF.
  2612
  2613     IF W-NEED-COMMENT = 'Y'  AND
  2614        COMMENTL NOT > ZERO
  2615           MOVE -1         TO  COMMENTL
  2616           MOVE ER-7363    TO  EMI-ERROR
  2617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2618     END-IF.
  2619
  2620     IF COMMENTL GREATER ZERO
  2621      OR  RESFORML GREATER ZERO
  2622      OR  FINLACTL GREATER ZERO
  2623         MOVE +1          TO  W-UPDATE-SW
  2624     END-IF.
  2625
  2626     IF W-ERROR-COUNT GREATER ZERO
  2627         GO TO 8200-SEND-DATAONLY
  2628     END-IF.
  2629
  2630     IF W-UPDATE-SW NOT GREATER ZERO
  2631         MOVE ER-3112    TO  EMI-ERROR
  2632         MOVE -1         TO  MAINTL
  2633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2634         GO TO 8200-SEND-DATAONLY
  2635     END-IF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL691.cbl
  2636
  2637     IF PI-ARCHIVE-STOPPED = 'Y'
  2638        MOVE AL-SANOF       TO RESENDA
  2639                               RESFORMA
  2640                               FINDATEA
  2641                               FINLACTA
  2642                               REPLYA
  2643                               COMMENTA
  2644     END-IF.
  2645
  2646     PERFORM 3000-READ-FOR-UPDATE THRU 3000-EXIT.
  2647
  2648     IF RESENDL GREATER ZERO
  2649         MOVE W-RESEND-DATE      TO  LA-RESEND-DATE
  2650     END-IF.
  2651
  2652     IF FINDATEL GREATER ZERO
  2653         MOVE W-FINAL-ACT-DATE   TO  LA-FINAL-ACT-DATE
  2654     END-IF.
  2655
  2656     IF REPLYL GREATER ZERO
  2657         MOVE W-RECEIVED-DATE    TO  LA-REPLY-DATE
  2658         IF W-RECEIVED-DATE NOT EQUAL LOW-VALUES
  2659             PERFORM 4000-ADD-CERT-NOTE THRU 4099-EXIT
  2660         END-IF
  2661     END-IF.
  2662
  2663     IF RESFORML GREATER ZERO
  2664        MOVE RESFORMI            TO  LA-RESEND-LETR
  2665     END-IF.
  2666
  2667     IF FINLACTL GREATER ZERO
  2668        MOVE FINLACTI            TO  LA-FINAL-ACT-IND
  2669     END-IF.
  2670
  2671     IF STOPDTEL GREATER ZERO
  2672        MOVE W-STOP-LETTER-DATE  TO  LA-VOIDED-DATE
  2673     END-IF.
  2674
  2675     PERFORM 3100-REWRITE THRU 3100-EXIT.
  2676
  2677     IF COMMENTL NOT GREATER ZERO
  2678
  2679         MOVE ER-0000            TO  EMI-ERROR
  2680         MOVE ' '                TO  MAINTO
  2681         MOVE -1                 TO  MAINTL
  2682         MOVE AL-UANOF           TO  MAINTA
  2683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2684         GO TO 1000-SHOW
  2685     END-IF.
  2686
  2687     PERFORM 3200-READ-ARCT-FOR-UPDATE THRU 3200-EXIT.
  2688
  2689     IF PI-COMMENT-INDEX EQUAL +20
  2690         MOVE ER-0051    TO  EMI-ERROR
  2691         MOVE -1         TO  MAINTL
  2692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2693         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL691.cbl
  2694     END-IF
  2695
  2696     SET PI-COMMENT-INDEX UP BY +1.
  2697     SET LC-NDX TO PI-COMMENT-INDEX.
  2698     MOVE COMMENTI        TO  LT-COMMENT-LINE (LC-NDX).
  2699     MOVE W-SAVE-BIN-DATE TO  LT-COMMENT-CHG-DT (LC-NDX).
  2700     MOVE PI-PROCESSOR-ID TO  LT-COMMENT-CHG-BY (LC-NDX).
  2701     ADD +1               TO  LT-NUM-LINES-ON-RECORD.
  2702
  2703
  2704     IF W-ADD-ARCT = 'N'
  2705         PERFORM 3300-REWRITE-ARCT THRU 3300-EXIT
  2706     ELSE
  2707         PERFORM 3350-INSERT-ARCT THRU 3350-EXIT
  2708     END-IF.
  2709
  2710
  2711     MOVE ER-0000                TO  EMI-ERROR.
  2712     MOVE ' '                    TO  MAINTO.
  2713     MOVE -1                     TO  MAINTL.
  2714     MOVE AL-UANOF               TO  MAINTA.
  2715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2716     GO TO 1000-SHOW.
  2717
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL691.cbl
  2719
  2720 1000-SHOW.
  2721***************************************************************
  2722*     THIS ROUTINE WILL READ THE ARCHIVE FILE WITH THE        *
  2723*     ARCHIVE NUMBER SPECIFIED FROM THE PRIOR SCREEN.         *
  2724***************************************************************
  2725     MOVE LOW-VALUES              TO W-ARCT-KEY.
  2726     MOVE PI-COMPANY-CD           TO W-ARCH-COMPANY-CD
  2727                                     W-ARCT-COMPANY-CD.
  2728     MOVE PI-689-ARCHIVE-NUMBER   TO W-ARCH-NUMBER
  2729                                     W-ARCT-ARCHIVE-NO.
  2730     MOVE '3'                     TO W-ARCT-RECORD-TYPE.
  2731     MOVE +0                      TO W-ARCT-LINE-SEQ-NO.
  2732
  2733
  2734* EXEC CICS HANDLE CONDITION
  2735*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  2736*         NOTFND     (1070-ARCH-NOT-FOUND)
  2737*         ENDFILE    (1070-ARCH-NOT-FOUND)
  2738*    END-EXEC.
  2739*    MOVE '"$JI''                 ! $ #00002696' TO DFHEIV0
  2740     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2742     MOVE X'2420233030303032363936' TO DFHEIV0(25:11)
  2743     CALL 'kxdfhei1' USING DFHEIV0
  2744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2745
  2746
  2747
  2748* EXEC CICS READ
  2749*        DATASET (W-ARCH-FILE-ID)
  2750*        SET     (ADDRESS OF LETTER-ARCHIVE)
  2751*        RIDFLD  (W-ARCH-KEY)
  2752*    END-EXEC.
  2753*    MOVE '&"S        E          (   #00002702' TO DFHEIV0
  2754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2756     MOVE X'2020233030303032373032' TO DFHEIV0(25:11)
  2757     CALL 'kxdfhei1' USING DFHEIV0,
  2758           W-ARCH-FILE-ID,
  2759           DFHEIV20,
  2760           DFHEIV99,
  2761           W-ARCH-KEY,
  2762           DFHEIV99,
  2763           DFHEIV99,
  2764           DFHEIV99
  2765     SET ADDRESS OF LETTER-ARCHIVE TO
  2766         DFHEIV20
  2767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2768
  2769
  2770     MOVE LA-FORM-A3             TO FORMNOO.
  2771     MOVE LA-ARCHIVE-NO          TO ARCHNOO.
  2772     MOVE LA-CARRIER-A2          TO CARRIERO.
  2773     MOVE LA-GROUPING-A2         TO GROUPO.
  2774     MOVE LA-STATE-A2            TO STATEO.
  2775     MOVE LA-ACCOUNT-A2          TO ACCTO.
  2776     MOVE LA-CERT-PRIME-A2       TO CERTO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL691.cbl
  2777     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  2778
  2779     IF  LA-CREATION-DATE EQUAL LOW-VALUES OR SPACES
  2780         MOVE SPACES             TO CREATDTI
  2781     ELSE
  2782         MOVE LA-CREATION-DATE   TO DC-BIN-DATE-1
  2783         MOVE ' '                TO DC-OPTION-CODE
  2784         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2785         MOVE DC-GREG-DATE-1-EDIT TO CREATDTI
  2786     END-IF.
  2787
  2788     MOVE LA-PROCESSOR-CD        TO CREATBYI.
  2789
  2790     IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES OR SPACES
  2791         MOVE SPACES             TO PRINTDTI
  2792     ELSE
  2793         MOVE LA-INITIAL-PRINT-DATE TO DC-BIN-DATE-1
  2794         MOVE ' '                TO DC-OPTION-CODE
  2795         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2796         MOVE DC-GREG-DATE-1-EDIT TO PRINTDTI
  2797     END-IF.
  2798
  2799     IF  LA-RESEND-DATE = LOW-VALUES OR SPACES
  2800         MOVE SPACES             TO RESENDI
  2801     ELSE
  2802         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  2803         MOVE ' '                TO DC-OPTION-CODE
  2804         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2805         MOVE DC-GREG-DATE-1-EDIT TO RESENDI
  2806     END-IF.
  2807
  2808     MOVE LA-RESEND-LETR         TO RESFORMI.
  2809
  2810     IF  LA-SENT-DATE = LOW-VALUES OR SPACES
  2811         MOVE SPACES             TO RESPRNTI
  2812         MOVE SPACES             TO PI-ARCHIVE-COMPLETE
  2813     ELSE
  2814         MOVE 'Y'                TO PI-ARCHIVE-COMPLETE
  2815         MOVE LA-SENT-DATE     TO DC-BIN-DATE-1
  2816         MOVE ' '                TO DC-OPTION-CODE
  2817         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2818         MOVE DC-GREG-DATE-1-EDIT TO RESPRNTI
  2819     END-IF.
  2820
  2821     IF  LA-FINAL-ACT-DATE EQUAL LOW-VALUES OR SPACES
  2822         MOVE SPACES             TO FINDATEI
  2823         MOVE SPACES             TO PI-ARCHIVE-FINAL
  2824     ELSE
  2825         MOVE 'Y'                TO PI-ARCHIVE-FINAL
  2826         MOVE LA-FINAL-ACT-DATE  TO DC-BIN-DATE-1
  2827         MOVE ' '                TO DC-OPTION-CODE
  2828         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2829         MOVE DC-GREG-DATE-1-EDIT TO FINDATEI
  2830     END-IF.
  2831
  2832     MOVE LA-FINAL-ACT-IND       TO FINLACTI.
  2833
  2834     IF  LA-REPLY-DATE = LOW-VALUES OR SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL691.cbl
  2835         MOVE SPACES             TO REPLYI
  2836         MOVE SPACES             TO PI-ARCHIVE-RECEIVED
  2837     ELSE
  2838         MOVE 'Y'                TO PI-ARCHIVE-RECEIVED
  2839         MOVE LA-REPLY-DATE      TO DC-BIN-DATE-1
  2840         MOVE ' '                TO DC-OPTION-CODE
  2841         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2842         MOVE DC-GREG-DATE-1-EDIT TO REPLYI
  2843     END-IF.
  2844
  2845     IF  LA-VOIDED-DATE = LOW-VALUES OR SPACES
  2846         MOVE SPACES             TO STOPDTEI
  2847         MOVE SPACES             TO PI-ARCHIVE-STOPPED
  2848     ELSE
  2849         MOVE 'Y'                TO PI-ARCHIVE-STOPPED
  2850         MOVE LA-VOIDED-DATE     TO DC-BIN-DATE-1
  2851         MOVE ' '                TO DC-OPTION-CODE
  2852         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2853         MOVE DC-GREG-DATE-1-EDIT TO STOPDTEI
  2854     END-IF.
  2855
  2856     IF LA-LAST-MAINT-DATE = LOW-VALUES OR SPACES
  2857         MOVE SPACES             TO MAINTDTI
  2858     ELSE
  2859         MOVE LA-LAST-MAINT-DATE TO DC-BIN-DATE-1
  2860         MOVE ' '                TO DC-OPTION-CODE
  2861         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2862         MOVE DC-GREG-DATE-1-EDIT TO MAINTDTI
  2863     END-IF.
  2864
  2865     IF LA-LAST-MAINT-TIMEX = LOW-VALUES OR SPACES
  2866         MOVE ZEROES             TO MAINTTMO
  2867     ELSE
  2868         MOVE LA-LAST-MAINT-TIME TO W-TIME-IN
  2869         MOVE W-TIME-OUT         TO MAINTTMO
  2870     END-IF.
  2871
  2872     MOVE LA-LAST-UPDATED-BY     TO MAINTBYI.
  2873
  2874     IF (LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  2875       OR (LA-VOIDED-DATE  NOT EQUAL LOW-VALUES AND SPACES)
  2876          MOVE AL-SANOF          TO RESENDA
  2877                                    RESFORMA
  2878                                    FINDATEA
  2879                                    FINLACTA
  2880                                    REPLYA
  2881                                    COMMENTA
  2882     END-IF.
  2883
  2884     IF LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES
  2885         MOVE AL-SANOF           TO STOPDTEA
  2886     END-IF.
  2887
  2888
  2889* EXEC CICS HANDLE CONDITION
  2890*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  2891*         NOTFND     (1000-ARCT-NOT-FOUND)
  2892*         ENDFILE    (1000-ARCT-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL691.cbl
  2893*    END-EXEC.
  2894*    MOVE '"$JI''                 ! % #00002826' TO DFHEIV0
  2895     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2897     MOVE X'2520233030303032383236' TO DFHEIV0(25:11)
  2898     CALL 'kxdfhei1' USING DFHEIV0
  2899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2900
  2901
  2902
  2903* EXEC CICS READ
  2904*        DATASET  (W-ARCT-FILE-ID)
  2905*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  2906*        RIDFLD   (W-ARCT-KEY)
  2907*    END-EXEC.
  2908*    MOVE '&"S        E          (   #00002832' TO DFHEIV0
  2909     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2911     MOVE X'2020233030303032383332' TO DFHEIV0(25:11)
  2912     CALL 'kxdfhei1' USING DFHEIV0,
  2913           W-ARCT-FILE-ID,
  2914           DFHEIV20,
  2915           DFHEIV99,
  2916           W-ARCT-KEY,
  2917           DFHEIV99,
  2918           DFHEIV99,
  2919           DFHEIV99
  2920     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  2921         DFHEIV20
  2922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2923
  2924
  2925     SET LC-NDX TO W-ZEROS.
  2926     PERFORM 20 TIMES
  2927         SET LC-NDX UP BY +1
  2928         IF LT-COMMENT-LINE (LC-NDX) > SPACES
  2929             MOVE LT-COMMENT-LINE (LC-NDX) TO COMMENTI
  2930             SET PI-COMMENT-INDEX TO LC-NDX
  2931         END-IF
  2932     END-PERFORM.
  2933
  2934     MOVE -1                     TO MAINTL.
  2935     GO TO 8100-SEND-INITIAL-MAP.
  2936
  2937 1000-ARCT-NOT-FOUND.
  2938
  2939     SET PI-COMMENT-INDEX        TO W-ZEROS.
  2940     MOVE -1                     TO MAINTL.
  2941     GO TO 8100-SEND-INITIAL-MAP.
  2942
  2943 1000-EXIT.
  2944     EXIT.
  2945
  2946
  2947 1070-ARCH-NOT-FOUND.
  2948
  2949     MOVE ER-7371                TO EMI-ERROR.
  2950     MOVE -1                     TO ARCHNOL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL691.cbl
  2951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2952     GO TO 8100-SEND-INITIAL-MAP.
  2953
  2954
  2955 3000-READ-FOR-UPDATE SECTION.
  2956
  2957
  2958* EXEC CICS HANDLE CONDITION
  2959*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  2960*         NOTFND     (1070-ARCH-NOT-FOUND)
  2961*         ENDFILE    (1070-ARCH-NOT-FOUND)
  2962*    END-EXEC.
  2963*    MOVE '"$JI''                 ! & #00002870' TO DFHEIV0
  2964     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2966     MOVE X'2620233030303032383730' TO DFHEIV0(25:11)
  2967     CALL 'kxdfhei1' USING DFHEIV0
  2968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2969
  2970
  2971     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
  2972     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCH-NUMBER
  2973
  2974
  2975* EXEC CICS READ
  2976*        DATASET (W-ARCH-FILE-ID)
  2977*        SET     (ADDRESS OF LETTER-ARCHIVE)
  2978*        RIDFLD  (W-ARCH-KEY)
  2979*        UPDATE
  2980*    END-EXEC.
  2981*    MOVE '&"S        EU         (   #00002879' TO DFHEIV0
  2982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2983     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2984     MOVE X'2020233030303032383739' TO DFHEIV0(25:11)
  2985     CALL 'kxdfhei1' USING DFHEIV0,
  2986           W-ARCH-FILE-ID,
  2987           DFHEIV20,
  2988           DFHEIV99,
  2989           W-ARCH-KEY,
  2990           DFHEIV99,
  2991           DFHEIV99,
  2992           DFHEIV99
  2993     SET ADDRESS OF LETTER-ARCHIVE TO
  2994         DFHEIV20
  2995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2996
  2997
  2998 3000-EXIT.
  2999     EXIT.
  3000
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL691.cbl
  3002
  3003 3100-REWRITE SECTION.
  3004
  3005     MOVE PI-PROCESSOR-ID        TO  LA-LAST-UPDATED-BY
  3006                                     MAINTBYI.
  3007     MOVE W-SAVE-BIN-DATE        TO  LA-LAST-MAINT-DATE.
  3008     MOVE W-SAVE-DATE            TO  MAINTDTI.
  3009
  3010     MOVE EIBTIME                TO  LA-LAST-MAINT-TIME
  3011                                     W-TIME-IN.
  3012     MOVE W-TIME-OUT             TO  MAINTTMO.
  3013
  3014
  3015* EXEC CICS REWRITE
  3016*        DATASET (W-ARCH-FILE-ID)
  3017*        FROM    (LETTER-ARCHIVE)
  3018*    END-EXEC.
  3019     MOVE LENGTH OF
  3020      LETTER-ARCHIVE
  3021       TO DFHEIV11
  3022*    MOVE '&& L                  %   #00002902' TO DFHEIV0
  3023     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3024     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3025     MOVE X'2020233030303032393032' TO DFHEIV0(25:11)
  3026     CALL 'kxdfhei1' USING DFHEIV0,
  3027           W-ARCH-FILE-ID,
  3028           LETTER-ARCHIVE,
  3029           DFHEIV11,
  3030           DFHEIV99
  3031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3032
  3033
  3034 3100-EXIT.
  3035     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL691.cbl
  3037 3200-READ-ARCT-FOR-UPDATE  SECTION.
  3038
  3039
  3040* EXEC CICS HANDLE CONDITION
  3041*         NOTFND     (3200-NOT-FOUND)
  3042*         ENDFILE    (3200-NOT-FOUND)
  3043*    END-EXEC.
  3044*    MOVE '"$I''                  ! '' #00002912' TO DFHEIV0
  3045     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3047     MOVE X'2720233030303032393132' TO DFHEIV0(25:11)
  3048     CALL 'kxdfhei1' USING DFHEIV0
  3049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3050
  3051
  3052     MOVE PI-COMPANY-CD TO W-ARCT-COMPANY-CD.
  3053     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCT-ARCHIVE-NO.
  3054     MOVE '3'                   TO W-ARCT-RECORD-TYPE.
  3055     MOVE +0                    TO W-ARCT-LINE-SEQ-NO.
  3056
  3057
  3058* EXEC CICS READ
  3059*        DATASET  (W-ARCT-FILE-ID)
  3060*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3061*        RIDFLD   (W-ARCT-KEY)
  3062*        UPDATE
  3063*    END-EXEC.
  3064*    MOVE '&"S        EU         (   #00002922' TO DFHEIV0
  3065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3066     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3067     MOVE X'2020233030303032393232' TO DFHEIV0(25:11)
  3068     CALL 'kxdfhei1' USING DFHEIV0,
  3069           W-ARCT-FILE-ID,
  3070           DFHEIV20,
  3071           DFHEIV99,
  3072           W-ARCT-KEY,
  3073           DFHEIV99,
  3074           DFHEIV99,
  3075           DFHEIV99
  3076     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3077         DFHEIV20
  3078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3079
  3080
  3081     MOVE 'N' TO W-ADD-ARCT.
  3082     GO TO 3200-EXIT.
  3083
  3084 3200-NOT-FOUND.
  3085
  3086
  3087* EXEC CICS GETMAIN
  3088*         SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3089*         LENGTH   (W-ARCT-LENGTH)
  3090*    END-EXEC.
  3091*    MOVE '," L                  $   #00002934' TO DFHEIV0
  3092     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3093     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3094     MOVE X'2020233030303032393334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL691.cbl
  3095     CALL 'kxdfhei1' USING DFHEIV0,
  3096           DFHEIV20,
  3097           W-ARCT-LENGTH,
  3098           DFHEIV99
  3099     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3100         DFHEIV20
  3101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3102
  3103
  3104     MOVE 'Y'                    TO W-ADD-ARCT.
  3105     MOVE LOW-VALUES             TO LETTER-ARCHIVE-TEXT.
  3106     MOVE 'LT'                   TO LT-RECORD-ID.
  3107     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
  3108     MOVE PI-689-ARCHIVE-NUMBER  TO LT-ARCHIVE-NO.
  3109     MOVE '3'                    TO LT-RECORD-TYPE.
  3110     MOVE +0                     TO LT-LINE-SEQ-NO.
  3111     MOVE +0                     TO LT-NUM-LINES-ON-RECORD.
  3112     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3113
  3114 3200-EXIT.
  3115     EXIT.
  3116
  3117 3300-REWRITE-ARCT SECTION.
  3118
  3119
  3120* EXEC CICS REWRITE
  3121*        DATASET (W-ARCT-FILE-ID)
  3122*        FROM    (LETTER-ARCHIVE-TEXT)
  3123*    END-EXEC.
  3124     MOVE LENGTH OF
  3125      LETTER-ARCHIVE-TEXT
  3126       TO DFHEIV11
  3127*    MOVE '&& L                  %   #00002954' TO DFHEIV0
  3128     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3129     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3130     MOVE X'2020233030303032393534' TO DFHEIV0(25:11)
  3131     CALL 'kxdfhei1' USING DFHEIV0,
  3132           W-ARCT-FILE-ID,
  3133           LETTER-ARCHIVE-TEXT,
  3134           DFHEIV11,
  3135           DFHEIV99
  3136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3137
  3138
  3139 3300-EXIT.
  3140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL691.cbl
  3142
  3143 3350-INSERT-ARCT SECTION.
  3144
  3145* EXEC CICS WRITE
  3146*         DATASET   (W-ARCT-FILE-ID)
  3147*         FROM      (LETTER-ARCHIVE-TEXT)
  3148*         RIDFLD    (LT-CONTROL-PRIMARY)
  3149*    END-EXEC.
  3150     MOVE LENGTH OF
  3151      LETTER-ARCHIVE-TEXT
  3152       TO DFHEIV11
  3153*    MOVE '&$ L                  ''   #00002964' TO DFHEIV0
  3154     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3155     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3156     MOVE X'2020233030303032393634' TO DFHEIV0(25:11)
  3157     CALL 'kxdfhei1' USING DFHEIV0,
  3158           W-ARCT-FILE-ID,
  3159           LETTER-ARCHIVE-TEXT,
  3160           DFHEIV11,
  3161           LT-CONTROL-PRIMARY,
  3162           DFHEIV99,
  3163           DFHEIV99
  3164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3165
  3166
  3167 3350-EXIT.
  3168     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL691.cbl
  3170
  3171
  3172 4000-ADD-CERT-NOTE  SECTION.
  3173
  3174     MOVE SPACES                 TO  ERCNOT-KEY
  3175                                     ELCERT-KEY.
  3176
  3177     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  3178                                     ELCERT-COMPANY-CD.
  3179     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  3180                                     ELCERT-CARRIER.
  3181     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  3182                                     ELCERT-GROUPING.
  3183     MOVE PI-STATE               TO  ERCNOT-STATE
  3184                                     ELCERT-STATE.
  3185     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  3186                                     ELCERT-ACCOUNT.
  3187     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  3188                                     ELCERT-EFF-DT.
  3189     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  3190                                     ELCERT-CERT-PRIME.
  3191     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  3192                                     ELCERT-CERT-SFX.
  3193     MOVE '1'                    TO  ERCNOT-REC-TYP
  3194     MOVE ZEROS                  TO  ERCNOT-SEQ.
  3195     MOVE ERCNOT-KEY             TO  SV-PRIOR-KEY.
  3196
  3197
  3198
  3199* EXEC CICS HANDLE CONDITION
  3200*         NOTFND(4010-ENDBR)
  3201*         ENDFILE(4010-ENDBR)
  3202*    END-EXEC.
  3203*    MOVE '"$I''                  ! ( #00003001' TO DFHEIV0
  3204     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3206     MOVE X'2820233030303033303031' TO DFHEIV0(25:11)
  3207     CALL 'kxdfhei1' USING DFHEIV0
  3208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3209
  3210
  3211
  3212* EXEC CICS STARTBR
  3213*         DATASET(ERCNOT-FILE-ID)
  3214*         RIDFLD(ERCNOT-KEY)
  3215*         KEYLENGTH(ERCNOT-START-LENGTH)
  3216*         GENERIC
  3217*         GTEQ
  3218*    END-EXEC.
  3219     MOVE 0
  3220       TO DFHEIV11
  3221*    MOVE '&,   KG    G          &   #00003006' TO DFHEIV0
  3222     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3224     MOVE X'2020233030303033303036' TO DFHEIV0(25:11)
  3225     CALL 'kxdfhei1' USING DFHEIV0,
  3226           ERCNOT-FILE-ID,
  3227           ERCNOT-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL691.cbl
  3228           ERCNOT-START-LENGTH,
  3229           DFHEIV11,
  3230           DFHEIV99
  3231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3232
  3233
  3234 4001-LOOP.
  3235
  3236* EXEC CICS READNEXT
  3237*         SET(ADDRESS OF CERT-NOTE-FILE)
  3238*         DATASET(ERCNOT-FILE-ID)
  3239*         RIDFLD(ERCNOT-KEY)
  3240*    END-EXEC.
  3241     MOVE 0
  3242       TO DFHEIV11
  3243*    MOVE '&.S                   )   #00003015' TO DFHEIV0
  3244     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3245     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3246     MOVE X'2020233030303033303135' TO DFHEIV0(25:11)
  3247     CALL 'kxdfhei1' USING DFHEIV0,
  3248           ERCNOT-FILE-ID,
  3249           DFHEIV20,
  3250           DFHEIV99,
  3251           ERCNOT-KEY,
  3252           DFHEIV99,
  3253           DFHEIV11,
  3254           DFHEIV99,
  3255           DFHEIV99
  3256     SET ADDRESS OF CERT-NOTE-FILE TO
  3257         DFHEIV20
  3258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3259
  3260
  3261     IF CZ-COMPANY-CD NOT = SV-COMPANY-CD
  3262         GO TO 4010-ENDBR
  3263     END-IF.
  3264
  3265     IF (CZ-CARRIER = SV-CARRIER)
  3266        AND (CZ-GROUPING = SV-GROUPING)
  3267        AND (CZ-STATE = SV-STATE)
  3268        AND (CZ-ACCOUNT = SV-ACCOUNT)
  3269        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  3270        AND (CZ-CERT-NO = SV-CERT-NO)
  3271        AND (CZ-RECORD-TYPE = SV-REC-TYP)
  3272          MOVE CZ-NOTE-SEQUENCE TO SV-NOTE-SEQUENCE
  3273          GO TO 4001-LOOP
  3274     END-IF.
  3275
  3276 4010-ENDBR.
  3277
  3278
  3279* EXEC CICS ENDBR
  3280*         DATASET(ERCNOT-FILE-ID)
  3281*    END-EXEC.
  3282     MOVE 0
  3283       TO DFHEIV11
  3284*    MOVE '&2                    $   #00003038' TO DFHEIV0
  3285     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL691.cbl
  3286     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3287     MOVE X'2020233030303033303338' TO DFHEIV0(25:11)
  3288     CALL 'kxdfhei1' USING DFHEIV0,
  3289           ERCNOT-FILE-ID,
  3290           DFHEIV11,
  3291           DFHEIV99
  3292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3293
  3294
  3295     MOVE SV-PRIOR-KEY           TO  ERCNOT-KEY.
  3296     MOVE SPACES                 TO  CERT-NOTE-FILE.
  3297     ADD 1                       TO  ERCNOT-SEQ.
  3298     MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY.
  3299     MOVE  'CZ'                  TO  CZ-RECORD-ID.
  3300     MOVE W-CERT-NOTE-MSG        TO  CZ-NOTE.
  3301     MOVE PI-PROCESSOR-ID        TO  CZ-LAST-MAINT-USER.
  3302     MOVE W-SAVE-BIN-DATE        TO  CZ-LAST-MAINT-DT.
  3303     MOVE EIBTIME                TO  CZ-LAST-MAINT-HHMMSS.
  3304
  3305
  3306* EXEC CICS WRITE
  3307*         DATASET(ERCNOT-FILE-ID)
  3308*         FROM(CERT-NOTE-FILE)
  3309*         RIDFLD(ERCNOT-KEY)
  3310*         RESP(W-RESPONSE)
  3311*    END-EXEC.
  3312     MOVE LENGTH OF
  3313      CERT-NOTE-FILE
  3314       TO DFHEIV11
  3315*    MOVE '&$ L                  ''  N#00003052' TO DFHEIV0
  3316     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3317     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3318     MOVE X'204E233030303033303532' TO DFHEIV0(25:11)
  3319     CALL 'kxdfhei1' USING DFHEIV0,
  3320           ERCNOT-FILE-ID,
  3321           CERT-NOTE-FILE,
  3322           DFHEIV11,
  3323           ERCNOT-KEY,
  3324           DFHEIV99,
  3325           DFHEIV99
  3326     MOVE EIBRESP  TO W-RESPONSE
  3327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3328
  3329
  3330     IF RESP-NORMAL
  3331         PERFORM 4800-CERTIFICATE-UPDATE THRU 4899-EXIT
  3332     END-IF.
  3333
  3334 4099-EXIT.
  3335     EXIT.
  3336
  3337
  3338 4800-CERTIFICATE-UPDATE SECTION.
  3339
  3340
  3341* EXEC CICS HANDLE CONDITION
  3342*        NOTFND   (4899-EXIT)
  3343*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL691.cbl
  3344*    MOVE '"$I                   ! ) #00003069' TO DFHEIV0
  3345     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3347     MOVE X'2920233030303033303639' TO DFHEIV0(25:11)
  3348     CALL 'kxdfhei1' USING DFHEIV0
  3349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3350
  3351
  3352
  3353* EXEC CICS READ
  3354*    EQUAL
  3355*    DATASET   (ELCERT-FILE-ID)
  3356*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  3357*    RIDFLD    (ELCERT-KEY)
  3358*    UPDATE
  3359*    RESP      (W-RESPONSE)
  3360*    END-EXEC.
  3361*    MOVE '&"S        EU         (  N#00003073' TO DFHEIV0
  3362     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3363     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3364     MOVE X'204E233030303033303733' TO DFHEIV0(25:11)
  3365     CALL 'kxdfhei1' USING DFHEIV0,
  3366           ELCERT-FILE-ID,
  3367           DFHEIV20,
  3368           DFHEIV99,
  3369           ELCERT-KEY,
  3370           DFHEIV99,
  3371           DFHEIV99,
  3372           DFHEIV99
  3373     SET ADDRESS OF CERTIFICATE-MASTER TO
  3374         DFHEIV20
  3375     MOVE EIBRESP  TO W-RESPONSE
  3376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3377
  3378
  3379     IF RESP-NORMAL
  3380        IF CM-NOTE-SW = ' '
  3381           MOVE '1'        TO CM-NOTE-SW
  3382        ELSE
  3383           IF CM-NOTE-SW = '2'
  3384              MOVE '3'      TO CM-NOTE-SW
  3385           ELSE
  3386              IF CM-NOTE-SW = '4'
  3387                  MOVE '5'    TO CM-NOTE-SW
  3388              ELSE
  3389                 IF CM-NOTE-SW = '6'
  3390                    MOVE '7'  TO CM-NOTE-SW
  3391                 END-IF
  3392              END-IF
  3393           END-IF
  3394        END-IF
  3395
  3396* EXEC CICS REWRITE
  3397*          FROM      (CERTIFICATE-MASTER)
  3398*          DATASET   (ELCERT-FILE-ID)
  3399*       END-EXEC
  3400     MOVE LENGTH OF
  3401      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL691.cbl
  3402       TO DFHEIV11
  3403*    MOVE '&& L                  %   #00003098' TO DFHEIV0
  3404     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3405     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3406     MOVE X'2020233030303033303938' TO DFHEIV0(25:11)
  3407     CALL 'kxdfhei1' USING DFHEIV0,
  3408           ELCERT-FILE-ID,
  3409           CERTIFICATE-MASTER,
  3410           DFHEIV11,
  3411           DFHEIV99
  3412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3413     END-IF.
  3414
  3415 4899-EXIT.
  3416      EXIT.
  3417
  3418
  3419
  3420 8010-ARCH-NOT-OPEN.
  3421
  3422     MOVE ER-7388                TO EMI-ERROR.
  3423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3424     MOVE -1                     TO MAINTL.
  3425     GO TO 8200-SEND-DATAONLY.
  3426
  3427 8015-ARCT-NOT-OPEN.
  3428
  3429     MOVE ER-7373                TO EMI-ERROR.
  3430     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3431     MOVE -1                     TO MAINTL.
  3432     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL691.cbl
  3434
  3435 8100-SEND-INITIAL-MAP.
  3436
  3437     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  3438
  3439     IF  NOT EMI-NO-ERRORS
  3440         MOVE EMI-MESSAGE-AREA (1)
  3441                                 TO ERRMSG1O
  3442     ELSE
  3443         MOVE SPACES             TO ERRMSG1O
  3444     END-IF.
  3445
  3446
  3447* EXEC CICS SEND
  3448*        MAP    (W-MAP)
  3449*        MAPSET (W-MAPSET)
  3450*        FROM   (EL691AO)
  3451*        ERASE
  3452*        CURSOR
  3453*    END-EXEC.
  3454     MOVE LENGTH OF
  3455      EL691AO
  3456       TO DFHEIV12
  3457     MOVE -1
  3458       TO DFHEIV11
  3459*    MOVE '8$     CT  E    H L F ,   #00003135' TO DFHEIV0
  3460     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3461     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3462     MOVE X'2020233030303033313335' TO DFHEIV0(25:11)
  3463     CALL 'kxdfhei1' USING DFHEIV0,
  3464           W-MAP,
  3465           EL691AO,
  3466           DFHEIV12,
  3467           W-MAPSET,
  3468           DFHEIV99,
  3469           DFHEIV99,
  3470           DFHEIV99,
  3471           DFHEIV11,
  3472           DFHEIV99,
  3473           DFHEIV99,
  3474           DFHEIV99
  3475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3476
  3477
  3478     GO TO 9000-RETURN-TRANS.
  3479
  3480 8100-EXIT.
  3481     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL691.cbl
  3483
  3484 8200-SEND-DATAONLY.
  3485
  3486     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  3487
  3488     IF  NOT EMI-NO-ERRORS
  3489         MOVE EMI-MESSAGE-AREA (1)
  3490                                 TO ERRMSG1O
  3491     ELSE
  3492         MOVE SPACES             TO ERRMSG1O
  3493     END-IF.
  3494
  3495
  3496* EXEC CICS SEND
  3497*        MAP    (W-MAP)
  3498*        MAPSET (W-MAPSET)
  3499*        FROM   (EL691AO)
  3500*        DATAONLY
  3501*        CURSOR
  3502*    END-EXEC.
  3503     MOVE LENGTH OF
  3504      EL691AO
  3505       TO DFHEIV12
  3506     MOVE -1
  3507       TO DFHEIV11
  3508*    MOVE '8$D    CT       H L F ,   #00003160' TO DFHEIV0
  3509     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3510     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3511     MOVE X'2020233030303033313630' TO DFHEIV0(25:11)
  3512     CALL 'kxdfhei1' USING DFHEIV0,
  3513           W-MAP,
  3514           EL691AO,
  3515           DFHEIV12,
  3516           W-MAPSET,
  3517           DFHEIV99,
  3518           DFHEIV99,
  3519           DFHEIV99,
  3520           DFHEIV11,
  3521           DFHEIV99,
  3522           DFHEIV99,
  3523           DFHEIV99
  3524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3525
  3526
  3527     GO TO 9000-RETURN-TRANS.
  3528
  3529 8200-EXIT.
  3530     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL691.cbl
  3532
  3533 8300-SEND-TEXT.
  3534
  3535
  3536* EXEC CICS SEND TEXT
  3537*        FROM    (LOGOFF-TEXT)
  3538*        LENGTH  (LOGOFF-LENGTH)
  3539*        ERASE
  3540*        FREEKB
  3541*    END-EXEC.
  3542*    MOVE '8&      T  E F  H   F -   #00003176' TO DFHEIV0
  3543     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3544     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3545     MOVE X'2020233030303033313736' TO DFHEIV0(25:11)
  3546     CALL 'kxdfhei1' USING DFHEIV0,
  3547           LOGOFF-TEXT,
  3548           LOGOFF-LENGTH,
  3549           DFHEIV99,
  3550           DFHEIV99,
  3551           DFHEIV99,
  3552           DFHEIV99,
  3553           DFHEIV99,
  3554           DFHEIV99,
  3555           DFHEIV99,
  3556           DFHEIV99,
  3557           DFHEIV99,
  3558           DFHEIV99
  3559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3560
  3561
  3562     GO TO 9000-RETURN-TRANS.
  3563
  3564 8300-EXIT.
  3565     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL691.cbl
  3567
  3568 8600-DEEDIT.
  3569
  3570
  3571* EXEC CICS BIF DEEDIT
  3572*         FIELD    (W-DEEDIT-FIELD)
  3573*         LENGTH   (15)
  3574*    END-EXEC.
  3575     MOVE 15
  3576       TO DFHEIV11
  3577*    MOVE '@"L                   #   #00003191' TO DFHEIV0
  3578     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3579     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3580     MOVE X'2020233030303033313931' TO DFHEIV0(25:11)
  3581     CALL 'kxdfhei1' USING DFHEIV0,
  3582           W-DEEDIT-FIELD,
  3583           DFHEIV11
  3584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3585
  3586
  3587 8600-EXIT.
  3588     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL691.cbl
  3590
  3591 9000-RETURN-TRANS.
  3592
  3593     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  3594     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
  3595
  3596* EXEC CICS RETURN
  3597*        TRANSID    (W-TRANSACTION)
  3598*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3599*        LENGTH     (PI-COMM-LENGTH)
  3600*    END-EXEC.
  3601*    MOVE '.(CT                  &   #00003204' TO DFHEIV0
  3602     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3603     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3604     MOVE X'2020233030303033323034' TO DFHEIV0(25:11)
  3605     CALL 'kxdfhei1' USING DFHEIV0,
  3606           W-TRANSACTION,
  3607           PROGRAM-INTERFACE-BLOCK,
  3608           PI-COMM-LENGTH,
  3609           DFHEIV99,
  3610           DFHEIV99
  3611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3612
  3613
  3614 9000-EXIT.
  3615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL691.cbl
  3617
  3618 9200-PA.
  3619
  3620     MOVE ER-7008                TO EMI-ERROR.
  3621     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3622     MOVE -1                     TO MAINTL.
  3623     GO TO 8200-SEND-DATAONLY.
  3624
  3625 9200-EXIT.
  3626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL691.cbl
  3628
  3629 9300-DFHCLEAR.
  3630
  3631     MOVE PI-RETURN-TO-PROGRAM TO W-CALL-PGM.
  3632     GO TO 9400-XCTL.
  3633
  3634 9300-EXIT.
  3635     EXIT.
  3636
  3637 9400-XCTL.
  3638
  3639
  3640* EXEC CICS XCTL
  3641*        PROGRAM  (W-CALL-PGM)
  3642*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3643*        LENGTH   (PI-COMM-LENGTH)
  3644*    END-EXEC.
  3645*    MOVE '.$C                   $   #00003235' TO DFHEIV0
  3646     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3647     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3648     MOVE X'2020233030303033323335' TO DFHEIV0(25:11)
  3649     CALL 'kxdfhei1' USING DFHEIV0,
  3650           W-CALL-PGM,
  3651           PROGRAM-INTERFACE-BLOCK,
  3652           PI-COMM-LENGTH
  3653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3654
  3655
  3656 9400-EXIT.
  3657     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL691.cbl
  3659
  3660 9500-LINK-DATE-CONVERT.
  3661
  3662
  3663* EXEC CICS LINK
  3664*        PROGRAM    ('ELDATCV')
  3665*        COMMAREA   (DATE-CONVERSION-DATA)
  3666*        LENGTH     (DC-COMM-LENGTH)
  3667*    END-EXEC.
  3668     MOVE 'ELDATCV' TO DFHEIV1
  3669*    MOVE '."C                   ''   #00003247' TO DFHEIV0
  3670     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3672     MOVE X'2020233030303033323437' TO DFHEIV0(25:11)
  3673     CALL 'kxdfhei1' USING DFHEIV0,
  3674           DFHEIV1,
  3675           DATE-CONVERSION-DATA,
  3676           DC-COMM-LENGTH,
  3677           DFHEIV99,
  3678           DFHEIV99,
  3679           DFHEIV99
  3680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3681
  3682
  3683 9500-EXIT.
  3684     EXIT.
  3685
  3686 9600-FORMAT-DATE-TIME.
  3687
  3688     MOVE W-SAVE-DATE            TO RUNDTEO.
  3689     MOVE EIBTIME                TO W-TIME-IN.
  3690     MOVE W-TIME-OUT             TO RUNTIMEO.
  3691     MOVE PI-COMPANY-ID          TO COMPANYO.
  3692     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3693     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  3694
  3695     IF PI-ARCHIVE-COMPLETE = 'Y'
  3696        MOVE AL-SANOF           TO STCOMPA
  3697        MOVE AL-SADOF           TO STRECVA
  3698                                   STSTOPA
  3699                                   STFINLA
  3700     ELSE
  3701       IF PI-ARCHIVE-RECEIVED = 'Y'
  3702           MOVE AL-SANOF        TO STRECVA
  3703           MOVE AL-SADOF        TO STCOMPA
  3704                                   STSTOPA
  3705                                   STFINLA
  3706       ELSE
  3707         IF PI-ARCHIVE-STOPPED = 'Y'
  3708             MOVE AL-SANOF      TO STSTOPA
  3709             MOVE AL-SADOF      TO STCOMPA
  3710                                   STRECVA
  3711                                   STFINLA
  3712         ELSE
  3713           IF PI-ARCHIVE-FINAL = 'Y'
  3714               MOVE AL-SANOF    TO STFINLA
  3715               MOVE AL-SADOF    TO STCOMPA
  3716                                   STRECVA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL691.cbl
  3717                                   STSTOPA
  3718           ELSE
  3719               MOVE AL-SADOF    TO STCOMPA
  3720                                   STRECVA
  3721                                   STSTOPA
  3722                                   STFINLA
  3723           END-IF
  3724         END-IF
  3725       END-IF
  3726     END-IF.
  3727
  3728
  3729 9600-EXIT.
  3730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL691.cbl
  3732
  3733 9700-PGMID-ERROR.
  3734
  3735
  3736* EXEC CICS  HANDLE CONDITION
  3737*        PGMIDERR  (8300-SEND-TEXT)
  3738*    END-EXEC.
  3739*    MOVE '"$L                   ! * #00003305' TO DFHEIV0
  3740     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3742     MOVE X'2A20233030303033333035' TO DFHEIV0(25:11)
  3743     CALL 'kxdfhei1' USING DFHEIV0
  3744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3745
  3746
  3747     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  3748     MOVE ' '                    TO PI-ENTRY-CD-1.
  3749     MOVE W-XCTL-005             TO W-CALL-PGM
  3750                                    LOGOFF-PGM.
  3751     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3752
  3753     PERFORM 9400-XCTL THRU 9400-EXIT.
  3754
  3755 9700-EXIT.
  3756     EXIT.
  3757
  3758 9800-ABEND.
  3759
  3760     MOVE W-LINK-004             TO W-CALL-PGM.
  3761     MOVE DFHEIBLK               TO EMI-LINE1
  3762
  3763
  3764* EXEC CICS  LINK
  3765*        PROGRAM   (W-CALL-PGM)
  3766*        COMMAREA  (EMI-LINE1)
  3767*        LENGTH    (72)
  3768*    END-EXEC.
  3769     MOVE 72
  3770       TO DFHEIV11
  3771*    MOVE '."C                   ''   #00003325' TO DFHEIV0
  3772     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3773     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3774     MOVE X'2020233030303033333235' TO DFHEIV0(25:11)
  3775     CALL 'kxdfhei1' USING DFHEIV0,
  3776           W-CALL-PGM,
  3777           EMI-LINE1,
  3778           DFHEIV11,
  3779           DFHEIV99,
  3780           DFHEIV99,
  3781           DFHEIV99
  3782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3783
  3784
  3785     GO TO 8200-SEND-DATAONLY.
  3786
  3787 9800-EXIT.
  3788     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL691.cbl
  3790
  3791 9900-ERROR-FORMAT.
  3792
  3793     IF  EMI-ERROR EQUAL ER-9097
  3794         NEXT SENTENCE
  3795     ELSE
  3796         IF  EMI-ERRORS-COMPLETE
  3797                 OR
  3798             EMI-ERROR EQUAL W-LAST-ERROR
  3799             GO TO 9900-EXIT
  3800     END-IF.
  3801
  3802     ADD +1  TO  W-ERROR-COUNT.
  3803     MOVE W-LINK-001             TO W-CALL-PGM.
  3804
  3805
  3806* EXEC CICS LINK
  3807*        PROGRAM    (W-CALL-PGM)
  3808*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3809*        LENGTH     (EMI-COMM-LENGTH)
  3810*    END-EXEC.
  3811*    MOVE '."C                   ''   #00003351' TO DFHEIV0
  3812     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3813     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3814     MOVE X'2020233030303033333531' TO DFHEIV0(25:11)
  3815     CALL 'kxdfhei1' USING DFHEIV0,
  3816           W-CALL-PGM,
  3817           ERROR-MESSAGE-INTERFACE-BLOCK,
  3818           EMI-COMM-LENGTH,
  3819           DFHEIV99,
  3820           DFHEIV99,
  3821           DFHEIV99
  3822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3823
  3824
  3825     MOVE EMI-ERROR              TO W-LAST-ERROR.
  3826
  3827 9900-EXIT.
  3828     EXIT.
  3829
  3830 9905-INITIALIZE-SECURITY.
  3831******************************************************************
  3832*                                                                *
  3833*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  3834*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  3835*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  3836*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  3837*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  3838*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  3839*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  3840*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
  3841*                                                                *
  3842*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
  3843*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  3844*                                                                *
  3845******************************************************************
  3846
  3847     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL691.cbl
  3848         MOVE 'Y'                TO PI-DISPLAY-CAP
  3849                                    PI-MODIFY-CAP
  3850     ELSE
  3851
  3852* EXEC CICS READQ TS
  3853*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3854*            INTO   (SECURITY-CONTROL)
  3855*            LENGTH (SC-COMM-LENGTH)
  3856*            ITEM   (1)
  3857*        END-EXEC
  3858     MOVE 1
  3859       TO DFHEIV11
  3860*    MOVE '*$II   L              ''   #00003383' TO DFHEIV0
  3861     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3862     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3863     MOVE X'2020233030303033333833' TO DFHEIV0(25:11)
  3864     CALL 'kxdfhei1' USING DFHEIV0,
  3865           PI-SECURITY-TEMP-STORE-ID,
  3866           SECURITY-CONTROL,
  3867           SC-COMM-LENGTH,
  3868           DFHEIV11,
  3869           DFHEIV99,
  3870           DFHEIV99
  3871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3872         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  3873                                 TO PI-DISPLAY-CAP
  3874         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  3875                                 TO PI-MODIFY-CAP
  3876     END-IF.
  3877
  3878 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL691.cbl
  3880
  3881 9995-SECURITY-VIOLATION.
  3882
  3883     MOVE EIBDATE                TO SM-JUL-DATE.
  3884     MOVE EIBTRMID               TO SM-TERMID.
  3885     MOVE W-THIS-PGM             TO SM-PGM.
  3886     MOVE EIBTIME                TO W-TIME-IN.
  3887     MOVE W-TIME-OUT             TO SM-TIME.
  3888     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
  3889
  3890
  3891* EXEC CICS LINK
  3892*         PROGRAM  ('EL003')
  3893*         COMMAREA (SECURITY-MESSAGE)
  3894*         LENGTH   (80)
  3895*    END-EXEC.
  3896     MOVE 'EL003' TO DFHEIV1
  3897     MOVE 80
  3898       TO DFHEIV11
  3899*    MOVE '."C                   ''   #00003407' TO DFHEIV0
  3900     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3901     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3902     MOVE X'2020233030303033343037' TO DFHEIV0(25:11)
  3903     CALL 'kxdfhei1' USING DFHEIV0,
  3904           DFHEIV1,
  3905           SECURITY-MESSAGE,
  3906           DFHEIV11,
  3907           DFHEIV99,
  3908           DFHEIV99,
  3909           DFHEIV99
  3910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3911
  3912
  3913 9995-EXIT.
  3914     EXIT.
  3915
  3916 9999-GOBACK.
  3917
  3918
  3919* GOBACK.
  3920     MOVE '9%                    "   ' TO DFHEIV0
  3921     MOVE 'EL691' TO DFHEIV1
  3922     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3923     GOBACK.
  3924
  3925 9999-EXIT.
  3926     EXIT.
  3927
  3928 9999-DFHBACK SECTION.
  3929     MOVE '9%                    "   ' TO DFHEIV0
  3930     MOVE 'EL691' TO DFHEIV1
  3931     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3932     GOBACK.
  3933 9999-DFHEXIT.
  3934     IF DFHEIGDJ EQUAL 0001
  3935         NEXT SENTENCE
  3936     ELSE IF DFHEIGDJ EQUAL 2
  3937         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL691.cbl
  3938               9200-PA,
  3939               9200-PA,
  3940               9200-PA
  3941         DEPENDING ON DFHEIGDI
  3942     ELSE IF DFHEIGDJ EQUAL 3
  3943         GO TO 9700-PGMID-ERROR,
  3944               9800-ABEND
  3945         DEPENDING ON DFHEIGDI
  3946     ELSE IF DFHEIGDJ EQUAL 4
  3947         GO TO 8010-ARCH-NOT-OPEN,
  3948               1070-ARCH-NOT-FOUND,
  3949               1070-ARCH-NOT-FOUND
  3950         DEPENDING ON DFHEIGDI
  3951     ELSE IF DFHEIGDJ EQUAL 5
  3952         GO TO 8015-ARCT-NOT-OPEN,
  3953               1000-ARCT-NOT-FOUND,
  3954               1000-ARCT-NOT-FOUND
  3955         DEPENDING ON DFHEIGDI
  3956     ELSE IF DFHEIGDJ EQUAL 6
  3957         GO TO 8010-ARCH-NOT-OPEN,
  3958               1070-ARCH-NOT-FOUND,
  3959               1070-ARCH-NOT-FOUND
  3960         DEPENDING ON DFHEIGDI
  3961     ELSE IF DFHEIGDJ EQUAL 7
  3962         GO TO 3200-NOT-FOUND,
  3963               3200-NOT-FOUND
  3964         DEPENDING ON DFHEIGDI
  3965     ELSE IF DFHEIGDJ EQUAL 8
  3966         GO TO 4010-ENDBR,
  3967               4010-ENDBR
  3968         DEPENDING ON DFHEIGDI
  3969     ELSE IF DFHEIGDJ EQUAL 9
  3970         GO TO 4899-EXIT
  3971         DEPENDING ON DFHEIGDI
  3972     ELSE IF DFHEIGDJ EQUAL 10
  3973         GO TO 8300-SEND-TEXT
  3974         DEPENDING ON DFHEIGDI.
  3975     MOVE '9%                    "   ' TO DFHEIV0
  3976     MOVE 'EL691' TO DFHEIV1
  3977     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3978     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4784     Code:        9118
