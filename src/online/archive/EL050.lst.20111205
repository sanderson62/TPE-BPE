* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   117* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   118* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   119*-----------------------------------------------------------------
   120
   121 01  WORK-AREAS.
   122
   123*****************************************************************
   124*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   125*****************************************************************
   126
   127     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   128     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   129     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   130     12  WS-NAME-EDIT-WORK-AREA.
   131         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   132         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   133             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   134         16  WS-WORK-NAME.
   135             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   136             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   137             20  FILLER           PIC X(10)     VALUE SPACES.
   138         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   139             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   140
   141*****************************************************************
   142*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   143*****************************************************************
   144
   145     12  WS-ERRESC-KEY.
   146         16 WS-ERRESC-SEARCH-KEY.
   147             20  WS-ERRESC-COMPANY-CD PIC  X.
   148             20  WS-ERRESC-CARRIER    PIC  X.
   149             20  WS-ERRESC-GROUP      PIC X(6).
   150             20  WS-ERRESC-STATE      PIC XX.
   151             20  WS-ERRESC-ACCOUNT    PIC X(10).
   152         16 WS-ERRESC-RESIDUAL-KEY.
   153             20  WS-ERRESC-AGENT      PIC X(10).
   154             20  WS-ERRESC-RES-STATE  PIC XX.
   155             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   156*                                          YYYYMMDD
   157     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   158     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   159
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   5
* EL050.cbl
   160*RESIDENT STATE TAX MASTER(ERRESS)
   161*
   162     12  WS-ERRESS-KEY.
   163         16  WS-ERRESS-COMPANY-CD      PIC  X.
   164         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   165         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   166         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   167*                                          YYYYMMDD
   168
   169     12  WS-CONTRACT-DATE              PIC 9(8).
   170*                                          YYYYMMDD
   171     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   172     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   173         16 WS-YEAR-YY                 PIC   9999.
   174         16 FILLER                     PIC 9(4).
   175*                                          YYYYMMDD
   176     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   177     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   178     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   179     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   180
   181     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   182         88  DPRB-1ST-TIME                      VALUE ' '.
   183
   184*****************************************************************
   185*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   186*****************************************************************
   187
   188     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   189     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   190     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   191     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   192     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   193     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   194     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   195     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   196     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   197     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   198         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   199         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   200     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   201         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   202         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   203     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   204
   205     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   206     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   207
   208     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   209     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   212     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   213     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   214     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   6
* EL050.cbl
   218     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   221     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   222     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   223     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   244     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   245     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   246     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   247     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   256     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   257     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   258     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   259     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   260     12  WS-2671-SW               PIC X         VALUE SPACE.
   261     12  WS-2672-SW               PIC X         VALUE SPACE.
   262     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   263         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   264     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   265         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   266     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   267
   268     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   269         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   270         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   271         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   272         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   273
   274     12  WS-CREDIT-EDIT-CONTROLS.
   275         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   7
* EL050.cbl
   276         16  WS-MIN-AGE           PIC 99                VALUE  0.
   277         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   278         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   279         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   280         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   281
   282     12  WS-SAVE-ALLOWABLE-BENEFIT.
   283         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   284         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   285         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   286         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   287         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   288         16  FILLER                      PIC XX.
   289
   290     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   291     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   292     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   293     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   294     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   295     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   296     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   297     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   298     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   299     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   300
   301     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   302     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   303     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   304     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   305     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   306     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   307     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   308     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   309         88  WS-REDUCING              VALUE 'R'.
   310         88  WS-LEVEL                 VALUE 'L' 'P'.
   311     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   312
   313     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   314     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   315     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   316     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   317     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   318     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   319     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   320     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   321     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   322
   323     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   324     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   325     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   326     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   327     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   328     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   329     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   330     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   332     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   333     12  WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   8
* EL050.cbl
   334         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   335         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   336     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   337     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   338     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   341     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   342     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   343     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-INITIALS.
   345         16  WS-INIT-1            PIC X         VALUE SPACES.
   346         16  WS-INIT-2            PIC X         VALUE SPACES.
   347
   348     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   349     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   350     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   351     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   352     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   353*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   354     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   357     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   358     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   359     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   361     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   362     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   363     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   364     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   365     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   366     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   367     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   369     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   373     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   374     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376******** FLA
   377     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   380     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   381     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   382********
   383     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   384     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   385     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   386     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   387     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   388     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   389     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   390     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   391     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page   9
* EL050.cbl
   392     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   393
   394     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   395         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   396                                         '0' THRU '9'.
   397
   398     12  NUMBER-OF-MONTHS.
   399         16  SK-MO OCCURS 12 TIMES PIC X.
   400
   401     12  WS-WORK-DATE.
   402         16  WS-YEAR            PIC 99    VALUE 00.
   403         16  WS-MONTH           PIC 99    VALUE 00.
   404         16  WS-DAY             PIC 99    VALUE 00.
   405
   406     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   407     12  WS-WORK-CRIT-DEV       REDEFINES
   408         WS-WORK-LF-CRIT-PER    PIC X(03).
   409
   410     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   411     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   412
   413     12  WS-WORK-DATE-FROM.
   414         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   415         16  FILLER             PIC X  VALUE SPACE.
   416         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   417         16  FILLER             PIC X         VALUE SPACE.
   418         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   419
   420     12  WS-WORK-DATE-THRU.
   421         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   424         16  FILLER             PIC X         VALUE SPACE.
   425         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   426
   427     12  WS-LF-INPUT-CD.
   428         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   429         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   430
   431     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   432     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   433         16  WS-AH-INPUT-CD-1   PIC X.
   434         16  WS-AH-INPUT-CD-2-3 PIC XX.
   435
   436     12  WS-SWITCHES.
   437         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   438         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   439             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   440         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   441             88  BANK-ACCT-FOUND          VALUE 'Y'.
   442         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   443             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   444         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   445             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   446         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   447             88  COMP-MASTER-FOUND        VALUE 'Y'.
   448         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   449             88  LOFC-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  10
* EL050.cbl
   450         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   451             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   452         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   453             88  STAT-MASTER-FOUND        VALUE 'Y'.
   454         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   455             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   456         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   457             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   458         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   459             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   460         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   461             88  FORM-MASTER-FOUND        VALUE 'Y'.
   462         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   463             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   464         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   465             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   466         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   467             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   468         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   469             88  NO-BENEFIT-FOUND         VALUE 'N'.
   470         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   471             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   472         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   473             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   474         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   475             88  AH-BENEFIT-FOUND         VALUE ' '.
   476             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   477         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   478             88  LF-BENEFIT-FOUND         VALUE ' '.
   479             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   480         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   481             88  NO-STATE-RECORD          VALUE '1'.
   482         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   483             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   484         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   485             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   486         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   487             88  CERT-WAS-FOUND           VALUE ' '.
   488             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   489         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   490             88  BROWSE-STARTED           VALUE 'Y'.
   491         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   492             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   493         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   494             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   495         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   496             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   497         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   498             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   499         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   500             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   501         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   502             88  APP-CERT-USED            VALUE 'Y' 'A'.
   503         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   504             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   505             88  FIRST-TIME-THROUGH       VALUE '1'.
   506             88  CTBL-NOT-FOUND           VALUE '2'.
   507
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  11
* EL050.cbl
   508         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   509             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   510
   511         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   512             88  DLO-ERROR-FOUND          VALUE 'Y'.
   513
   514********FLA
   515     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   516     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   517********
   518     12  RC-SW-1                  PIC X           VALUE '0'.
   519     12  RC-SW-2                  PIC X           VALUE '0'.
   520     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   521     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   522     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   526     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   527     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   530     12  LIT-SPACES               PIC X           VALUE SPACES.
   531     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   532     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   533     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   534     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   535     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   536     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   537     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   538         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   539         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   540     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   541         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   542
   543 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   544     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   545     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   546 01  WS-CRI-SSN-WORK-AREA.
   547     05  WS-CRI-SOC-SEC-NO.
   548         10  WS-SS-REPT-CD       PIC X(5).
   549         10  WS-SS-LAST-NAME     PIC X(5).
   550         10  WS-SS-INITIAL       PIC X.
   551
   552     05  WS-CRI-REPORT-CODE.
   553         10  FILLER              PIC X(5).
   554         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   555
   556     05  WS-CRI-LAST-NAME.
   557         10  WS-CRI-NAME-MOVE    PIC X(5).
   558         10  FILLER              PIC X(10).
   559
   560 01  WS-NUM-TABLE                PIC X(26)  VALUE
   561     '12345678012345070923456789'.
   562 01  FILLER REDEFINES WS-NUM-TABLE.
   563     05  WS-NUM OCCURS 26        PIC 9.
   564 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   565 01  V1                          PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  12
* EL050.cbl
   566 01  V2                          PIC S999 COMP-3.
   567 01  V3                          PIC S999 COMP-3.
   568 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   569 01  FILLER REDEFINES WS-WORK-VIN.
   570     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   571 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   572 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   573 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   574 01  WS-HEX-WORK.
   575     05  FILLER                  PIC X  VALUE LOW-VALUES.
   576     05  WS-HEX-BYTE             PIC X.
   577 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   578 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   579 01  WS-WORK-HIN-ROW-B.
   580     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   581
   582 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   583 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   584     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   585 01  WS-ROW-D-TABLE.
   586     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   587
   588 01  WS-HIN-TABLE-B.
   589     05  F                       PIC XX VALUE 'A2'.
   590     05  F                       PIC XX VALUE 'B3'.
   591     05  F                       PIC XX VALUE 'C4'.
   592     05  F                       PIC XX VALUE 'D5'.
   593     05  F                       PIC XX VALUE 'E6'.
   594     05  F                       PIC XX VALUE 'F7'.
   595     05  F                       PIC XX VALUE 'G8'.
   596     05  F                       PIC XX VALUE 'H9'.
   597     05  F                       PIC XX VALUE 'I1'.
   598     05  F                       PIC XX VALUE 'J2'.
   599     05  F                       PIC XX VALUE 'K3'.
   600     05  F                       PIC XX VALUE 'L4'.
   601     05  F                       PIC XX VALUE 'M5'.
   602     05  F                       PIC XX VALUE 'N6'.
   603     05  F                       PIC XX VALUE 'O0'.
   604     05  F                       PIC XX VALUE 'P7'.
   605     05  F                       PIC XX VALUE 'Q0'.
   606     05  F                       PIC XX VALUE 'R8'.
   607     05  F                       PIC XX VALUE 'S9'.
   608     05  F                       PIC XX VALUE 'T2'.
   609     05  F                       PIC XX VALUE 'U3'.
   610     05  F                       PIC XX VALUE 'V4'.
   611     05  F                       PIC XX VALUE 'W5'.
   612     05  F                       PIC XX VALUE 'X6'.
   613     05  F                       PIC XX VALUE 'Y7'.
   614     05  F                       PIC XX VALUE 'Z8'.
   615 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   616     05  WS-VAL-IN               PIC X.
   617     05  WS-VAL-OUT              PIC 9.
   618 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   619 01  WS-COMPARE-BINARY-DATES.
   620     05  WS-971231                PIC XX VALUE X'92FF'.
   621     05  WS-931231                PIC XX VALUE X'8CFF'.
   622     05  WS-791231                PIC XX VALUE X'77FF'.
   623     05  WS-771001                PIC XX VALUE X'74A1'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  13
* EL050.cbl
   624     05  WS-820301                PIC XX VALUE X'7B41'.
   625     05  WS-831031                PIC XX VALUE X'7DBF'.
   626     05  WS-831231                PIC XX VALUE X'7DFF'.
   627     05  WS-810831                PIC XX VALUE X'7A7F'.
   628     05  WS-830901                PIC XX VALUE X'7D81'.
   629
   630 01  FILE-ACCESS-IDS.
   631     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   632     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   633     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   634     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   635     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   636     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   637     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   638     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   639     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   640     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   641     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   642     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   643     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   644     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   645     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   646     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   647     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   648 01  DD-IU-SW                    PIC X   VALUE ' '.
   649     88  DD-IU-PRESENT                 VALUE 'Y'.
   650
   651 01  ACCESS-KEYS.
   652     12  ELMSTR-KEY.
   653         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   654         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   655     12  W-CLAIM-KEY.
   656         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   657         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   658
   659     12  ELCNTL-KEY.
   660         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   661         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   662         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   663         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   664
   665     12  ELCERT-KEY.
   666         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   667         16  CERT-CARRIER         PIC X       VALUE SPACE.
   668         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   669         16  CERT-STATE           PIC XX      VALUE SPACES.
   670         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   671         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   672         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   673
   674     12  ELCERT2-KEY.
   675         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   676         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   677
   678     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   679
   680     12  ELCERT-SAVE.
   681         16  FILLER                      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  14
* EL050.cbl
   682
   683         16  WCS-CONTROL-PRIMARY.
   684             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   685             20  WCS-CARRIER             PIC X     VALUE SPACE.
   686             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   687             20  WCS-STATE               PIC XX    VALUE SPACES.
   688             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   689             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   690             20  WCS-CERT-NO.
   691                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   692                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   693
   694         16  CS-CONTROL-BY-NAME.
   695             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   696             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   697             20  CS-INSURED-INITIALS.
   698                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   699                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   700
   701         16  CS-CONTROL-BY-SSN.
   702             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   703             20  CS-SOC-SEC-NO.
   704                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   705                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   706                 24  CS-SSN-LN3.
   707                     28 CS-INSURED-INITIALS-A2   PIC XX
   708                                     VALUE SPACES.
   709                     28 CS-PART-LAST-NAME-A2     PIC X
   710                                     VALUE SPACE.
   711
   712         16  CS-CONTROL-BY-CERT-NO.
   713             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   714             20  CS-CERT-NO-A4           PIC X(11)
   715                                     VALUE SPACES.
   716
   717         16  CS-CONTROL-BY-MEMB.
   718             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   719             20  CS-MEMBER-NO.
   720                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   721                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   722                 24  CS-MEMB-LN4.
   723                     28 CS-INSURED-INITIALS-A5   PIC XX
   724                                      VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A5     PIC XX
   726                                      VALUE SPACES.
   727
   728         16  FILLER              PIC X(360) VALUE SPACES.
   729
   730     12  ERACCT-KEY.
   731         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   732         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   733         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   734         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   735         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   736         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   737
   738     12  ERCOMP-KEY.
   739         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  15
* EL050.cbl
   740         16  COMP-CARRIER         PIC X     VALUE SPACES.
   741         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   742         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   743         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   744         16  COMP-TYPE            PIC X     VALUE SPACES.
   745
   746     12  ERLOFC-KEY.
   747         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   749         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   750         16  LOFC-STATE           PIC XX    VALUE SPACES.
   751         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   753
   754     12  WS-ELCRTT-KEY.
   755         16  WS-ELCRTT-PRIMARY       PIC X(33).
   756         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   757
   758     12  ERBXRF-KEY.
   759         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   760         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   761         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   762         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   763
   764     12  ERAGTC-KEY.
   765         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   766         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   767         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   768         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   769         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   770         16  AGTC-TYPE            PIC X     VALUE SPACES.
   771
   772     12  ERPLAN-KEY.
   773         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   774         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   775         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   776         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   777         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   779         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   780         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   781
   782     12  ERFORM-KEY.
   783         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   784         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   785         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   786         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   787
   788     12  ERREIN-KEY.
   789         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  REIN-TYPE            PIC X     VALUE SPACES.
   791         16  REIN-TABLE-CO.
   792             20  REIN-CODE-1      PIC X     VALUE SPACE.
   793             20  REIN-CODE-2      PIC X     VALUE SPACE.
   794             20  REIN-CODE-3      PIC X     VALUE SPACE.
   795         16  FILLER               PIC X(3)  VALUE SPACES.
   796
   797     12  ERCTBL-KEY.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  16
* EL050.cbl
   798         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   800         16  CTBL-CNTRL-2.
   801             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   802             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   803
   804     12  WS-ACCESS.
   805         16  FILLER               PIC XX    VALUE SPACES.
   806         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   807
   808     12  WS-CARR-ACCESS.
   809         16  FILLER               PIC X(3)  VALUE SPACES.
   810         16  WS-CARR              PIC X     VALUE SPACE.
   811*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   812*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   813     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   814         88  WS-DMD-LF-RATING   VALUE 'Y'.
   815         88  WS-DMD-AH-RATING   VALUE 'Y'.
   816         88  WS-DMD-NO-RATING   VALUE 'N'.
   817
   818     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   819         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   820                                         'NJ' 'NL'
   821                                         'PJ' 'PL'
   822                                         'SJ' 'SL'.
   823     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   824         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   825                                         'NI' 'NJ' 'NL' 'NU'
   826                                         'PJ' 'PL' 'PI' 'PU'
   827                                         'SI' 'SJ' 'SL' 'SU'
   828                                         'MX' 'MY' 'MZ'.
   829 01  ERPDEF-KEY-SAVE             PIC X(18).
   830 01  ERPDEF-KEY.
   831     12  ERPDEF-COMPANY-CD       PIC X.
   832     12  ERPDEF-STATE            PIC XX.
   833     12  ERPDEF-PROD-CD          PIC XXX.
   834     12  F                       PIC X(7).
   835     12  ERPDEF-BEN-TYPE         PIC X.
   836     12  ERPDEF-BEN-CODE         PIC XX.
   837     12  ERPDEF-EXP-DT           PIC XX.
   838
   839 01  ELSTAT-KEY-SAVE             PIC X(20).
   840 01  ELSTAT-KEY.
   841     12  ELSTAT-COMPANY-ID       PIC XXX.
   842     12  ELSTAT-CARRIER          PIC X.
   843     12  ELSTAT-GROUP            PIC X(6).
   844     12  ELSTAT-STATE            PIC XX.
   845     12  ELSTAT-EXP-DT           PIC 9(8).
   846 01  WS-ERROR-VALUES.
   847     12  ER-1570                     PIC S9(4)   VALUE +1570.
   848     12  ER-1571                     PIC S9(4)   VALUE +1571.
   849     12  ER-1575                     PIC S9(4)   VALUE +1575.
   850     12  ER-1891                     PIC S9(4)   VALUE +1891.
   851     12  ER-1892                     PIC S9(4)   VALUE +1892.
   852     12  ER-1893                     PIC S9(4)   VALUE +1893.
   853     12  ER-1894                     PIC S9(4)   VALUE +1894.
   854     12  ER-1895                     PIC S9(4)   VALUE +1895.
   855     12  ER-1896                     PIC S9(4)   VALUE +1896.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  17
* EL050.cbl
   856     12  ER-1897                     PIC S9(4)   VALUE +1897.
   857     12  ER-1898                     PIC S9(4)   VALUE +1898.
   858     12  ER-1899                     PIC S9(4)   VALUE +1899.
   859     12  ER-1900                     PIC S9(4)   VALUE +1900.
   860     12  ER-1901                     PIC S9(4)   VALUE +1901.
   861     12  ER-1902                     PIC S9(4)   VALUE +1902.
   862     12  ER-1903                     PIC S9(4)   VALUE +1903.
   863     12  ER-1904                     PIC S9(4)   VALUE +1904.
   864     12  ER-1905                     PIC S9(4)   VALUE +1905.
   865     12  ER-1906                     PIC S9(4)   VALUE +1906.
   866     12  ER-1907                     PIC S9(4)   VALUE +1907.
   867     12  ER-1909                     PIC S9(4)   VALUE +1909.
   868     12  ER-1910                     PIC S9(4)   VALUE +1910.
   869     12  ER-1911                     PIC S9(4)   VALUE +1911.
   870     12  ER-1912                     PIC S9(4)   VALUE +1912.
   871     12  ER-1913                     PIC S9(4)   VALUE +1913.
   872     12  ER-1914                     PIC S9(4)   VALUE +1914.
   873     12  ER-1915                     PIC S9(4)   VALUE +1915.
   874     12  ER-1916                     PIC S9(4)   VALUE +1916.
   875     12  ER-1917                     PIC S9(4)   VALUE +1917.
   876     12  ER-1918                     PIC S9(4)   VALUE +1918.
   877     12  ER-1919                     PIC S9(4)   VALUE +1919.
   878     12  ER-1920                     PIC S9(4)   VALUE +1920.
   879     12  ER-1921                     PIC S9(4)   VALUE +1921.
   880     12  ER-1922                     PIC S9(4)   VALUE +1922.
   881     12  ER-1923                     PIC S9(4)   VALUE +1923.
   882     12  ER-1924                     PIC S9(4)   VALUE +1924.
   883     12  ER-1925                     PIC S9(4)   VALUE +1925.
   884     12  ER-1926                     PIC S9(4)   VALUE +1926.
   885     12  ER-1927                     PIC S9(4)   VALUE +1927.
   886     12  ER-2393                     PIC S9(4)   VALUE +2393.
   887     12  ER-2600                     PIC S9(4)   VALUE +2600.
   888     12  ER-2601                     PIC S9(4)   VALUE +2601.
   889     12  ER-2602                     PIC S9(4)   VALUE +2602.
   890     12  ER-2603                     PIC S9(4)   VALUE +2603.
   891     12  ER-2604                     PIC S9(4)   VALUE +2604.
   892     12  ER-2605                     PIC S9(4)   VALUE +2605.
   893     12  ER-2606                     PIC S9(4)   VALUE +2606.
   894     12  ER-2607                     PIC S9(4)   VALUE +2607.
   895     12  ER-2608                     PIC S9(4)   VALUE +2608.
   896     12  ER-2609                     PIC S9(4)   VALUE +2609.
   897     12  ER-2610                     PIC S9(4)   VALUE +2610.
   898     12  ER-2611                     PIC S9(4)   VALUE +2611.
   899     12  ER-2612                     PIC S9(4)   VALUE +2612.
   900     12  ER-2613                     PIC S9(4)   VALUE +2613.
   901     12  ER-2614                     PIC S9(4)   VALUE +2614.
   902     12  ER-2615                     PIC S9(4)   VALUE +2615.
   903     12  ER-2616                     PIC S9(4)   VALUE +2616.
   904     12  ER-2617                     PIC S9(4)   VALUE +2617.
   905     12  ER-2618                     PIC S9(4)   VALUE +2618.
   906     12  ER-2619                     PIC S9(4)   VALUE +2619.
   907     12  ER-2620                     PIC S9(4)   VALUE +2620.
   908     12  ER-2621                     PIC S9(4)   VALUE +2621.
   909     12  ER-2622                     PIC S9(4)   VALUE +2622.
   910     12  ER-2623                     PIC S9(4)   VALUE +2623.
   911     12  ER-2624                     PIC S9(4)   VALUE +2624.
   912     12  ER-2625                     PIC S9(4)   VALUE +2625.
   913     12  ER-2626                     PIC S9(4)   VALUE +2626.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  18
* EL050.cbl
   914     12  ER-2627                     PIC S9(4)   VALUE +2627.
   915     12  ER-2628                     PIC S9(4)   VALUE +2628.
   916     12  ER-2629                     PIC S9(4)   VALUE +2629.
   917     12  ER-2630                     PIC S9(4)   VALUE +2630.
   918     12  ER-2631                     PIC S9(4)   VALUE +2631.
   919     12  ER-2632                     PIC S9(4)   VALUE +2632.
   920     12  ER-2633                     PIC S9(4)   VALUE +2633.
   921     12  ER-2634                     PIC S9(4)   VALUE +2634.
   922     12  ER-2635                     PIC S9(4)   VALUE +2635.
   923     12  ER-2636                     PIC S9(4)   VALUE +2636.
   924     12  ER-2637                     PIC S9(4)   VALUE +2637.
   925     12  ER-2638                     PIC S9(4)   VALUE +2638.
   926     12  ER-2639                     PIC S9(4)   VALUE +2639.
   927     12  ER-2640                     PIC S9(4)   VALUE +2640.
   928     12  ER-2641                     PIC S9(4)   VALUE +2641.
   929     12  ER-2642                     PIC S9(4)   VALUE +2642.
   930     12  ER-2643                     PIC S9(4)   VALUE +2643.
   931     12  ER-2644                     PIC S9(4)   VALUE +2644.
   932     12  ER-2645                     PIC S9(4)   VALUE +2645.
   933     12  ER-2646                     PIC S9(4)   VALUE +2646.
   934     12  ER-2647                     PIC S9(4)   VALUE +2647.
   935     12  ER-2648                     PIC S9(4)   VALUE +2648.
   936     12  ER-2649                     PIC S9(4)   VALUE +2649.
   937     12  ER-2650                     PIC S9(4)   VALUE +2650.
   938     12  ER-2651                     PIC S9(4)   VALUE +2651.
   939     12  ER-2652                     PIC S9(4)   VALUE +2652.
   940     12  ER-2653                     PIC S9(4)   VALUE +2653.
   941     12  ER-2654                     PIC S9(4)   VALUE +2654.
   942     12  ER-2655                     PIC S9(4)   VALUE +2655.
   943     12  ER-2656                     PIC S9(4)   VALUE +2656.
   944     12  ER-2657                     PIC S9(4)   VALUE +2657.
   945     12  ER-2658                     PIC S9(4)   VALUE +2658.
   946     12  ER-2659                     PIC S9(4)   VALUE +2659.
   947     12  ER-2660                     PIC S9(4)   VALUE +2660.
   948     12  ER-2661                     PIC S9(4)   VALUE +2661.
   949     12  ER-2662                     PIC S9(4)   VALUE +2662.
   950     12  ER-2663                     PIC S9(4)   VALUE +2663.
   951     12  ER-2664                     PIC S9(4)   VALUE +2664.
   952     12  ER-2665                     PIC S9(4)   VALUE +2665.
   953     12  ER-2666                     PIC S9(4)   VALUE +2666.
   954     12  ER-2667                     PIC S9(4)   VALUE +2667.
   955     12  ER-2668                     PIC S9(4)   VALUE +2668.
   956     12  ER-2669                     PIC S9(4)   VALUE +2669.
   957     12  ER-2670                     PIC S9(4)   VALUE +2670.
   958     12  ER-2671                     PIC S9(4)   VALUE +2671.
   959     12  ER-2672                     PIC S9(4)   VALUE +2672.
   960     12  ER-2673                     PIC S9(4)   VALUE +2673.
   961     12  ER-2674                     PIC S9(4)   VALUE +2674.
   962     12  ER-2675                     PIC S9(4)   VALUE +2675.
   963     12  ER-2676                     PIC S9(4)   VALUE +2676.
   964     12  ER-2677                     PIC S9(4)   VALUE +2677.
   965     12  ER-2678                     PIC S9(4)   VALUE +2678.
   966     12  ER-2679                     PIC S9(4)   VALUE +2679.
   967     12  ER-2680                     PIC S9(4)   VALUE +2680.
   968     12  ER-2681                     PIC S9(4)   VALUE +2681.
   969     12  ER-2682                     PIC S9(4)   VALUE +2682.
   970     12  ER-2683                     PIC S9(4)   VALUE +2683.
   971     12  ER-2684                     PIC S9(4)   VALUE +2684.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  19
* EL050.cbl
   972     12  ER-2685                     PIC S9(4)   VALUE +2685.
   973     12  ER-2686                     PIC S9(4)   VALUE +2686.
   974     12  ER-2687                     PIC S9(4)   VALUE +2687.
   975     12  ER-2688                     PIC S9(4)   VALUE +2688.
   976     12  ER-2689                     PIC S9(4)   VALUE +2689.
   977     12  ER-2690                     PIC S9(4)   VALUE +2690.
   978     12  ER-2691                     PIC S9(4)   VALUE +2691.
   979     12  ER-2692                     PIC S9(4)   VALUE +2692.
   980     12  ER-2693                     PIC S9(4)   VALUE +2693.
   981     12  ER-2694                     PIC S9(4)   VALUE +2694.
   982     12  ER-2695                     PIC S9(4)   VALUE +2695.
   983     12  ER-2696                     PIC S9(4)   VALUE +2696.
   984     12  ER-2697                     PIC S9(4)   VALUE +2697.
   985     12  ER-2698                     PIC S9(4)   VALUE +2698.
   986     12  ER-2699                     PIC S9(4)   VALUE +2699.
   987     12  ER-2700                     PIC S9(4)   VALUE +2700.
   988     12  ER-2701                     PIC S9(4)   VALUE +2701.
   989     12  ER-2702                     PIC S9(4)   VALUE +2702.
   990     12  ER-2703                     PIC S9(4)   VALUE +2703.
   991     12  ER-2704                     PIC S9(4)   VALUE +2704.
   992     12  ER-2707                     PIC S9(4)   VALUE +2707.
   993     12  ER-2720                     PIC S9(4)   VALUE +2720.
   994     12  ER-2709                     PIC S9(4)   VALUE +2709.
   995     12  ER-2717                     PIC S9(4)   VALUE +2717.
   996     12  ER-2718                     PIC S9(4)   VALUE +2718.
   997     12  ER-2719                     PIC S9(4)   VALUE +2719.
   998     12  ER-2721                     PIC S9(4)   VALUE +2721.
   999     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1000     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1001     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1002     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1003     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1004     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1005     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1006     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1007     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1008     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1009     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1010     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1011     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1012     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1013     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1014     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1015     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1016     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1017     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1018     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1019     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1020     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1021     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1022     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1023     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1024     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1025     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1026     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1027     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1028     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1029     12  ER-2752                     PIC S9(4)   VALUE +2752.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  20
* EL050.cbl
  1030     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1031     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1032     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1033     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1034     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1035     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1036     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1037     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1038     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1039     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1040     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1041     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1042     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1043     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1044     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1045     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1046     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1047     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1048     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1049     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1050     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1051     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1052     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1053     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1054     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1055     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1056     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1057     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1058     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1059     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1060     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1061     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1062     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1063     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1064     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1065     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1066     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1067     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1068     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1069     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1070     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1071     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1072     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1073     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1074     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1075     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1076     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1077     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1078     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1079     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1080     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1081     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1082     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1083     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1084     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1085     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1086     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1087     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  21
* EL050.cbl
  1088     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1089     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1090     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1091     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1092     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1093     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1094     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1095     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1096     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1097     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1098     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1099     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1100     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1101     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1102     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1103     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1104     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1105     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1106     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1107     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1108     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1109     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1110     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1111     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1112     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1113     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1114     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1115     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1116     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1117     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1118     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1119     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1120     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1121     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1122     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1123     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1124     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1125     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1126     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1127     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1128     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1129     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1130     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1131     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1132     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1133     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1134     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1135     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1136     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1137     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1138     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1139     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1140     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1141     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1142     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1143     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1144     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1145     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  22
* EL050.cbl
  1146     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1147     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1148     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1149     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1150     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1151     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1152     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1153     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1154     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1155     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1156     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1157     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1158     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1159     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1160     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1161     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1162     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1163     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1164     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1165     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1166     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1167     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1168     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1169     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1170     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1171     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1172     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1173     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1174     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1175     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1176     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1177     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1178     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1179     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1180     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1181     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1182     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1183     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1184     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1185     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1186     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1187******************************************************************
  1188***************   END OF ELC50WS     ****************************
  1189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  23
* EL050.cbl
  1192 01  WORKING-STORAGE-WORK-AREAS.
  1193     12  WS-RESPONSE             PIC S9(8)  COMP.
  1194         88  WS-RESP-NORMAL           VALUE +00.
  1195         88  WS-RESP-ERROR            VALUE +01.
  1196         88  WS-RESP-NOTFND           VALUE +13.
  1197         88  WS-RESP-DUPREC           VALUE +14.
  1198         88  WS-RESP-ENDFILE          VALUE +20.
  1199     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1200     12  WORK-AREAS.
  1201         16  WK-CONV-GREG.
  1202             24  WCG-CENT             PIC XX.
  1203             24  WCG-REST             PIC X(4).
  1204         16  WORK-GREGORIAN-DATE.
  1205             24  WK-GREG-CENT         PIC XX.
  1206             24  WK-GREG-DATE-YYMMDD.
  1207                 28  WK-GREG-YYMM     PIC X(4).
  1208                 28  WK-GREG-DD       PIC XX.
  1209
  1210         16  WORK-SELECT-DATE.
  1211             24  WK-SELECT-CENT            PIC XX.
  1212             24  WK-SELECT-DATE-YYMMDD.
  1213                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1214                 28  FILLER                PIC XX.
  1215
  1216         16  WK-FORM-NO.
  1217             24  WK-FORM-BANK-ID       PIC X(5).
  1218             24  WK-FORM-UNDRWRTR      PIC X(1).
  1219             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1220
  1221         16  WK-MEMBER-NO.
  1222             24  WK-MEMBER-1-6        PIC X(6).
  1223             24  WK-MEMBER-7-12       PIC X(6).
  1224
  1225         16  WK-FULL-CERT-NO.
  1226             24  WK-CERT-POS-1-2      PIC X(2).
  1227             24  WK-CERT-POS-3        PIC X(1).
  1228             24  WK-CERT-POS-4        PIC X(1).
  1229             24  WK-CERT-POS-5-6      PIC X(2).
  1230             24  WK-CERT-POS-7        PIC X(1).
  1231             24  WK-CERT-POS-8-11     PIC X(4).
  1232
  1233         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1234             88  VALID-RATE-CODE        VALUE 'Y'.
  1235             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1236
  1237         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1238         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1239         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1240         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1241         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1242         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1243         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1244         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1245         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1246         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1247
  1248* DLO001
  1249 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  24
* EL050.cbl
  1250     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1251     12  DMPF-RETURN-CODE          PIC XX.
  1252         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1253         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1254         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1255         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1256         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1257         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1258
  1259* DLO002
  1260 01  WS-DLO-INTERNAL-POLICY-FORM.
  1261     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1262     12  DIPF-RETURN-CODE          PIC XX.
  1263         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1264         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1265         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1266         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1267         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1268         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1269
  1270* DLO003
  1271 01  WS-DLO-VALID-BANK-ID.
  1272     12  DVBI-BANK-ID              PIC X(5).
  1273     12  DVBI-BANK-ID-TYPE         PIC X.
  1274         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1275         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1276         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1277         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1278         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1279     12  DVBI-RETURN-CODE          PIC XX.
  1280         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1281         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1282         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1283         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1284         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1285         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1286         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1287         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1288         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1289
  1290* DLO007
  1291 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1292     12  DCUA-RES-STATE            PIC XX.
  1293     12  DCUA-BEN-TYPE             PIC XX.
  1294     12  DCUA-SYS-IDENT            PIC X.
  1295         88  DCUA-CLAIM                        VALUE 'C'.
  1296         88  DCUA-PREMIUM                      VALUE 'P'.
  1297     12  DCUA-COVERAGE-RULE        PIC X.
  1298     12  DCUA-CLIENT-ID            PIC X(10).
  1299     12  DCUA-EFF-DATE             PIC X(8).
  1300     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1301     12  DCUA-RETURN-CODE          PIC XX.
  1302         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1303     12  DCUA-CERT-NUMBER          PIC X(11).
  1304     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1305     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1306
  1307* DLO011
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  25
* EL050.cbl
  1308 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1309     12  DPRB-RATE-CODE            PIC X(4).
  1310     12  DPRB-COVERAGE-CATEG       PIC X.
  1311     12  DPRB-RETURN-CODE          PIC XX.
  1312         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1313         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1314         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1315         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1316         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1317         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1318         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1319         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1320         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1321     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1322     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1323     12  DPRB-BEN-TYPE             PIC XX.
  1324
  1325* DLO017
  1326 01  WS-DLO-VALID-RATE-CODE.
  1327     12  DVRC-RATE-CODE            PIC X(4).
  1328     12  DVRC-RETURN-CODE          PIC XX.
  1329         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1330         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1331         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1332         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1333         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1334         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1335
  1336* DLO019
  1337 01  WS-DLO-ORIG-COV-CAT.
  1338     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1339     12  DOCC-RETURN-CODE          PIC XX.
  1340     12  DOCC-ORIG-COV-CAT         PIC X.
  1341     12  DOCC-UNDERWITER           PIC XX.
  1342     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1343     12  DOCC-FILLER               PIC X(6).
  1344
  1345* DLO021
  1346 01  WS-DLO-VALID-LOAN-OFFICER.
  1347     12  DVLO-LOAN-OFFICER.
  1348         16  DVLO-BILL-TYPE        PIC X.
  1349         16  DVLO-BILL-SOURCE      PIC X.
  1350         16  DVLO-BATCH-TYPE       PIC X.
  1351     12  DVLO-RETURN-CODE          PIC XX.
  1352         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1353         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1354         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1355         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1356         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1357         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1358
  1359* DLO022
  1360 01  WS-DLO-VALID-STATE-CODE.
  1361     12  DVSC-STATE-CODE           PIC XX.
  1362     12  DVSC-RETURN-CODE          PIC XX.
  1363         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1364
  1365* DLO023
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  26
* EL050.cbl
  1366 01  WS-DLO-VALID-CODE-VALUES.
  1367     12  DVCV-SYSTEM-ID            PIC XX.
  1368         88  DVCV-CLAIMS                       VALUE 'CL'.
  1369         88  DVCV-CREDIT                       VALUE 'CR'.
  1370     12  DVCV-RECORD-TYPE          PIC XX.
  1371         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1372         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1373         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1374         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1375         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1376         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1377         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1378         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1379     12  DVCV-RECORD-KEY           PIC X(6).
  1380     12  DVCV-RETURN-CODE          PIC XX.
  1381         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1383         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1384         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1385         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1386         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1387         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1388     12  DVCV-CODE-DESC            PIC X(60).
  1389     12  DVCV-GEN-DESC-1           PIC X(20).
  1390     12  DVCV-GEN-DESC-2           PIC X(20).
  1391     12  DVCV-GEN-DESC-3           PIC X(20).
  1392
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  27
* EL050.cbl
  1394*    COPY ERCBXRF.
  1395******************************************************************
  1396*                                                                *
  1397*                                                                *
  1398*                            ERCBXRF                             *
  1399*                                                                *
  1400*   ONLINE CREDIT SYSTEM                                         *
  1401*                                                                *
  1402*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1403*                                                                *
  1404*   FILE TYPE = VSAM,KSDS                                        *
  1405*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1406*                                                                *
  1407*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1408*       ALTERNATE PATH = NONE                                    *
  1409*                                                                *
  1410*   LOG = NO                                                     *
  1411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1412*                                                                *
  1413******************************************************************
  1414
  1415 01  BANK-CROSS-REFERENCE.
  1416     12  BK-RECORD-ID                PIC XX.
  1417         88  VALID-BK-ID             VALUE 'BK'.
  1418
  1419     12  BK-CONTROL-PRIMARY.
  1420         16  BK-COMPANY-CD           PIC X.
  1421         16  BK-CARRIER              PIC X.
  1422         16  BK-GROUPING             PIC X(6).
  1423         16  BK-BANK-NO              PIC X(10).
  1424
  1425     12  BK-MAINT-INFORMATION.
  1426         16  BK-LAST-MAINT-DT        PIC XX.
  1427         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1428         16  BK-LAST-MAINT-USER      PIC X(4).
  1429         16  FILLER                  PIC X(9).
  1430
  1431     12  FILLER                      PIC X(37).
  1432
  1433     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1434
  1435     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1436                            DEPENDING ON BK-BANK-POINTER-CNT.
  1437         16  BK-AM-ACCOUNT           PIC X(10).
  1438         16  BK-AM-EXP-DT            PIC XX.
  1439         16  BK-AM-EFF-DT            PIC XX.
  1440         16  BK-AM-STATE             PIC XX.
  1441         16  FILLER                  PIC X(20).
  1442
  1443******************************************************************
  1444
  1445*    COPY ERCCOMP.
  1446******************************************************************
  1447*                                                                *
  1448*                                                                *
  1449*                            ERCCOMP                             *
  1450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1451*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  28
* EL050.cbl
  1452*                                                                *
  1453*   ONLINE CREDIT SYSTEM                                         *
  1454*                                                                *
  1455*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1456*                                                                *
  1457*   FILE TYPE = VSAM,KSDS                                        *
  1458*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1459*                                                                *
  1460*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1461*       ALTERNATE PATH = NONE                                    *
  1462*                                                                *
  1463*   LOG = NO                                                     *
  1464*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1465*                                                                *
  1466******************************************************************
  1467*                   C H A N G E   L O G
  1468*
  1469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1470*-----------------------------------------------------------------
  1471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1472* EFFECTIVE    NUMBER
  1473*-----------------------------------------------------------------
  1474* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1475* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1476* 092205    2005050300006  PEMA  ADD LEASE FEE
  1477* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1478* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1479* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1480* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1481* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1482******************************************************************
  1483
  1484 01  COMPENSATION-MASTER.
  1485     12  CO-RECORD-ID                          PIC XX.
  1486         88  VALID-CO-ID                          VALUE 'CO'.
  1487
  1488     12  CO-CONTROL-PRIMARY.
  1489         16  CO-COMPANY-CD                     PIC X.
  1490         16  CO-CONTROL.
  1491             20  CO-CTL-1.
  1492                 24  CO-CARR-GROUP.
  1493                     28  CO-CARRIER            PIC X.
  1494                     28  CO-GROUPING.
  1495                         32  CO-GROUP-PREFIX   PIC XXX.
  1496                         32  CO-GROUP-PRIME    PIC XXX.
  1497                 24  CO-RESP-NO.
  1498                     28  CO-RESP-PREFIX        PIC X(4).
  1499                     28  CO-RESP-PRIME         PIC X(6).
  1500             20  CO-CTL-2.
  1501                 24  CO-ACCOUNT.
  1502                     28  CO-ACCT-PREFIX        PIC X(4).
  1503                     28  CO-ACCT-PRIME         PIC X(6).
  1504         16  CO-TYPE                           PIC X.
  1505             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1506             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1507             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1508
  1509     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  29
* EL050.cbl
  1510         16  CO-LAST-MAINT-DT                  PIC XX.
  1511         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1512         16  CO-LAST-MAINT-USER                PIC X(4).
  1513     12  FILLER                                PIC XX.
  1514     12  CO-STMT-TYPE                          PIC XXX.
  1515     12  CO-COMP-TYPE                          PIC X.
  1516         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1517     12  CO-STMT-OWNER                         PIC X(4).
  1518     12  CO-BALANCE-CONTROL                    PIC X.
  1519         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1520         88  CO-NO-BALANCE                        VALUE 'N'.
  1521
  1522     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1523         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1524         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1525         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1526
  1527     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1528         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1529         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1530
  1531     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1532     12  CO-GA-DIRECT-DEP                      PIC X.
  1533     12  CO-FUTURE-SPACE                       PIC X.
  1534         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1535
  1536     12  CO-ACCT-NAME                          PIC X(30).
  1537     12  CO-MAIL-NAME                          PIC X(30).
  1538     12  CO-ADDR-1                             PIC X(30).
  1539     12  CO-ADDR-2                             PIC X(30).
  1540     12  CO-ADDR-3.
  1541         16  CO-ADDR-CITY                      PIC X(27).
  1542         16  CO-ADDR-STATE                     PIC XX.
  1543     12  CO-CSO-1099                           PIC X.
  1544     12  CO-ZIP.
  1545         16  CO-ZIP-PRIME.
  1546             20  CO-ZIP-PRI-1ST                PIC X.
  1547                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1548             20  FILLER                        PIC X(4).
  1549         16  CO-ZIP-PLUS4                      PIC X(4).
  1550     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1551         16  CO-CAN-POSTAL-1                   PIC XXX.
  1552         16  CO-CAN-POSTAL-2                   PIC XXX.
  1553         16  FILLER                            PIC XXX.
  1554     12  CO-SOC-SEC                            PIC X(13).
  1555     12  CO-TELEPHONE.
  1556         16  CO-AREA-CODE                      PIC XXX.
  1557         16  CO-PREFIX                         PIC XXX.
  1558         16  CO-PHONE                          PIC X(4).
  1559
  1560     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1561
  1562     12  CO-AR-BAL-LEVEL                       PIC X.
  1563         88  CO-AR-REF-LVL                        VALUE '1'.
  1564         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1565         88  CO-AR-BILL-LVL                       VALUE '2'.
  1566         88  CO-AR-AGT-LVL                        VALUE '3'.
  1567         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  30
* EL050.cbl
  1568
  1569     12  CO-AR-NORMAL-PRINT                    PIC X.
  1570         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1571         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1572
  1573     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1574
  1575     12  CO-AR-REPORTING                       PIC X.
  1576         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1577         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1578
  1579     12  CO-AR-PULL-CHECK                      PIC X.
  1580         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1581         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1582
  1583     12  CO-AR-BALANCE-PRINT                   PIC X.
  1584         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1585
  1586     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1587         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1588         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1589         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1590
  1591     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1592
  1593     12  CO-USER-CODE                          PIC X.
  1594     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1595
  1596******************************************************************
  1597*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1598*    THE LAST MONTH END RUN.
  1599******************************************************************
  1600
  1601     12  CO-LAST-ACTIVITY-DATE.
  1602         16  CO-ACT-YEAR                       PIC 99.
  1603         16  CO-ACT-MONTH                      PIC 99.
  1604         16  CO-ACT-DAY                        PIC 99.
  1605
  1606     12  CO-LAST-STMT-DT.
  1607         16  CO-LAST-STMT-YEAR                 PIC 99.
  1608         16  CO-LAST-STMT-MONTH                PIC 99.
  1609         16  CO-LAST-STMT-DAY                  PIC 99.
  1610
  1611     12  CO-MO-END-TOTALS.
  1612         16  CO-MONTHLY-TOTALS.
  1613             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1614             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1615             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1616             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1617             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1618
  1619         16  CO-AGING-TOTALS.
  1620             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1621             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1622             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1623             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1624
  1625         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  31
* EL050.cbl
  1626             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1627             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1628
  1629         16  CO-OVER-UNDER-TOTALS.
  1630             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1631             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1632
  1633     12  CO-MISCELLANEOUS-TOTALS.
  1634         16  CO-FICA-TOTALS.
  1635             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1636             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1637
  1638         16  CO-CLAIM-TOTALS.
  1639             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1640             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1641
  1642******************************************************************
  1643*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1644*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1645******************************************************************
  1646
  1647     12  CO-CURRENT-TOTALS.
  1648         16  CO-CURRENT-LAST-STMT-DT.
  1649             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1650             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1651             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1652
  1653         16  CO-CURRENT-MONTHLY-TOTALS.
  1654             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1657             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1658             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1659
  1660         16  CO-CURRENT-AGING-TOTALS.
  1661             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1662             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1663             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1664             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-CURRENT-YTD-TOTALS.
  1667             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1668             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1669
  1670     12  CO-PAID-COMM-TOTALS.
  1671         16  CO-YTD-PAID-COMMS.
  1672             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1673             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1674
  1675     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1676         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1677         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1678
  1679     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1680         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1681         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1682         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1683         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  32
* EL050.cbl
  1684         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1685         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1686         88  CO-FINAL-LETTER                  VALUE 'F'.
  1687         88  CO-RECONCILING                   VALUE 'R'.
  1688         88  CO-PHONE-CALL                    VALUE 'P'.
  1689         88  CO-LEGAL                         VALUE 'L'.
  1690         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1691         88  CO-WRITE-OFF                     VALUE 'W'.
  1692         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1693
  1694     12  CO-CSR-CODE                       PIC X(4).
  1695
  1696     12  CO-GA-STATUS-INFO.
  1697         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1698         16  CO-GA-TERMINATION-DT          PIC XX.
  1699         16  CO-GA-STATUS-CODE             PIC X.
  1700             88  CO-GA-ACTIVE                 VALUE 'A'.
  1701             88  CO-GA-INACTIVE               VALUE 'I'.
  1702             88  CO-GA-PENDING                VALUE 'P'.
  1703         16  CO-GA-COMMENTS.
  1704             20  CO-GA-COMMENT-1           PIC X(40).
  1705             20  CO-GA-COMMENT-2           PIC X(40).
  1706             20  CO-GA-COMMENT-3           PIC X(40).
  1707             20  CO-GA-COMMENT-4           PIC X(40).
  1708
  1709     12  CO-RPTCD2                         PIC X(10).
  1710
  1711     12  CO-TYPE-AGENT                     PIC X(01).
  1712         88  CO-CORPORATION                   VALUE 'C'.
  1713         88  CO-PARTNERSHIP                   VALUE 'P'.
  1714         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1715         88  CO-TRUST                         VALUE 'T'.
  1716         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1717
  1718     12  CO-FAXNO.
  1719         16  CO-FAX-AREA-CODE                  PIC XXX.
  1720         16  CO-FAX-PREFIX                     PIC XXX.
  1721         16  CO-FAX-PHONE                      PIC X(4).
  1722
  1723     12  CO-BANK-INFORMATION.
  1724         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1725         16  CO-BANK-TRANSIT-NON REDEFINES
  1726             CO-BANK-TRANSIT-NO                PIC 9(8).
  1727
  1728         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1729     12  CO-MISC-DEDUCT-INFO REDEFINES
  1730                  CO-BANK-INFORMATION.
  1731         16  CO-MD-GL-ACCT                     PIC X(10).
  1732         16  CO-MD-DIV                         PIC XX.
  1733         16  CO-MD-CENTER                      PIC X(4).
  1734         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1735         16  CO-CREATE-AP-CHECK                PIC X.
  1736         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1737         16  FILLER                            PIC XXX.
  1738     12  CO-ACH-STATUS                         PIC X.
  1739         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1740         88  CO-ACH-PENDING                        VALUE 'P'.
  1741
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  33
* EL050.cbl
  1742     12  CO-BILL-SW                            PIC X.
  1743     12  CO-CONTROL-NAME                       PIC X(30).
  1744     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1745     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1746     12  CO-CLP-STATE                          PIC XX.
  1747     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1748     12  CO-SPP-REFUND-EDIT                    PIC X.
  1749
  1750******************************************************************
  1751
  1752*    COPY ERCAGTC.
  1753******************************************************************
  1754*                                                                *
  1755*                                                                *
  1756*                            ERCAGTC                             *
  1757*                            VMOD=2.001                          *
  1758*                                                                *
  1759*   ONLINE CREDIT SYSTEM                                         *
  1760*                                                                *
  1761*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1762*                                                                *
  1763*   FILE TYPE = VSAM,KSDS                                        *
  1764*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1765*                                                                *
  1766*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1767*       ALTERNATE PATH = NONE                                    *
  1768*                                                                *
  1769*   LOG = NO                                                     *
  1770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1771*                                                                *
  1772******************************************************************
  1773*                   C H A N G E   L O G
  1774*
  1775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1776*-----------------------------------------------------------------
  1777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1778* EFFECTIVE    NUMBER
  1779*-----------------------------------------------------------------
  1780* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1781* 111004                         NEW FILE AND COPYBOOK
  1782* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1783******************************************************************
  1784 01  AGENT-COMMISSIONS.
  1785     12  AG-RECORD-ID                          PIC XX.
  1786         88  VALID-CO-ID                          VALUE 'AG'.
  1787     12  AG-CONTROL-PRIMARY.
  1788         16  AG-COMPANY-CD                     PIC X.
  1789         16  AG-CONTROL.
  1790             20  AG-CTL-1.
  1791                 24  AG-CARR-GROUP.
  1792                     28  AG-CARRIER            PIC X.
  1793                     28  AG-GROUPING           PIC X(6).
  1794                 24  AG-BANK                   PIC X(10).
  1795             20  AG-CTL-2.
  1796                 24  AG-EXP-DT                 PIC XX.
  1797         16  AG-TYPE                           PIC X.
  1798             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1799             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  34
* EL050.cbl
  1800     12  AG-MAINT-INFORMATION.
  1801         16  AG-LAST-MAINT-DT                  PIC XX.
  1802         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1803         16  AG-LAST-MAINT-USER                PIC X(4).
  1804         16  FILLER                            PIC X(10).
  1805     12  AG-EFF-DT                             PIC XX.
  1806     12  AG-COMM-STRUCTURE.
  1807         16  AG-AGT-COMMS OCCURS 10.
  1808             20  AG-AGT                PIC X(10).
  1809             20  AG-COM-TYP            PIC X.
  1810             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1811             20  AG-RECALC-LV-INDIC    PIC X.
  1812             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1813             20  AG-LRCALC-LV-INDIC    PIC X.
  1814             20  FILLER                PIC X(05).
  1815     12  FILLER                  PIC X(145).
  1816******************************************************************
  1817*    COPY ERCRESS.
  1818******************************************************************
  1819*                                                                *
  1820*                            ERCRESS                             *
  1821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1822*                            VMOD=2.002                          *
  1823*                                                                *
  1824*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1825*                                                                *
  1826*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1827*   VSAM RESIDENT STATE TAX MASTER                              *
  1828*                                                                *
  1829*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1833*                                                                *
  1834*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1835*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1836*                                                                *
  1837*   LOG = NO                                                     *
  1838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1839*                                                                *
  1840*                                                                *
  1841******************************************************************
  1842
  1843 01  RESIDENT-STATE-TAX-MASTER.
  1844
  1845     10  ERRESS-PRIMARY-KEY.
  1846         15  RES-COMPANY-CD        PIC X.
  1847         15  RES-RESIDENT-STATE    PIC XX.
  1848         15  RES-COVERAGE-CATEGORY PIC X.
  1849         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1850*                                      YYYYMMDD
  1851*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1852
  1853     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1854
  1855         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1856         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1857         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  35
* EL050.cbl
  1858         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1859
  1860     10 RES-RECALC-SW              PIC   X.
  1861         88 RECALC                VALUE 'Y'.
  1862         88 NO-RECALC             VALUE 'N'.
  1863     10  RES-MAINT-BY              PIC X(4).
  1864     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1865     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1866*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  36
* EL050.cbl
  1868*    COPY ERCRESC.
  1869******************************************************************
  1870*                                                                *
  1871*                            ERCRESC                             *
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1873*                            VMOD=2.003                          *
  1874*                                                                *
  1875*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1876*                                                                *
  1877*   FILE TYPE = VSAM,KSDS                                        *
  1878*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1879*                                                                *
  1880*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1881*       ALTERNATE PATH1 = NONE                                   *
  1882*                                                                *
  1883*   LOG = NO                                                     *
  1884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1885*                                                                *
  1886******************************************************************
  1887
  1888 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1889
  1890     10  ERRESC-RECORD-KEY.
  1891         15  RESC-COMPANY-CD           PIC   X.
  1892         15  RESC-CARRIER              PIC   X.
  1893         15  RESC-GROUP                PIC   X(6).
  1894         15  RESC-STATE                PIC   XX.
  1895         15  RESC-ACCOUNT              PIC   X(10).
  1896         15  RESC-AGENT                PIC   X(10).
  1897         15  RESC-RESIDENT-STATE       PIC   XX.
  1898         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1899*                                           YYYYMMDD
  1900     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1901
  1902     10  RESC-COMM-RECORD-DATA.
  1903         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1904             20 RESC-COVERAGE-CAT      PIC    X.
  1905             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1906             20 RESC-COMMISSION-TAB REDEFINES
  1907                RESC-COMMISSION-PER    PIC  XXX.
  1908
  1909     10  RESC-MAINT-BY                 PIC X(4).
  1910     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1911     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1912*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  37
* EL050.cbl
  1914*    COPY ERCPLAN.
  1915******************************************************************
  1916*                                                                *
  1917*                                                                *
  1918*                            ERCPLAN                             *
  1919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1920*                            VMOD=2.003                          *
  1921*                                                                *
  1922*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1923*                                                                *
  1924*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1925*   PLAN MASTER                                                  *
  1926*                                                                *
  1927*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1928*                                                                *
  1929*   FILE TYPE = VSAM,KSDS                                        *
  1930*   RECORD SIZE = 420   RECFORM = FIX                            *
  1931*                                                                *
  1932*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1933*       ALTERNATE PATH1 = N/A                                    *
  1934*                                                                *
  1935*   LOG = NO                                                     *
  1936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1937*                                                                *
  1938*                                                                *
  1939******************************************************************
  1940
  1941 01  PLAN-MASTER.
  1942     12  PL-RECORD-ID                      PIC XX.
  1943         88  VALID-PL-ID                      VALUE 'PL'.
  1944
  1945     12  PL-CONTROL-PRIMARY.
  1946         16  PL-COMPANY-CD                 PIC X.
  1947         16  PL-MSTR-CNTRL.
  1948             20  PL-CONTROL-A.
  1949                 24  PL-CARRIER            PIC X.
  1950                 24  PL-GROUPING           PIC X(6).
  1951                 24  PL-STATE              PIC XX.
  1952                 24  PL-ACCOUNT            PIC X(10).
  1953             20  PL-BENEFIT-TYPE           PIC X.
  1954             20  PL-BENEFIT-CODE           PIC XX.
  1955             20  PL-REVISION-NO            PIC X(3).
  1956
  1957     12  PL-CONTROL-BY-VAR-GRP.
  1958         16  PL-COMPANY-CD-A1              PIC X.
  1959         16  PL-VG-CARRIER                 PIC X.
  1960         16  PL-VG-GROUPING                PIC X(6).
  1961         16  PL-VG-STATE                   PIC XX.
  1962         16  PL-VG-ACCOUNT                 PIC X(10).
  1963         16  PL-BENEFIT-TYPE-A1            PIC X.
  1964         16  PL-BENEFIT-CODE-A1            PIC XX.
  1965         16  PL-REVISION-NO-A1             PIC 999.
  1966
  1967     12  PL-MAINT-INFORMATION.
  1968         16  PL-LAST-MAINT-DT              PIC XX.
  1969         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1970         16  PL-LAST-MAINT-USER            PIC X(4).
  1971         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  38
* EL050.cbl
  1972
  1973     12  PL-LIABILITY-LIMITS.
  1974         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1975         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1976             20  PL-LM-AGE                 PIC S99        COMP-3.
  1977             20  PL-LM-DUR                 PIC S999       COMP-3.
  1978             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1979             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1980
  1981     12  FILLER                            PIC X(30).
  1982
  1983     12  PL-GL-ACCOUNT-NOS.
  1984         16  PL-PREMIUM-GL                 PIC X(8).
  1985         16  PL-COMM-GL                    PIC X(8).
  1986         16  PL-CLAIM-GL                   PIC X(8).
  1987     12  FILLER                            PIC X(24).
  1988     12  PL-TOLERANCES.
  1989         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1990         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1991         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1992         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1993         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1994         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1995     12  PL-OVER-SHORT.
  1996         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1997         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1998     12  FILLER                            PIC X(24).
  1999     12  PLAN-MISC.
  2000         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2001         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2002         16  PL-IG                         PIC X.
  2003         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2004         16  PL-POLICY-FORM                PIC X(12).
  2005         16  PL-EDIT-FOR-FORM              PIC X(01).
  2006         16  PL-DEV-CODE                   PIC XXX.
  2007         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2008         16  PL-CALC-METHOD                PIC X.
  2009         16  PL-BENEFIT-GROUP              PIC X(05).
  2010         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2011
  2012         16  FILLER                        PIC X(99).
  2013******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  39
* EL050.cbl
  2015*    COPY ELCCERT.
  2016******************************************************************
  2017*                                                                *
  2018*                            ELCCERT.                            *
  2019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2020*                            VMOD=2.013                          *
  2021*                                                                *
  2022*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2023*                                                                *
  2024*   FILE TYPE = VSAM,KSDS                                        *
  2025*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2026*                                                                *
  2027*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2028*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2029*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2030*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2031*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2032*                                                                *
  2033*   LOG = YES                                                    *
  2034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2035******************************************************************
  2036*                   C H A N G E   L O G
  2037*
  2038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2039*-----------------------------------------------------------------
  2040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2041* EFFECTIVE    NUMBER
  2042*-----------------------------------------------------------------
  2043* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2044* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2045* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2046* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2047* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2048* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2049* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2050******************************************************************
  2051
  2052 01  CERTIFICATE-MASTER.
  2053     12  CM-RECORD-ID                      PIC XX.
  2054         88  VALID-CM-ID                      VALUE 'CM'.
  2055
  2056     12  CM-CONTROL-PRIMARY.
  2057         16  CM-COMPANY-CD                 PIC X.
  2058         16  CM-CARRIER                    PIC X.
  2059         16  CM-GROUPING.
  2060             20  CM-GROUPING-PREFIX        PIC X(3).
  2061             20  CM-GROUPING-PRIME         PIC X(3).
  2062         16  CM-STATE                      PIC XX.
  2063         16  CM-ACCOUNT.
  2064             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2065             20  CM-ACCOUNT-PRIME          PIC X(6).
  2066         16  CM-CERT-EFF-DT                PIC XX.
  2067         16  CM-CERT-NO.
  2068             20  CM-CERT-PRIME             PIC X(10).
  2069             20  CM-CERT-SFX               PIC X.
  2070
  2071     12  CM-CONTROL-BY-NAME.
  2072         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  40
* EL050.cbl
  2073         16  CM-INSURED-LAST-NAME          PIC X(15).
  2074         16  CM-INSURED-INITIALS.
  2075             20  CM-INSURED-INITIAL1       PIC X.
  2076             20  CM-INSURED-INITIAL2       PIC X.
  2077
  2078     12  CM-CONTROL-BY-SSN.
  2079         16  CM-COMPANY-CD-A2              PIC X.
  2080         16  CM-SOC-SEC-NO.
  2081             20  CM-SSN-STATE              PIC XX.
  2082             20  CM-SSN-ACCOUNT            PIC X(6).
  2083             20  CM-SSN-LN3.
  2084                 25  CM-INSURED-INITIALS-A2.
  2085                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2086                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2087                 25 CM-PART-LAST-NAME-A2         PIC X.
  2088
  2089     12  CM-CONTROL-BY-CERT-NO.
  2090         16  CM-COMPANY-CD-A4              PIC X.
  2091         16  CM-CERT-NO-A4                 PIC X(11).
  2092
  2093     12  CM-CONTROL-BY-MEMB.
  2094         16  CM-COMPANY-CD-A5              PIC X.
  2095         16  CM-MEMBER-NO.
  2096             20  CM-MEMB-STATE             PIC XX.
  2097             20  CM-MEMB-ACCOUNT           PIC X(6).
  2098             20  CM-MEMB-LN4.
  2099                 25  CM-INSURED-INITIALS-A5.
  2100                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2101                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2102                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2103
  2104     12  CM-INSURED-PROFILE-DATA.
  2105         16  CM-INSURED-FIRST-NAME.
  2106             20  CM-INSURED-1ST-INIT       PIC X.
  2107             20  FILLER                    PIC X(9).
  2108         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2109         16  CM-INSURED-SEX                PIC X.
  2110             88  CM-SEX-MALE                  VALUE 'M'.
  2111             88  CM-SEX-FEMAL                 VALUE 'F'.
  2112         16  CM-INSURED-JOINT-AGE          PIC 99.
  2113         16  CM-JOINT-INSURED-NAME.
  2114             20  CM-JT-LAST-NAME           PIC X(15).
  2115             20  CM-JT-FIRST-NAME.
  2116                 24  CM-JT-1ST-INIT        PIC X.
  2117                 24  FILLER                PIC X(9).
  2118             20  CM-JT-INITIAL             PIC X.
  2119
  2120     12  CM-LIFE-DATA.
  2121         16  CM-LF-BENEFIT-CD              PIC XX.
  2122         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2123         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2124         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2125         16  CM-LF-DEV-CODE                PIC XXX.
  2126         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2127         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2128         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2129         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2130         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  41
* EL050.cbl
  2131         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2132         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2133         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2134         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2135         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2136         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2137         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2138         16  FILLER                        PIC XX.
  2139
  2140     12  CM-AH-DATA.
  2141         16  CM-AH-BENEFIT-CD              PIC XX.
  2142         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2143         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2144         16  CM-AH-DEV-CODE                PIC XXX.
  2145         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2146         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2147         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2148         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2149         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2150         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2151         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2152         16  CM-AH-PAID-THRU-DT            PIC XX.
  2153             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2154         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2155         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2156         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2157         16  FILLER                        PIC X.
  2158
  2159     12  CM-LOAN-INFORMATION.
  2160         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2161         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2162                                           PIC S9(5)V99  COMP-3.
  2163         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2164         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2165         16  CM-PAY-FREQUENCY              PIC S99.
  2166         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2167         16  CM-RATE-CLASS                 PIC XX.
  2168         16  CM-BENEFICIARY                PIC X(25).
  2169         16  CM-POLICY-FORM-NO             PIC X(12).
  2170         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2171         16  CM-LAST-ADD-ON-DT             PIC XX.
  2172         16  CM-DEDUCTIBLE-AMOUNTS.
  2173             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2174             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2175         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2176             20  CM-RESIDENT-STATE         PIC XX.
  2177             20  CM-RATE-CODE              PIC X(4).
  2178             20  FILLER                    PIC XX.
  2179         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2180             20  CM-LOAN-OFFICER           PIC X(5).
  2181             20  FILLER                    PIC XXX.
  2182         16  CM-CSR-CODE                   PIC XXX.
  2183         16  CM-UNDERWRITING-CODE          PIC X.
  2184             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2185         16  CM-POST-CARD-IND              PIC X.
  2186         16  CM-NH-INTERFACE-SW            PIC X.
  2187         16  CM-PREMIUM-TYPE               PIC X.
  2188             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  42
* EL050.cbl
  2189             88  CM-O-B-COVERAGE              VALUE '2'.
  2190             88  CM-OPEN-END                  VALUE '3'.
  2191         16  CM-IND-GRP-TYPE               PIC X.
  2192             88  CM-INDIVIDUAL                VALUE 'I'.
  2193             88  CM-GROUP                     VALUE 'G'.
  2194         16  CM-SKIP-CODE                  PIC X.
  2195             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2196             88  SKIP-JULY                    VALUE '1'.
  2197             88  SKIP-AUGUST                  VALUE '2'.
  2198             88  SKIP-SEPTEMBER               VALUE '3'.
  2199             88  SKIP-JULY-AUG                VALUE '4'.
  2200             88  SKIP-AUG-SEPT                VALUE '5'.
  2201             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2202             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2203             88  SKIP-JUNE                    VALUE '8'.
  2204             88  SKIP-JUNE-JULY               VALUE '9'.
  2205             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2206             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2207         16  CM-PAYMENT-MODE               PIC X.
  2208             88  PAY-MONTHLY                  VALUE SPACE.
  2209             88  PAY-WEEKLY                   VALUE '1'.
  2210             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2211             88  PAY-BI-WEEKLY                VALUE '3'.
  2212             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2213         16  CM-LOAN-NUMBER                PIC X(8).
  2214         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2215         16  CM-OLD-LOF                    PIC XXX.
  2216*        16  CM-LOAN-OFFICER               PIC XXX.
  2217         16  CM-REIN-TABLE                 PIC XXX.
  2218         16  CM-SPECIAL-REIN-CODE          PIC X.
  2219         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2220         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2221         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2222
  2223     12  CM-STATUS-DATA.
  2224         16  CM-ENTRY-STATUS               PIC X.
  2225         16  CM-ENTRY-DT                   PIC XX.
  2226
  2227         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2228         16  CM-LF-CANCEL-DT               PIC XX.
  2229         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2230
  2231         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2232         16  CM-LF-DEATH-DT                PIC XX.
  2233         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2234
  2235         16  CM-LF-CURRENT-STATUS          PIC X.
  2236             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2237                                                'M' '4' '5' '9'.
  2238             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2239             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2240             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2241             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2242             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2243             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2244             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2245             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2246             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  43
* EL050.cbl
  2247             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2248             88  CM-LF-DECLINED               VALUE 'D'.
  2249             88  CM-LF-VOIDED                 VALUE 'V'.
  2250
  2251         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2252         16  CM-AH-CANCEL-DT               PIC XX.
  2253         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2254
  2255         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2256         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2257         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2258
  2259         16  CM-AH-CURRENT-STATUS          PIC X.
  2260             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2261                                                'M' '4' '5' '9'.
  2262             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2263             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2264             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2265             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2266             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2267             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2268             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2269             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2270             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2271             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2272             88  CM-AH-DECLINED               VALUE 'D'.
  2273             88  CM-AH-VOIDED                 VALUE 'V'.
  2274
  2275         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2276             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2277             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2278             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2279         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2280
  2281         16  CM-ENTRY-BATCH                PIC X(6).
  2282         16  CM-LF-EXIT-BATCH              PIC X(6).
  2283         16  CM-AH-EXIT-BATCH              PIC X(6).
  2284         16  CM-LAST-MONTH-END             PIC XX.
  2285
  2286     12  CM-NOTE-SW                        PIC X.
  2287         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2288         88  CERT-NOTES-PRESENT               VALUE '1'.
  2289         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2290         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2291         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2292         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2293         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2294         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2295     12  CM-COMP-EXCP-SW                   PIC X.
  2296         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2297         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2298     12  CM-INSURED-ADDRESS-SW             PIC X.
  2299         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2300         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2301
  2302*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2303     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2304     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  44
* EL050.cbl
  2305
  2306*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2307     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2308     12  FILLER                            PIC X.
  2309*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2310     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2311
  2312     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2313         88  CERT-ADDED-BATCH                 VALUE ' '.
  2314         88  CERT-ADDED-ONLINE                VALUE '1'.
  2315         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2316         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2317         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2318     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2319         88  CERT-AS-LOADED                   VALUE ' '.
  2320         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2321         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2322         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2323         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2324         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2325         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2326         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2327
  2328     12  CM-ACCOUNT-COMM-PCTS.
  2329         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2330         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2331
  2332     12  CM-USER-FIELD                     PIC X.
  2333     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2334     12  CM-CLP-STATE                      PIC XX.
  2335     12  CM-USER-RESERVED                  PIC XXX.
  2336******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  45
* EL050.cbl
  2338*    COPY ERCMAIL.
  2339******************************************************************
  2340*                                                                *
  2341*                                                                *
  2342*                            ERCMAIL                             *
  2343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2344*                            VMOD=2.003                          *
  2345*                                                                *
  2346*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2347*                                                                *
  2348*   FILE TYPE = VSAM,KSDS                                        *
  2349*   RECORD SIZE = 374   RECFORM = FIX                            *
  2350*                                                                *
  2351*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2352*   ALTERNATE PATH    = NOT USED                                 *
  2353*                                                                *
  2354*   LOG = YES                                                    *
  2355*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2356******************************************************************
  2357*                   C H A N G E   L O G
  2358*
  2359* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2360*-----------------------------------------------------------------
  2361*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2362* EFFECTIVE    NUMBER
  2363*-----------------------------------------------------------------
  2364* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2365* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2366* 111108                   PEMA  ADD CRED BENE ADDR2
  2367******************************************************************
  2368
  2369 01  MAILING-DATA.
  2370     12  MA-RECORD-ID                      PIC XX.
  2371         88  VALID-MA-ID                       VALUE 'MA'.
  2372
  2373     12  MA-CONTROL-PRIMARY.
  2374         16  MA-COMPANY-CD                 PIC X.
  2375         16  MA-CARRIER                    PIC X.
  2376         16  MA-GROUPING.
  2377             20  MA-GROUPING-PREFIX        PIC XXX.
  2378             20  MA-GROUPING-PRIME         PIC XXX.
  2379         16  MA-STATE                      PIC XX.
  2380         16  MA-ACCOUNT.
  2381             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2382             20  MA-ACCOUNT-PRIME          PIC X(6).
  2383         16  MA-CERT-EFF-DT                PIC XX.
  2384         16  MA-CERT-NO.
  2385             20  MA-CERT-PRIME             PIC X(10).
  2386             20  MA-CERT-SFX               PIC X.
  2387
  2388     12  FILLER                            PIC XX.
  2389
  2390     12  MA-ACCESS-CONTROL.
  2391         16  MA-SOURCE-SYSTEM              PIC XX.
  2392             88  MA-FROM-CREDIT                VALUE 'CR'.
  2393             88  MA-FROM-VSI                   VALUE 'VS'.
  2394             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2395             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  46
* EL050.cbl
  2396         16  MA-RECORD-ADD-DT              PIC XX.
  2397         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2398         16  MA-LAST-MAINT-DT              PIC XX.
  2399         16  MA-LAST-MAINT-BY              PIC XXXX.
  2400         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2401
  2402     12  MA-PROFILE-INFO.
  2403         16  MA-QUALIFY-CODE-1             PIC XX.
  2404         16  MA-QUALIFY-CODE-2             PIC XX.
  2405         16  MA-QUALIFY-CODE-3             PIC XX.
  2406         16  MA-QUALIFY-CODE-4             PIC XX.
  2407         16  MA-QUALIFY-CODE-5             PIC XX.
  2408
  2409         16  MA-INSURED-LAST-NAME          PIC X(15).
  2410         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2411         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2412         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2413         16  MA-INSURED-BIRTH-DT           PIC XX.
  2414         16  MA-INSURED-SEX                PIC X.
  2415             88  MA-SEX-MALE                   VALUE 'M'.
  2416             88  MA-SEX-FEMALE                 VALUE 'F'.
  2417         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2418
  2419         16  MA-ADDRESS-CORRECTED          PIC X.
  2420         16  MA-JOINT-BIRTH-DT             PIC XX.
  2421*        16  FILLER                        PIC X(12).
  2422
  2423         16  MA-ADDRESS-LINE-1             PIC X(30).
  2424         16  MA-ADDRESS-LINE-2             PIC X(30).
  2425         16  MA-CITY-STATE.
  2426             20  MA-CITY                   PIC X(28).
  2427             20  MA-ADDR-STATE             PIC XX.
  2428         16  MA-ZIP.
  2429             20  MA-ZIP-CODE.
  2430                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2431                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2432                 24  FILLER                PIC X(4).
  2433             20  MA-ZIP-PLUS4              PIC X(4).
  2434         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2435             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2436             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2437             20  FILLER                    PIC X(3).
  2438
  2439         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2440
  2441         16  FILLER                        PIC XXX.
  2442*        16  FILLER                        PIC X(10).
  2443
  2444     12  MA-CRED-BENE-INFO.
  2445         16  MA-CRED-BENE-NAME                 PIC X(25).
  2446         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2447         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2448         16  MA-CRED-BENE-CTYST.
  2449             20  MA-CRED-BENE-CITY             PIC X(28).
  2450             20  MA-CRED-BENE-STATE            PIC XX.
  2451         16  MA-CRED-BENE-ZIP.
  2452             20  MA-CB-ZIP-CODE.
  2453                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  47
* EL050.cbl
  2454                     88  MA-CB-CANADIAN-POST-CODE
  2455                                           VALUE 'A' THRU 'Z'.
  2456                 24  FILLER                    PIC X(4).
  2457             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2458         16  MA-CB-CANADIAN-POSTAL-CODE
  2459                            REDEFINES MA-CRED-BENE-ZIP.
  2460             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2461             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2462             20  FILLER                        PIC X(3).
  2463     12  MA-POST-CARD-MAIL-DATA.
  2464         16  MA-MAIL-DATA OCCURS 7.
  2465             20  MA-MAIL-TYPE              PIC X.
  2466                 88  MA-12MO-MAILING           VALUE '1'.
  2467                 88  MA-EXP-MAILING            VALUE '2'.
  2468             20  MA-MAIL-STATUS            PIC X.
  2469                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2470                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2471                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2472             20  MA-MAIL-DATE              PIC XX.
  2473     12  FILLER                            PIC XX.
  2474     12  FILLER                            PIC XX.
  2475*    12  FILLER                            PIC X(30).
  2476******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  48
* EL050.cbl
  2478*    COPY ERCPNDM.
  2479******************************************************************
  2480*                                                                *
  2481*                                                                *
  2482*                            ERCPNDM                             *
  2483*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2484*                            VMOD=2.003                          *
  2485*                                                                *
  2486*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2487*                                                                *
  2488*   FILE TYPE = VSAM,KSDS                                        *
  2489*   RECORD SIZE = 374   RECFORM = FIX                            *
  2490*                                                                *
  2491*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2492*   ALTERNATE PATH    = NOT USED                                 *
  2493*                                                                *
  2494*   LOG = YES                                                    *
  2495*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2496******************************************************************
  2497*                   C H A N G E   L O G
  2498*
  2499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2500*-----------------------------------------------------------------
  2501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2502* EFFECTIVE    NUMBER
  2503*-----------------------------------------------------------------
  2504* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2505* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2506* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2507******************************************************************
  2508
  2509 01  PENDING-MAILING-DATA.
  2510     12  PM-RECORD-ID                      PIC XX.
  2511         88  VALID-MA-ID                       VALUE 'PM'.
  2512
  2513     12  PM-CONTROL-PRIMARY.
  2514         16  PM-COMPANY-CD                 PIC X.
  2515         16  PM-ENTRY-BATCH                PIC X(6).
  2516         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2517         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2518
  2519     12  FILLER                            PIC X(14).
  2520
  2521     12  PM-ACCESS-CONTROL.
  2522         16  PM-SOURCE-SYSTEM              PIC XX.
  2523             88  PM-FROM-CREDIT                VALUE 'CR'.
  2524             88  PM-FROM-VSI                   VALUE 'VS'.
  2525             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2526             88  PM-FROM-OTHER                 VALUE 'OT'.
  2527         16  PM-RECORD-ADD-DT              PIC XX.
  2528         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2529         16  PM-LAST-MAINT-DT              PIC XX.
  2530         16  PM-LAST-MAINT-BY              PIC XXXX.
  2531         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2532
  2533     12  PM-PROFILE-INFO.
  2534         16  PM-QUALIFY-CODE-1             PIC XX.
  2535         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  49
* EL050.cbl
  2536         16  PM-QUALIFY-CODE-3             PIC XX.
  2537         16  PM-QUALIFY-CODE-4             PIC XX.
  2538         16  PM-QUALIFY-CODE-5             PIC XX.
  2539
  2540         16  PM-INSURED-LAST-NAME          PIC X(15).
  2541         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2542         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2543         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2544         16  PM-INSURED-BIRTH-DT           PIC XX.
  2545         16  PM-INSURED-SEX                PIC X.
  2546             88  PM-SEX-MALE                   VALUE 'M'.
  2547             88  PM-SEX-FEMALE                 VALUE 'F'.
  2548         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2549
  2550         16  PM-ADDRESS-CORRECTED          PIC X.
  2551         16  PM-JOINT-BIRTH-DT             PIC XX.
  2552*        16  FILLER                        PIC X(12).
  2553
  2554         16  PM-ADDRESS-LINE-1             PIC X(30).
  2555         16  PM-ADDRESS-LINE-2             PIC X(30).
  2556         16  PM-CITY-STATE.
  2557             20  PM-CITY                   PIC X(28).
  2558             20  PM-STATE                  PIC XX.
  2559         16  PM-ZIP.
  2560             20  PM-ZIP-CODE.
  2561                 24  PM-ZIP-1              PIC X.
  2562                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2563                 24  FILLER                PIC X(4).
  2564             20  PM-ZIP-PLUS4              PIC X(4).
  2565         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2566             20  PM-CAN-POST1              PIC XXX.
  2567             20  PM-CAN-POST2              PIC XXX.
  2568             20  FILLER                    PIC XXX.
  2569
  2570         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2571
  2572         16  FILLER                        PIC X(03).
  2573
  2574     12  PM-CRED-BENE-INFO.
  2575         16  PM-CRED-BENE-NAME             PIC X(25).
  2576         16  PM-CRED-BENE-ADDR             PIC X(30).
  2577         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2578         16  PM-CRED-BENE-CTYST.
  2579             20  PM-CRED-BENE-CITY         PIC X(28).
  2580             20  PM-CRED-BENE-STATE        PIC XX.
  2581         16  PM-CRED-BENE-ZIP.
  2582             20  PM-CB-ZIP-CODE.
  2583                 24  PM-CB-ZIP-1           PIC X.
  2584                     88  PM-CB-CANADIAN-POST-CODE
  2585                                  VALUE 'A' THRU 'Z'.
  2586                 24  FILLER                PIC X(4).
  2587             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2588         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2589             20  PM-CB-CAN-POST1           PIC XXX.
  2590             20  PM-CB-CAN-POST2           PIC XXX.
  2591             20  FILLER                    PIC XXX.
  2592     12  PM-POST-CARD-MAIL-DATA.
  2593         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  50
* EL050.cbl
  2594             20  PM-MAIL-TYPE              PIC X.
  2595                 88  PM-12MO-MAILING           VALUE '1'.
  2596                 88  PM-EXP-MAILING            VALUE '2'.
  2597             20  PM-MAIL-STATUS            PIC X.
  2598                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2599                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2600                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2601             20  PM-MAIL-DATE              PIC XX.
  2602     12  FILLER                            PIC XX.
  2603     12  FILLER                            PIC X(12).
  2604*    12  FILLER                            PIC X(30).
  2605
  2606******************************************************************
  2607*                                COPY ERCLOFC.
  2608******************************************************************
  2609*                                                                *
  2610*                                                                *
  2611*                            ERCLOFC                             *
  2612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2613*                            VMOD=2.003                          *
  2614*                                                                *
  2615*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2616*                                                                *
  2617*   FILE TYPE = VSAM,KSDS                                        *
  2618*   RECORD SIZE = 670   RECFORM = FIX                            *
  2619*                                                                *
  2620*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2621*                                                                *
  2622*   LOG = YES                                                    *
  2623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2624*                                                                *
  2625******************************************************************
  2626
  2627 01  LOAN-OFFICER-MASTER.
  2628     12  LO-RECORD-ID                PIC XX.
  2629         88  VALID-LO-ID                VALUE 'LO'.
  2630
  2631     12  LO-CONTROL-PRIMARY.
  2632         16  LO-COMPANY-CD           PIC X.
  2633         16  LO-CARRIER              PIC X.
  2634         16  LO-GROUPING.
  2635             20  LO-GROUPING-PREFIX  PIC XXX.
  2636             20  LO-GROUPING-PRIME   PIC XXX.
  2637         16  LO-STATE                PIC XX.
  2638         16  LO-ACCOUNT.
  2639             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2640             20  LO-ACCOUNT-PRIME    PIC X(6).
  2641         16  LO-OFFICER-CODE         PIC X(5).
  2642
  2643     12  LO-OFFICER-NAME             PIC X(30).
  2644
  2645     12  LO-LAST-MAINT-DT            PIC XX.
  2646     12  LO-LAST-USER                PIC X(4).
  2647     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2648
  2649     12  LO-COMP-CONTROL             PIC X.
  2650             88  LO-SHOW-COMP           VALUE 'Y'.
  2651             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  51
* EL050.cbl
  2652     12  LO-DETAIL-CONTROL           PIC X.
  2653             88  LO-PRINT-DETAIL        VALUE 'D'.
  2654             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2655
  2656     12  LO-SV-CARRIER               PIC X.
  2657     12  LO-SV-GROUPING              PIC X(6).
  2658     12  LO-SV-STATE                 PIC XX.
  2659
  2660     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2661     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2662
  2663     12  LO-OFFICER-INFO.
  2664         16  FILLER OCCURS 12 TIMES.
  2665             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2666             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2667             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2668             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2669             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2670             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2671             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2672             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2673     12  FILLER                      PIC X(198).
  2674******************************************************************
  2675*                                COPY ERCPDEF.
  2676******************************************************************
  2677*                                                                *
  2678*                                                                *
  2679*                            ERCPDEF.                            *
  2680*                                                                *
  2681*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2682*                                                                *
  2683*    FILE TYPE = VSAM,KSDS                                       *
  2684*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2685*                                                                *
  2686*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2687*                                                                *
  2688*    LOG = YES                                                   *
  2689*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2690******************************************************************
  2691 01  PRODUCT-MASTER.
  2692    12  PD-RECORD-ID                 PIC X(02).
  2693        88  VALID-PD-ID                  VALUE 'PD'.
  2694    12  PD-CONTROL-PRIMARY.
  2695        16  PD-COMPANY-CD            PIC X.
  2696        16  PD-STATE                 PIC XX.
  2697        16  PD-PRODUCT-CD            PIC XXX.
  2698        16  PD-FILLER                PIC X(7).
  2699        16  PD-BEN-TYPE              PIC X.
  2700        16  PD-BEN-CODE              PIC XX.
  2701        16  PD-PROD-EXP-DT           PIC XX.
  2702    12  FILLER                       PIC X(50).
  2703    12  PD-PRODUCT-DATA OCCURS 8.
  2704        16  PD-PROD-CODE             PIC X.
  2705            88  PD-PROD-LIFE           VALUE 'L'.
  2706            88  PD-PROD-PROP           VALUE 'P'.
  2707            88  PD-PROD-AH             VALUE 'A'.
  2708            88  PD-PROD-IU             VALUE 'I'.
  2709            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  52
* EL050.cbl
  2710        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2711        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2712        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2713        16  PD-MAX-TERM              PIC S999        COMP-3.
  2714        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2715        16  FILLER                   PIC X.
  2716        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2717        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2718        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2719        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2720        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2721        16  PD-REC-CRIT-PERIOD       PIC X.
  2722        16  PD-RTW-MOS               PIC 99.
  2723        16  FILLER                   PIC X(5).
  2724    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2725    12  PD-TERM-LIMITS OCCURS 15.
  2726        16  PD-LOW-TERM              PIC S999        COMP-3.
  2727        16  PD-HI-TERM               PIC S999        COMP-3.
  2728*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2729    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2730        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2731        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2732    12  PD-EARN-FACTORS.
  2733        16  FILLER OCCURS 15.
  2734            20  FILLER OCCURS 15.
  2735                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2736    12  PD-PRODUCT-DESC              PIC X(80).
  2737    12  PD-TRUNCATED                 PIC X.
  2738    12  FILLER                       PIC X(59).
  2739    12  PD-MAINT-INFORMATION.
  2740        16  PD-LAST-MAINT-DT         PIC X(02).
  2741        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2742        16  PD-LAST-MAINT-BY         PIC X(04).
  2743*                                COPY ELCSTATE.
  2744******************************************************************
  2745*                                                                *
  2746*                                                                *
  2747*                            ELCSTATE.                           *
  2748*                                                                *
  2749*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2750*                                                                *
  2751*   FILE TYPE = VSAM,KSDS                                        *
  2752*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2753*                                                                *
  2754*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2755*       ALTERNATE INDEX = NONE                                   *
  2756*                                                                *
  2757*   LOG = YES                                                    *
  2758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2759******************************************************************
  2760*                   C H A N G E   L O G
  2761*
  2762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2763*-----------------------------------------------------------------
  2764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2765* EFFECTIVE    NUMBER
  2766*-----------------------------------------------------------------
  2767* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  53
* EL050.cbl
  2768******************************************************************
  2769*
  2770 01  STATE-FILE.
  2771     12  SF-RECORD-ID                       PIC XX.
  2772         88  VALID-CF-ID                        VALUE 'SF'.
  2773     12  SF-CONTROL-PRIMARY.
  2774         16  SF-COMPANY-ID                  PIC XXX.
  2775         16  SF-CARRIER-CODE                PIC X.
  2776         16  SF-GROUPING                    PIC X(6).
  2777         16  SF-STATE-CODE                  PIC XX.
  2778         16  SF-EXPIRE-DATE                 PIC 9(8).
  2779****************************************************************
  2780*             STATE CONTROLS
  2781****************************************************************
  2782     12  SF-LAST-MAINT-DT                   PIC XX.
  2783     12  SF-LAST-MAINT-BY                   PIC X(4).
  2784     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2785     12  SF-STATE-RT-CONTROLS.
  2786         16  SF-ST-RT-CALC                  PIC X.
  2787     12  SF-ST-TAX-CONTROLS.
  2788         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2789         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2790         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2791     12  SF-ST-REFUND-OPTIONS.
  2792         16  SF-ST-RF-LR-CALC               PIC X.
  2793         16  SF-ST-RF-LL-CALC               PIC X.
  2794         16  SF-ST-RF-LN-CALC               PIC X.
  2795         16  SF-ST-RF-AH-CALC               PIC X.
  2796         16  SF-ST-RF-CP-CALC               PIC X.
  2797     12  SF-ST-UNEARN-PREM-OPTIONS.
  2798         16  SF-ST-LUEP-R78                 PIC X.
  2799         16  SF-ST-LUEP-PRO                 PIC X.
  2800         16  SF-ST-LUEP-ST                  PIC X.
  2801         16  SF-ST-LUEP-DOM                 PIC X.
  2802         16  SF-ST-AUEP-R78                 PIC X.
  2803         16  SF-ST-AUEP-PRO                 PIC X.
  2804         16  SF-ST-AUEP-ST                  PIC X.
  2805         16  SF-ST-AUEP-DOM                 PIC X.
  2806         16  SF-ST-CUEP-R78                 PIC X.
  2807         16  SF-ST-CUEP-PRO                 PIC X.
  2808         16  SF-ST-CUEP-ST                  PIC X.
  2809         16  SF-ST-CUEP-DOM                 PIC X.
  2810     12  SF-ST-EARN-PREM-OPTIONS.
  2811         16  SF-ST-LEP-R78                  PIC X.
  2812         16  SF-ST-LEP-PRO                  PIC X.
  2813         16  SF-ST-LEP-ST                   PIC X.
  2814         16  SF-ST-LEP-DOM                  PIC X.
  2815         16  SF-ST-AEP-R78                  PIC X.
  2816         16  SF-ST-AEP-PRO                  PIC X.
  2817         16  SF-ST-AEP-ST                   PIC X.
  2818         16  SF-ST-AEP-DOM                  PIC X.
  2819         16  SF-ST-CEP-R78                  PIC X.
  2820         16  SF-ST-CEP-PRO                  PIC X.
  2821         16  SF-ST-CEP-ST                   PIC X.
  2822         16  SF-ST-CEP-DOM                  PIC X.
  2823     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  54
* EL050.cbl
  2825*    COPY ELCCRTT.
  2826******************************************************************
  2827*                                                                *
  2828*                            ELCCRTT.                            *
  2829*                                                                *
  2830*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2831*                                                                *
  2832*   FILE TYPE = VSAM,KSDS                                        *
  2833*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2834*                                                                *
  2835*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2836*                                                                *
  2837*   LOG = YES                                                    *
  2838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2839******************************************************************
  2840*                   C H A N G E   L O G
  2841*
  2842* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2843*-----------------------------------------------------------------
  2844*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2845* EFFECTIVE    NUMBER
  2846*-----------------------------------------------------------------
  2847* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2848* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2849* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2850******************************************************************
  2851
  2852 01  CERTIFICATE-TRAILERS.
  2853     12  CS-RECORD-ID                      PIC XX.
  2854         88  VALID-CS-ID                      VALUE 'CS'.
  2855
  2856     12  CS-CONTROL-PRIMARY.
  2857         16  CS-COMPANY-CD                 PIC X.
  2858         16  CS-CARRIER                    PIC X.
  2859         16  CS-GROUPING                   PIC X(6).
  2860         16  CS-STATE                      PIC XX.
  2861         16  CS-ACCOUNT                    PIC X(10).
  2862         16  CS-CERT-EFF-DT                PIC XX.
  2863         16  CS-CERT-NO.
  2864             20  CS-CERT-PRIME             PIC X(10).
  2865             20  CS-CERT-SFX               PIC X.
  2866         16  CS-TRAILER-TYPE               PIC X.
  2867             88  COMM-TRLR           VALUE 'A'.
  2868             88  FUTURE-TRLR         VALUE 'B'.
  2869             88  CERT-DATA-TRLR      VALUE 'C'.
  2870
  2871     12  CS-DATA-AREA                      PIC X(516).
  2872
  2873     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2874         16  CS-BANK-COMMISSION-AREA.
  2875             20  CS-BANK-COMMS       OCCURS 10.
  2876                 24  CS-AGT                PIC X(10).
  2877                 24  CS-COM-TYP            PIC X.
  2878                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2879                 24  CS-RECALC-LV-INDIC    PIC X.
  2880                 24  FILLER                PIC X(10).
  2881         16  FILLER                        PIC X(256).
  2882
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  55
* EL050.cbl
  2883     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2884         16  CS-VIN-NUMBER                 PIC X(17).
  2885         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2886         16  FILLER                        PIC X(498).
  2887******************************************************************
  2888
  2889*    COPY ELCDATE.
  2890******************************************************************
  2891*                                                                *
  2892*                                                                *
  2893*                            ELCDATE.                            *
  2894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2895*                            VMOD=2.003
  2896*                                                                *
  2897*                                                                *
  2898*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2899*                 LENGTH = 200                                   *
  2900******************************************************************
  2901
  2902 01  DATE-CONVERSION-DATA.
  2903     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2904     12  DC-OPTION-CODE                PIC X.
  2905         88  BIN-TO-GREG                VALUE ' '.
  2906         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2907         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2908         88  YMD-GREG-TO-BIN            VALUE '3'.
  2909         88  MDY-GREG-TO-BIN            VALUE '4'.
  2910         88  JULIAN-TO-BIN              VALUE '5'.
  2911         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2912         88  FIND-CENTURY               VALUE '7'.
  2913         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2914         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2915         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2916         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2917         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2918         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2919         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2920         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2921         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2922         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2923         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2924         88  BIN-3-TO-GREG              VALUE 'I'.
  2925         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2926         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2927         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2928         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2929         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2930         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2931         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2932         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2933         88  THREE-CHARACTER-BIN
  2934                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2935         88  GREGORIAN-TO-BIN
  2936                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2937         88  BIN-TO-GREGORIAN
  2938                  VALUES ' ' '1' 'I' '8' 'G'.
  2939         88  JULIAN-TO-BINARY
  2940                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  56
* EL050.cbl
  2941     12  DC-ERROR-CODE                 PIC X.
  2942         88  NO-CONVERSION-ERROR        VALUE ' '.
  2943         88  DATE-CONVERSION-ERROR
  2944                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2945         88  DATE-IS-ZERO               VALUE '1'.
  2946         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2947         88  DATE-IS-INVALID            VALUE '3'.
  2948         88  DATE1-GREATER-DATE2        VALUE '4'.
  2949         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2950         88  DATE-INVALID-OPTION        VALUE '9'.
  2951         88  INVALID-CENTURY            VALUE 'A'.
  2952         88  ONLY-CENTURY               VALUE 'B'.
  2953         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2954         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2955     12  DC-END-OF-MONTH               PIC X.
  2956         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2957     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2958         88  USE-NORMAL-PROCESS         VALUE ' '.
  2959         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2960         88  ADJUST-UP-100-YRS          VALUE '2'.
  2961     12  FILLER                        PIC X.
  2962     12  DC-CONVERSION-DATES.
  2963         16  DC-BIN-DATE-1             PIC XX.
  2964         16  DC-BIN-DATE-2             PIC XX.
  2965         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2966         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2967                       DC-GREG-DATE-1-EDIT.
  2968             20  DC-EDIT1-MONTH        PIC 99.
  2969             20  SLASH1-1              PIC X.
  2970             20  DC-EDIT1-DAY          PIC 99.
  2971             20  SLASH1-2              PIC X.
  2972             20  DC-EDIT1-YEAR         PIC 99.
  2973         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2974         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2975                     DC-GREG-DATE-2-EDIT.
  2976             20  DC-EDIT2-MONTH        PIC 99.
  2977             20  SLASH2-1              PIC X.
  2978             20  DC-EDIT2-DAY          PIC 99.
  2979             20  SLASH2-2              PIC X.
  2980             20  DC-EDIT2-YEAR         PIC 99.
  2981         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2982         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2983                     DC-GREG-DATE-1-YMD.
  2984             20  DC-YMD-YEAR           PIC 99.
  2985             20  DC-YMD-MONTH          PIC 99.
  2986             20  DC-YMD-DAY            PIC 99.
  2987         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2988         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2989                      DC-GREG-DATE-1-MDY.
  2990             20  DC-MDY-MONTH          PIC 99.
  2991             20  DC-MDY-DAY            PIC 99.
  2992             20  DC-MDY-YEAR           PIC 99.
  2993         16  DC-GREG-DATE-1-ALPHA.
  2994             20  DC-ALPHA-MONTH        PIC X(10).
  2995             20  DC-ALPHA-DAY          PIC 99.
  2996             20  FILLER                PIC XX.
  2997             20  DC-ALPHA-CENTURY.
  2998                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  57
* EL050.cbl
  2999             20  DC-ALPHA-YEAR         PIC 99.
  3000         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3001         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3002         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3003         16  DC-JULIAN-DATE            PIC 9(05).
  3004         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3005                                       PIC 9(05).
  3006         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3007             20  DC-JULIAN-YEAR        PIC 99.
  3008             20  DC-JULIAN-DAYS        PIC 999.
  3009         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3010         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3011         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3012     12  DATE-CONVERSION-VARIBLES.
  3013         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3014         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3015             20  FILLER                PIC 9(3).
  3016             20  HOLD-CEN-1-CCYY.
  3017                 24  HOLD-CEN-1-CC     PIC 99.
  3018                 24  HOLD-CEN-1-YY     PIC 99.
  3019             20  HOLD-CEN-1-MO         PIC 99.
  3020             20  HOLD-CEN-1-DA         PIC 99.
  3021         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3022             20  HOLD-CEN-1-R-MO       PIC 99.
  3023             20  HOLD-CEN-1-R-DA       PIC 99.
  3024             20  HOLD-CEN-1-R-CCYY.
  3025                 24  HOLD-CEN-1-R-CC   PIC 99.
  3026                 24  HOLD-CEN-1-R-YY   PIC 99.
  3027             20  FILLER                PIC 9(3).
  3028         16  HOLD-CENTURY-1-X.
  3029             20  FILLER                PIC X(3)  VALUE SPACES.
  3030             20  HOLD-CEN-1-X-CCYY.
  3031                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3032                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3033             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3034             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3035         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3036             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3037             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3038             20  HOLD-CEN-1-R-X-CCYY.
  3039                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3040                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3041             20  FILLER                PIC XXX.
  3042         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3043         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3044         16  DC-JULIAN-DATE-1          PIC 9(07).
  3045         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3046             20  DC-JULIAN-1-CCYY.
  3047                 24  DC-JULIAN-1-CC    PIC 99.
  3048                 24  DC-JULIAN-1-YR    PIC 99.
  3049             20  DC-JULIAN-DA-1        PIC 999.
  3050         16  DC-JULIAN-DATE-2          PIC 9(07).
  3051         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3052             20  DC-JULIAN-2-CCYY.
  3053                 24  DC-JULIAN-2-CC    PIC 99.
  3054                 24  DC-JULIAN-2-YR    PIC 99.
  3055             20  DC-JULIAN-DA-2        PIC 999.
  3056         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  58
* EL050.cbl
  3057             20  DC-EDITA-MONTH        PIC 99.
  3058             20  SLASHA-1              PIC X VALUE '/'.
  3059             20  DC-EDITA-DAY          PIC 99.
  3060             20  SLASHA-2              PIC X VALUE '/'.
  3061             20  DC-EDITA-CCYY.
  3062                 24  DC-EDITA-CENT     PIC 99.
  3063                 24  DC-EDITA-YEAR     PIC 99.
  3064         16  DC-GREG-DATE-B-EDIT.
  3065             20  DC-EDITB-MONTH        PIC 99.
  3066             20  SLASHB-1              PIC X VALUE '/'.
  3067             20  DC-EDITB-DAY          PIC 99.
  3068             20  SLASHB-2              PIC X VALUE '/'.
  3069             20  DC-EDITB-CCYY.
  3070                 24  DC-EDITB-CENT     PIC 99.
  3071                 24  DC-EDITB-YEAR     PIC 99.
  3072         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3073         16  DC-GREG-DATE-CYMD-R REDEFINES
  3074                              DC-GREG-DATE-CYMD.
  3075             20  DC-CYMD-CEN           PIC 99.
  3076             20  DC-CYMD-YEAR          PIC 99.
  3077             20  DC-CYMD-MONTH         PIC 99.
  3078             20  DC-CYMD-DAY           PIC 99.
  3079         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3080         16  DC-GREG-DATE-MDCY-R REDEFINES
  3081                              DC-GREG-DATE-MDCY.
  3082             20  DC-MDCY-MONTH         PIC 99.
  3083             20  DC-MDCY-DAY           PIC 99.
  3084             20  DC-MDCY-CEN           PIC 99.
  3085             20  DC-MDCY-YEAR          PIC 99.
  3086    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3087        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3088    12  DC-EL310-DATE                  PIC X(21).
  3089    12  FILLER                         PIC X(28).
  3090
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  59
* EL050.cbl
  3092*    COPY ELCCALC.
  3093******************************************************************
  3094*                                                                *
  3095*                           ELCCALC.                            *
  3096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3097*                            VMOD=2.025                          *
  3098*                                                                *
  3099*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3100*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3101*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3102*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3103*                                                                *
  3104*  PASSED TO ELRTRM                                              *
  3105*  -----------------                                             *
  3106*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3107*  ORIGINAL TERM                                                 *
  3108*  BEGINNING DATE                                                *
  3109*  ENDING DATE                                                   *
  3110*  COMPANY I.D.                                                  *
  3111*  ACCOUNT MASTER USER FIELD                                     *
  3112*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3113*  FREE LOOK DAYS                                                *
  3114*                                                                *
  3115*  RETURNED FROM ELRTRM                                          *
  3116*  ---------------------                                         *
  3117*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3118*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3119*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3120*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3121*----------------------------------------------------------------*
  3122*  PASSED TO ELRAMT                                              *
  3123*  ----------------                                              *
  3124*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3125*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3126*  ORIGINAL AMOUNT                                               *
  3127*  ALTERNATE BENEFIT (BALLON)                                    *
  3128*  A.P.R. - NET PAY ONLY                                         *
  3129*  METHOD
  3130*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3131*  COMPANY I.D.                                                  *
  3132*  BENEFIT TYPE                                                  *
  3133*                                                                *
  3134*  RETURNED FROM ELRAMT                                          *
  3135*  --------------------                                          *
  3136*  REMAINING AMOUNT 1 - CURRENT                                  *
  3137*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3138*  REMAINING AMOUNT FACTOR
  3139*----------------------------------------------------------------*
  3140*  PASSED TO ELRESV                                              *
  3141*  -----------------                                             *
  3142*  CERTIFICATE EFFECTIVE DATE                                    *
  3143*  VALUATION DATE                                                *
  3144*  PAID THRU DATE                                                *
  3145*  BENEFIT                                                       *
  3146*  INCURRED DATE                                                 *
  3147*  REPORTED DATE                                                 *
  3148*  ISSUE AGE                                                     *
  3149*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  60
* EL050.cbl
  3150*  CDT PERCENT                                                   *
  3151*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3152* *CLAIM TYPE (LIFE, A/H)                                        *
  3153* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3154* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3155*                                                                *
  3156*  RETURNED FROM ELRESV                                          *
  3157*  --------------------                                          *
  3158*  CDT TABLE USED                                                *
  3159*  CDT FACTOR USED                                               *
  3160*  PAY TO CURRENT RESERVE                                        *
  3161*  I.B.N.R. - A/H ONLY                                           *
  3162*  FUTURE (ACCRUED) AH ONLY                                      *
  3163*----------------------------------------------------------------*
  3164*  PASSED TO ELRATE                                              *
  3165*  ----------------                                              *
  3166*  CERT ISSUE DATE                                               *
  3167*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3168*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3169*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3170*  STATE CODE (CLIENT DEFINED)                                   *
  3171*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3172*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3173*  DEVIATION CODE                                                *
  3174*  ISSUE AGE                                                     *
  3175*  ORIGINAL BENEFIT AMOUNT                                       *
  3176*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3177*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3178*  BENEFIT KIND (LIFE OR A/H)                                    *
  3179*  A.P.R.                                                        *
  3180*  METHOD
  3181*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3182*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3183*  COMPANY I.D. (3 CHARACTER)                                    *
  3184*  BENEFIT CODE                                                  *
  3185*  BENEFIT OVERRIDE CODE                                         *
  3186*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3187*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3188*  JOINT INDICATOR (CSL ONLY)                                    *
  3189*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3190*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3191*                                                                *
  3192*  RETURNED FROM ELRATE                                          *
  3193*  --------------------                                          *
  3194*  CALCULATED PREMIUM                                            *
  3195*  PREMIUM RATE                                                  *
  3196*  MORTALITY CODE                                                *
  3197*  MAX ATTAINED AGE                                              *
  3198*  MAX AGE                                                       *
  3199*  MAX TERM                                                      *
  3200*  MAX MONTHLY BENEFIT                                           *
  3201*  MAX TOTAL BENIFIT                                             *
  3202*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3203*----------------------------------------------------------------*
  3204*  PASSED TO ELRFND                                              *
  3205*  ----------------                                              *
  3206*  CERT ISSUE DATE                                               *
  3207*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  61
* EL050.cbl
  3208*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3209*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3210*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3211*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3212*  STATE CODE (CLIENT DEFINED)                                   *
  3213*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3214*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3215*  DEVIATION CODE                                                *
  3216*  ISSUE AGE                                                     *
  3217*  ORIGINAL BENEFIT AMOUNT                                       *
  3218*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3219*  PROCESS TYPE (CANCEL)                                         *
  3220*  BENEFIT KIND (LIFE OR A/H)                                    *
  3221*  A.P.R.                                                        *
  3222*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3223*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3224*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3225*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3226*  COMPANY I.D. (3 CHARACTER)                                    *
  3227*  BENEFIT CODE                                                  *
  3228*  BENEFIT OVERRIDE CODE                                         *
  3229*                                                                *
  3230*  RETURNED FROM ELRFND                                          *
  3231*  --------------------                                          *
  3232*  CALCULATED REFUND                                             *
  3233*----------------------------------------------------------------*
  3234*  PASSED TO ELEARN                                              *
  3235*  ----------------                                              *
  3236*  CERT ISSUE DATE                                               *
  3237*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3238*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3239*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3240*  STATE CODE (CLIENT DEFINED)                                   *
  3241*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3242*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3243*  DEVIATION CODE                                                *
  3244*  ISSUE AGE                                                     *
  3245*  ORIGINAL BENEFIT AMOUNT                                       *
  3246*  BENEFIT KIND (LIFE OR A/H)                                    *
  3247*  A.P.R.                                                        *
  3248*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3249*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3250*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3251*  COMPANY I.D. (3 CHARACTER)                                    *
  3252*  BENEFIT CODE                                                  *
  3253*  BENEFIT OVERRIDE CODE                                         *
  3254*                                                                *
  3255*  RETURNED FROM ELEARN                                          *
  3256*  --------------------                                          *
  3257*  INDICATED  EARNINGS                                           *
  3258*----------------------------------------------------------------*
  3259*                 LENGTH = 450                                   *
  3260*                                                                *
  3261******************************************************************
  3262******************************************************************
  3263*                   C H A N G E   L O G
  3264*
  3265* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  62
* EL050.cbl
  3266*-----------------------------------------------------------------
  3267*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3268* EFFECTIVE    NUMBER
  3269*-----------------------------------------------------------------
  3270* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3271* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3272* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3273* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3274* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3275* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3276* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3277* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3278* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3279******************************************************************
  3280
  3281 01  CALCULATION-PASS-AREA.
  3282     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3283                                     COMP.
  3284
  3285     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3286       88  NO-CP-ERROR                             VALUE ZERO.
  3287       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3288                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3289       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3290       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3291       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3292       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3293       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3294       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3295       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3296       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3297       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3298       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3299       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3300       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3301       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3302       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3303       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3304       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3305       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3306
  3307     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3308       88  NO-CP-ERROR-2                           VALUE ZERO.
  3309***********************  INPUT AREAS ****************************
  3310
  3311     12  CP-CALCULATION-AREA.
  3312         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3313         16  CP-CERT-EFF-DT        PIC XX.
  3314         16  CP-VALUATION-DT       PIC XX.
  3315         16  CP-PAID-THRU-DT       PIC XX.
  3316         16  CP-BENEFIT-TYPE       PIC X.
  3317           88  CP-AH                               VALUE 'A' 'D'
  3318                                                   'I' 'U'.
  3319           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3320           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3321         16  CP-INCURRED-DT        PIC XX.
  3322         16  CP-REPORTED-DT        PIC XX.
  3323         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  63
* EL050.cbl
  3324         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3325         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3326                                     COMP-3.
  3327         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3328                                     COMP-3.
  3329         16  CP-CDT-METHOD         PIC X.
  3330           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3331           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3332           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3333         16  CP-CLAIM-TYPE         PIC X.
  3334           88  CP-AH-CLAIM                         VALUE 'A'.
  3335           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3336         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3337                                     COMP-3.
  3338         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3339                                     COMP-3.
  3340         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3341                                     COMP-3.
  3342         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3343                                     COMP-3.
  3344         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3345                                     COMP-3.
  3346         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3347                                     COMP-3.
  3348         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3349                                     COMP-3.
  3350         16  CP-REM-TERM-METHOD    PIC X.
  3351           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3352           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3353           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3354           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3355           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3356           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3357           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3358         16  CP-EARNING-METHOD     PIC X.
  3359           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3360           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3361           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3362           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3363           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3364           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3365           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3366           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3367           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3368           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3369           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3370           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3371           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3372           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3373         16  CP-PROCESS-TYPE       PIC X.
  3374           88  CP-CLAIM                            VALUE '1'.
  3375           88  CP-CANCEL                           VALUE '2'.
  3376           88  CP-ISSUE                            VALUE '3'.
  3377         16  CP-SPECIAL-CALC-CD    PIC X.
  3378           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3379           88  CP-1-MTH-INTEREST               VALUE ' '.
  3380           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3381           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  64
* EL050.cbl
  3382           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3383           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3384           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3385           88  CP-FARM-PLAN                    VALUE 'F'.
  3386           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3387           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3388           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3389           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3390           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3391           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3392           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3393           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3394           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3395           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3396                                                     'W' 'X'.
  3397           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3398           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3399           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3400           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3401           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3402           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3403           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3404           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3405           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3406           88  CP-CSL-METH-1                   VALUE '5'.
  3407           88  CP-CSL-METH-2                   VALUE '6'.
  3408           88  CP-CSL-METH-3                   VALUE '7'.
  3409           88  CP-CSL-METH-4                   VALUE '8'.
  3410
  3411         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3412                                     COMP-3.
  3413         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3414         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3415         16  CP-STATE              PIC XX          VALUE SPACE.
  3416         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3417         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3418           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3419               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3420         16  CP-R78-OPTION         PIC X.
  3421           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3422           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3423
  3424         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3425         16  CP-IBNR-RESERVE-SW    PIC X.
  3426         16  CP-CLAIM-STATUS       PIC X.
  3427         16  CP-RATE-FILE          PIC X.
  3428         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3429                                     COMP-3.
  3430
  3431         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3432         16  CP-AH-OVERRIDE-CODE   PIC X.
  3433
  3434         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3435                                     COMP-3.
  3436         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3437                                   PIC S9(5)V99 COMP-3.
  3438         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3439                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  65
* EL050.cbl
  3440         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3441                                     COMP-3.
  3442         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3443                                     COMP-3.
  3444         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3445                                  PIC S9(7)V99 COMP-3.
  3446
  3447         16  CP-PAID-FROM-DATE     PIC X(02).
  3448         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3449         16  CP-EXT-DAYS-CALC      PIC X.
  3450           88  CP-EXT-NO-CHG                   VALUE ' '.
  3451           88  CP-EXT-CHG-LF                   VALUE '1'.
  3452           88  CP-EXT-CHG-AH                   VALUE '2'.
  3453           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3454         16  CP-DOMICILE-STATE     PIC XX.
  3455         16  CP-CARRIER            PIC X.
  3456         16  CP-REIN-FLAG          PIC X.
  3457         16  CP-REM-TRM-CALC-OPTION PIC X.
  3458           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3459                      '2' '3' '4' '5'.
  3460           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3461           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3462           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3463           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3464           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3465           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3466           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3467           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3468         16  CP-SIG-SWITCH         PIC X.
  3469         16  CP-RATING-METHOD      PIC X.
  3470           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3471           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3472           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3473           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3474           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3475           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3476           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3477           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3478           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3479         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3480                                     COMP-3.
  3481         16  CP-BEN-CATEGORY       PIC X.
  3482         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3483         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3484                                   PIC S99V9(5) COMP-3.
  3485         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3486         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3487                                   PIC S99V9(5) COMP-3.
  3488         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3489         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3490         16  CP-EXPIRE-DT          PIC XX.
  3491         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3492         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3493         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3494         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3495         16  CP-DDF-SPEC-CALC      PIC X.
  3496             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3497             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  66
* EL050.cbl
  3498         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3499         16  CP-CANCEL-REASON      PIC X.
  3500         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3501         16  CP-PMT-MODE           PIC X.
  3502         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3503         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3504         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3505         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3506         16  FILLER                PIC X.
  3507
  3508***************    OUTPUT FROM ELRESV   ************************
  3509
  3510         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3511
  3512         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3513                                     COMP-3.
  3514         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3515                                     COMP-3.
  3516         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3517                                     COMP-3.
  3518         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3519                                     COMP-3.
  3520         16  FILLER                PIC X(09).
  3521***************    OUTPUT FROM ELRTRM   *************************
  3522
  3523         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3524                                     COMP-3.
  3525         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3530                                     COMP-3.
  3531         16  FILLER                PIC X(12).
  3532
  3533***************    OUTPUT FROM ELRAMT   *************************
  3534
  3535         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3536                                     COMP-3.
  3537         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3538                                     COMP-3.
  3539         16  FILLER                PIC X(12).
  3540
  3541***************    OUTPUT FROM ELRATE   *************************
  3542
  3543         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3544                                     COMP-3.
  3545         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3546                                     COMP-3.
  3547         16  CP-MORTALITY-CODE     PIC X(4).
  3548         16  CP-RATE-EDIT-FLAG     PIC X.
  3549             88  CP-RATES-NEED-APR                  VALUE '1'.
  3550         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3553         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3554         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3555                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  67
* EL050.cbl
  3556         16  FILLER                PIC X(07).
  3557
  3558***************    OUTPUT FROM ELRFND   *************************
  3559
  3560         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-REFUND-TYPE-USED   PIC X.
  3563           88  CP-R-AS-R78                         VALUE '1'.
  3564           88  CP-R-AS-PRORATA                     VALUE '2'.
  3565           88  CP-R-AS-CALIF                       VALUE '3'.
  3566           88  CP-R-AS-TEXAS                       VALUE '4'.
  3567           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3568           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3569           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3570           88  CP-R-AS-MEAN                        VALUE '8'.
  3571           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3572           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3573           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3574           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3575           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3576           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3577         16  FILLER                PIC X(12).
  3578
  3579***************    OUTPUT FROM ELEARN   *************************
  3580
  3581         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-EARNING-TYPE-USED  PIC X.
  3594           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3595           88  CP-E-AS-R78                         VALUE '1'.
  3596           88  CP-E-AS-PRORATA                     VALUE '2'.
  3597           88  CP-E-AS-TEXAS                       VALUE '4'.
  3598           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3599           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3600           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3601           88  CP-E-AS-MEAN                        VALUE '8'.
  3602           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3603         16  FILLER                PIC X(12).
  3604
  3605***************    OUTPUT FROM ELPMNT   *************************
  3606
  3607         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3608                                     COMP-3.
  3609         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3610                                     COMP-3.
  3611         16  FILLER                PIC X(12).
  3612
  3613***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  68
* EL050.cbl
  3614         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3615                                     COMP-3.
  3616         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3617                                     COMP-3.
  3618         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3619                                     COMP-3.
  3620         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3621                                     COMP-3.
  3622         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3623                                     COMP-3.
  3624         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3625                                     COMP-3.
  3626         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3627             88  OPEN-RATE-FILE                   VALUE 'O'.
  3628             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3629             88  IO-ERROR                         VALUE 'E'.
  3630
  3631         16  CP-FIRST-PAY-DATE     PIC XX.
  3632
  3633         16  CP-JOINT-INDICATOR    PIC X.
  3634
  3635         16  CP-RESERVE-REMAINING-TERM
  3636                                   PIC S9(4)V9    VALUE ZERO
  3637                                     COMP-3.
  3638
  3639         16  CP-INSURED-BIRTH-DT   PIC XX.
  3640
  3641         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3642                                     COMP-3.
  3643
  3644         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3645                                     COMP-3.
  3646
  3647         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3648                                     COMP-3.
  3649
  3650         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3651                                     COMP-3.
  3652
  3653         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3654                                     COMP-3.
  3655
  3656         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3657                                     COMP-3.
  3658
  3659         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3660                                     COMP-3.
  3661
  3662         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3663             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3664
  3665         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3670         16  FILLER                PIC X(15).
  3671******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  69
* EL050.cbl
  3673******************************************************************
  3674*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3675*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3676*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3677*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3678*** MODIFICATION.                                              ***
  3679*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3680*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3681******************************************************************
  3682*    COPY ERCPNDB.
  3683******************************************************************
  3684*                                                                *
  3685*                                                                *
  3686*                            ERCPNDB.                            *
  3687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3688*                            VMOD=2.025                          *
  3689*                                                                *
  3690*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3691*                                                                *
  3692******************************************************************
  3693*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3694*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3695******************************************************************
  3696*                                                                *
  3697*                                                                *
  3698*   FILE TYPE = VSAM,KSDS                                        *
  3699*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3700*                                                                *
  3701*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3702*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3703*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3704*                                                 RKP=13,LEN=36  *
  3705*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3706*                                      AND CHG-SEQ.)             *
  3707*                                                RKP=49,LEN=11   *
  3708*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3709*                                      AND CHG-SEQ.)             *
  3710*                                                RKP=60,LEN=15   *
  3711*                                                                *
  3712*   LOG = NO                                                     *
  3713*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3714******************************************************************
  3715******************************************************************
  3716*                   C H A N G E   L O G
  3717*
  3718* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3719*-----------------------------------------------------------------
  3720*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3721* EFFECTIVE    NUMBER
  3722*-----------------------------------------------------------------
  3723* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3724* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3725* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3726* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3727* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3728* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3729* 032306                   PEMA  ADD BOW LOAN NUMBER
  3730* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  70
* EL050.cbl
  3731* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3732* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3733* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3734* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3735* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3736* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3737* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3738******************************************************************
  3739
  3740 01  PENDING-BUSINESS.
  3741     12  PB-RECORD-ID                     PIC XX.
  3742         88  VALID-PB-ID                        VALUE 'PB'.
  3743
  3744     12  PB-CONTROL-PRIMARY.
  3745         16  PB-COMPANY-CD                PIC X.
  3746         16  PB-ENTRY-BATCH               PIC X(6).
  3747         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3748         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3749
  3750     12  PB-CONTROL-BY-ACCOUNT.
  3751         16  PB-COMPANY-CD-A1             PIC X.
  3752         16  PB-CARRIER                   PIC X.
  3753         16  PB-GROUPING.
  3754             20  PB-GROUPING-PREFIX       PIC XXX.
  3755             20  PB-GROUPING-PRIME        PIC XXX.
  3756         16  PB-STATE                     PIC XX.
  3757         16  PB-ACCOUNT.
  3758             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3759             20  PB-ACCOUNT-PRIME         PIC X(6).
  3760         16  PB-CERT-EFF-DT               PIC XX.
  3761         16  PB-CERT-NO.
  3762             20  PB-CERT-PRIME            PIC X(10).
  3763             20  PB-CERT-SFX              PIC X.
  3764         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3765
  3766         16  PB-RECORD-TYPE               PIC X.
  3767             88  PB-MAILING-DATA                VALUE '0'.
  3768             88  PB-ISSUE                       VALUE '1'.
  3769             88  PB-CANCELLATION                VALUE '2'.
  3770             88  PB-BATCH-TRAILER               VALUE '9'.
  3771
  3772     12  PB-CONTROL-BY-ORIG-BATCH.
  3773         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3774         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3775         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3776         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3777
  3778     12  PB-CONTROL-BY-CSR.
  3779         16  PB-CSR-COMPANY-CD            PIC X.
  3780         16  PB-CSR-ID                    PIC X(4).
  3781         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3782         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3783         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3784******************************************************************
  3785*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3786******************************************************************
  3787
  3788     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  71
* EL050.cbl
  3789     12  PB-LAST-MAINT-BY                 PIC X(4).
  3790     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3791
  3792     12  PB-RECORD-BODY                   PIC X(375).
  3793
  3794     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3795         16  PB-CERT-ORIGIN               PIC X.
  3796             88  CLASIC-CREATED-CERT         VALUE '1'.
  3797         16  PB-I-NAME.
  3798             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3799             20  PB-I-INSURED-FIRST-NAME.
  3800                 24  PB-I-INSURED-1ST-INIT PIC X.
  3801                 24  FILLER                PIC X(9).
  3802             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3803         16  PB-I-AGE                     PIC S99   COMP-3.
  3804         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3805         16  PB-I-BIRTHDAY                PIC XX.
  3806         16  PB-I-INSURED-SEX             PIC X.
  3807             88  PB-SEX-MALE     VALUE 'M'.
  3808             88  PB-SEX-FEMALE   VALUE 'F'.
  3809
  3810         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3811         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3812         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3813         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3814         16  PB-I-SKIP-CODE               PIC X.
  3815             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3816             88  PB-SKIP-JULY              VALUE '1'.
  3817             88  PB-SKIP-AUGUST            VALUE '2'.
  3818             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3819             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3820             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3821             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3822             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3823             88  PB-SKIP-JUNE              VALUE '8'.
  3824             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3825             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3826             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3827         16  PB-I-TERM-TYPE               PIC X.
  3828             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3829             88  PB-PAID-WEEKLY            VALUE 'W'.
  3830             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3831             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3832             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3833         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3834         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3835         16  PB-I-DATA-ENTRY-SW           PIC X.
  3836             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3837             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3838             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3839             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3840         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3841         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3842*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3843         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3844         16  FILLER                       PIC X.
  3845
  3846         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  72
* EL050.cbl
  3847             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3848             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3849                                                   '90' THRU '99'.
  3850         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3851                                          PIC XX.
  3852         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3853         16  PB-I-AMOUNT-FINANCED REDEFINES
  3854                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3855         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3856         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3857                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3858         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3859         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3860         16  PB-I-CLP-AMOUNT REDEFINES
  3861                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3862         16  PB-I-LF-CALC-FLAG            PIC X.
  3863             88 PB-COMP-LF-PREM               VALUE '?'.
  3864         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3865         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3866         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3867         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3868         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3869         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3870         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3871         16  PB-I-LF-ABBR                 PIC XXX.
  3872         16  PB-I-LF-INPUT-CD             PIC XX.
  3873
  3874         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3875             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3876             88  PB-INVALID-AH               VALUE '  ' '00'
  3877                                                   '90' THRU '99'.
  3878         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3879         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3880         16  PB-I-AH-CALC-FLAG            PIC X.
  3881             88 PB-COMP-AH-PREM                  VALUE '?'.
  3882         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3883         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3884         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3885         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3886         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3887         16  PB-I-AH-ABBR                 PIC XXX.
  3888         16  PB-I-AH-INPUT-CD             PIC XXX.
  3889
  3890         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3891         16  PB-I-REIN-TABLE              PIC XXX.
  3892         16  PB-I-BUSINESS-TYPE           PIC 99.
  3893         16  PB-I-INDV-GRP-CD             PIC X.
  3894         16  PB-I-MORT-CODE.
  3895             20  PB-I-TABLE               PIC X.
  3896             20  PB-I-INTEREST            PIC XX.
  3897             20  PB-I-MORT-TYP            PIC X.
  3898         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3899         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3900         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3901         16  PB-I-INDV-GRP-OVRD           PIC X.
  3902         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3903         16  PB-I-SIG-SW                  PIC X.
  3904             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  73
* EL050.cbl
  3905         16  PB-I-RATE-CLASS              PIC XX.
  3906         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3907         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3908         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3909         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3910         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3911         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3912         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3913         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3914         16  PB-I-OB-FLAG                 PIC X.
  3915             88  PB-I-OB                      VALUE 'B'.
  3916             88  PB-I-SUMMARY                 VALUE 'Z'.
  3917         16  PB-I-ENTRY-STATUS            PIC X.
  3918             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3919                                              'M' '5' '9' '2'.
  3920             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3921             88  PB-I-POLICY-PENDING          VALUE '2'.
  3922             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3923             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3924             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3925             88  PB-I-REIN-ONLY               VALUE '9'.
  3926             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3927             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3928             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3929             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3930         16  PB-I-INT-CODE                PIC X.
  3931             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3932             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3933         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3934         16  PB-I-SOC-SEC-NO              PIC X(11).
  3935         16  PB-I-MEMBER-NO               PIC X(12).
  3936         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3937*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3938         16  PB-I-OLD-LOF                 PIC XXX.
  3939         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3940         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3941         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3942         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3943         16  PB-I-LIFE-INDICATOR          PIC X.
  3944             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3945         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3946         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3947                                          PIC S9(5)V99    COMP-3.
  3948         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3949             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3950             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3951         16  PB-I-1ST-PMT-DT              PIC XX.
  3952         16  PB-I-JOINT-INSURED.
  3953             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3954             20 PB-I-JOINT-FIRST-NAME.
  3955                24  PB-I-JOINT-FIRST-INIT PIC X.
  3956                24  FILLER                PIC X(9).
  3957             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3958*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3959         16  PB-I-BENEFICIARY-NAME.
  3960             20  PB-I-BANK-NUMBER         PIC X(10).
  3961             20  FILLER                   PIC X(15).
  3962         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  74
* EL050.cbl
  3963         16  PB-I-REFERENCE               PIC X(12).
  3964         16  FILLER REDEFINES PB-I-REFERENCE.
  3965             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3966             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3967             20  PB-I-CLP-STATE           PIC XX.
  3968         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3969             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3970             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3971             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3972         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3973         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3974         16  PB-I-RESIDENT-STATE          PIC XX.
  3975         16  PB-I-RATE-CODE               PIC X(4).
  3976         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3977         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3978         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3979         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3980         16  PB-I-BANK-NOCHRGB            PIC 99.
  3981         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3982         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3983
  3984     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3985         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3986             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3987         16  PB-C-CANCEL-ORIGIN           PIC X.
  3988             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3989         16  PB-C-LF-CANCEL-DT            PIC XX.
  3990         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3991         16  PB-C-LF-CALC-REQ             PIC X.
  3992             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3993         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3994         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3995         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3996             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3997         16  PB-C-AH-CANCEL-DT            PIC XX.
  3998         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3999         16  PB-C-AH-CALC-REQ             PIC X.
  4000             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4001         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4002         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4003         16  PB-C-LAST-NAME               PIC X(15).
  4004         16  PB-C-REFUND-SW               PIC X.
  4005             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4006             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4007         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4008         16  PB-C-PAYEE-CODE              PIC X(6).
  4009         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4010         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4011         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4012         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4013         16  PB-C-REFERENCE               PIC X(12).
  4014         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4015         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4016         16  PB-C-POST-CARD-IND           PIC X.
  4017         16  PB-C-CANCEL-REASON           PIC X.
  4018         16  PB-C-REF-INTERFACE-SW        PIC X.
  4019         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4020         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  75
* EL050.cbl
  4021         16  FILLER                       PIC X(01).
  4022*        16  FILLER                       PIC X(18).
  4023         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4024*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4025         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4026         16  PB-CANCELED-CERT-DATA.
  4027             20  PB-CI-INSURED-NAME.
  4028                 24  PB-CI-LAST-NAME      PIC X(15).
  4029                 24  PB-CI-INITIALS       PIC XX.
  4030             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4031             20  PB-CI-INSURED-SEX        PIC X.
  4032             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4033             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4034             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4035             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4036             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4037             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4038             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4039             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4040             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4041             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4042             20  PB-CI-RATE-CLASS         PIC XX.
  4043             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4044             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4045             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4046             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4047             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4048             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4049             20  PB-CI-LF-ABBR            PIC X(3).
  4050             20  PB-CI-AH-ABBR            PIC X(3).
  4051             20  PB-CI-OB-FLAG            PIC X.
  4052                 88  PB-CI-OB                VALUE 'B'.
  4053             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4054                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4055                                           'M' '4' '5' '9' '2'.
  4056                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4057                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4058                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4059                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4060                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4061                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4062                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4063                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4064                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4065                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4066                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4067                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4068             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4069                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4070                                           'M' '4' '5' '9' '2'.
  4071                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4072                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4073                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4074                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4075                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4076                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4077                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4078                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  76
* EL050.cbl
  4079                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4080                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4081                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4082                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4083             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4084             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4085             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4086             20  PB-CI-MEMBER-NO          PIC X(12).
  4087             20  PB-CI-INT-CODE           PIC X.
  4088                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4089                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4090             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4091             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4092             20  PB-CI-COMP-EXCP-SW       PIC X.
  4093                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4094                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4095             20  PB-CI-ENTRY-STATUS       PIC X.
  4096             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4097             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4098             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4099             20  PB-CI-DEATH-DT           PIC XX.
  4100             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4101             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4102             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4103             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4104             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4105             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4106             20  PB-CI-ENTRY-DT              PIC XX.
  4107             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4108             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4109             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4110             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4111             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4112             20  PB-CI-OLD-LOF               PIC XXX.
  4113*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4114             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4115             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4116             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4117             20  PB-CI-INDV-GRP-CD           PIC X.
  4118             20  PB-CI-BENEFICIARY-NAME.
  4119                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4120                 24  FILLER                  PIC X(15).
  4121             20  PB-CI-NOTE-SW               PIC X.
  4122             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4123             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4124             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4125             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4126             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4127             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4128             20  PB-CI-FIRST-NAME            PIC X(10).
  4129             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4130
  4131         16  FILLER                       PIC X(13).
  4132*032306  16  FILLER                       PIC X(27).
  4133*        16  FILLER                       PIC X(46).
  4134
  4135     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4136         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  77
* EL050.cbl
  4137         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4138         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4139         16  PB-M-INSURED-MID-INIT        PIC X.
  4140         16  PB-M-INSURED-AGE             PIC 99.
  4141         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4142         16  PB-M-INSURED-SEX             PIC X.
  4143         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4144         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4145         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4146         16  PB-M-INSURED-CITY-STATE.
  4147             20  PB-M-INSURED-CITY        PIC X(28).
  4148             20  PB-M-INSURED-STATE       PIC XX.
  4149         16  PB-M-INSURED-ZIP-CODE.
  4150             20  PB-M-INSURED-ZIP-PRIME.
  4151                 24  PB-M-INSURED-ZIP-1   PIC X.
  4152                     88  PB-M-CANADIAN-POST-CODE
  4153                                             VALUE 'A' THRU 'Z'.
  4154                 24  FILLER               PIC X(4).
  4155             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4156         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4157                                        PB-M-INSURED-ZIP-CODE.
  4158             20  PM-M-INS-CAN-POST1       PIC XXX.
  4159             20  PM-M-INS-CAN-POST2       PIC XXX.
  4160             20  FILLER                   PIC XXX.
  4161         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4162         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4163         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4164         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4165         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4166         16  PB-M-CRED-BENE-CITYST.
  4167             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4168             20  PB-M-CRED-BENE-STATE     PIC XX.
  4169         16  FILLER                       PIC X(92).
  4170
  4171     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4172         16  FILLER                       PIC X(10).
  4173         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4174         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4175         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4176         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4177         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4178         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4179         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4180         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4181         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4182         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4183         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4184         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4185         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4186         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4187         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4188         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4189         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4190         16  PB-ACCOUNT-NAME              PIC X(30).
  4191         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4192         16  PB-REFERENCE                 PIC X(12).
  4193         16  PB-B-RECEIVED-DT             PIC XX.
  4194         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  78
* EL050.cbl
  4195
  4196     12  PB-RECORD-STATUS.
  4197         16  PB-CREDIT-SELECT-DT          PIC XX.
  4198         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4199         16  PB-BILLED-DT                 PIC XX.
  4200         16  PB-BILLING-STATUS            PIC X.
  4201             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4202             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4203             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4204         16  PB-RECORD-BILL               PIC X.
  4205             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4206             88  PB-RECORD-RETURNED           VALUE 'R'.
  4207             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4208             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4209             88  PB-OVERRIDE-AH               VALUE 'A'.
  4210             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4211         16  PB-BATCH-ENTRY               PIC X.
  4212             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4213             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4214             88  PB-REISSUED-CERT             VALUE 'E'.
  4215             88  PB-MONTHLY-CERT              VALUE 'M'.
  4216             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4217             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4218             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4219         16  PB-FORCE-CODE                PIC X.
  4220             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4221             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4222             88  PB-CANCEL-FORCE              VALUE '8'.
  4223             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4224             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4225             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4226             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4227             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4228             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4229             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4230         16  PB-FATAL-FLAG                PIC X.
  4231             88  PB-FATAL-ERRORS              VALUE 'X'.
  4232         16  PB-FORCE-ER-CD               PIC X.
  4233             88  PB-FORCE-ERRORS              VALUE 'F'.
  4234             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4235         16  PB-WARN-ER-CD                PIC X.
  4236             88  PB-WARNING-ERRORS            VALUE 'W'.
  4237         16  FILLER                       PIC X.
  4238         16  PB-OUT-BAL-CD                PIC X.
  4239             88  PB-OUT-OF-BAL                VALUE 'O'.
  4240         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4241         16  PB-AH-OVERRIDE-L1            PIC X.
  4242         16  PB-INPUT-DT                  PIC XX.
  4243         16  PB-INPUT-BY                  PIC X(4).
  4244         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4245         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4246         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4247         16  PB-LF-EARNING-METHOD         PIC X.
  4248         16  PB-AH-EARNING-METHOD         PIC X.
  4249         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4250         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4251         16  PB-REIN-CD                   PIC XXX.
  4252         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  79
* EL050.cbl
  4253         16  PB-AH-REFUND-TYPE            PIC X.
  4254         16  PB-ACCT-EFF-DT               PIC XX.
  4255         16  PB-ACCT-EXP-DT               PIC XX.
  4256         16  PB-COMPANY-ID                PIC X(3).
  4257         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4258         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4259         16  PB-SV-CARRIER                PIC X.
  4260         16  PB-SV-GROUPING               PIC X(6).
  4261         16  PB-SV-STATE                  PIC XX.
  4262         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4263         16  PB-GA-BILLING-INFO.
  4264             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4265                                          PIC XX.
  4266         16  PB-SV-REMIT-TO  REDEFINES
  4267             PB-GA-BILLING-INFO           PIC X(10).
  4268         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4269         16  PB-I-LOAN-OFFICER            PIC X(5).
  4270         16  PB-I-VIN                     PIC X(17).
  4271
  4272         16  FILLER                       PIC X(04).
  4273         16  IMNET-BYPASS-SW              PIC X.
  4274
  4275******************************************************************
  4276*                COMMON EDIT ERRORS                              *
  4277******************************************************************
  4278
  4279     12  PB-COMMON-ERRORS.
  4280         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4281                                           PIC S9(4)     COMP.
  4282
  4283******************************************************************
  4284
  4285* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4286*    COPY ELC50W1.
  4287******************************************************************
  4288*                                                                *
  4289*                                                                *
  4290*                             ELC50W1                            *
  4291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4292*                            VMOD=2.004                          *
  4293*                                                                *
  4294*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4295*                                                                *
  4296*                                                                *
  4297******************************************************************
  4298
  4299     12  WK-WORK-AREA.
  4300         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4301         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4302         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4303         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4304         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4305         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4306         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4307         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4308         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4309         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4310         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  80
* EL050.cbl
  4311         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4312         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4313         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4314         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4315         16  WK-CREDIT-EDIT-CONTROLS.
  4316             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4317             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4318             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4319             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4320             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4321             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4322         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4323         16  WK-SAVE-REIN-DATA.
  4324             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4325             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4326             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4327         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4328             88  ENTRY-FROM-EL6311       VALUE '6'.
  4329         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4330         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4331     12  WK-RECORD-ADDRESSES.
  4332         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4333         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4334         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4335         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4336         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4337         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4338         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4339         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4340     12  WK-OVER-SHORT-AREA.
  4341         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4342         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4343         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4344             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4345         16  FILLER                   PIC X(5) VALUE SPACES.
  4346
  4347*    COPY ELCEDITC.
  4348******************************************************************
  4349*                                                                *
  4350*                                                                *
  4351*                            ELCEDITC                            *
  4352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4353*                            VMOD=2.012                          *
  4354*                                                                *
  4355*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4356*                     EL6313, EL050 AND EL517.                   *
  4357*                                                                *
  4358******************************************************************
  4359******************************************************************
  4360*                   C H A N G E   L O G
  4361*
  4362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4363*-----------------------------------------------------------------
  4364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4365* EFFECTIVE    NUMBER
  4366*-----------------------------------------------------------------
  4367* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4368******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  81
* EL050.cbl
  4369
  4370     12  EDIT-CRITERIA-DATA.
  4371         16  EC-CO-MONTH-END-DT       PIC XX.
  4372         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4373         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4374         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4375         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4376         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4377         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4378         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4379         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4380         16  EC-CO-REM-TERM-CALC      PIC X.
  4381               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4382               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4383               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4384               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4385
  4386         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4387               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4388               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4389               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4390               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4391               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4392               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4393               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4394               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4395               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4396               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4397
  4398         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4399               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4400               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4401               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4402               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4403               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4404               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4405               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4406               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4407
  4408         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4409                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4410                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4411
  4412         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4413                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4414                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4415                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4416                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4417                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4418                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4419                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4420                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4421
  4422         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4423               88  EC-BR-REDUCING                   VALUE 'R'.
  4424               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4425
  4426         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  82
* EL050.cbl
  4427         16  EC-BR-LF-DESC             PIC X(10).
  4428         16  EC-BR-AH-DESC             PIC X(10).
  4429         16  EC-BR-LF-COMMENT          PIC X(10).
  4430         16  EC-BR-AH-COMMENT          PIC X(10).
  4431
  4432         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4433               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4434               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4435               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4436               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4437
  4438         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4439               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4440               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4441               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4442               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4443
  4444         16  EC-BR-LF-REFUND-CALC      PIC X.
  4445                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4446                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4447                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4448                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4449                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4450                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4451                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4452
  4453         16  EC-BR-AH-REFUND-CALC      PIC X.
  4454                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4455                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4456                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4457                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4458                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4459                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4460                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4461                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4462
  4463         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4464                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4465                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4466                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4467
  4468         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4469                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4470                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4471                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4472
  4473         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4474         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4475         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4476         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4477
  4478         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4479         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4480                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4481                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4482                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4483                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4484
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  83
* EL050.cbl
  4485         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4486               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4487               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4488               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4489               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4490               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4491
  4492         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4493               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4494               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4495               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4496               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4497               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4498
  4499         16  EC-ST-LF-REFUND-CALC      PIC X.
  4500                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4501                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4502                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4503                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4504                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4505                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4506                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4507                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4508
  4509         16  EC-ST-AH-REFUND-CALC      PIC X.
  4510                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4511                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4512                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4513                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4514                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4515                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4516                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4517                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4518
  4519         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4520         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4521         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4522         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4523         16  EC-AM-EXPIRATION-DT       PIC XX.
  4524         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4525         16  EC-AM-CLASS-CD            PIC XX.
  4526         16  EC-AM-LF-DEVIATION        PIC XXX.
  4527         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4528         16  EC-AM-AH-DEVIATION        PIC XXX.
  4529         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4530         16  EC-AM-PHONE-NO            PIC X(10).
  4531
  4532         16  EC-AM-LF-REFUND-CALC      PIC X.
  4533                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4534                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4535                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4536                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4537                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4538                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4539                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4540
  4541         16  EC-AM-AH-REFUND-CALC      PIC X.
  4542                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  84
* EL050.cbl
  4543                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4544                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4545                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4546                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4547                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4548                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4549
  4550         16  EC-AM-BEN-I-G-CD          PIC X.
  4551                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4552                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4553                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4554
  4555         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4556         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4557         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4558         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4559         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4560         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4561         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4562         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4563         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4564
  4565         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4566         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4567         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4568         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4569         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4570         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4571         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4572         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4573         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4574         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4575         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4576         16  EC-RT-LF-NSP-ST           PIC XX.
  4577         16  EC-RT-AH-NSP-ST           PIC XX.
  4578         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4579         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4580
  4581         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4582             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4583                                             'M' '5' '9' '2'.
  4584             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4585             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4586             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4587             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4588             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4589             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4590             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4591             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4592             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4593             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4594
  4595         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4596             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4597                                             'M' '5' '9' '2'.
  4598             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4599             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4600             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  85
* EL050.cbl
  4601             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4602             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4603             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4604             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4605             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4606             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4607             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4608
  4609         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4610         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4611         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4612         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4613         16  EC-CM-DEATH-DT            PIC XX.
  4614
  4615*DMD CUSTOM CODING FIELDS BELOW
  4616*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4617         16  EC-BR-DMD-RATING-SW       PIC X.
  4618                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4619                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4620                 88  NO-DMD-RATING               VALUE 'N'.
  4621
  4622         16  EC-NEW-CERT               PIC X(11).
  4623         16  EC-NEW-STATE              PIC XX.
  4624         16  FILLER                    PIC X.
  4625*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4626         16  OVER-SHORT-EDIT-FIELDS.
  4627             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4628             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4629             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4630             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4631             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4632             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4633             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4634             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4635             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4636         16  FILLER                    PIC X(71).
  4637******************************************************************
  4638
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  86
* EL050.cbl
  4640*    COPY ELCDIFRD.
  4641******************************************************************
  4642*                                                                *
  4643*                                                                *
  4644*                            ELCDIFRD.                           *
  4645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4646*                            VMOD=2.004                          *
  4647*                                                                *
  4648*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4649*                                                                *
  4650******************************************************************
  4651*
  4652  01  WS-DIFFERENCE-CALCULATION.
  4653        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4654        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4655        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4656        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4657        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4658        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4659        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4660        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4661        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4662        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4663        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4664
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  87
* EL050.cbl
  4666****************************************************************
  4667*
  4668* Copyright (c) 2007 by Clerity Solutions, Inc.
  4669* All rights reserved.
  4670*
  4671****************************************************************
  4672 01  DFHEIV.
  4673   02  DFHEIV0               PIC X(35).
  4674   02  DFHEIV1               PIC X(08).
  4675   02  DFHEIV2               PIC X(08).
  4676   02  DFHEIV3               PIC X(08).
  4677   02  DFHEIV4               PIC X(06).
  4678   02  DFHEIV5               PIC X(04).
  4679   02  DFHEIV6               PIC X(04).
  4680   02  DFHEIV7               PIC X(02).
  4681   02  DFHEIV8               PIC X(02).
  4682   02  DFHEIV9               PIC X(01).
  4683   02  DFHEIV10              PIC S9(7) COMP-3.
  4684   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4685   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4686   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4687   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4688   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4689   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4690   02  DFHEIV17              PIC X(04).
  4691   02  DFHEIV18              PIC X(04).
  4692   02  DFHEIV19              PIC X(04).
  4693   02  DFHEIV20              USAGE IS POINTER.
  4694   02  DFHEIV21              USAGE IS POINTER.
  4695   02  DFHEIV22              USAGE IS POINTER.
  4696   02  DFHEIV23              USAGE IS POINTER.
  4697   02  DFHEIV24              USAGE IS POINTER.
  4698   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4699   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4700   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4701   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4702   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4703   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4704   02  FILLER                PIC X(02).
  4705   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4706   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4707   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4708   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4709   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4710 LINKAGE  SECTION.
  4711*****************************************************************
  4712*                                                               *
  4713* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4714* All rights reserved.                                          *
  4715*                                                               *
  4716*****************************************************************
  4717 01  dfheiblk.
  4718     02  eibtime          pic s9(7) comp-3.
  4719     02  eibdate          pic s9(7) comp-3.
  4720     02  eibtrnid         pic x(4).
  4721     02  eibtaskn         pic s9(7) comp-3.
  4722     02  eibtrmid         pic x(4).
  4723     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  88
* EL050.cbl
  4724     02  eibcposn         pic s9(4) comp.
  4725     02  eibcalen         pic s9(4) comp.
  4726     02  eibaid           pic x(1).
  4727     02  eibfiller1       pic x(1).
  4728     02  eibfn            pic x(2).
  4729     02  eibfiller2       pic x(2).
  4730     02  eibrcode         pic x(6).
  4731     02  eibfiller3       pic x(2).
  4732     02  eibds            pic x(8).
  4733     02  eibreqid         pic x(8).
  4734     02  eibrsrce         pic x(8).
  4735     02  eibsync          pic x(1).
  4736     02  eibfree          pic x(1).
  4737     02  eibrecv          pic x(1).
  4738     02  eibsend          pic x(1).
  4739     02  eibatt           pic x(1).
  4740     02  eibeoc           pic x(1).
  4741     02  eibfmh           pic x(1).
  4742     02  eibcompl         pic x(1).
  4743     02  eibsig           pic x(1).
  4744     02  eibconf          pic x(1).
  4745     02  eiberr           pic x(1).
  4746     02  eibrldbk         pic x(1).
  4747     02  eiberrcd         pic x(4).
  4748     02  eibsynrb         pic x(1).
  4749     02  eibnodat         pic x(1).
  4750     02  eibfiller5       pic x(2).
  4751     02  eibresp          pic 9(09) comp.
  4752     02  eibresp2         pic 9(09) comp.
  4753     02  dfheigdj         pic s9(4) comp.
  4754     02  dfheigdk         pic s9(4) comp.
  4755
  4756 01  DFHCOMMAREA                   PIC X(1036).
  4757
  4758*01 PARMLIST .
  4759*    02  FILLER                    PIC S9(8)   COMP.
  4760*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4761*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4762*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4763*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4764*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4765*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4766*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4767
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  89
* EL050.cbl
  4769*    COPY ELCCNTL.
  4770******************************************************************
  4771*                                                                *
  4772*                                                                *
  4773*                            ELCCNTL.                            *
  4774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4775*                            VMOD=2.059                          *
  4776*                                                                *
  4777*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4778*                                                                *
  4779*   FILE TYPE = VSAM,KSDS                                        *
  4780*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4781*                                                                *
  4782*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4783*       ALTERNATE INDEX = NONE                                   *
  4784*                                                                *
  4785*   LOG = YES                                                    *
  4786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4787******************************************************************
  4788*                   C H A N G E   L O G
  4789*
  4790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4791*-----------------------------------------------------------------
  4792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4793* EFFECTIVE    NUMBER
  4794*-----------------------------------------------------------------
  4795* 082503                   PEMA  ADD BENEFIT GROUP
  4796* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4797* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4798* 092705    2005050300006  PEMA  ADD SPP LEASES
  4799* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4800* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4801* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4802* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4803* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4804******************************************************************
  4805*
  4806 01  CONTROL-FILE.
  4807     12  CF-RECORD-ID                       PIC XX.
  4808         88  VALID-CF-ID                        VALUE 'CF'.
  4809
  4810     12  CF-CONTROL-PRIMARY.
  4811         16  CF-COMPANY-ID                  PIC XXX.
  4812         16  CF-RECORD-TYPE                 PIC X.
  4813             88  CF-COMPANY-MASTER              VALUE '1'.
  4814             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4815             88  CF-STATE-MASTER                VALUE '3'.
  4816             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4817             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4818             88  CF-CARRIER-MASTER              VALUE '6'.
  4819             88  CF-MORTALITY-MASTER            VALUE '7'.
  4820             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4821             88  CF-TERMINAL-MASTER             VALUE '9'.
  4822             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4823             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4824             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4825             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4826             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  90
* EL050.cbl
  4827             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4828             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4829             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4830             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4831         16  CF-ACCESS-CD-GENL              PIC X(4).
  4832         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4833             20  CF-PROCESSOR               PIC X(4).
  4834         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4835             20  CF-STATE-CODE              PIC XX.
  4836             20  FILLER                     PIC XX.
  4837         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4838             20  FILLER                     PIC XX.
  4839             20  CF-HI-BEN-IN-REC           PIC XX.
  4840         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4841             20  FILLER                     PIC XXX.
  4842             20  CF-CARRIER-CNTL            PIC X.
  4843         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4844             20  FILLER                     PIC XX.
  4845             20  CF-HI-TYPE-IN-REC          PIC 99.
  4846         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4847             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4848                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4849             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4850             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4851         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  FILLER                     PIC X.
  4853             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4854         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4855             20  FILLER                     PIC XX.
  4856             20  CF-MORTGAGE-PLAN           PIC XX.
  4857         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4858
  4859     12  CF-LAST-MAINT-DT                   PIC XX.
  4860     12  CF-LAST-MAINT-BY                   PIC X(4).
  4861     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4862
  4863     12  CF-RECORD-BODY                     PIC X(728).
  4864
  4865
  4866****************************************************************
  4867*             COMPANY MASTER RECORD                            *
  4868****************************************************************
  4869
  4870     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4871         16  CF-COMPANY-ADDRESS.
  4872             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4873             20  CF-CL-IN-CARE-OF           PIC X(30).
  4874             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4875             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4876             20  CF-CL-CITY-STATE           PIC X(30).
  4877             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4878             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4879         16  CF-COMPANY-CD                  PIC X.
  4880         16  CF-COMPANY-PASSWORD            PIC X(8).
  4881         16  CF-SECURITY-OPTION             PIC X.
  4882             88  ALL-SECURITY                   VALUE '1'.
  4883             88  COMPANY-VERIFY                 VALUE '2'.
  4884             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  91
* EL050.cbl
  4885             88  NO-SECURITY                    VALUE '4'.
  4886             88  ALL-BUT-TERM                   VALUE '5'.
  4887         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4888             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4889         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4890             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4891         16  CF-INFORCE-LOCATION            PIC X.
  4892             88  CERTS-ARE-ONLINE               VALUE '1'.
  4893             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4894             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4895         16  CF-LOWER-CASE-LETTERS          PIC X.
  4896         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4897             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4898             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4899             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4900             88  CF-ACCNT-CNTL                  VALUE '3'.
  4901             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4902
  4903         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4904         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4905
  4906         16  CF-LGX-CREDIT-USER             PIC X.
  4907             88  CO-IS-NOT-USER                 VALUE 'N'.
  4908             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4909
  4910         16 CF-CREDIT-CALC-CODES.
  4911             20  CF-CR-REM-TERM-CALC PIC X.
  4912               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4913               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4914               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4915               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4916               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4917               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4918               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4919             20  CF-CR-R78-METHOD           PIC X.
  4920               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4921               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4922
  4923         16  CF-CLAIM-CONTROL-COUNTS.
  4924             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4925                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4926
  4927             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4928                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4929
  4930             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4931                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4932
  4933             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4934                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4935
  4936         16  CF-CURRENT-MONTH-END           PIC XX.
  4937
  4938         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4939             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4940             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4941             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4942             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  92
* EL050.cbl
  4943                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4944                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4945             20  CF-CO-PREM-REJECT-SW       PIC X.
  4946                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4947                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4948             20  CF-CO-REF-REJECT-SW        PIC X.
  4949                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4950                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4951
  4952         16  CF-CO-REPORTING-DT             PIC XX.
  4953         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4954         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4955           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4956           88  CF-CO-MONTH-END                  VALUE '1'.
  4957
  4958         16  CF-LGX-CLAIM-USER              PIC X.
  4959             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4960             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4961
  4962         16  CF-CREDIT-EDIT-CONTROLS.
  4963             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4964             20  CF-MIN-AGE                 PIC 99.
  4965             20  CF-DEFAULT-AGE             PIC 99.
  4966             20  CF-MIN-TERM                PIC S999      COMP-3.
  4967             20  CF-MAX-TERM                PIC S999      COMP-3.
  4968             20  CF-DEFAULT-SEX             PIC X.
  4969             20  CF-JOINT-AGE-INPUT         PIC X.
  4970                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4971             20  CF-BIRTH-DATE-INPUT        PIC X.
  4972                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4973             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4974                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4975                 88  CF-ZERO-CARRIER            VALUE '1'.
  4976                 88  CF-ZERO-GROUPING           VALUE '2'.
  4977                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4978             20  CF-EDIT-SW                 PIC X.
  4979                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4980             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4981             20  CF-CR-PR-METHOD            PIC X.
  4982               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4983               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4984             20  FILLER                     PIC X.
  4985
  4986         16  CF-CREDIT-MISC-CONTROLS.
  4987             20  CF-REIN-TABLE-SW           PIC X.
  4988                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4989             20  CF-COMP-TABLE-SW           PIC X.
  4990                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4991             20  CF-EXPERIENCE-RETENTION-AGE
  4992                                            PIC S9        COMP-3.
  4993             20  CF-CONVERSION-DT           PIC XX.
  4994             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4995             20  CF-RUN-FREQUENCY-SW        PIC X.
  4996                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4997                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4998
  4999             20  CF-CR-CHECK-NO-CONTROL.
  5000                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  93
* EL050.cbl
  5001                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5002                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5003                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5004                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5005                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5006
  5007                 24  CF-CR-CHECK-COUNT       REDEFINES
  5008                     CF-CR-CHECK-COUNTER      PIC X(4).
  5009
  5010                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5011                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5012
  5013                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5014                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5015                 24  CF-MAIL-PROCESSING       PIC X.
  5016                     88  MAIL-PROCESSING          VALUE 'Y'.
  5017
  5018         16  CF-MISC-SYSTEM-CONTROL.
  5019             20  CF-SYSTEM-C                 PIC X.
  5020                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5021             20  CF-SYSTEM-D                 PIC X.
  5022                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5023             20  CF-SOC-SEC-NO-SW            PIC X.
  5024                 88  SOC-SEC-NO-USED             VALUE '1'.
  5025             20  CF-MEMBER-NO-SW             PIC X.
  5026                 88  MEMBER-NO-USED              VALUE '1'.
  5027             20  CF-TAX-ID-NUMBER            PIC X(11).
  5028             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5029             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5030                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5031                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5032                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5033                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5034             20  CF-SYSTEM-E                 PIC X.
  5035                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5036
  5037         16  CF-LGX-LIFE-USER               PIC X.
  5038             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5039             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5040
  5041         16  CF-CR-MONTH-END-DT             PIC XX.
  5042
  5043         16  CF-FILE-MAINT-DATES.
  5044             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5045                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5046             20  CF-LAST-BATCH       REDEFINES
  5047                 CF-LAST-BATCH-NO               PIC X(4).
  5048             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5049             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5050             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5051             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5052             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5053             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5054             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5055             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5056             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5057             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5058
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  94
* EL050.cbl
  5059         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5060         16  FILLER                         PIC X.
  5061
  5062         16  CF-ALT-MORT-CODE               PIC X(4).
  5063         16  CF-MEMBER-CAPTION              PIC X(10).
  5064
  5065         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5066             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5067             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5068             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5069             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5070             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5071
  5072         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5073
  5074         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5075         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5076         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5077         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5078
  5079         16  CF-AH-OVERRIDE-L1              PIC X.
  5080         16  CF-AH-OVERRIDE-L2              PIC XX.
  5081         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5082         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5083
  5084         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5085         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5086
  5087         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5088         16  CF-AR-LAST-EL860-DT            PIC XX.
  5089         16  CF-MP-MONTH-END-DT             PIC XX.
  5090
  5091         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5092         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5093             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5094
  5095         16  CF-AR-MONTH-END-DT             PIC XX.
  5096
  5097         16  CF-CRDTCRD-USER                PIC X.
  5098             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5099             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5100
  5101         16  CF-CC-MONTH-END-DT             PIC XX.
  5102
  5103         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5104
  5105         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5106             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5107             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5108             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5109         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5110         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5111         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5112         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5113             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5114             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5115         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5116         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  95
* EL050.cbl
  5117         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5118             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5119         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5120
  5121         16  CF-CL-ZIP-CODE.
  5122             20  CF-CL-ZIP-PRIME.
  5123                 24  CF-CL-ZIP-1ST          PIC X.
  5124                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5125                 24  FILLER                 PIC X(4).
  5126             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5127         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5128             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5129             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5130             20  FILLER                     PIC XXX.
  5131
  5132         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5133         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5134         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5135         16  CF-CO-OPTION-START-DATE        PIC XX.
  5136         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5137           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5138                                                      '3' '4'.
  5139           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5140           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5141           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5142           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5143           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5144           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5145
  5146         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5147
  5148         16  CF-PAYMENT-APPROVAL-LEVELS.
  5149             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5150             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5151             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5152             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5153             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5154             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5155
  5156         16  CF-END-USER-REPORTING-USER     PIC X.
  5157             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5158             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5159
  5160         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5161             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5162             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5163
  5164         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5165
  5166         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5167         16  FILLER                         PIC X.
  5168
  5169         16  CF-CREDIT-ARCHIVE-CNTL.
  5170             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5171             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5172             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5173
  5174         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  96
* EL050.cbl
  5175
  5176         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5177             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5178             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5179
  5180         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5181             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5182             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5183
  5184         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5185
  5186         16  CF-CO-ACH-ID-CODE              PIC  X.
  5187             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5188             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5189             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5190         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5191         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5192         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5193         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5194         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5195         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5196         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5197         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5198         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5199                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5200         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5201                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5202
  5203         16  CF-CO-OVER-SHORT.
  5204             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5205             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5206
  5207*         16  FILLER                         PIC X(102).
  5208         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5209             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5210             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5211
  5212         16  CF-AH-APPROVAL-DAYS.
  5213             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5214             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5215             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5216             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5217
  5218         16  FILLER                         PIC X(82).
  5219****************************************************************
  5220*             PROCESSOR/USER RECORD                            *
  5221****************************************************************
  5222
  5223     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5224         16  CF-PROCESSOR-NAME              PIC X(30).
  5225         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5226         16  CF-PROCESSOR-TITLE             PIC X(26).
  5227         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5228                 88  MESSAGE-YES                VALUE 'Y'.
  5229                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5230
  5231*****************************************************
  5232****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  97
* EL050.cbl
  5233****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5234****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5235****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5236*****************************************************
  5237
  5238         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5239             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5240             20  CF-APPLICATION-FORCE       PIC X.
  5241             20  CF-INDIVIDUAL-APP.
  5242                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5243                     28  CF-BROWSE-APP      PIC X.
  5244                     28  CF-UPDATE-APP      PIC X.
  5245
  5246         16  CF-CURRENT-TERM-ON             PIC X(4).
  5247         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5248             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5249             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5250             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5251             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5252             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5253             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5254             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5255         16  CF-PROCESSOR-CARRIER           PIC X.
  5256             88  NO-CARRIER-SECURITY            VALUE ' '.
  5257         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5258             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5259         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5260             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5261         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5262             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5263
  5264         16  CF-PROC-SYS-ACCESS-SW.
  5265             20  CF-PROC-CREDIT-CLAIMS-SW.
  5266                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5267                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5268                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5269                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5270             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5271                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5272                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5273             20  CF-PROC-LIFE-GNRLDGR-SW.
  5274                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5275                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5276                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5277                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5278             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5279                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5280                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5281         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5282             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5283             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5284         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5285
  5286         16  CF-APPROVAL-LEVEL                  PIC X.
  5287             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5288             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5289             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5290             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  98
* EL050.cbl
  5291
  5292         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5293
  5294         16  CF-LANGUAGE-TYPE                   PIC X.
  5295             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5296             88  CF-LANG-IS-FR                      VALUE 'F'.
  5297         16  FILLER                             PIC  X(240).
  5298
  5299****************************************************************
  5300*             PROCESSOR/REMINDERS RECORD                       *
  5301****************************************************************
  5302
  5303     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5304         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5305             20  CF-START-REMIND-DT         PIC XX.
  5306             20  CF-END-REMIND-DT           PIC XX.
  5307             20  CF-REMINDER-TEXT           PIC X(50).
  5308         16  FILLER                         PIC X(296).
  5309
  5310
  5311****************************************************************
  5312*             STATE MASTER RECORD                              *
  5313****************************************************************
  5314
  5315     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5316         16  CF-STATE-ABBREVIATION          PIC XX.
  5317         16  CF-STATE-NAME                  PIC X(25).
  5318         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5319         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5320             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5321             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5322             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5323             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5324                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5325                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5326             20  CF-ST-PREM-REJECT-SW       PIC X.
  5327                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5328                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5329             20  CF-ST-REF-REJECT-SW        PIC X.
  5330                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5331                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5332         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5333         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5334         16  CF-ST-REFUND-RULES.
  5335             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5336             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5337             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5338         16  CF-ST-FST-PMT-EXTENSION.
  5339             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5340             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5341                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5342                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5343                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5344                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5345         16  CF-ST-STATE-CALL.
  5346             20  CF-ST-CALL-UNEARNED        PIC X.
  5347             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5348             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page  99
* EL050.cbl
  5349         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5350             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5351             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5352         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5353         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5354         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5355         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5356         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5357         16  FILLER                         PIC X.
  5358         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5359             20  CF-ST-BENEFIT-CD           PIC XX.
  5360             20  CF-ST-BENEFIT-KIND         PIC X.
  5361                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5362                 88  CF-ST-AH-KIND              VALUE 'A'.
  5363             20  CF-ST-REM-TERM-CALC        PIC X.
  5364                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5365                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5366                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5367                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5368                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5369                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5370                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5371                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5372
  5373             20  CF-ST-REFUND-CALC          PIC X.
  5374                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5375                 88  ST-REFD-BY-R78             VALUE '1'.
  5376                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5377                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5378                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5379                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5380                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5381                 88  ST-REFD-UTAH               VALUE '7'.
  5382                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5383                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5384                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5385
  5386             20  CF-ST-EARNING-CALC         PIC X.
  5387                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5388                 88  ST-EARN-BY-R78             VALUE '1'.
  5389                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5390                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5391                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5392                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5393                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5394                 88  ST-EARN-MEAN               VALUE '8'.
  5395                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5396
  5397             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5398                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5399                 88  ST-OVRD-BY-R78             VALUE '1'.
  5400                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5401                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5402                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5403                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5404                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5405                 88  ST-OVRD-MEAN               VALUE '8'.
  5406                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 100
* EL050.cbl
  5407             20  FILLER                     PIC X.
  5408
  5409         16  CF-ST-COMMISSION-CAPS.
  5410             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5411             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5412             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5413             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5414         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5415                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5416
  5417         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5418
  5419         16  CF-ST-STATUTORY-INTEREST.
  5420             20  CF-ST-STAT-DATE-FROM       PIC X.
  5421                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5422                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5423             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5424             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5425             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5426             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5427             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5428
  5429         16  CF-ST-OVER-SHORT.
  5430             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5431             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5432
  5433         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5434
  5435         16  CF-ST-RT-CALC                  PIC X.
  5436
  5437         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5438         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5439         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5440         16  CF-ST-RF-LR-CALC               PIC X.
  5441         16  CF-ST-RF-LL-CALC               PIC X.
  5442         16  CF-ST-RF-LN-CALC               PIC X.
  5443         16  CF-ST-RF-AH-CALC               PIC X.
  5444         16  CF-ST-RF-CP-CALC               PIC X.
  5445*        16  FILLER                         PIC X(206).
  5446*CIDMOD         16  FILLER                         PIC X(192).
  5447         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5448             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5449         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5450         16  CF-ST-VFY-2ND-BENE             PIC X.
  5451         16  FILLER                         PIC X(186).
  5452
  5453****************************************************************
  5454*             BENEFIT MASTER RECORD                            *
  5455****************************************************************
  5456
  5457     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5458         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5459             20  CF-BENEFIT-CODE            PIC XX.
  5460             20  CF-BENEFIT-NUMERIC  REDEFINES
  5461                 CF-BENEFIT-CODE            PIC XX.
  5462             20  CF-BENEFIT-ALPHA           PIC XXX.
  5463             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5464             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 101
* EL050.cbl
  5465
  5466             20  CF-LF-COVERAGE-TYPE        PIC X.
  5467                 88  CF-REDUCING                VALUE 'R'.
  5468                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5469
  5470             20  CF-SPECIAL-CALC-CD         PIC X.
  5471                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5472                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5473                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5474                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5475                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5476                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5477                 88  CF-FARM-PLAN               VALUE 'F'.
  5478                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5479                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5480                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5481                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5482                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5483                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5484                 88  CF-PRUDENTIAL              VALUE 'P'.
  5485                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5486                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5487                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5488                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5489                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5490                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5491
  5492             20  CF-JOINT-INDICATOR         PIC X.
  5493                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5494
  5495*            20  FILLER                     PIC X(12).
  5496             20  FILLER                     PIC X(11).
  5497             20  CF-BENEFIT-CATEGORY        PIC X.
  5498             20  CF-LOAN-TYPE               PIC X(8).
  5499
  5500             20  CF-CO-REM-TERM-CALC        PIC X.
  5501                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5502                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5503                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5504                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5505                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5506
  5507             20  CF-CO-EARNINGS-CALC        PIC X.
  5508                 88  CO-EARN-BY-R78             VALUE '1'.
  5509                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5510                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5511                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5512                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5513                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5514                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5515                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5516
  5517             20  CF-CO-REFUND-CALC          PIC X.
  5518                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5519                 88  CO-REFD-BY-R78             VALUE '1'.
  5520                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5521                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5522                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 102
* EL050.cbl
  5523                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5524                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5525                 88  CO-REFD-MEAN               VALUE '8'.
  5526                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5527                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5528                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5529
  5530             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5531                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5532                 88  CO-OVRD-BY-R78             VALUE '1'.
  5533                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5534                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5535                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5536                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5537                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5538                 88  CO-OVRD-MEAN               VALUE '8'.
  5539                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5540
  5541             20  CF-CO-BEN-I-G-CD           PIC X.
  5542                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5543                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5544                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5545
  5546         16  FILLER                         PIC X(304).
  5547
  5548
  5549****************************************************************
  5550*             CARRIER MASTER RECORD                            *
  5551****************************************************************
  5552
  5553     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5554         16  CF-ADDRESS-DATA.
  5555             20  CF-MAIL-TO-NAME            PIC X(30).
  5556             20  CF-IN-CARE-OF              PIC X(30).
  5557             20  CF-ADDRESS-LINE-1          PIC X(30).
  5558             20  CF-ADDRESS-LINE-2          PIC X(30).
  5559             20  CF-CITY-STATE              PIC X(30).
  5560             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5561             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5562
  5563         16  CF-CLAIM-NO-CONTROL.
  5564             20  CF-CLAIM-NO-METHOD         PIC X.
  5565                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5566                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5567                 88  CLAIM-NO-SEQ               VALUE '3'.
  5568                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5569             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5570                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5571                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5572                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5573
  5574         16  CF-CHECK-NO-CONTROL.
  5575             20  CF-CHECK-NO-METHOD         PIC X.
  5576                 88  CHECK-NO-MANUAL            VALUE '1'.
  5577                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5578                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5579                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5580             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 103
* EL050.cbl
  5581                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5582
  5583         16  CF-DOMICILE-STATE              PIC XX.
  5584
  5585         16  CF-EXPENSE-CONTROLS.
  5586             20  CF-EXPENSE-METHOD          PIC X.
  5587                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5588                 88  DOLLARS-PER-PMT            VALUE '2'.
  5589                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5590                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5591             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5592             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5593
  5594         16  CF-CORRESPONDENCE-CONTROL.
  5595             20  CF-LETTER-RESEND-OPT       PIC X.
  5596                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5597                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5598             20  FILLER                     PIC X(4).
  5599
  5600         16  CF-RESERVE-CONTROLS.
  5601             20  CF-MANUAL-SW               PIC X.
  5602                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5603             20  CF-FUTURE-SW               PIC X.
  5604                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5605             20  CF-PTC-SW                  PIC X.
  5606                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5607             20  CF-IBNR-SW                 PIC X.
  5608                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5609             20  CF-PTC-LF-SW               PIC X.
  5610                 88  CF-LF-PTC-USED             VALUE '1'.
  5611             20  CF-CDT-ACCESS-METHOD       PIC X.
  5612                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5613                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5614                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5615             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5616
  5617         16  CF-CLAIM-CALC-METHOD           PIC X.
  5618             88  360-PLUS-MONTHS                VALUE '1'.
  5619             88  365-PLUS-MONTHS                VALUE '2'.
  5620             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5621             88  360-DAILY                      VALUE '4'.
  5622             88  365-DAILY                      VALUE '5'.
  5623
  5624         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5625         16  FILLER                         PIC X(11).
  5626
  5627         16  CF-LIMIT-AMOUNTS.
  5628             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5629             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5630             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5631             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5632             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5633             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5634             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5635             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5636             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5637             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5638
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 104
* EL050.cbl
  5639         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5640         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5641         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5642
  5643         16  CF-ZIP-CODE.
  5644             20  CF-ZIP-PRIME.
  5645                 24  CF-ZIP-1ST             PIC X.
  5646                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5647                 24  FILLER                 PIC X(4).
  5648             20  CF-ZIP-PLUS4               PIC X(4).
  5649         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5650             20  CF-CAN-POSTAL-1            PIC XXX.
  5651             20  CF-CAN-POSTAL-2            PIC XXX.
  5652             20  FILLER                     PIC XXX.
  5653
  5654         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5655         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5656         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5657
  5658         16  CF-RATING-SWITCH               PIC X.
  5659             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5660             88  CF-NO-RATING                   VALUE 'N'.
  5661
  5662         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5663
  5664         16  CF-CARRIER-OVER-SHORT.
  5665             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5666             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5667
  5668         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5669         16  CF-SECPAY-SWITCH               PIC X.
  5670             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5671             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5672         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5673         16  FILLER                         PIC X(448).
  5674*        16  FILLER                         PIC X(452).
  5675
  5676
  5677****************************************************************
  5678*             MORTALITY MASTER RECORD                          *
  5679****************************************************************
  5680
  5681     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5682         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5683                                INDEXED BY CF-MORT-NDX.
  5684             20  CF-MORT-TABLE              PIC X(5).
  5685             20  CF-MORT-TABLE-TYPE         PIC X.
  5686                 88  CF-MORT-JOINT              VALUE 'J'.
  5687                 88  CF-MORT-SINGLE             VALUE 'S'.
  5688                 88  CF-MORT-COMBINED           VALUE 'C'.
  5689                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5690                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5691             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5692             20  CF-MORT-AGE-METHOD         PIC XX.
  5693                 88  CF-AGE-LAST                VALUE 'AL'.
  5694                 88  CF-AGE-NEAR                VALUE 'AN'.
  5695             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5696             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 105
* EL050.cbl
  5697                                            PIC X.
  5698                 88  CF-MINUS                   VALUE '-'.
  5699                 88  CF-PLUS                    VALUE '+'.
  5700             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5701             20  CF-MORT-JOINT-CODE         PIC X.
  5702                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5703             20  CF-MORT-PC-Q               PIC X.
  5704                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5705             20  CF-MORT-TABLE-CODE         PIC X(4).
  5706             20  CF-MORT-COMMENTS           PIC X(15).
  5707             20  FILLER                     PIC X(14).
  5708
  5709         16  FILLER                         PIC X(251).
  5710
  5711
  5712****************************************************************
  5713*             BUSSINESS TYPE MASTER RECORD                     *
  5714****************************************************************
  5715
  5716     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5717* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5718* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5719* AND RECORD 05 IS TYPES 81-99
  5720         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5721             20  CF-BUSINESS-TITLE          PIC  X(19).
  5722             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5723                                            PIC S9V9(4) COMP-3.
  5724             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5725             20  FILLER                     PIC  X.
  5726         16  FILLER                         PIC  X(248).
  5727
  5728
  5729****************************************************************
  5730*             TERMINAL MASTER RECORD                           *
  5731****************************************************************
  5732
  5733     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5734
  5735         16  CF-COMPANY-TERMINALS.
  5736             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5737                                  PIC X(4).
  5738         16  FILLER               PIC X(248).
  5739
  5740
  5741****************************************************************
  5742*             LIFE EDIT MASTER RECORD                          *
  5743****************************************************************
  5744
  5745     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5746         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5747             20  CF-LIFE-CODE-IN            PIC XX.
  5748             20  CF-LIFE-CODE-OUT           PIC XX.
  5749         16  FILLER                         PIC X(248).
  5750
  5751
  5752****************************************************************
  5753*             AH EDIT MASTER RECORD                            *
  5754****************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 106
* EL050.cbl
  5755
  5756     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5757         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5758             20  CF-AH-CODE-IN              PIC XXX.
  5759             20  CF-AH-CODE-OUT             PIC XX.
  5760         16  FILLER                         PIC X(248).
  5761
  5762
  5763****************************************************************
  5764*             CREDIBILITY TABLES                               *
  5765****************************************************************
  5766
  5767     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5768         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5769                             INDEXED BY CF-CRDB-NDX.
  5770             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5771             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5772             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5773         16  FILLER                         PIC  X(332).
  5774
  5775
  5776****************************************************************
  5777*             REPORT CUSTOMIZATION RECORD                      *
  5778****************************************************************
  5779
  5780     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5781         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5782             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5783             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5784             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5785**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5786****       A T-TRANSFER.                                   ****
  5787             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5788
  5789         16  FILLER                         PIC XX.
  5790
  5791         16  CF-CARRIER-CNTL-OPT.
  5792             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5793                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5794                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5795             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5796                                            PIC X.
  5797         16  CF-GROUP-CNTL-OPT.
  5798             20  CF-GROUP-OPT-SEQ           PIC 9.
  5799                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5800                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5801             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5802                                            PIC X(6).
  5803         16  CF-STATE-CNTL-OPT.
  5804             20  CF-STATE-OPT-SEQ           PIC 9.
  5805                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5806                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5807             20  CF-STATE-SELECT OCCURS 3 TIMES
  5808                                            PIC XX.
  5809         16  CF-ACCOUNT-CNTL-OPT.
  5810             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5811                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5812                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 107
* EL050.cbl
  5813             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5814                                            PIC X(10).
  5815         16  CF-BUS-TYP-CNTL-OPT.
  5816             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5817                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5818                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5819             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5820                                            PIC XX.
  5821         16  CF-LF-TYP-CNTL-OPT.
  5822             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5823                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5824                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5825             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5826                                            PIC XX.
  5827         16  CF-AH-TYP-CNTL-OPT.
  5828             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5829                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5830                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5831             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5832                                            PIC XX.
  5833         16  CF-REPTCD1-CNTL-OPT.
  5834             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5835                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5836                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5837             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5838                                            PIC X(10).
  5839         16  CF-REPTCD2-CNTL-OPT.
  5840             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5841                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5842                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5843             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5844                                            PIC X(10).
  5845         16  CF-USER1-CNTL-OPT.
  5846             20  CF-USER1-OPT-SEQ           PIC 9.
  5847                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5848                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5849             20  CF-USER1-SELECT OCCURS 3 TIMES
  5850                                            PIC X(10).
  5851         16  CF-USER2-CNTL-OPT.
  5852             20  CF-USER2-OPT-SEQ           PIC 9.
  5853                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5854                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5855             20  CF-USER2-SELECT OCCURS 3 TIMES
  5856                                            PIC X(10).
  5857         16  CF-USER3-CNTL-OPT.
  5858             20  CF-USER3-OPT-SEQ           PIC 9.
  5859                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5860                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5861             20  CF-USER3-SELECT OCCURS 3 TIMES
  5862                                            PIC X(10).
  5863         16  CF-USER4-CNTL-OPT.
  5864             20  CF-USER4-OPT-SEQ           PIC 9.
  5865                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5866                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5867             20  CF-USER4-SELECT OCCURS 3 TIMES
  5868                                            PIC X(10).
  5869         16  CF-USER5-CNTL-OPT.
  5870             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 108
* EL050.cbl
  5871                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5872                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5873             20  CF-USER5-SELECT OCCURS 3 TIMES
  5874                                            PIC X(10).
  5875         16  CF-REINS-CNTL-OPT.
  5876             20  CF-REINS-OPT-SEQ           PIC 9.
  5877                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5878                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5879             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5880                 24  CF-REINS-PRIME         PIC XXX.
  5881                 24  CF-REINS-SUB           PIC XXX.
  5882
  5883         16  CF-AGENT-CNTL-OPT.
  5884             20  CF-AGENT-OPT-SEQ           PIC 9.
  5885                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5886                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5887             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5888                                            PIC X(10).
  5889
  5890         16  FILLER                         PIC X(43).
  5891
  5892         16  CF-LOSS-RATIO-SELECT.
  5893             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5894             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5895         16  CF-ENTRY-DATE-SELECT.
  5896             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5897             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5898         16  CF-EFFECTIVE-DATE-SELECT.
  5899             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5900             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5901
  5902         16  CF-EXCEPTION-LIST-IND          PIC X.
  5903             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5904
  5905         16  FILLER                         PIC X(318).
  5906
  5907****************************************************************
  5908*                  EXCEPTION REPORTING RECORD                  *
  5909****************************************************************
  5910
  5911     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5912         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5913             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5914
  5915         16  CF-COMBINED-LIFE-AH-OPT.
  5916             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5917             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5918             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5919             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5920
  5921         16  CF-LIFE-OPT.
  5922             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5923             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5924             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5925             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5926             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5927             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5928             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 109
* EL050.cbl
  5929             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5930             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5931             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5932
  5933         16  CF-AH-OPT.
  5934             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5935             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5936             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5937             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5938             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5939             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5940             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5941             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5942             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5943             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5944
  5945         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5946             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5947             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5948             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5949
  5950         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5951
  5952         16  FILLER                         PIC X(673).
  5953
  5954
  5955****************************************************************
  5956*             MORTGAGE SYSTEM PLAN RECORD                      *
  5957****************************************************************
  5958
  5959     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5960         16  CF-PLAN-TYPE                   PIC X.
  5961             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5962             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5963             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5964         16  CF-PLAN-ABBREV                 PIC XXX.
  5965         16  CF-PLAN-DESCRIPT               PIC X(10).
  5966         16  CF-PLAN-NOTES                  PIC X(20).
  5967         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5968         16  CF-PLAN-UNDERWRITING.
  5969             20  CF-PLAN-TERM-DATA.
  5970                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5971                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5972             20  CF-PLAN-AGE-DATA.
  5973                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5974                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5975                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5976             20  CF-PLAN-BENEFIT-DATA.
  5977                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5978                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5979                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5980                                            PIC S9(7)V99  COMP-3.
  5981         16  CF-PLAN-POLICY-FORMS.
  5982             20  CF-POLICY-FORM             PIC X(12).
  5983             20  CF-MASTER-APPLICATION      PIC X(12).
  5984             20  CF-MASTER-POLICY           PIC X(12).
  5985         16  CF-PLAN-RATING.
  5986             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 110
* EL050.cbl
  5987             20  CF-SEX-RATING              PIC X.
  5988                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5989                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5990             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5991             20  CF-SUB-STD-TYPE            PIC X.
  5992                 88  CF-PCT-OF-PREM            VALUE '1'.
  5993                 88  CF-PCT-OF-BENE            VALUE '2'.
  5994         16  CF-PLAN-PREM-TOLERANCES.
  5995             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5996             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5997         16  CF-PLAN-PYMT-TOLERANCES.
  5998             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5999             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6000         16  CF-PLAN-MISC-DATA.
  6001             20  FILLER                     PIC X.
  6002             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6003             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6004         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6005         16  CF-PLAN-IND-GRP                PIC X.
  6006             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6007                                                     '1'.
  6008             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6009                                                     '2'.
  6010         16  CF-MIB-SEARCH-SW               PIC X.
  6011             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6012             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6013             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6014             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6015         16  CF-ALPHA-SEARCH-SW             PIC X.
  6016             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6017             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6018             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6019             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6020             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6021             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6022             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6023             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6024             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6025             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6026                                                     'A' 'B' 'C'
  6027                                                     'X' 'Y' 'Z'.
  6028         16  CF-EFF-DT-RULE-SW              PIC X.
  6029             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6030             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6031             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6032             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6033             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6034         16  FILLER                         PIC X(4).
  6035         16  CF-HEALTH-QUESTIONS            PIC X.
  6036             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6037         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6038         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6039         16  CF-PLAN-SNGL-JNT               PIC X.
  6040             88  CF-COMBINED-PLAN              VALUE 'C'.
  6041             88  CF-JNT-PLAN                   VALUE 'J'.
  6042             88  CF-SNGL-PLAN                  VALUE 'S'.
  6043         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6044         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 111
* EL050.cbl
  6045         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6046         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6047         16  CF-RERATE-CNTL                 PIC  X.
  6048             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6049             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6050             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6051             88  CF-AUTO-RECALC                 VALUE '4'.
  6052         16  CF-BENEFIT-TYPE                PIC  X.
  6053             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6054             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6055         16  CF-POLICY-FEE                  PIC S999V99
  6056                                                    COMP-3.
  6057         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6058         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6059         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6060         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6061         16  FILLER                         PIC  X(32).
  6062         16  CF-TERMINATION-FORM            PIC  X(04).
  6063         16  FILLER                         PIC  X(08).
  6064         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6065                                                       COMP-3.
  6066         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6067         16  CF-ISSUE-LETTER                PIC  X(4).
  6068         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6069         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6070             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6071             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6072         16  CF-MP-REFUND-CALC              PIC X.
  6073             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6074             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6075             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6076             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6077             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6078             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6079             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6080             88  CF-MP-REFD-MEAN                VALUE '8'.
  6081         16  CF-ALT-RATE-CODE               PIC  X(5).
  6082
  6083
  6084         16  FILLER                         PIC X(498).
  6085****************************************************************
  6086*             MORTGAGE COMPANY MASTER RECORD                   *
  6087****************************************************************
  6088
  6089     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6090         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6091         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6092             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6093             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6094             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6095             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6096             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6097
  6098         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6099         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6100         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6101         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6102         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 112
* EL050.cbl
  6103
  6104         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6105             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6106         16  CF-MP-RECON-USE-IND            PIC X(1).
  6107             88  CF-MP-USE-RECON             VALUE 'Y'.
  6108         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6109             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6110         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6111             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6112             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6113         16  FILLER                         PIC X(1).
  6114         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6115             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6116         16  CF-MORTG-MIB-VERSION           PIC X.
  6117             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6118             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6119             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6120         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6121             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6122                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6123             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6124                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6125             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6126                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6127             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6128                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6129             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6130                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6131             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6132                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6133         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6134         16  FILLER                         PIC X(7).
  6135         16  CF-MORTG-DESTINATION-SYMBOL.
  6136             20  CF-MORTG-MIB-COMM          PIC X(5).
  6137             20  CF-MORTG-MIB-TERM          PIC X(5).
  6138         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6139             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6140         16  FILLER                         PIC X(03).
  6141         16  CF-MP-CHECK-NO-CONTROL.
  6142             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6143                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6144                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6145                                                ' ' LOW-VALUES.
  6146                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6147                                               VALUE '3'.
  6148         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6149         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6150         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6151             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6152                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6153             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6154                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6155             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6156                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6157             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6158                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6159             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6160                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 113
* EL050.cbl
  6161             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6162                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6163         16  CF-MORTG-BILLING-AREA.
  6164             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6165                                            PIC X.
  6166         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6167         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6168         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6169         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6170             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6171             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6172         16  FILLER                         PIC X.
  6173         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6174             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6175             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6176         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6177         16  FILLER                         PIC X(8).
  6178         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6179         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6180         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6181         16  CF-ACH-COMPANY-ID.
  6182             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6183                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6184                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6185                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6186             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6187         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6188             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6189         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6190             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6191             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6192         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6193         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6194         16  FILLER                         PIC X(536).
  6195
  6196****************************************************************
  6197*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6198****************************************************************
  6199
  6200     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6201         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6202             20  CF-FEMALE-HEIGHT.
  6203                 24  CF-FEMALE-FT           PIC 99.
  6204                 24  CF-FEMALE-IN           PIC 99.
  6205             20  CF-FEMALE-MIN-WT           PIC 999.
  6206             20  CF-FEMALE-MAX-WT           PIC 999.
  6207         16  FILLER                         PIC X(428).
  6208
  6209     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6210         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6211             20  CF-MALE-HEIGHT.
  6212                 24  CF-MALE-FT             PIC 99.
  6213                 24  CF-MALE-IN             PIC 99.
  6214             20  CF-MALE-MIN-WT             PIC 999.
  6215             20  CF-MALE-MAX-WT             PIC 999.
  6216         16  FILLER                         PIC X(428).
  6217******************************************************************
  6218*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 114
* EL050.cbl
  6219******************************************************************
  6220     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6221         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6222             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6223             20  CF-SYS-LETTER-ID           PIC X(04).
  6224             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6225             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6226             20  CF-SYS-RESET-SW            PIC X(01).
  6227             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6228             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6229
  6230         16  FILLER                         PIC X(50).
  6231
  6232         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6233             20  CF-USER-ACTIVE-SW          PIC X(01).
  6234             20  CF-USER-LETTER-ID          PIC X(04).
  6235             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6236             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6237             20  CF-USER-RESET-SW           PIC X(01).
  6238             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6239             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6240             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6241
  6242         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 115
* EL050.cbl
  6244*    COPY ERCACCT.
  6245******************************************************************
  6246*                                                                *
  6247*                                                                *
  6248*                            ERCACCT                             *
  6249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6250*                            VMOD=2.031                          *
  6251*                                                                *
  6252*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6253*                                                                *
  6254*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6255*   VSAM ACCOUNT MASTER FILES.                                   *
  6256*                                                                *
  6257*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6258*                                                                *
  6259*   FILE TYPE = VSAM,KSDS                                        *
  6260*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6261*                                                                *
  6262*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6263*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6264*                                                                *
  6265*   LOG = NO                                                     *
  6266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6267*                                                                *
  6268*                                                                *
  6269******************************************************************
  6270*                   C H A N G E   L O G
  6271*
  6272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6273*-----------------------------------------------------------------
  6274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6275* EFFECTIVE    NUMBER
  6276*-----------------------------------------------------------------
  6277* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6278* 092705    2005050300006  PEMA  ADD SPP LEASES
  6279* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6280* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6281* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6282* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6283* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6284******************************************************************
  6285
  6286 01  ACCOUNT-MASTER.
  6287     12  AM-RECORD-ID                      PIC XX.
  6288         88  VALID-AM-ID                      VALUE 'AM'.
  6289
  6290     12  AM-CONTROL-PRIMARY.
  6291         16  AM-COMPANY-CD                 PIC X.
  6292         16  AM-MSTR-CNTRL.
  6293             20  AM-CONTROL-A.
  6294                 24  AM-CARRIER            PIC X.
  6295                 24  AM-GROUPING.
  6296                     28 AM-GROUPING-PREFIX PIC XXX.
  6297                     28 AM-GROUPING-PRIME  PIC XXX.
  6298                 24  AM-STATE              PIC XX.
  6299                 24  AM-ACCOUNT.
  6300                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6301                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 116
* EL050.cbl
  6302             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6303                                           PIC X(19).
  6304             20  AM-CNTRL-B.
  6305                 24  AM-EXPIRATION-DT      PIC XX.
  6306                 24  FILLER                PIC X(4).
  6307             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6308                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6309
  6310     12  AM-CONTROL-BY-VAR-GRP.
  6311         16  AM-COMPANY-CD-A1              PIC X.
  6312         16  AM-VG-CARRIER                 PIC X.
  6313         16  AM-VG-GROUPING                PIC X(6).
  6314         16  AM-VG-STATE                   PIC XX.
  6315         16  AM-VG-ACCOUNT                 PIC X(10).
  6316         16  AM-VG-DATE.
  6317             20  AM-VG-EXPIRATION-DT       PIC XX.
  6318             20  FILLER                    PIC X(4).
  6319         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6320                                           PIC 9(11)      COMP-3.
  6321     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6322         16  FILLER                        PIC X(10).
  6323         16  AM-VG-KEY3.
  6324             20  AM-VG3-ACCOUNT            PIC X(10).
  6325             20  AM-VG3-EXP-DT             PIC XX.
  6326         16  FILLER                        PIC X(4).
  6327     12  AM-MAINT-INFORMATION.
  6328         16  AM-LAST-MAINT-DT              PIC XX.
  6329         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6330         16  AM-LAST-MAINT-USER            PIC X(4).
  6331         16  FILLER                        PIC XX.
  6332
  6333     12  AM-EFFECTIVE-DT                   PIC XX.
  6334     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6335
  6336     12  AM-PREV-DATES  COMP-3.
  6337         16  AM-PREV-EXP-DT                PIC 9(11).
  6338         16  AM-PREV-EFF-DT                PIC 9(11).
  6339
  6340     12  AM-REPORT-CODE-1                  PIC X(10).
  6341     12  AM-REPORT-CODE-2                  PIC X(10).
  6342
  6343     12  AM-CITY-CODE                      PIC X(4).
  6344     12  AM-COUNTY-PARISH                  PIC X(6).
  6345
  6346     12  AM-NAME                           PIC X(30).
  6347     12  AM-PERSON                         PIC X(30).
  6348     12  AM-ADDRS                          PIC X(30).
  6349     12  AM-CITY.
  6350         16  AM-ADDR-CITY                  PIC X(28).
  6351         16  AM-ADDR-STATE                 PIC XX.
  6352     12  AM-ZIP.
  6353         16  AM-ZIP-PRIME.
  6354             20  AM-ZIP-PRI-1ST            PIC X.
  6355                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6356             20  FILLER                    PIC X(4).
  6357         16  AM-ZIP-PLUS4                  PIC X(4).
  6358     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6359         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 117
* EL050.cbl
  6360         16  AM-CAN-POSTAL-2               PIC XXX.
  6361         16  FILLER                        PIC XXX.
  6362     12  AM-TEL-NO.
  6363         16  AM-AREA-CODE                  PIC 999.
  6364         16  AM-TEL-PRE                    PIC 999.
  6365         16  AM-TEL-NBR                    PIC 9(4).
  6366     12  AM-TEL-LOC                        PIC X.
  6367         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6368         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6369
  6370     12  AM-COMM-STRUCTURE.
  6371         16  AM-DEFN-1.
  6372             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6373                 24  AM-AGT.
  6374                     28  AM-AGT-PREFIX     PIC X(4).
  6375                     28  AM-AGT-PRIME      PIC X(6).
  6376                 24  AM-COM-TYP            PIC X.
  6377                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6378                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6379                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6380                 24  AM-RECALC-LV-INDIC    PIC X.
  6381                 24  AM-RETRO-LV-INDIC     PIC X.
  6382                 24  AM-GL-CODES           PIC X.
  6383                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6384                 24  FILLER                PIC X(01).
  6385         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6386             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6387                 24  FILLER                PIC X(11).
  6388                 24  AM-L-COMA             PIC XXX.
  6389                 24  AM-J-COMA             PIC XXX.
  6390                 24  AM-A-COMA             PIC XXX.
  6391                 24  FILLER                PIC X(6).
  6392
  6393     12  AM-COMM-CHANGE-STATUS             PIC X.
  6394         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6395
  6396     12  AM-CSR-CODE                       PIC X(4).
  6397
  6398     12  AM-BILLING-STATUS                 PIC X.
  6399         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6400         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6401     12  AM-AUTO-REFUND-SW                 PIC X.
  6402         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6403         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6404     12  AM-GPCD                           PIC 99.
  6405     12  AM-IG                             PIC X.
  6406         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6407         88  AM-HAS-GROUP                     VALUE '2'.
  6408     12  AM-STATUS                         PIC X.
  6409         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6410         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6411         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6412         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6413         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6414         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6415     12  AM-REMIT-TO                       PIC 99.
  6416     12  AM-ID-NO                          PIC X(11).
  6417
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 118
* EL050.cbl
  6418     12  AM-CAL-TABLE                      PIC XX.
  6419     12  AM-LF-DEVIATION                   PIC XXX.
  6420     12  AM-AH-DEVIATION                   PIC XXX.
  6421     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6422     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6423     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6424     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6425     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6426     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6427
  6428     12  AM-USER-FIELDS.
  6429         16  AM-FLD-1                      PIC XX.
  6430         16  AM-FLD-2                      PIC XX.
  6431         16  AM-FLD-3                      PIC XX.
  6432         16  AM-FLD-4                      PIC XX.
  6433         16  AM-FLD-5                      PIC XX.
  6434
  6435     12  AM-1ST-PROD-DATE.
  6436         16  AM-1ST-PROD-YR                PIC XX.
  6437         16  AM-1ST-PROD-MO                PIC XX.
  6438         16  AM-1ST-PROD-DA                PIC XX.
  6439     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6440     12  AM-CERTS-PURGED-DATE.
  6441         16  AM-PUR-YR                     PIC XX.
  6442         16  AM-PUR-MO                     PIC XX.
  6443         16  AM-PUR-DA                     PIC XX.
  6444     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6445     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6446     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6447     12  AM-INACTIVE-DATE.
  6448         16  AM-INA-MO                     PIC 99.
  6449         16  AM-INA-DA                     PIC 99.
  6450         16  AM-INA-YR                     PIC 99.
  6451     12  AM-AR-HI-CERT-DATE                PIC XX.
  6452
  6453     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6454     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6455
  6456     12  AM-OB-PAYMENT-MODE                PIC X.
  6457         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6458         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6459         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6460         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6461
  6462     12  AM-AH-ONLY-INDICATOR              PIC X.
  6463         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6464         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6465
  6466     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6467
  6468     12  AM-OVER-SHORT.
  6469         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6470         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6471
  6472     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6473     12  AM-DCC-CLP-STATE                  PIC XX.
  6474
  6475     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 119
* EL050.cbl
  6476     12  AM-RECALC-REIN                    PIC X.
  6477
  6478     12  AM-REI-TABLE                      PIC XXX.
  6479     12  AM-REI-ET-LF                      PIC X.
  6480     12  AM-REI-ET-AH                      PIC X.
  6481     12  AM-REI-PE-LF                      PIC X.
  6482     12  AM-REI-PE-AH                      PIC X.
  6483     12  AM-REI-PRT-ST                     PIC X.
  6484     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6485     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6486     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6487     12  AM-REI-GROUP-A                    PIC X(6).
  6488     12  AM-REI-MORT                       PIC X(4).
  6489     12  AM-REI-PRT-OW                     PIC X.
  6490     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6491     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6492     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6493     12  AM-REI-GROUP-B                    PIC X(6).
  6494
  6495     12  AM-TRUST-TYPE                     PIC X(2).
  6496
  6497     12  AM-EMPLOYER-STMT-USED             PIC X.
  6498     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6499
  6500     12  AM-STD-AH-TYPE                    PIC XX.
  6501     12  AM-EARN-METHODS.
  6502         16  AM-EARN-METHOD-R              PIC X.
  6503             88 AM-REF-RL-R78                 VALUE 'R'.
  6504             88 AM-REF-RL-PR                  VALUE 'P'.
  6505             88 AM-REF-RL-MEAN                VALUE 'M'.
  6506             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6507         16  AM-EARN-METHOD-L              PIC X.
  6508             88 AM-REF-LL-R78                 VALUE 'R'.
  6509             88 AM-REF-LL-PR                  VALUE 'P'.
  6510             88 AM-REF-LL-MEAN                VALUE 'M'.
  6511             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6512         16  AM-EARN-METHOD-A              PIC X.
  6513             88 AM-REF-AH-R78                 VALUE 'R'.
  6514             88 AM-REF-AH-PR                  VALUE 'P'.
  6515             88 AM-REF-AH-MEAN                VALUE 'M'.
  6516             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6517             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6518             88 AM-REF-AH-NET                 VALUE 'N'.
  6519
  6520     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6521     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6522     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6523
  6524     12  AM-RET-Y-N                        PIC X.
  6525     12  AM-RET-P-E                        PIC X.
  6526     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6527     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6528     12  AM-RET-GRP                        PIC X(6).
  6529     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6530         16  AM-POOL-PRIME                 PIC XXX.
  6531         16  AM-POOL-SUB                   PIC XXX.
  6532     12  AM-RETRO-EARNINGS.
  6533         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 120
* EL050.cbl
  6534         16  AM-RET-EARN-L                 PIC X.
  6535         16  AM-RET-EARN-A                 PIC X.
  6536     12  AM-RET-ST-TAX-USE                 PIC X.
  6537         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6538         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6539     12  AM-RETRO-BEG-EARNINGS.
  6540         16  AM-RET-BEG-EARN-R             PIC X.
  6541         16  AM-RET-BEG-EARN-L             PIC X.
  6542         16  AM-RET-BEG-EARN-A             PIC X.
  6543     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6544     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6545
  6546     12  AM-USER-SELECT-OPTIONS.
  6547         16  AM-USER-SELECT-1              PIC X(10).
  6548         16  AM-USER-SELECT-2              PIC X(10).
  6549         16  AM-USER-SELECT-3              PIC X(10).
  6550         16  AM-USER-SELECT-4              PIC X(10).
  6551         16  AM-USER-SELECT-5              PIC X(10).
  6552
  6553     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6554
  6555     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6556
  6557     12  AM-RPT045A-SWITCH                 PIC X.
  6558         88  RPT045A-OFF                   VALUE 'N'.
  6559
  6560     12  AM-INSURANCE-LIMITS.
  6561         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6562         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6563
  6564     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6565         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6566
  6567     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6568         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6569         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6570
  6571     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6572
  6573     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6574     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6575     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6576     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6577     12  AM-DCC-UEF-STATE                  PIC XX.
  6578     12  FILLER                            PIC XXX.
  6579     12  AM-REPORT-CODE-3                  PIC X(10).
  6580*    12  FILLER                            PIC X(22).
  6581
  6582     12  AM-RESERVE-DATE.
  6583         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6584         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6585         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6586
  6587     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6588     12  AM-NOTIFICATION-TYPES.
  6589         16  AM-NOTIF-OF-LETTERS           PIC X.
  6590         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6591         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 121
* EL050.cbl
  6592         16  AM-NOTIF-OF-STATUS            PIC X.
  6593
  6594     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6595         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6596         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6597         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6598         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6599
  6600     12  AM-BENEFIT-CONTROLS.
  6601         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6602             20  AM-BENEFIT-CODE           PIC XX.
  6603             20  AM-BENEFIT-TYPE           PIC X.
  6604             20  AM-BENEFIT-REVISION       PIC XXX.
  6605             20  AM-BENEFIT-REM-TERM       PIC X.
  6606             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6607             20  FILLER                    PIC XX.
  6608         16  FILLER                        PIC X(80).
  6609
  6610     12  AM-TRANSFER-DATA.
  6611         16  AM-TRANSFERRED-FROM.
  6612             20  AM-TRNFROM-CARRIER        PIC X.
  6613             20  AM-TRNFROM-GROUPING.
  6614                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6615                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6616             20  AM-TRNFROM-STATE          PIC XX.
  6617             20  AM-TRNFROM-ACCOUNT.
  6618                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6619                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6620             20  AM-TRNFROM-DTE            PIC XX.
  6621         16  AM-TRANSFERRED-TO.
  6622             20  AM-TRNTO-CARRIER          PIC X.
  6623             20  AM-TRNTO-GROUPING.
  6624                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6625                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6626             20  AM-TRNTO-STATE            PIC XX.
  6627             20  AM-TRNTO-ACCOUNT.
  6628                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6629                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6630             20  AM-TRNTO-DTE              PIC XX.
  6631         16  FILLER                        PIC X(10).
  6632
  6633     12  AM-SAVED-REMIT-TO                 PIC 99.
  6634
  6635     12  AM-COMM-STRUCTURE-SAVED.
  6636         16  AM-DEFN-1-SAVED.
  6637             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6638                 24  AM-AGT-SV             PIC X(10).
  6639                 24  AM-COM-TYP-SV         PIC X.
  6640                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6641                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6642                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6643                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6644                 24  FILLER                PIC X.
  6645                 24  AM-GL-CODES-SV        PIC X.
  6646                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6647                 24  FILLER                PIC X.
  6648         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6649             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 122
* EL050.cbl
  6650                 24  FILLER                PIC X(11).
  6651                 24  AM-L-COMA-SV          PIC XXX.
  6652                 24  AM-J-COMA-SV          PIC XXX.
  6653                 24  AM-A-COMA-SV          PIC XXX.
  6654                 24  FILLER                PIC X(6).
  6655
  6656     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6657         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6658            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6659            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6660            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6661
  6662     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6663     12  FILLER                            PIC X(120).
  6664
  6665     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6666         16  AM-CONTROL-NAME               PIC X(30).
  6667         16  AM-EXECUTIVE-ONE.
  6668             20  AM-EXEC1-NAME             PIC X(15).
  6669             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6670                                                          COMP-3.
  6671             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6672                                                          COMP-3.
  6673         16  AM-EXECUTIVE-TWO.
  6674             20  AM-EXEC2-NAME             PIC X(15).
  6675             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6676                                                          COMP-3.
  6677             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6678                                                          COMP-3.
  6679
  6680     12  AM-RETRO-ADDITIONAL-DATA.
  6681         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6682         16  AM-RETRO-PREM-P-E             PIC X.
  6683         16  AM-RETRO-CLMS-P-I             PIC X.
  6684         16  AM-RETRO-RET-BRACKET-LF.
  6685             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6686                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6687                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6688             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6689                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6690                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6691             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6692                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6693                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6694         16  AM-RETRO-RET-BRACKET-AH.
  6695             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6696                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6697                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6698                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6699             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6700                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6701                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6702             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6703                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6704                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6705
  6706     12  AM-COMMENTS.
  6707         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 123
* EL050.cbl
  6708
  6709     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6710         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6711         16  AM-FLI-BILLING-CODE           PIC X.
  6712         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6713         16  AM-FLI-UNITED-IDENT           PIC X.
  6714         16  AM-FLI-INTEREST-LOST-DATA.
  6715             20  AM-FLI-BANK-NO            PIC X(5).
  6716             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6717             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6718             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6719         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6720             20  AM-FLI-AGT                PIC X(9).
  6721             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6722             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6723         16  FILLER                        PIC X(102).
  6724
  6725     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6726         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6727             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6728             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6729             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6730             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6731             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6732         16  FILLER                          PIC X(10).
  6733******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 124
* EL050.cbl
  6735*    COPY ERCREIN.
  6736******************************************************************
  6737*                                                                *
  6738*                            ERCREIN                             *
  6739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6740*                            VMOD=2.010                          *
  6741*                                                                *
  6742*   ONLINE CREDIT SYSTEM                                         *
  6743*                                                                *
  6744*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6745*                                                                *
  6746*   FILE TYPE = VSAM,KSDS                                        *
  6747*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6748*                                                                *
  6749*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6750*       ALTERNATE PATH = NONE                                    *
  6751*                                                                *
  6752*   LOG = NO                                                     *
  6753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6754*                                                                *
  6755******************************************************************
  6756*                   C H A N G E   L O G
  6757*
  6758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6759*-----------------------------------------------------------------
  6760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6761* EFFECTIVE    NUMBER
  6762*-----------------------------------------------------------------
  6763* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6764* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6765******************************************************************
  6766 01  REINSURANCE-RECORD.
  6767     12  RE-RECORD-ID                      PIC XX.
  6768         88  VALID-RE-ID                      VALUE 'RE'.
  6769
  6770     12  RE-CONTROL-PRIMARY.
  6771         16  RE-COMPANY-CD                 PIC X.
  6772         16  RE-KEY.
  6773             20  RE-CODE                   PIC X.
  6774                 88  RE-TABLE-RECORD          VALUE 'A'.
  6775                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6776             20  RE-TABLE                  PIC XXX.
  6777             20  FILLER                    PIC XXX.
  6778         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6779             20  FILLER                    PIC X.
  6780             20  RE-COMPANY.
  6781                 24  RE-COMP-PRIME         PIC XXX.
  6782                 24  RE-COMP-SUB           PIC XXX.
  6783
  6784     12  RE-MAINT-INFORMATION.
  6785         16  RE-LAST-MAINT-DT              PIC XX.
  6786         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6787         16  RE-LAST-MAINT-USER            PIC X(4).
  6788         16  FILLER                        PIC X(10).
  6789
  6790     12  RE-TABLE-DATA.
  6791         16  RE-100-COMP                   PIC 99.
  6792
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 125
* EL050.cbl
  6793         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6794             20  RE-REI-COMP-NO.
  6795                 24  RE-REI-COMP           PIC XXX.
  6796                 24  RE-REI-COMP-SUB       PIC XXX.
  6797             20  RE-LF-QC                  PIC X.
  6798             20  RE-AH-QC                  PIC X.
  6799             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6800             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6801             20  RE-LFAGE-LO               PIC 99.
  6802             20  RE-LFAGE-HI               PIC 99.
  6803             20  RE-AHAGE-LO               PIC 99.
  6804             20  RE-AHAGE-HI               PIC 99.
  6805             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6806             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6807             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6808             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6809             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6810             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6811             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6812             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6813             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6814             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6815             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6816             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6817             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6818             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6819             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6820             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6821             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6822             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6823             20  RE-LF-BEN-CODE            PIC X.
  6824             20  RE-AH-BEN-CODE            PIC X.
  6825             20  RE-INTERACTIVE            PIC X.
  6826             20  RE-REMAINING              PIC X.
  6827             20  RE-LF-RUNOFF-SW           PIC X.
  6828             20  RE-AH-RUNOFF-SW           PIC X.
  6829             20  FILLER                    PIC X(19).
  6830
  6831         16  RE-COMP-INFO-END              PIC X(6).
  6832         16  RE-NSP-ST-CD-LF               PIC XX.
  6833         16  RE-NSP-ST-CD-AH               PIC XX.
  6834         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6835             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6836
  6837         16  FILLER                        PIC X(27).
  6838
  6839     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6840         16  RE-NAME                       PIC X(30).
  6841         16  RE-LF-PE                      PIC X.
  6842         16  RE-AH-PE                      PIC X.
  6843         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6844         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6845         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6846         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6847         16  RE-PRT-ST                     PIC X.
  6848         16  RE-PRT-OW                     PIC X.
  6849         16  RE-MORT-CODE                  PIC X(4).
  6850         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 126
* EL050.cbl
  6851         16  RE-ZERO-LF-FEE                PIC X.
  6852         16  RE-ZERO-AH-FEE                PIC X.
  6853         16  RE-CEDE-NAME                  PIC X(30).
  6854         16  RE-LF-COMM                    PIC X.
  6855         16  RE-AH-COMM                    PIC X.
  6856         16  RE-LF-TAX                     PIC X.
  6857         16  RE-AH-TAX                     PIC X.
  6858         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6859         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6860         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6861
  6862         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6863             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6864
  6865         16  RE-LF-CEDING-FEE-BRACKETS.
  6866             20  RE-LF-FEE-METHOD          PIC X.
  6867                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6868                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6869                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6870                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6871             20  RE-LF-FEE-BASIS           PIC X.
  6872                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6873                 88  RE-LF-NET-CEDED               VALUE '2'.
  6874                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6875                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6876                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6877                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6878                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6879                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6880             20  FILLER                    PIC XXX.
  6881             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6882                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6883                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6884
  6885         16  RE-AH-CEDING-FEE-BRACKETS.
  6886             20  RE-AH-FEE-METHOD          PIC X.
  6887                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6888                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6889                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6890                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6891             20  RE-AH-FEE-BASIS           PIC X.
  6892                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6893                 88  RE-AH-NET-CEDED               VALUE '2'.
  6894                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6895                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6896                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6897                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6898                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6899                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6900             20  FILLER                    PIC XXX.
  6901             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6902                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6903                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6904
  6905         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6906
  6907         16  RE-OLD-CEDING-STMT            PIC X.
  6908
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 127
* EL050.cbl
  6909         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6910         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6911         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6912         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6913         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6914         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6915         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6916         16  RE-MORT-SW                    PIC X.
  6917         16  RE-CEDING-TYPE-FLAG           PIC X.
  6918             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6919             88  RE-CEDED                          VALUE 'C'.
  6920             88  RE-ASSUMED                        VALUE 'A'.
  6921             88  RE-PHANTOM                        VALUE 'P'.
  6922
  6923         16  RE-CEDING-STMT-OPT-A          PIC X.
  6924             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6925         16  RE-CEDING-STMT-OPT-B          PIC X.
  6926             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6927         16  RE-CEDING-STMT-OPT-C          PIC X.
  6928             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6929         16  RE-CEDING-STMT-OPT-D          PIC X.
  6930             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6931         16  RE-CEDING-STMT-OPT-E          PIC X.
  6932             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6933
  6934         16  RE-PRT-CRSV                   PIC X.
  6935
  6936         16  RE-GL-CENTER                  PIC X(4).
  6937
  6938         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6939
  6940         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6941
  6942         16  RE-EARN-STOP-CODE             PIC X.
  6943             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6944             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6945
  6946         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6947             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6948
  6949         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6950         16  FILLER                        PIC X(2281).
  6951
  6952         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6953
  6954******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 128
* EL050.cbl
  6956*    COPY ERCCTBL.
  6957******************************************************************
  6958*                                                                *
  6959*                                                                *
  6960*                            ERCCTBL                             *
  6961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6962*                            VMOD=2.003
  6963*                                                                *
  6964*   ONLINE CREDIT SYSTEM                                         *
  6965*                                                                *
  6966*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6967*                                                                *
  6968*   FILE TYPE = VSAM,KSDS                                        *
  6969*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6970*                                                                *
  6971*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6972*       ALTERNATE PATH = NONE                                    *
  6973*                                                                *
  6974*   LOG = NO                                                     *
  6975*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6976*                                                                *
  6977*                                                                *
  6978******************************************************************
  6979
  6980 01  COMM-TABLE-RECORD.
  6981     12  CT-RECORD-ID                      PIC XX.
  6982         88  VALID-CT-ID                      VALUE 'CT'.
  6983
  6984     12  CT-CONTROL-PRIMARY.
  6985         16  CT-COMPANY-CD                 PIC X.
  6986         16  CT-TABLE                      PIC XXX.
  6987         16  CT-CNTRL-2.
  6988             20  CT-BEN-TYPE               PIC X.
  6989             20  CT-BEN-CODE               PIC XX.
  6990
  6991     12  CT-MAINT-INFORMATION.
  6992         16  CT-LAST-MAINT-DT              PIC XX.
  6993         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6994         16  CT-LAST-MAINT-USER            PIC X(4).
  6995         16  FILLER                        PIC X(31).
  6996
  6997     12  CT-LIMITS.
  6998         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  6999
  7000         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7001
  7002         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7003
  7004     12  CT-RATES.
  7005         16  CT-RTX          OCCURS 27 TIMES.
  7006             20  CT-RT                     PIC SV9(5)     COMP-3.
  7007             20  CT-RT-R   REDEFINES
  7008                 CT-RT                     PIC XXX.
  7009
  7010     12  FILLER                            PIC  X(42).
  7011
  7012******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 129
* EL050.cbl
  7014*    COPY ERCFORM.
  7015******************************************************************
  7016*                                                                *
  7017*                                                                *
  7018*                            ERCFORM.                            *
  7019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7020*                            VMOD=2.003                          *
  7021*                                                                *
  7022*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7023*                                                                *
  7024*    FILE TYPE = VSAM,KSDS                                       *
  7025*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7026*                                                                *
  7027*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7028*                                                                *
  7029*    LOG = YES                                                   *
  7030*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7031******************************************************************
  7032 01  FORM-MASTER.
  7033    12  FO-RECORD-ID                 PIC X(02).
  7034        88  VALID-FO-ID                  VALUE 'FO'.
  7035
  7036    12  FO-CONTROL-PRIMARY.
  7037        16  FO-COMPANY-CD            PIC X(01).
  7038        16  FO-STATE                 PIC X(02).
  7039        16  FO-FORM-ID               PIC X(12).
  7040        16  FO-FORM-EXP-DT           PIC X(02).
  7041
  7042    12  FO-POLICY-FORM-DATA.
  7043        16  FO-IND-GRP-CD            PIC X(01).
  7044        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7045        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7046        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7047        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7048        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7049        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7050        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7051        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7052        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7053        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7054        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7055        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7056        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7057        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7058        16  FO-APP-CERT-USE-CD       PIC X(01).
  7059
  7060    12  FILLER                       PIC X(29).
  7061
  7062    12  FO-FORM-PLAN-TABLE.
  7063        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7064            20  FO-PLAN-TYPE         PIC X(01).
  7065            20  FO-PLAN-ID           PIC X(02).
  7066            20  FO-PLAN-TERM         PIC 9(03).
  7067            20  FO-PLAN-REFUND-METHOD
  7068                                     PIC X.
  7069
  7070    12  FILLER                       PIC X(30).
  7071
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 130
* EL050.cbl
  7072    12  FO-COMMENTS-AREA.
  7073        16  FO-COMMENT-LINE-1        PIC X(78).
  7074
  7075    12  FILLER                       PIC X(20).
  7076
  7077    12  FO-MAINT-INFORMATION.
  7078        16  FO-LAST-MAINT-DT         PIC X(02).
  7079        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7080        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 131
* EL050.cbl
  7082*    COPY ELCMSTR.
  7083******************************************************************
  7084*                                                                *
  7085*                            ELCMSTR.                            *
  7086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7087*                            VMOD=2.012                          *
  7088*                                                                *
  7089*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7090*                                                                *
  7091*   FILE TYPE = VSAM,KSDS                                        *
  7092*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7093*                                                                *
  7094*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7095*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7096*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7097*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7098*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7099*                                                 RKP=75,LEN=21  *
  7100*                                                                *
  7101*   **** NOTE ****                                               *
  7102*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7103*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7104*                                                                *
  7105*   LOG = YES                                                    *
  7106*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7107******************************************************************
  7108*                   C H A N G E   L O G
  7109*
  7110* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7111*-----------------------------------------------------------------
  7112*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7113* EFFECTIVE    NUMBER
  7114*-----------------------------------------------------------------
  7115* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7116* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7117******************************************************************
  7118 01  CLAIM-MASTER.
  7119     12  CL-RECORD-ID                PIC XX.
  7120         88  VALID-CL-ID         VALUE 'CL'.
  7121
  7122     12  CL-CONTROL-PRIMARY.
  7123         16  CL-COMPANY-CD           PIC X.
  7124         16  CL-CARRIER              PIC X.
  7125         16  CL-CLAIM-NO             PIC X(7).
  7126         16  CL-CERT-NO.
  7127             20  CL-CERT-PRIME       PIC X(10).
  7128             20  CL-CERT-SFX         PIC X.
  7129
  7130     12  CL-CONTROL-BY-NAME.
  7131         16  CL-COMPANY-CD-A1        PIC X.
  7132         16  CL-INSURED-LAST-NAME    PIC X(15).
  7133         16  CL-INSURED-NAME.
  7134             20  CL-INSURED-1ST-NAME PIC X(12).
  7135             20  CL-INSURED-MID-INIT PIC X.
  7136
  7137     12  CL-CONTROL-BY-SSN.
  7138         16  CL-COMPANY-CD-A2        PIC X.
  7139         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 132
* EL050.cbl
  7140             20  CL-SSN-STATE        PIC XX.
  7141             20  CL-SSN-ACCOUNT      PIC X(6).
  7142             20  CL-SSN-LN3          PIC X(3).
  7143
  7144     12  CL-CONTROL-BY-CERT-NO.
  7145         16  CL-COMPANY-CD-A4        PIC X.
  7146         16  CL-CERT-NO-A4.
  7147             20  CL-CERT-A4-PRIME    PIC X(10).
  7148             20  CL-CERT-A4-SFX      PIC X.
  7149
  7150     12  CL-CONTROL-BY-CCN.
  7151         16  CL-COMPANY-CD-A5        PIC X.
  7152         16  CL-CCN-A5.
  7153             20  CL-CCN.
  7154                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7155                 24  CL-CCN-PRIME-A5 PIC X(12).
  7156             20  CL-CCN-FILLER-A5    PIC X(4).
  7157
  7158     12  CL-INSURED-PROFILE-DATA.
  7159         16  CL-INSURED-BIRTH-DT     PIC XX.
  7160         16  CL-INSURED-SEX-CD       PIC X.
  7161             88  INSURED-IS-MALE        VALUE 'M'.
  7162             88  INSURED-IS-FEMALE      VALUE 'F'.
  7163             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7164         16  CL-INSURED-OCC-CD       PIC X(6).
  7165         16  FILLER                  PIC X(5).
  7166
  7167     12  CL-PROCESSING-INFO.
  7168         16  CL-PROCESSOR-ID         PIC X(4).
  7169         16  CL-CLAIM-STATUS         PIC X.
  7170             88  CLAIM-IS-OPEN          VALUE 'O'.
  7171             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7172         16  CL-CLAIM-TYPE           PIC X.
  7173*            88  AH-CLAIM               VALUE 'A'.
  7174*            88  LIFE-CLAIM             VALUE 'L'.
  7175*            88  PROPERTY-CLAIM         VALUE 'P'.
  7176*            88  IUI-CLAIM              VALUE 'I'.
  7177*            88  GAP-CLAIM              VALUE 'G'.
  7178         16  CL-CLAIM-PREM-TYPE      PIC X.
  7179             88  SINGLE-PREMIUM         VALUE '1'.
  7180             88  O-B-COVERAGE           VALUE '2'.
  7181             88  OPEN-END-COVERAGE      VALUE '3'.
  7182         16  CL-INCURRED-DT          PIC XX.
  7183         16  CL-REPORTED-DT          PIC XX.
  7184         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7185         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7186         16  CL-LAST-PMT-DT          PIC XX.
  7187         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7188         16  CL-PAID-THRU-DT         PIC XX.
  7189         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7190         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7191         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7192         16  CL-PMT-CALC-METHOD      PIC X.
  7193             88  CL-360-DAY-YR          VALUE '1'.
  7194             88  CL-365-DAY-YR          VALUE '2'.
  7195             88  CL-FULL-MONTHS         VALUE '3'.
  7196         16  CL-CAUSE-CD             PIC X(6).
  7197
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 133
* EL050.cbl
  7198         16  CL-PRIME-CERT-NO.
  7199             20  CL-PRIME-CERT-PRIME PIC X(10).
  7200             20  CL-PRIME-CERT-SFX   PIC X.
  7201
  7202         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7203             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7204             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7205
  7206         16  CL-MICROFILM-NO         PIC X(10).
  7207         16  CL-PROG-FORM-TYPE       PIC X.
  7208         16  CL-LAST-ADD-ON-DT       PIC XX.
  7209
  7210         16  CL-LAST-REOPEN-DT       PIC XX.
  7211         16  CL-LAST-CLOSE-DT        PIC XX.
  7212         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7213             88  FINAL-PAID             VALUE '1'.
  7214             88  CLAIM-DENIED           VALUE '2'.
  7215             88  AUTO-CLOSE             VALUE '3'.
  7216             88  MANUAL-CLOSE           VALUE '4'.
  7217             88  BENEFITS-CHANGED       VALUE 'C'.
  7218             88  SETUP-ERRORS           VALUE 'E'.
  7219         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7220         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7221         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7222             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7223         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7224         16  FILLER                  PIC X.
  7225
  7226     12  CL-CERTIFICATE-DATA.
  7227         16  CL-CERT-ORIGIN          PIC X.
  7228             88  CERT-WAS-ONLINE        VALUE '1'.
  7229             88  CERT-WAS-CREATED       VALUE '2'.
  7230             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7231         16  CL-CERT-KEY-DATA.
  7232             20  CL-CERT-CARRIER     PIC X.
  7233             20  CL-CERT-GROUPING    PIC X(6).
  7234             20  CL-CERT-STATE       PIC XX.
  7235             20  CL-CERT-ACCOUNT.
  7236                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7237                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7238             20  CL-CERT-EFF-DT      PIC XX.
  7239
  7240     12  CL-STATUS-CONTROLS.
  7241         16  CL-PRIORITY-CD          PIC X.
  7242             88  CONFIDENTIAL-DATA      VALUE '8'.
  7243             88  HIGHEST-PRIORITY       VALUE '9'.
  7244         16  CL-SUPV-ATTN-CD         PIC X.
  7245             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7246             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7247         16  CL-PURGED-DT            PIC XX.
  7248         16  CL-RESTORED-DT          PIC XX.
  7249         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7250         16  CL-NEXT-RESEND-DT       PIC XX.
  7251         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7252         16  FILLER                  PIC XX.
  7253         16  CL-LAST-MAINT-DT        PIC XX.
  7254         16  CL-LAST-MAINT-USER      PIC X(4).
  7255         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 134
* EL050.cbl
  7256         16  CL-LAST-MAINT-TYPE      PIC X.
  7257             88  CLAIM-SET-UP           VALUE ' '.
  7258             88  PAYMENT-MADE           VALUE '1'.
  7259             88  LETTER-SENT            VALUE '2'.
  7260             88  MASTER-WAS-ALTERED     VALUE '3'.
  7261             88  MASTER-WAS-RESTORED    VALUE '4'.
  7262             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7263             88  FILE-CONVERTED         VALUE '6'.
  7264             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7265             88  ERROR-CORRECTION       VALUE 'E'.
  7266         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7267         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7268         16  CL-BENEFICIARY          PIC X(10).
  7269         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7270         16  CL-DENIAL-TYPE          PIC X.
  7271             88  CL-TYPE-DENIAL          VALUE '1'.
  7272             88  CL-TYPE-RESCISSION      VALUE '2'.
  7273             88  CL-TYPE-REFORMATION     VALUE '3'.
  7274             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7275             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7276         16  FILLER                  PIC X(5).
  7277
  7278     12  CL-TRAILER-CONTROLS.
  7279         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7280             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7281             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7282             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7283         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7284         16  FILLER                  PIC XX.
  7285         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7286         16  CL-ADDRESS-TRAILER-CNT.
  7287             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7288                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7289             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7290                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7291             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7292                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7293             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7294                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7295             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7296                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7297             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7298                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7299             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7300                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7301
  7302     12  CL-CV-REFERENCE-NO.
  7303         16  CL-CV-REFNO-PRIME       PIC X(18).
  7304         16  CL-CV-REFNO-SFX         PIC XX.
  7305
  7306     12  CL-FILE-LOCATION            PIC X(4).
  7307
  7308     12  CL-PROCESS-ERRORS.
  7309         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7310             88  NO-FATAL-ERRORS        VALUE ZERO.
  7311         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7312             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7313
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 135
* EL050.cbl
  7314     12  CL-PRODUCT-CD               PIC X.
  7315
  7316     12  CL-CURRENT-KEY-DATA.
  7317         16  CL-CURRENT-CARRIER      PIC X.
  7318         16  CL-CURRENT-GROUPING     PIC X(6).
  7319         16  CL-CURRENT-STATE        PIC XX.
  7320         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7321
  7322     12  CL-ASSOCIATES               PIC X.
  7323         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7324         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7325         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7326         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7327
  7328     12  CL-ACTIVITY-CODE            PIC 99.
  7329     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7330     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7331
  7332     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7333     12  CL-LAG-REPORT-CODE          PIC 9.
  7334     12  CL-LOAN-TYPE                PIC XX.
  7335     12  CL-LEGAL-STATE              PIC XX.
  7336
  7337*    12  FILLER                      PIC X(5).
  7338     12  CL-YESNOSW                  PIC X.
  7339     12  FILLER                      PIC X(4).
  7340
  7341 01  PLAN-RECORDS.
  7342     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7343     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7344
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 136
* EL050.cbl
  7346 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7347                          ACCOUNT-MASTER REINSURANCE-RECORD
  7348                          COMM-TABLE-RECORD FORM-MASTER
  7349                          CLAIM-MASTER PLAN-RECORDS.
  7350 0000-DFHEXIT SECTION.
  7351     MOVE '9#                    $   ' TO DFHEIV0.
  7352     MOVE 'EL050' TO DFHEIV1.
  7353     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7354
  7355     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7356
  7357
  7358* EXEC CICS  HANDLE CONDITION
  7359*           ERROR    (9300-ABEND)
  7360*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7361*    END-EXEC.
  7362*    MOVE '"$.J                  ! " #00007353' TO DFHEIV0
  7363     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7365     MOVE X'2220233030303037333533' TO DFHEIV0(25:11)
  7366     CALL 'kxdfhei1' USING DFHEIV0
  7367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7368
  7369
  7370 0000-COPY-PROCEDURE-DIV.
  7371*                          COPY ELC50PD.
  7372******************************************************************
  7373*                                                                *
  7374*                            ELC50PD                             *
  7375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7376*                            VMOD=2.188                          *
  7377*                                                                *
  7378******************************************************************
  7379*                   C H A N G E   L O G
  7380*
  7381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7382*-----------------------------------------------------------------
  7383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7384* EFFECTIVE    NUMBER
  7385*-----------------------------------------------------------------
  7386* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7387* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7388* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7389*                             2709 AND 2718
  7390* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7391* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7392* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7393* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7394* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7395*                                IS OPEN OR CNC DT < PD THRU
  7396* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7397* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7398* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7399* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7400* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7401* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7402* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7403* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 137
* EL050.cbl
  7404* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7405* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7406* 020906                   PEMA  EXPAND LOAN OFFICER
  7407* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7408* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7409* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7410* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7411* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7412* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7413* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7414* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7415* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7416* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7417* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7418* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7419* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7420* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7421* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7422* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7423* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7424* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7425* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7426* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7427* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7428* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7429* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7430* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7431* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7432*                                UPDATE VIN ON CERT TRAILER
  7433* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7434* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7435* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7436* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7437* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7438* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7439* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7440* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7441* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7442* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7443* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7444* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7445* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7446* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7447* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7448* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7449* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7450* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7451* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7452* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7453* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7454* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7455* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7456* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7457* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7458* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7459* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7460* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7461* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 138
* EL050.cbl
  7462* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7463******************************************************************
  7464************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7465******************************************************************
  7466
  7467     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7468
  7469     MOVE SPACES                 TO PB-FATAL-FLAG
  7470                                    PB-FORCE-ER-CD
  7471                                    PB-WARN-ER-CD
  7472                                    PB-OUT-BAL-CD.
  7473
  7474     MOVE SPACE                  TO WS-IG-OVRD-AH
  7475                                    WS-IG-OVRD-LF
  7476                                    WS-IG-OVRD-AM
  7477                                    WS-IG-OVRD
  7478                                    WS-IG-OVRD-AH-PL
  7479                                    WS-IG-OVRD-LF-PL
  7480                                    WS-IG-OVRD-AH-BEN
  7481                                    WS-IG-OVRD-LF-BEN.
  7482
  7483******************************************************************
  7484*************       INITIALIZE COMMON ERRORS       ***************
  7485******************************************************************
  7486
  7487     MOVE +0                     TO PB-NO-OF-ERRORS.
  7488     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7489
  7490******************************************************************
  7491
  7492     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7493     SET JULIAN-TO-BIN           TO TRUE.
  7494*    MOVE 5                      TO DC-OPTION-CODE.
  7495     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7496     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7497
  7498     MOVE ZERO                   TO  SUB4.
  7499
  7500 0040-INITIALIZE-GA-BILL-DT.
  7501
  7502     ADD +1                      TO  SUB4.
  7503
  7504     IF  SUB4 GREATER THAN +5
  7505         GO TO 0050-CHECK-CNTL-FOUND.
  7506
  7507     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7508         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7509
  7510     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7511
  7512 0050-CHECK-CNTL-FOUND.
  7513
  7514     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7515        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7516                                         WS-AH-REM-TERM-CALC
  7517                                         EC-CO-REM-TERM-CALC
  7518        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7519        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 139
* EL050.cbl
  7520        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7521                                         WS-TOL-AH-CLAIM
  7522        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7523                                         WS-TOL-AH-PREM
  7524                                         EC-CO-TOL-PREM
  7525        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7526                                         WS-TOL-AH-REFUND
  7527                                         EC-CO-TOL-REFUND
  7528        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7529                                         WS-AH-REFUND-OVS-AMT
  7530                                         EC-CO-OVR-SHT-AMT
  7531        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7532                                         WS-TOL-AH-PREM-PCT
  7533                                         EC-CO-TOL-PREM-PCT
  7534        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7535                                         WS-TOL-AH-REFUND-PCT
  7536                                         EC-CO-TOL-REFUND-PCT
  7537        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7538                                         WS-AH-REFUND-OVS-PCT
  7539                                         EC-CO-OVR-SHT-PCT
  7540        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7541        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7542        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7543        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7544        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7545        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7546        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7547        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7548        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7549        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7550        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7551        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7552                                         EC-CO-MONTH-END-DT
  7553        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7554          GO TO 0100-READ-ACCT.
  7555
  7556     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7557     MOVE SPACES                 TO CNTL-ACCESS.
  7558     MOVE '1'                    TO CNTL-REC-TYPE.
  7559     MOVE +0                     TO CNTL-SEQ-NO.
  7560
  7561     MOVE '1' TO RC-SW-1.
  7562     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7563     IF NOT CF-COMPANY-MASTER
  7564         MOVE ZEROS             TO WK-CO-TOL-PREM
  7565                                   WK-CO-TOL-CLAIM
  7566                                   WK-CO-TOL-REFUND
  7567                                   WK-REFUND-OVS-AMT
  7568                                   WK-REFUND-OVS-PCT
  7569                                   WK-CO-TOL-PREM-PCT
  7570                                   WK-CO-TOL-REFUND-PCT
  7571                                   WK-DEFAULT-APR
  7572                                   WK-CO-MAX-CAP
  7573        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7574                                   WK-CR-R78-METHOD
  7575                                   WK-CO-REF-REJECT-SW
  7576                                   WK-CO-PREM-REJECT-SW
  7577                                   WK-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 140
* EL050.cbl
  7578                                   WK-BIRTH-DATE-INPUT
  7579                                   WK-JOINT-AGE-INPUT
  7580        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7581        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7582        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7583        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7584          GO TO 0099-COMPANY-NOT-FOUND.
  7585
  7586     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7587        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7588     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7589        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7590     IF CF-CO-TOL-CAP NOT NUMERIC
  7591        MOVE +0                    TO CF-CO-TOL-CAP.
  7592     IF CF-DEFAULT-APR NOT NUMERIC
  7593        MOVE +0                    TO CF-DEFAULT-APR.
  7594
  7595     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7596     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7597     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7598     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7599     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7600     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7601     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7602     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7603     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7604     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7605     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7606     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7607
  7608     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7609          CF-CO-OVR-SHT-AMT > +0
  7610        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7611
  7612     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7613          CF-CO-OVR-SHT-PCT > +0
  7614        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7615
  7616     IF CF-VALID-REM-TRM-OPTION
  7617         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7618     ELSE
  7619         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7620
  7621     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7622     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7623     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7624     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7625
  7626     GO TO 0050-CHECK-CNTL-FOUND.
  7627
  7628 0099-COMPANY-NOT-FOUND.
  7629
  7630     MOVE ER-2616                TO WS-ERROR.
  7631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7632
  7633 0100-READ-ACCT.
  7634
  7635     MOVE SPACES                 TO DATE-RANGE-SW.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 141
* EL050.cbl
  7636
  7637     IF WK-ACCT-ADDR = ZEROS
  7638        GO TO 0102-ACCT-GETMAIN.
  7639
  7640     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7641     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7642     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7643
  7644     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7645        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7646        GO TO 0105-READ-ACCT
  7647     END-IF
  7648
  7649     IF PB-CARRIER NOT = SPACES
  7650        IF PB-CARRIER NOT = AM-VG-CARRIER
  7651           GO TO 0105-READ-ACCT.
  7652
  7653     IF PB-STATE NOT = SPACES
  7654        IF PB-STATE NOT = AM-VG-STATE
  7655           GO TO 0105-READ-ACCT.
  7656
  7657     IF PB-GROUPING NOT = SPACES
  7658        IF PB-GROUPING NOT = AM-VG-GROUPING
  7659           GO TO 0105-READ-ACCT.
  7660
  7661     MOVE 'X'                 TO DATE-RANGE-SW.
  7662
  7663     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7664        MOVE 'X'                 TO DATE-RANGE-SW
  7665        GO TO 0105-READ-ACCT.
  7666
  7667     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7668        GO TO 0105-READ-ACCT.
  7669
  7670     GO TO 0180-ACCOUNT-FOUND.
  7671
  7672 0102-ACCT-GETMAIN.
  7673     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7674     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7675
  7676 0105-READ-ACCT.
  7677     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7678     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7679     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7680     MOVE PB-STATE               TO ACCT-STATE.
  7681     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7682     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7683
  7684     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7685
  7686     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7687
  7688 0110-FIND-ACCT-TOLERANCES-LOOP.
  7689     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7690
  7691     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7692        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7693        GO TO 0199-ACCT-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 142
* EL050.cbl
  7694     END-IF
  7695     IF PB-CARRIER NOT = SPACES
  7696        IF PB-CARRIER NOT = AM-VG-CARRIER
  7697           GO TO 0199-ACCT-NOT-FOUND.
  7698
  7699     IF PB-STATE NOT = SPACES
  7700        IF PB-STATE NOT = AM-VG-STATE
  7701           GO TO 0199-ACCT-NOT-FOUND.
  7702
  7703     IF PB-GROUPING NOT = SPACES
  7704        IF PB-GROUPING NOT = AM-VG-GROUPING
  7705           GO TO 0199-ACCT-NOT-FOUND.
  7706
  7707     MOVE 'X'                    TO DATE-RANGE-SW.
  7708
  7709     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7710        MOVE 'X'                 TO DATE-RANGE-SW
  7711        GO TO 0199-ACCT-NOT-FOUND.
  7712
  7713     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7714        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7715
  7716 0180-ACCOUNT-FOUND.
  7717     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7718     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7719     MOVE AM-STATE               TO PB-SV-STATE.
  7720     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7721
  7722     IF AM-CANCEL-FEE  NOT NUMERIC
  7723        MOVE ZEROS TO AM-CANCEL-FEE.
  7724
  7725     IF AM-MAX-MON-BEN NOT NUMERIC
  7726        MOVE ZEROS TO AM-MAX-MON-BEN.
  7727
  7728     IF AM-MAX-TOT-BEN NOT NUMERIC
  7729        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7730
  7731     IF AM-CLP-TOL-PCT NOT NUMERIC
  7732        MOVE +0                  TO AM-CLP-TOL-PCT
  7733     END-IF
  7734     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7735        MOVE +0                  TO AM-SPP-LEASE-COMM
  7736     END-IF
  7737     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7738        MOVE ER-2611             TO   WS-ERROR
  7739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7740
  7741     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7742        MOVE ER-2621             TO   WS-ERROR
  7743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7744
  7745     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7746        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7747        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7748        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7749         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7750
  7751     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 143
* EL050.cbl
  7752     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7753     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7754     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7755     IF AM-CLP-TOL-PCT NOT = ZEROS
  7756        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7757     END-IF
  7758     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7759        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7760     END-IF
  7761*    IF PB-COMPANY-ID = 'DCC'
  7762*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7763*                                   WS-ADMIN-FEES
  7764*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7765*          (SUB5 > +10)
  7766*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7767*             AND (AM-A-COM (SUB5) NUMERIC)
  7768*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7769*                + (AM-A-COM (SUB5) * 1000)
  7770*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7771*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7772*                + (AM-A-COM (SUB5) * 1000)
  7773*             END-IF
  7774*             IF AM-COM-TYP (SUB5) = 'N'
  7775*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7776*                + (AM-A-COM (SUB5) * 1000)
  7777*             END-IF
  7778*          END-IF
  7779*       END-PERFORM
  7780*    END-IF
  7781     IF (PB-COMPANY-ID = 'DCC')
  7782        AND (PB-ISSUE)
  7783        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7784        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7785           (SUB5 > +10)
  7786           MOVE +0 TO WS-WK-RATE
  7787           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7788              IF (AM-A-COM (SUB5) NUMERIC)
  7789                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7790                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7791              ELSE
  7792                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7793                 IF PB-ISSUE
  7794                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7795                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7796                 ELSE
  7797                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7798                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7799                 END-IF
  7800                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7801                 MOVE ZEROS             TO WS-SUB1
  7802                                           WS-COMMISSION
  7803                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7804                 MOVE '0530'               TO CTBL-SW
  7805                 MOVE ' '                  TO WS-CTBL-READ-SW
  7806                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7807                 IF FIRST-TIME-THROUGH
  7808                    MOVE 'AA'              TO CTBL-BEN-CODE
  7809                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 144
* EL050.cbl
  7810                 END-IF
  7811                 IF CTBL-TABLE-FOUND
  7812                    IF PB-ISSUE
  7813                       COMPUTE WS-COMM-CK-AMT =
  7814                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7815                    ELSE
  7816                       COMPUTE WS-COMM-CK-AMT =
  7817                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7818                    END-IF
  7819                    PERFORM 8800-GET-COMP-RATE
  7820                              THRU 8800-EXIT
  7821                 END-IF
  7822              END-IF
  7823              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7824                + (WS-WK-RATE * 1000)
  7825           END-IF
  7826        END-PERFORM
  7827     END-IF
  7828     IF PB-COMPANY-ID EQUAL 'CRI'
  7829         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7830
  7831     IF PB-COMPANY-ID EQUAL 'NCL'
  7832         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7833     END-IF
  7834
  7835     GO TO 0200-READ-CERT.
  7836
  7837 0199-ACCT-NOT-FOUND.
  7838
  7839     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7840
  7841     IF DATE-RANGE-SW NOT = SPACES
  7842        MOVE ER-2601             TO WS-ERROR
  7843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7844     ELSE
  7845        MOVE ER-2619             TO WS-ERROR
  7846        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7847
  7848     GO TO 9990-RETURN.
  7849
  7850 0200-READ-CERT.
  7851
  7852     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7853     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7854     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7855     MOVE PB-SV-STATE            TO CERT-STATE.
  7856     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7857     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7858     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7859
  7860     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7861
  7862     IF CERT-WAS-NOT-FOUND
  7863        GO TO 0299-CERT-NOT-FOUND.
  7864
  7865     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7866        MOVE ER-2759             TO WS-ERROR
  7867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 145
* EL050.cbl
  7868        GO TO 0298-UNLOCK-RETURN.
  7869
  7870     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7871         MOVE ER-2758            TO WS-ERROR
  7872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7873         GO TO 0298-UNLOCK-RETURN.
  7874
  7875     IF PB-ISSUE
  7876        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7877           IF CERT-WAS-CREATED-FOR-CLAIM
  7878              NEXT SENTENCE
  7879            ELSE
  7880              MOVE ER-2626       TO WS-ERROR
  7881              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7882              GO TO 0298-UNLOCK-RETURN.
  7883
  7884     IF NOT PB-CANCELLATION
  7885        GO TO 0300-CONTINUE-EDIT.
  7886
  7887     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7888     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7889     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7890     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7891     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7892     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7893
  7894     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7895     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7896     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7897     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7898     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7899     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7900     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7901     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7902     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7903
  7904     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7905     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7906     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7907     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7908     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7909     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7910     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7911
  7912     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7913     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7914
  7915     MOVE CM-CREDIT-INTERFACE-SW-1
  7916                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7917     MOVE CM-CREDIT-INTERFACE-SW-2
  7918                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7919
  7920     IF CM-O-B-COVERAGE
  7921         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7922
  7923     IF CM-LIVES NOT NUMERIC
  7924         MOVE ZERO                TO CM-LIVES.
  7925
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 146
* EL050.cbl
  7926     IF CM-BILLED NOT NUMERIC
  7927         MOVE ZERO                TO CM-BILLED.
  7928
  7929     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7930         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7931         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7932         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7933         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7934         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7935         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7936         MOVE CM-LIVES             TO PB-CI-LIVES
  7937*The next line causes a problem with my change  I dont think it is
  7938*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7939
  7940     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7941     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7942     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7943     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7944     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7945     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7946
  7947     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7948     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7949     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7950     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7951
  7952     IF CM-LIFE-COMM-PCT NUMERIC
  7953         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7954     ELSE
  7955         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7956
  7957     IF CM-AH-COMM-PCT NUMERIC
  7958         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7959     ELSE
  7960         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7961
  7962     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7963
  7964     IF CM-LOAN-APR       NOT NUMERIC
  7965           MOVE ZERO               TO CM-LOAN-APR.
  7966
  7967     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7968           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7969
  7970     IF CM-LOAN-TERM      NOT NUMERIC
  7971           MOVE ZERO               TO CM-LOAN-TERM.
  7972
  7973     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7974           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7975
  7976     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7977           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7978
  7979     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7980     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7981     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7982     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7983     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 147
* EL050.cbl
  7984     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7985     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7986     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  7987     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7988     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7989     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7990     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  7991
  7992     IF CM-STATE = CM-SSN-STATE
  7993         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  7994
  7995     IF CM-STATE NOT = CM-MEMB-STATE
  7996         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  7997
  7998     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  7999
  8000     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8001        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8002        IF CM-ADDL-CLP NOT NUMERIC
  8003           MOVE +0               TO CM-ADDL-CLP
  8004        END-IF
  8005        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8006        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8007           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8008        END-IF
  8009     END-IF
  8010     IF PB-COMPANY-ID = 'DCC'
  8011        MOVE +0                  TO WS-ADMIN-FEES
  8012                                    WS-CSO-ADMIN-FEE
  8013                                    WS-COMM-AND-MFEE
  8014                                    WS-1ST-YR-ALLOW
  8015        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8016           (SUB5 > +10)
  8017           MOVE +0 TO WS-WK-RATE
  8018           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8019              IF (AM-A-COM (SUB5) NUMERIC)
  8020                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8021                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8022              ELSE
  8023                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8024                 IF PB-ISSUE
  8025                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8026                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8027                 ELSE
  8028                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8029                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8030                 END-IF
  8031                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8032                 MOVE ZEROS             TO WS-SUB1
  8033                                           WS-COMMISSION
  8034                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8035                 MOVE '0530'               TO CTBL-SW
  8036                 MOVE ' '                  TO WS-CTBL-READ-SW
  8037                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8038                 IF FIRST-TIME-THROUGH
  8039                    MOVE 'AA'              TO CTBL-BEN-CODE
  8040                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8041                 END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 148
* EL050.cbl
  8042                 IF CTBL-TABLE-FOUND
  8043                    IF PB-ISSUE
  8044                       COMPUTE WS-COMM-CK-AMT =
  8045                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8046                    ELSE
  8047                       COMPUTE WS-COMM-CK-AMT =
  8048                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8049                    END-IF
  8050                    PERFORM 8800-GET-COMP-RATE
  8051                              THRU 8800-EXIT
  8052                 END-IF
  8053              END-IF
  8054              IF AM-COM-TYP (SUB5) = 'I'
  8055                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8056                   + (WS-WK-RATE * 1000)
  8057              END-IF
  8058              IF AM-COM-TYP (SUB5) = 'N'
  8059                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8060                   + (WS-WK-RATE * 1000)
  8061              END-IF
  8062              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8063                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8064                   + (WS-WK-RATE * 1000)
  8065              END-IF
  8066              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8067                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8068                   + (WS-WK-RATE * 1000)
  8069              END-IF
  8070           END-IF
  8071        END-PERFORM
  8072     END-IF
  8073     GO TO 0300-CONTINUE-EDIT.
  8074
  8075 0298-UNLOCK-RETURN.
  8076      PERFORM 9250-UNLOCK-RETURN
  8077      GO TO 9990-RETURN.
  8078
  8079 0299-CERT-NOT-FOUND.
  8080
  8081     MOVE '1'                     TO CERT-STATUS-SW.
  8082
  8083     IF PB-COMPANY-ID = 'UCL'
  8084         IF WS-ERROR = ER-2799
  8085             GO TO 3000-CONTINUE-EDIT.
  8086
  8087     IF NOT PB-CANCELLATION
  8088         GO TO 0300-CONTINUE-EDIT.
  8089
  8090     MOVE ER-2726                  TO  WS-ERROR.
  8091     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8092     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8093     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8094                                    PB-CI-LF-TERM
  8095                                    PB-C-LF-REM-TERM
  8096                                    PB-CI-AH-TERM
  8097                                    PB-C-AH-REM-TERM
  8098                                    PB-CI-LF-BENEFIT-CD
  8099                                    PB-CI-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 149
* EL050.cbl
  8100                                    PB-CI-LF-ALT-BENEFIT-AMT
  8101                                    PB-CI-LF-PREMIUM-AMT
  8102                                    PB-CI-LF-ALT-PREMIUM-AMT
  8103                                    PB-CI-AH-BENEFIT-CD
  8104                                    PB-CI-AH-BENEFIT-AMT
  8105                                    PB-CI-AH-PREMIUM-AMT
  8106                                    PB-CI-PAY-FREQUENCY
  8107                                    PB-CI-LOAN-APR
  8108                                    PB-CI-LOAN-TERM
  8109                                    PB-CI-LIFE-COMMISSION
  8110                                    PB-CI-AH-COMMISSION
  8111                                    PB-CI-CURR-SEQ
  8112                                    PB-CI-AH-CANCEL-AMT
  8113                                    PB-CI-LF-CANCEL-AMT
  8114                                    PB-CI-RATE-DEV-PCT-LF
  8115                                    PB-CI-RATE-DEV-PCT-AH
  8116                                    PB-CI-EXTENTION-DAYS
  8117                                    PB-CI-TERM-IN-DAYS
  8118                                    PB-CI-LIVES
  8119                                    PB-CI-LF-CRIT-PER
  8120                                    PB-CI-AH-CRIT-PER
  8121                                    PB-CI-ADDL-CLP
  8122                                    PB-CI-DDF-IU-RATE-UP.
  8123
  8124     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8125                                    PB-CI-AH-SETTLEMENT-DT
  8126                                    PB-CI-DEATH-DT
  8127                                    PB-CI-LF-PRIOR-CANCEL-DT
  8128                                    PB-CI-AH-PRIOR-CANCEL-DT
  8129                                    PB-CI-ENTRY-DT
  8130                                    PB-CI-LF-EXPIRE-DT
  8131                                    PB-CI-AH-EXPIRE-DT
  8132                                    PB-CI-LOAN-1ST-PMT-DT.
  8133
  8134     IF ACCOUNT-MAST-FOUND
  8135        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8136        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8137
  8138     GO TO 3000-CONTINUE-EDIT.
  8139
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 150
* EL050.cbl
  8141
  8142 0300-CONTINUE-EDIT.
  8143
  8144     IF PB-ISSUE
  8145        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8146            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8147
  8148     IF PB-ISSUE
  8149        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8150            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8151
  8152     IF PB-ISSUE
  8153       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8154          (AM-NO-AH-ONLY)
  8155           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8156               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8157                   MOVE ER-2679 TO WS-ERROR
  8158                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8159
  8160     IF PB-ISSUE
  8161        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8162        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8163        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8164     ELSE
  8165        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8166        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8167        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8168
  8169     MOVE 'N'                    TO PLAN-MASTER-SW
  8170                                    PLAN-MASTER-LIFE-SW
  8171                                    FORM-MASTER-SW
  8172                                    WS-APP-CERT-SW.
  8173
  8174     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8175                                    WS-PL-TOL-LF-REFUND
  8176                                    WS-PL-REF-OVS-AMT
  8177                                    WS-PL-TOL-LF-PREM-PCT
  8178                                    WS-PL-TOL-LF-REFUND-PCT
  8179                                    WS-PL-REF-OVS-PCT
  8180                                    WS-PL-TOL-LF-CLAIM.
  8181
  8182     IF PB-COMPANY-ID = 'NCL'
  8183       IF PB-ISSUE
  8184         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8185             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8186             IF FORM-MASTER-FOUND
  8187                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8188
  8189     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8190        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8191
  8192********************** MON CODE **********************
  8193     IF PB-COMPANY-ID = 'MON'
  8194     IF PB-ISSUE
  8195     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8196        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8197             PB-I-LOAN-APR = ZERO)
  8198               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 151
* EL050.cbl
  8199******************************************************
  8200
  8201     IF PB-COMPANY-ID = 'NCL'
  8202       IF PB-ISSUE
  8203           IF FORM-MASTER-FOUND
  8204             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8205                AM-DISMBR-COVERAGE
  8206                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8207                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8208                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8209                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8210                                           PB-I-LIFE-BENEFIT-CD.
  8211
  8212     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8213
  8214     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8215         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8216         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8217         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8218         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8219         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8220           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8221             GO TO 0301-LIFE-BENEFIT-SEARCH
  8222         ELSE
  8223             NEXT SENTENCE
  8224     ELSE
  8225         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8226
  8227     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8228     MOVE '4'                    TO CNTL-REC-TYPE.
  8229     MOVE +0                     TO CNTL-SEQ-NO.
  8230     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8231
  8232     MOVE '1' TO RC-SW-2.
  8233     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8234
  8235     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8236        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8237         GO TO 0305-BENEFIT-NOT-FOUND.
  8238
  8239     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8240
  8241 0301-LIFE-BENEFIT-SEARCH.
  8242
  8243     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8244
  8245     IF NO-BENEFIT-FOUND
  8246        GO TO 0305-BENEFIT-NOT-FOUND.
  8247
  8248     IF WS-BEN-CD = '99'
  8249        GO TO 0305-BENEFIT-NOT-FOUND.
  8250
  8251     IF PB-COMPANY-ID = 'NCL'
  8252         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8253             GO TO 0304-LIFE-BENEFIT-FOUND.
  8254
  8255     MOVE +1                     TO SUB5.
  8256     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 152
* EL050.cbl
  8257
  8258* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8259* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8260     IF PB-COMPANY-ID = 'DMD'
  8261         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8262
  8263 0302-EDIT-ACCT-LF-BENEFITS.
  8264
  8265     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8266        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8267           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8268                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8269           GO TO 03XX-GET-LIFE-ERPLAN.
  8270
  8271     IF SUB5 LESS THAN +20
  8272        ADD +1                   TO SUB5
  8273        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8274
  8275     MOVE +1                     TO SUB5.
  8276
  8277     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8278        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8279
  8280 0303-EDIT-DMD-EXTRA-BENEFITS.
  8281
  8282     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8283        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8284           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8285                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8286           GO TO 03XX-GET-LIFE-ERPLAN.
  8287
  8288     IF SUB5 LESS THAN +30
  8289        ADD +1                   TO SUB5
  8290        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8291
  8292     MOVE +1                     TO SUB5.
  8293
  8294 03XX-EDIT-FOR-NINETY-LF.
  8295
  8296***************************************************************
  8297*                                                             *
  8298*    NINETY BENEFIT PLAN TYPES:                               *
  8299*                                                             *
  8300*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8301*      92 = ALL GROUP REDUCING BENEFITS                       *
  8302*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8303*      94 = ALL GROUP LEVEL BENEFITS                          *
  8304*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8305*           BENEFIT CONTROLS.                                 *
  8306*      99 = ALL BENEFITS                                      *
  8307*                                                             *
  8308***************************************************************
  8309
  8310     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8311                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8312
  8313     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8314       AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 153
* EL050.cbl
  8315        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8316        GO TO 03XX-GET-LIFE-ERPLAN.
  8317
  8318     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8319       AND
  8320        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8321        IF CF-REDUCING (SUB3)
  8322           IF (PB-I-INDV-GRP-OVRD = 'I')
  8323              OR
  8324           ((AM-IG = '1') AND
  8325           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8326              OR
  8327           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8328           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8329           (AM-IG NOT = '2'))
  8330              GO TO 03XX-GET-LIFE-ERPLAN.
  8331
  8332     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8333       AND
  8334        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8335        IF CF-REDUCING (SUB3)
  8336           IF (PB-I-INDV-GRP-OVRD = 'G')
  8337              OR
  8338           ((AM-IG = '2') AND
  8339           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8340              OR
  8341           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8342           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8343           (AM-IG NOT = '1'))
  8344              GO TO 03XX-GET-LIFE-ERPLAN.
  8345
  8346     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8347       AND
  8348        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8349        IF CF-LEVEL    (SUB3)
  8350           IF (PB-I-INDV-GRP-OVRD = 'I')
  8351              OR
  8352           ((AM-IG = '1') AND
  8353           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8354              OR
  8355           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8356           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8357            (AM-IG NOT = '2'))
  8358              GO TO 03XX-GET-LIFE-ERPLAN.
  8359
  8360     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8361       AND
  8362        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8363        IF CF-LEVEL    (SUB3)
  8364           IF (PB-I-INDV-GRP-OVRD = 'G')
  8365              OR
  8366           ((AM-IG = '2') AND
  8367           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8368              OR
  8369           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8370           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8371           (AM-IG NOT = '1'))
  8372              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 154
* EL050.cbl
  8373
  8374     IF SUB5 LESS THAN +20
  8375        ADD +1                   TO SUB5
  8376        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8377
  8378     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8379
  8380     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8381        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8382
  8383     MOVE +1                     TO SUB5.
  8384
  8385 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8386
  8387     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8388                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8389
  8390     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8391       AND
  8392        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8393        GO TO 03XX-GET-LIFE-ERPLAN.
  8394
  8395     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8396       AND
  8397        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8398        IF CF-REDUCING (SUB3)
  8399           IF (PB-I-INDV-GRP-OVRD = 'I')
  8400              OR
  8401           ((AM-IG = '1') AND
  8402           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8403              OR
  8404           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8405           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8406           (AM-IG NOT = '2'))
  8407              GO TO 03XX-GET-LIFE-ERPLAN.
  8408
  8409     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8410       AND
  8411        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8412        IF CF-REDUCING (SUB3)
  8413           IF (PB-I-INDV-GRP-OVRD = 'G')
  8414              OR
  8415           ((AM-IG = '2') AND
  8416           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8417              OR
  8418           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8419           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8420           (AM-IG NOT = '1'))
  8421              GO TO 03XX-GET-LIFE-ERPLAN.
  8422
  8423     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8424       AND
  8425        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8426        IF CF-LEVEL    (SUB3)
  8427           IF (PB-I-INDV-GRP-OVRD = 'I')
  8428              OR
  8429           ((AM-IG = '1') AND
  8430           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 155
* EL050.cbl
  8431              OR
  8432           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8433           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8434            (AM-IG NOT = '2'))
  8435              GO TO 03XX-GET-LIFE-ERPLAN.
  8436
  8437     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8438       AND
  8439        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8440        IF CF-LEVEL    (SUB3)
  8441           IF (PB-I-INDV-GRP-OVRD = 'G')
  8442              OR
  8443           ((AM-IG = '2') AND
  8444           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8445              OR
  8446           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8447           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8448           (AM-IG NOT = '1'))
  8449              GO TO 03XX-GET-LIFE-ERPLAN.
  8450
  8451     IF SUB5 LESS THAN +30
  8452        ADD +1                   TO SUB5
  8453        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8454
  8455     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8456
  8457 03XX-EDIT-FOR-NINETY-LF-CONT.
  8458
  8459     MOVE +99                    TO SUB5.
  8460
  8461     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8462        IF PB-ISSUE
  8463           MOVE ER-1924          TO  WS-ERROR
  8464           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8465
  8466     GO TO 0304-LIFE-BENEFIT-FOUND.
  8467
  8468 03XX-GET-LIFE-ERPLAN.
  8469
  8470     IF WK-PLAN-ADDR EQUAL +0
  8471        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8472
  8473     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8474     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8475     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8476     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8477     MOVE 'Y'                    TO PLAN-MASTER-SW
  8478                                    PLAN-MASTER-LIFE-SW.
  8479     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8480
  8481 03XX-ERPLAN-LIFE-GETMAIN.
  8482
  8483     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8484     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8485
  8486 03XX-ERPLAN-LIFE-READ.
  8487
  8488     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 156
* EL050.cbl
  8489     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8490     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8491     MOVE PB-SV-STATE            TO PLAN-STATE.
  8492     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8493     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8494     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8495     MOVE WS-SAVE-BENEFIT-REVISION
  8496                                 TO PLAN-REVISION-NO.
  8497
  8498     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8499     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8500
  8501     IF PB-COMPANY-ID = 'NCL'
  8502       IF NOT LF-PLAN-MASTER-FOUND
  8503         IF NOT PB-POLICY-IS-DECLINED  AND
  8504            NOT PB-POLICY-IS-VOIDED
  8505             MOVE  ER-1921         TO  WS-ERROR
  8506             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8507             GO TO 0304-LIFE-BENEFIT-FOUND.
  8508
  8509     IF NOT LF-PLAN-MASTER-FOUND
  8510        GO TO 0304-LIFE-BENEFIT-FOUND.
  8511
  8512 XXXX-CHECK-LF-PLAN-KEY.
  8513
  8514     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8515        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8516        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8517        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8518        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8519        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8520        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8521        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8522        MOVE 'N'                 TO PLAN-MASTER-SW
  8523          GO TO 03XX-ERPLAN-LIFE-READ.
  8524
  8525     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8526
  8527     IF  PB-CANCELLATION
  8528         GO TO  0303-LF-ACCT-BEN-FOUND.
  8529
  8530     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8531        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8532           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8533           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8534              MOVE ER-2644             TO WS-ERROR
  8535              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8536           ELSE
  8537              NEXT SENTENCE
  8538        ELSE
  8539           IF PB-COMPANY-ID NOT = 'NCL'
  8540              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8541                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8542
  8543 0303-LF-ACCT-BEN-FOUND.
  8544
  8545     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8546
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 157
* EL050.cbl
  8547     IF PL-DEV-CODE NOT = SPACES
  8548        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8549
  8550     IF PL-DEV-PCT NUMERIC AND
  8551        PL-DEV-PCT NOT = ZEROS
  8552        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8553
  8554     IF PL-TOL-PREM-AMT GREATER THAN +0
  8555        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8556
  8557     IF PL-TOL-REF-AMT GREATER THAN +0
  8558        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8559
  8560     IF PL-TOL-PREM-PCT GREATER THAN +0
  8561        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8562
  8563     IF PL-TOL-REF-PCT GREATER THAN +0
  8564        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8565
  8566     IF PL-TOL-CLM-AMT GREATER THAN +0
  8567        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8568
  8569     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8570                          PL-OVER-SHORT-AMT > +0
  8571        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8572
  8573     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8574                          PL-OVER-SHORT-PCT > +0
  8575        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8576
  8577     IF PL-SALES-TAX NUMERIC AND
  8578                          PL-SALES-TAX > +0
  8579         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8580
  8581     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8582        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8583                                    WS-IG-OVRD-AM.
  8584
  8585 0304-LIFE-BENEFIT-FOUND.
  8586
  8587     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8588
  8589     IF PB-ISSUE
  8590        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8591     ELSE
  8592        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8593
  8594     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8595     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8596     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8597     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8598     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8599                                         WS-LF-REFUND-CALC.
  8600
  8601     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8602        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8603
  8604     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 158
* EL050.cbl
  8605        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8606     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8607
  8608     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8609     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8610     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8611     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8612     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8613     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8614
  8615     IF PB-COMPANY-ID = 'NCL'  AND
  8616        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8617         NEXT SENTENCE
  8618     ELSE
  8619         IF SUB5 NOT GREATER THAN +20
  8620            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8621               MOVE WS-SAVE-BENEFIT-REM-TERM
  8622                                      TO WS-AM-LF-BENE-REM-TERM
  8623                                         EC-BR-LF-REM-TERM-CALC.
  8624
  8625     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8626     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8627
  8628     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8629
  8630 0305-BENEFIT-NOT-FOUND.
  8631
  8632     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8633     MOVE ER-2604                TO WS-ERROR.
  8634     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8635
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 159
* EL050.cbl
  8637
  8638 0310-FIND-AH-BENEFIT-RECORD.
  8639
  8640     MOVE 'N'                    TO PLAN-MASTER-SW
  8641                                    PLAN-MASTER-AH-SW.
  8642
  8643     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8644                                    WS-PL-TOL-AH-REFUND
  8645                                    WS-AH-PL-REF-OVS-AMT
  8646                                    WS-PL-TOL-AH-PREM-PCT
  8647                                    WS-PL-TOL-AH-REFUND-PCT
  8648                                    WS-AH-PL-REF-OVS-PCT
  8649                                    WS-PL-TOL-AH-CLAIM.
  8650     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8651
  8652
  8653     if pb-issue
  8654        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8655           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8656        end-if
  8657        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8658           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8659           GO TO 0399-BENEFIT-NOT-FOUND
  8660        end-if
  8661     end-if
  8662
  8663     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8664        GO TO 0400-FIND-CARRIER.
  8665
  8666     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8667
  8668     IF WK-AH-BEN-ADDR NOT = ZEROS
  8669         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8670         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8671         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8672         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8673           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8674             GO TO 0311-AH-BENEFIT-SEARCH
  8675         ELSE
  8676             NEXT SENTENCE
  8677     ELSE
  8678         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8679
  8680     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8681     MOVE '5'                    TO CNTL-REC-TYPE.
  8682     MOVE +0                     TO CNTL-SEQ-NO.
  8683     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8684
  8685     MOVE '2' TO RC-SW-2.
  8686     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8687
  8688     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8689        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8690          GO TO 0399-BENEFIT-NOT-FOUND.
  8691
  8692     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8693
  8694 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 160
* EL050.cbl
  8695
  8696     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8697
  8698     IF NO-BENEFIT-FOUND
  8699         GO TO 0399-BENEFIT-NOT-FOUND.
  8700
  8701     IF WS-BEN-CD = '99'
  8702        GO TO 0399-BENEFIT-NOT-FOUND.
  8703
  8704     IF PB-COMPANY-ID  =  'NCL'
  8705         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8706             GO TO 0314-A-H-BENEFIT-FOUND.
  8707
  8708     MOVE +1                     TO SUB5.
  8709     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8710
  8711* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8712* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8713     IF PB-COMPANY-ID = 'DMD'
  8714         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8715
  8716 0312-EDIT-ACCT-AH-BENEFITS.
  8717
  8718     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8719        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8720           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8721                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8722           GO TO 03XX-GET-AH-ERPLAN.
  8723
  8724     IF SUB5 LESS THAN +20
  8725        ADD +1                   TO SUB5
  8726        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8727
  8728     MOVE +1                     TO SUB5.
  8729
  8730     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8731        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8732
  8733 0313-EDIT-DMD-EXTRA-BENEFITS.
  8734
  8735     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8736        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8737           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8738                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8739           GO TO 03XX-GET-AH-ERPLAN.
  8740
  8741     IF SUB5 LESS THAN +30
  8742        ADD +1                   TO SUB5
  8743        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8744
  8745     MOVE +1                     TO SUB5.
  8746
  8747 03XX-EDIT-FOR-NINETY-AH.
  8748
  8749***************************************************************
  8750*                                                             *
  8751*    NINETY BENEFIT PLAN TYPES:                               *
  8752*                                                             *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 161
* EL050.cbl
  8753*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8754*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8755*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8756*           BENEFIT CONTROLS.                                 *
  8757*      99 = ALL BENEFITS.                                     *
  8758*                                                             *
  8759***************************************************************
  8760
  8761     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8762                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8763
  8764     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8765       AND
  8766        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8767        GO TO 03XX-GET-AH-ERPLAN.
  8768
  8769     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8770       AND
  8771        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8772           IF (PB-I-INDV-GRP-OVRD = 'I')
  8773              OR
  8774           ((AM-IG = '1') AND
  8775           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8776              OR
  8777           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8778           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8779           (AM-IG NOT = '2'))
  8780              GO TO 03XX-GET-AH-ERPLAN.
  8781
  8782     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8783       AND
  8784        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8785           IF (PB-I-INDV-GRP-OVRD = 'G')
  8786              OR
  8787           ((AM-IG = '2') AND
  8788           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8789              OR
  8790           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8791           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8792           (AM-IG NOT = '1'))
  8793              GO TO 03XX-GET-AH-ERPLAN.
  8794
  8795     IF SUB5 LESS THAN +20
  8796        ADD +1                   TO SUB5
  8797        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8798
  8799     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8800        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8801
  8802     MOVE +1                    TO SUB5.
  8803
  8804 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8805
  8806     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8807                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8808
  8809     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8810       AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 162
* EL050.cbl
  8811        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8812        GO TO 03XX-GET-AH-ERPLAN.
  8813
  8814     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8815       AND
  8816        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8817           IF (PB-I-INDV-GRP-OVRD = 'I')
  8818              OR
  8819           ((AM-IG = '1') AND
  8820           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8821              OR
  8822           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8823           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8824           (AM-IG NOT = '2'))
  8825              GO TO 03XX-GET-AH-ERPLAN.
  8826
  8827     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8828       AND
  8829        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8830           IF (PB-I-INDV-GRP-OVRD = 'G')
  8831              OR
  8832           ((AM-IG = '2') AND
  8833           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8834              OR
  8835           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8836           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8837           (AM-IG NOT = '1'))
  8838              GO TO 03XX-GET-AH-ERPLAN.
  8839
  8840     IF SUB5 LESS THAN +30
  8841        ADD +1                   TO SUB5
  8842        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8843
  8844 03XX-EDIT-FOR-NINETY-AH-CONT.
  8845
  8846     MOVE +99                    TO SUB5.
  8847
  8848     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8849
  8850     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8851        IF PB-ISSUE
  8852           MOVE ER-1925          TO  WS-ERROR
  8853           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8854
  8855     GO TO 0314-A-H-BENEFIT-FOUND.
  8856
  8857 03XX-GET-AH-ERPLAN.
  8858
  8859     IF WK-PLAN-ADDR EQUAL +0
  8860         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8861
  8862     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8863     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8864     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8865     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8866     MOVE 'Y'                    TO PLAN-MASTER-SW
  8867                                    PLAN-MASTER-AH-SW.
  8868*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 163
* EL050.cbl
  8869     GO TO 03XX-ERPLAN-AH-READ.
  8870
  8871 03XX-ERPLAN-AH-GETMAIN.
  8872
  8873     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8874     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8875
  8876 03XX-ERPLAN-AH-READ.
  8877
  8878     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8879     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8880     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8881     MOVE PB-SV-STATE            TO PLAN-STATE.
  8882     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8883     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8884     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8885     MOVE WS-SAVE-BENEFIT-REVISION
  8886                                 TO PLAN-REVISION-NO.
  8887
  8888     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8889     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8890
  8891     IF PB-COMPANY-ID = 'NCL'
  8892       IF NOT AH-PLAN-MASTER-FOUND
  8893         IF NOT PB-POLICY-IS-DECLINED  AND
  8894            NOT PB-POLICY-IS-VOIDED
  8895             MOVE  ER-1922         TO  WS-ERROR
  8896             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8897             GO TO 0314-A-H-BENEFIT-FOUND.
  8898
  8899     IF NOT AH-PLAN-MASTER-FOUND
  8900        GO TO 0314-A-H-BENEFIT-FOUND.
  8901
  8902 XXXX-CHECK-AH-PLAN-KEY.
  8903
  8904     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8905        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8906        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8907        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8908        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8909        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8910        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8911        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8912        MOVE 'N'                 TO PLAN-MASTER-SW
  8913          GO TO 03XX-ERPLAN-AH-READ.
  8914
  8915     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8916
  8917     IF  PB-CANCELLATION
  8918         GO TO  0313-AH-ACCT-BEN-FOUND.
  8919
  8920     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8921       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8922          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8923          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8924             MOVE ER-2644             TO WS-ERROR
  8925             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8926          ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 164
* EL050.cbl
  8927             NEXT SENTENCE
  8928       ELSE
  8929          IF PB-COMPANY-ID NOT = 'NCL'
  8930             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8931                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8932
  8933 0313-AH-ACCT-BEN-FOUND.
  8934
  8935     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8936
  8937     IF PL-DEV-CODE NOT = SPACES
  8938        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8939
  8940     IF PL-DEV-PCT NUMERIC AND
  8941        PL-DEV-PCT NOT = ZEROS
  8942        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8943
  8944     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8945        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8946
  8947     IF PL-TOL-REF-AMT NOT EQUAL +0
  8948        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8949
  8950     IF PL-TOL-PREM-PCT GREATER THAN +0
  8951        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8952
  8953     IF PL-TOL-REF-PCT GREATER THAN +0
  8954        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8955
  8956     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8957        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8958
  8959     IF PL-OVER-SHORT-AMT NUMERIC AND
  8960                          PL-OVER-SHORT-AMT > +0
  8961        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8962
  8963     IF PL-OVER-SHORT-PCT NUMERIC AND
  8964                          PL-OVER-SHORT-PCT > +0
  8965        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8966
  8967     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8968        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8969        IF WS-IG-OVRD-AM EQUAL SPACES
  8970            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8971
  8972 0314-A-H-BENEFIT-FOUND.
  8973
  8974     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8975
  8976     IF PB-ISSUE
  8977        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8978       ELSE
  8979        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8980
  8981     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8982     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8983     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8984     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 165
* EL050.cbl
  8985                                         WS-AH-REFUND-CALC.
  8986
  8987     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8988        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  8989
  8990     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8991        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  8992     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  8993
  8994     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  8995     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  8996     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  8997     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  8998     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  8999     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9000
  9001     IF PB-COMPANY-ID = 'NCL'  AND
  9002        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9003         NEXT SENTENCE
  9004     ELSE
  9005         IF SUB5 NOT GREATER THAN +20
  9006            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9007                MOVE WS-SAVE-BENEFIT-REM-TERM
  9008                                      TO WS-AM-AH-BENE-REM-TERM
  9009                                         EC-BR-AH-REM-TERM-CALC.
  9010
  9011     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9012     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9013
  9014     GO TO 0400-FIND-CARRIER.
  9015
  9016 0399-BENEFIT-NOT-FOUND.
  9017
  9018     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9019     MOVE ER-2605                TO WS-ERROR.
  9020     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9021
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 166
* EL050.cbl
  9023
  9024 0400-FIND-CARRIER.
  9025
  9026     MOVE PB-SV-CARRIER          TO WS-CARR.
  9027
  9028     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9029     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9030     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9031     MOVE '6'                    TO CNTL-REC-TYPE.
  9032
  9033*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9034     MOVE SPACE                  TO WS-DMD-RATING-SW
  9035                                    EC-BR-DMD-RATING-SW.
  9036
  9037     MOVE '2'                    TO RC-SW-1.
  9038     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9039
  9040     IF NOT CF-CARRIER-MASTER
  9041        GO TO 0400-CARRIER-NOT-FOUND.
  9042
  9043 0400-BUILD-CARR-TOL.
  9044
  9045     IF CF-CR-TOL-PREM NUMERIC AND
  9046        CF-CR-TOL-PREM GREATER THAN +0
  9047        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9048                                    WS-TOL-AH-PREM.
  9049
  9050     IF CF-CR-TOL-REFUND NUMERIC AND
  9051        CF-CR-TOL-REFUND GREATER THAN +0
  9052        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9053                                    WS-TOL-AH-REFUND.
  9054
  9055     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9056        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9057        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9058                                    WS-AH-REFUND-OVS-AMT.
  9059
  9060     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9061        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9062        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9063                                    WS-AH-REFUND-OVS-PCT.
  9064
  9065     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9066        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9067        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9068                                    WS-TOL-AH-PREM-PCT.
  9069
  9070     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9071        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9072        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9073                                     WS-TOL-AH-REFUND-PCT.
  9074
  9075     IF CF-COMPANY-ID EQUAL 'DMD'
  9076         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9077                                    EC-BR-DMD-RATING-SW.
  9078
  9079     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9080     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 167
* EL050.cbl
  9081        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9082     END-IF
  9083     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9084        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9085     END-IF
  9086     IF WS-TOL-CLP-PCT = ZEROS
  9087        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9088     END-IF
  9089
  9090     IF WS-SPP-LEASE-COMM = ZEROS
  9091        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9092     END-IF
  9093     GO TO 0400-FIND-ERPDEF.
  9094
  9095 0400-CARRIER-NOT-FOUND.
  9096
  9097     MOVE ER-2602                TO WS-ERROR.
  9098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9099
  9100 0400-FIND-ERPDEF.
  9101     IF PB-COMPANY-ID = 'DCC'
  9102        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9103        CONTINUE
  9104     ELSE
  9105        GO TO 0400-FIND-ERCOMP
  9106     END-IF
  9107     MOVE ' '                    TO PDEF-MASTER-SW
  9108     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9109     MOVE PB-STATE               TO ERPDEF-STATE
  9110     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9111     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9112     IF PB-ISSUE
  9113        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9114     ELSE
  9115        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9116     END-IF
  9117     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9118     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9119     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9120     IF PDEF-MASTER-FOUND
  9121        MOVE 'N'                 TO PDEF-MASTER-SW
  9122        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9123        IF PDEF-MASTER-FOUND
  9124           IF (ERPDEF-KEY-SAVE (1:16) =
  9125                        PD-CONTROL-PRIMARY (1:16))
  9126              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9127              CONTINUE
  9128           ELSE
  9129              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9130              IF (ERPDEF-KEY-SAVE (1:16) =
  9131                        PD-CONTROL-PRIMARY (1:16))
  9132                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9133                 CONTINUE
  9134              ELSE
  9135                 MOVE 'N'        TO PDEF-MASTER-SW
  9136              END-IF
  9137           END-IF
  9138        END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 168
* EL050.cbl
  9139        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9140     END-IF
  9141     IF PDEF-MASTER-FOUND
  9142        IF PD-TRUNCATED = 'Y'
  9143           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9144        END-IF
  9145     END-IF
  9146     .
  9147 0400-FIND-ERCOMP.
  9148     IF PB-COMPANY-ID = 'DCC'
  9149        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9150           (WS-SUB1 > +10)
  9151           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9152                 OR 'A' OR 'N'
  9153              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9154              MOVE PB-CARRIER    TO COMP-CARRIER
  9155              MOVE PB-GROUPING   TO COMP-GROUPING
  9156              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9157              MOVE AM-AGT (WS-SUB1)
  9158                                 TO COMP-FIN-RESP
  9159              MOVE 'G'           TO COMP-TYPE
  9160              PERFORM 8582-READ-COMPENSATION-MASTER
  9161                                 THRU 8582-EXIT
  9162              IF COMP-MASTER-FOUND
  9163                 IF CO-GA-INACTIVE
  9164                    MOVE ER-2763 TO WS-ERROR
  9165                    PERFORM 9900-ERROR-FORMAT
  9166                                 THRU 9900-EXIT
  9167                    MOVE +11     TO WS-SUB1
  9168                 END-IF
  9169                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9170                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9171                    MOVE ER-2788 TO WS-ERROR
  9172                    PERFORM 9900-ERROR-FORMAT
  9173                                 THRU 9900-EXIT
  9174                    MOVE +11     TO WS-SUB1
  9175                 END-IF
  9176              END-IF
  9177           END-IF
  9178        END-PERFORM
  9179     END-IF
  9180     IF (PB-COMPANY-ID = 'DCC')
  9181               AND
  9182        ((WS-LF-BEN-CATEGORY = 'D')
  9183        OR (WS-AH-BEN-CATEGORY = 'D')
  9184        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9185        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9186           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9187                                    WS-CLP-STATE
  9188        ELSE
  9189           MOVE SPACES           TO PB-I-CLP-STATE
  9190                                    WS-CLP-STATE
  9191        END-IF
  9192     END-IF
  9193
  9194     IF (PB-COMPANY-ID = 'DCC')
  9195        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9196        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 169
* EL050.cbl
  9197        CONTINUE
  9198     ELSE
  9199        GO TO 0400-FIND-STATE-RECORD
  9200     END-IF
  9201     MOVE SPACES                 TO WS-CLP-STATE
  9202     MOVE +0                     TO WS-BANK-FEE
  9203                                    WS-BANK-LFEE
  9204                                    WS-BANK-NOCHRGB
  9205
  9206     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9207     IF (PB-ISSUE)
  9208        AND (PB-I-BANK-NUMBER NOT =
  9209            SPACES AND ZEROS AND LOW-VALUES)
  9210        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9211     ELSE
  9212        IF (PB-CANCELLATION)
  9213           AND (PB-CI-BANK-NUMBER NOT =
  9214                SPACES AND ZEROS AND LOW-VALUES)
  9215           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9216        END-IF
  9217     END-IF
  9218     IF COMP-FIN-RESP NOT = LOW-VALUES
  9219        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9220        MOVE PB-CARRIER          TO COMP-CARRIER
  9221        MOVE PB-GROUPING         TO COMP-GROUPING
  9222        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9223        MOVE 'B'                 TO COMP-TYPE
  9224        PERFORM 8582-READ-COMPENSATION-MASTER
  9225                                 THRU 8582-EXIT
  9226        IF COMP-MASTER-FOUND
  9227           IF CO-MAX-BANK-FEE NOT NUMERIC
  9228              MOVE +0            TO CO-MAX-BANK-FEE
  9229           END-IF
  9230           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9231              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9232           END-IF
  9233           IF CO-GA-INACTIVE
  9234              MOVE ER-2763       TO WS-ERROR
  9235              PERFORM 9900-ERROR-FORMAT
  9236                                 THRU 9900-EXIT
  9237           END-IF
  9238           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9239              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9240              MOVE ER-2788 TO WS-ERROR
  9241              PERFORM 9900-ERROR-FORMAT
  9242                                 THRU 9900-EXIT
  9243              MOVE +11     TO WS-SUB1
  9244           END-IF
  9245           IF WS-AH-BEN-CATEGORY = 'G'
  9246              MOVE CO-MAX-BANK-FEE
  9247                                 TO WS-BANK-FEE
  9248                                    PB-I-BANK-FEE
  9249           ELSE
  9250              MOVE CO-MAX-BANK-FEE-LEASE
  9251                                 TO WS-BANK-LFEE
  9252                                    PB-I-BANK-FEE
  9253           END-IF
  9254           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 170
* EL050.cbl
  9255              AND (WS-AH-REFUND-CALC = 'G'))
  9256                        OR
  9257              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9258              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9259              CONTINUE
  9260           ELSE
  9261              MOVE ER-2789 TO WS-ERROR
  9262              PERFORM 9900-ERROR-FORMAT
  9263                                 THRU 9900-EXIT
  9264           END-IF
  9265           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9266                                    PB-I-CLP-STATE
  9267           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9268           MOVE CO-CARRIER       TO BXRF-CARRIER
  9269           MOVE CO-GROUPING      TO BXRF-GROUPING
  9270           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9271           MOVE BXRF-MAX-REC-LENGTH
  9272                                 TO BXRF-REC-LENGTH
  9273           PERFORM 8584-READ-BANK-CROSS-REF
  9274                                 THRU 8584-EXIT
  9275           IF BXRF-MASTER-FOUND
  9276              MOVE ' '           TO BANK-ACCT-SW
  9277              MOVE BK-BANK-POINTER-CNT
  9278                                 TO BK-BANK-POINTER-CNT
  9279              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9280                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9281                 OR (BANK-ACCT-FOUND)
  9282                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9283                    AND (BK-AM-EXP-DT (WS-SUB1)
  9284                                 > PB-CERT-EFF-DT)
  9285                    AND (BK-AM-EFF-DT (WS-SUB1)
  9286                                 NOT > PB-CERT-EFF-DT)
  9287                    SET BANK-ACCT-FOUND TO TRUE
  9288                 END-IF
  9289              END-PERFORM
  9290              IF NOT BANK-ACCT-FOUND
  9291                 MOVE ZEROS      TO WS-BANK-FEE
  9292                                    WS-BANK-LFEE
  9293                 MOVE ER-2869    TO WS-ERROR
  9294                 PERFORM 9900-ERROR-FORMAT
  9295                                 THRU 9900-EXIT
  9296              ELSE
  9297                 PERFORM 5000-PROCESS-REPS
  9298                                 THRU 5000-EXIT
  9299                 IF AGENT-MASTER-FOUND
  9300                    MOVE +0      TO WS-BANK-FEE
  9301                                    WS-BANK-LFEE
  9302*                   MOVE AG-SPP-FEES (1)
  9303*                                TO PB-I-BANK-FEE
  9304*                                   WS-BANK-FEE
  9305                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9306                       (WS-SUB1 > +10)
  9307                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9308                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9309                       END-IF
  9310                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9311                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9312                       END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 171
* EL050.cbl
  9313                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9314                          AG-SPP-FEES (WS-SUB1)
  9315                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9316                          AG-SPP-LFEES (WS-SUB1)
  9317                    END-PERFORM
  9318                    IF WS-AH-BEN-CATEGORY = 'G'
  9319                       MOVE WS-BANK-FEE
  9320                                 TO PB-I-BANK-FEE
  9321                    ELSE
  9322                       MOVE WS-BANK-LFEE
  9323                                 TO PB-I-BANK-FEE
  9324                    END-IF
  9325                 END-IF
  9326              END-IF
  9327           END-IF
  9328        ELSE
  9329           MOVE ER-2879          TO WS-ERROR
  9330           PERFORM 9900-ERROR-FORMAT
  9331                                 THRU 9900-EXIT
  9332        END-IF
  9333     ELSE
  9334        MOVE ER-2879             TO WS-ERROR
  9335        PERFORM 9900-ERROR-FORMAT
  9336                                 THRU 9900-EXIT
  9337     END-IF
  9338     IF WS-AH-BEN-CATEGORY = 'G'
  9339        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9340        + WS-BANK-FEE
  9341     ELSE
  9342        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9343        + WS-BANK-LFEE
  9344     END-IF
  9345     .
  9346 0400-FIND-STATE-RECORD.
  9347
  9348     IF WK-STATE-ADDR NOT = ZEROS
  9349         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9350         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9351         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9352         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9353         IF PB-SV-STATE = CF-STATE-CODE
  9354             GO TO 0405-CONTINUE-EDIT
  9355         ELSE
  9356             NEXT SENTENCE
  9357     ELSE
  9358         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9359
  9360     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9361     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9362     MOVE '3'                    TO CNTL-REC-TYPE.
  9363     MOVE +0                     TO CNTL-SEQ-NO.
  9364
  9365     MOVE '3'                    TO RC-SW-2.
  9366     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9367
  9368     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9369        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9370        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 172
* EL050.cbl
  9371        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9372                                    WS-TOL-AH-CLAIM
  9373                                    WS-MINIMUM-REFUND
  9374                                    WS-TOL-LF-PREM
  9375                                    WS-TOL-AH-PREM
  9376                                    WS-TOL-LF-REFUND
  9377                                    WS-TOL-AH-REFUND
  9378                                    EC-ST-TOL-PREM-PCT
  9379                                    WS-TOL-LF-PREM-PCT
  9380                                    WS-TOL-AH-PREM-PCT
  9381                                    EC-ST-TOL-REFUND-PCT
  9382                                    WS-TOL-LF-REFUND-PCT
  9383                                    WS-TOL-AH-REFUND-PCT
  9384                                    EC-ST-TOL-PREM
  9385                                    EC-ST-TOL-REFUND
  9386                                    EC-ST-FST-PMT-DAYS-MAX
  9387                                    WS-FREE-LOOK-PERIOD
  9388                                    WS-ST-LF-PREM-TAX
  9389                                    WS-ST-AH-PREM-TAX-I
  9390                                    WS-ST-AH-PREM-TAX-G
  9391                                    WS-BANK-FEE
  9392                                    WS-BANK-LFEE
  9393                                    WS-TOL-CLP-PCT
  9394                                    WS-SPP-LEASE-COMM
  9395        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9396                                    EC-ST-FST-PMT-DAYS-CHG
  9397                                    WS-LF-REM-TERM-CALC
  9398                                    WS-LF-REFUND-CALC
  9399                                    EC-ST-LF-REM-TERM-CALC
  9400                                    EC-ST-LF-REFUND-CALC
  9401                                    WS-AH-REM-TERM-CALC
  9402                                    WS-AH-REFUND-CALC
  9403                                    WS-LF-BEN-CATEGORY
  9404                                    WS-AH-BEN-CATEGORY
  9405                                    WS-CLP-STATE
  9406                                    WS-ST-REFUND-CLAIM-FLAG
  9407                                    EC-ST-AH-REM-TERM-CALC
  9408                                    EC-ST-AH-REFUND-CALC
  9409          GO TO 0499-STATE-NOT-FOUND.
  9410
  9411     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9412
  9413 0405-CONTINUE-EDIT.
  9414
  9415     IF PB-CERT-PRIME NOT NUMERIC
  9416        MOVE ER-2722             TO WS-ERROR
  9417        PERFORM 9900-ERROR-FORMAT
  9418                                 THRU 9900-EXIT
  9419     END-IF
  9420*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9421*       MOVE +0                  TO SUB3
  9422*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9423*       IF SUB3 > +0
  9424*          MOVE ER-2722          TO WS-ERROR
  9425*          PERFORM 9900-ERROR-FORMAT
  9426*                                THRU 9900-EXIT
  9427*       END-IF
  9428*    END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 173
* EL050.cbl
  9429*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9430*       IF PB-CERT-PRIME NOT NUMERIC
  9431*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9432*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9433*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9434*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9435*
  9436*          MOVE ER-2722          TO WS-ERROR
  9437*          PERFORM 9900-ERROR-FORMAT
  9438*                                THRU 9900-EXIT
  9439*       END-IF
  9440*    END-IF
  9441
  9442     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9443
  9444     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9445        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9446                                    WS-TOL-AH-CLAIM.
  9447
  9448     IF CF-ST-REFUND-MIN NOT NUMERIC
  9449        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9450
  9451     IF CF-ST-REFUND-MIN NOT = ZEROS
  9452        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9453
  9454     IF CF-ST-TOL-PREM  NOT = ZEROS
  9455        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9456                                    WS-TOL-AH-PREM
  9457        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9458
  9459     IF CF-ST-TOL-REFUND NOT = ZEROS
  9460        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9461                                    WS-TOL-AH-REFUND
  9462        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9463
  9464     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9465        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9466        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9467                                    WS-AH-REFUND-OVS-AMT
  9468                                    EC-ST-OVR-SHT-AMT.
  9469
  9470     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9471        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9472        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9473                                    WS-TOL-LF-PREM-PCT
  9474                                    WS-TOL-AH-PREM-PCT.
  9475
  9476     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9477        CF-ST-TOL-REF-PCT GREATER THAN +0
  9478        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9479                                    WS-TOL-LF-REFUND-PCT
  9480                                    WS-TOL-AH-REFUND-PCT.
  9481
  9482     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9483        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9484        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9485                                    WS-AH-REFUND-OVS-PCT
  9486                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 174
* EL050.cbl
  9487
  9488     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9489     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9490
  9491     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9492          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9493
  9494     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9495     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9496     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9497
  9498     IF CF-ST-LF-PREM-TAX NUMERIC
  9499        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9500     END-IF
  9501     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9502        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9503     END-IF
  9504     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9505        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9506     END-IF
  9507
  9508     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9509         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9510     END-IF.
  9511
  9512     IF WS-LF-BENEFIT-CD = ZEROS
  9513        GO TO 0410-CHECK-AH.
  9514
  9515     IF CF-ST-RT-CALC NOT = SPACES
  9516        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9517                                    EC-ST-LF-REM-TERM-CALC
  9518     END-IF
  9519
  9520     IF WS-LF-COVERAGE-TYPE = 'R'
  9521        IF WS-LF-EARNINGS-CALC = '5'
  9522           IF CF-ST-RF-LN-CALC > '0'
  9523              MOVE CF-ST-RF-LN-CALC
  9524                                 TO WS-LF-REFUND-CALC
  9525                                    EC-ST-LF-REFUND-CALC
  9526           END-IF
  9527        ELSE
  9528           IF CF-ST-RF-LR-CALC > '0'
  9529              MOVE CF-ST-RF-LR-CALC
  9530                                 TO WS-LF-REFUND-CALC
  9531                                    EC-ST-LF-REFUND-CALC
  9532           END-IF
  9533        END-IF
  9534     ELSE
  9535        IF CF-ST-RF-LL-CALC > '0'
  9536           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9537                                    EC-ST-LF-REFUND-CALC
  9538        END-IF
  9539     END-IF
  9540
  9541     IF CF-ST-RT-CALC NOT = SPACES
  9542        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9543                                    EC-ST-LF-REM-TERM-CALC
  9544     END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 175
* EL050.cbl
  9545
  9546     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9547     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9548
  9549     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9550
  9551     IF NO-BENEFIT-FOUND
  9552        GO TO 0410-CHECK-AH.
  9553
  9554     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9555        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9556                                 TO EC-ST-LF-REM-TERM-CALC
  9557                                    WS-LF-REM-TERM-CALC
  9558     END-IF
  9559
  9560     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9561        MOVE CF-ST-REFUND-CALC (SUB3)
  9562                                 TO WS-LF-REFUND-CALC
  9563                                    EC-ST-LF-REFUND-CALC
  9564     END-IF
  9565*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9566
  9567     .
  9568 0410-CHECK-AH.
  9569
  9570     IF WS-AH-BENEFIT-CD = ZEROS
  9571        GO TO 0500-SET-ACCOUNT.
  9572
  9573     IF CF-ST-RT-CALC NOT = SPACES
  9574        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9575                                    EC-ST-AH-REM-TERM-CALC
  9576     END-IF
  9577
  9578     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9579        IF CF-ST-RF-CP-CALC > '0'
  9580           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9581                                    EC-ST-AH-REFUND-CALC
  9582        END-IF
  9583     ELSE
  9584        IF CF-ST-RF-AH-CALC > '0'
  9585           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9586                                    EC-ST-AH-REFUND-CALC
  9587        END-IF
  9588     END-IF
  9589     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9590     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9591
  9592     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9593
  9594     IF NO-BENEFIT-FOUND
  9595        GO TO 0500-SET-ACCOUNT.
  9596
  9597     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9598        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9599                                 TO WS-AH-REM-TERM-CALC
  9600                                    EC-ST-AH-REM-TERM-CALC
  9601     END-IF
  9602
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 176
* EL050.cbl
  9603     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9604        MOVE CF-ST-REFUND-CALC (SUB3)
  9605                                 TO WS-AH-REFUND-CALC
  9606                                    EC-ST-AH-REFUND-CALC
  9607     END-IF
  9608
  9609*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9610
  9611     GO TO 0500-SET-ACCOUNT.
  9612
  9613 0499-STATE-NOT-FOUND.
  9614
  9615     MOVE ER-2603                TO WS-ERROR.
  9616     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9617
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 177
* EL050.cbl
  9619
  9620 0500-SET-ACCOUNT.
  9621*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9622     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9623        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9624        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9625        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9626        MOVE '3'                 TO CNTL-REC-TYPE
  9627        MOVE +0                  TO CNTL-SEQ-NO
  9628
  9629        MOVE '3'                 TO RC-SW-2
  9630        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9631
  9632        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9633           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9634           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9635           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9636                                    WS-ST-AH-PREM-TAX-I
  9637                                    WS-ST-AH-PREM-TAX-G
  9638        ELSE
  9639           IF CF-ST-LF-PREM-TAX NUMERIC
  9640              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9641           END-IF
  9642           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9643              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9644           END-IF
  9645           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9646              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9647           END-IF
  9648        END-IF
  9649        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9650     END-IF
  9651*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9652*  FOR DCC ONLY
  9653     IF PB-COMPANY-ID = 'DCC'
  9654
  9655     MOVE ' '                    TO STAT-MASTER-SW
  9656     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9657     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9658     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9659     MOVE PB-STATE               TO ELSTAT-STATE
  9660     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9661        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9662     END-IF
  9663
  9664     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9665     SET BIN-TO-GREG             TO TRUE
  9666     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9667     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9668     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9669
  9670     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9671     IF STAT-MASTER-FOUND
  9672        MOVE 'N'                 TO STAT-MASTER-SW
  9673        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9674        IF STAT-MASTER-FOUND
  9675           IF (ELSTAT-KEY-SAVE (1:12) =
  9676                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 178
* EL050.cbl
  9677              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9678                 MOVE 'F'        TO STAT-MASTER-SW
  9679              ELSE
  9680                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9681                 IF (STAT-MASTER-FOUND)
  9682                    AND (ELSTAT-KEY-SAVE (1:12) =
  9683                        SF-CONTROL-PRIMARY (1:12))
  9684                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9685                    MOVE 'F'     TO STAT-MASTER-SW
  9686                 END-IF
  9687              END-IF
  9688           END-IF
  9689        END-IF
  9690     END-IF
  9691
  9692     IF STAT-MASTER-SW = 'F'
  9693        IF SF-ST-LF-PREM-TAX NUMERIC
  9694           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9695        END-IF
  9696        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9697           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9698        END-IF
  9699        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9700           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9701        END-IF
  9702     END-IF
  9703
  9704     END-IF
  9705     IF (PB-COMPANY-ID = 'DCC')
  9706        AND (PB-ISSUE)
  9707        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9708        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9709        AND (AM-GPCD = 06)
  9710        MOVE 'Y'                 TO WS-GOOD-HIN
  9711        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9712           MOVE PB-I-VIN         TO WS-WORK-VIN
  9713           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9714              (V1 > 16)
  9715              IF WS-WORK-VIN (V1:1) NUMERIC
  9716                 MOVE WS-WORK-VIN-N (V1)
  9717                                 TO WS-ROW-B-VAL (V1)
  9718              ELSE
  9719                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9720                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9721                    OR (V2 > 26)
  9722                 END-PERFORM
  9723                 IF V2 < 27
  9724                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9725                 ELSE
  9726                    MOVE 'N'     TO WS-GOOD-HIN
  9727                 END-IF
  9728              END-IF
  9729              COMPUTE WS-ROW-D-VAL (V1) =
  9730                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9731              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9732                 WS-ROW-D-VAL (V1)
  9733           END-PERFORM
  9734           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 179
* EL050.cbl
  9735           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9736             REMAINDER WS-VIN-REMAINDER
  9737           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9738              CONTINUE
  9739           ELSE
  9740              MOVE 'N'           TO WS-GOOD-HIN
  9741           END-IF
  9742        ELSE
  9743           MOVE 'N'              TO WS-GOOD-HIN
  9744        END-IF
  9745        IF WS-GOOD-HIN NOT = 'Y'
  9746           MOVE ER-3826           TO WS-ERROR
  9747           PERFORM 9900-ERROR-FORMAT
  9748                                 THRU 9900-EXIT
  9749        END-IF
  9750     END-IF
  9751     IF (PB-COMPANY-ID = 'DCC')
  9752        AND (PB-ISSUE)
  9753        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9754        AND (AM-GPCD NOT = 06)
  9755        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9756          MOVE PB-I-VIN          TO WS-WORK-VIN
  9757          MOVE +8                TO V2
  9758          MOVE ZEROS             TO WS-VIN-TOTAL
  9759          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9760           (V1 > 17)
  9761             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9762                MOVE ER-3825     TO WS-ERROR
  9763                PERFORM 9900-ERROR-FORMAT
  9764                                 THRU 9900-EXIT
  9765             ELSE
  9766                IF V1 = 8
  9767                   MOVE 10       TO V2
  9768                END-IF
  9769                IF V1 = 9
  9770                   MOVE 0        TO V2
  9771                END-IF
  9772                IF V1 = 10
  9773                   MOVE 9        TO V2
  9774                END-IF
  9775                IF WS-WORK-VIN (V1:1) NUMERIC
  9776                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9777                    + (WS-WORK-VIN-N (V1) * V2)
  9778                ELSE
  9779                   MOVE WS-WORK-VIN (V1:1)
  9780                                 TO WS-HEX-BYTE
  9781                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9782                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9783                    + (WS-NUM (V3) * V2)
  9784                END-IF
  9785                COMPUTE V2 = V2 - 1
  9786             END-IF
  9787          END-PERFORM
  9788          MOVE ZEROS TO WS-VIN-REMAINDER
  9789          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9790             REMAINDER WS-VIN-REMAINDER
  9791          IF ((WS-WORK-VIN (9:1) = 'X')
  9792             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 180
* EL050.cbl
  9793                     OR
  9794             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9795             CONTINUE
  9796          ELSE
  9797             MOVE ER-3826        TO WS-ERROR
  9798             PERFORM 9900-ERROR-FORMAT
  9799                                 THRU 9900-EXIT
  9800          END-IF
  9801        ELSE
  9802          MOVE ER-3826           TO WS-ERROR
  9803          PERFORM 9900-ERROR-FORMAT
  9804                                 THRU 9900-EXIT
  9805        END-IF
  9806     END-IF
  9807******************************************************************
  9808******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9809******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9810******* METHODS.
  9811******************************************************************
  9812     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9813        IF PB-CANCELLATION
  9814           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9815              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9816                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9817                IF FORM-MASTER-FOUND
  9818                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9819******************************************************************
  9820
  9821     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9822     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9823
  9824     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9825     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9826     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9827     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9828
  9829
  9830     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9831     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9832     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9833
  9834     IF AM-LF-OB-RATE NOT NUMERIC
  9835         MOVE ZERO               TO AM-LF-OB-RATE.
  9836
  9837     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9838         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9839
  9840     IF AM-AH-OB-RATE NOT NUMERIC
  9841         MOVE ZERO               TO AM-AH-OB-RATE.
  9842
  9843     IF WS-LF-JOINT-INDICATOR = 'J'
  9844         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9845     ELSE
  9846         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9847
  9848     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9849
  9850     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 181
* EL050.cbl
  9851         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9852
  9853     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9854         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9855                                       WS-IG-OVRD
  9856     ELSE
  9857         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9858             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9859                                       WS-IG-OVRD
  9860         ELSE
  9861             MOVE AM-IG             TO WS-IG-OVRD-AH
  9862                                       WS-IG-OVRD.
  9863
  9864     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9865         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9866                                       WS-IG-OVRD
  9867     ELSE
  9868         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9869             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9870                                       WS-IG-OVRD
  9871         ELSE
  9872             MOVE AM-IG             TO WS-IG-OVRD-LF
  9873                                       WS-IG-OVRD.
  9874
  9875     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9876     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9877     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9878     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9879     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9880
  9881     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9882     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9883     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9884     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9885
  9886     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9887     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9888     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9889     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9890     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9891     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9892     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9893
  9894     IF WS-ACCT-AH-DEV-PCT > +0
  9895        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9896     ELSE
  9897        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9898
  9899     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9900        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9901     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9902        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9903
  9904        IF AM-EARN-METHOD-L = 'S'
  9905            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9906                                        WS-LF-REFUND-CALC.
  9907
  9908        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 182
* EL050.cbl
  9909            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9910                                        WS-LF-REFUND-CALC.
  9911
  9912     IF WS-LF-COVERAGE-TYPE = 'R'
  9913         IF AM-EARN-METHOD-R = 'R'
  9914            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9915                                    WS-LF-REFUND-CALC.
  9916     IF WS-LF-COVERAGE-TYPE = 'R'
  9917         IF AM-EARN-METHOD-R = 'P'
  9918            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9919                                    WS-LF-REFUND-CALC.
  9920     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9921         IF AM-EARN-METHOD-L = 'R'
  9922            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9923                                    WS-LF-REFUND-CALC.
  9924     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9925         IF AM-EARN-METHOD-L = 'P'
  9926            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9927                                    WS-LF-REFUND-CALC.
  9928     IF WS-LF-COVERAGE-TYPE = 'R'
  9929         IF AM-EARN-METHOD-R = 'A'
  9930            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9931                                    WS-LF-REFUND-CALC.
  9932     IF WS-LF-COVERAGE-TYPE = 'R'
  9933         IF AM-EARN-METHOD-R = 'M'
  9934            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9935                                    WS-LF-REFUND-CALC.
  9936     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9937         IF AM-EARN-METHOD-L = 'A'
  9938            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9939                                    WS-LF-REFUND-CALC.
  9940     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9941         IF AM-EARN-METHOD-L = 'M'
  9942            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9943                                    WS-LF-REFUND-CALC.
  9944
  9945     IF AM-EARN-METHOD-A = 'R'
  9946        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9947                                    WS-AH-REFUND-CALC.
  9948     IF AM-EARN-METHOD-A = 'P'
  9949        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9950                                    WS-AH-REFUND-CALC.
  9951     IF AM-EARN-METHOD-A = 'C'
  9952        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9953                                    WS-AH-REFUND-CALC.
  9954     IF AM-EARN-METHOD-A = 'A'
  9955        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9956                                    WS-AH-REFUND-CALC.
  9957     IF AM-EARN-METHOD-A = 'M'
  9958        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9959                                    WS-AH-REFUND-CALC.
  9960     IF AM-EARN-METHOD-A = 'N'
  9961        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9962                                    WS-AH-REFUND-CALC.
  9963     IF AM-EARN-METHOD-A = 'S'
  9964        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9965                                    WS-AH-REFUND-CALC.
  9966
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 183
* EL050.cbl
  9967     IF AM-TOL-PREM NOT = ZEROS
  9968        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9969                                    WS-TOL-AH-PREM.
  9970
  9971     IF AM-OVR-SHT-AMT NUMERIC AND
  9972                  AM-OVR-SHT-AMT > 0
  9973        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9974                                    EC-AM-LF-OVR-SHT-AMT
  9975                                    WS-AH-REFUND-OVS-AMT
  9976                                    EC-AM-AH-OVR-SHT-AMT.
  9977
  9978     IF AM-OVR-SHT-PCT NUMERIC AND
  9979                    AM-OVR-SHT-PCT > 0
  9980        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9981                                    EC-AM-LF-OVR-SHT-PCT
  9982                                    WS-AH-REFUND-OVS-PCT
  9983                                    EC-AM-AH-OVR-SHT-PCT.
  9984
  9985     IF AM-TOL-REF-PCT NUMERIC AND
  9986                  AM-TOL-REF-PCT > 0
  9987        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
  9988                                    WS-TOL-AH-REFUND-PCT.
  9989
  9990     IF AM-TOL-REF  NOT = ZEROS  AND
  9991                  AM-TOL-REF NUMERIC
  9992        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
  9993                                    EC-AM-LF-TOL-REFUND
  9994                                    WS-TOL-AH-REFUND
  9995                                    EC-AM-AH-TOL-REFUND.
  9996
  9997     IF AM-TOL-CLM  NOT = ZEROS
  9998        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
  9999                                    WS-TOL-AH-CLAIM.
 10000
 10001     IF AM-CLP-TOL-PCT NOT NUMERIC
 10002        MOVE +0                  TO AM-CLP-TOL-PCT
 10003     END-IF
 10004
 10005     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10006        MOVE +0                  TO AM-SPP-LEASE-COMM
 10007     END-IF
 10008     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10009        MOVE WS-PL-TOL-LF-PREM-PCT
 10010                                 TO WS-TOL-LF-PREM-PCT.
 10011
 10012     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10013        MOVE WS-PL-TOL-AH-PREM-PCT
 10014                                 TO WS-TOL-AH-PREM-PCT.
 10015
 10016     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10017        MOVE WS-PL-TOL-LF-REFUND-PCT
 10018                                 TO WS-TOL-LF-REFUND-PCT.
 10019
 10020     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10021        MOVE WS-PL-TOL-AH-REFUND-PCT
 10022                                 TO WS-TOL-AH-REFUND-PCT.
 10023
 10024     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 184
* EL050.cbl
 10025        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10026
 10027     IF WS-PL-REF-OVS-PCT > +0
 10028        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10029
 10030     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10031        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10032     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10033        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10034     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10035        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10036     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10037        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10038     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10039        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10040     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10041        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10042
 10043     IF WS-AH-PL-REF-OVS-AMT > +0
 10044        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10045
 10046     IF WS-AH-PL-REF-OVS-PCT > +0
 10047        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10048
 10049     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10050     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10051
 10052     IF PB-CANCELLATION
 10053        GO TO 3000-CONTINUE-EDIT.
 10054
 10055     MOVE +1 TO SUB1.
 10056     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10057     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10058
 10059     IF CF-COMPANY-ID = 'DMD'
 10060       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10061         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10062        ELSE
 10063         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10064
 10065  0525-FIND-ACCT-COMM.
 10066     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10067        NEXT SENTENCE
 10068      ELSE
 10069         ADD +1 TO SUB1
 10070         IF SUB1 LESS +11
 10071            GO TO 0525-FIND-ACCT-COMM
 10072          ELSE
 10073             GO TO 0560-EDIT-CONTINUE.
 10074
 10075     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10076     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10077                                    PB-I-LIFE-COMMISSION.
 10078***  IF PB-COMPANY-ID = 'CRI'
 10079     IF PB-PREM-ACCTNG-ONLY
 10080         GO TO 0560-EDIT-CONTINUE.
 10081
 10082     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 185
* EL050.cbl
 10083     MOVE ' '    TO WS-CTBL-READ-SW.
 10084
 10085
 10086 0530-GET-AH-COMP.
 10087     IF NO-AH-COVERAGE  OR
 10088        NO-AH-BENEFIT-MATCH
 10089           GO TO 0540-NEXT-READ-STEP.
 10090
 10091     IF AM-A-COM (SUB1) NUMERIC
 10092        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10093         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10094         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10095         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10096         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10097     ELSE
 10098          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10099          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10100          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10101          MOVE ZEROS             TO WS-SUB1
 10102                                    WS-COMMISSION
 10103          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10104          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10105          IF WS-COMMISSION > ZEROS
 10106             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10107             GO TO 0540-NEXT-READ-STEP
 10108          END-IF
 10109          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10110          IF CTBL-TABLE-FOUND
 10111             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10112                                        PB-I-AH-TERM
 10113             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10114             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10115             GO TO 0540-NEXT-READ-STEP
 10116          ELSE
 10117             IF FIRST-TIME-THROUGH
 10118                 GO TO 0530-GET-AH-COMP
 10119             ELSE
 10120                 MOVE ER-2609                TO WS-ERROR
 10121                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10122
 10123 0540-NEXT-READ-STEP.
 10124     MOVE '0540' TO CTBL-SW.
 10125     MOVE ' '    TO WS-CTBL-READ-SW.
 10126
 10127 0540-GET-LF-COMP.
 10128     IF NO-LIFE-COVERAGE  OR
 10129        NO-LF-BENEFIT-MATCH
 10130           GO TO 0560-EDIT-CONTINUE.
 10131
 10132     IF WS-LF-JOINT-INDICATOR = 'J'
 10133        IF AM-J-COM (SUB1) NUMERIC
 10134           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10135           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10136           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10137           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10138           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10139        ELSE
 10140           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 186
* EL050.cbl
 10141           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10142           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10143           MOVE ZEROS                TO WS-SUB1
 10144                                        WS-COMMISSION
 10145           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10146           IF WS-COMMISSION > ZEROS
 10147              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10148              GO TO 0560-EDIT-CONTINUE
 10149           END-IF
 10150           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10151           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10152           IF CTBL-TABLE-FOUND
 10153              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10154              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10155              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10156              GO TO 0560-EDIT-CONTINUE
 10157           ELSE
 10158              IF FIRST-TIME-THROUGH
 10159                  GO TO 0540-GET-LF-COMP
 10160              ELSE
 10161                  MOVE ER-2609                TO WS-ERROR
 10162                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10163                  GO TO 0560-EDIT-CONTINUE.
 10164
 10165     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10166        IF AM-L-COM (SUB1) NUMERIC
 10167           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10168           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10169           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10170           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10171           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10172        ELSE
 10173           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10174           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10175           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10176           MOVE ZEROS                TO WS-SUB1
 10177                                        WS-COMMISSION
 10178           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10179           IF WS-COMMISSION IS GREATER THAN ZEROS
 10180              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10181              GO TO 0560-EDIT-CONTINUE
 10182           END-IF
 10183           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10184           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10185           IF CTBL-TABLE-FOUND
 10186              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10187              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10188              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10189              GO TO 0560-EDIT-CONTINUE
 10190           ELSE
 10191              IF FIRST-TIME-THROUGH
 10192                  GO TO 0540-GET-LF-COMP
 10193              ELSE
 10194                  MOVE ER-2609                TO WS-ERROR
 10195                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10196
 10197*    GO TO 0560-EDIT-CONTINUE.
 10198
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 187
* EL050.cbl
 10199 0560-EDIT-CONTINUE.
 10200     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10201                                    WS-AH-PMF-COMM
 10202*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10203*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10204     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10205        (SUB1 > +10)
 10206        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10207           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10208           MOVE '0530'           TO CTBL-SW
 10209           MOVE ' '              TO WS-CTBL-READ-SW
 10210           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10211           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10212           MOVE '0540'           TO CTBL-SW
 10213           MOVE ' '              TO WS-CTBL-READ-SW
 10214           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10215        END-IF
 10216     END-PERFORM
 10217     GO TO 0564-EDIT-CONTINUE
 10218     .
 10219 0561-CHECK-AH.
 10220     IF (NO-AH-COVERAGE)
 10221        OR (NO-AH-BENEFIT-MATCH)
 10222        CONTINUE
 10223     ELSE
 10224        IF (AM-A-COM (SUB1) NUMERIC)
 10225           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10226           IF (AM-COM-TYP (SUB1) = 'A')
 10227              AND (WS-AH-PMF-COMM = ZEROS)
 10228              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10229           END-IF
 10230           CONTINUE
 10231        ELSE
 10232           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10233           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10234           MOVE PB-AH-OVERRIDE-L1
 10235                                 TO CTBL-BEN-TYPE
 10236           MOVE ZEROS            TO WS-SUB1
 10237                                    WS-COMMISSION
 10238           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10239           PERFORM 8300-READ-CTBL-TABLE
 10240                                 THRU 8300-EXIT
 10241           IF CTBL-TABLE-FOUND
 10242              IF (AM-COM-TYP (SUB1) = 'A')
 10243                 AND (WS-AH-PMF-COMM = ZEROS)
 10244                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10245                                        PB-I-AH-TERM
 10246                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10247                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10248              END-IF
 10249              CONTINUE
 10250           ELSE
 10251              IF FIRST-TIME-THROUGH
 10252                 GO TO 0561-CHECK-AH
 10253              ELSE
 10254                 MOVE ER-2609    TO WS-ERROR
 10255                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10256              END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 188
* EL050.cbl
 10257           END-IF
 10258        END-IF
 10259     END-IF
 10260     .
 10261 0561-EXIT.
 10262     EXIT.
 10263 0563-CHECK-LF.
 10264     IF (NO-LIFE-COVERAGE)
 10265        OR (NO-LF-BENEFIT-MATCH)
 10266        CONTINUE
 10267     ELSE
 10268        IF WS-LF-JOINT-INDICATOR = 'J'
 10269           IF AM-J-COM (SUB1) NUMERIC
 10270              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10271              IF (AM-COM-TYP (SUB1) = 'A')
 10272                 AND (WS-LF-PMF-COMM = ZEROS)
 10273                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10274              END-IF
 10275              CONTINUE
 10276           ELSE
 10277              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10278              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10279              MOVE PB-LIFE-OVERRIDE-L1
 10280                                 TO CTBL-BEN-TYPE
 10281              MOVE ZEROS         TO WS-SUB1
 10282                                    WS-COMMISSION
 10283              MOVE AM-J-COMA (SUB1)
 10284                                 TO CTBL-TABLE
 10285              PERFORM 8300-READ-CTBL-TABLE
 10286                                 THRU 8300-EXIT
 10287              IF CTBL-TABLE-FOUND
 10288                 IF (AM-COM-TYP (SUB1) = 'A')
 10289                    AND (WS-LF-PMF-COMM = ZEROS)
 10290                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10291                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10292                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10293                 END-IF
 10294                 CONTINUE
 10295              ELSE
 10296                 IF FIRST-TIME-THROUGH
 10297                    GO TO 0563-CHECK-LF
 10298                 ELSE
 10299                    MOVE ER-2609 TO WS-ERROR
 10300                    PERFORM 9900-ERROR-FORMAT
 10301                                 THRU 9900-EXIT
 10302*                   GO TO 0560-EDIT-CONTINUE
 10303                 END-IF
 10304              END-IF
 10305           END-IF
 10306        ELSE
 10307           IF AM-L-COM (SUB1) NUMERIC
 10308              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10309              IF (AM-COM-TYP (SUB1) = 'A')
 10310                 AND (WS-LF-PMF-COMM = ZEROS)
 10311                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10312              END-IF
 10313              CONTINUE
 10314           ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 189
* EL050.cbl
 10315              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10316              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10317              MOVE PB-LIFE-OVERRIDE-L1
 10318                                 TO CTBL-BEN-TYPE
 10319              MOVE ZEROS         TO WS-SUB1
 10320                                    WS-COMMISSION
 10321              MOVE AM-L-COMA (SUB1)
 10322                                 TO CTBL-TABLE
 10323              PERFORM 8300-READ-CTBL-TABLE
 10324                                 THRU 8300-EXIT
 10325              IF CTBL-TABLE-FOUND
 10326                 CONTINUE
 10327              ELSE
 10328                 IF FIRST-TIME-THROUGH
 10329                    GO TO 0563-CHECK-LF
 10330                 ELSE
 10331                    MOVE ER-2609 TO WS-ERROR
 10332                    PERFORM 9900-ERROR-FORMAT
 10333                                 THRU 9900-EXIT
 10334                 END-IF
 10335              END-IF
 10336           END-IF
 10337        END-IF
 10338     END-IF
 10339     .
 10340 0563-EXIT.
 10341     EXIT.
 10342 0564-EDIT-CONTINUE.
 10343
 10344     IF  PB-COMPANY-ID EQUAL 'DMD'
 10345         IF PB-I-NUM-BILLED EQUAL ZEROS
 10346            MOVE ER-8148       TO WS-ERROR
 10347            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10348
 10349*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10350*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10351*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10352*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10353*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10354*         IF NO-CONVERSION-ERROR
 10355*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10356*         ELSE
 10357*             IF PB-COMPANY-ID EQUAL 'HAN'
 10358*                 MOVE ZEROS     TO PB-I-AGE.
 10359     IF PB-I-BIRTHDAY > LOW-VALUES
 10360        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10361        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10362        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10363        PERFORM 8500-DATE-CONVERT
 10364                                 THRU 8500-EXIT
 10365        IF NO-CONVERSION-ERROR
 10366           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10367           IF PB-I-AGE > ZEROS
 10368              IF WS-WORK-AGE NOT = PB-I-AGE
 10369                 MOVE ER-9501    TO WS-ERROR
 10370                 PERFORM 9900-ERROR-FORMAT
 10371                                 THRU 9900-EXIT
 10372              END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 190
* EL050.cbl
 10373           ELSE
 10374              MOVE WS-WORK-AGE   TO PB-I-AGE
 10375           END-IF
 10376        END-IF
 10377     END-IF
 10378     IF PB-I-AGE = ZEROS
 10379        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10380           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10381
 10382     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10383                                   WS-AH-EDIT-AGE.
 10384
 10385     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10386        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10387        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10388        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10389        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10390        IF NO-CONVERSION-ERROR
 10391           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10392           IF PB-I-JOINT-AGE > 0
 10393              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10394                 MOVE ER-9503    TO WS-ERROR
 10395                 PERFORM 9900-ERROR-FORMAT
 10396                                 THRU 9900-EXIT
 10397              END-IF
 10398           ELSE
 10399              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10400           END-IF
 10401        ELSE
 10402           MOVE ZEROS            TO PB-I-JOINT-AGE
 10403        END-IF
 10404     END-IF
 10405     IF PB-I-JOINT-AGE NOT NUMERIC
 10406        MOVE ZERO               TO PB-I-JOINT-AGE.
 10407
 10408     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC'
 10409        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10410           (WS-AH-JOINT-INDICATOR = 'J')
 10411           IF PB-I-JOINT-AGE = ZEROS
 10412               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10413           END-IF
 10414        END-IF
 10415     END-IF
 10416
 10417     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10418     IF WS-LF-JOINT-INDICATOR = 'J'
 10419        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10420        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10421            IF  PB-I-JOINT-AGE = ZERO
 10422                MOVE ER-2686       TO WS-ERROR
 10423                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10424            ELSE
 10425                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10426                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10427                    IF PB-COMPANY-ID NOT = 'LBL'
 10428                        MOVE ER-2685    TO WS-ERROR
 10429                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10430
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 191
* EL050.cbl
 10431     IF WS-AH-JOINT-INDICATOR = 'J'
 10432        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10433            IF  PB-I-JOINT-AGE = ZERO
 10434                MOVE ER-2686       TO WS-ERROR
 10435                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10436            ELSE
 10437                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10438                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10439                                           WS-EDIT-AGE
 10440                    IF PB-COMPANY-ID NOT = 'LBL'
 10441                        MOVE ER-2685    TO WS-ERROR
 10442                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10443
 10444******************************************************************
 10445*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10446******************************************************************
 10447
 10448     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10449        (WS-AH-SPECIAL-CALC-CD = 'O')
 10450        NEXT SENTENCE
 10451     ELSE
 10452        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10453          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10454           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10455            WS-AH-JOINT-INDICATOR = 'J')  AND
 10456           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10457            MOVE ER-2627             TO WS-ERROR
 10458            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10459
 10460     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10461        (WS-AH-SPECIAL-CALC-CD = 'O')
 10462         NEXT SENTENCE
 10463     ELSE
 10464         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10465            WS-AH-JOINT-INDICATOR = 'J'
 10466             IF PB-I-JOINT-INSURED = SPACES
 10467                 IF PB-COMPANY-ID NOT = 'JAL'
 10468                     MOVE ER-2696    TO WS-ERROR
 10469                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10470
 10471     IF PB-COMPANY-ID NOT = 'BOA'
 10472        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10473           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10474           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10475               PB-I-JOINT-INSURED NOT = SPACES)
 10476                MOVE ER-2691         TO WS-ERROR
 10477                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10478
 10479     IF PB-COMPANY-ID = 'BOA'
 10480        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10481           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10482            IF PB-I-JOINT-AGE NOT = ZEROS
 10483                MOVE ER-2691         TO WS-ERROR
 10484                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10485
 10486     IF PB-COMPANY-ID = 'CRI'
 10487        IF PB-I-SIG-SW = 'J'
 10488           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 192
* EL050.cbl
 10489              WS-AH-JOINT-INDICATOR NOT = 'J'
 10490              MOVE ER-2675       TO WS-ERROR
 10491              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10492
 10493     IF PB-COMPANY-ID = 'CRI'
 10494        IF PB-I-SIG-SW = 'S'
 10495           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10496              WS-AH-JOINT-INDICATOR = 'J'
 10497              MOVE ER-2676       TO WS-ERROR
 10498              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10499
 10500     IF PB-COMPANY-ID = 'CVL'
 10501         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10502            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10503              MOVE ER-2783           TO WS-ERROR
 10504              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10505     IF (WS-LF-JOINT-INDICATOR = 'J')
 10506        AND (WS-AH-JOINT-INDICATOR = 'J')
 10507        AND (PB-I-LF-TERM > 120)
 10508        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10509        MOVE ER-2783             TO WS-ERROR
 10510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10511     END-IF
 10512     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10513
 10514     IF PB-I-INDV-GRP-OVRD = 'I'
 10515        MOVE ER-2666             TO WS-ERROR
 10516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10517        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10518
 10519     IF PB-I-INDV-GRP-OVRD = 'G'
 10520        MOVE ER-2666             TO WS-ERROR
 10521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10522        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10523
 10524     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10525        NEXT SENTENCE
 10526     ELSE
 10527        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10528
 10529     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10530        IF WS-ERROR = ER-2666
 10531           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10532           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10533
 10534     IF PB-COMPANY-ID = 'CID'
 10535        IF PB-STATE = 'UT' OR 'MO'
 10536           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10537                 OR '76' OR '77')
 10538                      OR
 10539               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10540                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10541                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10542                   OR '2K' OR '2L'))
 10543              AND PB-I-INDV-GRP-CD = 'I'
 10544              MOVE ER-2721             TO WS-ERROR
 10545              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10546           END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 193
* EL050.cbl
 10547        END-IF
 10548     END-IF
 10549
 10550     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10551     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10552        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10553     ELSE
 10554        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10555     END-IF
 10556
 10557*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10558*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10559     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10560                                    ACCOUNT-AH-CK-SW.
 10561
 10562     IF PB-REISSUED-CERT       OR
 10563        PB-REIN-ONLY-CERT      OR
 10564        PB-POLICY-IS-DECLINED  OR
 10565        PB-POLICY-IS-VOIDED
 10566*       OR PB-MONTHLY-CERT
 10567         GO TO 3000-CONTINUE-EDIT.
 10568
 10569     IF PB-COMPANY-ID = 'CID'
 10570        IF WS-EDIT-AGE           > +65
 10571           MOVE ER-2709          TO WS-ERROR
 10572           PERFORM 9900-ERROR-FORMAT
 10573                                 THRU 9900-EXIT
 10574        ELSE
 10575           IF WS-EDIT-AGE        > +55
 10576              MOVE ER-2718       TO WS-ERROR
 10577              PERFORM 9900-ERROR-FORMAT
 10578                                 THRU 9900-EXIT
 10579           END-IF
 10580        END-IF
 10581     IF PB-COMPANY-ID = 'DCC'
 10582        IF WS-EDIT-AGE           > +65
 10583           MOVE ER-2709          TO WS-ERROR
 10584           PERFORM 9900-ERROR-FORMAT
 10585                                 THRU 9900-EXIT
 10586        END-IF
 10587     END-IF
 10588     .
 10589
 10590 0565-LIFE-PLAN-LIMIT-EDITS.
 10591
 10592     IF NOT LF-PLAN-MASTER-FOUND
 10593        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10594                                    EC-AM-LF-MAX-TOT-BEN
 10595        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10596
 10597     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10598
 10599     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10600         IF PL-LM-AGE (1) = ZEROS
 10601             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10602
 10603     IF NO-LF-BENEFIT-MATCH          OR
 10604        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 194
* EL050.cbl
 10605        WS-LF-SPECIAL-CALC-CD = 'M'
 10606        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10607
 10608     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10609     MOVE +1                     TO SUB2.
 10610
 10611     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10612        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10613           MOVE +5   TO SUB2
 10614           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10615              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10616              (PL-LM-AGE (SUB2) EQUAL +0)
 10617              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10618              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10619
 10620     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10621
 10622     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10623                               + PB-I-LF-ALT-BENEFIT-AMT.
 10624
 10625 0568-CHECK-LIFE-ATT-AGE.
 10626
 10627     IF PL-ATT-AGE NUMERIC AND
 10628        PL-ATT-AGE > +0
 10629        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10630     END-IF
 10631*    IF PL-ATT-AGE NUMERIC AND
 10632*       PL-ATT-AGE > +0
 10633*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10634*       IF PB-I-BIRTHDAY > LOW-VALUES
 10635*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10636*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10637*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10638*          SET BIN-PLUS-ELAPSED  TO TRUE
 10639*          PERFORM 8500-DATE-CONVERT
 10640*                                THRU 8500-EXIT
 10641*          IF NO-CONVERSION-ERROR
 10642*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10643*             MOVE ER-2669       TO WS-ERROR
 10644*             PERFORM 9900-ERROR-FORMAT
 10645*                                THRU 9900-EXIT
 10646*          END-IF
 10647*       ELSE
 10648*          IF WS-ATT-AGE >= PL-ATT-AGE
 10649*             MOVE ER-2669       TO WS-ERROR
 10650*             PERFORM 9900-ERROR-FORMAT
 10651*                                THRU 9900-EXIT
 10652*          END-IF
 10653*       END-IF
 10654*    END-IF
 10655     .
 10656 0570-CHECK-LIFE-LIMITS.
 10657
 10658     IF PB-COMPANY-ID EQUAL 'CRI'
 10659        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10660           IF SUB2 GREATER THAN +4
 10661              MOVE ER-2637 TO WS-ERROR
 10662              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 195
* EL050.cbl
 10663              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10664
 10665     IF PB-COMPANY-ID  =  'NCL'
 10666        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10667            SUB2 GREATER THAN +8
 10668             MOVE 'U'         TO PB-BATCH-ENTRY
 10669             MOVE ER-2637     TO WS-ERROR
 10670             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10671             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10672
 10673     IF SUB2 > +8
 10674        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10675           AND (PB-I-SIG-SW = 'Y')
 10676           CONTINUE
 10677        ELSE
 10678           MOVE ER-2637          TO WS-ERROR
 10679           PERFORM 9900-ERROR-FORMAT
 10680                                 THRU 9900-EXIT
 10681        END-IF
 10682        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10683     END-IF
 10684     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10685     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10686     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10687
 10688     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10689        ADD +1  TO SUB2
 10690        GO TO 0570-CHECK-LIFE-LIMITS.
 10691
 10692     IF PB-COMPANY-ID = 'NCL'
 10693         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10694
 10695     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10696        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10697        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10698           AND (PB-I-SIG-SW = 'Y')
 10699           CONTINUE
 10700        ELSE
 10701           MOVE ER-2637          TO WS-ERROR
 10702           PERFORM 9900-ERROR-FORMAT
 10703                                 THRU 9900-EXIT
 10704        END-IF
 10705     END-IF
 10706     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10707
 10708
 10709 0570-CHECK-NCL-LIFE-LIMITS.
 10710
 10711     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10712        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10713         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10714
 10715     IF APP-CERT-USED
 10716         IF SUB2  LESS THAN  +5
 10717             MOVE +5          TO SUB2
 10718             GO TO 0570-CHECK-LIFE-LIMITS.
 10719
 10720     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 196
* EL050.cbl
 10721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10722
 10723     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10724
 10725 0575-CHECK-NCL-SIG-SWITCH.
 10726
 10727     IF NOT APP-CERT-USED
 10728         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10729
 10730     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10731        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10732        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10733        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10734         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10735
 10736     IF SUB2 GREATER THAN +4
 10737         IF PL-LM-AGE (5) = ZEROS  AND
 10738            PL-LM-AGE (6) = ZEROS  AND
 10739            PL-LM-AGE (7) = ZEROS  AND
 10740            PL-LM-AGE (8) = ZEROS
 10741             MOVE  ER-1927        TO WS-ERROR
 10742             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10743             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10744         ELSE
 10745             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10746                 MOVE  ER-1920    TO WS-ERROR
 10747                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10748
 10749     IF PB-I-SIG-SW  = 'Y'
 10750       IF NOT PB-I-POLICY-ACCEPTED  AND
 10751          NOT PB-I-POLICY-DECLINED
 10752           MOVE 'U'               TO PB-BATCH-ENTRY
 10753           MOVE  ER-1926          TO WS-ERROR
 10754           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10755
 10756
 10757 0580-AH-PLAN-LIMIT-EDITS.
 10758
 10759     IF PB-COMPANY-ID = 'CID'
 10760        IF PB-I-AH-BENEFIT-AMT > +1250
 10761           MOVE ER-2702          TO WS-ERROR
 10762           PERFORM 9900-ERROR-FORMAT
 10763                                 THRU 9900-EXIT
 10764        END-IF
 10765     END-IF
 10766
 10767     IF (PB-COMPANY-ID = 'DCC')
 10768        AND (PB-MONTHLY-CERT)
 10769        IF PB-I-AH-BENEFIT-AMT > +1000
 10770           MOVE ER-2881          TO WS-ERROR
 10771           PERFORM 9900-ERROR-FORMAT
 10772                                 THRU 9900-EXIT
 10773        END-IF
 10774     END-IF
 10775     IF NOT AH-PLAN-MASTER-FOUND
 10776        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10777        GO TO 3000-CONTINUE-EDIT.
 10778
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 197
* EL050.cbl
 10779     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10780
 10781     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10782         IF PL-LM-AGE (1) = ZEROS
 10783             GO TO 3000-CONTINUE-EDIT.
 10784
 10785     IF NO-AH-BENEFIT-MATCH          OR
 10786        WS-AH-BENEFIT-CD = ZEROS     OR
 10787        WS-AH-SPECIAL-CALC-CD = 'M'
 10788        GO TO 3000-CONTINUE-EDIT.
 10789
 10790     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10791     MOVE +1                     TO SUB2.
 10792
 10793     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10794        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10795           MOVE +5 TO SUB2
 10796           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10797              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10798              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10799              (PL-LM-AGE (SUB2) EQUAL +0)
 10800              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10801              GO TO 3000-CONTINUE-EDIT.
 10802
 10803     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10804
 10805 0590-CHECK-AH-ATT-AGE.
 10806
 10807     IF PL-ATT-AGE NUMERIC AND
 10808        PL-ATT-AGE GREATER THAN +0
 10809        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10810     END-IF
 10811*       IF WS-ATT-AGE >= PL-ATT-AGE
 10812*          MOVE ER-3054          TO WS-ERROR
 10813*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10814     .
 10815 0597-CHECK-AH-LIMITS.
 10816
 10817     IF PB-COMPANY-ID EQUAL 'CRI'
 10818        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10819           IF SUB2 GREATER THAN +4
 10820              MOVE ER-2638       TO WS-ERROR
 10821              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10822              GO TO 3000-CONTINUE-EDIT.
 10823
 10824     IF PB-COMPANY-ID  =  'NCL'
 10825        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10826            SUB2 GREATER THAN +8
 10827             MOVE 'U'            TO PB-BATCH-ENTRY
 10828             MOVE ER-2638        TO WS-ERROR
 10829             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10830             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10831
 10832     IF SUB2 > +8
 10833        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10834           AND (PB-I-SIG-SW = 'Y')
 10835           CONTINUE
 10836        ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 198
* EL050.cbl
 10837           MOVE ER-2638          TO WS-ERROR
 10838           PERFORM 9900-ERROR-FORMAT
 10839                                 THRU 9900-EXIT
 10840        END-IF
 10841        GO TO 3000-CONTINUE-EDIT
 10842     END-IF
 10843
 10844     IF PB-COMPANY-ID = 'CRI'
 10845        IF WS-ERROR = ER-2638
 10846           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10847
 10848     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10849     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10850     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10851     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10852
 10853     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10854        ADD +1                   TO SUB2
 10855        GO TO 0597-CHECK-AH-LIMITS.
 10856
 10857     IF PB-COMPANY-ID = 'NCL'
 10858         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10859
 10860     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10861        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10862        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10863                                 > PL-LM-AMT (SUB2))
 10864        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10865           AND (PB-I-SIG-SW = 'Y')
 10866           CONTINUE
 10867        ELSE
 10868           MOVE ER-2638          TO WS-ERROR
 10869           PERFORM 9900-ERROR-FORMAT
 10870                                 THRU 9900-EXIT
 10871        END-IF
 10872     END-IF
 10873
 10874     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10875         IF  WS-ERROR    EQUAL    ER-2638
 10876             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10877                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10878                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10879                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10880                MOVE  ER-1910    TO  WS-ERROR
 10881                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10882
 10883     IF PB-COMPANY-ID = 'CRI'
 10884        IF WS-ERROR = ER-2638
 10885            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10886            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10887            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10888
 10889     GO TO 3000-CONTINUE-EDIT.
 10890
 10891 0597-CHECK-NCL-AH-LIMITS.
 10892
 10893     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10894        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 199
* EL050.cbl
 10895        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10896                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10897         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10898
 10899     IF APP-CERT-USED
 10900         IF SUB2  LESS THAN  +5
 10901             MOVE +5             TO SUB2
 10902             GO TO 0597-CHECK-AH-LIMITS.
 10903
 10904     MOVE ER-2638                TO WS-ERROR.
 10905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10906
 10907     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10908
 10909 0599-CHECK-NCL-SIG-SWITCH.
 10910
 10911     IF NOT APP-CERT-USED
 10912         GO TO 3000-CONTINUE-EDIT.
 10913
 10914     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10915        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10916        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10917        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10918         GO TO 3000-CONTINUE-EDIT.
 10919
 10920     IF SUB2 GREATER THAN +4
 10921         IF PL-LM-AGE (5) = ZEROS  AND
 10922            PL-LM-AGE (6) = ZEROS  AND
 10923            PL-LM-AGE (7) = ZEROS  AND
 10924            PL-LM-AGE (8) = ZEROS
 10925             MOVE  ER-1927        TO WS-ERROR
 10926             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10927             GO TO 3000-CONTINUE-EDIT
 10928         ELSE
 10929             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10930                 MOVE  ER-1920    TO WS-ERROR
 10931                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10932
 10933     IF PB-I-SIG-SW  = 'Y'
 10934       IF NOT PB-I-POLICY-ACCEPTED  AND
 10935          NOT PB-I-POLICY-DECLINED
 10936           MOVE 'U'               TO PB-BATCH-ENTRY
 10937           MOVE  ER-1926          TO WS-ERROR
 10938           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10939
 10940******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 200
* EL050.cbl
 10942
 10943 3000-CONTINUE-EDIT.
 10944
 10945     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10946     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10947     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10948     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10949     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10950
 10951     IF BROWSE-STARTED
 10952        PERFORM 9990-RETURN THRU 9990-EXIT
 10953        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10954
 10955     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10956        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10957        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10958        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10959*       MOVE 1                   TO DC-OPTION-CODE
 10960        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10961        IF DATE-CONVERSION-ERROR
 10962           MOVE ER-2622          TO WS-ERROR
 10963           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10964        ELSE
 10965           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10966              MOVE ER-2623       TO WS-ERROR
 10967              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10968           ELSE
 10969              MOVE ER-2622       TO WS-ERROR
 10970              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10971
 10972     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10973     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10974     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10975*    MOVE 1                      TO DC-OPTION-CODE.
 10976     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10977     IF DATE-CONVERSION-ERROR
 10978        GO TO 3005-EDIT-CONTINUE
 10979     ELSE
 10980        IF DC-ELAPSED-DAYS GREATER +180
 10981           MOVE ER-2613          TO WS-ERROR
 10982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10983        ELSE
 10984           IF DC-ELAPSED-DAYS GREATER +90
 10985              MOVE ER-2612       TO WS-ERROR
 10986              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10987           ELSE
 10988             IF DC-ELAPSED-DAYS GREATER +60
 10989                MOVE ER-2614     TO WS-ERROR
 10990                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10991
 10992 3005-EDIT-CONTINUE.
 10993
 10994     IF PB-CANCELLATION
 10995         GO TO 3700-EDIT-CANCEL.
 10996
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 201
* EL050.cbl
 10998******************************************************************
 10999*                  E D I T   I S S U E                           *
 11000******************************************************************
 11001
 11002 3020-EDIT-ISSUE.
 11003
 11004      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11005      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11006      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11007      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11008      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11009
 11010     IF PB-ISSUE-FORCE
 11011        OR PB-ISSUE-DATE-FORCED
 11012        OR PB-FORCE-OFF
 11013        OR PB-OVERCHARGE-FORCE
 11014        CONTINUE
 11015     ELSE
 11016        MOVE ER-2670             TO WS-ERROR
 11017        PERFORM 9900-ERROR-FORMAT
 11018                                 THRU 9900-EXIT
 11019     END-IF
 11020     .
 11021 3022-SET-POLICY-STATUS.
 11022
 11023     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11024
 11025     IF (PB-REISSUED-CERT)
 11026             OR
 11027        ((PB-COMPANY-ID NOT = 'DCC')
 11028         AND (PB-MONTHLY-CERT))
 11029         MOVE '5'                TO PB-I-ENTRY-STATUS
 11030         MOVE 'E'                TO PB-BATCH-ENTRY
 11031     END-IF
 11032
 11033     IF PB-COMPANY-ID = 'DCC'
 11034        IF PB-MONTHLY-CERT
 11035           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11036        END-IF
 11037     END-IF
 11038     IF PB-POLICY-IS-DECLINED
 11039         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11040     IF PB-POLICY-IS-VOIDED
 11041         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11042     IF PB-NEEDS-UNDERWRITING
 11043         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11044     IF PB-REIN-ONLY-CERT
 11045         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11046     IF PB-PREM-ACCTNG-ONLY
 11047         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11048
 11049     MOVE SPACE                  TO PB-I-OB-FLAG.
 11050
 11051     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11052         MOVE ER-2665            TO WS-ERROR
 11053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11054         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11055
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 202
* EL050.cbl
 11056     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11057        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11058           MOVE 'Z'             TO PB-I-OB-FLAG.
 11059
 11060     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11061        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11062           MOVE 'Z'             TO PB-I-OB-FLAG.
 11063
 11064     IF ACCOUNT-MAST-FOUND
 11065         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11066         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11067         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11068         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11069         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11070         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11071         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11072     END-IF
 11073
 11074     IF ACCOUNT-MAST-FOUND
 11075        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11076         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11077
 11078     IF (ACCOUNT-MAST-FOUND)
 11079        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11080        IF PB-REISSUED-CERT
 11081           CONTINUE
 11082        ELSE
 11083           MOVE ER-2608          TO WS-ERROR
 11084           PERFORM 9900-ERROR-FORMAT
 11085                                 THRU 9900-EXIT
 11086         END-IF
 11087     END-IF
 11088
 11089     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11090        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11091        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11092
 11093**********   DMD CUSTOM CODE FOLLOWS  **********
 11094 3024-EDIT-DMD-FIELDS.
 11095     IF PB-COMPANY-ID NOT = 'DMD'
 11096        GO TO 3025-EDIT-REINSURANCE.
 11097
 11098*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11099*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11100*** ERROR IF THEY ARE NOT EQUAL.
 11101
 11102     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11103     SET BIN-TO-GREG               TO TRUE.
 11104     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11105     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11106**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11107
 11108     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11109     SET BIN-TO-GREG               TO TRUE.
 11110     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11111     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11112**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11113
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 203
* EL050.cbl
 11114     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11115        MOVE ER-8116               TO WS-ERROR
 11116        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11117
 11118     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11119
 11120     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11121                                      WK-FULL-CERT-NO.
 11122     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11123
 11124     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11125
 11126     IF PB-VALID-LIFE
 11127        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11128     ELSE
 11129        IF PB-VALID-AH
 11130          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11131
 11132
 11133     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11134     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11135     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11136                                      DCUA-UNDRWRTR-CODE
 11137                                      DCUA-UNDRWRTR-GROUP-CODE
 11138                                      DCUA-RETURN-CODE.
 11139
 11140****************************************************************
 11141*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11142***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11143***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11144***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11145***   TO THIS RECORD.                                        ***
 11146****************************************************************
 11147     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11148     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11149     IF DCUA-SUCCESSFUL-PROCESS
 11150        GO TO 3024-EDIT-DL7-CONT.
 11151
 11152     IF DCUA-RETURN-CODE EQUAL '01'
 11153        MOVE ER-8110               TO WS-ERROR
 11154        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11155        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11156        GO TO 3024-EDIT-DL7-CONT.
 11157
 11158     IF DCUA-RETURN-CODE EQUAL '02'
 11159        MOVE ER-8111               TO WS-ERROR
 11160        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11162        GO TO 3024-EDIT-DL7-CONT.
 11163
 11164     IF DCUA-RETURN-CODE EQUAL '03'
 11165        MOVE ER-8074               TO WS-ERROR
 11166        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11167        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11168        GO TO 3024-EDIT-DL7-CONT.
 11169
 11170     IF DCUA-RETURN-CODE EQUAL '04'
 11171        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 204
* EL050.cbl
 11172        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11174        GO TO 3024-EDIT-DL7-CONT.
 11175
 11176     IF DCUA-RETURN-CODE EQUAL '05'
 11177        MOVE ER-8076               TO WS-ERROR
 11178        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11180        GO TO 3024-EDIT-DL7-CONT.
 11181
 11182     IF DCUA-RETURN-CODE EQUAL '06'
 11183        MOVE ER-8077               TO WS-ERROR
 11184        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11186        GO TO 3024-EDIT-DL7-CONT.
 11187
 11188     IF DCUA-RETURN-CODE EQUAL '07'
 11189        MOVE ER-8078               TO WS-ERROR
 11190        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11192        GO TO 3024-EDIT-DL7-CONT.
 11193
 11194     IF DCUA-RETURN-CODE EQUAL 'E1'
 11195        MOVE ER-8079               TO WS-ERROR
 11196        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11198        GO TO 3024-EDIT-DL7-CONT.
 11199
 11200     IF DCUA-RETURN-CODE EQUAL 'E2'
 11201        MOVE ER-8080               TO WS-ERROR
 11202        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11204        GO TO 3024-EDIT-DL7-CONT.
 11205
 11206     IF DCUA-RETURN-CODE EQUAL 'E3'
 11207        MOVE ER-8098               TO WS-ERROR
 11208        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11210        GO TO 3024-EDIT-DL7-CONT.
 11211
 11212     IF DCUA-RETURN-CODE EQUAL 'C1'
 11213        MOVE ER-8099               TO WS-ERROR
 11214        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11216        GO TO 3024-EDIT-DL7-CONT.
 11217
 11218     IF DCUA-RETURN-CODE EQUAL 'U1'
 11219        MOVE ER-8109               TO WS-ERROR
 11220        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11222        GO TO 3024-EDIT-DL7-CONT.
 11223
 11224     IF DCUA-RETURN-CODE EQUAL 'N1'
 11225        MOVE ER-8112               TO WS-ERROR
 11226        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11227        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11228        GO TO 3024-EDIT-DL7-CONT.
 11229
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 205
* EL050.cbl
 11230     IF DCUA-RETURN-CODE EQUAL 'N2'
 11231        MOVE ER-8113               TO WS-ERROR
 11232        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11234        GO TO 3024-EDIT-DL7-CONT.
 11235
 11236     IF DCUA-RETURN-CODE EQUAL 'N3'
 11237        MOVE ER-8114               TO WS-ERROR
 11238        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11240        GO TO 3024-EDIT-DL7-CONT.
 11241
 11242     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11243     MOVE ER-8097                  TO WS-ERROR.
 11244     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11245     GO TO 3024-EDIT-DL7-CONT.
 11246
 11247 3024-EDIT-DL7-CONT.
 11248
 11249     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11250     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11251     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11252        NEXT SENTENCE
 11253     ELSE
 11254        MOVE ER-9263               TO WS-ERROR
 11255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11256
 11257******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11258******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11259     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11260        NEXT SENTENCE
 11261     ELSE
 11262        MOVE ER-8039               TO WS-ERROR
 11263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11264
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 206
* EL050.cbl
 11266****************************************************************
 11267*** VALIDATE STATE  : DLO022                                 ***
 11268****************************************************************
 11269     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11270     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11271
 11272     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11273     IF DVSC-SUCCESSFUL-EDIT
 11274        GO TO 3024-EDIT-DL22-CONT.
 11275
 11276     IF DVSC-RETURN-CODE EQUAL '01'
 11277        MOVE ER-8300               TO WS-ERROR
 11278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11279        GO TO 3024-EDIT-DL22-CONT.
 11280
 11281     IF DVSC-RETURN-CODE EQUAL '02'
 11282        MOVE ER-8301               TO WS-ERROR
 11283        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11284        GO TO 3024-EDIT-DL22-CONT.
 11285
 11286     IF DVSC-RETURN-CODE EQUAL '03'
 11287        MOVE ER-8302               TO WS-ERROR
 11288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11289        GO TO 3024-EDIT-DL22-CONT.
 11290
 11291     IF DVSC-RETURN-CODE EQUAL 'N1'
 11292        MOVE ER-8304               TO WS-ERROR
 11293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11294        GO TO 3024-EDIT-DL22-CONT.
 11295
 11296     MOVE ER-8303                  TO WS-ERROR
 11297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11298
 11299 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 207
* EL050.cbl
 11301****************************************************************
 11302*** VALIDATE LOAN OFFICER : DLO021                           ***
 11303****************************************************************
 11304
 11305     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11306     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11307     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11308     IF DVLO-SUCCESSFUL-EDIT
 11309        GO TO 3024-EDIT-DL21-CONT.
 11310
 11311     IF DVLO-RETURN-CODE EQUAL '01'
 11312        MOVE ER-8081               TO WS-ERROR
 11313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11314        GO TO 3024-EDIT-DL21-CONT.
 11315
 11316     IF DVLO-RETURN-CODE EQUAL '02'
 11317        MOVE ER-8082               TO WS-ERROR
 11318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11319        GO TO 3024-EDIT-DL21-CONT.
 11320
 11321     IF DVLO-RETURN-CODE EQUAL '03'
 11322        MOVE ER-8083               TO WS-ERROR
 11323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11324        GO TO 3024-EDIT-DL21-CONT.
 11325
 11326     IF DVLO-RETURN-CODE EQUAL '04'
 11327        MOVE ER-8084               TO WS-ERROR
 11328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11329        GO TO 3024-EDIT-DL21-CONT.
 11330
 11331     IF DVLO-RETURN-CODE EQUAL '05'
 11332        MOVE ER-8085               TO WS-ERROR
 11333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334        GO TO 3024-EDIT-DL21-CONT.
 11335
 11336     MOVE ER-7825                  TO WS-ERROR
 11337     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11338     GO TO 3024-EDIT-DL21-CONT.
 11339
 11340 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 208
* EL050.cbl
 11342
 11343****************************************************************
 11344*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11345****************************************************************
 11346
 11347     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11348     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11349     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11350     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11351     IF DIPF-SUCCESSFUL-EDIT
 11352        GO TO 3024-EDIT-DL02-CONT.
 11353
 11354     IF DIPF-RETURN-CODE EQUAL '01'
 11355        MOVE ER-8086               TO WS-ERROR
 11356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357        GO TO 3024-EDIT-DL02-CONT.
 11358
 11359     IF DIPF-RETURN-CODE EQUAL '02'
 11360        MOVE ER-8087               TO WS-ERROR
 11361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11362        GO TO 3024-EDIT-DL02-CONT.
 11363
 11364     IF DIPF-RETURN-CODE EQUAL '03'
 11365        MOVE ER-8088               TO WS-ERROR
 11366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11367        GO TO 3024-EDIT-DL02-CONT.
 11368
 11369     MOVE ER-8095                  TO WS-ERROR
 11370     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11371     GO TO 3024-EDIT-DL02-CONT.
 11372
 11373 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 209
* EL050.cbl
 11375
 11376****************************************************************
 11377*** VALIDATE BANK ID : DLO003                                ***
 11378****************************************************************
 11379
 11380     MOVE WK-GREG-CENT           TO WCG-CENT.
 11381     MOVE WK-GREG-YYMM           TO WCG-REST.
 11382     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11383        MOVE ER-8040               TO WS-ERROR
 11384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11385
 11386     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11387     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11388     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11389     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11390     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11391     IF DVBI-SUCCESSFUL-EDIT
 11392        GO TO 3024-EDIT-DL03-CONT.
 11393
 11394     IF DVBI-RETURN-CODE EQUAL '01'
 11395        MOVE ER-8089               TO WS-ERROR
 11396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11397        GO TO 3024-EDIT-DL03-CONT.
 11398
 11399     IF DVBI-RETURN-CODE EQUAL '02'
 11400        MOVE ER-8090               TO WS-ERROR
 11401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11402        GO TO 3024-EDIT-DL03-CONT.
 11403
 11404     IF DVBI-RETURN-CODE EQUAL '03'
 11405        MOVE ER-8091               TO WS-ERROR
 11406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11407        GO TO 3024-EDIT-DL03-CONT.
 11408
 11409     IF DVBI-RETURN-CODE EQUAL '04'
 11410        MOVE ER-8092               TO WS-ERROR
 11411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11412        GO TO 3024-EDIT-DL03-CONT.
 11413
 11414     IF DVBI-RETURN-CODE EQUAL '05'
 11415        MOVE ER-8093               TO WS-ERROR
 11416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11417        GO TO 3024-EDIT-DL03-CONT.
 11418
 11419     IF DVBI-RETURN-CODE EQUAL '06'
 11420        MOVE ER-8094               TO WS-ERROR
 11421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11422        GO TO 3024-EDIT-DL03-CONT.
 11423
 11424     MOVE ER-8096                  TO WS-ERROR
 11425     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11426     GO TO 3024-EDIT-DL03-CONT.
 11427
 11428 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 210
* EL050.cbl
 11430
 11431     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11432        NEXT SENTENCE
 11433     ELSE
 11434        MOVE ER-8042               TO WS-ERROR
 11435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11436
 11437     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11438     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11439     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11440
 11441     IF DMPF-RETURN-CODE = '01'
 11442        MOVE ER-8067               TO WS-ERROR
 11443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11444        GO TO 3024-EDIT-DL01-CONT.
 11445
 11446     IF DMPF-RETURN-CODE = '02'
 11447        MOVE ER-8068               TO WS-ERROR
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11449        GO TO 3024-EDIT-DL01-CONT.
 11450
 11451     IF DMPF-RETURN-CODE = '03'
 11452        MOVE ER-8069               TO WS-ERROR
 11453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11454        GO TO 3024-EDIT-DL01-CONT.
 11455
 11456     IF DMPF-RETURN-CODE = 'E1'
 11457        MOVE ER-8070               TO WS-ERROR
 11458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11459        GO TO 3024-EDIT-DL01-CONT.
 11460
 11461     IF DMPF-RETURN-CODE = 'N1'
 11462        MOVE ER-8071               TO WS-ERROR
 11463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11464        GO TO 3024-EDIT-DL01-CONT.
 11465
 11466     IF DMPF-RETURN-CODE NOT = 'OK'
 11467        MOVE ER-8072               TO WS-ERROR
 11468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11469
 11470 3024-EDIT-DL01-CONT.
 11471******************************************************************
 11472***  VALIDATES RATE CODES : DLO017                             ***
 11473******************************************************************
 11474
 11475      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11476      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11477      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11478      IF DVRC-SUCCESSFUL-EDIT
 11479        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11480        GO TO 3024-CHECK-VALID-RATE.
 11481
 11482      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11483
 11484      IF DVRC-RETURN-CODE EQUAL '01'
 11485         MOVE ER-7817                   TO WS-ERROR
 11486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11487         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 211
* EL050.cbl
 11488
 11489      IF DVRC-RETURN-CODE EQUAL '02'
 11490         MOVE ER-7818                   TO WS-ERROR
 11491         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11492         GO TO 3025-EDIT-REINSURANCE.
 11493
 11494      IF DVRC-RETURN-CODE EQUAL '03'
 11495         MOVE ER-7819                   TO WS-ERROR
 11496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11497         GO TO 3025-EDIT-REINSURANCE.
 11498
 11499       MOVE ER-7820                     TO WS-ERROR.
 11500       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11501       GO TO 3025-EDIT-REINSURANCE.
 11502
 11503******************************************************************
 11504***  GET PREMIUM RATES : DLO011                                ***
 11505******************************************************************
 11506
 11507 3024-CHECK-VALID-RATE.
 11508
 11509     IF VALID-RATE-CODE
 11510        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11511        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11512        MOVE SPACES                TO DPRB-RETURN-CODE
 11513        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11514     ELSE
 11515         GO TO 3025-EDIT-REINSURANCE.
 11516
 11517      IF DPRB-SUCCESSFUL-PROCESS
 11518         IF PB-VALID-LIFE
 11519             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11520             GO TO 3025-EDIT-REINSURANCE
 11521         ELSE
 11522             IF PB-VALID-AH
 11523                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11524                 GO TO 3025-EDIT-REINSURANCE.
 11525
 11526      IF DPRB-RETURN-CODE EQUAL '01'
 11527         MOVE ER-7812                   TO WS-ERROR
 11528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11529         GO TO 3025-EDIT-REINSURANCE.
 11530
 11531      IF DPRB-RETURN-CODE EQUAL '02'
 11532         MOVE ER-7813                   TO WS-ERROR
 11533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11534         GO TO 3025-EDIT-REINSURANCE.
 11535
 11536      IF DPRB-RETURN-CODE EQUAL '03'
 11537         MOVE ER-7814                   TO WS-ERROR
 11538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11539         GO TO 3025-EDIT-REINSURANCE.
 11540
 11541      IF DPRB-RETURN-CODE EQUAL '04'
 11542         IF NOT DPRB-1ST-TIME
 11543            MOVE ER-7815                   TO WS-ERROR
 11544            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11545            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 212
* EL050.cbl
 11546          ELSE
 11547         IF PB-VALID-LIFE
 11548            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11549          ELSE
 11550            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11551         END-IF
 11552         MOVE SPACES                TO DOCC-RETURN-CODE
 11553         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11554         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11555         IF DOCC-RETURN-CODE = 'OK'
 11556             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11557             GO TO 3024-CHECK-VALID-RATE
 11558           ELSE
 11559             MOVE ER-7823               TO WS-ERROR
 11560             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11561             GO TO 3025-EDIT-REINSURANCE.
 11562
 11563       MOVE ER-7816                     TO WS-ERROR.
 11564       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11565       GO TO 3025-EDIT-REINSURANCE.
 11566
 11567**********   DMD CUSTOM CODE ABOVE    **********
 11568
 11569 3025-EDIT-REINSURANCE.
 11570     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11571         GO TO 3027-EDIT-CONTINUE.
 11572
 11573     MOVE LOW-VALUES               TO ERREIN-KEY.
 11574     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11575     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11576                                      REIN-CODE-2
 11577                                      REIN-CODE-3.
 11578     MOVE 'A'                      TO REIN-TYPE.
 11579
 11580     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11581
 11582     MOVE '3026' TO REIN-SW.
 11583     MOVE ' '                   TO WS-REIN-READ-SW.
 11584
 11585     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11586     IF REIN-TABLE-NOT-FOUND
 11587         GO TO 3026-NO-SPEC-TABLE.
 11588
 11589     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11590     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11591                                   WS-NSP-ST-CD-LF.
 11592     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11593                                   WS-NSP-ST-CD-AH.
 11594
 11595     GO TO 3040-EDIT-CONTINUE.
 11596
 11597 3026-NO-SPEC-TABLE.
 11598
 11599     MOVE ER-2664                TO WS-ERROR.
 11600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11601     GO TO 3040-EDIT-CONTINUE.
 11602
 11603 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 213
* EL050.cbl
 11604
 11605     IF PB-I-REIN-TABLE = SPACES
 11606       GO TO 3040-EDIT-CONTINUE.
 11607
 11608     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11609          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11610          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11611           GO TO 3040-EDIT-CONTINUE.
 11612
 11613     MOVE LOW-VALUES            TO ERREIN-KEY.
 11614     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11615     MOVE 'A'                   TO REIN-TYPE.
 11616     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11617
 11618     MOVE '3028'                TO REIN-SW.
 11619     MOVE ' '                   TO WS-REIN-READ-SW.
 11620
 11621     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11622     IF REIN-TABLE-NOT-FOUND
 11623         GO TO 3028-NO-REIN-TABLE.
 11624
 11625     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11626     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11627                                   WS-NSP-ST-CD-LF.
 11628     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11629                                   WS-NSP-ST-CD-AH.
 11630
 11631     GO TO 3040-EDIT-CONTINUE.
 11632
 11633 3028-NO-REIN-TABLE.
 11634
 11635     MOVE ER-2615                TO WS-ERROR.
 11636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11637     GO TO 3040-EDIT-CONTINUE.
 11638
 11639 3040-EDIT-CONTINUE.
 11640
 11641     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11642         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11643
 11644     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11645         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11646
 11647     IF (NOT PB-REISSUED-CERT)
 11648        AND (NOT PB-MONTHLY-CERT)
 11649        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11650            MOVE '001'           TO PB-I-LF-TERM
 11651            MOVE 'M'             TO PB-I-INSURED-SEX.
 11652
 11653     IF (NOT PB-REISSUED-CERT)
 11654        AND (NOT PB-MONTHLY-CERT)
 11655        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11656            MOVE '001'           TO PB-I-AH-TERM
 11657            MOVE 'M'             TO PB-I-INSURED-SEX.
 11658
 11659 3040-EDIT-1ST-PMT-DT.
 11660     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11661     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 214
* EL050.cbl
 11662         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11663
 11664******************************************************************
 11665*                                                                *
 11666*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11667*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11668*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11669*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11670*                                                                *
 11671******************************************************************
 11672
 11673     IF PB-EFF-DT-PROCESSING
 11674        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11675                                    PB-I-LF-EXPIRE-DT
 11676                                    PB-I-AH-EXPIRE-DT
 11677        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11678        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11679        MOVE ZERO                TO DC-ELAPSED-DAYS
 11680        MOVE +1                  TO DC-ELAPSED-MONTHS
 11681        SET BIN-PLUS-ELAPSED     TO TRUE
 11682*       MOVE 6                   TO DC-OPTION-CODE
 11683        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11684        IF NO-CONVERSION-ERROR
 11685           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11686
 11687******************************************************************
 11688*                                                                *
 11689*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11690*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11691*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11692*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11693*                                                                *
 11694******************************************************************
 11695
 11696     IF PB-EXT-DAYS-PROCESSING
 11697          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11698                                         PB-I-LF-EXPIRE-DT
 11699                                         PB-I-AH-EXPIRE-DT
 11700          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11701          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11702          MOVE +1                     TO DC-ELAPSED-MONTHS
 11703          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11704          SET BIN-PLUS-ELAPSED        TO TRUE
 11705*         MOVE 6                      TO DC-OPTION-CODE
 11706          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11707          IF NO-CONVERSION-ERROR
 11708             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11709
 11710******************************************************************
 11711*                                                                *
 11712*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11713*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11714*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11715*        (EXPIRE DATE - (TERM -1))  *  -1.
 11716*                                                                *
 11717******************************************************************
 11718
 11719     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 215
* EL050.cbl
 11720        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11721           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11722              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11723              MOVE PB-I-AH-TERM      TO WS-TERM
 11724           ELSE
 11725              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11726              MOVE PB-I-LF-TERM      TO WS-TERM
 11727        ELSE
 11728           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11729              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11730              MOVE PB-I-LF-TERM      TO WS-TERM
 11731           ELSE
 11732              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11733              MOVE PB-I-AH-TERM      TO WS-TERM.
 11734
 11735     IF PB-EXPIRE-DT-PROCESSING
 11736        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11737        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11738        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11739        MOVE ZERO                TO DC-ELAPSED-DAYS
 11740                                    DC-ODD-DAYS-OVER
 11741          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11742          SET BIN-PLUS-ELAPSED    TO TRUE
 11743*         MOVE 6                  TO DC-OPTION-CODE
 11744          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11745          IF NO-CONVERSION-ERROR
 11746             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11747
 11748******************************************************************
 11749*                                                                *
 11750*            1ST PAYMENT DATE PROCESSING                         *
 11751*                                                                *
 11752******************************************************************
 11753
 11754     IF PB-1ST-PMT-DT-PROCESSING
 11755        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11756                                    PB-I-AH-EXPIRE-DT
 11757        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11758
 11759     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11760         NEXT SENTENCE
 11761     ELSE
 11762         MOVE ER-2680                 TO WS-ERROR
 11763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11764         GO TO 3060-ORIG-TERM-CHECK.
 11765
 11766     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11767     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11768     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11769*    MOVE 1                      TO DC-OPTION-CODE.
 11770     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11771                                    DC-ELAPSED-DAYS
 11772                                    DC-ODD-DAYS-OVER.
 11773
 11774     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11775
 11776     IF DATE-CONVERSION-ERROR
 11777        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 216
* EL050.cbl
 11778
 11779     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11780     IF (PB-COMPANY-ID = 'CID')
 11781        AND (WS-LF-COVERAGE-TYPE = 'L')
 11782        IF (DC-ELAPSED-MONTHS > 1)
 11783                      OR
 11784           ((DC-ELAPSED-MONTHS = 1)
 11785           AND (DC-ODD-DAYS-OVER > 0))
 11786           MOVE ER-2882          TO WS-ERROR
 11787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11788        END-IF
 11789     END-IF
 11790     IF PB-EXT-DAYS-PROCESSING
 11791        CONTINUE
 11792     ELSE
 11793        IF DC-ELAPSED-MONTHS = +0
 11794           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11795        ELSE
 11796           IF (WS-LF-EARNINGS-CALC = '4')
 11797              AND (DC-ELAPSED-MONTHS > ZERO)
 11798              AND (DC-ELAPSED-DAYS > ZERO)
 11799              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11800           ELSE
 11801              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11802                                 THRU 6499-EXIT
 11803              MOVE WS-ODD-DAYS-OVER
 11804                                 TO PB-I-EXTENTION-DAYS
 11805           END-IF
 11806        END-IF
 11807     END-IF
 11808******************************************************************
 11809*                                                                *
 11810*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11811*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11812*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11813*            AND ANY ODD DAYS.                                   *
 11814*                                                                *
 11815******************************************************************
 11816
 11817     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11818                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11819     IF WS-LF-EARNINGS-CALC NOT = '4'
 11820        IF DC-ELAPSED-DAYS > ZEROS
 11821           MOVE ER-2681          TO WS-ERROR
 11822           PERFORM 9900-ERROR-FORMAT
 11823                                 THRU 9900-EXIT
 11824        END-IF
 11825     END-IF
 11826
 11827     IF WS-LF-EARNINGS-CALC NOT = '4'
 11828        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11829           MOVE ER-2681          TO WS-ERROR
 11830           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11831
 11832     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11833        (PB-I-LF-TERM NOT = ZERO) AND
 11834         NOT NO-LIFE-COVERAGE
 11835          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 217
* EL050.cbl
 11836          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11837          IF WS-LF-EARNINGS-CALC = '4'
 11838             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11839             PB-I-PAY-FREQUENCY
 11840          END-IF
 11841          MOVE ZERO              TO DC-ELAPSED-DAYS
 11842                                    DC-ODD-DAYS-OVER
 11843          MOVE 1                 TO DC-END-OF-MONTH
 11844          SET BIN-PLUS-ELAPSED        TO TRUE
 11845*         MOVE 6                 TO DC-OPTION-CODE
 11846          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11847          IF NO-CONVERSION-ERROR
 11848             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11849             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11850                (WS-LF-SPECIAL-CALC-CD = 'L')
 11851                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11852                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11853                  MOVE +1             TO DC-ELAPSED-MONTHS
 11854                  SET BIN-PLUS-ELAPSED  TO TRUE
 11855*                 MOVE 6              TO DC-OPTION-CODE
 11856                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11857                  IF NO-CONVERSION-ERROR
 11858                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11859
 11860* okay, i had to move the new att age edit down here because the
 11861* expiration date could get recalculated and i need the exp date
 11862     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11863        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11864        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11865        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11866           AND ZEROS
 11867           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11868           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11869           SET ELAPSED-BETWEEN-BIN TO TRUE
 11870           PERFORM 8500-DATE-CONVERT
 11871                                 THRU 8500-EXIT
 11872           IF NO-CONVERSION-ERROR
 11873              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11874                 MOVE ER-2669       TO WS-ERROR
 11875*                PERFORM 9900-ERROR-FORMAT
 11876*                                THRU 9900-EXIT
 11877              END-IF
 11878           END-IF
 11879        ELSE
 11880           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11881           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11882              MOVE ER-2669       TO WS-ERROR
 11883*             PERFORM 9900-ERROR-FORMAT
 11884*                                THRU 9900-EXIT
 11885           ELSE
 11886              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11887                 MOVE ER-1570    TO WS-ERROR
 11888                 PERFORM 9900-ERROR-FORMAT
 11889                                 THRU 9900-EXIT
 11890              END-IF
 11891           END-IF
 11892        END-IF
 11893        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 218
* EL050.cbl
 11894           AND ZEROS
 11895           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11896           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11897           SET ELAPSED-BETWEEN-BIN TO TRUE
 11898           PERFORM 8500-DATE-CONVERT
 11899                                 THRU 8500-EXIT
 11900           IF NO-CONVERSION-ERROR
 11901              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11902                 MOVE ER-2669       TO WS-ERROR
 11903*                PERFORM 9900-ERROR-FORMAT
 11904*                                THRU 9900-EXIT
 11905              END-IF
 11906           END-IF
 11907        ELSE
 11908           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11909             (PB-I-LF-TERM / 12)
 11910           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11911              MOVE ER-2669       TO WS-ERROR
 11912*             PERFORM 9900-ERROR-FORMAT
 11913*                                THRU 9900-EXIT
 11914           ELSE
 11915              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11916                 MOVE ER-1571    TO WS-ERROR
 11917                 PERFORM 9900-ERROR-FORMAT
 11918                                 THRU 9900-EXIT
 11919              END-IF
 11920           END-IF
 11921        END-IF
 11922        IF WS-ERROR = ER-2669
 11923           PERFORM 9900-ERROR-FORMAT
 11924                                 THRU 9900-EXIT
 11925        END-IF
 11926     END-IF
 11927     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11928        (PB-I-AH-TERM NOT = ZERO) AND
 11929         NOT NO-AH-COVERAGE
 11930          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11931             AND (PB-COMPANY-ID = 'DCC')
 11932             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11933             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11934          ELSE
 11935             IF WS-LF-EARNINGS-CALC = '4'
 11936                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11937                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11938                PB-I-PAY-FREQUENCY
 11939             ELSE
 11940                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11941                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11942             END-IF
 11943          END-IF
 11944          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11945                                         DC-ODD-DAYS-OVER
 11946          MOVE 1                      TO DC-END-OF-MONTH
 11947          SET BIN-PLUS-ELAPSED        TO TRUE
 11948*         MOVE 6                      TO DC-OPTION-CODE
 11949          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11950          IF NO-CONVERSION-ERROR
 11951             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 219
* EL050.cbl
 11952     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11953        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11954        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11955        IF PB-I-BIRTHDAY > LOW-VALUES
 11956           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11957           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11958           SET ELAPSED-BETWEEN-BIN TO TRUE
 11959           PERFORM 8500-DATE-CONVERT
 11960                                 THRU 8500-EXIT
 11961           IF NO-CONVERSION-ERROR
 11962              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11963                 MOVE ER-3054       TO WS-ERROR
 11964*                PERFORM 9900-ERROR-FORMAT
 11965*                                THRU 9900-EXIT
 11966              END-IF
 11967           END-IF
 11968        ELSE
 11969           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11970           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11971              MOVE ER-3054       TO WS-ERROR
 11972*             PERFORM 9900-ERROR-FORMAT
 11973*                                THRU 9900-EXIT
 11974           END-IF
 11975        END-IF
 11976        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11977           AND ZEROS
 11978           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11979           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11980           SET ELAPSED-BETWEEN-BIN TO TRUE
 11981           PERFORM 8500-DATE-CONVERT
 11982                                 THRU 8500-EXIT
 11983           IF NO-CONVERSION-ERROR
 11984              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11985                 MOVE ER-3054       TO WS-ERROR
 11986*                PERFORM 9900-ERROR-FORMAT
 11987*                                THRU 9900-EXIT
 11988              END-IF
 11989           END-IF
 11990        ELSE
 11991           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11992             (PB-I-AH-TERM / 12)
 11993           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11994              MOVE ER-3054       TO WS-ERROR
 11995*             PERFORM 9900-ERROR-FORMAT
 11996*                                THRU 9900-EXIT
 11997           END-IF
 11998        END-IF
 11999        IF WS-ERROR = ER-3054
 12000           PERFORM 9900-ERROR-FORMAT
 12001                                 THRU 9900-EXIT
 12002        END-IF
 12003     END-IF
 12004     MOVE SPACE                       TO DC-END-OF-MONTH.
 12005
 12006     IF PB-COMPANY-ID = 'NCB'
 12007        GO TO 3040-EDIT-EXTENSION-DAYS.
 12008
 12009     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 220
* EL050.cbl
 12010       AND
 12011        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12012        NEXT SENTENCE
 12013     ELSE
 12014        GO TO 3040-EDIT-EXTENSION-DAYS.
 12015
 12016     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12017        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12018        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12019     ELSE
 12020        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12021        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12022
 12023     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12024*    MOVE '1'      TO DC-OPTION-CODE
 12025     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12026     IF (NO-CONVERSION-ERROR)
 12027        AND (DC-ELAPSED-MONTHS > +1)
 12028        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12029        MOVE ER-2668   TO WS-ERROR
 12030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12031
 12032 3040-EDIT-EXTENSION-DAYS.
 12033
 12034     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12035        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12036         GO TO 3050-EDIT-TERM-IN-DAYS
 12037     ELSE
 12038         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12039
 12040     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12041         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12042     ELSE
 12043        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12044           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12045           MOVE ER-2681         TO WS-ERROR
 12046           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12047
 12048     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12049        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12050        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12051         GO TO 3060-ORIG-TERM-CHECK.
 12052
 12053     GO TO 3060-ORIG-TERM-CHECK.
 12054
 12055 3050-EDIT-TERM-IN-DAYS.
 12056
 12057     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12058
 12059     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12060         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12061     ELSE
 12062         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12063            MOVE ER-2682         TO WS-ERROR
 12064            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12065
 12066     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12067                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 221
* EL050.cbl
 12068     IF WS-WORK-TERM GREATER THAN ZERO
 12069         ADD +1 TO PB-I-LF-TERM.
 12070
 12071     IF NOT NO-AH-COVERAGE
 12072         MOVE ER-2684            TO WS-ERROR
 12073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12074
 12075
 12076 3060-ORIG-TERM-CHECK.
 12077
 12078******************************************************************
 12079*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12080******************************************************************
 12081
 12082     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12083        NEXT SENTENCE
 12084     ELSE
 12085        IF NOT NO-LIFE-COVERAGE
 12086           IF PB-I-LF-TERM NUMERIC
 12087              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12088              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12089              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12090                  NEXT SENTENCE
 12091           ELSE
 12092              MOVE ER-2647       TO WS-ERROR
 12093              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12094
 12095     IF NOT NO-AH-COVERAGE
 12096         IF PB-I-AH-TERM NUMERIC
 12097            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12098            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12099            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12100             NEXT SENTENCE
 12101          ELSE
 12102              MOVE ER-2658       TO WS-ERROR
 12103              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12104
 12105     IF PB-COMPANY-ID = 'NCB'
 12106        GO TO 3070-LOAN-TERM-CHECK.
 12107
 12108     IF POLICY-HAS-AH
 12109       AND
 12110        POLICY-HAS-LIFE
 12111       AND
 12112        PB-I-LF-TERM NUMERIC
 12113       AND
 12114        PB-I-AH-TERM NUMERIC
 12115        NEXT SENTENCE
 12116     ELSE
 12117        GO TO 3070-LOAN-TERM-CHECK.
 12118
 12119     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12120     IF WS-TEX-FACT-2 LESS THAN +0
 12121        MULTIPLY +1 BY WS-TEX-FACT-2.
 12122
 12123     IF WS-TEX-FACT-2 GREATER THAN +1
 12124        MOVE ER-2668             TO WS-ERROR
 12125        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 222
* EL050.cbl
 12126
 12127 3070-LOAN-TERM-CHECK.
 12128
 12129     IF (WS-LF-BENEFIT-CD = ZERO)
 12130         OR (NO-LF-BENEFIT-MATCH)
 12131            GO TO 3125-EDIT-PMT-FREQ.
 12132     IF PB-COMPANY-ID NOT = 'DCC'
 12133        IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12134           AND 'V' AND 'W' AND 'X'
 12135           GO TO 3125-EDIT-PMT-FREQ
 12136        END-IF
 12137     ELSE
 12138        IF WS-AH-DCC-TRUNC = 'T'
 12139           CONTINUE
 12140        ELSE
 12141           GO TO 3125-EDIT-PMT-FREQ
 12142        END-IF
 12143     END-IF
 12144     IF PB-I-LOAN-TERM NOT NUMERIC
 12145         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12146
 12147     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12148        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12149        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12150        PB-I-LOAN-TERM NOT GREATER THAN +360
 12151         NEXT SENTENCE
 12152     ELSE
 12153         MOVE ER-2648            TO WS-ERROR
 12154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12155
 12156     IF WS-STATE-ABBREVIATION = 'NC'
 12157        IF PB-I-LOAN-TERM > +59
 12158           CONTINUE
 12159        ELSE
 12160           MOVE ER-2792          TO WS-ERROR
 12161           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12162        END-IF
 12163     END-IF
 12164
 12165     .
 12166 3125-EDIT-PMT-FREQ.
 12167     IF (WS-LF-BENEFIT-CD = ZERO)
 12168         OR (NO-LF-BENEFIT-MATCH)
 12169            GO TO 3127-EDIT-LOAN-OFFICER.
 12170     IF WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 12171         OR 'E'
 12172        CONTINUE
 12173     ELSE
 12174        IF (PB-I-LOAN-TERM > ZEROS)
 12175           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12176           MOVE ER-1575          TO WS-ERROR
 12177           PERFORM 9900-ERROR-FORMAT
 12178                                 THRU 9900-EXIT
 12179        END-IF
 12180     END-IF
 12181     IF PB-COMPANY-ID = 'DCC'
 12182        IF WS-AH-DCC-TRUNC = 'T'
 12183           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 223
* EL050.cbl
 12184        ELSE
 12185           IF (PB-I-LOAN-TERM > ZEROS)
 12186              AND (PB-I-LOAN-TERM NOT = PB-I-AH-TERM)
 12187              MOVE ER-1575       TO WS-ERROR
 12188              PERFORM 9900-ERROR-FORMAT
 12189                                 THRU 9900-EXIT
 12190           END-IF
 12191        END-IF
 12192     END-IF
 12193     IF WS-LF-EARNINGS-CALC NOT = '4'
 12194         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12195            MOVE ER-2653         TO WS-ERROR
 12196            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12197            GO TO 3127-EDIT-LOAN-OFFICER
 12198         ELSE
 12199            GO TO 3127-EDIT-LOAN-OFFICER.
 12200
 12201     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12202         MOVE ER-2655            TO WS-ERROR
 12203         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12204         GO TO 3127-EDIT-LOAN-OFFICER.
 12205
 12206     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12207         MOVE ER-2654            TO WS-ERROR
 12208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12209         GO TO 3127-EDIT-LOAN-OFFICER.
 12210
 12211     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12212         GIVING WS-TEX-FACT-2
 12213             REMAINDER WS-TEX-FACT-3.
 12214
 12215*    IF WS-TEX-FACT-3 NOT = ZERO
 12216*       MOVE ER-2654             TO WS-ERROR
 12217*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12218
 12219
 12220 3127-EDIT-LOAN-OFFICER.
 12221
 12222     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12223        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12224           MOVE ER-2690          TO WS-ERROR
 12225           PERFORM 9900-ERROR-FORMAT
 12226                                 THRU 9900-EXIT
 12227        ELSE
 12228           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12229           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12230           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12231           MOVE PB-SV-STATE      TO LOFC-STATE
 12232           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12233           MOVE PB-I-LOAN-OFFICER
 12234                                 TO LOFC-CODE
 12235           PERFORM 8586-READ-LOAN-OFFICER
 12236                                 THRU 8586-EXIT
 12237           IF (NOT LOFC-MASTER-FOUND)
 12238              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12239              MOVE ER-3006       TO WS-ERROR
 12240              PERFORM 9900-ERROR-FORMAT
 12241                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 224
* EL050.cbl
 12242           END-IF
 12243        END-IF
 12244     END-IF
 12245     .
 12246 3129-EDIT-APR.
 12247
 12248     IF (WS-LF-BENEFIT-CD = ZERO)
 12249        OR (NO-LF-BENEFIT-MATCH)
 12250        IF PB-COMPANY-ID NOT = 'DCC'
 12251           GO TO 3130-EDIT-AGE
 12252*       ELSE
 12253*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12254*             GO TO 3130-EDIT-AGE
 12255*          END-IF
 12256        END-IF
 12257     END-IF
 12258
 12259     IF (WS-STATE-ABBREVIATION = 'OH')
 12260         AND (PB-I-RATE-CLASS NOT = 'L ')
 12261         AND (PB-I-LF-TERM GREATER THAN 60)
 12262         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12263         GO TO 3129-APR-CONT.
 12264
 12265     IF (WS-STATE-ABBREVIATION = 'RI')
 12266         AND (PB-I-LF-TERM GREATER THAN 60)
 12267         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12268         GO TO 3129-APR-CONT.
 12269
 12270     IF (WS-STATE-ABBREVIATION = 'UT')
 12271         AND (PB-I-LF-TERM GREATER THAN 62)
 12272         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12273         AND (PB-CERT-EFF-DT LESS WS-830901)
 12274         GO TO 3129-APR-CONT.
 12275
 12276     IF PB-COMPANY-ID = 'LAP'
 12277        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12278           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12279              MOVE ER-2656         TO WS-ERROR
 12280              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12281              GO TO 3130-EDIT-AGE.
 12282
 12283     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12284        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12285        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12286        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12287         GO TO 3130-EDIT-AGE.
 12288
 12289 3129-APR-CONT.
 12290     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12291         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12292         GO TO 3130-EDIT-AGE.
 12293
 12294     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12295        AND (PB-COMPANY-ID = 'DCC')
 12296        AND (PB-I-LOAN-APR = ZERO)
 12297        MOVE ER-2657             TO WS-ERROR
 12298        PERFORM 9900-ERROR-FORMAT
 12299                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 225
* EL050.cbl
 12300        GO TO 3130-EDIT-AGE
 12301     END-IF
 12302     IF PB-I-LOAN-APR = ZERO
 12303        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12304     END-IF
 12305
 12306     IF PB-I-LOAN-APR = ZERO
 12307        MOVE ER-2656             TO WS-ERROR
 12308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12309        GO TO 3130-EDIT-AGE.
 12310
 12311*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12312     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12313        MOVE ER-2657             TO WS-ERROR
 12314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12315
 12316 3130-EDIT-AGE.
 12317
 12318******************************************************************
 12319*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12320******************************************************************
 12321
 12322     IF NOT NO-LIFE-COVERAGE
 12323        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12324           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12325               MOVE ER-2628             TO WS-ERROR
 12326               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12327
 12328     IF NOT NO-AH-COVERAGE
 12329        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12330           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12331               MOVE ER-2628         TO WS-ERROR
 12332               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12333
 12334 3133-SEX-CODE.
 12335     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12336         IF WS-DEFAULT-SEX = 'M'
 12337             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12338          ELSE
 12339             IF WS-DEFAULT-SEX = 'F'
 12340             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12341
 12342     IF PB-I-INSURED-SEX = '1'
 12343         MOVE 'M' TO PB-I-INSURED-SEX.
 12344
 12345     IF PB-I-INSURED-SEX = '2'
 12346         MOVE 'F' TO PB-I-INSURED-SEX.
 12347
 12348 3134-SIG-SW-EDIT.
 12349     IF PB-I-SIG-SW = SPACE
 12350         MOVE 'N'                TO  PB-I-SIG-SW.
 12351
 12352     IF PB-COMPANY-ID = 'NCL'
 12353         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12354             NEXT SENTENCE
 12355         ELSE
 12356             MOVE ER-1923        TO  WS-ERROR
 12357             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 226
* EL050.cbl
 12358     ELSE
 12359     IF PB-COMPANY-ID = 'CRI'
 12360         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12361             NEXT SENTENCE
 12362         ELSE
 12363             MOVE ER-2606        TO  WS-ERROR
 12364             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12365     ELSE
 12366     IF PB-COMPANY-ID = 'TMS'
 12367         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12368             NEXT SENTENCE
 12369         ELSE
 12370             MOVE ER-2689        TO  WS-ERROR
 12371             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12372     ELSE
 12373         IF PB-I-SIG-SW = 'Y' OR 'N'
 12374             NEXT SENTENCE
 12375         ELSE
 12376             MOVE ER-2651        TO  WS-ERROR
 12377             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12378
 12379     IF PB-COMPANY-ID = 'FLA'
 12380         IF (WS-EDIT-AGE GREATER 54  OR
 12381             WS-AH-EDIT-AGE GREATER 54)  AND
 12382            PB-I-SIG-SW = 'N'
 12383            MOVE ER-2651         TO  WS-ERROR
 12384            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12385
 12386 3135-NAME-EDIT.
 12387
 12388     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12389        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12390        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12391           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12392                                 TO PB-I-JOINT-FIRST-NAME
 12393        END-PERFORM
 12394     END-IF
 12395     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12396        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12397        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12398           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12399                                 TO PB-I-JOINT-LAST-NAME
 12400        END-PERFORM
 12401     END-IF
 12402     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12403        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12404        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12405           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12406                                 TO PB-I-INSURED-FIRST-NAME
 12407        END-PERFORM
 12408     END-IF
 12409     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12410        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12411        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12412           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12413                                 TO PB-I-INSURED-LAST-NAME
 12414        END-PERFORM
 12415     END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 227
* EL050.cbl
 12416     IF PB-I-INSURED-LAST-NAME = SPACES
 12417       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12418       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12419           MOVE ER-2660    TO WS-ERROR
 12420           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12421
 12422 3136-EDIT-SEX.
 12423
 12424******************************************************************
 12425*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12426******************************************************************
 12427
 12428     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12429        (WS-AH-SPECIAL-CALC-CD = 'O')
 12430        NEXT SENTENCE
 12431     ELSE
 12432        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12433           NEXT SENTENCE
 12434        ELSE
 12435           MOVE ER-2629            TO WS-ERROR
 12436           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12437
 12438 3137-EDIT-EFF-DATE.
 12439
 12440     IF PB-REISSUED-CERT       OR
 12441        PB-POLICY-IS-DECLINED  OR
 12442        PB-POLICY-IS-VOIDED
 12443         GO TO 3139-EDIT-COVERAGE-CODES.
 12444
 12445     MOVE SPACE                  TO WS-2671-SW
 12446                                    WS-2672-SW.
 12447
 12448     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12449         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12450             MOVE ER-2703        TO WS-ERROR
 12451             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12452             GO TO 3139-EDIT-COVERAGE-CODES.
 12453
 12454     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12455         GO TO 3139-EDIT-COVERAGE-CODES.
 12456
 12457     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12458     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12459*    MOVE '1'                    TO DC-OPTION-CODE.
 12460     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12461     MOVE +0                     TO DC-ELAPSED-MONTHS
 12462                                    DC-ELAPSED-DAYS.
 12463     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12464
 12465     IF DATE-CONVERSION-ERROR
 12466         GO TO 3139-EDIT-COVERAGE-CODES.
 12467
 12468     IF DC-ELAPSED-DAYS GREATER +180
 12469         MOVE ER-2672            TO WS-ERROR
 12470         MOVE 'Y'                TO WS-2672-SW
 12471         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12472     END-IF
 12473
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 228
* EL050.cbl
 12474     IF WS-ERROR = ER-2671  AND
 12475        PB-COMPANY-ID  = 'LBL'
 12476        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12477        MOVE SPACE               TO WS-2671-SW
 12478        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12479
 12480     IF PB-ISSUE-DATE-FORCED  AND
 12481      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12482         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12483         MOVE ER-2673            TO WS-ERROR
 12484         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12485         MOVE SPACE              TO WS-2671-SW
 12486                                    WS-2672-SW.
 12487
 12488     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12489         IF PB-ISSUE-DATE-FORCED
 12490             MOVE ER-2600          TO  WS-ERROR
 12491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12492         ELSE
 12493             MOVE ER-2692          TO  WS-ERROR
 12494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12495
 12496
 12497 3139-EDIT-COVERAGE-CODES.
 12498
 12499     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12500        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12501        MOVE ER-2787             TO WS-ERROR
 12502        PERFORM 9900-ERROR-FORMAT
 12503                                 THRU 9900-EXIT
 12504     END-IF
 12505     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12506        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12507                                 > 250000.00
 12508           MOVE ER-2719          TO WS-ERROR
 12509           PERFORM 9900-ERROR-FORMAT
 12510                                 THRU 9900-EXIT
 12511        END-IF
 12512     END-IF
 12513
 12514     IF PB-POLICY-IS-DECLINED  OR
 12515        PB-POLICY-IS-VOIDED
 12516         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12517
 12518     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12519        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12520         MOVE ER-2630                TO WS-ERROR
 12521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12522
 12523     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12524        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12525        PB-I-LF-PREMIUM-AMT = ZERO
 12526         GO TO 3140-CHECK-AH-FOR-ZERO.
 12527
 12528     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12529        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12530        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12531         GO TO 3140-CHECK-AH-FOR-ZERO.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 229
* EL050.cbl
 12532
 12533     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12534        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12535        MOVE ER-2631             TO WS-ERROR
 12536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12537     END-IF
 12538
 12539
 12540******************************************************************
 12541*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12542******************************************************************
 12543
 12544     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12545        NEXT SENTENCE
 12546     ELSE
 12547        IF PB-I-LF-BENEFIT-AMT = ZERO
 12548           MOVE ER-2632             TO WS-ERROR
 12549           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12550
 12551
 12552******************************************************************
 12553*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12554******************************************************************
 12555
 12556     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12557        CONTINUE
 12558     ELSE
 12559        IF PB-I-LF-PREMIUM-AMT = ZERO
 12560           IF (NOT PB-COMP-LF-PREM)
 12561              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12562              MOVE ER-2633       TO WS-ERROR
 12563              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12564           END-IF
 12565        END-IF
 12566     END-IF
 12567     .
 12568 3140-CHECK-AH-FOR-ZERO.
 12569
 12570     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12571        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12572        PB-I-AH-PREMIUM-AMT = ZERO
 12573         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12574
 12575     IF PB-COMPANY-ID = 'CSL'  AND
 12576        PB-I-AH-BENEFIT-CD = ZERO  AND
 12577        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12578        PB-I-AH-PREMIUM-AMT = ZERO
 12579         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12580
 12581     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12582        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12583        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12584         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12585
 12586     IF PB-I-AH-BENEFIT-CD = ZERO
 12587         MOVE ER-2634            TO WS-ERROR
 12588         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12589
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 230
* EL050.cbl
 12590******************************************************************
 12591*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12592******************************************************************
 12593
 12594     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12595        NEXT SENTENCE
 12596     ELSE
 12597        IF PB-I-AH-BENEFIT-AMT = ZERO
 12598           MOVE ER-2635             TO WS-ERROR
 12599           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12600
 12601******************************************************************
 12602*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12603******************************************************************
 12604
 12605     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12606        NEXT SENTENCE
 12607     ELSE
 12608        IF PB-I-AH-PREMIUM-AMT = ZERO
 12609            IF NOT PB-COMP-AH-PREM
 12610                MOVE ER-2636    TO WS-ERROR
 12611                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12612
 12613
 12614 3140-EDIT-MAX-AMT-SIZES.
 12615* CUSTOM CODE FOR CLIENT    'DMD'
 12616     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12617                                     WS-RES-MUNI-TAX
 12618                                     PB-I-STATE-TAX
 12619                                     PB-I-MUNI-TAX.
 12620
 12621     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12622
 12623     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12624        GO TO 3150-RATE-OUTSTAND-BAL.
 12625
 12626     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12627        GO TO 3150-RATE-OUTSTAND-BAL.
 12628
 12629     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12630        GO TO 3150-RATE-OUTSTAND-BAL.
 12631
 12632     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12633                             OR 'RIC')
 12634        GO TO 3150-RATE-OUTSTAND-BAL.
 12635
 12636     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12637        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12638            GO TO 3150-RATE-OUTSTAND-BAL
 12639        ELSE
 12640           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12641               GO TO 3150-RATE-OUTSTAND-BAL.
 12642
 12643     IF NOT PB-NO-MONTHS-SKIPPED
 12644        GO TO 3150-RATE-OUTSTAND-BAL.
 12645
 12646     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12647        GO TO 3150-RATE-OUTSTAND-BAL.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 231
* EL050.cbl
 12648
 12649     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12650        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12651           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12652             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12653           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12654           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12655              MOVE ER-2693     TO WS-ERROR
 12656              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12657              GO TO 3150-RATE-OUTSTAND-BAL
 12658           ELSE
 12659              GO TO 3150-RATE-OUTSTAND-BAL.
 12660
 12661 3150-RATE-OUTSTAND-BAL.
 12662
 12663* DMD RATING TEST
 12664     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12665         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12666         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12667         MOVE ER-2687                 TO WS-ERROR
 12668         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12669         MOVE 'B'                     TO PB-I-OB-FLAG
 12670         GO TO 3260-EDIT-CONTINUE.
 12671
 12672     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12673         IF  WS-ERROR    EQUAL    ER-2693
 12674             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12675                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12676                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12677                 MOVE  +0            TO  WS-ERROR.
 12678
 12679     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12680         IF  WS-ERROR    EQUAL    ER-2693
 12681             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12682                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12683                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12684                 MOVE  +0            TO  WS-ERROR.
 12685
 12686     IF PLAN-MASTER-AH-SW = 'Y'
 12687        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12688            IF  WS-ERROR    EQUAL    ER-2693
 12689              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12690                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12691                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12692                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12693                 MOVE  ER-1910           TO  WS-ERROR
 12694                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12695
 12696     IF PLAN-MASTER-AH-SW = 'Y'
 12697        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12698            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12699               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12700               MOVE  ER-1910           TO  WS-ERROR
 12701               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12702
 12703     IF PLAN-MASTER-AH-SW = 'Y'
 12704        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12705            IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 232
* EL050.cbl
 12706                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12707                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12708                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12709                 MOVE  +0       TO  WS-ERROR.
 12710
 12711     IF WS-ERROR = ER-2693
 12712        IF PB-COMPANY-ID = 'JAL' AND
 12713           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12714           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12715           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12716
 12717     IF WS-ERROR = ER-2693
 12718        IF PB-COMPANY-ID = 'NCL'  AND
 12719           PB-I-AH-BENEFIT-CD = 'OA'
 12720           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12721           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12722
 12723     IF WS-ERROR = ER-2693
 12724        IF PB-COMPANY-ID = 'CNL' AND
 12725           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12726           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12727           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12728
 12729     IF WS-ERROR = ER-2693
 12730        IF PB-COMPANY-ID = 'HER'
 12731           IF WS-LEVEL
 12732              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12733              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12734
 12735     IF ((LF-BENEFIT-FOUND) AND
 12736         (NOT NO-LIFE-COVERAGE)  AND
 12737         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12738       OR   ((AH-BENEFIT-FOUND) AND
 12739             (NOT NO-AH-COVERAGE)    AND
 12740             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12741         NEXT SENTENCE
 12742     ELSE
 12743         GO TO 3215-EDIT-RATES.
 12744
 12745     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12746        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12747           MOVE ER-2674          TO WS-ERROR
 12748           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12749           GO TO 3215-EDIT-RATES.
 12750
 12751     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12752        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12753           MOVE ER-2674          TO WS-ERROR
 12754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12755           GO TO 3215-EDIT-RATES.
 12756
 12757     MOVE 'B'                    TO PB-I-OB-FLAG.
 12758
 12759     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12760         NEXT SENTENCE
 12761     ELSE
 12762         IF NOT NO-LIFE-COVERAGE
 12763             IF WS-ACCT-LF-OB-RT = ZERO
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 233
* EL050.cbl
 12764                MOVE ER-2641    TO WS-ERROR
 12765                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12766
 12767     IF PB-COMPANY-ID = 'CRI'
 12768       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12769         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12770         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12771         IF WS-ERROR = ER-2675
 12772            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12773            MOVE ER-2687              TO WS-ERROR
 12774            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12775         ELSE
 12776            MOVE ER-2687              TO WS-ERROR
 12777            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12778
 12779
 12780     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12781         NEXT SENTENCE
 12782     ELSE
 12783         IF NOT NO-AH-COVERAGE
 12784             IF WS-ACCT-AH-OB-RT = ZERO
 12785                MOVE ER-2642    TO WS-ERROR
 12786                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12787
 12788     IF PB-COMPANY-ID = 'CRI'
 12789       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12790         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12791         IF WS-ERROR = ER-2676
 12792            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12793            MOVE ER-2687              TO WS-ERROR
 12794            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12795         ELSE
 12796            MOVE ER-2687              TO WS-ERROR
 12797            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12798
 12799     IF PB-COMPANY-ID NOT = 'GIC'
 12800         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12801            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12802     ELSE
 12803         IF PB-I-LF-PREM-CALC = ZEROS
 12804             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12805                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12806
 12807     IF PB-COMPANY-ID NOT = 'GIC'
 12808         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12809            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12810     ELSE
 12811         IF PB-I-AH-PREM-CALC = ZEROS
 12812             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12813                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12814
 12815     MOVE ZEROS TO PB-I-MORT-CODE.
 12816
 12817     GO TO 3260-EDIT-CONTINUE.
 12818
 12819
 12820 3215-EDIT-RATES.
 12821     IF ACCOUNT-MAST-FOUND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 234
* EL050.cbl
 12822         NEXT SENTENCE
 12823     ELSE
 12824         GO TO 3999-END-EDIT.
 12825
 12826 3220-CHECK-LF-RATES.
 12827
 12828     IF PB-COMPANY-ID = 'DCC'
 12829        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12830        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12831        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12832           AND (NOT WS-LF-CASH))
 12833                           OR
 12834           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12835           AND (NOT WS-AH-CASH)))
 12836                       AND
 12837           (PB-I-ENTRY-STATUS NOT = '5')
 12838           MOVE 'M'              TO PB-BATCH-ENTRY
 12839                                    PB-I-ENTRY-STATUS
 12840        END-IF
 12841     END-IF
 12842     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12843                                    PB-I-AH-PREM-CALC
 12844                                    PB-I-LF-ALT-PREM-CALC
 12845                                    PB-I-LF-ALT-RATE
 12846                                    PB-I-LF-REI-RATE
 12847                                    PB-I-LF-ALT-REI-RATE
 12848                                    PB-I-AH-REI-RATE
 12849                                    PB-I-TOT-FEES-CALC.
 12850
 12851     IF PB-COMPANY-ID EQUAL 'DMD'
 12852        NEXT SENTENCE
 12853     ELSE
 12854        MOVE ZEROS               TO PB-I-LF-RATE
 12855                                    PB-I-AH-RATE.
 12856
 12857     IF PB-I-TOT-FEES NOT NUMERIC
 12858        MOVE ZEROS               TO PB-I-TOT-FEES
 12859     END-IF
 12860     IF PB-I-LIVES NOT NUMERIC
 12861         MOVE ZERO               TO PB-I-LIVES.
 12862
 12863     IF PB-I-NUM-BILLED NOT NUMERIC
 12864         MOVE ZERO               TO PB-I-NUM-BILLED.
 12865
 12866     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12867        MOVE +0                  TO PB-I-LF-PREM-TAX
 12868     END-IF
 12869
 12870     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12871        MOVE +0                  TO PB-I-AH-PREM-TAX
 12872     END-IF
 12873
 12874     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12875        PB-I-PAY-FREQUENCY = ZEROS
 12876            MOVE 12 TO CP-PAY-FREQUENCY
 12877     ELSE
 12878            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12879
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 235
* EL050.cbl
 12880     IF PB-I-STATE-TAX NOT NUMERIC
 12881         MOVE ZEROS               TO PB-I-STATE-TAX.
 12882
 12883     IF PB-I-MUNI-TAX NOT NUMERIC
 12884         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12885
 12886     MOVE SPACES                 TO CP-BEN-CATEGORY
 12887     IF PB-COMPANY-ID  = 'CSL'  AND
 12888        PB-I-LF-TERM NOT = ZERO
 12889        COMPUTE WS-PAYMENT-AMT =
 12890             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12891        COMPUTE WS-CSL-AMT1 =
 12892             PB-I-LF-TERM * AM-MAX-MON-BEN
 12893        COMPUTE WS-CSL-AMT2 =
 12894             WS-PAYMENT-AMT * PB-I-LF-TERM
 12895        IF CP-PAY-FREQUENCY NOT = 12
 12896           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12897           MOVE '8' TO WS-CSL-CALC-CD
 12898        ELSE
 12899           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 12900              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12901               AM-MAX-TOT-BEN
 12902               MOVE '6' TO WS-CSL-CALC-CD
 12903           ELSE
 12904              IF (WS-CSL-AMT1  GREATER THAN
 12905                 AM-MAX-TOT-BEN) AND
 12906                 (WS-CSL-AMT2  GREATER THAN
 12907                 AM-MAX-TOT-BEN)
 12908                 MOVE '7' TO WS-CSL-CALC-CD
 12909              ELSE
 12910                 MOVE '5' TO WS-CSL-CALC-CD.
 12911
 12912     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12913         NEXT SENTENCE
 12914     ELSE
 12915         GO TO 3300-CHECK-AH-RATES.
 12916
 12917*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12918
 12919     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12920        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12921              OR
 12922           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12923           MOVE ER-2618          TO WS-ERROR
 12924           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12925           GO TO 3300-CHECK-AH-RATES.
 12926
 12927     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12928           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12929                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12930
 12931     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12932         MOVE ER-2687             TO WS-ERROR
 12933         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12934         MOVE 'Z000'              TO PB-I-MORT-CODE
 12935         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12936         GO TO 3300-CHECK-AH-RATES.
 12937
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 236
* EL050.cbl
 12938     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12939        IF PB-I-LIVES = ZERO
 12940           MOVE ER-2688          TO WS-ERROR
 12941           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12942
 12943     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12944
 12945     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12946     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12947     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12948     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12949     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12950     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12951     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12952     MOVE '3'                    TO CP-PROCESS-TYPE.
 12953     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12954     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12955
 12956******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12957     IF PB-COMPANY-ID EQUAL 'CDL'
 12958         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12959            CP-EARN-AS-NET-PAY)
 12960             IF PB-CERT-EFF-DT GREATER  WS-931231
 12961                 MOVE '1'        TO CP-EARNING-METHOD.
 12962*******
 12963
 12964     MOVE PB-SV-STATE            TO CP-STATE.
 12965     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12966     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12967     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12968     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12969     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12970                                    CP-RATING-BENEFIT-AMT.
 12971     IF CP-STATE-STD-ABBRV = 'OR'
 12972         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12973                                         PB-I-LF-ALT-BENEFIT-AMT.
 12974     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12975     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12976     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12977     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12978     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12979     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12980     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12981     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12982     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12983                                    CP-REMAINING-TERM
 12984                                    CP-LOAN-TERM.
 12985
 12986     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 12987         NEXT SENTENCE
 12988     ELSE
 12989         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 12990             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12991                                           PB-I-LF-PREMIUM-AMT.
 12992
 12993     IF PB-COMPANY-ID EQUAL 'CSL'
 12994        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 12995           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 237
* EL050.cbl
 12996                                         PB-I-LF-PREMIUM-AMT.
 12997
 12998     IF PB-COMPANY-ID EQUAL 'NCB'
 12999         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13000            CP-EARN-AS-NET-PAY
 13001             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13002                 PB-I-LF-PREMIUM-AMT.
 13003
 13004     IF CP-TRUNCATED-LIFE
 13005        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13006
 13007     IF PB-COMPANY-ID EQUAL 'CRI'
 13008        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13009
 13010     IF CP-TERM-IS-DAYS
 13011         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13012     ELSE
 13013         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13014     IF PB-COMPANY-ID = 'DCC'
 13015        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13016        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13017        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13018        IF WS-LF-BEN-CATEGORY = 'D'
 13019           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13020           MOVE PB-I-LIFE-COMMISSION
 13021                                 TO CP-DCC-ACT-COMM
 13022           MOVE WS-LF-BEN-CATEGORY
 13023                                 TO CP-BEN-CATEGORY
 13024        END-IF
 13025        IF (CP-BENEFIT-CD (1:1) = 'P')
 13026           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13027           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13028        END-IF
 13029     END-IF
 13030     IF PB-COMPANY-ID = 'CSL'
 13031         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13032         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13033         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13034
 13035     IF PB-COMPANY-ID = 'CSL'
 13036        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13037
 13038     IF (CP-SPECIAL-CALC-CD = 'H')
 13039        OR (PB-COMPANY-ID = 'DCC')
 13040         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13041                                    TO CP-ALTERNATE-BENEFIT
 13042         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13043
 13044     IF (PB-COMPANY-ID = 'CID')
 13045        AND (WS-LF-EARNINGS-CALC = 'B')
 13046        AND (CP-STATE-STD-ABBRV = 'MN')
 13047        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13048                                 TO CP-ALTERNATE-BENEFIT
 13049        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13050     END-IF
 13051     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13052     MOVE 'R'                   TO CP-RATE-FILE.
 13053     PERFORM 7000-GET-RATE THRU 7000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 238
* EL050.cbl
 13054
 13055     IF CP-ERROR-RATE-NOT-FOUND
 13056        MOVE ER-2641            TO WS-ERROR
 13057        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13058        GO TO 3300-CHECK-AH-RATES.
 13059
 13060     IF PB-COMPANY-ID EQUAL 'CRI'
 13061        IF CP-ERROR-NO-LIMITS-CRI
 13062           IF NOT ACCOUNT-LIFE-CHECKED
 13063              MOVE ER-2607      TO WS-ERROR
 13064              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13065
 13066******************************************************************
 13067*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13068*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13069******************************************************************
 13070
 13071* CALC LIFE AGE AT EXPIRATION.
 13072
 13073     COMPUTE WS-AGE-AT-EXPIRE =
 13074          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13075
 13076*    IF PB-STATE = 'CO' OR 'UT'
 13077*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13078*        MOVE 'F'            TO PB-FATAL-FLAG
 13079*        MOVE ER-2709        TO WS-ERROR
 13080*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13081*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13082
 13083*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13084*        MOVE 'X'            TO PB-FATAL-FLAG
 13085*        MOVE ER-2718        TO WS-ERROR
 13086*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13087*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13088
 13089* CALC A & H AGE AT EXPIRATION.
 13090
 13091     COMPUTE WS-AGE-AT-EXPIRE =
 13092          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13093
 13094*    IF PB-STATE = 'CO' OR 'UT'
 13095*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13096*        MOVE 'F'            TO PB-FATAL-FLAG
 13097*        MOVE ER-2709        TO WS-ERROR
 13098*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13099*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13100
 13101*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13102*        MOVE 'X'            TO PB-FATAL-FLAG
 13103*        MOVE ER-2718        TO WS-ERROR
 13104*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13105*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13106
 13107     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13108        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13109
 13110     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13111        GO TO 3221-CHECK-ERROR-RATE-OPEN.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 239
* EL050.cbl
 13112
 13113     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13114        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13115
 13116     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13117         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13118         MOVE ER-2639        TO WS-ERROR
 13119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13120
 13121
 13122******************************************************************
 13123*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13124******************************************************************
 13125
 13126 PREMIUM-EDITING-IS-BYPASSED.
 13127     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13128        AND (CP-R-MAX-ATT-AGE > +0)
 13129        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13130        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13131           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13132           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13133           MOVE '1'              TO DC-OPTION-CODE
 13134           PERFORM 8500-DATE-CONVERT
 13135                                 THRU 8500-EXIT
 13136           IF NO-CONVERSION-ERROR
 13137              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13138                 MOVE ER-2661       TO WS-ERROR
 13139*                PERFORM 9900-ERROR-FORMAT
 13140*                                THRU 9900-EXIT
 13141              END-IF
 13142           END-IF
 13143        ELSE
 13144           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13145           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13146              MOVE ER-2661       TO WS-ERROR
 13147*             PERFORM 9900-ERROR-FORMAT
 13148*                                THRU 9900-EXIT
 13149           ELSE
 13150              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13151                 MOVE ER-1570    TO WS-ERROR
 13152                 PERFORM 9900-ERROR-FORMAT
 13153                                 THRU 9900-EXIT
 13154              END-IF
 13155           END-IF
 13156        END-IF
 13157        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13158           MOVE PB-I-JOINT-BIRTHDAY
 13159                                 TO DC-BIN-DATE-1
 13160           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13161           MOVE '1'              TO DC-OPTION-CODE
 13162           PERFORM 8500-DATE-CONVERT
 13163                                 THRU 8500-EXIT
 13164           IF NO-CONVERSION-ERROR
 13165              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13166                 MOVE ER-2661       TO WS-ERROR
 13167*                PERFORM 9900-ERROR-FORMAT
 13168*                                THRU 9900-EXIT
 13169              END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 240
* EL050.cbl
 13170           ELSE
 13171              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13172           END-IF
 13173        ELSE
 13174           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13175             (PB-I-LF-TERM / 12)
 13176           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13177              MOVE ER-2661       TO WS-ERROR
 13178*             PERFORM 9900-ERROR-FORMAT
 13179*                                THRU 9900-EXIT
 13180           ELSE
 13181              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13182                 MOVE ER-1571    TO WS-ERROR
 13183                 PERFORM 9900-ERROR-FORMAT
 13184                                 THRU 9900-EXIT
 13185              END-IF
 13186           END-IF
 13187        END-IF
 13188        IF WS-ERROR = ER-2661
 13189           PERFORM 9900-ERROR-FORMAT
 13190                                 THRU 9900-EXIT
 13191        END-IF
 13192     END-IF
 13193*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13194*       MOVE ER-2661             TO WS-ERROR
 13195*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13196
 13197     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13198        MOVE ER-2662             TO WS-ERROR
 13199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13200
 13201     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13202        MOVE ER-2677             TO WS-ERROR
 13203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13204
 13205     IF CP-ERROR-LOAN-TERM
 13206        MOVE ER-2648             TO WS-ERROR
 13207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13208
 13209 3221-CHECK-ERROR-RATE-OPEN.
 13210
 13211     IF CP-ERROR-RATE-FILE-NOTOPEN
 13212         GO TO 3990-FILES-NOT-OPEN.
 13213
 13214     IF PB-COMPANY-ID NOT = 'DMD'
 13215        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13216     END-IF
 13217     .
 13218 3221-CONTINUE.
 13219     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13220                                    WS-DCC-AH-RATE
 13221     IF PB-COMPANY-ID = 'DCC'
 13222        IF WS-LF-BEN-CATEGORY = 'D'
 13223           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13224              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13225        END-IF
 13226     END-IF
 13227     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 241
* EL050.cbl
 13228*   X'A4FF' = 12/31/2009
 13229     IF (PB-COMPANY-ID = 'CID')
 13230        AND (WS-LF-EARNINGS-CALC = 'B')
 13231        AND (CP-STATE-STD-ABBRV = 'MN')
 13232        AND (PB-CERT-EFF-DT > X'A4FF')
 13233        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13234     END-IF
 13235     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13236
 13237     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13238     IF (PB-COMPANY-ID = 'DCC')
 13239        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13240        AND (PB-I-POLICY-IS-MONTHLY)
 13241        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13242        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13243     END-IF
 13244     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13245     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13246     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13247     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13248     IF (PB-COMPANY-ID = 'DCC')
 13249        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13250        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13251        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13252        MOVE ER-2786             TO WS-ERROR
 13253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13254     END-IF
 13255
 13256     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13257
 13258******************************************************************
 13259*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13260******************************************************************
 13261     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13262        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13263
 13264     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13265        GO TO 3225-CHECK-ALT-LIFE-RATE
 13266     ELSE
 13267       IF PB-I-LF-RATE = ZERO
 13268          MOVE ER-2641          TO WS-ERROR
 13269          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13270
 13271 3225-CHECK-ALT-LIFE-RATE.
 13272
 13273     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13274        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13275        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13276         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13277
 13278     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13279         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13280             AND PB-COMPANY-ID NOT = 'DCC')
 13281                   OR
 13282              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13283              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13284              AND PB-COMPANY-ID NOT = 'DCC')
 13285             MOVE ER-2720        TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 242
* EL050.cbl
 13286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13287             GO TO 3225-RATING-CONT
 13288         ELSE
 13289             GO TO 3225-RATING-CONT.
 13290     IF (PB-COMPANY-ID = 'CID')
 13291        AND (AM-GPCD = 01 OR 06 OR 15)
 13292        MOVE ER-2798             TO WS-ERROR
 13293        PERFORM 9900-ERROR-FORMAT
 13294                                 THRU 9900-EXIT
 13295*       GO TO 3225-RATING-CONT
 13296     END-IF
 13297     IF (PB-COMPANY-ID = 'CID')
 13298        AND (WS-LF-EARNINGS-CALC = 'B')
 13299        AND (CP-STATE-STD-ABBRV = 'MN')
 13300        AND (PB-CERT-EFF-DT > X'A4FF')
 13301        GO TO 3225-RATING-CONT
 13302     END-IF
 13303     IF PB-COMPANY-ID = 'DCC'
 13304        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13305           AND (PB-I-POLICY-IS-MONTHLY)
 13306           GO TO 3225-RATING-CONT
 13307        END-IF
 13308     END-IF
 13309
 13310     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13311        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13312        CP-EARN-AS-REG-BALLOON
 13313        NEXT SENTENCE
 13314     ELSE
 13315        MOVE '2'                 TO CP-EARNING-METHOD.
 13316
 13317 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13318
 13319     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13320
 13321     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13322        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13323        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13324         NEXT SENTENCE
 13325     ELSE
 13326         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13327
 13328     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13329     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13330     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13331                                     CP-RATING-BENEFIT-AMT.
 13332     IF CP-STATE-STD-ABBRV = 'OR'
 13333         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13334                                         PB-I-LF-ALT-BENEFIT-AMT.
 13335     IF PB-COMPANY-ID = 'DCC'
 13336        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13337     END-IF
 13338     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13339     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13340     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13341                                    CP-REMAINING-TERM
 13342                                    CP-LOAN-TERM.
 13343     IF WS-LF-SPECIAL-CALC-CD = 'L'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 243
* EL050.cbl
 13344        ADD +1                   TO CP-ORIGINAL-TERM
 13345                                    CP-REMAINING-TERM
 13346                                    CP-LOAN-TERM.
 13347
 13348     MOVE 'R'                   TO CP-RATE-FILE.
 13349     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13350
 13351     IF CP-ERROR-RATE-NOT-FOUND
 13352         MOVE ER-2641            TO WS-ERROR
 13353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13354         GO TO 3300-CHECK-AH-RATES.
 13355
 13356     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13357     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13358
 13359     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13360         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13361
 13362     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13363                               + PB-I-LF-ALT-BENEFIT-AMT.
 13364
 13365     IF ACCOUNT-LIFE-CHECKED  OR
 13366        PB-POLICY-IS-VOIDED   OR
 13367        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13368        GO TO 3225-CONTINUE.
 13369
 13370     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13371        GO TO 3225-CONTINUE.
 13372
 13373     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13374                             EC-RT-LF-MAX-TOT-BEN
 13375        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13376        MOVE ER-2639       TO WS-ERROR
 13377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13378
 13379 3225-CONTINUE.
 13380     IF PB-I-LF-ALT-RATE = ZERO
 13381         MOVE ER-2659            TO WS-ERROR
 13382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13383
 13384     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13385        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13386        MOVE ER-2698             TO WS-ERROR
 13387        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13388
 13389 3225-RATING-CONT.
 13390
 13391     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13392         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13393         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13394         MOVE ER-2687             TO WS-ERROR
 13395         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13396         GO TO 3290-EDIT-LF-REIN-RATE.
 13397
 13398* DMD RATING TEST
 13399     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13400         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13401         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 244
* EL050.cbl
 13402         MOVE ER-2687                 TO WS-ERROR
 13403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13404         GO TO 3290-EDIT-LF-REIN-RATE.
 13405
 13406 3230-CLIENT-MORT-CD-SPECIALS.
 13407
 13408     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13409     SET BIN-TO-GREG          TO TRUE.
 13410*    MOVE ' '                 TO DC-OPTION-CODE.
 13411     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13412     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13413
 13414 C-POS-3230-MORT-CD.
 13415     IF PB-COMPANY-ID = 'POS' AND
 13416        PB-SV-CARRIER = '2'
 13417         NEXT SENTENCE
 13418     ELSE
 13419         GO TO C-POS-3240-MORT-CD.
 13420
 13421     IF PB-SV-GROUPING = '030'
 13422        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13423         MOVE '2350' TO PB-I-MORT-CODE
 13424      ELSE
 13425         MOVE '3300' TO PB-I-MORT-CODE.
 13426
 13427
 13428 C-POS-3240-MORT-CD.
 13429     IF PB-COMPANY-ID = 'POS' AND
 13430        PB-SV-CARRIER = '1'
 13431         NEXT SENTENCE
 13432     ELSE
 13433         GO TO 3230-CONTINUE.
 13434
 13435     IF PB-SV-STATE = '45' OR '47'
 13436        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13437         MOVE '5200' TO PB-I-MORT-CODE
 13438     ELSE
 13439         MOVE '8300' TO PB-I-MORT-CODE.
 13440
 13441 3230-CONTINUE.
 13442
 13443     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13444        GO TO 3240-CONTINUE
 13445     END-IF
 13446
 13447     IF PB-CERT-EFF-DT > WS-971231
 13448        GO TO 3240-CONTINUE
 13449     END-IF
 13450
 13451     IF LF-BENEFIT-FOUND AND
 13452        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13453         MOVE 'F250'       TO PB-I-MORT-CODE
 13454     ELSE
 13455         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13456             MOVE '7250'   TO PB-I-MORT-CODE
 13457         ELSE
 13458             MOVE '4251'   TO PB-I-MORT-CODE
 13459         END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 245
* EL050.cbl
 13460     END-IF
 13461
 13462     .
 13463 3240-CONTINUE.
 13464
 13465     IF PB-COMPANY-ID NOT = 'GNL'
 13466         GO TO 3256-CONTINUE.
 13467
 13468     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13469         MOVE 'A300' TO PB-I-MORT-CODE
 13470     ELSE
 13471         MOVE '8350' TO PB-I-MORT-CODE.
 13472
 13473 3256-CONTINUE.
 13474     IF PB-COMPANY-ID NOT = 'ABL'
 13475         GO TO 3260-EDIT-CONTINUE.
 13476
 13477     IF PB-I-LF-TERM GREATER THAN 59
 13478         MOVE 'F550' TO PB-I-MORT-CODE
 13479     ELSE
 13480         MOVE 'E550' TO PB-I-MORT-CODE.
 13481
 13482 3260-EDIT-CONTINUE.
 13483     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13484
 13485 3290-EDIT-LF-REIN-RATE.
 13486     IF LF-REIN-NSP-NOT-USED
 13487         GO TO 3290-RATING-CONT.
 13488
 13489     IF PB-COMPANY-ID = 'DCC'
 13490        GO TO 3290-RATING-CONT.
 13491     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13492     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13493     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13494     MOVE '3'                   TO CP-PROCESS-TYPE.
 13495     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13496
 13497******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13498     IF PB-COMPANY-ID EQUAL 'CDL'
 13499         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13500            CP-EARN-AS-NET-PAY)
 13501             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13502*            MOVE SPACE          TO DC-OPTION-CODE
 13503             SET BIN-TO-GREG     TO TRUE
 13504             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13505***  Y2K PROJ 7744
 13506             IF DC-GREG-DATE-CYMD GREATER 19931231
 13507                 MOVE '1'        TO CP-EARNING-METHOD.
 13508***  Y2K PROJ 7744
 13509*******
 13510
 13511     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13512     MOVE PB-SV-STATE           TO CP-STATE.
 13513     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13514     MOVE ZERO                  TO CP-DEVIATION-CODE
 13515                                   CP-RATE-DEV-PCT.
 13516     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13517     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 246
* EL050.cbl
 13518                                   CP-RATING-BENEFIT-AMT.
 13519
 13520************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13521     IF PB-COMPANY-ID EQUAL 'NCB'
 13522         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13523            CP-EARN-AS-NET-PAY
 13524             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13525                 PB-I-LF-PREMIUM-AMT.
 13526************
 13527
 13528     IF CP-STATE-STD-ABBRV = 'OR'
 13529         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13530                                         PB-I-LF-ALT-BENEFIT-AMT.
 13531     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13532     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13533     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13534     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13535     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13536     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13537     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13538     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13539                                   CP-REMAINING-TERM
 13540                                   CP-LOAN-TERM.
 13541     IF CP-TRUNCATED-LIFE
 13542        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13543
 13544     IF CP-TERM-IS-DAYS
 13545         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13546     ELSE
 13547         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13548
 13549     IF PB-COMPANY-ID = 'DCC'
 13550        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13551     END-IF
 13552     IF PB-COMPANY-ID NOT = 'TIC'
 13553          MOVE ZERO          TO CP-CLASS-CODE.
 13554
 13555     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13556
 13557     MOVE 'R'                   TO CP-RATE-FILE.
 13558     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13559
 13560     IF CP-ERROR-RATE-NOT-FOUND
 13561        IF PB-I-OB
 13562           MOVE ER-2625      TO WS-ERROR
 13563           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13564           GO TO 3299-EDIT-CONTINUE
 13565        ELSE
 13566           MOVE ER-2643      TO WS-ERROR
 13567           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13568           GO TO 3299-EDIT-CONTINUE.
 13569
 13570     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13571
 13572     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13573     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13574
 13575     IF PB-I-LF-REI-RATE = ZERO
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 247
* EL050.cbl
 13576         MOVE ER-2643        TO WS-ERROR
 13577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13578
 13579 3290-CHECK-ALT-REIN-RATE.
 13580
 13581     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13582        GO TO 3290-RATING-CONT.
 13583
 13584     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13585     MOVE '2'                    TO CP-EARNING-METHOD.
 13586     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13587     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13588     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13589     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13590                                     CP-RATING-BENEFIT-AMT.
 13591     IF CP-STATE-STD-ABBRV = 'OR'
 13592         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13593                                         PB-I-LF-ALT-BENEFIT-AMT.
 13594     IF PB-COMPANY-ID = 'DCC'
 13595        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13596     END-IF
 13597     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13598     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13599     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13600                                    CP-REMAINING-TERM
 13601                                    CP-LOAN-TERM.
 13602     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13603        ADD +1                   TO CP-ORIGINAL-TERM
 13604                                    CP-REMAINING-TERM
 13605                                    CP-LOAN-TERM.
 13606
 13607     MOVE 'R'                   TO CP-RATE-FILE.
 13608     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13609
 13610     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13611
 13612     IF PB-I-LF-ALT-REI-RATE = ZERO
 13613         MOVE ER-2643            TO WS-ERROR
 13614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13615
 13616 3290-RATING-CONT.
 13617
 13618     IF PB-I-OB
 13619*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13620        GO TO 3300-CHECK-AH-RATES.
 13621
 13622 3299-EDIT-CONTINUE.
 13623
 13624     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13625         NEXT SENTENCE
 13626     ELSE
 13627         MOVE ER-2620           TO WS-ERROR
 13628         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13629
 13630 3300-CHECK-AH-RATES.
 13631     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13632         NEXT SENTENCE
 13633     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 248
* EL050.cbl
 13634         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13635
 13636     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13637        ((CF-COMPANY-ID = 'DMD') AND
 13638                (NO-DMD-RATING))
 13639         MOVE ER-2687             TO WS-ERROR
 13640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13641         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13642         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13643
 13644     IF PB-I-OB
 13645        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13646
 13647     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13648         MOVE ER-2687             TO WS-ERROR
 13649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13650         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13651         GO TO 3999-END-EDIT.
 13652
 13653*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13654
 13655     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13656        IF PB-I-AH-CRIT-PER = ZERO
 13657           IF PB-COMPANY-ID = 'DCC'
 13658              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13659              CONTINUE
 13660           ELSE
 13661              MOVE ER-2618       TO WS-ERROR
 13662              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13663              GO TO 3999-END-EDIT
 13664           END-IF
 13665        END-IF
 13666     END-IF
 13667     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13668     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13669     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13670     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13671     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13672     MOVE PB-SV-STATE            TO CP-STATE.
 13673     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13674     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13675     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13676*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13677     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13678     MOVE '3'                    TO CP-PROCESS-TYPE.
 13679     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13680     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13681                                    CP-RATING-BENEFIT-AMT.
 13682     IF PB-COMPANY-ID = 'CID'
 13683               OR
 13684        CP-STATE-STD-ABBRV = 'OR'
 13685         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13686                                         PB-I-AH-TERM.
 13687     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13688        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13689           AND (PB-I-POLICY-IS-MONTHLY)
 13690           MOVE PB-I-LF-BENEFIT-AMT
 13691                                 TO CP-NET-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 249
* EL050.cbl
 13692           move pb-i-ah-premium-amt to cp-original-premium
 13693        END-IF
 13694     END-IF
 13695     MOVE SPACES                 TO CP-BEN-CATEGORY
 13696     IF PB-COMPANY-ID = 'DCC'
 13697        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13698        EVALUATE TRUE
 13699           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13700              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13701              MOVE PB-I-LF-BENEFIT-AMT
 13702                                 TO CP-RATING-BENEFIT-AMT
 13703              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13704           WHEN WS-AH-BEN-CATEGORY = 'G'
 13705              MOVE PB-I-UNPAID-CASH-PRICE
 13706                                 TO CP-RATING-BENEFIT-AMT
 13707           WHEN WS-AH-BEN-CATEGORY = 'D'
 13708              MOVE WS-AH-PMF-COMM
 13709                                 TO CP-DCC-PMF-COMM
 13710              MOVE PB-I-AH-COMMISSION
 13711                                 TO CP-DCC-ACT-COMM
 13712        END-EVALUATE
 13713     END-IF
 13714     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13715     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13716     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13717     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13718     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13719     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13720     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13721                                    CP-REMAINING-TERM
 13722                                    WS-WORK-TERM.
 13723     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13724
 13725     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13726     SET BIN-TO-GREG             TO TRUE.
 13727*    MOVE ' '                    TO DC-OPTION-CODE.
 13728     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13729     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13730
 13731     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13732     IF NOT VALID-SKIP-CODE
 13733         MOVE ER-2683            TO WS-ERROR
 13734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13735         GO TO 3320-RATE-CONTINUE.
 13736
 13737     IF PB-NO-MONTHS-SKIPPED
 13738         GO TO 3320-RATE-CONTINUE.
 13739
 13740     MOVE SPACE TO NUMBER-OF-MONTHS.
 13741
 13742     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13743         MOVE 'S'                TO SK-MO (6).
 13744     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13745         MOVE 'S'                TO SK-MO (7).
 13746     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13747         MOVE 'S'                TO SK-MO (8).
 13748     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13749         MOVE 'S'                TO SK-MO (9).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 250
* EL050.cbl
 13750     IF PB-I-SKIP-CODE = 'A'
 13751         MOVE 'S'                TO SK-MO (10).
 13752
 13753     MOVE 1                      TO SUB2.
 13754     MOVE PB-I-AH-TERM           TO SUB3.
 13755     MOVE WS-MONTH               TO SUB1.
 13756     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13757     GO TO 3320-RATE-CONTINUE.
 13758
 13759 3310-GET-SKIP-MO.
 13760     IF SUB1 = 13
 13761         MOVE 1                  TO SUB1.
 13762
 13763     IF SK-MO (SUB1) = 'S'
 13764         SUBTRACT 1 FROM WS-WORK-TERM.
 13765
 13766     ADD 1 TO SUB2
 13767              SUB1.
 13768
 13769 3320-RATE-CONTINUE.
 13770
 13771     IF WS-WORK-TERM = ZERO
 13772         MOVE 1                  TO WS-WORK-TERM.
 13773
 13774     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13775                                    CP-LOAN-TERM.
 13776
 13777     IF PB-COMPANY-ID EQUAL 'DMD'
 13778         NEXT SENTENCE
 13779     ELSE
 13780         MOVE ZERO               TO PB-I-AH-RATE
 13781                                    PB-I-AH-REI-RATE.
 13782
 13783
 13784     IF PB-COMPANY-ID EQUAL 'CRI'
 13785        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13786
 13787     IF PB-COMPANY-ID = 'CSL'
 13788         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13789         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13790         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13791         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13792
 13793     IF PB-COMPANY-ID = 'DCC'
 13794        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13795           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13796              PB-I-RATE-DEV-PCT-LF
 13797        END-IF
 13798        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13799                                 TO CP-ALTERNATE-BENEFIT
 13800        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13801        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13802        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13803     END-IF
 13804     IF (PB-COMPANY-ID = 'CID')
 13805        AND (WS-LF-EARNINGS-CALC = 'B')
 13806        AND (CP-STATE-STD-ABBRV = 'MN')
 13807        MOVE 'Y'                 TO CP-AH-BALLOON-SW
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 251
* EL050.cbl
 13808     ELSE
 13809        MOVE ' '                 TO CP-AH-BALLOON-SW
 13810     END-IF
 13811     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13812     MOVE 'R'                   TO CP-RATE-FILE.
 13813     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13814
 13815     IF CP-ERROR-RATE-NOT-FOUND
 13816        IF PB-I-OB
 13817           MOVE ER-2624          TO WS-ERROR
 13818           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13819           GO TO 3340-CALCULATE-PREMIUM-AMT
 13820        ELSE
 13821           MOVE ER-2642          TO WS-ERROR
 13822           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13823           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13824
 13825     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13826        CP-ERROR-DIV-BY-ZERO
 13827           MOVE ER-3782          TO WS-ERROR
 13828           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13829
 13830     IF PB-COMPANY-ID EQUAL 'CRI'
 13831        IF CP-ERROR-NO-LIMITS-CRI
 13832           IF NOT ACCOUNT-AH-CHECKED
 13833              MOVE ER-2607          TO WS-ERROR
 13834              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13835
 13836     IF ACCOUNT-AH-CHECKED
 13837        NEXT SENTENCE
 13838     ELSE
 13839       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13840          MOVE ER-2640           TO WS-ERROR
 13841          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13842
 13843     IF PB-COMPANY-ID = 'CRI'
 13844         IF WS-ERROR = ER-2640
 13845             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13846     IF ACCOUNT-AH-CHECKED
 13847        CONTINUE
 13848     ELSE
 13849        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13850           AND (CP-R-MAX-ATT-AGE > +0)
 13851           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13852           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13853              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13854              MOVE PB-I-AH-EXPIRE-DT
 13855                                 TO DC-BIN-DATE-2
 13856              MOVE '1'           TO DC-OPTION-CODE
 13857              PERFORM 8500-DATE-CONVERT
 13858                                 THRU 8500-EXIT
 13859              IF NO-CONVERSION-ERROR
 13860                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13861                    MOVE ER-2661       TO WS-ERROR
 13862*                   PERFORM 9900-ERROR-FORMAT
 13863*                                THRU 9900-EXIT
 13864                 END-IF
 13865              END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 252
* EL050.cbl
 13866           ELSE
 13867              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13868              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13869                 MOVE ER-2661    TO WS-ERROR
 13870*                PERFORM 9900-ERROR-FORMAT
 13871*                                THRU 9900-EXIT
 13872              ELSE
 13873                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13874                    MOVE ER-1570 TO WS-ERROR
 13875                    PERFORM 9900-ERROR-FORMAT
 13876                                 THRU 9900-EXIT
 13877                 END-IF
 13878              END-IF
 13879           END-IF
 13880           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13881              MOVE PB-I-JOINT-BIRTHDAY
 13882                                    TO DC-BIN-DATE-1
 13883              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13884              MOVE '1'              TO DC-OPTION-CODE
 13885              PERFORM 8500-DATE-CONVERT
 13886                                    THRU 8500-EXIT
 13887              IF NO-CONVERSION-ERROR
 13888                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13889                    MOVE ER-2661       TO WS-ERROR
 13890*                   PERFORM 9900-ERROR-FORMAT
 13891*                                   THRU 9900-EXIT
 13892                 END-IF
 13893              END-IF
 13894           ELSE
 13895              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13896                (PB-I-AH-TERM / 12)
 13897              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13898                 MOVE ER-2661       TO WS-ERROR
 13899*                PERFORM 9900-ERROR-FORMAT
 13900*                                   THRU 9900-EXIT
 13901              ELSE
 13902                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13903                    MOVE ER-1571 TO WS-ERROR
 13904                    PERFORM 9900-ERROR-FORMAT
 13905                                 THRU 9900-EXIT
 13906                 END-IF
 13907              END-IF
 13908           END-IF
 13909           IF WS-ERROR = ER-2661
 13910              PERFORM 9900-ERROR-FORMAT
 13911                                    THRU 9900-EXIT
 13912           END-IF
 13913        END-IF
 13914     END-IF
 13915*    IF ACCOUNT-AH-CHECKED
 13916*       NEXT SENTENCE
 13917*    ELSE
 13918*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13919*          MOVE ER-2661          TO WS-ERROR
 13920*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13921
 13922     IF ACCOUNT-AH-CHECKED
 13923        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 253
* EL050.cbl
 13924     ELSE
 13925        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13926           MOVE ER-2663          TO WS-ERROR
 13927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13928
 13929     IF ACCOUNT-AH-CHECKED OR
 13930        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13931         PB-POLICY-IS-VOIDED
 13932        NEXT SENTENCE
 13933     ELSE
 13934        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13935           MOVE ER-2667            TO WS-ERROR
 13936           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13937
 13938     IF PB-COMPANY-ID = 'CRI'
 13939         IF WS-ERROR = ER-2667
 13940             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13941
 13942     IF ACCOUNT-AH-CHECKED
 13943        NEXT SENTENCE
 13944     ELSE
 13945        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13946           MOVE ER-2678            TO WS-ERROR
 13947           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13948
 13949     IF CP-ERROR-RATE-FILE-NOTOPEN
 13950         GO TO 3990-FILES-NOT-OPEN.
 13951
 13952 3321-CONTINUE.
 13953     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13954     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13955     IF (PB-COMPANY-ID = 'DCC')
 13956        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13957        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13958                                    PB-I-LF-ALT-PREM-CALC
 13959        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13960        IF WS-AH-BEN-CATEGORY = 'G'
 13961           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13962           + PB-I-ADDL-CLP)
 13963           * (1 + WS-TOL-CLP-PCT)
 13964*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13965        ELSE
 13966           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13967           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13968*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13969        END-IF
 13970        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13971                                 TO PB-I-AH-PREM-CALC
 13972        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13973           MOVE ER-8152          TO WS-ERROR
 13974           PERFORM 9900-ERROR-FORMAT
 13975                                 THRU 9900-EXIT
 13976        ELSE
 13977           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 13978                 PB-I-ADDL-CLP)
 13979              MOVE ER-8148       TO WS-ERROR
 13980              PERFORM 9900-ERROR-FORMAT
 13981                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 254
* EL050.cbl
 13982           END-IF
 13983        END-IF
 13984     END-IF
 13985     IF (PB-COMPANY-ID = 'DCC')
 13986        AND (PB-I-POLICY-IS-MONTHLY)
 13987        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13988        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 13989        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 13990           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 13991        END-IF
 13992     END-IF
 13993     IF (PB-COMPANY-ID = 'DCC')
 13994        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 13995        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13996        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 13997        MOVE ER-2786             TO WS-ERROR
 13998        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13999     END-IF
 14000     MOVE +0                     TO PB-I-AH-CLP
 14001     IF PB-COMPANY-ID = 'DCC'
 14002        IF WS-AH-BEN-CATEGORY = 'D'
 14003           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14004              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14005        ELSE
 14006           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14007              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14008           END-IF
 14009        END-IF
 14010     END-IF
 14011     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14012
 14013     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14014         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14015
 14016     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14017         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14018
 14019     IF PB-COMPANY-ID = 'CRI'
 14020         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14021            PB-I-PAYMENT-AMOUNT = ZERO
 14022             NEXT SENTENCE
 14023         ELSE
 14024             COMPUTE PB-I-AH-PREM-CALC =
 14025                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14026                 (CP-PREMIUM-RATE / 100)
 14027             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14028                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14029                                             PB-I-RATE-DEV-PCT-AH.
 14030
 14031     IF PB-I-AH-RATE  = ZERO
 14032         MOVE ER-2642            TO WS-ERROR
 14033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14034
 14035     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14036     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14037     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14038     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14039     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 255
* EL050.cbl
 14040     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14041
 14042     IF (PB-COMPANY-ID = 'DCC')
 14043        AND (WS-AH-BEN-CATEGORY = 'G')
 14044        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14045        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14046        IF CP-DEVIATION-CODE NOT = '000'
 14047           MOVE '000'            TO CP-DEVIATION-CODE
 14048           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14049           IF NO-CP-ERROR
 14050              COMPUTE PB-I-DDF-IU-RATE-UP =
 14051              PB-I-AH-CLP - CP-CALC-PREMIUM
 14052           ELSE
 14053              MOVE ER-3057        TO WS-ERROR
 14054              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14055           END-IF
 14056        END-IF
 14057     END-IF
 14058     .
 14059 3335-EDIT-AH-REIN-NSP-RATE.
 14060     IF AH-REIN-NSP-NOT-USED
 14061         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14062
 14063     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14064     IF PB-COMPANY-ID = 'DCC'
 14065         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14066     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14067     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14068     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14069     MOVE PB-SV-STATE            TO CP-STATE.
 14070     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14071     MOVE ZERO                   TO CP-DEVIATION-CODE
 14072                                    CP-RATE-DEV-PCT.
 14073*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14074     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14075     MOVE '3'                    TO CP-PROCESS-TYPE.
 14076     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14077     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14078                                    CP-RATING-BENEFIT-AMT.
 14079     IF CP-STATE-STD-ABBRV = 'OR'
 14080         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14081                                         PB-I-AH-TERM.
 14082     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14083     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14084     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14085     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14086     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14087     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14088                                    CP-REMAINING-TERM
 14089                                    WS-WORK-TERM.
 14090     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14091     IF PB-COMPANY-ID = 'DCC'
 14092        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14093     END-IF
 14094     IF  PB-COMPANY-ID = 'TIC'
 14095         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14096            MOVE ZERO TO CP-CLASS-CODE.
 14097
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 256
* EL050.cbl
 14098     IF PB-COMPANY-ID NOT = 'TIC'
 14099          MOVE ZERO          TO CP-CLASS-CODE.
 14100
 14101     MOVE ZERO               TO CP-DEVIATION-CODE.
 14102
 14103     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14104
 14105     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14106
 14107     MOVE 'R'                   TO CP-RATE-FILE.
 14108     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14109
 14110     IF CP-ERROR-RATE-NOT-FOUND
 14111         MOVE ER-2645        TO WS-ERROR
 14112         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14114
 14115     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14116
 14117     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14118     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14119
 14120     IF PB-I-AH-REI-RATE = ZERO
 14121         MOVE ER-2645        TO WS-ERROR
 14122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14123
 14124
 14125 3340-CALCULATE-PREMIUM-AMT.
 14126
 14127     IF PB-COMPANY-ID = 'NCL'
 14128         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14129             WS-AH-SPECIAL-CALC-CD = 'O')
 14130             GO TO 3999-END-EDIT.
 14131
 14132     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14133                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14134                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14135         NEXT SENTENCE
 14136     ELSE
 14137         IF WS-STATE-ABBREVIATION = 'CT'
 14138             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14139                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14140                 COMPUTE PB-I-LF-PREM-CALC =
 14141                                     PB-I-LF-PREM-CALC * .90
 14142                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14143                                     PB-I-LF-ALT-PREM-CALC * .90
 14144                 COMPUTE PB-I-AH-PREM-CALC =
 14145                                     PB-I-AH-PREM-CALC * .90.
 14146
 14147     IF PB-COMP-LF-PREM
 14148        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14149        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14150
 14151     IF PB-COMP-AH-PREM
 14152        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14153
 14154 3340-CHECK-DCC-TOT-FEES.
 14155     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 257
* EL050.cbl
 14156        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14157        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14158        AND (PB-I-POLICY-IS-MONTHLY)
 14159        CONTINUE
 14160     ELSE
 14161        GO TO 3340-EDIT-LF-AH-TOL
 14162     END-IF
 14163     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14164     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14165     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14166        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14167           PB-I-RATE-DEV-PCT-LF
 14168     END-IF
 14169     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14170        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14171           PB-I-RATE-DEV-PCT-AH
 14172     END-IF
 14173     MOVE 'N'                    TO CP-BEN-CATEGORY
 14174     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14175
 14176     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14177     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14178     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14179     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14180     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14181     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14182     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14183     MOVE '3'                    TO CP-PROCESS-TYPE.
 14184     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14185     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14186
 14187     MOVE PB-SV-STATE            TO CP-STATE.
 14188     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14189     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14190     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14191     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14192     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14193                                    CP-RATING-BENEFIT-AMT.
 14194     IF CP-STATE-STD-ABBRV = 'OR'
 14195         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14196                                         PB-I-LF-ALT-BENEFIT-AMT.
 14197     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14198     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14199     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14200     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14201     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14202     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14203     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14204     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14205     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14206                                    CP-REMAINING-TERM
 14207                                    CP-LOAN-TERM.
 14208
 14209     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14210         NEXT SENTENCE
 14211     ELSE
 14212         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14213             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 258
* EL050.cbl
 14214                                           PB-I-LF-PREMIUM-AMT.
 14215
 14216     IF CP-TRUNCATED-LIFE
 14217        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14218
 14219     IF CP-TERM-IS-DAYS
 14220         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14221     ELSE
 14222         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14223
 14224     IF PB-COMPANY-ID = 'DCC'
 14225        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14226     END-IF
 14227     IF CP-SPECIAL-CALC-CD = 'H'
 14228         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14229                                    TO CP-ALTERNATE-BENEFIT
 14230         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14231     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14232     MOVE 'R'                    TO CP-RATE-FILE
 14233     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14234     IF NOT CP-ERROR-RATE-NOT-FOUND
 14235        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14236        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14237           AND (CP-BENEFIT-CD (1:1) = 'S')
 14238           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14239                                    PB-I-LF-PREMIUM-AMT
 14240        END-IF
 14241     ELSE
 14242        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14243     END-IF
 14244     .
 14245 3340-EDIT-LF-AH-TOL.
 14246
 14247***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14248***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14249***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14250***
 14251     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14252         PB-I-AH-PREMIUM-AMT
 14253          GIVING WS-CALC-WORK.
 14254
 14255     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14256        AND WS-CALC-WORK NOT = ZERO
 14257         MOVE ER-2649            TO WS-ERROR
 14258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14259
 14260     SUBTRACT PB-I-LF-PREM-CALC
 14261             FROM PB-I-LF-PREMIUM-AMT
 14262                 GIVING WS-UNSIGN-WRK1.
 14263
 14264     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14265             FROM PB-I-LF-ALT-PREMIUM-AMT
 14266                 GIVING WS-UNSIGN-WRK4.
 14267
 14268     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14269                                + WS-UNSIGN-WRK4.
 14270
 14271     SUBTRACT PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 259
* EL050.cbl
 14272             FROM PB-I-AH-PREMIUM-AMT
 14273                 GIVING WS-UNSIGN-WRK2.
 14274
 14275******************************************************************
 14276*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14277******************************************************************
 14278
 14279     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14280         MOVE ZERO TO WS-UNSIGN-WRK1.
 14281
 14282     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14283         MOVE ZERO TO WS-UNSIGN-WRK2.
 14284
 14285     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14286             GIVING WS-UNSIGN-WRK3.
 14287
 14288 3342-CONTINUE.
 14289
 14290     IF (PB-I-LF-RATE = ZERO  AND
 14291         PB-I-AH-RATE = ZERO)
 14292         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14293            WS-AH-SPECIAL-CALC-CD = 'O'
 14294              NEXT SENTENCE
 14295         ELSE
 14296             GO TO 3345-EDIT-CONTINUE.
 14297
 14298     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14299         NEXT SENTENCE
 14300     ELSE
 14301     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14302        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14303           IF (PB-REISSUED-CERT         OR
 14304               PB-POLICY-IS-DECLINED    OR
 14305               PB-POLICY-IS-VOIDED)
 14306              NEXT SENTENCE
 14307           ELSE
 14308              IF WS-PREM-REJECT-SW = SPACE
 14309                 MOVE ER-2652    TO WS-ERROR
 14310                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14311                 GO TO 3344-CHECK-AH
 14312              ELSE
 14313                 MOVE ER-2650    TO WS-ERROR
 14314                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14315                 GO TO 3344-CHECK-AH.
 14316
 14317***
 14318***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14319***
 14320
 14321     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14322         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14323            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14324             (1 + WS-TOL-LF-PREM-PCT)
 14325         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14326            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14327             (1 - WS-TOL-LF-PREM-PCT)
 14328     ELSE
 14329         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 260
* EL050.cbl
 14330         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14331
 14332***
 14333***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14334***
 14335
 14336     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14337         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14338          WS-TOL-LF-PREM.
 14339
 14340     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14341         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14342          WS-TOL-LF-PREM.
 14343
 14344     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14345        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14346
 14347     IF (PB-REISSUED-CERT        OR
 14348         PB-POLICY-IS-DECLINED   OR
 14349         PB-POLICY-IS-VOIDED)
 14350        NEXT SENTENCE
 14351     ELSE
 14352     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14353           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14354       OR
 14355        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14356           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14357       AND
 14358        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14359           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14360         OR
 14361          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14362           LESS WS-TOL-LF-LOW-PREM-PCT))
 14363              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14364                  MOVE ER-2652   TO  WS-ERROR
 14365                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14366              ELSE
 14367                  MOVE ER-2650   TO  WS-ERROR
 14368                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14369
 14370*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14371*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14372*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14373*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14374
 14375     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14376        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14377                      OR
 14378           ((PB-COMPANY-ID = 'DCC')
 14379           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14380           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14381           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14382        END-IF
 14383     END-IF
 14384
 14385     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14386        IF WS-COMP-MAX-CAP GREATER THAN +0
 14387           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 261
* EL050.cbl
 14388              IF (PB-REISSUED-CERT         OR
 14389                  PB-POLICY-IS-DECLINED    OR
 14390                  PB-POLICY-IS-VOIDED)
 14391                 NEXT SENTENCE
 14392              ELSE
 14393                  MOVE ER-2646   TO  WS-ERROR
 14394                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14395
 14396 3344-CVL-TOLERANCE-CHECK.
 14397
 14398      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14399          GO TO 3344-CHECK-AH.
 14400
 14401      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14402          GO TO 3344-CHECK-AH.
 14403
 14404      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14405                                     WS-UNSIGN-WRK6.
 14406
 14407      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14408          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14409                                 + PB-I-LF-PREMIUM-AMT
 14410                                 - PB-I-LF-PREM-CALC.
 14411
 14412      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14413          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14414                                 + PB-I-LF-ALT-PREMIUM-AMT
 14415                                 - PB-I-LF-ALT-PREM-CALC.
 14416
 14417      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14418          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14419              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14420                 MOVE ER-2652    TO  WS-ERROR
 14421                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14422              ELSE
 14423                 MOVE ER-2650    TO  WS-ERROR
 14424                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14425
 14426      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14427          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14428              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14429                 MOVE ER-2652    TO  WS-ERROR
 14430                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14431              ELSE
 14432                 MOVE ER-2650    TO  WS-ERROR
 14433                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14434
 14435 3344-CHECK-AH.
 14436
 14437****************************************************************
 14438***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14439***
 14440
 14441     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14442         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14443             (1 + WS-TOL-AH-PREM-PCT)
 14444         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14445             (1 - WS-TOL-AH-PREM-PCT)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 262
* EL050.cbl
 14446     ELSE
 14447         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14448         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14449
 14450***
 14451***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14452***
 14453
 14454     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14455         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14456
 14457     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14458         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14459
 14460     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14461        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14462
 14463     IF (PB-REISSUED-CERT)
 14464        OR (PB-POLICY-IS-DECLINED)
 14465        OR (PB-POLICY-IS-VOIDED)
 14466        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14467        CONTINUE
 14468     ELSE
 14469        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14470            OR
 14471           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14472           AND
 14473           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14474           OR
 14475           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14476           IF WS-PREM-REJECT-SW = SPACE
 14477              MOVE ER-3052       TO WS-ERROR
 14478              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14479           ELSE
 14480              MOVE ER-3050       TO WS-ERROR
 14481              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14482           END-IF
 14483        END-IF
 14484     END-IF
 14485
 14486     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14487         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14488             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14489             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14490
 14491     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14492        IF WS-COMP-MAX-CAP GREATER THAN +0
 14493           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14494              IF (PB-REISSUED-CERT         OR
 14495                  PB-POLICY-IS-DECLINED    OR
 14496                  PB-POLICY-IS-VOIDED)
 14497                 NEXT SENTENCE
 14498              ELSE
 14499                  MOVE ER-2646   TO  WS-ERROR
 14500                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14501
 14502     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14503        (WS-COMP-MAX-CAP EQUAL +0)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 263
* EL050.cbl
 14504           GO TO 3345-EDIT-CONTINUE.
 14505
 14506     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14507        GREATER THAN WS-COMP-MAX-CAP
 14508           MOVE ER-2646          TO  WS-ERROR
 14509           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14510
 14511 3345-EDIT-CONTINUE.
 14512
 14513*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14514*       IF PB-ENTRY-BATCH   NUMERIC
 14515*          IF PB-ISSUE
 14516*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14517*          ELSE
 14518*              IF PB-CANCELLATION
 14519*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14520
 14521*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14522*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14523*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14524*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14525*        ELSE
 14526*            MOVE  ER-1909            TO  WS-ERROR
 14527*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14528
 14529     IF PB-I-POLICY-ACCEPTED
 14530        IF PB-POLICY-IS-DECLINED  OR
 14531           PB-REISSUED-CERT  OR
 14532           PB-REIN-ONLY-CERT  OR
 14533           PB-POLICY-IS-VOIDED
 14534            MOVE  ER-1891         TO  WS-ERROR
 14535            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14536        ELSE
 14537            MOVE SPACE            TO  PB-BATCH-ENTRY
 14538            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14539
 14540     IF PB-I-POLICY-DECLINED
 14541        IF PB-REISSUED-CERT  OR
 14542           PB-REIN-ONLY-CERT  OR
 14543           PB-POLICY-IS-VOIDED
 14544            MOVE  ER-1906         TO  WS-ERROR
 14545            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14546        ELSE
 14547            MOVE  'D'             TO  PB-BATCH-ENTRY
 14548                                      PB-I-ENTRY-STATUS.
 14549
 14550     IF PB-I-NEEDS-UNDERWRITING
 14551        IF PB-POLICY-IS-DECLINED OR
 14552           PB-REISSUED-CERT  OR
 14553           PB-REIN-ONLY-CERT  OR
 14554           PB-POLICY-IS-VOIDED
 14555            MOVE  ER-1907         TO  WS-ERROR
 14556            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14557        ELSE
 14558            MOVE 'U'              TO  PB-BATCH-ENTRY
 14559                                      PB-I-ENTRY-STATUS.
 14560
 14561     IF PB-NEEDS-UNDERWRITING
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 264
* EL050.cbl
 14562        MOVE  ER-1901             TO  WS-ERROR
 14563        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14564     IF PB-COMPANY-ID = 'DCC'
 14565        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14566        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14567        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14568           AND (NOT WS-LF-CASH))
 14569                           OR
 14570           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14571           AND (NOT WS-AH-CASH)))
 14572                       AND
 14573           (PB-I-ENTRY-STATUS NOT = '5')
 14574           MOVE 'M'              TO PB-BATCH-ENTRY
 14575                                    PB-I-ENTRY-STATUS
 14576        END-IF
 14577     END-IF
 14578     IF  PB-COMPANY-ID NOT = 'NCL'
 14579         GO TO 3999-END-EDIT.
 14580
 14581     IF PB-REISSUED-CERT  OR
 14582        PB-POLICY-IS-DECLINED  OR
 14583        PB-POLICY-IS-VOIDED  OR
 14584        PB-I-OB
 14585         GO TO 3999-END-EDIT.
 14586
 14587     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14588         MOVE  ER-2644            TO  WS-ERROR
 14589         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14590         GO TO 3999-END-EDIT.
 14591
 14592     MOVE 'N'                     TO  FORM-MASTER-SW.
 14593     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14594
 14595     IF NOT FORM-MASTER-FOUND
 14596         GO TO 3999-END-EDIT.
 14597
 14598     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14599                                      FORM-MASTER-AH-SW.
 14600
 14601     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14602         MOVE  +1                 TO SUB6
 14603         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14604
 14605     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14606         MOVE  +1                 TO SUB6
 14607         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14608
 14609     IF LF-FORM-MASTER-FOUND  OR
 14610        AH-FORM-MASTER-FOUND
 14611         GO TO 3360-CHECK-FORM-LIMITS
 14612     ELSE
 14613         GO TO 3999-END-EDIT.
 14614
 14615******************************************************************
 14616*                  3350-GET-ERFORM                               *
 14617*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14618*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14619******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 265
* EL050.cbl
 14620
 14621 3350-GET-ERFORM.
 14622
 14623     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14624         GO TO  3350-ERFORM-GETMAIN.
 14625
 14626     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14627     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14628     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14629     MOVE 'Y'                     TO FORM-MASTER-SW.
 14630
 14631     IF PB-CANCELLATION
 14632         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14633            PB-SV-STATE          EQUAL   FO-STATE       AND
 14634            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14635              GO TO 3350-EXIT
 14636         ELSE
 14637             NEXT SENTENCE
 14638     ELSE
 14639         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14640            PB-SV-STATE          EQUAL   FO-STATE       AND
 14641            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14642              GO TO 3350-EXIT.
 14643
 14644 3350-ERFORM-GETMAIN.
 14645
 14646     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14647     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14648
 14649 3350-ERFORM-READ.
 14650
 14651     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14652     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14653     IF PB-CANCELLATION
 14654         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14655     ELSE
 14656         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14657     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14658
 14659     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14660
 14661     IF FORM-MASTER-FOUND
 14662       IF PB-CANCELLATION
 14663          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14664             PB-SV-STATE          EQUAL   FO-STATE       AND
 14665             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14666              GO  TO 3350-EXIT
 14667          ELSE
 14668              NEXT SENTENCE
 14669       ELSE
 14670          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14671             PB-SV-STATE          EQUAL   FO-STATE       AND
 14672             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14673              GO  TO 3350-EXIT.
 14674
 14675     MOVE  'N'                    TO  FORM-MASTER-SW.
 14676     MOVE  ER-1895                TO  WS-ERROR.
 14677     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 266
* EL050.cbl
 14678
 14679 3350-EXIT.
 14680      EXIT.
 14681
 14682******************************************************************
 14683*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14684*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14685*   VALID FOR THE POLICY FORM USED.                              *
 14686******************************************************************
 14687
 14688 3355-EDIT-FORM-LF-BENEFITS.
 14689
 14690     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14691        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14692         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14693         GO TO   3355-EXIT.
 14694
 14695     IF  SUB6    LESS THAN   +40
 14696         ADD  +1      TO  SUB6
 14697         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14698
 14699     MOVE  ER-1896         TO  WS-ERROR.
 14700     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14701
 14702 3355-EXIT.
 14703      EXIT.
 14704
 14705******************************************************************
 14706*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14707*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14708*   VALID FOR THE POLICY FORM USED.                              *
 14709******************************************************************
 14710
 14711 3356-EDIT-FORM-AH-BENEFITS.
 14712
 14713     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14714        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14715         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14716         GO TO  3356-EXIT.
 14717
 14718      IF  SUB6    LESS THAN     +40
 14719          ADD  +1      TO  SUB6
 14720          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14721
 14722     MOVE  ER-1897         TO  WS-ERROR.
 14723     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14724
 14725 3356-EXIT.
 14726      EXIT.
 14727
 14728******************************************************************
 14729*                  3357-BENEFIT-SEARCH                           *
 14730*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14731*   CANCELLATIONS ONLY.                                          *
 14732******************************************************************
 14733 3357-BENEFIT-SEARCH.
 14734     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14735         MOVE +1                          TO SUB6
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 267
* EL050.cbl
 14736         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14737
 14738     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14739         MOVE +1                          TO SUB6
 14740         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14741
 14742 3357-EXIT.
 14743     EXIT.
 14744
 14745******************************************************************
 14746*                  3358-BENEFIT-LIFE-SEARCH                      *
 14747*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14748*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14749*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14750******************************************************************
 14751 3358-BENEFIT-LIFE-SEARCH.
 14752     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14753       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14754         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14755           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14756              IF FO-PLAN-REFUND-METHOD (SUB6)
 14757                     IS GREATER THAN SPACES
 14758                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14759                                          WS-LF-REFUND-CALC
 14760                 GO TO 3358-EXIT.
 14761
 14762     IF SUB6 LESS THAN +40
 14763         ADD +1                 TO SUB6
 14764         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14765
 14766 3358-EXIT.
 14767     EXIT.
 14768******************************************************************
 14769*                  3359-BENEFIT-AH-SEARCH                        *
 14770*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14771*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14772*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14773******************************************************************
 14774 3359-BENEFIT-AH-SEARCH.
 14775     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14776       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14777         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14778           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14779              IF FO-PLAN-REFUND-METHOD (SUB6)
 14780                      IS GREATER THAN SPACES
 14781                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14782                                          WS-AH-REFUND-CALC
 14783                 GO TO 3359-EXIT.
 14784
 14785     IF SUB6 LESS THAN +40
 14786         ADD +1                 TO SUB6
 14787         GO TO 3359-BENEFIT-AH-SEARCH.
 14788
 14789 3359-EXIT.
 14790     EXIT.
 14791
 14792******************************************************************
 14793*                  3360-CHECK-FORM-LIMITS                        *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 268
* EL050.cbl
 14794*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14795*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14796******************************************************************
 14797
 14798 3360-CHECK-FORM-LIMITS.
 14799
 14800     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14801         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14802
 14803     IF NOT LF-FORM-MASTER-FOUND
 14804         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14805
 14806 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14807
 14808     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14809       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14810        WS-LF-JOINT-INDICATOR = 'J'  AND
 14811        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14812         IF PB-COMPANY-ID = 'NCL'
 14813            MOVE  ER-1911          TO  WS-ERROR
 14814            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14815         ELSE
 14816            MOVE  ER-1892          TO  WS-ERROR
 14817            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14818
 14819 3360-CHECK-FORM-LF-ATT-AGE.
 14820
 14821     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14822
 14823     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14824         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14825         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14826            IF PB-COMPANY-ID = 'NCL'
 14827                MOVE  ER-1913      TO  WS-ERROR
 14828                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14829            ELSE
 14830                MOVE  ER-1894      TO  WS-ERROR
 14831                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14832
 14833 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14834
 14835     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14836         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14837         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14838            IF PB-COMPANY-ID = 'NCL'
 14839                MOVE  ER-1914      TO  WS-ERROR
 14840                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14841            ELSE
 14842                MOVE  ER-1899      TO  WS-ERROR
 14843                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14844
 14845 3360-CHECK-FORM-LF-TERM-BAMT.
 14846
 14847     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14848         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14849         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14850           IF  PB-COMPANY-ID = 'NCL'
 14851               MOVE  ER-1916       TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 269
* EL050.cbl
 14852               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14853           ELSE
 14854               MOVE  ER-1902       TO  WS-ERROR
 14855               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14856
 14857     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14858                                    PB-I-LF-ALT-BENEFIT-AMT.
 14859
 14860     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14861         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14862         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14863             IF  PB-COMPANY-ID = 'NCL'
 14864                 MOVE  ER-1918     TO  WS-ERROR
 14865                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14866             ELSE
 14867                 MOVE  ER-1904     TO  WS-ERROR
 14868                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14869
 14870******************************************************************
 14871*                  3360-CHECK-FORM-AH-LIMITS                     *
 14872*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14873*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14874******************************************************************
 14875
 14876 3360-CHECK-FORM-AH-LIMITS.
 14877
 14878     IF NOT AH-FORM-MASTER-FOUND
 14879         GO TO 3999-END-EDIT.
 14880
 14881 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14882
 14883     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14884       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14885        WS-AH-JOINT-INDICATOR = 'J'  AND
 14886        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14887         IF PB-COMPANY-ID = 'NCL'
 14888            MOVE  ER-1912          TO  WS-ERROR
 14889            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14890         ELSE
 14891            MOVE  ER-1893          TO  WS-ERROR
 14892            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14893
 14894 3360-CHECK-FORM-AH-ATT-AGE.
 14895
 14896     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14897
 14898     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14899         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14900         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14901            IF PB-COMPANY-ID = 'NCL'
 14902                MOVE  ER-1913      TO  WS-ERROR
 14903                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14904            ELSE
 14905                MOVE  ER-1894      TO  WS-ERROR
 14906                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14907
 14908 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14909
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 270
* EL050.cbl
 14910     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14911         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14912         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14913            IF PB-COMPANY-ID = 'NCL'
 14914                MOVE  ER-1915      TO  WS-ERROR
 14915                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14916            ELSE
 14917                MOVE  ER-1900      TO  WS-ERROR
 14918                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14919
 14920 3360-CHECK-FORM-AH-TERM-BAMT.
 14921
 14922     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14923         FO-AH-MAX-TERM    GREATER THAN  +0
 14924         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14925             IF  PB-COMPANY-ID = 'NCL'
 14926                 MOVE  ER-1917     TO  WS-ERROR
 14927                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14928             ELSE
 14929                  MOVE  ER-1903    TO  WS-ERROR
 14930                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14931
 14932     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14933         FO-MAX-AH-AMT    GREATER THAN  +0
 14934         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14935             IF  PB-COMPANY-ID = 'NCL'
 14936                 MOVE  ER-1919     TO  WS-ERROR
 14937                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14938             ELSE
 14939                 MOVE  ER-1905     TO  WS-ERROR
 14940                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14941
 14942     GO TO 3999-END-EDIT.
 14943
 14944******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 271
* EL050.cbl
 14946******************************************************************
 14947*                  E D I T   C A N C E L                         *
 14948******************************************************************
 14949
 14950 3700-EDIT-CANCEL.
 14951     IF PB-COMPANY-ID = 'DMD'
 14952         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14953                                         WS-RES-MUNI-TAX
 14954                                         PB-CI-STATE-TAX
 14955                                         PB-CI-MUNI-TAX
 14956         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14957
 14958*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14959*       IF PB-ENTRY-BATCH  NUMERIC
 14960*          IF PB-CANCELLATION
 14961*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14962*          ELSE
 14963*             IF PB-ISSUE
 14964*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14965
 14966     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14967        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14968     END-IF
 14969*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14970*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14971
 14972     IF CM-ENTRY-STATUS = 'V'
 14973        MOVE ER-2780             TO WS-ERROR
 14974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14975        GO TO 3999-END-EDIT.
 14976
 14977     IF CM-ENTRY-STATUS = 'D'
 14978        MOVE ER-2781             TO WS-ERROR
 14979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14980        GO TO 3999-END-EDIT.
 14981
 14982     IF CM-ENTRY-STATUS = 'U'
 14983        MOVE ER-2782             TO WS-ERROR
 14984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14985
 14986***************************************************************
 14987*                                                             *
 14988*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 14989*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 14990*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 14991*   OF ANOTHER COVERAGE.                                      *
 14992*                                                             *
 14993***************************************************************
 14994
 14995     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 14996                                    PB-C-AH-CANCEL-VOID-SW.
 14997
 14998     IF PB-C-LF-CANCEL-AMT = ZERO
 14999        NEXT SENTENCE
 15000     ELSE
 15001        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15002           AND
 15003           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 272
* EL050.cbl
 15004               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15005               MOVE ER-2745           TO WS-ERROR
 15006               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15007
 15008     IF PB-C-AH-CANCEL-AMT = ZERO
 15009        NEXT SENTENCE
 15010     ELSE
 15011        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15012           AND
 15013           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15014               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15015               MOVE ER-2745           TO WS-ERROR
 15016               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15017
 15018     IF WS-LF-EARNINGS-CALC = '4'
 15019        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15020
 15021     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15022     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15023     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15024     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15025     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15026     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15027
 15028     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15029                                      PB-C-AH-REF-CALC.
 15030     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15031
 15032******************************************************************
 15033*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15034*             TO VALIDATE COVERAGE.                              *
 15035******************************************************************
 15036
 15037     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15038        PB-C-LF-CANCEL-AMT = ZEROS
 15039          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15040      ELSE
 15041          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15042
 15043     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15044        PB-C-AH-CANCEL-AMT = ZEROS
 15045          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15046      ELSE
 15047          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15048
 15049     EVALUATE TRUE
 15050         WHEN PB-CANCEL-FORCE             OR
 15051              PB-CANCEL-DATE-FORCED       OR
 15052              PB-FORCE-OFF
 15053                  IF PB-COMPANY-ID = 'ACE'
 15054                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15055                  END-IF
 15056         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15057               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15058              (PB-COMPANY-ID = 'ACE' )
 15059                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15060         WHEN OTHER
 15061              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 273
* EL050.cbl
 15062                 MOVE ER-2794              TO WS-ERROR
 15063              ELSE
 15064                 MOVE ER-2749              TO WS-ERROR
 15065              END-IF
 15066              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15067     END-EVALUATE.
 15068
 15069
 15070*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15071*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15072*            MOVE  ER-1909            TO  WS-ERROR
 15073*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15074*        ELSE
 15075*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15076
 15077     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15078     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15079        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15080     ELSE
 15081        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15082     END-IF
 15083     .
 15084 3705-EDIT-CANCEL-DT.
 15085
 15086     IF LF-COVERAGE-CANCELLED
 15087        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15088         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15089         MOVE WS-CURRENT-MONTH-END
 15090                                 TO DC-BIN-DATE-2
 15091         SET ELAPSED-BETWEEN-BIN TO TRUE
 15092*        MOVE 1                  TO DC-OPTION-CODE
 15093         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15094         IF DATE-CONVERSION-ERROR
 15095            NEXT SENTENCE
 15096          ELSE
 15097             IF DC-ELAPSED-DAYS GREATER +180
 15098                IF PB-CANCEL-DATE-FORCED  OR
 15099                   PB-CANCEL-DATE-FORCED-NO-FEE
 15100                      MOVE ER-2751  TO WS-ERROR
 15101                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15102                 ELSE
 15103                   MOVE ER-2752  TO WS-ERROR
 15104                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15105
 15106     IF AH-COVERAGE-CANCELLED
 15107        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15108         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15109         MOVE WS-CURRENT-MONTH-END
 15110                                 TO DC-BIN-DATE-2
 15111         SET ELAPSED-BETWEEN-BIN TO TRUE
 15112*        MOVE 1                  TO DC-OPTION-CODE
 15113         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15114         IF DATE-CONVERSION-ERROR
 15115            NEXT SENTENCE
 15116          ELSE
 15117             IF DC-ELAPSED-DAYS GREATER +180
 15118                IF PB-CANCEL-DATE-FORCED OR
 15119                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 274
* EL050.cbl
 15120                      MOVE ER-2751  TO WS-ERROR
 15121                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15122                 ELSE
 15123                   MOVE ER-2752  TO WS-ERROR
 15124                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15125
 15126     IF WS-ERROR = ER-2752
 15127        AND (PB-COMPANY-ID = 'ABL'
 15128         OR  PB-COMPANY-ID = 'FGL'
 15129         OR  PB-COMPANY-ID = 'IST'
 15130         OR  PB-COMPANY-ID = 'JHL'
 15131         OR  PB-COMPANY-ID = 'LAP'
 15132         OR  PB-COMPANY-ID = 'LBL'
 15133         OR  PB-COMPANY-ID = 'NCB'
 15134         OR  PB-COMPANY-ID = 'NLI'
 15135         OR  PB-COMPANY-ID = 'OFI'
 15136         OR  PB-COMPANY-ID = 'PLI'
 15137         OR  PB-COMPANY-ID = 'TAO'
 15138         OR  PB-COMPANY-ID = 'TIC'
 15139         OR  PB-COMPANY-ID = 'HER'
 15140         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15141         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15142            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15143            MOVE ER-2762     TO WS-ERROR
 15144            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15145
 15146     IF LF-COVERAGE-CANCELLED
 15147        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15148        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15149             MOVE ER-2733         TO WS-ERROR
 15150             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15151
 15152     IF AH-COVERAGE-CANCELLED
 15153        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15154        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15155              MOVE ER-2733        TO WS-ERROR
 15156              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15157
 15158     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15159        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15160        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15161           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15162            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15163              IF PB-COMPANY-ID NOT = 'LAP'
 15164               MOVE ER-2704            TO WS-ERROR
 15165               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15166
 15167     IF CERT-WAS-NOT-FOUND
 15168         GO TO 3999-END-EDIT.
 15169
 15170     IF PB-COMPANY-ID EQUAL 'CDC'
 15171        IF LF-COVERAGE-CANCELLED
 15172           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15173            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15174            MOVE PB-C-LF-CANCEL-DT
 15175                                 TO DC-BIN-DATE-2
 15176            SET ELAPSED-BETWEEN-BIN TO TRUE
 15177*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 275
* EL050.cbl
 15178            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15179            IF DATE-CONVERSION-ERROR
 15180               NEXT SENTENCE
 15181             ELSE
 15182                IF DC-ELAPSED-DAYS GREATER +60
 15183                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15184
 15185     IF PB-COMPANY-ID EQUAL 'CDC'
 15186        IF AH-COVERAGE-CANCELLED
 15187           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15188            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15189            MOVE PB-C-AH-CANCEL-DT
 15190                                 TO DC-BIN-DATE-2
 15191            MOVE +0              TO DC-ELAPSED-DAYS
 15192                                    DC-ELAPSED-MONTHS
 15193            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15194*           MOVE 1               TO DC-OPTION-CODE
 15195            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15196            IF DATE-CONVERSION-ERROR
 15197               NEXT SENTENCE
 15198             ELSE
 15199                IF DC-ELAPSED-DAYS GREATER +60
 15200                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15201
 15202     MOVE +0                     TO DC-ELAPSED-DAYS
 15203                                    DC-ELAPSED-MONTHS.
 15204
 15205     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15206        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15207          MOVE 'Z'                TO PB-CI-OB-FLAG
 15208          MOVE ER-2767            TO WS-ERROR
 15209          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15210          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15211          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15212          GO TO 3775-OVER-REF-CHK
 15213        ELSE
 15214          MOVE ZEROS              TO PB-CI-LIVES
 15215                                     PB-C-LIVES
 15216          IF PB-CI-OB-FLAG NOT = 'B'
 15217             MOVE SPACE           TO PB-CI-OB-FLAG.
 15218
 15219     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15220         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15221     ELSE
 15222         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15223
 15224     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15225        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15226            MOVE ER-2760         TO WS-ERROR
 15227            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15228
 15229     IF LF-COVERAGE-CANCELLED
 15230        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15231         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15232            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15233               MOVE ER-2774       TO WS-ERROR
 15234               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15235
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 276
* EL050.cbl
 15236     IF AH-COVERAGE-CANCELLED
 15237        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15238         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15239            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15240               MOVE ER-2775       TO WS-ERROR
 15241               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15242
 15243     IF LF-COVERAGE-CANCELLED
 15244        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15245         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15246            MOVE ER-2776         TO WS-ERROR
 15247            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15248
 15249     IF AH-COVERAGE-CANCELLED
 15250        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15251         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15252            MOVE ER-2777         TO WS-ERROR
 15253            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15254
 15255     IF LF-COVERAGE-CANCELLED
 15256        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15257         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15258         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15259         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15260*        MOVE 6                    TO DC-OPTION-CODE
 15261         SET BIN-PLUS-ELAPSED      TO TRUE
 15262         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15263         IF DATE-CONVERSION-ERROR
 15264            NEXT SENTENCE
 15265          ELSE
 15266            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15267              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15268                             OR  'FIA'
 15269                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15270               ELSE
 15271                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15272                MOVE ER-2731       TO WS-ERROR
 15273                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15274
 15275 3705-EDIT-AH-CANCEL-DT.
 15276
 15277     IF AH-COVERAGE-CANCELLED
 15278        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15279         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15280         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15281         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15282*        MOVE 6                    TO DC-OPTION-CODE
 15283         SET BIN-PLUS-ELAPSED      TO TRUE
 15284         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15285         IF DATE-CONVERSION-ERROR
 15286            NEXT SENTENCE
 15287          ELSE
 15288            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15289              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15290                              OR 'FIA'
 15291                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15292              ELSE
 15293               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 277
* EL050.cbl
 15294               MOVE ER-2771       TO WS-ERROR
 15295               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15296
 15297 3705-EDIT-CONTINUED.
 15298
 15299*    IF LF-COVERAGE-CANCELLED
 15300*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15301*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15302*            MOVE ER-2727         TO WS-ERROR
 15303*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15304*
 15305*    IF AH-COVERAGE-CANCELLED
 15306*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15307*        IF PB-COMPANY-ID = 'ACE'
 15308*           MOVE ER-2727        TO WS-ERROR
 15309*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15310*        ELSE
 15311*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15312*              MOVE ER-2727     TO WS-ERROR
 15313*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15314
 15315     IF PB-COMPANY-ID = 'ACE'
 15316       IF AH-COVERAGE-CANCELLED
 15317         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15318           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15319              MOVE ER-2732      TO WS-ERROR
 15320              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15321
 15322     IF PB-COMPANY-ID      EQUAL   'HER'
 15323        IF WS-ERROR        EQUAL   ER-2727
 15324            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15325            MOVE  ER-2725          TO  WS-ERROR
 15326            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15327
 15328     IF PB-C-CLAIM-CREATED-CANCEL
 15329            MOVE ER-2748         TO WS-ERROR
 15330            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15331
 15332     IF PB-C-LAST-NAME NOT = SPACES
 15333         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15334            MOVE ER-2747         TO WS-ERROR
 15335            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15336
 15337 3710-EDIT-LUMP-SUM-PRIOR.
 15338
 15339     IF AH-COVERAGE-CANCELLED
 15340         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15341             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15342                MOVE ER-2735    TO WS-ERROR
 15343                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15344
 15345     IF LF-COVERAGE-CANCELLED
 15346         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15347             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15348                MOVE ER-2735    TO WS-ERROR
 15349                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15350
 15351 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 278
* EL050.cbl
 15352
 15353*    IF LF-COVERAGE-CANCELLED
 15354*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15355*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15356*           (NOT PB-CI-OB)
 15357*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15358*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15359*                   MOVE ER-2732  TO WS-ERROR
 15360*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15361*
 15362*    IF AH-COVERAGE-CANCELLED
 15363*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15364*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15365*           (NOT PB-CI-OB)
 15366*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15367*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15368*                   MOVE ER-2732  TO WS-ERROR
 15369*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15370
 15371     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15372         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15373            (NOT PB-COMP-LF-CANCEL)
 15374             NEXT SENTENCE
 15375         ELSE
 15376           IF PB-C-LF-CANCEL-VOIDED
 15377              NEXT SENTENCE
 15378           ELSE
 15379              MOVE ER-2753      TO WS-ERROR
 15380              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15381
 15382     IF CANCEL-FUTURE-DT
 15383         GO TO 3999-END-EDIT.
 15384
 15385 3715-GET-REMAIN-TERM-LF.
 15386
 15387     IF NO-LF-BENEFIT-MATCH  OR
 15388        WS-LF-BENEFIT-CD = ZEROS
 15389        GO TO 3730-GET-AH-REMAIN-TERM.
 15390
 15391     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15392     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15393     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15394     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15395     MOVE PB-SV-STATE            TO CP-STATE.
 15396     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15397     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15398     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15399     MOVE '2'                    TO CP-PROCESS-TYPE.
 15400     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15401     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15402     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15403     IF (PB-COMPANY-ID = 'CID')
 15404        AND (CP-STATE-STD-ABBRV = 'WI')
 15405        MOVE '7'                 TO CP-REM-TERM-METHOD
 15406        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15407     ELSE
 15408        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15409        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 279
* EL050.cbl
 15410                                 TO CP-REM-TRM-CALC-OPTION
 15411     END-IF
 15412**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15413     IF (PB-COMPANY-ID = 'CID')
 15414        AND (CP-STATE-STD-ABBRV = 'MO')
 15415        AND (PB-CERT-EFF-DT >= X'9B41')
 15416        AND (PB-CERT-EFF-DT <= X'A2FB')
 15417        MOVE '7'                 TO CP-REM-TERM-METHOD
 15418        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15419     END-IF
 15420     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15421                                    CP-LOAN-TERM.
 15422     IF CP-TRUNCATED-LIFE
 15423        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15424
 15425     IF CP-TERM-IS-DAYS
 15426         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15427     ELSE
 15428         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15429
 15430     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15431
 15432     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15433
 15434     IF LF-COVERAGE-CANCELLED
 15435        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15436        NEXT SENTENCE
 15437      ELSE
 15438          GO TO 3730-GET-AH-REMAIN-TERM.
 15439
 15440 3720-GET-LF-REFUND.
 15441
 15442     IF PB-C-LF-CANCEL-VOIDED OR
 15443        PB-C-AH-CANCEL-VOIDED
 15444        GO TO 3780-UPDATE-CANCEL-CERT.
 15445
 15446     IF PB-COMPANY-ID EQUAL 'BOA'
 15447         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15448         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15449         GO TO 3730-GET-AH-REMAIN-TERM.
 15450
 15451     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15452        (WS-AH-SPECIAL-CALC-CD = 'M')
 15453         MOVE ER-2767            TO WS-ERROR
 15454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15455         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15456         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15457         GO TO 3780-UPDATE-CANCEL-CERT.
 15458
 15459     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15460
 15461     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15462     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15463     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15464     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15465     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15466     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15467     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 280
* EL050.cbl
 15468        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15469        IF PDEF-MASTER-FOUND
 15470           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15471              (V1 > +8)
 15472              OR (PD-PROD-CODE (V1) = 'L')
 15473           END-PERFORM
 15474           IF V1 < +9
 15475              MOVE PD-MAX-AMT (V1)
 15476                           TO CP-R-MAX-TOT-BEN
 15477                              EC-AM-LF-MAX-TOT-BEN
 15478           END-IF
 15479        ELSE
 15480        MOVE ' '                 TO PDEF-MASTER-SW
 15481        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15482        MOVE PB-STATE            TO ERPDEF-STATE
 15483        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15484        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15485        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15486        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15487        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15488        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15489        IF PDEF-MASTER-FOUND
 15490           MOVE 'N'              TO PDEF-MASTER-SW
 15491           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15492           IF PDEF-MASTER-FOUND
 15493              IF (ERPDEF-KEY-SAVE (1:16) =
 15494                           PD-CONTROL-PRIMARY (1:16))
 15495                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15496                 CONTINUE
 15497              ELSE
 15498                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15499                 IF (ERPDEF-KEY-SAVE (1:16) =
 15500                           PD-CONTROL-PRIMARY (1:16))
 15501                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15502                    CONTINUE
 15503                 ELSE
 15504                    MOVE 'N'     TO PDEF-MASTER-SW
 15505                 END-IF
 15506              END-IF
 15507              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15508
 15509              IF PDEF-MASTER-FOUND
 15510                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15511                    (V1 > +8)
 15512                    OR (PD-PROD-CODE (V1) = 'L')
 15513                 END-PERFORM
 15514                 IF V1 < +9
 15515                    MOVE PD-MAX-AMT (V1)
 15516                                 TO CP-R-MAX-TOT-BEN
 15517                                    EC-AM-LF-MAX-TOT-BEN
 15518                 END-IF
 15519              END-IF
 15520           END-IF
 15521           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15522        END-IF
 15523        END-IF
 15524     END-IF
 15525     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 281
* EL050.cbl
 15526
 15527     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15528
 15529     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15530                                    PB-C-LF-REM-TERM.
 15531
 15532     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15533     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15534
 15535     IF PB-COMPANY-ID EQUAL 'FLC'
 15536        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15537           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15538           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15539                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15540                    - CM-LF-ITD-DEATH-AMT
 15541           IF PB-C-LF-REF-CALC LESS THAN +0
 15542              MOVE +0            TO PB-C-LF-REF-CALC
 15543              GO TO 3730-GET-AH-REMAIN-TERM
 15544           ELSE
 15545              GO TO 3730-GET-AH-REMAIN-TERM.
 15546
 15547     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15548                            OR '4' OR '5' OR '6' OR '8'
 15549                            OR '9' OR 'G'
 15550        MOVE PB-C-LF-REFUND-OVERRIDE
 15551                                 TO CP-EARNING-METHOD.
 15552
 15553     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15554     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15555     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15556                                    CP-RATING-BENEFIT-AMT.
 15557     IF CP-STATE-STD-ABBRV = 'OR'
 15558         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15559                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15560     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15561     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15562     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15563     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15564     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15565     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15566     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15567     IF WS-DEFAULT-APR NOT NUMERIC
 15568         MOVE ZEROS TO WS-DEFAULT-APR.
 15569****   N O T E   ****
 15570*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15571*      THE OH HARD CODING IN ELCRFNDP
 15572
 15573     IF PB-COMPANY-ID = 'CID'
 15574        IF CP-STATE-STD-ABBRV = 'OH'
 15575           MOVE WS-LF-EARNINGS-CALC
 15576                                 TO CP-EARNING-METHOD
 15577        END-IF
 15578     END-IF
 15579
 15580****   N O T E   ****
 15581
 15582     IF CP-EARN-AS-NET-PAY
 15583         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 282
* EL050.cbl
 15584            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15585                MOVE WS-DEFAULT-APR
 15586                                 TO  CP-LOAN-APR
 15587                MOVE ER-3780     TO  WS-ERROR
 15588                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15589            ELSE
 15590                MOVE ER-3781     TO  WS-ERROR
 15591                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15592     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15593     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15594
 15595     IF CP-REFUND-TYPE-USED NOT = SPACE
 15596         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15597
 15598     IF CP-ERROR-RATE-IS-ZERO OR
 15599        CP-ERROR-RATE-NOT-FOUND
 15600        MOVE ER-2740             TO WS-ERROR
 15601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15602
 15603     IF CP-ERROR-RATE-FILE-NOTOPEN
 15604        MOVE ER-2617             TO WS-ERROR
 15605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15606
 15607     IF PB-COMPANY-ID = 'DCC'
 15608        AND PB-CI-ENTRY-STATUS = 'M'
 15609        MOVE +0                  TO PB-C-LF-REF-CALC
 15610     ELSE
 15611        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15612     END-IF
 15613
 15614     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15615         GO TO 3730-GET-AH-REMAIN-TERM.
 15616
 15617*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15618*       ADD +1                   TO PB-C-LF-REM-TERM
 15619*                                   CP-REMAINING-TERM
 15620*                                   CP-ORIGINAL-TERM.
 15621
 15622     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15623     MOVE '2'                    TO CP-EARNING-METHOD
 15624                                    CP-RATING-METHOD.
 15625     IF PB-COMPANY-ID = 'CID'
 15626        IF (CP-STATE-STD-ABBRV = 'MN')
 15627           AND (PB-CERT-EFF-DT > X'A4FF')
 15628           AND (WS-LF-EARNINGS-CALC = 'B')
 15629           MOVE '5'              TO CP-EARNING-METHOD
 15630           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15631        END-IF
 15632     END-IF
 15633     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15634                                        CP-REMAINING-BENEFIT
 15635                                        CP-RATING-BENEFIT-AMT.
 15636     IF CP-STATE-STD-ABBRV = 'OR'
 15637         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15638                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15639     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15640     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15641
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 283
* EL050.cbl
 15642     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15643
 15644     IF CP-ERROR-RATE-IS-ZERO OR
 15645        CP-ERROR-RATE-NOT-FOUND
 15646        MOVE ER-2740             TO WS-ERROR
 15647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15648
 15649     IF CP-ERROR-RATE-FILE-NOTOPEN
 15650        MOVE ER-2617             TO WS-ERROR
 15651        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15652
 15653     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15654
 15655******************************************************************
 15656
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 284
* EL050.cbl
 15658 3730-GET-AH-REMAIN-TERM.
 15659     IF NO-AH-BENEFIT-MATCH  OR
 15660        WS-AH-BENEFIT-CD = ZEROS
 15661         GO TO 3770-CHECK-REFUNDS.
 15662
 15663     IF PB-CI-AH-LUMP-SUM-DISAB
 15664         IF  PB-C-AH-CANCEL-AMT = ZERO
 15665            IF NOT PB-COMP-AH-CANCEL
 15666             GO TO 3770-CHECK-REFUNDS.
 15667
 15668     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15669     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15670     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15671     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15672     MOVE PB-SV-STATE            TO CP-STATE.
 15673     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15674     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15675     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15676     MOVE '2'                    TO CP-PROCESS-TYPE.
 15677     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15678     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15679     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15680     IF (PB-COMPANY-ID = 'CID')
 15681        AND (CP-STATE-STD-ABBRV = 'WI')
 15682        MOVE '7'                 TO CP-REM-TERM-METHOD
 15683        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15684     ELSE
 15685        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15686        MOVE WS-REM-TRM-CALC-OPTION
 15687                                 TO CP-REM-TRM-CALC-OPTION
 15688     END-IF
 15689     IF (PB-COMPANY-ID = 'CID')
 15690        AND (CP-STATE-STD-ABBRV = 'MO')
 15691        AND (PB-CERT-EFF-DT >= X'9B41')
 15692        AND (PB-CERT-EFF-DT <= X'A2FB')
 15693        MOVE '7'                 TO CP-REM-TERM-METHOD
 15694        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15695     END-IF
 15696     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15697                                    CP-LOAN-TERM.
 15698     IF NOT CP-TERM-IS-DAYS
 15699         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15700
 15701     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15702
 15703     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15704
 15705     IF AH-COVERAGE-CANCELLED
 15706        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15707        NEXT SENTENCE
 15708      ELSE
 15709         GO TO 3770-CHECK-REFUNDS.
 15710
 15711 3740-GET-AH-REFUND.
 15712
 15713     IF PB-C-LF-CANCEL-VOIDED OR
 15714        PB-C-AH-CANCEL-VOIDED
 15715        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 285
* EL050.cbl
 15716
 15717     IF PB-COMPANY-ID = 'BOA'
 15718         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15719         GO TO 3770-CHECK-REFUNDS.
 15720
 15721     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15722*    MOVE ' '                    TO DC-OPTION-CODE
 15723     SET BIN-TO-GREG             TO TRUE
 15724     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15725     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15726                                    PB-C-AH-REM-TERM.
 15727     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15728     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15729
 15730     IF PB-COMPANY-ID EQUAL 'FLC'
 15731        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15732           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15733           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15734                    - CM-AH-ITD-AH-PMT)
 15735           IF PB-C-AH-REF-CALC LESS THAN +0
 15736              MOVE +0            TO PB-C-AH-REF-CALC
 15737              GO TO 3770-CHECK-REFUNDS
 15738           ELSE
 15739              GO TO 3770-CHECK-REFUNDS.
 15740
 15741     IF PB-COMPANY-ID = 'DCC'
 15742        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15743            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15744           MOVE 'S'              TO CP-EARNING-METHOD
 15745        END-IF
 15746     END-IF
 15747     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15748                            OR '4' OR '5' OR '6' OR '8'
 15749                            OR '9' OR 'G' OR 'S'
 15750        MOVE PB-C-AH-REFUND-OVERRIDE
 15751                                 TO CP-EARNING-METHOD.
 15752
 15753     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15754     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15755     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15756                                    CP-RATING-BENEFIT-AMT.
 15757     IF CP-STATE-STD-ABBRV = 'OR'
 15758         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15759                                         PB-CI-AH-TERM.
 15760     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15761     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15762     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15763     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15764     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15765     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15766
 15767     IF CP-STATE-STD-ABBRV = 'OH'
 15768        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15769                                AND 'CID' AND 'DCC')
 15770           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15771              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15772              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15773              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 286
* EL050.cbl
 15774           END-IF
 15775        END-IF
 15776        IF PB-COMPANY-ID = 'CID'
 15777           IF NO-LIFE-COVERAGE
 15778              IF CP-CRITICAL-PERIOD
 15779                 MOVE '2'       TO CP-EARNING-METHOD
 15780              ELSE
 15781                 MOVE '6'       TO CP-EARNING-METHOD
 15782              END-IF
 15783           ELSE
 15784              IF WS-LF-COVERAGE-TYPE = 'L'
 15785                 MOVE '2'       TO CP-EARNING-METHOD
 15786              ELSE
 15787                 IF (PB-CI-LF-TERM > +60) OR
 15788                    (WS-LF-EARNINGS-CALC = '5')
 15789                    IF CP-CRITICAL-PERIOD
 15790                       MOVE '2'  TO CP-EARNING-METHOD
 15791                    ELSE
 15792                       MOVE '6'  TO CP-EARNING-METHOD
 15793                    END-IF
 15794                 ELSE
 15795                    MOVE '1'     TO CP-EARNING-METHOD
 15796                 END-IF
 15797              END-IF
 15798           END-IF
 15799        END-IF
 15800     END-IF
 15801
 15802*    IF CP-STATE-STD-ABBRV = 'VA'
 15803*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15804*          IF CP-ORIGINAL-TERM GREATER 61
 15805*             MOVE '6' TO CP-EARNING-METHOD
 15806*          ELSE
 15807*             MOVE '1' TO CP-EARNING-METHOD.
 15808
 15809     IF WS-DEFAULT-APR NOT NUMERIC
 15810         MOVE ZEROS TO WS-DEFAULT-APR.
 15811     IF CP-EARN-AS-NET-PAY
 15812         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15813            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15814                MOVE WS-DEFAULT-APR
 15815                                 TO  CP-LOAN-APR
 15816                MOVE ER-3780     TO  WS-ERROR
 15817                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15818            ELSE
 15819                MOVE ER-3781     TO  WS-ERROR
 15820                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15821     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15822     IF PB-COMPANY-ID = 'DCC'
 15823        AND CP-CANCEL-REASON = 'R'
 15824        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15825        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15826     END-IF
 15827     IF PB-COMPANY-ID = 'DCC'
 15828        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15829        AND (CP-EARNING-METHOD = 'D')
 15830        AND (CP-CANCEL-REASON NOT = 'R')
 15831        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 287
* EL050.cbl
 15832     ELSE
 15833        GO TO 3750-CONTINUE
 15834     END-IF
 15835     MOVE ' '                    TO DD-IU-SW
 15836     IF NOT PDEF-MASTER-FOUND
 15837        MOVE ' '                 TO PDEF-MASTER-SW
 15838        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15839        MOVE PB-STATE            TO ERPDEF-STATE
 15840        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15841        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15842        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15843        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15844        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15845        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15846        IF PDEF-MASTER-FOUND
 15847           MOVE 'N'              TO PDEF-MASTER-SW
 15848           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15849           IF PDEF-MASTER-FOUND
 15850              IF (ERPDEF-KEY-SAVE (1:16) =
 15851                           PD-CONTROL-PRIMARY (1:16))
 15852                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15853                 CONTINUE
 15854              ELSE
 15855                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15856                 IF (ERPDEF-KEY-SAVE (1:16) =
 15857                           PD-CONTROL-PRIMARY (1:16))
 15858                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15859                    CONTINUE
 15860                 ELSE
 15861                    MOVE ER-2740 TO WS-ERROR
 15862                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15863                    GO TO 3770-CHECK-REFUNDS
 15864                 END-IF
 15865              END-IF
 15866           END-IF
 15867           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15868        END-IF
 15869     END-IF
 15870     IF PDEF-MASTER-FOUND
 15871        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15872           (V1 > +8)
 15873           OR (PD-PROD-CODE (V1) = 'I')
 15874        END-PERFORM
 15875        IF V1 < +9
 15876           SET DD-IU-PRESENT        TO TRUE
 15877        END-IF
 15878        IF WS-AH-DCC-TRUNC = 'T'
 15879           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 15880        ELSE
 15881           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 15882        END-IF
 15883        EVALUATE TRUE
 15884           WHEN WS-TERM > +168
 15885              MOVE 15               TO V1
 15886           WHEN WS-TERM > +156
 15887              MOVE 14               TO V1
 15888           WHEN WS-TERM > +144
 15889              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 288
* EL050.cbl
 15890           WHEN WS-TERM > +132
 15891              MOVE 12               TO V1
 15892           WHEN WS-TERM > +120
 15893              MOVE 11               TO V1
 15894           WHEN WS-TERM > +108
 15895              MOVE 10               TO V1
 15896           WHEN WS-TERM > +96
 15897              MOVE 9                TO V1
 15898           WHEN WS-TERM > +84
 15899              MOVE 8                TO V1
 15900           WHEN WS-TERM > +72
 15901              MOVE 7                TO V1
 15902           WHEN WS-TERM > +60
 15903              MOVE 6                TO V1
 15904           WHEN WS-TERM > +48
 15905              MOVE 5                TO V1
 15906           WHEN WS-TERM > +36
 15907              MOVE 4                TO V1
 15908           WHEN WS-TERM > +24
 15909              MOVE 3                TO V1
 15910           WHEN WS-TERM > +12
 15911              MOVE 2                TO V1
 15912           WHEN OTHER
 15913              MOVE 1                TO V1
 15914        END-EVALUATE
 15915
 15916        EVALUATE TRUE
 15917*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15918*             < +13)
 15919*             AND (DD-IU-PRESENT)
 15920*             MOVE 2                TO V2
 15921*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15922*             MOVE 1                TO V2
 15923           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15924              MOVE 2                TO V2
 15925           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15926              MOVE 3                TO V2
 15927           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15928              MOVE 4                TO V2
 15929           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15930              MOVE 5                TO V2
 15931           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15932              MOVE 6                TO V2
 15933           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15934              MOVE 7                TO V2
 15935           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15936              MOVE 8                TO V2
 15937           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 15938              MOVE 9                TO V2
 15939           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 15940              MOVE 10               TO V2
 15941           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 15942              MOVE 11               TO V2
 15943           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 15944              MOVE 12               TO V2
 15945           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 15946              MOVE 13               TO V2
 15947           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 289
* EL050.cbl
 15948              MOVE 14               TO V2
 15949           WHEN OTHER
 15950              MOVE 15               TO V2
 15951        END-EVALUATE
 15952
 15953        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15954                                 TO CP-DDF-LO-FACT
 15955        MOVE PD-UEP-FACTOR (V1 V2)
 15956                                 TO CP-DDF-HI-FACT
 15957
 15958        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15959        MOVE CM-AH-CLP     TO CP-DDF-CLP
 15960        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 15961           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15962        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15963        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15964        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15965           + PD-1ST-YR-ADMIN-ALLOW
 15966
 15967        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15968*       IF PI-CLP-YN = 'Y'
 15969*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 15970*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 15971*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 15972*       END-IF
 15973
 15974        IF DD-IU-PRESENT
 15975           MOVE 'I'              TO CP-EARNING-METHOD
 15976        END-IF
 15977        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15978                                     CP-CLP-RATE-UP
 15979        IF CP-IU-RATE-UP NOT = ZEROS
 15980           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 15981              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 15982           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 15983              / (1 - WS-WORK-FACT)
 15984        END-IF
 15985     END-IF
 15986     .
 15987 3750-CONTINUE.
 15988     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15989
 15990     IF CP-REFUND-TYPE-USED NOT = SPACE
 15991         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 15992
 15993     IF CP-ERROR-RATE-IS-ZERO OR
 15994        CP-ERROR-RATE-NOT-FOUND
 15995        MOVE ER-2740             TO WS-ERROR
 15996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15997
 15998     IF CP-ERROR-RATE-FILE-NOTOPEN
 15999        MOVE ER-2617             TO WS-ERROR
 16000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16001     IF PB-COMPANY-ID = 'DCC'
 16002        AND PB-CI-ENTRY-STATUS = 'M'
 16003        MOVE +0                  TO PB-C-AH-REF-CALC
 16004     ELSE
 16005        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 290
* EL050.cbl
 16006     END-IF
 16007     IF PB-COMPANY-ID = 'DCC'
 16008        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16009        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16010        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16011        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16012        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16013        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16014        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16015        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16016        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16017     END-IF
 16018     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 291
* EL050.cbl
 16020
 16021 3770-CHECK-REFUNDS.
 16022
 16023     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16024        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16025           MOVE ER-2766          TO WS-ERROR
 16026           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16027           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16028           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16029              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16030
 16031     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16032        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16033           MOVE ER-2766          TO WS-ERROR
 16034           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16035           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16036           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16037              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16038
 16039     IF PB-COMP-LF-CANCEL
 16040        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16041        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16042           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16043              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16044
 16045     IF PB-COMP-AH-CANCEL
 16046        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16047        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16048           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16049              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16050
 16051     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16052             GIVING WS-UNSIGN-WRK1
 16053     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16054             GIVING WS-UNSIGN-WRK2.
 16055
 16056     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16057         MOVE ZERO TO WS-UNSIGN-WRK1.
 16058
 16059     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16060         MOVE ZERO TO WS-UNSIGN-WRK2.
 16061
 16062     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16063
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 292
* EL050.cbl
 16065
 16066 3772-CONTINUE.
 16067
 16068**********************************
 16069*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16070*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16071*** DOUBLES THE TOLERANCE AMOUNT.
 16072***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16073**********************************
 16074     IF PB-COMPANY-ID = 'MON'
 16075     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16076         IF WS-REF-REJECT-SW = SPACE
 16077             MOVE ER-2754        TO WS-ERROR
 16078             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16079           ELSE
 16080             MOVE ER-2736        TO WS-ERROR
 16081             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16082**********************************
 16083
 16084 3773-CONTINUE.
 16085
 16086     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16087        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16088           MOVE ER-2723          TO WS-ERROR
 16089           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16090
 16091     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16092        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16093           MOVE ER-2724          TO WS-ERROR
 16094           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16095
 16096     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16097         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16098             (1 + WS-LF-REFUND-OVS-PCT)
 16099     ELSE
 16100         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16101
 16102     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16103         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16104             (1 - WS-TOL-LF-REFUND-PCT)
 16105     ELSE
 16106         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16107
 16108     IF (PB-COMPANY-ID = 'DCC')
 16109        AND (PB-CI-ENTRY-STATUS = 'M')
 16110        AND (PB-C-LF-CANCEL-AMT > +0)
 16111        MOVE ER-3843             TO WS-ERROR
 16112        PERFORM 9900-ERROR-FORMAT
 16113                                 THRU 9900-EXIT
 16114     END-IF
 16115     EVALUATE TRUE
 16116        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16117           CONTINUE
 16118        WHEN PB-C-LF-CANCEL-AMT = +0
 16119                 AND PB-C-LF-REF-CALC > +0
 16120           CONTINUE
 16121        WHEN WS-LF-REFUND-OVS-AMT = 0
 16122                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 293
* EL050.cbl
 16123           CONTINUE
 16124        WHEN OTHER
 16125           IF WS-TOL-LF-REFUND  = +0
 16126              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16127           END-IF
 16128           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16129                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16130                          (PB-C-LF-CANCEL-AMT))
 16131              CONTINUE
 16132           ELSE
 16133              IF WS-LF-REFUND-OVS-AMT = +0
 16134                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16135              END-IF
 16136              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16137                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16138                                       PB-C-LF-CANCEL-AMT)
 16139                 CONTINUE
 16140              ELSE
 16141                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16142                   MOVE ER-2754   TO  WS-ERROR
 16143                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16144                 ELSE
 16145                    MOVE ER-2736   TO  WS-ERROR
 16146                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16147                 END-IF
 16148              END-IF
 16149           END-IF
 16150     END-EVALUATE.
 16151
 16152     EVALUATE TRUE
 16153        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16154           CONTINUE
 16155        WHEN PB-C-LF-CANCEL-AMT = +0
 16156                 AND PB-C-LF-REF-CALC > +0
 16157           CONTINUE
 16158        WHEN OTHER
 16159           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16160               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16161              CONTINUE
 16162           ELSE
 16163              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16164               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16165                CONTINUE
 16166              ELSE
 16167                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16168                     MOVE ER-2754   TO  WS-ERROR
 16169                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16170                 ELSE
 16171                     MOVE ER-2736   TO  WS-ERROR
 16172                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16173                 END-IF
 16174              END-IF
 16175           END-IF
 16176     END-EVALUATE.
 16177
 16178     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16179         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16180             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 294
* EL050.cbl
 16181     ELSE
 16182         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16183
 16184     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16185         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16186             (1 - WS-TOL-AH-REFUND-PCT)
 16187     ELSE
 16188         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16189
 16190     IF (PB-COMPANY-ID = 'DCC')
 16191        AND (PB-CI-ENTRY-STATUS = 'M')
 16192        AND (PB-C-AH-CANCEL-AMT > +0)
 16193        MOVE ER-3843             TO WS-ERROR
 16194        PERFORM 9900-ERROR-FORMAT
 16195                                 THRU 9900-EXIT
 16196     END-IF
 16197     EVALUATE TRUE
 16198        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16199           CONTINUE
 16200*       WHEN PB-C-AH-REF-CALC = +0 AND
 16201*                  PB-C-AH-CANCEL-AMT > +0
 16202        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16203                   PB-C-AH-REF-CALC > +0
 16204           CONTINUE
 16205        WHEN WS-AH-REFUND-OVS-AMT = +0
 16206                AND WS-TOL-AH-REFUND = +0
 16207           CONTINUE
 16208        WHEN OTHER
 16209           IF WS-TOL-AH-REFUND = +0
 16210              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16211           END-IF
 16212           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16213               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16214                                         PB-C-AH-CANCEL-AMT)
 16215              CONTINUE
 16216           ELSE
 16217              IF WS-AH-REFUND-OVS-AMT = +0
 16218                 MOVE +9999999.99 TO
 16219                         WS-AH-REFUND-OVS-AMT
 16220              END-IF
 16221              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16222                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16223                                         PB-C-AH-CANCEL-AMT)
 16224                 CONTINUE
 16225              ELSE
 16226                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16227                    MOVE ER-2754   TO  WS-ERROR
 16228                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16229                 ELSE
 16230                    MOVE ER-2736   TO  WS-ERROR
 16231                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16232                 END-IF
 16233              END-IF
 16234           END-IF
 16235     END-EVALUATE.
 16236
 16237     EVALUATE TRUE
 16238        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 295
* EL050.cbl
 16239           CONTINUE
 16240*       WHEN PB-C-AH-REF-CALC > +0 AND
 16241*                  PB-C-AH-CANCEL-AMT = +0
 16242        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16243                   PB-C-AH-REF-CALC = +0
 16244           CONTINUE
 16245        WHEN OTHER
 16246           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16247               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16248              CONTINUE
 16249           ELSE
 16250              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16251                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16252                 CONTINUE
 16253              ELSE
 16254                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16255                     MOVE ER-2754   TO  WS-ERROR
 16256                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16257                 ELSE
 16258                     MOVE ER-2736   TO  WS-ERROR
 16259                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16260                 END-IF
 16261              END-IF
 16262           END-IF
 16263     END-EVALUATE.
 16264
 16265     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16266        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16267        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16268           AND  PB-C-LF-REF-CALC < +1.00
 16269           AND  PB-C-AH-REF-CALC < +1.00
 16270           CONTINUE
 16271        ELSE
 16272           IF (PB-COMPANY-ID = 'DCC')
 16273              AND (PB-CI-ENTRY-STATUS = 'M')
 16274              CONTINUE
 16275           ELSE
 16276              MOVE ER-2741       TO WS-ERROR
 16277              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16278           END-IF
 16279        END-IF
 16280     END-IF
 16281
 16282     IF (PB-C-LF-CANCEL-AMT = ZERO
 16283        AND WS-LF-BENEFIT-CD NOT = ZERO
 16284        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16285        AND PB-C-LF-REF-CALC NOT = ZERO)
 16286        OR
 16287        (PB-C-LF-CANCEL-AMT = ZERO
 16288        AND WS-LF-BENEFIT-CD NOT = ZERO
 16289        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16290             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16291                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16292                NEXT SENTENCE
 16293             ELSE
 16294                MOVE ER-2739        TO WS-ERROR
 16295                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16296
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 296
* EL050.cbl
 16297     IF (PB-C-AH-CANCEL-AMT = ZERO
 16298        AND WS-AH-BENEFIT-CD NOT = ZERO
 16299        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16300        AND PB-C-AH-REF-CALC NOT = ZERO)
 16301        OR
 16302        (PB-C-AH-CANCEL-AMT = ZERO
 16303        AND WS-AH-BENEFIT-CD NOT = ZERO
 16304        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16305             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16306                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16307                NEXT SENTENCE
 16308             ELSE
 16309                MOVE ER-2738        TO WS-ERROR
 16310                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16311
 16312 3775-OVER-REF-CHK.
 16313
 16314     IF PB-CI-ENTRY-STATUS = '5'
 16315        GO TO 3780-UPDATE-CANCEL-CERT.
 16316
 16317     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16318                              PB-CI-LF-ALT-PREMIUM-AMT.
 16319
 16320     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16321        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16322                                 PB-C-LF-REF-CALC
 16323      ELSE
 16324        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16325                                 PB-C-LF-CANCEL-AMT.
 16326
 16327     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16328        MOVE ER-2755             TO WS-ERROR
 16329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16330
 16331     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16332
 16333     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16334        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16335                                 PB-C-AH-REF-CALC
 16336      ELSE
 16337        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16338                                 PB-C-AH-CANCEL-AMT.
 16339
 16340     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16341        MOVE ER-2778             TO WS-ERROR
 16342        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16343
 16344     IF PB-CI-OB-FLAG NOT = 'Z'
 16345        NEXT SENTENCE
 16346       ELSE
 16347         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16348            MOVE ER-2757           TO WS-ERROR
 16349            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16350
 16351 3780-UPDATE-CANCEL-CERT.
 16352
 16353     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16354        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 297
* EL050.cbl
 16355        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16356
 16357     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16358         MOVE ER-2729              TO WS-ERROR
 16359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16360
 16361     IF PB-CI-LF-BENEFIT-CD = ZERO
 16362         GO TO 3780-UPDATE-CONT-1.
 16363
 16364     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16365         GO TO 3780-UPDATE-CONT-1.
 16366
 16367     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16368       AND
 16369        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16370       AND
 16371        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16372       AND
 16373        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16374            NEXT SENTENCE
 16375       ELSE
 16376        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16377          AND
 16378***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16379***       AND
 16380           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16381            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16382               MOVE ER-2730      TO WS-ERROR
 16383               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16384               GO TO 3999-END-EDIT
 16385            ELSE
 16386               GO TO 3999-END-EDIT
 16387        ELSE
 16388            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16389               MOVE ER-2765           TO WS-ERROR
 16390               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16391               GO TO 3785-CHECK-NH.
 16392*              GO TO 3999-END-EDIT.
 16393
 16394 3780-UPDATE-CONT-1.
 16395     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16396
 16397     IF PB-CI-AH-BENEFIT-CD = ZERO
 16398         GO TO 3780-UPDATE-CONT-2.
 16399
 16400     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16401         GO TO 3780-UPDATE-CONT-2.
 16402
 16403     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16404
 16405     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16406       AND
 16407        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16408       AND
 16409        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16410       AND
 16411        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16412            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 298
* EL050.cbl
 16413       ELSE
 16414        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16415          AND
 16416***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16417***       AND
 16418           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16419           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16420            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16421               MOVE ER-2773      TO WS-ERROR
 16422               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16423               GO TO 3999-END-EDIT
 16424            ELSE
 16425               GO TO 3999-END-EDIT
 16426            END-IF
 16427           ELSE
 16428             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16429                MOVE ER-2890 TO WS-ERROR
 16430                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16431                GO TO 3999-END-EDIT
 16432             ELSE
 16433                GO TO 3785-CHECK-NH
 16434             END-IF
 16435           END-IF
 16436          ELSE
 16437            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16438              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16439                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16440                   MOVE ER-2890 TO WS-ERROR
 16441                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16442                   GO TO 3999-END-EDIT
 16443                ELSE
 16444                   MOVE ER-2765 TO WS-ERROR
 16445                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16446                   GO TO 3785-CHECK-NH
 16447                END-IF
 16448              ELSE
 16449               MOVE ER-2765      TO WS-ERROR
 16450               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16451               GO TO 3785-CHECK-NH.
 16452*              GO TO 3999-END-EDIT.
 16453
 16454 3780-UPDATE-CONT-2.
 16455
 16456     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16457        AND WS-LF-BENEFIT-CD = ZERO
 16458           MOVE ER-2743           TO WS-ERROR
 16459           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16460
 16461     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16462        AND WS-AH-BENEFIT-CD = ZERO
 16463           MOVE ER-2744           TO WS-ERROR
 16464           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16465
 16466     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16467        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16468        AND
 16469        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16470         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 299
* EL050.cbl
 16471           MOVE ER-2746           TO WS-ERROR
 16472           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16473
 16474     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16475       AND
 16476        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16477             MOVE ER-2737        TO WS-ERROR
 16478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16479
 16480     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16481       AND
 16482        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16483             MOVE ER-2737        TO WS-ERROR
 16484             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16485
 16486     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16487         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16488             OR 'CID' OR 'DCC'
 16489             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16490         ELSE
 16491             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16492                 MOVE ER-2768    TO WS-ERROR
 16493                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16494             ELSE
 16495                 MOVE ER-2756    TO WS-ERROR
 16496                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16497
 16498     IF CERT-PEND-ISSUE-RETURNED
 16499        MOVE ER-2772             TO WS-ERROR
 16500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16501 3785-CHECK-NH.
 16502     IF PB-STATE NOT = 'NH'
 16503        GO TO 3999-END-EDIT
 16504     END-IF
 16505
 16506     MOVE ER-2796                TO WS-ERROR
 16507     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16508     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16509        OR (CM-NH-INTERFACE-SW = 'Y')
 16510        MOVE ER-2793             TO WS-ERROR
 16511        PERFORM 9900-ERROR-FORMAT
 16512                                 THRU 9900-EXIT
 16513     END-IF
 16514     MOVE +0                     TO WS-PAYMENT-AMT
 16515     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16516        GO TO 3999-END-EDIT
 16517     END-IF
 16518     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16519        GO TO 3999-END-EDIT
 16520     END-IF
 16521     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16522     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16523     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16524        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16525     END-IF
 16526     MOVE '1'                    TO DC-OPTION-CODE
 16527     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16528     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 300
* EL050.cbl
 16529        IF DC-ELAPSED-DAYS < +16
 16530           GO TO 3999-END-EDIT
 16531        END-IF
 16532     END-IF
 16533     MOVE +0                     TO DC-ELAPSED-DAYS
 16534     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16535     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16536     MOVE '1'                    TO DC-OPTION-CODE
 16537     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16538     IF NO-CONVERSION-ERROR
 16539        IF DC-ELAPSED-DAYS > +30
 16540           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16541        ELSE
 16542           GO TO 3999-END-EDIT
 16543        END-IF
 16544     ELSE
 16545        GO TO 3999-END-EDIT
 16546     END-IF
 16547     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16548        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16549           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16550     IF WS-PAYMENT-AMT < 600.00
 16551        GO TO 3999-END-EDIT
 16552     END-IF
 16553     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16554
 16555     IF (ERMAIL-FOUND = ' ')
 16556         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16557         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16558        GO TO 3999-END-EDIT
 16559     END-IF
 16560     MOVE ER-2795                TO WS-ERROR
 16561     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16562
 16563     GO TO 3999-END-EDIT.
 16564******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 301
* EL050.cbl
 16566 3990-FILES-NOT-OPEN.
 16567
 16568     MOVE ER-2617                TO WS-ERROR.
 16569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16570     GO TO 9990-RETURN.
 16571
 16572 3999-END-EDIT.
 16573
 16574     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16575
 16576     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16577         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16578         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16579             PERFORM 9250-UNLOCK-RETURN
 16580             GO TO 9990-RETURN
 16581          ELSE
 16582             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16583             GO TO 9990-RETURN.
 16584
 16585     IF PB-CANCELLATION
 16586          GO TO 9990-RETURN.
 16587
 16588     IF CERT-WAS-NOT-FOUND
 16589        MOVE SPACES              TO CERTIFICATE-MASTER.
 16590
 16591     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16592
 16593     IF CERT-WAS-FOUND
 16594         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16595             PERFORM 9250-UNLOCK-RETURN
 16596          ELSE
 16597            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16598      ELSE
 16599         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16600
 16601     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16602        IF PB-COMPANY-ID = 'DCC' AND
 16603           (PB-CARRIER = '2' OR '4' OR '6')
 16604              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16605        END-IF
 16606     END-IF.
 16607
 16608     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16609     IF ((PB-COMPANY-ID = 'DCC')
 16610        AND (WS-NO-SECURE-PAY))
 16611                  OR
 16612        (WS-LF-SPECIAL-CALC-CD = 'O'
 16613        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16614        SET SKIP-ADDR-EDIT       TO TRUE
 16615     END-IF
 16616     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16617        AND (NOT SKIP-ADDR-EDIT)
 16618        MOVE ER-2963             TO WS-ERROR
 16619        PERFORM 9900-ERROR-FORMAT
 16620                                 THRU 9900-EXIT
 16621        GO TO 9990-RETURN
 16622     END-IF
 16623     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 302
* EL050.cbl
 16624     IF ERPNDM-FOUND NOT = 'X'
 16625        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16626           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16627           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16628           AND (NOT SKIP-ADDR-EDIT)
 16629           MOVE ER-2694          TO WS-ERROR
 16630           PERFORM 9900-ERROR-FORMAT
 16631                                 THRU 9900-EXIT
 16632        END-IF
 16633        MOVE ' '                 TO STATE-RECORD-ERROR
 16634        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16635        MOVE PM-STATE            TO CNTL-ACCESS
 16636        MOVE '3'                 TO CNTL-REC-TYPE
 16637        MOVE +0                  TO CNTL-SEQ-NO
 16638        MOVE '0'                 TO RC-SW-2
 16639        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16640        IF (NO-STATE-RECORD)
 16641           OR (CF-RECORD-TYPE NOT = '3')
 16642           OR (PM-STATE NOT = CF-STATE-CODE)
 16643           IF (PM-STATE = SPACES)
 16644              AND (SKIP-ADDR-EDIT)
 16645              CONTINUE
 16646           ELSE
 16647              MOVE ER-2963       TO WS-ERROR
 16648              PERFORM 9900-ERROR-FORMAT
 16649                                 THRU 9900-EXIT
 16650           END-IF
 16651        END-IF
 16652        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16653           MOVE ER-2883          TO WS-ERROR
 16654           PERFORM 9900-ERROR-FORMAT
 16655                                 THRU 9900-EXIT
 16656        END-IF
 16657        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16658           MOVE ' '                 TO STATE-RECORD-ERROR
 16659           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16660           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16661           MOVE '3'                 TO CNTL-REC-TYPE
 16662           MOVE +0                  TO CNTL-SEQ-NO
 16663           MOVE '0'                 TO RC-SW-2
 16664           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16665           IF NO-STATE-RECORD
 16666              OR (CF-RECORD-TYPE NOT = '3')
 16667              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16668              MOVE ER-2964          TO WS-ERROR
 16669              PERFORM 9900-ERROR-FORMAT
 16670                                    THRU 9900-EXIT
 16671           END-IF
 16672        END-IF
 16673     ELSE
 16674        IF NOT SKIP-ADDR-EDIT
 16675           MOVE ER-2393          TO WS-ERROR
 16676           PERFORM 9900-ERROR-FORMAT
 16677                                 THRU 9900-EXIT
 16678        END-IF
 16679     END-IF
 16680
 16681     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 303
* EL050.cbl
 16682
 16683     IF (ERMAIL-FOUND = ' ' AND
 16684        ERPNDM-FOUND = ' ')
 16685        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16686           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16687           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16688          OR
 16689           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16690          OR
 16691           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16692           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16693           GO TO 3999-UNLOCK-ERMAIL.
 16694
 16695     IF ERPNDM-FOUND = 'X'
 16696        GO TO 3999-UNLOCK-ERMAIL.
 16697
 16698     IF PM-INSURED-LAST-NAME      = SPACES
 16699        AND PM-INSURED-FIRST-NAME = SPACES
 16700        AND PM-ADDRESS-LINE-1     = SPACES
 16701        AND PM-ADDRESS-LINE-2     = SPACES
 16702        AND PM-CITY-STATE         = SPACES
 16703        AND PM-CRED-BENE-NAME     = SPACES
 16704        AND PM-CRED-BENE-ADDR     = SPACES
 16705        AND PM-CRED-BENE-CTYST    = SPACES
 16706        GO TO 3999-UNLOCK-ERMAIL
 16707     END-IF
 16708
 16709     MOVE SPACES                 TO MAILING-DATA.
 16710
 16711     MOVE 'MA'                   TO MA-RECORD-ID.
 16712     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16713     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16714     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16715     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16716     MOVE PB-SV-STATE            TO MA-STATE.
 16717     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16718     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16719
 16720     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16721     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16722
 16723     IF ERMAIL-FOUND = ' '
 16724        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16725     ELSE
 16726        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16727        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16728        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16729
 16730     GO TO 9990-RETURN.
 16731
 16732 3999-UNLOCK-ERMAIL.
 16733     IF ERMAIL-FOUND = ' '
 16734        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16735
 16736     GO TO 9990-RETURN.
 16737******************************************************************
 16738
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 304
* EL050.cbl
 16740 4000-UPDATE-CANCELLED-CERT.
 16741     IF CERT-WAS-NOT-FOUND
 16742        GO TO 4299-EXIT.
 16743
 16744*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16745     IF PB-C-NH-INT-ON-REFS > ZEROS
 16746        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16747     END-IF
 16748     IF PB-C-REF-INTERFACE-SW = 'Y'
 16749        MOVE PB-C-REF-INTERFACE-SW
 16750                                 TO CM-NH-INTERFACE-SW
 16751     END-IF
 16752     IF PB-C-POST-CARD-IND = 'Y'
 16753        MOVE +8                  TO SUB
 16754        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16755        IF ERMAIL-FOUND = ' '
 16756           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16757              (SUB > +7)
 16758              OR (MA-MAIL-STATUS (SUB) = '1')
 16759           END-PERFORM
 16760        END-IF
 16761        IF (SUB > +7)
 16762           OR (ERMAIL-FOUND = 'X')
 16763           MOVE ER-3789          TO WS-ERROR
 16764           PERFORM 9900-ERROR-FORMAT
 16765                                 THRU 9900-EXIT
 16766        END-IF
 16767     ELSE
 16768        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16769     END-IF
 16770     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16771
 16772     IF PB-CI-OB-FLAG = 'Z'
 16773        GO TO 4150-SUMMARY-CERT-CANCEL.
 16774
 16775     IF PB-C-LF-CANCEL-VOIDED
 16776         PERFORM 4200-REVERSE-LF-CANCEL.
 16777     IF PB-C-AH-CANCEL-VOIDED
 16778         PERFORM 4200-REVERSE-AH-CANCEL.
 16779
 16780 4100-APPLY-LF-CANCEL.
 16781
 16782     MOVE +0                     TO WS-SUB.
 16783
 16784 4100-CHECK-LF-ERRORS.
 16785
 16786     ADD +1                       TO WS-SUB.
 16787
 16788     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16789        IF LF-COVERAGE-CANCELLED
 16790           GO TO 4100-LF-CANCEL-CONT
 16791        ELSE
 16792           GO TO 4100-UPDATE-LF-COVERAGE.
 16793
 16794     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16795                                   ER-2729 OR
 16796                                   ER-2730 OR
 16797                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 305
* EL050.cbl
 16798                                   ER-2732 OR
 16799                                   ER-2737 OR
 16800                                   ER-2740 OR
 16801                                   ER-2743 OR
 16802                                   ER-2749 OR
 16803                                   ER-2750 OR
 16804                                   ER-2755 OR
 16805                                   ER-2757 OR
 16806                                   ER-2760 OR
 16807                                   ER-2772 OR
 16808                                   ER-2774 OR
 16809                                   ER-2776 OR
 16810                                   ER-2794
 16811        GO TO 4100-UPDATE-LF-COVERAGE.
 16812
 16813     GO TO 4100-CHECK-LF-ERRORS.
 16814
 16815 4100-UPDATE-LF-COVERAGE.
 16816
 16817     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16818     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16819     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16820        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16821     END-IF
 16822     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16823                                      TO CM-CREDIT-INTERFACE-SW-2.
 16824     IF CM-LF-CANCEL-DT = LOW-VALUE
 16825         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16826
 16827     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16828         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16829                                         CM-LF-STATUS-AT-CANCEL.
 16830
 16831     GO TO 4100-APPLY-AH-CANCEL.
 16832
 16833 4100-LF-CANCEL-CONT.
 16834     IF PB-C-LF-CANCEL-VOIDED
 16835         GO TO 4100-APPLY-AH-CANCEL.
 16836
 16837     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16838         GO TO 4100-APPLY-AH-CANCEL.
 16839
 16840     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16841        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16842           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16843        ELSE
 16844           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16845
 16846     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16847     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16848
 16849     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16850         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16851
 16852     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16853        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16854         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16855         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 306
* EL050.cbl
 16856
 16857     IF PB-RECORD-RETURNED
 16858        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16859      ELSE
 16860        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16861
 16862 4100-APPLY-AH-CANCEL.
 16863
 16864     MOVE +0                      TO WS-SUB.
 16865
 16866 4100-CHECK-AH-ERRORS.
 16867
 16868     ADD +1                       TO WS-SUB.
 16869
 16870     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16871        IF AH-COVERAGE-CANCELLED
 16872           GO TO 4100-AH-CANCEL-CONT
 16873        ELSE
 16874           GO TO 4100-UPDATE-AH-COVERAGE.
 16875
 16876     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16877                                   ER-2729 OR
 16878                                   ER-2732 OR
 16879                                   ER-2737 OR
 16880                                   ER-2740 OR
 16881                                   ER-2744 OR
 16882                                   ER-2749 OR
 16883                                   ER-2750 OR
 16884                                   ER-2755 OR
 16885                                   ER-2757 OR
 16886                                   ER-2760 OR
 16887                                   ER-2771 OR
 16888                                   ER-2772 OR
 16889                                   ER-2773 OR
 16890                                   ER-2775 OR
 16891                                   ER-2777 OR
 16892                                   ER-2794
 16893        GO TO 4100-UPDATE-AH-COVERAGE.
 16894
 16895     GO TO 4100-CHECK-AH-ERRORS.
 16896
 16897 4100-UPDATE-AH-COVERAGE.
 16898
 16899     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16900     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16901     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16902     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16903                                      TO CM-CREDIT-INTERFACE-SW-2.
 16904     IF CM-AH-CANCEL-DT = LOW-VALUE
 16905         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16906
 16907     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16908         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16909                                         CM-AH-STATUS-AT-CANCEL.
 16910
 16911     IF LF-COVERAGE-CANCELLED
 16912         IF PB-RECORD-RETURNED
 16913              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 307
* EL050.cbl
 16914          ELSE
 16915              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16916
 16917     GO TO 4299-EXIT.
 16918
 16919 4100-AH-CANCEL-CONT.
 16920     IF PB-C-AH-CANCEL-VOIDED
 16921         GO TO 4299-EXIT.
 16922
 16923     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16924         GO TO 4299-EXIT.
 16925
 16926     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16927        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16928           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16929        ELSE
 16930           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16931
 16932     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16933     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16934
 16935     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16936         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16937
 16938     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16939         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16940         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16941
 16942     IF PB-RECORD-RETURNED
 16943        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16944      ELSE
 16945        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16946
 16947     GO TO 4299-EXIT.
 16948
 16949 4150-SUMMARY-CERT-CANCEL.
 16950     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16951
 16952     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16953        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16954                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16955     ELSE
 16956        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16957                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16958
 16959     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16960        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16961                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16962     ELSE
 16963        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16964                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16965
 16966     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16967        NEXT SENTENCE
 16968     ELSE
 16969        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16970
 16971     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 308
* EL050.cbl
 16972
 16973 4200-REVERSE-LF-CANCEL.
 16974     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 16975
 16976     IF CM-LF-CANCEL-APPLIED
 16977        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16978        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16979        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16980
 16981     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16982
 16983     IF PB-RECORD-RETURNED
 16984        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16985       ELSE
 16986        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16987
 16988 4200-REVERSE-LF-EXIT.
 16989       EXIT.
 16990
 16991 4200-REVERSE-AH-CANCEL.
 16992     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 16993
 16994     IF CM-AH-CANCEL-APPLIED
 16995        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 16996        MOVE SPACES                TO CM-AH-EXIT-BATCH
 16997        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 16998
 16999     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17000
 17001     IF PB-RECORD-RETURNED
 17002        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17003       ELSE
 17004        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17005
 17006 4200-REVERSE-AH-EXIT.
 17007       EXIT.
 17008
 17009 4299-EXIT.
 17010       EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 309
* EL050.cbl
 17012
 17013 4500-UPDATE-NEW-CERT.
 17014     IF CERT-WAS-FOUND
 17015         NEXT SENTENCE
 17016       ELSE
 17017         GO TO 4520-BUILD-NEW-KEY.
 17018
 17019     IF  CLASIC-CREATED-CERT
 17020         GO TO 4999-EXIT.
 17021
 17022     IF  CERT-WAS-CREATED-FOR-CLAIM
 17023         GO TO 4520-BUILD-NEW-KEY.
 17024
 17025     IF CERT-ADDED-BATCH
 17026        IF CM-RECORD-ID = 'CM'
 17027            GO TO 4999-EXIT.
 17028
 17029 4520-BUILD-NEW-KEY.
 17030* BUILD CONTROL PRIMARY
 17031
 17032     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17033                                       CM-COMPANY-CD-A1
 17034                                       CM-COMPANY-CD-A2
 17035                                       CM-COMPANY-CD-A4
 17036                                       CM-COMPANY-CD-A5.
 17037
 17038     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17039     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17040     MOVE PB-SV-STATE               TO CM-STATE.
 17041     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17042     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17043     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17044     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17045
 17046     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17047
 17048     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17049     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17050     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17051     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17052
 17053     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17054        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17055
 17056     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17057         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17058         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17059         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17060         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17061     ELSE
 17062         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17063
 17064     IF PB-COMPANY-ID   EQUAL  'CRI'
 17065         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17066         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17067         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17068         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17069         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 310
* EL050.cbl
 17070
 17071     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17072        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17073         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17074
 17075     IF PB-COMPANY-ID  = 'LBL'
 17076        IF PB-I-JOINT-COVERAGE
 17077            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17078                                           PB-I-MEMBER-NO
 17079            GO TO 4550-CONT-CERT-PROCESS.
 17080
 17081     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17082        NEXT SENTENCE
 17083     ELSE
 17084        GO TO 4540-BUILD-MEMBER-NO.
 17085
 17086******************************************************************
 17087*                                                                *
 17088*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17089*    FOR 'MON'.                                                  *
 17090*                                                                *
 17091******************************************************************
 17092
 17093     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17094     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17095     MOVE +1                     TO WS-SUB1
 17096                                    WS-SUB2.
 17097
 17098 4530-EDIT-MEMB-NAME.
 17099
 17100     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17101        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17102        ADD +1                       TO WS-SUB2.
 17103
 17104     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17105        ADD +1                       TO WS-SUB1
 17106        GO TO 4530-EDIT-MEMB-NAME.
 17107
 17108     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17109     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17110     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17111*    MOVE SPACE                      TO DC-OPTION-CODE.
 17112     SET  BIN-TO-GREG                TO TRUE.
 17113     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17114     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17115
 17116     GO TO 4550-CONT-CERT-PROCESS.
 17117
 17118******************************************************************
 17119*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17120******************************************************************
 17121
 17122 4540-BUILD-MEMBER-NO.
 17123
 17124     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17125         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17126         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17127         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 311
* EL050.cbl
 17128         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17129     ELSE
 17130         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17131
 17132     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17133        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17134         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17135
 17136 4550-CONT-CERT-PROCESS.
 17137
 17138*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17139*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17140*    ELSE
 17141*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17142
 17143     IF CERT-WAS-CREATED-FOR-CLAIM
 17144        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17145        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17146
 17147     IF CERT-AND-CLAIM-ONLINE
 17148        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17149        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17150
 17151     MOVE 'CM'                     TO CM-RECORD-ID.
 17152     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17153
 17154     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17155        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17156        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17157     ELSE
 17158        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17159        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17160
 17161     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17162     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17163     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17164     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17165     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17166     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17167     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17168                                      CM-LF-ITD-CANCEL-AMT
 17169                                      CM-LF-ITD-DEATH-AMT
 17170                                      CM-AH-ITD-AH-PMT
 17171                                      CM-AH-ITD-LUMP-PMT
 17172                                      CM-AH-ITD-CANCEL-AMT
 17173                                      CM-LF-NSP-PREMIUM-AMT
 17174                                      CM-AH-NSP-PREMIUM-AMT.
 17175*                                     CM-CLAIM-DEDUCT-WITHHELD
 17176*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17177     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17178     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17179     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17180     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17181     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17182     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17183     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17184     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17185     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 312
* EL050.cbl
 17186     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17187     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17188     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17189
 17190     IF PB-I-LIVES NOT NUMERIC
 17191         MOVE ZERO                 TO PB-I-LIVES.
 17192
 17193     IF PB-I-NUM-BILLED NOT NUMERIC
 17194         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17195
 17196     MOVE PB-I-LIVES               TO CM-LIVES.
 17197     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17198
 17199     IF PB-COMPANY-ID EQUAL  'DMD'
 17200         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17201         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17202
 17203     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17204     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17205     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17206     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17207     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17208     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17209
 17210     IF PB-I-LF-POLICY-FEE NUMERIC
 17211        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17212     ELSE
 17213        MOVE +0                    TO CM-LF-POLICY-FEE.
 17214
 17215     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17216        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17217        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17218     ELSE
 17219        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17220
 17221     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17222     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17223     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17224     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17225     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17226     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17227     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17228     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17229     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17230
 17231     IF PB-I-AH-POLICY-FEE NUMERIC
 17232        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17233     ELSE
 17234        MOVE +0                    TO CM-AH-POLICY-FEE.
 17235
 17236     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17237        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17238     ELSE
 17239        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17240
 17241     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17242     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17243
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 313
* EL050.cbl
 17244     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17245                                      CM-LF-DEATH-EXIT-DT
 17246                                      CM-AH-SETTLEMENT-EXIT-DT.
 17247
 17248*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17249*                       'TIH' OR 'OFL' OR 'FLA' OR
 17250*                       'TII' OR 'TMS' OR 'CRI' OR
 17251*                       'NCL'
 17252     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17253
 17254     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17255         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17256            MOVE '2'                TO CM-PREMIUM-TYPE.
 17257
 17258     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17259         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17260            MOVE '2'                TO CM-PREMIUM-TYPE.
 17261
 17262     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17263         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17264     ELSE
 17265         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17266         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17267
 17268     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17269     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17270     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17271     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17272     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17273     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17274     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17275     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17276
 17277     IF PB-NO-MONTHS-SKIPPED
 17278         MOVE SPACE                 TO CM-SKIP-CODE
 17279     ELSE
 17280         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17281
 17282     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17283     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17284                                       CM-LF-STATUS-AT-CANCEL.
 17285
 17286     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17287     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17288                                       CM-AH-STATUS-AT-CANCEL.
 17289
 17290     MOVE '1'                       TO CM-ENTRY-STATUS.
 17291
 17292     IF PB-REISSUED-CERT
 17293        MOVE '5'                    TO CM-ENTRY-STATUS.
 17294
 17295     IF PB-MONTHLY-CERT
 17296        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17297
 17298     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17299     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17300     IF PB-POLICY-IS-DECLINED
 17301        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 314
* EL050.cbl
 17302
 17303     IF PB-POLICY-IS-VOIDED
 17304        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17305
 17306     IF PB-NEEDS-UNDERWRITING
 17307        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17308
 17309     IF PB-REIN-ONLY-CERT
 17310        MOVE '9'                    TO CM-ENTRY-STATUS.
 17311
 17312     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17313         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17314     ELSE
 17315         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17316
 17317     IF PB-RECORD-RETURNED
 17318        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17319      ELSE
 17320        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17321
 17322     IF PB-I-MAIL-ADDRS-PRESENT
 17323        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17324
 17325     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17326                                       CM-ENTRY-DT.
 17327
 17328 4999-EXIT.
 17329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 315
* EL050.cbl
 17331
 17332 5000-PROCESS-REPS.
 17333     MOVE ' '                    TO AGTC-MASTER-SW
 17334     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17335     MOVE CO-TYPE                TO AGTC-TYPE
 17336     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17337     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17338     IF (AGTC-MASTER-SW NOT = 'N')
 17339        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17340        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17341        PERFORM 8583-READ-ERAGTC-NEXT
 17342                                 THRU 8583-EXIT
 17343     END-IF
 17344     IF AGTC-MASTER-SW = 'N'
 17345        CONTINUE
 17346     ELSE
 17347        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17348           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17349              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17350              MOVE 'Y'           TO AGTC-MASTER-SW
 17351           END-IF
 17352        END-IF
 17353     END-IF
 17354     .
 17355 5000-EXIT.
 17356     EXIT.
 17357 6370-EDIT-INPUT-LF-CODE.
 17358     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17359        MOVE +1                  TO SUB
 17360        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17361        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17362        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17363        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17364        GO TO 6370-SEARCH-LOOP.
 17365
 17366     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17367
 17368     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17369     MOVE SPACES                 TO CNTL-ACCESS.
 17370*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17371     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17372     MOVE +0                     TO CNTL-SEQ-NO.
 17373     MOVE '4' TO RC-SW-2.
 17374     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17375
 17376     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17377        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17378        GO TO 6370-NO-LF-FOUND.
 17379
 17380     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17381     MOVE +1                     TO SUB.
 17382
 17383 6370-SEARCH-LOOP.
 17384     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17385         GO TO 6370-NO-LF-FOUND.
 17386
 17387     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17388         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 316
* EL050.cbl
 17389         GO TO 6370-HER-NET-PAY-CHECK.
 17390
 17391     ADD 1   TO SUB.
 17392*    IF SUB GREATER 120
 17393     IF SUB GREATER 200
 17394         GO TO 6370-NO-LF-FOUND.
 17395
 17396     GO TO 6370-SEARCH-LOOP.
 17397
 17398 6370-NO-LF-FOUND.
 17399
 17400     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17401
 17402 6370-HER-NET-PAY-CHECK.
 17403
 17404     IF PB-COMPANY-ID = 'CID'
 17405        IF PB-SV-STATE = 'CA' OR 'MN'
 17406           IF PB-I-LF-BENEFIT-CD = '02'
 17407              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17408           ELSE
 17409              IF PB-I-LF-BENEFIT-CD = '04'
 17410                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17411              END-IF
 17412           END-IF
 17413        END-IF
 17414     END-IF
 17415
 17416     IF PB-COMPANY-ID NOT = 'HER'
 17417         GO TO 6370-EXIT.
 17418
 17419     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17420         GO TO 6370-EXIT.
 17421
 17422     IF PB-I-LF-TERM NOT NUMERIC
 17423         MOVE ZEROS              TO PB-I-LF-TERM.
 17424
 17425     IF PB-I-LOAN-TERM NOT NUMERIC
 17426         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17427
 17428     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17429         GO TO 6370-EXIT.
 17430
 17431     IF PB-I-LF-BENEFIT-CD = '33'
 17432         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17433
 17434     IF PB-I-LF-BENEFIT-CD = '34'
 17435         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17436
 17437 6370-EXIT.
 17438     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 317
* EL050.cbl
 17440
 17441 6380-EDIT-INPUT-AH-CODE.
 17442     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17443        MOVE +1                  TO SUB
 17444        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17445        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17446        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17447        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17448        GO TO 6380-SEARCH-LOOP.
 17449
 17450     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17451
 17452     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17453     MOVE SPACES                 TO CNTL-ACCESS.
 17454     MOVE 'A'                    TO CNTL-REC-TYPE.
 17455*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17456     MOVE +0                     TO CNTL-SEQ-NO.
 17457     MOVE '5' TO RC-SW-2.
 17458     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17459
 17460     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17461        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17462        GO TO 6380-NO-AH-FOUND.
 17463
 17464     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17465     MOVE +1 TO SUB.
 17466
 17467 6380-SEARCH-LOOP.
 17468     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17469         GO TO 6380-NO-AH-FOUND.
 17470
 17471     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17472         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17473         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17474
 17475     ADD 1   TO SUB.
 17476     IF SUB GREATER THAN 96
 17477*    IF SUB GREATER THAN 300
 17478         GO TO 6380-NO-AH-FOUND.
 17479
 17480     GO TO 6380-SEARCH-LOOP.
 17481
 17482 6380-NO-AH-FOUND.
 17483
 17484     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17485
 17486     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17487         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17488     ELSE
 17489         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17490
 17491 6380-CSO-AH-ONLY-CHECKS.
 17492
 17493     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17494        NEXT SENTENCE
 17495      ELSE
 17496        GO TO 6380-EXIT.
 17497
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 318
* EL050.cbl
 17498     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17499         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17500
 17501
 17502     GO TO 6380-EXIT
 17503     .
 17504 6380-CSO-LIFE-WITH-AH-CHECKS.
 17505
 17506
 17507     .
 17508 6380-EXIT.
 17509     EXIT.
 17510
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 319
* EL050.cbl
 17512
 17513 6400-COMPUTE-EXTENSION-DAYS.
 17514
 17515******************************************************************
 17516*                                                                *
 17517*                   COMPUTE EXTENSION DAYS                       *
 17518*                                                                *
 17519*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17520*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17521*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17522*    THE EXTENSION DAYS.                                         *
 17523*                                                                *
 17524******************************************************************
 17525
 17526     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17527     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17528
 17529******************************************************************
 17530*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17531*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17532******************************************************************
 17533
 17534     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17535        COMPUTE WS-ODD-DAYS-OVER =
 17536               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17537     ELSE
 17538        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17539
 17540     IF WS-ODD-DAYS-OVER = ZEROS
 17541           GO TO 6499-EXIT
 17542     ELSE
 17543        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17544           IF WS-WDF-MONTH = 02
 17545              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17546              ADD 2       TO  WS-ODD-DAYS-OVER
 17547              GO TO 6499-EXIT
 17548           ELSE
 17549              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17550                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17551                 GO TO 6499-EXIT
 17552               ELSE
 17553                 GO TO 6499-EXIT
 17554        ELSE
 17555           GO TO 6499-EXIT.
 17556
 17557 6412-CHECK-TO-DAY.
 17558
 17559        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17560           IF WS-WDT-DAY = 28
 17561              ADD 2              TO WS-ODD-DAYS-OVER
 17562           ELSE
 17563              IF WS-WDT-DAY = 29
 17564                 ADD 1           TO WS-ODD-DAYS-OVER
 17565              ELSE
 17566                 NEXT SENTENCE
 17567        ELSE
 17568           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17569              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 320
* EL050.cbl
 17570
 17571     GO TO 6499-EXIT.
 17572
 17573
 17574 6415-CHECK-LEAP-YEAR.
 17575
 17576     IF DC-DAYS-IN-MONTH = 29
 17577        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17578
 17579 6415-EXIT.
 17580     EXIT.
 17581
 17582 6499-EXIT.
 17583      EXIT.
 17584
 17585 6500-END.
 17586     EXIT.
 17587
 17588
 17589******************************************************************
 17590************* PROCEDURE DIVISION FOR EL050 ***********************
 17591********************** ELC50PD END *******************************
 17592
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 321
* EL050.cbl
 17594
 17595**START***********************************************************
 17596*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17597*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17598******************************************************************
 17599*
 17600 6600-GET-STATE-MUNICIPAL-TAX.
 17601
 17602     IF PB-COMPANY-ID NOT = 'DMD'
 17603         GO TO 6640-EXIT.
 17604
 17605     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17606     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17607     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17608*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17609*
 17610***  Y2K PROJ 7744
 17611     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17612     SET BIN-TO-GREG          TO TRUE.
 17613     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17614
 17615     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17616
 17617     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17618     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17619
 17620
 17621* EXEC CICS HANDLE CONDITION
 17622*        INVREQ    (6610-START-BROWSE)
 17623*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17624*        NOTFND    (6630-END-OF-FILE)
 17625*    END-EXEC.
 17626*    MOVE '"$8JI                 ! # #00017608' TO DFHEIV0
 17627     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17629     MOVE X'2320233030303137363038' TO DFHEIV0(25:11)
 17630     CALL 'kxdfhei1' USING DFHEIV0
 17631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17632
 17633
 17634 6610-START-BROWSE.
 17635
 17636
 17637* EXEC CICS HANDLE CONDITION
 17638*        NOTFND    (6630-END-OF-FILE)
 17639*        DISABLED  (6630-ERRESS-PROBLEM)
 17640*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17641*        ENDFILE   (6630-END-OF-FILE)
 17642*    END-EXEC.
 17643*    MOVE '"$IcJ''                ! $ #00017616' TO DFHEIV0
 17644     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17646     MOVE X'2420233030303137363136' TO DFHEIV0(25:11)
 17647     CALL 'kxdfhei1' USING DFHEIV0
 17648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17649
 17650
 17651
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 322
* EL050.cbl
 17652* EXEC CICS STARTBR
 17653*        DATASET (FILE-ID-ERRESS)
 17654*        RIDFLD  (WS-ERRESS-KEY)
 17655*        GTEQ
 17656*    END-EXEC.
 17657     MOVE 0
 17658       TO DFHEIV11
 17659*    MOVE '&,         G          &   #00017623' TO DFHEIV0
 17660     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17661     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17662     MOVE X'2020233030303137363233' TO DFHEIV0(25:11)
 17663     CALL 'kxdfhei1' USING DFHEIV0,
 17664           FILE-ID-ERRESS,
 17665           WS-ERRESS-KEY,
 17666           DFHEIV99,
 17667           DFHEIV11,
 17668           DFHEIV99
 17669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17670
 17671
 17672 6620-READ-NEXT-ERRESS-MASTER.
 17673
 17674
 17675* EXEC CICS HANDLE CONDITION
 17676*        NOTFND    (6630-END-OF-FILE)
 17677*        ENDFILE   (6630-END-OF-FILE)
 17678*        DISABLED  (6630-ERRESS-PROBLEM)
 17679*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17680*    END-EXEC.
 17681*    MOVE '"$I''cJ                ! % #00017631' TO DFHEIV0
 17682     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17684     MOVE X'2520233030303137363331' TO DFHEIV0(25:11)
 17685     CALL 'kxdfhei1' USING DFHEIV0
 17686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17687
 17688
 17689
 17690* EXEC CICS READNEXT
 17691*        DATASET (FILE-ID-ERRESS)
 17692*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17693*        RIDFLD  (WS-ERRESS-KEY)
 17694*    END-EXEC.
 17695     MOVE LENGTH OF
 17696      RESIDENT-STATE-TAX-MASTER
 17697       TO DFHEIV12
 17698     MOVE 0
 17699       TO DFHEIV11
 17700*    MOVE '&.IL                  )   #00017638' TO DFHEIV0
 17701     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17702     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17703     MOVE X'2020233030303137363338' TO DFHEIV0(25:11)
 17704     CALL 'kxdfhei1' USING DFHEIV0,
 17705           FILE-ID-ERRESS,
 17706           RESIDENT-STATE-TAX-MASTER,
 17707           DFHEIV12,
 17708           WS-ERRESS-KEY,
 17709           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 323
* EL050.cbl
 17710           DFHEIV11,
 17711           DFHEIV99,
 17712           DFHEIV99
 17713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17714
 17715
 17716     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17717
 17718* EXEC CICS ENDBR
 17719*            DATASET (FILE-ID-ERRESS)
 17720*       END-EXEC
 17721     MOVE 0
 17722       TO DFHEIV11
 17723*    MOVE '&2                    $   #00017645' TO DFHEIV0
 17724     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17725     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17726     MOVE X'2020233030303137363435' TO DFHEIV0(25:11)
 17727     CALL 'kxdfhei1' USING DFHEIV0,
 17728           FILE-ID-ERRESS,
 17729           DFHEIV11,
 17730           DFHEIV99
 17731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17732        GO TO 6630-END-OF-FILE.
 17733
 17734     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17735        NEXT SENTENCE
 17736      ELSE
 17737        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17738
 17739*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17740*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17741*
 17742     MOVE +2                     TO WS-SUB1.
 17743
 17744     IF PB-ISSUE
 17745     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17746        MOVE +1                  TO WS-SUB1.
 17747
 17748     IF PB-CANCELLATION
 17749     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17750        MOVE +1                  TO WS-SUB1.
 17751*
 17752*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17753*
 17754***  Y2K PROJ 7744
 17755     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17756***  Y2K PROJ 7744
 17757
 17758*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17759* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17760* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17761
 17762     ADD 1                    TO WS-YEAR-YY.
 17763
 17764     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17765         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17766                              TO WS-RES-STATE-TAX
 17767         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 324
* EL050.cbl
 17768                              TO WS-RES-MUNI-TAX
 17769     ELSE
 17770         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17771                              TO WS-RES-STATE-TAX
 17772         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17773                              TO WS-RES-MUNI-TAX.
 17774
 17775*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17776
 17777     IF PB-CANCELLATION
 17778         GO TO 6640-CANCEL-TAX.
 17779
 17780     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17781         COMPUTE PB-I-STATE-TAX ROUNDED =
 17782                                   PB-I-LF-PREMIUM-AMT
 17783                                 * WS-RES-STATE-TAX
 17784         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17785                                   PB-I-LF-PREMIUM-AMT
 17786                                 * WS-RES-MUNI-TAX
 17787     ELSE
 17788     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17789         COMPUTE PB-I-STATE-TAX ROUNDED =
 17790                                   PB-I-AH-PREMIUM-AMT
 17791                                 * WS-RES-STATE-TAX
 17792         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17793                                   PB-I-AH-PREMIUM-AMT
 17794                                 * WS-RES-MUNI-TAX.
 17795
 17796
 17797* EXEC CICS ENDBR
 17798*         DATASET (FILE-ID-ERRESS)
 17799*    END-EXEC.
 17800     MOVE 0
 17801       TO DFHEIV11
 17802*    MOVE '&2                    $   #00017712' TO DFHEIV0
 17803     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17804     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17805     MOVE X'2020233030303137373132' TO DFHEIV0(25:11)
 17806     CALL 'kxdfhei1' USING DFHEIV0,
 17807           FILE-ID-ERRESS,
 17808           DFHEIV11,
 17809           DFHEIV99
 17810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17811
 17812
 17813     GO TO 6640-EXIT.
 17814
 17815 6640-CANCEL-TAX.
 17816     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17817
 17818     IF PB-C-LF-CANCEL-AMT > ZEROS
 17819         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17820                                   PB-C-LF-CANCEL-AMT
 17821                                 * WS-RES-STATE-TAX
 17822         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17823                                   PB-C-LF-CANCEL-AMT
 17824                                *  WS-RES-MUNI-TAX
 17825     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 325
* EL050.cbl
 17826     IF PB-C-AH-CANCEL-AMT > ZEROS
 17827         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17828                                   PB-C-AH-CANCEL-AMT
 17829                                 * WS-RES-STATE-TAX
 17830         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17831                                   PB-C-AH-CANCEL-AMT
 17832                                *  WS-RES-MUNI-TAX.
 17833
 17834
 17835* EXEC CICS ENDBR
 17836*         DATASET (FILE-ID-ERRESS)
 17837*    END-EXEC.
 17838     MOVE 0
 17839       TO DFHEIV11
 17840*    MOVE '&2                    $   #00017737' TO DFHEIV0
 17841     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17843     MOVE X'2020233030303137373337' TO DFHEIV0(25:11)
 17844     CALL 'kxdfhei1' USING DFHEIV0,
 17845           FILE-ID-ERRESS,
 17846           DFHEIV11,
 17847           DFHEIV99
 17848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17849
 17850
 17851     GO TO 6640-EXIT.
 17852
 17853 6630-END-OF-FILE.
 17854     MOVE ER-8002              TO WS-ERROR.
 17855     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17856
 17857     GO TO 6640-EXIT.
 17858
 17859 6630-ERRESS-PROBLEM.
 17860     MOVE ER-8044              TO WS-ERROR.
 17861     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17862
 17863 6640-EXIT.
 17864     EXIT.
 17865
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 326
* EL050.cbl
 17867 6650-GET-RES-STATE-COMM.
 17868
 17869     IF PB-COMPANY-ID NOT = 'DMD'
 17870         GO TO 6700-COMM-EXIT.
 17871
 17872     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17873     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17874     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17875     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17876     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17877     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17878     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17879
 17880*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17881*
 17882***  Y2K PROJ 7744
 17883     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17884     SET BIN-TO-GREG          TO TRUE.
 17885     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17886
 17887     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17888***  Y2K PROJ 7744
 17889
 17890     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17891
 17892
 17893* EXEC CICS HANDLE CONDITION
 17894*        INVREQ    (6660-START-BROWSE)
 17895*        DISABLED  (6690-ERRESC-PROBLEM)
 17896*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17897*        NOTFND    (6690-END-OF-FILE)
 17898*    END-EXEC.
 17899*    MOVE '"$8cJI                ! & #00017782' TO DFHEIV0
 17900     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17902     MOVE X'2620233030303137373832' TO DFHEIV0(25:11)
 17903     CALL 'kxdfhei1' USING DFHEIV0
 17904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17905
 17906
 17907
 17908* EXEC CICS RESETBR
 17909*        DATASET (FILE-ID-ERRESC)
 17910*        RIDFLD  (WS-ERRESC-KEY)
 17911*    END-EXEC.
 17912     MOVE 0
 17913       TO DFHEIV11
 17914*    MOVE '&4         G          &   #00017789' TO DFHEIV0
 17915     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17916     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17917     MOVE X'2020233030303137373839' TO DFHEIV0(25:11)
 17918     CALL 'kxdfhei1' USING DFHEIV0,
 17919           FILE-ID-ERRESC,
 17920           WS-ERRESC-KEY,
 17921           DFHEIV99,
 17922           DFHEIV11,
 17923           DFHEIV99
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 327
* EL050.cbl
 17925
 17926
 17927 6660-START-BROWSE.
 17928
 17929
 17930* EXEC CICS HANDLE CONDITION
 17931*        NOTFND    (6690-END-OF-FILE)
 17932*        DISABLED  (6690-ERRESC-PROBLEM)
 17933*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17934*        ENDFILE   (6690-END-OF-FILE)
 17935*    END-EXEC.
 17936*    MOVE '"$IcJ''                ! '' #00017796' TO DFHEIV0
 17937     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17939     MOVE X'2720233030303137373936' TO DFHEIV0(25:11)
 17940     CALL 'kxdfhei1' USING DFHEIV0
 17941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17942
 17943
 17944
 17945* EXEC CICS STARTBR
 17946*        DATASET (FILE-ID-ERRESC)
 17947*        RIDFLD  (WS-ERRESC-KEY)
 17948*        GTEQ
 17949*    END-EXEC.
 17950     MOVE 0
 17951       TO DFHEIV11
 17952*    MOVE '&,         G          &   #00017803' TO DFHEIV0
 17953     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17955     MOVE X'2020233030303137383033' TO DFHEIV0(25:11)
 17956     CALL 'kxdfhei1' USING DFHEIV0,
 17957           FILE-ID-ERRESC,
 17958           WS-ERRESC-KEY,
 17959           DFHEIV99,
 17960           DFHEIV11,
 17961           DFHEIV99
 17962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17963
 17964
 17965     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17966
 17967 6670-READ-NEXT-ERRESC-MASTER.
 17968
 17969
 17970* EXEC CICS HANDLE CONDITION
 17971*        NOTFND    (6690-END-OF-FILE)
 17972*        DISABLED  (6690-ERRESC-PROBLEM)
 17973*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17974*        ENDFILE   (6690-END-OF-FILE)
 17975*    END-EXEC.
 17976*    MOVE '"$IcJ''                ! ( #00017813' TO DFHEIV0
 17977     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17979     MOVE X'2820233030303137383133' TO DFHEIV0(25:11)
 17980     CALL 'kxdfhei1' USING DFHEIV0
 17981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17982
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 328
* EL050.cbl
 17983
 17984
 17985* EXEC CICS READNEXT
 17986*        DATASET (FILE-ID-ERRESC)
 17987*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 17988*        RIDFLD  (ERRESC-RECORD-KEY)
 17989*    END-EXEC.
 17990     MOVE LENGTH OF
 17991      ACCOUNT-RESIDENT-ST-COMMISSION
 17992       TO DFHEIV12
 17993     MOVE 0
 17994       TO DFHEIV11
 17995*    MOVE '&.IL                  )   #00017820' TO DFHEIV0
 17996     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17997     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17998     MOVE X'2020233030303137383230' TO DFHEIV0(25:11)
 17999     CALL 'kxdfhei1' USING DFHEIV0,
 18000           FILE-ID-ERRESC,
 18001           ACCOUNT-RESIDENT-ST-COMMISSION,
 18002           DFHEIV12,
 18003           ERRESC-RECORD-KEY,
 18004           DFHEIV99,
 18005           DFHEIV11,
 18006           DFHEIV99,
 18007           DFHEIV99
 18008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18009
 18010
 18011     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18012        NEXT SENTENCE
 18013     ELSE
 18014
 18015* EXEC CICS ENDBR
 18016*            DATASET (FILE-ID-ERRESC)
 18017*       END-EXEC
 18018     MOVE 0
 18019       TO DFHEIV11
 18020*    MOVE '&2                    $   #00017829' TO DFHEIV0
 18021     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18023     MOVE X'2020233030303137383239' TO DFHEIV0(25:11)
 18024     CALL 'kxdfhei1' USING DFHEIV0,
 18025           FILE-ID-ERRESC,
 18026           DFHEIV11,
 18027           DFHEIV99
 18028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18029        GO TO 6690-END-OF-FILE.
 18030
 18031     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18032
 18033* EXEC CICS ENDBR
 18034*            DATASET (FILE-ID-ERRESC)
 18035*       END-EXEC
 18036     MOVE 0
 18037       TO DFHEIV11
 18038*    MOVE '&2                    $   #00017835' TO DFHEIV0
 18039     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18040     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 329
* EL050.cbl
 18041     MOVE X'2020233030303137383335' TO DFHEIV0(25:11)
 18042     CALL 'kxdfhei1' USING DFHEIV0,
 18043           FILE-ID-ERRESC,
 18044           DFHEIV11,
 18045           DFHEIV99
 18046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18047        GO TO 6690-END-OF-FILE.
 18048
 18049     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18050        NEXT SENTENCE
 18051      ELSE
 18052        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18053
 18054* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18055*
 18056     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18057
 18058     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18059
 18060     IF WS-SUB1 > ZERO
 18061         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18062             PERFORM 6680-SET-COMMISSION
 18063         ELSE
 18064             PERFORM 6680-SET-TABLE-CODE.
 18065
 18066
 18067* EXEC CICS ENDBR
 18068*         DATASET (FILE-ID-ERRESC)
 18069*    END-EXEC.
 18070     MOVE 0
 18071       TO DFHEIV11
 18072*    MOVE '&2                    $   #00017857' TO DFHEIV0
 18073     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18075     MOVE X'2020233030303137383537' TO DFHEIV0(25:11)
 18076     CALL 'kxdfhei1' USING DFHEIV0,
 18077           FILE-ID-ERRESC,
 18078           DFHEIV11,
 18079           DFHEIV99
 18080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18081
 18082
 18083     GO TO 6700-COMM-EXIT.
 18084
 18085 6680-SET-TABLE-CODE.
 18086     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18087        MOVE ZEROS             TO WS-SUB1
 18088     ELSE
 18089* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18090* TO COMPUTE AH COMMISSION.
 18091        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18092        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18093        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18094        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18095        PERFORM 6680-READ-CTBL-TABLE
 18096        IF WS-CTBL-READ-SW NOT = 'Y'
 18097           MOVE ZEROS          TO WS-SUB1.
 18098
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 330
* EL050.cbl
 18099 6680-READ-CTBL-TABLE.
 18100*
 18101* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18102* TO COMPUTE LIFE COMMISSION
 18103
 18104     IF CTBL-SW = '0540'
 18105        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18106        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18107        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18108
 18109     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18110
 18111     IF CTBL-TABLE-FOUND
 18112        IF CTBL-SW = '0530'
 18113             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18114                                    * PB-I-AH-TERM
 18115             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18116             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18117        ELSE
 18118             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18119             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18120             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18121     ELSE
 18122        IF FIRST-TIME-THROUGH
 18123            GO TO 6680-READ-CTBL-TABLE
 18124        ELSE
 18125            MOVE ZEROS         TO WS-SUB1.
 18126
 18127 6680-SET-COMMISSION.
 18128     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18129           MOVE ZEROS          TO WS-SUB1
 18130       ELSE
 18131           MOVE RESC-COMMISSION-PER (WS-SUB)
 18132                               TO WS-COMMISSION
 18133           IF CTBL-SW = '0530'
 18134               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18135           ELSE
 18136               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18137
 18138 6680-SEARCH-CATEGORY.
 18139     ADD +1                   TO WS-SUB.
 18140     IF WS-SUB > +12
 18141         GO TO 6680-EXIT.
 18142
 18143     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18144          MOVE WS-SUB         TO WS-SUB1
 18145          GO TO 6680-EXIT.
 18146
 18147     GO TO 6680-SEARCH-CATEGORY.
 18148
 18149 6680-EXIT.
 18150     EXIT.
 18151
 18152 6690-END-OF-FILE.
 18153     GO TO 6700-COMM-EXIT.
 18154
 18155 6690-ERRESC-PROBLEM.
 18156      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 331
* EL050.cbl
 18157      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18158
 18159      GO TO 6700-COMM-EXIT.
 18160
 18161 6700-COMM-EXIT.
 18162     EXIT.
 18163
 18164 7000-GET-RATE.
 18165
 18166* EXEC CICS LINK
 18167*        PROGRAM    ('ELRATE')
 18168*        COMMAREA   (CALCULATION-PASS-AREA)
 18169*        LENGTH     (CP-COMM-LENGTH)
 18170*    END-EXEC.
 18171     MOVE 'ELRATE' TO DFHEIV1
 18172*    MOVE '."C                   ''   #00017943' TO DFHEIV0
 18173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18175     MOVE X'2020233030303137393433' TO DFHEIV0(25:11)
 18176     CALL 'kxdfhei1' USING DFHEIV0,
 18177           DFHEIV1,
 18178           CALCULATION-PASS-AREA,
 18179           CP-COMM-LENGTH,
 18180           DFHEIV99,
 18181           DFHEIV99,
 18182           DFHEIV99
 18183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18184
 18185
 18186 7000-EXIT.
 18187     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 332
* EL050.cbl
 18189 7100-FIND-BENEFIT-IN-STATE.
 18190     MOVE 'N'                    TO BEN-SEARCH-SW.
 18191
 18192     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18193         VARYING SUB3 FROM 1 BY 1 UNTIL
 18194            ((SUB3 GREATER 50) OR
 18195              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18196               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18197
 18198     IF SUB3 NOT = 51
 18199         MOVE 'Y'                TO BEN-SEARCH-SW.
 18200
 18201     GO TO 7199-EXIT.
 18202
 18203 7100-BENEFIT-DUMMY.
 18204
 18205 7100-DUMMY-EXIT.
 18206     EXIT.
 18207
 18208 7199-EXIT.
 18209     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 333
* EL050.cbl
 18211 7200-FIND-BENEFIT.
 18212     MOVE 'N'                    TO BEN-SEARCH-SW.
 18213
 18214     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18215         VARYING SUB3 FROM 1 BY 1 UNTIL
 18216            ((SUB3 GREATER 8) OR
 18217            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18218
 18219     IF SUB3 NOT = 9
 18220         MOVE 'Y'                TO BEN-SEARCH-SW.
 18221
 18222     GO TO 7200-EXIT.
 18223
 18224 7200-BENEFIT-DUMMY.
 18225
 18226 7200-DUMMY-EXIT.
 18227     EXIT.
 18228
 18229 7200-EXIT.
 18230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 334
* EL050.cbl
 18232 7250-LOOK-FOR-RESCINDED-CLAIM.
 18233     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18234                                    W-CL-COMP-CD.
 18235     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18236                                    W-CL-CERT-NO.
 18237
 18238
 18239* EXEC CICS HANDLE CONDITION
 18240*        NOTFND  (7250-CONTINUE)
 18241*        ENDFILE (7250-CONTINUE)
 18242*    END-EXEC.
 18243*    MOVE '"$I''                  ! ) #00018001' TO DFHEIV0
 18244     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18246     MOVE X'2920233030303138303031' TO DFHEIV0(25:11)
 18247     CALL 'kxdfhei1' USING DFHEIV0
 18248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18249
 18250
 18251
 18252* EXEC CICS IGNORE CONDITION
 18253*        DUPKEY
 18254*    END-EXEC.
 18255*    MOVE '"*$                   !   #00018006' TO DFHEIV0
 18256     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18258     MOVE X'2020233030303138303036' TO DFHEIV0(25:11)
 18259     CALL 'kxdfhei1' USING DFHEIV0
 18260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18261
 18262
 18263
 18264* EXEC CICS STARTBR
 18265*        DATASET   (CLMS-ID)
 18266*        RIDFLD    (ELMSTR-KEY)
 18267*        GENERIC   EQUAL
 18268*        KEYLENGTH (ELMSTR-LENGTH)
 18269*    END-EXEC.
 18270     MOVE 0
 18271       TO DFHEIV11
 18272*    MOVE '&,   KG    E          &   #00018010' TO DFHEIV0
 18273     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18275     MOVE X'2020233030303138303130' TO DFHEIV0(25:11)
 18276     CALL 'kxdfhei1' USING DFHEIV0,
 18277           CLMS-ID,
 18278           ELMSTR-KEY,
 18279           ELMSTR-LENGTH,
 18280           DFHEIV11,
 18281           DFHEIV99
 18282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18283
 18284
 18285     MOVE 'Y'                    TO W-BROWSE-SW.
 18286
 18287 7250-NEXT-CLAIM.
 18288
 18289
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 335
* EL050.cbl
 18290* EXEC CICS READNEXT
 18291*        DATASET   (CLMS-ID)
 18292*        RIDFLD    (ELMSTR-KEY)
 18293*        SET       (ADDRESS OF CLAIM-MASTER)
 18294*    END-EXEC.
 18295     MOVE 0
 18296       TO DFHEIV11
 18297*    MOVE '&.S                   )   #00018021' TO DFHEIV0
 18298     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18299     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18300     MOVE X'2020233030303138303231' TO DFHEIV0(25:11)
 18301     CALL 'kxdfhei1' USING DFHEIV0,
 18302           CLMS-ID,
 18303           DFHEIV20,
 18304           DFHEIV99,
 18305           ELMSTR-KEY,
 18306           DFHEIV99,
 18307           DFHEIV11,
 18308           DFHEIV99,
 18309           DFHEIV99
 18310     SET ADDRESS OF CLAIM-MASTER TO
 18311         DFHEIV20
 18312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18313
 18314
 18315     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18316        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18317         GO TO 7250-CONTINUE
 18318     END-IF.
 18319
 18320     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18321        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18322        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18323        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18324        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18325         GO TO 7250-NEXT-CLAIM
 18326     END-IF.
 18327
 18328     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18329        OR (CL-CLAIM-TYPE = 'I')
 18330        OR (CL-CLAIM-TYPE = 'G')
 18331          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18332              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18333              GO TO 7250-CONTINUE
 18334          END-IF
 18335     END-IF.
 18336
 18337     GO TO 7250-NEXT-CLAIM.
 18338
 18339 7250-CONTINUE.
 18340
 18341     IF W-BROWSE-SW = 'Y'
 18342
 18343* EXEC CICS ENDBR
 18344*            DATASET   (CLMS-ID)
 18345*        END-EXEC
 18346     MOVE 0
 18347       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 336
* EL050.cbl
 18348*    MOVE '&2                    $   #00018054' TO DFHEIV0
 18349     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18350     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18351     MOVE X'2020233030303138303534' TO DFHEIV0(25:11)
 18352     CALL 'kxdfhei1' USING DFHEIV0,
 18353           CLMS-ID,
 18354           DFHEIV11,
 18355           DFHEIV99
 18356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18357         MOVE 'N' TO W-BROWSE-SW
 18358     END-IF.
 18359
 18360 7250-EXIT.
 18361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 337
* EL050.cbl
 18363 7300-CHECK-FOR-OPEN-CLMS.
 18364
 18365*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18366*    MOVE SPACES                 TO CNTL-ACCESS.
 18367*    MOVE '1'                    TO CNTL-REC-TYPE.
 18368*    MOVE +0                     TO CNTL-SEQ-NO.
 18369
 18370*    MOVE '3'                    TO RC-SW-1.
 18371*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18372
 18373*    IF NOT CF-COMPANY-MASTER
 18374*         PERFORM 0099-COMPANY-NOT-FOUND
 18375*         GO TO 7300-EXIT.
 18376
 18377     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18378                                    W-CL-COMP-CD.
 18379     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18380                                    W-CL-CERT-NO.
 18381
 18382
 18383* EXEC CICS HANDLE CONDITION
 18384*        NOTFND  (7300-CONTINUE)
 18385*        ENDFILE (7300-CONTINUE)
 18386*    END-EXEC.
 18387*    MOVE '"$I''                  ! * #00018082' TO DFHEIV0
 18388     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18390     MOVE X'2A20233030303138303832' TO DFHEIV0(25:11)
 18391     CALL 'kxdfhei1' USING DFHEIV0
 18392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18393
 18394
 18395
 18396* EXEC CICS IGNORE CONDITION
 18397*        DUPKEY
 18398*    END-EXEC.
 18399*    MOVE '"*$                   !   #00018087' TO DFHEIV0
 18400     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18402     MOVE X'2020233030303138303837' TO DFHEIV0(25:11)
 18403     CALL 'kxdfhei1' USING DFHEIV0
 18404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18405
 18406
 18407
 18408* EXEC CICS STARTBR
 18409*        DATASET   (CLMS-ID)
 18410*        RIDFLD    (ELMSTR-KEY)
 18411*        GENERIC   EQUAL
 18412*        KEYLENGTH (ELMSTR-LENGTH)
 18413*    END-EXEC.
 18414     MOVE 0
 18415       TO DFHEIV11
 18416*    MOVE '&,   KG    E          &   #00018091' TO DFHEIV0
 18417     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18418     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18419     MOVE X'2020233030303138303931' TO DFHEIV0(25:11)
 18420     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 338
* EL050.cbl
 18421           CLMS-ID,
 18422           ELMSTR-KEY,
 18423           ELMSTR-LENGTH,
 18424           DFHEIV11,
 18425           DFHEIV99
 18426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18427
 18428
 18429     MOVE 'Y'                    TO W-BROWSE-SW.
 18430
 18431 7300-NEXT-CLAIM.
 18432
 18433
 18434* EXEC CICS READNEXT
 18435*        DATASET   (CLMS-ID)
 18436*        RIDFLD    (ELMSTR-KEY)
 18437*        SET       (ADDRESS OF CLAIM-MASTER)
 18438*    END-EXEC.
 18439     MOVE 0
 18440       TO DFHEIV11
 18441*    MOVE '&.S                   )   #00018102' TO DFHEIV0
 18442     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18443     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18444     MOVE X'2020233030303138313032' TO DFHEIV0(25:11)
 18445     CALL 'kxdfhei1' USING DFHEIV0,
 18446           CLMS-ID,
 18447           DFHEIV20,
 18448           DFHEIV99,
 18449           ELMSTR-KEY,
 18450           DFHEIV99,
 18451           DFHEIV11,
 18452           DFHEIV99,
 18453           DFHEIV99
 18454     SET ADDRESS OF CLAIM-MASTER TO
 18455         DFHEIV20
 18456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18457
 18458
 18459     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18460        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18461         GO TO 7300-CONTINUE.
 18462
 18463     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18464        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18465        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18466        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18467        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18468         GO TO 7300-NEXT-CLAIM.
 18469
 18470*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18471     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18472        OR (CL-CLAIM-TYPE = 'I')
 18473        OR (CL-CLAIM-TYPE = 'G')
 18474        IF CLAIM-IS-OPEN
 18475           EVALUATE TRUE
 18476             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18477                 MOVE ER-2884      TO WS-ERROR
 18478             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 339
* EL050.cbl
 18479                 MOVE ER-2887      TO WS-ERROR
 18480             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18481                 MOVE ER-2886      TO WS-ERROR
 18482             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18483                 MOVE ER-2888      TO WS-ERROR
 18484             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18485                 MOVE ER-2885      TO WS-ERROR
 18486             WHEN OTHER
 18487                 MOVE ER-2768      TO WS-ERROR
 18488           END-EVALUATE
 18489           IF PB-C-AH-CANCEL-VOIDED OR
 18490              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18491                NOT AH-COVERAGE-CANCELLED)
 18492               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18493               MOVE ER-2768      TO WS-ERROR
 18494           END-IF
 18495           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18496           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18497              PB-FORCE-CODE NOT EQUAL '8'
 18498               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18499           END-IF
 18500           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18501           GO TO 7300-CONTINUE
 18502        ELSE
 18503           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18504*****THIS IS A RESCISSION OR REFORMATION
 18505              IF (AH-COVERAGE-CANCELLED AND
 18506                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18507                    MOVE ER-2890 TO WS-ERROR
 18508                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18509                    GO TO 7300-CONTINUE
 18510              END-IF
 18511           ELSE
 18512              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18513                 MOVE ER-2756        TO WS-ERROR
 18514                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18515                 GO TO 7300-CONTINUE
 18516              END-IF
 18517           END-IF
 18518        END-IF
 18519     ELSE
 18520*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18521        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18522           IF CLAIM-IS-OPEN
 18523              MOVE ER-2889      TO WS-ERROR
 18524              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18525              GO TO 7300-CONTINUE
 18526           ELSE
 18527              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18528*****THIS IS A RESCISSION OR REFORMATION
 18529                 IF (LF-COVERAGE-CANCELLED AND
 18530                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18531                       MOVE ER-2890 TO WS-ERROR
 18532                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18533                       GO TO 7300-CONTINUE
 18534                 END-IF
 18535              ELSE
 18536                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 340
* EL050.cbl
 18537                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18538                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18539                    (LF-COVERAGE-CANCELLED AND
 18540                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18541                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18542                       MOVE ER-2965 TO WS-ERROR
 18543                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18544                       GO TO 7300-CONTINUE
 18545                 END-IF
 18546                 IF LF-COVERAGE-CANCELLED
 18547                  IF CL-TOTAL-PAID-AMT > 0
 18548                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18549                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18550                        MOVE ER-2891 TO WS-ERROR
 18551                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18552                        GO TO 7300-CONTINUE
 18553                      END-IF
 18554                    ELSE
 18555                      MOVE ER-2892 TO WS-ERROR
 18556                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18557                      GO TO 7300-CONTINUE
 18558                    END-IF
 18559                  END-IF
 18560                 END-IF
 18561              END-IF
 18562           END-IF
 18563        END-IF
 18564     END-IF
 18565
 18566     GO TO 7300-NEXT-CLAIM.
 18567
 18568 7300-CONTINUE.
 18569
 18570     IF W-BROWSE-SW = 'Y'
 18571
 18572* EXEC CICS ENDBR
 18573*            DATASET   (CLMS-ID)
 18574*        END-EXEC.
 18575     MOVE 0
 18576       TO DFHEIV11
 18577*    MOVE '&2                    $   #00018220' TO DFHEIV0
 18578     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18579     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18580     MOVE X'2020233030303138323230' TO DFHEIV0(25:11)
 18581     CALL 'kxdfhei1' USING DFHEIV0,
 18582           CLMS-ID,
 18583           DFHEIV11,
 18584           DFHEIV99
 18585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18586
 18587
 18588 7300-EXIT.
 18589     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 341
* EL050.cbl
 18591
 18592 7400-GET-REMAIN-TERM.
 18593
 18594* EXEC CICS LINK
 18595*        PROGRAM    ('ELRTRM')
 18596*        COMMAREA   (CALCULATION-PASS-AREA)
 18597*        LENGTH     (CP-COMM-LENGTH)
 18598*    END-EXEC.
 18599     MOVE 'ELRTRM' TO DFHEIV1
 18600*    MOVE '."C                   ''   #00018229' TO DFHEIV0
 18601     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18602     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18603     MOVE X'2020233030303138323239' TO DFHEIV0(25:11)
 18604     CALL 'kxdfhei1' USING DFHEIV0,
 18605           DFHEIV1,
 18606           CALCULATION-PASS-AREA,
 18607           CP-COMM-LENGTH,
 18608           DFHEIV99,
 18609           DFHEIV99,
 18610           DFHEIV99
 18611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18612
 18613
 18614 7400-EXIT.
 18615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 342
* EL050.cbl
 18617
 18618 7500-GET-REMAIN-AMOUNT.
 18619
 18620* EXEC CICS LINK
 18621*        PROGRAM    ('ELRAMT')
 18622*        COMMAREA   (CALCULATION-PASS-AREA)
 18623*        LENGTH     (CP-COMM-LENGTH)
 18624*    END-EXEC.
 18625     MOVE 'ELRAMT' TO DFHEIV1
 18626*    MOVE '."C                   ''   #00018240' TO DFHEIV0
 18627     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18629     MOVE X'2020233030303138323430' TO DFHEIV0(25:11)
 18630     CALL 'kxdfhei1' USING DFHEIV0,
 18631           DFHEIV1,
 18632           CALCULATION-PASS-AREA,
 18633           CP-COMM-LENGTH,
 18634           DFHEIV99,
 18635           DFHEIV99,
 18636           DFHEIV99
 18637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18638
 18639
 18640 7500-EXIT.
 18641     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 343
* EL050.cbl
 18643
 18644 7600-GET-REFUND.
 18645
 18646* EXEC CICS LINK
 18647*        PROGRAM    ('ELRFND')
 18648*        COMMAREA   (CALCULATION-PASS-AREA)
 18649*        LENGTH     (CP-COMM-LENGTH)
 18650*    END-EXEC.
 18651     MOVE 'ELRFND' TO DFHEIV1
 18652*    MOVE '."C                   ''   #00018251' TO DFHEIV0
 18653     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18655     MOVE X'2020233030303138323531' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0,
 18657           DFHEIV1,
 18658           CALCULATION-PASS-AREA,
 18659           CP-COMM-LENGTH,
 18660           DFHEIV99,
 18661           DFHEIV99,
 18662           DFHEIV99
 18663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18664
 18665
 18666 7600-EXIT.
 18667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 344
* EL050.cbl
 18669 7700-CALL-DL1.
 18670
 18671* EXEC CICS LINK
 18672*        PROGRAM    ('DLO001')
 18673*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18674*        LENGTH     (DLO001-COMM-LENGTH)
 18675*    END-EXEC.
 18676     MOVE 'DLO001' TO DFHEIV1
 18677*    MOVE '."C                   ''   #00018261' TO DFHEIV0
 18678     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18680     MOVE X'2020233030303138323631' TO DFHEIV0(25:11)
 18681     CALL 'kxdfhei1' USING DFHEIV0,
 18682           DFHEIV1,
 18683           WS-DLO-MASTER-POLICY-FORM,
 18684           DLO001-COMM-LENGTH,
 18685           DFHEIV99,
 18686           DFHEIV99,
 18687           DFHEIV99
 18688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18689
 18690
 18691 7700-EXIT.
 18692     EXIT.
 18693
 18694 7710-CALL-DL2.
 18695
 18696* EXEC CICS LINK
 18697*        PROGRAM    ('DLO002')
 18698*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18699*        LENGTH     (DLO002-COMM-LENGTH)
 18700*    END-EXEC.
 18701     MOVE 'DLO002' TO DFHEIV1
 18702*    MOVE '."C                   ''   #00018271' TO DFHEIV0
 18703     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18705     MOVE X'2020233030303138323731' TO DFHEIV0(25:11)
 18706     CALL 'kxdfhei1' USING DFHEIV0,
 18707           DFHEIV1,
 18708           WS-DLO-INTERNAL-POLICY-FORM,
 18709           DLO002-COMM-LENGTH,
 18710           DFHEIV99,
 18711           DFHEIV99,
 18712           DFHEIV99
 18713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18714
 18715
 18716 7710-EXIT.
 18717     EXIT.
 18718
 18719 7720-CALL-DL3.
 18720
 18721* EXEC CICS LINK
 18722*        PROGRAM    ('DLO003')
 18723*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18724*        LENGTH     (DLO003-COMM-LENGTH)
 18725*    END-EXEC.
 18726     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 345
* EL050.cbl
 18727*    MOVE '."C                   ''   #00018281' TO DFHEIV0
 18728     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18730     MOVE X'2020233030303138323831' TO DFHEIV0(25:11)
 18731     CALL 'kxdfhei1' USING DFHEIV0,
 18732           DFHEIV1,
 18733           WS-DLO-VALID-BANK-ID,
 18734           DLO003-COMM-LENGTH,
 18735           DFHEIV99,
 18736           DFHEIV99,
 18737           DFHEIV99
 18738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18739
 18740
 18741 7720-EXIT.
 18742     EXIT.
 18743
 18744 7730-CALL-DL7.
 18745
 18746* EXEC CICS LINK
 18747*        PROGRAM    ('DLO007')
 18748*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18749*        LENGTH     (DLO007-COMM-LENGTH)
 18750*    END-EXEC.
 18751     MOVE 'DLO007' TO DFHEIV1
 18752*    MOVE '."C                   ''   #00018291' TO DFHEIV0
 18753     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18754     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18755     MOVE X'2020233030303138323931' TO DFHEIV0(25:11)
 18756     CALL 'kxdfhei1' USING DFHEIV0,
 18757           DFHEIV1,
 18758           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18759           DLO007-COMM-LENGTH,
 18760           DFHEIV99,
 18761           DFHEIV99,
 18762           DFHEIV99
 18763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18764
 18765
 18766 7730-EXIT.
 18767     EXIT.
 18768
 18769 7740-CALL-DL11.
 18770
 18771* EXEC CICS LINK
 18772*        PROGRAM    ('DLO011')
 18773*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18774*        LENGTH     (DLO011-COMM-LENGTH)
 18775*    END-EXEC.
 18776     MOVE 'DLO011' TO DFHEIV1
 18777*    MOVE '."C                   ''   #00018301' TO DFHEIV0
 18778     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18780     MOVE X'2020233030303138333031' TO DFHEIV0(25:11)
 18781     CALL 'kxdfhei1' USING DFHEIV0,
 18782           DFHEIV1,
 18783           WS-DLO-PREM-RATES-BEN-TYPE,
 18784           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 346
* EL050.cbl
 18785           DFHEIV99,
 18786           DFHEIV99,
 18787           DFHEIV99
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
 18791 7740-EXIT.
 18792     EXIT.
 18793
 18794 7750-CALL-DL17.
 18795
 18796* EXEC CICS LINK
 18797*        PROGRAM    ('DLO017')
 18798*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18799*        LENGTH     (DLO017-COMM-LENGTH)
 18800*    END-EXEC.
 18801     MOVE 'DLO017' TO DFHEIV1
 18802*    MOVE '."C                   ''   #00018311' TO DFHEIV0
 18803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18805     MOVE X'2020233030303138333131' TO DFHEIV0(25:11)
 18806     CALL 'kxdfhei1' USING DFHEIV0,
 18807           DFHEIV1,
 18808           WS-DLO-VALID-RATE-CODE,
 18809           DLO017-COMM-LENGTH,
 18810           DFHEIV99,
 18811           DFHEIV99,
 18812           DFHEIV99
 18813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18814
 18815
 18816 7750-EXIT.
 18817     EXIT.
 18818
 18819 7755-CALL-DL19.
 18820
 18821* EXEC CICS LINK
 18822*        PROGRAM    ('DLO019')
 18823*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18824*        LENGTH     (DLO019-COMM-LENGTH)
 18825*    END-EXEC.
 18826     MOVE 'DLO019' TO DFHEIV1
 18827*    MOVE '."C                   ''   #00018321' TO DFHEIV0
 18828     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18830     MOVE X'2020233030303138333231' TO DFHEIV0(25:11)
 18831     CALL 'kxdfhei1' USING DFHEIV0,
 18832           DFHEIV1,
 18833           WS-DLO-ORIG-COV-CAT,
 18834           DLO019-COMM-LENGTH,
 18835           DFHEIV99,
 18836           DFHEIV99,
 18837           DFHEIV99
 18838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18839
 18840
 18841 7755-EXIT.
 18842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 347
* EL050.cbl
 18843
 18844 7760-CALL-DL21.
 18845
 18846* EXEC CICS LINK
 18847*        PROGRAM    ('DLO021')
 18848*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18849*        LENGTH     (DLO021-COMM-LENGTH)
 18850*    END-EXEC.
 18851     MOVE 'DLO021' TO DFHEIV1
 18852*    MOVE '."C                   ''   #00018331' TO DFHEIV0
 18853     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18854     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18855     MOVE X'2020233030303138333331' TO DFHEIV0(25:11)
 18856     CALL 'kxdfhei1' USING DFHEIV0,
 18857           DFHEIV1,
 18858           WS-DLO-VALID-LOAN-OFFICER,
 18859           DLO021-COMM-LENGTH,
 18860           DFHEIV99,
 18861           DFHEIV99,
 18862           DFHEIV99
 18863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18864
 18865
 18866 7760-EXIT.
 18867     EXIT.
 18868
 18869 7770-CALL-DL22.
 18870
 18871* EXEC CICS LINK
 18872*        PROGRAM    ('DLO022')
 18873*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18874*        LENGTH     (DLO022-COMM-LENGTH)
 18875*    END-EXEC.
 18876     MOVE 'DLO022' TO DFHEIV1
 18877*    MOVE '."C                   ''   #00018341' TO DFHEIV0
 18878     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18880     MOVE X'2020233030303138333431' TO DFHEIV0(25:11)
 18881     CALL 'kxdfhei1' USING DFHEIV0,
 18882           DFHEIV1,
 18883           WS-DLO-VALID-STATE-CODE,
 18884           DLO022-COMM-LENGTH,
 18885           DFHEIV99,
 18886           DFHEIV99,
 18887           DFHEIV99
 18888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18889
 18890
 18891 7770-EXIT.
 18892     EXIT.
 18893
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 348
* EL050.cbl
 18895
 18896 7800-REWRITE-CERT.
 18897******************************************************************
 18898*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18899*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18900******************************************************************
 18901
 18902     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18903        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18904        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18905        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18906
 18907* EXEC CICS REWRITE
 18908*                  DATASET (CERT-ID)
 18909*                  FROM    (CERTIFICATE-MASTER)
 18910*              END-EXEC
 18911     MOVE LENGTH OF
 18912      CERTIFICATE-MASTER
 18913       TO DFHEIV11
 18914*    MOVE '&& L                  %   #00018362' TO DFHEIV0
 18915     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18917     MOVE X'2020233030303138333632' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0,
 18919           CERT-ID,
 18920           CERTIFICATE-MASTER,
 18921           DFHEIV11,
 18922           DFHEIV99
 18923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18924        GO TO 7800-EXIT.
 18925
 18926       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18927       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18928
 18929 7800-EXIT.
 18930      EXIT.
 18931
 18932 7900-DELETE-CERT.
 18933
 18934* EXEC CICS DELETE
 18935*        DATASET (CERT-ID)
 18936*    END-EXEC.
 18937*    MOVE '&(                    &   #00018375' TO DFHEIV0
 18938     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18939     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18940     MOVE X'2020233030303138333735' TO DFHEIV0(25:11)
 18941     CALL 'kxdfhei1' USING DFHEIV0,
 18942           CERT-ID,
 18943           DFHEIV99,
 18944           DFHEIV99,
 18945           DFHEIV99,
 18946           DFHEIV99
 18947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18948
 18949
 18950 7900-EXIT.
 18951     EXIT.
 18952
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 349
* EL050.cbl
 18953 8000-WRITE-CERT.
 18954
 18955* EXEC CICS HANDLE CONDITION
 18956*        DUPKEY    (8000-FREE-MAIN)
 18957*    END-EXEC.
 18958*    MOVE '"$$                   ! + #00018383' TO DFHEIV0
 18959     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18961     MOVE X'2B20233030303138333833' TO DFHEIV0(25:11)
 18962     CALL 'kxdfhei1' USING DFHEIV0
 18963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18964
 18965
 18966
 18967* EXEC CICS WRITE
 18968*        DATASET     (CERT-ID)
 18969*        FROM        (CERTIFICATE-MASTER)
 18970*        RIDFLD      (ELCERT-KEY)
 18971*    END-EXEC.
 18972     MOVE LENGTH OF
 18973      CERTIFICATE-MASTER
 18974       TO DFHEIV11
 18975*    MOVE '&$ L                  ''   #00018387' TO DFHEIV0
 18976     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18977     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18978     MOVE X'2020233030303138333837' TO DFHEIV0(25:11)
 18979     CALL 'kxdfhei1' USING DFHEIV0,
 18980           CERT-ID,
 18981           CERTIFICATE-MASTER,
 18982           DFHEIV11,
 18983           ELCERT-KEY,
 18984           DFHEIV99,
 18985           DFHEIV99
 18986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18987
 18988
 18989 8000-FREE-MAIN.
 18990
 18991 8000-EXIT.
 18992      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 350
* EL050.cbl
 18994
 18995 8100-READ-ERPNDM.
 18996
 18997* EXEC CICS HANDLE CONDITION
 18998*         NOTFND     (8100-NOTFND)
 18999*         ENDFILE    (8100-NOTFND)
 19000*    END-EXEC.
 19001*    MOVE '"$I''                  ! , #00018400' TO DFHEIV0
 19002     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19004     MOVE X'2C20233030303138343030' TO DFHEIV0(25:11)
 19005     CALL 'kxdfhei1' USING DFHEIV0
 19006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19007
 19008
 19009     MOVE SPACES                 TO ERPNDM-FOUND.
 19010     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19011
 19012
 19013* EXEC CICS READ
 19014*         DATASET   (FILE-ERPNDM)
 19015*         RIDFLD    (PM-CONTROL-PRIMARY)
 19016*         INTO      (PENDING-MAILING-DATA)
 19017*    END-EXEC.
 19018     MOVE LENGTH OF
 19019      PENDING-MAILING-DATA
 19020       TO DFHEIV11
 19021*    MOVE '&"IL       E          (   #00018408' TO DFHEIV0
 19022     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19024     MOVE X'2020233030303138343038' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0,
 19026           FILE-ERPNDM,
 19027           PENDING-MAILING-DATA,
 19028           DFHEIV11,
 19029           PM-CONTROL-PRIMARY,
 19030           DFHEIV99,
 19031           DFHEIV99,
 19032           DFHEIV99
 19033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19034
 19035
 19036     GO TO 8100-EXIT.
 19037
 19038 8100-NOTFND.
 19039
 19040     MOVE 'X'                    TO ERPNDM-FOUND.
 19041     MOVE ER-2694                TO WS-ERROR.
 19042     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19043     MOVE ER-2883                TO WS-ERROR
 19044     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19045     .
 19046 8100-EXIT.
 19047     EXIT.
 19048
 19049 8110-READ-ERMAIL.
 19050
 19051* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 351
* EL050.cbl
 19052*         NOTFND     (8110-NOTFND)
 19053*         ENDFILE    (8110-NOTFND)
 19054*    END-EXEC.
 19055*    MOVE '"$I''                  ! - #00018428' TO DFHEIV0
 19056     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19058     MOVE X'2D20233030303138343238' TO DFHEIV0(25:11)
 19059     CALL 'kxdfhei1' USING DFHEIV0
 19060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19061
 19062
 19063     MOVE SPACES                 TO ERMAIL-FOUND.
 19064     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19065     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19066     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19067     MOVE PB-SV-STATE            TO MA-STATE.
 19068
 19069
 19070* EXEC CICS READ
 19071*         UPDATE
 19072*         DATASET   (FILE-ERMAIL)
 19073*         RIDFLD    (MA-CONTROL-PRIMARY)
 19074*         INTO      (MAILING-DATA)
 19075*    END-EXEC.
 19076     MOVE LENGTH OF
 19077      MAILING-DATA
 19078       TO DFHEIV11
 19079*    MOVE '&"IL       EU         (   #00018439' TO DFHEIV0
 19080     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19081     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19082     MOVE X'2020233030303138343339' TO DFHEIV0(25:11)
 19083     CALL 'kxdfhei1' USING DFHEIV0,
 19084           FILE-ERMAIL,
 19085           MAILING-DATA,
 19086           DFHEIV11,
 19087           MA-CONTROL-PRIMARY,
 19088           DFHEIV99,
 19089           DFHEIV99,
 19090           DFHEIV99
 19091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19092
 19093
 19094     GO TO 8110-EXIT.
 19095
 19096 8110-NOTFND.
 19097     MOVE 'X'                    TO ERMAIL-FOUND.
 19098
 19099 8110-EXIT.
 19100     EXIT.
 19101
 19102 8120-REWRITE-ERMAIL.
 19103
 19104* EXEC CICS REWRITE
 19105*         DATASET    (FILE-ERMAIL)
 19106*         FROM       (MAILING-DATA)
 19107*    END-EXEC.
 19108     MOVE LENGTH OF
 19109      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 352
* EL050.cbl
 19110       TO DFHEIV11
 19111*    MOVE '&& L                  %   #00018455' TO DFHEIV0
 19112     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19113     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19114     MOVE X'2020233030303138343535' TO DFHEIV0(25:11)
 19115     CALL 'kxdfhei1' USING DFHEIV0,
 19116           FILE-ERMAIL,
 19117           MAILING-DATA,
 19118           DFHEIV11,
 19119           DFHEIV99
 19120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19121
 19122
 19123 8120-EXIT.
 19124     EXIT.
 19125
 19126 8130-WRITE-ERMAIL.
 19127
 19128* EXEC CICS HANDLE CONDITION
 19129*         DUPKEY   (8130-EXIT)
 19130*    END-EXEC.
 19131*    MOVE '"$$                   ! . #00018464' TO DFHEIV0
 19132     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19134     MOVE X'2E20233030303138343634' TO DFHEIV0(25:11)
 19135     CALL 'kxdfhei1' USING DFHEIV0
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19137
 19138
 19139
 19140* EXEC CICS WRITE
 19141*         DATASET     (FILE-ERMAIL)
 19142*         RIDFLD      (MA-CONTROL-PRIMARY)
 19143*         FROM        (MAILING-DATA)
 19144*    END-EXEC.
 19145     MOVE LENGTH OF
 19146      MAILING-DATA
 19147       TO DFHEIV11
 19148*    MOVE '&$ L                  ''   #00018468' TO DFHEIV0
 19149     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19150     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19151     MOVE X'2020233030303138343638' TO DFHEIV0(25:11)
 19152     CALL 'kxdfhei1' USING DFHEIV0,
 19153           FILE-ERMAIL,
 19154           MAILING-DATA,
 19155           DFHEIV11,
 19156           MA-CONTROL-PRIMARY,
 19157           DFHEIV99,
 19158           DFHEIV99
 19159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19160
 19161
 19162 8130-EXIT.
 19163     EXIT.
 19164
 19165 8140-UNLOCK-ERMAIL.
 19166
 19167* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 353
* EL050.cbl
 19168*         DATASET   (FILE-ERMAIL)
 19169*    END-EXEC.
 19170*    MOVE '&*                    #   #00018478' TO DFHEIV0
 19171     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19172     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19173     MOVE X'2020233030303138343738' TO DFHEIV0(25:11)
 19174     CALL 'kxdfhei1' USING DFHEIV0,
 19175           FILE-ERMAIL,
 19176           DFHEIV99
 19177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19178
 19179
 19180 8140-EXIT.
 19181     EXIT.
 19182
 19183 8180-UPDATE-VIN-NUMBER.
 19184
 19185* EXEC CICS HANDLE CONDITION
 19186*        NOTFND   (8180-NOTFND)
 19187*    END-EXEC.
 19188*    MOVE '"$I                   ! / #00018486' TO DFHEIV0
 19189     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19191     MOVE X'2F20233030303138343836' TO DFHEIV0(25:11)
 19192     CALL 'kxdfhei1' USING DFHEIV0
 19193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19194
 19195
 19196     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19197     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19198
 19199
 19200* EXEC CICS READ
 19201*        UPDATE
 19202*        DATASET  (CRTT-ID)
 19203*        RIDFLD   (WS-ELCRTT-KEY)
 19204*        INTO     (CERTIFICATE-TRAILERS)
 19205*    END-EXEC.
 19206     MOVE LENGTH OF
 19207      CERTIFICATE-TRAILERS
 19208       TO DFHEIV11
 19209*    MOVE '&"IL       EU         (   #00018493' TO DFHEIV0
 19210     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19211     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19212     MOVE X'2020233030303138343933' TO DFHEIV0(25:11)
 19213     CALL 'kxdfhei1' USING DFHEIV0,
 19214           CRTT-ID,
 19215           CERTIFICATE-TRAILERS,
 19216           DFHEIV11,
 19217           WS-ELCRTT-KEY,
 19218           DFHEIV99,
 19219           DFHEIV99,
 19220           DFHEIV99
 19221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19222
 19223
 19224     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19225         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 354
* EL050.cbl
 19226
 19227* EXEC CICS REWRITE
 19228*           DATASET  (CRTT-ID)
 19229*           FROM     (CERTIFICATE-TRAILERS)
 19230*        END-EXEC
 19231     MOVE LENGTH OF
 19232      CERTIFICATE-TRAILERS
 19233       TO DFHEIV11
 19234*    MOVE '&& L                  %   #00018502' TO DFHEIV0
 19235     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19236     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19237     MOVE X'2020233030303138353032' TO DFHEIV0(25:11)
 19238     CALL 'kxdfhei1' USING DFHEIV0,
 19239           CRTT-ID,
 19240           CERTIFICATE-TRAILERS,
 19241           DFHEIV11,
 19242           DFHEIV99
 19243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19244     ELSE
 19245
 19246* EXEC CICS UNLOCK
 19247*          DATASET  (CRTT-ID)
 19248*       END-EXEC
 19249*    MOVE '&*                    #   #00018507' TO DFHEIV0
 19250     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19251     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19252     MOVE X'2020233030303138353037' TO DFHEIV0(25:11)
 19253     CALL 'kxdfhei1' USING DFHEIV0,
 19254           CRTT-ID,
 19255           DFHEIV99
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19257     END-IF.
 19258
 19259     GO TO 8180-EXIT.
 19260
 19261 8180-NOTFND.
 19262
 19263     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19264     MOVE 'CS'         TO CS-RECORD-ID.
 19265     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19266     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19267     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19268     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19269
 19270* EXEC CICS WRITE
 19271*       DATASET  (CRTT-ID)
 19272*       RIDFLD   (WS-ELCRTT-KEY)
 19273*       FROM     (CERTIFICATE-TRAILERS)
 19274*    END-EXEC.
 19275     MOVE LENGTH OF
 19276      CERTIFICATE-TRAILERS
 19277       TO DFHEIV11
 19278*    MOVE '&$ L                  ''   #00018522' TO DFHEIV0
 19279     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19281     MOVE X'2020233030303138353232' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0,
 19283           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 355
* EL050.cbl
 19284           CERTIFICATE-TRAILERS,
 19285           DFHEIV11,
 19286           WS-ELCRTT-KEY,
 19287           DFHEIV99,
 19288           DFHEIV99
 19289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19290
 19291
 19292 8180-EXIT.
 19293     EXIT.
 19294
 19295 8190-UPDATE-REFUND-CLAIM-FLAG.
 19296
 19297* EXEC CICS HANDLE CONDITION
 19298*        NOTFND   (8190-NOTFND)
 19299*    END-EXEC.
 19300*    MOVE '"$I                   ! 0 #00018532' TO DFHEIV0
 19301     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19303     MOVE X'3020233030303138353332' TO DFHEIV0(25:11)
 19304     CALL 'kxdfhei1' USING DFHEIV0
 19305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19306
 19307
 19308     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19309     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19310
 19311
 19312* EXEC CICS READ
 19313*        UPDATE
 19314*        DATASET  (CRTT-ID)
 19315*        RIDFLD   (WS-ELCRTT-KEY)
 19316*        INTO     (CERTIFICATE-TRAILERS)
 19317*    END-EXEC.
 19318     MOVE LENGTH OF
 19319      CERTIFICATE-TRAILERS
 19320       TO DFHEIV11
 19321*    MOVE '&"IL       EU         (   #00018539' TO DFHEIV0
 19322     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19323     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19324     MOVE X'2020233030303138353339' TO DFHEIV0(25:11)
 19325     CALL 'kxdfhei1' USING DFHEIV0,
 19326           CRTT-ID,
 19327           CERTIFICATE-TRAILERS,
 19328           DFHEIV11,
 19329           WS-ELCRTT-KEY,
 19330           DFHEIV99,
 19331           DFHEIV99,
 19332           DFHEIV99
 19333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19334
 19335
 19336     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19337
 19338* EXEC CICS REWRITE
 19339*       DATASET  (CRTT-ID)
 19340*       FROM     (CERTIFICATE-TRAILERS)
 19341*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 356
* EL050.cbl
 19342     MOVE LENGTH OF
 19343      CERTIFICATE-TRAILERS
 19344       TO DFHEIV11
 19345*    MOVE '&& L                  %   #00018547' TO DFHEIV0
 19346     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19347     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19348     MOVE X'2020233030303138353437' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0,
 19350           CRTT-ID,
 19351           CERTIFICATE-TRAILERS,
 19352           DFHEIV11,
 19353           DFHEIV99
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357     GO TO 8190-EXIT.
 19358
 19359 8190-NOTFND.
 19360
 19361     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19362     MOVE 'CS'         TO CS-RECORD-ID.
 19363     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19364     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19365     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19366     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19367
 19368* EXEC CICS WRITE
 19369*       DATASET  (CRTT-ID)
 19370*       RIDFLD   (WS-ELCRTT-KEY)
 19371*       FROM     (CERTIFICATE-TRAILERS)
 19372*    END-EXEC.
 19373     MOVE LENGTH OF
 19374      CERTIFICATE-TRAILERS
 19375       TO DFHEIV11
 19376*    MOVE '&$ L                  ''   #00018562' TO DFHEIV0
 19377     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303138353632' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0,
 19381           CRTT-ID,
 19382           CERTIFICATE-TRAILERS,
 19383           DFHEIV11,
 19384           WS-ELCRTT-KEY,
 19385           DFHEIV99,
 19386           DFHEIV99
 19387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19388
 19389
 19390 8190-EXIT.
 19391     EXIT.
 19392
 19393 8200-READ-REIN-TABLE.
 19394
 19395* EXEC CICS HANDLE CONDITION
 19396*         NOTFND   (8200-NOTFND)
 19397*    END-EXEC.
 19398*    MOVE '"$I                   ! 1 #00018572' TO DFHEIV0
 19399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 357
* EL050.cbl
 19400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19401     MOVE X'3120233030303138353732' TO DFHEIV0(25:11)
 19402     CALL 'kxdfhei1' USING DFHEIV0
 19403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19404
 19405
 19406
 19407* EXEC CICS READ
 19408*        DATASET     (REIN-ID)
 19409*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19410*        RIDFLD      (ERREIN-KEY)
 19411*    END-EXEC.
 19412*    MOVE '&"S        E          (   #00018576' TO DFHEIV0
 19413     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19415     MOVE X'2020233030303138353736' TO DFHEIV0(25:11)
 19416     CALL 'kxdfhei1' USING DFHEIV0,
 19417           REIN-ID,
 19418           DFHEIV20,
 19419           DFHEIV99,
 19420           ERREIN-KEY,
 19421           DFHEIV99,
 19422           DFHEIV99,
 19423           DFHEIV99
 19424     SET ADDRESS OF REINSURANCE-RECORD TO
 19425         DFHEIV20
 19426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19427
 19428
 19429     GO TO 8200-EXIT.
 19430
 19431 8200-NOTFND.
 19432     MOVE 'N'             TO WS-REIN-READ-SW.
 19433
 19434 8200-EXIT.
 19435      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 358
* EL050.cbl
 19437
 19438 8300-READ-CTBL-TABLE.
 19439
 19440* EXEC CICS HANDLE CONDITION
 19441*        NOTFND    (8300-NOTFND)
 19442*        DISABLED  (8300-ERRESS-PROBLEM)
 19443*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19444*        ENDFILE   (8300-NOTFND)
 19445*    END-EXEC.
 19446*    MOVE '"$IcJ''                ! 2 #00018592' TO DFHEIV0
 19447     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19449     MOVE X'3220233030303138353932' TO DFHEIV0(25:11)
 19450     CALL 'kxdfhei1' USING DFHEIV0
 19451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19452
 19453
 19454
 19455* EXEC CICS READ
 19456*        DATASET     (CTBL-ID)
 19457*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19458*        RIDFLD      (ERCTBL-KEY)
 19459*    END-EXEC.
 19460*    MOVE '&"S        E          (   #00018599' TO DFHEIV0
 19461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19462     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19463     MOVE X'2020233030303138353939' TO DFHEIV0(25:11)
 19464     CALL 'kxdfhei1' USING DFHEIV0,
 19465           CTBL-ID,
 19466           DFHEIV20,
 19467           DFHEIV99,
 19468           ERCTBL-KEY,
 19469           DFHEIV99,
 19470           DFHEIV99,
 19471           DFHEIV99
 19472     SET ADDRESS OF COMM-TABLE-RECORD TO
 19473         DFHEIV20
 19474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19475
 19476
 19477     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19478
 19479     GO TO 8300-EXIT.
 19480
 19481 8300-NOTFND.
 19482
 19483     IF CTBL-SW = '0530'
 19484         MOVE 'AA'                     TO WS-AH-COMP-CD
 19485         MOVE '0550'                   TO CTBL-SW
 19486         MOVE '1'                      TO WS-CTBL-READ-SW
 19487         GO TO 8300-EXIT.
 19488
 19489     IF CTBL-SW = '0540'
 19490         MOVE 'AA'                     TO WS-LF-COMP-CD
 19491         MOVE '0550'                   TO CTBL-SW
 19492         MOVE '1'                      TO WS-CTBL-READ-SW
 19493         GO TO 8300-EXIT.
 19494
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 359
* EL050.cbl
 19495     IF CTBL-SW = '0550'
 19496         MOVE '2'                      TO WS-CTBL-READ-SW
 19497         GO TO 8300-EXIT.
 19498
 19499     GO TO 8300-EXIT.
 19500
 19501 8300-ERRESS-PROBLEM.
 19502
 19503      MOVE ER-8050              TO WS-ERROR.
 19504      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19505
 19506     GO TO 8300-EXIT.
 19507
 19508 8300-EXIT.
 19509      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 360
* EL050.cbl
 19511
 19512
 19513 8400-GETMAIN-ERFORM.
 19514
 19515
 19516* EXEC CICS   GETMAIN
 19517*        LENGTH  (500)
 19518*        SET     (ADDRESS OF FORM-MASTER)
 19519*    END-EXEC.
 19520     MOVE 500
 19521       TO DFHEIV11
 19522*    MOVE '," L                  $   #00018643' TO DFHEIV0
 19523     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19524     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19525     MOVE X'2020233030303138363433' TO DFHEIV0(25:11)
 19526     CALL 'kxdfhei1' USING DFHEIV0,
 19527           DFHEIV20,
 19528           DFHEIV11,
 19529           DFHEIV99
 19530     SET ADDRESS OF FORM-MASTER TO
 19531         DFHEIV20
 19532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19533
 19534
 19535     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19536
 19537 8400-EXIT.
 19538      EXIT.
 19539
 19540 8450-READ-FORM-MASTER.
 19541
 19542
 19543* EXEC CICS  HANDLE CONDITION
 19544*        NOTFND   (8450-FORM-NOT-FOUND)
 19545*        ENDFILE  (8450-FORM-NOT-FOUND)
 19546*    END-EXEC.
 19547*    MOVE '"$I''                  ! 3 #00018655' TO DFHEIV0
 19548     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19550     MOVE X'3320233030303138363535' TO DFHEIV0(25:11)
 19551     CALL 'kxdfhei1' USING DFHEIV0
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19553
 19554
 19555
 19556* EXEC CICS   READ
 19557*        DATASET   (FORM-ID)
 19558*        RIDFLD    (ERFORM-KEY)
 19559*        INTO      (FORM-MASTER)
 19560*        GTEQ
 19561*    END-EXEC.
 19562     MOVE LENGTH OF
 19563      FORM-MASTER
 19564       TO DFHEIV11
 19565*    MOVE '&"IL       G          (   #00018660' TO DFHEIV0
 19566     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19568     MOVE X'2020233030303138363630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 361
* EL050.cbl
 19569     CALL 'kxdfhei1' USING DFHEIV0,
 19570           FORM-ID,
 19571           FORM-MASTER,
 19572           DFHEIV11,
 19573           ERFORM-KEY,
 19574           DFHEIV99,
 19575           DFHEIV99,
 19576           DFHEIV99
 19577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19578
 19579
 19580     MOVE  'Y'           TO  FORM-MASTER-SW.
 19581
 19582     GO TO  8450-EXIT.
 19583
 19584 8450-FORM-NOT-FOUND.
 19585
 19586     MOVE  'N'           TO  FORM-MASTER-SW.
 19587
 19588 8450-EXIT.
 19589      EXIT.
 19590
 19591 8500-DATE-CONVERT.
 19592
 19593* EXEC CICS LINK
 19594*        PROGRAM    ('ELDATCV')
 19595*        COMMAREA   (DATE-CONVERSION-DATA)
 19596*        LENGTH     (DC-COMM-LENGTH)
 19597*    END-EXEC.
 19598     MOVE 'ELDATCV' TO DFHEIV1
 19599*    MOVE '."C                   ''   #00018679' TO DFHEIV0
 19600     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19602     MOVE X'2020233030303138363739' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0,
 19604           DFHEIV1,
 19605           DATE-CONVERSION-DATA,
 19606           DC-COMM-LENGTH,
 19607           DFHEIV99,
 19608           DFHEIV99,
 19609           DFHEIV99
 19610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19611
 19612
 19613 8500-EXIT.
 19614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 362
* EL050.cbl
 19616
 19617 8555-RELOAD-CONTROL-FILE.
 19618     CONTINUE.
 19619
 19620 8555-EXIT.
 19621     EXIT.
 19622
 19623 8557-GETMAIN-ERPLAN.
 19624
 19625
 19626* EXEC CICS GETMAIN
 19627*        LENGTH    (840)
 19628*        SET       (ADDRESS OF PLAN-RECORDS)
 19629*    END-EXEC.
 19630     MOVE 840
 19631       TO DFHEIV11
 19632*    MOVE '," L                  $   #00018697' TO DFHEIV0
 19633     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19634     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19635     MOVE X'2020233030303138363937' TO DFHEIV0(25:11)
 19636     CALL 'kxdfhei1' USING DFHEIV0,
 19637           DFHEIV20,
 19638           DFHEIV11,
 19639           DFHEIV99
 19640     SET ADDRESS OF PLAN-RECORDS TO
 19641         DFHEIV20
 19642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19643
 19644
 19645     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19646
 19647 8557-EXIT.
 19648     EXIT.
 19649
 19650 8560-GETMAIN.
 19651
 19652* EXEC CICS GETMAIN
 19653*        LENGTH    (2000)
 19654*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19655*    END-EXEC.
 19656     MOVE 2000
 19657       TO DFHEIV11
 19658*    MOVE '," L                  $   #00018708' TO DFHEIV0
 19659     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19660     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19661     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 19662     CALL 'kxdfhei1' USING DFHEIV0,
 19663           DFHEIV20,
 19664           DFHEIV11,
 19665           DFHEIV99
 19666     SET ADDRESS OF ACCOUNT-MASTER TO
 19667         DFHEIV20
 19668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19669
 19670
 19671     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19672
 19673 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 363
* EL050.cbl
 19674     EXIT.
 19675
 19676 8570-START-ACCOUNT-MASTER.
 19677
 19678* EXEC CICS HANDLE CONDITION
 19679*        NOTFND    (0199-ACCT-NOT-FOUND)
 19680*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19681*    END-EXEC.
 19682*    MOVE '"$I''                  ! 4 #00018719' TO DFHEIV0
 19683     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19685     MOVE X'3420233030303138373139' TO DFHEIV0(25:11)
 19686     CALL 'kxdfhei1' USING DFHEIV0
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19688
 19689
 19690
 19691* EXEC CICS STARTBR
 19692*        DATASET    (ACCT-ID)
 19693*        RIDFLD     (ERACCT-KEY)
 19694*        GTEQ
 19695*    END-EXEC.
 19696     MOVE 0
 19697       TO DFHEIV11
 19698*    MOVE '&,         G          &   #00018724' TO DFHEIV0
 19699     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19701     MOVE X'2020233030303138373234' TO DFHEIV0(25:11)
 19702     CALL 'kxdfhei1' USING DFHEIV0,
 19703           ACCT-ID,
 19704           ERACCT-KEY,
 19705           DFHEIV99,
 19706           DFHEIV11,
 19707           DFHEIV99
 19708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19709
 19710
 19711 8570-EXIT.
 19712     EXIT.
 19713
 19714 8580-READ-ACCOUNT-MASTER.
 19715
 19716* EXEC CICS HANDLE CONDITION
 19717*        NOTFND    (0199-ACCT-NOT-FOUND)
 19718*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19719*    END-EXEC.
 19720*    MOVE '"$I''                  ! 5 #00018734' TO DFHEIV0
 19721     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19723     MOVE X'3520233030303138373334' TO DFHEIV0(25:11)
 19724     CALL 'kxdfhei1' USING DFHEIV0
 19725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19726
 19727
 19728
 19729* EXEC CICS READNEXT
 19730*        DATASET     (ACCT-ID)
 19731*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 364
* EL050.cbl
 19732*        RIDFLD      (ERACCT-KEY)
 19733*    END-EXEC.
 19734     MOVE LENGTH OF
 19735      ACCOUNT-MASTER
 19736       TO DFHEIV12
 19737     MOVE 0
 19738       TO DFHEIV11
 19739*    MOVE '&.IL                  )   #00018739' TO DFHEIV0
 19740     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19741     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19742     MOVE X'2020233030303138373339' TO DFHEIV0(25:11)
 19743     CALL 'kxdfhei1' USING DFHEIV0,
 19744           ACCT-ID,
 19745           ACCOUNT-MASTER,
 19746           DFHEIV12,
 19747           ERACCT-KEY,
 19748           DFHEIV99,
 19749           DFHEIV11,
 19750           DFHEIV99,
 19751           DFHEIV99
 19752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19753
 19754
 19755 8580-EXIT.
 19756     EXIT.
 19757
 19758 8582-READ-COMPENSATION-MASTER.
 19759
 19760* EXEC CICS HANDLE CONDITION
 19761*        NOTFND    (8582-COMP-NOT-FOUND)
 19762*        ENDFILE   (8582-COMP-NOT-FOUND)
 19763*    END-EXEC.
 19764*    MOVE '"$I''                  ! 6 #00018749' TO DFHEIV0
 19765     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19767     MOVE X'3620233030303138373439' TO DFHEIV0(25:11)
 19768     CALL 'kxdfhei1' USING DFHEIV0
 19769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19770
 19771
 19772
 19773* EXEC CICS READ
 19774*        DATASET     (COMP-ID)
 19775*        INTO        (COMPENSATION-MASTER)
 19776*        RIDFLD      (ERCOMP-KEY)
 19777*    END-EXEC.
 19778     MOVE LENGTH OF
 19779      COMPENSATION-MASTER
 19780       TO DFHEIV11
 19781*    MOVE '&"IL       E          (   #00018754' TO DFHEIV0
 19782     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19784     MOVE X'2020233030303138373534' TO DFHEIV0(25:11)
 19785     CALL 'kxdfhei1' USING DFHEIV0,
 19786           COMP-ID,
 19787           COMPENSATION-MASTER,
 19788           DFHEIV11,
 19789           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 365
* EL050.cbl
 19790           DFHEIV99,
 19791           DFHEIV99,
 19792           DFHEIV99
 19793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19794
 19795
 19796     MOVE 'Y'                    TO COMP-MASTER-SW
 19797
 19798     GO TO 8582-EXIT
 19799     .
 19800 8582-COMP-NOT-FOUND.
 19801
 19802     MOVE 'N'                    TO COMP-MASTER-SW.
 19803
 19804 8582-EXIT.
 19805     EXIT.
 19806
 19807 8583-READ-ERAGTC.
 19808
 19809* EXEC CICS HANDLE CONDITION
 19810*        NOTFND    (8583-AGTC-NOT-FOUND)
 19811*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19812*    END-EXEC.
 19813*    MOVE '"$I''                  ! 7 #00018772' TO DFHEIV0
 19814     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19816     MOVE X'3720233030303138373732' TO DFHEIV0(25:11)
 19817     CALL 'kxdfhei1' USING DFHEIV0
 19818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19819
 19820
 19821
 19822* EXEC CICS STARTBR
 19823*        DATASET    (AGTC-ID)
 19824*        RIDFLD     (ERAGTC-KEY)
 19825*        GTEQ
 19826*    END-EXEC.
 19827     MOVE 0
 19828       TO DFHEIV11
 19829*    MOVE '&,         G          &   #00018777' TO DFHEIV0
 19830     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19831     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19832     MOVE X'2020233030303138373737' TO DFHEIV0(25:11)
 19833     CALL 'kxdfhei1' USING DFHEIV0,
 19834           AGTC-ID,
 19835           ERAGTC-KEY,
 19836           DFHEIV99,
 19837           DFHEIV11,
 19838           DFHEIV99
 19839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19840
 19841
 19842 8583-READ-ERAGTC-NEXT.
 19843
 19844* EXEC CICS READNEXT
 19845*        DATASET     (AGTC-ID)
 19846*        INTO        (AGENT-COMMISSIONS)
 19847*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 366
* EL050.cbl
 19848*    END-EXEC.
 19849     MOVE LENGTH OF
 19850      AGENT-COMMISSIONS
 19851       TO DFHEIV12
 19852     MOVE 0
 19853       TO DFHEIV11
 19854*    MOVE '&.IL                  )   #00018784' TO DFHEIV0
 19855     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19856     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19857     MOVE X'2020233030303138373834' TO DFHEIV0(25:11)
 19858     CALL 'kxdfhei1' USING DFHEIV0,
 19859           AGTC-ID,
 19860           AGENT-COMMISSIONS,
 19861           DFHEIV12,
 19862           ERAGTC-KEY,
 19863           DFHEIV99,
 19864           DFHEIV11,
 19865           DFHEIV99,
 19866           DFHEIV99
 19867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19868
 19869
 19870*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19871
 19872     GO TO 8583-EXIT
 19873     .
 19874 8583-AGTC-NOT-FOUND.
 19875
 19876     MOVE 'N'                    TO AGTC-MASTER-SW.
 19877
 19878 8583-EXIT.
 19879     EXIT.
 19880
 19881 8584-READ-BANK-CROSS-REF.
 19882
 19883* EXEC CICS HANDLE CONDITION
 19884*        NOTFND    (8584-BXRF-NOT-FOUND)
 19885*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19886*    END-EXEC.
 19887*    MOVE '"$I''                  ! 8 #00018802' TO DFHEIV0
 19888     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19890     MOVE X'3820233030303138383032' TO DFHEIV0(25:11)
 19891     CALL 'kxdfhei1' USING DFHEIV0
 19892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19893
 19894
 19895
 19896* EXEC CICS READ
 19897*        DATASET     (BXRF-ID)
 19898*        INTO        (BANK-CROSS-REFERENCE)
 19899*        RIDFLD      (ERBXRF-KEY)
 19900*        LENGTH      (BXRF-REC-LENGTH)
 19901*    END-EXEC.
 19902*    MOVE '&"IL       E          (   #00018807' TO DFHEIV0
 19903     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19905     MOVE X'2020233030303138383037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 367
* EL050.cbl
 19906     CALL 'kxdfhei1' USING DFHEIV0,
 19907           BXRF-ID,
 19908           BANK-CROSS-REFERENCE,
 19909           BXRF-REC-LENGTH,
 19910           ERBXRF-KEY,
 19911           DFHEIV99,
 19912           DFHEIV99,
 19913           DFHEIV99
 19914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19915
 19916
 19917     MOVE 'Y'                    TO BXRF-MASTER-SW
 19918
 19919     GO TO 8584-EXIT
 19920     .
 19921 8584-BXRF-NOT-FOUND.
 19922
 19923     MOVE 'N'                    TO BXRF-MASTER-SW.
 19924
 19925 8584-EXIT.
 19926     EXIT.
 19927
 19928 8585-READ-PLAN-MASTER.
 19929
 19930
 19931* EXEC CICS HANDLE CONDITION
 19932*        NOTFND    (8585-PLAN-NOT-FOUND)
 19933*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19934*    END-EXEC.
 19935*    MOVE '"$I''                  ! 9 #00018827' TO DFHEIV0
 19936     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19938     MOVE X'3920233030303138383237' TO DFHEIV0(25:11)
 19939     CALL 'kxdfhei1' USING DFHEIV0
 19940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19941
 19942
 19943
 19944* EXEC CICS READ
 19945*        DATASET     (PLAN-ID)
 19946*        INTO        (PLAN-MASTER)
 19947*        RIDFLD      (ERPLAN-KEY)
 19948*    END-EXEC.
 19949     MOVE LENGTH OF
 19950      PLAN-MASTER
 19951       TO DFHEIV11
 19952*    MOVE '&"IL       E          (   #00018832' TO DFHEIV0
 19953     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19955     MOVE X'2020233030303138383332' TO DFHEIV0(25:11)
 19956     CALL 'kxdfhei1' USING DFHEIV0,
 19957           PLAN-ID,
 19958           PLAN-MASTER,
 19959           DFHEIV11,
 19960           ERPLAN-KEY,
 19961           DFHEIV99,
 19962           DFHEIV99,
 19963           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 368
* EL050.cbl
 19964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19965
 19966
 19967     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19968
 19969     GO TO 8585-EXIT.
 19970
 19971 8585-PLAN-NOT-FOUND.
 19972
 19973     MOVE 'N'                    TO PLAN-MASTER-SW.
 19974
 19975 8585-EXIT.
 19976     EXIT.
 19977
 19978 8586-READ-LOAN-OFFICER.
 19979
 19980* EXEC CICS READ
 19981*        DATASET     (LOFC-ID)
 19982*        INTO        (LOAN-OFFICER-MASTER)
 19983*        RIDFLD      (ERLOFC-KEY)
 19984*        RESP        (WS-RESPONSE)
 19985*    END-EXEC
 19986     MOVE LENGTH OF
 19987      LOAN-OFFICER-MASTER
 19988       TO DFHEIV11
 19989*    MOVE '&"IL       E          (  N#00018850' TO DFHEIV0
 19990     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19992     MOVE X'204E233030303138383530' TO DFHEIV0(25:11)
 19993     CALL 'kxdfhei1' USING DFHEIV0,
 19994           LOFC-ID,
 19995           LOAN-OFFICER-MASTER,
 19996           DFHEIV11,
 19997           ERLOFC-KEY,
 19998           DFHEIV99,
 19999           DFHEIV99,
 20000           DFHEIV99
 20001     MOVE EIBRESP  TO WS-RESPONSE
 20002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20003
 20004     IF WS-RESP-NORMAL
 20005        MOVE 'Y'                 TO LOFC-MASTER-SW
 20006     ELSE
 20007        MOVE 'N'                 TO LOFC-MASTER-SW
 20008     END-IF
 20009     .
 20010 8586-EXIT.
 20011     EXIT.
 20012 8587-START-ERPDEF.
 20013
 20014* EXEC CICS STARTBR
 20015*       DATASET   (PDEF-ID)
 20016*       RIDFLD    (ERPDEF-KEY)
 20017*       GTEQ
 20018*       RESP      (WS-RESPONSE)
 20019*    END-EXEC
 20020     MOVE 0
 20021       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 369
* EL050.cbl
 20022*    MOVE '&,         G          &  N#00018866' TO DFHEIV0
 20023     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20024     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20025     MOVE X'204E233030303138383636' TO DFHEIV0(25:11)
 20026     CALL 'kxdfhei1' USING DFHEIV0,
 20027           PDEF-ID,
 20028           ERPDEF-KEY,
 20029           DFHEIV99,
 20030           DFHEIV11,
 20031           DFHEIV99
 20032     MOVE EIBRESP  TO WS-RESPONSE
 20033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20034     IF WS-RESP-NORMAL
 20035        MOVE 'Y'                 TO PDEF-MASTER-SW
 20036     ELSE
 20037        MOVE 'N'                 TO PDEF-MASTER-SW
 20038     END-IF
 20039     .
 20040 8587-EXIT.
 20041     EXIT.
 20042 8588-READ-ERPDEF.
 20043
 20044* EXEC CICS READNEXT
 20045*       DATASET   (PDEF-ID)
 20046*       RIDFLD    (ERPDEF-KEY)
 20047*       INTO      (PRODUCT-MASTER)
 20048*       RESP      (WS-RESPONSE)
 20049*    END-EXEC
 20050     MOVE LENGTH OF
 20051      PRODUCT-MASTER
 20052       TO DFHEIV12
 20053     MOVE 0
 20054       TO DFHEIV11
 20055*    MOVE '&.IL                  )  N#00018881' TO DFHEIV0
 20056     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20057     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20058     MOVE X'204E233030303138383831' TO DFHEIV0(25:11)
 20059     CALL 'kxdfhei1' USING DFHEIV0,
 20060           PDEF-ID,
 20061           PRODUCT-MASTER,
 20062           DFHEIV12,
 20063           ERPDEF-KEY,
 20064           DFHEIV99,
 20065           DFHEIV11,
 20066           DFHEIV99,
 20067           DFHEIV99
 20068     MOVE EIBRESP  TO WS-RESPONSE
 20069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20070     IF WS-RESP-NORMAL
 20071        MOVE 'Y'                 TO PDEF-MASTER-SW
 20072     ELSE
 20073        MOVE 'N'                 TO PDEF-MASTER-SW
 20074     END-IF
 20075     .
 20076 8588-EXIT.
 20077     EXIT.
 20078 8589-ENDBR-ERPDEF.
 20079
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 370
* EL050.cbl
 20080* EXEC CICS ENDBR
 20081*       DATASET   (PDEF-ID)
 20082*    END-EXEC
 20083     MOVE 0
 20084       TO DFHEIV11
 20085*    MOVE '&2                    $   #00018896' TO DFHEIV0
 20086     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20087     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20088     MOVE X'2020233030303138383936' TO DFHEIV0(25:11)
 20089     CALL 'kxdfhei1' USING DFHEIV0,
 20090           PDEF-ID,
 20091           DFHEIV11,
 20092           DFHEIV99
 20093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20094     .
 20095 8589-EXIT.
 20096     EXIT.
 20097 8590-READ-CERT-MASTER.
 20098     IF PB-COMPANY-ID = 'UCL'
 20099         GO TO 8690-READ-CERT-MASTER-UCL.
 20100
 20101
 20102* EXEC CICS HANDLE CONDITION
 20103*         NOTFND    (0299-CERT-NOT-FOUND)
 20104*    END-EXEC.
 20105*    MOVE '"$I                   ! : #00018906' TO DFHEIV0
 20106     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20108     MOVE X'3A20233030303138393036' TO DFHEIV0(25:11)
 20109     CALL 'kxdfhei1' USING DFHEIV0
 20110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20111
 20112
 20113
 20114* EXEC CICS READ
 20115*        DATASET     (CERT-ID)
 20116*        INTO        (CERTIFICATE-MASTER)
 20117*        RIDFLD      (ELCERT-KEY)
 20118*        UPDATE
 20119*    END-EXEC.
 20120     MOVE LENGTH OF
 20121      CERTIFICATE-MASTER
 20122       TO DFHEIV11
 20123*    MOVE '&"IL       EU         (   #00018910' TO DFHEIV0
 20124     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20125     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20126     MOVE X'2020233030303138393130' TO DFHEIV0(25:11)
 20127     CALL 'kxdfhei1' USING DFHEIV0,
 20128           CERT-ID,
 20129           CERTIFICATE-MASTER,
 20130           DFHEIV11,
 20131           ELCERT-KEY,
 20132           DFHEIV99,
 20133           DFHEIV99,
 20134           DFHEIV99
 20135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20136
 20137
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 371
* EL050.cbl
 20138 8590-EXIT.
 20139     EXIT.
 20140
 20141 8690-READ-CERT-MASTER-UCL.
 20142
 20143* EXEC CICS HANDLE CONDITION
 20144*         NOTFND    (8700-READ-CERT-MASTER)
 20145*    END-EXEC.
 20146*    MOVE '"$I                   ! ; #00018921' TO DFHEIV0
 20147     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20149     MOVE X'3B20233030303138393231' TO DFHEIV0(25:11)
 20150     CALL 'kxdfhei1' USING DFHEIV0
 20151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20152
 20153
 20154 8690-READ-CERT-CONT.
 20155
 20156* EXEC CICS READ
 20157*        DATASET     (CERT-ID)
 20158*        INTO        (CERTIFICATE-MASTER)
 20159*        RIDFLD      (ELCERT-KEY)
 20160*        UPDATE
 20161*    END-EXEC.
 20162     MOVE LENGTH OF
 20163      CERTIFICATE-MASTER
 20164       TO DFHEIV11
 20165*    MOVE '&"IL       EU         (   #00018926' TO DFHEIV0
 20166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20168     MOVE X'2020233030303138393236' TO DFHEIV0(25:11)
 20169     CALL 'kxdfhei1' USING DFHEIV0,
 20170           CERT-ID,
 20171           CERTIFICATE-MASTER,
 20172           DFHEIV11,
 20173           ELCERT-KEY,
 20174           DFHEIV99,
 20175           DFHEIV99,
 20176           DFHEIV99
 20177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20178
 20179
 20180     GO TO 8590-EXIT.
 20181
 20182 8700-READ-CERT-MASTER.
 20183     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20184     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20185
 20186* EXEC CICS HANDLE CONDITION
 20187*         DUPKEY    (8720-COMP-ACCOUNTS)
 20188*         ENDFILE   (8730-END-BROWSE)
 20189*         NOTFND    (8740-NOT-FOUND)
 20190*    END-EXEC.
 20191*    MOVE '"$$''I                 ! < #00018938' TO DFHEIV0
 20192     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20194     MOVE X'3C20233030303138393338' TO DFHEIV0(25:11)
 20195     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 372
* EL050.cbl
 20196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20197
 20198
 20199
 20200* EXEC CICS STARTBR
 20201*        DATASET     ('ELCERT5')
 20202*        RIDFLD      (ELCERT2-KEY)
 20203*        EQUAL
 20204*    END-EXEC.
 20205     MOVE 'ELCERT5' TO DFHEIV1
 20206     MOVE 0
 20207       TO DFHEIV11
 20208*    MOVE '&,         E          &   #00018944' TO DFHEIV0
 20209     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20211     MOVE X'2020233030303138393434' TO DFHEIV0(25:11)
 20212     CALL 'kxdfhei1' USING DFHEIV0,
 20213           DFHEIV1,
 20214           ELCERT2-KEY,
 20215           DFHEIV99,
 20216           DFHEIV11,
 20217           DFHEIV99
 20218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20219
 20220
 20221 8710-READ-NEXT.
 20222
 20223* EXEC CICS READNEXT
 20224*        DATASET     ('ELCERT5')
 20225*        INTO        (CERTIFICATE-MASTER)
 20226*        RIDFLD      (ELCERT2-KEY)
 20227*    END-EXEC.
 20228     MOVE LENGTH OF
 20229      CERTIFICATE-MASTER
 20230       TO DFHEIV12
 20231     MOVE 'ELCERT5' TO DFHEIV1
 20232     MOVE 0
 20233       TO DFHEIV11
 20234*    MOVE '&.IL                  )   #00018951' TO DFHEIV0
 20235     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20236     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20237     MOVE X'2020233030303138393531' TO DFHEIV0(25:11)
 20238     CALL 'kxdfhei1' USING DFHEIV0,
 20239           DFHEIV1,
 20240           CERTIFICATE-MASTER,
 20241           DFHEIV12,
 20242           ELCERT2-KEY,
 20243           DFHEIV99,
 20244           DFHEIV11,
 20245           DFHEIV99,
 20246           DFHEIV99
 20247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20248
 20249
 20250 8720-COMP-ACCOUNTS.
 20251
 20252* EXEC CICS ENTER
 20253*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 373
* EL050.cbl
 20254*         FROM (PB-C-LAST-NAME)
 20255*    END-EXEC.
 20256     MOVE 001
 20257       TO DFHEIV11
 20258*    MOVE ':$F                   %   #00018958' TO DFHEIV0
 20259     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20260     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20261     MOVE X'2020233030303138393538' TO DFHEIV0(25:11)
 20262     CALL 'kxdfhei1' USING DFHEIV0,
 20263           DFHEIV11,
 20264           PB-C-LAST-NAME,
 20265           DFHEIV99,
 20266           DFHEIV99
 20267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20268
 20269
 20270
 20271* EXEC CICS ENTER
 20272*         TRACEID (002)
 20273*         FROM (CM-INSURED-LAST-NAME)
 20274*    END-EXEC.
 20275     MOVE 002
 20276       TO DFHEIV11
 20277*    MOVE ':$F                   %   #00018963' TO DFHEIV0
 20278     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20279     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20280     MOVE X'2020233030303138393633' TO DFHEIV0(25:11)
 20281     CALL 'kxdfhei1' USING DFHEIV0,
 20282           DFHEIV11,
 20283           CM-INSURED-LAST-NAME,
 20284           DFHEIV99,
 20285           DFHEIV99
 20286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20287
 20288
 20289     IF PB-CERT-NO NOT = CM-CERT-NO
 20290         GO TO 8730-END-BROWSE.
 20291
 20292     IF PB-ACCOUNT = CM-ACCOUNT
 20293         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20294             MOVE ER-2799        TO WS-ERROR
 20295             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20296             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20297             GO TO 8730-END-BROWSE.
 20298
 20299     GO TO 8710-READ-NEXT.
 20300
 20301 8730-END-BROWSE.
 20302
 20303* EXEC CICS ENDBR
 20304*         DATASET    ('ELCERT5')
 20305*    END-EXEC.
 20306     MOVE 'ELCERT5' TO DFHEIV1
 20307     MOVE 0
 20308       TO DFHEIV11
 20309*    MOVE '&2                    $   #00018981' TO DFHEIV0
 20310     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20311     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 374
* EL050.cbl
 20312     MOVE X'2020233030303138393831' TO DFHEIV0(25:11)
 20313     CALL 'kxdfhei1' USING DFHEIV0,
 20314           DFHEIV1,
 20315           DFHEIV11,
 20316           DFHEIV99
 20317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20318
 20319
 20320 8740-NOT-FOUND.
 20321     GO TO 0299-CERT-NOT-FOUND.
 20322
 20323 8750-START-ELSTAT.
 20324
 20325* EXEC CICS STARTBR
 20326*       DATASET   (STAT-ID)
 20327*       RIDFLD    (ELSTAT-KEY)
 20328*       GTEQ
 20329*       RESP      (WS-RESPONSE)
 20330*    END-EXEC
 20331     MOVE 0
 20332       TO DFHEIV11
 20333*    MOVE '&,         G          &  N#00018989' TO DFHEIV0
 20334     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20335     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20336     MOVE X'204E233030303138393839' TO DFHEIV0(25:11)
 20337     CALL 'kxdfhei1' USING DFHEIV0,
 20338           STAT-ID,
 20339           ELSTAT-KEY,
 20340           DFHEIV99,
 20341           DFHEIV11,
 20342           DFHEIV99
 20343     MOVE EIBRESP  TO WS-RESPONSE
 20344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20345     IF WS-RESP-NORMAL
 20346        MOVE 'Y'                 TO STAT-MASTER-SW
 20347     ELSE
 20348        MOVE 'N'                 TO STAT-MASTER-SW
 20349     END-IF
 20350     .
 20351 8750-EXIT.
 20352     EXIT.
 20353 8752-READ-ELSTAT.
 20354
 20355* EXEC CICS READNEXT
 20356*       DATASET   (STAT-ID)
 20357*       RIDFLD    (ELSTAT-KEY)
 20358*       INTO      (STATE-FILE)
 20359*       RESP      (WS-RESPONSE)
 20360*    END-EXEC
 20361     MOVE LENGTH OF
 20362      STATE-FILE
 20363       TO DFHEIV12
 20364     MOVE 0
 20365       TO DFHEIV11
 20366*    MOVE '&.IL                  )  N#00019004' TO DFHEIV0
 20367     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20368     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20369     MOVE X'204E233030303139303034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 375
* EL050.cbl
 20370     CALL 'kxdfhei1' USING DFHEIV0,
 20371           STAT-ID,
 20372           STATE-FILE,
 20373           DFHEIV12,
 20374           ELSTAT-KEY,
 20375           DFHEIV99,
 20376           DFHEIV11,
 20377           DFHEIV99,
 20378           DFHEIV99
 20379     MOVE EIBRESP  TO WS-RESPONSE
 20380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20381     IF WS-RESP-NORMAL
 20382        MOVE 'Y'                 TO STAT-MASTER-SW
 20383     ELSE
 20384        MOVE 'N'                 TO STAT-MASTER-SW
 20385     END-IF
 20386     .
 20387 8752-EXIT.
 20388     EXIT.
 20389 8800-GET-COMP-RATE.
 20390     MOVE +1 TO IB.
 20391     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20392         ADD +9 TO IB
 20393         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20394             ADD +9 TO IB
 20395             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20396                MOVE ZEROS       TO WS-WK-RATE
 20397                GO TO 8800-EXIT.
 20398
 20399     IF PB-I-AGE GREATER CT-AGE (1)
 20400         ADD +3 TO IB
 20401         IF PB-I-AGE GREATER CT-AGE (2)
 20402             ADD +3 TO IB
 20403             IF PB-I-AGE GREATER CT-AGE (3)
 20404                MOVE ZEROS       TO WS-WK-RATE
 20405                GO TO 8800-EXIT.
 20406
 20407     IF WS-WORK-TERM GREATER CT-TRM (1)
 20408         ADD +1 TO IB
 20409         IF WS-WORK-TERM GREATER CT-TRM (2)
 20410             ADD +1 TO IB
 20411             IF WS-WORK-TERM GREATER CT-TRM (3)
 20412                MOVE ZEROS       TO WS-WK-RATE
 20413                GO TO 8800-EXIT.
 20414
 20415     IF CT-RT (IB) NOT NUMERIC
 20416         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20417         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20418         GO TO 8800-GET-COMP-RATE.
 20419
 20420     MOVE CT-RT (IB) TO WS-WK-RATE.
 20421
 20422 8800-EXIT.
 20423     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 376
* EL050.cbl
 20425 8900-ADDRESS-FILE.
 20426     IF ERACCT-FILE-ADDRESSED
 20427         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20428         GO TO 8900-ADDRESS-EXIT.
 20429
 20430     IF ELCNTL-FILE-ADDRESSED
 20431         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20432         GO TO 8900-ADDRESS-EXIT.
 20433
 20434     IF ERPLAN-FILE-ADDRESSED
 20435         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20436         GO TO 8900-ADDRESS-EXIT.
 20437
 20438     IF ERFORM-FILE-ADDRESSED
 20439         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20440         GO TO 8900-ADDRESS-EXIT.
 20441
 20442 8900-ADDRESS-EXIT.
 20443     EXIT.
 20444
 20445 9000-READ-CONTROL.
 20446
 20447* EXEC CICS HANDLE CONDITION
 20448*        NOTFND    (9000-NOTFND)
 20449*    END-EXEC.
 20450*    MOVE '"$I                   ! = #00019075' TO DFHEIV0
 20451     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20453     MOVE X'3D20233030303139303735' TO DFHEIV0(25:11)
 20454     CALL 'kxdfhei1' USING DFHEIV0
 20455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20456
 20457
 20458
 20459* EXEC CICS READ
 20460*        DATASET     (CNTL-ID)
 20461*        SET         (ADDRESS OF CONTROL-FILE)
 20462*        RIDFLD      (ELCNTL-KEY)
 20463*        GTEQ
 20464*    END-EXEC.
 20465*    MOVE '&"S        G          (   #00019079' TO DFHEIV0
 20466     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20468     MOVE X'2020233030303139303739' TO DFHEIV0(25:11)
 20469     CALL 'kxdfhei1' USING DFHEIV0,
 20470           CNTL-ID,
 20471           DFHEIV20,
 20472           DFHEIV99,
 20473           ELCNTL-KEY,
 20474           DFHEIV99,
 20475           DFHEIV99,
 20476           DFHEIV99
 20477     SET ADDRESS OF CONTROL-FILE TO
 20478         DFHEIV20
 20479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20480
 20481
 20482     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 377
* EL050.cbl
 20483
 20484 9000-NOTFND.
 20485     IF RC-SW-1 = '1'
 20486        MOVE ER-2616              TO WS-ERROR
 20487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20488        GO TO 9000-EXIT.
 20489
 20490     IF RC-SW-1 = '2'
 20491        MOVE ER-2602              TO WS-ERROR
 20492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20493
 20494 9000-EXIT.
 20495      EXIT.
 20496
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 378
* EL050.cbl
 20498 9100-READ-CONTROL.
 20499
 20500* EXEC CICS HANDLE CONDITION
 20501*        NOTFND  (9100-NOTFND)
 20502*        ENDFILE (9100-NOTFND)
 20503*    END-EXEC.
 20504*    MOVE '"$I''                  ! > #00019103' TO DFHEIV0
 20505     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20507     MOVE X'3E20233030303139313033' TO DFHEIV0(25:11)
 20508     CALL 'kxdfhei1' USING DFHEIV0
 20509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20510
 20511
 20512
 20513* EXEC CICS READ
 20514*        DATASET     (CNTL-ID)
 20515*        INTO        (CONTROL-FILE)
 20516*        RIDFLD      (ELCNTL-KEY)
 20517*        GTEQ
 20518*    END-EXEC.
 20519     MOVE LENGTH OF
 20520      CONTROL-FILE
 20521       TO DFHEIV11
 20522*    MOVE '&"IL       G          (   #00019108' TO DFHEIV0
 20523     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20524     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20525     MOVE X'2020233030303139313038' TO DFHEIV0(25:11)
 20526     CALL 'kxdfhei1' USING DFHEIV0,
 20527           CNTL-ID,
 20528           CONTROL-FILE,
 20529           DFHEIV11,
 20530           ELCNTL-KEY,
 20531           DFHEIV99,
 20532           DFHEIV99,
 20533           DFHEIV99
 20534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20535
 20536
 20537     GO TO 9100-EXIT.
 20538
 20539 9100-NOTFND.
 20540     IF RC-SW-2 = '0'
 20541        MOVE '1'                  TO STATE-RECORD-ERROR
 20542        GO TO 9100-EXIT
 20543     END-IF
 20544     IF RC-SW-2 = '1'
 20545        MOVE '1'                  TO LF-BENEFIT-ERROR
 20546        MOVE ER-2604              TO WS-ERROR
 20547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20548        GO TO 9100-EXIT.
 20549
 20550     IF RC-SW-2 = '2'
 20551        MOVE '1'                  TO AH-BENEFIT-ERROR
 20552        MOVE ER-2605              TO WS-ERROR
 20553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20554        GO TO 9100-EXIT.
 20555
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 379
* EL050.cbl
 20556     IF RC-SW-2 = '3'
 20557         MOVE ER-2603           TO WS-ERROR
 20558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20559         GO TO 9100-EXIT.
 20560
 20561     IF RC-SW-2 = '4'
 20562         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20563         GO TO 9100-EXIT.
 20564
 20565     IF RC-SW-2 = '5'
 20566         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20567         IF WS-AH-INPUT-CD-1 = SPACE
 20568             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20569         ELSE
 20570             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20571
 20572 9100-EXIT.
 20573      EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 380
* EL050.cbl
 20575 9200-CONTROL-GETMAIN.
 20576
 20577* EXEC CICS GETMAIN
 20578*         LENGTH   (750)
 20579*         SET      (ADDRESS OF CONTROL-FILE)
 20580*    END-EXEC.
 20581     MOVE 750
 20582       TO DFHEIV11
 20583*    MOVE '," L                  $   #00019154' TO DFHEIV0
 20584     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20585     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20586     MOVE X'2020233030303139313534' TO DFHEIV0(25:11)
 20587     CALL 'kxdfhei1' USING DFHEIV0,
 20588           DFHEIV20,
 20589           DFHEIV11,
 20590           DFHEIV99
 20591     SET ADDRESS OF CONTROL-FILE TO
 20592         DFHEIV20
 20593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20594
 20595
 20596     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20597
 20598 9200-EXIT.
 20599     EXIT.
 20600
 20601 9250-UNLOCK-RETURN.
 20602
 20603* EXEC CICS UNLOCK
 20604*        DATASET   (CERT-ID)
 20605*    END-EXEC.
 20606*    MOVE '&*                    #   #00019165' TO DFHEIV0
 20607     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20608     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20609     MOVE X'2020233030303139313635' TO DFHEIV0(25:11)
 20610     CALL 'kxdfhei1' USING DFHEIV0,
 20611           CERT-ID,
 20612           DFHEIV99
 20613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20614
 20615
 20616 9300-ABEND.
 20617     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20618
 20619
 20620* EXEC CICS LINK
 20621*        PROGRAM   ('EL004')
 20622*        COMMAREA  (WS-ERROR-LINE)
 20623*        LENGTH    (72)
 20624*    END-EXEC.
 20625     MOVE 'EL004' TO DFHEIV1
 20626     MOVE 72
 20627       TO DFHEIV11
 20628*    MOVE '."C                   ''   #00019172' TO DFHEIV0
 20629     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20630     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20631     MOVE X'2020233030303139313732' TO DFHEIV0(25:11)
 20632     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 381
* EL050.cbl
 20633           DFHEIV1,
 20634           WS-ERROR-LINE,
 20635           DFHEIV11,
 20636           DFHEIV99,
 20637           DFHEIV99,
 20638           DFHEIV99
 20639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20640
 20641
 20642     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20643
 20644
 20645* EXEC CICS ABEND
 20646*        ABCODE ('EL50')
 20647*    END-EXEC.
 20648     MOVE 'EL50' TO DFHEIV5
 20649*    MOVE '.,A                   "   #00019180' TO DFHEIV0
 20650     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20651     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20652     MOVE X'2020233030303139313830' TO DFHEIV0(25:11)
 20653     CALL 'kxdfhei1' USING DFHEIV0,
 20654           DFHEIV5
 20655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20656
 20657
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 382
* EL050.cbl
 20659
 20660******************************************************************
 20661*                                                                *
 20662*            E R R O R   F O R M A T   R O U T I N E             *
 20663*                                                                *
 20664******************************************************************
 20665
 20666 9900-ERROR-FORMAT.
 20667
 20668     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20669                    PB-COMMON-ERROR (2) OR
 20670                    PB-COMMON-ERROR (3) OR
 20671                    PB-COMMON-ERROR (4) OR
 20672                    PB-COMMON-ERROR (5) OR
 20673                    PB-COMMON-ERROR (6) OR
 20674                    PB-COMMON-ERROR (7) OR
 20675                    PB-COMMON-ERROR (8) OR
 20676                    PB-COMMON-ERROR (9) OR
 20677                    PB-COMMON-ERROR (10)
 20678        GO TO 9900-EXIT.
 20679
 20680     IF PB-NO-OF-ERRORS = +10
 20681        GO TO 9900-EXIT.
 20682
 20683     ADD +1  TO PB-NO-OF-ERRORS.
 20684     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20685                                       (PB-NO-OF-ERRORS).
 20686 9900-EXIT.
 20687     EXIT.
 20688
 20689 9990-RETURN.
 20690     IF BROWSE-STARTED
 20691
 20692* EXEC CICS ENDBR
 20693*            DATASET  (ACCT-ID)
 20694*       END-EXEC.
 20695     MOVE 0
 20696       TO DFHEIV11
 20697*    MOVE '&2                    $   #00019217' TO DFHEIV0
 20698     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20699     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20700     MOVE X'2020233030303139323137' TO DFHEIV0(25:11)
 20701     CALL 'kxdfhei1' USING DFHEIV0,
 20702           ACCT-ID,
 20703           DFHEIV11,
 20704           DFHEIV99
 20705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20706
 20707
 20708 9990-EXIT.
 20709     EXIT.
 20710
 20711 9999-RETURN.
 20712     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20713
 20714
 20715* EXEC CICS RETURN
 20716*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 383
* EL050.cbl
 20717*    MOVE '.(                    &   #00019227' TO DFHEIV0
 20718     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20720     MOVE X'2020233030303139323237' TO DFHEIV0(25:11)
 20721     CALL 'kxdfhei1' USING DFHEIV0,
 20722           DFHEIV99,
 20723           DFHEIV99,
 20724           DFHEIV99,
 20725           DFHEIV99,
 20726           DFHEIV99
 20727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20728
 20729
 20730
 20731* GOBACK.
 20732     MOVE '9%                    "   ' TO DFHEIV0
 20733     MOVE 'EL050' TO DFHEIV1
 20734     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20735     GOBACK.
 20736
 20737 9999-DFHBACK SECTION.
 20738     MOVE '9%                    "   ' TO DFHEIV0
 20739     MOVE 'EL050' TO DFHEIV1
 20740     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20741     GOBACK.
 20742 9999-DFHEXIT.
 20743     IF DFHEIGDJ EQUAL 0001
 20744         NEXT SENTENCE
 20745     ELSE IF DFHEIGDJ EQUAL 2
 20746         GO TO 9300-ABEND,
 20747               3990-FILES-NOT-OPEN
 20748         DEPENDING ON DFHEIGDI
 20749     ELSE IF DFHEIGDJ EQUAL 3
 20750         GO TO 6610-START-BROWSE,
 20751               6630-ERRESS-PROBLEM,
 20752               6630-END-OF-FILE
 20753         DEPENDING ON DFHEIGDI
 20754     ELSE IF DFHEIGDJ EQUAL 4
 20755         GO TO 6630-END-OF-FILE,
 20756               6630-ERRESS-PROBLEM,
 20757               6630-ERRESS-PROBLEM,
 20758               6630-END-OF-FILE
 20759         DEPENDING ON DFHEIGDI
 20760     ELSE IF DFHEIGDJ EQUAL 5
 20761         GO TO 6630-END-OF-FILE,
 20762               6630-END-OF-FILE,
 20763               6630-ERRESS-PROBLEM,
 20764               6630-ERRESS-PROBLEM
 20765         DEPENDING ON DFHEIGDI
 20766     ELSE IF DFHEIGDJ EQUAL 6
 20767         GO TO 6660-START-BROWSE,
 20768               6690-ERRESC-PROBLEM,
 20769               6690-ERRESC-PROBLEM,
 20770               6690-END-OF-FILE
 20771         DEPENDING ON DFHEIGDI
 20772     ELSE IF DFHEIGDJ EQUAL 7
 20773         GO TO 6690-END-OF-FILE,
 20774               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 384
* EL050.cbl
 20775               6690-ERRESC-PROBLEM,
 20776               6690-END-OF-FILE
 20777         DEPENDING ON DFHEIGDI
 20778     ELSE IF DFHEIGDJ EQUAL 8
 20779         GO TO 6690-END-OF-FILE,
 20780               6690-ERRESC-PROBLEM,
 20781               6690-ERRESC-PROBLEM,
 20782               6690-END-OF-FILE
 20783         DEPENDING ON DFHEIGDI
 20784     ELSE IF DFHEIGDJ EQUAL 9
 20785         GO TO 7250-CONTINUE,
 20786               7250-CONTINUE
 20787         DEPENDING ON DFHEIGDI
 20788     ELSE IF DFHEIGDJ EQUAL 10
 20789         GO TO 7300-CONTINUE,
 20790               7300-CONTINUE
 20791         DEPENDING ON DFHEIGDI
 20792     ELSE IF DFHEIGDJ EQUAL 11
 20793         GO TO 8000-FREE-MAIN
 20794         DEPENDING ON DFHEIGDI
 20795     ELSE IF DFHEIGDJ EQUAL 12
 20796         GO TO 8100-NOTFND,
 20797               8100-NOTFND
 20798         DEPENDING ON DFHEIGDI
 20799     ELSE IF DFHEIGDJ EQUAL 13
 20800         GO TO 8110-NOTFND,
 20801               8110-NOTFND
 20802         DEPENDING ON DFHEIGDI
 20803     ELSE IF DFHEIGDJ EQUAL 14
 20804         GO TO 8130-EXIT
 20805         DEPENDING ON DFHEIGDI
 20806     ELSE IF DFHEIGDJ EQUAL 15
 20807         GO TO 8180-NOTFND
 20808         DEPENDING ON DFHEIGDI
 20809     ELSE IF DFHEIGDJ EQUAL 16
 20810         GO TO 8190-NOTFND
 20811         DEPENDING ON DFHEIGDI
 20812     ELSE IF DFHEIGDJ EQUAL 17
 20813         GO TO 8200-NOTFND
 20814         DEPENDING ON DFHEIGDI
 20815     ELSE IF DFHEIGDJ EQUAL 18
 20816         GO TO 8300-NOTFND,
 20817               8300-ERRESS-PROBLEM,
 20818               8300-ERRESS-PROBLEM,
 20819               8300-NOTFND
 20820         DEPENDING ON DFHEIGDI
 20821     ELSE IF DFHEIGDJ EQUAL 19
 20822         GO TO 8450-FORM-NOT-FOUND,
 20823               8450-FORM-NOT-FOUND
 20824         DEPENDING ON DFHEIGDI
 20825     ELSE IF DFHEIGDJ EQUAL 20
 20826         GO TO 0199-ACCT-NOT-FOUND,
 20827               0199-ACCT-NOT-FOUND
 20828         DEPENDING ON DFHEIGDI
 20829     ELSE IF DFHEIGDJ EQUAL 21
 20830         GO TO 0199-ACCT-NOT-FOUND,
 20831               0199-ACCT-NOT-FOUND
 20832         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:33 Page 385
* EL050.cbl
 20833     ELSE IF DFHEIGDJ EQUAL 22
 20834         GO TO 8582-COMP-NOT-FOUND,
 20835               8582-COMP-NOT-FOUND
 20836         DEPENDING ON DFHEIGDI
 20837     ELSE IF DFHEIGDJ EQUAL 23
 20838         GO TO 8583-AGTC-NOT-FOUND,
 20839               8583-AGTC-NOT-FOUND
 20840         DEPENDING ON DFHEIGDI
 20841     ELSE IF DFHEIGDJ EQUAL 24
 20842         GO TO 8584-BXRF-NOT-FOUND,
 20843               8584-BXRF-NOT-FOUND
 20844         DEPENDING ON DFHEIGDI
 20845     ELSE IF DFHEIGDJ EQUAL 25
 20846         GO TO 8585-PLAN-NOT-FOUND,
 20847               8585-PLAN-NOT-FOUND
 20848         DEPENDING ON DFHEIGDI
 20849     ELSE IF DFHEIGDJ EQUAL 26
 20850         GO TO 0299-CERT-NOT-FOUND
 20851         DEPENDING ON DFHEIGDI
 20852     ELSE IF DFHEIGDJ EQUAL 27
 20853         GO TO 8700-READ-CERT-MASTER
 20854         DEPENDING ON DFHEIGDI
 20855     ELSE IF DFHEIGDJ EQUAL 28
 20856         GO TO 8720-COMP-ACCOUNTS,
 20857               8730-END-BROWSE,
 20858               8740-NOT-FOUND
 20859         DEPENDING ON DFHEIGDI
 20860     ELSE IF DFHEIGDJ EQUAL 29
 20861         GO TO 9000-NOTFND
 20862         DEPENDING ON DFHEIGDI
 20863     ELSE IF DFHEIGDJ EQUAL 30
 20864         GO TO 9100-NOTFND,
 20865               9100-NOTFND
 20866         DEPENDING ON DFHEIGDI.
 20867     MOVE '9%                    "   ' TO DFHEIV0
 20868     MOVE 'EL050' TO DFHEIV1
 20869     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20870     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39416     Code:       84360
