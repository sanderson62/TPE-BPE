* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52******************************************************************
    53 environment division.
    54 data division.
    55 working-storage section.
    56 01  DFH-START PIC X(04).
    57*
    58* program buffers
    59*
    60 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    61     88  ALREADY-SENT              VALUE 'Y'.
    62 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    63 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    64     88  ELCERT-FINISHED            VALUE 'Y'.
    65 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    66 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    67     88  ERACCT-FOUND               VALUE 'Y'.
    68 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    69 77 ws-send-msg-size           pic s9(8) comp value 4096.
    70 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    71 77 ws-recv-buf                pic x(4096).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   3
* SOCK03.cbl
    72 77 ws-send-buf                pic x(4096) VALUE SPACES.
    73 77 ws-recv-total              pic s9(8) comp value 0.
    74 77 ws-recv-left               pic s9(8) comp value 0.
    75 77 ws-seq-num                 pic s9(8) comp value 0.
    76 77 ws-flags                   pic s9(8) comp value 0.
    77 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    78 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    79 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    80 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    81 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    82 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    83 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    84 77  ws-cancel-reason            pic x   value spaces.
    85 77  P1                          PIC S999 COMP-3 VALUE +0.
    86 77  P2                          PIC S999 COMP-3 VALUE +0.
    87 77  C0                          PIC S999 COMP-3 VALUE +0.
    88 77  C1                          PIC S999 COMP-3 VALUE +0.
    89 77  C2                          PIC S999 COMP-3 VALUE +0.
    90 77  C3                          PIC S999 COMP-3 VALUE +0.
    91 77 S1                           PIC S999 COMP-3 VALUE +0.
    92 77 S2                           PIC S999 COMP-3 VALUE +0.
    93 77 L1                           PIC S999 COMP-3 VALUE +0.
    94 77 L2                           PIC S999 COMP-3 VALUE +0.
    95 77 F1                           PIC S999 COMP-3 VALUE +0.
    96 77 WS-BUILD-SW                  PIC X.
    97    88  TIME-TO-BUILD               VALUE 'Y'.
    98 77 WS-SAVE-ERACCT               PIC X(2000).
    99 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   100 77 WS-STOP-SW                   PIC X  VALUE ' '.
   101    88  TOLD-TO-STOP               VALUE 'Y'.
   102 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   103    88  GET-RATES                    VALUE 'R'.
   104    88  GET-ACT-ACCTS                VALUE 'A'.
   105 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   106 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   107 77 ws-disp-rate                 pic z9.99999.
   108 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   109     88  END-OF-ERCTBL                 VALUE 'Y'.
   110 77  WS-STATUS                   PIC X.
   111 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   112 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   113 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   114 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   115 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   116 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   117 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   118 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   119 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   120 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   121 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   122 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   123     88  WS-ELCERT-FULL             VALUE '1'.
   124     88  WS-ELCERT-NAME             VALUE '2'.
   125     88  WS-ELCERT-CERT-NO          VALUE '3'.
   126     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   127 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   128 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   129     88  I-SAY-TO-STOP      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   4
* SOCK03.cbl
   130 77  WS-HEX-0A                   PIC X.
   131 77  WS-CALL-TYPE                PIC X(6).
   132 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   133 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   134 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   135 77  DD-IU-SW                    PIC X   VALUE ' '.
   136     88  DD-IU-PRESENT                 VALUE 'Y'.
   137 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   138 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   139 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   140 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   141 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   142 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   143 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   144 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   145 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   146     88  PDEF-FOUND                              VALUE 'Y'.
   147 77  ws-epiq-sw                  pic x  value ' '.
   148     88  ws-epiq-request           value 'Y'.
   149 77  ws-epiq-max                 pic s999 value +0 comp-3.
   150 01  WS-STRING-DATA.
   151     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   152     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   153     05  WS-CARRIER              PIC X        VALUE SPACES.
   154     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   155     05  WS-STATE                PIC XX       VALUE SPACES.
   156     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   157     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   158     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   159     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   160     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   161     05  WS-MID-INIT             PIC X        VALUE SPACES.
   162     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   163     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   164     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   165     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   166     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   167     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   168     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   169     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   170     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   171     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   172     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   173     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   174     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   175     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   176     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   177     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   178     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   179     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   180     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   181     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   182     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   183     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   184     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   185     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   186     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   187     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   5
* SOCK03.cbl
   188     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   189     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   190     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   191     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   192     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   193     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   194     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   195     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   196     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   197     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   198     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   199     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   200     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   201 01  ws-work-date.
   202     05  ws-work-ccyy            pic x(4).
   203     05  ws-work-mm              pic xx.
   204     05  ws-work-dd              pic xx.
   205 01  ws-work-date-num redefines ws-work-date
   206                                 pic 9(8).
   207 01  FILLER.
   208     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   209     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   210     12  WS-STATE-ABBREVIATION   PIC XX.
   211     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   212     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   213     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   214     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   215     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   216     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   217     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   218     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   219     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   220     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   221     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   222     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   223     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   224     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   225     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   226     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   227     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   228     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   229     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   230     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   231     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   232     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   233     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   234     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   235     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   236     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   237         88  WS-REDUCING                         VALUE 'R'.
   238         88  WS-LEVEL                            VALUE 'L'  'P'.
   239 01  ELMSTR-KEY.
   240     12  ELMSTR-COMP-CD          PIC X.
   241     12  ELMSTR-CERT-NO          PIC X(11).
   242 01  CTBL-KEY-SAVE               PIC X(5).
   243 01  CTBL-KEY.
   244     05  CTBL-COMPANY-CD         PIC X.
   245     05  CTBL-TABLE              PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   6
* SOCK03.cbl
   246     05  CTBL-BEN-TYPE           PIC X.
   247     05  CTBL-BEN-CODE           PIC XX.
   248 01  ERPDEF-KEY-SAVE             PIC X(18).
   249 01  ERPDEF-KEY.
   250     12  ERPDEF-COMPANY-CD       PIC X.
   251     12  ERPDEF-STATE            PIC XX.
   252     12  ERPDEF-PROD-CD          PIC XXX.
   253     12  F                       PIC X(7).
   254     12  ERPDEF-BEN-TYPE         PIC X.
   255     12  ERPDEF-BEN-CODE         PIC XX.
   256     12  ERPDEF-EXP-DT           PIC XX.
   257 01  WS-AM3-KEY.
   258     12  WS-AM3-ACCOUNT          PIC X(10).
   259     12  WS-AM3-EXP-DT           PIC XX.
   260 01  WS-AM-KEY.
   261     12  WS-AM-COMPANY-CD        PIC X.
   262     12  WS-AM-CARRIER           PIC X.
   263     12  WS-AM-GROUPING          PIC X(6).
   264     12  WS-AM-STATE             PIC XX.
   265     12  WS-AM-ACCOUNT           PIC X(10).
   266     12  WS-AM-EXPIRATION-DT     PIC XX.
   267     12  WS-AM-FILLER            PIC XXXX.
   268 01  WS-CO-DATA.
   269     05  WS-CO-NUM               PIC X(10).
   270     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   271     05  WS-CO-NAME              PIC X(30).
   272     05  WS-CO-MAIL-NAME         PIC X(30).
   273     05  WS-CO-ADDR1             PIC X(30).
   274     05  WS-CO-ADDR2             PIC X(30).
   275     05  WS-CO-ADDR3             PIC X(30).
   276     05  WS-CO-ZIP               PIC X(9).
   277     05  WS-CO-PHONE             PIC X(10).
   278 01  WS-CF-KEY.
   279     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   280     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   281*        88  COMPANY-MASTER                      VALUE '1'.
   282*        88  STATE-MASTER                        VALUE '3'.
   283*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   284*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   285     12  WS-CF-ACCESS.
   286         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   287         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   288             20  FILLER          PIC  X(01).
   289             20  WS-CF-CARRIER   PIC  X(01).
   290     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   291 01  WS-CM-KEY.
   292     05  WS-CM-COMPANY-CD        PIC X.
   293     05  WS-CM-CARRIER           PIC X.
   294     05  WS-CM-GROUP             PIC X(6).
   295     05  WS-CM-STATE             PIC XX.
   296     05  WS-CM-ACCOUNT           PIC X(10).
   297     05  WS-CM-EFF-DT            PIC XX.
   298     05  WS-CM-CERT-NO           PIC X(11).
   299 01  WS-CM-KEY-A1.
   300     05  WS-CM-COMPANY-CD-A1     PIC X.
   301     05  WS-CM-LAST-NAME         PIC X(15).
   302     05  WS-CM-INITIALS          PIC XX.
   303 01  WS-CM-KEY-A4.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   7
* SOCK03.cbl
   304     05  WS-CM-COMPANY-CD-A4     PIC X.
   305     05  WS-CM-CERT-NO-A4        PIC X(11).
   306 01  WS-CID-NO                   PIC X(8).
   307 01  WS-DISP-RESP                PIC 9(5).
   308 01  WS-RESPONSE                 PIC S9(8)   COMP.
   309     88  RESP-NORMAL                  VALUE +00.
   310     88  RESP-NOTFND                  VALUE +13.
   311     88  RESP-DUPKEY                  VALUE +15.
   312     88  RESP-NOTOPEN                 VALUE +19.
   313     88  RESP-ENDFILE                 VALUE +20.
   314*                                 COPY ELCCERT.
   315******************************************************************
   316*                                                                *
   317*                            ELCCERT.                            *
   318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   319*                            VMOD=2.013                          *
   320*                                                                *
   321*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   322*                                                                *
   323*   FILE TYPE = VSAM,KSDS                                        *
   324*   RECORD SIZE = 450  RECFORM = FIXED                           *
   325*                                                                *
   326*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   327*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   328*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   329*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   330*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   331*                                                                *
   332*   LOG = YES                                                    *
   333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   334******************************************************************
   335*                   C H A N G E   L O G
   336*
   337* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   338*-----------------------------------------------------------------
   339*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   340* EFFECTIVE    NUMBER
   341*-----------------------------------------------------------------
   342* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   343* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   344* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   345* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   346* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   347* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   348* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   349* 032612  CR2011110200001  PEMA  AHL CHANGES
   350* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   351* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   352******************************************************************
   353
   354 01  CERTIFICATE-MASTER.
   355     12  CM-RECORD-ID                      PIC XX.
   356         88  VALID-CM-ID                      VALUE 'CM'.
   357
   358     12  CM-CONTROL-PRIMARY.
   359         16  CM-COMPANY-CD                 PIC X.
   360         16  CM-CARRIER                    PIC X.
   361         16  CM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   8
* SOCK03.cbl
   362             20  CM-GROUPING-PREFIX        PIC X(3).
   363             20  CM-GROUPING-PRIME         PIC X(3).
   364         16  CM-STATE                      PIC XX.
   365         16  CM-ACCOUNT.
   366             20  CM-ACCOUNT-PREFIX         PIC X(4).
   367             20  CM-ACCOUNT-PRIME          PIC X(6).
   368         16  CM-CERT-EFF-DT                PIC XX.
   369         16  CM-CERT-NO.
   370             20  CM-CERT-PRIME             PIC X(10).
   371             20  CM-CERT-SFX               PIC X.
   372
   373     12  CM-CONTROL-BY-NAME.
   374         16  CM-COMPANY-CD-A1              PIC X.
   375         16  CM-INSURED-LAST-NAME          PIC X(15).
   376         16  CM-INSURED-INITIALS.
   377             20  CM-INSURED-INITIAL1       PIC X.
   378             20  CM-INSURED-INITIAL2       PIC X.
   379
   380     12  CM-CONTROL-BY-SSN.
   381         16  CM-COMPANY-CD-A2              PIC X.
   382         16  CM-SOC-SEC-NO.
   383             20  CM-SSN-STATE              PIC XX.
   384             20  CM-SSN-ACCOUNT            PIC X(6).
   385             20  CM-SSN-LN3.
   386                 25  CM-INSURED-INITIALS-A2.
   387                     30 CM-INSURED-INITIAL1-A2   PIC X.
   388                     30 CM-INSURED-INITIAL2-A2   PIC X.
   389                 25 CM-PART-LAST-NAME-A2         PIC X.
   390
   391     12  CM-CONTROL-BY-CERT-NO.
   392         16  CM-COMPANY-CD-A4              PIC X.
   393         16  CM-CERT-NO-A4                 PIC X(11).
   394
   395     12  CM-CONTROL-BY-MEMB.
   396         16  CM-COMPANY-CD-A5              PIC X.
   397         16  CM-MEMBER-NO.
   398             20  CM-MEMB-STATE             PIC XX.
   399             20  CM-MEMB-ACCOUNT           PIC X(6).
   400             20  CM-MEMB-LN4.
   401                 25  CM-INSURED-INITIALS-A5.
   402                     30 CM-INSURED-INITIAL1-A5   PIC X.
   403                     30 CM-INSURED-INITIAL2-A5   PIC X.
   404                 25 CM-PART-LAST-NAME-A5         PIC XX.
   405
   406     12  CM-INSURED-PROFILE-DATA.
   407         16  CM-INSURED-FIRST-NAME.
   408             20  CM-INSURED-1ST-INIT       PIC X.
   409             20  FILLER                    PIC X(9).
   410         16  CM-INSURED-ISSUE-AGE          PIC 99.
   411         16  CM-INSURED-SEX                PIC X.
   412             88  CM-SEX-MALE                  VALUE 'M'.
   413             88  CM-SEX-FEMAL                 VALUE 'F'.
   414         16  CM-INSURED-JOINT-AGE          PIC 99.
   415         16  CM-JOINT-INSURED-NAME.
   416             20  CM-JT-LAST-NAME           PIC X(15).
   417             20  CM-JT-FIRST-NAME.
   418                 24  CM-JT-1ST-INIT        PIC X.
   419                 24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page   9
* SOCK03.cbl
   420             20  CM-JT-INITIAL             PIC X.
   421
   422     12  CM-LIFE-DATA.
   423         16  CM-LF-BENEFIT-CD              PIC XX.
   424         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   425         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   426         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   427         16  CM-LF-DEV-CODE                PIC XXX.
   428         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   429         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   430         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   431         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   432         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   433         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   434         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   435         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   436         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   437         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   438         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   439         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   440         16  cm-temp-epiq                  pic xx.
   441             88  EPIQ-CLASS                  value 'EQ'.
   442*        16  FILLER                        PIC XX.
   443
   444     12  CM-AH-DATA.
   445         16  CM-AH-BENEFIT-CD              PIC XX.
   446         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   447         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   448         16  CM-AH-DEV-CODE                PIC XXX.
   449         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   450         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   451         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   452         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   453         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   454         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   455         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   456         16  CM-AH-PAID-THRU-DT            PIC XX.
   457             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   458         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   459         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   460         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   461         16  FILLER                        PIC X.
   462
   463     12  CM-LOAN-INFORMATION.
   464         16  CM-LIVES                      PIC S9(7)     COMP-3.
   465         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   466                                           PIC S9(5)V99  COMP-3.
   467         16  CM-BILLED                     PIC S9(7)     COMP-3.
   468         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   469         16  CM-PAY-FREQUENCY              PIC S99.
   470         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   471         16  CM-RATE-CLASS                 PIC XX.
   472         16  CM-BENEFICIARY                PIC X(25).
   473         16  CM-POLICY-FORM-NO             PIC X(12).
   474         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   475         16  CM-LAST-ADD-ON-DT             PIC XX.
   476         16  CM-DEDUCTIBLE-AMOUNTS.
   477             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  10
* SOCK03.cbl
   478             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   479         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   480             20  CM-RESIDENT-STATE         PIC XX.
   481             20  CM-RATE-CODE              PIC X(4).
   482             20  FILLER                    PIC XX.
   483         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   484             20  CM-LOAN-OFFICER           PIC X(5).
   485             20  FILLER                    PIC XXX.
   486         16  CM-CSR-CODE                   PIC XXX.
   487         16  CM-UNDERWRITING-CODE          PIC X.
   488             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   489         16  CM-POST-CARD-IND              PIC X.
   490         16  CM-NH-INTERFACE-SW            PIC X.
   491         16  CM-PREMIUM-TYPE               PIC X.
   492             88  CM-SING-PRM                  VALUE '1'.
   493             88  CM-O-B-COVERAGE              VALUE '2'.
   494             88  CM-OPEN-END                  VALUE '3'.
   495         16  CM-IND-GRP-TYPE               PIC X.
   496             88  CM-INDIVIDUAL                VALUE 'I'.
   497             88  CM-GROUP                     VALUE 'G'.
   498         16  CM-SKIP-CODE                  PIC X.
   499             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   500             88  SKIP-JULY                    VALUE '1'.
   501             88  SKIP-AUGUST                  VALUE '2'.
   502             88  SKIP-SEPTEMBER               VALUE '3'.
   503             88  SKIP-JULY-AUG                VALUE '4'.
   504             88  SKIP-AUG-SEPT                VALUE '5'.
   505             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   506             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   507             88  SKIP-JUNE                    VALUE '8'.
   508             88  SKIP-JUNE-JULY               VALUE '9'.
   509             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   510             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   511         16  CM-PAYMENT-MODE               PIC X.
   512             88  PAY-MONTHLY                  VALUE SPACE.
   513             88  PAY-WEEKLY                   VALUE '1'.
   514             88  PAY-SEMI-MONTHLY             VALUE '2'.
   515             88  PAY-BI-WEEKLY                VALUE '3'.
   516             88  PAY-SEMI-ANUALLY             VALUE '4'.
   517         16  CM-LOAN-NUMBER                PIC X(8).
   518         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   519         16  CM-OLD-LOF                    PIC XXX.
   520*        16  CM-LOAN-OFFICER               PIC XXX.
   521         16  CM-REIN-TABLE                 PIC XXX.
   522         16  CM-SPECIAL-REIN-CODE          PIC X.
   523         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   524         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   525         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   526
   527     12  CM-STATUS-DATA.
   528         16  CM-ENTRY-STATUS               PIC X.
   529         16  CM-ENTRY-DT                   PIC XX.
   530
   531         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   532         16  CM-LF-CANCEL-DT               PIC XX.
   533         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   534
   535         16  CM-LF-STATUS-AT-DEATH         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  11
* SOCK03.cbl
   536         16  CM-LF-DEATH-DT                PIC XX.
   537         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   538
   539         16  CM-LF-CURRENT-STATUS          PIC X.
   540             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   541                                                'M' '4' '5' '9'.
   542             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   543             88  CM-LF-POLICY-PENDING         VALUE '2'.
   544             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   545             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   546             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   547             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   548             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   549             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   550             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   551             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   552             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   553             88  CM-LF-DECLINED               VALUE 'D'.
   554             88  CM-LF-VOIDED                 VALUE 'V'.
   555
   556         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   557         16  CM-AH-CANCEL-DT               PIC XX.
   558         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   559
   560         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   561         16  CM-AH-SETTLEMENT-DT           PIC XX.
   562         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   563
   564         16  CM-AH-CURRENT-STATUS          PIC X.
   565             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   566                                                'M' '4' '5' '9'.
   567             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   568             88  CM-AH-POLICY-PENDING         VALUE '2'.
   569             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   570             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   571             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   572             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   573             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   574             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   575             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   576             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   577             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   578             88  CM-AH-DECLINED               VALUE 'D'.
   579             88  CM-AH-VOIDED                 VALUE 'V'.
   580
   581         16  CM-CLAIM-INTERFACE-SW         PIC X.
   582             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   583             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   584             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   585         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   586
   587         16  CM-ENTRY-BATCH                PIC X(6).
   588         16  CM-LF-EXIT-BATCH              PIC X(6).
   589         16  CM-AH-EXIT-BATCH              PIC X(6).
   590         16  CM-LAST-MONTH-END             PIC XX.
   591
   592     12  CM-NOTE-SW                        PIC X.
   593         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  12
* SOCK03.cbl
   594         88  CERT-NOTES-PRESENT               VALUE '1'.
   595         88  BILLING-NOTES-PRESENT            VALUE '2'.
   596         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   597         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   598         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   599         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   600         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   601     12  CM-COMP-EXCP-SW                   PIC X.
   602         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   603         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   604     12  CM-INSURED-ADDRESS-SW             PIC X.
   605         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   606         88  INSURED-ADDR-PRESENT             VALUE '1'.
   607
   608*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   609     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   610     12  FILLER                            PIC X.
   611
   612*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   613     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   614     12  FILLER                            PIC X.
   615*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   616     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   617
   618     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   619         88  CERT-ADDED-BATCH                 VALUE ' '.
   620         88  CERT-ADDED-ONLINE                VALUE '1'.
   621         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   622         88  CERT-PURGED-OFFLINE              VALUE '3'.
   623         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   624     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   625         88  CERT-AS-LOADED                   VALUE ' '.
   626         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   627         88  CERT-CLAIM-ONLINE                VALUE '2'.
   628         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   629         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   630         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   631         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   632         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   633
   634     12  CM-ACCOUNT-COMM-PCTS.
   635         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   636         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   637
   638     12  CM-USER-FIELD                     PIC X.
   639     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   640     12  CM-CLP-STATE                      PIC XX.
   641     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   642     12  CM-USER-RESERVED                  PIC XXX.
   643     12  FILLER REDEFINES CM-USER-RESERVED.
   644         16  CM-AH-CLASS-CD                PIC XX.
   645         16  F                             PIC X.
   646******************************************************************
   647*                                 COPY ELCMSTR.
   648******************************************************************
   649*                                                                *
   650*                            ELCMSTR.                            *
   651*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  13
* SOCK03.cbl
   652*                            VMOD=2.012                          *
   653*                                                                *
   654*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   655*                                                                *
   656*   FILE TYPE = VSAM,KSDS                                        *
   657*   RECORD SIZE = 350  RECFORM = FIXED                           *
   658*                                                                *
   659*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   660*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   661*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   662*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   663*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   664*                                                 RKP=75,LEN=21  *
   665*                                                                *
   666*   **** NOTE ****                                               *
   667*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   668*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   669*                                                                *
   670*   LOG = YES                                                    *
   671*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   672******************************************************************
   673*                   C H A N G E   L O G
   674*
   675* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   676*-----------------------------------------------------------------
   677*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   678* EFFECTIVE    NUMBER
   679*-----------------------------------------------------------------
   680* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   681* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   682* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   683* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   684* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   685* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   686******************************************************************
   687 01  CLAIM-MASTER.
   688     12  CL-RECORD-ID                PIC XX.
   689         88  VALID-CL-ID         VALUE 'CL'.
   690
   691     12  CL-CONTROL-PRIMARY.
   692         16  CL-COMPANY-CD           PIC X.
   693         16  CL-CARRIER              PIC X.
   694         16  CL-CLAIM-NO             PIC X(7).
   695         16  CL-CERT-NO.
   696             20  CL-CERT-PRIME       PIC X(10).
   697             20  CL-CERT-SFX         PIC X.
   698
   699     12  CL-CONTROL-BY-NAME.
   700         16  CL-COMPANY-CD-A1        PIC X.
   701         16  CL-INSURED-LAST-NAME    PIC X(15).
   702         16  CL-INSURED-NAME.
   703             20  CL-INSURED-1ST-NAME PIC X(12).
   704             20  CL-INSURED-MID-INIT PIC X.
   705
   706     12  CL-CONTROL-BY-SSN.
   707         16  CL-COMPANY-CD-A2        PIC X.
   708         16  CL-SOC-SEC-NO.
   709             20  CL-SSN-STATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  14
* SOCK03.cbl
   710             20  CL-SSN-ACCOUNT      PIC X(6).
   711             20  CL-SSN-LN3          PIC X(3).
   712
   713     12  CL-CONTROL-BY-CERT-NO.
   714         16  CL-COMPANY-CD-A4        PIC X.
   715         16  CL-CERT-NO-A4.
   716             20  CL-CERT-A4-PRIME    PIC X(10).
   717             20  CL-CERT-A4-SFX      PIC X.
   718
   719     12  CL-CONTROL-BY-CCN.
   720         16  CL-COMPANY-CD-A5        PIC X.
   721         16  CL-CCN-A5.
   722             20  CL-CCN.
   723                 24  CL-CCN-PREFIX-A5 PIC X(4).
   724                 24  CL-CCN-PRIME-A5 PIC X(12).
   725             20  CL-CCN-FILLER-A5    PIC X(4).
   726
   727     12  CL-INSURED-PROFILE-DATA.
   728         16  CL-INSURED-BIRTH-DT     PIC XX.
   729         16  CL-INSURED-SEX-CD       PIC X.
   730             88  INSURED-IS-MALE        VALUE 'M'.
   731             88  INSURED-IS-FEMALE      VALUE 'F'.
   732             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   733         16  CL-INSURED-OCC-CD       PIC X(6).
   734         16  FILLER                  PIC X(5).
   735
   736     12  CL-PROCESSING-INFO.
   737         16  CL-PROCESSOR-ID         PIC X(4).
   738         16  CL-CLAIM-STATUS         PIC X.
   739             88  CLAIM-IS-OPEN          VALUE 'O'.
   740             88  CLAIM-IS-CLOSED        VALUE 'C'.
   741         16  CL-CLAIM-TYPE           PIC X.
   742*            88  AH-CLAIM               VALUE 'A'.
   743*            88  LIFE-CLAIM             VALUE 'L'.
   744*            88  PROPERTY-CLAIM         VALUE 'P'.
   745*            88  IUI-CLAIM              VALUE 'I'.
   746*            88  GAP-CLAIM              VALUE 'G'.
   747*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   748         16  CL-CLAIM-PREM-TYPE      PIC X.
   749             88  SINGLE-PREMIUM         VALUE '1'.
   750             88  O-B-COVERAGE           VALUE '2'.
   751             88  OPEN-END-COVERAGE      VALUE '3'.
   752         16  CL-INCURRED-DT          PIC XX.
   753         16  CL-REPORTED-DT          PIC XX.
   754         16  CL-FILE-ESTABLISH-DT    PIC XX.
   755         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   756         16  CL-LAST-PMT-DT          PIC XX.
   757         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   758         16  CL-PAID-THRU-DT         PIC XX.
   759         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   760         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   761         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   762         16  CL-PMT-CALC-METHOD      PIC X.
   763             88  CL-360-DAY-YR          VALUE '1'.
   764             88  CL-365-DAY-YR          VALUE '2'.
   765             88  CL-FULL-MONTHS         VALUE '3'.
   766         16  CL-CAUSE-CD             PIC X(6).
   767
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  15
* SOCK03.cbl
   768         16  CL-PRIME-CERT-NO.
   769             20  CL-PRIME-CERT-PRIME PIC X(10).
   770             20  CL-PRIME-CERT-SFX   PIC X.
   771
   772         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   773             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   774             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   775
   776         16  CL-MICROFILM-NO         PIC X(10).
   777         16  FILLER REDEFINES CL-MICROFILM-NO.
   778             20  CL-BENEFIT-PERIOD   PIC 99.
   779             20  FILLER              PIC X(8).
   780         16  CL-PROG-FORM-TYPE       PIC X.
   781         16  CL-LAST-ADD-ON-DT       PIC XX.
   782
   783         16  CL-LAST-REOPEN-DT       PIC XX.
   784         16  CL-LAST-CLOSE-DT        PIC XX.
   785         16  CL-LAST-CLOSE-REASON    PIC X(01).
   786             88  FINAL-PAID             VALUE '1'.
   787             88  CLAIM-DENIED           VALUE '2'.
   788             88  AUTO-CLOSE             VALUE '3'.
   789             88  MANUAL-CLOSE           VALUE '4'.
   790             88  BENEFITS-CHANGED       VALUE 'C'.
   791             88  SETUP-ERRORS           VALUE 'E'.
   792         16  CL-ASSOC-CERT-SEQU      PIC S99.
   793         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   794         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   795             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   796         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   797         16  FILLER                  PIC X.
   798
   799     12  CL-CERTIFICATE-DATA.
   800         16  CL-CERT-ORIGIN          PIC X.
   801             88  CERT-WAS-ONLINE        VALUE '1'.
   802             88  CERT-WAS-CREATED       VALUE '2'.
   803             88  COVERAGE-WAS-ADDED     VALUE '3'.
   804         16  CL-CERT-KEY-DATA.
   805             20  CL-CERT-CARRIER     PIC X.
   806             20  CL-CERT-GROUPING    PIC X(6).
   807             20  CL-CERT-STATE       PIC XX.
   808             20  CL-CERT-ACCOUNT.
   809                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   810                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   811             20  CL-CERT-EFF-DT      PIC XX.
   812
   813     12  CL-STATUS-CONTROLS.
   814         16  CL-PRIORITY-CD          PIC X.
   815             88  CONFIDENTIAL-DATA      VALUE '8'.
   816             88  HIGHEST-PRIORITY       VALUE '9'.
   817         16  CL-SUPV-ATTN-CD         PIC X.
   818             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   819             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   820         16  CL-PURGED-DT            PIC XX.
   821         16  CL-RESTORED-DT          PIC XX.
   822         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   823         16  CL-NEXT-RESEND-DT       PIC XX.
   824         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   825         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  16
* SOCK03.cbl
   826*        16  FILLER                  PIC XX.
   827         16  CL-LAST-MAINT-DT        PIC XX.
   828         16  CL-LAST-MAINT-USER      PIC X(4).
   829         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   830         16  CL-LAST-MAINT-TYPE      PIC X.
   831             88  CLAIM-SET-UP           VALUE ' '.
   832             88  PAYMENT-MADE           VALUE '1'.
   833             88  LETTER-SENT            VALUE '2'.
   834             88  MASTER-WAS-ALTERED     VALUE '3'.
   835             88  MASTER-WAS-RESTORED    VALUE '4'.
   836             88  INCURRED-DATE-CHANGED  VALUE '5'.
   837             88  FILE-CONVERTED         VALUE '6'.
   838             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   839             88  ERROR-CORRECTION       VALUE 'E'.
   840         16  CL-RELATED-CLAIM-NO     PIC X(7).
   841         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   842         16  CL-BENEFICIARY          PIC X(10).
   843         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   844         16  CL-DENIAL-TYPE          PIC X.
   845             88  CL-TYPE-DENIAL          VALUE '1'.
   846             88  CL-TYPE-RESCISSION      VALUE '2'.
   847             88  CL-TYPE-REFORMATION     VALUE '3'.
   848             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   849             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   850         16  CL-NO-OF-EXTENSIONS     PIC 99.
   851         16  filler                  pic x(3).
   852*        16  CL-CRIT-PER-RECURRENT   PIC X.
   853*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   854*        16  CL-RTW-DT               PIC XX.
   855
   856     12  CL-TRAILER-CONTROLS.
   857         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   858             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   859             88  CL-LAST-TRL-AVAIL      VALUE +100.
   860             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   861         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   862         16  FILLER                  PIC XX.
   863         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   864         16  CL-ADDRESS-TRAILER-CNT.
   865             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   866                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   867             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   868                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   869             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   870                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   871             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   872                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   873             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   874                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   875             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   876                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   877             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   878                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   879
   880     12  CL-CV-REFERENCE-NO.
   881         16  CL-CV-REFNO-PRIME       PIC X(18).
   882         16  CL-CV-REFNO-SFX         PIC XX.
   883
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  17
* SOCK03.cbl
   884     12  CL-FILE-LOCATION            PIC X(4).
   885
   886     12  CL-PROCESS-ERRORS.
   887         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   888             88  NO-FATAL-ERRORS        VALUE ZERO.
   889         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   890             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   891
   892     12  CL-PRODUCT-CD               PIC X.
   893
   894     12  CL-CURRENT-KEY-DATA.
   895         16  CL-CURRENT-CARRIER      PIC X.
   896         16  CL-CURRENT-GROUPING     PIC X(6).
   897         16  CL-CURRENT-STATE        PIC XX.
   898         16  CL-CURRENT-ACCOUNT      PIC X(10).
   899
   900     12  CL-ASSOCIATES               PIC X.
   901         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   902         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   903         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   904         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   905
   906     12  CL-ACTIVITY-CODE            PIC 99.
   907     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   908     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   909
   910     12  CL-LAPSE-REPORT-CODE        PIC 9.
   911     12  CL-LAG-REPORT-CODE          PIC 9.
   912     12  CL-LOAN-TYPE                PIC XX.
   913     12  CL-LEGAL-STATE              PIC XX.
   914
   915     12  CL-YESNOSW                  PIC X.
   916     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   917         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   918         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   919         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   920     12  cl-insured-type             pic x.
   921         88  cl-claim-on-primary         value 'P'.
   922         88  cl-claim-on-co-borrower     value 'C'.
   923     12  cl-benefit-expiration-dt    PIC XX.
   924*                                 COPY ERCPDEF.
   925******************************************************************
   926*                                                                *
   927*                                                                *
   928*                            ERCPDEF.                            *
   929*                                                                *
   930*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   931*                                                                *
   932*    FILE TYPE = VSAM,KSDS                                       *
   933*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   934*                                                                *
   935*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   936*                                                                *
   937*    LOG = YES                                                   *
   938*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   939******************************************************************
   940*                   C H A N G E   L O G
   941*
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  18
* SOCK03.cbl
   942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   943*-----------------------------------------------------------------
   944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   945* EFFECTIVE    NUMBER
   946*-----------------------------------------------------------------
   947* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   948* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   949* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   950******************************************************************
   951 01  PRODUCT-MASTER.
   952    12  PD-RECORD-ID                 PIC X(02).
   953        88  VALID-PD-ID                  VALUE 'PD'.
   954    12  PD-CONTROL-PRIMARY.
   955        16  PD-COMPANY-CD            PIC X.
   956        16  PD-STATE                 PIC XX.
   957        16  PD-PRODUCT-CD            PIC XXX.
   958        16  PD-FILLER                PIC X(7).
   959        16  PD-BEN-TYPE              PIC X.
   960        16  PD-BEN-CODE              PIC XX.
   961        16  PD-PROD-EXP-DT           PIC XX.
   962    12  FILLER                       PIC X(50).
   963    12  PD-PRODUCT-DATA OCCURS 8.
   964        16  PD-PROD-CODE             PIC X.
   965            88  PD-PROD-LIFE           VALUE 'L'.
   966            88  PD-PROD-PROP           VALUE 'P'.
   967            88  PD-PROD-AH             VALUE 'A'.
   968            88  PD-PROD-IU             VALUE 'I'.
   969            88  PD-PROD-GAP            VALUE 'G'.
   970            88  PD-PROD-FAML           VALUE 'F'.
   971        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   972        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   973        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   974        16  PD-MAX-TERM              PIC S999        COMP-3.
   975        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   976        16  FILLER                   PIC X.
   977        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   978        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   979        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   980        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   981        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   982        16  PD-REC-CRIT-PERIOD       PIC 99.
   983        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   984            20  PD-RECURRING-YN      PIC X.
   985            20  FILLER               PIC X.
   986        16  PD-RTW-MOS               PIC 99.
   987        16  PD-MAX-EXTENSION         PIC 99.
   988        16  pd-ben-pct               pic sv999 comp-3.
   989*       16  FILLER                   PIC XX.
   990    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   991    12  PD-TERM-LIMITS OCCURS 15.
   992        16  PD-LOW-TERM              PIC S999        COMP-3.
   993        16  PD-HI-TERM               PIC S999        COMP-3.
   994*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   995    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   996        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   997        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   998    12  PD-EARN-FACTORS.
   999        16  FILLER OCCURS 15.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  19
* SOCK03.cbl
  1000            20  FILLER OCCURS 15.
  1001                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1002    12  PD-PRODUCT-DESC              PIC X(80).
  1003    12  PD-TRUNCATED                 PIC X.
  1004    12  FILLER                       PIC X(59).
  1005    12  PD-MAINT-INFORMATION.
  1006        16  PD-LAST-MAINT-DT         PIC X(02).
  1007        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1008        16  PD-LAST-MAINT-BY         PIC X(04).
  1009*                                 COPY ERCCTBL.
  1010******************************************************************
  1011*                                                                *
  1012*                                                                *
  1013*                            ERCCTBL                             *
  1014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1015*                            VMOD=2.003
  1016*                                                                *
  1017*   ONLINE CREDIT SYSTEM                                         *
  1018*                                                                *
  1019*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1020*                                                                *
  1021*   FILE TYPE = VSAM,KSDS                                        *
  1022*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1023*                                                                *
  1024*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1025*       ALTERNATE PATH = NONE                                    *
  1026*                                                                *
  1027*   LOG = NO                                                     *
  1028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1029*                                                                *
  1030*                                                                *
  1031******************************************************************
  1032
  1033 01  COMM-TABLE-RECORD.
  1034     12  CT-RECORD-ID                      PIC XX.
  1035         88  VALID-CT-ID                      VALUE 'CT'.
  1036
  1037     12  CT-CONTROL-PRIMARY.
  1038         16  CT-COMPANY-CD                 PIC X.
  1039         16  CT-TABLE                      PIC XXX.
  1040         16  CT-CNTRL-2.
  1041             20  CT-BEN-TYPE               PIC X.
  1042             20  CT-BEN-CODE               PIC XX.
  1043
  1044     12  CT-MAINT-INFORMATION.
  1045         16  CT-LAST-MAINT-DT              PIC XX.
  1046         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1047         16  CT-LAST-MAINT-USER            PIC X(4).
  1048         16  FILLER                        PIC X(31).
  1049
  1050     12  CT-LIMITS.
  1051         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1052
  1053         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1054
  1055         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1056
  1057     12  CT-RATES.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  20
* SOCK03.cbl
  1058         16  CT-RTX          OCCURS 27 TIMES.
  1059             20  CT-RT                     PIC SV9(5)     COMP-3.
  1060             20  CT-RT-R   REDEFINES
  1061                 CT-RT                     PIC XXX.
  1062
  1063     12  FILLER                            PIC  X(42).
  1064
  1065******************************************************************
  1066*                                 COPY ELCCNTL.
  1067******************************************************************
  1068*                                                                *
  1069*                                                                *
  1070*                            ELCCNTL.                            *
  1071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1072*                            VMOD=2.059                          *
  1073*                                                                *
  1074*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1075*                                                                *
  1076*   FILE TYPE = VSAM,KSDS                                        *
  1077*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1078*                                                                *
  1079*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1080*       ALTERNATE INDEX = NONE                                   *
  1081*                                                                *
  1082*   LOG = YES                                                    *
  1083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1084******************************************************************
  1085*                   C H A N G E   L O G
  1086*
  1087* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1088*-----------------------------------------------------------------
  1089*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1090* EFFECTIVE    NUMBER
  1091*-----------------------------------------------------------------
  1092* 082503                   PEMA  ADD BENEFIT GROUP
  1093* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1094* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1095* 092705    2005050300006  PEMA  ADD SPP LEASES
  1096* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1097* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1098* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1099* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1100* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1101* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1102* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1103* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1104* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1105* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1106******************************************************************
  1107*
  1108 01  CONTROL-FILE.
  1109     12  CF-RECORD-ID                       PIC XX.
  1110         88  VALID-CF-ID                        VALUE 'CF'.
  1111
  1112     12  CF-CONTROL-PRIMARY.
  1113         16  CF-COMPANY-ID                  PIC XXX.
  1114         16  CF-RECORD-TYPE                 PIC X.
  1115             88  CF-COMPANY-MASTER              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  21
* SOCK03.cbl
  1116             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1117             88  CF-STATE-MASTER                VALUE '3'.
  1118             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1119             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1120             88  CF-CARRIER-MASTER              VALUE '6'.
  1121             88  CF-MORTALITY-MASTER            VALUE '7'.
  1122             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1123             88  CF-TERMINAL-MASTER             VALUE '9'.
  1124             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1125             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1126             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1127             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1128             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1129             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1130             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1131             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1132             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1133         16  CF-ACCESS-CD-GENL              PIC X(4).
  1134         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1135             20  CF-PROCESSOR               PIC X(4).
  1136         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1137             20  CF-STATE-CODE              PIC XX.
  1138             20  FILLER                     PIC XX.
  1139         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1140             20  FILLER                     PIC XX.
  1141             20  CF-HI-BEN-IN-REC           PIC XX.
  1142         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1143             20  FILLER                     PIC XXX.
  1144             20  CF-CARRIER-CNTL            PIC X.
  1145         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1146             20  FILLER                     PIC XX.
  1147             20  CF-HI-TYPE-IN-REC          PIC 99.
  1148         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1149             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1150                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1151             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1152             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1153         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1154             20  FILLER                     PIC X.
  1155             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1156         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1157             20  FILLER                     PIC XX.
  1158             20  CF-MORTGAGE-PLAN           PIC XX.
  1159         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1160
  1161     12  CF-LAST-MAINT-DT                   PIC XX.
  1162     12  CF-LAST-MAINT-BY                   PIC X(4).
  1163     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1164
  1165     12  CF-RECORD-BODY                     PIC X(728).
  1166
  1167
  1168****************************************************************
  1169*             COMPANY MASTER RECORD                            *
  1170****************************************************************
  1171
  1172     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1173         16  CF-COMPANY-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  22
* SOCK03.cbl
  1174             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1175             20  CF-CL-IN-CARE-OF           PIC X(30).
  1176             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1177             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1178             20  CF-CL-CITY-STATE           PIC X(30).
  1179             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1180             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1181         16  CF-COMPANY-CD                  PIC X.
  1182         16  CF-COMPANY-PASSWORD            PIC X(8).
  1183         16  CF-SECURITY-OPTION             PIC X.
  1184             88  ALL-SECURITY                   VALUE '1'.
  1185             88  COMPANY-VERIFY                 VALUE '2'.
  1186             88  PROCESSOR-VERIFY               VALUE '3'.
  1187             88  NO-SECURITY                    VALUE '4'.
  1188             88  ALL-BUT-TERM                   VALUE '5'.
  1189         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1190             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1191         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1192             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1193         16  CF-INFORCE-LOCATION            PIC X.
  1194             88  CERTS-ARE-ONLINE               VALUE '1'.
  1195             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1196             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1197         16  CF-LOWER-CASE-LETTERS          PIC X.
  1198         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1199             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1200             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1201             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1202             88  CF-ACCNT-CNTL                  VALUE '3'.
  1203             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1204
  1205         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1206         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1207
  1208         16  CF-LGX-CREDIT-USER             PIC X.
  1209             88  CO-IS-NOT-USER                 VALUE 'N'.
  1210             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1211
  1212         16 CF-CREDIT-CALC-CODES.
  1213             20  CF-CR-REM-TERM-CALC PIC X.
  1214               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1215               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1216               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1217               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1218               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1219               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1220               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1221             20  CF-CR-R78-METHOD           PIC X.
  1222               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1223               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1224
  1225         16  CF-CLAIM-CONTROL-COUNTS.
  1226             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1227                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1228
  1229             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1230                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1231
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  23
* SOCK03.cbl
  1232             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1233                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1234
  1235             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1236                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1237
  1238         16  CF-CURRENT-MONTH-END           PIC XX.
  1239
  1240         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1241             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1242             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1243             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1244             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1245                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1246                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1247             20  CF-CO-PREM-REJECT-SW       PIC X.
  1248                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1249                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1250             20  CF-CO-REF-REJECT-SW        PIC X.
  1251                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1252                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1253
  1254         16  CF-CO-REPORTING-DT             PIC XX.
  1255         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1256         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1257           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1258           88  CF-CO-MONTH-END                  VALUE '1'.
  1259
  1260         16  CF-LGX-CLAIM-USER              PIC X.
  1261             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1262             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1263
  1264         16  CF-CREDIT-EDIT-CONTROLS.
  1265             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1266             20  CF-MIN-AGE                 PIC 99.
  1267             20  CF-DEFAULT-AGE             PIC 99.
  1268             20  CF-MIN-TERM                PIC S999      COMP-3.
  1269             20  CF-MAX-TERM                PIC S999      COMP-3.
  1270             20  CF-DEFAULT-SEX             PIC X.
  1271             20  CF-JOINT-AGE-INPUT         PIC X.
  1272                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1273             20  CF-BIRTH-DATE-INPUT        PIC X.
  1274                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1275             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1276                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1277                 88  CF-ZERO-CARRIER            VALUE '1'.
  1278                 88  CF-ZERO-GROUPING           VALUE '2'.
  1279                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1280             20  CF-EDIT-SW                 PIC X.
  1281                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1282             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1283             20  CF-CR-PR-METHOD            PIC X.
  1284               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1285               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1286             20  FILLER                     PIC X.
  1287
  1288         16  CF-CREDIT-MISC-CONTROLS.
  1289             20  CF-REIN-TABLE-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  24
* SOCK03.cbl
  1290                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1291             20  CF-COMP-TABLE-SW           PIC X.
  1292                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1293             20  CF-EXPERIENCE-RETENTION-AGE
  1294                                            PIC S9        COMP-3.
  1295             20  CF-CONVERSION-DT           PIC XX.
  1296             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1297             20  CF-RUN-FREQUENCY-SW        PIC X.
  1298                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1299                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1300
  1301             20  CF-CR-CHECK-NO-CONTROL.
  1302                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1303                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1304                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1305                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1306                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1307                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1308
  1309                 24  CF-CR-CHECK-COUNT       REDEFINES
  1310                     CF-CR-CHECK-COUNTER      PIC X(4).
  1311
  1312                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1313                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1314
  1315                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1316                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1317                 24  CF-MAIL-PROCESSING       PIC X.
  1318                     88  MAIL-PROCESSING          VALUE 'Y'.
  1319
  1320         16  CF-MISC-SYSTEM-CONTROL.
  1321             20  CF-SYSTEM-C                 PIC X.
  1322                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1323             20  CF-SYSTEM-D                 PIC X.
  1324                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1325             20  CF-SOC-SEC-NO-SW            PIC X.
  1326                 88  SOC-SEC-NO-USED             VALUE '1'.
  1327             20  CF-MEMBER-NO-SW             PIC X.
  1328                 88  MEMBER-NO-USED              VALUE '1'.
  1329             20  CF-TAX-ID-NUMBER            PIC X(11).
  1330             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1331             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1332                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1333                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1334                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1335                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1336             20  CF-SYSTEM-E                 PIC X.
  1337                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1338
  1339         16  CF-LGX-LIFE-USER               PIC X.
  1340             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1341             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1342
  1343         16  CF-CR-MONTH-END-DT             PIC XX.
  1344
  1345         16  CF-FILE-MAINT-DATES.
  1346             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1347                 88  CF-LAST-BATCH-RESET        VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  25
* SOCK03.cbl
  1348             20  CF-LAST-BATCH       REDEFINES
  1349                 CF-LAST-BATCH-NO               PIC X(4).
  1350             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1351             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1352             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1353             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1354             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1355             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1356             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1357             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1358             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1359             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1360
  1361         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1362         16  FILLER                         PIC X.
  1363
  1364         16  CF-ALT-MORT-CODE               PIC X(4).
  1365         16  CF-MEMBER-CAPTION              PIC X(10).
  1366
  1367         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1368             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1369             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1370             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1371             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1372             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1373
  1374         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1375
  1376         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1377         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1378         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1379         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1380
  1381         16  CF-AH-OVERRIDE-L1              PIC X.
  1382         16  CF-AH-OVERRIDE-L2              PIC XX.
  1383         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1384         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1385
  1386         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1387         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1388
  1389         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1390         16  CF-AR-LAST-EL860-DT            PIC XX.
  1391         16  CF-MP-MONTH-END-DT             PIC XX.
  1392
  1393         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1394         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1395             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1396
  1397         16  CF-AR-MONTH-END-DT             PIC XX.
  1398
  1399         16  CF-CRDTCRD-USER                PIC X.
  1400             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1401             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1402
  1403         16  CF-CC-MONTH-END-DT             PIC XX.
  1404
  1405         16  CF-PRINT-ADDRESS-LABELS        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  26
* SOCK03.cbl
  1406
  1407         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1408             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1409             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1410             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1411         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1412         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1413         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1414         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1415             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1416             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1417         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1418         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1419         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1420             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1421         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1422
  1423         16  CF-CL-ZIP-CODE.
  1424             20  CF-CL-ZIP-PRIME.
  1425                 24  CF-CL-ZIP-1ST          PIC X.
  1426                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1427                 24  FILLER                 PIC X(4).
  1428             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1429         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1430             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1431             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1432             20  FILLER                     PIC XXX.
  1433
  1434         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1435         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1436         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1437         16  CF-CO-OPTION-START-DATE        PIC XX.
  1438         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1439           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1440                                                      '3' '4'.
  1441           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1442           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1443           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1444           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1445           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1446           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1447
  1448         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1449
  1450         16  CF-PAYMENT-APPROVAL-LEVELS.
  1451             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1452             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1453             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1454             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1455             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1456             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1457
  1458         16  CF-END-USER-REPORTING-USER     PIC X.
  1459             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1460             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1461
  1462         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1463             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  27
* SOCK03.cbl
  1464             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1465
  1466         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1467
  1468         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1469         16  FILLER                         PIC X.
  1470
  1471         16  CF-CREDIT-ARCHIVE-CNTL.
  1472             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1473             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1474             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1475
  1476         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1477
  1478         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1479             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1480             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1481
  1482         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1483             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1484             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1485
  1486         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1487
  1488         16  CF-CO-ACH-ID-CODE              PIC  X.
  1489             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1490             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1491             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1492         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1493         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1494         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1495         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1496         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1497         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1498         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1499         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1500         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1501                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1502         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1503                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1504
  1505         16  CF-CO-OVER-SHORT.
  1506             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1507             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1508
  1509*         16  FILLER                         PIC X(102).
  1510         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1511             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1512             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1513
  1514         16  CF-AH-APPROVAL-DAYS.
  1515             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1516             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1517             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1518             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1519
  1520         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1521
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  28
* SOCK03.cbl
  1522         16  CF-APPROV-LEV-5.
  1523             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1524             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1525             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1526
  1527         16  FILLER                         PIC X(68).
  1528****************************************************************
  1529*             PROCESSOR/USER RECORD                            *
  1530****************************************************************
  1531
  1532     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1533         16  CF-PROCESSOR-NAME              PIC X(30).
  1534         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1535         16  CF-PROCESSOR-TITLE             PIC X(26).
  1536         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1537                 88  MESSAGE-YES                VALUE 'Y'.
  1538                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1539
  1540*****************************************************
  1541****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1542****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1543****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1544****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1545*****************************************************
  1546
  1547         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1548             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1549             20  CF-APPLICATION-FORCE       PIC X.
  1550             20  CF-INDIVIDUAL-APP.
  1551                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1552                     28  CF-BROWSE-APP      PIC X.
  1553                     28  CF-UPDATE-APP      PIC X.
  1554
  1555         16  CF-CURRENT-TERM-ON             PIC X(4).
  1556         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1557             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1558             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1559             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1560             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1561             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1562             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1563             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1564         16  CF-PROCESSOR-CARRIER           PIC X.
  1565             88  NO-CARRIER-SECURITY            VALUE ' '.
  1566         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1567             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1568         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1569             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1570         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1571             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1572
  1573         16  CF-PROC-SYS-ACCESS-SW.
  1574             20  CF-PROC-CREDIT-CLAIMS-SW.
  1575                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1576                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1577                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1578                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1579             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  29
* SOCK03.cbl
  1580                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1581                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1582             20  CF-PROC-LIFE-GNRLDGR-SW.
  1583                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1584                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1585                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1586                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1587             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1588                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1589                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1590         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1591             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1592             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1593         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1594
  1595         16  CF-APPROVAL-LEVEL                  PIC X.
  1596             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1597             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1598             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1599             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1600             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1601
  1602         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1603
  1604         16  CF-LANGUAGE-TYPE                   PIC X.
  1605             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1606             88  CF-LANG-IS-FR                      VALUE 'F'.
  1607
  1608         16  CF-CSR-IND                         PIC X.
  1609         16  FILLER                             PIC X(239).
  1610
  1611****************************************************************
  1612*             PROCESSOR/REMINDERS RECORD                       *
  1613****************************************************************
  1614
  1615     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1616         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1617             20  CF-START-REMIND-DT         PIC XX.
  1618             20  CF-END-REMIND-DT           PIC XX.
  1619             20  CF-REMINDER-TEXT           PIC X(50).
  1620         16  FILLER                         PIC X(296).
  1621
  1622
  1623****************************************************************
  1624*             STATE MASTER RECORD                              *
  1625****************************************************************
  1626
  1627     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1628         16  CF-STATE-ABBREVIATION          PIC XX.
  1629         16  CF-STATE-NAME                  PIC X(25).
  1630         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1631         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1632             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1633             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1634             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1635             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1636                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1637                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  30
* SOCK03.cbl
  1638             20  CF-ST-PREM-REJECT-SW       PIC X.
  1639                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1640                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1641             20  CF-ST-REF-REJECT-SW        PIC X.
  1642                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1643                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1644         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1645         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1646         16  CF-ST-REFUND-RULES.
  1647             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1648             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1649             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1650         16  CF-ST-FST-PMT-EXTENSION.
  1651             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1652             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1653                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1654                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1655                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1656                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1657         16  CF-ST-STATE-CALL.
  1658             20  CF-ST-CALL-UNEARNED        PIC X.
  1659             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1660             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1661         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1662             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1663             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1664         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1665         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1666         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1667         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1668         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1669         16  FILLER                         PIC X.
  1670         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1671             20  CF-ST-BENEFIT-CD           PIC XX.
  1672             20  CF-ST-BENEFIT-KIND         PIC X.
  1673                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1674                 88  CF-ST-AH-KIND              VALUE 'A'.
  1675             20  CF-ST-REM-TERM-CALC        PIC X.
  1676                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1677                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1678                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1679                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1680                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1681                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1682                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1683                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1684
  1685             20  CF-ST-REFUND-CALC          PIC X.
  1686                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1687                 88  ST-REFD-BY-R78             VALUE '1'.
  1688                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1689                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1690                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1691                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1692                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1693                 88  ST-REFD-UTAH               VALUE '7'.
  1694                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1695                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  31
* SOCK03.cbl
  1696                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1697
  1698             20  CF-ST-EARNING-CALC         PIC X.
  1699                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1700                 88  ST-EARN-BY-R78             VALUE '1'.
  1701                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1702                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1703                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1704                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1705                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1706                 88  ST-EARN-MEAN               VALUE '8'.
  1707                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1708
  1709             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1710                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1711                 88  ST-OVRD-BY-R78             VALUE '1'.
  1712                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1713                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1714                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1715                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1716                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1717                 88  ST-OVRD-MEAN               VALUE '8'.
  1718                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1719             20  cf-st-extra-periods        pic 9.
  1720*            20  FILLER                     PIC X.
  1721
  1722         16  CF-ST-COMMISSION-CAPS.
  1723             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1724             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1725             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1726             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1727         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1728                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1729
  1730         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1731
  1732         16  CF-ST-STATUTORY-INTEREST.
  1733             20  CF-ST-STAT-DATE-FROM       PIC X.
  1734                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1735                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1736             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1737             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1738             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1739             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1740             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1741
  1742         16  CF-ST-OVER-SHORT.
  1743             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1744             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1745
  1746         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1747
  1748         16  CF-ST-RT-CALC                  PIC X.
  1749
  1750         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1751         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1752         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1753         16  CF-ST-RF-LR-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  32
* SOCK03.cbl
  1754         16  CF-ST-RF-LL-CALC               PIC X.
  1755         16  CF-ST-RF-LN-CALC               PIC X.
  1756         16  CF-ST-RF-AH-CALC               PIC X.
  1757         16  CF-ST-RF-CP-CALC               PIC X.
  1758*        16  FILLER                         PIC X(206).
  1759*CIDMOD         16  FILLER                         PIC X(192).
  1760         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1761             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1762         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1763         16  CF-ST-VFY-2ND-BENE             PIC X.
  1764         16  CF-ST-CAUSAL-STATE             PIC X.
  1765         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1766         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1767         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1768             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1769         16  CF-ST-NET-ONLY-STATE           PIC X.
  1770             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1771         16  FILLER                         PIC X(181).
  1772
  1773****************************************************************
  1774*             BENEFIT MASTER RECORD                            *
  1775****************************************************************
  1776
  1777     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1778         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1779             20  CF-BENEFIT-CODE            PIC XX.
  1780             20  CF-BENEFIT-NUMERIC  REDEFINES
  1781                 CF-BENEFIT-CODE            PIC XX.
  1782             20  CF-BENEFIT-ALPHA           PIC XXX.
  1783             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1784             20  CF-BENEFIT-COMMENT         PIC X(10).
  1785
  1786             20  CF-LF-COVERAGE-TYPE        PIC X.
  1787                 88  CF-REDUCING                VALUE 'R'.
  1788                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1789
  1790             20  CF-SPECIAL-CALC-CD         PIC X.
  1791                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1792                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1793                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1794                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1795                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1796                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1797                 88  CF-FARM-PLAN               VALUE 'F'.
  1798                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1799                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1800                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1801                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1802                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1803                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1804                 88  CF-PRUDENTIAL              VALUE 'P'.
  1805                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1806                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1807                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1808                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1809                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1810                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1811
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  33
* SOCK03.cbl
  1812             20  CF-JOINT-INDICATOR         PIC X.
  1813                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1814
  1815*            20  FILLER                     PIC X(12).
  1816             20  cf-maximum-benefits        pic s999 comp-3.
  1817             20  FILLER                     PIC X(09).
  1818             20  CF-BENEFIT-CATEGORY        PIC X.
  1819             20  CF-LOAN-TYPE               PIC X(8).
  1820
  1821             20  CF-CO-REM-TERM-CALC        PIC X.
  1822                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1823                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1824                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1825                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1826                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1827
  1828             20  CF-CO-EARNINGS-CALC        PIC X.
  1829                 88  CO-EARN-BY-R78             VALUE '1'.
  1830                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1831                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1832                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1833                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1834                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1835                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1836                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1837
  1838             20  CF-CO-REFUND-CALC          PIC X.
  1839                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1840                 88  CO-REFD-BY-R78             VALUE '1'.
  1841                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1842                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1843                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1844                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1845                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1846                 88  CO-REFD-MEAN               VALUE '8'.
  1847                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1848                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1849                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1850
  1851             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1852                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1853                 88  CO-OVRD-BY-R78             VALUE '1'.
  1854                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1855                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1856                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1857                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1858                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1859                 88  CO-OVRD-MEAN               VALUE '8'.
  1860                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1861
  1862             20  CF-CO-BEN-I-G-CD           PIC X.
  1863                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1864                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1865                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1866
  1867         16  FILLER                         PIC X(304).
  1868
  1869
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  34
* SOCK03.cbl
  1870****************************************************************
  1871*             CARRIER MASTER RECORD                            *
  1872****************************************************************
  1873
  1874     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1875         16  CF-ADDRESS-DATA.
  1876             20  CF-MAIL-TO-NAME            PIC X(30).
  1877             20  CF-IN-CARE-OF              PIC X(30).
  1878             20  CF-ADDRESS-LINE-1          PIC X(30).
  1879             20  CF-ADDRESS-LINE-2          PIC X(30).
  1880             20  CF-CITY-STATE              PIC X(30).
  1881             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1882             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1883
  1884         16  CF-CLAIM-NO-CONTROL.
  1885             20  CF-CLAIM-NO-METHOD         PIC X.
  1886                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1887                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1888                 88  CLAIM-NO-SEQ               VALUE '3'.
  1889                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1890             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1891                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1892                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1893                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1894
  1895         16  CF-CHECK-NO-CONTROL.
  1896             20  CF-CHECK-NO-METHOD         PIC X.
  1897                 88  CHECK-NO-MANUAL            VALUE '1'.
  1898                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1899                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1900                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1901             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1902                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1903
  1904         16  CF-DOMICILE-STATE              PIC XX.
  1905
  1906         16  CF-EXPENSE-CONTROLS.
  1907             20  CF-EXPENSE-METHOD          PIC X.
  1908                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1909                 88  DOLLARS-PER-PMT            VALUE '2'.
  1910                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1911                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1912             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1913             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1914
  1915         16  CF-CORRESPONDENCE-CONTROL.
  1916             20  CF-LETTER-RESEND-OPT       PIC X.
  1917                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1918                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1919             20  FILLER                     PIC X(4).
  1920
  1921         16  CF-RESERVE-CONTROLS.
  1922             20  CF-MANUAL-SW               PIC X.
  1923                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1924             20  CF-FUTURE-SW               PIC X.
  1925                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1926             20  CF-PTC-SW                  PIC X.
  1927                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  35
* SOCK03.cbl
  1928             20  CF-IBNR-SW                 PIC X.
  1929                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1930             20  CF-PTC-LF-SW               PIC X.
  1931                 88  CF-LF-PTC-USED             VALUE '1'.
  1932             20  CF-CDT-ACCESS-METHOD       PIC X.
  1933                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1934                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1935                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1936             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1937
  1938         16  CF-CLAIM-CALC-METHOD           PIC X.
  1939             88  360-PLUS-MONTHS                VALUE '1'.
  1940             88  365-PLUS-MONTHS                VALUE '2'.
  1941             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1942             88  360-DAILY                      VALUE '4'.
  1943             88  365-DAILY                      VALUE '5'.
  1944
  1945         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1946         16  FILLER                         PIC X(11).
  1947
  1948         16  CF-LIMIT-AMOUNTS.
  1949             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1950             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1951             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1952             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1953             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1954             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1955             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1956             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1957             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1958             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1959
  1960         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1961         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1962         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1963
  1964         16  CF-ZIP-CODE.
  1965             20  CF-ZIP-PRIME.
  1966                 24  CF-ZIP-1ST             PIC X.
  1967                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1968                 24  FILLER                 PIC X(4).
  1969             20  CF-ZIP-PLUS4               PIC X(4).
  1970         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1971             20  CF-CAN-POSTAL-1            PIC XXX.
  1972             20  CF-CAN-POSTAL-2            PIC XXX.
  1973             20  FILLER                     PIC XXX.
  1974
  1975         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1976         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1977         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1978
  1979         16  CF-RATING-SWITCH               PIC X.
  1980             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1981             88  CF-NO-RATING                   VALUE 'N'.
  1982
  1983         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1984
  1985         16  CF-CARRIER-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  36
* SOCK03.cbl
  1986             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1987             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1988
  1989         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1990         16  CF-SECPAY-SWITCH               PIC X.
  1991             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1992             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1993         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1994         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1995         16  FILLER                         PIC X(444).
  1996*        16  FILLER                         PIC X(452).
  1997
  1998
  1999****************************************************************
  2000*             MORTALITY MASTER RECORD                          *
  2001****************************************************************
  2002
  2003     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2004         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2005                                INDEXED BY CF-MORT-NDX.
  2006             20  CF-MORT-TABLE              PIC X(5).
  2007             20  CF-MORT-TABLE-TYPE         PIC X.
  2008                 88  CF-MORT-JOINT              VALUE 'J'.
  2009                 88  CF-MORT-SINGLE             VALUE 'S'.
  2010                 88  CF-MORT-COMBINED           VALUE 'C'.
  2011                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2012                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2013             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2014             20  CF-MORT-AGE-METHOD         PIC XX.
  2015                 88  CF-AGE-LAST                VALUE 'AL'.
  2016                 88  CF-AGE-NEAR                VALUE 'AN'.
  2017             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2018             20  CF-MORT-ADJUSTMENT-DIRECTION
  2019                                            PIC X.
  2020                 88  CF-MINUS                   VALUE '-'.
  2021                 88  CF-PLUS                    VALUE '+'.
  2022             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2023             20  CF-MORT-JOINT-CODE         PIC X.
  2024                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2025             20  CF-MORT-PC-Q               PIC X.
  2026                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2027             20  CF-MORT-TABLE-CODE         PIC X(4).
  2028             20  CF-MORT-COMMENTS           PIC X(15).
  2029             20  FILLER                     PIC X(14).
  2030
  2031         16  FILLER                         PIC X(251).
  2032
  2033
  2034****************************************************************
  2035*             BUSSINESS TYPE MASTER RECORD                     *
  2036****************************************************************
  2037
  2038     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2039* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2040* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2041* AND RECORD 05 IS TYPES 81-99
  2042         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2043             20  CF-BUSINESS-TITLE          PIC  X(19).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  37
* SOCK03.cbl
  2044             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2045                                            PIC S9V9(4) COMP-3.
  2046             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2047             20  FILLER                     PIC  X.
  2048         16  FILLER                         PIC  X(248).
  2049
  2050
  2051****************************************************************
  2052*             TERMINAL MASTER RECORD                           *
  2053****************************************************************
  2054
  2055     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2056
  2057         16  CF-COMPANY-TERMINALS.
  2058             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2059                                  PIC X(4).
  2060         16  FILLER               PIC X(248).
  2061
  2062
  2063****************************************************************
  2064*             LIFE EDIT MASTER RECORD                          *
  2065****************************************************************
  2066
  2067     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2068         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2069             20  CF-LIFE-CODE-IN            PIC XX.
  2070             20  CF-LIFE-CODE-OUT           PIC XX.
  2071         16  FILLER                         PIC X(248).
  2072
  2073
  2074****************************************************************
  2075*             AH EDIT MASTER RECORD                            *
  2076****************************************************************
  2077
  2078     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2079         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2080             20  CF-AH-CODE-IN              PIC XXX.
  2081             20  CF-AH-CODE-OUT             PIC XX.
  2082         16  FILLER                         PIC X(248).
  2083
  2084
  2085****************************************************************
  2086*             CREDIBILITY TABLES                               *
  2087****************************************************************
  2088
  2089     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2090         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2091                             INDEXED BY CF-CRDB-NDX.
  2092             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2093             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2094             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2095         16  FILLER                         PIC  X(332).
  2096
  2097
  2098****************************************************************
  2099*             REPORT CUSTOMIZATION RECORD                      *
  2100****************************************************************
  2101
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  38
* SOCK03.cbl
  2102     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2103         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2104             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2105             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2106             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2107**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2108****       A T-TRANSFER.                                   ****
  2109             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2110
  2111         16  FILLER                         PIC XX.
  2112
  2113         16  CF-CARRIER-CNTL-OPT.
  2114             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2115                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2116                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2117             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2118                                            PIC X.
  2119         16  CF-GROUP-CNTL-OPT.
  2120             20  CF-GROUP-OPT-SEQ           PIC 9.
  2121                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2122                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2123             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2124                                            PIC X(6).
  2125         16  CF-STATE-CNTL-OPT.
  2126             20  CF-STATE-OPT-SEQ           PIC 9.
  2127                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2128                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2129             20  CF-STATE-SELECT OCCURS 3 TIMES
  2130                                            PIC XX.
  2131         16  CF-ACCOUNT-CNTL-OPT.
  2132             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2133                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2134                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2135             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2136                                            PIC X(10).
  2137         16  CF-BUS-TYP-CNTL-OPT.
  2138             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2139                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2140                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2141             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2142                                            PIC XX.
  2143         16  CF-LF-TYP-CNTL-OPT.
  2144             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2145                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2146                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2147             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2148                                            PIC XX.
  2149         16  CF-AH-TYP-CNTL-OPT.
  2150             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2151                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2152                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2153             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2154                                            PIC XX.
  2155         16  CF-REPTCD1-CNTL-OPT.
  2156             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2157                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2158                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2159             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  39
* SOCK03.cbl
  2160                                            PIC X(10).
  2161         16  CF-REPTCD2-CNTL-OPT.
  2162             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2163                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2164                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2165             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2166                                            PIC X(10).
  2167         16  CF-USER1-CNTL-OPT.
  2168             20  CF-USER1-OPT-SEQ           PIC 9.
  2169                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2170                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2171             20  CF-USER1-SELECT OCCURS 3 TIMES
  2172                                            PIC X(10).
  2173         16  CF-USER2-CNTL-OPT.
  2174             20  CF-USER2-OPT-SEQ           PIC 9.
  2175                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2176                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2177             20  CF-USER2-SELECT OCCURS 3 TIMES
  2178                                            PIC X(10).
  2179         16  CF-USER3-CNTL-OPT.
  2180             20  CF-USER3-OPT-SEQ           PIC 9.
  2181                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2182                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2183             20  CF-USER3-SELECT OCCURS 3 TIMES
  2184                                            PIC X(10).
  2185         16  CF-USER4-CNTL-OPT.
  2186             20  CF-USER4-OPT-SEQ           PIC 9.
  2187                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2188                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2189             20  CF-USER4-SELECT OCCURS 3 TIMES
  2190                                            PIC X(10).
  2191         16  CF-USER5-CNTL-OPT.
  2192             20  CF-USER5-OPT-SEQ           PIC 9.
  2193                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2194                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2195             20  CF-USER5-SELECT OCCURS 3 TIMES
  2196                                            PIC X(10).
  2197         16  CF-REINS-CNTL-OPT.
  2198             20  CF-REINS-OPT-SEQ           PIC 9.
  2199                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2200                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2201             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2202                 24  CF-REINS-PRIME         PIC XXX.
  2203                 24  CF-REINS-SUB           PIC XXX.
  2204
  2205         16  CF-AGENT-CNTL-OPT.
  2206             20  CF-AGENT-OPT-SEQ           PIC 9.
  2207                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2208                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2209             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2210                                            PIC X(10).
  2211
  2212         16  FILLER                         PIC X(43).
  2213
  2214         16  CF-LOSS-RATIO-SELECT.
  2215             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2216             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2217         16  CF-ENTRY-DATE-SELECT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  40
* SOCK03.cbl
  2218             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2219             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2220         16  CF-EFFECTIVE-DATE-SELECT.
  2221             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2222             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2223
  2224         16  CF-EXCEPTION-LIST-IND          PIC X.
  2225             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2226
  2227         16  FILLER                         PIC X(318).
  2228
  2229****************************************************************
  2230*                  EXCEPTION REPORTING RECORD                  *
  2231****************************************************************
  2232
  2233     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2234         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2235             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2236
  2237         16  CF-COMBINED-LIFE-AH-OPT.
  2238             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2239             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2240             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2241             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2242
  2243         16  CF-LIFE-OPT.
  2244             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2245             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2246             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2247             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2248             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2249             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2250             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2251             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2252             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2253             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2254
  2255         16  CF-AH-OPT.
  2256             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2257             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2258             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2259             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2260             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2261             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2262             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2263             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2264             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2265             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2266
  2267         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2268             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2269             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2270             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2271
  2272         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2273
  2274         16  FILLER                         PIC X(673).
  2275
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  41
* SOCK03.cbl
  2276
  2277****************************************************************
  2278*             MORTGAGE SYSTEM PLAN RECORD                      *
  2279****************************************************************
  2280
  2281     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2282         16  CF-PLAN-TYPE                   PIC X.
  2283             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2284             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2285             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2286         16  CF-PLAN-ABBREV                 PIC XXX.
  2287         16  CF-PLAN-DESCRIPT               PIC X(10).
  2288         16  CF-PLAN-NOTES                  PIC X(20).
  2289         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2290         16  CF-PLAN-UNDERWRITING.
  2291             20  CF-PLAN-TERM-DATA.
  2292                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2293                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2294             20  CF-PLAN-AGE-DATA.
  2295                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2296                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2297                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2298             20  CF-PLAN-BENEFIT-DATA.
  2299                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2300                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2301                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2302                                            PIC S9(7)V99  COMP-3.
  2303         16  CF-PLAN-POLICY-FORMS.
  2304             20  CF-POLICY-FORM             PIC X(12).
  2305             20  CF-MASTER-APPLICATION      PIC X(12).
  2306             20  CF-MASTER-POLICY           PIC X(12).
  2307         16  CF-PLAN-RATING.
  2308             20  CF-RATE-CODE               PIC X(5).
  2309             20  CF-SEX-RATING              PIC X.
  2310                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2311                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2312             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2313             20  CF-SUB-STD-TYPE            PIC X.
  2314                 88  CF-PCT-OF-PREM            VALUE '1'.
  2315                 88  CF-PCT-OF-BENE            VALUE '2'.
  2316         16  CF-PLAN-PREM-TOLERANCES.
  2317             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2318             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2319         16  CF-PLAN-PYMT-TOLERANCES.
  2320             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2321             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2322         16  CF-PLAN-MISC-DATA.
  2323             20  FILLER                     PIC X.
  2324             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2325             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2326         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2327         16  CF-PLAN-IND-GRP                PIC X.
  2328             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2329                                                     '1'.
  2330             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2331                                                     '2'.
  2332         16  CF-MIB-SEARCH-SW               PIC X.
  2333             88  CF-MIB-SEARCH-ALL             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  42
* SOCK03.cbl
  2334             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2335             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2336             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2337         16  CF-ALPHA-SEARCH-SW             PIC X.
  2338             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2339             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2340             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2341             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2342             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2343             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2344             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2345             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2346             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2347             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2348                                                     'A' 'B' 'C'
  2349                                                     'X' 'Y' 'Z'.
  2350         16  CF-EFF-DT-RULE-SW              PIC X.
  2351             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2352             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2353             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2354             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2355             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2356         16  FILLER                         PIC X(4).
  2357         16  CF-HEALTH-QUESTIONS            PIC X.
  2358             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2359         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2360         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2361         16  CF-PLAN-SNGL-JNT               PIC X.
  2362             88  CF-COMBINED-PLAN              VALUE 'C'.
  2363             88  CF-JNT-PLAN                   VALUE 'J'.
  2364             88  CF-SNGL-PLAN                  VALUE 'S'.
  2365         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2366         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2367         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2368         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2369         16  CF-RERATE-CNTL                 PIC  X.
  2370             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2371             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2372             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2373             88  CF-AUTO-RECALC                 VALUE '4'.
  2374         16  CF-BENEFIT-TYPE                PIC  X.
  2375             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2376             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2377         16  CF-POLICY-FEE                  PIC S999V99
  2378                                                    COMP-3.
  2379         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2380         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2381         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2382         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2383         16  FILLER                         PIC  X(32).
  2384         16  CF-TERMINATION-FORM            PIC  X(04).
  2385         16  FILLER                         PIC  X(08).
  2386         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2387                                                       COMP-3.
  2388         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2389         16  CF-ISSUE-LETTER                PIC  X(4).
  2390         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2391         16  CF-DEPENDENT-COVERAGE          PIC  X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  43
* SOCK03.cbl
  2392             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2393             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2394         16  CF-MP-REFUND-CALC              PIC X.
  2395             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2396             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2397             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2398             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2399             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2400             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2401             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2402             88  CF-MP-REFD-MEAN                VALUE '8'.
  2403         16  CF-ALT-RATE-CODE               PIC  X(5).
  2404
  2405
  2406         16  FILLER                         PIC X(498).
  2407****************************************************************
  2408*             MORTGAGE COMPANY MASTER RECORD                   *
  2409****************************************************************
  2410
  2411     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2412         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2413         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2414             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2415             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2416             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2417             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2418             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2419
  2420         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2421         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2422         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2423         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2424         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2425
  2426         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2427             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2428         16  CF-MP-RECON-USE-IND            PIC X(1).
  2429             88  CF-MP-USE-RECON             VALUE 'Y'.
  2430         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2431             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2432         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2433             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2434             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2435         16  FILLER                         PIC X(1).
  2436         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2437             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2438         16  CF-MORTG-MIB-VERSION           PIC X.
  2439             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2440             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2441             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2442         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2443             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2444                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2445             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2446                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2447             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2448                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2449             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  44
* SOCK03.cbl
  2450                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2451             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2452                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2453             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2454                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2455         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2456         16  FILLER                         PIC X(7).
  2457         16  CF-MORTG-DESTINATION-SYMBOL.
  2458             20  CF-MORTG-MIB-COMM          PIC X(5).
  2459             20  CF-MORTG-MIB-TERM          PIC X(5).
  2460         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2461             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2462         16  FILLER                         PIC X(03).
  2463         16  CF-MP-CHECK-NO-CONTROL.
  2464             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2465                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2466                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2467                                                ' ' LOW-VALUES.
  2468                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2469                                               VALUE '3'.
  2470         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2471         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2472         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2473             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2474                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2475             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2476                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2477             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2478                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2479             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2480                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2481             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2482                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2483             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2484                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2485         16  CF-MORTG-BILLING-AREA.
  2486             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2487                                            PIC X.
  2488         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2489         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2490         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2491         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2492             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2493             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2494         16  FILLER                         PIC X.
  2495         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2496             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2497             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2498         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2499         16  FILLER                         PIC X(8).
  2500         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2501         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2502         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2503         16  CF-ACH-COMPANY-ID.
  2504             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2505                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2506                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2507                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  45
* SOCK03.cbl
  2508             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2509         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2510             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2511         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2512             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2513             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2514         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2515         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2516         16  FILLER                         PIC X(536).
  2517
  2518****************************************************************
  2519*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2520****************************************************************
  2521
  2522     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2523         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2524             20  CF-FEMALE-HEIGHT.
  2525                 24  CF-FEMALE-FT           PIC 99.
  2526                 24  CF-FEMALE-IN           PIC 99.
  2527             20  CF-FEMALE-MIN-WT           PIC 999.
  2528             20  CF-FEMALE-MAX-WT           PIC 999.
  2529         16  FILLER                         PIC X(428).
  2530
  2531     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2532         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2533             20  CF-MALE-HEIGHT.
  2534                 24  CF-MALE-FT             PIC 99.
  2535                 24  CF-MALE-IN             PIC 99.
  2536             20  CF-MALE-MIN-WT             PIC 999.
  2537             20  CF-MALE-MAX-WT             PIC 999.
  2538         16  FILLER                         PIC X(428).
  2539******************************************************************
  2540*             AUTOMATIC ACTIVITY RECORD                          *
  2541******************************************************************
  2542     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2543         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2544             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2545             20  CF-SYS-LETTER-ID           PIC X(04).
  2546             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2547             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2548             20  CF-SYS-RESET-SW            PIC X(01).
  2549             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2550             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2551
  2552         16  FILLER                         PIC X(50).
  2553
  2554         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2555             20  CF-USER-ACTIVE-SW          PIC X(01).
  2556             20  CF-USER-LETTER-ID          PIC X(04).
  2557             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2558             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2559             20  CF-USER-RESET-SW           PIC X(01).
  2560             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2561             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2562             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2563
  2564         16  FILLER                         PIC X(246).
  2565*                                 COPY ERCACCT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  46
* SOCK03.cbl
  2566******************************************************************
  2567*                                                                *
  2568*                                                                *
  2569*                            ERCACCT                             *
  2570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2571*                            VMOD=2.031                          *
  2572*                                                                *
  2573*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2574*                                                                *
  2575*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2576*   VSAM ACCOUNT MASTER FILES.                                   *
  2577*                                                                *
  2578*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2579*                                                                *
  2580*   FILE TYPE = VSAM,KSDS                                        *
  2581*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2582*                                                                *
  2583*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2584*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2585*                                                                *
  2586*   LOG = NO                                                     *
  2587*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2588*                                                                *
  2589*                                                                *
  2590******************************************************************
  2591*                   C H A N G E   L O G
  2592*
  2593* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2594*-----------------------------------------------------------------
  2595*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2596* EFFECTIVE    NUMBER
  2597*-----------------------------------------------------------------
  2598* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2599* 092705    2005050300006  PEMA  ADD SPP LEASES
  2600* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2601* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2602* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2603* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2604* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2605* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2606******************************************************************
  2607
  2608 01  ACCOUNT-MASTER.
  2609     12  AM-RECORD-ID                      PIC XX.
  2610         88  VALID-AM-ID                      VALUE 'AM'.
  2611
  2612     12  AM-CONTROL-PRIMARY.
  2613         16  AM-COMPANY-CD                 PIC X.
  2614         16  AM-MSTR-CNTRL.
  2615             20  AM-CONTROL-A.
  2616                 24  AM-CARRIER            PIC X.
  2617                 24  AM-GROUPING.
  2618                     28 AM-GROUPING-PREFIX PIC XXX.
  2619                     28 AM-GROUPING-PRIME  PIC XXX.
  2620                 24  AM-STATE              PIC XX.
  2621                 24  AM-ACCOUNT.
  2622                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2623                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  47
* SOCK03.cbl
  2624             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2625                                           PIC X(19).
  2626             20  AM-CNTRL-B.
  2627                 24  AM-EXPIRATION-DT      PIC XX.
  2628                 24  FILLER                PIC X(4).
  2629             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2630                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2631
  2632     12  AM-CONTROL-BY-VAR-GRP.
  2633         16  AM-COMPANY-CD-A1              PIC X.
  2634         16  AM-VG-CARRIER                 PIC X.
  2635         16  AM-VG-GROUPING                PIC X(6).
  2636         16  AM-VG-STATE                   PIC XX.
  2637         16  AM-VG-ACCOUNT                 PIC X(10).
  2638         16  AM-VG-DATE.
  2639             20  AM-VG-EXPIRATION-DT       PIC XX.
  2640             20  FILLER                    PIC X(4).
  2641         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2642                                           PIC 9(11)      COMP-3.
  2643     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2644         16  FILLER                        PIC X(10).
  2645         16  AM-VG-KEY3.
  2646             20  AM-VG3-ACCOUNT            PIC X(10).
  2647             20  AM-VG3-EXP-DT             PIC XX.
  2648         16  FILLER                        PIC X(4).
  2649     12  AM-MAINT-INFORMATION.
  2650         16  AM-LAST-MAINT-DT              PIC XX.
  2651         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2652         16  AM-LAST-MAINT-USER            PIC X(4).
  2653         16  FILLER                        PIC XX.
  2654
  2655     12  AM-EFFECTIVE-DT                   PIC XX.
  2656     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2657
  2658     12  AM-PREV-DATES  COMP-3.
  2659         16  AM-PREV-EXP-DT                PIC 9(11).
  2660         16  AM-PREV-EFF-DT                PIC 9(11).
  2661
  2662     12  AM-REPORT-CODE-1                  PIC X(10).
  2663     12  AM-REPORT-CODE-2                  PIC X(10).
  2664
  2665     12  AM-CITY-CODE                      PIC X(4).
  2666     12  AM-COUNTY-PARISH                  PIC X(6).
  2667
  2668     12  AM-NAME                           PIC X(30).
  2669     12  AM-PERSON                         PIC X(30).
  2670     12  AM-ADDRS                          PIC X(30).
  2671     12  AM-CITY.
  2672         16  AM-ADDR-CITY                  PIC X(28).
  2673         16  AM-ADDR-STATE                 PIC XX.
  2674     12  AM-ZIP.
  2675         16  AM-ZIP-PRIME.
  2676             20  AM-ZIP-PRI-1ST            PIC X.
  2677                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2678             20  FILLER                    PIC X(4).
  2679         16  AM-ZIP-PLUS4                  PIC X(4).
  2680     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2681         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  48
* SOCK03.cbl
  2682         16  AM-CAN-POSTAL-2               PIC XXX.
  2683         16  FILLER                        PIC XXX.
  2684     12  AM-TEL-NO.
  2685         16  AM-AREA-CODE                  PIC 999.
  2686         16  AM-TEL-PRE                    PIC 999.
  2687         16  AM-TEL-NBR                    PIC 9(4).
  2688     12  AM-TEL-LOC                        PIC X.
  2689         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2690         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2691
  2692     12  AM-COMM-STRUCTURE.
  2693         16  AM-DEFN-1.
  2694             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2695                 24  AM-AGT.
  2696                     28  AM-AGT-PREFIX     PIC X(4).
  2697                     28  AM-AGT-PRIME      PIC X(6).
  2698                 24  AM-COM-TYP            PIC X.
  2699                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2700                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2701                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2702                 24  AM-RECALC-LV-INDIC    PIC X.
  2703                 24  AM-RETRO-LV-INDIC     PIC X.
  2704                 24  AM-GL-CODES           PIC X.
  2705                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2706                 24  FILLER                PIC X(01).
  2707         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2708             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2709                 24  FILLER                PIC X(11).
  2710                 24  AM-L-COMA             PIC XXX.
  2711                 24  AM-J-COMA             PIC XXX.
  2712                 24  AM-A-COMA             PIC XXX.
  2713                 24  FILLER                PIC X(6).
  2714
  2715     12  AM-COMM-CHANGE-STATUS             PIC X.
  2716         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2717
  2718     12  AM-CSR-CODE                       PIC X(4).
  2719
  2720     12  AM-BILLING-STATUS                 PIC X.
  2721         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2722         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2723     12  AM-AUTO-REFUND-SW                 PIC X.
  2724         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2725         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2726     12  AM-GPCD                           PIC 99.
  2727     12  AM-IG                             PIC X.
  2728         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2729         88  AM-HAS-GROUP                     VALUE '2'.
  2730     12  AM-STATUS                         PIC X.
  2731         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2732         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2733         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2734         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2735         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2736         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2737         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2738         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2739         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  49
* SOCK03.cbl
  2740         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2741     12  AM-REMIT-TO                       PIC 99.
  2742     12  AM-ID-NO                          PIC X(11).
  2743
  2744     12  AM-CAL-TABLE                      PIC XX.
  2745     12  AM-LF-DEVIATION                   PIC XXX.
  2746     12  AM-AH-DEVIATION                   PIC XXX.
  2747     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2748     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2749     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2750     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2751     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2752     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2753
  2754     12  AM-USER-FIELDS.
  2755         16  AM-FLD-1                      PIC XX.
  2756         16  AM-FLD-2                      PIC XX.
  2757         16  AM-FLD-3                      PIC XX.
  2758         16  AM-FLD-4                      PIC XX.
  2759         16  AM-FLD-5                      PIC XX.
  2760
  2761     12  AM-1ST-PROD-DATE.
  2762         16  AM-1ST-PROD-YR                PIC XX.
  2763         16  AM-1ST-PROD-MO                PIC XX.
  2764         16  AM-1ST-PROD-DA                PIC XX.
  2765     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2766     12  AM-CERTS-PURGED-DATE.
  2767         16  AM-PUR-YR                     PIC XX.
  2768         16  AM-PUR-MO                     PIC XX.
  2769         16  AM-PUR-DA                     PIC XX.
  2770     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2771     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2772     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2773     12  AM-INACTIVE-DATE.
  2774         16  AM-INA-MO                     PIC 99.
  2775         16  AM-INA-DA                     PIC 99.
  2776         16  AM-INA-YR                     PIC 99.
  2777     12  AM-AR-HI-CERT-DATE                PIC XX.
  2778
  2779     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2780     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2781
  2782     12  AM-OB-PAYMENT-MODE                PIC X.
  2783         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2784         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2785         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2786         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2787
  2788     12  AM-AH-ONLY-INDICATOR              PIC X.
  2789         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2790         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2791
  2792     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2793
  2794     12  AM-OVER-SHORT.
  2795         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2796         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2797
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  50
* SOCK03.cbl
  2798     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2799     12  AM-DCC-CLP-STATE                  PIC XX.
  2800
  2801     12  AM-RECALC-COMM                    PIC X.
  2802     12  AM-RECALC-REIN                    PIC X.
  2803
  2804     12  AM-REI-TABLE                      PIC XXX.
  2805     12  AM-REI-ET-LF                      PIC X.
  2806     12  AM-REI-ET-AH                      PIC X.
  2807     12  AM-REI-PE-LF                      PIC X.
  2808     12  AM-REI-PE-AH                      PIC X.
  2809     12  AM-REI-PRT-ST                     PIC X.
  2810     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2811     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2812     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2813     12  AM-REI-GROUP-A                    PIC X(6).
  2814     12  AM-REI-MORT                       PIC X(4).
  2815     12  AM-REI-PRT-OW                     PIC X.
  2816     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2817     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2818     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2819     12  AM-REI-GROUP-B                    PIC X(6).
  2820
  2821     12  AM-TRUST-TYPE                     PIC X(2).
  2822
  2823     12  AM-EMPLOYER-STMT-USED             PIC X.
  2824     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2825
  2826     12  AM-STD-AH-TYPE                    PIC XX.
  2827     12  AM-EARN-METHODS.
  2828         16  AM-EARN-METHOD-R              PIC X.
  2829             88 AM-REF-RL-R78                 VALUE 'R'.
  2830             88 AM-REF-RL-PR                  VALUE 'P'.
  2831             88 AM-REF-RL-MEAN                VALUE 'M'.
  2832             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2833         16  AM-EARN-METHOD-L              PIC X.
  2834             88 AM-REF-LL-R78                 VALUE 'R'.
  2835             88 AM-REF-LL-PR                  VALUE 'P'.
  2836             88 AM-REF-LL-MEAN                VALUE 'M'.
  2837             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2838         16  AM-EARN-METHOD-A              PIC X.
  2839             88 AM-REF-AH-R78                 VALUE 'R'.
  2840             88 AM-REF-AH-PR                  VALUE 'P'.
  2841             88 AM-REF-AH-MEAN                VALUE 'M'.
  2842             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2843             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2844             88 AM-REF-AH-NET                 VALUE 'N'.
  2845
  2846     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2847     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2848     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2849
  2850     12  AM-RET-Y-N                        PIC X.
  2851     12  AM-RET-P-E                        PIC X.
  2852     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2853     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2854     12  AM-RET-GRP                        PIC X(6).
  2855     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  51
* SOCK03.cbl
  2856         16  AM-POOL-PRIME                 PIC XXX.
  2857         16  AM-POOL-SUB                   PIC XXX.
  2858     12  AM-RETRO-EARNINGS.
  2859         16  AM-RET-EARN-R                 PIC X.
  2860         16  AM-RET-EARN-L                 PIC X.
  2861         16  AM-RET-EARN-A                 PIC X.
  2862     12  AM-RET-ST-TAX-USE                 PIC X.
  2863         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2864         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2865     12  AM-RETRO-BEG-EARNINGS.
  2866         16  AM-RET-BEG-EARN-R             PIC X.
  2867         16  AM-RET-BEG-EARN-L             PIC X.
  2868         16  AM-RET-BEG-EARN-A             PIC X.
  2869     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2870     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2871
  2872     12  AM-USER-SELECT-OPTIONS.
  2873         16  AM-USER-SELECT-1              PIC X(10).
  2874         16  AM-USER-SELECT-2              PIC X(10).
  2875         16  AM-USER-SELECT-3              PIC X(10).
  2876         16  AM-USER-SELECT-4              PIC X(10).
  2877         16  AM-USER-SELECT-5              PIC X(10).
  2878
  2879     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2880
  2881     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2882
  2883     12  AM-RPT045A-SWITCH                 PIC X.
  2884         88  RPT045A-OFF                   VALUE 'N'.
  2885
  2886     12  AM-INSURANCE-LIMITS.
  2887         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2888         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2889
  2890     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2891         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2892
  2893     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2894         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2895         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2896
  2897     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2898
  2899     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2900     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2901     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2902     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2903     12  AM-DCC-UEF-STATE                  PIC XX.
  2904     12  FILLER                            PIC XXX.
  2905     12  AM-REPORT-CODE-3                  PIC X(10).
  2906*    12  FILLER                            PIC X(22).
  2907
  2908     12  AM-RESERVE-DATE.
  2909         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2910         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2911         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2912
  2913     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  52
* SOCK03.cbl
  2914     12  AM-NOTIFICATION-TYPES.
  2915         16  AM-NOTIF-OF-LETTERS           PIC X.
  2916         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2917         16  AM-NOTIF-OF-REPORTS           PIC X.
  2918         16  AM-NOTIF-OF-STATUS            PIC X.
  2919
  2920     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2921         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2922         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2923         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2924         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2925
  2926     12  AM-BENEFIT-CONTROLS.
  2927         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2928             20  AM-BENEFIT-CODE           PIC XX.
  2929             20  AM-BENEFIT-TYPE           PIC X.
  2930             20  AM-BENEFIT-REVISION       PIC XXX.
  2931             20  AM-BENEFIT-REM-TERM       PIC X.
  2932             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2933             20  FILLER                    PIC XX.
  2934         16  FILLER                        PIC X(80).
  2935
  2936     12  AM-TRANSFER-DATA.
  2937         16  AM-TRANSFERRED-FROM.
  2938             20  AM-TRNFROM-CARRIER        PIC X.
  2939             20  AM-TRNFROM-GROUPING.
  2940                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2941                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2942             20  AM-TRNFROM-STATE          PIC XX.
  2943             20  AM-TRNFROM-ACCOUNT.
  2944                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2945                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2946             20  AM-TRNFROM-DTE            PIC XX.
  2947         16  AM-TRANSFERRED-TO.
  2948             20  AM-TRNTO-CARRIER          PIC X.
  2949             20  AM-TRNTO-GROUPING.
  2950                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2951                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2952             20  AM-TRNTO-STATE            PIC XX.
  2953             20  AM-TRNTO-ACCOUNT.
  2954                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2955                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2956             20  AM-TRNTO-DTE              PIC XX.
  2957         16  FILLER                        PIC X(10).
  2958
  2959     12  AM-SAVED-REMIT-TO                 PIC 99.
  2960
  2961     12  AM-COMM-STRUCTURE-SAVED.
  2962         16  AM-DEFN-1-SAVED.
  2963             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2964                 24  AM-AGT-SV             PIC X(10).
  2965                 24  AM-COM-TYP-SV         PIC X.
  2966                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2967                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2968                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2969                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2970                 24  FILLER                PIC X.
  2971                 24  AM-GL-CODES-SV        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  53
* SOCK03.cbl
  2972                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2973                 24  FILLER                PIC X.
  2974         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2975             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2976                 24  FILLER                PIC X(11).
  2977                 24  AM-L-COMA-SV          PIC XXX.
  2978                 24  AM-J-COMA-SV          PIC XXX.
  2979                 24  AM-A-COMA-SV          PIC XXX.
  2980                 24  FILLER                PIC X(6).
  2981
  2982     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2983         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2984            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2985            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2986            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2987
  2988     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2989     12  FILLER                            PIC X(120).
  2990
  2991     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2992         16  AM-CONTROL-NAME               PIC X(30).
  2993         16  AM-EXECUTIVE-ONE.
  2994             20  AM-EXEC1-NAME             PIC X(15).
  2995             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2996                                                          COMP-3.
  2997             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2998                                                          COMP-3.
  2999         16  AM-EXECUTIVE-TWO.
  3000             20  AM-EXEC2-NAME             PIC X(15).
  3001             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3002                                                          COMP-3.
  3003             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3004                                                          COMP-3.
  3005
  3006     12  AM-RETRO-ADDITIONAL-DATA.
  3007         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3008         16  AM-RETRO-PREM-P-E             PIC X.
  3009         16  AM-RETRO-CLMS-P-I             PIC X.
  3010         16  AM-RETRO-RET-BRACKET-LF.
  3011             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3012                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3013                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3014             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3015                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3016                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3017             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3018                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3019                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3020         16  AM-RETRO-RET-BRACKET-AH.
  3021             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3022                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3023                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3024                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3025             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3026                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3027                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3028             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3029                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  54
* SOCK03.cbl
  3030                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3031
  3032     12  AM-COMMENTS.
  3033         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3034
  3035     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3036         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3037         16  AM-FLI-BILLING-CODE           PIC X.
  3038         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3039         16  AM-FLI-UNITED-IDENT           PIC X.
  3040         16  AM-FLI-INTEREST-LOST-DATA.
  3041             20  AM-FLI-BANK-NO            PIC X(5).
  3042             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3043             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3044             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3045         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3046             20  AM-FLI-AGT                PIC X(9).
  3047             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3048             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3049         16  FILLER                        PIC X(102).
  3050
  3051     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3052         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3053             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3054             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3055             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3056             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3057             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3058         16  FILLER                          PIC X(10).
  3059******************************************************************
  3060*                                 COPY ELCDATE.
  3061******************************************************************
  3062*                                                                *
  3063*                                                                *
  3064*                            ELCDATE.                            *
  3065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3066*                            VMOD=2.003
  3067*                                                                *
  3068*                                                                *
  3069*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3070*                 LENGTH = 200                                   *
  3071******************************************************************
  3072
  3073 01  DATE-CONVERSION-DATA.
  3074     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3075     12  DC-OPTION-CODE                PIC X.
  3076         88  BIN-TO-GREG                VALUE ' '.
  3077         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3078         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3079         88  YMD-GREG-TO-BIN            VALUE '3'.
  3080         88  MDY-GREG-TO-BIN            VALUE '4'.
  3081         88  JULIAN-TO-BIN              VALUE '5'.
  3082         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3083         88  FIND-CENTURY               VALUE '7'.
  3084         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3085         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3086         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3087         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  55
* SOCK03.cbl
  3088         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3089         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3090         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3091         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3092         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3093         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3094         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3095         88  BIN-3-TO-GREG              VALUE 'I'.
  3096         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3097         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3098         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3099         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3100         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3101         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3102         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3103         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3104         88  THREE-CHARACTER-BIN
  3105                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3106         88  GREGORIAN-TO-BIN
  3107                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3108         88  BIN-TO-GREGORIAN
  3109                  VALUES ' ' '1' 'I' '8' 'G'.
  3110         88  JULIAN-TO-BINARY
  3111                  VALUES '5' 'C' 'E' 'F'.
  3112     12  DC-ERROR-CODE                 PIC X.
  3113         88  NO-CONVERSION-ERROR        VALUE ' '.
  3114         88  DATE-CONVERSION-ERROR
  3115                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3116         88  DATE-IS-ZERO               VALUE '1'.
  3117         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3118         88  DATE-IS-INVALID            VALUE '3'.
  3119         88  DATE1-GREATER-DATE2        VALUE '4'.
  3120         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3121         88  DATE-INVALID-OPTION        VALUE '9'.
  3122         88  INVALID-CENTURY            VALUE 'A'.
  3123         88  ONLY-CENTURY               VALUE 'B'.
  3124         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3125         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3126     12  DC-END-OF-MONTH               PIC X.
  3127         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3128     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3129         88  USE-NORMAL-PROCESS         VALUE ' '.
  3130         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3131         88  ADJUST-UP-100-YRS          VALUE '2'.
  3132     12  FILLER                        PIC X.
  3133     12  DC-CONVERSION-DATES.
  3134         16  DC-BIN-DATE-1             PIC XX.
  3135         16  DC-BIN-DATE-2             PIC XX.
  3136         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3137         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3138                       DC-GREG-DATE-1-EDIT.
  3139             20  DC-EDIT1-MONTH        PIC 99.
  3140             20  SLASH1-1              PIC X.
  3141             20  DC-EDIT1-DAY          PIC 99.
  3142             20  SLASH1-2              PIC X.
  3143             20  DC-EDIT1-YEAR         PIC 99.
  3144         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3145         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  56
* SOCK03.cbl
  3146                     DC-GREG-DATE-2-EDIT.
  3147             20  DC-EDIT2-MONTH        PIC 99.
  3148             20  SLASH2-1              PIC X.
  3149             20  DC-EDIT2-DAY          PIC 99.
  3150             20  SLASH2-2              PIC X.
  3151             20  DC-EDIT2-YEAR         PIC 99.
  3152         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3153         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3154                     DC-GREG-DATE-1-YMD.
  3155             20  DC-YMD-YEAR           PIC 99.
  3156             20  DC-YMD-MONTH          PIC 99.
  3157             20  DC-YMD-DAY            PIC 99.
  3158         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3159         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3160                      DC-GREG-DATE-1-MDY.
  3161             20  DC-MDY-MONTH          PIC 99.
  3162             20  DC-MDY-DAY            PIC 99.
  3163             20  DC-MDY-YEAR           PIC 99.
  3164         16  DC-GREG-DATE-1-ALPHA.
  3165             20  DC-ALPHA-MONTH        PIC X(10).
  3166             20  DC-ALPHA-DAY          PIC 99.
  3167             20  FILLER                PIC XX.
  3168             20  DC-ALPHA-CENTURY.
  3169                 24 DC-ALPHA-CEN-N     PIC 99.
  3170             20  DC-ALPHA-YEAR         PIC 99.
  3171         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3172         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3173         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3174         16  DC-JULIAN-DATE            PIC 9(05).
  3175         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3176                                       PIC 9(05).
  3177         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3178             20  DC-JULIAN-YEAR        PIC 99.
  3179             20  DC-JULIAN-DAYS        PIC 999.
  3180         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3181         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3182         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3183     12  DATE-CONVERSION-VARIBLES.
  3184         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3185         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3186             20  FILLER                PIC 9(3).
  3187             20  HOLD-CEN-1-CCYY.
  3188                 24  HOLD-CEN-1-CC     PIC 99.
  3189                 24  HOLD-CEN-1-YY     PIC 99.
  3190             20  HOLD-CEN-1-MO         PIC 99.
  3191             20  HOLD-CEN-1-DA         PIC 99.
  3192         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3193             20  HOLD-CEN-1-R-MO       PIC 99.
  3194             20  HOLD-CEN-1-R-DA       PIC 99.
  3195             20  HOLD-CEN-1-R-CCYY.
  3196                 24  HOLD-CEN-1-R-CC   PIC 99.
  3197                 24  HOLD-CEN-1-R-YY   PIC 99.
  3198             20  FILLER                PIC 9(3).
  3199         16  HOLD-CENTURY-1-X.
  3200             20  FILLER                PIC X(3)  VALUE SPACES.
  3201             20  HOLD-CEN-1-X-CCYY.
  3202                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3203                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  57
* SOCK03.cbl
  3204             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3205             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3206         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3207             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3208             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3209             20  HOLD-CEN-1-R-X-CCYY.
  3210                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3211                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3212             20  FILLER                PIC XXX.
  3213         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3214         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3215         16  DC-JULIAN-DATE-1          PIC 9(07).
  3216         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3217             20  DC-JULIAN-1-CCYY.
  3218                 24  DC-JULIAN-1-CC    PIC 99.
  3219                 24  DC-JULIAN-1-YR    PIC 99.
  3220             20  DC-JULIAN-DA-1        PIC 999.
  3221         16  DC-JULIAN-DATE-2          PIC 9(07).
  3222         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3223             20  DC-JULIAN-2-CCYY.
  3224                 24  DC-JULIAN-2-CC    PIC 99.
  3225                 24  DC-JULIAN-2-YR    PIC 99.
  3226             20  DC-JULIAN-DA-2        PIC 999.
  3227         16  DC-GREG-DATE-A-EDIT.
  3228             20  DC-EDITA-MONTH        PIC 99.
  3229             20  SLASHA-1              PIC X VALUE '/'.
  3230             20  DC-EDITA-DAY          PIC 99.
  3231             20  SLASHA-2              PIC X VALUE '/'.
  3232             20  DC-EDITA-CCYY.
  3233                 24  DC-EDITA-CENT     PIC 99.
  3234                 24  DC-EDITA-YEAR     PIC 99.
  3235         16  DC-GREG-DATE-B-EDIT.
  3236             20  DC-EDITB-MONTH        PIC 99.
  3237             20  SLASHB-1              PIC X VALUE '/'.
  3238             20  DC-EDITB-DAY          PIC 99.
  3239             20  SLASHB-2              PIC X VALUE '/'.
  3240             20  DC-EDITB-CCYY.
  3241                 24  DC-EDITB-CENT     PIC 99.
  3242                 24  DC-EDITB-YEAR     PIC 99.
  3243         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3244         16  DC-GREG-DATE-CYMD-R REDEFINES
  3245                              DC-GREG-DATE-CYMD.
  3246             20  DC-CYMD-CEN           PIC 99.
  3247             20  DC-CYMD-YEAR          PIC 99.
  3248             20  DC-CYMD-MONTH         PIC 99.
  3249             20  DC-CYMD-DAY           PIC 99.
  3250         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3251         16  DC-GREG-DATE-MDCY-R REDEFINES
  3252                              DC-GREG-DATE-MDCY.
  3253             20  DC-MDCY-MONTH         PIC 99.
  3254             20  DC-MDCY-DAY           PIC 99.
  3255             20  DC-MDCY-CEN           PIC 99.
  3256             20  DC-MDCY-YEAR          PIC 99.
  3257    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3258        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3259    12  DC-EL310-DATE                  PIC X(21).
  3260    12  FILLER                         PIC X(28).
  3261*                                 COPY ELCCALC.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  58
* SOCK03.cbl
  3262******************************************************************
  3263*                                                                *
  3264*                           ELCCALC.                            *
  3265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3266*                            VMOD=2.025                          *
  3267*                                                                *
  3268*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3269*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3270*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3271*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3272*                                                                *
  3273*  PASSED TO ELRTRM                                              *
  3274*  -----------------                                             *
  3275*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3276*  ORIGINAL TERM                                                 *
  3277*  BEGINNING DATE                                                *
  3278*  ENDING DATE                                                   *
  3279*  COMPANY I.D.                                                  *
  3280*  ACCOUNT MASTER USER FIELD                                     *
  3281*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3282*  FREE LOOK DAYS                                                *
  3283*                                                                *
  3284*  RETURNED FROM ELRTRM                                          *
  3285*  ---------------------                                         *
  3286*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3287*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3288*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3289*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3290*----------------------------------------------------------------*
  3291*  PASSED TO ELRAMT                                              *
  3292*  ----------------                                              *
  3293*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3294*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3295*  ORIGINAL AMOUNT                                               *
  3296*  ALTERNATE BENEFIT (BALLON)                                    *
  3297*  A.P.R. - NET PAY ONLY                                         *
  3298*  METHOD
  3299*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3300*  COMPANY I.D.                                                  *
  3301*  BENEFIT TYPE                                                  *
  3302*                                                                *
  3303*  RETURNED FROM ELRAMT                                          *
  3304*  --------------------                                          *
  3305*  REMAINING AMOUNT 1 - CURRENT                                  *
  3306*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3307*  REMAINING AMOUNT FACTOR
  3308*----------------------------------------------------------------*
  3309*  PASSED TO ELRESV                                              *
  3310*  -----------------                                             *
  3311*  CERTIFICATE EFFECTIVE DATE                                    *
  3312*  VALUATION DATE                                                *
  3313*  PAID THRU DATE                                                *
  3314*  BENEFIT                                                       *
  3315*  INCURRED DATE                                                 *
  3316*  REPORTED DATE                                                 *
  3317*  ISSUE AGE                                                     *
  3318*  TERM                                                          *
  3319*  CDT PERCENT                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  59
* SOCK03.cbl
  3320*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3321* *CLAIM TYPE (LIFE, A/H)                                        *
  3322* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3323* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3324*                                                                *
  3325*  RETURNED FROM ELRESV                                          *
  3326*  --------------------                                          *
  3327*  CDT TABLE USED                                                *
  3328*  CDT FACTOR USED                                               *
  3329*  PAY TO CURRENT RESERVE                                        *
  3330*  I.B.N.R. - A/H ONLY                                           *
  3331*  FUTURE (ACCRUED) AH ONLY                                      *
  3332*----------------------------------------------------------------*
  3333*  PASSED TO ELRATE                                              *
  3334*  ----------------                                              *
  3335*  CERT ISSUE DATE                                               *
  3336*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3337*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3338*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3339*  STATE CODE (CLIENT DEFINED)                                   *
  3340*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3341*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3342*  DEVIATION CODE                                                *
  3343*  ISSUE AGE                                                     *
  3344*  ORIGINAL BENEFIT AMOUNT                                       *
  3345*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3346*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3347*  BENEFIT KIND (LIFE OR A/H)                                    *
  3348*  A.P.R.                                                        *
  3349*  METHOD
  3350*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3351*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3352*  COMPANY I.D. (3 CHARACTER)                                    *
  3353*  BENEFIT CODE                                                  *
  3354*  BENEFIT OVERRIDE CODE                                         *
  3355*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3356*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3357*  JOINT INDICATOR (CSL ONLY)                                    *
  3358*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3359*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3360*                                                                *
  3361*  RETURNED FROM ELRATE                                          *
  3362*  --------------------                                          *
  3363*  CALCULATED PREMIUM                                            *
  3364*  PREMIUM RATE                                                  *
  3365*  MORTALITY CODE                                                *
  3366*  MAX ATTAINED AGE                                              *
  3367*  MAX AGE                                                       *
  3368*  MAX TERM                                                      *
  3369*  MAX MONTHLY BENEFIT                                           *
  3370*  MAX TOTAL BENIFIT                                             *
  3371*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3372*----------------------------------------------------------------*
  3373*  PASSED TO ELRFND                                              *
  3374*  ----------------                                              *
  3375*  CERT ISSUE DATE                                               *
  3376*  REFUND DATE                                                   *
  3377*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  60
* SOCK03.cbl
  3378*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3379*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3380*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3381*  STATE CODE (CLIENT DEFINED)                                   *
  3382*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3383*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3384*  DEVIATION CODE                                                *
  3385*  ISSUE AGE                                                     *
  3386*  ORIGINAL BENEFIT AMOUNT                                       *
  3387*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3388*  PROCESS TYPE (CANCEL)                                         *
  3389*  BENEFIT KIND (LIFE OR A/H)                                    *
  3390*  A.P.R.                                                        *
  3391*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3392*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3393*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3394*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3395*  COMPANY I.D. (3 CHARACTER)                                    *
  3396*  BENEFIT CODE                                                  *
  3397*  BENEFIT OVERRIDE CODE                                         *
  3398*                                                                *
  3399*  RETURNED FROM ELRFND                                          *
  3400*  --------------------                                          *
  3401*  CALCULATED REFUND                                             *
  3402*----------------------------------------------------------------*
  3403*  PASSED TO ELEARN                                              *
  3404*  ----------------                                              *
  3405*  CERT ISSUE DATE                                               *
  3406*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3407*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3408*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3409*  STATE CODE (CLIENT DEFINED)                                   *
  3410*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3411*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3412*  DEVIATION CODE                                                *
  3413*  ISSUE AGE                                                     *
  3414*  ORIGINAL BENEFIT AMOUNT                                       *
  3415*  BENEFIT KIND (LIFE OR A/H)                                    *
  3416*  A.P.R.                                                        *
  3417*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3418*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3419*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3420*  COMPANY I.D. (3 CHARACTER)                                    *
  3421*  BENEFIT CODE                                                  *
  3422*  BENEFIT OVERRIDE CODE                                         *
  3423*                                                                *
  3424*  RETURNED FROM ELEARN                                          *
  3425*  --------------------                                          *
  3426*  INDICATED  EARNINGS                                           *
  3427*----------------------------------------------------------------*
  3428*                 LENGTH = 450                                   *
  3429*                                                                *
  3430******************************************************************
  3431******************************************************************
  3432*                   C H A N G E   L O G
  3433*
  3434* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3435*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  61
* SOCK03.cbl
  3436*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3437* EFFECTIVE    NUMBER
  3438*-----------------------------------------------------------------
  3439* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3440* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3441* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3442* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3443* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3444* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3445* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3446* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3447* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3448* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3449* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3450******************************************************************
  3451
  3452 01  CALCULATION-PASS-AREA.
  3453     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3454                                     COMP.
  3455
  3456     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3457       88  NO-CP-ERROR                             VALUE ZERO.
  3458       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3459                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3460       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3461       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3462       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3463       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3464       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3465       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3466       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3467       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3468       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3469       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3470       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3471       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3472       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3473       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3474       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3475       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3476       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3477
  3478     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3479       88  NO-CP-ERROR-2                           VALUE ZERO.
  3480***********************  INPUT AREAS ****************************
  3481
  3482     12  CP-CALCULATION-AREA.
  3483         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3484         16  CP-CERT-EFF-DT        PIC XX.
  3485         16  CP-VALUATION-DT       PIC XX.
  3486         16  CP-PAID-THRU-DT       PIC XX.
  3487         16  CP-BENEFIT-TYPE       PIC X.
  3488           88  CP-AH                               VALUE 'A' 'D'
  3489                                                   'I' 'U'.
  3490           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3491           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3492         16  CP-INCURRED-DT        PIC XX.
  3493         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  62
* SOCK03.cbl
  3494         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3495         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3496         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3497                                     COMP-3.
  3498         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3499                                     COMP-3.
  3500         16  CP-CDT-METHOD         PIC X.
  3501           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3502           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3503           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3504         16  CP-CLAIM-TYPE         PIC X.
  3505           88  CP-AH-CLAIM                         VALUE 'A'.
  3506           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3507         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3508                                     COMP-3.
  3509         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3510                                     COMP-3.
  3511         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3512                                     COMP-3.
  3513         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3514                                     COMP-3.
  3515         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3516                                     COMP-3.
  3517         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3518                                     COMP-3.
  3519         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3520                                     COMP-3.
  3521         16  CP-REM-TERM-METHOD    PIC X.
  3522           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3523           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3524           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3525           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3526           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3527           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3528           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3529         16  CP-EARNING-METHOD     PIC X.
  3530           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3531           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3532           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3533           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3534           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3535           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3536           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3537           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3538           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3539           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3540           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3541           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3542           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3543           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3544         16  CP-PROCESS-TYPE       PIC X.
  3545           88  CP-CLAIM                            VALUE '1'.
  3546           88  CP-CANCEL                           VALUE '2'.
  3547           88  CP-ISSUE                            VALUE '3'.
  3548         16  CP-SPECIAL-CALC-CD    PIC X.
  3549           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3550           88  CP-1-MTH-INTEREST               VALUE ' '.
  3551           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  63
* SOCK03.cbl
  3552           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3553           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3554           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3555           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3556           88  CP-FARM-PLAN                    VALUE 'F'.
  3557           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3558           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3559           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3560           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3561           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3562           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3563           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3564           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3565           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3566           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3567                                                     'W' 'X'.
  3568           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3569           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3570           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3571           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3572           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3573           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3574           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3575           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3576           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3577           88  CP-CSL-METH-1                   VALUE '5'.
  3578           88  CP-CSL-METH-2                   VALUE '6'.
  3579           88  CP-CSL-METH-3                   VALUE '7'.
  3580           88  CP-CSL-METH-4                   VALUE '8'.
  3581
  3582         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3583                                     COMP-3.
  3584         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3585         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3586         16  CP-STATE              PIC XX          VALUE SPACE.
  3587         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3588         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3589           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3590               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3591         16  CP-R78-OPTION         PIC X.
  3592           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3593           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3594
  3595         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3596         16  CP-IBNR-RESERVE-SW    PIC X.
  3597         16  CP-CLAIM-STATUS       PIC X.
  3598         16  CP-RATE-FILE          PIC X.
  3599         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3600                                     COMP-3.
  3601
  3602         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3603         16  CP-AH-OVERRIDE-CODE   PIC X.
  3604
  3605         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3606                                     COMP-3.
  3607         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3608                                   PIC S9(5)V99 COMP-3.
  3609         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  64
* SOCK03.cbl
  3610                                     COMP-3.
  3611         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3612                                     COMP-3.
  3613         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3614                                     COMP-3.
  3615         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3616                                  PIC S9(7)V99 COMP-3.
  3617
  3618         16  CP-PAID-FROM-DATE     PIC X(02).
  3619         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3620         16  CP-EXT-DAYS-CALC      PIC X.
  3621           88  CP-EXT-NO-CHG                   VALUE ' '.
  3622           88  CP-EXT-CHG-LF                   VALUE '1'.
  3623           88  CP-EXT-CHG-AH                   VALUE '2'.
  3624           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3625         16  CP-DOMICILE-STATE     PIC XX.
  3626         16  CP-CARRIER            PIC X.
  3627         16  CP-REIN-FLAG          PIC X.
  3628         16  CP-REM-TRM-CALC-OPTION PIC X.
  3629           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3630                      '2' '3' '4' '5'.
  3631           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3632           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3633           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3634           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3635           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3636           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3637           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3638           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3639         16  CP-SIG-SWITCH         PIC X.
  3640         16  CP-RATING-METHOD      PIC X.
  3641           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3642           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3643           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3644           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3645           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3646           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3647           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3648           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3649           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3650         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3651                                     COMP-3.
  3652         16  CP-BEN-CATEGORY       PIC X.
  3653         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3654         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3655                                   PIC S99V9(5) COMP-3.
  3656         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3657         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3658                                   PIC S99V9(5) COMP-3.
  3659         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3660         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3661         16  CP-EXPIRE-DT          PIC XX.
  3662         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3663         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3664         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3665         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3666         16  CP-DDF-SPEC-CALC      PIC X.
  3667             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  65
* SOCK03.cbl
  3668             88  CP-CALC-CLP              VALUE 'C'.
  3669         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3670         16  CP-CANCEL-REASON      PIC X.
  3671         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3672         16  CP-PMT-MODE           PIC X.
  3673         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3674         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3675         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3676         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3677         16  FILLER                PIC X.
  3678
  3679***************    OUTPUT FROM ELRESV   ************************
  3680
  3681         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3682
  3683         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3684                                     COMP-3.
  3685         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3686                                     COMP-3.
  3687         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3690                                     COMP-3.
  3691         16  FILLER                PIC X(09).
  3692***************    OUTPUT FROM ELRTRM   *************************
  3693
  3694         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3697                                     COMP-3.
  3698         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3701                                     COMP-3.
  3702         16  FILLER                PIC X(12).
  3703
  3704***************    OUTPUT FROM ELRAMT   *************************
  3705
  3706         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3709                                     COMP-3.
  3710         16  FILLER                PIC X(12).
  3711
  3712***************    OUTPUT FROM ELRATE   *************************
  3713
  3714         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-MORTALITY-CODE     PIC X(4).
  3719         16  CP-RATE-EDIT-FLAG     PIC X.
  3720             88  CP-RATES-NEED-APR                  VALUE '1'.
  3721         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3724         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3725         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  66
* SOCK03.cbl
  3726                                   PIC S9(7)V99 COMP-3.
  3727         16  FILLER                PIC X(07).
  3728
  3729***************    OUTPUT FROM ELRFND   *************************
  3730
  3731         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-REFUND-TYPE-USED   PIC X.
  3734           88  CP-R-AS-R78                         VALUE '1'.
  3735           88  CP-R-AS-PRORATA                     VALUE '2'.
  3736           88  CP-R-AS-CALIF                       VALUE '3'.
  3737           88  CP-R-AS-TEXAS                       VALUE '4'.
  3738           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3739           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3740           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3741           88  CP-R-AS-MEAN                        VALUE '8'.
  3742           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3743           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3744           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3745           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3746           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3747           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3748         16  FILLER                PIC X(12).
  3749
  3750***************    OUTPUT FROM ELEARN   *************************
  3751
  3752         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3759                                     COMP-3.
  3760         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-EARNING-TYPE-USED  PIC X.
  3765           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3766           88  CP-E-AS-R78                         VALUE '1'.
  3767           88  CP-E-AS-PRORATA                     VALUE '2'.
  3768           88  CP-E-AS-TEXAS                       VALUE '4'.
  3769           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3770           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3771           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3772           88  CP-E-AS-MEAN                        VALUE '8'.
  3773           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3774         16  FILLER                PIC X(12).
  3775
  3776***************    OUTPUT FROM ELPMNT   *************************
  3777
  3778         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  FILLER                PIC X(12).
  3783
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  67
* SOCK03.cbl
  3784***************   MISC WORK AREAS    *****************************
  3785         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3788                                     COMP-3.
  3789         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3796                                     COMP-3.
  3797         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3798             88  OPEN-RATE-FILE                   VALUE 'O'.
  3799             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3800             88  IO-ERROR                         VALUE 'E'.
  3801
  3802         16  CP-FIRST-PAY-DATE     PIC XX.
  3803
  3804         16  CP-JOINT-INDICATOR    PIC X.
  3805
  3806         16  CP-RESERVE-REMAINING-TERM
  3807                                   PIC S9(4)V9    VALUE ZERO
  3808                                     COMP-3.
  3809
  3810         16  CP-INSURED-BIRTH-DT   PIC XX.
  3811
  3812         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3813                                     COMP-3.
  3814
  3815         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3816                                     COMP-3.
  3817
  3818         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3819                                     COMP-3.
  3820
  3821         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3822                                     COMP-3.
  3823
  3824         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3825                                     COMP-3.
  3826
  3827         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3828                                     COMP-3.
  3829
  3830         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3831                                     COMP-3.
  3832
  3833         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3834             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3835
  3836         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3841         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  68
* SOCK03.cbl
  3842         16  cp-net-only-state     pic x value spaces.
  3843         16  FILLER                PIC X(13).
  3844******************************************************************
  3845****************************************************************
  3846*
  3847* Copyright (c) 2007-2013 Dell Inc.
  3848* All rights reserved.
  3849*
  3850****************************************************************
  3851 01  DFHEIV.
  3852   02  DFHEIV0               PIC X(35).
  3853   02  DFHEIV1               PIC X(08).
  3854   02  DFHEIV2               PIC X(08).
  3855   02  DFHEIV3               PIC X(08).
  3856   02  DFHEIV4               PIC X(06).
  3857   02  DFHEIV5               PIC X(04).
  3858   02  DFHEIV6               PIC X(04).
  3859   02  DFHEIV7               PIC X(02).
  3860   02  DFHEIV8               PIC X(02).
  3861   02  DFHEIV9               PIC X(01).
  3862   02  DFHEIV10              PIC S9(7) COMP-3.
  3863   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3864   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3865   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3866   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3867   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3868   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3869   02  DFHEIV17              PIC X(04).
  3870   02  DFHEIV18              PIC X(04).
  3871   02  DFHEIV19              PIC X(04).
  3872   02  DFHEIV20              USAGE IS POINTER.
  3873   02  DFHEIV21              USAGE IS POINTER.
  3874   02  DFHEIV22              USAGE IS POINTER.
  3875   02  DFHEIV23              USAGE IS POINTER.
  3876   02  DFHEIV24              USAGE IS POINTER.
  3877   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3878   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3879   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3880   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3881   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3882   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3883   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3884   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3885   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3886   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3887   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3888   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3889   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3890   02  FILLER                PIC X(02).
  3891   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3892   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3893   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3894   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3895   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3896   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3897   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3898 LINKAGE  SECTION.
  3899*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  69
* SOCK03.cbl
  3900*                                                               *
  3901* Copyright (c) 2007-2013 Dell Inc.                             *
  3902* All rights reserved.                                          *
  3903*                                                               *
  3904*****************************************************************
  3905 01  dfheiblk.
  3906     02  eibtime          pic s9(7) comp-3.
  3907     02  eibdate          pic s9(7) comp-3.
  3908     02  eibtrnid         pic x(4).
  3909     02  eibtaskn         pic s9(7) comp-3.
  3910     02  eibtrmid         pic x(4).
  3911     02  dfheigdi         pic s9(4) comp.
  3912     02  eibcposn         pic s9(4) comp.
  3913     02  eibcalen         pic s9(4) comp.
  3914     02  eibaid           pic x(1).
  3915     02  eibfiller1       pic x(1).
  3916     02  eibfn            pic x(2).
  3917     02  eibfiller2       pic x(2).
  3918     02  eibrcode         pic x(6).
  3919     02  eibfiller3       pic x(2).
  3920     02  eibds            pic x(8).
  3921     02  eibreqid         pic x(8).
  3922     02  eibrsrce         pic x(8).
  3923     02  eibsync          pic x(1).
  3924     02  eibfree          pic x(1).
  3925     02  eibrecv          pic x(1).
  3926     02  eibsend          pic x(1).
  3927     02  eibatt           pic x(1).
  3928     02  eibeoc           pic x(1).
  3929     02  eibfmh           pic x(1).
  3930     02  eibcompl         pic x(1).
  3931     02  eibsig           pic x(1).
  3932     02  eibconf          pic x(1).
  3933     02  eiberr           pic x(1).
  3934     02  eibrldbk         pic x(1).
  3935     02  eiberrcd         pic x(4).
  3936     02  eibsynrb         pic x(1).
  3937     02  eibnodat         pic x(1).
  3938     02  eibfiller5       pic x(2).
  3939     02  eibresp          pic s9(8) comp.
  3940     02  eibresp2         pic s9(8) comp.
  3941     02  dfheigdj         pic s9(4) comp.
  3942     02  dfheigdk         pic s9(4) comp.
  3943 01  DFHCOMMAREA.
  3944   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3945   05 LSTN-NAME                PIC X(8).
  3946   05 LSTN-SUBNAME             PIC X(8).
  3947   05 CLIENT-IN-DATA.
  3948      15  CLIENT-CAR           PIC X.
  3949      15  CLIENT-GRP           PIC X(6).
  3950      15  CLIENT-STATE         PIC XX.
  3951      15  CLIENT-ACCOUNT       PIC X(10).
  3952*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3953      15  CLIENT-EFF-DT        PIC X(8).
  3954      15  CLIENT-CERT-NO       PIC X(11).
  3955      15  CLIENT-LAST-NAME     PIC X(15).
  3956      15  CLIENT-FIRST-NAME    PIC X(10).
  3957      15  CLIENT-VAL-DT        PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  70
* SOCK03.cbl
  3958      15  CLIENT-CAN-REASON    PIC X.
  3959   05 SOCKADDR-IN-PARM.
  3960     15 SIN-FAMILY             PIC 9(4) COMP.
  3961     15 SIN-PORT               PIC 9(4) COMP.
  3962     15 SIN-ADDRESS            PIC 9(8) COMP.
  3963     15 SIN-ZERO               PIC X(8).
  3964 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3965 0000-DFHEXIT SECTION.
  3966     MOVE '9#                    $   ' TO DFHEIV0.
  3967     MOVE 'SOCK03' TO DFHEIV1.
  3968     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3969     display '  BEGIN SOCK03 '
  3970     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3971     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3972     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3973        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3974        evaluate true
  3975           when client-in-data (8:3) = 'AHL'
  3976              MOVE X'06'         TO WS-COMP-CD
  3977              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  3978                                    WS-COMP-ID
  3979           when CLIENT-IN-DATA (8:3) = 'DCC'
  3980              MOVE X'05'         TO WS-COMP-CD
  3981              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3982                                    WS-COMP-ID
  3983           when CLIENT-IN-DATA (8:3) = 'CAP'
  3984              MOVE X'07'         TO WS-COMP-CD
  3985              MOVE 'CAP'         TO WS-SEND-BUF (5:3)
  3986                                    WS-COMP-ID
  3987           when other
  3988              MOVE X'04'         TO WS-COMP-CD
  3989              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3990                                    WS-COMP-ID
  3991        end-evaluate
  3992        move 'CSO'               to ws-send-buf (1:3)
  3993        move +25                 to ws-send-msg-size
  3994     END-IF
  3995     display 'SOCK03:sequence number  =', ws-seq-num.
  3996     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3997     call "send" using by value GIVE-TAKE-SOCKET,
  3998         by reference ws-send-buf,
  3999         by value ws-send-msg-size,
  4000         by value ws-flags.
  4001     if return-code <= zero
  4002         display 'SOCK03:send error ',
  4003         go to socket-error.
  4004     move low-values to ws-recv-buf.
  4005     set ws-recv-total to zero.
  4006     compute ws-recv-left = ws-recv-msg-size.
  4007     display 'SOCK03:About to recv '
  4008     call "recv" using by value GIVE-TAKE-SOCKET,
  4009         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4010         by value ws-recv-left,
  4011         by value ws-flags.
  4012     if return-code < zero
  4013        display 'SOCK03:recv error ',
  4014        go to socket-error.
  4015     if return-code = zero
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  71
* SOCK03.cbl
  4016        display 'SOCK03:client disconnected',
  4017        go to socket-error.
  4018*
  4019     display 'SOCK03:Good recv  '
  4020     display 'SOCK03:return code      = ', return-code
  4021     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  4022     move +4096                  to ws-send-msg-size
  4023*    move +750                   to ws-send-msg-size
  4024     move ws-recv-buf (1:72)     to client-in-data
  4025     MOVE SPACES                 TO WS-ELCERT-SW
  4026     MOVE X'0A'                  TO WS-HEX-0A
  4027     if client-account = 'EPIQ000001'
  4028        set ws-epiq-request to true
  4029        move spaces              to client-account
  4030     end-if
  4031     move +0 to ws-epiq-max
  4032     EVALUATE TRUE
  4033        WHEN (CLIENT-CAR NOT = SPACES)
  4034           AND (CLIENT-STATE NOT = SPACES)
  4035           AND (CLIENT-ACCOUNT NOT = SPACES)
  4036           AND (CLIENT-EFF-DT NOT = SPACES)
  4037           AND (CLIENT-CERT-NO NOT = SPACES)
  4038           SET WS-ELCERT-FULL    TO TRUE
  4039           DISPLAY ' SETTING FULL '
  4040        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4041           SET WS-ELCERT-CERT-NO TO TRUE
  4042           DISPLAY ' SETTING CERT NO '
  4043*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4044*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4045        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4046           AND (CLIENT-LAST-NAME NOT = SPACES)
  4047           SET WS-ELCERT-ACT-NAME TO TRUE
  4048        WHEN CLIENT-LAST-NAME NOT = SPACES
  4049           SET WS-ELCERT-NAME    TO TRUE
  4050           DISPLAY ' SETTING NAME '
  4051        WHEN OTHER
  4052           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4053           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4054           MOVE ZEROS            TO WS-RESP
  4055           PERFORM 0030-BUILD-BUFFER
  4056                                 THRU 0030-EXIT
  4057           PERFORM 0020-SEND-BUFFER
  4058                                 THRU 0020-EXIT
  4059           PERFORM 0025-CLOSE-SOCKET
  4060                                 THRU 0025-EXIT
  4061           GO TO 0010-RETURN
  4062     END-EVALUATE
  4063     IF CLIENT-CAN-REASON = 'R'
  4064        MOVE 'R'                 TO WS-CANCEL-REASON
  4065     ELSE
  4066        MOVE ' '                 TO WS-CANCEL-REASON
  4067     END-IF
  4068     IF WS-ELCERT-KEY-SW NOT = SPACES
  4069        PERFORM 0050-BEGIN-REFUND-PROCESS
  4070                                 THRU 0050-EXIT
  4071     END-IF
  4072     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4073     .
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  72
* SOCK03.cbl
  4074 0010-RETURN.
  4075
  4076* exec cics return end-exec.
  4077*    MOVE '.(                    ''   #00004071' TO DFHEIV0
  4078     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4079     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4080     MOVE X'2020233030303034303731' TO DFHEIV0(25:11)
  4081     CALL 'kxdfhei1' USING DFHEIV0,
  4082           DFHEIV99,
  4083           DFHEIV99,
  4084           DFHEIV99,
  4085           DFHEIV99,
  4086           DFHEIV99,
  4087           DFHEIV99
  4088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4089
  4090
  4091* goback.
  4092     MOVE '9%                    "   ' TO DFHEIV0
  4093     MOVE 'SOCK03' TO DFHEIV1
  4094     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4095     goback.
  4096*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4097     .
  4098 0020-SEND-BUFFER.
  4099     display 'SOCK03:About to send      '
  4100     display 'SOCK03:sequence number  =', ws-seq-num.
  4101     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4102     call "send" using by value GIVE-TAKE-SOCKET,
  4103         by reference ws-send-buf,
  4104         by value ws-send-msg-size,
  4105         by value ws-flags.
  4106     if return-code <= zero
  4107         display 'SOCK03:send error ' return-code,
  4108         go to socket-error.
  4109 0020-EXIT.
  4110     EXIT.
  4111 0025-CLOSE-SOCKET.
  4112*    display 'SOCK03:closing socket'.
  4113*    call "close" using by value GIVE-TAKE-SOCKET .
  4114     display 'SOCK03:done'.
  4115     .
  4116 0025-EXIT.
  4117     EXIT.
  4118*
  4119* set up the receive buffer
  4120*
  4121     move low-values to ws-recv-buf.
  4122     set ws-recv-total to zero.
  4123     compute ws-recv-left = ws-recv-msg-size.
  4124*
  4125* receive data
  4126*
  4127 recv-1.
  4128     call "recv" using by value GIVE-TAKE-SOCKET,
  4129         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4130         by value ws-recv-left,
  4131         by value ws-flags.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  73
* SOCK03.cbl
  4132*
  4133* test what was received and decide what we should do
  4134*
  4135     if return-code < zero
  4136        display 'SOCK03:recv error ',
  4137        go to socket-error.
  4138     if return-code = zero
  4139        display 'SOCK03:client disconnected',
  4140        go to socket-error.
  4141*
  4142* have we received all the data yet?
  4143*
  4144     compute ws-recv-total = ws-recv-total + return-code.
  4145     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4146*
  4147* not yet
  4148*
  4149     if ws-recv-left > 0 go to recv-1.
  4150*
  4151* received all the data
  4152*
  4153     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4154*
  4155* make sure what we received was what we sent
  4156*
  4157*    if ws-recv-buf <> ws-send-buf
  4158*        display "SOCK03:data doesn't match",
  4159*        go to socket-error.
  4160*
  4161* end of pass
  4162*
  4163*loop-end.
  4164*    if ws-seq-num = 5 go to socket-error.
  4165*    go to loop-1.
  4166*
  4167* program end
  4168*
  4169 socket-error.
  4170     if ws-seq-num <> 0
  4171         display "SOCK03:did not complete".
  4172*
  4173* flush the send buffer and deallocate
  4174*
  4175*    display 'SOCK03:closing socket'.
  4176*    call "close" using by value GIVE-TAKE-SOCKET .
  4177*
  4178* finised return to cics
  4179*
  4180 socket-fin.
  4181*    display 'SOCK03:closing socket'.
  4182*    call "close" using by value GIVE-TAKE-SOCKET .
  4183     display 'SOCK03:done'.
  4184
  4185* exec cics return end-exec.
  4186*    MOVE '.(                    ''   #00004161' TO DFHEIV0
  4187     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4188     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4189     MOVE X'2020233030303034313631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  74
* SOCK03.cbl
  4190     CALL 'kxdfhei1' USING DFHEIV0,
  4191           DFHEIV99,
  4192           DFHEIV99,
  4193           DFHEIV99,
  4194           DFHEIV99,
  4195           DFHEIV99,
  4196           DFHEIV99
  4197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4198
  4199
  4200* goback.
  4201     MOVE '9%                    "   ' TO DFHEIV0
  4202     MOVE 'SOCK03' TO DFHEIV1
  4203     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4204     goback.
  4205 0030-BUILD-BUFFER.
  4206     MOVE SPACES                 TO WS-SEND-BUF
  4207     IF WS-CALL-TYPE = 'NEWBUS'
  4208        STRING
  4209           WS-COMMENT            ';'
  4210           WS-RESP               ';'
  4211           WS-CARRIER            ';'
  4212           WS-GROUPING           ';'
  4213           WS-STATE              ';'
  4214           WS-ACCOUNT            ';'
  4215           WS-CERT-EFF-DATE      ';'
  4216           WS-CERT-NO            ';'
  4217           WS-LAST-NAME          ';'
  4218           WS-FIRST-NAME         ';'
  4219           WS-MID-INIT           ';'
  4220           WS-LAST-JNAME         ';'
  4221           WS-FIRST-JNAME        ';'
  4222           WS-MID-JINIT          ';'
  4223           WS-POST-CARD-SW       ';'
  4224           ws-lf-coverage-type   ';'
  4225           WS-LF-STATUS          ';'
  4226           WS-LF-BEN-CODE        ';'
  4227           WS-LF-BEN-CODE-DESC   ';'
  4228           WS-LF-TERM            ';'
  4229           WS-LF-REM-TERM        ';'
  4230           WS-LF-PREM            ';'
  4231           WS-LF-REFUND          ';'
  4232           WS-LF-METHOD          ';'
  4233           WS-LF-ORIG-BENEFIT    ';'
  4234           WS-LF-REM-BEN         ';'
  4235           WS-LF-EXPIRE-DATE     ';'
  4236           WS-LF-COMM            ';'
  4237           WS-LF-UEC             ';'
  4238           WS-AH-COVERAGE-TYPE   ';'
  4239           WS-AH-STATUS          ';'
  4240           WS-AH-BEN-CODE        ';'
  4241           WS-AH-BEN-CODE-DESC   ';'
  4242           WS-AH-TERM            ';'
  4243           WS-AH-REM-TERM        ';'
  4244           WS-AH-PREM            ';'
  4245           WS-AH-REFUND          ';'
  4246           WS-AH-METHOD          ';'
  4247           WS-AH-ORIG-BENEFIT    ';'
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  75
* SOCK03.cbl
  4248           WS-AH-REM-BEN         ';'
  4249           WS-AH-EXPIRE-DATE     ';'
  4250           WS-AH-COMM            ';'
  4251           WS-AH-UEC             ';'
  4252           WS-ACCOUNT-NAME       ';'
  4253           WS-REPORT-CODE-1      ';'
  4254           WS-REPORT-CODE-2      ';'
  4255           WS-REPORT-CODE-3      ';'
  4256           WS-CLM-PAID-THRU-DT   ';'
  4257           WS-HEX-0A
  4258            DELIMITED BY '  ' INTO WS-SEND-BUF
  4259        END-STRING
  4260     ELSE
  4261        STRING
  4262           WS-COMMENT            ';'
  4263           WS-RESP               ';'
  4264           WS-CARRIER            ';'
  4265           WS-GROUPING           ';'
  4266           WS-STATE              ';'
  4267           WS-ACCOUNT            ';'
  4268           WS-CERT-EFF-DATE      ';'
  4269           WS-CERT-NO            ';'
  4270           WS-LAST-NAME          ';'
  4271           WS-FIRST-NAME         ';'
  4272           WS-MID-INIT           ';'
  4273           WS-LAST-JNAME         ';'
  4274           WS-FIRST-JNAME        ';'
  4275           WS-MID-JINIT          ';'
  4276           WS-POST-CARD-SW       ';'
  4277           WS-LF-STATUS          ';'
  4278           WS-LF-BEN-CODE        ';'
  4279           WS-LF-BEN-CODE-DESC   ';'
  4280           WS-LF-TERM            ';'
  4281           WS-LF-REM-TERM        ';'
  4282           WS-LF-PREM            ';'
  4283           WS-LF-REFUND          ';'
  4284           WS-LF-METHOD          ';'
  4285           WS-LF-ORIG-BENEFIT    ';'
  4286           WS-LF-REM-BEN         ';'
  4287           WS-LF-EXPIRE-DATE     ';'
  4288           WS-LF-COMM            ';'
  4289           WS-LF-UEC             ';'
  4290           WS-AH-STATUS          ';'
  4291           WS-AH-BEN-CODE        ';'
  4292           WS-AH-BEN-CODE-DESC   ';'
  4293           WS-AH-TERM            ';'
  4294           WS-AH-REM-TERM        ';'
  4295           WS-AH-PREM            ';'
  4296           WS-AH-REFUND          ';'
  4297           WS-AH-METHOD          ';'
  4298           WS-AH-ORIG-BENEFIT    ';'
  4299           WS-AH-REM-BEN         ';'
  4300           WS-AH-EXPIRE-DATE     ';'
  4301           WS-AH-COMM            ';'
  4302           WS-AH-UEC             ';'
  4303           WS-ACCOUNT-NAME       ';'
  4304           WS-REPORT-CODE-1      ';'
  4305           WS-REPORT-CODE-2      ';'
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  76
* SOCK03.cbl
  4306           WS-REPORT-CODE-3      ';'
  4307           WS-CLM-PAID-THRU-DT   ';'
  4308           'E'                   ';'
  4309            DELIMITED BY '  ' INTO WS-SEND-BUF
  4310        END-STRING
  4311     END-IF
  4312     .
  4313 0030-EXIT.
  4314     EXIT.
  4315 0050-BEGIN-REFUND-PROCESS.
  4316     IF WS-ELCERT-ACT-NAME
  4317        PERFORM 0060-FIND-FULL-KEY
  4318                                 THRU 0060-EXIT
  4319        MOVE AM-CARRIER          TO CLIENT-CAR
  4320        MOVE AM-GROUPING         TO CLIENT-GRP
  4321        MOVE AM-STATE            TO CLIENT-STATE
  4322     END-IF
  4323     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4324     IF NOT RESP-NORMAL
  4325        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4326        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4327        MOVE WS-RESPONSE         TO WS-RESP
  4328        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4329        PERFORM 0020-SEND-BUFFER
  4330                                 THRU 0020-EXIT
  4331        PERFORM 0025-CLOSE-SOCKET
  4332                                 THRU 0025-EXIT
  4333        GO TO 0010-RETURN
  4334     END-IF
  4335     PERFORM 0150-READ-NEXT-ELCERT
  4336                                 THRU 0150-EXIT
  4337*    display ' came back from 0150 ' ws-response
  4338     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4339        DISPLAY ' CERT NOT FOUND '
  4340        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4341        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4342        MOVE WS-RESPONSE         TO WS-RESP
  4343        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4344        PERFORM 0020-SEND-BUFFER
  4345                                 THRU 0020-EXIT
  4346        PERFORM 0025-CLOSE-SOCKET
  4347                                 THRU 0025-EXIT
  4348        GO TO 0010-RETURN
  4349     END-IF
  4350     PERFORM 0200-BEGIN-REFUND-PROCESS
  4351                                 THRU 0200-EXIT UNTIL
  4352        ELCERT-FINISHED
  4353     .
  4354 0050-EXIT.
  4355     EXIT.
  4356 0060-FIND-FULL-KEY.
  4357     MOVE ' ' TO WS-STOP-SW
  4358     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4359     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4360
  4361* EXEC CICS STARTBR
  4362*       DATASET  ('ERACCT3')
  4363*       RIDFLD   (WS-AM3-KEY)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  77
* SOCK03.cbl
  4364*       GTEQ
  4365*       RESP (WS-RESPONSE)
  4366*    END-EXEC
  4367     MOVE 'ERACCT3' TO DFHEIV1
  4368     MOVE 0
  4369       TO DFHEIV11
  4370*    MOVE '&,         G          &  N#00004318' TO DFHEIV0
  4371     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4373     MOVE X'204E233030303034333138' TO DFHEIV0(25:11)
  4374     CALL 'kxdfhei1' USING DFHEIV0,
  4375           DFHEIV1,
  4376           WS-AM3-KEY,
  4377           DFHEIV99,
  4378           DFHEIV11,
  4379           DFHEIV99
  4380     MOVE EIBRESP  TO WS-RESPONSE
  4381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4382     IF RESP-NORMAL
  4383        PERFORM UNTIL TOLD-TO-STOP
  4384
  4385* EXEC CICS READNEXT
  4386*             DATASET  ('ERACCT3')
  4387*             INTO     (ACCOUNT-MASTER)
  4388*             RIDFLD   (WS-AM3-KEY)
  4389*          END-EXEC
  4390     MOVE LENGTH OF
  4391      ACCOUNT-MASTER
  4392       TO DFHEIV12
  4393     MOVE 'ERACCT3' TO DFHEIV1
  4394     MOVE 0
  4395       TO DFHEIV11
  4396*    MOVE '&.IL                  )   #00004326' TO DFHEIV0
  4397     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4398     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4399     MOVE X'2020233030303034333236' TO DFHEIV0(25:11)
  4400     CALL 'kxdfhei1' USING DFHEIV0,
  4401           DFHEIV1,
  4402           ACCOUNT-MASTER,
  4403           DFHEIV12,
  4404           WS-AM3-KEY,
  4405           DFHEIV99,
  4406           DFHEIV11,
  4407           DFHEIV99,
  4408           DFHEIV99
  4409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4410           EVALUATE TRUE
  4411              WHEN (RESP-NORMAL)
  4412                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4413                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4414                 SET TOLD-TO-STOP TO TRUE
  4415              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4416                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4417                 CONTINUE
  4418              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4419                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4420                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4421                 MOVE ZEROS      TO WS-RESP
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  78
* SOCK03.cbl
  4422                 PERFORM 0030-BUILD-BUFFER
  4423                                 THRU 0030-EXIT
  4424                 PERFORM 0020-SEND-BUFFER
  4425                                 THRU 0020-EXIT
  4426                 PERFORM 0025-CLOSE-SOCKET
  4427                                 THRU 0025-EXIT
  4428                 GO TO 0010-RETURN
  4429           END-EVALUATE
  4430        END-PERFORM
  4431
  4432* EXEC CICS ENDBR
  4433*          DATASET   ('ERACCT3')
  4434*       END-EXEC
  4435     MOVE 'ERACCT3' TO DFHEIV1
  4436     MOVE 0
  4437       TO DFHEIV11
  4438*    MOVE '&2                    $   #00004352' TO DFHEIV0
  4439     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4440     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4441     MOVE X'2020233030303034333532' TO DFHEIV0(25:11)
  4442     CALL 'kxdfhei1' USING DFHEIV0,
  4443           DFHEIV1,
  4444           DFHEIV11,
  4445           DFHEIV99
  4446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4447     ELSE
  4448        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4449        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4450        MOVE ZEROS      TO WS-RESP
  4451        PERFORM 0030-BUILD-BUFFER
  4452                                 THRU 0030-EXIT
  4453        PERFORM 0020-SEND-BUFFER
  4454                                 THRU 0020-EXIT
  4455        PERFORM 0025-CLOSE-SOCKET
  4456                                 THRU 0025-EXIT
  4457        GO TO 0010-RETURN
  4458     END-IF
  4459     .
  4460 0060-EXIT.
  4461     EXIT.
  4462 0100-START-ELCERT.
  4463     MOVE SPACES                 TO WS-SEND-BUF
  4464     INITIALIZE WS-STRING-DATA
  4465     MOVE LOW-VALUES             TO WS-CM-KEY
  4466                                    WS-CM-KEY-A1
  4467                                    WS-CM-KEY-A4
  4468     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4469                                    WS-CM-COMPANY-CD-A1
  4470                                    WS-CM-COMPANY-CD-A4
  4471     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4472     MOVE 'L'                    TO DC-OPTION-CODE
  4473     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4474     IF NO-CONVERSION-ERROR
  4475        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4476     ELSE
  4477        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4478        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4479        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  79
* SOCK03.cbl
  4480        PERFORM 0020-SEND-BUFFER
  4481                                 THRU 0020-EXIT
  4482        PERFORM 0025-CLOSE-SOCKET
  4483                                 THRU 0025-EXIT
  4484        GO TO 0010-RETURN
  4485     END-IF
  4486     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4487        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4488        MOVE 'L'                 TO DC-OPTION-CODE
  4489        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4490        IF NO-CONVERSION-ERROR
  4491           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4492        ELSE
  4493           MOVE 'BAD EFF DT CONVERT '
  4494                                 TO WS-COMMENT
  4495           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4496           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4497           PERFORM 0020-SEND-BUFFER
  4498                                 THRU 0020-EXIT
  4499           PERFORM 0025-CLOSE-SOCKET
  4500                                 THRU 0025-EXIT
  4501           GO TO 0010-RETURN
  4502        END-IF
  4503     END-IF
  4504     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4505        (F1 > +10)
  4506        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4507     END-PERFORM
  4508     IF F1 > +1
  4509        SUBTRACT +1 FROM F1
  4510     END-IF
  4511     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4512        (L1 > +15)
  4513        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4514     END-PERFORM
  4515     IF L1 > +1
  4516        SUBTRACT +1 FROM L1
  4517     END-IF
  4518     EVALUATE TRUE
  4519        WHEN WS-ELCERT-FULL
  4520           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4521           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4522           MOVE CLIENT-STATE        TO WS-CM-STATE
  4523           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4524           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4525           MOVE CLIENT-CERT-NO (1:10)
  4526                                    TO WS-CM-CERT-NO
  4527
  4528* EXEC CICS READ
  4529*             INTO    (CERTIFICATE-MASTER)
  4530*             DATASET ('ELCERT')
  4531*             RIDFLD  (WS-CM-KEY)
  4532*             RESP    (WS-RESPONSE)
  4533*          END-EXEC
  4534     MOVE LENGTH OF
  4535      CERTIFICATE-MASTER
  4536       TO DFHEIV11
  4537     MOVE 'ELCERT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  80
* SOCK03.cbl
  4538*    MOVE '&"IL       E          (  N#00004436' TO DFHEIV0
  4539     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4541     MOVE X'204E233030303034343336' TO DFHEIV0(25:11)
  4542     CALL 'kxdfhei1' USING DFHEIV0,
  4543           DFHEIV1,
  4544           CERTIFICATE-MASTER,
  4545           DFHEIV11,
  4546           WS-CM-KEY,
  4547           DFHEIV99,
  4548           DFHEIV99,
  4549           DFHEIV99
  4550     MOVE EIBRESP  TO WS-RESPONSE
  4551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4552        WHEN WS-ELCERT-ACT-NAME
  4553           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4554           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4555           MOVE CLIENT-STATE        TO WS-CM-STATE
  4556           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4557           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4558           MOVE ZEROS               TO WS-CM-CERT-NO
  4559
  4560* EXEC CICS STARTBR
  4561*             DATASET ('ELCERT')
  4562*             RIDFLD  (WS-CM-KEY)
  4563*             RESP    (WS-RESPONSE)
  4564*          END-EXEC
  4565     MOVE 'ELCERT' TO DFHEIV1
  4566     MOVE 0
  4567       TO DFHEIV11
  4568*    MOVE '&,         G          &  N#00004449' TO DFHEIV0
  4569     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4570     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4571     MOVE X'204E233030303034343439' TO DFHEIV0(25:11)
  4572     CALL 'kxdfhei1' USING DFHEIV0,
  4573           DFHEIV1,
  4574           WS-CM-KEY,
  4575           DFHEIV99,
  4576           DFHEIV11,
  4577           DFHEIV99
  4578     MOVE EIBRESP  TO WS-RESPONSE
  4579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4580        WHEN WS-ELCERT-NAME
  4581           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4582           MOVE SPACES           TO WS-CM-INITIALS
  4583           COMPUTE WS-LENGTH = L1 + +1
  4584
  4585* EXEC CICS STARTBR
  4586*             DATASET   ('ELCERT2')
  4587*             RIDFLD    (WS-CM-KEY-A1)
  4588*             GENERIC
  4589*             KEYLENGTH (WS-LENGTH)
  4590*             GTEQ
  4591*             RESP      (WS-RESPONSE)
  4592*          END-EXEC
  4593     MOVE 'ELCERT2' TO DFHEIV1
  4594     MOVE 0
  4595       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  81
* SOCK03.cbl
  4596*    MOVE '&,   KG    G          &  N#00004458' TO DFHEIV0
  4597     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4598     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4599     MOVE X'204E233030303034343538' TO DFHEIV0(25:11)
  4600     CALL 'kxdfhei1' USING DFHEIV0,
  4601           DFHEIV1,
  4602           WS-CM-KEY-A1,
  4603           WS-LENGTH,
  4604           DFHEIV11,
  4605           DFHEIV99
  4606     MOVE EIBRESP  TO WS-RESPONSE
  4607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4608*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4609*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4610        WHEN WS-ELCERT-CERT-NO
  4611* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4612           MOVE +11 TO WS-LENGTH
  4613           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4614
  4615* EXEC CICS STARTBR
  4616*             DATASET   ('ELCERT5')
  4617*             RIDFLD    (WS-CM-KEY-A4)
  4618*             GENERIC
  4619*             KEYLENGTH (WS-LENGTH)
  4620*             GTEQ
  4621*             RESP      (WS-RESPONSE)
  4622*          END-EXEC
  4623     MOVE 'ELCERT5' TO DFHEIV1
  4624     MOVE 0
  4625       TO DFHEIV11
  4626*    MOVE '&,   KG    G          &  N#00004472' TO DFHEIV0
  4627     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4628     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4629     MOVE X'204E233030303034343732' TO DFHEIV0(25:11)
  4630     CALL 'kxdfhei1' USING DFHEIV0,
  4631           DFHEIV1,
  4632           WS-CM-KEY-A4,
  4633           WS-LENGTH,
  4634           DFHEIV11,
  4635           DFHEIV99
  4636     MOVE EIBRESP  TO WS-RESPONSE
  4637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4638     END-EVALUATE
  4639     .
  4640 0100-EXIT.
  4641     EXIT.
  4642 0150-READ-NEXT-ELCERT.
  4643     EVALUATE TRUE
  4644        WHEN WS-ELCERT-ACT-NAME
  4645*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4646
  4647* EXEC CICS READNEXT
  4648*             DATASET   ('ELCERT')
  4649*             RIDFLD    (WS-CM-KEY)
  4650*             INTO      (CERTIFICATE-MASTER)
  4651*             RESP      (WS-RESPONSE)
  4652*          END-EXEC
  4653     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  82
* SOCK03.cbl
  4654      CERTIFICATE-MASTER
  4655       TO DFHEIV12
  4656     MOVE 'ELCERT' TO DFHEIV1
  4657     MOVE 0
  4658       TO DFHEIV11
  4659*    MOVE '&.IL                  )  N#00004489' TO DFHEIV0
  4660     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4661     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4662     MOVE X'204E233030303034343839' TO DFHEIV0(25:11)
  4663     CALL 'kxdfhei1' USING DFHEIV0,
  4664           DFHEIV1,
  4665           CERTIFICATE-MASTER,
  4666           DFHEIV12,
  4667           WS-CM-KEY,
  4668           DFHEIV99,
  4669           DFHEIV11,
  4670           DFHEIV99,
  4671           DFHEIV99
  4672     MOVE EIBRESP  TO WS-RESPONSE
  4673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4674        WHEN WS-ELCERT-NAME
  4675*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4676
  4677* EXEC CICS READNEXT
  4678*             DATASET   ('ELCERT2')
  4679*             RIDFLD    (WS-CM-KEY-A1)
  4680*             INTO      (CERTIFICATE-MASTER)
  4681*             RESP      (WS-RESPONSE)
  4682*          END-EXEC
  4683     MOVE LENGTH OF
  4684      CERTIFICATE-MASTER
  4685       TO DFHEIV12
  4686     MOVE 'ELCERT2' TO DFHEIV1
  4687     MOVE 0
  4688       TO DFHEIV11
  4689*    MOVE '&.IL                  )  N#00004497' TO DFHEIV0
  4690     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4691     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4692     MOVE X'204E233030303034343937' TO DFHEIV0(25:11)
  4693     CALL 'kxdfhei1' USING DFHEIV0,
  4694           DFHEIV1,
  4695           CERTIFICATE-MASTER,
  4696           DFHEIV12,
  4697           WS-CM-KEY-A1,
  4698           DFHEIV99,
  4699           DFHEIV11,
  4700           DFHEIV99,
  4701           DFHEIV99
  4702     MOVE EIBRESP  TO WS-RESPONSE
  4703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4704        WHEN WS-ELCERT-CERT-NO
  4705
  4706* EXEC CICS READNEXT
  4707*             DATASET   ('ELCERT5')
  4708*             RIDFLD    (WS-CM-KEY-A4)
  4709*             INTO      (CERTIFICATE-MASTER)
  4710*             RESP      (WS-RESPONSE)
  4711*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  83
* SOCK03.cbl
  4712     MOVE LENGTH OF
  4713      CERTIFICATE-MASTER
  4714       TO DFHEIV12
  4715     MOVE 'ELCERT5' TO DFHEIV1
  4716     MOVE 0
  4717       TO DFHEIV11
  4718*    MOVE '&.IL                  )  N#00004504' TO DFHEIV0
  4719     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4720     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4721     MOVE X'204E233030303034353034' TO DFHEIV0(25:11)
  4722     CALL 'kxdfhei1' USING DFHEIV0,
  4723           DFHEIV1,
  4724           CERTIFICATE-MASTER,
  4725           DFHEIV12,
  4726           WS-CM-KEY-A4,
  4727           DFHEIV99,
  4728           DFHEIV11,
  4729           DFHEIV99,
  4730           DFHEIV99
  4731     MOVE EIBRESP  TO WS-RESPONSE
  4732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4733     END-EVALUATE
  4734     .
  4735 0150-EXIT.
  4736     EXIT.
  4737 0200-BEGIN-REFUND-PROCESS.
  4738     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4739                                    WS-ERACCT-SW
  4740     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4741                                    WS-NCB-DIFF-ODD-DAYS
  4742     INITIALIZE WS-STRING-DATA
  4743     IF RESP-NORMAL OR RESP-DUPKEY
  4744        EVALUATE TRUE
  4745           WHEN WS-ELCERT-ACT-NAME
  4746              EVALUATE TRUE
  4747                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4748                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4749                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4750                    OR (CM-STATE NOT = CLIENT-STATE)
  4751                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4752                    SET ELCERT-FINISHED TO TRUE
  4753                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4754                    CLIENT-LAST-NAME (1:L1))
  4755                    GO TO 0200-CONTINUE
  4756                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4757                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4758                    GO TO 0200-CONTINUE
  4759                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4760                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4761                     CLIENT-FIRST-NAME (1:F1)))
  4762                    GO TO 0200-CONTINUE
  4763                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4764                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4765                    GO TO 0200-CONTINUE
  4766              END-EVALUATE
  4767           WHEN WS-ELCERT-CERT-NO
  4768              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4769                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  84
* SOCK03.cbl
  4770                 SET ELCERT-FINISHED TO TRUE
  4771              ELSE
  4772                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4773                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4774                              OR
  4775                    ((CLIENT-LAST-NAME NOT = SPACES)
  4776                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4777                        CLIENT-LAST-NAME (1:L1)))
  4778                              OR
  4779                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4780                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4781                        CLIENT-FIRST-NAME (1:F1)))
  4782                              OR
  4783                    ((CLIENT-ACCOUNT NOT = SPACES)
  4784                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4785                     GO TO 0200-CONTINUE
  4786                 END-IF
  4787              END-IF
  4788           WHEN WS-ELCERT-NAME
  4789              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4790                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4791                    CLIENT-LAST-NAME (1:L1))
  4792                  SET ELCERT-FINISHED TO TRUE
  4793              ELSE
  4794                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4795                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4796                           OR
  4797                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4798                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4799                     CLIENT-FIRST-NAME (1:F1)))
  4800                           OR
  4801                 ((CLIENT-ACCOUNT NOT = SPACES)
  4802                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4803                  GO TO 0200-CONTINUE
  4804                 END-IF
  4805              END-IF
  4806           WHEN OTHER
  4807              SET ELCERT-FINISHED   TO TRUE
  4808        END-EVALUATE
  4809     ELSE
  4810        SET ELCERT-FINISHED TO TRUE
  4811     END-IF
  4812*       IF WS-ELCERT-CERT-NO
  4813*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4814*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4815*                          OR
  4816*                ((CLIENT-EFF-DT NOT = SPACES)
  4817*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4818*                          OR
  4819*                ((CLIENT-LAST-NAME NOT = SPACES)
  4820*                 AND (CM-INSURED-LAST-NAME NOT =
  4821*                    CLIENT-LAST-NAME))
  4822*                 SET ELCERT-FINISHED TO TRUE
  4823*          END-IF
  4824*          IF WS-ELCERT-NAME
  4825*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4826*                OR (CM-INSURED-LAST-NAME NOT =
  4827*                   CLIENT-LAST-NAME)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  85
* SOCK03.cbl
  4828*                            OR
  4829*                ((CLIENT-EFF-DT NOT = SPACES)
  4830*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4831*                 SET ELCERT-FINISHED TO TRUE
  4832*             END-IF
  4833*          ELSE
  4834*             SET ELCERT-FINISHED   TO TRUE
  4835*          END-IF
  4836     IF NOT WS-ELCERT-FULL
  4837        IF ELCERT-FINISHED
  4838           GO TO 0200-EXIT
  4839        END-IF
  4840     END-IF
  4841     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4842        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4843        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4844        PERFORM 0030-BUILD-BUFFER
  4845                                 THRU 0030-EXIT
  4846        PERFORM 0020-SEND-BUFFER
  4847                                 THRU 0020-EXIT
  4848        GO TO 0200-CONTINUE
  4849     END-IF
  4850     if (ws-epiq-request)
  4851        and (not EPIQ-CLASS)
  4852        go to 0200-continue
  4853     end-if
  4854
  4855     if ws-epiq-request
  4856        add +1 to ws-epiq-max
  4857        if ws-epiq-max > +100
  4858           go to 0200-continue
  4859        end-if
  4860     end-if
  4861     PERFORM 0300-GET-ELCNTL-RECORDS
  4862                                 THRU 0300-EXIT
  4863     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4864     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4865     MOVE +0                     TO DC-ELAPSED-MONTHS
  4866                                    DC-ELAPSED-DAYS
  4867     MOVE '1'                    TO DC-OPTION-CODE
  4868     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4869     IF NO-CONVERSION-ERROR
  4870        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4871        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4872     END-IF
  4873     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4874     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4875     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4876     IF NOT ALREADY-SENT
  4877        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4878     END-IF
  4879     .
  4880 0200-CONTINUE.
  4881     PERFORM 0150-READ-NEXT-ELCERT
  4882                                 THRU 0150-EXIT
  4883     .
  4884 0200-EXIT.
  4885     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  86
* SOCK03.cbl
  4886 0300-GET-ELCNTL-RECORDS.
  4887     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4888     IF NOT RESP-NORMAL
  4889        MOVE ' COMPANY RECORD NOT FOUND '
  4890                                 TO WS-COMMENT
  4891        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4892        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4893        PERFORM 0020-SEND-BUFFER
  4894                                 THRU 0020-EXIT
  4895        PERFORM 0025-CLOSE-SOCKET
  4896                                 THRU 0025-EXIT
  4897        GO TO 0010-RETURN
  4898     END-IF
  4899     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4900        PERFORM 0320-GET-LIFE-RECORD
  4901                                 THRU 0320-EXIT
  4902        IF NOT RESP-NORMAL
  4903           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4904                                 TO WS-COMMENT
  4905           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4906           PERFORM 0030-BUILD-BUFFER
  4907                                 THRU 0030-EXIT
  4908           PERFORM 0020-SEND-BUFFER
  4909                                 THRU 0020-EXIT
  4910           PERFORM 0025-CLOSE-SOCKET
  4911                                 THRU 0025-EXIT
  4912           GO TO 0010-RETURN
  4913        END-IF
  4914     END-IF
  4915     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4916        PERFORM 0330-GET-AH-RECORD
  4917                                 THRU 0330-EXIT
  4918        IF NOT RESP-NORMAL
  4919           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4920                                 TO WS-COMMENT
  4921           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4922           PERFORM 0030-BUILD-BUFFER
  4923                                 THRU 0030-EXIT
  4924           PERFORM 0020-SEND-BUFFER
  4925                                 THRU 0020-EXIT
  4926           PERFORM 0025-CLOSE-SOCKET
  4927                                 THRU 0025-EXIT
  4928           GO TO 0010-RETURN
  4929        END-IF
  4930     END-IF
  4931     PERFORM 0340-GET-STATE-RECORD
  4932                                 THRU 0340-EXIT
  4933     IF NOT RESP-NORMAL
  4934        MOVE ' STATE RECORD NOT FOUND '
  4935                                 TO WS-COMMENT
  4936        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4937        PERFORM 0030-BUILD-BUFFER
  4938                                 THRU 0030-EXIT
  4939        PERFORM 0020-SEND-BUFFER
  4940                                 THRU 0020-EXIT
  4941        PERFORM 0025-CLOSE-SOCKET
  4942                                 THRU 0025-EXIT
  4943        GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  87
* SOCK03.cbl
  4944     END-IF
  4945     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4946     IF NOT ERACCT-FOUND
  4947        MOVE ' ACCOUNT NOT FOUND '
  4948                                 TO WS-COMMENT
  4949        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4950        PERFORM 0030-BUILD-BUFFER
  4951                                 THRU 0030-EXIT
  4952        PERFORM 0020-SEND-BUFFER
  4953                                 THRU 0020-EXIT
  4954        PERFORM 0025-CLOSE-SOCKET
  4955                                 THRU 0025-EXIT
  4956        GO TO 0010-RETURN
  4957     ELSE
  4958        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4959        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4960        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4961        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4962     END-IF
  4963     .
  4964 0300-EXIT.
  4965     EXIT.
  4966 0310-GET-COMPANY.
  4967     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4968     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4969     MOVE SPACES                 TO  WS-CF-ACCESS
  4970     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4971
  4972* EXEC CICS READ
  4973*       INTO    (CONTROL-FILE)
  4974*       DATASET ('ELCNTL')
  4975*       RIDFLD  (WS-CF-KEY)
  4976*       RESP    (WS-RESPONSE)
  4977*    END-EXEC
  4978     MOVE LENGTH OF
  4979      CONTROL-FILE
  4980       TO DFHEIV11
  4981     MOVE 'ELCNTL' TO DFHEIV1
  4982*    MOVE '&"IL       E          (  N#00004749' TO DFHEIV0
  4983     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4985     MOVE X'204E233030303034373439' TO DFHEIV0(25:11)
  4986     CALL 'kxdfhei1' USING DFHEIV0,
  4987           DFHEIV1,
  4988           CONTROL-FILE,
  4989           DFHEIV11,
  4990           WS-CF-KEY,
  4991           DFHEIV99,
  4992           DFHEIV99,
  4993           DFHEIV99
  4994     MOVE EIBRESP  TO WS-RESPONSE
  4995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4996     IF (RESP-NORMAL)
  4997        AND (CF-COMPANY-ID = WS-COMP-ID)
  4998        AND (CF-RECORD-TYPE = '1')
  4999        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5000        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5001        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  88
* SOCK03.cbl
  5002        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5003        IF CF-DEFAULT-APR NUMERIC
  5004           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5005        ELSE
  5006           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5007        END-IF
  5008        IF CF-VALID-REM-TRM-OPTION
  5009           MOVE CF-REM-TRM-CALC-OPTION
  5010                                 TO WS-CF-REM-TRM-CALC-OPTION
  5011        ELSE
  5012           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5013        END-IF
  5014     END-IF
  5015     .
  5016 0310-EXIT.
  5017     EXIT.
  5018 0320-GET-LIFE-RECORD.
  5019     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5020     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5021                                    WS-LF-BEN-CODE
  5022     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5023
  5024* EXEC CICS READ
  5025*       INTO    (CONTROL-FILE)
  5026*       DATASET ('ELCNTL')
  5027*       RIDFLD  (WS-CF-KEY)
  5028*       GTEQ
  5029*       RESP    (WS-RESPONSE)
  5030*    END-EXEC
  5031     MOVE LENGTH OF
  5032      CONTROL-FILE
  5033       TO DFHEIV11
  5034     MOVE 'ELCNTL' TO DFHEIV1
  5035*    MOVE '&"IL       G          (  N#00004782' TO DFHEIV0
  5036     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5038     MOVE X'204E233030303034373832' TO DFHEIV0(25:11)
  5039     CALL 'kxdfhei1' USING DFHEIV0,
  5040           DFHEIV1,
  5041           CONTROL-FILE,
  5042           DFHEIV11,
  5043           WS-CF-KEY,
  5044           DFHEIV99,
  5045           DFHEIV99,
  5046           DFHEIV99
  5047     MOVE EIBRESP  TO WS-RESPONSE
  5048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5049     IF RESP-NORMAL
  5050        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5051        AND (CF-RECORD-TYPE = '4')
  5052        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5053           (S1 > +8)
  5054           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5055        END-PERFORM
  5056        IF S1 > +8
  5057           CONTINUE
  5058        ELSE
  5059           MOVE CF-BENEFIT-DESCRIP (S1)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  89
* SOCK03.cbl
  5060                                 TO WS-LF-BEN-CODE-DESC
  5061           MOVE CF-LF-COVERAGE-TYPE (S1)
  5062                                 TO WS-CF-LF-COVERAGE-TYPE
  5063           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5064              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5065           ELSE
  5066              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5067           END-IF
  5068           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5069               MOVE CF-CO-REM-TERM-CALC (S1)
  5070                                 TO WS-LF-CO-REM-TERM-CALC
  5071           END-IF
  5072           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5073               MOVE CF-CO-EARNINGS-CALC (S1)
  5074                                 TO WS-LF-CO-EARNINGS-CALC
  5075                                    WS-LF-CO-REFUND-CALC
  5076           END-IF
  5077           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5078               MOVE CF-SPECIAL-CALC-CD (S1)
  5079                                 TO WS-LF-SPECIAL-CALC-CD
  5080           END-IF
  5081           IF CF-CO-REFUND-CALC (S1) > '0'
  5082               MOVE CF-CO-REFUND-CALC (S1)
  5083                                 TO WS-LF-CO-REFUND-CALC
  5084        END-IF
  5085     END-IF
  5086     .
  5087 0320-EXIT.
  5088     EXIT.
  5089 0330-GET-AH-RECORD.
  5090     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5091     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5092     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5093
  5094* EXEC CICS READ
  5095*       INTO    (CONTROL-FILE)
  5096*       DATASET ('ELCNTL')
  5097*       RIDFLD  (WS-CF-KEY)
  5098*       GTEQ
  5099*       RESP    (WS-RESPONSE)
  5100*    END-EXEC
  5101     MOVE LENGTH OF
  5102      CONTROL-FILE
  5103       TO DFHEIV11
  5104     MOVE 'ELCNTL' TO DFHEIV1
  5105*    MOVE '&"IL       G          (  N#00004833' TO DFHEIV0
  5106     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5108     MOVE X'204E233030303034383333' TO DFHEIV0(25:11)
  5109     CALL 'kxdfhei1' USING DFHEIV0,
  5110           DFHEIV1,
  5111           CONTROL-FILE,
  5112           DFHEIV11,
  5113           WS-CF-KEY,
  5114           DFHEIV99,
  5115           DFHEIV99,
  5116           DFHEIV99
  5117     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  90
* SOCK03.cbl
  5118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5119     IF RESP-NORMAL
  5120        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5121        AND (CF-RECORD-TYPE = '5')
  5122        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5123           (S1 > +8)
  5124           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5125        END-PERFORM
  5126        IF S1 > +8
  5127           CONTINUE
  5128        ELSE
  5129           MOVE CF-BENEFIT-DESCRIP (S1)
  5130                                 TO WS-AH-BEN-CODE-DESC
  5131           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5132              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5133           ELSE
  5134              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5135           END-IF
  5136           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5137              MOVE CF-CO-REM-TERM-CALC (S1)
  5138                                 TO WS-AH-CO-REM-TERM-CALC
  5139           END-IF
  5140           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5141              MOVE CF-CO-EARNINGS-CALC (S1)
  5142                                 TO WS-AH-CO-EARNINGS-CALC
  5143                                    WS-AH-CO-REFUND-CALC
  5144           END-IF
  5145           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5146              MOVE CF-SPECIAL-CALC-CD (S1)
  5147                                 TO WS-AH-SPECIAL-CALC-CD
  5148           END-IF
  5149           IF CF-CO-REFUND-CALC (S1) > '0'
  5150              MOVE CF-CO-REFUND-CALC (S1)
  5151                                 TO WS-AH-CO-REFUND-CALC
  5152           END-IF
  5153           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5154              MOVE CF-BENEFIT-CATEGORY (S1)
  5155                                 TO WS-AH-BEN-CATEGORY
  5156           END-IF
  5157        END-IF
  5158     END-IF
  5159     .
  5160 0330-EXIT.
  5161     EXIT.
  5162 0340-GET-STATE-RECORD.
  5163     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5164     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5165     MOVE CM-STATE               TO WS-CF-ACCESS
  5166     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5167
  5168* EXEC CICS READ
  5169*       INTO    (CONTROL-FILE)
  5170*       DATASET ('ELCNTL')
  5171*       RIDFLD  (WS-CF-KEY)
  5172*       RESP    (WS-RESPONSE)
  5173*    END-EXEC
  5174     MOVE LENGTH OF
  5175      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  91
* SOCK03.cbl
  5176       TO DFHEIV11
  5177     MOVE 'ELCNTL' TO DFHEIV1
  5178*    MOVE '&"IL       E          (  N#00004888' TO DFHEIV0
  5179     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5181     MOVE X'204E233030303034383838' TO DFHEIV0(25:11)
  5182     CALL 'kxdfhei1' USING DFHEIV0,
  5183           DFHEIV1,
  5184           CONTROL-FILE,
  5185           DFHEIV11,
  5186           WS-CF-KEY,
  5187           DFHEIV99,
  5188           DFHEIV99,
  5189           DFHEIV99
  5190     MOVE EIBRESP  TO WS-RESPONSE
  5191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5192     IF (RESP-NORMAL)
  5193        AND (CF-COMPANY-ID = WS-COMP-ID)
  5194        AND (CF-RECORD-TYPE = '3')
  5195        AND (CF-STATE-CODE = CM-STATE)
  5196        MOVE CF-ST-FREE-LOOK-PERIOD
  5197                                 TO WS-FREE-LOOK
  5198        MOVE CF-STATE-ABBREVIATION
  5199                                 TO WS-STATE-ABBREVIATION
  5200        MOVE CF-ST-FST-PMT-DAYS-CHG
  5201                                 TO  WS-STATE-EXT-DAYS-CHG
  5202        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5203           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5204           IF CF-ST-RT-CALC NOT = SPACES
  5205              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5206           END-IF
  5207           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5208              IF CF-ST-RF-LR-CALC > '0'
  5209                 MOVE CF-ST-RF-LR-CALC
  5210                                 TO WS-LF-ST-REFUND-CALC
  5211              END-IF
  5212              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5213                 IF CF-ST-RF-LN-CALC > '0'
  5214                    MOVE CF-ST-RF-LN-CALC
  5215                                 TO WS-LF-ST-REFUND-CALC
  5216                 END-IF
  5217              END-IF
  5218           ELSE
  5219              IF CF-ST-RF-LL-CALC > '0'
  5220                 MOVE CF-ST-RF-LL-CALC
  5221                                 TO WS-LF-ST-REFUND-CALC
  5222              END-IF
  5223           END-IF
  5224           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5225              (S1 > 50)
  5226              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5227                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5228           END-PERFORM
  5229           IF S1 < +51
  5230              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5231                 MOVE CF-ST-REM-TERM-CALC (S1)
  5232                                 TO WS-LF-ST-REM-TERM-CALC
  5233              END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  92
* SOCK03.cbl
  5234              IF CF-ST-REFUND-CALC (S1) > '0'
  5235                 MOVE CF-ST-REFUND-CALC (S1)
  5236                                 TO WS-LF-ST-REFUND-CALC
  5237              END-IF
  5238           END-IF
  5239        END-IF
  5240        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5241           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5242           IF CF-ST-RT-CALC NOT = SPACES
  5243              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5244           END-IF
  5245           IF CF-ST-RF-AH-CALC > '0'
  5246              MOVE CF-ST-RF-AH-CALC
  5247                                 TO WS-AH-ST-REFUND-CALC
  5248           END-IF
  5249           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5250              IF CF-ST-RF-CP-CALC > '0'
  5251                 MOVE CF-ST-RF-CP-CALC
  5252                                 TO WS-AH-ST-REFUND-CALC
  5253              END-IF
  5254           END-IF
  5255           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5256              (S1 > 50)
  5257              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5258                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5259           END-PERFORM
  5260           IF S1 < +51
  5261              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5262                 MOVE CF-ST-REM-TERM-CALC (S1)
  5263                                 TO WS-AH-ST-REM-TERM-CALC
  5264              END-IF
  5265              IF CF-ST-REFUND-CALC (S1) > '0'
  5266                 MOVE CF-ST-REFUND-CALC (S1)
  5267                                 TO WS-AH-ST-REFUND-CALC
  5268              END-IF
  5269           END-IF
  5270        END-IF
  5271     END-IF
  5272     .
  5273 0340-EXIT.
  5274     EXIT.
  5275 0350-GET-ERACCT.
  5276     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5277                                    WS-AM-EARN-METHOD-R
  5278                                    WS-AM-EARN-METHOD-A
  5279                                    WS-LF-AM-REM-TERM-CALC
  5280                                    WS-AH-AM-REM-TERM-CALC
  5281     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5282     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5283     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5284     MOVE CM-STATE               TO WS-AM-STATE
  5285     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5286     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5287     MOVE LOW-VALUES             TO WS-AM-FILLER
  5288     MOVE ' '                    TO WS-STOP-SW
  5289
  5290* EXEC CICS STARTBR
  5291*       DATASET  ('ERACCT')
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  93
* SOCK03.cbl
  5292*       RIDFLD   (WS-AM-KEY)
  5293*       GTEQ
  5294*       RESP (WS-RESPONSE)
  5295*    END-EXEC
  5296     MOVE 'ERACCT' TO DFHEIV1
  5297     MOVE 0
  5298       TO DFHEIV11
  5299*    MOVE '&,         G          &  N#00004991' TO DFHEIV0
  5300     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5301     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5302     MOVE X'204E233030303034393931' TO DFHEIV0(25:11)
  5303     CALL 'kxdfhei1' USING DFHEIV0,
  5304           DFHEIV1,
  5305           WS-AM-KEY,
  5306           DFHEIV99,
  5307           DFHEIV11,
  5308           DFHEIV99
  5309     MOVE EIBRESP  TO WS-RESPONSE
  5310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5311     IF RESP-NORMAL
  5312        PERFORM UNTIL TOLD-TO-STOP
  5313
  5314* EXEC CICS READNEXT
  5315*             DATASET  ('ERACCT')
  5316*             INTO     (ACCOUNT-MASTER)
  5317*             RIDFLD   (WS-AM-KEY)
  5318*          END-EXEC
  5319     MOVE LENGTH OF
  5320      ACCOUNT-MASTER
  5321       TO DFHEIV12
  5322     MOVE 'ERACCT' TO DFHEIV1
  5323     MOVE 0
  5324       TO DFHEIV11
  5325*    MOVE '&.IL                  )   #00004999' TO DFHEIV0
  5326     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5327     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5328     MOVE X'2020233030303034393939' TO DFHEIV0(25:11)
  5329     CALL 'kxdfhei1' USING DFHEIV0,
  5330           DFHEIV1,
  5331           ACCOUNT-MASTER,
  5332           DFHEIV12,
  5333           WS-AM-KEY,
  5334           DFHEIV99,
  5335           DFHEIV11,
  5336           DFHEIV99,
  5337           DFHEIV99
  5338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5339           IF RESP-NORMAL
  5340              EVALUATE TRUE
  5341                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5342                    CM-CONTROL-PRIMARY (1:20)
  5343                    SET TOLD-TO-STOP TO TRUE
  5344                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5345                    CM-CONTROL-PRIMARY (1:20))
  5346                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5347                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5348                    SET ERACCT-FOUND      TO TRUE
  5349                    SET TOLD-TO-STOP TO TRUE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  94
* SOCK03.cbl
  5350              END-EVALUATE
  5351           ELSE
  5352              SET TOLD-TO-STOP TO TRUE
  5353           END-IF
  5354        END-PERFORM
  5355
  5356* EXEC CICS ENDBR
  5357*          DATASET   ('ERACCT')
  5358*       END-EXEC
  5359     MOVE 'ERACCT' TO DFHEIV1
  5360     MOVE 0
  5361       TO DFHEIV11
  5362*    MOVE '&2                    $   #00005020' TO DFHEIV0
  5363     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5365     MOVE X'2020233030303035303230' TO DFHEIV0(25:11)
  5366     CALL 'kxdfhei1' USING DFHEIV0,
  5367           DFHEIV1,
  5368           DFHEIV11,
  5369           DFHEIV99
  5370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5371     END-IF
  5372     .
  5373 0350-EXIT.
  5374     EXIT.
  5375 0400-PROCESS-LIFE.
  5376     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5377     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5378     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5379     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5380     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5381     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5382     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5383     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5384     MOVE CM-CARRIER             TO WS-CARRIER
  5385     MOVE CM-GROUPING            TO WS-GROUPING
  5386     MOVE CM-STATE               TO WS-STATE
  5387     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5388     MOVE CM-CERT-NO             TO WS-CERT-NO
  5389     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5390     MOVE ' '                    TO  DC-OPTION-CODE.
  5391     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5392     IF NO-CONVERSION-ERROR
  5393        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5394     ELSE
  5395        MOVE 99999999            TO WS-CERT-EFF-DATE
  5396     END-IF
  5397     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5398        GO TO 0400-EXIT
  5399     END-IF
  5400     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5401                                    WS-TOT-LF-PREM
  5402                                    WS-TOT-LF-COMM
  5403     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5404     MOVE ' '                    TO  DC-OPTION-CODE
  5405     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5406     IF NO-CONVERSION-ERROR
  5407        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  95
* SOCK03.cbl
  5408     ELSE
  5409        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5410     END-IF
  5411     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5412     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5413     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5414     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5415     MOVE CM-STATE               TO CP-STATE
  5416     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5417     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5418     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5419     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5420     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5421     MOVE '2'                    TO CP-PROCESS-TYPE
  5422     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5423     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5424     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5425     MOVE WS-CF-REM-TRM-CALC-OPTION
  5426                                 TO CP-REM-TRM-CALC-OPTION
  5427     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5428     IF WS-LF-CO-REM-TERM-CALC > '0'
  5429        MOVE WS-LF-CO-REM-TERM-CALC
  5430                                 TO CP-REM-TERM-METHOD
  5431     END-IF
  5432     IF WS-LF-ST-REM-TERM-CALC > '0'
  5433         MOVE WS-LF-ST-REM-TERM-CALC
  5434                                 TO  CP-REM-TERM-METHOD.
  5435     IF WS-LF-AM-REM-TERM-CALC > '0'
  5436         MOVE WS-LF-AM-REM-TERM-CALC
  5437                                 TO  CP-REM-TERM-METHOD.
  5438     IF (WS-COMP-ID = 'CID')
  5439        AND (CP-STATE-STD-ABBRV = 'WI')
  5440        MOVE '7'                 TO CP-REM-TERM-METHOD
  5441        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5442     END-IF
  5443     IF (WS-COMP-ID = 'CID')
  5444        AND (CP-STATE-STD-ABBRV = 'MO')
  5445        AND (CM-CERT-EFF-DT >= X'9B41')
  5446        AND (CM-CERT-EFF-DT <= X'A2FB')
  5447        MOVE '7'                 TO CP-REM-TERM-METHOD
  5448        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5449     END-IF
  5450     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5451                                    CP-LOAN-TERM
  5452                                    WS-LF-TERM
  5453     IF CP-TRUNCATED-LIFE
  5454         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5455     IF CP-TERM-IS-DAYS
  5456        IF CM-LF-TERM-IN-DAYS NUMERIC
  5457           MOVE CM-LF-TERM-IN-DAYS
  5458                                 TO CP-TERM-OR-EXT-DAYS
  5459        ELSE
  5460           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5461        END-IF
  5462     ELSE
  5463        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5464           MOVE CM-PMT-EXTENSION-DAYS
  5465                                 TO CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  96
* SOCK03.cbl
  5466        ELSE
  5467           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5468        END-IF
  5469     END-IF
  5470     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5471     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5472        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5473        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5474     END-IF
  5475     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5476     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5477     MOVE ' '                    TO WS-CLM-STOP-SW
  5478     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5479     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5480
  5481* EXEC CICS STARTBR
  5482*       DATASET     ('ELMSTR5')
  5483*       RIDFLD      (ELMSTR-KEY)
  5484*       RESP        (WS-RESPONSE)
  5485*    END-EXEC
  5486     MOVE 'ELMSTR5' TO DFHEIV1
  5487     MOVE 0
  5488       TO DFHEIV11
  5489*    MOVE '&,         G          &  N#00005132' TO DFHEIV0
  5490     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5491     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5492     MOVE X'204E233030303035313332' TO DFHEIV0(25:11)
  5493     CALL 'kxdfhei1' USING DFHEIV0,
  5494           DFHEIV1,
  5495           ELMSTR-KEY,
  5496           DFHEIV99,
  5497           DFHEIV11,
  5498           DFHEIV99
  5499     MOVE EIBRESP  TO WS-RESPONSE
  5500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5501     DISPLAY ' AFTER START ' WS-RESPONSE
  5502     IF RESP-NORMAL
  5503        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5504
  5505* EXEC CICS READNEXT
  5506*             DATASET   ('ELMSTR5')
  5507*             RIDFLD    (ELMSTR-KEY)
  5508*             INTO      (CLAIM-MASTER)
  5509*             RESP      (WS-RESPONSE)
  5510*          END-EXEC
  5511     MOVE LENGTH OF
  5512      CLAIM-MASTER
  5513       TO DFHEIV12
  5514     MOVE 'ELMSTR5' TO DFHEIV1
  5515     MOVE 0
  5516       TO DFHEIV11
  5517*    MOVE '&.IL                  )  N#00005140' TO DFHEIV0
  5518     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5519     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5520     MOVE X'204E233030303035313430' TO DFHEIV0(25:11)
  5521     CALL 'kxdfhei1' USING DFHEIV0,
  5522           DFHEIV1,
  5523           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  97
* SOCK03.cbl
  5524           DFHEIV12,
  5525           ELMSTR-KEY,
  5526           DFHEIV99,
  5527           DFHEIV11,
  5528           DFHEIV99,
  5529           DFHEIV99
  5530     MOVE EIBRESP  TO WS-RESPONSE
  5531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5532        IF (RESP-NORMAL OR RESP-DUPKEY)
  5533           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5534           AND (CM-CERT-NO = CL-CERT-NO)
  5535           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5536              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5537              IF CL-CLAIM-TYPE = 'L'
  5538                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5539                    MOVE 'D'     TO WS-AH-STATUS
  5540                 END-IF
  5541                 IF CLAIM-IS-OPEN
  5542                    MOVE ' OPEN LIFE CLAIM '
  5543                                 TO WS-COMMENT
  5544                    MOVE 'L'     TO WS-LF-STATUS
  5545                    GO TO 0400-EXIT
  5546                 ELSE
  5547                    MOVE ' DEATH CLAIM APPLIED '
  5548                                 TO WS-COMMENT
  5549                    MOVE 'D'     TO WS-LF-STATUS
  5550*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5551*                      MOVE CL-PAID-THRU-DT
  5552*                                TO WS-LF-BIN-PAID-THRU-DT
  5553*                   END-IF
  5554                 END-IF
  5555              END-IF
  5556           END-IF
  5557        ELSE
  5558           SET I-SAY-TO-STOP TO TRUE
  5559        END-IF
  5560        END-PERFORM
  5561
  5562* EXEC CICS ENDBR
  5563*          DATASET   ('ELMSTR5')
  5564*       END-EXEC
  5565     MOVE 'ELMSTR5' TO DFHEIV1
  5566     MOVE 0
  5567       TO DFHEIV11
  5568*    MOVE '&2                    $   #00005175' TO DFHEIV0
  5569     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5570     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5571     MOVE X'2020233030303035313735' TO DFHEIV0(25:11)
  5572     CALL 'kxdfhei1' USING DFHEIV0,
  5573           DFHEIV1,
  5574           DFHEIV11,
  5575           DFHEIV99
  5576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5577     END-IF
  5578     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5579*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5580        MOVE WS-LF-BIN-PAID-THRU-DT
  5581                                 TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  98
* SOCK03.cbl
  5582        MOVE ' '                 TO DC-OPTION-CODE
  5583        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5584        IF NO-CONVERSION-ERROR
  5585           MOVE DC-GREG-DATE-CYMD
  5586                                 TO WS-CLM-PAID-THRU-DT
  5587        ELSE
  5588           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5589        END-IF
  5590*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5591*          MOVE 'CAN DT =< CLM PD THRU DT'
  5592*                                TO WS-COMMENT
  5593*          MOVE 'P'              TO WS-LF-STATUS
  5594*          GO TO 0400-EXIT
  5595*       END-IF
  5596        GO TO 0400-EXIT
  5597     END-IF
  5598     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5599     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5600        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5601        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5602        COMPUTE CP-REMAINING-TERM-1 =
  5603                CP-REMAINING-TERM-1 - +1
  5604        COMPUTE CP-REMAINING-TERM-2 =
  5605                CP-REMAINING-TERM-2 - +1
  5606     END-IF
  5607     IF CP-REMAINING-TERM-1 NEGATIVE
  5608        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5609     END-IF
  5610     IF CP-REMAINING-TERM-2 NEGATIVE
  5611        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5612     END-IF
  5613     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5614        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5615     END-IF
  5616     IF CM-LIFE-COMM-PCT > ZEROS
  5617        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5618           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5619     END-IF
  5620     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5621     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5622     IF CM-LF-CURRENT-STATUS = '8'
  5623        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5624           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5625                                 TO WS-COMMENT
  5626           MOVE 'C'              TO WS-LF-STATUS
  5627*          PERFORM 0030-BUILD-BUFFER
  5628*                                THRU 0030-EXIT
  5629*          PERFORM 0020-SEND-BUFFER
  5630*                                THRU 0020-EXIT
  5631*          SET ALREADY-SENT      TO TRUE
  5632*          MOVE SPACES           TO WS-COMMENT
  5633           GO TO 0400-EXIT
  5634*          PERFORM 0025-CLOSE-SOCKET
  5635*                                THRU 0025-EXIT
  5636*          GO TO 0010-RETURN
  5637        END-IF
  5638     END-IF
  5639     IF CM-LF-CURRENT-STATUS = '7'
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page  99
* SOCK03.cbl
  5640        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5641           MOVE ' DEATH CLAIM APPLIED '
  5642                                 TO WS-COMMENT
  5643           MOVE 'D'              TO WS-LF-STATUS
  5644*          PERFORM 0030-BUILD-BUFFER
  5645*                                THRU 0030-EXIT
  5646*          IF NOT ALREADY-SENT
  5647*             PERFORM 0020-SEND-BUFFER
  5648*                                THRU 0020-EXIT
  5649*             SET ALREADY-SENT   TO TRUE
  5650*          END-IF
  5651           GO TO 0400-EXIT
  5652*          PERFORM 0025-CLOSE-SOCKET
  5653*                                THRU 0025-EXIT
  5654*          GO TO 0010-RETURN
  5655        END-IF
  5656     END-IF
  5657     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5658        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5659        MOVE 'LF COVERAGE EXPIRED '
  5660                                 TO WS-COMMENT
  5661        MOVE 'E'                 TO WS-LF-STATUS
  5662        GO TO 0400-EXIT
  5663     END-IF
  5664     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5665        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5666        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5667     ELSE
  5668        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5669     END-IF
  5670     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5671     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5672*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5673     if ws-comp-id = 'AHL'
  5674        move cm-lf-class-cd      to cp-class-code
  5675        if cp-class-code = spaces
  5676           move zeros            to cp-class-code
  5677        end-if
  5678     else
  5679        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5680     end-if
  5681     IF (ws-comp-id = 'DCC' or 'CAP')
  5682        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5683        MOVE ' '                 TO WS-PDEF-RECORD-SW
  5684        PERFORM 0730-GET-DDF-FACTORS
  5685                                 THRU 0730-EXIT
  5686        IF PDEF-FOUND
  5687           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5688              (P1 > +8)
  5689              OR (PD-PROD-CODE (P1) = 'L')
  5690           END-PERFORM
  5691           IF P1 < +9
  5692              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  5693           END-IF
  5694        END-IF
  5695     END-IF
  5696     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5697*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 100
* SOCK03.cbl
  5698     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5699        CM-LF-ALT-BENEFIT-AMT
  5700*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5701     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5702                                    WS-LF-REM-BEN
  5703     move cm-lf-premium-amt      to ws-tot-lf-prem
  5704     if ws-lf-co-earnings-calc = 'B'
  5705        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  5706           + CM-LF-ALT-PREMIUM-AMT
  5707     end-if
  5708     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5709     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5710        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5711        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5712     ELSE
  5713        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5714     END-IF
  5715     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5716     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5717     IF WS-LF-ST-REFUND-CALC > ZERO
  5718         MOVE WS-LF-ST-REFUND-CALC
  5719                                 TO  CP-EARNING-METHOD.
  5720     IF WS-LF-FO-REFUND-CALC > ZERO
  5721         MOVE WS-LF-FO-REFUND-CALC
  5722                                 TO  CP-EARNING-METHOD.
  5723     IF CP-RATING-METHOD = '4'
  5724        MOVE '4'                 TO CP-EARNING-METHOD
  5725     END-IF
  5726*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5727     if ws-comp-id = 'AHL'
  5728        move cm-lf-class-cd      to cp-class-code
  5729        if cp-class-code = spaces
  5730           move zeros            to cp-class-code
  5731        end-if
  5732     else
  5733        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5734     end-if
  5735     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5736     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5737                                     CP-RATING-BENEFIT-AMT.
  5738     IF CP-STATE-STD-ABBRV = 'OR'
  5739         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5740                                         CM-LF-ALT-BENEFIT-AMT.
  5741****   N O T E   ****
  5742*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5743*      THE OH HARD CODING IN ELCRFNDP
  5744     IF WS-COMP-ID = 'CID'
  5745        IF CP-STATE-STD-ABBRV = 'OH'
  5746           MOVE WS-LF-CO-EARNINGS-CALC
  5747                                 TO CP-EARNING-METHOD
  5748        END-IF
  5749     END-IF
  5750****   N O T E   ****
  5751     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5752     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5753     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5754     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5755     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 101
* SOCK03.cbl
  5756*    IF CP-EARN-AS-NET-PAY
  5757*       IF CP-LOAN-APR <= ZEROS
  5758*          IF WS-CF-DEFAULT-APR > ZEROS
  5759*             MOVE WS-CF-DEFAULT-APR
  5760*                                TO  CP-LOAN-APR
  5761*          END-IF
  5762*       END-IF
  5763*    END-IF
  5764*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5765*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5766*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5767*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5768*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5769*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5770*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5771*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5772*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5773*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5774*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5775*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5776*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5777*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5778*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5779*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5780*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5781*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5782     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5783     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5784     DISPLAY ' MADE IT BACK FROM ELRFND '
  5785     IF (CP-ERROR-RATE-IS-ZERO)
  5786        OR (CP-ERROR-RATE-NOT-FOUND)
  5787        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5788        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5789          DELIMITED BY SIZE INTO WS-COMMENT
  5790        END-STRING
  5791        MOVE 'X'                 TO WS-LF-STATUS
  5792        GO TO 0400-EXIT
  5793*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5794*       IF NOT ALREADY-SENT
  5795*          PERFORM 0020-SEND-BUFFER
  5796*                                THRU 0020-EXIT
  5797*          SET ALREADY-SENT      TO TRUE
  5798*       END-IF
  5799*       PERFORM 0025-CLOSE-SOCKET
  5800*                                THRU 0025-EXIT
  5801*       GO TO 0010-RETURN
  5802     END-IF
  5803     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5804                                    WS-TOT-LF-RFND
  5805     IF (WS-LF-STATUS = SPACES)
  5806        OR (CP-CALC-REFUND > ZEROS)
  5807        MOVE 'A'                 TO WS-LF-STATUS
  5808     END-IF
  5809     EVALUATE TRUE
  5810        WHEN CP-R-AS-R78
  5811           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5812        WHEN  CP-R-AS-PRORATA
  5813           MOVE 'PRO RATA'         TO  WS-LF-METHOD
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 102
* SOCK03.cbl
  5814        WHEN CP-R-AS-CALIF
  5815           MOVE 'CALIF'            TO  WS-LF-METHOD
  5816        WHEN CP-R-AS-TEXAS
  5817           MOVE 'IRREG'            TO  WS-LF-METHOD
  5818        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5819           MOVE 'UTAH'             TO  WS-LF-METHOD
  5820        WHEN CP-R-AS-FARM-PLAN
  5821           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5822        WHEN CP-R-AS-NET-PAY
  5823           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5824        WHEN CP-R-AS-ANTICIPATION
  5825           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5826        WHEN CP-R-AS-MEAN
  5827           MOVE 'MEAN'             TO  WS-LF-METHOD
  5828        WHEN CP-R-AS-SUM-OF-DIGITS
  5829           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5830     END-EVALUATE
  5831     IF WS-TOT-LF-RFND > ZEROS
  5832        COMPUTE WS-WORK-FACTOR ROUNDED =
  5833           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5834        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5835           WS-TOT-LF-COMM
  5836     END-IF
  5837     IF ERACCT-FOUND
  5838        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5839           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5840        END-IF
  5841        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5842           IF (AM-COMM-CHARGEBACK (1) = 99)
  5843                     OR
  5844              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5845                     OR
  5846              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5847              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5848              MOVE ZEROS         TO WS-LF-UEC
  5849           END-IF
  5850        END-IF
  5851     END-IF
  5852     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5853        GO TO 0400-EXIT
  5854     END-IF
  5855     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5856     MOVE '2'                    TO  CP-EARNING-METHOD
  5857                                     CP-RATING-METHOD.
  5858     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5859                                     CP-REMAINING-BENEFIT
  5860                                     CP-RATING-BENEFIT-AMT.
  5861     IF CP-STATE-STD-ABBRV = 'OR'
  5862         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5863                                         CM-LF-ALT-BENEFIT-AMT.
  5864     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5865     IF ws-comp-id = 'CID'
  5866        IF (CP-STATE-STD-ABBRV = 'MN')
  5867           AND (CM-CERT-EFF-DT > X'A4FF')
  5868           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  5869           MOVE '5'              TO CP-EARNING-METHOD
  5870           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  5871        END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 103
* SOCK03.cbl
  5872     END-IF
  5873     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5874     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5875     IF (CP-ERROR-RATE-IS-ZERO)
  5876        OR (CP-ERROR-RATE-NOT-FOUND)
  5877        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5878        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5879          DELIMITED BY SIZE INTO WS-COMMENT
  5880        END-STRING
  5881        MOVE 'X'              TO WS-LF-STATUS
  5882        GO TO 0400-EXIT
  5883*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5884*       IF NOT ALREADY-SENT
  5885*          PERFORM 0020-SEND-BUFFER
  5886*                                THRU 0020-EXIT
  5887*          SET ALREADY-SENT      TO TRUE
  5888*       END-IF
  5889*       PERFORM 0025-CLOSE-SOCKET
  5890*                                THRU 0025-EXIT
  5891*       GO TO 0010-RETURN
  5892     END-IF
  5893     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5894     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5895     IF WS-TOT-LF-RFND > ZEROS
  5896        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5897           WS-TOT-LF-COMM
  5898     END-IF
  5899     IF ERACCT-FOUND
  5900        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5901           IF (AM-COMM-CHARGEBACK (1) = 99)
  5902                     OR
  5903              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5904                     OR
  5905              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5906              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5907              MOVE ZEROS         TO WS-LF-UEC
  5908           END-IF
  5909        END-IF
  5910     END-IF
  5911     .
  5912 0400-EXIT.
  5913     EXIT.
  5914 0500-PROCESS-AH.
  5915     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5916        GO TO 0500-EXIT
  5917     END-IF
  5918     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5919                                    WS-TOT-AH-PREM
  5920                                    WS-TOT-AH-COMM
  5921     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5922     MOVE ' '                    TO  DC-OPTION-CODE
  5923     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5924     IF NO-CONVERSION-ERROR
  5925        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5926     ELSE
  5927        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5928     END-IF
  5929     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 104
* SOCK03.cbl
  5930     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5931     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5932     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5933     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5934     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5935     MOVE CM-STATE               TO  CP-STATE.
  5936     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5937     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5938     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5939     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5940     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5941     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5942     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5943     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5944     MOVE WS-CF-CR-REM-TERM-CALC
  5945                                 TO  CP-REM-TERM-METHOD.
  5946     IF WS-AH-CO-REM-TERM-CALC > '0'
  5947         MOVE WS-AH-CO-REM-TERM-CALC
  5948                                 TO  CP-REM-TERM-METHOD.
  5949     IF WS-AH-ST-REM-TERM-CALC > '0'
  5950         MOVE WS-AH-ST-REM-TERM-CALC
  5951                                 TO  CP-REM-TERM-METHOD.
  5952     IF WS-AH-AM-REM-TERM-CALC > '0'
  5953         MOVE WS-AH-AM-REM-TERM-CALC
  5954                                 TO  CP-REM-TERM-METHOD.
  5955     IF (WS-COMP-ID = 'CID')
  5956        AND (CP-STATE-STD-ABBRV = 'WI')
  5957        MOVE '7'                 TO CP-REM-TERM-METHOD
  5958        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5959     END-IF
  5960     IF (WS-COMP-ID = 'CID')
  5961        AND (CP-STATE-STD-ABBRV = 'MO')
  5962        AND (CM-CERT-EFF-DT >= X'9B41')
  5963        AND (CM-CERT-EFF-DT <= X'A2FB')
  5964        MOVE '7'                 TO CP-REM-TERM-METHOD
  5965        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5966     END-IF
  5967     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5968                                     CP-LOAN-TERM.
  5969     IF  NOT  CP-TERM-IS-DAYS
  5970         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5971             MOVE CM-PMT-EXTENSION-DAYS
  5972                                 TO  CP-TERM-OR-EXT-DAYS
  5973         ELSE
  5974             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5975     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5976     IF CM-AH-COMM-PCT > ZEROS
  5977        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5978           CM-AH-PREMIUM-AMT
  5979     END-IF
  5980     IF (ws-comp-id = 'DCC' or 'CAP')
  5981        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5982        compute ws-tot-ah-comm = cm-ah-premium-amt -
  5983           (cm-ah-clp + cm-addl-clp)
  5984     end-if
  5985     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5986     IF WS-AH-STATUS = 'D'
  5987        GO TO 0500-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 105
* SOCK03.cbl
  5988     END-IF
  5989     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5990     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5991     MOVE ' '                    TO WS-CLM-STOP-SW
  5992     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5993     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5994
  5995* EXEC CICS STARTBR
  5996*       DATASET     ('ELMSTR5')
  5997*       RIDFLD      (ELMSTR-KEY)
  5998*       RESP        (WS-RESPONSE)
  5999*    END-EXEC
  6000     MOVE 'ELMSTR5' TO DFHEIV1
  6001     MOVE 0
  6002       TO DFHEIV11
  6003*    MOVE '&,         G          &  N#00005595' TO DFHEIV0
  6004     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6006     MOVE X'204E233030303035353935' TO DFHEIV0(25:11)
  6007     CALL 'kxdfhei1' USING DFHEIV0,
  6008           DFHEIV1,
  6009           ELMSTR-KEY,
  6010           DFHEIV99,
  6011           DFHEIV11,
  6012           DFHEIV99
  6013     MOVE EIBRESP  TO WS-RESPONSE
  6014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6015     DISPLAY ' AFTER START ' WS-RESPONSE
  6016     IF RESP-NORMAL
  6017        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6018           DISPLAY ' AH READNEXT '
  6019
  6020* EXEC CICS READNEXT
  6021*             DATASET   ('ELMSTR5')
  6022*             RIDFLD    (ELMSTR-KEY)
  6023*             INTO      (CLAIM-MASTER)
  6024*             RESP      (WS-RESPONSE)
  6025*          END-EXEC
  6026     MOVE LENGTH OF
  6027      CLAIM-MASTER
  6028       TO DFHEIV12
  6029     MOVE 'ELMSTR5' TO DFHEIV1
  6030     MOVE 0
  6031       TO DFHEIV11
  6032*    MOVE '&.IL                  )  N#00005604' TO DFHEIV0
  6033     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6034     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6035     MOVE X'204E233030303035363034' TO DFHEIV0(25:11)
  6036     CALL 'kxdfhei1' USING DFHEIV0,
  6037           DFHEIV1,
  6038           CLAIM-MASTER,
  6039           DFHEIV12,
  6040           ELMSTR-KEY,
  6041           DFHEIV99,
  6042           DFHEIV11,
  6043           DFHEIV99,
  6044           DFHEIV99
  6045     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 106
* SOCK03.cbl
  6046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6047        IF (RESP-NORMAL OR RESP-DUPKEY)
  6048           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6049           AND (CM-CERT-NO = CL-CERT-NO)
  6050           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6051              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6052              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6053                 IF CLAIM-IS-OPEN
  6054                    DISPLAY ' FOUND OPEN AH CLAIM '
  6055                    MOVE ' OPEN HEALTH CLAIM '
  6056                                 TO WS-COMMENT
  6057                    MOVE 'H'     TO WS-AH-STATUS
  6058                 ELSE
  6059                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6060                    MOVE ' CLOSED HEALTH CLAIM '
  6061                                 TO WS-COMMENT
  6062                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6063                       MOVE CL-PAID-THRU-DT
  6064                                 TO WS-AH-BIN-PAID-THRU-DT
  6065                    END-IF
  6066                 END-IF
  6067              END-IF
  6068           END-IF
  6069        ELSE
  6070           SET I-SAY-TO-STOP TO TRUE
  6071        END-IF
  6072        END-PERFORM
  6073
  6074* EXEC CICS ENDBR
  6075*          DATASET   ('ELMSTR5')
  6076*       END-EXEC
  6077     MOVE 'ELMSTR5' TO DFHEIV1
  6078     MOVE 0
  6079       TO DFHEIV11
  6080*    MOVE '&2                    $   #00005636' TO DFHEIV0
  6081     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6082     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6083     MOVE X'2020233030303035363336' TO DFHEIV0(25:11)
  6084     CALL 'kxdfhei1' USING DFHEIV0,
  6085           DFHEIV1,
  6086           DFHEIV11,
  6087           DFHEIV99
  6088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6089     END-IF
  6090     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6091*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6092        MOVE WS-AH-BIN-PAID-THRU-DT
  6093                                 TO DC-BIN-DATE-1
  6094        MOVE ' '                 TO DC-OPTION-CODE
  6095        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6096        IF NO-CONVERSION-ERROR
  6097           MOVE DC-GREG-DATE-CYMD
  6098                                 TO WS-CLM-PAID-THRU-DT
  6099        ELSE
  6100           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6101        END-IF
  6102        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6103           MOVE 'CAN DT NOT > CLM CLOSE DT '
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 107
* SOCK03.cbl
  6104                                 TO WS-COMMENT
  6105           MOVE 'P'              TO WS-AH-STATUS
  6106           GO TO 0500-EXIT
  6107        END-IF
  6108     END-IF
  6109     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6110     IF CM-AH-CURRENT-STATUS = '8'
  6111        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6112           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6113                                 TO WS-COMMENT
  6114           MOVE 'C'              TO WS-AH-STATUS
  6115           GO TO 0500-EXIT
  6116        END-IF
  6117     END-IF
  6118     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6119        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6120           MOVE ' SETTLEMENT CLAIM APPLIED '
  6121                                 TO WS-COMMENT
  6122           MOVE 'S'              TO WS-AH-STATUS
  6123*          PERFORM 0030-BUILD-BUFFER
  6124*                                THRU 0030-EXIT
  6125*          IF NOT ALREADY-SENT
  6126*             PERFORM 0020-SEND-BUFFER
  6127*                                THRU 0020-EXIT
  6128*             SET ALREADY-SENT   TO TRUE
  6129*          END-IF
  6130           GO TO 0500-EXIT
  6131*          PERFORM 0025-CLOSE-SOCKET
  6132*                                THRU 0025-EXIT
  6133*          GO TO 0010-RETURN
  6134        END-IF
  6135     END-IF
  6136     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6137        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6138        MOVE 'AH COVERAGE EXPIRED '
  6139                                 TO WS-COMMENT
  6140        MOVE 'E'                 TO WS-AH-STATUS
  6141        GO TO 0500-EXIT
  6142     END-IF
  6143     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6144                                    WS-AH-PREM
  6145     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6146     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6147        * CP-REMAINING-TERM-1
  6148     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6149                                     WS-AH-REM-TERM
  6150     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6151     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6152     IF WS-AH-ST-REFUND-CALC > ZERO
  6153         MOVE WS-AH-ST-REFUND-CALC
  6154                                 TO  CP-EARNING-METHOD.
  6155     IF WS-AH-FO-REFUND-CALC > ZERO
  6156         MOVE WS-AH-FO-REFUND-CALC
  6157                                 TO  CP-EARNING-METHOD.
  6158*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6159     if ws-comp-id = 'AHL'
  6160        move cm-ah-class-cd      to cp-class-code
  6161        if cp-class-code = spaces
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 108
* SOCK03.cbl
  6162           move zeros            to cp-class-code
  6163        end-if
  6164     else
  6165        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6166     end-if
  6167     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6168     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6169                                     CP-RATING-BENEFIT-AMT.
  6170     IF CP-STATE-STD-ABBRV = 'OR'
  6171         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6172                                         CM-AH-ORIG-TERM.
  6173     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6174     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6175     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6176     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6177     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6178     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6179     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6180     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6181     MOVE ' '                    TO  DC-OPTION-CODE.
  6182     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6183     IF CP-STATE-STD-ABBRV = 'OH'
  6184        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6185         IF (CP-ORIGINAL-TERM > 60)
  6186           AND (DC-GREG-DATE-1-YMD > '831101')
  6187           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6188             MOVE '6'            TO  CP-EARNING-METHOD
  6189         END-IF
  6190        END-IF
  6191        IF WS-COMP-ID = 'CID'
  6192           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6193                           LOW-VALUES)
  6194              IF CP-CRITICAL-PERIOD
  6195                 MOVE '2'       TO CP-EARNING-METHOD
  6196              ELSE
  6197                 MOVE '6'       TO CP-EARNING-METHOD
  6198              END-IF
  6199           ELSE
  6200              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6201                 MOVE '2'       TO CP-EARNING-METHOD
  6202              ELSE
  6203                 IF ((CM-LF-ORIG-TERM > 60) AND
  6204                    (CM-RATE-CLASS NOT = 'L '))
  6205                               OR
  6206                    (WS-LF-CO-EARNINGS-CALC = '5')
  6207                    IF CP-CRITICAL-PERIOD
  6208                       MOVE '2'  TO CP-EARNING-METHOD
  6209                    ELSE
  6210                       MOVE '6'  TO CP-EARNING-METHOD
  6211                    END-IF
  6212                 ELSE
  6213                    MOVE '1'     TO CP-EARNING-METHOD
  6214                 END-IF
  6215              END-IF
  6216           END-IF
  6217        END-IF
  6218     END-IF
  6219     IF CP-STATE-STD-ABBRV = 'VA'
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 109
* SOCK03.cbl
  6220       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6221         IF DC-GREG-DATE-1-YMD > '921231'
  6222            IF CP-ORIGINAL-TERM > 61
  6223                MOVE '6'            TO  CP-EARNING-METHOD
  6224            ELSE
  6225                MOVE '1'            TO  CP-EARNING-METHOD.
  6226*    IF CP-EARN-AS-NET-PAY
  6227*       IF CP-LOAN-APR <= ZEROS
  6228*          IF WS-CF-DEFAULT-APR > ZEROS
  6229*             MOVE WS-CF-DEFAULT-APR
  6230*                                TO  CP-LOAN-APR
  6231*          END-IF
  6232*       END-IF
  6233*    END-IF
  6234     IF WS-COMP-ID = 'DCC' or 'CAP'
  6235        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6236           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6237           MOVE 'S'              TO CP-EARNING-METHOD
  6238        END-IF
  6239     END-IF
  6240     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6241     IF (WS-COMP-ID = 'DCC' or 'CAP')
  6242        AND (CP-EARNING-METHOD = 'D')
  6243        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6244                                    WS-DDF-CSO-ADMIN-FEE
  6245                                    WS-DDF-1ST-YR-TOT-EXP
  6246                                    WS-DDF-COMM-AND-MFEE
  6247        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6248           S1 > +10
  6249           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6250              IF (AM-A-COM (S1) NUMERIC)
  6251                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6252                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6253              ELSE
  6254                 MOVE +0         TO WS-COMM-PCT C0
  6255                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6256                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6257              END-IF
  6258              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6259                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6260                    + WS-COMM-PCT
  6261              END-IF
  6262              IF AM-COM-TYP (S1) = 'N'
  6263                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6264                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6265              END-IF
  6266              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6267                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6268                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6269              END-IF
  6270              IF AM-COM-TYP (S1) = 'I'
  6271                 COMPUTE WS-DDF-COMM-AND-MFEE
  6272                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6273              END-IF
  6274           END-IF
  6275        END-PERFORM
  6276        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6277        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 110
* SOCK03.cbl
  6278        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6279           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6280     END-IF
  6281     IF (WS-COMP-ID = 'DCC' or 'CAP')
  6282        AND (CP-EARNING-METHOD = 'D')
  6283        AND (ws-CANCEL-REASON NOT = 'R')
  6284        PERFORM 0730-GET-DDF-FACTORS
  6285                                 THRU 0730-EXIT
  6286        IF NOT PDEF-FOUND
  6287           MOVE ' DDF UE FACTORS  NOT FOUND '
  6288                                 TO WS-COMMENT
  6289           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6290           PERFORM 0030-BUILD-BUFFER
  6291                                 THRU 0030-EXIT
  6292           PERFORM 0020-SEND-BUFFER
  6293                                 THRU 0020-EXIT
  6294           PERFORM 0025-CLOSE-SOCKET
  6295                                 THRU 0025-EXIT
  6296           GO TO 0010-RETURN
  6297        END-IF
  6298*       IF NOT PDEF-FOUND
  6299*          MOVE ER-9999          TO EMI-ERROR
  6300*          PERFORM 9700-ERROR-FORMAT
  6301*                                THRU 9799-EXIT
  6302*          GO TO 8200-SEND-DATAONLY
  6303*       END-IF
  6304        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6305                                 TO CP-DDF-LO-FACT
  6306        MOVE PD-UEP-FACTOR (P1 P2)
  6307                                 TO CP-DDF-HI-FACT
  6308        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6309        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6310        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6311        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6312           + PD-1ST-YR-ADMIN-ALLOW
  6313        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6314*       IF PI-CLP-YN = 'Y'
  6315*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6316*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6317*                                   CP-DDF-CLP
  6318*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6319*       END-IF
  6320        IF DD-IU-PRESENT
  6321           MOVE 'I'              TO CP-EARNING-METHOD
  6322        END-IF
  6323        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6324                                    CP-CLP-RATE-UP
  6325        IF (CP-CALC-GROSS-FEE)
  6326           AND (CP-IU-RATE-UP NOT = ZEROS)
  6327           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6328              / CP-ORIGINAL-PREMIUM)
  6329           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6330              / (1 - TEX-FACT-8)
  6331        END-IF
  6332     END-IF
  6333     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6334     IF (CP-ERROR-RATE-IS-ZERO)
  6335        OR (CP-ERROR-RATE-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 111
* SOCK03.cbl
  6336        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6337        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6338          DELIMITED BY SIZE INTO WS-COMMENT
  6339        END-STRING
  6340        IF WS-AH-STATUS NOT = 'H'
  6341           MOVE 'X'                 TO WS-AH-STATUS
  6342        END-IF
  6343        GO TO 0500-EXIT
  6344*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6345*       IF NOT ALREADY-SENT
  6346*          PERFORM 0020-SEND-BUFFER
  6347*                                THRU 0020-EXIT
  6348*          SET ALREADY-SENT      TO TRUE
  6349*       END-IF
  6350*       PERFORM 0025-CLOSE-SOCKET
  6351*                                THRU 0025-EXIT
  6352*       GO TO 0010-RETURN
  6353     END-IF
  6354     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6355                                    WS-TOT-AH-RFND
  6356     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6357     IF ((WS-AH-STATUS = SPACES)
  6358        OR (CP-CALC-REFUND > ZEROS))
  6359                  AND
  6360          (WS-AH-STATUS NOT = 'H')
  6361        MOVE 'A'                 TO WS-AH-STATUS
  6362     END-IF
  6363     IF WS-COMP-ID = 'DCC' or 'CAP'
  6364        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6365        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6366        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6367        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6368        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6369        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6370        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6371        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6372        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6373     END-IF
  6374     EVALUATE TRUE
  6375        WHEN CP-R-AS-R78
  6376           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6377        WHEN CP-R-AS-PRORATA
  6378           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6379        WHEN CP-REFUND-TYPE-USED = '3'
  6380           MOVE 'CALIF'            TO  WS-AH-METHOD
  6381        WHEN CP-R-AS-TEXAS
  6382           MOVE 'IRREG'            TO  WS-AH-METHOD
  6383        WHEN CP-R-AS-FARM-PLAN
  6384           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6385        WHEN CP-R-AS-NET-PAY
  6386           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6387        WHEN CP-R-AS-ANTICIPATION
  6388           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6389        WHEN CP-R-AS-MEAN
  6390           MOVE 'MEAN'             TO  WS-AH-METHOD
  6391        WHEN CP-R-AS-SUM-OF-DIGITS
  6392           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6393        WHEN CP-GAP-ACTUARIAL
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 112
* SOCK03.cbl
  6394           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6395     END-EVALUATE
  6396     IF WS-TOT-AH-RFND > ZEROS
  6397        IF (ws-comp-id = 'DCC' or 'CAP')
  6398           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6399           compute ws-work-factor rounded =
  6400              ws-ah-rfnd-clp / cm-ah-clp
  6401        else
  6402           COMPUTE WS-WORK-FACTOR ROUNDED =
  6403              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6404        end-if
  6405        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6406           WS-TOT-AH-COMM
  6407     END-IF
  6408     IF ERACCT-FOUND
  6409        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6410           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6411        END-IF
  6412        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6413           IF (AM-COMM-CHARGEBACK (1) = 99)
  6414                     OR
  6415              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6416                     OR
  6417              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6418              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6419              MOVE ZEROS         TO WS-AH-UEC
  6420           END-IF
  6421        END-IF
  6422     END-IF
  6423     .
  6424 0500-EXIT.
  6425     EXIT.
  6426 0700-LINK-REM-TERM.
  6427
  6428* EXEC CICS LINK
  6429*        PROGRAM   ('ELRTRM')
  6430*        COMMAREA  (CALCULATION-PASS-AREA)
  6431*        LENGTH    (CP-COMM-LENGTH)
  6432*    END-EXEC.
  6433     MOVE 'ELRTRM' TO DFHEIV1
  6434*    MOVE '."C                   (   #00005977' TO DFHEIV0
  6435     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6437     MOVE X'2020233030303035393737' TO DFHEIV0(25:11)
  6438     CALL 'kxdfhei1' USING DFHEIV0,
  6439           DFHEIV1,
  6440           CALCULATION-PASS-AREA,
  6441           CP-COMM-LENGTH,
  6442           DFHEIV99,
  6443           DFHEIV99,
  6444           DFHEIV99,
  6445           DFHEIV99
  6446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6447
  6448 0700-EXIT.
  6449     EXIT.
  6450 0710-LINK-REM-AMOUNT.
  6451
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 113
* SOCK03.cbl
  6452* EXEC CICS LINK
  6453*        PROGRAM   ('ELRAMT')
  6454*        COMMAREA  (CALCULATION-PASS-AREA)
  6455*        LENGTH    (CP-COMM-LENGTH)
  6456*    END-EXEC
  6457     MOVE 'ELRAMT' TO DFHEIV1
  6458*    MOVE '."C                   (   #00005985' TO DFHEIV0
  6459     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6461     MOVE X'2020233030303035393835' TO DFHEIV0(25:11)
  6462     CALL 'kxdfhei1' USING DFHEIV0,
  6463           DFHEIV1,
  6464           CALCULATION-PASS-AREA,
  6465           CP-COMM-LENGTH,
  6466           DFHEIV99,
  6467           DFHEIV99,
  6468           DFHEIV99,
  6469           DFHEIV99
  6470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6471     .
  6472 0710-EXIT.
  6473     EXIT.
  6474 0720-LINK-REFUND.
  6475
  6476* EXEC CICS LINK
  6477*        PROGRAM   ('ELRFND')
  6478*        COMMAREA  (CALCULATION-PASS-AREA)
  6479*        LENGTH    (CP-COMM-LENGTH)
  6480*    END-EXEC
  6481     MOVE 'ELRFND' TO DFHEIV1
  6482*    MOVE '."C                   (   #00005994' TO DFHEIV0
  6483     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6485     MOVE X'2020233030303035393934' TO DFHEIV0(25:11)
  6486     CALL 'kxdfhei1' USING DFHEIV0,
  6487           DFHEIV1,
  6488           CALCULATION-PASS-AREA,
  6489           CP-COMM-LENGTH,
  6490           DFHEIV99,
  6491           DFHEIV99,
  6492           DFHEIV99,
  6493           DFHEIV99
  6494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6495     .
  6496 0720-EXIT.
  6497     EXIT.
  6498 0730-GET-DDF-FACTORS.
  6499     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6500     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6501     MOVE CM-STATE               TO ERPDEF-STATE
  6502     if cm-clp-state not = cm-state and spaces and zeros
  6503        move cm-clp-state        to erpdef-state
  6504     end-if
  6505     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6506     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6507     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6508     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6509     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 114
* SOCK03.cbl
  6510
  6511* EXEC CICS STARTBR
  6512*        DATASET  ('ERPDEF')
  6513*        RIDFLD   (ERPDEF-KEY)
  6514*        GTEQ
  6515*        RESP     (WS-RESPONSE)
  6516*    END-EXEC
  6517     MOVE 'ERPDEF' TO DFHEIV1
  6518     MOVE 0
  6519       TO DFHEIV11
  6520*    MOVE '&,         G          &  N#00006014' TO DFHEIV0
  6521     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6522     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6523     MOVE X'204E233030303036303134' TO DFHEIV0(25:11)
  6524     CALL 'kxdfhei1' USING DFHEIV0,
  6525           DFHEIV1,
  6526           ERPDEF-KEY,
  6527           DFHEIV99,
  6528           DFHEIV11,
  6529           DFHEIV99
  6530     MOVE EIBRESP  TO WS-RESPONSE
  6531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6532     IF NOT RESP-NORMAL
  6533        GO TO 0730-EXIT
  6534     END-IF
  6535     .
  6536 0730-READNEXT.
  6537
  6538* EXEC CICS READNEXT
  6539*       DATASET  ('ERPDEF')
  6540*       INTO     (PRODUCT-MASTER)
  6541*       RIDFLD   (ERPDEF-KEY)
  6542*       RESP     (WS-RESPONSE)
  6543*    END-EXEC
  6544     MOVE LENGTH OF
  6545      PRODUCT-MASTER
  6546       TO DFHEIV12
  6547     MOVE 'ERPDEF' TO DFHEIV1
  6548     MOVE 0
  6549       TO DFHEIV11
  6550*    MOVE '&.IL                  )  N#00006025' TO DFHEIV0
  6551     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6552     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6553     MOVE X'204E233030303036303235' TO DFHEIV0(25:11)
  6554     CALL 'kxdfhei1' USING DFHEIV0,
  6555           DFHEIV1,
  6556           PRODUCT-MASTER,
  6557           DFHEIV12,
  6558           ERPDEF-KEY,
  6559           DFHEIV99,
  6560           DFHEIV11,
  6561           DFHEIV99,
  6562           DFHEIV99
  6563     MOVE EIBRESP  TO WS-RESPONSE
  6564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6565     IF NOT RESP-NORMAL
  6566        GO TO 0730-ENDBR
  6567     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 115
* SOCK03.cbl
  6568     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6569        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6570           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6571        ELSE
  6572           GO TO 0730-READNEXT
  6573        END-IF
  6574     ELSE
  6575        GO TO 0730-ENDBR
  6576     END-IF
  6577     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6578        (P1 > +8)
  6579        OR (PD-PROD-CODE (P1) = 'I')
  6580     END-PERFORM
  6581     IF P1 < +9
  6582        SET DD-IU-PRESENT        TO TRUE
  6583     END-IF
  6584     IF CM-LOAN-TERM = ZEROS
  6585        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  6586     END-IF
  6587     IF PD-TRUNCATED = 'Y'
  6588        MOVE CM-LOAN-TERM        TO WS-TERM
  6589     ELSE
  6590        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  6591     END-IF
  6592     EVALUATE TRUE
  6593        WHEN WS-TERM > +168
  6594           MOVE 15               TO P1
  6595        WHEN WS-TERM > +156
  6596           MOVE 14               TO P1
  6597        WHEN WS-TERM > +144
  6598           MOVE 13               TO P1
  6599        WHEN WS-TERM > +132
  6600           MOVE 12               TO P1
  6601        WHEN WS-TERM > +120
  6602           MOVE 11               TO P1
  6603        WHEN WS-TERM > +108
  6604           MOVE 10               TO P1
  6605        WHEN WS-TERM > +96
  6606           MOVE 9                TO P1
  6607        WHEN WS-TERM > +84
  6608           MOVE 8                TO P1
  6609        WHEN WS-TERM > +72
  6610           MOVE 7                TO P1
  6611        WHEN WS-TERM > +60
  6612           MOVE 6                TO P1
  6613        WHEN WS-TERM > +48
  6614           MOVE 5                TO P1
  6615        WHEN WS-TERM > +36
  6616           MOVE 4                TO P1
  6617        WHEN WS-TERM > +24
  6618           MOVE 3                TO P1
  6619        WHEN WS-TERM > +12
  6620           MOVE 2                TO P1
  6621        WHEN OTHER
  6622           MOVE 1                TO P1
  6623     END-EVALUATE
  6624     EVALUATE TRUE
  6625*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 116
* SOCK03.cbl
  6626*          AND (DD-IU-PRESENT)
  6627*          MOVE 2                TO P2
  6628*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  6629*          MOVE 1                TO P2
  6630        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  6631           MOVE 2                TO P2
  6632        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  6633           MOVE 3                TO P2
  6634        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  6635           MOVE 4                TO P2
  6636        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  6637           MOVE 5                TO P2
  6638        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  6639           MOVE 6                TO P2
  6640        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  6641           MOVE 7                TO P2
  6642        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  6643           MOVE 8                TO P2
  6644        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  6645           MOVE 9                TO P2
  6646        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  6647           MOVE 10               TO P2
  6648        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  6649           MOVE 11               TO P2
  6650        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  6651           MOVE 12               TO P2
  6652        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  6653           MOVE 13               TO P2
  6654        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  6655           MOVE 14               TO P2
  6656        WHEN OTHER
  6657           MOVE 15               TO P2
  6658     END-EVALUATE
  6659     .
  6660 0730-ENDBR.
  6661
  6662* EXEC CICS ENDBR
  6663*       DATASET  ('ERPDEF')
  6664*    END-EXEC
  6665     MOVE 'ERPDEF' TO DFHEIV1
  6666     MOVE 0
  6667       TO DFHEIV11
  6668*    MOVE '&2                    $   #00006127' TO DFHEIV0
  6669     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6670     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6671     MOVE X'2020233030303036313237' TO DFHEIV0(25:11)
  6672     CALL 'kxdfhei1' USING DFHEIV0,
  6673           DFHEIV1,
  6674           DFHEIV11,
  6675           DFHEIV99
  6676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6677     .
  6678 0730-EXIT.
  6679     EXIT.
  6680 0740-GET-ERCTBL.
  6681     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6682     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6683     MOVE 'A'                    TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 117
* SOCK03.cbl
  6684     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  6685     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6686     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6687     IF RESP-NORMAL
  6688        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6689     ELSE
  6690        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6691        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6692        MOVE 'A'                    TO CTBL-BEN-TYPE
  6693        MOVE 'AA'                   TO CTBL-BEN-CODE
  6694        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6695        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6696        IF RESP-NORMAL
  6697           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6698        END-IF
  6699     END-IF
  6700     .
  6701 0740-EXIT.
  6702     EXIT.
  6703 0750-READ-ERCTBL.
  6704
  6705* EXEC CICS READ
  6706*         INTO    (COMM-TABLE-RECORD)
  6707*         DATASET ('ERCTBL')
  6708*         RIDFLD  (CTBL-KEY)
  6709*         RESP    (WS-RESPONSE)
  6710*    END-EXEC
  6711     MOVE LENGTH OF
  6712      COMM-TABLE-RECORD
  6713       TO DFHEIV11
  6714     MOVE 'ERCTBL' TO DFHEIV1
  6715*    MOVE '&"IL       E          (  N#00006157' TO DFHEIV0
  6716     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6718     MOVE X'204E233030303036313537' TO DFHEIV0(25:11)
  6719     CALL 'kxdfhei1' USING DFHEIV0,
  6720           DFHEIV1,
  6721           COMM-TABLE-RECORD,
  6722           DFHEIV11,
  6723           CTBL-KEY,
  6724           DFHEIV99,
  6725           DFHEIV99,
  6726           DFHEIV99
  6727     MOVE EIBRESP  TO WS-RESPONSE
  6728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6729     .
  6730 0750-EXIT.
  6731     EXIT.
  6732 0760-FIND-COMM.
  6733     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  6734        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  6735        OR (C1 > +3)
  6736     END-PERFORM
  6737     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  6738        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  6739        OR (C2 > +3)
  6740     END-PERFORM
  6741     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 118
* SOCK03.cbl
  6742        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  6743        OR (C3 > +3)
  6744     END-PERFORM
  6745     IF C1 > +3
  6746        MOVE +1                  TO C1
  6747     END-IF
  6748     IF C2 > +3
  6749        MOVE +1                  TO C2
  6750     END-IF
  6751     IF C3 > +3
  6752        MOVE +1                  TO C3
  6753     END-IF
  6754     IF C1 = +3
  6755        MOVE +18                 TO C0
  6756     ELSE
  6757        IF C1 = +2
  6758           MOVE +9               TO C0
  6759        END-IF
  6760     END-IF
  6761     IF C2 = +3
  6762        ADD +6                   TO C0
  6763     ELSE
  6764        IF C2 = +2
  6765           ADD +3                TO C0
  6766        END-IF
  6767     END-IF
  6768     ADD C3                      TO C0
  6769     MOVE CT-RT (C0)             TO WS-COMM-PCT
  6770     .
  6771 0760-EXIT.
  6772     EXIT.
  6773 9700-DATE-LINK.
  6774
  6775* EXEC CICS LINK
  6776*         PROGRAM  ('ELDATCV')
  6777*         COMMAREA (DATE-CONVERSION-DATA)
  6778*         LENGTH   (DC-COMM-LENGTH)
  6779*    END-EXEC.
  6780     MOVE 'ELDATCV' TO DFHEIV1
  6781*    MOVE '."C                   (   #00006208' TO DFHEIV0
  6782     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6784     MOVE X'2020233030303036323038' TO DFHEIV0(25:11)
  6785     CALL 'kxdfhei1' USING DFHEIV0,
  6786           DFHEIV1,
  6787           DATE-CONVERSION-DATA,
  6788           DC-COMM-LENGTH,
  6789           DFHEIV99,
  6790           DFHEIV99,
  6791           DFHEIV99,
  6792           DFHEIV99
  6793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6794
  6795 9700-EXIT.
  6796      EXIT.
  6797
  6798 9999-DFHBACK SECTION.
  6799     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 14:42 Page 119
* SOCK03.cbl
  6800     MOVE 'SOCK03' TO DFHEIV1
  6801     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6802     GOBACK.
  6803 9999-DFHEXIT.
  6804     IF DFHEIGDJ EQUAL 0001
  6805         NEXT SENTENCE.
  6806     MOVE '9%                    "   ' TO DFHEIV0
  6807     MOVE 'SOCK03' TO DFHEIV1
  6808     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6809     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18960     Code:       28517
