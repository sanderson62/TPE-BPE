* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6504.cbl
* Options: int("EL6504.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6504.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6504.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6504.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6504.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 08:07:16.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6504.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*                                                                *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23*
    24*REMARKS.    TRANSACTION - EXC8 - ACCOUNT MAINT (REIN & COMM).
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    35******************************************************************
    36
    37 ENVIRONMENT DIVISION.
    38
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6504.cbl
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*    EL6504 WORKING STORAGE    *'.
    45 77  FILLER  PIC X(32)  VALUE '************ V/M 2.011 *********'.
    46
    47 01  WS-DATE-AREA.
    48     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    49     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    50
    51 01  STANDARD-AREAS.
    52     12  WS-YYYYMMDD             PIC X(8).
    53     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
    54                                 PIC 9(8).
    55     12  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    56     12  MAP-NAME                    PIC X(8)    VALUE 'EL6504A'.
    57     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL6504S'.
    58     12  SCREEN-NUMBER               PIC X(4)    VALUE '650E'.
    59     12  TRANS-ID                    PIC X(4)    VALUE 'EXC8'.
    60     12  THIS-PGM                    PIC X(8)    VALUE 'EL6504'.
    61     12  PGM-NAME                    PIC X(8)    VALUE SPACES.
    62     12  TIME-IN                     PIC S9(7)   VALUE ZEROS.
    63     12  TIME-OUT-R  REDEFINES TIME-IN.
    64         16  FILLER                  PIC X.
    65         16  TIME-OUT                PIC 99V99.
    66         16  FILLER                  PIC XX.
    67     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
    68     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
    69     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
    70     12  XCTL-650                    PIC X(8)    VALUE 'EL650'.
    71     12  XCTL-6501                   PIC X(8)    VALUE 'EL6501'.
    72     12  XCTL-6502                   PIC X(8)    VALUE 'EL6502'.
    73     12  XCTL-6503                   PIC X(8)    VALUE 'EL6503'.
    74     12  XCTL-6505                   PIC X(8)    VALUE 'EL6505'.
    75     12  XCTL-6506                   PIC X(8)    VALUE 'EL6506'.
    76     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
    77     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
    78     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
    79     12  FILE-ID                     PIC X(8)    VALUE SPACES.
    80     12  ERACCT-FILE                 PIC X(8)    VALUE 'ERACCT'.
    81     12  CNTL-FILE-ID                PIC X(8)    VALUE 'ELCNTL'.
    82     12  BIN-CURRENT-SAVE            PIC XX      VALUE SPACES.
    83     12  YMD-CURRENT-SAVE            PIC X(6)    VALUE SPACES.
    84
    85     12  ERACCT-LENGTH               PIC S9(4)   VALUE +2023 COMP.
    86     12  SC-ITEM                     PIC S9(4)   VALUE +1    COMP.
    87     12  ELCNTL-LENGTH               PIC S9(4)   VALUE +527  COMP.
    88     12  WS-JOURNAL-FILE-LENGTH      PIC S9(4)   VALUE +0    COMP.
    89     12  SUB1                        PIC S9(4)   VALUE +0    COMP.
    90     12  SUB2                        PIC S9(4)   VALUE +0    COMP.
    91
    92     12  DEEDIT-FIELD                PIC X(15).
    93     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
    94     12  DEEDIT-FIELD-V3  REDEFINES DEEDIT-FIELD PIC S9(12)V999.
    95     12  DEEDIT-FIELD-V4  REDEFINES DEEDIT-FIELD PIC S9(11)V9999.
    96
    97     12  WS-EDIT-FIELD-CONV          PIC S9(4)   VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6504.cbl
    98     12  WS-TOT-PERCENT              PIC S9V9999 VALUE +0.
    99
   100     12  WS-VALID-EARNINGS           PIC X       VALUE SPACE.
   101         88  VALID-EARNINGS                      VALUE ' ' 'R' 'P'
   102                                                      'A' 'C' 'M'.
   103
   104     12  WS-LF-FEE                   PIC S9V9999 VALUE ZEROS.
   105     12  WS-LF-TAX                   PIC S9V9999 VALUE ZEROS.
   106     12  WS-AH-FEE                   PIC S9V9999 VALUE ZEROS.
   107     12  WS-AH-TAX                   PIC S9V9999 VALUE ZEROS.
   108     12  WS-AH-R78                   PIC S9V9999 VALUE ZEROS.
   109     12  WS-AH-PRATA                 PIC S9V9999 VALUE ZEROS.
   110     12  WS-LF-RET                   PIC S9V9999 VALUE ZEROS.
   111     12  WS-AH-RET                   PIC S9V9999 VALUE ZEROS.
   112     12  WS-LF-LOSS                  PIC SV999   VALUE ZEROS.
   113     12  WS-AH-LOSS                  PIC SV999   VALUE ZEROS.
   114     12  WS-LF-PCT-1                 PIC S9V9999 VALUE ZEROS.
   115     12  WS-LF-PCT-2                 PIC S9V9999 VALUE ZEROS.
   116     12  WS-LF-PCT-3                 PIC S9V9999 VALUE ZEROS.
   117     12  WS-AH-PCT-1                 PIC S9V9999 VALUE ZEROS.
   118     12  WS-AH-PCT-2                 PIC S9V9999 VALUE ZEROS.
   119     12  WS-AH-PCT-3                 PIC S9V9999 VALUE ZEROS.
   120     12  WS-LF-THRU-1                PIC S9(7)   VALUE ZEROS.
   121     12  WS-LF-THRU-2                PIC S9(7)   VALUE ZEROS.
   122     12  WS-LF-THRU-3                PIC S9(7)   VALUE ZEROS.
   123     12  WS-AH-THRU-1                PIC S9(7)   VALUE ZEROS.
   124     12  WS-AH-THRU-2                PIC S9(7)   VALUE ZEROS.
   125     12  WS-AH-THRU-3                PIC S9(7)   VALUE ZEROS.
   126     12  WS-QUALIFY-LIMIT            PIC S9(7)   VALUE ZEROS.
   127
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6504.cbl
   129     12  ERROR-MESSAGES.
   130         16  ER-0000                 PIC X(4)    VALUE '0000'.
   131         16  ER-0002                 PIC X(4)    VALUE '0002'.
   132         16  ER-0004                 PIC X(4)    VALUE '0004'.
   133         16  ER-0008                 PIC X(4)    VALUE '0008'.
   134         16  ER-0029                 PIC X(4)    VALUE '0029'.
   135         16  ER-0068                 PIC X(4)    VALUE '0068'.
   136         16  ER-0070                 PIC X(4)    VALUE '0070'.
   137         16  ER-0620                 PIC X(4)    VALUE '0620'.
   138         16  ER-0621                 PIC X(4)    VALUE '0621'.
   139         16  ER-0626                 PIC X(4)    VALUE '0626'.
   140         16  ER-2039                 PIC X(4)    VALUE '2039'.
   141         16  ER-2081                 PIC X(4)    VALUE '2081'.
   142         16  ER-2082                 PIC X(4)    VALUE '2082'.
   143         16  ER-2083                 PIC X(4)    VALUE '2083'.
   144         16  ER-2084                 PIC X(4)    VALUE '2084'.
   145         16  ER-2085                 PIC X(4)    VALUE '2085'.
   146         16  ER-2086                 PIC X(4)    VALUE '2086'.
   147         16  ER-2098                 PIC X(4)    VALUE '2098'.
   148         16  ER-2099                 PIC X(4)    VALUE '2099'.
   149         16  ER-2100                 PIC X(4)    VALUE '2100'.
   150         16  ER-2101                 PIC X(4)    VALUE '2101'.
   151         16  ER-2102                 PIC X(4)    VALUE '2102'.
   152         16  ER-2103                 PIC X(4)    VALUE '2103'.
   153         16  ER-2161                 PIC X(4)    VALUE '2161'.
   154         16  ER-2162                 PIC X(4)    VALUE '2162'.
   155         16  ER-2163                 PIC X(4)    VALUE '2163'.
   156         16  ER-2164                 PIC X(4)    VALUE '2164'.
   157         16  ER-2165                 PIC X(4)    VALUE '2165'.
   158         16  ER-2171                 PIC X(4)    VALUE '2171'.
   159         16  ER-2572                 PIC X(4)    VALUE '2572'.
   160
   161     12  ELCNTL-KEY.
   162         16  CNTL-COMP-ID            PIC X(3)    VALUE SPACES.
   163         16  CNTL-REC-TYPE           PIC X       VALUE SPACES.
   164         16  CNTL-ACCESS             PIC X(4)    VALUE SPACES.
   165         16  CNTL-SEQ-NO             PIC S9(4)   VALUE +0  COMP.
   166
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6504.cbl
   168*                          COPY ELCSCTM.
   169******************************************************************
   170*                                                                *
   171*                                                                *
   172*                            ELCSCTM                             *
   173*                            VMOD=2.001                          *
   174*                                                                *
   175*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   176*                                                                *
   177******************************************************************
   178 01  SECURITY-MESSAGE.
   179     12  FILLER                          PIC X(30)
   180            VALUE '** LOGIC SECURITY VIOLATION -'.
   181     12  SM-READ                         PIC X(6).
   182     12  FILLER                          PIC X(5)
   183            VALUE ' PGM='.
   184     12  SM-PGM                          PIC X(6).
   185     12  FILLER                          PIC X(5)
   186            VALUE ' OPR='.
   187     12  SM-PROCESSOR-ID                 PIC X(4).
   188     12  FILLER                          PIC X(6)
   189            VALUE ' TERM='.
   190     12  SM-TERMID                       PIC X(4).
   191     12  FILLER                          PIC XX   VALUE SPACE.
   192     12  SM-JUL-DATE                     PIC 9(5).
   193     12  FILLER                          PIC X    VALUE SPACE.
   194     12  SM-TIME                         PIC 99.99.
   195
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6504.cbl
   197*                          COPY ELCSCRTY.
   198******************************************************************
   199*                                                                *
   200*                                                                *
   201*                            ELCSCRTY                            *
   202*                            VMOD=2.001                          *
   203*                                                                *
   204*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   205*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   206*        SAVED IN PI-SECURITY-ADDRESS.                           *
   207*                                                                *
   208******************************************************************
   209 01  SECURITY-CONTROL.
   210     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   211     12  FILLER                       PIC XX    VALUE 'SC'.
   212     12  SC-CREDIT-CODES.
   213         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   214             20  SC-CREDIT-DISPLAY    PIC X.
   215             20  SC-CREDIT-UPDATE     PIC X.
   216     12  SC-CLAIMS-CODES.
   217         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   218             20  SC-CLAIMS-DISPLAY    PIC X.
   219             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6504.cbl
   221*                          COPY ELCLOGOF.
   222******************************************************************
   223*                                                                *
   224*                                                                *
   225*                            ELCLOGOF.                           *
   226*                            VMOD=2.001                          *
   227*                                                                *
   228*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   229*                                                                *
   230******************************************************************
   231 01  CLASIC-LOGOFF.
   232     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   233     12  LOGOFF-TEXT.
   234         16  FILLER          PIC X(5)    VALUE SPACES.
   235         16  LOGOFF-MSG.
   236             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   237             20  FILLER      PIC X       VALUE SPACES.
   238             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   239         16  FILLER          PIC X(80)
   240           VALUE '* YOU ARE NOW LOGGED OFF'.
   241         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   242         16  FILLER          PIC X       VALUE QUOTE.
   243         16  LOGOFF-SYS-MSG  PIC X(17)
   244           VALUE 'S CLAS-IC SYSTEM '.
   245     12  TEXT-MESSAGES.
   246         16  UNACCESS-MSG    PIC X(29)
   247             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   248         16  PGMIDERR-MSG    PIC X(17)
   249             VALUE 'PROGRAM NOT FOUND'.
   250
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6504.cbl
   252*                          COPY ELCDATE.
   253******************************************************************
   254*                                                                *
   255*                                                                *
   256*                            ELCDATE.                            *
   257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   258*                            VMOD=2.003
   259*                                                                *
   260*                                                                *
   261*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   262*                 LENGTH = 200                                   *
   263******************************************************************
   264
   265 01  DATE-CONVERSION-DATA.
   266     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   267     12  DC-OPTION-CODE                PIC X.
   268         88  BIN-TO-GREG                VALUE ' '.
   269         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   270         88  EDIT-GREG-TO-BIN           VALUE '2'.
   271         88  YMD-GREG-TO-BIN            VALUE '3'.
   272         88  MDY-GREG-TO-BIN            VALUE '4'.
   273         88  JULIAN-TO-BIN              VALUE '5'.
   274         88  BIN-PLUS-ELAPSED           VALUE '6'.
   275         88  FIND-CENTURY               VALUE '7'.
   276         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   277         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   278         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   279         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   280         88  JULIAN-TO-BIN-3            VALUE 'C'.
   281         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   282         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   283         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   284         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   285         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   286         88  CHECK-LEAP-YEAR            VALUE 'H'.
   287         88  BIN-3-TO-GREG              VALUE 'I'.
   288         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   289         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   290         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   291         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   292         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   293         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   294         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   295         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   296         88  THREE-CHARACTER-BIN
   297                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   298         88  GREGORIAN-TO-BIN
   299                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   300         88  BIN-TO-GREGORIAN
   301                  VALUES ' ' '1' 'I' '8' 'G'.
   302         88  JULIAN-TO-BINARY
   303                  VALUES '5' 'C' 'E' 'F'.
   304     12  DC-ERROR-CODE                 PIC X.
   305         88  NO-CONVERSION-ERROR        VALUE ' '.
   306         88  DATE-CONVERSION-ERROR
   307                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   308         88  DATE-IS-ZERO               VALUE '1'.
   309         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6504.cbl
   310         88  DATE-IS-INVALID            VALUE '3'.
   311         88  DATE1-GREATER-DATE2        VALUE '4'.
   312         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   313         88  DATE-INVALID-OPTION        VALUE '9'.
   314         88  INVALID-CENTURY            VALUE 'A'.
   315         88  ONLY-CENTURY               VALUE 'B'.
   316         88  ONLY-LEAP-YEAR             VALUE 'C'.
   317         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   318     12  DC-END-OF-MONTH               PIC X.
   319         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   320     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   321         88  USE-NORMAL-PROCESS         VALUE ' '.
   322         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   323         88  ADJUST-UP-100-YRS          VALUE '2'.
   324     12  FILLER                        PIC X.
   325     12  DC-CONVERSION-DATES.
   326         16  DC-BIN-DATE-1             PIC XX.
   327         16  DC-BIN-DATE-2             PIC XX.
   328         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   329         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   330                       DC-GREG-DATE-1-EDIT.
   331             20  DC-EDIT1-MONTH        PIC 99.
   332             20  SLASH1-1              PIC X.
   333             20  DC-EDIT1-DAY          PIC 99.
   334             20  SLASH1-2              PIC X.
   335             20  DC-EDIT1-YEAR         PIC 99.
   336         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   337         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   338                     DC-GREG-DATE-2-EDIT.
   339             20  DC-EDIT2-MONTH        PIC 99.
   340             20  SLASH2-1              PIC X.
   341             20  DC-EDIT2-DAY          PIC 99.
   342             20  SLASH2-2              PIC X.
   343             20  DC-EDIT2-YEAR         PIC 99.
   344         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   345         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   346                     DC-GREG-DATE-1-YMD.
   347             20  DC-YMD-YEAR           PIC 99.
   348             20  DC-YMD-MONTH          PIC 99.
   349             20  DC-YMD-DAY            PIC 99.
   350         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   351         16  DC-GREG-DATE-1-MDY-R REDEFINES
   352                      DC-GREG-DATE-1-MDY.
   353             20  DC-MDY-MONTH          PIC 99.
   354             20  DC-MDY-DAY            PIC 99.
   355             20  DC-MDY-YEAR           PIC 99.
   356         16  DC-GREG-DATE-1-ALPHA.
   357             20  DC-ALPHA-MONTH        PIC X(10).
   358             20  DC-ALPHA-DAY          PIC 99.
   359             20  FILLER                PIC XX.
   360             20  DC-ALPHA-CENTURY.
   361                 24 DC-ALPHA-CEN-N     PIC 99.
   362             20  DC-ALPHA-YEAR         PIC 99.
   363         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   364         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   365         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   366         16  DC-JULIAN-DATE            PIC 9(05).
   367         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6504.cbl
   368                                       PIC 9(05).
   369         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   370             20  DC-JULIAN-YEAR        PIC 99.
   371             20  DC-JULIAN-DAYS        PIC 999.
   372         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   373         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   374         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   375     12  DATE-CONVERSION-VARIBLES.
   376         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   377         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   378             20  FILLER                PIC 9(3).
   379             20  HOLD-CEN-1-CCYY.
   380                 24  HOLD-CEN-1-CC     PIC 99.
   381                 24  HOLD-CEN-1-YY     PIC 99.
   382             20  HOLD-CEN-1-MO         PIC 99.
   383             20  HOLD-CEN-1-DA         PIC 99.
   384         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   385             20  HOLD-CEN-1-R-MO       PIC 99.
   386             20  HOLD-CEN-1-R-DA       PIC 99.
   387             20  HOLD-CEN-1-R-CCYY.
   388                 24  HOLD-CEN-1-R-CC   PIC 99.
   389                 24  HOLD-CEN-1-R-YY   PIC 99.
   390             20  FILLER                PIC 9(3).
   391         16  HOLD-CENTURY-1-X.
   392             20  FILLER                PIC X(3)  VALUE SPACES.
   393             20  HOLD-CEN-1-X-CCYY.
   394                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   395                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   396             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   397             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   398         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   399             20  HOLD-CEN-1-R-X-MO     PIC XX.
   400             20  HOLD-CEN-1-R-X-DA     PIC XX.
   401             20  HOLD-CEN-1-R-X-CCYY.
   402                 24  HOLD-CEN-1-R-X-CC PIC XX.
   403                 24  HOLD-CEN-1-R-X-YY PIC XX.
   404             20  FILLER                PIC XXX.
   405         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   406         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   407         16  DC-JULIAN-DATE-1          PIC 9(07).
   408         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   409             20  DC-JULIAN-1-CCYY.
   410                 24  DC-JULIAN-1-CC    PIC 99.
   411                 24  DC-JULIAN-1-YR    PIC 99.
   412             20  DC-JULIAN-DA-1        PIC 999.
   413         16  DC-JULIAN-DATE-2          PIC 9(07).
   414         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   415             20  DC-JULIAN-2-CCYY.
   416                 24  DC-JULIAN-2-CC    PIC 99.
   417                 24  DC-JULIAN-2-YR    PIC 99.
   418             20  DC-JULIAN-DA-2        PIC 999.
   419         16  DC-GREG-DATE-A-EDIT.
   420             20  DC-EDITA-MONTH        PIC 99.
   421             20  SLASHA-1              PIC X VALUE '/'.
   422             20  DC-EDITA-DAY          PIC 99.
   423             20  SLASHA-2              PIC X VALUE '/'.
   424             20  DC-EDITA-CCYY.
   425                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6504.cbl
   426                 24  DC-EDITA-YEAR     PIC 99.
   427         16  DC-GREG-DATE-B-EDIT.
   428             20  DC-EDITB-MONTH        PIC 99.
   429             20  SLASHB-1              PIC X VALUE '/'.
   430             20  DC-EDITB-DAY          PIC 99.
   431             20  SLASHB-2              PIC X VALUE '/'.
   432             20  DC-EDITB-CCYY.
   433                 24  DC-EDITB-CENT     PIC 99.
   434                 24  DC-EDITB-YEAR     PIC 99.
   435         16  DC-GREG-DATE-CYMD         PIC 9(08).
   436         16  DC-GREG-DATE-CYMD-R REDEFINES
   437                              DC-GREG-DATE-CYMD.
   438             20  DC-CYMD-CEN           PIC 99.
   439             20  DC-CYMD-YEAR          PIC 99.
   440             20  DC-CYMD-MONTH         PIC 99.
   441             20  DC-CYMD-DAY           PIC 99.
   442         16  DC-GREG-DATE-MDCY         PIC 9(08).
   443         16  DC-GREG-DATE-MDCY-R REDEFINES
   444                              DC-GREG-DATE-MDCY.
   445             20  DC-MDCY-MONTH         PIC 99.
   446             20  DC-MDCY-DAY           PIC 99.
   447             20  DC-MDCY-CEN           PIC 99.
   448             20  DC-MDCY-YEAR          PIC 99.
   449    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   450        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   451    12  DC-EL310-DATE                  PIC X(21).
   452    12  FILLER                         PIC X(28).
   453
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6504.cbl
   455*                          COPY ELCATTR.
   456******************************************************************
   457*                                                                *
   458*                            ELCATTR.                            *
   459*                            VMOD=2.001                          *
   460*                                                                *
   461*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   462*                                                                *
   463*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   464*                                                                *
   465*                   POS 1   P=PROTECTED                          *
   466*                           U=UNPROTECTED                        *
   467*                           S=ASKIP                              *
   468*                   POS 2   A=ALPHA/NUMERIC                      *
   469*                           N=NUMERIC                            *
   470*                   POS 3   N=NORMAL                             *
   471*                           B=BRIGHT                             *
   472*                           D=DARK                               *
   473*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   474*                           OF=MODIFIED DATA TAG OFF             *
   475*                                                                *
   476*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   477******************************************************************
   478 01  ATTRIBUTE-LIST.
   479     12  AL-PABOF            PIC X       VALUE 'Y'.
   480     12  AL-PABON            PIC X       VALUE 'Z'.
   481     12  AL-PADOF            PIC X       VALUE '%'.
   482     12  AL-PADON            PIC X       VALUE '_'.
   483     12  AL-PANOF            PIC X       VALUE '-'.
   484     12  AL-PANON            PIC X       VALUE '/'.
   485     12  AL-SABOF            PIC X       VALUE '8'.
   486     12  AL-SABON            PIC X       VALUE '9'.
   487     12  AL-SADOF            PIC X       VALUE '@'.
   488     12  AL-SADON            PIC X       VALUE QUOTE.
   489     12  AL-SANOF            PIC X       VALUE '0'.
   490     12  AL-SANON            PIC X       VALUE '1'.
   491     12  AL-UABOF            PIC X       VALUE 'H'.
   492     12  AL-UABON            PIC X       VALUE 'I'.
   493     12  AL-UADOF            PIC X       VALUE '<'.
   494     12  AL-UADON            PIC X       VALUE '('.
   495     12  AL-UANOF            PIC X       VALUE ' '.
   496     12  AL-UANON            PIC X       VALUE 'A'.
   497     12  AL-UNBOF            PIC X       VALUE 'Q'.
   498     12  AL-UNBON            PIC X       VALUE 'R'.
   499     12  AL-UNDOF            PIC X       VALUE '*'.
   500     12  AL-UNDON            PIC X       VALUE ')'.
   501     12  AL-UNNOF            PIC X       VALUE '&'.
   502     12  AL-UNNON            PIC X       VALUE 'J'.
   503
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6504.cbl
   505*                          COPY ELCEMIB.
   506******************************************************************
   507*                                                                *
   508*                                                                *
   509*                            ELCEMIB.                            *
   510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   511*                            VMOD=2.005                          *
   512*                                                                *
   513*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   514*                                                                *
   515******************************************************************
   516 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   517     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   518     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   519     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   520     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   521     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   522     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   523     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   524     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   525     12  EMI-SWITCH1             PIC X        VALUE '1'.
   526         88  EMI-NO-ERRORS                    VALUE '1'.
   527         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   528         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   529     12  EMI-SWITCH2             PIC X        VALUE '1'.
   530         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   531     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   532         88  EMI-AREA1-EMPTY                  VALUE '1'.
   533         88  EMI-AREA1-FULL                   VALUE '2'.
   534     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   535         88  EMI-AREA2-EMPTY                  VALUE '1'.
   536         88  EMI-AREA2-FULL                   VALUE '2'.
   537     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   538         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   539         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   540         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   541         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   542         88  EMI-BYPASS-FATALS                VALUE 'X'.
   543     12  EMI-ERROR-LINES.
   544         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   545         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   546         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   547         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   548             20  EMI-ERR-CODES OCCURS 10 TIMES.
   549                 24  EMI-ERR-NUM         PIC X(4).
   550                 24  EMI-FILLER          PIC X.
   551                 24  EMI-SEV             PIC X.
   552                 24  FILLER              PIC X.
   553             20  FILLER                  PIC X(02).
   554     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   555         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   556             20  EMI-ERROR-NUMBER    PIC X(4).
   557             20  EMI-FILL            PIC X.
   558             20  EMI-SEVERITY        PIC X.
   559             20  FILLER              PIC X.
   560             20  EMI-ERROR-TEXT.
   561                 24  EMI-TEXT-VARIABLE   PIC X(10).
   562                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6504.cbl
   563     12  EMI-SEVERITY-SAVE           PIC X.
   564         88  EMI-NOTE                    VALUE 'N'.
   565         88  EMI-WARNING                 VALUE 'W'.
   566         88  EMI-FORCABLE                VALUE 'F'.
   567         88  EMI-FATAL                   VALUE 'X'.
   568     12  EMI-MESSAGE-FLAG            PIC X.
   569         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   570         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   571     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   572     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   573         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   574         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   575         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   576     12  FILLER                      PIC X(137)  VALUE SPACES.
   577     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   578     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   579     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   580     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   581
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6504.cbl
   583*                          COPY ELCINTF.
   584******************************************************************
   585*                                                                *
   586*                                                                *
   587*                            ELCINTF.                            *
   588*                            VMOD=2.017                          *
   589*                                                                *
   590*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   591*                                                                *
   592*       LENGTH = 1024                                            *
   593*                                                                *
   594******************************************************************
   595 01  PROGRAM-INTERFACE-BLOCK.
   596     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   597     12  PI-CALLING-PROGRAM              PIC X(8).
   598     12  PI-SAVED-PROGRAM-1              PIC X(8).
   599     12  PI-SAVED-PROGRAM-2              PIC X(8).
   600     12  PI-SAVED-PROGRAM-3              PIC X(8).
   601     12  PI-SAVED-PROGRAM-4              PIC X(8).
   602     12  PI-SAVED-PROGRAM-5              PIC X(8).
   603     12  PI-SAVED-PROGRAM-6              PIC X(8).
   604     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   605     12  PI-COMPANY-ID                   PIC XXX.
   606     12  PI-COMPANY-CD                   PIC X.
   607
   608     12  PI-COMPANY-PASSWORD             PIC X(8).
   609
   610     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   611
   612     12  PI-CONTROL-IN-PROGRESS.
   613         16  PI-CARRIER                  PIC X.
   614         16  PI-GROUPING                 PIC X(6).
   615         16  PI-STATE                    PIC XX.
   616         16  PI-ACCOUNT                  PIC X(10).
   617         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   618                                         PIC X(10).
   619         16  PI-CLAIM-CERT-GRP.
   620             20  PI-CLAIM-NO             PIC X(7).
   621             20  PI-CERT-NO.
   622                 25  PI-CERT-PRIME       PIC X(10).
   623                 25  PI-CERT-SFX         PIC X.
   624             20  PI-CERT-EFF-DT          PIC XX.
   625         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   626             20  PI-PLAN-CODE            PIC X(2).
   627             20  PI-REVISION-NUMBER      PIC X(3).
   628             20  PI-PLAN-EFF-DT          PIC X(2).
   629             20  PI-PLAN-EXP-DT          PIC X(2).
   630             20  FILLER                  PIC X(11).
   631         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   632             20  PI-OE-REFERENCE-1.
   633                 25  PI-OE-REF-1-PRIME   PIC X(18).
   634                 25  PI-OE-REF-1-SUFF    PIC XX.
   635
   636     12  PI-SESSION-IN-PROGRESS          PIC X.
   637         88  CLAIM-SESSION                   VALUE '1'.
   638         88  CREDIT-SESSION                  VALUE '2'.
   639         88  WARRANTY-SESSION                VALUE '3'.
   640         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6504.cbl
   641         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   642
   643
   644*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   645
   646     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   647     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   648
   649     12  PI-CREDIT-USER                  PIC X.
   650         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   651         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   652
   653     12  PI-CLAIM-USER                   PIC X.
   654         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   655         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   656
   657     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   658         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   659         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   660         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   661         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   662         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   663
   664     12  PI-PROCESSOR-ID                 PIC X(4).
   665
   666     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   667
   668     12  PI-MEMBER-CAPTION               PIC X(10).
   669
   670     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   671         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   672
   673     12  PI-LIFE-OVERRIDE-L1             PIC X.
   674     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   675     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   676     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   677
   678     12  PI-AH-OVERRIDE-L1               PIC X.
   679     12  PI-AH-OVERRIDE-L2               PIC XX.
   680     12  PI-AH-OVERRIDE-L6               PIC X(6).
   681     12  PI-AH-OVERRIDE-L12              PIC X(12).
   682
   683     12  PI-NEW-SYSTEM                   PIC X(2).
   684
   685     12  PI-PRIMARY-CERT-NO              PIC X(11).
   686     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   687         88  PI-USES-PAID-TO                 VALUE '1'.
   688     12  PI-CRDTCRD-SYSTEM.
   689         16  PI-CRDTCRD-USER             PIC X.
   690             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   691             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   692         16  PI-CC-MONTH-END-DT          PIC XX.
   693     12  PI-PROCESSOR-PRINTER            PIC X(4).
   694
   695     12  PI-OE-REFERENCE-2.
   696         16  PI-OE-REF-2-PRIME           PIC X(10).
   697         16  PI-OE-REF-2-SUFF            PIC X.
   698
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6504.cbl
   699     12  PI-REM-TRM-CALC-OPTION          PIC X.
   700
   701     12  PI-LANGUAGE-TYPE                PIC X.
   702             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   703             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   704             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   705
   706     12  PI-POLICY-LINKAGE-IND           PIC X.
   707         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   708         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   709                                                   LOW-VALUES.
   710
   711     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   712     12  PI-CLAIM-PW-SESSION             PIC X(1).
   713         88  PI-CLAIM-CREDIT                 VALUE '1'.
   714         88  PI-CLAIM-CONVEN                 VALUE '2'.
   715     12  FILLER                          PIC X(4).
   716
   717     12  PI-SYSTEM-LEVEL                 PIC X(145).
   718
   719     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   720         PI-SYSTEM-LEVEL.
   721
   722         16  PI-ENTRY-CODES.
   723             20  PI-ENTRY-CD-1           PIC X.
   724             20  PI-ENTRY-CD-2           PIC X.
   725
   726         16  PI-RETURN-CODES.
   727             20  PI-RETURN-CD-1          PIC X.
   728             20  PI-RETURN-CD-2          PIC X.
   729
   730         16  PI-UPDATE-STATUS-SAVE.
   731             20  PI-UPDATE-BY            PIC X(4).
   732             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   733
   734         16  PI-LOWER-CASE-LETTERS       PIC X.
   735             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   736
   737*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   738*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   739*            88  CARRIER-CLM-CNTL            VALUE '2'.
   740
   741         16  PI-CERT-ACCESS-CONTROL      PIC X.
   742             88  ST-ACCNT-CNTL               VALUE ' '.
   743             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   744             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   745             88  ACCNT-CNTL                  VALUE '3'.
   746             88  CARR-ACCNT-CNTL             VALUE '4'.
   747
   748         16  PI-PROCESSOR-CAP-LIST.
   749             20  PI-SYSTEM-CONTROLS.
   750                24 PI-SYSTEM-DISPLAY     PIC X.
   751                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   752                24 PI-SYSTEM-MODIFY      PIC X.
   753                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   754             20  FILLER                  PIC XX.
   755             20  PI-DISPLAY-CAP          PIC X.
   756                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6504.cbl
   757             20  PI-MODIFY-CAP           PIC X.
   758                 88  MODIFY-CAP              VALUE 'Y'.
   759             20  PI-MSG-AT-LOGON-CAP     PIC X.
   760                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   761             20  PI-FORCE-CAP            PIC X.
   762                 88  FORCE-CAP               VALUE 'Y'.
   763
   764         16  PI-PROGRAM-CONTROLS.
   765             20  PI-PGM-PRINT-OPT        PIC X.
   766             20  PI-PGM-FORMAT-OPT       PIC X.
   767             20  PI-PGM-PROCESS-OPT      PIC X.
   768             20  PI-PGM-TOTALS-OPT       PIC X.
   769
   770         16  PI-HELP-INTERFACE.
   771             20  PI-LAST-ERROR-NO        PIC X(4).
   772             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   773
   774         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   775             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   776
   777         16  PI-CR-CONTROL-IN-PROGRESS.
   778             20  PI-CR-CARRIER           PIC X.
   779             20  PI-CR-GROUPING          PIC X(6).
   780             20  PI-CR-STATE             PIC XX.
   781             20  PI-CR-ACCOUNT           PIC X(10).
   782             20  PI-CR-FIN-RESP          PIC X(10).
   783             20  PI-CR-TYPE              PIC X.
   784
   785         16  PI-CR-BATCH-NUMBER          PIC X(6).
   786
   787         16  PI-CR-MONTH-END-DT          PIC XX.
   788
   789         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   790             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   791             88  PI-ZERO-CARRIER             VALUE '1'.
   792             88  PI-ZERO-GROUPING            VALUE '2'.
   793             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   794
   795         16  PI-CARRIER-SECURITY         PIC X.
   796             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   797
   798         16  PI-ACCOUNT-SECURITY         PIC X(10).
   799             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   800             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   801
   802         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   803             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   804                                         INDEXED BY PI-ACCESS-NDX
   805                                         PIC X.
   806
   807         16  PI-GA-BILLING-CONTROL       PIC X.
   808             88  PI-GA-BILLING               VALUE '1'.
   809
   810         16  PI-MAIL-PROCESSING          PIC X.
   811             88  PI-MAIL-YES                 VALUE 'Y'.
   812
   813         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   814
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6504.cbl
   815         16  PI-AR-SYSTEM.
   816             20  PI-AR-PROCESSING-CNTL   PIC X.
   817                 88  PI-AR-PROCESSING        VALUE 'Y'.
   818             20  PI-AR-SUMMARY-CODE      PIC X(6).
   819             20  PI-AR-MONTH-END-DT      PIC XX.
   820
   821         16  PI-MP-SYSTEM.
   822             20  PI-MORTGAGE-USER            PIC X.
   823                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   824                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   825             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   826                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   827                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   828                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   829                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   830                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   831             20  PI-MP-MONTH-END-DT          PIC XX.
   832             20  PI-MP-REFERENCE-NO.
   833                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   834                 24  PI-MP-REFERENCE-SFX     PIC XX.
   835
   836         16  PI-LABEL-CONTROL            PIC X(01).
   837             88  PI-CREATE-LABELS                    VALUE 'Y'.
   838             88  PI-BYPASS-LABELS                    VALUE 'N'.
   839
   840         16  PI-BILL-GROUPING-CODE       PIC X(01).
   841             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   842
   843         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   844             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   845             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   846
   847         16  FILLER                      PIC X(14).
   848
   849     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   850******************************************************************
   851*                          COPY ELC650PI.
   852******************************************************************
   853*
   854*                            ELC650PI.
   855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   856*                            VMOD=2.007
   857*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   858*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
   859* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   860*
   861******************************************************************
   862
   863     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   864         16  PI-MAINT                   PIC X.
   865         16  PI-PREV-ACCOUNT            PIC X(20).
   866         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   867         16  PI-ACCT-KEY.
   868             20  PI-ACCT-CCGSA-KEY.
   869                 24  PI-ACCT-CO             PIC X.
   870                 24  PI-ACCT-CARRIER        PIC X.
   871                 24  PI-ACCT-GROUPING       PIC X(6).
   872                 24  PI-ACCT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6504.cbl
   873                 24  PI-ACCT-ACCOUNT        PIC X(10).
   874             20  PI-ACCT-EXP-DT           PIC XX.
   875             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   876         16  PI-ACCT-ID                 PIC X(8).
   877         16  PI-PLAN-KEY.
   878             20  PI-PLAN-ACCT-KEY.
   879                 24  PI-PLAN-COMPANY-CD PIC X.
   880                 24  PI-PLAN-CARRIER    PIC X.
   881                 24  PI-PLAN-GROUP      PIC X(6).
   882                 24  PI-PLAN-STATE      PIC X(2).
   883                 24  PI-PLAN-ACCOUNT    PIC X(10).
   884             20  PI-PLAN-BEN-TYPE       PIC X.
   885             20  PI-PLAN-BEN            PIC XX.
   886             20  PI-PLAN-REVISION       PIC X(3).
   887         16  PI-WS-STATE                PIC XX.
   888         16  PI-WS-CLASS                PIC XX.
   889         16  PI-WS-DEV                  PIC X(3).
   890         16  PI-WS-TYPE                 PIC X.
   891         16  PI-WS-PLAN                 PIC XX.
   892
   893         16  PI-ERPNDB-ALT-KEY.
   894             20  PI-PB-COMPANY-CD-A1    PIC X.
   895             20  PI-PB-CARRIER          PIC X.
   896             20  PI-PB-GROUPING         PIC X(6).
   897             20  PI-PB-STATE            PIC XX.
   898             20  PI-PB-ACCOUNT          PIC X(10).
   899             20  PI-PB-CERT-EFF-DT      PIC XX.
   900             20  PI-PB-CERT-NO          PIC X(10).
   901             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   902             20  PI-PB-RECORD-TYPE      PIC X.
   903
   904         16  PI-DATE-RANGE-TABLE.
   905             20  PI-TABLE-ENT OCCURS 32 TIMES
   906                            INDEXED BY T-INDEX.
   907                 24  PI-BIN-EFF-DT          PIC XX.
   908                 24  PI-BIN-EXP-DT          PIC XX.
   909                 24  PI-BIN-MAINT-DT        PIC XX.
   910                 24  PI-BIN-LO-CERT         PIC XX.
   911                 24  PI-BIN-AR-HI-CERT      PIC XX.
   912                 24  PI-BIN-HI-CERT         PIC XX.
   913         16  PI-PAGE-NUMBER             PIC S9.
   914             88  PI-FST-PAGE               VALUE +1.
   915             88  PI-2ND-PAGE               VALUE +2.
   916             88  PI-3RD-PAGE               VALUE +3.
   917             88  PI-LST-PAGE               VALUE +4.
   918         16  PI-TOTAL-LINES             PIC S99.
   919         16  PI-LINE-SELECTED    PIC S9.
   920***  Y2K PROJ 7744
   921         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   922         16  BIN-EFFCHG-SAVE     PIC XX.
   923         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   924***  Y2K PROJ 7744
   925         16  BIN-EXPCHG-SAVE     PIC XX.
   926         16  PI-RECORD-ADDED-SW  PIC X.
   927             88  PI-RECORD-ADDED            VALUE '1'.
   928             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   929         16  PI-ACCNAME          PIC X(30).
   930         16  PI-COMM-POINTER     PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6504.cbl
   931         16  PI-SV-MAINT         PIC X.
   932         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   933         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   934         16  PI-UPDATE-SW        PIC X.
   935             88  PI-CHANGES-MADE             VALUE '1'.
   936         16  PI-NOTE-TYPE        PIC X.
   937             88  PI-ACCT-NOTE                VALUE '1'.
   938         16  PI-DMD-FILE-SW      PIC X.
   939             88  END-OF-FILE                 VALUE 'E'.
   940             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   941             88  FIRST-OCCURS                VALUE 'F'.
   942         16  PI-DMD-OCCURS       PIC S999.
   943         16  PI-DMD-SCREEN       PIC X.
   944             88  SCREEN-1-DISPLAYED  VALUE '1'.
   945             88  SCREEN-2-DISPLAYED  VALUE '2'.
   946             88  SCREEN-3-DISPLAYED  VALUE '3'.
   947         16  PI-NAMEFLG          PIC X.
   948         16  PI-EL650-DEL-SW     PIC X.
   949         16  FILLER              PIC X(41).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6504.cbl
   951
   952*                          COPY ELCJPFX.
   953******************************************************************
   954*                                                                *
   955*                                                                *
   956*                            ELCJPFX.                            *
   957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   958*                            VMOD=2.002                          *
   959*                                                                *
   960*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   961*                                                                *
   962*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   963*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   964*        ELCNTL - CONTROL FILE                                   *
   965*        ELMSTR - CLAIM MASTERS                                  *
   966*        ELTRLR - ACTIVITY TRAILERS                              *
   967*        ELCHKQ - CHECK QUE                                      *
   968******************************************************************
   969 01  JOURNAL-RECORD.
   970     12  JP-USER-ID                  PIC X(4).
   971     12  JP-FILE-ID                  PIC X(8).
   972     12  JP-PROGRAM-ID               PIC X(8).
   973     12  JP-RECORD-TYPE              PIC X.
   974         88 JP-ADD              VALUE 'A'.
   975         88 JP-BEFORE-CHANGE    VALUE 'B'.
   976         88 JP-AFTER-CHANGE     VALUE 'C'.
   977         88 JP-DELETE           VALUE 'D'.
   978         88 JP-GENERIC-DELETE   VALUE 'G'.
   979         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   980         88 JP-KEY-CHG-ADD      VALUE 'N'.
   981     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   982     12  JP-RECORD-AREA
   983
   984
   985                                     PIC X(2000).
   986
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6504.cbl
   988*                          COPY ELCAID.
   989******************************************************************
   990*                                                                *
   991*                            ELCAID.                             *
   992*                            VMOD=2.001                          *
   993*                                                                *
   994*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   995*                                                                *
   996*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   997*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   998******************************************************************
   999
  1000 01  DFHAID.
  1001   02  DFHNULL   PIC  X  VALUE  ' '.
  1002   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1003   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1004   02  DFHPEN    PIC  X  VALUE  '='.
  1005   02  DFHOPID   PIC  X  VALUE  'W'.
  1006   02  DFHPA1    PIC  X  VALUE  '%'.
  1007   02  DFHPA2    PIC  X  VALUE  '>'.
  1008   02  DFHPA3    PIC  X  VALUE  ','.
  1009   02  DFHPF1    PIC  X  VALUE  '1'.
  1010   02  DFHPF2    PIC  X  VALUE  '2'.
  1011   02  DFHPF3    PIC  X  VALUE  '3'.
  1012   02  DFHPF4    PIC  X  VALUE  '4'.
  1013   02  DFHPF5    PIC  X  VALUE  '5'.
  1014   02  DFHPF6    PIC  X  VALUE  '6'.
  1015   02  DFHPF7    PIC  X  VALUE  '7'.
  1016   02  DFHPF8    PIC  X  VALUE  '8'.
  1017   02  DFHPF9    PIC  X  VALUE  '9'.
  1018   02  DFHPF10   PIC  X  VALUE  ':'.
  1019   02  DFHPF11   PIC  X  VALUE  '#'.
  1020   02  DFHPF12   PIC  X  VALUE  '@'.
  1021   02  DFHPF13   PIC  X  VALUE  'A'.
  1022   02  DFHPF14   PIC  X  VALUE  'B'.
  1023   02  DFHPF15   PIC  X  VALUE  'C'.
  1024   02  DFHPF16   PIC  X  VALUE  'D'.
  1025   02  DFHPF17   PIC  X  VALUE  'E'.
  1026   02  DFHPF18   PIC  X  VALUE  'F'.
  1027   02  DFHPF19   PIC  X  VALUE  'G'.
  1028   02  DFHPF20   PIC  X  VALUE  'H'.
  1029   02  DFHPF21   PIC  X  VALUE  'I'.
  1030*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1031   02  DFHPF22   PIC  X  VALUE  '['.
  1032   02  DFHPF23   PIC  X  VALUE  '.'.
  1033   02  DFHPF24   PIC  X  VALUE  '<'.
  1034   02  DFHMSRE   PIC  X  VALUE  'X'.
  1035   02  DFHSTRF   PIC  X  VALUE  'h'.
  1036   02  DFHTRIG   PIC  X  VALUE  '"'.
  1037 01  FILLER    REDEFINES DFHAID.
  1038     12  FILLER                      PIC X(8).
  1039     12  PF-VALUES                   PIC X       OCCURS 2.
  1040
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6504.cbl
  1042*                          COPY EL6504S.
  1043 01  EL6504AI.
  1044     05  FILLER            PIC  X(0012).
  1045*    -------------------------------
  1046     05  DATEL PIC S9(0004) COMP.
  1047     05  DATEF PIC  X(0001).
  1048     05  FILLER REDEFINES DATEF.
  1049         10  DATEA PIC  X(0001).
  1050     05  DATEI PIC  X(0008).
  1051*    -------------------------------
  1052     05  TIMEL PIC S9(0004) COMP.
  1053     05  TIMEF PIC  X(0001).
  1054     05  FILLER REDEFINES TIMEF.
  1055         10  TIMEA PIC  X(0001).
  1056     05  TIMEI PIC  X(0005).
  1057*    -------------------------------
  1058     05  CMPNYIDL PIC S9(0004) COMP.
  1059     05  CMPNYIDF PIC  X(0001).
  1060     05  FILLER REDEFINES CMPNYIDF.
  1061         10  CMPNYIDA PIC  X(0001).
  1062     05  CMPNYIDI PIC  X(0003).
  1063*    -------------------------------
  1064     05  USERIDL PIC S9(0004) COMP.
  1065     05  USERIDF PIC  X(0001).
  1066     05  FILLER REDEFINES USERIDF.
  1067         10  USERIDA PIC  X(0001).
  1068     05  USERIDI PIC  X(0004).
  1069*    -------------------------------
  1070     05  MAINTYPL PIC S9(0004) COMP.
  1071     05  MAINTYPF PIC  X(0001).
  1072     05  FILLER REDEFINES MAINTYPF.
  1073         10  MAINTYPA PIC  X(0001).
  1074     05  MAINTYPI PIC  X(0001).
  1075*    -------------------------------
  1076     05  CARRL PIC S9(0004) COMP.
  1077     05  CARRF PIC  X(0001).
  1078     05  FILLER REDEFINES CARRF.
  1079         10  CARRA PIC  X(0001).
  1080     05  CARRI PIC  X(0001).
  1081*    -------------------------------
  1082     05  GROUPINL PIC S9(0004) COMP.
  1083     05  GROUPINF PIC  X(0001).
  1084     05  FILLER REDEFINES GROUPINF.
  1085         10  GROUPINA PIC  X(0001).
  1086     05  GROUPINI PIC  X(0006).
  1087*    -------------------------------
  1088     05  STATEL PIC S9(0004) COMP.
  1089     05  STATEF PIC  X(0001).
  1090     05  FILLER REDEFINES STATEF.
  1091         10  STATEA PIC  X(0001).
  1092     05  STATEI PIC  X(0002).
  1093*    -------------------------------
  1094     05  ACCOUNTL PIC S9(0004) COMP.
  1095     05  ACCOUNTF PIC  X(0001).
  1096     05  FILLER REDEFINES ACCOUNTF.
  1097         10  ACCOUNTA PIC  X(0001).
  1098     05  ACCOUNTI PIC  X(0010).
  1099*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6504.cbl
  1100     05  EFFDTEL PIC S9(0004) COMP.
  1101     05  EFFDTEF PIC  X(0001).
  1102     05  FILLER REDEFINES EFFDTEF.
  1103         10  EFFDTEA PIC  X(0001).
  1104     05  EFFDTEI PIC  X(0008).
  1105*    -------------------------------
  1106     05  EXPDTEL PIC S9(0004) COMP.
  1107     05  EXPDTEF PIC  X(0001).
  1108     05  FILLER REDEFINES EXPDTEF.
  1109         10  EXPDTEA PIC  X(0001).
  1110     05  EXPDTEI PIC  X(0008).
  1111*    -------------------------------
  1112     05  LFREIHDL PIC S9(0004) COMP.
  1113     05  LFREIHDF PIC  X(0001).
  1114     05  FILLER REDEFINES LFREIHDF.
  1115         10  LFREIHDA PIC  X(0001).
  1116     05  LFREIHDI PIC  X(0006).
  1117*    -------------------------------
  1118     05  LCFEEL PIC S9(0004) COMP.
  1119     05  LCFEEF PIC  X(0001).
  1120     05  FILLER REDEFINES LCFEEF.
  1121         10  LCFEEA PIC  X(0001).
  1122     05  LCFEEI PIC  X(0006).
  1123*    -------------------------------
  1124     05  LCBASISL PIC S9(0004) COMP.
  1125     05  LCBASISF PIC  X(0001).
  1126     05  FILLER REDEFINES LCBASISF.
  1127         10  LCBASISA PIC  X(0001).
  1128     05  LCBASISI PIC  X(0001).
  1129*    -------------------------------
  1130     05  LTAXL PIC S9(0004) COMP.
  1131     05  LTAXF PIC  X(0001).
  1132     05  FILLER REDEFINES LTAXF.
  1133         10  LTAXA PIC  X(0001).
  1134     05  LTAXI PIC  X(0006).
  1135*    -------------------------------
  1136     05  TAXOPTL PIC S9(0004) COMP.
  1137     05  TAXOPTF PIC  X(0001).
  1138     05  FILLER REDEFINES TAXOPTF.
  1139         10  TAXOPTA PIC  X(0001).
  1140     05  TAXOPTI PIC  X(0001).
  1141*    -------------------------------
  1142     05  PRTOPTL PIC S9(0004) COMP.
  1143     05  PRTOPTF PIC  X(0001).
  1144     05  FILLER REDEFINES PRTOPTF.
  1145         10  PRTOPTA PIC  X(0001).
  1146     05  PRTOPTI PIC  X(0001).
  1147*    -------------------------------
  1148     05  GROUPAL PIC S9(0004) COMP.
  1149     05  GROUPAF PIC  X(0001).
  1150     05  FILLER REDEFINES GROUPAF.
  1151         10  GROUPAA PIC  X(0001).
  1152     05  GROUPAI PIC  X(0006).
  1153*    -------------------------------
  1154     05  GROUPBL PIC S9(0004) COMP.
  1155     05  GROUPBF PIC  X(0001).
  1156     05  FILLER REDEFINES GROUPBF.
  1157         10  GROUPBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6504.cbl
  1158     05  GROUPBI PIC  X(0006).
  1159*    -------------------------------
  1160     05  MORTALL PIC S9(0004) COMP.
  1161     05  MORTALF PIC  X(0001).
  1162     05  FILLER REDEFINES MORTALF.
  1163         10  MORTALA PIC  X(0001).
  1164     05  MORTALI PIC  X(0004).
  1165*    -------------------------------
  1166     05  AHREIHDL PIC S9(0004) COMP.
  1167     05  AHREIHDF PIC  X(0001).
  1168     05  FILLER REDEFINES AHREIHDF.
  1169         10  AHREIHDA PIC  X(0001).
  1170     05  AHREIHDI PIC  X(0006).
  1171*    -------------------------------
  1172     05  ACFEEL PIC S9(0004) COMP.
  1173     05  ACFEEF PIC  X(0001).
  1174     05  FILLER REDEFINES ACFEEF.
  1175         10  ACFEEA PIC  X(0001).
  1176     05  ACFEEI PIC  X(0006).
  1177*    -------------------------------
  1178     05  ACBASISL PIC S9(0004) COMP.
  1179     05  ACBASISF PIC  X(0001).
  1180     05  FILLER REDEFINES ACBASISF.
  1181         10  ACBASISA PIC  X(0001).
  1182     05  ACBASISI PIC  X(0001).
  1183*    -------------------------------
  1184     05  ATAXL PIC S9(0004) COMP.
  1185     05  ATAXF PIC  X(0001).
  1186     05  FILLER REDEFINES ATAXF.
  1187         10  ATAXA PIC  X(0001).
  1188     05  ATAXI PIC  X(0006).
  1189*    -------------------------------
  1190     05  ARULEL PIC S9(0004) COMP.
  1191     05  ARULEF PIC  X(0001).
  1192     05  FILLER REDEFINES ARULEF.
  1193         10  ARULEA PIC  X(0001).
  1194     05  ARULEI PIC  X(0006).
  1195*    -------------------------------
  1196     05  ARATAL PIC S9(0004) COMP.
  1197     05  ARATAF PIC  X(0001).
  1198     05  FILLER REDEFINES ARATAF.
  1199         10  ARATAA PIC  X(0001).
  1200     05  ARATAI PIC  X(0006).
  1201*    -------------------------------
  1202     05  LRETHD1L PIC S9(0004) COMP.
  1203     05  LRETHD1F PIC  X(0001).
  1204     05  FILLER REDEFINES LRETHD1F.
  1205         10  LRETHD1A PIC  X(0001).
  1206     05  LRETHD1I PIC  X(0002).
  1207*    -------------------------------
  1208     05  ARETHD1L PIC S9(0004) COMP.
  1209     05  ARETHD1F PIC  X(0001).
  1210     05  FILLER REDEFINES ARETHD1F.
  1211         10  ARETHD1A PIC  X(0001).
  1212     05  ARETHD1I PIC  X(0002).
  1213*    -------------------------------
  1214     05  ARETHD2L PIC S9(0004) COMP.
  1215     05  ARETHD2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6504.cbl
  1216     05  FILLER REDEFINES ARETHD2F.
  1217         10  ARETHD2A PIC  X(0001).
  1218     05  ARETHD2I PIC  X(0002).
  1219*    -------------------------------
  1220     05  ARETHD3L PIC S9(0004) COMP.
  1221     05  ARETHD3F PIC  X(0001).
  1222     05  FILLER REDEFINES ARETHD3F.
  1223         10  ARETHD3A PIC  X(0001).
  1224     05  ARETHD3I PIC  X(0002).
  1225*    -------------------------------
  1226     05  YNRETROL PIC S9(0004) COMP.
  1227     05  YNRETROF PIC  X(0001).
  1228     05  FILLER REDEFINES YNRETROF.
  1229         10  YNRETROA PIC  X(0001).
  1230     05  YNRETROI PIC  X(0001).
  1231*    -------------------------------
  1232     05  PERETROL PIC S9(0004) COMP.
  1233     05  PERETROF PIC  X(0001).
  1234     05  FILLER REDEFINES PERETROF.
  1235         10  PERETROA PIC  X(0001).
  1236     05  PERETROI PIC  X(0001).
  1237*    -------------------------------
  1238     05  PECOMML PIC S9(0004) COMP.
  1239     05  PECOMMF PIC  X(0001).
  1240     05  FILLER REDEFINES PECOMMF.
  1241         10  PECOMMA PIC  X(0001).
  1242     05  PECOMMI PIC  X(0001).
  1243*    -------------------------------
  1244     05  PICLAIML PIC S9(0004) COMP.
  1245     05  PICLAIMF PIC  X(0001).
  1246     05  FILLER REDEFINES PICLAIMF.
  1247         10  PICLAIMA PIC  X(0001).
  1248     05  PICLAIMI PIC  X(0001).
  1249*    -------------------------------
  1250     05  GPRETROL PIC S9(0004) COMP.
  1251     05  GPRETROF PIC  X(0001).
  1252     05  FILLER REDEFINES GPRETROF.
  1253         10  GPRETROA PIC  X(0001).
  1254     05  GPRETROI PIC  X(0006).
  1255*    -------------------------------
  1256     05  RELIMITL PIC S9(0004) COMP.
  1257     05  RELIMITF PIC  X(0001).
  1258     05  FILLER REDEFINES RELIMITF.
  1259         10  RELIMITA PIC  X(0001).
  1260     05  RELIMITI PIC  X(0007).
  1261*    -------------------------------
  1262     05  LFLOSSL PIC S9(0004) COMP.
  1263     05  LFLOSSF PIC  X(0001).
  1264     05  FILLER REDEFINES LFLOSSF.
  1265         10  LFLOSSA PIC  X(0001).
  1266     05  LFLOSSI PIC  X(0004).
  1267*    -------------------------------
  1268     05  AHLOSSL PIC S9(0004) COMP.
  1269     05  AHLOSSF PIC  X(0001).
  1270     05  FILLER REDEFINES AHLOSSF.
  1271         10  AHLOSSA PIC  X(0001).
  1272     05  AHLOSSI PIC  X(0004).
  1273*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6504.cbl
  1274     05  REDEARNL PIC S9(0004) COMP.
  1275     05  REDEARNF PIC  X(0001).
  1276     05  FILLER REDEFINES REDEARNF.
  1277         10  REDEARNA PIC  X(0001).
  1278     05  REDEARNI PIC  X(0001).
  1279*    -------------------------------
  1280     05  LEVEARNL PIC S9(0004) COMP.
  1281     05  LEVEARNF PIC  X(0001).
  1282     05  FILLER REDEFINES LEVEARNF.
  1283         10  LEVEARNA PIC  X(0001).
  1284     05  LEVEARNI PIC  X(0001).
  1285*    -------------------------------
  1286     05  AHEARNL PIC S9(0004) COMP.
  1287     05  AHEARNF PIC  X(0001).
  1288     05  FILLER REDEFINES AHEARNF.
  1289         10  AHEARNA PIC  X(0001).
  1290     05  AHEARNI PIC  X(0001).
  1291*    -------------------------------
  1292     05  BEGREDL PIC S9(0004) COMP.
  1293     05  BEGREDF PIC  X(0001).
  1294     05  FILLER REDEFINES BEGREDF.
  1295         10  BEGREDA PIC  X(0001).
  1296     05  BEGREDI PIC  X(0001).
  1297*    -------------------------------
  1298     05  BEGLEVL PIC S9(0004) COMP.
  1299     05  BEGLEVF PIC  X(0001).
  1300     05  FILLER REDEFINES BEGLEVF.
  1301         10  BEGLEVA PIC  X(0001).
  1302     05  BEGLEVI PIC  X(0001).
  1303*    -------------------------------
  1304     05  BEGAHL PIC S9(0004) COMP.
  1305     05  BEGAHF PIC  X(0001).
  1306     05  FILLER REDEFINES BEGAHF.
  1307         10  BEGAHA PIC  X(0001).
  1308     05  BEGAHI PIC  X(0001).
  1309*    -------------------------------
  1310     05  TAXOPL PIC S9(0004) COMP.
  1311     05  TAXOPF PIC  X(0001).
  1312     05  FILLER REDEFINES TAXOPF.
  1313         10  TAXOPA PIC  X(0001).
  1314     05  TAXOPI PIC  X(0001).
  1315*    -------------------------------
  1316     05  LFRETHDL PIC S9(0004) COMP.
  1317     05  LFRETHDF PIC  X(0001).
  1318     05  FILLER REDEFINES LFRETHDF.
  1319         10  LFRETHDA PIC  X(0001).
  1320     05  LFRETHDI PIC  X(0006).
  1321*    -------------------------------
  1322     05  LFRETENL PIC S9(0004) COMP.
  1323     05  LFRETENF PIC  X(0001).
  1324     05  FILLER REDEFINES LFRETENF.
  1325         10  LFRETENA PIC  X(0001).
  1326     05  LFRETENI PIC  X(0006).
  1327*    -------------------------------
  1328     05  LFMETHDL PIC S9(0004) COMP.
  1329     05  LFMETHDF PIC  X(0001).
  1330     05  FILLER REDEFINES LFMETHDF.
  1331         10  LFMETHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6504.cbl
  1332     05  LFMETHDI PIC  X(0001).
  1333*    -------------------------------
  1334     05  LFBASISL PIC S9(0004) COMP.
  1335     05  LFBASISF PIC  X(0001).
  1336     05  FILLER REDEFINES LFBASISF.
  1337         10  LFBASISA PIC  X(0001).
  1338     05  LFBASISI PIC  X(0001).
  1339*    -------------------------------
  1340     05  LFPCT1L PIC S9(0004) COMP.
  1341     05  LFPCT1F PIC  X(0001).
  1342     05  FILLER REDEFINES LFPCT1F.
  1343         10  LFPCT1A PIC  X(0001).
  1344     05  LFPCT1I PIC  X(0006).
  1345*    -------------------------------
  1346     05  LFTHRU1L PIC S9(0004) COMP.
  1347     05  LFTHRU1F PIC  X(0001).
  1348     05  FILLER REDEFINES LFTHRU1F.
  1349         10  LFTHRU1A PIC  X(0001).
  1350     05  LFTHRU1I PIC  X(0009).
  1351*    -------------------------------
  1352     05  LFPCT2L PIC S9(0004) COMP.
  1353     05  LFPCT2F PIC  X(0001).
  1354     05  FILLER REDEFINES LFPCT2F.
  1355         10  LFPCT2A PIC  X(0001).
  1356     05  LFPCT2I PIC  X(0006).
  1357*    -------------------------------
  1358     05  LFTHRU2L PIC S9(0004) COMP.
  1359     05  LFTHRU2F PIC  X(0001).
  1360     05  FILLER REDEFINES LFTHRU2F.
  1361         10  LFTHRU2A PIC  X(0001).
  1362     05  LFTHRU2I PIC  X(0009).
  1363*    -------------------------------
  1364     05  LFPCT3L PIC S9(0004) COMP.
  1365     05  LFPCT3F PIC  X(0001).
  1366     05  FILLER REDEFINES LFPCT3F.
  1367         10  LFPCT3A PIC  X(0001).
  1368     05  LFPCT3I PIC  X(0006).
  1369*    -------------------------------
  1370     05  LFTHRU3L PIC S9(0004) COMP.
  1371     05  LFTHRU3F PIC  X(0001).
  1372     05  FILLER REDEFINES LFTHRU3F.
  1373         10  LFTHRU3A PIC  X(0001).
  1374     05  LFTHRU3I PIC  X(0009).
  1375*    -------------------------------
  1376     05  AHRETHDL PIC S9(0004) COMP.
  1377     05  AHRETHDF PIC  X(0001).
  1378     05  FILLER REDEFINES AHRETHDF.
  1379         10  AHRETHDA PIC  X(0001).
  1380     05  AHRETHDI PIC  X(0006).
  1381*    -------------------------------
  1382     05  AHRETENL PIC S9(0004) COMP.
  1383     05  AHRETENF PIC  X(0001).
  1384     05  FILLER REDEFINES AHRETENF.
  1385         10  AHRETENA PIC  X(0001).
  1386     05  AHRETENI PIC  X(0006).
  1387*    -------------------------------
  1388     05  AHMETHDL PIC S9(0004) COMP.
  1389     05  AHMETHDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6504.cbl
  1390     05  FILLER REDEFINES AHMETHDF.
  1391         10  AHMETHDA PIC  X(0001).
  1392     05  AHMETHDI PIC  X(0001).
  1393*    -------------------------------
  1394     05  AHBASISL PIC S9(0004) COMP.
  1395     05  AHBASISF PIC  X(0001).
  1396     05  FILLER REDEFINES AHBASISF.
  1397         10  AHBASISA PIC  X(0001).
  1398     05  AHBASISI PIC  X(0001).
  1399*    -------------------------------
  1400     05  AHPCT1L PIC S9(0004) COMP.
  1401     05  AHPCT1F PIC  X(0001).
  1402     05  FILLER REDEFINES AHPCT1F.
  1403         10  AHPCT1A PIC  X(0001).
  1404     05  AHPCT1I PIC  X(0006).
  1405*    -------------------------------
  1406     05  AHTHRU1L PIC S9(0004) COMP.
  1407     05  AHTHRU1F PIC  X(0001).
  1408     05  FILLER REDEFINES AHTHRU1F.
  1409         10  AHTHRU1A PIC  X(0001).
  1410     05  AHTHRU1I PIC  X(0009).
  1411*    -------------------------------
  1412     05  AHPCT2L PIC S9(0004) COMP.
  1413     05  AHPCT2F PIC  X(0001).
  1414     05  FILLER REDEFINES AHPCT2F.
  1415         10  AHPCT2A PIC  X(0001).
  1416     05  AHPCT2I PIC  X(0006).
  1417*    -------------------------------
  1418     05  AHTHRU2L PIC S9(0004) COMP.
  1419     05  AHTHRU2F PIC  X(0001).
  1420     05  FILLER REDEFINES AHTHRU2F.
  1421         10  AHTHRU2A PIC  X(0001).
  1422     05  AHTHRU2I PIC  X(0009).
  1423*    -------------------------------
  1424     05  AHPCT3L PIC S9(0004) COMP.
  1425     05  AHPCT3F PIC  X(0001).
  1426     05  FILLER REDEFINES AHPCT3F.
  1427         10  AHPCT3A PIC  X(0001).
  1428     05  AHPCT3I PIC  X(0006).
  1429*    -------------------------------
  1430     05  AHTHRU3L PIC S9(0004) COMP.
  1431     05  AHTHRU3F PIC  X(0001).
  1432     05  FILLER REDEFINES AHTHRU3F.
  1433         10  AHTHRU3A PIC  X(0001).
  1434     05  AHTHRU3I PIC  X(0009).
  1435*    -------------------------------
  1436     05  COM1L PIC S9(0004) COMP.
  1437     05  COM1F PIC  X(0001).
  1438     05  FILLER REDEFINES COM1F.
  1439         10  COM1A PIC  X(0001).
  1440     05  COM1I PIC  X(0050).
  1441*    -------------------------------
  1442     05  COM2L PIC S9(0004) COMP.
  1443     05  COM2F PIC  X(0001).
  1444     05  FILLER REDEFINES COM2F.
  1445         10  COM2A PIC  X(0001).
  1446     05  COM2I PIC  X(0050).
  1447*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6504.cbl
  1448     05  COM3L PIC S9(0004) COMP.
  1449     05  COM3F PIC  X(0001).
  1450     05  FILLER REDEFINES COM3F.
  1451         10  COM3A PIC  X(0001).
  1452     05  COM3I PIC  X(0050).
  1453*    -------------------------------
  1454     05  COM4L PIC S9(0004) COMP.
  1455     05  COM4F PIC  X(0001).
  1456     05  FILLER REDEFINES COM4F.
  1457         10  COM4A PIC  X(0001).
  1458     05  COM4I PIC  X(0050).
  1459*    -------------------------------
  1460     05  COM5L PIC S9(0004) COMP.
  1461     05  COM5F PIC  X(0001).
  1462     05  FILLER REDEFINES COM5F.
  1463         10  COM5A PIC  X(0001).
  1464     05  COM5I PIC  X(0050).
  1465*    -------------------------------
  1466     05  ERRMSG1L PIC S9(0004) COMP.
  1467     05  ERRMSG1F PIC  X(0001).
  1468     05  FILLER REDEFINES ERRMSG1F.
  1469         10  ERRMSG1A PIC  X(0001).
  1470     05  ERRMSG1I PIC  X(0070).
  1471*    -------------------------------
  1472     05  ERRMSG2L PIC S9(0004) COMP.
  1473     05  ERRMSG2F PIC  X(0001).
  1474     05  FILLER REDEFINES ERRMSG2F.
  1475         10  ERRMSG2A PIC  X(0001).
  1476     05  ERRMSG2I PIC  X(0070).
  1477*    -------------------------------
  1478     05  PFENTERL PIC S9(0004) COMP.
  1479     05  PFENTERF PIC  X(0001).
  1480     05  FILLER REDEFINES PFENTERF.
  1481         10  PFENTERA PIC  X(0001).
  1482     05  PFENTERI PIC  9(2).
  1483 01  EL6504AO REDEFINES EL6504AI.
  1484     05  FILLER            PIC  X(0012).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  DATEO PIC  X(0008).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  TIMEO PIC  99.99.
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  CMPNYIDO PIC  X(0003).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  USERIDO PIC  X(0004).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  MAINTYPO PIC  X(0001).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  CARRO PIC  X(0001).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  GROUPINO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6504.cbl
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  STATEO PIC  X(0002).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  ACCOUNTO PIC  X(0010).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  EFFDTEO PIC  X(0008).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  EXPDTEO PIC  99B99B99.
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  LFREIHDO PIC  X(0006).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  LCFEEO PIC  9.9999.
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  LCBASISO PIC  X(0001).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  LTAXO PIC  9.9999.
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  TAXOPTO PIC  X(0001).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  PRTOPTO PIC  X(0001).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  GROUPAO PIC  X(0006).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  GROUPBO PIC  X(0006).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  MORTALO PIC  X(0004).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  AHREIHDO PIC  X(0006).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  ACFEEO PIC  9.9999.
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  ACBASISO PIC  X(0001).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  ATAXO PIC  9.9999.
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  ARULEO PIC  9.9999.
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  ARATAO PIC  9.9999.
  1563*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6504.cbl
  1564     05  FILLER            PIC  X(0003).
  1565     05  LRETHD1O PIC  X(0002).
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  ARETHD1O PIC  X(0002).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  ARETHD2O PIC  X(0002).
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  ARETHD3O PIC  X(0002).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  YNRETROO PIC  X(0001).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  PERETROO PIC  X(0001).
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  PECOMMO PIC  X(0001).
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
  1586     05  PICLAIMO PIC  X(0001).
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  GPRETROO PIC  X(0006).
  1590*    -------------------------------
  1591     05  FILLER            PIC  X(0003).
  1592     05  RELIMITO PIC  ZZZZZZZ.
  1593*    -------------------------------
  1594     05  FILLER            PIC  X(0003).
  1595     05  LFLOSSO PIC  .999.
  1596*    -------------------------------
  1597     05  FILLER            PIC  X(0003).
  1598     05  AHLOSSO PIC  .999.
  1599*    -------------------------------
  1600     05  FILLER            PIC  X(0003).
  1601     05  REDEARNO PIC  X(0001).
  1602*    -------------------------------
  1603     05  FILLER            PIC  X(0003).
  1604     05  LEVEARNO PIC  X(0001).
  1605*    -------------------------------
  1606     05  FILLER            PIC  X(0003).
  1607     05  AHEARNO PIC  X(0001).
  1608*    -------------------------------
  1609     05  FILLER            PIC  X(0003).
  1610     05  BEGREDO PIC  X(0001).
  1611*    -------------------------------
  1612     05  FILLER            PIC  X(0003).
  1613     05  BEGLEVO PIC  X(0001).
  1614*    -------------------------------
  1615     05  FILLER            PIC  X(0003).
  1616     05  BEGAHO PIC  X(0001).
  1617*    -------------------------------
  1618     05  FILLER            PIC  X(0003).
  1619     05  TAXOPO PIC  X(0001).
  1620*    -------------------------------
  1621     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6504.cbl
  1622     05  LFRETHDO PIC  X(0006).
  1623*    -------------------------------
  1624     05  FILLER            PIC  X(0003).
  1625     05  LFRETENO PIC  Z.9999.
  1626*    -------------------------------
  1627     05  FILLER            PIC  X(0003).
  1628     05  LFMETHDO PIC  X(0001).
  1629*    -------------------------------
  1630     05  FILLER            PIC  X(0003).
  1631     05  LFBASISO PIC  X(0001).
  1632*    -------------------------------
  1633     05  FILLER            PIC  X(0003).
  1634     05  LFPCT1O PIC  Z.9999.
  1635*    -------------------------------
  1636     05  FILLER            PIC  X(0003).
  1637     05  LFTHRU1O PIC  Z,ZZZ,ZZZ.
  1638*    -------------------------------
  1639     05  FILLER            PIC  X(0003).
  1640     05  LFPCT2O PIC  Z.9999.
  1641*    -------------------------------
  1642     05  FILLER            PIC  X(0003).
  1643     05  LFTHRU2O PIC  Z,ZZZ,ZZZ.
  1644*    -------------------------------
  1645     05  FILLER            PIC  X(0003).
  1646     05  LFPCT3O PIC  Z.9999.
  1647*    -------------------------------
  1648     05  FILLER            PIC  X(0003).
  1649     05  LFTHRU3O PIC  Z,ZZZ,ZZZ.
  1650*    -------------------------------
  1651     05  FILLER            PIC  X(0003).
  1652     05  AHRETHDO PIC  X(0006).
  1653*    -------------------------------
  1654     05  FILLER            PIC  X(0003).
  1655     05  AHRETENO PIC  Z.9999.
  1656*    -------------------------------
  1657     05  FILLER            PIC  X(0003).
  1658     05  AHMETHDO PIC  X(0001).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  AHBASISO PIC  X(0001).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
  1664     05  AHPCT1O PIC  Z.9999.
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  AHTHRU1O PIC  Z,ZZZ,ZZZ.
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  AHPCT2O PIC  Z.9999.
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  AHTHRU2O PIC  Z,ZZZ,ZZZ.
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  AHPCT3O PIC  Z.9999.
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  AHTHRU3O PIC  Z,ZZZ,ZZZ.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6504.cbl
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  COM1O PIC  X(0050).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  COM2O PIC  X(0050).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  COM3O PIC  X(0050).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  COM4O PIC  X(0050).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  COM5O PIC  X(0050).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  ERRMSG1O PIC  X(0070).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  ERRMSG2O PIC  X(0070).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  PFENTERO PIC  99.
  1704*    -------------------------------
  1705
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6504.cbl
  1707****************************************************************
  1708*
  1709* Copyright (c) 2007 by Clerity Solutions, Inc.
  1710* All rights reserved.
  1711*
  1712****************************************************************
  1713 01  DFHEIV.
  1714   02  DFHEIV0               PIC X(35).
  1715   02  DFHEIV1               PIC X(08).
  1716   02  DFHEIV2               PIC X(08).
  1717   02  DFHEIV3               PIC X(08).
  1718   02  DFHEIV4               PIC X(06).
  1719   02  DFHEIV5               PIC X(04).
  1720   02  DFHEIV6               PIC X(04).
  1721   02  DFHEIV7               PIC X(02).
  1722   02  DFHEIV8               PIC X(02).
  1723   02  DFHEIV9               PIC X(01).
  1724   02  DFHEIV10              PIC S9(7) COMP-3.
  1725   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1726   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1727   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1728   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1729   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1730   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1731   02  DFHEIV17              PIC X(04).
  1732   02  DFHEIV18              PIC X(04).
  1733   02  DFHEIV19              PIC X(04).
  1734   02  DFHEIV20              USAGE IS POINTER.
  1735   02  DFHEIV21              USAGE IS POINTER.
  1736   02  DFHEIV22              USAGE IS POINTER.
  1737   02  DFHEIV23              USAGE IS POINTER.
  1738   02  DFHEIV24              USAGE IS POINTER.
  1739   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1740   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1741   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1742   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1743   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1744   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1745   02  FILLER                PIC X(02).
  1746   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1747   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1748   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1749   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1750   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1751 LINKAGE  SECTION.
  1752*****************************************************************
  1753*                                                               *
  1754* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1755* All rights reserved.                                          *
  1756*                                                               *
  1757*****************************************************************
  1758 01  dfheiblk.
  1759     02  eibtime          pic s9(7) comp-3.
  1760     02  eibdate          pic s9(7) comp-3.
  1761     02  eibtrnid         pic x(4).
  1762     02  eibtaskn         pic s9(7) comp-3.
  1763     02  eibtrmid         pic x(4).
  1764     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6504.cbl
  1765     02  eibcposn         pic s9(4) comp.
  1766     02  eibcalen         pic s9(4) comp.
  1767     02  eibaid           pic x(1).
  1768     02  eibfiller1       pic x(1).
  1769     02  eibfn            pic x(2).
  1770     02  eibfiller2       pic x(2).
  1771     02  eibrcode         pic x(6).
  1772     02  eibfiller3       pic x(2).
  1773     02  eibds            pic x(8).
  1774     02  eibreqid         pic x(8).
  1775     02  eibrsrce         pic x(8).
  1776     02  eibsync          pic x(1).
  1777     02  eibfree          pic x(1).
  1778     02  eibrecv          pic x(1).
  1779     02  eibsend          pic x(1).
  1780     02  eibatt           pic x(1).
  1781     02  eibeoc           pic x(1).
  1782     02  eibfmh           pic x(1).
  1783     02  eibcompl         pic x(1).
  1784     02  eibsig           pic x(1).
  1785     02  eibconf          pic x(1).
  1786     02  eiberr           pic x(1).
  1787     02  eibrldbk         pic x(1).
  1788     02  eiberrcd         pic x(4).
  1789     02  eibsynrb         pic x(1).
  1790     02  eibnodat         pic x(1).
  1791     02  eibfiller5       pic x(2).
  1792     02  eibresp          pic 9(09) comp.
  1793     02  eibresp2         pic 9(09) comp.
  1794     02  dfheigdj         pic s9(4) comp.
  1795     02  dfheigdk         pic s9(4) comp.
  1796 01  DFHCOMMAREA                     PIC X(1500).
  1797
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6504.cbl
  1799*01 PARMLIST .
  1800*    02  FILLER                      PIC S9(8)   COMP.
  1801*    02  ERACCT-POINTER              PIC S9(8)   COMP.
  1802*    02  ELCNTL-POINTER              PIC S9(8)   COMP.
  1803
  1804*                          COPY ERCACCT.
  1805******************************************************************
  1806*                                                                *
  1807*                                                                *
  1808*                            ERCACCT                             *
  1809*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1810*                            VMOD=2.031                          *
  1811*                                                                *
  1812*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1813*                                                                *
  1814*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1815*   VSAM ACCOUNT MASTER FILES.                                   *
  1816*                                                                *
  1817*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1818*                                                                *
  1819*   FILE TYPE = VSAM,KSDS                                        *
  1820*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1821*                                                                *
  1822*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1823*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1824*                                                                *
  1825*   LOG = NO                                                     *
  1826*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1827*                                                                *
  1828*                                                                *
  1829******************************************************************
  1830*                   C H A N G E   L O G
  1831*
  1832* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1833*-----------------------------------------------------------------
  1834*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1835* EFFECTIVE    NUMBER
  1836*-----------------------------------------------------------------
  1837* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1838* 092705    2005050300006  PEMA  ADD SPP LEASES
  1839* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1840* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1841******************************************************************
  1842
  1843 01  ACCOUNT-MASTER.
  1844     12  AM-RECORD-ID                      PIC XX.
  1845         88  VALID-AM-ID                      VALUE 'AM'.
  1846
  1847     12  AM-CONTROL-PRIMARY.
  1848         16  AM-COMPANY-CD                 PIC X.
  1849         16  AM-MSTR-CNTRL.
  1850             20  AM-CONTROL-A.
  1851                 24  AM-CARRIER            PIC X.
  1852                 24  AM-GROUPING.
  1853                     28 AM-GROUPING-PREFIX PIC XXX.
  1854                     28 AM-GROUPING-PRIME  PIC XXX.
  1855                 24  AM-STATE              PIC XX.
  1856                 24  AM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6504.cbl
  1857                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1858                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1859             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1860                                           PIC X(19).
  1861             20  AM-CNTRL-B.
  1862                 24  AM-EXPIRATION-DT      PIC XX.
  1863                 24  FILLER                PIC X(4).
  1864             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1865                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1866
  1867     12  AM-CONTROL-BY-VAR-GRP.
  1868         16  AM-COMPANY-CD-A1              PIC X.
  1869         16  AM-VG-CARRIER                 PIC X.
  1870         16  AM-VG-GROUPING                PIC X(6).
  1871         16  AM-VG-STATE                   PIC XX.
  1872         16  AM-VG-ACCOUNT                 PIC X(10).
  1873         16  AM-VG-DATE.
  1874             20  AM-VG-EXPIRATION-DT       PIC XX.
  1875             20  FILLER                    PIC X(4).
  1876         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1877                                           PIC 9(11)      COMP-3.
  1878     12  AM-MAINT-INFORMATION.
  1879         16  AM-LAST-MAINT-DT              PIC XX.
  1880         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1881         16  AM-LAST-MAINT-USER            PIC X(4).
  1882         16  FILLER                        PIC XX.
  1883
  1884     12  AM-EFFECTIVE-DT                   PIC XX.
  1885     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1886
  1887     12  AM-PREV-DATES  COMP-3.
  1888         16  AM-PREV-EXP-DT                PIC 9(11).
  1889         16  AM-PREV-EFF-DT                PIC 9(11).
  1890
  1891     12  AM-REPORT-CODE-1                  PIC X(10).
  1892     12  AM-REPORT-CODE-2                  PIC X(10).
  1893
  1894     12  AM-CITY-CODE                      PIC X(4).
  1895     12  AM-COUNTY-PARISH                  PIC X(6).
  1896
  1897     12  AM-NAME                           PIC X(30).
  1898     12  AM-PERSON                         PIC X(30).
  1899     12  AM-ADDRS                          PIC X(30).
  1900     12  AM-CITY.
  1901         16  AM-ADDR-CITY                  PIC X(28).
  1902         16  AM-ADDR-STATE                 PIC XX.
  1903     12  AM-ZIP.
  1904         16  AM-ZIP-PRIME.
  1905             20  AM-ZIP-PRI-1ST            PIC X.
  1906                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1907             20  FILLER                    PIC X(4).
  1908         16  AM-ZIP-PLUS4                  PIC X(4).
  1909     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1910         16  AM-CAN-POSTAL-1               PIC XXX.
  1911         16  AM-CAN-POSTAL-2               PIC XXX.
  1912         16  FILLER                        PIC XXX.
  1913     12  AM-TEL-NO.
  1914         16  AM-AREA-CODE                  PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6504.cbl
  1915         16  AM-TEL-PRE                    PIC 999.
  1916         16  AM-TEL-NBR                    PIC 9(4).
  1917     12  AM-TEL-LOC                        PIC X.
  1918         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1919         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1920
  1921     12  AM-COMM-STRUCTURE.
  1922         16  AM-DEFN-1.
  1923             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1924                 24  AM-AGT.
  1925                     28  AM-AGT-PREFIX     PIC X(4).
  1926                     28  AM-AGT-PRIME      PIC X(6).
  1927                 24  AM-COM-TYP            PIC X.
  1928                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1929                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1930                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1931                 24  AM-RECALC-LV-INDIC    PIC X.
  1932                 24  AM-RETRO-LV-INDIC     PIC X.
  1933                 24  AM-GL-CODES           PIC X.
  1934                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1935                 24  FILLER                PIC X(01).
  1936         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1937             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1938                 24  FILLER                PIC X(11).
  1939                 24  AM-L-COMA             PIC XXX.
  1940                 24  AM-J-COMA             PIC XXX.
  1941                 24  AM-A-COMA             PIC XXX.
  1942                 24  FILLER                PIC X(6).
  1943
  1944     12  AM-COMM-CHANGE-STATUS             PIC X.
  1945         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1946
  1947     12  AM-CSR-CODE                       PIC X(4).
  1948
  1949     12  AM-BILLING-STATUS                 PIC X.
  1950         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1951         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1952     12  AM-AUTO-REFUND-SW                 PIC X.
  1953         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1954         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1955     12  AM-GPCD                           PIC 99.
  1956     12  AM-IG                             PIC X.
  1957         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1958         88  AM-HAS-GROUP                     VALUE '2'.
  1959     12  AM-STATUS                         PIC X.
  1960         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1961         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1962         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1963         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1964         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1965     12  AM-REMIT-TO                       PIC 99.
  1966     12  AM-ID-NO                          PIC X(11).
  1967
  1968     12  AM-CAL-TABLE                      PIC XX.
  1969     12  AM-LF-DEVIATION                   PIC XXX.
  1970     12  AM-AH-DEVIATION                   PIC XXX.
  1971     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1972     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6504.cbl
  1973     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1974     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1975     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1976     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1977
  1978     12  AM-USER-FIELDS.
  1979         16  AM-FLD-1                      PIC XX.
  1980         16  AM-FLD-2                      PIC XX.
  1981         16  AM-FLD-3                      PIC XX.
  1982         16  AM-FLD-4                      PIC XX.
  1983         16  AM-FLD-5                      PIC XX.
  1984
  1985     12  AM-1ST-PROD-DATE.
  1986         16  AM-1ST-PROD-YR                PIC XX.
  1987         16  AM-1ST-PROD-MO                PIC XX.
  1988         16  AM-1ST-PROD-DA                PIC XX.
  1989     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1990     12  AM-CERTS-PURGED-DATE.
  1991         16  AM-PUR-YR                     PIC XX.
  1992         16  AM-PUR-MO                     PIC XX.
  1993         16  AM-PUR-DA                     PIC XX.
  1994     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1995     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1996     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1997     12  AM-INACTIVE-DATE.
  1998         16  AM-INA-MO                     PIC 99.
  1999         16  AM-INA-DA                     PIC 99.
  2000         16  AM-INA-YR                     PIC 99.
  2001     12  AM-AR-HI-CERT-DATE                PIC XX.
  2002
  2003     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2004     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2005
  2006     12  AM-OB-PAYMENT-MODE                PIC X.
  2007         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2008         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2009         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2010         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2011
  2012     12  AM-AH-ONLY-INDICATOR              PIC X.
  2013         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2014         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2015
  2016     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2017
  2018     12  AM-OVER-SHORT.
  2019         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2020         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2021
  2022     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2023     12  AM-DCC-CLP-STATE                  PIC XX.
  2024
  2025     12  AM-RECALC-COMM                    PIC X.
  2026     12  AM-RECALC-REIN                    PIC X.
  2027
  2028     12  AM-REI-TABLE                      PIC XXX.
  2029     12  AM-REI-ET-LF                      PIC X.
  2030     12  AM-REI-ET-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6504.cbl
  2031     12  AM-REI-PE-LF                      PIC X.
  2032     12  AM-REI-PE-AH                      PIC X.
  2033     12  AM-REI-PRT-ST                     PIC X.
  2034     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2035     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2036     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2037     12  AM-REI-GROUP-A                    PIC X(6).
  2038     12  AM-REI-MORT                       PIC X(4).
  2039     12  AM-REI-PRT-OW                     PIC X.
  2040     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2041     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2042     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2043     12  AM-REI-GROUP-B                    PIC X(6).
  2044
  2045     12  AM-TRUST-TYPE                     PIC X(2).
  2046
  2047     12  AM-EMPLOYER-STMT-USED             PIC X.
  2048     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2049
  2050     12  AM-STD-AH-TYPE                    PIC XX.
  2051     12  AM-EARN-METHODS.
  2052         16  AM-EARN-METHOD-R              PIC X.
  2053             88 AM-REF-RL-R78                 VALUE 'R'.
  2054             88 AM-REF-RL-PR                  VALUE 'P'.
  2055             88 AM-REF-RL-MEAN                VALUE 'M'.
  2056             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2057         16  AM-EARN-METHOD-L              PIC X.
  2058             88 AM-REF-LL-R78                 VALUE 'R'.
  2059             88 AM-REF-LL-PR                  VALUE 'P'.
  2060             88 AM-REF-LL-MEAN                VALUE 'M'.
  2061             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2062         16  AM-EARN-METHOD-A              PIC X.
  2063             88 AM-REF-AH-R78                 VALUE 'R'.
  2064             88 AM-REF-AH-PR                  VALUE 'P'.
  2065             88 AM-REF-AH-MEAN                VALUE 'M'.
  2066             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2067             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2068             88 AM-REF-AH-NET                 VALUE 'N'.
  2069
  2070     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2071     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2072     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2073
  2074     12  AM-RET-Y-N                        PIC X.
  2075     12  AM-RET-P-E                        PIC X.
  2076     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2077     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2078     12  AM-RET-GRP                        PIC X(6).
  2079     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2080         16  AM-POOL-PRIME                 PIC XXX.
  2081         16  AM-POOL-SUB                   PIC XXX.
  2082     12  AM-RETRO-EARNINGS.
  2083         16  AM-RET-EARN-R                 PIC X.
  2084         16  AM-RET-EARN-L                 PIC X.
  2085         16  AM-RET-EARN-A                 PIC X.
  2086     12  AM-RET-ST-TAX-USE                 PIC X.
  2087         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2088         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6504.cbl
  2089     12  AM-RETRO-BEG-EARNINGS.
  2090         16  AM-RET-BEG-EARN-R             PIC X.
  2091         16  AM-RET-BEG-EARN-L             PIC X.
  2092         16  AM-RET-BEG-EARN-A             PIC X.
  2093     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2094     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2095
  2096     12  AM-USER-SELECT-OPTIONS.
  2097         16  AM-USER-SELECT-1              PIC X(10).
  2098         16  AM-USER-SELECT-2              PIC X(10).
  2099         16  AM-USER-SELECT-3              PIC X(10).
  2100         16  AM-USER-SELECT-4              PIC X(10).
  2101         16  AM-USER-SELECT-5              PIC X(10).
  2102
  2103     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2104
  2105     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2106
  2107     12  AM-RPT045A-SWITCH                 PIC X.
  2108         88  RPT045A-OFF                   VALUE 'N'.
  2109
  2110     12  AM-INSURANCE-LIMITS.
  2111         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2112         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2113
  2114     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2115         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2116
  2117     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2118         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2119         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2120
  2121     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2122
  2123     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2124     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2125     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2126     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2127     12  FILLER                            PIC X(5).
  2128     12  AM-REPORT-CODE-3                  PIC X(10).
  2129*    12  FILLER                            PIC X(22).
  2130
  2131     12  AM-RESERVE-DATE.
  2132         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2133         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2134         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2135
  2136     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2137     12  AM-NOTIFICATION-TYPES.
  2138         16  AM-NOTIF-OF-LETTERS           PIC X.
  2139         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2140         16  AM-NOTIF-OF-REPORTS           PIC X.
  2141         16  AM-NOTIF-OF-STATUS            PIC X.
  2142
  2143     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2144         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2145         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2146         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6504.cbl
  2147         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2148
  2149     12  AM-BENEFIT-CONTROLS.
  2150         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2151             20  AM-BENEFIT-CODE           PIC XX.
  2152             20  AM-BENEFIT-TYPE           PIC X.
  2153             20  AM-BENEFIT-REVISION       PIC XXX.
  2154             20  AM-BENEFIT-REM-TERM       PIC X.
  2155             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2156             20  FILLER                    PIC XX.
  2157         16  FILLER                        PIC X(80).
  2158
  2159     12  AM-TRANSFER-DATA.
  2160         16  AM-TRANSFERRED-FROM.
  2161             20  AM-TRNFROM-CARRIER        PIC X.
  2162             20  AM-TRNFROM-GROUPING.
  2163                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2164                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2165             20  AM-TRNFROM-STATE          PIC XX.
  2166             20  AM-TRNFROM-ACCOUNT.
  2167                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2168                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2169             20  AM-TRNFROM-DTE            PIC XX.
  2170         16  AM-TRANSFERRED-TO.
  2171             20  AM-TRNTO-CARRIER          PIC X.
  2172             20  AM-TRNTO-GROUPING.
  2173                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2174                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2175             20  AM-TRNTO-STATE            PIC XX.
  2176             20  AM-TRNTO-ACCOUNT.
  2177                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2178                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2179             20  AM-TRNTO-DTE              PIC XX.
  2180         16  FILLER                        PIC X(10).
  2181
  2182     12  AM-SAVED-REMIT-TO                 PIC 99.
  2183
  2184     12  AM-COMM-STRUCTURE-SAVED.
  2185         16  AM-DEFN-1-SAVED.
  2186             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2187                 24  AM-AGT-SV             PIC X(10).
  2188                 24  AM-COM-TYP-SV         PIC X.
  2189                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2190                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2191                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2192                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2193                 24  FILLER                PIC X.
  2194                 24  AM-GL-CODES-SV        PIC X.
  2195                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2196                 24  FILLER                PIC X.
  2197         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2198             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2199                 24  FILLER                PIC X(11).
  2200                 24  AM-L-COMA-SV          PIC XXX.
  2201                 24  AM-J-COMA-SV          PIC XXX.
  2202                 24  AM-A-COMA-SV          PIC XXX.
  2203                 24  FILLER                PIC X(6).
  2204
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6504.cbl
  2205     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2206         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2207            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2208            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2209            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2210
  2211     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2212     12  FILLER                            PIC X(120).
  2213
  2214     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2215         16  AM-CONTROL-NAME               PIC X(30).
  2216         16  AM-EXECUTIVE-ONE.
  2217             20  AM-EXEC1-NAME             PIC X(15).
  2218             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2219                                                          COMP-3.
  2220             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2221                                                          COMP-3.
  2222         16  AM-EXECUTIVE-TWO.
  2223             20  AM-EXEC2-NAME             PIC X(15).
  2224             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2225                                                          COMP-3.
  2226             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2227                                                          COMP-3.
  2228
  2229     12  AM-RETRO-ADDITIONAL-DATA.
  2230         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2231         16  AM-RETRO-PREM-P-E             PIC X.
  2232         16  AM-RETRO-CLMS-P-I             PIC X.
  2233         16  AM-RETRO-RET-BRACKET-LF.
  2234             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2235                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2236                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2237             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2238                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2239                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2240             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2241                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2242                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2243         16  AM-RETRO-RET-BRACKET-AH.
  2244             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2245                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2246                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2247                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2248             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2249                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2250                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2251             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2252                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2253                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2254
  2255     12  AM-COMMENTS.
  2256         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2257
  2258     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2259         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2260         16  AM-FLI-BILLING-CODE           PIC X.
  2261         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2262         16  AM-FLI-UNITED-IDENT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6504.cbl
  2263         16  AM-FLI-INTEREST-LOST-DATA.
  2264             20  AM-FLI-BANK-NO            PIC X(5).
  2265             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2266             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2267             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2268         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2269             20  AM-FLI-AGT                PIC X(9).
  2270             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2271             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2272         16  FILLER                        PIC X(102).
  2273
  2274     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2275         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2276             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2277             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2278             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2279             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2280             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2281         16  FILLER                          PIC X(10).
  2282******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6504.cbl
  2284*                          COPY ELCCNTL.
  2285******************************************************************
  2286*                                                                *
  2287*                                                                *
  2288*                            ELCCNTL.                            *
  2289*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2290*                            VMOD=2.059                          *
  2291*                                                                *
  2292*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2293*                                                                *
  2294*   FILE TYPE = VSAM,KSDS                                        *
  2295*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2296*                                                                *
  2297*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2298*       ALTERNATE INDEX = NONE                                   *
  2299*                                                                *
  2300*   LOG = YES                                                    *
  2301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2302******************************************************************
  2303*                   C H A N G E   L O G
  2304*
  2305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2306*-----------------------------------------------------------------
  2307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2308* EFFECTIVE    NUMBER
  2309*-----------------------------------------------------------------
  2310* 082503                   PEMA  ADD BENEFIT GROUP
  2311* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2312* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2313* 092705    2005050300006  PEMA  ADD SPP LEASES
  2314* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2315* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2316* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2317* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2318******************************************************************
  2319*
  2320 01  CONTROL-FILE.
  2321     12  CF-RECORD-ID                       PIC XX.
  2322         88  VALID-CF-ID                        VALUE 'CF'.
  2323
  2324     12  CF-CONTROL-PRIMARY.
  2325         16  CF-COMPANY-ID                  PIC XXX.
  2326         16  CF-RECORD-TYPE                 PIC X.
  2327             88  CF-COMPANY-MASTER              VALUE '1'.
  2328             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2329             88  CF-STATE-MASTER                VALUE '3'.
  2330             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2331             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2332             88  CF-CARRIER-MASTER              VALUE '6'.
  2333             88  CF-MORTALITY-MASTER            VALUE '7'.
  2334             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2335             88  CF-TERMINAL-MASTER             VALUE '9'.
  2336             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2337             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2338             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2339             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2340             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2341             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6504.cbl
  2342             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2343             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2344             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2345         16  CF-ACCESS-CD-GENL              PIC X(4).
  2346         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2347             20  CF-PROCESSOR               PIC X(4).
  2348         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2349             20  CF-STATE-CODE              PIC XX.
  2350             20  FILLER                     PIC XX.
  2351         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2352             20  FILLER                     PIC XX.
  2353             20  CF-HI-BEN-IN-REC           PIC XX.
  2354         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2355             20  FILLER                     PIC XXX.
  2356             20  CF-CARRIER-CNTL            PIC X.
  2357         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2358             20  FILLER                     PIC XX.
  2359             20  CF-HI-TYPE-IN-REC          PIC 99.
  2360         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2361             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2362                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2363             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2364             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2365         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2366             20  FILLER                     PIC X.
  2367             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2368         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2369             20  FILLER                     PIC XX.
  2370             20  CF-MORTGAGE-PLAN           PIC XX.
  2371         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2372
  2373     12  CF-LAST-MAINT-DT                   PIC XX.
  2374     12  CF-LAST-MAINT-BY                   PIC X(4).
  2375     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2376
  2377     12  CF-RECORD-BODY                     PIC X(728).
  2378
  2379
  2380****************************************************************
  2381*             COMPANY MASTER RECORD                            *
  2382****************************************************************
  2383
  2384     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2385         16  CF-COMPANY-ADDRESS.
  2386             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2387             20  CF-CL-IN-CARE-OF           PIC X(30).
  2388             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2389             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2390             20  CF-CL-CITY-STATE           PIC X(30).
  2391             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2392             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2393         16  CF-COMPANY-CD                  PIC X.
  2394         16  CF-COMPANY-PASSWORD            PIC X(8).
  2395         16  CF-SECURITY-OPTION             PIC X.
  2396             88  ALL-SECURITY                   VALUE '1'.
  2397             88  COMPANY-VERIFY                 VALUE '2'.
  2398             88  PROCESSOR-VERIFY               VALUE '3'.
  2399             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6504.cbl
  2400             88  ALL-BUT-TERM                   VALUE '5'.
  2401         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2402             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2403         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2404             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2405         16  CF-INFORCE-LOCATION            PIC X.
  2406             88  CERTS-ARE-ONLINE               VALUE '1'.
  2407             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2408             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2409         16  CF-LOWER-CASE-LETTERS          PIC X.
  2410         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2411             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2412             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2413             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2414             88  CF-ACCNT-CNTL                  VALUE '3'.
  2415             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2416
  2417         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2418         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2419
  2420         16  CF-LGX-CREDIT-USER             PIC X.
  2421             88  CO-IS-NOT-USER                 VALUE 'N'.
  2422             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2423
  2424         16 CF-CREDIT-CALC-CODES.
  2425             20  CF-CR-REM-TERM-CALC PIC X.
  2426               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2427               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2428               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2429               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2430               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2431               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2432               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2433             20  CF-CR-R78-METHOD           PIC X.
  2434               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2435               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2436
  2437         16  CF-CLAIM-CONTROL-COUNTS.
  2438             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2439                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2440
  2441             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2442                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2443
  2444             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2445                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2446
  2447             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2448                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2449
  2450         16  CF-CURRENT-MONTH-END           PIC XX.
  2451
  2452         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2453             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2454             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2455             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2456             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2457                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6504.cbl
  2458                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2459             20  CF-CO-PREM-REJECT-SW       PIC X.
  2460                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2461                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2462             20  CF-CO-REF-REJECT-SW        PIC X.
  2463                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2464                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2465
  2466         16  CF-CO-REPORTING-DT             PIC XX.
  2467         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2468         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2469           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2470           88  CF-CO-MONTH-END                  VALUE '1'.
  2471
  2472         16  CF-LGX-CLAIM-USER              PIC X.
  2473             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2474             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2475
  2476         16  CF-CREDIT-EDIT-CONTROLS.
  2477             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2478             20  CF-MIN-AGE                 PIC 99.
  2479             20  CF-DEFAULT-AGE             PIC 99.
  2480             20  CF-MIN-TERM                PIC S999      COMP-3.
  2481             20  CF-MAX-TERM                PIC S999      COMP-3.
  2482             20  CF-DEFAULT-SEX             PIC X.
  2483             20  CF-JOINT-AGE-INPUT         PIC X.
  2484                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2485             20  CF-BIRTH-DATE-INPUT        PIC X.
  2486                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2487             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2488                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2489                 88  CF-ZERO-CARRIER            VALUE '1'.
  2490                 88  CF-ZERO-GROUPING           VALUE '2'.
  2491                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2492             20  CF-EDIT-SW                 PIC X.
  2493                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2494             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2495             20  CF-CR-PR-METHOD            PIC X.
  2496               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2497               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2498             20  FILLER                     PIC X.
  2499
  2500         16  CF-CREDIT-MISC-CONTROLS.
  2501             20  CF-REIN-TABLE-SW           PIC X.
  2502                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2503             20  CF-COMP-TABLE-SW           PIC X.
  2504                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2505             20  CF-EXPERIENCE-RETENTION-AGE
  2506                                            PIC S9        COMP-3.
  2507             20  CF-CONVERSION-DT           PIC XX.
  2508             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2509             20  CF-RUN-FREQUENCY-SW        PIC X.
  2510                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2511                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2512
  2513             20  CF-CR-CHECK-NO-CONTROL.
  2514                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2515                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6504.cbl
  2516                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2517                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2518                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2519                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2520
  2521                 24  CF-CR-CHECK-COUNT       REDEFINES
  2522                     CF-CR-CHECK-COUNTER      PIC X(4).
  2523
  2524                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2525                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2526
  2527                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2528                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2529                 24  CF-MAIL-PROCESSING       PIC X.
  2530                     88  MAIL-PROCESSING          VALUE 'Y'.
  2531
  2532         16  CF-MISC-SYSTEM-CONTROL.
  2533             20  CF-SYSTEM-C                 PIC X.
  2534                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2535             20  CF-SYSTEM-D                 PIC X.
  2536                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2537             20  CF-SOC-SEC-NO-SW            PIC X.
  2538                 88  SOC-SEC-NO-USED             VALUE '1'.
  2539             20  CF-MEMBER-NO-SW             PIC X.
  2540                 88  MEMBER-NO-USED              VALUE '1'.
  2541             20  CF-TAX-ID-NUMBER            PIC X(11).
  2542             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2543             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2544                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2545                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2546                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2547                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2548             20  CF-SYSTEM-E                 PIC X.
  2549                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2550
  2551         16  CF-LGX-LIFE-USER               PIC X.
  2552             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2553             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2554
  2555         16  CF-CR-MONTH-END-DT             PIC XX.
  2556
  2557         16  CF-FILE-MAINT-DATES.
  2558             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2559                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2560             20  CF-LAST-BATCH       REDEFINES
  2561                 CF-LAST-BATCH-NO               PIC X(4).
  2562             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2563             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2564             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2565             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2566             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2567             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2568             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2569             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2570             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2571             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2572
  2573         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6504.cbl
  2574         16  FILLER                         PIC X.
  2575
  2576         16  CF-ALT-MORT-CODE               PIC X(4).
  2577         16  CF-MEMBER-CAPTION              PIC X(10).
  2578
  2579         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2580             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2581             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2582             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2583             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2584             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2585
  2586         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2587
  2588         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2589         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2590         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2591         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2592
  2593         16  CF-AH-OVERRIDE-L1              PIC X.
  2594         16  CF-AH-OVERRIDE-L2              PIC XX.
  2595         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2596         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2597
  2598         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2599         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2600
  2601         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2602         16  CF-AR-LAST-EL860-DT            PIC XX.
  2603         16  CF-MP-MONTH-END-DT             PIC XX.
  2604
  2605         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2606         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2607             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2608
  2609         16  CF-AR-MONTH-END-DT             PIC XX.
  2610
  2611         16  CF-CRDTCRD-USER                PIC X.
  2612             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2613             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2614
  2615         16  CF-CC-MONTH-END-DT             PIC XX.
  2616
  2617         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2618
  2619         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2620             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2621             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2622             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2623         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2624         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2625         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2626         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2627             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2628             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2629         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2630         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2631         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6504.cbl
  2632             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2633         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2634
  2635         16  CF-CL-ZIP-CODE.
  2636             20  CF-CL-ZIP-PRIME.
  2637                 24  CF-CL-ZIP-1ST          PIC X.
  2638                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2639                 24  FILLER                 PIC X(4).
  2640             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2641         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2642             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2643             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2644             20  FILLER                     PIC XXX.
  2645
  2646         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2647         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2648         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2649         16  CF-CO-OPTION-START-DATE        PIC XX.
  2650         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2651           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2652                                                      '3' '4'.
  2653           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2654           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2655           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2656           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2657           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2658           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2659
  2660         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2661
  2662         16  CF-PAYMENT-APPROVAL-LEVELS.
  2663             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2664             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2665             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2666             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2667             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2668             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2669
  2670         16  CF-END-USER-REPORTING-USER     PIC X.
  2671             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2672             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2673
  2674         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2675             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2676             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2677
  2678         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2679
  2680         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2681         16  FILLER                         PIC X.
  2682
  2683         16  CF-CREDIT-ARCHIVE-CNTL.
  2684             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2685             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2686             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2687
  2688         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2689
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6504.cbl
  2690         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2691             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2692             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2693
  2694         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2695             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2696             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2697
  2698         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2699
  2700         16  CF-CO-ACH-ID-CODE              PIC  X.
  2701             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2702             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2703             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2704         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2705         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2706         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2707         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2708         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2709         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2710         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2711         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2712         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2713                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2714         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2715                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2716
  2717         16  CF-CO-OVER-SHORT.
  2718             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2719             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2720
  2721*         16  FILLER                         PIC X(102).
  2722         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2723             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2724             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2725
  2726         16  CF-AH-APPROVAL-DAYS.
  2727             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2728             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2729             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2730             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2731
  2732         16  FILLER                         PIC X(82).
  2733****************************************************************
  2734*             PROCESSOR/USER RECORD                            *
  2735****************************************************************
  2736
  2737     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2738         16  CF-PROCESSOR-NAME              PIC X(30).
  2739         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2740         16  CF-PROCESSOR-TITLE             PIC X(26).
  2741         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2742                 88  MESSAGE-YES                VALUE 'Y'.
  2743                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2744
  2745*****************************************************
  2746****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2747****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6504.cbl
  2748****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2749****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2750*****************************************************
  2751
  2752         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2753             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2754             20  CF-APPLICATION-FORCE       PIC X.
  2755             20  CF-INDIVIDUAL-APP.
  2756                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2757                     28  CF-BROWSE-APP      PIC X.
  2758                     28  CF-UPDATE-APP      PIC X.
  2759
  2760         16  CF-CURRENT-TERM-ON             PIC X(4).
  2761         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2762             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2763             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2764             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2765             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2766             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2767             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2768             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2769         16  CF-PROCESSOR-CARRIER           PIC X.
  2770             88  NO-CARRIER-SECURITY            VALUE ' '.
  2771         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2772             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2773         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2774             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2775         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2776             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2777
  2778         16  CF-PROC-SYS-ACCESS-SW.
  2779             20  CF-PROC-CREDIT-CLAIMS-SW.
  2780                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2781                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2782                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2783                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2784             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2785                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2786                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2787             20  CF-PROC-LIFE-GNRLDGR-SW.
  2788                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2789                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2790                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2791                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2792             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2793                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2794                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2795         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2796             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2797             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2798         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2799
  2800         16  CF-APPROVAL-LEVEL                  PIC X.
  2801             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2802             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2803             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2804             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2805
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6504.cbl
  2806         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2807
  2808         16  CF-LANGUAGE-TYPE                   PIC X.
  2809             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2810             88  CF-LANG-IS-FR                      VALUE 'F'.
  2811         16  FILLER                             PIC  X(240).
  2812
  2813****************************************************************
  2814*             PROCESSOR/REMINDERS RECORD                       *
  2815****************************************************************
  2816
  2817     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2818         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2819             20  CF-START-REMIND-DT         PIC XX.
  2820             20  CF-END-REMIND-DT           PIC XX.
  2821             20  CF-REMINDER-TEXT           PIC X(50).
  2822         16  FILLER                         PIC X(296).
  2823
  2824
  2825****************************************************************
  2826*             STATE MASTER RECORD                              *
  2827****************************************************************
  2828
  2829     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2830         16  CF-STATE-ABBREVIATION          PIC XX.
  2831         16  CF-STATE-NAME                  PIC X(25).
  2832         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2833         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2834             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2835             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2836             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2837             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2838                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2839                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2840             20  CF-ST-PREM-REJECT-SW       PIC X.
  2841                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2842                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2843             20  CF-ST-REF-REJECT-SW        PIC X.
  2844                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2845                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2846         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2847         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2848         16  CF-ST-REFUND-RULES.
  2849             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2850             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2851             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2852         16  CF-ST-FST-PMT-EXTENSION.
  2853             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2854             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2855                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2856                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2857                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2858                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2859         16  CF-ST-STATE-CALL.
  2860             20  CF-ST-CALL-UNEARNED        PIC X.
  2861             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2862             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2863         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6504.cbl
  2864             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2865             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2866         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2867         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2868         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2869         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2870         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2871         16  FILLER                         PIC X.
  2872         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2873             20  CF-ST-BENEFIT-CD           PIC XX.
  2874             20  CF-ST-BENEFIT-KIND         PIC X.
  2875                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2876                 88  CF-ST-AH-KIND              VALUE 'A'.
  2877             20  CF-ST-REM-TERM-CALC        PIC X.
  2878                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2879                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2880                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2881                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2882                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2883                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2884                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2885                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2886
  2887             20  CF-ST-REFUND-CALC          PIC X.
  2888                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2889                 88  ST-REFD-BY-R78             VALUE '1'.
  2890                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2891                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2892                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2893                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2894                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2895                 88  ST-REFD-UTAH               VALUE '7'.
  2896                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2897                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2898                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2899
  2900             20  CF-ST-EARNING-CALC         PIC X.
  2901                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2902                 88  ST-EARN-BY-R78             VALUE '1'.
  2903                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2904                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2905                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2906                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2907                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2908                 88  ST-EARN-MEAN               VALUE '8'.
  2909                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2910
  2911             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2912                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2913                 88  ST-OVRD-BY-R78             VALUE '1'.
  2914                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2915                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2916                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2917                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2918                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2919                 88  ST-OVRD-MEAN               VALUE '8'.
  2920                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2921             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6504.cbl
  2922
  2923         16  CF-ST-COMMISSION-CAPS.
  2924             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2925             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2926             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2927             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2928         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2929                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2930
  2931         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2932
  2933         16  CF-ST-STATUTORY-INTEREST.
  2934             20  CF-ST-STAT-DATE-FROM       PIC X.
  2935                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2936                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2937             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2938             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2939             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2940             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2941             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2942
  2943         16  CF-ST-OVER-SHORT.
  2944             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2945             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2946
  2947         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2948
  2949         16  CF-ST-RT-CALC                  PIC X.
  2950
  2951         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2952         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2953         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2954         16  CF-ST-RF-LR-CALC               PIC X.
  2955         16  CF-ST-RF-LL-CALC               PIC X.
  2956         16  CF-ST-RF-LN-CALC               PIC X.
  2957         16  CF-ST-RF-AH-CALC               PIC X.
  2958         16  CF-ST-RF-CP-CALC               PIC X.
  2959*        16  FILLER                         PIC X(206).
  2960*CIDMOD         16  FILLER                         PIC X(192).
  2961         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2962             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2963         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2964         16  FILLER                         PIC X(187).
  2965
  2966****************************************************************
  2967*             BENEFIT MASTER RECORD                            *
  2968****************************************************************
  2969
  2970     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2971         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2972             20  CF-BENEFIT-CODE            PIC XX.
  2973             20  CF-BENEFIT-NUMERIC  REDEFINES
  2974                 CF-BENEFIT-CODE            PIC XX.
  2975             20  CF-BENEFIT-ALPHA           PIC XXX.
  2976             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2977             20  CF-BENEFIT-COMMENT         PIC X(10).
  2978
  2979             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6504.cbl
  2980                 88  CF-REDUCING                VALUE 'R'.
  2981                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2982
  2983             20  CF-SPECIAL-CALC-CD         PIC X.
  2984                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2985                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2986                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2987                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2988                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2989                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2990                 88  CF-FARM-PLAN               VALUE 'F'.
  2991                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2992                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2993                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2994                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2995                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2996                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2997                 88  CF-PRUDENTIAL              VALUE 'P'.
  2998                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2999                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3000                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3001                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3002                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3003                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3004
  3005             20  CF-JOINT-INDICATOR         PIC X.
  3006                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3007
  3008*            20  FILLER                     PIC X(12).
  3009             20  FILLER                     PIC X(11).
  3010             20  CF-BENEFIT-CATEGORY        PIC X.
  3011             20  CF-LOAN-TYPE               PIC X(8).
  3012
  3013             20  CF-CO-REM-TERM-CALC        PIC X.
  3014                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3015                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3016                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3017                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3018                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3019
  3020             20  CF-CO-EARNINGS-CALC        PIC X.
  3021                 88  CO-EARN-BY-R78             VALUE '1'.
  3022                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3023                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3024                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3025                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3026                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3027                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3028                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3029
  3030             20  CF-CO-REFUND-CALC          PIC X.
  3031                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3032                 88  CO-REFD-BY-R78             VALUE '1'.
  3033                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3034                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3035                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3036                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3037                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6504.cbl
  3038                 88  CO-REFD-MEAN               VALUE '8'.
  3039                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3040                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3041                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3042
  3043             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3044                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3045                 88  CO-OVRD-BY-R78             VALUE '1'.
  3046                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3047                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3048                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3049                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3050                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3051                 88  CO-OVRD-MEAN               VALUE '8'.
  3052                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3053
  3054             20  CF-CO-BEN-I-G-CD           PIC X.
  3055                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3056                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3057                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3058
  3059         16  FILLER                         PIC X(304).
  3060
  3061
  3062****************************************************************
  3063*             CARRIER MASTER RECORD                            *
  3064****************************************************************
  3065
  3066     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3067         16  CF-ADDRESS-DATA.
  3068             20  CF-MAIL-TO-NAME            PIC X(30).
  3069             20  CF-IN-CARE-OF              PIC X(30).
  3070             20  CF-ADDRESS-LINE-1          PIC X(30).
  3071             20  CF-ADDRESS-LINE-2          PIC X(30).
  3072             20  CF-CITY-STATE              PIC X(30).
  3073             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3074             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3075
  3076         16  CF-CLAIM-NO-CONTROL.
  3077             20  CF-CLAIM-NO-METHOD         PIC X.
  3078                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3079                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3080                 88  CLAIM-NO-SEQ               VALUE '3'.
  3081                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3082             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3083                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3084                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3085                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3086
  3087         16  CF-CHECK-NO-CONTROL.
  3088             20  CF-CHECK-NO-METHOD         PIC X.
  3089                 88  CHECK-NO-MANUAL            VALUE '1'.
  3090                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3091                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3092                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3093             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3094                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3095
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6504.cbl
  3096         16  CF-DOMICILE-STATE              PIC XX.
  3097
  3098         16  CF-EXPENSE-CONTROLS.
  3099             20  CF-EXPENSE-METHOD          PIC X.
  3100                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3101                 88  DOLLARS-PER-PMT            VALUE '2'.
  3102                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3103                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3104             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3105             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3106
  3107         16  CF-CORRESPONDENCE-CONTROL.
  3108             20  CF-LETTER-RESEND-OPT       PIC X.
  3109                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3110                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3111             20  FILLER                     PIC X(4).
  3112
  3113         16  CF-RESERVE-CONTROLS.
  3114             20  CF-MANUAL-SW               PIC X.
  3115                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3116             20  CF-FUTURE-SW               PIC X.
  3117                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3118             20  CF-PTC-SW                  PIC X.
  3119                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3120             20  CF-IBNR-SW                 PIC X.
  3121                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3122             20  CF-PTC-LF-SW               PIC X.
  3123                 88  CF-LF-PTC-USED             VALUE '1'.
  3124             20  CF-CDT-ACCESS-METHOD       PIC X.
  3125                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3126                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3127                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3128             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3129
  3130         16  CF-CLAIM-CALC-METHOD           PIC X.
  3131             88  360-PLUS-MONTHS                VALUE '1'.
  3132             88  365-PLUS-MONTHS                VALUE '2'.
  3133             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3134             88  360-DAILY                      VALUE '4'.
  3135             88  365-DAILY                      VALUE '5'.
  3136
  3137         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3138         16  FILLER                         PIC X(11).
  3139
  3140         16  CF-LIMIT-AMOUNTS.
  3141             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3142             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3143             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3144             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3145             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3146             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3147             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3148             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3149             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3150             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3151
  3152         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3153         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6504.cbl
  3154         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3155
  3156         16  CF-ZIP-CODE.
  3157             20  CF-ZIP-PRIME.
  3158                 24  CF-ZIP-1ST             PIC X.
  3159                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3160                 24  FILLER                 PIC X(4).
  3161             20  CF-ZIP-PLUS4               PIC X(4).
  3162         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3163             20  CF-CAN-POSTAL-1            PIC XXX.
  3164             20  CF-CAN-POSTAL-2            PIC XXX.
  3165             20  FILLER                     PIC XXX.
  3166
  3167         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3168         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3169         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3170
  3171         16  CF-RATING-SWITCH               PIC X.
  3172             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3173             88  CF-NO-RATING                   VALUE 'N'.
  3174
  3175         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3176
  3177         16  CF-CARRIER-OVER-SHORT.
  3178             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3179             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3180
  3181         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3182         16  CF-SECPAY-SWITCH               PIC X.
  3183             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3184             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3185         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3186         16  FILLER                         PIC X(448).
  3187*        16  FILLER                         PIC X(452).
  3188
  3189
  3190****************************************************************
  3191*             MORTALITY MASTER RECORD                          *
  3192****************************************************************
  3193
  3194     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3195         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3196                                INDEXED BY CF-MORT-NDX.
  3197             20  CF-MORT-TABLE              PIC X(5).
  3198             20  CF-MORT-TABLE-TYPE         PIC X.
  3199                 88  CF-MORT-JOINT              VALUE 'J'.
  3200                 88  CF-MORT-SINGLE             VALUE 'S'.
  3201                 88  CF-MORT-COMBINED           VALUE 'C'.
  3202                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3203                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3204             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3205             20  CF-MORT-AGE-METHOD         PIC XX.
  3206                 88  CF-AGE-LAST                VALUE 'AL'.
  3207                 88  CF-AGE-NEAR                VALUE 'AN'.
  3208             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3209             20  CF-MORT-ADJUSTMENT-DIRECTION
  3210                                            PIC X.
  3211                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6504.cbl
  3212                 88  CF-PLUS                    VALUE '+'.
  3213             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3214             20  CF-MORT-JOINT-CODE         PIC X.
  3215                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3216             20  CF-MORT-PC-Q               PIC X.
  3217                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3218             20  CF-MORT-TABLE-CODE         PIC X(4).
  3219             20  CF-MORT-COMMENTS           PIC X(15).
  3220             20  FILLER                     PIC X(14).
  3221
  3222         16  FILLER                         PIC X(251).
  3223
  3224
  3225****************************************************************
  3226*             BUSSINESS TYPE MASTER RECORD                     *
  3227****************************************************************
  3228
  3229     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3230* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3231* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3232* AND RECORD 05 IS TYPES 81-99
  3233         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3234             20  CF-BUSINESS-TITLE          PIC  X(19).
  3235             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3236                                            PIC S9V9(4) COMP-3.
  3237             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3238             20  FILLER                     PIC  X.
  3239         16  FILLER                         PIC  X(248).
  3240
  3241
  3242****************************************************************
  3243*             TERMINAL MASTER RECORD                           *
  3244****************************************************************
  3245
  3246     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3247
  3248         16  CF-COMPANY-TERMINALS.
  3249             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3250                                  PIC X(4).
  3251         16  FILLER               PIC X(248).
  3252
  3253
  3254****************************************************************
  3255*             LIFE EDIT MASTER RECORD                          *
  3256****************************************************************
  3257
  3258     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3259         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3260             20  CF-LIFE-CODE-IN            PIC XX.
  3261             20  CF-LIFE-CODE-OUT           PIC XX.
  3262         16  FILLER                         PIC X(248).
  3263
  3264
  3265****************************************************************
  3266*             AH EDIT MASTER RECORD                            *
  3267****************************************************************
  3268
  3269     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6504.cbl
  3270         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3271             20  CF-AH-CODE-IN              PIC XXX.
  3272             20  CF-AH-CODE-OUT             PIC XX.
  3273         16  FILLER                         PIC X(248).
  3274
  3275
  3276****************************************************************
  3277*             CREDIBILITY TABLES                               *
  3278****************************************************************
  3279
  3280     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3281         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3282                             INDEXED BY CF-CRDB-NDX.
  3283             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3284             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3285             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3286         16  FILLER                         PIC  X(332).
  3287
  3288
  3289****************************************************************
  3290*             REPORT CUSTOMIZATION RECORD                      *
  3291****************************************************************
  3292
  3293     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3294         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3295             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3296             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3297             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3298**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3299****       A T-TRANSFER.                                   ****
  3300             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3301
  3302         16  FILLER                         PIC XX.
  3303
  3304         16  CF-CARRIER-CNTL-OPT.
  3305             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3306                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3307                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3308             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3309                                            PIC X.
  3310         16  CF-GROUP-CNTL-OPT.
  3311             20  CF-GROUP-OPT-SEQ           PIC 9.
  3312                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3313                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3314             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3315                                            PIC X(6).
  3316         16  CF-STATE-CNTL-OPT.
  3317             20  CF-STATE-OPT-SEQ           PIC 9.
  3318                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3319                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3320             20  CF-STATE-SELECT OCCURS 3 TIMES
  3321                                            PIC XX.
  3322         16  CF-ACCOUNT-CNTL-OPT.
  3323             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3324                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3325                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3326             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3327                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6504.cbl
  3328         16  CF-BUS-TYP-CNTL-OPT.
  3329             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3330                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3331                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3332             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3333                                            PIC XX.
  3334         16  CF-LF-TYP-CNTL-OPT.
  3335             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3336                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3337                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3338             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3339                                            PIC XX.
  3340         16  CF-AH-TYP-CNTL-OPT.
  3341             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3342                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3343                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3344             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3345                                            PIC XX.
  3346         16  CF-REPTCD1-CNTL-OPT.
  3347             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3348                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3349                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3350             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3351                                            PIC X(10).
  3352         16  CF-REPTCD2-CNTL-OPT.
  3353             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3354                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3355                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3356             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3357                                            PIC X(10).
  3358         16  CF-USER1-CNTL-OPT.
  3359             20  CF-USER1-OPT-SEQ           PIC 9.
  3360                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3361                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3362             20  CF-USER1-SELECT OCCURS 3 TIMES
  3363                                            PIC X(10).
  3364         16  CF-USER2-CNTL-OPT.
  3365             20  CF-USER2-OPT-SEQ           PIC 9.
  3366                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3367                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3368             20  CF-USER2-SELECT OCCURS 3 TIMES
  3369                                            PIC X(10).
  3370         16  CF-USER3-CNTL-OPT.
  3371             20  CF-USER3-OPT-SEQ           PIC 9.
  3372                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3373                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3374             20  CF-USER3-SELECT OCCURS 3 TIMES
  3375                                            PIC X(10).
  3376         16  CF-USER4-CNTL-OPT.
  3377             20  CF-USER4-OPT-SEQ           PIC 9.
  3378                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3379                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3380             20  CF-USER4-SELECT OCCURS 3 TIMES
  3381                                            PIC X(10).
  3382         16  CF-USER5-CNTL-OPT.
  3383             20  CF-USER5-OPT-SEQ           PIC 9.
  3384                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3385                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6504.cbl
  3386             20  CF-USER5-SELECT OCCURS 3 TIMES
  3387                                            PIC X(10).
  3388         16  CF-REINS-CNTL-OPT.
  3389             20  CF-REINS-OPT-SEQ           PIC 9.
  3390                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3391                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3392             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3393                 24  CF-REINS-PRIME         PIC XXX.
  3394                 24  CF-REINS-SUB           PIC XXX.
  3395
  3396         16  CF-AGENT-CNTL-OPT.
  3397             20  CF-AGENT-OPT-SEQ           PIC 9.
  3398                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3399                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3400             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3401                                            PIC X(10).
  3402
  3403         16  FILLER                         PIC X(43).
  3404
  3405         16  CF-LOSS-RATIO-SELECT.
  3406             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3407             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3408         16  CF-ENTRY-DATE-SELECT.
  3409             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3410             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3411         16  CF-EFFECTIVE-DATE-SELECT.
  3412             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3413             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3414
  3415         16  CF-EXCEPTION-LIST-IND          PIC X.
  3416             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3417
  3418         16  FILLER                         PIC X(318).
  3419
  3420****************************************************************
  3421*                  EXCEPTION REPORTING RECORD                  *
  3422****************************************************************
  3423
  3424     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3425         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3426             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3427
  3428         16  CF-COMBINED-LIFE-AH-OPT.
  3429             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3430             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3431             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3432             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3433
  3434         16  CF-LIFE-OPT.
  3435             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3436             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3437             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3438             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3439             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3440             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3441             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3442             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3443             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6504.cbl
  3444             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3445
  3446         16  CF-AH-OPT.
  3447             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3448             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3449             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3450             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3451             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3452             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3453             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3454             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3455             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3456             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3457
  3458         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3459             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3460             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3461             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3462
  3463         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3464
  3465         16  FILLER                         PIC X(673).
  3466
  3467
  3468****************************************************************
  3469*             MORTGAGE SYSTEM PLAN RECORD                      *
  3470****************************************************************
  3471
  3472     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3473         16  CF-PLAN-TYPE                   PIC X.
  3474             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3475             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3476             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3477         16  CF-PLAN-ABBREV                 PIC XXX.
  3478         16  CF-PLAN-DESCRIPT               PIC X(10).
  3479         16  CF-PLAN-NOTES                  PIC X(20).
  3480         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3481         16  CF-PLAN-UNDERWRITING.
  3482             20  CF-PLAN-TERM-DATA.
  3483                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3484                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3485             20  CF-PLAN-AGE-DATA.
  3486                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3487                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3488                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3489             20  CF-PLAN-BENEFIT-DATA.
  3490                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3491                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3492                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3493                                            PIC S9(7)V99  COMP-3.
  3494         16  CF-PLAN-POLICY-FORMS.
  3495             20  CF-POLICY-FORM             PIC X(12).
  3496             20  CF-MASTER-APPLICATION      PIC X(12).
  3497             20  CF-MASTER-POLICY           PIC X(12).
  3498         16  CF-PLAN-RATING.
  3499             20  CF-RATE-CODE               PIC X(5).
  3500             20  CF-SEX-RATING              PIC X.
  3501                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6504.cbl
  3502                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3503             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3504             20  CF-SUB-STD-TYPE            PIC X.
  3505                 88  CF-PCT-OF-PREM            VALUE '1'.
  3506                 88  CF-PCT-OF-BENE            VALUE '2'.
  3507         16  CF-PLAN-PREM-TOLERANCES.
  3508             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3509             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3510         16  CF-PLAN-PYMT-TOLERANCES.
  3511             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3512             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3513         16  CF-PLAN-MISC-DATA.
  3514             20  FILLER                     PIC X.
  3515             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3516             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3517         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3518         16  CF-PLAN-IND-GRP                PIC X.
  3519             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3520                                                     '1'.
  3521             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3522                                                     '2'.
  3523         16  CF-MIB-SEARCH-SW               PIC X.
  3524             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3525             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3526             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3527             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3528         16  CF-ALPHA-SEARCH-SW             PIC X.
  3529             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3530             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3531             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3532             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3533             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3534             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3535             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3536             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3537             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3538             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3539                                                     'A' 'B' 'C'
  3540                                                     'X' 'Y' 'Z'.
  3541         16  CF-EFF-DT-RULE-SW              PIC X.
  3542             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3543             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3544             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3545             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3546             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3547         16  FILLER                         PIC X(4).
  3548         16  CF-HEALTH-QUESTIONS            PIC X.
  3549             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3550         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3551         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3552         16  CF-PLAN-SNGL-JNT               PIC X.
  3553             88  CF-COMBINED-PLAN              VALUE 'C'.
  3554             88  CF-JNT-PLAN                   VALUE 'J'.
  3555             88  CF-SNGL-PLAN                  VALUE 'S'.
  3556         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3557         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3558         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3559         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6504.cbl
  3560         16  CF-RERATE-CNTL                 PIC  X.
  3561             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3562             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3563             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3564             88  CF-AUTO-RECALC                 VALUE '4'.
  3565         16  CF-BENEFIT-TYPE                PIC  X.
  3566             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3567             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3568         16  CF-POLICY-FEE                  PIC S999V99
  3569                                                    COMP-3.
  3570         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3571         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3572         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3573         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3574         16  FILLER                         PIC  X(32).
  3575         16  CF-TERMINATION-FORM            PIC  X(04).
  3576         16  FILLER                         PIC  X(08).
  3577         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3578                                                       COMP-3.
  3579         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3580         16  CF-ISSUE-LETTER                PIC  X(4).
  3581         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3582         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3583             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3584             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3585         16  CF-MP-REFUND-CALC              PIC X.
  3586             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3587             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3588             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3589             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3590             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3591             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3592             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3593             88  CF-MP-REFD-MEAN                VALUE '8'.
  3594         16  CF-ALT-RATE-CODE               PIC  X(5).
  3595
  3596
  3597         16  FILLER                         PIC X(498).
  3598****************************************************************
  3599*             MORTGAGE COMPANY MASTER RECORD                   *
  3600****************************************************************
  3601
  3602     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3603         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3604         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3605             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3606             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3607             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3608             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3609             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3610
  3611         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3612         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3613         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3614         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3615         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3616
  3617         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6504.cbl
  3618             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3619         16  CF-MP-RECON-USE-IND            PIC X(1).
  3620             88  CF-MP-USE-RECON             VALUE 'Y'.
  3621         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3622             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3623         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3624             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3625             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3626         16  FILLER                         PIC X(1).
  3627         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3628             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3629         16  CF-MORTG-MIB-VERSION           PIC X.
  3630             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3631             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3632             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3633         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3634             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3635                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3636             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3637                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3638             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3639                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3640             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3641                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3642             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3643                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3644             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3645                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3646         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3647         16  FILLER                         PIC X(7).
  3648         16  CF-MORTG-DESTINATION-SYMBOL.
  3649             20  CF-MORTG-MIB-COMM          PIC X(5).
  3650             20  CF-MORTG-MIB-TERM          PIC X(5).
  3651         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3652             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3653         16  FILLER                         PIC X(03).
  3654         16  CF-MP-CHECK-NO-CONTROL.
  3655             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3656                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3657                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3658                                                ' ' LOW-VALUES.
  3659                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3660                                               VALUE '3'.
  3661         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3662         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3663         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3664             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3665                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3666             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3667                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3668             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3669                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3670             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3671                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3672             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3673                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3674             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3675                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6504.cbl
  3676         16  CF-MORTG-BILLING-AREA.
  3677             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3678                                            PIC X.
  3679         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3680         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3681         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3682         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3683             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3684             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3685         16  FILLER                         PIC X.
  3686         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3687             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3688             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3689         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3690         16  FILLER                         PIC X(8).
  3691         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3692         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3693         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3694         16  CF-ACH-COMPANY-ID.
  3695             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3696                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3697                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3698                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3699             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3700         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3701             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3702         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3703             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3704             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3705         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3706         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3707         16  FILLER                         PIC X(536).
  3708
  3709****************************************************************
  3710*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3711****************************************************************
  3712
  3713     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3714         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3715             20  CF-FEMALE-HEIGHT.
  3716                 24  CF-FEMALE-FT           PIC 99.
  3717                 24  CF-FEMALE-IN           PIC 99.
  3718             20  CF-FEMALE-MIN-WT           PIC 999.
  3719             20  CF-FEMALE-MAX-WT           PIC 999.
  3720         16  FILLER                         PIC X(428).
  3721
  3722     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3723         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3724             20  CF-MALE-HEIGHT.
  3725                 24  CF-MALE-FT             PIC 99.
  3726                 24  CF-MALE-IN             PIC 99.
  3727             20  CF-MALE-MIN-WT             PIC 999.
  3728             20  CF-MALE-MAX-WT             PIC 999.
  3729         16  FILLER                         PIC X(428).
  3730******************************************************************
  3731*             AUTOMATIC ACTIVITY RECORD                          *
  3732******************************************************************
  3733     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6504.cbl
  3734         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3735             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3736             20  CF-SYS-LETTER-ID           PIC X(04).
  3737             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3738             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3739             20  CF-SYS-RESET-SW            PIC X(01).
  3740             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3741             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3742
  3743         16  FILLER                         PIC X(50).
  3744
  3745         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3746             20  CF-USER-ACTIVE-SW          PIC X(01).
  3747             20  CF-USER-LETTER-ID          PIC X(04).
  3748             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3749             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3750             20  CF-USER-RESET-SW           PIC X(01).
  3751             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3752             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3753             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3754
  3755         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6504.cbl
  3757
  3758 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  3759                          CONTROL-FILE.
  3760 0000-DFHEXIT SECTION.
  3761     MOVE '9#                    $   ' TO DFHEIV0.
  3762     MOVE 'EL6504' TO DFHEIV1.
  3763     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3764     CONTINUE.
  3765
  3766     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3767     MOVE '5'                    TO  DC-OPTION-CODE.
  3768     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3769     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  3770     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  3771     MOVE DC-GREG-DATE-1-YMD     TO  YMD-CURRENT-SAVE.
  3772
  3773     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3774     IF EIBCALEN = 0
  3775         GO TO 8800-UNAUTHORIZED-ACCESS.
  3776
  3777     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3778         IF PI-CALLING-PROGRAM = XCTL-6501
  3779             MOVE PI-CALLING-PROGRAM
  3780                                 TO  PI-RETURN-TO-PROGRAM
  3781             MOVE THIS-PGM       TO  PI-CALLING-PROGRAM
  3782         ELSE
  3783             MOVE THIS-PGM       TO  PI-CALLING-PROGRAM.
  3784
  3785     MOVE LOW-VALUES             TO  EL6504AI.
  3786
  3787     IF EIBTRNID NOT = TRANS-ID
  3788         MOVE PI-MAINT           TO  MAINTYPO
  3789         MOVE AL-UANON           TO  MAINTYPA
  3790         MOVE -1                 TO  MAINTYPL
  3791
  3792         IF PI-MAINT = 'S' OR 'C'
  3793             GO TO 4000-SHOW
  3794         ELSE
  3795             IF PI-MAINT = 'A'
  3796                 MOVE 'C'            TO  PI-MAINT
  3797                 GO TO 4000-SHOW
  3798             ELSE
  3799                 GO TO 8100-SEND-INITIAL-MAP.
  3800
  3801
  3802* EXEC CICS HANDLE CONDITION
  3803*        PGMIDERR  (9600-PGMID-ERROR)
  3804*        ERROR     (9990-ABEND)
  3805*    END-EXEC.
  3806*    MOVE '"$L.                  ! " #00003797' TO DFHEIV0
  3807     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3809     MOVE X'2220233030303033373937' TO DFHEIV0(25:11)
  3810     CALL 'kxdfhei1' USING DFHEIV0
  3811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3812
  3813
  3814     IF EIBAID = DFHCLEAR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6504.cbl
  3815         GO TO 9400-CLEAR.
  3816
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6504.cbl
  3818 0200-RECEIVE.
  3819     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3820         MOVE ER-0008            TO  EMI-ERROR
  3821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3822         MOVE -1                 TO  PFENTERL
  3823         GO TO 8200-SEND-DATAONLY.
  3824
  3825
  3826* EXEC CICS RECEIVE
  3827*        MAP      (MAP-NAME)
  3828*        MAPSET   (MAPSET-NAME)
  3829*        INTO     (EL6504AI)
  3830*    END-EXEC.
  3831     MOVE LENGTH OF
  3832      EL6504AI
  3833       TO DFHEIV11
  3834*    MOVE '8"T I  L              ''   #00003813' TO DFHEIV0
  3835     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3837     MOVE X'2020233030303033383133' TO DFHEIV0(25:11)
  3838     CALL 'kxdfhei1' USING DFHEIV0,
  3839           MAP-NAME,
  3840           EL6504AI,
  3841           DFHEIV11,
  3842           MAPSET-NAME,
  3843           DFHEIV99,
  3844           DFHEIV99
  3845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3846
  3847
  3848     IF PFENTERL = 0
  3849         GO TO 0300-CHECK-PFKEYS.
  3850     IF EIBAID NOT = DFHENTER
  3851         MOVE ER-0004            TO  EMI-ERROR
  3852         GO TO 0320-INPUT-ERROR.
  3853     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  3854         MOVE PF-VALUES (PFENTERI) TO  EIBAID
  3855     ELSE
  3856         MOVE ER-0029            TO  EMI-ERROR
  3857         GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6504.cbl
  3859 0300-CHECK-PFKEYS.
  3860     IF EIBAID = DFHPF23
  3861         GO TO 8810-PF23.
  3862     IF EIBAID = DFHPF24
  3863         GO TO 9200-RETURN-MAIN-MENU.
  3864     IF EIBAID = DFHPF12
  3865         GO TO 9500-PF12.
  3866
  3867     IF EIBAID = DFHPF5
  3868         MOVE XCTL-6502          TO  PGM-NAME
  3869         GO TO 9300-XCTL.
  3870
  3871     IF EIBAID = DFHPF7
  3872         MOVE XCTL-6501          TO  PGM-NAME
  3873         GO TO 9300-XCTL.
  3874
  3875     IF EIBAID = DFHPF8
  3876         MOVE XCTL-6506          TO  PGM-NAME
  3877         GO TO 9300-XCTL.
  3878
  3879     IF EIBAID = DFHPF9
  3880         MOVE XCTL-6505          TO  PGM-NAME
  3881         GO TO 9300-XCTL.
  3882
  3883     IF EIBAID = DFHENTER
  3884         GO TO 0330-CHECK-MAINTYP.
  3885
  3886     MOVE ER-0029                TO  EMI-ERROR.
  3887 0320-INPUT-ERROR.
  3888     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3889     MOVE AL-UNBON               TO  PFENTERA.
  3890     MOVE -1                     TO  PFENTERL.
  3891     GO TO 8200-SEND-DATAONLY.
  3892
  3893 0330-CHECK-MAINTYP.
  3894     IF MAINTYPL GREATER ZERO
  3895         IF MAINTYPI = 'S' OR 'C' OR 'A'
  3896             MOVE AL-UANON       TO  MAINTYPA
  3897             MOVE MAINTYPI       TO  PI-MAINT
  3898         ELSE
  3899             MOVE -1             TO  MAINTYPL
  3900             MOVE AL-UABON       TO  MAINTYPA
  3901             MOVE ER-2039        TO  EMI-ERROR
  3902             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3903             GO TO 8200-SEND-DATAONLY
  3904     ELSE
  3905         MOVE -1                 TO  MAINTYPL
  3906         MOVE AL-UABON           TO  MAINTYPA
  3907         MOVE ER-2039            TO  EMI-ERROR
  3908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3909         GO TO 8200-SEND-DATAONLY.
  3910
  3911     IF PI-MAINT = 'S'
  3912         GO TO 4000-SHOW.
  3913
  3914     PERFORM 7800-COMPANY-REC-READ THRU 7899-EXIT.
  3915
  3916     IF EMI-ERROR NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6504.cbl
  3917         MOVE -1                 TO  MAINTYPL
  3918         GO TO 8200-SEND-DATAONLY.
  3919
  3920     GO TO 4200-MAINT.
  3921
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6504.cbl
  3923
  3924 4000-SHOW.
  3925     PERFORM 7100-READ-ERACCT THRU 7100-EXIT.
  3926     MOVE LOW-VALUES             TO  EL6504AO.
  3927     GO TO 5000-BUILD-INITIAL-SCREEN.
  3928
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6504.cbl
  3930
  3931 4200-MAINT.
  3932     IF NOT MODIFY-CAP
  3933         MOVE 'UPDATE'            TO SM-READ
  3934         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3935         MOVE ER-0070             TO  EMI-ERROR
  3936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3937         GO TO 8100-SEND-INITIAL-MAP.
  3938
  3939     PERFORM 7000-EDIT THRU 7099-EXIT.
  3940
  3941     IF EMI-NO-ERRORS
  3942         NEXT SENTENCE
  3943     ELSE
  3944         GO TO 8200-SEND-DATAONLY.
  3945
  3946     PERFORM 7300-READ-ERACCT-UPDATE THRU 7300-EXIT.
  3947
  3948     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  3949     MOVE ERACCT-FILE            TO  FILE-ID.
  3950
  3951     PERFORM 6000-CHECK-FOR-UPDATE   THRU 6049-EXIT.
  3952
  3953     IF AM-LAST-MAINT-USER   = PI-UPDATE-BY OR
  3954        AM-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  3955         NEXT SENTENCE
  3956     ELSE
  3957
  3958* EXEC CICS UNLOCK
  3959*             DATASET  (ERACCT-FILE)
  3960*        END-EXEC
  3961*    MOVE '&*                    #   #00003928' TO DFHEIV0
  3962     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3963     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3964     MOVE X'2020233030303033393238' TO DFHEIV0(25:11)
  3965     CALL 'kxdfhei1' USING DFHEIV0,
  3966           ERACCT-FILE,
  3967           DFHEIV99
  3968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3969         MOVE ER-0068            TO  EMI-ERROR
  3970         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3971         PERFORM 7100-READ-ERACCT  THRU 7100-EXIT
  3972         MOVE LOW-VALUES         TO  EL6504AO
  3973         MOVE -1                 TO  MAINTYPL
  3974         MOVE 'S'                TO  PI-MAINT
  3975         GO TO 5000-BUILD-INITIAL-SCREEN.
  3976
  3977     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  3978     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  3979     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3980     MOVE '5'                    TO  DC-OPTION-CODE.
  3981     MOVE LINK-ELDATCV           TO  PGM-NAME.
  3982
  3983
  3984* EXEC CICS LINK
  3985*        PROGRAM (PGM-NAME)
  3986*        COMMAREA(DATE-CONVERSION-DATA)
  3987*        LENGTH  (DC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6504.cbl
  3988*    END-EXEC.
  3989*    MOVE '."C                   ''   #00003945' TO DFHEIV0
  3990     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3991     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3992     MOVE X'2020233030303033393435' TO DFHEIV0(25:11)
  3993     CALL 'kxdfhei1' USING DFHEIV0,
  3994           PGM-NAME,
  3995           DATE-CONVERSION-DATA,
  3996           DC-COMM-LENGTH,
  3997           DFHEIV99,
  3998           DFHEIV99,
  3999           DFHEIV99
  4000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4001
  4002
  4003     MOVE DC-BIN-DATE-1          TO  AM-LAST-MAINT-DT
  4004                                     BIN-CURRENT-SAVE.
  4005*    MOVE YMD-CURRENT-SAVE       TO  ACC-LST-75-UPD.
  4006     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4007     MOVE ERACCT-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.
  4008     PERFORM 8400-LOG-JOURNAL-RECORD.
  4009     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  4010
  4011
  4012* EXEC CICS REWRITE
  4013*        DATASET  (ERACCT-FILE)
  4014*        FROM     (ACCOUNT-MASTER)
  4015*    END-EXEC.
  4016     MOVE LENGTH OF
  4017      ACCOUNT-MASTER
  4018       TO DFHEIV11
  4019*    MOVE '&& L                  %   #00003959' TO DFHEIV0
  4020     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4021     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4022     MOVE X'2020233030303033393539' TO DFHEIV0(25:11)
  4023     CALL 'kxdfhei1' USING DFHEIV0,
  4024           ERACCT-FILE,
  4025           ACCOUNT-MASTER,
  4026           DFHEIV11,
  4027           DFHEIV99
  4028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4029
  4030
  4031     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4032     MOVE ERACCT-FILE            TO  FILE-ID.
  4033     MOVE ERACCT-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.
  4034     PERFORM 8400-LOG-JOURNAL-RECORD.
  4035     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  4036     MOVE ER-0000                TO  EMI-ERROR.
  4037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4038
  4039     PERFORM 7100-READ-ERACCT THRU 7100-EXIT.
  4040
  4041     MOVE LOW-VALUES             TO  EL6504AO.
  4042     MOVE 'C'                    TO  PI-MAINT.
  4043
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6504.cbl
  4045 5000-BUILD-INITIAL-SCREEN.
  4046     MOVE AM-REI-PRT-ST          TO  TAXOPTO.
  4047     MOVE AM-REI-PRT-OW          TO  PRTOPTO.
  4048     MOVE AM-REI-MORT            TO  MORTALO.
  4049
  4050     MOVE AL-UANON               TO  TAXOPTA
  4051                                     PRTOPTA
  4052                                     MORTALA.
  4053
  4054     IF AM-REI-78-PCT NUMERIC
  4055      IF AM-REI-78-PCT NOT = ZEROS
  4056         MOVE AM-REI-78-PCT      TO  ARULEO
  4057         MOVE AL-UNNON           TO  ARULEA.
  4058
  4059     IF AM-REI-PR-PCT NUMERIC
  4060      IF AM-REI-PR-PCT NOT = ZEROS
  4061         MOVE AM-REI-PR-PCT      TO  ARATAO
  4062         MOVE AL-UNNON           TO  ARATAA.
  4063
  4064     IF AM-REI-FEE-LF NUMERIC
  4065      IF AM-REI-FEE-LF NOT = ZEROS
  4066         MOVE AM-REI-FEE-LF      TO  LCFEEO
  4067         MOVE AL-UNNON           TO  LCFEEA.
  4068
  4069     IF AM-REI-PE-LF  NOT = SPACES
  4070         MOVE AM-REI-PE-LF       TO  LCBASISO
  4071         MOVE AL-UANON           TO  LCBASISA.
  4072
  4073     IF AM-REI-LF-TAX NUMERIC
  4074      IF AM-REI-LF-TAX NOT = ZEROS
  4075         MOVE AM-REI-LF-TAX      TO  LTAXO
  4076         MOVE AL-UNNON           TO  LTAXA.
  4077
  4078     IF AM-REI-FEE-AH NUMERIC
  4079      IF AM-REI-FEE-AH NOT = ZEROS
  4080         MOVE AM-REI-FEE-AH      TO  ACFEEO
  4081         MOVE AL-UNNON           TO  ACFEEA.
  4082
  4083     IF AM-REI-PE-AH  NOT = SPACES
  4084         MOVE AM-REI-PE-AH       TO  ACBASISO
  4085         MOVE AL-UANON           TO  ACBASISA.
  4086
  4087     IF AM-REI-AH-TAX NOT = ZEROS
  4088         MOVE AM-REI-AH-TAX      TO  ATAXO
  4089         MOVE AL-UNNON           TO  ATAXA.
  4090
  4091     IF AM-REI-GROUP-A  NOT = SPACES
  4092         MOVE AM-REI-GROUP-A     TO  GROUPAO.
  4093         MOVE AL-UANON           TO  GROUPAA.
  4094
  4095     IF AM-REI-GROUP-B  NOT = SPACES
  4096         MOVE AM-REI-GROUP-B     TO  GROUPBO.
  4097         MOVE AL-UANON           TO  GROUPBA.
  4098
  4099     IF AM-RETRO-PREM-P-E = ZERO
  4100         MOVE SPACE              TO AM-RETRO-PREM-P-E.
  4101     IF AM-RETRO-CLMS-P-I = ZERO
  4102         MOVE SPACE              TO AM-RETRO-CLMS-P-I.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6504.cbl
  4103
  4104     MOVE AM-RET-Y-N             TO  YNRETROO.
  4105     MOVE AM-RETRO-PREM-P-E      TO  PERETROO.
  4106     MOVE AM-RET-P-E             TO  PECOMMO.
  4107     MOVE AM-RETRO-CLMS-P-I      TO  PICLAIMO.
  4108
  4109     MOVE AL-UANON               TO  YNRETROA
  4110                                     PERETROA
  4111                                     PECOMMA
  4112                                     PICLAIMA.
  4113
  4114     IF AM-RETRO-POOL NOT = SPACES
  4115         MOVE AM-RETRO-POOL      TO  GPRETROO
  4116         MOVE AL-UANON           TO  GPRETROA.
  4117
  4118     IF AM-RETRO-QUALIFY-LIMIT NOT NUMERIC
  4119         MOVE ZEROS              TO  AM-RETRO-QUALIFY-LIMIT.
  4120
  4121     IF AM-RETRO-QUALIFY-LIMIT NOT = ZEROS
  4122         MOVE AM-RETRO-QUALIFY-LIMIT
  4123                                 TO  RELIMITO
  4124         MOVE AL-UNNON           TO  RELIMITA.
  4125
  4126     IF AM-RET-MIN-LOSS-L NOT NUMERIC OR
  4127        AM-RET-MIN-LOSS-L = ZEROS
  4128         NEXT SENTENCE
  4129     ELSE
  4130         MOVE AM-RET-MIN-LOSS-L  TO  LFLOSSO
  4131         MOVE AL-UNNON           TO  LFLOSSA.
  4132
  4133     IF AM-RET-MIN-LOSS-A NOT NUMERIC OR
  4134        AM-RET-MIN-LOSS-A = ZEROS
  4135         NEXT SENTENCE
  4136     ELSE
  4137         MOVE AM-RET-MIN-LOSS-A  TO  AHLOSSO
  4138         MOVE AL-UNNON           TO  AHLOSSA.
  4139
  4140     IF AM-RET-EARN-R NOT = SPACES
  4141         MOVE AM-RET-EARN-R      TO  REDEARNO
  4142         MOVE AL-UANON           TO  REDEARNA.
  4143
  4144     IF AM-RET-EARN-L NOT = SPACES
  4145         MOVE AM-RET-EARN-L      TO  LEVEARNO
  4146         MOVE AL-UANON           TO  LEVEARNA.
  4147
  4148     IF AM-RET-EARN-A NOT = SPACES
  4149         MOVE AM-RET-EARN-A      TO  AHEARNO
  4150         MOVE AL-UANON           TO  AHEARNA.
  4151
  4152     IF AM-RET-BEG-EARN-R NOT = SPACES
  4153         MOVE AM-RET-BEG-EARN-R  TO  BEGREDO
  4154         MOVE AL-UANON           TO  BEGREDA.
  4155
  4156     IF AM-RET-BEG-EARN-L NOT = SPACES
  4157         MOVE AM-RET-BEG-EARN-L  TO  BEGLEVO
  4158         MOVE AL-UANON           TO  BEGLEVA.
  4159
  4160     IF AM-RET-BEG-EARN-A NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6504.cbl
  4161         MOVE AM-RET-BEG-EARN-A  TO  BEGAHO
  4162         MOVE AL-UANON           TO  BEGAHA.
  4163
  4164     IF AM-RET-ST-TAX-USE NOT = SPACES
  4165         MOVE AM-RET-ST-TAX-USE  TO  TAXOPO
  4166         MOVE AL-UANON           TO  TAXOPA.
  4167
  4168     IF AM-LF-RET NOT = ZEROS
  4169         MOVE AM-LF-RET          TO  LFRETENO
  4170         MOVE AL-UNNON           TO  LFRETENA.
  4171
  4172     IF AM-AH-RET NOT = ZEROS
  4173         MOVE AM-AH-RET          TO  AHRETENO
  4174         MOVE AL-UNNON           TO  AHRETENA.
  4175
  4176*    MOVE AM-RETRO-RET-METHOD-LF TO  LFMETHDO.
  4177*    MOVE AL-UANON               TO  LFMETHDA.
  4178*    MOVE AM-RETRO-RET-BASIS-LF  TO  LFBASISO.
  4179*    MOVE AL-UANON               TO  LFBASISA.
  4180
  4181     IF AM-RETRO-RET-PCT-LF (1) NOT NUMERIC
  4182         MOVE ZEROS              TO  AM-RETRO-RET-PCT-LF (1).
  4183     IF AM-RETRO-RET-PCT-LF (2) NOT NUMERIC
  4184         MOVE ZEROS              TO  AM-RETRO-RET-PCT-LF (2).
  4185     IF AM-RETRO-RET-PCT-LF (3) NOT NUMERIC
  4186         MOVE ZEROS              TO  AM-RETRO-RET-PCT-LF (3).
  4187     IF AM-RETRO-RET-THRU-LF (1) NOT NUMERIC
  4188         MOVE ZEROS              TO  AM-RETRO-RET-THRU-LF (1).
  4189     IF AM-RETRO-RET-THRU-LF (2) NOT NUMERIC
  4190         MOVE ZEROS              TO  AM-RETRO-RET-THRU-LF (2).
  4191     IF AM-RETRO-RET-THRU-LF (3) NOT NUMERIC
  4192         MOVE ZEROS              TO  AM-RETRO-RET-THRU-LF (3).
  4193
  4194*    IF AM-RETRO-RET-PCT-LF (1) NOT = ZEROS
  4195*        MOVE AM-RETRO-RET-PCT-LF (1)  TO  LFPCT1O
  4196*        MOVE AL-UNNON                 TO  LFPCT1A.
  4197*
  4198*    IF AM-RETRO-RET-THRU-LF (1) NOT = ZEROS
  4199*        MOVE AM-RETRO-RET-THRU-LF (1) TO  LFTHRU1O
  4200*        MOVE AL-UNNON                 TO  LFTHRU1A.
  4201*
  4202*    IF AM-RETRO-RET-PCT-LF (2) NOT = ZEROS
  4203*        MOVE AM-RETRO-RET-PCT-LF (2)  TO  LFPCT2O
  4204*        MOVE AL-UNNON                 TO  LFPCT2A.
  4205*
  4206*    IF AM-RETRO-RET-THRU-LF (2) NOT = ZEROS
  4207*        MOVE AM-RETRO-RET-THRU-LF (2) TO  LFTHRU2O
  4208*        MOVE AL-UNNON                 TO  LFTHRU2A.
  4209*
  4210*    IF AM-RETRO-RET-PCT-LF (3) NOT = ZEROS
  4211*        MOVE AM-RETRO-RET-PCT-LF (3)  TO  LFPCT3O
  4212*        MOVE AL-UNNON                 TO  LFPCT3A.
  4213*
  4214*    IF AM-RETRO-RET-THRU-LF (3) NOT = ZEROS
  4215*        MOVE AM-RETRO-RET-THRU-LF (3) TO  LFTHRU3O
  4216*        MOVE AL-UNNON                 TO  LFTHRU3A.
  4217*
  4218*    MOVE AM-RETRO-RET-METHOD-AH TO  AHMETHDO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6504.cbl
  4219*    MOVE AL-UANON               TO  AHMETHDA.
  4220*    MOVE AM-RETRO-RET-BASIS-AH  TO  AHBASISO.
  4221*    MOVE AL-UANON               TO  AHBASISA.
  4222
  4223     IF AM-RETRO-RET-PCT-AH (1) NOT NUMERIC
  4224         MOVE ZEROS              TO  AM-RETRO-RET-PCT-AH (1).
  4225     IF AM-RETRO-RET-PCT-AH (2) NOT NUMERIC
  4226         MOVE ZEROS              TO  AM-RETRO-RET-PCT-AH (2).
  4227     IF AM-RETRO-RET-PCT-AH (3) NOT NUMERIC
  4228         MOVE ZEROS              TO  AM-RETRO-RET-PCT-AH (3).
  4229     IF AM-RETRO-RET-THRU-AH (1) NOT NUMERIC
  4230         MOVE ZEROS              TO  AM-RETRO-RET-THRU-AH (1).
  4231     IF AM-RETRO-RET-THRU-AH (2) NOT NUMERIC
  4232         MOVE ZEROS              TO  AM-RETRO-RET-THRU-AH (2).
  4233     IF AM-RETRO-RET-THRU-AH (3) NOT NUMERIC
  4234         MOVE ZEROS              TO  AM-RETRO-RET-THRU-AH (3).
  4235
  4236*    IF AM-RETRO-RET-PCT-AH (1) NOT = ZEROS
  4237*        MOVE AM-RETRO-RET-PCT-AH (1)  TO  AHPCT1O
  4238*        MOVE AL-UNNON                 TO  AHPCT1A.
  4239*
  4240*    IF AM-RETRO-RET-THRU-AH (1) NOT = ZEROS
  4241*        MOVE AM-RETRO-RET-THRU-AH (1) TO  AHTHRU1O
  4242*        MOVE AL-UNNON                 TO  AHTHRU1A.
  4243*
  4244*    IF AM-RETRO-RET-PCT-AH (2) NOT = ZEROS
  4245*        MOVE AM-RETRO-RET-PCT-AH (2)  TO  AHPCT2O
  4246*        MOVE AL-UNNON                 TO  AHPCT2A.
  4247*
  4248*    IF AM-RETRO-RET-THRU-AH (2) NOT = ZEROS
  4249*        MOVE AM-RETRO-RET-THRU-AH (2) TO  AHTHRU2O
  4250*        MOVE AL-UNNON                 TO  AHTHRU2A.
  4251*
  4252*    IF AM-RETRO-RET-PCT-AH (3) NOT = ZEROS
  4253*        MOVE AM-RETRO-RET-PCT-AH (3)  TO  AHPCT3O
  4254*        MOVE AL-UNNON                 TO  AHPCT3A.
  4255*
  4256*    IF AM-RETRO-RET-THRU-AH (3) NOT = ZEROS
  4257*        MOVE AM-RETRO-RET-THRU-AH (3) TO  AHTHRU3O
  4258*        MOVE AL-UNNON                 TO  AHTHRU3A.
  4259
  4260
  4261     IF AM-FLI-BANK-BALANCE    NUMERIC AND
  4262        AM-FLI-BANK-1ST-6-PREM NUMERIC AND
  4263        AM-FLI-BANK-CAP-AMT    NUMERIC
  4264           MOVE AL-SADOF            TO  COM1A
  4265                                        COM2A
  4266                                        COM3A
  4267                                        COM4A
  4268                                        COM5A
  4269         ELSE
  4270           MOVE AM-COMMENT-LINE (1)  TO  COM1O
  4271           MOVE AM-COMMENT-LINE (2)  TO  COM2O
  4272           MOVE AM-COMMENT-LINE (3)  TO  COM3O
  4273           MOVE AM-COMMENT-LINE (4)  TO  COM4O
  4274           MOVE AM-COMMENT-LINE (5)  TO  COM5O
  4275           MOVE AL-UANON             TO  COM1A
  4276                                         COM2A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6504.cbl
  4277                                         COM3A
  4278                                         COM4A
  4279                                         COM5A.
  4280
  4281     MOVE PI-MAINT               TO  MAINTYPO.
  4282     MOVE AL-UANON               TO  MAINTYPA.
  4283     MOVE -1                     TO  MAINTYPL.
  4284
  4285     GO TO 8100-SEND-INITIAL-MAP.
  4286
  4287 5099-EXIT.
  4288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6504.cbl
  4290 6000-CHECK-FOR-UPDATE.
  4291     IF LCFEEL GREATER ZERO
  4292         MOVE WS-LF-FEE          TO  AM-REI-FEE-LF.
  4293*        MOVE LCFEEI             TO  AM-REI-FEE-LF.
  4294
  4295     IF LCBASISL GREATER ZERO
  4296         MOVE LCBASISI           TO  AM-REI-PE-LF.
  4297
  4298     IF LTAXL GREATER ZERO
  4299         MOVE WS-LF-TAX          TO  AM-REI-LF-TAX.
  4300*        MOVE LTAXI              TO  AM-REI-LF-TAX.
  4301
  4302     IF ACFEEL GREATER ZERO
  4303         MOVE WS-AH-FEE          TO  AM-REI-FEE-AH.
  4304*        MOVE ACFEEI             TO  AM-REI-FEE-AH.
  4305
  4306     IF ACBASISL GREATER ZERO
  4307         MOVE ACBASISI           TO  AM-REI-PE-AH.
  4308
  4309     IF ATAXL GREATER ZERO
  4310         MOVE WS-AH-TAX          TO  AM-REI-AH-TAX.
  4311*        MOVE ATAXI              TO  AM-REI-AH-TAX.
  4312
  4313     IF ARULEL GREATER ZERO
  4314         MOVE WS-AH-R78          TO  AM-REI-78-PCT.
  4315*        MOVE ARULEI             TO  AM-REI-78-PCT.
  4316
  4317     IF ARATAL GREATER ZERO
  4318         MOVE WS-AH-PRATA        TO  AM-REI-PR-PCT.
  4319*        MOVE ARATAI             TO  AM-REI-PR-PCT.
  4320
  4321     IF TAXOPTL GREATER ZERO
  4322         MOVE TAXOPTI            TO  AM-REI-PRT-ST.
  4323
  4324     IF PRTOPTL GREATER ZERO
  4325         MOVE PRTOPTI            TO  AM-REI-PRT-OW.
  4326
  4327     IF GROUPAL GREATER ZERO
  4328         MOVE GROUPAI            TO  AM-REI-GROUP-A.
  4329
  4330     IF GROUPBL GREATER ZERO
  4331         MOVE GROUPBI            TO  AM-REI-GROUP-B.
  4332
  4333     IF MORTALL GREATER ZERO
  4334         MOVE MORTALI            TO  AM-REI-MORT.
  4335
  4336     IF YNRETROL GREATER ZERO
  4337        MOVE YNRETROI            TO  AM-RET-Y-N.
  4338
  4339     IF PERETROL GREATER ZERO
  4340        MOVE PERETROI            TO  AM-RETRO-PREM-P-E.
  4341
  4342     IF PECOMML GREATER ZERO
  4343        MOVE PECOMMI             TO  AM-RET-P-E.
  4344
  4345     IF PICLAIML GREATER ZERO
  4346        MOVE PICLAIMI            TO  AM-RETRO-CLMS-P-I.
  4347
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6504.cbl
  4348     IF GPRETROL GREATER ZERO
  4349        MOVE GPRETROI            TO  AM-RETRO-POOL.
  4350
  4351     IF RELIMITL GREATER ZERO
  4352        MOVE WS-QUALIFY-LIMIT    TO  AM-RETRO-QUALIFY-LIMIT.
  4353
  4354     IF LFLOSSL GREATER ZERO
  4355         MOVE WS-LF-LOSS         TO  AM-RET-MIN-LOSS-L.
  4356*        MOVE LFLOSSI            TO  AM-RET-MIN-LOSS-L.
  4357
  4358     IF AHLOSSL GREATER ZERO
  4359         MOVE WS-AH-LOSS         TO  AM-RET-MIN-LOSS-A.
  4360*        MOVE AHLOSSI            TO  AM-RET-MIN-LOSS-A.
  4361
  4362     IF REDEARNL GREATER ZERO
  4363         MOVE REDEARNI           TO  AM-RET-EARN-R.
  4364
  4365     IF LEVEARNL GREATER ZERO
  4366         MOVE LEVEARNI           TO  AM-RET-EARN-L.
  4367
  4368     IF AHEARNL GREATER ZERO
  4369         MOVE AHEARNI            TO  AM-RET-EARN-A.
  4370
  4371     IF BEGREDL GREATER ZERO
  4372         MOVE BEGREDI            TO  AM-RET-BEG-EARN-R.
  4373
  4374     IF BEGLEVL GREATER ZERO
  4375         MOVE BEGLEVI            TO  AM-RET-BEG-EARN-L.
  4376
  4377     IF BEGAHL GREATER ZERO
  4378         MOVE BEGAHI             TO  AM-RET-BEG-EARN-A.
  4379
  4380     IF TAXOPL GREATER ZERO
  4381         MOVE TAXOPI             TO  AM-RET-ST-TAX-USE.
  4382
  4383     IF LFRETENL GREATER ZERO
  4384        MOVE WS-LF-RET           TO  AM-LF-RET.
  4385*       MOVE LFRETENI            TO  AM-LF-RET.
  4386
  4387*    IF LFMETHDL GREATER ZERO
  4388*        MOVE LFMETHDI           TO  AM-RETRO-RET-METHOD-LF.
  4389*
  4390*    IF LFBASISL GREATER ZERO
  4391*        MOVE LFBASISI           TO  AM-RETRO-RET-BASIS-LF.
  4392*
  4393*    IF LFPCT1L GREATER ZERO
  4394*        MOVE WS-LF-PCT-1        TO  AM-RETRO-RET-PCT-LF (1).
  4395*
  4396*    IF LFTHRU1L GREATER ZERO
  4397*        MOVE WS-LF-THRU-1       TO  AM-RETRO-RET-THRU-LF (1).
  4398*
  4399*    IF LFPCT2L GREATER ZERO
  4400*        MOVE WS-LF-PCT-2        TO  AM-RETRO-RET-PCT-LF (2).
  4401*
  4402*    IF LFTHRU2L GREATER ZERO
  4403*        MOVE WS-LF-THRU-2       TO  AM-RETRO-RET-THRU-LF (2).
  4404*
  4405*    IF LFPCT3L GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6504.cbl
  4406*        MOVE WS-LF-PCT-3        TO  AM-RETRO-RET-PCT-LF (3).
  4407*
  4408*    IF LFTHRU3L GREATER ZERO
  4409*        MOVE WS-LF-THRU-3       TO  AM-RETRO-RET-THRU-LF (3).
  4410
  4411     IF AHRETENL GREATER ZERO
  4412        MOVE WS-AH-RET           TO  AM-AH-RET.
  4413*       MOVE AHRETENI            TO  AM-AH-RET.
  4414
  4415*    IF AHMETHDL GREATER ZERO
  4416*        MOVE AHMETHDI           TO  AM-RETRO-RET-METHOD-AH.
  4417*
  4418*    IF AHBASISL GREATER ZERO
  4419*        MOVE AHBASISI           TO  AM-RETRO-RET-BASIS-AH.
  4420*
  4421*    IF AHPCT1L GREATER ZERO
  4422*        MOVE WS-AH-PCT-1        TO  AM-RETRO-RET-PCT-AH (1).
  4423*
  4424*    IF AHTHRU1L GREATER ZERO
  4425*        MOVE WS-AH-THRU-1       TO  AM-RETRO-RET-THRU-AH (1).
  4426*
  4427*    IF AHPCT2L GREATER ZERO
  4428*        MOVE WS-AH-PCT-2        TO  AM-RETRO-RET-PCT-AH (2).
  4429*
  4430*    IF AHTHRU2L GREATER ZERO
  4431*        MOVE WS-AH-THRU-2       TO  AM-RETRO-RET-THRU-AH (2).
  4432*
  4433*    IF AHPCT3L GREATER ZERO
  4434*        MOVE WS-AH-PCT-3        TO  AM-RETRO-RET-PCT-AH (3).
  4435*
  4436*    IF AHTHRU3L GREATER ZERO
  4437*        MOVE WS-AH-THRU-3       TO  AM-RETRO-RET-THRU-AH (3).
  4438*
  4439     IF COM1L GREATER ZERO
  4440         MOVE COM1I              TO  AM-COMMENT-LINE (1).
  4441
  4442     IF COM2L GREATER ZERO
  4443         MOVE COM2I              TO  AM-COMMENT-LINE (2).
  4444
  4445     IF COM3L GREATER ZERO
  4446         MOVE COM3I              TO  AM-COMMENT-LINE (3).
  4447
  4448     IF COM4L GREATER ZERO
  4449         MOVE COM4I              TO  AM-COMMENT-LINE (4).
  4450
  4451     IF COM5L GREATER ZERO
  4452         MOVE COM5I              TO  AM-COMMENT-LINE (5).
  4453
  4454
  4455 6049-EXIT.
  4456     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6504.cbl
  4458 7000-EDIT.
  4459     IF LCFEEL GREATER ZERO
  4460         MOVE LCFEEI                 TO  DEEDIT-FIELD
  4461         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4462         IF DEEDIT-FIELD-V4 NUMERIC
  4463             MOVE DEEDIT-FIELD-V4    TO  WS-LF-FEE
  4464             MOVE AL-UNNON           TO  LCFEEA
  4465         ELSE
  4466             MOVE -1                 TO  LCFEEL
  4467             MOVE AL-UNBON           TO  LCFEEA
  4468             MOVE ER-2081            TO  EMI-ERROR
  4469             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4470
  4471     IF LCBASISL GREATER ZERO
  4472         IF LCBASISI = SPACES
  4473             NEXT SENTENCE
  4474         ELSE
  4475             IF LCBASISI = 'P' OR 'E' OR ' '
  4476                 MOVE AL-UANON       TO  LCBASISA
  4477             ELSE
  4478                 MOVE -1             TO  LCBASISL
  4479                 MOVE AL-UABON       TO  LCBASISA
  4480                 MOVE ER-2098        TO  EMI-ERROR
  4481                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4482
  4483     IF LTAXL GREATER ZERO
  4484         MOVE LTAXI                  TO  DEEDIT-FIELD
  4485         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4486         IF DEEDIT-FIELD-V4 NUMERIC
  4487             MOVE DEEDIT-FIELD-V4    TO  WS-LF-TAX
  4488             MOVE AL-UNNON           TO  LTAXA
  4489         ELSE
  4490             MOVE -1                 TO  LTAXL
  4491             MOVE AL-UNBON           TO  LTAXA
  4492             MOVE ER-2082            TO  EMI-ERROR
  4493             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4494
  4495     IF TAXOPTL GREATER ZERO
  4496         IF TAXOPTI = 'Y' OR 'N' OR ' ' OR 'F'
  4497             MOVE AL-UANON       TO  TAXOPTA
  4498         ELSE
  4499             MOVE -1             TO  TAXOPTL
  4500             MOVE AL-UABON       TO  TAXOPTA
  4501             MOVE ER-2100        TO  EMI-ERROR
  4502             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4503
  4504     IF PRTOPTL GREATER ZERO
  4505         IF PRTOPTI = 'A' OR 'F' OR 'Y' OR ' '
  4506             MOVE AL-UANON       TO  PRTOPTA
  4507         ELSE
  4508             MOVE -1             TO  PRTOPTL
  4509             MOVE AL-UABON       TO  PRTOPTA
  4510             MOVE ER-2101        TO  EMI-ERROR
  4511             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4512
  4513     IF GROUPAL GREATER ZERO
  4514         MOVE AL-UANON           TO  GROUPAA.
  4515
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6504.cbl
  4516     IF GROUPBL GREATER ZERO
  4517         MOVE AL-UANON           TO  GROUPBA.
  4518
  4519     IF MORTALL GREATER ZERO
  4520         PERFORM 7400-EDIT-MORTALITY
  4521            THRU 7499-EXIT.
  4522
  4523     IF ACFEEL GREATER ZERO
  4524         MOVE ACFEEI                 TO  DEEDIT-FIELD
  4525         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4526         IF DEEDIT-FIELD-V4 NUMERIC
  4527             MOVE DEEDIT-FIELD-V4    TO  WS-AH-FEE
  4528             MOVE AL-UNNON           TO  ACFEEA
  4529         ELSE
  4530             MOVE -1                 TO  ACFEEL
  4531             MOVE AL-UNBON           TO  ACFEEA
  4532             MOVE ER-2083            TO  EMI-ERROR
  4533             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4534
  4535     IF ACBASISL GREATER ZERO
  4536         IF ACBASISI = SPACES
  4537             NEXT SENTENCE
  4538         ELSE
  4539             IF ACBASISI = 'P' OR 'E' OR ' '
  4540                 MOVE AL-UANON       TO  ACBASISA
  4541             ELSE
  4542                 MOVE -1             TO  ACBASISL
  4543                 MOVE AL-UABON       TO  ACBASISA
  4544                 MOVE ER-2099        TO  EMI-ERROR
  4545                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4546
  4547     IF ATAXL GREATER ZERO
  4548         MOVE ATAXI                  TO  DEEDIT-FIELD
  4549         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4550         IF DEEDIT-FIELD-V4 NUMERIC
  4551             MOVE DEEDIT-FIELD-V4    TO  WS-AH-TAX
  4552             MOVE AL-UNNON           TO  ATAXA
  4553         ELSE
  4554             MOVE -1                 TO  ATAXL
  4555             MOVE AL-UNBON           TO  ATAXA
  4556             MOVE ER-2084            TO  EMI-ERROR
  4557             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4558
  4559     IF ARULEL GREATER ZERO
  4560         MOVE ARULEI                 TO  DEEDIT-FIELD
  4561         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4562         IF DEEDIT-FIELD-V4 NUMERIC
  4563             MOVE DEEDIT-FIELD-V4    TO  WS-AH-R78
  4564             MOVE AL-UNNON           TO  ARULEA
  4565             ADD WS-AH-R78           TO  WS-TOT-PERCENT
  4566         ELSE
  4567             MOVE -1                 TO  ARULEL
  4568             MOVE AL-UNBON           TO  ARULEA
  4569             MOVE ER-2085            TO  EMI-ERROR
  4570             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4571
  4572     IF ARATAL GREATER ZERO
  4573         MOVE ARATAI                 TO  DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6504.cbl
  4574         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4575         IF DEEDIT-FIELD-V4 NUMERIC
  4576             MOVE DEEDIT-FIELD-V4    TO  WS-AH-PRATA
  4577             MOVE AL-UNNON           TO  ARATAA
  4578             ADD WS-AH-PRATA         TO  WS-TOT-PERCENT
  4579             IF WS-TOT-PERCENT = +1 OR ZERO
  4580                 NEXT SENTENCE
  4581             ELSE
  4582                 MOVE -1             TO  ARULEL
  4583                 MOVE AL-UNBON       TO  ARULEA
  4584                                         ARATAA
  4585                 MOVE ER-2102        TO  EMI-ERROR
  4586                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4587         ELSE
  4588             MOVE -1             TO  ARATAL
  4589             MOVE AL-UNBON       TO  ARATAA
  4590             MOVE ER-2086        TO  EMI-ERROR
  4591             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4592
  4593     IF YNRETROL GREATER ZERO
  4594         IF YNRETROI = 'Y' OR 'N' OR 'Q' OR 'S' OR
  4595                       'G' OR 'I' OR ' '
  4596             NEXT SENTENCE
  4597         ELSE
  4598             MOVE -1             TO  YNRETROL
  4599             MOVE AL-UABON       TO  YNRETROA
  4600             MOVE ER-2161        TO  EMI-ERROR
  4601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4602
  4603     IF PECOMML GREATER ZERO
  4604         IF PECOMMI = 'P' OR 'E' OR ' '
  4605             NEXT SENTENCE
  4606         ELSE
  4607             MOVE ER-2162        TO  EMI-ERROR
  4608             MOVE -1             TO  PECOMML
  4609             MOVE AL-UABON       TO  PECOMMA
  4610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4611     ELSE
  4612         IF YNRETROI NOT = 'N'
  4613             MOVE ER-2171        TO  EMI-ERROR
  4614             MOVE -1             TO  PECOMML
  4615             MOVE AL-UABON       TO  PECOMMA
  4616             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4617
  4618     IF PERETROL GREATER ZERO
  4619         IF PERETROI = 'P' OR 'E' OR ' '
  4620             NEXT SENTENCE
  4621         ELSE
  4622             MOVE ER-2162        TO  EMI-ERROR
  4623             MOVE -1             TO  PERETROL
  4624             MOVE AL-UABON       TO  PERETROA
  4625             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4626
  4627     IF PICLAIML GREATER ZERO
  4628         IF PICLAIMI = 'P' OR 'I' OR ' '
  4629             NEXT SENTENCE
  4630         ELSE
  4631             MOVE ER-2162        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6504.cbl
  4632             MOVE -1             TO  PICLAIML
  4633             MOVE AL-UABON       TO  PICLAIMA
  4634             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4635
  4636     IF GPRETROL GREATER ZERO
  4637         MOVE AL-UANON           TO  GPRETROA.
  4638
  4639     IF RELIMITL GREATER ZERO
  4640         MOVE RELIMITI               TO  DEEDIT-FIELD
  4641         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4642         IF DEEDIT-FIELD-V0 NUMERIC
  4643             MOVE DEEDIT-FIELD-V0    TO  WS-QUALIFY-LIMIT
  4644             MOVE AL-UNNON           TO  RELIMITA
  4645         ELSE
  4646             MOVE -1                 TO  RELIMITL
  4647             MOVE AL-UNBON           TO  RELIMITA
  4648             MOVE ER-0620            TO  EMI-ERROR
  4649             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4650
  4651     IF LFLOSSL GREATER ZERO
  4652         MOVE LFLOSSI                TO  DEEDIT-FIELD
  4653         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4654         IF DEEDIT-FIELD-V3 NUMERIC
  4655             MOVE DEEDIT-FIELD-V3    TO  WS-LF-LOSS
  4656             MOVE AL-UNNON           TO  LFLOSSA
  4657         ELSE
  4658             MOVE -1                 TO  LFLOSSL
  4659             MOVE AL-UNBON           TO  LFLOSSA
  4660             MOVE ER-0620            TO  EMI-ERROR
  4661             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4662
  4663     IF AHLOSSL GREATER ZERO
  4664         MOVE AHLOSSI                TO  DEEDIT-FIELD
  4665         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4666         IF DEEDIT-FIELD-V3 NUMERIC
  4667             MOVE DEEDIT-FIELD-V3    TO  WS-AH-LOSS
  4668             MOVE AL-UNNON           TO  AHLOSSA
  4669         ELSE
  4670             MOVE -1                 TO  AHLOSSL
  4671             MOVE AL-UNBON           TO  AHLOSSA
  4672             MOVE ER-0621            TO  EMI-ERROR
  4673             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4674
  4675     IF REDEARNL GREATER ZERO
  4676         MOVE REDEARNI           TO  WS-VALID-EARNINGS
  4677         IF VALID-EARNINGS
  4678             MOVE AL-UANON       TO  REDEARNA
  4679         ELSE
  4680             MOVE -1             TO  REDEARNL
  4681             MOVE AL-UABON       TO  REDEARNA
  4682             MOVE ER-2165        TO  EMI-ERROR
  4683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4684
  4685     IF LEVEARNL GREATER ZERO
  4686         MOVE LEVEARNI           TO  WS-VALID-EARNINGS
  4687         IF VALID-EARNINGS
  4688             MOVE AL-UANON       TO  LEVEARNA
  4689         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6504.cbl
  4690             MOVE -1             TO  LEVEARNL
  4691             MOVE AL-UABON       TO  LEVEARNA
  4692             MOVE ER-2165        TO  EMI-ERROR
  4693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4694
  4695     IF AHEARNL GREATER ZERO
  4696         MOVE AHEARNI            TO  WS-VALID-EARNINGS
  4697         IF VALID-EARNINGS
  4698             MOVE AL-UANON       TO  AHEARNA
  4699         ELSE
  4700             MOVE -1             TO  AHEARNL
  4701             MOVE AL-UABON       TO  AHEARNA
  4702             MOVE ER-2165        TO  EMI-ERROR
  4703             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4704
  4705     IF BEGREDL GREATER ZERO
  4706         MOVE BEGREDI            TO  WS-VALID-EARNINGS
  4707         IF VALID-EARNINGS
  4708             MOVE AL-UANON       TO  BEGREDA
  4709         ELSE
  4710             MOVE -1             TO  BEGREDL
  4711             MOVE AL-UABON       TO  BEGREDA
  4712             MOVE ER-2165        TO  EMI-ERROR
  4713             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4714
  4715     IF BEGLEVL GREATER ZERO
  4716         MOVE BEGLEVI            TO  WS-VALID-EARNINGS
  4717         IF VALID-EARNINGS
  4718             MOVE AL-UANON       TO  BEGLEVA
  4719         ELSE
  4720             MOVE -1             TO  BEGLEVL
  4721             MOVE AL-UABON       TO  BEGLEVA
  4722             MOVE ER-2165        TO  EMI-ERROR
  4723             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4724
  4725     IF BEGAHL GREATER ZERO
  4726         MOVE BEGAHI             TO  WS-VALID-EARNINGS
  4727         IF VALID-EARNINGS
  4728             MOVE AL-UANON       TO  BEGAHA
  4729         ELSE
  4730             MOVE -1             TO  BEGAHL
  4731             MOVE AL-UABON       TO  BEGAHA
  4732             MOVE ER-2165        TO  EMI-ERROR
  4733             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4734
  4735     IF TAXOPL GREATER ZERO
  4736         IF TAXOPI = 'P' OR 'E' OR 'Y' OR ' '
  4737             MOVE AL-UANON       TO  TAXOPA
  4738         ELSE
  4739             MOVE -1             TO  TAXOPL
  4740             MOVE AL-UABON       TO  TAXOPA
  4741             MOVE ER-0626        TO  EMI-ERROR
  4742             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4743
  4744     IF LFRETENL GREATER ZERO
  4745         MOVE LFRETENI               TO  DEEDIT-FIELD
  4746         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4747         IF DEEDIT-FIELD-V4 NUMERIC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6504.cbl
  4748             MOVE DEEDIT-FIELD-V4    TO  WS-LF-RET
  4749             IF WS-LF-RET GREATER 1
  4750                 MOVE -1             TO  LFRETENL
  4751                 MOVE AL-UNBON       TO  LFRETENA
  4752                 MOVE ER-2163        TO  EMI-ERROR
  4753                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4754             ELSE
  4755                 MOVE AL-UNNON       TO  LFRETENA
  4756         ELSE
  4757             MOVE -1             TO  LFRETENL
  4758             MOVE AL-UNBON       TO  LFRETENA
  4759             MOVE ER-2163        TO  EMI-ERROR
  4760             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4761
  4762*    IF LFMETHDL GREATER ZERO
  4763*        IF LFMETHDI = 'P' OR 'S' OR ' '
  4764*            NEXT SENTENCE
  4765*        ELSE
  4766*            MOVE ER-2162        TO  EMI-ERROR
  4767*            MOVE -1             TO  LFMETHDL
  4768*            MOVE AL-UABON       TO  LFMETHDA
  4769*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4770*
  4771*    IF LFBASISL GREATER ZERO
  4772*        IF LFBASISI = 'P' OR 'E' OR ' '
  4773*            NEXT SENTENCE
  4774*        ELSE
  4775*            MOVE ER-2162        TO  EMI-ERROR
  4776*            MOVE -1             TO  LFBASISL
  4777*            MOVE AL-UABON       TO  LFBASISA
  4778*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4779*
  4780*    IF LFPCT1L GREATER ZERO
  4781*        MOVE LFPCT1I                TO  DEEDIT-FIELD
  4782*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4783*        IF DEEDIT-FIELD-V4 NUMERIC
  4784*            MOVE DEEDIT-FIELD-V4    TO  WS-LF-PCT-1
  4785*            IF WS-LF-PCT-1 GREATER 1
  4786*                MOVE -1             TO  LFPCT1L
  4787*                MOVE AL-UNBON       TO  LFPCT1A
  4788*                MOVE ER-2163        TO  EMI-ERROR
  4789*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4790*            ELSE
  4791*                MOVE AL-UNNON       TO  LFPCT1A
  4792*        ELSE
  4793*            MOVE -1             TO  LFPCT1L
  4794*            MOVE AL-UNBON       TO  LFPCT1A
  4795*            MOVE ER-2163        TO  EMI-ERROR
  4796*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4797*
  4798*    IF LFTHRU1L GREATER ZERO
  4799*        MOVE LFTHRU1I               TO  DEEDIT-FIELD
  4800*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4801*        IF DEEDIT-FIELD-V0 NUMERIC
  4802*            MOVE DEEDIT-FIELD-V0    TO  WS-LF-THRU-1
  4803*            MOVE AL-UNNON           TO  LFTHRU1A
  4804*        ELSE
  4805*            MOVE -1             TO  LFTHRU1L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6504.cbl
  4806*            MOVE AL-UNBON       TO  LFTHRU1A
  4807*            MOVE ER-2163        TO  EMI-ERROR
  4808*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4809*
  4810*    IF LFPCT2L GREATER ZERO
  4811*        MOVE LFPCT2I                TO  DEEDIT-FIELD
  4812*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4813*        IF DEEDIT-FIELD-V4 NUMERIC
  4814*            MOVE DEEDIT-FIELD-V4    TO  WS-LF-PCT-2
  4815*            IF WS-LF-PCT-2 GREATER 1
  4816*                MOVE -1             TO  LFPCT2L
  4817*                MOVE AL-UNBON       TO  LFPCT2A
  4818*                MOVE ER-2163        TO  EMI-ERROR
  4819*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4820*            ELSE
  4821*                MOVE AL-UNNON       TO  LFPCT2A
  4822*        ELSE
  4823*            MOVE -1             TO  LFPCT2L
  4824*            MOVE AL-UNBON       TO  LFPCT2A
  4825*            MOVE ER-2163        TO  EMI-ERROR
  4826*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4827*
  4828*    IF LFTHRU2L GREATER ZERO
  4829*        MOVE LFTHRU2I               TO  DEEDIT-FIELD
  4830*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4831*        IF DEEDIT-FIELD-V0 NUMERIC
  4832*            MOVE DEEDIT-FIELD-V0    TO  WS-LF-THRU-2
  4833*            MOVE AL-UNNON           TO  LFTHRU2A
  4834*        ELSE
  4835*            MOVE -1             TO  LFTHRU2L
  4836*            MOVE AL-UNBON       TO  LFTHRU2A
  4837*            MOVE ER-2163        TO  EMI-ERROR
  4838*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4839*
  4840*    IF LFPCT3L GREATER ZERO
  4841*        MOVE LFPCT3I                TO  DEEDIT-FIELD
  4842*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4843*        IF DEEDIT-FIELD-V4 NUMERIC
  4844*            MOVE DEEDIT-FIELD-V4    TO  WS-LF-PCT-3
  4845*            IF WS-LF-PCT-3 GREATER 1
  4846*                MOVE -1             TO  LFPCT3L
  4847*                MOVE AL-UNBON       TO  LFPCT3A
  4848*                MOVE ER-2163        TO  EMI-ERROR
  4849*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4850*            ELSE
  4851*                MOVE AL-UNNON       TO  LFPCT3A
  4852*        ELSE
  4853*            MOVE -1             TO  LFPCT3L
  4854*            MOVE AL-UNBON       TO  LFPCT3A
  4855*            MOVE ER-2163        TO  EMI-ERROR
  4856*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4857*
  4858*    IF LFTHRU3L GREATER ZERO
  4859*        MOVE LFTHRU3I               TO  DEEDIT-FIELD
  4860*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4861*        IF DEEDIT-FIELD-V0 NUMERIC
  4862*            MOVE DEEDIT-FIELD-V0    TO  WS-LF-THRU-3
  4863*            MOVE AL-UNNON           TO  LFTHRU3A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6504.cbl
  4864*        ELSE
  4865*            MOVE -1             TO  LFTHRU3L
  4866*            MOVE AL-UNBON       TO  LFTHRU3A
  4867*            MOVE ER-2163        TO  EMI-ERROR
  4868*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4869
  4870     IF AHRETENL GREATER ZERO
  4871         MOVE AHRETENI               TO  DEEDIT-FIELD
  4872         PERFORM 7200-DEEDIT THRU 7200-EXIT
  4873         IF DEEDIT-FIELD-V4 NUMERIC
  4874             MOVE DEEDIT-FIELD-V4    TO  WS-AH-RET
  4875             IF WS-AH-RET GREATER 1
  4876                 MOVE -1             TO  AHRETENL
  4877                 MOVE AL-UNBON       TO  AHRETENA
  4878                 MOVE ER-2164        TO  EMI-ERROR
  4879                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4880             ELSE
  4881                 MOVE AL-UNNON       TO  AHRETENA
  4882         ELSE
  4883             MOVE -1             TO  AHRETENL
  4884             MOVE AL-UNBON       TO  AHRETENA
  4885             MOVE ER-2164        TO  EMI-ERROR
  4886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4887
  4888*    IF AHMETHDL GREATER ZERO
  4889*        IF AHMETHDI = 'P' OR 'S' OR ' '
  4890*            NEXT SENTENCE
  4891*        ELSE
  4892*            MOVE ER-2162        TO  EMI-ERROR
  4893*            MOVE -1             TO  AHMETHDL
  4894*            MOVE AL-UABON       TO  AHMETHDA
  4895*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4896*
  4897*    IF AHBASISL GREATER ZERO
  4898*        IF AHBASISI = 'P' OR 'E' OR ' '
  4899*            NEXT SENTENCE
  4900*        ELSE
  4901*            MOVE ER-2162        TO  EMI-ERROR
  4902*            MOVE -1             TO  AHBASISL
  4903*            MOVE AL-UABON       TO  AHBASISA
  4904*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4905*
  4906*    IF AHPCT1L GREATER ZERO
  4907*        MOVE AHPCT1I                TO  DEEDIT-FIELD
  4908*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4909*        IF DEEDIT-FIELD-V4 NUMERIC
  4910*            MOVE DEEDIT-FIELD-V4    TO  WS-AH-PCT-1
  4911*            IF WS-AH-PCT-1 GREATER 1
  4912*                MOVE -1             TO  AHPCT1L
  4913*                MOVE AL-UNBON       TO  AHPCT1A
  4914*                MOVE ER-2163        TO  EMI-ERROR
  4915*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4916*            ELSE
  4917*                MOVE AL-UNNON       TO  AHPCT1A
  4918*        ELSE
  4919*            MOVE -1             TO  AHPCT1L
  4920*            MOVE AL-UNBON       TO  AHPCT1A
  4921*            MOVE ER-2163        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6504.cbl
  4922*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4923*
  4924*    IF AHTHRU1L GREATER ZERO
  4925*        MOVE AHTHRU1I               TO  DEEDIT-FIELD
  4926*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4927*        IF DEEDIT-FIELD-V0 NUMERIC
  4928*            MOVE DEEDIT-FIELD-V0    TO  WS-AH-THRU-1
  4929*            MOVE AL-UNNON           TO  AHTHRU1A
  4930*        ELSE
  4931*            MOVE -1             TO  AHTHRU1L
  4932*            MOVE AL-UNBON       TO  AHTHRU1A
  4933*            MOVE ER-2163        TO  EMI-ERROR
  4934*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4935*
  4936*    IF AHPCT2L GREATER ZERO
  4937*        MOVE AHPCT2I                TO  DEEDIT-FIELD
  4938*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4939*        IF DEEDIT-FIELD-V4 NUMERIC
  4940*            MOVE DEEDIT-FIELD-V4    TO  WS-AH-PCT-2
  4941*            IF WS-AH-PCT-2 GREATER 1
  4942*                MOVE -1             TO  AHPCT2L
  4943*                MOVE AL-UNBON       TO  AHPCT2A
  4944*                MOVE ER-2163        TO  EMI-ERROR
  4945*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4946*            ELSE
  4947*                MOVE AL-UNNON       TO  AHPCT2A
  4948*        ELSE
  4949*            MOVE -1             TO  AHPCT2L
  4950*            MOVE AL-UNBON       TO  AHPCT2A
  4951*            MOVE ER-2163        TO  EMI-ERROR
  4952*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4953*
  4954*    IF AHTHRU2L GREATER ZERO
  4955*        MOVE AHTHRU2I               TO  DEEDIT-FIELD
  4956*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4957*        IF DEEDIT-FIELD-V0 NUMERIC
  4958*            MOVE DEEDIT-FIELD-V0    TO  WS-AH-THRU-2
  4959*            MOVE AL-UNNON           TO  AHTHRU2A
  4960*        ELSE
  4961*            MOVE -1             TO  AHTHRU2L
  4962*            MOVE AL-UNBON       TO  AHTHRU2A
  4963*            MOVE ER-2163        TO  EMI-ERROR
  4964*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4965*
  4966*    IF AHPCT3L GREATER ZERO
  4967*        MOVE AHPCT3I                TO  DEEDIT-FIELD
  4968*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4969*        IF DEEDIT-FIELD-V4 NUMERIC
  4970*            MOVE DEEDIT-FIELD-V4    TO  WS-AH-PCT-3
  4971*            IF WS-AH-PCT-3 GREATER 1
  4972*                MOVE -1             TO  AHPCT3L
  4973*                MOVE AL-UNBON       TO  AHPCT3A
  4974*                MOVE ER-2163        TO  EMI-ERROR
  4975*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4976*            ELSE
  4977*                MOVE AL-UNNON       TO  AHPCT3A
  4978*        ELSE
  4979*            MOVE -1             TO  AHPCT3L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6504.cbl
  4980*            MOVE AL-UNBON       TO  AHPCT3A
  4981*            MOVE ER-2163        TO  EMI-ERROR
  4982*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4983*
  4984*    IF AHTHRU3L GREATER ZERO
  4985*        MOVE AHTHRU3I               TO  DEEDIT-FIELD
  4986*        PERFORM 7200-DEEDIT THRU 7200-EXIT
  4987*        IF DEEDIT-FIELD-V0 NUMERIC
  4988*            MOVE DEEDIT-FIELD-V0    TO  WS-AH-THRU-3
  4989*            MOVE AL-UNNON           TO  AHTHRU3A
  4990*        ELSE
  4991*            MOVE -1             TO  LFTHRU3L
  4992*            MOVE AL-UNBON       TO  LFTHRU3A
  4993*            MOVE ER-2163        TO  EMI-ERROR
  4994*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4995*
  4996     IF COM1L GREATER ZERO
  4997         MOVE AL-UANON           TO  COM1A.
  4998
  4999     IF COM2L GREATER ZERO
  5000         MOVE AL-UANON           TO  COM2A.
  5001
  5002     IF COM3L GREATER ZERO
  5003         MOVE AL-UANON           TO  COM3A.
  5004
  5005     IF COM4L GREATER ZERO
  5006         MOVE AL-UANON           TO  COM4A.
  5007
  5008     IF COM5L GREATER ZERO
  5009         MOVE AL-UANON           TO  COM5A.
  5010
  5011 7099-EXIT.
  5012     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6504.cbl
  5014 7100-READ-ERACCT.
  5015
  5016* EXEC CICS READ
  5017*         DATASET  (ERACCT-FILE)
  5018*         SET      (ADDRESS OF ACCOUNT-MASTER)
  5019*         RIDFLD   (PI-ACCT-KEY)
  5020*    END-EXEC.
  5021*    MOVE '&"S        E          (   #00004948' TO DFHEIV0
  5022     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5024     MOVE X'2020233030303034393438' TO DFHEIV0(25:11)
  5025     CALL 'kxdfhei1' USING DFHEIV0,
  5026           ERACCT-FILE,
  5027           DFHEIV20,
  5028           DFHEIV99,
  5029           PI-ACCT-KEY,
  5030           DFHEIV99,
  5031           DFHEIV99,
  5032           DFHEIV99
  5033     SET ADDRESS OF ACCOUNT-MASTER TO
  5034         DFHEIV20
  5035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5036
  5037
  5038     CONTINUE.
  5039
  5040     MOVE AM-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5041     MOVE AM-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  5042
  5043 7100-EXIT.
  5044     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6504.cbl
  5046 7200-DEEDIT.
  5047
  5048* EXEC CICS BIF
  5049*         DEEDIT
  5050*         FIELD  (DEEDIT-FIELD)
  5051*         LENGTH (15)
  5052*    END-EXEC.
  5053     MOVE 15
  5054       TO DFHEIV11
  5055*    MOVE '@"L                   #   #00004963' TO DFHEIV0
  5056     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5057     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5058     MOVE X'2020233030303034393633' TO DFHEIV0(25:11)
  5059     CALL 'kxdfhei1' USING DFHEIV0,
  5060           DEEDIT-FIELD,
  5061           DFHEIV11
  5062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5063
  5064
  5065 7200-EXIT.
  5066     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6504.cbl
  5068 7300-READ-ERACCT-UPDATE.
  5069
  5070* EXEC CICS READ
  5071*         DATASET  (ERACCT-FILE)
  5072*         SET      (ADDRESS OF ACCOUNT-MASTER)
  5073*         RIDFLD   (PI-ACCT-KEY)
  5074*         UPDATE
  5075*    END-EXEC.
  5076*    MOVE '&"S        EU         (   #00004973' TO DFHEIV0
  5077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5078     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5079     MOVE X'2020233030303034393733' TO DFHEIV0(25:11)
  5080     CALL 'kxdfhei1' USING DFHEIV0,
  5081           ERACCT-FILE,
  5082           DFHEIV20,
  5083           DFHEIV99,
  5084           PI-ACCT-KEY,
  5085           DFHEIV99,
  5086           DFHEIV99,
  5087           DFHEIV99
  5088     SET ADDRESS OF ACCOUNT-MASTER TO
  5089         DFHEIV20
  5090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5091
  5092
  5093     CONTINUE.
  5094
  5095 7300-EXIT.
  5096     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6504.cbl
  5098 7400-EDIT-MORTALITY.
  5099     IF MORTALI = SPACES
  5100         GO TO 7499-EXIT.
  5101
  5102     MOVE SPACES                 TO  ELCNTL-KEY.
  5103     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  5104     MOVE '7'                    TO  CNTL-REC-TYPE.
  5105     MOVE +0                     TO  CNTL-SEQ-NO.
  5106
  5107
  5108* EXEC CICS HANDLE CONDITION
  5109*        NOTFND  (7490-NOT-FOUND)
  5110*        ENDFILE (7490-NOT-FOUND)
  5111*    END-EXEC.
  5112*    MOVE '"$I''                  ! # #00004994' TO DFHEIV0
  5113     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5115     MOVE X'2320233030303034393934' TO DFHEIV0(25:11)
  5116     CALL 'kxdfhei1' USING DFHEIV0
  5117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5118
  5119
  5120 7405-READ-MORTALITY.
  5121
  5122
  5123* EXEC CICS READ
  5124*         DATASET  (CNTL-FILE-ID)
  5125*         SET      (ADDRESS OF CONTROL-FILE)
  5126*         RIDFLD   (ELCNTL-KEY)
  5127*    END-EXEC.
  5128*    MOVE '&"S        E          (   #00005001' TO DFHEIV0
  5129     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5130     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5131     MOVE X'2020233030303035303031' TO DFHEIV0(25:11)
  5132     CALL 'kxdfhei1' USING DFHEIV0,
  5133           CNTL-FILE-ID,
  5134           DFHEIV20,
  5135           DFHEIV99,
  5136           ELCNTL-KEY,
  5137           DFHEIV99,
  5138           DFHEIV99,
  5139           DFHEIV99
  5140     SET ADDRESS OF CONTROL-FILE TO
  5141         DFHEIV20
  5142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5143
  5144
  5145     CONTINUE.
  5146
  5147     IF PI-COMPANY-ID NOT EQUAL  TO CF-COMPANY-ID
  5148         OR CF-RECORD-TYPE NOT EQUAL '7'
  5149         GO TO 7490-NOT-FOUND
  5150     ELSE
  5151         MOVE +1                 TO  SUB2
  5152         GO TO 7410-SEARCH-MORTAL-TABLE.
  5153
  5154 7410-SEARCH-MORTAL-TABLE.
  5155
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6504.cbl
  5156     IF CF-MORT-TABLE-CODE (SUB2) = MORTALI
  5157         GO TO 7499-EXIT.
  5158
  5159     IF CF-MORT-TABLE-CODE (SUB2) = LOW-VALUES
  5160            OR
  5161        CF-MORT-TABLE-CODE (SUB2) GREATER THAN MORTALI
  5162        GO TO 7490-NOT-FOUND.
  5163
  5164     ADD +1                      TO  SUB2.
  5165
  5166     IF SUB2 GREATER +9
  5167         ADD +1                  TO CNTL-SEQ-NO
  5168         GO TO 7405-READ-MORTALITY
  5169     ELSE
  5170         GO TO 7410-SEARCH-MORTAL-TABLE.
  5171
  5172 7490-NOT-FOUND.
  5173     MOVE -1                     TO  MORTALL.
  5174     MOVE AL-UABON               TO  MORTALA.
  5175     MOVE ER-2103                TO  EMI-ERROR
  5176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5177
  5178 7499-EXIT.
  5179     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6504.cbl
  5181 7800-COMPANY-REC-READ.
  5182     MOVE SPACES                 TO  ELCNTL-KEY.
  5183     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  5184     MOVE '1'                    TO  CNTL-REC-TYPE.
  5185     MOVE +0                     TO  CNTL-SEQ-NO.
  5186
  5187* EXEC CICS HANDLE CONDITION
  5188*        NOTFND   (7880-NO-COMP)
  5189*    END-EXEC.
  5190*    MOVE '"$I                   ! $ #00005048' TO DFHEIV0
  5191     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5193     MOVE X'2420233030303035303438' TO DFHEIV0(25:11)
  5194     CALL 'kxdfhei1' USING DFHEIV0
  5195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5196
  5197
  5198
  5199* EXEC CICS READ
  5200*        DATASET   (CNTL-FILE-ID)
  5201*        SET       (ADDRESS OF CONTROL-FILE)
  5202*        RIDFLD    (ELCNTL-KEY)
  5203*    END-EXEC.
  5204*    MOVE '&"S        E          (   #00005052' TO DFHEIV0
  5205     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5207     MOVE X'2020233030303035303532' TO DFHEIV0(25:11)
  5208     CALL 'kxdfhei1' USING DFHEIV0,
  5209           CNTL-FILE-ID,
  5210           DFHEIV20,
  5211           DFHEIV99,
  5212           ELCNTL-KEY,
  5213           DFHEIV99,
  5214           DFHEIV99,
  5215           DFHEIV99
  5216     SET ADDRESS OF CONTROL-FILE TO
  5217         DFHEIV20
  5218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5219
  5220
  5221     CONTINUE.
  5222
  5223     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  5224         MOVE ER-2572            TO  EMI-ERROR
  5225         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5226
  5227     GO TO 7899-EXIT.
  5228
  5229 7880-NO-COMP.
  5230     MOVE ER-0002                TO  EMI-ERROR
  5231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5232
  5233 7899-EXIT.
  5234     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6504.cbl
  5236
  5237 8000-UPDATE-MAINT-DATE.
  5238     MOVE SPACES                 TO  ELCNTL-KEY.
  5239
  5240     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  5241     MOVE '1'                    TO  CNTL-REC-TYPE.
  5242     MOVE +0                     TO  CNTL-SEQ-NO.
  5243
  5244
  5245* EXEC CICS HANDLE CONDITION
  5246*        NOTFND   (8000-EXIT)
  5247*    END-EXEC.
  5248*    MOVE '"$I                   ! % #00005081' TO DFHEIV0
  5249     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5251     MOVE X'2520233030303035303831' TO DFHEIV0(25:11)
  5252     CALL 'kxdfhei1' USING DFHEIV0
  5253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5254
  5255
  5256
  5257* EXEC CICS READ
  5258*        UPDATE
  5259*        DATASET   (CNTL-FILE-ID)
  5260*        SET       (ADDRESS OF CONTROL-FILE)
  5261*        RIDFLD    (ELCNTL-KEY)
  5262*    END-EXEC.
  5263*    MOVE '&"S        EU         (   #00005085' TO DFHEIV0
  5264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5265     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5266     MOVE X'2020233030303035303835' TO DFHEIV0(25:11)
  5267     CALL 'kxdfhei1' USING DFHEIV0,
  5268           CNTL-FILE-ID,
  5269           DFHEIV20,
  5270           DFHEIV99,
  5271           ELCNTL-KEY,
  5272           DFHEIV99,
  5273           DFHEIV99,
  5274           DFHEIV99
  5275     SET ADDRESS OF CONTROL-FILE TO
  5276         DFHEIV20
  5277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5278
  5279
  5280     CONTINUE.
  5281
  5282     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  5283     MOVE 'B'                    TO  JP-RECORD-TYPE.
  5284     MOVE ELCNTL-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.
  5285     MOVE CNTL-FILE-ID           TO  FILE-ID.
  5286     PERFORM 8400-LOG-JOURNAL-RECORD.
  5287
  5288     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  5289
  5290     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  5291     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5292     MOVE CNTL-FILE-ID           TO  FILE-ID.
  5293
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL6504.cbl
  5294
  5295* EXEC CICS REWRITE
  5296*        DATASET   (CNTL-FILE-ID)
  5297*        FROM      (CONTROL-FILE)
  5298*    END-EXEC.
  5299     MOVE LENGTH OF
  5300      CONTROL-FILE
  5301       TO DFHEIV11
  5302*    MOVE '&& L                  %   #00005106' TO DFHEIV0
  5303     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5304     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5305     MOVE X'2020233030303035313036' TO DFHEIV0(25:11)
  5306     CALL 'kxdfhei1' USING DFHEIV0,
  5307           CNTL-FILE-ID,
  5308           CONTROL-FILE,
  5309           DFHEIV11,
  5310           DFHEIV99
  5311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5312
  5313
  5314     MOVE ELCNTL-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.
  5315     PERFORM 8400-LOG-JOURNAL-RECORD.
  5316
  5317 8000-EXIT.
  5318      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL6504.cbl
  5320
  5321 8100-SEND-INITIAL-MAP.
  5322     MOVE SAVE-DATE              TO  DATEO.
  5323     MOVE EIBTIME                TO  TIME-IN.
  5324     MOVE TIME-OUT               TO  TIMEO.
  5325     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5326     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5327     MOVE -1                     TO  PFENTERL.
  5328     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5329
  5330     MOVE PI-LIFE-OVERRIDE-L6    TO  LFREIHDO
  5331                                     LFRETHDO.
  5332     MOVE PI-AH-OVERRIDE-L6      TO  AHREIHDO
  5333                                     AHRETHDO.
  5334     MOVE PI-LIFE-OVERRIDE-L2    TO  LRETHD1O.
  5335     MOVE PI-AH-OVERRIDE-L2      TO  ARETHD1O
  5336                                     ARETHD2O
  5337                                     ARETHD3O.
  5338
  5339     SET T-INDEX                 TO PI-LINE-SELECTED
  5340
  5341     IF PI-2ND-PAGE
  5342        SET T-INDEX UP BY 8
  5343     ELSE
  5344        IF PI-3RD-PAGE
  5345           SET T-INDEX UP BY 16
  5346        ELSE
  5347           IF PI-LST-PAGE
  5348              SET T-INDEX UP BY 24
  5349           END-IF
  5350        END-IF
  5351     END-IF
  5352
  5353     MOVE PI-ACCT-CARRIER        TO CARRI
  5354     MOVE PI-ACCT-GROUPING       TO GROUPINI
  5355     MOVE PI-ACCT-STATE          TO STATEI
  5356     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI
  5357
  5358     IF PI-ACCT-EXP-DT = LOW-VALUES
  5359        MOVE SPACES              TO EXPDTEI
  5360     ELSE
  5361        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  5362           MOVE PI-ACCT-EXP-DT   TO DC-BIN-DATE-1
  5363           MOVE SPACE            TO DC-OPTION-CODE
  5364           PERFORM 9700-LINK-DATE-CONVERT
  5365                                 THRU 9700-EXIT
  5366           MOVE DC-GREG-DATE-1-EDIT
  5367                                 TO EXPDTEI
  5368        ELSE
  5369           MOVE 999999           TO EXPDTEO
  5370           INSPECT EXPDTEI CONVERTING SPACES TO '/'
  5371        END-IF
  5372     END-IF
  5373
  5374     MOVE EXPDTEI (1:2)          TO WS-YYYYMMDD (5:2)
  5375     MOVE EXPDTEI (4:2)          TO WS-YYYYMMDD (7:2)
  5376     MOVE EXPDTEI (6:2)          TO WS-YYYYMMDD (3:2)
  5377     IF EXPDTEI (7:1) NOT = '9'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL6504.cbl
  5378        MOVE '20'                TO WS-YYYYMMDD (1:2)
  5379     ELSE
  5380        MOVE '19'                TO WS-YYYYMMDD (1:2)
  5381     END-IF
  5382
  5383     MOVE PI-BIN-EFF-DT (T-INDEX)
  5384                                 TO DC-BIN-DATE-1
  5385     MOVE SPACE                  TO DC-OPTION-CODE
  5386     PERFORM 9700-LINK-DATE-CONVERT
  5387                                 THRU 9700-EXIT
  5388     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTEI
  5389
  5390     IF PI-PROCESSOR-ID NOT = 'PEMA'
  5391        MOVE AL-SADON            TO LTAXA
  5392                                    ATAXA
  5393     END-IF
  5394
  5395
  5396* EXEC CICS SEND
  5397*        MAP      (MAP-NAME)
  5398*        MAPSET   (MAPSET-NAME)
  5399*        FROM     (EL6504AO)
  5400*        ERASE
  5401*        CURSOR
  5402*    END-EXEC.
  5403     MOVE LENGTH OF
  5404      EL6504AO
  5405       TO DFHEIV12
  5406     MOVE -1
  5407       TO DFHEIV11
  5408*    MOVE '8$     CT  E    H L F ,   #00005192' TO DFHEIV0
  5409     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5410     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5411     MOVE X'2020233030303035313932' TO DFHEIV0(25:11)
  5412     CALL 'kxdfhei1' USING DFHEIV0,
  5413           MAP-NAME,
  5414           EL6504AO,
  5415           DFHEIV12,
  5416           MAPSET-NAME,
  5417           DFHEIV99,
  5418           DFHEIV99,
  5419           DFHEIV99,
  5420           DFHEIV11,
  5421           DFHEIV99,
  5422           DFHEIV99,
  5423           DFHEIV99
  5424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5425
  5426
  5427     GO TO 9100-RETURN-TRAN.
  5428
  5429 8200-SEND-DATAONLY.
  5430     MOVE SAVE-DATE              TO  DATEO.
  5431     MOVE EIBTIME                TO  TIME-IN.
  5432     MOVE TIME-OUT               TO  TIMEO.
  5433     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5434     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5435     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL6504.cbl
  5436
  5437     MOVE PI-LIFE-OVERRIDE-L6    TO  LFREIHDO
  5438                                     LFRETHDO.
  5439     MOVE PI-AH-OVERRIDE-L6      TO  AHREIHDO
  5440                                     AHRETHDO.
  5441     MOVE PI-LIFE-OVERRIDE-L2    TO  LRETHD1O.
  5442     MOVE PI-AH-OVERRIDE-L2      TO  ARETHD1O
  5443                                     ARETHD2O
  5444                                     ARETHD3O.
  5445
  5446     IF PI-PROCESSOR-ID NOT = 'PEMA'
  5447        MOVE AL-SADON            TO LTAXA
  5448                                    ATAXA
  5449     END-IF
  5450
  5451
  5452* EXEC CICS SEND
  5453*        MAP      (MAP-NAME)
  5454*        MAPSET   (MAPSET-NAME)
  5455*        FROM     (EL6504AO)
  5456*        DATAONLY
  5457*        ERASEAUP
  5458*        CURSOR
  5459*    END-EXEC.
  5460     MOVE LENGTH OF
  5461      EL6504AO
  5462       TO DFHEIV12
  5463     MOVE -1
  5464       TO DFHEIV11
  5465*    MOVE '8$D    CT  A    H L F ,   #00005224' TO DFHEIV0
  5466     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  5467     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5468     MOVE X'2020233030303035323234' TO DFHEIV0(25:11)
  5469     CALL 'kxdfhei1' USING DFHEIV0,
  5470           MAP-NAME,
  5471           EL6504AO,
  5472           DFHEIV12,
  5473           MAPSET-NAME,
  5474           DFHEIV99,
  5475           DFHEIV99,
  5476           DFHEIV99,
  5477           DFHEIV11,
  5478           DFHEIV99,
  5479           DFHEIV99,
  5480           DFHEIV99
  5481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5482
  5483
  5484     GO TO 9100-RETURN-TRAN.
  5485
  5486 8300-SEND-TEXT.
  5487
  5488* EXEC CICS SEND TEXT
  5489*        FROM     (LOGOFF-TEXT)
  5490*        LENGTH   (LOGOFF-LENGTH)
  5491*        ERASE
  5492*        FREEKB
  5493*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL6504.cbl
  5494*    MOVE '8&      T  E F  H   F -   #00005236' TO DFHEIV0
  5495     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5496     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5497     MOVE X'2020233030303035323336' TO DFHEIV0(25:11)
  5498     CALL 'kxdfhei1' USING DFHEIV0,
  5499           LOGOFF-TEXT,
  5500           LOGOFF-LENGTH,
  5501           DFHEIV99,
  5502           DFHEIV99,
  5503           DFHEIV99,
  5504           DFHEIV99,
  5505           DFHEIV99,
  5506           DFHEIV99,
  5507           DFHEIV99,
  5508           DFHEIV99,
  5509           DFHEIV99,
  5510           DFHEIV99
  5511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5512
  5513
  5514
  5515* EXEC CICS RETURN
  5516*    END-EXEC.
  5517*    MOVE '.(                    &   #00005243' TO DFHEIV0
  5518     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5520     MOVE X'2020233030303035323433' TO DFHEIV0(25:11)
  5521     CALL 'kxdfhei1' USING DFHEIV0,
  5522           DFHEIV99,
  5523           DFHEIV99,
  5524           DFHEIV99,
  5525           DFHEIV99,
  5526           DFHEIV99
  5527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5528
  5529
  5530 8400-LOG-JOURNAL-RECORD.
  5531     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5532     MOVE FILE-ID                TO  JP-FILE-ID.
  5533     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5534*    IF PI-JOURNAL-FILE-ID NOT = ZERO
  5535*        EXEC CICS JOURNAL
  5536*            JFILEID     (PI-JOURNAL-FILE-ID)
  5537*            JTYPEID     ('ER')
  5538*            FROM        (JOURNAL-RECORD)
  5539*            LENGTH      (WS-JOURNAL-FILE-LENGTH)
  5540*        END-EXEC.
  5541
  5542 8800-UNAUTHORIZED-ACCESS.
  5543     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5544     GO TO 8300-SEND-TEXT.
  5545
  5546 8810-PF23.
  5547     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5548     MOVE XCTL-005               TO  PGM-NAME.
  5549     GO TO 9300-XCTL.
  5550
  5551 9000-RETURN-CICS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL6504.cbl
  5552
  5553* EXEC CICS RETURN
  5554*    END-EXEC.
  5555*    MOVE '.(                    &   #00005268' TO DFHEIV0
  5556     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5557     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5558     MOVE X'2020233030303035323638' TO DFHEIV0(25:11)
  5559     CALL 'kxdfhei1' USING DFHEIV0,
  5560           DFHEIV99,
  5561           DFHEIV99,
  5562           DFHEIV99,
  5563           DFHEIV99,
  5564           DFHEIV99
  5565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5566
  5567
  5568 9100-RETURN-TRAN.
  5569     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5570     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5571
  5572* EXEC CICS RETURN
  5573*        TRANSID    (TRANS-ID)
  5574*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  5575*        LENGTH     (WS-COMM-LENGTH)
  5576*    END-EXEC.
  5577*    MOVE '.(CT                  &   #00005274' TO DFHEIV0
  5578     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5580     MOVE X'2020233030303035323734' TO DFHEIV0(25:11)
  5581     CALL 'kxdfhei1' USING DFHEIV0,
  5582           TRANS-ID,
  5583           PROGRAM-INTERFACE-BLOCK,
  5584           WS-COMM-LENGTH,
  5585           DFHEIV99,
  5586           DFHEIV99
  5587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5588
  5589
  5590 9200-RETURN-MAIN-MENU.
  5591     MOVE XCTL-626               TO  PGM-NAME.
  5592     GO TO 9300-XCTL.
  5593
  5594 9300-XCTL.
  5595
  5596* EXEC CICS XCTL
  5597*        PROGRAM    (PGM-NAME)
  5598*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  5599*        LENGTH     (WS-COMM-LENGTH)
  5600*    END-EXEC.
  5601*    MOVE '.$C                   $   #00005285' TO DFHEIV0
  5602     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5603     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5604     MOVE X'2020233030303035323835' TO DFHEIV0(25:11)
  5605     CALL 'kxdfhei1' USING DFHEIV0,
  5606           PGM-NAME,
  5607           PROGRAM-INTERFACE-BLOCK,
  5608           WS-COMM-LENGTH
  5609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL6504.cbl
  5610
  5611
  5612 9400-CLEAR.
  5613     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5614     GO TO 9300-XCTL.
  5615
  5616 9500-PF12.
  5617     MOVE XCTL-010               TO  PGM-NAME.
  5618     GO TO 9300-XCTL.
  5619
  5620 9600-PGMID-ERROR.
  5621
  5622* EXEC CICS HANDLE CONDITION
  5623*        PGMIDERR    (8300-SEND-TEXT)
  5624*    END-EXEC.
  5625*    MOVE '"$L                   ! & #00005300' TO DFHEIV0
  5626     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5628     MOVE X'2620233030303035333030' TO DFHEIV0(25:11)
  5629     CALL 'kxdfhei1' USING DFHEIV0
  5630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5631
  5632
  5633     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5634     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5635     MOVE XCTL-005               TO  PGM-NAME.
  5636     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5637     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5638     GO TO 9300-XCTL.
  5639
  5640 9700-LINK-DATE-CONVERT.
  5641
  5642
  5643* EXEC CICS LINK
  5644*        PROGRAM    ('ELDATCV')
  5645*        COMMAREA   (DATE-CONVERSION-DATA)
  5646*        LENGTH     (DC-COMM-LENGTH)
  5647*    END-EXEC.
  5648     MOVE 'ELDATCV' TO DFHEIV1
  5649*    MOVE '."C                   ''   #00005313' TO DFHEIV0
  5650     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5651     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5652     MOVE X'2020233030303035333133' TO DFHEIV0(25:11)
  5653     CALL 'kxdfhei1' USING DFHEIV0,
  5654           DFHEIV1,
  5655           DATE-CONVERSION-DATA,
  5656           DC-COMM-LENGTH,
  5657           DFHEIV99,
  5658           DFHEIV99,
  5659           DFHEIV99
  5660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5661
  5662
  5663 9700-EXIT.
  5664     EXIT.
  5665
  5666 9900-ERROR-FORMAT.
  5667     IF NOT EMI-ERRORS-COMPLETE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL6504.cbl
  5668         MOVE LINK-001           TO  PGM-NAME
  5669
  5670* EXEC CICS LINK
  5671*            PROGRAM    (PGM-NAME)
  5672*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  5673*            LENGTH     (EMI-COMM-LENGTH)
  5674*        END-EXEC.
  5675*    MOVE '."C                   ''   #00005325' TO DFHEIV0
  5676     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5678     MOVE X'2020233030303035333235' TO DFHEIV0(25:11)
  5679     CALL 'kxdfhei1' USING DFHEIV0,
  5680           PGM-NAME,
  5681           ERROR-MESSAGE-INTERFACE-BLOCK,
  5682           EMI-COMM-LENGTH,
  5683           DFHEIV99,
  5684           DFHEIV99,
  5685           DFHEIV99
  5686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5687
  5688
  5689 9900-EXIT.
  5690     EXIT.
  5691
  5692 9990-ABEND.
  5693     MOVE LINK-004               TO  PGM-NAME.
  5694     MOVE DFHEIBLK               TO  EMI-LINE1.
  5695
  5696* EXEC CICS LINK
  5697*        PROGRAM   (PGM-NAME)
  5698*        COMMAREA  (EMI-LINE1)
  5699*        LENGTH    (72)
  5700*    END-EXEC.
  5701     MOVE 72
  5702       TO DFHEIV11
  5703*    MOVE '."C                   ''   #00005337' TO DFHEIV0
  5704     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5706     MOVE X'2020233030303035333337' TO DFHEIV0(25:11)
  5707     CALL 'kxdfhei1' USING DFHEIV0,
  5708           PGM-NAME,
  5709           EMI-LINE1,
  5710           DFHEIV11,
  5711           DFHEIV99,
  5712           DFHEIV99,
  5713           DFHEIV99
  5714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5715
  5716
  5717     GO TO 8200-SEND-DATAONLY.
  5718
  5719
  5720* GOBACK.
  5721     MOVE '9%                    "   ' TO DFHEIV0
  5722     MOVE 'EL6504' TO DFHEIV1
  5723     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5724     GOBACK.
  5725
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL6504.cbl
  5726 9995-SECURITY-VIOLATION.
  5727*           COPY ELCSCTP.
  5728******************************************************************
  5729*                                                                *
  5730*                            ELCSCTP                             *
  5731*                            VMOD=2.001                          *
  5732*                                                                *
  5733*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5734******************************************************************
  5735
  5736
  5737     MOVE EIBDATE          TO SM-JUL-DATE.
  5738     MOVE EIBTRMID         TO SM-TERMID.
  5739     MOVE THIS-PGM         TO SM-PGM.
  5740     MOVE EIBTIME          TO TIME-IN.
  5741     MOVE TIME-OUT         TO SM-TIME.
  5742     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5743
  5744
  5745* EXEC CICS LINK
  5746*         PROGRAM  ('EL003')
  5747*         COMMAREA (SECURITY-MESSAGE)
  5748*         LENGTH   (80)
  5749*    END-EXEC.
  5750     MOVE 'EL003' TO DFHEIV1
  5751     MOVE 80
  5752       TO DFHEIV11
  5753*    MOVE '."C                   ''   #00005365' TO DFHEIV0
  5754     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5756     MOVE X'2020233030303035333635' TO DFHEIV0(25:11)
  5757     CALL 'kxdfhei1' USING DFHEIV0,
  5758           DFHEIV1,
  5759           SECURITY-MESSAGE,
  5760           DFHEIV11,
  5761           DFHEIV99,
  5762           DFHEIV99,
  5763           DFHEIV99
  5764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5765
  5766
  5767******************************************************************
  5768
  5769 9995-EXIT.
  5770      EXIT.
  5772
  5773 9999-DFHBACK SECTION.
  5774     MOVE '9%                    "   ' TO DFHEIV0
  5775     MOVE 'EL6504' TO DFHEIV1
  5776     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5777     GOBACK.
  5778 9999-DFHEXIT.
  5779     IF DFHEIGDJ EQUAL 0001
  5780         NEXT SENTENCE
  5781     ELSE IF DFHEIGDJ EQUAL 2
  5782         GO TO 9600-PGMID-ERROR,
  5783               9990-ABEND
  5784         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL6504.cbl
  5785     ELSE IF DFHEIGDJ EQUAL 3
  5786         GO TO 7490-NOT-FOUND,
  5787               7490-NOT-FOUND
  5788         DEPENDING ON DFHEIGDI
  5789     ELSE IF DFHEIGDJ EQUAL 4
  5790         GO TO 7880-NO-COMP
  5791         DEPENDING ON DFHEIGDI
  5792     ELSE IF DFHEIGDJ EQUAL 5
  5793         GO TO 8000-EXIT
  5794         DEPENDING ON DFHEIGDI
  5795     ELSE IF DFHEIGDJ EQUAL 6
  5796         GO TO 8300-SEND-TEXT
  5797         DEPENDING ON DFHEIGDI.
  5798     MOVE '9%                    "   ' TO DFHEIV0
  5799     MOVE 'EL6504' TO DFHEIV1
  5800     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5801     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6676     Code:       10337
