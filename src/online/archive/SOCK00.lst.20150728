* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* SOCK00.cbl
* Options: int("SOCK00.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK00.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK00.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK00.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* SOCK00.cbl
    14*-----------------------------------------------------------------
    15* 091609  CR2009082400002  PEMA  ADD USER SELECT 3
    16* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    17* 042612  CR2012042500004  PEMA  ADD CODE TO HANDLE AHL
    18* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    19*-----------------------------------------------------------------
    20 identification division.
    21 program-id. SOCK00.
    22*         This program is the first invoked by the SOCK
    23*         transaction. This transaction must be submited
    24*         by a message transmited over a stream socket.
    25*         The first message format is:
    26*         aaaa,bbbbb              ccc
    27*         where "aaaa" is the tran id SOCK (1 to 4 characters)
    28*         and "bbbbb is either "RATE " or "STATE" and ccc is eithe
    29*         DCC or CID or any future company id
    30*         Information on the originating message and
    31*         remote socket is provided in the DFHCOMMAREA.
    32*         As its first action this program must send a
    33*         message to the requesting socket. This lets the
    34*         remote program know its request has been
    35*         accepted and the transaction started.
    36*         The program will make four transmissions to
    37*         the initating program in response to received
    38*         messages and then close the socket.
    39*         This program is provided to show method and
    40*         has minimal checking and error messages.
    41*         The Cobol compiler, unless instructed otherwise,
    42*         will hold its working storage integer data items in
    43*         machine idependent form. This matches the network
    44*         ordering of information. Care should be exercised
    45*         to ensure that this data ordering is correct when
    46*         calling system library functions or passing data
    47*         structure containing such data to functions.
    48 environment division.
    49 data division.
    50 working-storage section.
    51 01  DFH-START PIC X(04).
    52*
    53* program buffers
    54*
    55 77 ws-send-msg-size           pic s9(8) comp value 4096.
    56 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    57 77 ws-recv-buf                pic x(4096).
    58 77 ws-send-buf                pic x(4096) VALUE SPACES.
    59 77 ws-recv-total              pic s9(8) comp value 0.
    60 77 ws-recv-left               pic s9(8) comp value 0.
    61 77 ws-seq-num                 pic s9(8) comp value 0.
    62 77 ws-flags                   pic s9(8) comp value 0.
    63 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    64 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    65 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    66 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    67 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    68 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    69 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    70 77 S1                           PIC S999 COMP-3 VALUE +0.
    71 77 S2                           PIC S999 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* SOCK00.cbl
    72 77 WS-BUILD-SW                  PIC X.
    73    88  TIME-TO-BUILD               VALUE 'Y'.
    74 77 WS-SAVE-ERACCT               PIC X(2000).
    75 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    76 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    77    88  GET-RATES                    VALUE 'R'.
    78    88  GET-ACT-ACCTS                VALUE 'A'.
    79 77 ws-bin-eff-dt                pic xx  value low-values.
    80 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    81 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    82 77 ws-disp-rate                 pic z9.99999.
    83 77  WS-ERACCT-SW                PIC X VALUE ' '.
    84     88  END-OF-ERACCT                 VALUE 'Y'.
    85 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    86     88  END-OF-ERCTBL                 VALUE 'Y'.
    87 77  WS-STATUS                   PIC X.
    88 01  ws-work-date.
    89     05  ws-work-ccyy            pic x(4).
    90     05  ws-work-mm              pic xx.
    91     05  ws-work-dd              pic xx.
    92 01  ws-work-date-num redefines ws-work-date
    93                                 pic 9(8).
    94 01  WS-AM-CITY-STATE            PIC X(30) VALUE SPACES.
    95 01  ws-work-apr.
    96     05  ws-apr-num              pic 99V999.
    97 01  ws-work-ben.
    98     05  ws-ben-num              pic 9(5).
    99 01  ws-work-term.
   100     05  ws-term-num             pic 999.
   101 01  ws-get-rate-data.
   102     05  rate-state              pic xx.
   103     05  rate-lf-ah              pic x.
   104     05  rate-ben-code           pic xx.
   105     05  rate-earn-meth          pic x.
   106     05  rate-ben-amt            pic x(5).
   107     05  rate-eff-date           pic x(10).
   108     05  rate-term               pic xxx.
   109     05  rate-apr                pic x(5).
   110 01  WS-FIN-RESP                 PIC X(10).
   111 01  WS-GA-DATA.
   112     05  WS-GA-NUM               PIC X(10).
   113     05  WS-GA-PRIMARY-CONTACT   PIC X(30).
   114     05  WS-GA-NAME              PIC X(30).
   115     05  WS-GA-MAIL-NAME         PIC X(30).
   116     05  WS-GA-ADDR1             PIC X(30).
   117     05  WS-GA-ADDR2             PIC X(30).
   118     05  WS-GA-ADDR3             PIC X(30).
   119     05  WS-GA-ZIP               PIC X(9).
   120     05  WS-GA-PHONE             PIC X(10).
   121 01  WS-AM-KEY.
   122     05  WS-AM-COMPANY-CD        PIC X.
   123     05  WS-AM-CARRIER           PIC X.
   124     05  WS-AM-GROUP             PIC X(6).
   125     05  WS-AM-STATE             PIC XX.
   126     05  WS-AM-ACCOUNT           PIC X(10).
   127     05  WS-AM-EXP-DT            PIC XX.
   128     05  FILLER                  PIC X(4).
   129 01  WS-NT-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* SOCK00.cbl
   130     05  WS-NT-COMPANY-CD        PIC X.
   131     05  WS-NT-CARRIER           PIC X.
   132     05  WS-NT-GROUP             PIC X(6).
   133     05  WS-NT-STATE             PIC XX.
   134     05  WS-NT-ACCOUNT           PIC X(10).
   135     05  WS-NT-REC-TYPE          PIC X.
   136     05  WS-NT-SEQ-NO            PIC S9(4) COMP.
   137 01  WS-AM-ALT-KEY.
   138     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   139     05  WS-AM-ALT-EXP-DT        PIC XX.
   140 01  WS-CT-KEY-SAVE              PIC X(5).
   141 01  WS-CT-KEY.
   142     05  WS-CT-COMPANY-CD        PIC X.
   143     05  WS-CT-TABLE             PIC XXX.
   144     05  WS-CT-BEN-TYPE          PIC X.
   145     05  WS-CT-BEN-CODE          PIC XX.
   146 01  WS-CF-KEY-SAVE              PIC X(10).
   147 01  WS-CF-KEY.
   148     05  WS-CF-COMPANY-ID        PIC XXX.
   149     05  WS-CF-RECORD-TYPE       PIC X.
   150     05  WS-CF-ACCESS            PIC X(4).
   151     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   152 01  WS-CO-KEY.
   153     05  WS-CO-COMPANY-CD        PIC X.
   154     05  WS-CO-CARRIER           PIC X.
   155     05  WS-CO-GROUP             PIC X(6).
   156     05  WS-CO-FIN-RESP          PIC X(10).
   157     05  WS-CO-ACCOUNT           PIC X(10).
   158     05  WS-CO-TYPE              PIC X.
   159 01  WS-WORK-SAH-COMM            PIC SV9(5) VALUE +0.
   160 01  WS-WORK-JAH-COMM            PIC SV9(5) VALUE +0.
   161 01  WS-POLICY-NO                PIC X(6).
   162 01  WS-SHORT-ACCT-NAME          PIC X(30).
   163 01  WS-LONG-ACCT-NAME           PIC X(60).
   164 01  WS-CONTR-NAME               PIC X(60).
   165 01  WS-SL-COMM                  PIC 9.99999.
   166 01  WS-JL-COMM                  PIC 9.99999.
   167 01  WS-SAH-COMM                 PIC 9.99999.
   168 01  WS-JAH-COMM                 PIC 9.99999.
   169 01  WS-CID-NO                   PIC X(8).
   170 01  WS-DISP-RESP                PIC 9(5).
   171 01  WS-RESPONSE                 PIC S9(8)   COMP.
   172     88  RESP-NORMAL                  VALUE +00.
   173     88  RESP-NOTFND                  VALUE +13.
   174     88  RESP-NOTOPEN                 VALUE +19.
   175     88  RESP-ENDFILE                 VALUE +20.
   176*                                 COPY ERCACNT.
   177******************************************************************
   178*                                                                *
   179*                                                                *
   180*                            ERCACNT.                            *
   181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   182*                            VMOD=2.002                          *
   183*                                                                *
   184*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
   185*                                                                *
   186*   FILE TYPE = VSAM,KSDS                                        *
   187*   RECORD SIZE = 120   RECFORM = FIXED                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* SOCK00.cbl
   188*                                                                *
   189*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
   190*       ALTERNATE INDEX = NONE                                   *
   191*                                                                *
   192*                                                                *
   193*   LOG = YES                                                    *
   194*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   195******************************************************************
   196*                   C H A N G E   L O G
   197*
   198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   199*-----------------------------------------------------------------
   200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   201* EFFECTIVE    NUMBER
   202*-----------------------------------------------------------------
   203* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
   204*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
   205******************************************************************
   206 01  NOTE-FILE.
   207     12  NT-FILE-ID                  PIC XX.
   208         88  VALID-NOTE-ID              VALUE 'NT'.
   209
   210     12  NT-CONTROL-PRIMARY.
   211         16  NT-COMPANY-CD           PIC X.
   212         16  NT-ACCT-NOTE-KEY.
   213             18  NT-CARRIER              PIC X.
   214             18  NT-GROUPING             PIC X(06).
   215             18  NT-STATE                PIC XX.
   216             18  NT-ACCOUNT              PIC X(10).
   217         16  NT-RECORD-TYPE          PIC X.
   218              88  ACCT-NOTE          VALUE '1'.
   219              88  ACCT-BRANCH-LOC    VALUE '2'.
   220              88  ACCT-SHIPPING-ADDR VALUE '3'.
   221         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
   222
   223     12  NT-LAST-MAINT-DT            PIC XX.
   224     12  NT-LAST-MAINT-BY            PIC X(4).
   225     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
   226
   227*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
   228*     SEQUENCE NUMBERS
   229     12  NT-NOTE-INFORMATION.
   230         16  NT-NOTE-LINE            PIC X(60).
   231         16  FILLER                  PIC X(25).
   232*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
   233     12  NT-LOCATION-INFORMATION REDEFINES
   234                         NT-NOTE-INFORMATION.
   235         16  NT-BRANCH-LOC-LINE      PIC X(60).
   236         16  FILLER                  PIC X(25).
   237*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
   238*     SEQUENCE NUMBER 1 IS NAME LINE 1
   239*     SEQUENCE NUMBER 2 IS NAME LINE 2
   240*     SEQUENCE NUMBER 3 IS ADDR LINE 1
   241*     SEQUENCE NUMBER 4 IS ADDR LINE 2
   242*     SEQUENCE NUMBER 5 IS ADDR LINE 3
   243*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
   244     12  NT-SHIPPING-INFORMATION REDEFINES
   245                         NT-NOTE-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* SOCK00.cbl
   246         16  NT-SHIPPING-LINE        PIC X(60).
   247         16  NT-SHIP-STATE           PIC XX.
   248         16  NT-SHIP-ZIP             PIC X(10).
   249         16  FILLER                  PIC X(13).
   250*****************************************************************
   251*                                 COPY ERCACCT.
   252******************************************************************
   253*                                                                *
   254*                                                                *
   255*                            ERCACCT                             *
   256*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   257*                            VMOD=2.031                          *
   258*                                                                *
   259*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   260*                                                                *
   261*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   262*   VSAM ACCOUNT MASTER FILES.                                   *
   263*                                                                *
   264*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   265*                                                                *
   266*   FILE TYPE = VSAM,KSDS                                        *
   267*   RECORD SIZE = 2000  RECFORM = FIX                            *
   268*                                                                *
   269*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   270*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   271*                                                                *
   272*   LOG = NO                                                     *
   273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   274*                                                                *
   275*                                                                *
   276******************************************************************
   277*                   C H A N G E   L O G
   278*
   279* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   280*-----------------------------------------------------------------
   281*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   282* EFFECTIVE    NUMBER
   283*-----------------------------------------------------------------
   284* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   285* 092705    2005050300006  PEMA  ADD SPP LEASES
   286* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   287* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   288* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   289* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   290* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   291******************************************************************
   292
   293 01  ACCOUNT-MASTER.
   294     12  AM-RECORD-ID                      PIC XX.
   295         88  VALID-AM-ID                      VALUE 'AM'.
   296
   297     12  AM-CONTROL-PRIMARY.
   298         16  AM-COMPANY-CD                 PIC X.
   299         16  AM-MSTR-CNTRL.
   300             20  AM-CONTROL-A.
   301                 24  AM-CARRIER            PIC X.
   302                 24  AM-GROUPING.
   303                     28 AM-GROUPING-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* SOCK00.cbl
   304                     28 AM-GROUPING-PRIME  PIC XXX.
   305                 24  AM-STATE              PIC XX.
   306                 24  AM-ACCOUNT.
   307                     28  AM-ACCOUNT-PREFIX PIC X(4).
   308                     28  AM-ACCOUNT-PRIME  PIC X(6).
   309             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   310                                           PIC X(19).
   311             20  AM-CNTRL-B.
   312                 24  AM-EXPIRATION-DT      PIC XX.
   313                 24  FILLER                PIC X(4).
   314             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   315                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   316
   317     12  AM-CONTROL-BY-VAR-GRP.
   318         16  AM-COMPANY-CD-A1              PIC X.
   319         16  AM-VG-CARRIER                 PIC X.
   320         16  AM-VG-GROUPING                PIC X(6).
   321         16  AM-VG-STATE                   PIC XX.
   322         16  AM-VG-ACCOUNT                 PIC X(10).
   323         16  AM-VG-DATE.
   324             20  AM-VG-EXPIRATION-DT       PIC XX.
   325             20  FILLER                    PIC X(4).
   326         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   327                                           PIC 9(11)      COMP-3.
   328     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   329         16  FILLER                        PIC X(10).
   330         16  AM-VG-KEY3.
   331             20  AM-VG3-ACCOUNT            PIC X(10).
   332             20  AM-VG3-EXP-DT             PIC XX.
   333         16  FILLER                        PIC X(4).
   334     12  AM-MAINT-INFORMATION.
   335         16  AM-LAST-MAINT-DT              PIC XX.
   336         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   337         16  AM-LAST-MAINT-USER            PIC X(4).
   338         16  FILLER                        PIC XX.
   339
   340     12  AM-EFFECTIVE-DT                   PIC XX.
   341     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   342
   343     12  AM-PREV-DATES  COMP-3.
   344         16  AM-PREV-EXP-DT                PIC 9(11).
   345         16  AM-PREV-EFF-DT                PIC 9(11).
   346
   347     12  AM-REPORT-CODE-1                  PIC X(10).
   348     12  AM-REPORT-CODE-2                  PIC X(10).
   349
   350     12  AM-CITY-CODE                      PIC X(4).
   351     12  AM-COUNTY-PARISH                  PIC X(6).
   352
   353     12  AM-NAME                           PIC X(30).
   354     12  AM-PERSON                         PIC X(30).
   355     12  AM-ADDRS                          PIC X(30).
   356     12  AM-CITY.
   357         16  AM-ADDR-CITY                  PIC X(28).
   358         16  AM-ADDR-STATE                 PIC XX.
   359     12  AM-ZIP.
   360         16  AM-ZIP-PRIME.
   361             20  AM-ZIP-PRI-1ST            PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* SOCK00.cbl
   362                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   363             20  FILLER                    PIC X(4).
   364         16  AM-ZIP-PLUS4                  PIC X(4).
   365     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   366         16  AM-CAN-POSTAL-1               PIC XXX.
   367         16  AM-CAN-POSTAL-2               PIC XXX.
   368         16  FILLER                        PIC XXX.
   369     12  AM-TEL-NO.
   370         16  AM-AREA-CODE                  PIC 999.
   371         16  AM-TEL-PRE                    PIC 999.
   372         16  AM-TEL-NBR                    PIC 9(4).
   373     12  AM-TEL-LOC                        PIC X.
   374         88  AM-TEL-AT-HOME                   VALUE 'H'.
   375         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   376
   377     12  AM-COMM-STRUCTURE.
   378         16  AM-DEFN-1.
   379             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   380                 24  AM-AGT.
   381                     28  AM-AGT-PREFIX     PIC X(4).
   382                     28  AM-AGT-PRIME      PIC X(6).
   383                 24  AM-COM-TYP            PIC X.
   384                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   385                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   386                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   387                 24  AM-RECALC-LV-INDIC    PIC X.
   388                 24  AM-RETRO-LV-INDIC     PIC X.
   389                 24  AM-GL-CODES           PIC X.
   390                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   391                 24  FILLER                PIC X(01).
   392         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   393             20  AM-COM-TBLS        OCCURS 10 TIMES.
   394                 24  FILLER                PIC X(11).
   395                 24  AM-L-COMA             PIC XXX.
   396                 24  AM-J-COMA             PIC XXX.
   397                 24  AM-A-COMA             PIC XXX.
   398                 24  FILLER                PIC X(6).
   399
   400     12  AM-COMM-CHANGE-STATUS             PIC X.
   401         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   402
   403     12  AM-CSR-CODE                       PIC X(4).
   404
   405     12  AM-BILLING-STATUS                 PIC X.
   406         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   407         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   408     12  AM-AUTO-REFUND-SW                 PIC X.
   409         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   410         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   411     12  AM-GPCD                           PIC 99.
   412     12  AM-IG                             PIC X.
   413         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   414         88  AM-HAS-GROUP                     VALUE '2'.
   415     12  AM-STATUS                         PIC X.
   416         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   417         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   418         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   419         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* SOCK00.cbl
   420         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   421         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   422     12  AM-REMIT-TO                       PIC 99.
   423     12  AM-ID-NO                          PIC X(11).
   424
   425     12  AM-CAL-TABLE                      PIC XX.
   426     12  AM-LF-DEVIATION                   PIC XXX.
   427     12  AM-AH-DEVIATION                   PIC XXX.
   428     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   429     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   430     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   431     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   432     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   433     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   434
   435     12  AM-USER-FIELDS.
   436         16  AM-FLD-1                      PIC XX.
   437         16  AM-FLD-2                      PIC XX.
   438         16  AM-FLD-3                      PIC XX.
   439         16  AM-FLD-4                      PIC XX.
   440         16  AM-FLD-5                      PIC XX.
   441
   442     12  AM-1ST-PROD-DATE.
   443         16  AM-1ST-PROD-YR                PIC XX.
   444         16  AM-1ST-PROD-MO                PIC XX.
   445         16  AM-1ST-PROD-DA                PIC XX.
   446     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   447     12  AM-CERTS-PURGED-DATE.
   448         16  AM-PUR-YR                     PIC XX.
   449         16  AM-PUR-MO                     PIC XX.
   450         16  AM-PUR-DA                     PIC XX.
   451     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   452     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   453     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   454     12  AM-INACTIVE-DATE.
   455         16  AM-INA-MO                     PIC 99.
   456         16  AM-INA-DA                     PIC 99.
   457         16  AM-INA-YR                     PIC 99.
   458     12  AM-AR-HI-CERT-DATE                PIC XX.
   459
   460     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   461     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   462
   463     12  AM-OB-PAYMENT-MODE                PIC X.
   464         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   465         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   466         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   467         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   468
   469     12  AM-AH-ONLY-INDICATOR              PIC X.
   470         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   471         88  AM-NO-AH-ONLY                    VALUE 'N'.
   472
   473     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   474
   475     12  AM-OVER-SHORT.
   476         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   477         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* SOCK00.cbl
   478
   479     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   480     12  AM-DCC-CLP-STATE                  PIC XX.
   481
   482     12  AM-RECALC-COMM                    PIC X.
   483     12  AM-RECALC-REIN                    PIC X.
   484
   485     12  AM-REI-TABLE                      PIC XXX.
   486     12  AM-REI-ET-LF                      PIC X.
   487     12  AM-REI-ET-AH                      PIC X.
   488     12  AM-REI-PE-LF                      PIC X.
   489     12  AM-REI-PE-AH                      PIC X.
   490     12  AM-REI-PRT-ST                     PIC X.
   491     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   492     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   493     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   494     12  AM-REI-GROUP-A                    PIC X(6).
   495     12  AM-REI-MORT                       PIC X(4).
   496     12  AM-REI-PRT-OW                     PIC X.
   497     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   498     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   499     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   500     12  AM-REI-GROUP-B                    PIC X(6).
   501
   502     12  AM-TRUST-TYPE                     PIC X(2).
   503
   504     12  AM-EMPLOYER-STMT-USED             PIC X.
   505     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   506
   507     12  AM-STD-AH-TYPE                    PIC XX.
   508     12  AM-EARN-METHODS.
   509         16  AM-EARN-METHOD-R              PIC X.
   510             88 AM-REF-RL-R78                 VALUE 'R'.
   511             88 AM-REF-RL-PR                  VALUE 'P'.
   512             88 AM-REF-RL-MEAN                VALUE 'M'.
   513             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   514         16  AM-EARN-METHOD-L              PIC X.
   515             88 AM-REF-LL-R78                 VALUE 'R'.
   516             88 AM-REF-LL-PR                  VALUE 'P'.
   517             88 AM-REF-LL-MEAN                VALUE 'M'.
   518             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   519         16  AM-EARN-METHOD-A              PIC X.
   520             88 AM-REF-AH-R78                 VALUE 'R'.
   521             88 AM-REF-AH-PR                  VALUE 'P'.
   522             88 AM-REF-AH-MEAN                VALUE 'M'.
   523             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   524             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   525             88 AM-REF-AH-NET                 VALUE 'N'.
   526
   527     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   528     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   529     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   530
   531     12  AM-RET-Y-N                        PIC X.
   532     12  AM-RET-P-E                        PIC X.
   533     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   534     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   535     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* SOCK00.cbl
   536     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   537         16  AM-POOL-PRIME                 PIC XXX.
   538         16  AM-POOL-SUB                   PIC XXX.
   539     12  AM-RETRO-EARNINGS.
   540         16  AM-RET-EARN-R                 PIC X.
   541         16  AM-RET-EARN-L                 PIC X.
   542         16  AM-RET-EARN-A                 PIC X.
   543     12  AM-RET-ST-TAX-USE                 PIC X.
   544         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   545         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   546     12  AM-RETRO-BEG-EARNINGS.
   547         16  AM-RET-BEG-EARN-R             PIC X.
   548         16  AM-RET-BEG-EARN-L             PIC X.
   549         16  AM-RET-BEG-EARN-A             PIC X.
   550     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   551     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   552
   553     12  AM-USER-SELECT-OPTIONS.
   554         16  AM-USER-SELECT-1              PIC X(10).
   555         16  AM-USER-SELECT-2              PIC X(10).
   556         16  AM-USER-SELECT-3              PIC X(10).
   557         16  AM-USER-SELECT-4              PIC X(10).
   558         16  AM-USER-SELECT-5              PIC X(10).
   559
   560     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   561
   562     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   563
   564     12  AM-RPT045A-SWITCH                 PIC X.
   565         88  RPT045A-OFF                   VALUE 'N'.
   566
   567     12  AM-INSURANCE-LIMITS.
   568         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   569         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   570
   571     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   572         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   573
   574     12  AM-DISMBR-COVERAGE-SW             PIC X.
   575         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   576         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   577
   578     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   579
   580     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   581     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   582     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   583     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   584     12  AM-DCC-UEF-STATE                  PIC XX.
   585     12  FILLER                            PIC XXX.
   586     12  AM-REPORT-CODE-3                  PIC X(10).
   587*    12  FILLER                            PIC X(22).
   588
   589     12  AM-RESERVE-DATE.
   590         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   591         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   592         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   593
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* SOCK00.cbl
   594     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   595     12  AM-NOTIFICATION-TYPES.
   596         16  AM-NOTIF-OF-LETTERS           PIC X.
   597         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   598         16  AM-NOTIF-OF-REPORTS           PIC X.
   599         16  AM-NOTIF-OF-STATUS            PIC X.
   600
   601     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   602         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   603         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   604         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   605         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   606
   607     12  AM-BENEFIT-CONTROLS.
   608         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   609             20  AM-BENEFIT-CODE           PIC XX.
   610             20  AM-BENEFIT-TYPE           PIC X.
   611             20  AM-BENEFIT-REVISION       PIC XXX.
   612             20  AM-BENEFIT-REM-TERM       PIC X.
   613             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   614             20  FILLER                    PIC XX.
   615         16  FILLER                        PIC X(80).
   616
   617     12  AM-TRANSFER-DATA.
   618         16  AM-TRANSFERRED-FROM.
   619             20  AM-TRNFROM-CARRIER        PIC X.
   620             20  AM-TRNFROM-GROUPING.
   621                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   622                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   623             20  AM-TRNFROM-STATE          PIC XX.
   624             20  AM-TRNFROM-ACCOUNT.
   625                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   626                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   627             20  AM-TRNFROM-DTE            PIC XX.
   628         16  AM-TRANSFERRED-TO.
   629             20  AM-TRNTO-CARRIER          PIC X.
   630             20  AM-TRNTO-GROUPING.
   631                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   632                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   633             20  AM-TRNTO-STATE            PIC XX.
   634             20  AM-TRNTO-ACCOUNT.
   635                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   636                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   637             20  AM-TRNTO-DTE              PIC XX.
   638         16  FILLER                        PIC X(10).
   639
   640     12  AM-SAVED-REMIT-TO                 PIC 99.
   641
   642     12  AM-COMM-STRUCTURE-SAVED.
   643         16  AM-DEFN-1-SAVED.
   644             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   645                 24  AM-AGT-SV             PIC X(10).
   646                 24  AM-COM-TYP-SV         PIC X.
   647                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   648                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   649                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   650                 24  AM-RECALC-LV-INDIC-SV PIC X.
   651                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* SOCK00.cbl
   652                 24  AM-GL-CODES-SV        PIC X.
   653                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   654                 24  FILLER                PIC X.
   655         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   656             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   657                 24  FILLER                PIC X(11).
   658                 24  AM-L-COMA-SV          PIC XXX.
   659                 24  AM-J-COMA-SV          PIC XXX.
   660                 24  AM-A-COMA-SV          PIC XXX.
   661                 24  FILLER                PIC X(6).
   662
   663     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   664         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   665            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   666            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   667            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   668
   669     12  AM-ORIG-DEALER-NO                 PIC X(10).
   670     12  FILLER                            PIC X(120).
   671
   672     12  AM-ACCOUNT-EXECUTIVE-DATA.
   673         16  AM-CONTROL-NAME               PIC X(30).
   674         16  AM-EXECUTIVE-ONE.
   675             20  AM-EXEC1-NAME             PIC X(15).
   676             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   677                                                          COMP-3.
   678             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   679                                                          COMP-3.
   680         16  AM-EXECUTIVE-TWO.
   681             20  AM-EXEC2-NAME             PIC X(15).
   682             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   683                                                          COMP-3.
   684             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   685                                                          COMP-3.
   686
   687     12  AM-RETRO-ADDITIONAL-DATA.
   688         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   689         16  AM-RETRO-PREM-P-E             PIC X.
   690         16  AM-RETRO-CLMS-P-I             PIC X.
   691         16  AM-RETRO-RET-BRACKET-LF.
   692             20  AM-RETRO-RET-METHOD-LF    PIC X.
   693                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   694                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   695             20  AM-RETRO-RET-BASIS-LF     PIC X.
   696                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   697                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   698             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   699                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   700                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   701         16  AM-RETRO-RET-BRACKET-AH.
   702             20  AM-RETRO-RET-METHOD-AH    PIC X.
   703                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   704                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   705                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   706             20  AM-RETRO-RET-BASIS-AH     PIC X.
   707                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   708                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   709             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* SOCK00.cbl
   710                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   711                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   712
   713     12  AM-COMMENTS.
   714         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   715
   716     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   717         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   718         16  AM-FLI-BILLING-CODE           PIC X.
   719         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   720         16  AM-FLI-UNITED-IDENT           PIC X.
   721         16  AM-FLI-INTEREST-LOST-DATA.
   722             20  AM-FLI-BANK-NO            PIC X(5).
   723             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   724             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   725             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   726         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   727             20  AM-FLI-AGT                PIC X(9).
   728             20  AM-FLI-AGT-COMM-ACC       PIC X.
   729             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   730         16  FILLER                        PIC X(102).
   731
   732     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   733         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   734             20  AM-BENEFIT-DMD-CODE         PIC XX.
   735             20  AM-BENEFIT-DMD-TYPE         PIC X.
   736             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   737             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   738             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   739         16  FILLER                          PIC X(10).
   740******************************************************************
   741*                                 COPY ERCCOMP.
   742******************************************************************
   743*                                                                *
   744*                                                                *
   745*                            ERCCOMP                             *
   746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   747*                            VMOD=2.019                          *
   748*                                                                *
   749*   ONLINE CREDIT SYSTEM                                         *
   750*                                                                *
   751*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   752*                                                                *
   753*   FILE TYPE = VSAM,KSDS                                        *
   754*   RECORD SIZE = 700   RECFORM = FIXED                          *
   755*                                                                *
   756*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   757*       ALTERNATE PATH = NONE                                    *
   758*                                                                *
   759*   LOG = NO                                                     *
   760*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   761*                                                                *
   762******************************************************************
   763*                   C H A N G E   L O G
   764*
   765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   766*-----------------------------------------------------------------
   767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* SOCK00.cbl
   768* EFFECTIVE    NUMBER
   769*-----------------------------------------------------------------
   770* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   771* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   772* 092205    2005050300006  PEMA  ADD LEASE FEE
   773* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   774* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   775* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   776* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   777* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   778* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   779******************************************************************
   780
   781 01  COMPENSATION-MASTER.
   782     12  CO-RECORD-ID                          PIC XX.
   783         88  VALID-CO-ID                          VALUE 'CO'.
   784
   785     12  CO-CONTROL-PRIMARY.
   786         16  CO-COMPANY-CD                     PIC X.
   787         16  CO-CONTROL.
   788             20  CO-CTL-1.
   789                 24  CO-CARR-GROUP.
   790                     28  CO-CARRIER            PIC X.
   791                     28  CO-GROUPING.
   792                         32  CO-GROUP-PREFIX   PIC XXX.
   793                         32  CO-GROUP-PRIME    PIC XXX.
   794                 24  CO-RESP-NO.
   795                     28  CO-RESP-PREFIX        PIC X(4).
   796                     28  CO-RESP-PRIME         PIC X(6).
   797             20  CO-CTL-2.
   798                 24  CO-ACCOUNT.
   799                     28  CO-ACCT-PREFIX        PIC X(4).
   800                     28  CO-ACCT-PRIME         PIC X(6).
   801         16  CO-TYPE                           PIC X.
   802             88  CO-COMPANY-TYPE                  VALUE 'C'.
   803             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   804             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   805
   806     12  CO-MAINT-INFORMATION.
   807         16  CO-LAST-MAINT-DT                  PIC XX.
   808         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   809         16  CO-LAST-MAINT-USER                PIC X(4).
   810     12  FILLER                                PIC XX.
   811     12  CO-STMT-TYPE                          PIC XXX.
   812     12  CO-COMP-TYPE                          PIC X.
   813         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   814     12  CO-STMT-OWNER                         PIC X(4).
   815     12  CO-BALANCE-CONTROL                    PIC X.
   816         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   817         88  CO-NO-BALANCE                        VALUE 'N'.
   818
   819     12  CO-INTERNAL-CONTROL-1                 PIC X.
   820         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   821         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   822         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   823
   824     12  CO-INTERNAL-CONTROL-2                 PIC X.
   825         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* SOCK00.cbl
   826         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   827
   828     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   829     12  CO-GA-DIRECT-DEP                      PIC X.
   830     12  CO-FUTURE-SPACE                       PIC X.
   831         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   832
   833     12  CO-ACCT-NAME                          PIC X(30).
   834     12  CO-MAIL-NAME                          PIC X(30).
   835     12  CO-ADDR-1                             PIC X(30).
   836     12  CO-ADDR-2                             PIC X(30).
   837     12  CO-ADDR-3.
   838         16  CO-ADDR-CITY                      PIC X(27).
   839         16  CO-ADDR-STATE                     PIC XX.
   840     12  CO-CSO-1099                           PIC X.
   841     12  CO-ZIP.
   842         16  CO-ZIP-PRIME.
   843             20  CO-ZIP-PRI-1ST                PIC X.
   844                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   845             20  FILLER                        PIC X(4).
   846         16  CO-ZIP-PLUS4                      PIC X(4).
   847     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   848         16  CO-CAN-POSTAL-1                   PIC XXX.
   849         16  CO-CAN-POSTAL-2                   PIC XXX.
   850         16  FILLER                            PIC XXX.
   851     12  CO-SOC-SEC                            PIC X(13).
   852     12  CO-TELEPHONE.
   853         16  CO-AREA-CODE                      PIC XXX.
   854         16  CO-PREFIX                         PIC XXX.
   855         16  CO-PHONE                          PIC X(4).
   856
   857     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   858
   859     12  CO-AR-BAL-LEVEL                       PIC X.
   860         88  CO-AR-REF-LVL                        VALUE '1'.
   861         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   862         88  CO-AR-BILL-LVL                       VALUE '2'.
   863         88  CO-AR-AGT-LVL                        VALUE '3'.
   864         88  CO-AR-FR-LVL                         VALUE '4'.
   865
   866     12  CO-AR-NORMAL-PRINT                    PIC X.
   867         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   868         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   869
   870     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   871
   872     12  CO-AR-REPORTING                       PIC X.
   873         88  CO-AR-NET-REPORT                     VALUE 'N'.
   874         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   875
   876     12  CO-AR-PULL-CHECK                      PIC X.
   877         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   878         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   879
   880     12  CO-AR-BALANCE-PRINT                   PIC X.
   881         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   882
   883     12  CO-AR-LAST-RUN-CODE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* SOCK00.cbl
   884         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   885         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   886         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   887
   888     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   889
   890     12  CO-USER-CODE                          PIC X.
   891     12  CO-REPORT-GROUP-ID                    PIC X(12).
   892
   893******************************************************************
   894*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   895*    THE LAST MONTH END RUN.
   896******************************************************************
   897
   898     12  CO-LAST-ACTIVITY-DATE.
   899         16  CO-ACT-YEAR                       PIC 99.
   900         16  CO-ACT-MONTH                      PIC 99.
   901         16  CO-ACT-DAY                        PIC 99.
   902
   903     12  CO-LAST-STMT-DT.
   904         16  CO-LAST-STMT-YEAR                 PIC 99.
   905         16  CO-LAST-STMT-MONTH                PIC 99.
   906         16  CO-LAST-STMT-DAY                  PIC 99.
   907
   908     12  CO-MO-END-TOTALS.
   909         16  CO-MONTHLY-TOTALS.
   910             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   911             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   912             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   913             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   914             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   915
   916         16  CO-AGING-TOTALS.
   917             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   918             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   919             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   920             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   921
   922         16  CO-YTD-TOTALS.
   923             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   924             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   925
   926         16  CO-OVER-UNDER-TOTALS.
   927             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   928             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   929
   930     12  CO-MISCELLANEOUS-TOTALS.
   931         16  CO-FICA-TOTALS.
   932             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   933             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   934
   935         16  CO-CLAIM-TOTALS.
   936             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   937             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   938
   939******************************************************************
   940*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   941*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* SOCK00.cbl
   942******************************************************************
   943
   944     12  CO-CURRENT-TOTALS.
   945         16  CO-CURRENT-LAST-STMT-DT.
   946             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   947             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   948             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   949
   950         16  CO-CURRENT-MONTHLY-TOTALS.
   951             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   952             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   953             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   954             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   955             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   956
   957         16  CO-CURRENT-AGING-TOTALS.
   958             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   959             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   960             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   961             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   962
   963         16  CO-CURRENT-YTD-TOTALS.
   964             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   965             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   966
   967     12  CO-PAID-COMM-TOTALS.
   968         16  CO-YTD-PAID-COMMS.
   969             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   970             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   971
   972     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   973         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   974         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   975
   976     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   977         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   978         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   979         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   980         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   981         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   982         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   983         88  CO-FINAL-LETTER                  VALUE 'F'.
   984         88  CO-RECONCILING                   VALUE 'R'.
   985         88  CO-PHONE-CALL                    VALUE 'P'.
   986         88  CO-LEGAL                         VALUE 'L'.
   987         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   988         88  CO-WRITE-OFF                     VALUE 'W'.
   989         88  CO-NO-ACTION                     VALUE 'N' ' '.
   990
   991     12  CO-CSR-CODE                       PIC X(4).
   992
   993     12  CO-GA-STATUS-INFO.
   994         16  CO-GA-EFFECTIVE-DT            PIC XX.
   995         16  CO-GA-TERMINATION-DT          PIC XX.
   996         16  CO-GA-STATUS-CODE             PIC X.
   997             88  CO-GA-ACTIVE                 VALUE 'A'.
   998             88  CO-GA-INACTIVE               VALUE 'I'.
   999             88  CO-GA-PENDING                VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* SOCK00.cbl
  1000         16  CO-GA-COMMENTS.
  1001             20  CO-GA-COMMENT-1           PIC X(40).
  1002             20  CO-GA-COMMENT-2           PIC X(40).
  1003             20  CO-GA-COMMENT-3           PIC X(40).
  1004             20  CO-GA-COMMENT-4           PIC X(40).
  1005
  1006     12  CO-RPTCD2                         PIC X(10).
  1007     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1008         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1009         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1010
  1011     12  CO-TYPE-AGENT                     PIC X(01).
  1012         88  CO-CORPORATION                   VALUE 'C'.
  1013         88  CO-PARTNERSHIP                   VALUE 'P'.
  1014         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1015         88  CO-TRUST                         VALUE 'T'.
  1016         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1017
  1018     12  CO-FAXNO.
  1019         16  CO-FAX-AREA-CODE                  PIC XXX.
  1020         16  CO-FAX-PREFIX                     PIC XXX.
  1021         16  CO-FAX-PHONE                      PIC X(4).
  1022
  1023     12  CO-BANK-INFORMATION.
  1024         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1025         16  CO-BANK-TRANSIT-NON REDEFINES
  1026             CO-BANK-TRANSIT-NO                PIC 9(8).
  1027
  1028         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1029     12  CO-MISC-DEDUCT-INFO REDEFINES
  1030                  CO-BANK-INFORMATION.
  1031         16  CO-MD-GL-ACCT                     PIC X(10).
  1032         16  CO-MD-DIV                         PIC XX.
  1033         16  CO-MD-CENTER                      PIC X(4).
  1034         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1035         16  CO-CREATE-AP-CHECK                PIC X.
  1036         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1037         16  FILLER                            PIC XXX.
  1038     12  CO-ACH-STATUS                         PIC X.
  1039         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1040         88  CO-ACH-PENDING                        VALUE 'P'.
  1041
  1042     12  CO-BILL-SW                            PIC X.
  1043     12  CO-CONTROL-NAME                       PIC X(30).
  1044     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1045     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1046     12  CO-CLP-STATE                          PIC XX.
  1047     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1048     12  CO-SPP-REFUND-EDIT                    PIC X.
  1049
  1050******************************************************************
  1051*                                 COPY ELCCNTL.
  1052******************************************************************
  1053*                                                                *
  1054*                                                                *
  1055*                            ELCCNTL.                            *
  1056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1057*                            VMOD=2.059                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* SOCK00.cbl
  1058*                                                                *
  1059*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1060*                                                                *
  1061*   FILE TYPE = VSAM,KSDS                                        *
  1062*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1063*                                                                *
  1064*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1065*       ALTERNATE INDEX = NONE                                   *
  1066*                                                                *
  1067*   LOG = YES                                                    *
  1068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1069******************************************************************
  1070*                   C H A N G E   L O G
  1071*
  1072* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1073*-----------------------------------------------------------------
  1074*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1075* EFFECTIVE    NUMBER
  1076*-----------------------------------------------------------------
  1077* 082503                   PEMA  ADD BENEFIT GROUP
  1078* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1079* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1080* 092705    2005050300006  PEMA  ADD SPP LEASES
  1081* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1082* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1083* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1084* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1085* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1086* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1087* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1088* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1089* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1090* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1091******************************************************************
  1092*
  1093 01  CONTROL-FILE.
  1094     12  CF-RECORD-ID                       PIC XX.
  1095         88  VALID-CF-ID                        VALUE 'CF'.
  1096
  1097     12  CF-CONTROL-PRIMARY.
  1098         16  CF-COMPANY-ID                  PIC XXX.
  1099         16  CF-RECORD-TYPE                 PIC X.
  1100             88  CF-COMPANY-MASTER              VALUE '1'.
  1101             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1102             88  CF-STATE-MASTER                VALUE '3'.
  1103             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1104             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1105             88  CF-CARRIER-MASTER              VALUE '6'.
  1106             88  CF-MORTALITY-MASTER            VALUE '7'.
  1107             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1108             88  CF-TERMINAL-MASTER             VALUE '9'.
  1109             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1110             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1111             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1112             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1113             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1114             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1115             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* SOCK00.cbl
  1116             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1117             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1118         16  CF-ACCESS-CD-GENL              PIC X(4).
  1119         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1120             20  CF-PROCESSOR               PIC X(4).
  1121         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1122             20  CF-STATE-CODE              PIC XX.
  1123             20  FILLER                     PIC XX.
  1124         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1125             20  FILLER                     PIC XX.
  1126             20  CF-HI-BEN-IN-REC           PIC XX.
  1127         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1128             20  FILLER                     PIC XXX.
  1129             20  CF-CARRIER-CNTL            PIC X.
  1130         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1131             20  FILLER                     PIC XX.
  1132             20  CF-HI-TYPE-IN-REC          PIC 99.
  1133         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1134             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1135                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1136             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1137             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1138         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1139             20  FILLER                     PIC X.
  1140             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1141         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1142             20  FILLER                     PIC XX.
  1143             20  CF-MORTGAGE-PLAN           PIC XX.
  1144         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1145
  1146     12  CF-LAST-MAINT-DT                   PIC XX.
  1147     12  CF-LAST-MAINT-BY                   PIC X(4).
  1148     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1149
  1150     12  CF-RECORD-BODY                     PIC X(728).
  1151
  1152
  1153****************************************************************
  1154*             COMPANY MASTER RECORD                            *
  1155****************************************************************
  1156
  1157     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1158         16  CF-COMPANY-ADDRESS.
  1159             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1160             20  CF-CL-IN-CARE-OF           PIC X(30).
  1161             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1162             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1163             20  CF-CL-CITY-STATE           PIC X(30).
  1164             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1165             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1166         16  CF-COMPANY-CD                  PIC X.
  1167         16  CF-COMPANY-PASSWORD            PIC X(8).
  1168         16  CF-SECURITY-OPTION             PIC X.
  1169             88  ALL-SECURITY                   VALUE '1'.
  1170             88  COMPANY-VERIFY                 VALUE '2'.
  1171             88  PROCESSOR-VERIFY               VALUE '3'.
  1172             88  NO-SECURITY                    VALUE '4'.
  1173             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* SOCK00.cbl
  1174         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1175             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1176         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1177             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1178         16  CF-INFORCE-LOCATION            PIC X.
  1179             88  CERTS-ARE-ONLINE               VALUE '1'.
  1180             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1181             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1182         16  CF-LOWER-CASE-LETTERS          PIC X.
  1183         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1184             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1185             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1186             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1187             88  CF-ACCNT-CNTL                  VALUE '3'.
  1188             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1189
  1190         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1191         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1192
  1193         16  CF-LGX-CREDIT-USER             PIC X.
  1194             88  CO-IS-NOT-USER                 VALUE 'N'.
  1195             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1196
  1197         16 CF-CREDIT-CALC-CODES.
  1198             20  CF-CR-REM-TERM-CALC PIC X.
  1199               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1200               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1201               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1202               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1203               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1204               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1205               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1206             20  CF-CR-R78-METHOD           PIC X.
  1207               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1208               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1209
  1210         16  CF-CLAIM-CONTROL-COUNTS.
  1211             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1212                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1213
  1214             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1215                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1216
  1217             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1218                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1219
  1220             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1221                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1222
  1223         16  CF-CURRENT-MONTH-END           PIC XX.
  1224
  1225         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1226             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1227             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1228             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1229             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1230                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1231                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* SOCK00.cbl
  1232             20  CF-CO-PREM-REJECT-SW       PIC X.
  1233                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1234                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1235             20  CF-CO-REF-REJECT-SW        PIC X.
  1236                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1237                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1238
  1239         16  CF-CO-REPORTING-DT             PIC XX.
  1240         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1241         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1242           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1243           88  CF-CO-MONTH-END                  VALUE '1'.
  1244
  1245         16  CF-LGX-CLAIM-USER              PIC X.
  1246             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1247             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1248
  1249         16  CF-CREDIT-EDIT-CONTROLS.
  1250             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1251             20  CF-MIN-AGE                 PIC 99.
  1252             20  CF-DEFAULT-AGE             PIC 99.
  1253             20  CF-MIN-TERM                PIC S999      COMP-3.
  1254             20  CF-MAX-TERM                PIC S999      COMP-3.
  1255             20  CF-DEFAULT-SEX             PIC X.
  1256             20  CF-JOINT-AGE-INPUT         PIC X.
  1257                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1258             20  CF-BIRTH-DATE-INPUT        PIC X.
  1259                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1260             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1261                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1262                 88  CF-ZERO-CARRIER            VALUE '1'.
  1263                 88  CF-ZERO-GROUPING           VALUE '2'.
  1264                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1265             20  CF-EDIT-SW                 PIC X.
  1266                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1267             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1268             20  CF-CR-PR-METHOD            PIC X.
  1269               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1270               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1271             20  FILLER                     PIC X.
  1272
  1273         16  CF-CREDIT-MISC-CONTROLS.
  1274             20  CF-REIN-TABLE-SW           PIC X.
  1275                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1276             20  CF-COMP-TABLE-SW           PIC X.
  1277                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1278             20  CF-EXPERIENCE-RETENTION-AGE
  1279                                            PIC S9        COMP-3.
  1280             20  CF-CONVERSION-DT           PIC XX.
  1281             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1282             20  CF-RUN-FREQUENCY-SW        PIC X.
  1283                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1284                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1285
  1286             20  CF-CR-CHECK-NO-CONTROL.
  1287                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1288                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1289                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* SOCK00.cbl
  1290                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1291                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1292                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1293
  1294                 24  CF-CR-CHECK-COUNT       REDEFINES
  1295                     CF-CR-CHECK-COUNTER      PIC X(4).
  1296
  1297                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1298                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1299
  1300                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1301                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1302                 24  CF-MAIL-PROCESSING       PIC X.
  1303                     88  MAIL-PROCESSING          VALUE 'Y'.
  1304
  1305         16  CF-MISC-SYSTEM-CONTROL.
  1306             20  CF-SYSTEM-C                 PIC X.
  1307                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1308             20  CF-SYSTEM-D                 PIC X.
  1309                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1310             20  CF-SOC-SEC-NO-SW            PIC X.
  1311                 88  SOC-SEC-NO-USED             VALUE '1'.
  1312             20  CF-MEMBER-NO-SW             PIC X.
  1313                 88  MEMBER-NO-USED              VALUE '1'.
  1314             20  CF-TAX-ID-NUMBER            PIC X(11).
  1315             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1316             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1317                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1318                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1319                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1320                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1321             20  CF-SYSTEM-E                 PIC X.
  1322                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1323
  1324         16  CF-LGX-LIFE-USER               PIC X.
  1325             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1326             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1327
  1328         16  CF-CR-MONTH-END-DT             PIC XX.
  1329
  1330         16  CF-FILE-MAINT-DATES.
  1331             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1332                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1333             20  CF-LAST-BATCH       REDEFINES
  1334                 CF-LAST-BATCH-NO               PIC X(4).
  1335             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1336             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1337             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1338             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1339             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1340             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1341             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1342             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1343             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1344             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1345
  1346         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1347         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* SOCK00.cbl
  1348
  1349         16  CF-ALT-MORT-CODE               PIC X(4).
  1350         16  CF-MEMBER-CAPTION              PIC X(10).
  1351
  1352         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1353             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1354             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1355             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1356             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1357             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1358
  1359         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1360
  1361         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1362         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1363         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1364         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1365
  1366         16  CF-AH-OVERRIDE-L1              PIC X.
  1367         16  CF-AH-OVERRIDE-L2              PIC XX.
  1368         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1369         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1370
  1371         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1372         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1373
  1374         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1375         16  CF-AR-LAST-EL860-DT            PIC XX.
  1376         16  CF-MP-MONTH-END-DT             PIC XX.
  1377
  1378         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1379         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1380             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1381
  1382         16  CF-AR-MONTH-END-DT             PIC XX.
  1383
  1384         16  CF-CRDTCRD-USER                PIC X.
  1385             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1386             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1387
  1388         16  CF-CC-MONTH-END-DT             PIC XX.
  1389
  1390         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1391
  1392         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1393             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1394             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1395             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1396         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1397         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1398         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1399         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1400             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1401             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1402         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1403         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1404         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1405             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* SOCK00.cbl
  1406         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1407
  1408         16  CF-CL-ZIP-CODE.
  1409             20  CF-CL-ZIP-PRIME.
  1410                 24  CF-CL-ZIP-1ST          PIC X.
  1411                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1412                 24  FILLER                 PIC X(4).
  1413             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1414         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1415             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1416             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1417             20  FILLER                     PIC XXX.
  1418
  1419         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1420         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1421         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1422         16  CF-CO-OPTION-START-DATE        PIC XX.
  1423         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1424           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1425                                                      '3' '4'.
  1426           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1427           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1428           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1429           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1430           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1431           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1432
  1433         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1434
  1435         16  CF-PAYMENT-APPROVAL-LEVELS.
  1436             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1437             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1438             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1439             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1440             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1441             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1442
  1443         16  CF-END-USER-REPORTING-USER     PIC X.
  1444             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1445             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1446
  1447         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1448             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1449             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1450
  1451         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1452
  1453         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1454         16  FILLER                         PIC X.
  1455
  1456         16  CF-CREDIT-ARCHIVE-CNTL.
  1457             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1458             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1459             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1460
  1461         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1462
  1463         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* SOCK00.cbl
  1464             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1465             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1466
  1467         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1468             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1469             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1470
  1471         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1472
  1473         16  CF-CO-ACH-ID-CODE              PIC  X.
  1474             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1475             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1476             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1477         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1478         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1479         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1480         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1481         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1482         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1483         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1484         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1485         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1486                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1487         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1488                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1489
  1490         16  CF-CO-OVER-SHORT.
  1491             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1492             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1493
  1494*         16  FILLER                         PIC X(102).
  1495         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1496             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1497             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1498
  1499         16  CF-AH-APPROVAL-DAYS.
  1500             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1501             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1502             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1503             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1504
  1505         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1506
  1507         16  CF-APPROV-LEV-5.
  1508             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1509             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1510             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1511
  1512         16  FILLER                         PIC X(68).
  1513****************************************************************
  1514*             PROCESSOR/USER RECORD                            *
  1515****************************************************************
  1516
  1517     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1518         16  CF-PROCESSOR-NAME              PIC X(30).
  1519         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1520         16  CF-PROCESSOR-TITLE             PIC X(26).
  1521         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* SOCK00.cbl
  1522                 88  MESSAGE-YES                VALUE 'Y'.
  1523                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1524
  1525*****************************************************
  1526****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1527****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1528****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1529****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1530*****************************************************
  1531
  1532         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1533             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1534             20  CF-APPLICATION-FORCE       PIC X.
  1535             20  CF-INDIVIDUAL-APP.
  1536                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1537                     28  CF-BROWSE-APP      PIC X.
  1538                     28  CF-UPDATE-APP      PIC X.
  1539
  1540         16  CF-CURRENT-TERM-ON             PIC X(4).
  1541         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1542             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1543             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1544             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1545             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1546             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1547             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1548             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1549         16  CF-PROCESSOR-CARRIER           PIC X.
  1550             88  NO-CARRIER-SECURITY            VALUE ' '.
  1551         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1552             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1553         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1554             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1555         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1556             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1557
  1558         16  CF-PROC-SYS-ACCESS-SW.
  1559             20  CF-PROC-CREDIT-CLAIMS-SW.
  1560                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1561                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1562                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1563                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1564             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1565                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1566                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1567             20  CF-PROC-LIFE-GNRLDGR-SW.
  1568                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1569                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1570                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1571                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1572             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1573                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1574                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1575         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1576             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1577             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1578         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1579
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* SOCK00.cbl
  1580         16  CF-APPROVAL-LEVEL                  PIC X.
  1581             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1582             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1583             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1584             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1585             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1586
  1587         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1588
  1589         16  CF-LANGUAGE-TYPE                   PIC X.
  1590             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1591             88  CF-LANG-IS-FR                      VALUE 'F'.
  1592
  1593         16  CF-CSR-IND                         PIC X.
  1594         16  FILLER                             PIC X(239).
  1595
  1596****************************************************************
  1597*             PROCESSOR/REMINDERS RECORD                       *
  1598****************************************************************
  1599
  1600     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1601         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1602             20  CF-START-REMIND-DT         PIC XX.
  1603             20  CF-END-REMIND-DT           PIC XX.
  1604             20  CF-REMINDER-TEXT           PIC X(50).
  1605         16  FILLER                         PIC X(296).
  1606
  1607
  1608****************************************************************
  1609*             STATE MASTER RECORD                              *
  1610****************************************************************
  1611
  1612     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1613         16  CF-STATE-ABBREVIATION          PIC XX.
  1614         16  CF-STATE-NAME                  PIC X(25).
  1615         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1616         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1617             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1618             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1619             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1620             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1621                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1622                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1623             20  CF-ST-PREM-REJECT-SW       PIC X.
  1624                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1625                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1626             20  CF-ST-REF-REJECT-SW        PIC X.
  1627                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1628                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1629         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1630         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1631         16  CF-ST-REFUND-RULES.
  1632             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1633             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1634             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1635         16  CF-ST-FST-PMT-EXTENSION.
  1636             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1637             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* SOCK00.cbl
  1638                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1639                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1640                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1641                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1642         16  CF-ST-STATE-CALL.
  1643             20  CF-ST-CALL-UNEARNED        PIC X.
  1644             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1645             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1646         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1647             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1648             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1649         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1650         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1651         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1652         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1653         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1654         16  FILLER                         PIC X.
  1655         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1656             20  CF-ST-BENEFIT-CD           PIC XX.
  1657             20  CF-ST-BENEFIT-KIND         PIC X.
  1658                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1659                 88  CF-ST-AH-KIND              VALUE 'A'.
  1660             20  CF-ST-REM-TERM-CALC        PIC X.
  1661                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1662                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1663                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1664                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1665                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1666                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1667                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1668                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1669
  1670             20  CF-ST-REFUND-CALC          PIC X.
  1671                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1672                 88  ST-REFD-BY-R78             VALUE '1'.
  1673                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1674                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1675                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1676                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1677                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1678                 88  ST-REFD-UTAH               VALUE '7'.
  1679                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1680                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1681                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1682
  1683             20  CF-ST-EARNING-CALC         PIC X.
  1684                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1685                 88  ST-EARN-BY-R78             VALUE '1'.
  1686                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1687                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1688                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1689                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1690                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1691                 88  ST-EARN-MEAN               VALUE '8'.
  1692                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1693
  1694             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1695                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* SOCK00.cbl
  1696                 88  ST-OVRD-BY-R78             VALUE '1'.
  1697                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1698                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1699                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1700                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1701                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1702                 88  ST-OVRD-MEAN               VALUE '8'.
  1703                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1704             20  FILLER                     PIC X.
  1705
  1706         16  CF-ST-COMMISSION-CAPS.
  1707             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1708             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1709             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1710             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1711         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1712                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1713
  1714         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1715
  1716         16  CF-ST-STATUTORY-INTEREST.
  1717             20  CF-ST-STAT-DATE-FROM       PIC X.
  1718                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1719                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1720             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1721             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1722             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1723             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1724             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1725
  1726         16  CF-ST-OVER-SHORT.
  1727             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1728             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1729
  1730         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1731
  1732         16  CF-ST-RT-CALC                  PIC X.
  1733
  1734         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1735         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1736         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1737         16  CF-ST-RF-LR-CALC               PIC X.
  1738         16  CF-ST-RF-LL-CALC               PIC X.
  1739         16  CF-ST-RF-LN-CALC               PIC X.
  1740         16  CF-ST-RF-AH-CALC               PIC X.
  1741         16  CF-ST-RF-CP-CALC               PIC X.
  1742*        16  FILLER                         PIC X(206).
  1743*CIDMOD         16  FILLER                         PIC X(192).
  1744         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1745             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1746         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1747         16  CF-ST-VFY-2ND-BENE             PIC X.
  1748         16  CF-ST-CAUSAL-STATE             PIC X.
  1749         16  FILLER                         PIC X(185).
  1750
  1751****************************************************************
  1752*             BENEFIT MASTER RECORD                            *
  1753****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* SOCK00.cbl
  1754
  1755     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1756         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1757             20  CF-BENEFIT-CODE            PIC XX.
  1758             20  CF-BENEFIT-NUMERIC  REDEFINES
  1759                 CF-BENEFIT-CODE            PIC XX.
  1760             20  CF-BENEFIT-ALPHA           PIC XXX.
  1761             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1762             20  CF-BENEFIT-COMMENT         PIC X(10).
  1763
  1764             20  CF-LF-COVERAGE-TYPE        PIC X.
  1765                 88  CF-REDUCING                VALUE 'R'.
  1766                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1767
  1768             20  CF-SPECIAL-CALC-CD         PIC X.
  1769                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1770                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1771                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1772                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1773                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1774                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1775                 88  CF-FARM-PLAN               VALUE 'F'.
  1776                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1777                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1778                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1779                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1780                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1781                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1782                 88  CF-PRUDENTIAL              VALUE 'P'.
  1783                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1784                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1785                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1786                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1787                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1788                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1789
  1790             20  CF-JOINT-INDICATOR         PIC X.
  1791                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1792
  1793*            20  FILLER                     PIC X(12).
  1794             20  cf-maximum-benefits        pic s999 comp-3.
  1795             20  FILLER                     PIC X(09).
  1796             20  CF-BENEFIT-CATEGORY        PIC X.
  1797             20  CF-LOAN-TYPE               PIC X(8).
  1798
  1799             20  CF-CO-REM-TERM-CALC        PIC X.
  1800                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1801                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1802                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1803                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1804                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1805
  1806             20  CF-CO-EARNINGS-CALC        PIC X.
  1807                 88  CO-EARN-BY-R78             VALUE '1'.
  1808                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1809                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1810                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1811                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* SOCK00.cbl
  1812                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1813                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1814                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1815
  1816             20  CF-CO-REFUND-CALC          PIC X.
  1817                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1818                 88  CO-REFD-BY-R78             VALUE '1'.
  1819                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1820                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1821                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1822                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1823                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1824                 88  CO-REFD-MEAN               VALUE '8'.
  1825                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1826                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1827                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1828
  1829             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1830                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1831                 88  CO-OVRD-BY-R78             VALUE '1'.
  1832                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1833                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1834                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1835                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1836                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1837                 88  CO-OVRD-MEAN               VALUE '8'.
  1838                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1839
  1840             20  CF-CO-BEN-I-G-CD           PIC X.
  1841                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1842                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1843                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1844
  1845         16  FILLER                         PIC X(304).
  1846
  1847
  1848****************************************************************
  1849*             CARRIER MASTER RECORD                            *
  1850****************************************************************
  1851
  1852     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1853         16  CF-ADDRESS-DATA.
  1854             20  CF-MAIL-TO-NAME            PIC X(30).
  1855             20  CF-IN-CARE-OF              PIC X(30).
  1856             20  CF-ADDRESS-LINE-1          PIC X(30).
  1857             20  CF-ADDRESS-LINE-2          PIC X(30).
  1858             20  CF-CITY-STATE              PIC X(30).
  1859             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1860             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1861
  1862         16  CF-CLAIM-NO-CONTROL.
  1863             20  CF-CLAIM-NO-METHOD         PIC X.
  1864                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1865                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1866                 88  CLAIM-NO-SEQ               VALUE '3'.
  1867                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1868             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1869                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* SOCK00.cbl
  1870                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1871                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1872
  1873         16  CF-CHECK-NO-CONTROL.
  1874             20  CF-CHECK-NO-METHOD         PIC X.
  1875                 88  CHECK-NO-MANUAL            VALUE '1'.
  1876                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1877                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1878                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1879             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1880                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1881
  1882         16  CF-DOMICILE-STATE              PIC XX.
  1883
  1884         16  CF-EXPENSE-CONTROLS.
  1885             20  CF-EXPENSE-METHOD          PIC X.
  1886                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1887                 88  DOLLARS-PER-PMT            VALUE '2'.
  1888                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1889                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1890             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1891             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1892
  1893         16  CF-CORRESPONDENCE-CONTROL.
  1894             20  CF-LETTER-RESEND-OPT       PIC X.
  1895                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1896                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1897             20  FILLER                     PIC X(4).
  1898
  1899         16  CF-RESERVE-CONTROLS.
  1900             20  CF-MANUAL-SW               PIC X.
  1901                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1902             20  CF-FUTURE-SW               PIC X.
  1903                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1904             20  CF-PTC-SW                  PIC X.
  1905                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1906             20  CF-IBNR-SW                 PIC X.
  1907                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1908             20  CF-PTC-LF-SW               PIC X.
  1909                 88  CF-LF-PTC-USED             VALUE '1'.
  1910             20  CF-CDT-ACCESS-METHOD       PIC X.
  1911                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1912                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1913                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1914             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1915
  1916         16  CF-CLAIM-CALC-METHOD           PIC X.
  1917             88  360-PLUS-MONTHS                VALUE '1'.
  1918             88  365-PLUS-MONTHS                VALUE '2'.
  1919             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1920             88  360-DAILY                      VALUE '4'.
  1921             88  365-DAILY                      VALUE '5'.
  1922
  1923         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1924         16  FILLER                         PIC X(11).
  1925
  1926         16  CF-LIMIT-AMOUNTS.
  1927             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* SOCK00.cbl
  1928             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1929             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1930             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1931             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1932             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1933             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1934             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1935             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1936             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1937
  1938         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1939         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1940         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1941
  1942         16  CF-ZIP-CODE.
  1943             20  CF-ZIP-PRIME.
  1944                 24  CF-ZIP-1ST             PIC X.
  1945                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1946                 24  FILLER                 PIC X(4).
  1947             20  CF-ZIP-PLUS4               PIC X(4).
  1948         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1949             20  CF-CAN-POSTAL-1            PIC XXX.
  1950             20  CF-CAN-POSTAL-2            PIC XXX.
  1951             20  FILLER                     PIC XXX.
  1952
  1953         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1954         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1955         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1956
  1957         16  CF-RATING-SWITCH               PIC X.
  1958             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1959             88  CF-NO-RATING                   VALUE 'N'.
  1960
  1961         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1962
  1963         16  CF-CARRIER-OVER-SHORT.
  1964             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1965             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1966
  1967         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1968         16  CF-SECPAY-SWITCH               PIC X.
  1969             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1970             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1971         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1972         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1973         16  FILLER                         PIC X(444).
  1974*        16  FILLER                         PIC X(452).
  1975
  1976
  1977****************************************************************
  1978*             MORTALITY MASTER RECORD                          *
  1979****************************************************************
  1980
  1981     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1982         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1983                                INDEXED BY CF-MORT-NDX.
  1984             20  CF-MORT-TABLE              PIC X(5).
  1985             20  CF-MORT-TABLE-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* SOCK00.cbl
  1986                 88  CF-MORT-JOINT              VALUE 'J'.
  1987                 88  CF-MORT-SINGLE             VALUE 'S'.
  1988                 88  CF-MORT-COMBINED           VALUE 'C'.
  1989                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1990                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1991             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1992             20  CF-MORT-AGE-METHOD         PIC XX.
  1993                 88  CF-AGE-LAST                VALUE 'AL'.
  1994                 88  CF-AGE-NEAR                VALUE 'AN'.
  1995             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1996             20  CF-MORT-ADJUSTMENT-DIRECTION
  1997                                            PIC X.
  1998                 88  CF-MINUS                   VALUE '-'.
  1999                 88  CF-PLUS                    VALUE '+'.
  2000             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2001             20  CF-MORT-JOINT-CODE         PIC X.
  2002                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2003             20  CF-MORT-PC-Q               PIC X.
  2004                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2005             20  CF-MORT-TABLE-CODE         PIC X(4).
  2006             20  CF-MORT-COMMENTS           PIC X(15).
  2007             20  FILLER                     PIC X(14).
  2008
  2009         16  FILLER                         PIC X(251).
  2010
  2011
  2012****************************************************************
  2013*             BUSSINESS TYPE MASTER RECORD                     *
  2014****************************************************************
  2015
  2016     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2017* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2018* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2019* AND RECORD 05 IS TYPES 81-99
  2020         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2021             20  CF-BUSINESS-TITLE          PIC  X(19).
  2022             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2023                                            PIC S9V9(4) COMP-3.
  2024             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2025             20  FILLER                     PIC  X.
  2026         16  FILLER                         PIC  X(248).
  2027
  2028
  2029****************************************************************
  2030*             TERMINAL MASTER RECORD                           *
  2031****************************************************************
  2032
  2033     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2034
  2035         16  CF-COMPANY-TERMINALS.
  2036             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2037                                  PIC X(4).
  2038         16  FILLER               PIC X(248).
  2039
  2040
  2041****************************************************************
  2042*             LIFE EDIT MASTER RECORD                          *
  2043****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* SOCK00.cbl
  2044
  2045     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2046         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2047             20  CF-LIFE-CODE-IN            PIC XX.
  2048             20  CF-LIFE-CODE-OUT           PIC XX.
  2049         16  FILLER                         PIC X(248).
  2050
  2051
  2052****************************************************************
  2053*             AH EDIT MASTER RECORD                            *
  2054****************************************************************
  2055
  2056     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2057         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2058             20  CF-AH-CODE-IN              PIC XXX.
  2059             20  CF-AH-CODE-OUT             PIC XX.
  2060         16  FILLER                         PIC X(248).
  2061
  2062
  2063****************************************************************
  2064*             CREDIBILITY TABLES                               *
  2065****************************************************************
  2066
  2067     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2068         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2069                             INDEXED BY CF-CRDB-NDX.
  2070             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2071             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2072             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2073         16  FILLER                         PIC  X(332).
  2074
  2075
  2076****************************************************************
  2077*             REPORT CUSTOMIZATION RECORD                      *
  2078****************************************************************
  2079
  2080     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2081         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2082             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2083             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2084             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2085**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2086****       A T-TRANSFER.                                   ****
  2087             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2088
  2089         16  FILLER                         PIC XX.
  2090
  2091         16  CF-CARRIER-CNTL-OPT.
  2092             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2093                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2094                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2095             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2096                                            PIC X.
  2097         16  CF-GROUP-CNTL-OPT.
  2098             20  CF-GROUP-OPT-SEQ           PIC 9.
  2099                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2100                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2101             20  CF-GROUP-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* SOCK00.cbl
  2102                                            PIC X(6).
  2103         16  CF-STATE-CNTL-OPT.
  2104             20  CF-STATE-OPT-SEQ           PIC 9.
  2105                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2106                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2107             20  CF-STATE-SELECT OCCURS 3 TIMES
  2108                                            PIC XX.
  2109         16  CF-ACCOUNT-CNTL-OPT.
  2110             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2111                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2112                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2113             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2114                                            PIC X(10).
  2115         16  CF-BUS-TYP-CNTL-OPT.
  2116             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2117                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2118                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2119             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2120                                            PIC XX.
  2121         16  CF-LF-TYP-CNTL-OPT.
  2122             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2123                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2124                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2125             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2126                                            PIC XX.
  2127         16  CF-AH-TYP-CNTL-OPT.
  2128             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2129                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2130                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2131             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2132                                            PIC XX.
  2133         16  CF-REPTCD1-CNTL-OPT.
  2134             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2135                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2136                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2137             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2138                                            PIC X(10).
  2139         16  CF-REPTCD2-CNTL-OPT.
  2140             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2141                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2142                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2143             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2144                                            PIC X(10).
  2145         16  CF-USER1-CNTL-OPT.
  2146             20  CF-USER1-OPT-SEQ           PIC 9.
  2147                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2148                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2149             20  CF-USER1-SELECT OCCURS 3 TIMES
  2150                                            PIC X(10).
  2151         16  CF-USER2-CNTL-OPT.
  2152             20  CF-USER2-OPT-SEQ           PIC 9.
  2153                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2154                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2155             20  CF-USER2-SELECT OCCURS 3 TIMES
  2156                                            PIC X(10).
  2157         16  CF-USER3-CNTL-OPT.
  2158             20  CF-USER3-OPT-SEQ           PIC 9.
  2159                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* SOCK00.cbl
  2160                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2161             20  CF-USER3-SELECT OCCURS 3 TIMES
  2162                                            PIC X(10).
  2163         16  CF-USER4-CNTL-OPT.
  2164             20  CF-USER4-OPT-SEQ           PIC 9.
  2165                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2166                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2167             20  CF-USER4-SELECT OCCURS 3 TIMES
  2168                                            PIC X(10).
  2169         16  CF-USER5-CNTL-OPT.
  2170             20  CF-USER5-OPT-SEQ           PIC 9.
  2171                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2172                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2173             20  CF-USER5-SELECT OCCURS 3 TIMES
  2174                                            PIC X(10).
  2175         16  CF-REINS-CNTL-OPT.
  2176             20  CF-REINS-OPT-SEQ           PIC 9.
  2177                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2178                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2179             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2180                 24  CF-REINS-PRIME         PIC XXX.
  2181                 24  CF-REINS-SUB           PIC XXX.
  2182
  2183         16  CF-AGENT-CNTL-OPT.
  2184             20  CF-AGENT-OPT-SEQ           PIC 9.
  2185                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2186                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2187             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2188                                            PIC X(10).
  2189
  2190         16  FILLER                         PIC X(43).
  2191
  2192         16  CF-LOSS-RATIO-SELECT.
  2193             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2194             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2195         16  CF-ENTRY-DATE-SELECT.
  2196             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2197             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2198         16  CF-EFFECTIVE-DATE-SELECT.
  2199             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2200             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2201
  2202         16  CF-EXCEPTION-LIST-IND          PIC X.
  2203             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2204
  2205         16  FILLER                         PIC X(318).
  2206
  2207****************************************************************
  2208*                  EXCEPTION REPORTING RECORD                  *
  2209****************************************************************
  2210
  2211     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2212         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2213             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2214
  2215         16  CF-COMBINED-LIFE-AH-OPT.
  2216             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2217             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* SOCK00.cbl
  2218             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2219             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2220
  2221         16  CF-LIFE-OPT.
  2222             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2223             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2224             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2225             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2226             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2227             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2228             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2229             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2230             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2231             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2232
  2233         16  CF-AH-OPT.
  2234             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2235             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2236             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2237             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2238             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2239             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2240             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2241             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2242             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2243             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2244
  2245         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2246             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2247             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2248             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2249
  2250         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2251
  2252         16  FILLER                         PIC X(673).
  2253
  2254
  2255****************************************************************
  2256*             MORTGAGE SYSTEM PLAN RECORD                      *
  2257****************************************************************
  2258
  2259     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2260         16  CF-PLAN-TYPE                   PIC X.
  2261             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2262             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2263             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2264         16  CF-PLAN-ABBREV                 PIC XXX.
  2265         16  CF-PLAN-DESCRIPT               PIC X(10).
  2266         16  CF-PLAN-NOTES                  PIC X(20).
  2267         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2268         16  CF-PLAN-UNDERWRITING.
  2269             20  CF-PLAN-TERM-DATA.
  2270                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2271                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2272             20  CF-PLAN-AGE-DATA.
  2273                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2274                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2275                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* SOCK00.cbl
  2276             20  CF-PLAN-BENEFIT-DATA.
  2277                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2278                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2279                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2280                                            PIC S9(7)V99  COMP-3.
  2281         16  CF-PLAN-POLICY-FORMS.
  2282             20  CF-POLICY-FORM             PIC X(12).
  2283             20  CF-MASTER-APPLICATION      PIC X(12).
  2284             20  CF-MASTER-POLICY           PIC X(12).
  2285         16  CF-PLAN-RATING.
  2286             20  CF-RATE-CODE               PIC X(5).
  2287             20  CF-SEX-RATING              PIC X.
  2288                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2289                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2290             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2291             20  CF-SUB-STD-TYPE            PIC X.
  2292                 88  CF-PCT-OF-PREM            VALUE '1'.
  2293                 88  CF-PCT-OF-BENE            VALUE '2'.
  2294         16  CF-PLAN-PREM-TOLERANCES.
  2295             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2296             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2297         16  CF-PLAN-PYMT-TOLERANCES.
  2298             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2299             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2300         16  CF-PLAN-MISC-DATA.
  2301             20  FILLER                     PIC X.
  2302             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2303             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2304         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2305         16  CF-PLAN-IND-GRP                PIC X.
  2306             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2307                                                     '1'.
  2308             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2309                                                     '2'.
  2310         16  CF-MIB-SEARCH-SW               PIC X.
  2311             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2312             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2313             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2314             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2315         16  CF-ALPHA-SEARCH-SW             PIC X.
  2316             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2317             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2318             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2319             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2320             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2321             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2322             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2323             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2324             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2325             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2326                                                     'A' 'B' 'C'
  2327                                                     'X' 'Y' 'Z'.
  2328         16  CF-EFF-DT-RULE-SW              PIC X.
  2329             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2330             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2331             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2332             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2333             88  CF-EFF-DT-ANN                 VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* SOCK00.cbl
  2334         16  FILLER                         PIC X(4).
  2335         16  CF-HEALTH-QUESTIONS            PIC X.
  2336             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2337         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2338         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2339         16  CF-PLAN-SNGL-JNT               PIC X.
  2340             88  CF-COMBINED-PLAN              VALUE 'C'.
  2341             88  CF-JNT-PLAN                   VALUE 'J'.
  2342             88  CF-SNGL-PLAN                  VALUE 'S'.
  2343         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2344         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2345         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2346         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2347         16  CF-RERATE-CNTL                 PIC  X.
  2348             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2349             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2350             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2351             88  CF-AUTO-RECALC                 VALUE '4'.
  2352         16  CF-BENEFIT-TYPE                PIC  X.
  2353             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2354             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2355         16  CF-POLICY-FEE                  PIC S999V99
  2356                                                    COMP-3.
  2357         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2358         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2359         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2360         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2361         16  FILLER                         PIC  X(32).
  2362         16  CF-TERMINATION-FORM            PIC  X(04).
  2363         16  FILLER                         PIC  X(08).
  2364         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2365                                                       COMP-3.
  2366         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2367         16  CF-ISSUE-LETTER                PIC  X(4).
  2368         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2369         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2370             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2371             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2372         16  CF-MP-REFUND-CALC              PIC X.
  2373             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2374             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2375             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2376             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2377             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2378             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2379             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2380             88  CF-MP-REFD-MEAN                VALUE '8'.
  2381         16  CF-ALT-RATE-CODE               PIC  X(5).
  2382
  2383
  2384         16  FILLER                         PIC X(498).
  2385****************************************************************
  2386*             MORTGAGE COMPANY MASTER RECORD                   *
  2387****************************************************************
  2388
  2389     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2390         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2391         16  CF-MORTG-ACCESS-CONTROL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* SOCK00.cbl
  2392             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2393             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2394             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2395             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2396             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2397
  2398         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2399         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2400         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2401         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2402         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2403
  2404         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2405             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2406         16  CF-MP-RECON-USE-IND            PIC X(1).
  2407             88  CF-MP-USE-RECON             VALUE 'Y'.
  2408         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2409             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2410         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2411             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2412             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2413         16  FILLER                         PIC X(1).
  2414         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2415             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2416         16  CF-MORTG-MIB-VERSION           PIC X.
  2417             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2418             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2419             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2420         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2421             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2422                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2423             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2424                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2425             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2426                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2427             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2428                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2429             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2430                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2431             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2432                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2433         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2434         16  FILLER                         PIC X(7).
  2435         16  CF-MORTG-DESTINATION-SYMBOL.
  2436             20  CF-MORTG-MIB-COMM          PIC X(5).
  2437             20  CF-MORTG-MIB-TERM          PIC X(5).
  2438         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2439             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2440         16  FILLER                         PIC X(03).
  2441         16  CF-MP-CHECK-NO-CONTROL.
  2442             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2443                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2444                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2445                                                ' ' LOW-VALUES.
  2446                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2447                                               VALUE '3'.
  2448         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2449         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* SOCK00.cbl
  2450         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2451             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2452                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2453             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2454                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2455             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2456                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2457             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2458                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2459             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2460                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2461             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2462                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2463         16  CF-MORTG-BILLING-AREA.
  2464             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2465                                            PIC X.
  2466         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2467         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2468         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2469         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2470             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2471             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2472         16  FILLER                         PIC X.
  2473         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2474             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2475             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2476         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2477         16  FILLER                         PIC X(8).
  2478         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2479         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2480         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2481         16  CF-ACH-COMPANY-ID.
  2482             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2483                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2484                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2485                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2486             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2487         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2488             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2489         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2490             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2491             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2492         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2493         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2494         16  FILLER                         PIC X(536).
  2495
  2496****************************************************************
  2497*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2498****************************************************************
  2499
  2500     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2501         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2502             20  CF-FEMALE-HEIGHT.
  2503                 24  CF-FEMALE-FT           PIC 99.
  2504                 24  CF-FEMALE-IN           PIC 99.
  2505             20  CF-FEMALE-MIN-WT           PIC 999.
  2506             20  CF-FEMALE-MAX-WT           PIC 999.
  2507         16  FILLER                         PIC X(428).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* SOCK00.cbl
  2508
  2509     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2510         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2511             20  CF-MALE-HEIGHT.
  2512                 24  CF-MALE-FT             PIC 99.
  2513                 24  CF-MALE-IN             PIC 99.
  2514             20  CF-MALE-MIN-WT             PIC 999.
  2515             20  CF-MALE-MAX-WT             PIC 999.
  2516         16  FILLER                         PIC X(428).
  2517******************************************************************
  2518*             AUTOMATIC ACTIVITY RECORD                          *
  2519******************************************************************
  2520     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2521         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2522             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2523             20  CF-SYS-LETTER-ID           PIC X(04).
  2524             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2525             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2526             20  CF-SYS-RESET-SW            PIC X(01).
  2527             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2528             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2529
  2530         16  FILLER                         PIC X(50).
  2531
  2532         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2533             20  CF-USER-ACTIVE-SW          PIC X(01).
  2534             20  CF-USER-LETTER-ID          PIC X(04).
  2535             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2536             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2537             20  CF-USER-RESET-SW           PIC X(01).
  2538             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2539             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2540             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2541
  2542         16  FILLER                         PIC X(246).
  2543*                                 COPY ERCCTBL.
  2544******************************************************************
  2545*                                                                *
  2546*                                                                *
  2547*                            ERCCTBL                             *
  2548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2549*                            VMOD=2.003
  2550*                                                                *
  2551*   ONLINE CREDIT SYSTEM                                         *
  2552*                                                                *
  2553*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2554*                                                                *
  2555*   FILE TYPE = VSAM,KSDS                                        *
  2556*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2557*                                                                *
  2558*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2559*       ALTERNATE PATH = NONE                                    *
  2560*                                                                *
  2561*   LOG = NO                                                     *
  2562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2563*                                                                *
  2564*                                                                *
  2565******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* SOCK00.cbl
  2566
  2567 01  COMM-TABLE-RECORD.
  2568     12  CT-RECORD-ID                      PIC XX.
  2569         88  VALID-CT-ID                      VALUE 'CT'.
  2570
  2571     12  CT-CONTROL-PRIMARY.
  2572         16  CT-COMPANY-CD                 PIC X.
  2573         16  CT-TABLE                      PIC XXX.
  2574         16  CT-CNTRL-2.
  2575             20  CT-BEN-TYPE               PIC X.
  2576             20  CT-BEN-CODE               PIC XX.
  2577
  2578     12  CT-MAINT-INFORMATION.
  2579         16  CT-LAST-MAINT-DT              PIC XX.
  2580         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2581         16  CT-LAST-MAINT-USER            PIC X(4).
  2582         16  FILLER                        PIC X(31).
  2583
  2584     12  CT-LIMITS.
  2585         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2586
  2587         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2588
  2589         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2590
  2591     12  CT-RATES.
  2592         16  CT-RTX          OCCURS 27 TIMES.
  2593             20  CT-RT                     PIC SV9(5)     COMP-3.
  2594             20  CT-RT-R   REDEFINES
  2595                 CT-RT                     PIC XXX.
  2596
  2597     12  FILLER                            PIC  X(42).
  2598
  2599******************************************************************
  2600*                                 COPY ELCDATE.
  2601******************************************************************
  2602*                                                                *
  2603*                                                                *
  2604*                            ELCDATE.                            *
  2605*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2606*                            VMOD=2.003
  2607*                                                                *
  2608*                                                                *
  2609*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2610*                 LENGTH = 200                                   *
  2611******************************************************************
  2612
  2613 01  DATE-CONVERSION-DATA.
  2614     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2615     12  DC-OPTION-CODE                PIC X.
  2616         88  BIN-TO-GREG                VALUE ' '.
  2617         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2618         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2619         88  YMD-GREG-TO-BIN            VALUE '3'.
  2620         88  MDY-GREG-TO-BIN            VALUE '4'.
  2621         88  JULIAN-TO-BIN              VALUE '5'.
  2622         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2623         88  FIND-CENTURY               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* SOCK00.cbl
  2624         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2625         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2626         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2627         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2628         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2629         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2630         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2631         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2632         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2633         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2634         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2635         88  BIN-3-TO-GREG              VALUE 'I'.
  2636         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2637         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2638         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2639         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2640         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2641         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2642         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2643         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2644         88  THREE-CHARACTER-BIN
  2645                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2646         88  GREGORIAN-TO-BIN
  2647                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2648         88  BIN-TO-GREGORIAN
  2649                  VALUES ' ' '1' 'I' '8' 'G'.
  2650         88  JULIAN-TO-BINARY
  2651                  VALUES '5' 'C' 'E' 'F'.
  2652     12  DC-ERROR-CODE                 PIC X.
  2653         88  NO-CONVERSION-ERROR        VALUE ' '.
  2654         88  DATE-CONVERSION-ERROR
  2655                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2656         88  DATE-IS-ZERO               VALUE '1'.
  2657         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2658         88  DATE-IS-INVALID            VALUE '3'.
  2659         88  DATE1-GREATER-DATE2        VALUE '4'.
  2660         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2661         88  DATE-INVALID-OPTION        VALUE '9'.
  2662         88  INVALID-CENTURY            VALUE 'A'.
  2663         88  ONLY-CENTURY               VALUE 'B'.
  2664         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2665         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2666     12  DC-END-OF-MONTH               PIC X.
  2667         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2668     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2669         88  USE-NORMAL-PROCESS         VALUE ' '.
  2670         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2671         88  ADJUST-UP-100-YRS          VALUE '2'.
  2672     12  FILLER                        PIC X.
  2673     12  DC-CONVERSION-DATES.
  2674         16  DC-BIN-DATE-1             PIC XX.
  2675         16  DC-BIN-DATE-2             PIC XX.
  2676         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2677         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2678                       DC-GREG-DATE-1-EDIT.
  2679             20  DC-EDIT1-MONTH        PIC 99.
  2680             20  SLASH1-1              PIC X.
  2681             20  DC-EDIT1-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* SOCK00.cbl
  2682             20  SLASH1-2              PIC X.
  2683             20  DC-EDIT1-YEAR         PIC 99.
  2684         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2685         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2686                     DC-GREG-DATE-2-EDIT.
  2687             20  DC-EDIT2-MONTH        PIC 99.
  2688             20  SLASH2-1              PIC X.
  2689             20  DC-EDIT2-DAY          PIC 99.
  2690             20  SLASH2-2              PIC X.
  2691             20  DC-EDIT2-YEAR         PIC 99.
  2692         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2693         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2694                     DC-GREG-DATE-1-YMD.
  2695             20  DC-YMD-YEAR           PIC 99.
  2696             20  DC-YMD-MONTH          PIC 99.
  2697             20  DC-YMD-DAY            PIC 99.
  2698         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2699         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2700                      DC-GREG-DATE-1-MDY.
  2701             20  DC-MDY-MONTH          PIC 99.
  2702             20  DC-MDY-DAY            PIC 99.
  2703             20  DC-MDY-YEAR           PIC 99.
  2704         16  DC-GREG-DATE-1-ALPHA.
  2705             20  DC-ALPHA-MONTH        PIC X(10).
  2706             20  DC-ALPHA-DAY          PIC 99.
  2707             20  FILLER                PIC XX.
  2708             20  DC-ALPHA-CENTURY.
  2709                 24 DC-ALPHA-CEN-N     PIC 99.
  2710             20  DC-ALPHA-YEAR         PIC 99.
  2711         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2712         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2713         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2714         16  DC-JULIAN-DATE            PIC 9(05).
  2715         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2716                                       PIC 9(05).
  2717         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2718             20  DC-JULIAN-YEAR        PIC 99.
  2719             20  DC-JULIAN-DAYS        PIC 999.
  2720         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2721         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2722         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2723     12  DATE-CONVERSION-VARIBLES.
  2724         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2725         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2726             20  FILLER                PIC 9(3).
  2727             20  HOLD-CEN-1-CCYY.
  2728                 24  HOLD-CEN-1-CC     PIC 99.
  2729                 24  HOLD-CEN-1-YY     PIC 99.
  2730             20  HOLD-CEN-1-MO         PIC 99.
  2731             20  HOLD-CEN-1-DA         PIC 99.
  2732         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2733             20  HOLD-CEN-1-R-MO       PIC 99.
  2734             20  HOLD-CEN-1-R-DA       PIC 99.
  2735             20  HOLD-CEN-1-R-CCYY.
  2736                 24  HOLD-CEN-1-R-CC   PIC 99.
  2737                 24  HOLD-CEN-1-R-YY   PIC 99.
  2738             20  FILLER                PIC 9(3).
  2739         16  HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* SOCK00.cbl
  2740             20  FILLER                PIC X(3)  VALUE SPACES.
  2741             20  HOLD-CEN-1-X-CCYY.
  2742                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2743                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2744             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2745             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2746         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2747             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2748             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2749             20  HOLD-CEN-1-R-X-CCYY.
  2750                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2751                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2752             20  FILLER                PIC XXX.
  2753         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2754         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2755         16  DC-JULIAN-DATE-1          PIC 9(07).
  2756         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2757             20  DC-JULIAN-1-CCYY.
  2758                 24  DC-JULIAN-1-CC    PIC 99.
  2759                 24  DC-JULIAN-1-YR    PIC 99.
  2760             20  DC-JULIAN-DA-1        PIC 999.
  2761         16  DC-JULIAN-DATE-2          PIC 9(07).
  2762         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2763             20  DC-JULIAN-2-CCYY.
  2764                 24  DC-JULIAN-2-CC    PIC 99.
  2765                 24  DC-JULIAN-2-YR    PIC 99.
  2766             20  DC-JULIAN-DA-2        PIC 999.
  2767         16  DC-GREG-DATE-A-EDIT.
  2768             20  DC-EDITA-MONTH        PIC 99.
  2769             20  SLASHA-1              PIC X VALUE '/'.
  2770             20  DC-EDITA-DAY          PIC 99.
  2771             20  SLASHA-2              PIC X VALUE '/'.
  2772             20  DC-EDITA-CCYY.
  2773                 24  DC-EDITA-CENT     PIC 99.
  2774                 24  DC-EDITA-YEAR     PIC 99.
  2775         16  DC-GREG-DATE-B-EDIT.
  2776             20  DC-EDITB-MONTH        PIC 99.
  2777             20  SLASHB-1              PIC X VALUE '/'.
  2778             20  DC-EDITB-DAY          PIC 99.
  2779             20  SLASHB-2              PIC X VALUE '/'.
  2780             20  DC-EDITB-CCYY.
  2781                 24  DC-EDITB-CENT     PIC 99.
  2782                 24  DC-EDITB-YEAR     PIC 99.
  2783         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2784         16  DC-GREG-DATE-CYMD-R REDEFINES
  2785                              DC-GREG-DATE-CYMD.
  2786             20  DC-CYMD-CEN           PIC 99.
  2787             20  DC-CYMD-YEAR          PIC 99.
  2788             20  DC-CYMD-MONTH         PIC 99.
  2789             20  DC-CYMD-DAY           PIC 99.
  2790         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2791         16  DC-GREG-DATE-MDCY-R REDEFINES
  2792                              DC-GREG-DATE-MDCY.
  2793             20  DC-MDCY-MONTH         PIC 99.
  2794             20  DC-MDCY-DAY           PIC 99.
  2795             20  DC-MDCY-CEN           PIC 99.
  2796             20  DC-MDCY-YEAR          PIC 99.
  2797    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* SOCK00.cbl
  2798        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2799    12  DC-EL310-DATE                  PIC X(21).
  2800    12  FILLER                         PIC X(28).
  2801*                                 COPY ELCCALC.
  2802******************************************************************
  2803*                                                                *
  2804*                           ELCCALC.                            *
  2805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2806*                            VMOD=2.025                          *
  2807*                                                                *
  2808*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2809*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2810*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2811*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2812*                                                                *
  2813*  PASSED TO ELRTRM                                              *
  2814*  -----------------                                             *
  2815*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2816*  ORIGINAL TERM                                                 *
  2817*  BEGINNING DATE                                                *
  2818*  ENDING DATE                                                   *
  2819*  COMPANY I.D.                                                  *
  2820*  ACCOUNT MASTER USER FIELD                                     *
  2821*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2822*  FREE LOOK DAYS                                                *
  2823*                                                                *
  2824*  RETURNED FROM ELRTRM                                          *
  2825*  ---------------------                                         *
  2826*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2827*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2828*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2829*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2830*----------------------------------------------------------------*
  2831*  PASSED TO ELRAMT                                              *
  2832*  ----------------                                              *
  2833*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2834*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2835*  ORIGINAL AMOUNT                                               *
  2836*  ALTERNATE BENEFIT (BALLON)                                    *
  2837*  A.P.R. - NET PAY ONLY                                         *
  2838*  METHOD
  2839*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2840*  COMPANY I.D.                                                  *
  2841*  BENEFIT TYPE                                                  *
  2842*                                                                *
  2843*  RETURNED FROM ELRAMT                                          *
  2844*  --------------------                                          *
  2845*  REMAINING AMOUNT 1 - CURRENT                                  *
  2846*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2847*  REMAINING AMOUNT FACTOR
  2848*----------------------------------------------------------------*
  2849*  PASSED TO ELRESV                                              *
  2850*  -----------------                                             *
  2851*  CERTIFICATE EFFECTIVE DATE                                    *
  2852*  VALUATION DATE                                                *
  2853*  PAID THRU DATE                                                *
  2854*  BENEFIT                                                       *
  2855*  INCURRED DATE                                                 *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* SOCK00.cbl
  2856*  REPORTED DATE                                                 *
  2857*  ISSUE AGE                                                     *
  2858*  TERM                                                          *
  2859*  CDT PERCENT                                                   *
  2860*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2861* *CLAIM TYPE (LIFE, A/H)                                        *
  2862* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2863* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2864*                                                                *
  2865*  RETURNED FROM ELRESV                                          *
  2866*  --------------------                                          *
  2867*  CDT TABLE USED                                                *
  2868*  CDT FACTOR USED                                               *
  2869*  PAY TO CURRENT RESERVE                                        *
  2870*  I.B.N.R. - A/H ONLY                                           *
  2871*  FUTURE (ACCRUED) AH ONLY                                      *
  2872*----------------------------------------------------------------*
  2873*  PASSED TO ELRATE                                              *
  2874*  ----------------                                              *
  2875*  CERT ISSUE DATE                                               *
  2876*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2877*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2878*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2879*  STATE CODE (CLIENT DEFINED)                                   *
  2880*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2881*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2882*  DEVIATION CODE                                                *
  2883*  ISSUE AGE                                                     *
  2884*  ORIGINAL BENEFIT AMOUNT                                       *
  2885*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2886*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2887*  BENEFIT KIND (LIFE OR A/H)                                    *
  2888*  A.P.R.                                                        *
  2889*  METHOD
  2890*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2891*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2892*  COMPANY I.D. (3 CHARACTER)                                    *
  2893*  BENEFIT CODE                                                  *
  2894*  BENEFIT OVERRIDE CODE                                         *
  2895*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2896*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2897*  JOINT INDICATOR (CSL ONLY)                                    *
  2898*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2899*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2900*                                                                *
  2901*  RETURNED FROM ELRATE                                          *
  2902*  --------------------                                          *
  2903*  CALCULATED PREMIUM                                            *
  2904*  PREMIUM RATE                                                  *
  2905*  MORTALITY CODE                                                *
  2906*  MAX ATTAINED AGE                                              *
  2907*  MAX AGE                                                       *
  2908*  MAX TERM                                                      *
  2909*  MAX MONTHLY BENEFIT                                           *
  2910*  MAX TOTAL BENIFIT                                             *
  2911*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2912*----------------------------------------------------------------*
  2913*  PASSED TO ELRFND                                              *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* SOCK00.cbl
  2914*  ----------------                                              *
  2915*  CERT ISSUE DATE                                               *
  2916*  REFUND DATE                                                   *
  2917*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2918*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2919*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2920*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2921*  STATE CODE (CLIENT DEFINED)                                   *
  2922*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2923*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2924*  DEVIATION CODE                                                *
  2925*  ISSUE AGE                                                     *
  2926*  ORIGINAL BENEFIT AMOUNT                                       *
  2927*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2928*  PROCESS TYPE (CANCEL)                                         *
  2929*  BENEFIT KIND (LIFE OR A/H)                                    *
  2930*  A.P.R.                                                        *
  2931*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2932*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2933*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2934*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2935*  COMPANY I.D. (3 CHARACTER)                                    *
  2936*  BENEFIT CODE                                                  *
  2937*  BENEFIT OVERRIDE CODE                                         *
  2938*                                                                *
  2939*  RETURNED FROM ELRFND                                          *
  2940*  --------------------                                          *
  2941*  CALCULATED REFUND                                             *
  2942*----------------------------------------------------------------*
  2943*  PASSED TO ELEARN                                              *
  2944*  ----------------                                              *
  2945*  CERT ISSUE DATE                                               *
  2946*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2947*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2948*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2949*  STATE CODE (CLIENT DEFINED)                                   *
  2950*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2951*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2952*  DEVIATION CODE                                                *
  2953*  ISSUE AGE                                                     *
  2954*  ORIGINAL BENEFIT AMOUNT                                       *
  2955*  BENEFIT KIND (LIFE OR A/H)                                    *
  2956*  A.P.R.                                                        *
  2957*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2958*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2959*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2960*  COMPANY I.D. (3 CHARACTER)                                    *
  2961*  BENEFIT CODE                                                  *
  2962*  BENEFIT OVERRIDE CODE                                         *
  2963*                                                                *
  2964*  RETURNED FROM ELEARN                                          *
  2965*  --------------------                                          *
  2966*  INDICATED  EARNINGS                                           *
  2967*----------------------------------------------------------------*
  2968*                 LENGTH = 450                                   *
  2969*                                                                *
  2970******************************************************************
  2971******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* SOCK00.cbl
  2972*                   C H A N G E   L O G
  2973*
  2974* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2975*-----------------------------------------------------------------
  2976*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2977* EFFECTIVE    NUMBER
  2978*-----------------------------------------------------------------
  2979* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2980* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2981* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2982* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2983* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2984* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2985* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2986* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2987* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2988******************************************************************
  2989
  2990 01  CALCULATION-PASS-AREA.
  2991     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2992                                     COMP.
  2993
  2994     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2995       88  NO-CP-ERROR                             VALUE ZERO.
  2996       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2997                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2998       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2999       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3000       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3001       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3002       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3003       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3004       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3005       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3006       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3007       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3008       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3009       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3010       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3011       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3012       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3013       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3014       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3015
  3016     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3017       88  NO-CP-ERROR-2                           VALUE ZERO.
  3018***********************  INPUT AREAS ****************************
  3019
  3020     12  CP-CALCULATION-AREA.
  3021         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3022         16  CP-CERT-EFF-DT        PIC XX.
  3023         16  CP-VALUATION-DT       PIC XX.
  3024         16  CP-PAID-THRU-DT       PIC XX.
  3025         16  CP-BENEFIT-TYPE       PIC X.
  3026           88  CP-AH                               VALUE 'A' 'D'
  3027                                                   'I' 'U'.
  3028           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3029           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* SOCK00.cbl
  3030         16  CP-INCURRED-DT        PIC XX.
  3031         16  CP-REPORTED-DT        PIC XX.
  3032         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3033         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3034         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3035                                     COMP-3.
  3036         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3037                                     COMP-3.
  3038         16  CP-CDT-METHOD         PIC X.
  3039           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3040           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3041           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3042         16  CP-CLAIM-TYPE         PIC X.
  3043           88  CP-AH-CLAIM                         VALUE 'A'.
  3044           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3045         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3046                                     COMP-3.
  3047         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3048                                     COMP-3.
  3049         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3050                                     COMP-3.
  3051         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3052                                     COMP-3.
  3053         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3054                                     COMP-3.
  3055         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3056                                     COMP-3.
  3057         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3058                                     COMP-3.
  3059         16  CP-REM-TERM-METHOD    PIC X.
  3060           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3061           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3062           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3063           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3064           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3065           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3066           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3067         16  CP-EARNING-METHOD     PIC X.
  3068           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3069           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3070           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3071           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3072           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3073           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3074           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3075           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3076           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3077           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3078           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3079           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3080           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3081           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3082         16  CP-PROCESS-TYPE       PIC X.
  3083           88  CP-CLAIM                            VALUE '1'.
  3084           88  CP-CANCEL                           VALUE '2'.
  3085           88  CP-ISSUE                            VALUE '3'.
  3086         16  CP-SPECIAL-CALC-CD    PIC X.
  3087           88  CP-OUTSTANDING-BAL              VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* SOCK00.cbl
  3088           88  CP-1-MTH-INTEREST               VALUE ' '.
  3089           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3090           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3091           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3092           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3093           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3094           88  CP-FARM-PLAN                    VALUE 'F'.
  3095           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3096           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3097           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3098           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3099           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3100           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3101           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3102           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3103           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3104           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3105                                                     'W' 'X'.
  3106           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3107           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3108           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3109           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3110           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3111           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3112           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3113           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3114           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3115           88  CP-CSL-METH-1                   VALUE '5'.
  3116           88  CP-CSL-METH-2                   VALUE '6'.
  3117           88  CP-CSL-METH-3                   VALUE '7'.
  3118           88  CP-CSL-METH-4                   VALUE '8'.
  3119
  3120         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3121                                     COMP-3.
  3122         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3123         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3124         16  CP-STATE              PIC XX          VALUE SPACE.
  3125         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3126         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3127           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3128               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3129         16  CP-R78-OPTION         PIC X.
  3130           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3131           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3132
  3133         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3134         16  CP-IBNR-RESERVE-SW    PIC X.
  3135         16  CP-CLAIM-STATUS       PIC X.
  3136         16  CP-RATE-FILE          PIC X.
  3137         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3138                                     COMP-3.
  3139
  3140         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3141         16  CP-AH-OVERRIDE-CODE   PIC X.
  3142
  3143         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3144                                     COMP-3.
  3145         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* SOCK00.cbl
  3146                                   PIC S9(5)V99 COMP-3.
  3147         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3148                                     COMP-3.
  3149         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3150                                     COMP-3.
  3151         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3152                                     COMP-3.
  3153         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3154                                  PIC S9(7)V99 COMP-3.
  3155
  3156         16  CP-PAID-FROM-DATE     PIC X(02).
  3157         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3158         16  CP-EXT-DAYS-CALC      PIC X.
  3159           88  CP-EXT-NO-CHG                   VALUE ' '.
  3160           88  CP-EXT-CHG-LF                   VALUE '1'.
  3161           88  CP-EXT-CHG-AH                   VALUE '2'.
  3162           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3163         16  CP-DOMICILE-STATE     PIC XX.
  3164         16  CP-CARRIER            PIC X.
  3165         16  CP-REIN-FLAG          PIC X.
  3166         16  CP-REM-TRM-CALC-OPTION PIC X.
  3167           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3168                      '2' '3' '4' '5'.
  3169           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3170           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3171           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3172           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3173           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3174           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3175           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3176           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3177         16  CP-SIG-SWITCH         PIC X.
  3178         16  CP-RATING-METHOD      PIC X.
  3179           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3180           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3181           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3182           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3183           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3184           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3185           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3186           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3187           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3188         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3189                                     COMP-3.
  3190         16  CP-BEN-CATEGORY       PIC X.
  3191         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3192         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3193                                   PIC S99V9(5) COMP-3.
  3194         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3195         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3196                                   PIC S99V9(5) COMP-3.
  3197         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3198         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3199         16  CP-EXPIRE-DT          PIC XX.
  3200         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3201         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3202         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3203         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* SOCK00.cbl
  3204         16  CP-DDF-SPEC-CALC      PIC X.
  3205             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3206             88  CP-CALC-CLP              VALUE 'C'.
  3207         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3208         16  CP-CANCEL-REASON      PIC X.
  3209         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3210         16  CP-PMT-MODE           PIC X.
  3211         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3212         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3213         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3214         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3215         16  FILLER                PIC X.
  3216
  3217***************    OUTPUT FROM ELRESV   ************************
  3218
  3219         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3220
  3221         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3222                                     COMP-3.
  3223         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3224                                     COMP-3.
  3225         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3226                                     COMP-3.
  3227         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3228                                     COMP-3.
  3229         16  FILLER                PIC X(09).
  3230***************    OUTPUT FROM ELRTRM   *************************
  3231
  3232         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3233                                     COMP-3.
  3234         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3235                                     COMP-3.
  3236         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3237                                     COMP-3.
  3238         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3239                                     COMP-3.
  3240         16  FILLER                PIC X(12).
  3241
  3242***************    OUTPUT FROM ELRAMT   *************************
  3243
  3244         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3245                                     COMP-3.
  3246         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3247                                     COMP-3.
  3248         16  FILLER                PIC X(12).
  3249
  3250***************    OUTPUT FROM ELRATE   *************************
  3251
  3252         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3253                                     COMP-3.
  3254         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3255                                     COMP-3.
  3256         16  CP-MORTALITY-CODE     PIC X(4).
  3257         16  CP-RATE-EDIT-FLAG     PIC X.
  3258             88  CP-RATES-NEED-APR                  VALUE '1'.
  3259         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3260                                     COMP-3.
  3261         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* SOCK00.cbl
  3262         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3263         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3264                                   PIC S9(7)V99 COMP-3.
  3265         16  FILLER                PIC X(07).
  3266
  3267***************    OUTPUT FROM ELRFND   *************************
  3268
  3269         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3270                                     COMP-3.
  3271         16  CP-REFUND-TYPE-USED   PIC X.
  3272           88  CP-R-AS-R78                         VALUE '1'.
  3273           88  CP-R-AS-PRORATA                     VALUE '2'.
  3274           88  CP-R-AS-CALIF                       VALUE '3'.
  3275           88  CP-R-AS-TEXAS                       VALUE '4'.
  3276           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3277           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3278           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3279           88  CP-R-AS-MEAN                        VALUE '8'.
  3280           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3281           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3282           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3283           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3284           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3285           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3286         16  FILLER                PIC X(12).
  3287
  3288***************    OUTPUT FROM ELEARN   *************************
  3289
  3290         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3291                                     COMP-3.
  3292         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3293                                     COMP-3.
  3294         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3295                                     COMP-3.
  3296         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3297                                     COMP-3.
  3298         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3299                                     COMP-3.
  3300         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3301                                     COMP-3.
  3302         16  CP-EARNING-TYPE-USED  PIC X.
  3303           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3304           88  CP-E-AS-R78                         VALUE '1'.
  3305           88  CP-E-AS-PRORATA                     VALUE '2'.
  3306           88  CP-E-AS-TEXAS                       VALUE '4'.
  3307           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3308           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3309           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3310           88  CP-E-AS-MEAN                        VALUE '8'.
  3311           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3312         16  FILLER                PIC X(12).
  3313
  3314***************    OUTPUT FROM ELPMNT   *************************
  3315
  3316         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3317                                     COMP-3.
  3318         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3319                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* SOCK00.cbl
  3320         16  FILLER                PIC X(12).
  3321
  3322***************   MISC WORK AREAS    *****************************
  3323         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3324                                     COMP-3.
  3325         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3326                                     COMP-3.
  3327         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3328                                     COMP-3.
  3329         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3330                                     COMP-3.
  3331         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3332                                     COMP-3.
  3333         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3334                                     COMP-3.
  3335         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3336             88  OPEN-RATE-FILE                   VALUE 'O'.
  3337             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3338             88  IO-ERROR                         VALUE 'E'.
  3339
  3340         16  CP-FIRST-PAY-DATE     PIC XX.
  3341
  3342         16  CP-JOINT-INDICATOR    PIC X.
  3343
  3344         16  CP-RESERVE-REMAINING-TERM
  3345                                   PIC S9(4)V9    VALUE ZERO
  3346                                     COMP-3.
  3347
  3348         16  CP-INSURED-BIRTH-DT   PIC XX.
  3349
  3350         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3351                                     COMP-3.
  3352
  3353         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3354                                     COMP-3.
  3355
  3356         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3357                                     COMP-3.
  3358
  3359         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3360                                     COMP-3.
  3361
  3362         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3363                                     COMP-3.
  3364
  3365         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3366                                     COMP-3.
  3367
  3368         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3369                                     COMP-3.
  3370
  3371         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3372             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3373
  3374         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3375                                     COMP-3.
  3376         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3377                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* SOCK00.cbl
  3378         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3379         16  FILLER                PIC X(15).
  3380******************************************************************
  3381****************************************************************
  3382*
  3383* Copyright (c) 2007 by Clerity Solutions, Inc.
  3384* All rights reserved.
  3385*
  3386****************************************************************
  3387 01  DFHEIV.
  3388   02  DFHEIV0               PIC X(35).
  3389   02  DFHEIV1               PIC X(08).
  3390   02  DFHEIV2               PIC X(08).
  3391   02  DFHEIV3               PIC X(08).
  3392   02  DFHEIV4               PIC X(06).
  3393   02  DFHEIV5               PIC X(04).
  3394   02  DFHEIV6               PIC X(04).
  3395   02  DFHEIV7               PIC X(02).
  3396   02  DFHEIV8               PIC X(02).
  3397   02  DFHEIV9               PIC X(01).
  3398   02  DFHEIV10              PIC S9(7) COMP-3.
  3399   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3400   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3401   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3402   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3403   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3404   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3405   02  DFHEIV17              PIC X(04).
  3406   02  DFHEIV18              PIC X(04).
  3407   02  DFHEIV19              PIC X(04).
  3408   02  DFHEIV20              USAGE IS POINTER.
  3409   02  DFHEIV21              USAGE IS POINTER.
  3410   02  DFHEIV22              USAGE IS POINTER.
  3411   02  DFHEIV23              USAGE IS POINTER.
  3412   02  DFHEIV24              USAGE IS POINTER.
  3413   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3414   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3415   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3416   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3417   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3418   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3419   02  FILLER                PIC X(02).
  3420   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3421   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3422   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3423   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3424   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3425 LINKAGE  SECTION.
  3426*****************************************************************
  3427*                                                               *
  3428* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3429* All rights reserved.                                          *
  3430*                                                               *
  3431*****************************************************************
  3432 01  dfheiblk.
  3433     02  eibtime          pic s9(7) comp-3.
  3434     02  eibdate          pic s9(7) comp-3.
  3435     02  eibtrnid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* SOCK00.cbl
  3436     02  eibtaskn         pic s9(7) comp-3.
  3437     02  eibtrmid         pic x(4).
  3438     02  dfheigdi         pic s9(4) comp.
  3439     02  eibcposn         pic s9(4) comp.
  3440     02  eibcalen         pic s9(4) comp.
  3441     02  eibaid           pic x(1).
  3442     02  eibfiller1       pic x(1).
  3443     02  eibfn            pic x(2).
  3444     02  eibfiller2       pic x(2).
  3445     02  eibrcode         pic x(6).
  3446     02  eibfiller3       pic x(2).
  3447     02  eibds            pic x(8).
  3448     02  eibreqid         pic x(8).
  3449     02  eibrsrce         pic x(8).
  3450     02  eibsync          pic x(1).
  3451     02  eibfree          pic x(1).
  3452     02  eibrecv          pic x(1).
  3453     02  eibsend          pic x(1).
  3454     02  eibatt           pic x(1).
  3455     02  eibeoc           pic x(1).
  3456     02  eibfmh           pic x(1).
  3457     02  eibcompl         pic x(1).
  3458     02  eibsig           pic x(1).
  3459     02  eibconf          pic x(1).
  3460     02  eiberr           pic x(1).
  3461     02  eibrldbk         pic x(1).
  3462     02  eiberrcd         pic x(4).
  3463     02  eibsynrb         pic x(1).
  3464     02  eibnodat         pic x(1).
  3465     02  eibfiller5       pic x(2).
  3466     02  eibresp          pic 9(09) comp.
  3467     02  eibresp2         pic 9(09) comp.
  3468     02  dfheigdj         pic s9(4) comp.
  3469     02  dfheigdk         pic s9(4) comp.
  3470 01  DFHCOMMAREA.
  3471   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3472   05 LSTN-NAME                PIC X(8).
  3473   05 LSTN-SUBNAME             PIC X(8).
  3474   05 CLIENT-IN-DATA.
  3475      15  CLIENT-CAR           PIC X.
  3476      15  CLIENT-GRP           PIC X(6).
  3477      15  CLIENT-ST            PIC XX.
  3478      15  CLIENT-ACT           PIC X(10).
  3479      15  CLIENT-ID            PIC XXX.
  3480      15  FILLER               PIC X(14).
  3481   05 SOCKADDR-IN-PARM.
  3482     15 SIN-FAMILY             PIC 9(4) COMP.
  3483     15 SIN-PORT               PIC 9(4) COMP.
  3484     15 SIN-ADDRESS            PIC 9(8) COMP.
  3485     15 SIN-ZERO               PIC X(8).
  3486 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3487 0000-DFHEXIT SECTION.
  3488     MOVE '9#                    $   ' TO DFHEIV0.
  3489     MOVE 'SOCK00' TO DFHEIV1.
  3490     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3491*
  3492* when calling a C function the function returns its value
  3493* in the system variable return code.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* SOCK00.cbl
  3494*
  3495 start-here.
  3496*
  3497* data with transaction
  3498*
  3499     display 'SOCK00:transaction data =', CLIENT-IN-DATA.
  3500     display 'SOCK00:socket number    =', GIVE-TAKE-SOCKET.
  3501     IF CLIENT-IN-DATA (1:4) = "RATE"
  3502        SET GET-RATES            TO TRUE
  3503     ELSE
  3504        IF CLIENT-IN-DATA (1:5) = "STATE"
  3505           SET GET-ACT-ACCTS     TO TRUE
  3506        END-IF
  3507     END-IF
  3508     IF CLIENT-ID = 'AHL'
  3509        MOVE X'06'               TO WS-COMP-CD
  3510        MOVE 'AHL'               TO WS-SEND-BUF (5:3)
  3511                                    WS-COMP-ID
  3512     ELSE
  3513        IF CLIENT-ID = 'DCC'
  3514           MOVE X'05'            TO WS-COMP-CD
  3515           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
  3516                                    WS-COMP-ID
  3517        ELSE
  3518           MOVE X'04'            TO WS-COMP-CD
  3519           MOVE 'CID'            TO WS-SEND-BUF (5:3)
  3520                                    WS-COMP-ID
  3521        END-IF
  3522     END-IF
  3523     move 'CSO'                  to ws-send-buf (1:3)
  3524     move +25                    to ws-send-msg-size
  3525* send data
  3526*
  3527     display 'SOCK00:sequence number  =', ws-seq-num.
  3528     display 'SOCK00:send buffer      =', ws-send-buf(1:25).
  3529     call "send" using by value GIVE-TAKE-SOCKET,
  3530         by reference ws-send-buf,
  3531         by value ws-send-msg-size,
  3532         by value ws-flags.
  3533     if return-code <= zero
  3534         display 'SOCK00:send error ',
  3535         go to socket-error.
  3536*
  3537* set up the receive buffer
  3538*
  3539     move low-values to ws-recv-buf.
  3540     set ws-recv-total to zero.
  3541     compute ws-recv-left = ws-recv-msg-size.
  3542*
  3543* receive data
  3544*
  3545     display 'SOCK00:About to recv '
  3546     call "recv" using by value GIVE-TAKE-SOCKET,
  3547         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3548         by value ws-recv-left,
  3549         by value ws-flags.
  3550*
  3551* test what was received and decide what we should do
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* SOCK00.cbl
  3552*
  3553     if return-code < zero
  3554        display 'SOCK00:recv error ',
  3555        go to socket-error.
  3556     if return-code = zero
  3557        display 'SOCK00:client disconnected',
  3558        go to socket-error.
  3559*
  3560     display 'SOCK00:Good recv  '
  3561     display 'SOCK00:return code      = ', return-code
  3562     display 'SOCK00:receive buffer   = ', ws-recv-buf(1:50)
  3563     move +4096                  to ws-send-msg-size
  3564*    move +750                   to ws-send-msg-size
  3565     if get-rates
  3566        perform 0300-get-rates   thru 0300-exit
  3567     end-if
  3568     IF GET-ACT-ACCTS
  3569        PERFORM 0400-GET-ACT-ACCTS
  3570                                 THRU 0400-EXIT
  3571     END-IF
  3572     move ws-recv-buf (1:19)     to client-in-data
  3573     IF (CLIENT-CAR NOT = ZEROS)
  3574        AND (CLIENT-ST NOT = ZEROS)
  3575        PERFORM 0500-GET-ONE-ACCT
  3576                                 THRU 0500-EXIT
  3577     END-IF
  3578     MOVE ' '                    TO WS-BUILD-SW
  3579     MOVE CLIENT-ACT             TO WS-AM-ALT-ACCOUNT
  3580     MOVE LOW-VALUES             TO WS-AM-ALT-EXP-DT
  3581     PERFORM 0010-STARTBR-ERACCT THRU 0010-EXIT
  3582     IF NOT RESP-NORMAL
  3583        MOVE 'BAD STARTBR ON ERACCT  '
  3584                                 TO WS-SEND-BUF
  3585        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3586        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3587        GO TO SEND-BUFFER
  3588     END-IF
  3589     PERFORM 0020-READNEXT-ERACCT
  3590                                 THRU 0020-EXIT
  3591     IF (NOT RESP-NORMAL)
  3592        OR (AM-ACCOUNT NOT = CLIENT-ACT)
  3593        MOVE 'BAD READNEXT ON ERACCT '
  3594                                 TO WS-SEND-BUF
  3595        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3596        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3597        GO TO SEND-BUFFER
  3598     ELSE
  3599        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  3600     END-IF
  3601     PERFORM UNTIL
  3602        (TIME-TO-BUILD)
  3603        IF AM-ACCOUNT = CLIENT-ACT
  3604         IF (AM-STATE = CLIENT-ST)
  3605                 OR
  3606            (CLIENT-ST = 00)
  3607           IF AM-EXPIRATION-DT = HIGH-VALUES
  3608              SET TIME-TO-BUILD  TO TRUE
  3609           ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* SOCK00.cbl
  3610              MOVE ACCOUNT-MASTER
  3611                                 TO WS-SAVE-ERACCT
  3612              PERFORM 0020-READNEXT-ERACCT
  3613                                 THRU 0020-EXIT
  3614              IF NOT RESP-NORMAL
  3615                 MOVE WS-SAVE-ERACCT
  3616                                 TO ACCOUNT-MASTER
  3617                 SET TIME-TO-BUILD
  3618                                 TO TRUE
  3619              END-IF
  3620           END-IF
  3621         ELSE
  3622          PERFORM 0020-READNEXT-ERACCT
  3623                            THRU 0020-EXIT
  3624         END-IF
  3625        ELSE
  3626           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  3627           SET TIME-TO-BUILD     TO TRUE
  3628        END-IF
  3629     END-PERFORM
  3630     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3631     .
  3632*
  3633* send data
  3634*
  3635 SEND-BUFFER.
  3636     display 'SOCK00:About to send      '
  3637     display 'SOCK00:sequence number  =', ws-seq-num.
  3638     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  3639     call "send" using by value GIVE-TAKE-SOCKET,
  3640         by reference ws-send-buf,
  3641         by value ws-send-msg-size,
  3642         by value ws-flags.
  3643     if return-code <= zero
  3644         display 'SOCK00:send error ',
  3645         go to socket-error.
  3646     GO TO SOCKET-FIN
  3647*
  3648* set up the receive buffer
  3649*
  3650     move low-values to ws-recv-buf.
  3651     set ws-recv-total to zero.
  3652     compute ws-recv-left = ws-recv-msg-size.
  3653*
  3654* receive data
  3655*
  3656 recv-1.
  3657     call "recv" using by value GIVE-TAKE-SOCKET,
  3658         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3659         by value ws-recv-left,
  3660         by value ws-flags.
  3661*
  3662* test what was received and decide what we should do
  3663*
  3664     if return-code < zero
  3665        display 'SOCK00:recv error ',
  3666        go to socket-error.
  3667     if return-code = zero
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* SOCK00.cbl
  3668        display 'SOCK00:client disconnected',
  3669        go to socket-error.
  3670*
  3671* have we received all the data yet?
  3672*
  3673     compute ws-recv-total = ws-recv-total + return-code.
  3674     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3675*
  3676* not yet
  3677*
  3678     if ws-recv-left > 0 go to recv-1.
  3679*
  3680* received all the data
  3681*
  3682     display 'SOCK00:receive buffer   =', ws-recv-buf(1:50).
  3683*
  3684* make sure what we received was what we sent
  3685*
  3686*    if ws-recv-buf <> ws-send-buf
  3687*        display "SOCK00:data doesn't match",
  3688*        go to socket-error.
  3689*
  3690* end of pass
  3691*
  3692*loop-end.
  3693*    if ws-seq-num = 5 go to socket-error.
  3694*    go to loop-1.
  3695*
  3696* program end
  3697*
  3698 socket-error.
  3699     if ws-seq-num <> 0
  3700         display "SOCK00:did not complete".
  3701*
  3702* flush the send buffer and deallocate
  3703*
  3704*    display 'SOCK00:closing socket'.
  3705*    call "close" using by value GIVE-TAKE-SOCKET .
  3706*
  3707* finised return to cics
  3708*
  3709 socket-fin.
  3710     display 'SOCK00:closing socket'.
  3711     call "close" using by value GIVE-TAKE-SOCKET .
  3712     display 'SOCK00:done'.
  3713
  3714* exec cics return end-exec.
  3715*    MOVE '.(                    ''   #00003709' TO DFHEIV0
  3716     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3718     MOVE X'2020233030303033373039' TO DFHEIV0(25:11)
  3719     CALL 'kxdfhei1' USING DFHEIV0,
  3720           DFHEIV99,
  3721           DFHEIV99,
  3722           DFHEIV99,
  3723           DFHEIV99,
  3724           DFHEIV99,
  3725           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* SOCK00.cbl
  3726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3727
  3728
  3729* goback.
  3730     MOVE '9%                    "   ' TO DFHEIV0
  3731     MOVE 'SOCK00' TO DFHEIV1
  3732     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3733     goback.
  3734 0010-STARTBR-ERACCT.
  3735
  3736* EXEC CICS STARTBR
  3737*         DATASET    ('ERACCT3')
  3738*         RIDFLD     (WS-AM-ALT-KEY)
  3739*         GENERIC
  3740*         GTEQ
  3741*         KEYLENGTH  (10)
  3742*         RESP       (WS-RESPONSE)
  3743*    END-EXEC
  3744     MOVE 'ERACCT3' TO DFHEIV1
  3745     MOVE 10
  3746       TO DFHEIV11
  3747     MOVE 0
  3748       TO DFHEIV12
  3749*    MOVE '&,   KG    G          &  N#00003712' TO DFHEIV0
  3750     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3751     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3752     MOVE X'204E233030303033373132' TO DFHEIV0(25:11)
  3753     CALL 'kxdfhei1' USING DFHEIV0,
  3754           DFHEIV1,
  3755           WS-AM-ALT-KEY,
  3756           DFHEIV11,
  3757           DFHEIV12,
  3758           DFHEIV99
  3759     MOVE EIBRESP  TO WS-RESPONSE
  3760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3761     .
  3762 0010-EXIT.
  3763     EXIT.
  3764 0020-READNEXT-ERACCT.
  3765
  3766* EXEC CICS READNEXT
  3767*         INTO    (ACCOUNT-MASTER)
  3768*         DATASET ('ERACCT3')
  3769*         RIDFLD  (WS-AM-ALT-KEY)
  3770*         RESP    (WS-RESPONSE)
  3771*    END-EXEC
  3772     MOVE LENGTH OF
  3773      ACCOUNT-MASTER
  3774       TO DFHEIV12
  3775     MOVE 'ERACCT3' TO DFHEIV1
  3776     MOVE 0
  3777       TO DFHEIV11
  3778*    MOVE '&.IL                  )  N#00003724' TO DFHEIV0
  3779     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3780     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3781     MOVE X'204E233030303033373234' TO DFHEIV0(25:11)
  3782     CALL 'kxdfhei1' USING DFHEIV0,
  3783           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* SOCK00.cbl
  3784           ACCOUNT-MASTER,
  3785           DFHEIV12,
  3786           WS-AM-ALT-KEY,
  3787           DFHEIV99,
  3788           DFHEIV11,
  3789           DFHEIV99,
  3790           DFHEIV99
  3791     MOVE EIBRESP  TO WS-RESPONSE
  3792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3793     .
  3794 0020-EXIT.
  3795     EXIT.
  3796 0030-BUILD-BUFFER.
  3797     PERFORM 0100-BUILD-ERACCT-STUFF
  3798                                 THRU 0100-EXIT
  3799     MOVE SPACES                 TO WS-SEND-BUF
  3800     EVALUATE AM-STATUS
  3801        WHEN '1'
  3802           MOVE 'I'              TO WS-STATUS
  3803        WHEN '2'
  3804           MOVE 'T'              TO WS-STATUS
  3805        WHEN '3'
  3806           MOVE 'C'              TO WS-STATUS
  3807        WHEN '4'
  3808           MOVE 'I'              TO WS-STATUS
  3809        WHEN '5'
  3810           MOVE 'S'              TO WS-STATUS
  3811        WHEN OTHER
  3812           MOVE 'A'              TO WS-STATUS
  3813     END-EVALUATE
  3814     IF AM-REMIT-TO NOT NUMERIC
  3815        MOVE ZEROS         TO AM-REMIT-TO
  3816     END-IF
  3817     IF AM-REMIT-TO = ZEROS
  3818        MOVE 01        TO AM-REMIT-TO
  3819     END-IF
  3820     MOVE AM-AGT (AM-REMIT-TO) TO WS-FIN-RESP
  3821     MOVE SPACES                 TO WS-AM-CITY-STATE
  3822     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3823        DELIMITED BY '  ' INTO WS-AM-CITY-STATE
  3824     END-STRING
  3825     IF NOT GET-ACT-ACCTS
  3826* this is when a single account is selected
  3827       STRING
  3828        AM-ACCOUNT      ';'
  3829        WS-LONG-ACCT-NAME    ';'
  3830        WS-CONTR-NAME   ';'
  3831        AM-ADDRS        ';'
  3832        WS-AM-CITY-STATE ';'
  3833        AM-ZIP          ';'
  3834        AM-GPCD         ';'
  3835        WS-EFF-DATE     ';'
  3836        WS-EXP-DATE     ';'
  3837        WS-POLICY-NO    ';'
  3838        WS-SL-COMM      ';'
  3839        WS-JL-COMM      ';'
  3840        WS-SAH-COMM     ';'
  3841        WS-JAH-COMM     ';'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* SOCK00.cbl
  3842        WS-CID-NO       ';'
  3843        AM-STATE        ';'
  3844        WS-GA-NUM       ';'
  3845        WS-GA-PRIMARY-CONTACT ';'
  3846        WS-GA-NAME      ';'
  3847        WS-GA-MAIL-NAME ';'
  3848        WS-GA-ADDR1     ';'
  3849        WS-GA-ADDR2     ';'
  3850        WS-GA-ADDR3     ';'
  3851        WS-GA-ZIP       ';'
  3852        WS-GA-PHONE     ';'
  3853        AM-CONTROL-NAME ';'
  3854        WS-ORIG-EFF-DT  ';'
  3855        AM-COMMENT-LINE (1) ';'
  3856        AM-COMMENT-LINE (2) ';'
  3857        AM-COMMENT-LINE (3) ';'
  3858        AM-COMMENT-LINE (4) ';'
  3859        AM-COMMENT-LINE (5) ';'
  3860        AM-TEL-NO       ';'
  3861        AM-REPORT-CODE-1    ';'
  3862        AM-REPORT-CODE-2    ';'
  3863        WS-STATUS           ';'
  3864        AM-REPORT-CODE-3    ';'
  3865        AM-USER-SELECT-2    ';'
  3866        AM-CARRIER          ';'
  3867        WS-FIN-RESP         ';'
  3868        AM-USER-SELECT-3    ';'
  3869        WS-SHORT-ACCT-NAME  ';'
  3870           DELIMITED BY SIZE INTO WS-SEND-BUF
  3871       END-STRING
  3872     ELSE
  3873       STRING
  3874        AM-ACCOUNT      ';'
  3875        WS-LONG-ACCT-NAME    ';'
  3876        WS-CONTR-NAME   ';'
  3877        AM-ADDRS        ';'
  3878        WS-AM-CITY-STATE ';'
  3879        AM-ZIP          ';'
  3880        AM-GPCD         ';'
  3881        WS-EFF-DATE     ';'
  3882        WS-EXP-DATE     ';'
  3883        WS-POLICY-NO    ';'
  3884        WS-SL-COMM      ';'
  3885        WS-JL-COMM      ';'
  3886        WS-SAH-COMM     ';'
  3887        WS-JAH-COMM     ';'
  3888        WS-CID-NO       ';'
  3889        AM-STATE        ';'
  3890        WS-GA-NUM       ';'
  3891        WS-GA-PRIMARY-CONTACT ';'
  3892        WS-GA-NAME      ';'
  3893        WS-GA-MAIL-NAME ';'
  3894        WS-GA-ADDR1     ';'
  3895        WS-GA-ADDR2     ';'
  3896        WS-GA-ADDR3     ';'
  3897        WS-GA-ZIP       ';'
  3898        WS-GA-PHONE     ';'
  3899        AM-COMMENT-LINE (1) ';'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* SOCK00.cbl
  3900        AM-COMMENT-LINE (2) ';'
  3901        AM-COMMENT-LINE (3) ';'
  3902        AM-COMMENT-LINE (4) ';'
  3903        AM-COMMENT-LINE (5) ';'
  3904        AM-CONTROL-NAME     ';'
  3905        WS-ORIG-EFF-DT      ';'
  3906        AM-TEL-NO           ';'
  3907        AM-REPORT-CODE-1    ';'
  3908        AM-REPORT-CODE-2    ';'
  3909        WS-STATUS           ';'
  3910        AM-REPORT-CODE-3    ';'
  3911        AM-USER-SELECT-2    ';'
  3912        AM-CARRIER          ';'
  3913        WS-FIN-RESP         ';'
  3914        AM-USER-SELECT-3    ';'
  3915        WS-SHORT-ACCT-NAME  ';'
  3916           DELIMITED BY SIZE INTO WS-SEND-BUF
  3917       END-STRING
  3918     END-IF
  3919     .
  3920 0030-EXIT.
  3921     EXIT.
  3922 0100-BUILD-ERACCT-STUFF.
  3923     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
  3924     MOVE ' '                    TO DC-OPTION-CODE
  3925     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3926     IF NO-CONVERSION-ERROR
  3927        MOVE DC-GREG-DATE-A-EDIT TO WS-EFF-DATE
  3928     ELSE
  3929        MOVE '00/00/0000'        TO WS-EFF-DATE
  3930     END-IF
  3931     IF AM-EXPIRATION-DT = HIGH-VALUES
  3932        MOVE '99/99/9999'        TO WS-EXP-DATE
  3933     ELSE
  3934        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  3935        MOVE ' '                 TO DC-OPTION-CODE
  3936        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  3937        IF NO-CONVERSION-ERROR
  3938           MOVE DC-GREG-DATE-A-EDIT
  3939                                 TO WS-EXP-DATE
  3940        ELSE
  3941           MOVE '00/00/0000'     TO WS-EXP-DATE
  3942        END-IF
  3943     END-IF
  3944     MOVE WS-BIN-ORIG-EFF-DT     TO DC-BIN-DATE-1
  3945     MOVE ' '                    TO DC-OPTION-CODE
  3946     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3947     IF NO-CONVERSION-ERROR
  3948        MOVE DC-GREG-DATE-A-EDIT TO WS-ORIG-EFF-DT
  3949     ELSE
  3950        MOVE '00/00/0000'        TO WS-ORIG-EFF-DT
  3951     END-IF
  3952     MOVE AM-COMMENT-LINE (2)    TO WS-POLICY-NO
  3953     PERFORM VARYING S1 FROM +7 BY +1 UNTIL
  3954        (S1 > +48)
  3955        OR (AM-COMMENT-LINE (2) (S1:3) = 'CID')
  3956     END-PERFORM
  3957     IF S1 > +48
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* SOCK00.cbl
  3958        MOVE SPACES              TO WS-CID-NO
  3959     ELSE
  3960        MOVE AM-COMMENT-LINE (2) (S1:8)
  3961                                 TO WS-CID-NO
  3962     END-IF
  3963     MOVE AM-NAME                TO WS-SHORT-ACCT-NAME
  3964                                    WS-LONG-ACCT-NAME
  3965     MOVE AM-PERSON              TO WS-CONTR-NAME
  3966*    IF AM-REPORT-CODE-3 = 'RLIC'
  3967        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  3968        MOVE '3'                 TO WS-NT-REC-TYPE
  3969        MOVE +1                  TO WS-NT-SEQ-NO
  3970
  3971* EXEC CICS READ
  3972*          DATASET    ('ERACNT')
  3973*          RIDFLD     (WS-NT-KEY)
  3974*          INTO       (NOTE-FILE)
  3975*          RESP       (WS-RESPONSE)
  3976*       END-EXEC
  3977     MOVE LENGTH OF
  3978      NOTE-FILE
  3979       TO DFHEIV11
  3980     MOVE 'ERACNT' TO DFHEIV1
  3981*    MOVE '&"IL       E          (  N#00003907' TO DFHEIV0
  3982     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3984     MOVE X'204E233030303033393037' TO DFHEIV0(25:11)
  3985     CALL 'kxdfhei1' USING DFHEIV0,
  3986           DFHEIV1,
  3987           NOTE-FILE,
  3988           DFHEIV11,
  3989           WS-NT-KEY,
  3990           DFHEIV99,
  3991           DFHEIV99,
  3992           DFHEIV99
  3993     MOVE EIBRESP  TO WS-RESPONSE
  3994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3995        IF RESP-NORMAL
  3996           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  3997              MOVE NT-SHIPPING-LINE TO WS-LONG-ACCT-NAME
  3998           END-IF
  3999        END-IF
  4000        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  4001        MOVE '3'                 TO WS-NT-REC-TYPE
  4002        MOVE +2                  TO WS-NT-SEQ-NO
  4003
  4004* EXEC CICS READ
  4005*          DATASET    ('ERACNT')
  4006*          RIDFLD     (WS-NT-KEY)
  4007*          INTO       (NOTE-FILE)
  4008*          RESP       (WS-RESPONSE)
  4009*       END-EXEC
  4010     MOVE LENGTH OF
  4011      NOTE-FILE
  4012       TO DFHEIV11
  4013     MOVE 'ERACNT' TO DFHEIV1
  4014*    MOVE '&"IL       E          (  N#00003921' TO DFHEIV0
  4015     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* SOCK00.cbl
  4016     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4017     MOVE X'204E233030303033393231' TO DFHEIV0(25:11)
  4018     CALL 'kxdfhei1' USING DFHEIV0,
  4019           DFHEIV1,
  4020           NOTE-FILE,
  4021           DFHEIV11,
  4022           WS-NT-KEY,
  4023           DFHEIV99,
  4024           DFHEIV99,
  4025           DFHEIV99
  4026     MOVE EIBRESP  TO WS-RESPONSE
  4027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4028        IF RESP-NORMAL
  4029           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4030              MOVE NT-SHIPPING-LINE TO WS-CONTR-NAME
  4031           END-IF
  4032        END-IF
  4033*    END-IF
  4034     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4035        (S1 > +10)
  4036        OR (AM-COM-TYP (S1) = 'D' OR 'C')
  4037     END-PERFORM
  4038     IF S1 > +10
  4039        CONTINUE
  4040     ELSE
  4041        PERFORM 0150-BUILD-DW-COMM
  4042                                 THRU 0150-EXIT
  4043     END-IF
  4044     MOVE SPACES                 TO WS-GA-DATA
  4045     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4046        (S1 > +10)
  4047        OR (AM-COM-TYP (S1) = 'O' OR 'P' OR 'K' OR 'S')
  4048     END-PERFORM
  4049     IF S1 > +10
  4050        MOVE ZEROS               TO WS-GA-NUM
  4051     ELSE
  4052        MOVE AM-AGT (S1)         TO WS-GA-NUM
  4053     END-IF
  4054     IF WS-GA-NUM NOT = ZEROS
  4055        PERFORM 0200-GET-ERCOMP  THRU 0200-EXIT
  4056     END-IF
  4057     .
  4058 0100-EXIT.
  4059     EXIT.
  4060 0150-BUILD-DW-COMM.
  4061     MOVE ZEROS                  TO WS-SL-COMM
  4062                                    WS-JL-COMM
  4063                                    WS-SAH-COMM
  4064                                    WS-JAH-COMM
  4065                                    WS-WORK-SAH-COMM
  4066                                    WS-WORK-JAH-COMM
  4067     IF (AM-L-COM (S1) NOT NUMERIC)
  4068        OR (AM-L-COMA (S1) (3:1) = 'L' OR 'M')
  4069        CONTINUE
  4070     ELSE
  4071        MOVE AM-L-COM (S1)       TO WS-SL-COMM
  4072     END-IF
  4073     IF (AM-J-COM (S1) NOT NUMERIC)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* SOCK00.cbl
  4074        OR (AM-J-COMA (S1) (3:1) = 'L' OR 'M')
  4075        CONTINUE
  4076     ELSE
  4077        MOVE AM-J-COM (S1)       TO WS-JL-COMM
  4078     END-IF
  4079     IF (AM-A-COM (S1) NOT NUMERIC)
  4080        OR (AM-A-COMA (S1) (3:1) = 'L' OR 'M')
  4081        PERFORM 0160-ERCTBL-STARTBR
  4082                                 THRU 0160-EXIT
  4083        IF RESP-NORMAL
  4084           PERFORM 0165-ERCTBL-READNEXT
  4085                                 THRU 0165-EXIT
  4086           UNTIL
  4087           ((WS-WORK-SAH-COMM NOT = ZEROS)
  4088            AND (WS-WORK-JAH-COMM NOT = ZEROS))
  4089                       OR
  4090            END-OF-ERCTBL
  4091            MOVE WS-WORK-JAH-COMM TO WS-JAH-COMM
  4092            MOVE WS-WORK-SAH-COMM TO WS-SAH-COMM
  4093        END-IF
  4094     ELSE
  4095        MOVE AM-A-COM (S1)       TO WS-SAH-COMM
  4096                                    WS-JAH-COMM
  4097     END-IF
  4098     .
  4099 0150-EXIT.
  4100     EXIT.
  4101 0160-ERCTBL-STARTBR.
  4102     MOVE AM-COMPANY-CD          TO WS-CT-COMPANY-CD
  4103     MOVE AM-A-COMA (S1)         TO WS-CT-TABLE
  4104     MOVE 'A'                    TO WS-CT-BEN-TYPE
  4105     MOVE LOW-VALUES             TO WS-CT-BEN-CODE
  4106     MOVE WS-CT-KEY              TO WS-CT-KEY-SAVE
  4107
  4108* EXEC CICS STARTBR
  4109*         DATASET    ('ERCTBL')
  4110*         RIDFLD     (WS-CT-KEY)
  4111*         GTEQ
  4112*         RESP       (WS-RESPONSE)
  4113*    END-EXEC
  4114     MOVE 'ERCTBL' TO DFHEIV1
  4115     MOVE 0
  4116       TO DFHEIV11
  4117*    MOVE '&,         G          &  N#00004006' TO DFHEIV0
  4118     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4120     MOVE X'204E233030303034303036' TO DFHEIV0(25:11)
  4121     CALL 'kxdfhei1' USING DFHEIV0,
  4122           DFHEIV1,
  4123           WS-CT-KEY,
  4124           DFHEIV99,
  4125           DFHEIV11,
  4126           DFHEIV99
  4127     MOVE EIBRESP  TO WS-RESPONSE
  4128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4129     .
  4130 0160-EXIT.
  4131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* SOCK00.cbl
  4132 0165-ERCTBL-READNEXT.
  4133
  4134* EXEC CICS READNEXT
  4135*         INTO    (COMM-TABLE-RECORD)
  4136*         DATASET ('ERCTBL')
  4137*         RIDFLD  (WS-CT-KEY)
  4138*         RESP    (WS-RESPONSE)
  4139*    END-EXEC
  4140     MOVE LENGTH OF
  4141      COMM-TABLE-RECORD
  4142       TO DFHEIV12
  4143     MOVE 'ERCTBL' TO DFHEIV1
  4144     MOVE 0
  4145       TO DFHEIV11
  4146*    MOVE '&.IL                  )  N#00004016' TO DFHEIV0
  4147     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4148     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4149     MOVE X'204E233030303034303136' TO DFHEIV0(25:11)
  4150     CALL 'kxdfhei1' USING DFHEIV0,
  4151           DFHEIV1,
  4152           COMM-TABLE-RECORD,
  4153           DFHEIV12,
  4154           WS-CT-KEY,
  4155           DFHEIV99,
  4156           DFHEIV11,
  4157           DFHEIV99,
  4158           DFHEIV99
  4159     MOVE EIBRESP  TO WS-RESPONSE
  4160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4161     IF (RESP-NORMAL)
  4162        AND (WS-CT-KEY (1:5) = WS-CT-KEY-SAVE (1:5))
  4163        PERFORM 0170-PROCESS-BEN-CODE
  4164                                 THRU 0170-EXIT
  4165     ELSE
  4166        SET END-OF-ERCTBL        TO TRUE
  4167     END-IF
  4168     .
  4169 0165-EXIT.
  4170     EXIT.
  4171 0170-PROCESS-BEN-CODE.
  4172     MOVE SPACES                 TO WS-CF-KEY
  4173     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4174     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4175     MOVE CT-BEN-CODE            TO WS-CF-ACCESS (3:2)
  4176     MOVE +0                     TO WS-CF-SEQ-NO
  4177     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
  4178
  4179* EXEC CICS READ
  4180*         DATASET    ('ELCNTL')
  4181*         RIDFLD     (WS-CF-KEY)
  4182*         INTO       (CONTROL-FILE)
  4183*         GTEQ
  4184*         RESP       (WS-RESPONSE)
  4185*    END-EXEC
  4186     MOVE LENGTH OF
  4187      CONTROL-FILE
  4188       TO DFHEIV11
  4189     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* SOCK00.cbl
  4190*    MOVE '&"IL       G          (  N#00004039' TO DFHEIV0
  4191     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4192     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4193     MOVE X'204E233030303034303339' TO DFHEIV0(25:11)
  4194     CALL 'kxdfhei1' USING DFHEIV0,
  4195           DFHEIV1,
  4196           CONTROL-FILE,
  4197           DFHEIV11,
  4198           WS-CF-KEY,
  4199           DFHEIV99,
  4200           DFHEIV99,
  4201           DFHEIV99
  4202     MOVE EIBRESP  TO WS-RESPONSE
  4203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4204     IF NOT RESP-NORMAL
  4205        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4206        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4207        GO TO 0170-EXIT
  4208     END-IF
  4209     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4210        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4211           (S2 > +8)
  4212           OR (CT-BEN-CODE = CF-BENEFIT-CODE (S2))
  4213        END-PERFORM
  4214        IF CT-BEN-CODE = CF-BENEFIT-CODE (S2)
  4215           IF CF-JOINT-INDICATOR (S2) = 'J'
  4216              IF WS-WORK-JAH-COMM = ZEROS
  4217                 MOVE CT-RT (1)  TO WS-WORK-JAH-COMM
  4218              END-IF
  4219           ELSE
  4220              IF WS-WORK-SAH-COMM = ZEROS
  4221                 MOVE CT-RT (1)  TO WS-WORK-SAH-COMM
  4222              END-IF
  4223           END-IF
  4224        END-IF
  4225     END-IF
  4226     .
  4227 0170-EXIT.
  4228     EXIT.
  4229 0200-GET-ERCOMP.
  4230     MOVE LOW-VALUES             TO WS-CO-KEY
  4231     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  4232     MOVE AM-CARRIER             TO WS-CO-CARRIER
  4233     MOVE AM-GROUPING            TO WS-CO-GROUP
  4234     MOVE WS-GA-NUM              TO WS-CO-FIN-RESP
  4235     MOVE LOW-VALUES             TO WS-CO-ACCOUNT
  4236     MOVE 'G'                    TO WS-CO-TYPE
  4237
  4238* EXEC CICS READ
  4239*         INTO    (COMPENSATION-MASTER)
  4240*         DATASET ('ERCOMP')
  4241*         RIDFLD  (WS-CO-KEY)
  4242*         RESP    (WS-RESPONSE)
  4243*    END-EXEC
  4244     MOVE LENGTH OF
  4245      COMPENSATION-MASTER
  4246       TO DFHEIV11
  4247     MOVE 'ERCOMP' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* SOCK00.cbl
  4248*    MOVE '&"IL       E          (  N#00004079' TO DFHEIV0
  4249     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4251     MOVE X'204E233030303034303739' TO DFHEIV0(25:11)
  4252     CALL 'kxdfhei1' USING DFHEIV0,
  4253           DFHEIV1,
  4254           COMPENSATION-MASTER,
  4255           DFHEIV11,
  4256           WS-CO-KEY,
  4257           DFHEIV99,
  4258           DFHEIV99,
  4259           DFHEIV99
  4260     MOVE EIBRESP  TO WS-RESPONSE
  4261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4262     IF RESP-NORMAL
  4263        MOVE CO-CONTROL-NAME     TO WS-GA-PRIMARY-CONTACT
  4264        MOVE CO-ACCT-NAME        TO WS-GA-NAME
  4265        MOVE CO-MAIL-NAME        TO WS-GA-MAIL-NAME
  4266        MOVE CO-ADDR-1           TO WS-GA-ADDR1
  4267        MOVE CO-ADDR-2           TO WS-GA-ADDR2
  4268*       MOVE CO-ADDR-3           TO WS-GA-ADDR3
  4269        MOVE SPACES              TO WS-GA-ADDR3
  4270        STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  4271           DELIMITED BY '  ' INTO WS-GA-ADDR3
  4272        END-STRING
  4273        MOVE CO-ZIP              TO WS-GA-ZIP
  4274        MOVE CO-TELEPHONE        TO WS-GA-PHONE
  4275     ELSE
  4276        MOVE SPACES              TO WS-GA-DATA
  4277        MOVE 'GA NOT FOUND '     TO WS-GA-NAME
  4278     END-IF
  4279     .
  4280 0200-EXIT.
  4281     EXIT.
  4282 0300-get-rates.
  4283     move +30                    to ws-send-msg-size
  4284     move ws-recv-buf (1:31)     to ws-get-rate-data
  4285     if rate-apr not numeric
  4286        move zeros               to rate-apr
  4287     end-if
  4288     move rate-apr               to ws-work-apr
  4289     if rate-ben-amt not numeric
  4290        move zeros               to rate-ben-amt
  4291     end-if
  4292     move rate-ben-amt           to ws-work-ben
  4293     if rate-term not numeric
  4294        move zeros               to rate-term
  4295     end-if
  4296     move rate-term              to ws-work-term
  4297     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4298     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4299     move rate-eff-date (4:2)    to ws-work-date (7:2)
  4300     move ws-work-date-num       to dc-greg-date-cymd
  4301     move 'L'                    to dc-option-code
  4302     perform 9700-date-link      thru 9700-exit
  4303     if no-conversion-error
  4304        move dc-bin-date-1       to ws-bin-eff-dt
  4305     else
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* SOCK00.cbl
  4306        move 'bad eff dt convert ' to ws-send-buf
  4307        go to send-rate-buf
  4308     end-if
  4309     move +1                     to dc-elapsed-months
  4310     move +0                     to dc-elapsed-days
  4311     move '6'                    to dc-option-code
  4312     perform 9700-date-link      thru 9700-exit
  4313     if no-conversion-error
  4314        move dc-bin-date-2       to ws-bin-1st-pay-dt
  4315     else
  4316        move 'bad 1st dt convert ' to ws-send-buf
  4317        go to send-rate-buf
  4318     end-if
  4319*    move spaces                 to calculation-pass-area
  4320     move zeros                  to cp-r-max-mon-ben
  4321                                    cp-r-max-tot-ben
  4322                                    cp-class-code
  4323                                    cp-deviation-code
  4324                                    cp-rate-dev-pct
  4325                                    cp-original-premium
  4326                                    cp-critical-months
  4327                                    cp-term-or-ext-days
  4328     move rate-state             to cp-state
  4329                                    cp-state-std-abbrv
  4330     move rate-lf-ah             to cp-benefit-type
  4331     move rate-ben-code          to cp-benefit-cd
  4332     move ws-ben-num             to cp-original-benefit
  4333                                    cp-rating-benefit-amt
  4334     move 40                     to cp-issue-age
  4335     move WS-COMP-ID             to cp-company-id
  4336     move WS-COMP-CD             to cp-company-cd
  4337     move ws-apr-num             to cp-loan-apr
  4338     move ws-term-num            to cp-original-term
  4339                                    cp-loan-term
  4340                                    cp-remaining-term
  4341     move 'L'                    to cp-life-override-code
  4342     move 'A'                    to cp-ah-override-code
  4343     move '3'                    to cp-process-type
  4344     move rate-earn-meth         to cp-earning-method
  4345                                    cp-rating-method
  4346     move 'R'                    to cp-rate-file
  4347     move ws-bin-eff-dt          to cp-cert-eff-dt
  4348     move ws-bin-1st-pay-dt      to cp-first-pay-date
  4349     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4350     if not no-cp-error
  4351        move cp-return-code      to ws-send-buf
  4352     else
  4353        move cp-calc-premium     to ws-disp-amt
  4354        move cp-premium-rate     to ws-disp-rate
  4355        string ws-disp-amt ';' ws-disp-rate delimited
  4356           by size into ws-send-buf
  4357        end-string
  4358     end-if
  4359     .
  4360 SEND-RATE-BUF.
  4361     display 'SOCK00:About to send      '
  4362     display 'SOCK00:sequence number  =', ws-seq-num.
  4363     display 'SOCK00:send buffer      =', ws-send-buf(1:30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* SOCK00.cbl
  4364     call "send" using by value GIVE-TAKE-SOCKET,
  4365         by reference ws-send-buf,
  4366         by value ws-send-msg-size,
  4367         by value ws-flags.
  4368     if return-code <= zero
  4369         display 'SOCK00:send error ',
  4370         go to socket-error.
  4371     GO TO SOCKET-FIN
  4372     .
  4373 0300-exit.
  4374     exit.
  4375 0400-GET-ACT-ACCTS.
  4376     MOVE WS-RECV-BUF (1:2)      TO CLIENT-ST
  4377     MOVE ' '                    TO WS-BUILD-SW
  4378     MOVE LOW-VALUES             TO WS-AM-KEY
  4379     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4380     PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4381     IF NOT RESP-NORMAL
  4382        MOVE 'BAD STARTBR ON ERACCT  '
  4383                                 TO WS-SEND-BUF
  4384        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4385        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4386        GO TO SEND-BUFFER
  4387     END-IF
  4388     PERFORM 0420-READNEXT-ERACCT
  4389                                 THRU 0420-EXIT
  4390     IF NOT RESP-NORMAL
  4391        MOVE 'BAD READNEXT ON ERACCT '
  4392                                 TO WS-SEND-BUF
  4393        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4394        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4395        GO TO SEND-BUFFER
  4396     ELSE
  4397        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4398        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4399     END-IF
  4400     PERFORM UNTIL END-OF-ERACCT
  4401        IF NOT (RESP-NORMAL)
  4402           OR (AM-COMPANY-CD > WS-COMP-CD)
  4403           SET END-OF-ERACCT     TO TRUE
  4404        ELSE
  4405           IF AM-ACCOUNT NOT = WS-SAVE-ACCOUNT
  4406              MOVE AM-EFFECTIVE-DT TO WS-BIN-ORIG-EFF-DT
  4407           END-IF
  4408           IF (AM-STATE = CLIENT-ST)
  4409              AND (AM-EXPIRATION-DT = HIGH-VALUES)
  4410*             AND (AM-STATUS = '0')
  4411              PERFORM 0030-BUILD-BUFFER
  4412                                 THRU 0030-EXIT
  4413              PERFORM 0430-SEND-BUFFER
  4414                                 THRU 0430-EXIT
  4415           END-IF
  4416           PERFORM 0420-READNEXT-ERACCT
  4417                                 THRU 0420-EXIT
  4418        END-IF
  4419     END-PERFORM
  4420     GO TO SOCKET-FIN
  4421     .
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* SOCK00.cbl
  4422 0400-EXIT.
  4423     EXIT.
  4424 0410-STARTBR-ERACCT.
  4425
  4426* EXEC CICS STARTBR
  4427*         DATASET    ('ERACCT')
  4428*         RIDFLD     (WS-AM-KEY)
  4429*         GTEQ
  4430*         RESP       (WS-RESPONSE)
  4431*    END-EXEC
  4432     MOVE 'ERACCT' TO DFHEIV1
  4433     MOVE 0
  4434       TO DFHEIV11
  4435*    MOVE '&,         G          &  N#00004248' TO DFHEIV0
  4436     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4438     MOVE X'204E233030303034323438' TO DFHEIV0(25:11)
  4439     CALL 'kxdfhei1' USING DFHEIV0,
  4440           DFHEIV1,
  4441           WS-AM-KEY,
  4442           DFHEIV99,
  4443           DFHEIV11,
  4444           DFHEIV99
  4445     MOVE EIBRESP  TO WS-RESPONSE
  4446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4447     .
  4448 0410-EXIT.
  4449     EXIT.
  4450 0420-READNEXT-ERACCT.
  4451
  4452* EXEC CICS READNEXT
  4453*         INTO    (ACCOUNT-MASTER)
  4454*         DATASET ('ERACCT')
  4455*         RIDFLD  (WS-AM-KEY)
  4456*         RESP    (WS-RESPONSE)
  4457*    END-EXEC
  4458     MOVE LENGTH OF
  4459      ACCOUNT-MASTER
  4460       TO DFHEIV12
  4461     MOVE 'ERACCT' TO DFHEIV1
  4462     MOVE 0
  4463       TO DFHEIV11
  4464*    MOVE '&.IL                  )  N#00004258' TO DFHEIV0
  4465     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4466     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4467     MOVE X'204E233030303034323538' TO DFHEIV0(25:11)
  4468     CALL 'kxdfhei1' USING DFHEIV0,
  4469           DFHEIV1,
  4470           ACCOUNT-MASTER,
  4471           DFHEIV12,
  4472           WS-AM-KEY,
  4473           DFHEIV99,
  4474           DFHEIV11,
  4475           DFHEIV99,
  4476           DFHEIV99
  4477     MOVE EIBRESP  TO WS-RESPONSE
  4478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4479     .
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* SOCK00.cbl
  4480 0420-EXIT.
  4481     EXIT.
  4482 0430-SEND-BUFFER.
  4483     display 'SOCK00:About to send      '
  4484     display 'SOCK00:sequence number  =', ws-seq-num.
  4485     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  4486     call "send" using by value GIVE-TAKE-SOCKET,
  4487         by reference ws-send-buf,
  4488         by value ws-send-msg-size,
  4489         by value ws-flags.
  4490     if return-code <= zero
  4491         display 'SOCK00:send error ',
  4492         go to socket-error.
  4493     .
  4494 0430-EXIT.
  4495     EXIT.
  4496 0500-GET-ONE-ACCT.
  4497     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4498     MOVE CLIENT-CAR             TO WS-AM-CARRIER
  4499     MOVE CLIENT-GRP             TO WS-AM-GROUP
  4500     MOVE CLIENT-ST              TO WS-AM-STATE
  4501     MOVE CLIENT-ACT             TO WS-AM-ACCOUNT
  4502     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4503     MOVE '5'                    TO DC-OPTION-CODE
  4504     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4505     MOVE DC-BIN-DATE-1          TO WS-AM-EXP-DT
  4506     MOVE LOW-VALUES             TO WS-AM-EXP-DT
  4507     MOVE ' '                    TO WS-BUILD-SW
  4508    PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4509     IF NOT RESP-NORMAL
  4510        MOVE 'BAD STARTBR ON ERACCT  '
  4511                                 TO WS-SEND-BUF
  4512        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4513        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4514        GO TO SEND-BUFFER
  4515     END-IF
  4516     PERFORM 0420-READNEXT-ERACCT
  4517                                 THRU 0420-EXIT
  4518     IF NOT RESP-NORMAL
  4519        MOVE 'BAD READNEXT ON ERACCT '
  4520                                 TO WS-SEND-BUF
  4521        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4522        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4523        GO TO SEND-BUFFER
  4524     ELSE
  4525        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4526        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4527     END-IF
  4528     PERFORM UNTIL
  4529        (TIME-TO-BUILD)
  4530        IF AM-ACCOUNT = CLIENT-ACT
  4531           IF AM-EXPIRATION-DT = HIGH-VALUES
  4532              SET TIME-TO-BUILD  TO TRUE
  4533           ELSE
  4534              MOVE ACCOUNT-MASTER
  4535                                 TO WS-SAVE-ERACCT
  4536              PERFORM 0420-READNEXT-ERACCT
  4537                                 THRU 0420-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* SOCK00.cbl
  4538              IF NOT RESP-NORMAL
  4539                 MOVE WS-SAVE-ERACCT
  4540                                 TO ACCOUNT-MASTER
  4541                 SET TIME-TO-BUILD
  4542                                 TO TRUE
  4543              END-IF
  4544           END-IF
  4545        ELSE
  4546           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  4547           SET TIME-TO-BUILD     TO TRUE
  4548        END-IF
  4549     END-PERFORM
  4550     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4551     PERFORM 0430-SEND-BUFFER    THRU 0430-EXIT
  4552     GO TO SOCKET-FIN
  4553     .
  4554 0500-EXIT.
  4555     EXIT.
  4556 7000-GET-RATE.
  4557
  4558* EXEC CICS LINK
  4559*       PROGRAM ('ELRATE')
  4560*       COMMAREA (CALCULATION-PASS-AREA)
  4561*       LENGTH   (CP-COMM-LENGTH)
  4562*    END-EXEC
  4563     MOVE 'ELRATE' TO DFHEIV1
  4564*    MOVE '."C                   (   #00004342' TO DFHEIV0
  4565     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4567     MOVE X'2020233030303034333432' TO DFHEIV0(25:11)
  4568     CALL 'kxdfhei1' USING DFHEIV0,
  4569           DFHEIV1,
  4570           CALCULATION-PASS-AREA,
  4571           CP-COMM-LENGTH,
  4572           DFHEIV99,
  4573           DFHEIV99,
  4574           DFHEIV99,
  4575           DFHEIV99
  4576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4577     .
  4578 7000-EXIT.
  4579     EXIT.
  4580 9700-DATE-LINK.
  4581
  4582* EXEC CICS LINK
  4583*         PROGRAM  ('ELDATCV')
  4584*         COMMAREA (DATE-CONVERSION-DATA)
  4585*         LENGTH   (DC-COMM-LENGTH)
  4586*    END-EXEC.
  4587     MOVE 'ELDATCV' TO DFHEIV1
  4588*    MOVE '."C                   (   #00004351' TO DFHEIV0
  4589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4591     MOVE X'2020233030303034333531' TO DFHEIV0(25:11)
  4592     CALL 'kxdfhei1' USING DFHEIV0,
  4593           DFHEIV1,
  4594           DATE-CONVERSION-DATA,
  4595           DC-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* SOCK00.cbl
  4596           DFHEIV99,
  4597           DFHEIV99,
  4598           DFHEIV99,
  4599           DFHEIV99
  4600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4601
  4602 9700-EXIT.
  4603      EXIT.
  4604
  4605 9999-DFHBACK SECTION.
  4606     MOVE '9%                    "   ' TO DFHEIV0
  4607     MOVE 'SOCK00' TO DFHEIV1
  4608     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4609     GOBACK.
  4610 9999-DFHEXIT.
  4611     IF DFHEIGDJ EQUAL 0001
  4612         NEXT SENTENCE.
  4613     MOVE '9%                    "   ' TO DFHEIV0
  4614     MOVE 'SOCK00' TO DFHEIV1
  4615     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4616     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16548     Code:        8757
