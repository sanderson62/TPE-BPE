* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL614.cbl
* Options: int("EL614.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL614.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL614.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL614.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL614 .
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.    PABLO.
     7*           COLLEYVILLE TX.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL614.cbl
    14*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.
    19*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    20*    FOR THE  EOB   CODES IN THE CLAIM SYSTEM.
    21*
    22*    SCREENS     - EL614A - EOB CODE MAINTENANCE
    23*
    24*    ENTERED BY  - EL101 - SYSTEM ADMINISTRATION MENU
    25*                  EL156 - PAYMENT WORKSHEET
    26*                  EL6317 - CERTIFICATE VERIFICATION
    27*    EXIT TO     - EL101 - SYSTEM ADMINISTRATION MENU
    28*                  EL156 - PAYMENT WORKSHEET
    29*                  EL6317 - CERTIFICATE VERIFICATION
    30*    COMMAREA    - PASSED
    31*
    32*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    33*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    34*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    35*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    36*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    37*                  MAINTENANCE TYPE INDICATED.
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 083110    2009122800001  PEMA  NEW PROGRAM
    47* 011811    2009122800001  AJRA  FIX SELECTION
    48* 042211    2011040600001  PEMA  FIX ISSUE NO RECORDS FOUND
    49* 081511    2011022800001  PEMA  ADMIN SERV NAPERSOFT CHANGES
    50******************************************************************
    51 ENVIRONMENT DIVISION.
    52 DATA DIVISION.
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55 77  FILLER  PIC X(32)  VALUE '********************************'.
    56 77  FILLER  PIC X(32)  VALUE '*   EL614  WORKING STORAGE     *'.
    57 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    58 77  CI1                PIC S999  COMP-3 VALUE +0.
    59 77  B1                 PIC S999  COMP-3 VALUE +0.
    60 77  S1                 PIC S999  COMP-3 VALUE +0.
    61 77  E1                 PIC S999  COMP-3 VALUE +0.
    62 77  WS-DUP-EOB-SW      PIC X VALUE ' '.
    63     88  FOUND-DUP-EOB     VALUE 'Y'.
    64*    COPY ELCSCTM.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCTM                             *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL614.cbl
    72*                                                                *
    73******************************************************************
    74 01  SECURITY-MESSAGE.
    75     12  FILLER                          PIC X(30)
    76            VALUE '** LOGIC SECURITY VIOLATION -'.
    77     12  SM-READ                         PIC X(6).
    78     12  FILLER                          PIC X(5)
    79            VALUE ' PGM='.
    80     12  SM-PGM                          PIC X(6).
    81     12  FILLER                          PIC X(5)
    82            VALUE ' OPR='.
    83     12  SM-PROCESSOR-ID                 PIC X(4).
    84     12  FILLER                          PIC X(6)
    85            VALUE ' TERM='.
    86     12  SM-TERMID                       PIC X(4).
    87     12  FILLER                          PIC XX   VALUE SPACE.
    88     12  SM-JUL-DATE                     PIC 9(5).
    89     12  FILLER                          PIC X    VALUE SPACE.
    90     12  SM-TIME                         PIC 99.99.
    91
    92*    COPY ELCSCRTY.
    93******************************************************************
    94*                                                                *
    95*                                                                *
    96*                            ELCSCRTY                            *
    97*                            VMOD=2.001                          *
    98*                                                                *
    99*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   100*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   101*        SAVED IN PI-SECURITY-ADDRESS.                           *
   102*                                                                *
   103******************************************************************
   104 01  SECURITY-CONTROL.
   105     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   106     12  FILLER                       PIC XX    VALUE 'SC'.
   107     12  SC-CREDIT-CODES.
   108         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   109             20  SC-CREDIT-DISPLAY    PIC X.
   110             20  SC-CREDIT-UPDATE     PIC X.
   111     12  SC-CLAIMS-CODES.
   112         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   113             20  SC-CLAIMS-DISPLAY    PIC X.
   114             20  SC-CLAIMS-UPDATE     PIC X.
   115 01  WS-PASSED-FROM-CALL-PGM     PIC X(60)  VALUE SPACES.
   116 01  WS-DATE-AREA.
   117     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   118    05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   119 01  WS-SELECTED-EOB-CODES.
   120     05  WS-SELECTED-CODES OCCURS 12.
   121         10  WS-SEL-EOB-CODE PIC XXXX.
   122         10  FILLER          PIC X.
   123 01  FILLER                          COMP-3.
   124     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   125     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   126     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   127     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   128     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   129       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL614.cbl
   130       88  INITIAL-TRANSACTION                       VALUE +2.
   131       88  CHANGE-SUCCESSFUL                         VALUE +3.
   132     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   133     05  TIME-OUT                    REDEFINES
   134         TIME-IN                     PIC S9(3)V9(4).
   135 01  FILLER                          COMP SYNC.
   136     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   137     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   138     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   139     05  ELEOBC-LENGTH               PIC S9(4)   VALUE +350.
   140     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   141 01  FILLER.
   142     05  SC-ITEM             PIC S9(4) COMP VALUE +1.
   143     05  DEEDIT-FIELD        PIC  X(10).
   144     05  DEEDIT-FIELD-V0  REDEFINES
   145         DEEDIT-FIELD        PIC S9(10).
   146     05  WS-RESPONSE             PIC S9(8)   COMP.
   147         88  RESP-NORMAL              VALUE +00.
   148         88  RESP-ERROR               VALUE +01.
   149         88  RESP-NOTFND              VALUE +13.
   150         88  RESP-NOTOPEN             VALUE +19.
   151         88  RESP-ENDFILE             VALUE +20.
   152     05  WS-ELEOBC-KEY.
   153         10  WS-COMPANY-CD           PIC X      VALUE LOW-VALUES.
   154         10  WS-EOB-REC-TYPE         PIC X      VALUE LOW-VALUES.
   155         10  WS-EOB-CODE             PIC X(4)   VALUE LOW-VALUES.
   156         10  FILLER                  PIC X(9)   VALUE LOW-VALUES.
   157     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL614S'.
   158     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL614A'.
   159     05  FILLER                      REDEFINES
   160         WS-MAP-NAME.
   161         10  FILLER                  PIC XX.
   162         10  WS-MAP-NUMBER           PIC X(4).
   163         10  FILLER                  PIC XX.
   164     05  THIS-PGM                    PIC X(8)  VALUE 'EL614'.
   165     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   166     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   167     05  WS-SPACE                    PIC X       VALUE SPACE.
   168     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAI'.
   169     05  WS-TEMP-STORAGE-KEY.
   170         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   171         10  FILLER                  PIC X(4)    VALUE '614'.
   172     05  WS-ERROR-MESSAGE-AREA.
   173         10  ER-0000                 PIC 9(4)   VALUE 0000.
   174         10  ER-0004                 PIC 9(4)   VALUE 0004.
   175         10  ER-0006                 PIC 9(4)   VALUE 0006.
   176         10  ER-0008                 PIC 9(4)   VALUE 0008.
   177         10  ER-0023                 PIC 9(4)   VALUE 0023.
   178         10  ER-0029                 PIC 9(4)   VALUE 0029.
   179         10  ER-0070                 PIC 9(4)   VALUE 0070.
   180         10  ER-0150                 PIC 9(4)   VALUE 0150.
   181         10  ER-0491                 PIC 9(4)   VALUE 0491.
   182         10  ER-1079                 PIC 9(4)   VALUE 1079.
   183         10  ER-1257                 PIC 9(4)   VALUE 1257.
   184         10  ER-1258                 PIC 9(4)   VALUE 1258.
   185         10  ER-2261                 PIC 9(4)   VALUE 2261.
   186         10  ER-3800                 PIC 9(4)   VALUE 3800.
   187         10  ER-3801                 PIC 9(4)   VALUE 3801.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL614.cbl
   188         10  ER-3802                 PIC 9(4)   VALUE 3802.
   189         10  ER-3803                 PIC 9(4)   VALUE 3803.
   190         10  ER-3804                 PIC 9(4)   VALUE 3804.
   191         10  ER-3805                 PIC 9(4)   VALUE 3805.
   192         10  ER-3806                 PIC 9(4)   VALUE 3806.
   193         10  ER-3807                 PIC 9(4)   VALUE 3807.
   194         10  ER-3840                 PIC 9(4)   VALUE 3840.
   195         10  ER-3841                 PIC 9(4)   VALUE 3841.
   196         10  ER-3842                 PIC 9(4)   VALUE 3842.
   197         10  ER-7220                 PIC 9(4)   VALUE 7220.
   198         10  ER-7698                 PIC 9(4)   VALUE 7698.
   199         10  ER-9999                 PIC 9(4)   VALUE 9999.
   200*    COPY ELCINTF.
   201******************************************************************
   202*                                                                *
   203*                                                                *
   204*                            ELCINTF.                            *
   205*                            VMOD=2.017                          *
   206*                                                                *
   207*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   208*                                                                *
   209*       LENGTH = 1024                                            *
   210*                                                                *
   211******************************************************************
   212*                   C H A N G E   L O G
   213*
   214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   215*-----------------------------------------------------------------
   216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   217* EFFECTIVE    NUMBER
   218*-----------------------------------------------------------------
   219* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   220******************************************************************
   221 01  PROGRAM-INTERFACE-BLOCK.
   222     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   223     12  PI-CALLING-PROGRAM              PIC X(8).
   224     12  PI-SAVED-PROGRAM-1              PIC X(8).
   225     12  PI-SAVED-PROGRAM-2              PIC X(8).
   226     12  PI-SAVED-PROGRAM-3              PIC X(8).
   227     12  PI-SAVED-PROGRAM-4              PIC X(8).
   228     12  PI-SAVED-PROGRAM-5              PIC X(8).
   229     12  PI-SAVED-PROGRAM-6              PIC X(8).
   230     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   231     12  PI-COMPANY-ID                   PIC XXX.
   232     12  PI-COMPANY-CD                   PIC X.
   233
   234     12  PI-COMPANY-PASSWORD             PIC X(8).
   235
   236     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   237
   238     12  PI-CONTROL-IN-PROGRESS.
   239         16  PI-CARRIER                  PIC X.
   240         16  PI-GROUPING                 PIC X(6).
   241         16  PI-STATE                    PIC XX.
   242         16  PI-ACCOUNT                  PIC X(10).
   243         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   244                                         PIC X(10).
   245         16  PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL614.cbl
   246             20  PI-CLAIM-NO             PIC X(7).
   247             20  PI-CERT-NO.
   248                 25  PI-CERT-PRIME       PIC X(10).
   249                 25  PI-CERT-SFX         PIC X.
   250             20  PI-CERT-EFF-DT          PIC XX.
   251         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   252             20  PI-PLAN-CODE            PIC X(2).
   253             20  PI-REVISION-NUMBER      PIC X(3).
   254             20  PI-PLAN-EFF-DT          PIC X(2).
   255             20  PI-PLAN-EXP-DT          PIC X(2).
   256             20  FILLER                  PIC X(11).
   257         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   258             20  PI-OE-REFERENCE-1.
   259                 25  PI-OE-REF-1-PRIME   PIC X(18).
   260                 25  PI-OE-REF-1-SUFF    PIC XX.
   261
   262     12  PI-SESSION-IN-PROGRESS          PIC X.
   263         88  CLAIM-SESSION                   VALUE '1'.
   264         88  CREDIT-SESSION                  VALUE '2'.
   265         88  WARRANTY-SESSION                VALUE '3'.
   266         88  MORTGAGE-SESSION                VALUE '4'.
   267         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   268
   269
   270*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   271
   272     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   273     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   274
   275     12  PI-CREDIT-USER                  PIC X.
   276         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   277         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   278
   279     12  PI-CLAIM-USER                   PIC X.
   280         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   281         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   282
   283     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   284         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   285         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   286         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   287         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   288         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   289
   290     12  PI-PROCESSOR-ID                 PIC X(4).
   291
   292     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   293
   294     12  PI-MEMBER-CAPTION               PIC X(10).
   295
   296     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   297         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   298
   299     12  PI-LIFE-OVERRIDE-L1             PIC X.
   300     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   301     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   302     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   303
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL614.cbl
   304     12  PI-AH-OVERRIDE-L1               PIC X.
   305     12  PI-AH-OVERRIDE-L2               PIC XX.
   306     12  PI-AH-OVERRIDE-L6               PIC X(6).
   307     12  PI-AH-OVERRIDE-L12              PIC X(12).
   308
   309     12  PI-NEW-SYSTEM                   PIC X(2).
   310
   311     12  PI-PRIMARY-CERT-NO              PIC X(11).
   312     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   313         88  PI-USES-PAID-TO                 VALUE '1'.
   314     12  PI-CRDTCRD-SYSTEM.
   315         16  PI-CRDTCRD-USER             PIC X.
   316             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   317             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   318         16  PI-CC-MONTH-END-DT          PIC XX.
   319     12  PI-PROCESSOR-PRINTER            PIC X(4).
   320
   321     12  PI-OE-REFERENCE-2.
   322         16  PI-OE-REF-2-PRIME           PIC X(10).
   323         16  PI-OE-REF-2-SUFF            PIC X.
   324
   325     12  PI-REM-TRM-CALC-OPTION          PIC X.
   326
   327     12  PI-LANGUAGE-TYPE                PIC X.
   328             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   329             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   330             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   331
   332     12  PI-POLICY-LINKAGE-IND           PIC X.
   333         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   334         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   335                                                   LOW-VALUES.
   336
   337     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   338     12  PI-CLAIM-PW-SESSION             PIC X(1).
   339         88  PI-CLAIM-CREDIT                 VALUE '1'.
   340         88  PI-CLAIM-CONVEN                 VALUE '2'.
   341
   342     12  PI-PROCESSOR-CSR-IND            PIC X.
   343         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   344         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   345
   346     12  FILLER                          PIC X(3).
   347
   348     12  PI-SYSTEM-LEVEL                 PIC X(145).
   349
   350     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   351         PI-SYSTEM-LEVEL.
   352
   353         16  PI-ENTRY-CODES.
   354             20  PI-ENTRY-CD-1           PIC X.
   355             20  PI-ENTRY-CD-2           PIC X.
   356
   357         16  PI-RETURN-CODES.
   358             20  PI-RETURN-CD-1          PIC X.
   359             20  PI-RETURN-CD-2          PIC X.
   360
   361         16  PI-UPDATE-STATUS-SAVE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL614.cbl
   362             20  PI-UPDATE-BY            PIC X(4).
   363             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   364
   365         16  PI-LOWER-CASE-LETTERS       PIC X.
   366             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   367
   368*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   369*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   370*            88  CARRIER-CLM-CNTL            VALUE '2'.
   371
   372         16  PI-CERT-ACCESS-CONTROL      PIC X.
   373             88  ST-ACCNT-CNTL               VALUE ' '.
   374             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   375             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   376             88  ACCNT-CNTL                  VALUE '3'.
   377             88  CARR-ACCNT-CNTL             VALUE '4'.
   378
   379         16  PI-PROCESSOR-CAP-LIST.
   380             20  PI-SYSTEM-CONTROLS.
   381                24 PI-SYSTEM-DISPLAY     PIC X.
   382                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   383                24 PI-SYSTEM-MODIFY      PIC X.
   384                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   385             20  FILLER                  PIC XX.
   386             20  PI-DISPLAY-CAP          PIC X.
   387                 88  DISPLAY-CAP             VALUE 'Y'.
   388             20  PI-MODIFY-CAP           PIC X.
   389                 88  MODIFY-CAP              VALUE 'Y'.
   390             20  PI-MSG-AT-LOGON-CAP     PIC X.
   391                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   392             20  PI-FORCE-CAP            PIC X.
   393                 88  FORCE-CAP               VALUE 'Y'.
   394
   395         16  PI-PROGRAM-CONTROLS.
   396             20  PI-PGM-PRINT-OPT        PIC X.
   397             20  PI-PGM-FORMAT-OPT       PIC X.
   398             20  PI-PGM-PROCESS-OPT      PIC X.
   399             20  PI-PGM-TOTALS-OPT       PIC X.
   400
   401         16  PI-HELP-INTERFACE.
   402             20  PI-LAST-ERROR-NO        PIC X(4).
   403             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   404
   405         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   406             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   407
   408         16  PI-CR-CONTROL-IN-PROGRESS.
   409             20  PI-CR-CARRIER           PIC X.
   410             20  PI-CR-GROUPING          PIC X(6).
   411             20  PI-CR-STATE             PIC XX.
   412             20  PI-CR-ACCOUNT           PIC X(10).
   413             20  PI-CR-FIN-RESP          PIC X(10).
   414             20  PI-CR-TYPE              PIC X.
   415
   416         16  PI-CR-BATCH-NUMBER          PIC X(6).
   417
   418         16  PI-CR-MONTH-END-DT          PIC XX.
   419
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL614.cbl
   420         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   421             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   422             88  PI-ZERO-CARRIER             VALUE '1'.
   423             88  PI-ZERO-GROUPING            VALUE '2'.
   424             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   425
   426         16  PI-CARRIER-SECURITY         PIC X.
   427             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   428
   429         16  PI-ACCOUNT-SECURITY         PIC X(10).
   430             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   431             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   432
   433         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   434             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   435                                         INDEXED BY PI-ACCESS-NDX
   436                                         PIC X.
   437
   438         16  PI-GA-BILLING-CONTROL       PIC X.
   439             88  PI-GA-BILLING               VALUE '1'.
   440
   441         16  PI-MAIL-PROCESSING          PIC X.
   442             88  PI-MAIL-YES                 VALUE 'Y'.
   443
   444         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   445
   446         16  PI-AR-SYSTEM.
   447             20  PI-AR-PROCESSING-CNTL   PIC X.
   448                 88  PI-AR-PROCESSING        VALUE 'Y'.
   449             20  PI-AR-SUMMARY-CODE      PIC X(6).
   450             20  PI-AR-MONTH-END-DT      PIC XX.
   451
   452         16  PI-MP-SYSTEM.
   453             20  PI-MORTGAGE-USER            PIC X.
   454                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   455                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   456             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   457                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   458                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   459                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   460                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   461                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   462             20  PI-MP-MONTH-END-DT          PIC XX.
   463             20  PI-MP-REFERENCE-NO.
   464                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   465                 24  PI-MP-REFERENCE-SFX     PIC XX.
   466
   467         16  PI-LABEL-CONTROL            PIC X(01).
   468             88  PI-CREATE-LABELS                    VALUE 'Y'.
   469             88  PI-BYPASS-LABELS                    VALUE 'N'.
   470
   471         16  PI-BILL-GROUPING-CODE       PIC X(01).
   472             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   473
   474         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   475             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   476             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   477
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL614.cbl
   478         16  FILLER                      PIC X(14).
   479
   480     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   481******************************************************************
   482     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   483         16  PI-SELECTED-EOB-CODES.
   484             20  PI-SELECTED-CODES OCCURS 12.
   485                 24  PI-EOB-CODE     PIC XXXX.
   486                 24  FILLER          PIC X.
   487         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   488         16  PI-MODE                 PIC X.
   489             88  ADD-FUNCTION         VALUE 'A'.
   490         16  PI-DN-RCODE             PIC XXXX.
   491         16  PI-DN-TOP-KEY           PIC X(15).
   492         16  PI-DN-BOT-KEY           PIC X(15).
   493         16  PI-DN-KEYS OCCURS 17.
   494             20  PI-DN-KEY           PIC X(15).
   495         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   496         16  PI-BROWSE-SW            PIC S9     COMP-3.
   497         16  PI-SHOW-SW              PIC S9     COMP-3.
   498         16  PI-CHANGE-SW            PIC S9     COMP-3.
   499         16  PI-RECORD-TYPE          PIC X.
   500         16  FILLER                  PIC X(184).
   501*    COPY EL614S.
   502 01  EL614AI.
   503     05  FILLER            PIC  X(0012).
   504*    -------------------------------
   505     05  ADATEL PIC S9(0004) COMP.
   506     05  ADATEF PIC  X(0001).
   507     05  FILLER REDEFINES ADATEF.
   508         10  ADATEA PIC  X(0001).
   509     05  ADATEI PIC  X(0008).
   510*    -------------------------------
   511     05  ATIMEL PIC S9(0004) COMP.
   512     05  ATIMEF PIC  X(0001).
   513     05  FILLER REDEFINES ATIMEF.
   514         10  ATIMEA PIC  X(0001).
   515     05  ATIMEI PIC  X(0005).
   516*    -------------------------------
   517     05  SELHL PIC S9(0004) COMP.
   518     05  SELHF PIC  X(0001).
   519     05  FILLER REDEFINES SELHF.
   520         10  SELHA PIC  X(0001).
   521     05  SELHI PIC  X(0003).
   522*    -------------------------------
   523     05  SEL01L PIC S9(0004) COMP.
   524     05  SEL01F PIC  X(0001).
   525     05  FILLER REDEFINES SEL01F.
   526         10  SEL01A PIC  X(0001).
   527     05  SEL01I PIC  X(0001).
   528*    -------------------------------
   529     05  EOBCD01L PIC S9(0004) COMP.
   530     05  EOBCD01F PIC  X(0001).
   531     05  FILLER REDEFINES EOBCD01F.
   532         10  EOBCD01A PIC  X(0001).
   533     05  EOBCD01I PIC  X(0004).
   534*    -------------------------------
   535     05  DESC01L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL614.cbl
   536     05  DESC01F PIC  X(0001).
   537     05  FILLER REDEFINES DESC01F.
   538         10  DESC01A PIC  X(0001).
   539     05  DESC01I PIC  X(0060).
   540*    -------------------------------
   541     05  SEL02L PIC S9(0004) COMP.
   542     05  SEL02F PIC  X(0001).
   543     05  FILLER REDEFINES SEL02F.
   544         10  SEL02A PIC  X(0001).
   545     05  SEL02I PIC  X(0001).
   546*    -------------------------------
   547     05  EOBCD02L PIC S9(0004) COMP.
   548     05  EOBCD02F PIC  X(0001).
   549     05  FILLER REDEFINES EOBCD02F.
   550         10  EOBCD02A PIC  X(0001).
   551     05  EOBCD02I PIC  X(0004).
   552*    -------------------------------
   553     05  DESC02L PIC S9(0004) COMP.
   554     05  DESC02F PIC  X(0001).
   555     05  FILLER REDEFINES DESC02F.
   556         10  DESC02A PIC  X(0001).
   557     05  DESC02I PIC  X(0060).
   558*    -------------------------------
   559     05  SEL03L PIC S9(0004) COMP.
   560     05  SEL03F PIC  X(0001).
   561     05  FILLER REDEFINES SEL03F.
   562         10  SEL03A PIC  X(0001).
   563     05  SEL03I PIC  X(0001).
   564*    -------------------------------
   565     05  EOBCD03L PIC S9(0004) COMP.
   566     05  EOBCD03F PIC  X(0001).
   567     05  FILLER REDEFINES EOBCD03F.
   568         10  EOBCD03A PIC  X(0001).
   569     05  EOBCD03I PIC  X(0004).
   570*    -------------------------------
   571     05  DESC03L PIC S9(0004) COMP.
   572     05  DESC03F PIC  X(0001).
   573     05  FILLER REDEFINES DESC03F.
   574         10  DESC03A PIC  X(0001).
   575     05  DESC03I PIC  X(0060).
   576*    -------------------------------
   577     05  SEL04L PIC S9(0004) COMP.
   578     05  SEL04F PIC  X(0001).
   579     05  FILLER REDEFINES SEL04F.
   580         10  SEL04A PIC  X(0001).
   581     05  SEL04I PIC  X(0001).
   582*    -------------------------------
   583     05  EOBCD04L PIC S9(0004) COMP.
   584     05  EOBCD04F PIC  X(0001).
   585     05  FILLER REDEFINES EOBCD04F.
   586         10  EOBCD04A PIC  X(0001).
   587     05  EOBCD04I PIC  X(0004).
   588*    -------------------------------
   589     05  DESC04L PIC S9(0004) COMP.
   590     05  DESC04F PIC  X(0001).
   591     05  FILLER REDEFINES DESC04F.
   592         10  DESC04A PIC  X(0001).
   593     05  DESC04I PIC  X(0060).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL614.cbl
   594*    -------------------------------
   595     05  SEL05L PIC S9(0004) COMP.
   596     05  SEL05F PIC  X(0001).
   597     05  FILLER REDEFINES SEL05F.
   598         10  SEL05A PIC  X(0001).
   599     05  SEL05I PIC  X(0001).
   600*    -------------------------------
   601     05  EOBCD05L PIC S9(0004) COMP.
   602     05  EOBCD05F PIC  X(0001).
   603     05  FILLER REDEFINES EOBCD05F.
   604         10  EOBCD05A PIC  X(0001).
   605     05  EOBCD05I PIC  X(0004).
   606*    -------------------------------
   607     05  DESC05L PIC S9(0004) COMP.
   608     05  DESC05F PIC  X(0001).
   609     05  FILLER REDEFINES DESC05F.
   610         10  DESC05A PIC  X(0001).
   611     05  DESC05I PIC  X(0060).
   612*    -------------------------------
   613     05  SEL06L PIC S9(0004) COMP.
   614     05  SEL06F PIC  X(0001).
   615     05  FILLER REDEFINES SEL06F.
   616         10  SEL06A PIC  X(0001).
   617     05  SEL06I PIC  X(0001).
   618*    -------------------------------
   619     05  EOBCD06L PIC S9(0004) COMP.
   620     05  EOBCD06F PIC  X(0001).
   621     05  FILLER REDEFINES EOBCD06F.
   622         10  EOBCD06A PIC  X(0001).
   623     05  EOBCD06I PIC  X(0004).
   624*    -------------------------------
   625     05  DESC06L PIC S9(0004) COMP.
   626     05  DESC06F PIC  X(0001).
   627     05  FILLER REDEFINES DESC06F.
   628         10  DESC06A PIC  X(0001).
   629     05  DESC06I PIC  X(0060).
   630*    -------------------------------
   631     05  SEL07L PIC S9(0004) COMP.
   632     05  SEL07F PIC  X(0001).
   633     05  FILLER REDEFINES SEL07F.
   634         10  SEL07A PIC  X(0001).
   635     05  SEL07I PIC  X(0001).
   636*    -------------------------------
   637     05  EOBCD07L PIC S9(0004) COMP.
   638     05  EOBCD07F PIC  X(0001).
   639     05  FILLER REDEFINES EOBCD07F.
   640         10  EOBCD07A PIC  X(0001).
   641     05  EOBCD07I PIC  X(0004).
   642*    -------------------------------
   643     05  DESC07L PIC S9(0004) COMP.
   644     05  DESC07F PIC  X(0001).
   645     05  FILLER REDEFINES DESC07F.
   646         10  DESC07A PIC  X(0001).
   647     05  DESC07I PIC  X(0060).
   648*    -------------------------------
   649     05  SEL08L PIC S9(0004) COMP.
   650     05  SEL08F PIC  X(0001).
   651     05  FILLER REDEFINES SEL08F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL614.cbl
   652         10  SEL08A PIC  X(0001).
   653     05  SEL08I PIC  X(0001).
   654*    -------------------------------
   655     05  EOBCD08L PIC S9(0004) COMP.
   656     05  EOBCD08F PIC  X(0001).
   657     05  FILLER REDEFINES EOBCD08F.
   658         10  EOBCD08A PIC  X(0001).
   659     05  EOBCD08I PIC  X(0004).
   660*    -------------------------------
   661     05  DESC08L PIC S9(0004) COMP.
   662     05  DESC08F PIC  X(0001).
   663     05  FILLER REDEFINES DESC08F.
   664         10  DESC08A PIC  X(0001).
   665     05  DESC08I PIC  X(0060).
   666*    -------------------------------
   667     05  SEL09L PIC S9(0004) COMP.
   668     05  SEL09F PIC  X(0001).
   669     05  FILLER REDEFINES SEL09F.
   670         10  SEL09A PIC  X(0001).
   671     05  SEL09I PIC  X(0001).
   672*    -------------------------------
   673     05  EOBCD09L PIC S9(0004) COMP.
   674     05  EOBCD09F PIC  X(0001).
   675     05  FILLER REDEFINES EOBCD09F.
   676         10  EOBCD09A PIC  X(0001).
   677     05  EOBCD09I PIC  X(0004).
   678*    -------------------------------
   679     05  DESC09L PIC S9(0004) COMP.
   680     05  DESC09F PIC  X(0001).
   681     05  FILLER REDEFINES DESC09F.
   682         10  DESC09A PIC  X(0001).
   683     05  DESC09I PIC  X(0060).
   684*    -------------------------------
   685     05  SEL10L PIC S9(0004) COMP.
   686     05  SEL10F PIC  X(0001).
   687     05  FILLER REDEFINES SEL10F.
   688         10  SEL10A PIC  X(0001).
   689     05  SEL10I PIC  X(0001).
   690*    -------------------------------
   691     05  EOBCD10L PIC S9(0004) COMP.
   692     05  EOBCD10F PIC  X(0001).
   693     05  FILLER REDEFINES EOBCD10F.
   694         10  EOBCD10A PIC  X(0001).
   695     05  EOBCD10I PIC  X(0004).
   696*    -------------------------------
   697     05  DESC10L PIC S9(0004) COMP.
   698     05  DESC10F PIC  X(0001).
   699     05  FILLER REDEFINES DESC10F.
   700         10  DESC10A PIC  X(0001).
   701     05  DESC10I PIC  X(0060).
   702*    -------------------------------
   703     05  SEL11L PIC S9(0004) COMP.
   704     05  SEL11F PIC  X(0001).
   705     05  FILLER REDEFINES SEL11F.
   706         10  SEL11A PIC  X(0001).
   707     05  SEL11I PIC  X(0001).
   708*    -------------------------------
   709     05  EOBCD11L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL614.cbl
   710     05  EOBCD11F PIC  X(0001).
   711     05  FILLER REDEFINES EOBCD11F.
   712         10  EOBCD11A PIC  X(0001).
   713     05  EOBCD11I PIC  X(0004).
   714*    -------------------------------
   715     05  DESC11L PIC S9(0004) COMP.
   716     05  DESC11F PIC  X(0001).
   717     05  FILLER REDEFINES DESC11F.
   718         10  DESC11A PIC  X(0001).
   719     05  DESC11I PIC  X(0060).
   720*    -------------------------------
   721     05  SEL12L PIC S9(0004) COMP.
   722     05  SEL12F PIC  X(0001).
   723     05  FILLER REDEFINES SEL12F.
   724         10  SEL12A PIC  X(0001).
   725     05  SEL12I PIC  X(0001).
   726*    -------------------------------
   727     05  EOBCD12L PIC S9(0004) COMP.
   728     05  EOBCD12F PIC  X(0001).
   729     05  FILLER REDEFINES EOBCD12F.
   730         10  EOBCD12A PIC  X(0001).
   731     05  EOBCD12I PIC  X(0004).
   732*    -------------------------------
   733     05  DESC12L PIC S9(0004) COMP.
   734     05  DESC12F PIC  X(0001).
   735     05  FILLER REDEFINES DESC12F.
   736         10  DESC12A PIC  X(0001).
   737     05  DESC12I PIC  X(0060).
   738*    -------------------------------
   739     05  SEL13L PIC S9(0004) COMP.
   740     05  SEL13F PIC  X(0001).
   741     05  FILLER REDEFINES SEL13F.
   742         10  SEL13A PIC  X(0001).
   743     05  SEL13I PIC  X(0001).
   744*    -------------------------------
   745     05  EOBCD13L PIC S9(0004) COMP.
   746     05  EOBCD13F PIC  X(0001).
   747     05  FILLER REDEFINES EOBCD13F.
   748         10  EOBCD13A PIC  X(0001).
   749     05  EOBCD13I PIC  X(0004).
   750*    -------------------------------
   751     05  DESC13L PIC S9(0004) COMP.
   752     05  DESC13F PIC  X(0001).
   753     05  FILLER REDEFINES DESC13F.
   754         10  DESC13A PIC  X(0001).
   755     05  DESC13I PIC  X(0060).
   756*    -------------------------------
   757     05  SEL14L PIC S9(0004) COMP.
   758     05  SEL14F PIC  X(0001).
   759     05  FILLER REDEFINES SEL14F.
   760         10  SEL14A PIC  X(0001).
   761     05  SEL14I PIC  X(0001).
   762*    -------------------------------
   763     05  EOBCD14L PIC S9(0004) COMP.
   764     05  EOBCD14F PIC  X(0001).
   765     05  FILLER REDEFINES EOBCD14F.
   766         10  EOBCD14A PIC  X(0001).
   767     05  EOBCD14I PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL614.cbl
   768*    -------------------------------
   769     05  DESC14L PIC S9(0004) COMP.
   770     05  DESC14F PIC  X(0001).
   771     05  FILLER REDEFINES DESC14F.
   772         10  DESC14A PIC  X(0001).
   773     05  DESC14I PIC  X(0060).
   774*    -------------------------------
   775     05  SEL15L PIC S9(0004) COMP.
   776     05  SEL15F PIC  X(0001).
   777     05  FILLER REDEFINES SEL15F.
   778         10  SEL15A PIC  X(0001).
   779     05  SEL15I PIC  X(0001).
   780*    -------------------------------
   781     05  EOBCD15L PIC S9(0004) COMP.
   782     05  EOBCD15F PIC  X(0001).
   783     05  FILLER REDEFINES EOBCD15F.
   784         10  EOBCD15A PIC  X(0001).
   785     05  EOBCD15I PIC  X(0004).
   786*    -------------------------------
   787     05  DESC15L PIC S9(0004) COMP.
   788     05  DESC15F PIC  X(0001).
   789     05  FILLER REDEFINES DESC15F.
   790         10  DESC15A PIC  X(0001).
   791     05  DESC15I PIC  X(0060).
   792*    -------------------------------
   793     05  SEL16L PIC S9(0004) COMP.
   794     05  SEL16F PIC  X(0001).
   795     05  FILLER REDEFINES SEL16F.
   796         10  SEL16A PIC  X(0001).
   797     05  SEL16I PIC  X(0001).
   798*    -------------------------------
   799     05  EOBCD16L PIC S9(0004) COMP.
   800     05  EOBCD16F PIC  X(0001).
   801     05  FILLER REDEFINES EOBCD16F.
   802         10  EOBCD16A PIC  X(0001).
   803     05  EOBCD16I PIC  X(0004).
   804*    -------------------------------
   805     05  DESC16L PIC S9(0004) COMP.
   806     05  DESC16F PIC  X(0001).
   807     05  FILLER REDEFINES DESC16F.
   808         10  DESC16A PIC  X(0001).
   809     05  DESC16I PIC  X(0060).
   810*    -------------------------------
   811     05  SEL17L PIC S9(0004) COMP.
   812     05  SEL17F PIC  X(0001).
   813     05  FILLER REDEFINES SEL17F.
   814         10  SEL17A PIC  X(0001).
   815     05  SEL17I PIC  X(0001).
   816*    -------------------------------
   817     05  EOBCD17L PIC S9(0004) COMP.
   818     05  EOBCD17F PIC  X(0001).
   819     05  FILLER REDEFINES EOBCD17F.
   820         10  EOBCD17A PIC  X(0001).
   821     05  EOBCD17I PIC  X(0004).
   822*    -------------------------------
   823     05  DESC17L PIC S9(0004) COMP.
   824     05  DESC17F PIC  X(0001).
   825     05  FILLER REDEFINES DESC17F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL614.cbl
   826         10  DESC17A PIC  X(0001).
   827     05  DESC17I PIC  X(0060).
   828*    -------------------------------
   829     05  AEMSGL PIC S9(0004) COMP.
   830     05  AEMSGF PIC  X(0001).
   831     05  FILLER REDEFINES AEMSGF.
   832         10  AEMSGA PIC  X(0001).
   833     05  AEMSGI PIC  X(0079).
   834*    -------------------------------
   835     05  APFKL PIC S9(0004) COMP.
   836     05  APFKF PIC  X(0001).
   837     05  FILLER REDEFINES APFKF.
   838         10  APFKA PIC  X(0001).
   839     05  APFKI PIC  S99.
   840*    -------------------------------
   841     05  F3KEYL PIC S9(0004) COMP.
   842     05  F3KEYF PIC  X(0001).
   843     05  FILLER REDEFINES F3KEYF.
   844         10  F3KEYA PIC  X(0001).
   845     05  F3KEYI PIC  X(0019).
   846 01  EL614AO REDEFINES EL614AI.
   847     05  FILLER            PIC  X(0012).
   848*    -------------------------------
   849     05  FILLER            PIC  X(0003).
   850     05  ADATEO PIC  X(0008).
   851*    -------------------------------
   852     05  FILLER            PIC  X(0003).
   853     05  ATIMEO PIC  99.99.
   854*    -------------------------------
   855     05  FILLER            PIC  X(0003).
   856     05  SELHO PIC  X(0003).
   857*    -------------------------------
   858     05  FILLER            PIC  X(0003).
   859     05  SEL01O PIC  X(0001).
   860*    -------------------------------
   861     05  FILLER            PIC  X(0003).
   862     05  EOBCD01O PIC  X(0004).
   863*    -------------------------------
   864     05  FILLER            PIC  X(0003).
   865     05  DESC01O PIC  X(0060).
   866*    -------------------------------
   867     05  FILLER            PIC  X(0003).
   868     05  SEL02O PIC  X(0001).
   869*    -------------------------------
   870     05  FILLER            PIC  X(0003).
   871     05  EOBCD02O PIC  X(0004).
   872*    -------------------------------
   873     05  FILLER            PIC  X(0003).
   874     05  DESC02O PIC  X(0060).
   875*    -------------------------------
   876     05  FILLER            PIC  X(0003).
   877     05  SEL03O PIC  X(0001).
   878*    -------------------------------
   879     05  FILLER            PIC  X(0003).
   880     05  EOBCD03O PIC  X(0004).
   881*    -------------------------------
   882     05  FILLER            PIC  X(0003).
   883     05  DESC03O PIC  X(0060).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL614.cbl
   884*    -------------------------------
   885     05  FILLER            PIC  X(0003).
   886     05  SEL04O PIC  X(0001).
   887*    -------------------------------
   888     05  FILLER            PIC  X(0003).
   889     05  EOBCD04O PIC  X(0004).
   890*    -------------------------------
   891     05  FILLER            PIC  X(0003).
   892     05  DESC04O PIC  X(0060).
   893*    -------------------------------
   894     05  FILLER            PIC  X(0003).
   895     05  SEL05O PIC  X(0001).
   896*    -------------------------------
   897     05  FILLER            PIC  X(0003).
   898     05  EOBCD05O PIC  X(0004).
   899*    -------------------------------
   900     05  FILLER            PIC  X(0003).
   901     05  DESC05O PIC  X(0060).
   902*    -------------------------------
   903     05  FILLER            PIC  X(0003).
   904     05  SEL06O PIC  X(0001).
   905*    -------------------------------
   906     05  FILLER            PIC  X(0003).
   907     05  EOBCD06O PIC  X(0004).
   908*    -------------------------------
   909     05  FILLER            PIC  X(0003).
   910     05  DESC06O PIC  X(0060).
   911*    -------------------------------
   912     05  FILLER            PIC  X(0003).
   913     05  SEL07O PIC  X(0001).
   914*    -------------------------------
   915     05  FILLER            PIC  X(0003).
   916     05  EOBCD07O PIC  X(0004).
   917*    -------------------------------
   918     05  FILLER            PIC  X(0003).
   919     05  DESC07O PIC  X(0060).
   920*    -------------------------------
   921     05  FILLER            PIC  X(0003).
   922     05  SEL08O PIC  X(0001).
   923*    -------------------------------
   924     05  FILLER            PIC  X(0003).
   925     05  EOBCD08O PIC  X(0004).
   926*    -------------------------------
   927     05  FILLER            PIC  X(0003).
   928     05  DESC08O PIC  X(0060).
   929*    -------------------------------
   930     05  FILLER            PIC  X(0003).
   931     05  SEL09O PIC  X(0001).
   932*    -------------------------------
   933     05  FILLER            PIC  X(0003).
   934     05  EOBCD09O PIC  X(0004).
   935*    -------------------------------
   936     05  FILLER            PIC  X(0003).
   937     05  DESC09O PIC  X(0060).
   938*    -------------------------------
   939     05  FILLER            PIC  X(0003).
   940     05  SEL10O PIC  X(0001).
   941*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL614.cbl
   942     05  FILLER            PIC  X(0003).
   943     05  EOBCD10O PIC  X(0004).
   944*    -------------------------------
   945     05  FILLER            PIC  X(0003).
   946     05  DESC10O PIC  X(0060).
   947*    -------------------------------
   948     05  FILLER            PIC  X(0003).
   949     05  SEL11O PIC  X(0001).
   950*    -------------------------------
   951     05  FILLER            PIC  X(0003).
   952     05  EOBCD11O PIC  X(0004).
   953*    -------------------------------
   954     05  FILLER            PIC  X(0003).
   955     05  DESC11O PIC  X(0060).
   956*    -------------------------------
   957     05  FILLER            PIC  X(0003).
   958     05  SEL12O PIC  X(0001).
   959*    -------------------------------
   960     05  FILLER            PIC  X(0003).
   961     05  EOBCD12O PIC  X(0004).
   962*    -------------------------------
   963     05  FILLER            PIC  X(0003).
   964     05  DESC12O PIC  X(0060).
   965*    -------------------------------
   966     05  FILLER            PIC  X(0003).
   967     05  SEL13O PIC  X(0001).
   968*    -------------------------------
   969     05  FILLER            PIC  X(0003).
   970     05  EOBCD13O PIC  X(0004).
   971*    -------------------------------
   972     05  FILLER            PIC  X(0003).
   973     05  DESC13O PIC  X(0060).
   974*    -------------------------------
   975     05  FILLER            PIC  X(0003).
   976     05  SEL14O PIC  X(0001).
   977*    -------------------------------
   978     05  FILLER            PIC  X(0003).
   979     05  EOBCD14O PIC  X(0004).
   980*    -------------------------------
   981     05  FILLER            PIC  X(0003).
   982     05  DESC14O PIC  X(0060).
   983*    -------------------------------
   984     05  FILLER            PIC  X(0003).
   985     05  SEL15O PIC  X(0001).
   986*    -------------------------------
   987     05  FILLER            PIC  X(0003).
   988     05  EOBCD15O PIC  X(0004).
   989*    -------------------------------
   990     05  FILLER            PIC  X(0003).
   991     05  DESC15O PIC  X(0060).
   992*    -------------------------------
   993     05  FILLER            PIC  X(0003).
   994     05  SEL16O PIC  X(0001).
   995*    -------------------------------
   996     05  FILLER            PIC  X(0003).
   997     05  EOBCD16O PIC  X(0004).
   998*    -------------------------------
   999     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL614.cbl
  1000     05  DESC16O PIC  X(0060).
  1001*    -------------------------------
  1002     05  FILLER            PIC  X(0003).
  1003     05  SEL17O PIC  X(0001).
  1004*    -------------------------------
  1005     05  FILLER            PIC  X(0003).
  1006     05  EOBCD17O PIC  X(0004).
  1007*    -------------------------------
  1008     05  FILLER            PIC  X(0003).
  1009     05  DESC17O PIC  X(0060).
  1010*    -------------------------------
  1011     05  FILLER            PIC  X(0003).
  1012     05  AEMSGO PIC  X(0079).
  1013*    -------------------------------
  1014     05  FILLER            PIC  X(0003).
  1015     05  APFKO PIC  X(0002).
  1016*    -------------------------------
  1017     05  FILLER            PIC  X(0003).
  1018     05  F3KEYO PIC  X(0019).
  1019*    -------------------------------
  1020 01  EL614AO-R REDEFINES EL614AI.
  1021     05  FILLER                      PIC X(37).
  1022     05  WS-MAP-LINE                 OCCURS 17
  1023                                     INDEXED BY M1.
  1024         10  SELL                    PIC S9(4)  COMP.
  1025         10  SELA                    PIC X.
  1026         10  SELI                    PIC X.
  1027         10  RCODEL                  PIC S9(4)  COMP.
  1028         10  RCODEA                  PIC X.
  1029         10  RCODEO                  PIC XXXX.
  1030         10  RCODEI                  REDEFINES
  1031             RCODEO                  PIC XXXX.
  1032         10  DESCL                   PIC S9(4)   COMP.
  1033         10  DESCA                   PIC X.
  1034         10  DESCO                   PIC X(60).
  1035         10  DESCI                   REDEFINES
  1036             DESCO                   PIC X(60).
  1037*    COPY ELCJPFX.
  1038******************************************************************
  1039*                                                                *
  1040*                                                                *
  1041*                            ELCJPFX.                            *
  1042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1043*                            VMOD=2.002                          *
  1044*                                                                *
  1045*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1046*                                                                *
  1047*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1048*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1049*        ELCNTL - CONTROL FILE                                   *
  1050*        ELMSTR - CLAIM MASTERS                                  *
  1051*        ELTRLR - ACTIVITY TRAILERS                              *
  1052*        ELCHKQ - CHECK QUE                                      *
  1053******************************************************************
  1054 01  JOURNAL-RECORD.
  1055     12  JP-USER-ID                  PIC X(4).
  1056     12  JP-FILE-ID                  PIC X(8).
  1057     12  JP-PROGRAM-ID               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL614.cbl
  1058     12  JP-RECORD-TYPE              PIC X.
  1059         88 JP-ADD              VALUE 'A'.
  1060         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1061         88 JP-AFTER-CHANGE     VALUE 'C'.
  1062         88 JP-DELETE           VALUE 'D'.
  1063         88 JP-GENERIC-DELETE   VALUE 'G'.
  1064         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1065         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1066     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1067     12  JP-RECORD-AREA
  1068
  1069
  1070                                     PIC X(750).
  1071*                                COPY ELCEOBC.
  1072******************************************************************
  1073*                                                                *
  1074*                                                                *
  1075*                            ELCEOBC                             *
  1076*                            VMOD=2.001                          *
  1077*                                                                *
  1078*   CLAIM SYSTEM EOB CODE TABLE                                  *
  1079*                                                                *
  1080*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1081*   VSAM EOB CODE TABLE                                          *
  1082*                                                                *
  1083*   FILE DESCRIPTION = EOB CODE TABLE                            *
  1084*                                                                *
  1085*   FILE TYPE = VSAM,KSDS                                        *
  1086*   RECORD SIZE = 350   RECFORM = FIX                            *
  1087*                                                                *
  1088*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  1089*                                                                *
  1090*   LOG = NO                                                     *
  1091*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1092*                                                                *
  1093*                                                                *
  1094******************************************************************
  1095*                   C H A N G E   L O G
  1096*
  1097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1098*-----------------------------------------------------------------
  1099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1100* EFFECTIVE    NUMBER
  1101*-----------------------------------------------------------------
  1102* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  1103* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  1104******************************************************************
  1105 01  EOB-CODES.
  1106     12  EO-RECORD-ID                      PIC XX.
  1107         88  VALID-DN-ID                      VALUE 'EO'.
  1108     12  EO-CONTROL-PRIMARY.
  1109         16  EO-COMPANY-CD                 PIC X.
  1110         16  EO-RECORD-TYPE                PIC X.
  1111             88  EO-EOB-RECS                  VALUE '1'.
  1112             88  EO-VERIF-RECS                VALUE '2'.
  1113             88  EO-GCE-RECS                  VALUE '3'.
  1114         16  EO-EOB-CODE                   PIC X(4).
  1115         16  FILLER                        PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL614.cbl
  1116     12  EO-MAINT-INFORMATION.
  1117         16  EO-LAST-MAINT-DT              PIC XX.
  1118         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1119         16  EO-LAST-MAINT-USER            PIC X(4).
  1120         16  FILLER                        PIC XX.
  1121     12  EO-DESCRIPTION                    PIC X(275).
  1122     12  FILLER                            PIC X(46).
  1123******************************************************************
  1124*    COPY ELCEMIB.
  1125******************************************************************
  1126*                                                                *
  1127*                                                                *
  1128*                            ELCEMIB.                            *
  1129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1130*                            VMOD=2.005                          *
  1131*                                                                *
  1132*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1133*                                                                *
  1134******************************************************************
  1135 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1136     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1137     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1138     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1139     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1140     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1141     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1142     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1143     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1144     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1145         88  EMI-NO-ERRORS                    VALUE '1'.
  1146         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1147         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1148     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1149         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1150     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1151         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1152         88  EMI-AREA1-FULL                   VALUE '2'.
  1153     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1154         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1155         88  EMI-AREA2-FULL                   VALUE '2'.
  1156     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1157         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1158         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1159         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1160         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1161         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1162     12  EMI-ERROR-LINES.
  1163         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1164         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1165         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1166         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1167             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1168                 24  EMI-ERR-NUM         PIC X(4).
  1169                 24  EMI-FILLER          PIC X.
  1170                 24  EMI-SEV             PIC X.
  1171                 24  FILLER              PIC X.
  1172             20  FILLER                  PIC X(02).
  1173     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL614.cbl
  1174         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1175             20  EMI-ERROR-NUMBER    PIC X(4).
  1176             20  EMI-FILL            PIC X.
  1177             20  EMI-SEVERITY        PIC X.
  1178             20  FILLER              PIC X.
  1179             20  EMI-ERROR-TEXT.
  1180                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1181                 24  FILLER          PIC X(55).
  1182     12  EMI-SEVERITY-SAVE           PIC X.
  1183         88  EMI-NOTE                    VALUE 'N'.
  1184         88  EMI-WARNING                 VALUE 'W'.
  1185         88  EMI-FORCABLE                VALUE 'F'.
  1186         88  EMI-FATAL                   VALUE 'X'.
  1187     12  EMI-MESSAGE-FLAG            PIC X.
  1188         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1189         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1190     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1191     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1192         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1193         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1194         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1195     12  FILLER                      PIC X(137)  VALUE SPACES.
  1196     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1197     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1198     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1199     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1200*    COPY ELCDATE.
  1201******************************************************************
  1202*                                                                *
  1203*                                                                *
  1204*                            ELCDATE.                            *
  1205*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1206*                            VMOD=2.003
  1207*                                                                *
  1208*                                                                *
  1209*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1210*                 LENGTH = 200                                   *
  1211******************************************************************
  1212
  1213 01  DATE-CONVERSION-DATA.
  1214     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1215     12  DC-OPTION-CODE                PIC X.
  1216         88  BIN-TO-GREG                VALUE ' '.
  1217         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1218         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1219         88  YMD-GREG-TO-BIN            VALUE '3'.
  1220         88  MDY-GREG-TO-BIN            VALUE '4'.
  1221         88  JULIAN-TO-BIN              VALUE '5'.
  1222         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1223         88  FIND-CENTURY               VALUE '7'.
  1224         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1225         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1226         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1227         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1228         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1229         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1230         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1231         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL614.cbl
  1232         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1233         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1234         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1235         88  BIN-3-TO-GREG              VALUE 'I'.
  1236         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1237         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1238         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1239         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1240         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1241         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1242         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1243         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1244         88  THREE-CHARACTER-BIN
  1245                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1246         88  GREGORIAN-TO-BIN
  1247                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1248         88  BIN-TO-GREGORIAN
  1249                  VALUES ' ' '1' 'I' '8' 'G'.
  1250         88  JULIAN-TO-BINARY
  1251                  VALUES '5' 'C' 'E' 'F'.
  1252     12  DC-ERROR-CODE                 PIC X.
  1253         88  NO-CONVERSION-ERROR        VALUE ' '.
  1254         88  DATE-CONVERSION-ERROR
  1255                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1256         88  DATE-IS-ZERO               VALUE '1'.
  1257         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1258         88  DATE-IS-INVALID            VALUE '3'.
  1259         88  DATE1-GREATER-DATE2        VALUE '4'.
  1260         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1261         88  DATE-INVALID-OPTION        VALUE '9'.
  1262         88  INVALID-CENTURY            VALUE 'A'.
  1263         88  ONLY-CENTURY               VALUE 'B'.
  1264         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1265         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1266     12  DC-END-OF-MONTH               PIC X.
  1267         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1268     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1269         88  USE-NORMAL-PROCESS         VALUE ' '.
  1270         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1271         88  ADJUST-UP-100-YRS          VALUE '2'.
  1272     12  FILLER                        PIC X.
  1273     12  DC-CONVERSION-DATES.
  1274         16  DC-BIN-DATE-1             PIC XX.
  1275         16  DC-BIN-DATE-2             PIC XX.
  1276         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1277         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1278                       DC-GREG-DATE-1-EDIT.
  1279             20  DC-EDIT1-MONTH        PIC 99.
  1280             20  SLASH1-1              PIC X.
  1281             20  DC-EDIT1-DAY          PIC 99.
  1282             20  SLASH1-2              PIC X.
  1283             20  DC-EDIT1-YEAR         PIC 99.
  1284         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1285         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1286                     DC-GREG-DATE-2-EDIT.
  1287             20  DC-EDIT2-MONTH        PIC 99.
  1288             20  SLASH2-1              PIC X.
  1289             20  DC-EDIT2-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL614.cbl
  1290             20  SLASH2-2              PIC X.
  1291             20  DC-EDIT2-YEAR         PIC 99.
  1292         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1293         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1294                     DC-GREG-DATE-1-YMD.
  1295             20  DC-YMD-YEAR           PIC 99.
  1296             20  DC-YMD-MONTH          PIC 99.
  1297             20  DC-YMD-DAY            PIC 99.
  1298         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1299         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1300                      DC-GREG-DATE-1-MDY.
  1301             20  DC-MDY-MONTH          PIC 99.
  1302             20  DC-MDY-DAY            PIC 99.
  1303             20  DC-MDY-YEAR           PIC 99.
  1304         16  DC-GREG-DATE-1-ALPHA.
  1305             20  DC-ALPHA-MONTH        PIC X(10).
  1306             20  DC-ALPHA-DAY          PIC 99.
  1307             20  FILLER                PIC XX.
  1308             20  DC-ALPHA-CENTURY.
  1309                 24 DC-ALPHA-CEN-N     PIC 99.
  1310             20  DC-ALPHA-YEAR         PIC 99.
  1311         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1312         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1313         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1314         16  DC-JULIAN-DATE            PIC 9(05).
  1315         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1316                                       PIC 9(05).
  1317         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1318             20  DC-JULIAN-YEAR        PIC 99.
  1319             20  DC-JULIAN-DAYS        PIC 999.
  1320         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1321         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1322         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1323     12  DATE-CONVERSION-VARIBLES.
  1324         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1325         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1326             20  FILLER                PIC 9(3).
  1327             20  HOLD-CEN-1-CCYY.
  1328                 24  HOLD-CEN-1-CC     PIC 99.
  1329                 24  HOLD-CEN-1-YY     PIC 99.
  1330             20  HOLD-CEN-1-MO         PIC 99.
  1331             20  HOLD-CEN-1-DA         PIC 99.
  1332         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1333             20  HOLD-CEN-1-R-MO       PIC 99.
  1334             20  HOLD-CEN-1-R-DA       PIC 99.
  1335             20  HOLD-CEN-1-R-CCYY.
  1336                 24  HOLD-CEN-1-R-CC   PIC 99.
  1337                 24  HOLD-CEN-1-R-YY   PIC 99.
  1338             20  FILLER                PIC 9(3).
  1339         16  HOLD-CENTURY-1-X.
  1340             20  FILLER                PIC X(3)  VALUE SPACES.
  1341             20  HOLD-CEN-1-X-CCYY.
  1342                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1343                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1344             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1345             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1346         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1347             20  HOLD-CEN-1-R-X-MO     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL614.cbl
  1348             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1349             20  HOLD-CEN-1-R-X-CCYY.
  1350                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1351                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1352             20  FILLER                PIC XXX.
  1353         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1354         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1355         16  DC-JULIAN-DATE-1          PIC 9(07).
  1356         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1357             20  DC-JULIAN-1-CCYY.
  1358                 24  DC-JULIAN-1-CC    PIC 99.
  1359                 24  DC-JULIAN-1-YR    PIC 99.
  1360             20  DC-JULIAN-DA-1        PIC 999.
  1361         16  DC-JULIAN-DATE-2          PIC 9(07).
  1362         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1363             20  DC-JULIAN-2-CCYY.
  1364                 24  DC-JULIAN-2-CC    PIC 99.
  1365                 24  DC-JULIAN-2-YR    PIC 99.
  1366             20  DC-JULIAN-DA-2        PIC 999.
  1367         16  DC-GREG-DATE-A-EDIT.
  1368             20  DC-EDITA-MONTH        PIC 99.
  1369             20  SLASHA-1              PIC X VALUE '/'.
  1370             20  DC-EDITA-DAY          PIC 99.
  1371             20  SLASHA-2              PIC X VALUE '/'.
  1372             20  DC-EDITA-CCYY.
  1373                 24  DC-EDITA-CENT     PIC 99.
  1374                 24  DC-EDITA-YEAR     PIC 99.
  1375         16  DC-GREG-DATE-B-EDIT.
  1376             20  DC-EDITB-MONTH        PIC 99.
  1377             20  SLASHB-1              PIC X VALUE '/'.
  1378             20  DC-EDITB-DAY          PIC 99.
  1379             20  SLASHB-2              PIC X VALUE '/'.
  1380             20  DC-EDITB-CCYY.
  1381                 24  DC-EDITB-CENT     PIC 99.
  1382                 24  DC-EDITB-YEAR     PIC 99.
  1383         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1384         16  DC-GREG-DATE-CYMD-R REDEFINES
  1385                              DC-GREG-DATE-CYMD.
  1386             20  DC-CYMD-CEN           PIC 99.
  1387             20  DC-CYMD-YEAR          PIC 99.
  1388             20  DC-CYMD-MONTH         PIC 99.
  1389             20  DC-CYMD-DAY           PIC 99.
  1390         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1391         16  DC-GREG-DATE-MDCY-R REDEFINES
  1392                              DC-GREG-DATE-MDCY.
  1393             20  DC-MDCY-MONTH         PIC 99.
  1394             20  DC-MDCY-DAY           PIC 99.
  1395             20  DC-MDCY-CEN           PIC 99.
  1396             20  DC-MDCY-YEAR          PIC 99.
  1397    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1398        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1399    12  DC-EL310-DATE                  PIC X(21).
  1400    12  FILLER                         PIC X(28).
  1401*    COPY ELCLOGOF.
  1402******************************************************************
  1403*                                                                *
  1404*                                                                *
  1405*                            ELCLOGOF.                           *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL614.cbl
  1406*                            VMOD=2.001                          *
  1407*                                                                *
  1408*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1409*                                                                *
  1410******************************************************************
  1411 01  CLASIC-LOGOFF.
  1412     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1413     12  LOGOFF-TEXT.
  1414         16  FILLER          PIC X(5)    VALUE SPACES.
  1415         16  LOGOFF-MSG.
  1416             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1417             20  FILLER      PIC X       VALUE SPACES.
  1418             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1419         16  FILLER          PIC X(80)
  1420           VALUE '* YOU ARE NOW LOGGED OFF'.
  1421         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1422         16  FILLER          PIC X       VALUE QUOTE.
  1423         16  LOGOFF-SYS-MSG  PIC X(17)
  1424           VALUE 'S CLAS-IC SYSTEM '.
  1425     12  TEXT-MESSAGES.
  1426         16  UNACCESS-MSG    PIC X(29)
  1427             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1428         16  PGMIDERR-MSG    PIC X(17)
  1429             VALUE 'PROGRAM NOT FOUND'.
  1430*    COPY ELCATTR.
  1431******************************************************************
  1432*                                                                *
  1433*                            ELCATTR.                            *
  1434*                            VMOD=2.001                          *
  1435*                                                                *
  1436*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1437*                                                                *
  1438*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1439*                                                                *
  1440*                   POS 1   P=PROTECTED                          *
  1441*                           U=UNPROTECTED                        *
  1442*                           S=ASKIP                              *
  1443*                   POS 2   A=ALPHA/NUMERIC                      *
  1444*                           N=NUMERIC                            *
  1445*                   POS 3   N=NORMAL                             *
  1446*                           B=BRIGHT                             *
  1447*                           D=DARK                               *
  1448*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1449*                           OF=MODIFIED DATA TAG OFF             *
  1450*                                                                *
  1451*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1452******************************************************************
  1453 01  ATTRIBUTE-LIST.
  1454     12  AL-PABOF            PIC X       VALUE 'Y'.
  1455     12  AL-PABON            PIC X       VALUE 'Z'.
  1456     12  AL-PADOF            PIC X       VALUE '%'.
  1457     12  AL-PADON            PIC X       VALUE '_'.
  1458     12  AL-PANOF            PIC X       VALUE '-'.
  1459     12  AL-PANON            PIC X       VALUE '/'.
  1460     12  AL-SABOF            PIC X       VALUE '8'.
  1461     12  AL-SABON            PIC X       VALUE '9'.
  1462     12  AL-SADOF            PIC X       VALUE '@'.
  1463     12  AL-SADON            PIC X       VALUE QUOTE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL614.cbl
  1464     12  AL-SANOF            PIC X       VALUE '0'.
  1465     12  AL-SANON            PIC X       VALUE '1'.
  1466     12  AL-UABOF            PIC X       VALUE 'H'.
  1467     12  AL-UABON            PIC X       VALUE 'I'.
  1468     12  AL-UADOF            PIC X       VALUE '<'.
  1469     12  AL-UADON            PIC X       VALUE '('.
  1470     12  AL-UANOF            PIC X       VALUE ' '.
  1471     12  AL-UANON            PIC X       VALUE 'A'.
  1472     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1473     12  AL-UNBON            PIC X       VALUE 'R'.
  1474     12  AL-UNDOF            PIC X       VALUE '*'.
  1475     12  AL-UNDON            PIC X       VALUE ')'.
  1476     12  AL-UNNOF            PIC X       VALUE '&'.
  1477     12  AL-UNNON            PIC X       VALUE 'J'.
  1478*    COPY ELCAID.
  1479******************************************************************
  1480*                                                                *
  1481*                            ELCAID.                             *
  1482*                            VMOD=2.001                          *
  1483*                                                                *
  1484*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1485*                                                                *
  1486*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1487*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1488******************************************************************
  1489
  1490 01  DFHAID.
  1491   02  DFHNULL   PIC  X  VALUE  ' '.
  1492   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1493   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1494   02  DFHPEN    PIC  X  VALUE  '='.
  1495   02  DFHOPID   PIC  X  VALUE  'W'.
  1496   02  DFHPA1    PIC  X  VALUE  '%'.
  1497   02  DFHPA2    PIC  X  VALUE  '>'.
  1498   02  DFHPA3    PIC  X  VALUE  ','.
  1499   02  DFHPF1    PIC  X  VALUE  '1'.
  1500   02  DFHPF2    PIC  X  VALUE  '2'.
  1501   02  DFHPF3    PIC  X  VALUE  '3'.
  1502   02  DFHPF4    PIC  X  VALUE  '4'.
  1503   02  DFHPF5    PIC  X  VALUE  '5'.
  1504   02  DFHPF6    PIC  X  VALUE  '6'.
  1505   02  DFHPF7    PIC  X  VALUE  '7'.
  1506   02  DFHPF8    PIC  X  VALUE  '8'.
  1507   02  DFHPF9    PIC  X  VALUE  '9'.
  1508   02  DFHPF10   PIC  X  VALUE  ':'.
  1509   02  DFHPF11   PIC  X  VALUE  '#'.
  1510   02  DFHPF12   PIC  X  VALUE  '@'.
  1511   02  DFHPF13   PIC  X  VALUE  'A'.
  1512   02  DFHPF14   PIC  X  VALUE  'B'.
  1513   02  DFHPF15   PIC  X  VALUE  'C'.
  1514   02  DFHPF16   PIC  X  VALUE  'D'.
  1515   02  DFHPF17   PIC  X  VALUE  'E'.
  1516   02  DFHPF18   PIC  X  VALUE  'F'.
  1517   02  DFHPF19   PIC  X  VALUE  'G'.
  1518   02  DFHPF20   PIC  X  VALUE  'H'.
  1519   02  DFHPF21   PIC  X  VALUE  'I'.
  1520*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1521   02  DFHPF22   PIC  X  VALUE  '['.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL614.cbl
  1522   02  DFHPF23   PIC  X  VALUE  '.'.
  1523   02  DFHPF24   PIC  X  VALUE  '<'.
  1524   02  DFHMSRE   PIC  X  VALUE  'X'.
  1525   02  DFHSTRF   PIC  X  VALUE  'h'.
  1526   02  DFHTRIG   PIC  X  VALUE  '"'.
  1527 01  FILLER    REDEFINES DFHAID.
  1528     05  FILLER                      PIC X(8).
  1529     05  PF-VALUES                   PIC X
  1530         OCCURS 24 TIMES.
  1531****************************************************************
  1532*
  1533* Copyright (c) 2007 by Clerity Solutions, Inc.
  1534* All rights reserved.
  1535*
  1536****************************************************************
  1537 01  DFHEIV.
  1538   02  DFHEIV0               PIC X(35).
  1539   02  DFHEIV1               PIC X(08).
  1540   02  DFHEIV2               PIC X(08).
  1541   02  DFHEIV3               PIC X(08).
  1542   02  DFHEIV4               PIC X(06).
  1543   02  DFHEIV5               PIC X(04).
  1544   02  DFHEIV6               PIC X(04).
  1545   02  DFHEIV7               PIC X(02).
  1546   02  DFHEIV8               PIC X(02).
  1547   02  DFHEIV9               PIC X(01).
  1548   02  DFHEIV10              PIC S9(7) COMP-3.
  1549   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1550   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1551   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1552   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1553   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1554   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1555   02  DFHEIV17              PIC X(04).
  1556   02  DFHEIV18              PIC X(04).
  1557   02  DFHEIV19              PIC X(04).
  1558   02  DFHEIV20              USAGE IS POINTER.
  1559   02  DFHEIV21              USAGE IS POINTER.
  1560   02  DFHEIV22              USAGE IS POINTER.
  1561   02  DFHEIV23              USAGE IS POINTER.
  1562   02  DFHEIV24              USAGE IS POINTER.
  1563   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1564   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1565   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1566   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1567   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1568   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1569   02  FILLER                PIC X(02).
  1570   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1571   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1572   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1573   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1574   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1575 LINKAGE  SECTION.
  1576*****************************************************************
  1577*                                                               *
  1578* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1579* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL614.cbl
  1580*                                                               *
  1581*****************************************************************
  1582 01  dfheiblk.
  1583     02  eibtime          pic s9(7) comp-3.
  1584     02  eibdate          pic s9(7) comp-3.
  1585     02  eibtrnid         pic x(4).
  1586     02  eibtaskn         pic s9(7) comp-3.
  1587     02  eibtrmid         pic x(4).
  1588     02  dfheigdi         pic s9(4) comp.
  1589     02  eibcposn         pic s9(4) comp.
  1590     02  eibcalen         pic s9(4) comp.
  1591     02  eibaid           pic x(1).
  1592     02  eibfiller1       pic x(1).
  1593     02  eibfn            pic x(2).
  1594     02  eibfiller2       pic x(2).
  1595     02  eibrcode         pic x(6).
  1596     02  eibfiller3       pic x(2).
  1597     02  eibds            pic x(8).
  1598     02  eibreqid         pic x(8).
  1599     02  eibrsrce         pic x(8).
  1600     02  eibsync          pic x(1).
  1601     02  eibfree          pic x(1).
  1602     02  eibrecv          pic x(1).
  1603     02  eibsend          pic x(1).
  1604     02  eibatt           pic x(1).
  1605     02  eibeoc           pic x(1).
  1606     02  eibfmh           pic x(1).
  1607     02  eibcompl         pic x(1).
  1608     02  eibsig           pic x(1).
  1609     02  eibconf          pic x(1).
  1610     02  eiberr           pic x(1).
  1611     02  eibrldbk         pic x(1).
  1612     02  eiberrcd         pic x(4).
  1613     02  eibsynrb         pic x(1).
  1614     02  eibnodat         pic x(1).
  1615     02  eibfiller5       pic x(2).
  1616     02  eibresp          pic 9(09) comp.
  1617     02  eibresp2         pic 9(09) comp.
  1618     02  dfheigdj         pic s9(4) comp.
  1619     02  dfheigdk         pic s9(4) comp.
  1620 01  DFHCOMMAREA                     PIC X(1024).
  1621 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1622 0000-DFHEXIT SECTION.
  1623     MOVE '9#                    $   ' TO DFHEIV0.
  1624     MOVE 'EL614' TO DFHEIV1.
  1625     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1626     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1627     MOVE '5'                   TO DC-OPTION-CODE.
  1628     PERFORM 8500-DATE-CONVERSION
  1629                                THRU 8500-EXIT
  1630     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1631     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1632     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1633     MOVE +1                    TO  EMI-NUMBER-OF-LINES
  1634                                    EMI-SWITCH2.
  1635     IF EIBCALEN NOT > ZERO
  1636        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1637        GO TO 8300-SEND-TEXT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL614.cbl
  1638     END-IF
  1639
  1640* EXEC CICS HANDLE CONDITION
  1641*        PGMIDERR (9600-PGMIDERR)
  1642*        ERROR    (9990-ERROR)
  1643*    END-EXEC
  1644*    MOVE '"$L.                  ! " #00001635' TO DFHEIV0
  1645     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1647     MOVE X'2220233030303031363335' TO DFHEIV0(25:11)
  1648     CALL 'kxdfhei1' USING DFHEIV0
  1649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1650     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1651        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1652           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1653           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1654           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1655           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1656           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1657           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1658           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1659           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1660        ELSE
  1661           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1662           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1663           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1664           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1665           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1666           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1667           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1668           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1669        END-IF
  1670     END-IF
  1671     IF EIBTRNID NOT = WS-TRANS-ID
  1672        GO TO 1000-INITIAL-SCREEN
  1673     END-IF
  1674     IF EIBAID = DFHCLEAR
  1675        GO TO 9400-CLEAR
  1676     END-IF
  1677     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1678        MOVE LOW-VALUES          TO EL614AO
  1679        MOVE -1                  TO APFKL
  1680        MOVE ER-0008             TO EMI-ERROR
  1681        GO TO 8200-SEND-DATAONLY
  1682     END-IF
  1683
  1684* EXEC CICS RECEIVE
  1685*        INTO   (EL614AO)
  1686*        MAPSET (WS-MAPSET-NAME)
  1687*        MAP    (WS-MAP-NAME)
  1688*    END-EXEC
  1689     MOVE LENGTH OF
  1690      EL614AO
  1691       TO DFHEIV11
  1692*    MOVE '8"T I  L              ''   #00001672' TO DFHEIV0
  1693     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1695     MOVE X'2020233030303031363732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL614.cbl
  1696     CALL 'kxdfhei1' USING DFHEIV0,
  1697           WS-MAP-NAME,
  1698           EL614AO,
  1699           DFHEIV11,
  1700           WS-MAPSET-NAME,
  1701           DFHEIV99,
  1702           DFHEIV99
  1703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1704     display ' received map ' el614ao
  1705     IF APFKL > ZERO
  1706        IF EIBAID NOT = DFHENTER
  1707           MOVE ER-0004          TO EMI-ERROR
  1708           MOVE AL-UNBOF         TO APFKA
  1709           MOVE -1               TO APFKL
  1710           GO TO 8200-SEND-DATAONLY
  1711        ELSE
  1712           IF APFKO NUMERIC AND
  1713              (APFKO > ZERO AND LESS '25')
  1714              MOVE PF-VALUES (APFKI)
  1715                                 TO  EIBAID
  1716           ELSE
  1717              MOVE ER-0029       TO  EMI-ERROR
  1718              MOVE AL-UNBOF      TO  APFKA
  1719              MOVE -1            TO  APFKL
  1720              GO TO 8200-SEND-DATAONLY
  1721           END-IF
  1722        END-IF
  1723     END-IF
  1724     IF EIBAID = DFHPF12
  1725        MOVE 'EL010'             TO THIS-PGM
  1726        GO TO 9300-XCTL
  1727     END-IF
  1728     IF EIBAID = DFHPF23
  1729        GO TO 9000-RETURN-CICS
  1730     END-IF
  1731     IF EIBAID = DFHPF24
  1732        IF CREDIT-SESSION
  1733           MOVE 'EL626'          TO THIS-PGM
  1734           GO TO 9300-XCTL
  1735        ELSE
  1736           MOVE 'EL126'          TO THIS-PGM
  1737           GO TO 9300-XCTL
  1738        END-IF
  1739     END-IF
  1740     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2
  1741        OR DFHPF3 OR DFHPF4
  1742        CONTINUE
  1743     ELSE
  1744        MOVE ER-0008             TO EMI-ERROR
  1745        MOVE -1                  TO APFKL
  1746        GO TO 8200-SEND-DATAONLY
  1747     END-IF
  1748     IF EIBAID = DFHPF1 OR DFHPF2 OR DFHPF3
  1749        OR DFHPF4 OR DFHENTER
  1750        MOVE 'S'                 TO PI-MODE
  1751     ELSE
  1752        MOVE AL-UABOF            TO APFKA
  1753        MOVE -1                  TO APFKL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL614.cbl
  1754        MOVE ER-0023             TO EMI-ERROR
  1755        PERFORM 9900-ERROR-FORMAT
  1756     END-IF
  1757     IF EMI-FATAL-CTR > ZERO
  1758        GO TO 8200-SEND-DATAONLY
  1759     END-IF
  1760     IF PI-MODE EQUAL 'S'
  1761        GO TO 2000-PROCESS-SHOW
  1762     END-IF
  1763     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL614'
  1764                                 TO LOGOFF-MSG
  1765     GO TO 8300-SEND-TEXT
  1766     .
  1767 1000-INITIAL-SCREEN.
  1768     DISPLAY ' MADE 1000 INITIAL '
  1769     MOVE PI-PROGRAM-WORK-AREA (1:60)
  1770                                 TO WS-PASSED-FROM-CALL-PGM
  1771     EVALUATE TRUE
  1772        WHEN PI-RETURN-TO-PROGRAM = 'EL156'
  1773           MOVE WS-PASSED-FROM-CALL-PGM
  1774                                 TO PI-PROGRAM-WORK-AREA
  1775           MOVE '1'              TO PI-RECORD-TYPE
  1776        WHEN PI-RETURN-TO-PROGRAM = 'EL6316'
  1777           MOVE WS-PASSED-FROM-CALL-PGM
  1778                                 TO PI-PROGRAM-WORK-AREA
  1779           MOVE '4'              TO PI-RECORD-TYPE
  1780           DISPLAY ' MOVING 4 TO RECORD TYPE '
  1781        WHEN PI-RETURN-TO-PROGRAM = 'EL6317'
  1782           MOVE WS-PASSED-FROM-CALL-PGM
  1783                                 TO PI-PROGRAM-WORK-AREA
  1784           MOVE '2'              TO PI-RECORD-TYPE
  1785           DISPLAY ' MOVING 2 TO RECORD TYPE '
  1786        WHEN PI-RETURN-TO-PROGRAM = 'EL6318'
  1787           MOVE WS-PASSED-FROM-CALL-PGM
  1788                                 TO PI-PROGRAM-WORK-AREA
  1789           MOVE '3'              TO PI-RECORD-TYPE
  1790           DISPLAY ' MOVING 3 TO RECORD TYPE '
  1791        WHEN OTHER
  1792           MOVE SPACES           TO PI-PROGRAM-WORK-AREA
  1793                                    WS-PASSED-FROM-CALL-PGM
  1794                                    PI-RECORD-TYPE
  1795     END-EVALUATE
  1796     MOVE PI-COMPANY-CD          TO PI-DN-TOP-KEY (1:1)
  1797                                    PI-DN-BOT-KEY (1:1)
  1798                                    WS-ELEOBC-KEY
  1799     MOVE PI-RECORD-TYPE         TO WS-EOB-REC-TYPE
  1800                                    PI-DN-TOP-KEY (2:1)
  1801                                    PI-DN-BOT-KEY (2:1)
  1802     MOVE ZERO                   TO PI-1ST-TIME-SW
  1803                                    PI-LINE-COUNT
  1804                                    PI-BROWSE-SW
  1805                                    PI-SHOW-SW
  1806                                    PI-CHANGE-SW
  1807     MOVE LOW-VALUES             TO EL614AO
  1808     GO TO 7000-BROWSE-FWD
  1809     .
  1810 2000-PROCESS-SHOW.
  1811**  THE FIRST THING TO DO IS CHECK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL614.cbl
  1812**  FOR PF4 (CLEAR SELECTED CODES) IF PRESSED
  1813**  SPACE OUT THE PRIOR SELECTIONS. NEXT CHECK
  1814**  THE SELECTED CODES
  1815**  AGAINST THE TABLE AND SYNC THEM UP.
  1816**  IF THEY SPACE ONE OUT THEN GET RID OF IT FROM THE
  1817**  TABLE
  1818     display ' made it to 2000 process '
  1819     IF EIBAID = DFHPF4
  1820        MOVE SPACES              TO PI-SELECTED-EOB-CODES
  1821        MOVE PI-COMPANY-CD    TO WS-ELEOBC-KEY
  1822        GO TO 7000-BROWSE-FWD
  1823     END-IF
  1824     display ' 2000 return to pgm ' pi-return-to-program
  1825     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317' OR 'EL6318'
  1826        OR 'EL6316'
  1827        display ' made past if '
  1828        PERFORM VARYING M1 FROM +1 BY +1 UNTIL
  1829           M1 > +17
  1830           IF SELL (M1) > +0
  1831              display ' sell > 0 ' sell (m1)
  1832              IF SELI (M1) = SPACES
  1833                display ' sell = sp ' sell (m1)
  1834                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1835                    E1 > +12
  1836                    IF PI-EOB-CODE (E1) = RCODEI (M1)
  1837                       MOVE SPACES TO PI-EOB-CODE (E1)
  1838                    END-IF
  1839                 END-PERFORM
  1840              ELSE
  1841                 MOVE ' '       TO WS-DUP-EOB-SW
  1842                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1843                    E1 > +12
  1844                    IF RCODEI (M1) = PI-EOB-CODE (E1)
  1845                      display ' rcd = pi '
  1846                       SET FOUND-DUP-EOB TO TRUE
  1847                    END-IF
  1848                 END-PERFORM
  1849                 IF NOT FOUND-DUP-EOB
  1850                   display ' no dups '
  1851                    PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1852                       (PI-EOB-CODE (E1) = SPACES)
  1853                       OR (E1 > +12)
  1854                    END-PERFORM
  1855                    IF E1 < +13
  1856                      display ' e1 < 13 ' rcodei (m1)
  1857                       MOVE RCODEI (M1) TO PI-EOB-CODE (E1)
  1858                    END-IF
  1859                 END-IF
  1860              END-IF
  1861           END-IF
  1862        END-PERFORM
  1863     END-IF
  1864     display ' eob codes ' PI-SELECTED-EOB-CODES
  1865     EVALUATE TRUE
  1866        WHEN EIBAID = DFHPF2
  1867           MOVE PI-DN-TOP-KEY    TO WS-ELEOBC-KEY
  1868           GO TO 8000-BROWSE-BWD
  1869        WHEN EIBAID = DFHPF1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL614.cbl
  1870           MOVE PI-DN-BOT-KEY    TO WS-ELEOBC-KEY
  1871           GO TO 7000-BROWSE-FWD
  1872        WHEN EIBAID = DFHPF3
  1873           PERFORM 6100-FORMAT-EOB-CODES
  1874                                 THRU 6100-EXIT
  1875           GO TO 9400-CLEAR
  1876        WHEN OTHER
  1877*          MOVE PI-COMPANY-CD    TO WS-ELEOBC-KEY
  1878*          GO TO 7000-BROWSE-FWD
  1879           MOVE -1 TO SELL (1)
  1880           GO TO 8200-SEND-DATAONLY
  1881     END-EVALUATE
  1882     .
  1883 6100-FORMAT-EOB-CODES.
  1884**  THIS ROUTINE JUST ELIMINATES ANY EOB CODES THAT
  1885**  WERE "UN SELECTED"
  1886     display ' made it to 6100 '
  1887     MOVE SPACES                 TO WS-SELECTED-EOB-CODES
  1888     MOVE +1                     TO E1 S1
  1889     PERFORM UNTIL E1 > +12
  1890        IF PI-EOB-CODE (E1) NOT = SPACES
  1891           MOVE PI-EOB-CODE (E1) TO WS-SEL-EOB-CODE (S1)
  1892           ADD +1                TO S1
  1893        END-IF
  1894        ADD +1                   TO E1
  1895     END-PERFORM
  1896     MOVE WS-SELECTED-EOB-CODES  TO PI-SELECTED-EOB-CODES
  1897     .
  1898 6100-EXIT.
  1899     EXIT.
  1900 7000-BROWSE-FWD.
  1901     SET M1  TO +1
  1902
  1903* EXEC CICS STARTBR
  1904*        DATASET   ('ELEOBC')
  1905*        RIDFLD    (WS-ELEOBC-KEY)
  1906*        GTEQ
  1907*        RESP      (WS-RESPONSE)
  1908*    END-EXEC
  1909     MOVE 'ELEOBC' TO DFHEIV1
  1910     MOVE 0
  1911       TO DFHEIV11
  1912*    MOVE '&,         G          &  N#00001875' TO DFHEIV0
  1913     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1915     MOVE X'204E233030303031383735' TO DFHEIV0(25:11)
  1916     CALL 'kxdfhei1' USING DFHEIV0,
  1917           DFHEIV1,
  1918           WS-ELEOBC-KEY,
  1919           DFHEIV99,
  1920           DFHEIV11,
  1921           DFHEIV99
  1922     MOVE EIBRESP  TO WS-RESPONSE
  1923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1924     EVALUATE TRUE
  1925        WHEN RESP-ENDFILE
  1926           GO TO 7030-END-FILE
  1927        WHEN RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL614.cbl
  1928           CONTINUE
  1929        WHEN RESP-NOTFND
  1930           GO TO 7040-NOT-FOUND
  1931     END-EVALUATE
  1932     MOVE LOW-VALUES             TO EL614AO
  1933     MOVE ZERO                   TO PI-LINE-COUNT
  1934     MOVE +1                     TO PI-BROWSE-SW
  1935     MOVE +0                     TO CI1
  1936     .
  1937 7010-READ-NEXT.
  1938
  1939* EXEC CICS READNEXT
  1940*        INTO    (EOB-CODES)
  1941*        DATASET ('ELEOBC')
  1942*        RIDFLD  (WS-ELEOBC-KEY)
  1943*        RESP    (WS-RESPONSE)
  1944*    END-EXEC
  1945     MOVE LENGTH OF
  1946      EOB-CODES
  1947       TO DFHEIV12
  1948     MOVE 'ELEOBC' TO DFHEIV1
  1949     MOVE 0
  1950       TO DFHEIV11
  1951*    MOVE '&.IL                  )  N#00001895' TO DFHEIV0
  1952     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1953     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1954     MOVE X'204E233030303031383935' TO DFHEIV0(25:11)
  1955     CALL 'kxdfhei1' USING DFHEIV0,
  1956           DFHEIV1,
  1957           EOB-CODES,
  1958           DFHEIV12,
  1959           WS-ELEOBC-KEY,
  1960           DFHEIV99,
  1961           DFHEIV11,
  1962           DFHEIV99,
  1963           DFHEIV99
  1964     MOVE EIBRESP  TO WS-RESPONSE
  1965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1966     DISPLAY ' READ NEXT ' WS-ELEOBC-KEY (2:14) ' '
  1967        ws-response
  1968     display ' pi record type ' pi-record-type
  1969     display ' return to      ' pi-return-to-program
  1970     EVALUATE TRUE
  1971        WHEN RESP-ENDFILE
  1972           GO TO 7030-END-FILE
  1973        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  1974           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  1975               AND (PI-RECORD-TYPE NOT = SPACES))
  1976           GO TO 7030-END-FILE
  1977        WHEN RESP-NORMAL
  1978           CONTINUE
  1979        WHEN RESP-NOTFND
  1980           GO TO 7040-NOT-FOUND
  1981        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  1982           GO TO 7030-END-FILE
  1983     END-EVALUATE
  1984     ADD +1                      TO WS-RECORD-COUNT
  1985                                    CI1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL614.cbl
  1986     MOVE EO-CONTROL-PRIMARY     TO PI-DN-BOT-KEY
  1987     MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  1988     MOVE EO-EOB-CODE         TO RCODEO (M1)
  1989     MOVE EO-DESCRIPTION         TO DESCO (M1)
  1990     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317' OR 'EL6318'
  1991        OR 'EL6316'
  1992        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1993           E1 > +12
  1994           IF EO-EOB-CODE = PI-EOB-CODE (E1)
  1995              MOVE 'S'           TO SELI (M1)
  1996              MOVE +1            TO SELL (M1)
  1997           END-IF
  1998        END-PERFORM
  1999     END-IF
  2000     IF M1 = +1
  2001        MOVE EO-CONTROL-PRIMARY  TO PI-DN-TOP-KEY
  2002     END-IF
  2003     IF M1 < +17
  2004        SET M1 UP BY +1
  2005        GO TO 7010-READ-NEXT
  2006     END-IF
  2007     IF PI-BROWSE-SW = +1
  2008
  2009* EXEC CICS ENDBR
  2010*          DATASET ('ELEOBC')
  2011*       END-EXEC
  2012     MOVE 'ELEOBC' TO DFHEIV1
  2013     MOVE 0
  2014       TO DFHEIV11
  2015*    MOVE '&2                    $   #00001943' TO DFHEIV0
  2016     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2017     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2018     MOVE X'2020233030303031393433' TO DFHEIV0(25:11)
  2019     CALL 'kxdfhei1' USING DFHEIV0,
  2020           DFHEIV1,
  2021           DFHEIV11,
  2022           DFHEIV99
  2023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2024        MOVE +0                  TO PI-BROWSE-SW
  2025     END-IF
  2026     MOVE ER-0000                TO EMI-ERROR
  2027     GO TO 8100-SEND-INITIAL-MAP
  2028     .
  2029 7030-END-FILE.
  2030     IF EMI-ERROR = ER-1257
  2031        MOVE ER-7220             TO  EMI-ERROR
  2032     ELSE
  2033        MOVE ER-1258             TO  EMI-ERROR
  2034     END-IF
  2035     MOVE -1                     TO  APFKL
  2036     MOVE AL-UABOF               TO  APFKA
  2037     GO TO 8100-SEND-INITIAL-MAP
  2038     .
  2039 7040-NOT-FOUND.
  2040     MOVE ER-0006                TO  EMI-ERROR
  2041     MOVE -1                     TO  APFKL
  2042     MOVE AL-UABOF               TO  APFKA
  2043     IF EIBTRNID NOT = WS-TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL614.cbl
  2044        GO TO 8100-SEND-INITIAL-MAP
  2045     ELSE
  2046        GO TO 8200-SEND-DATAONLY
  2047     END-IF
  2048     .
  2049*****************************************************************
  2050 8000-BROWSE-BWD.
  2051*****************************************************************
  2052     SET M1                      TO +17
  2053     MOVE +18                    TO CI1
  2054
  2055* EXEC CICS STARTBR
  2056*       DATASET ('ELEOBC')
  2057*       RIDFLD  (WS-ELEOBC-KEY)
  2058*       GTEQ
  2059*       RESP    (WS-RESPONSE)
  2060*    END-EXEC
  2061     MOVE 'ELEOBC' TO DFHEIV1
  2062     MOVE 0
  2063       TO DFHEIV11
  2064*    MOVE '&,         G          &  N#00001976' TO DFHEIV0
  2065     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2066     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2067     MOVE X'204E233030303031393736' TO DFHEIV0(25:11)
  2068     CALL 'kxdfhei1' USING DFHEIV0,
  2069           DFHEIV1,
  2070           WS-ELEOBC-KEY,
  2071           DFHEIV99,
  2072           DFHEIV11,
  2073           DFHEIV99
  2074     MOVE EIBRESP  TO WS-RESPONSE
  2075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2076     EVALUATE TRUE
  2077        WHEN RESP-ENDFILE
  2078           GO TO 8020-END-FILE
  2079        WHEN RESP-NORMAL
  2080           CONTINUE
  2081        WHEN RESP-NOTFND
  2082           GO TO 8030-NOT-FOUND
  2083     END-EVALUATE
  2084     MOVE LOW-VALUES             TO EL614AO
  2085     MOVE ZERO                   TO PI-LINE-COUNT
  2086     MOVE +1                     TO PI-BROWSE-SW
  2087     .
  2088 8010-READ-PREV.
  2089
  2090* EXEC CICS READPREV
  2091*       INTO    (EOB-CODES)
  2092*       DATASET ('ELEOBC')
  2093*       RIDFLD  (WS-ELEOBC-KEY)
  2094*       RESP    (WS-RESPONSE)
  2095*    END-EXEC
  2096     MOVE LENGTH OF
  2097      EOB-CODES
  2098       TO DFHEIV12
  2099     MOVE 'ELEOBC' TO DFHEIV1
  2100     MOVE 0
  2101       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL614.cbl
  2102*    MOVE '&0IL                  )  N#00001995' TO DFHEIV0
  2103     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
  2104     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2105     MOVE X'204E233030303031393935' TO DFHEIV0(25:11)
  2106     CALL 'kxdfhei1' USING DFHEIV0,
  2107           DFHEIV1,
  2108           EOB-CODES,
  2109           DFHEIV12,
  2110           WS-ELEOBC-KEY,
  2111           DFHEIV99,
  2112           DFHEIV11,
  2113           DFHEIV99,
  2114           DFHEIV99
  2115     MOVE EIBRESP  TO WS-RESPONSE
  2116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2117     EVALUATE TRUE
  2118        WHEN RESP-ENDFILE
  2119           GO TO 8020-END-FILE
  2120        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2121           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2122               AND (PI-RECORD-TYPE NOT = SPACES))
  2123           GO TO 8020-END-FILE
  2124        WHEN RESP-NORMAL
  2125           CONTINUE
  2126        WHEN RESP-NOTFND
  2127           GO TO 8030-NOT-FOUND
  2128     END-EVALUATE
  2129     IF EO-COMPANY-CD NOT = PI-COMPANY-CD
  2130        GO TO 8020-END-FILE
  2131     END-IF
  2132     ADD +1                      TO WS-RECORD-COUNT
  2133     SUBTRACT +1                 FROM CI1
  2134     MOVE EO-CONTROL-PRIMARY     TO PI-DN-TOP-KEY
  2135     MOVE EO-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2136     MOVE EO-EOB-CODE            TO RCODEO (M1)
  2137     MOVE EO-DESCRIPTION         TO DESCO  (M1)
  2138     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317' OR 'EL6318'
  2139        OR 'EL6316'
  2140        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2141           E1 > +12
  2142           IF EO-EOB-CODE = PI-EOB-CODE (E1)
  2143              MOVE 'S'           TO SELI (M1)
  2144              MOVE +1            TO SELL (M1)
  2145           END-IF
  2146        END-PERFORM
  2147     END-IF
  2148     IF M1 = +17
  2149        MOVE EO-CONTROL-PRIMARY  TO PI-DN-BOT-KEY
  2150     END-IF
  2151     IF M1 > +1
  2152        SET M1                   DOWN BY +1
  2153        GO TO 8010-READ-PREV
  2154     END-IF
  2155     IF PI-BROWSE-SW = +1
  2156
  2157* EXEC CICS ENDBR
  2158*          DATASET ('ELEOBC')
  2159*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL614.cbl
  2160     MOVE 'ELEOBC' TO DFHEIV1
  2161     MOVE 0
  2162       TO DFHEIV11
  2163*    MOVE '&2                    $   #00002040' TO DFHEIV0
  2164     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2165     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2166     MOVE X'2020233030303032303430' TO DFHEIV0(25:11)
  2167     CALL 'kxdfhei1' USING DFHEIV0,
  2168           DFHEIV1,
  2169           DFHEIV11,
  2170           DFHEIV99
  2171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2172        MOVE +0                  TO PI-BROWSE-SW
  2173     END-IF
  2174     MOVE ER-0000                TO EMI-ERROR
  2175     GO TO 8100-SEND-INITIAL-MAP
  2176     .
  2177 8020-END-FILE.
  2178     IF M1 > +1
  2179        MOVE PI-DN-TOP-KEY       TO WS-ELEOBC-KEY
  2180        MOVE ER-1257             TO EMI-ERROR
  2181        GO TO 7000-BROWSE-FWD
  2182     END-IF
  2183     MOVE ER-1257                TO EMI-ERROR
  2184     MOVE -1                     TO  APFKL
  2185     MOVE AL-UABOF               TO  APFKA
  2186     GO TO 8100-SEND-INITIAL-MAP
  2187     .
  2188 8030-NOT-FOUND.
  2189     MOVE ER-0006                TO  EMI-ERROR
  2190     MOVE -1                     TO  APFKL
  2191     MOVE AL-UABOF               TO  APFKA
  2192     GO TO 8200-SEND-DATAONLY
  2193     .
  2194*****************************************************************
  2195 8100-SEND-INITIAL-MAP.
  2196*****************************************************************
  2197     MOVE -1                     TO  APFKL.
  2198     MOVE ZERO                   TO  PI-BROWSE-SW.
  2199     MOVE SAVE-DATE              TO  ADATEO.
  2200     MOVE EIBTIME                TO  TIME-IN.
  2201     MOVE TIME-OUT               TO  ATIMEO.
  2202     IF EMI-ERROR NOT = ZERO
  2203         PERFORM 9900-ERROR-FORMAT
  2204     END-IF
  2205     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO
  2206     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2207           'EL6318' AND 'EL6316'
  2208        MOVE AL-SADOF            TO SELHA
  2209                                    F3KEYA
  2210        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2211           S1 > +17
  2212           MOVE AL-SADOF         TO SELA (S1)
  2213        END-PERFORM
  2214     END-IF
  2215
  2216* EXEC CICS SEND
  2217*        FROM   (EL614AO)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL614.cbl
  2218*        MAPSET (WS-MAPSET-NAME)
  2219*        MAP    (WS-MAP-NAME)
  2220*        CURSOR ERASE
  2221*    END-EXEC.
  2222     MOVE LENGTH OF
  2223      EL614AO
  2224       TO DFHEIV12
  2225     MOVE -1
  2226       TO DFHEIV11
  2227*    MOVE '8$     CT  E    H L F ,   #00002086' TO DFHEIV0
  2228     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2229     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2230     MOVE X'2020233030303032303836' TO DFHEIV0(25:11)
  2231     CALL 'kxdfhei1' USING DFHEIV0,
  2232           WS-MAP-NAME,
  2233           EL614AO,
  2234           DFHEIV12,
  2235           WS-MAPSET-NAME,
  2236           DFHEIV99,
  2237           DFHEIV99,
  2238           DFHEIV99,
  2239           DFHEIV11,
  2240           DFHEIV99,
  2241           DFHEIV99,
  2242           DFHEIV99
  2243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2244
  2245     GO TO 9100-RETURN-TRAN
  2246     .
  2247 8100-EXIT.
  2248      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL614.cbl
  2250*****************************************************************
  2251 8200-SEND-DATAONLY.
  2252*****************************************************************
  2253     MOVE SAVE-DATE              TO  ADATEO.
  2254     MOVE EIBTIME                TO  TIME-IN.
  2255     MOVE TIME-OUT               TO  ATIMEO.
  2256     IF EMI-ERROR NOT = ZERO
  2257         PERFORM 9900-ERROR-FORMAT.
  2258     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO.
  2259     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2260           'EL6318' AND 'EL6316'
  2261        MOVE AL-SADOF            TO SELHA
  2262                                    F3KEYA
  2263        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2264           S1 > +17
  2265           MOVE AL-SADOF         TO SELA (S1)
  2266        END-PERFORM
  2267     END-IF
  2268
  2269* EXEC CICS SEND DATAONLY
  2270*        FROM   (EL614AO)
  2271*        MAPSET (WS-MAPSET-NAME)
  2272*        MAP    (WS-MAP-NAME)
  2273*        CURSOR
  2274*    END-EXEC.
  2275     MOVE LENGTH OF
  2276      EL614AO
  2277       TO DFHEIV12
  2278     MOVE -1
  2279       TO DFHEIV11
  2280*    MOVE '8$D    CT       H L F ,   #00002115' TO DFHEIV0
  2281     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2282     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2283     MOVE X'2020233030303032313135' TO DFHEIV0(25:11)
  2284     CALL 'kxdfhei1' USING DFHEIV0,
  2285           WS-MAP-NAME,
  2286           EL614AO,
  2287           DFHEIV12,
  2288           WS-MAPSET-NAME,
  2289           DFHEIV99,
  2290           DFHEIV99,
  2291           DFHEIV99,
  2292           DFHEIV11,
  2293           DFHEIV99,
  2294           DFHEIV99,
  2295           DFHEIV99
  2296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2297
  2298     GO TO 9100-RETURN-TRAN
  2299     .
  2300 8200-EXIT.
  2301      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL614.cbl
  2303*****************************************************************
  2304 8300-SEND-TEXT.
  2305*****************************************************************
  2306
  2307* EXEC CICS SEND TEXT
  2308*        FROM   (LOGOFF-TEXT)
  2309*        LENGTH (LOGOFF-LENGTH)
  2310*        ERASE  FREEKB
  2311*    END-EXEC.
  2312*    MOVE '8&      T  E F  H   F -   #00002129' TO DFHEIV0
  2313     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2314     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2315     MOVE X'2020233030303032313239' TO DFHEIV0(25:11)
  2316     CALL 'kxdfhei1' USING DFHEIV0,
  2317           LOGOFF-TEXT,
  2318           LOGOFF-LENGTH,
  2319           DFHEIV99,
  2320           DFHEIV99,
  2321           DFHEIV99,
  2322           DFHEIV99,
  2323           DFHEIV99,
  2324           DFHEIV99,
  2325           DFHEIV99,
  2326           DFHEIV99,
  2327           DFHEIV99,
  2328           DFHEIV99
  2329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2330
  2331
  2332* EXEC CICS RETURN
  2333*    END-EXEC.
  2334*    MOVE '.(                    &   #00002134' TO DFHEIV0
  2335     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2336     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2337     MOVE X'2020233030303032313334' TO DFHEIV0(25:11)
  2338     CALL 'kxdfhei1' USING DFHEIV0,
  2339           DFHEIV99,
  2340           DFHEIV99,
  2341           DFHEIV99,
  2342           DFHEIV99,
  2343           DFHEIV99
  2344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2345
  2346 8300-EXIT.
  2347      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL614.cbl
  2349*****************************************************************
  2350 8400-LOG-JOURNAL-RECORD.
  2351*****************************************************************
  2352     IF PI-JOURNAL-FILE-ID = 0
  2353         GO TO 8400-EXIT.
  2354     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2355     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  2356     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2357*    EXEC CICS JOURNAL
  2358*        JFILEID (PI-JOURNAL-FILE-ID)
  2359*        JTYPEID (WS-JOURNAL-TYPE-ID)
  2360*        FROM    (JOURNAL-RECORD)
  2361*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  2362*    END-EXEC.
  2363 8400-EXIT.
  2364      EXIT.
  2365*****************************************************************
  2366 8500-DATE-CONVERSION.
  2367*****************************************************************
  2368
  2369* EXEC CICS LINK
  2370*        PROGRAM  ('ELDATCV')
  2371*        COMMAREA (DATE-CONVERSION-DATA)
  2372*        LENGTH   (DC-COMM-LENGTH)
  2373*    END-EXEC.
  2374     MOVE 'ELDATCV' TO DFHEIV1
  2375*    MOVE '."C                   ''   #00002158' TO DFHEIV0
  2376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2378     MOVE X'2020233030303032313538' TO DFHEIV0(25:11)
  2379     CALL 'kxdfhei1' USING DFHEIV0,
  2380           DFHEIV1,
  2381           DATE-CONVERSION-DATA,
  2382           DC-COMM-LENGTH,
  2383           DFHEIV99,
  2384           DFHEIV99,
  2385           DFHEIV99
  2386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2387
  2388 8500-EXIT.
  2389      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL614.cbl
  2391*****************************************************************
  2392 9000-RETURN-CICS.
  2393*****************************************************************
  2394     MOVE 'EL005'                TO  THIS-PGM.
  2395     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2396     PERFORM 9300-XCTL.
  2397 9000-EXIT.
  2398      EXIT.
  2399*****************************************************************
  2400 9100-RETURN-TRAN.
  2401*****************************************************************
  2402     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2403     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2404
  2405* EXEC CICS RETURN
  2406*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2407*        LENGTH   (PI-COMM-LENGTH)
  2408*        TRANSID  (WS-TRANS-ID)
  2409*    END-EXEC.
  2410*    MOVE '.(CT                  &   #00002179' TO DFHEIV0
  2411     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2413     MOVE X'2020233030303032313739' TO DFHEIV0(25:11)
  2414     CALL 'kxdfhei1' USING DFHEIV0,
  2415           WS-TRANS-ID,
  2416           PROGRAM-INTERFACE-BLOCK,
  2417           PI-COMM-LENGTH,
  2418           DFHEIV99,
  2419           DFHEIV99
  2420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2421
  2422 9100-EXIT.
  2423      EXIT.
  2424*****************************************************************
  2425 9300-XCTL.
  2426*****************************************************************
  2427     MOVE DFHENTER               TO  EIBAID.
  2428
  2429* EXEC CICS XCTL
  2430*        PROGRAM  (THIS-PGM)
  2431*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2432*        LENGTH   (PI-COMM-LENGTH)
  2433*    END-EXEC.
  2434*    MOVE '.$C                   $   #00002190' TO DFHEIV0
  2435     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2437     MOVE X'2020233030303032313930' TO DFHEIV0(25:11)
  2438     CALL 'kxdfhei1' USING DFHEIV0,
  2439           THIS-PGM,
  2440           PROGRAM-INTERFACE-BLOCK,
  2441           PI-COMM-LENGTH
  2442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2443
  2444 9300-EXIT.
  2445      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL614.cbl
  2447*****************************************************************
  2448 9400-CLEAR.
  2449*****************************************************************
  2450     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  2451     display ' el614 - returning to ' this-pgm
  2452     display ' pi 1 60' pi-program-WORK-AREA (1:60)
  2453     PERFORM 9300-XCTL.
  2454 9400-EXIT.
  2455      EXIT.
  2456*****************************************************************
  2457 9600-PGMIDERR.
  2458*****************************************************************
  2459
  2460* EXEC CICS HANDLE CONDITION
  2461*        PGMIDERR (8300-SEND-TEXT)
  2462*    END-EXEC.
  2463*    MOVE '"$L                   ! # #00002210' TO DFHEIV0
  2464     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2466     MOVE X'2320233030303032323130' TO DFHEIV0(25:11)
  2467     CALL 'kxdfhei1' USING DFHEIV0
  2468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2469
  2470     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2471                                     LOGOFF-PGM.
  2472     MOVE 'EL005'                TO  THIS-PGM.
  2473     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2474     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2475     PERFORM 9300-XCTL.
  2476 9600-EXIT.
  2477      EXIT.
  2478*****************************************************************
  2479 9900-ERROR-FORMAT.
  2480*****************************************************************
  2481     IF EMI-ERRORS-COMPLETE
  2482         ADD +1             TO  EMI-FATAL-CTR
  2483         MOVE ZERO          TO  EMI-ERROR
  2484         GO TO 9900-EXIT.
  2485
  2486* EXEC CICS LINK
  2487*        PROGRAM  ('EL001')
  2488*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2489*        LENGTH   (EMI-COMM-LENGTH)
  2490*    END-EXEC.
  2491     MOVE 'EL001' TO DFHEIV1
  2492*    MOVE '."C                   ''   #00002228' TO DFHEIV0
  2493     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2495     MOVE X'2020233030303032323238' TO DFHEIV0(25:11)
  2496     CALL 'kxdfhei1' USING DFHEIV0,
  2497           DFHEIV1,
  2498           ERROR-MESSAGE-INTERFACE-BLOCK,
  2499           EMI-COMM-LENGTH,
  2500           DFHEIV99,
  2501           DFHEIV99,
  2502           DFHEIV99
  2503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2504
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL614.cbl
  2505     MOVE ZERO              TO  EMI-ERROR.
  2506 9900-EXIT.
  2507      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL614.cbl
  2509*****************************************************************
  2510 9990-ERROR.
  2511*****************************************************************
  2512     MOVE DFHEIBLK               TO EMI-LINE1.
  2513
  2514* EXEC CICS LINK
  2515*        PROGRAM   ('EL004')
  2516*        COMMAREA  (EMI-LINE1)
  2517*        LENGTH    (72)
  2518*    END-EXEC.
  2519     MOVE 'EL004' TO DFHEIV1
  2520     MOVE 72
  2521       TO DFHEIV11
  2522*    MOVE '."C                   ''   #00002241' TO DFHEIV0
  2523     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2525     MOVE X'2020233030303032323431' TO DFHEIV0(25:11)
  2526     CALL 'kxdfhei1' USING DFHEIV0,
  2527           DFHEIV1,
  2528           EMI-LINE1,
  2529           DFHEIV11,
  2530           DFHEIV99,
  2531           DFHEIV99,
  2532           DFHEIV99
  2533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2534
  2535     PERFORM 8200-SEND-DATAONLY.
  2536     GO TO 9100-RETURN-TRAN.
  2537 9990-EXIT.
  2538      EXIT.
  2539*****************************************************************
  2540 9995-SECURITY-VIOLATION.
  2541*****************************************************************
  2542*           COPY ELCSCTP.
  2543******************************************************************
  2544*                                                                *
  2545*                            ELCSCTP                             *
  2546*                            VMOD=2.001                          *
  2547*                                                                *
  2548*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2549******************************************************************
  2550
  2551
  2552     MOVE EIBDATE          TO SM-JUL-DATE.
  2553     MOVE EIBTRMID         TO SM-TERMID.
  2554     MOVE THIS-PGM         TO SM-PGM.
  2555     MOVE EIBTIME          TO TIME-IN.
  2556     MOVE TIME-OUT         TO SM-TIME.
  2557     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2558
  2559
  2560* EXEC CICS LINK
  2561*         PROGRAM  ('EL003')
  2562*         COMMAREA (SECURITY-MESSAGE)
  2563*         LENGTH   (80)
  2564*    END-EXEC.
  2565     MOVE 'EL003' TO DFHEIV1
  2566     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL614.cbl
  2567       TO DFHEIV11
  2568*    MOVE '."C                   ''   #00002270' TO DFHEIV0
  2569     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2570     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2571     MOVE X'2020233030303032323730' TO DFHEIV0(25:11)
  2572     CALL 'kxdfhei1' USING DFHEIV0,
  2573           DFHEIV1,
  2574           SECURITY-MESSAGE,
  2575           DFHEIV11,
  2576           DFHEIV99,
  2577           DFHEIV99,
  2578           DFHEIV99
  2579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2580
  2581
  2582******************************************************************
  2583
  2584 9995-EXIT.
  2585      EXIT.
  2586 9999-LAST-PARAGRAPH SECTION.
  2587
  2588* GOBACK.
  2589     MOVE '9%                    "   ' TO DFHEIV0
  2590     MOVE 'EL614' TO DFHEIV1
  2591     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2592     GOBACK.
  2593
  2594 9999-DFHBACK SECTION.
  2595     MOVE '9%                    "   ' TO DFHEIV0
  2596     MOVE 'EL614' TO DFHEIV1
  2597     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2598     GOBACK.
  2599 9999-DFHEXIT.
  2600     IF DFHEIGDJ EQUAL 0001
  2601         NEXT SENTENCE
  2602     ELSE IF DFHEIGDJ EQUAL 2
  2603         GO TO 9600-PGMIDERR,
  2604               9990-ERROR
  2605         DEPENDING ON DFHEIGDI
  2606     ELSE IF DFHEIGDJ EQUAL 3
  2607         GO TO 8300-SEND-TEXT
  2608         DEPENDING ON DFHEIGDI.
  2609     MOVE '9%                    "   ' TO DFHEIV0
  2610     MOVE 'EL614' TO DFHEIV1
  2611     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2612     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6148     Code:        6662
