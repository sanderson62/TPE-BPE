* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL150.cbl
* Options: int("EL150.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL150.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL150.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL150.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL150 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/09/95 16:19:31.
     7*                            VMOD=2.053
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*REMARKS.    TRANSACTION - EX23 - STATUS DISPLAY AND DISPOSITION
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL150.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    22*                              ADJUST REDEFINES EL150AI FILLER
    23* 062602    2002030700006  PEMA  Add note type of 'S'
    24*                                  (special review)
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    26* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    27* 050107    2007041300002  AJRA  PREVENT CHECK FOR NON COVERED CLA
    28* 080106    2006052500001  AJRA  ADD NOTE TYPE N
    29* 041807    2006032200004  AJRA  ADD NOTE TYPE R
    30* 082707    2007032100001  PEMA  ADDITIONAL INTEREST CHANGES
    31* 102809    2008100900003  AJRA  PF19 TO NEW CERT NOTES SCREEN
    32* 042110  CR2008100900001  PEMA  ADD DENIAL TYPE
    33* 113010    2009122800001  AJRA  DISPLAY STOP DATE
    34* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    35* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    36******************************************************************
    37
    38 ENVIRONMENT DIVISION.
    39
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL150.cbl
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL150 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.053 *********'.
    48
    49*                            COPY ELCSCTM.
    50******************************************************************
    51*                                                                *
    52*                                                                *
    53*                            ELCSCTM                             *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    57*                                                                *
    58******************************************************************
    59 01  SECURITY-MESSAGE.
    60     12  FILLER                          PIC X(30)
    61            VALUE '** LOGIC SECURITY VIOLATION -'.
    62     12  SM-READ                         PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' PGM='.
    65     12  SM-PGM                          PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' OPR='.
    68     12  SM-PROCESSOR-ID                 PIC X(4).
    69     12  FILLER                          PIC X(6)
    70            VALUE ' TERM='.
    71     12  SM-TERMID                       PIC X(4).
    72     12  FILLER                          PIC XX   VALUE SPACE.
    73     12  SM-JUL-DATE                     PIC 9(5).
    74     12  FILLER                          PIC X    VALUE SPACE.
    75     12  SM-TIME                         PIC 99.99.
    76
    77
    78*                            COPY ELCSCRTY.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCRTY                            *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    86*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    87*        SAVED IN PI-SECURITY-ADDRESS.                           *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-CONTROL.
    91     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    92     12  FILLER                       PIC XX    VALUE 'SC'.
    93     12  SC-CREDIT-CODES.
    94         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    95             20  SC-CREDIT-DISPLAY    PIC X.
    96             20  SC-CREDIT-UPDATE     PIC X.
    97     12  SC-CLAIMS-CODES.
    98         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL150.cbl
    99             20  SC-CLAIMS-DISPLAY    PIC X.
   100             20  SC-CLAIMS-UPDATE     PIC X.
   101
   102 01  TS-AREA.
   103     05  TS-PI-AREA          PIC X(1024) VALUE LOW-VALUES.
   104     05  TS-PI-SAVE-CLOAN    PIC X(25)   VALUE LOW-VALUES.
   105 01  WS-DATE-AREA.
   106     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   107     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   108
   109 01  STANDARD-AREAS.
   110     12  TS-LENGTH           PIC S9(4)  COMP VALUE +1049.
   111     12  WS-EARNING-METHOD   PIC X      VALUE SPACES.
   112     12  WS-INDEX            PIC S9(04) COMP VALUE +0.
   113     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   114     12  MAP-NAME            PIC X(8)    VALUE 'EL150A'.
   115     12  MAPSET-NAME         PIC X(8)    VALUE 'EL150S'.
   116     12  TRANS-ID            PIC X(4)    VALUE 'EX23'.
   117     12  THIS-PGM            PIC X(8)    VALUE 'EL150'.
   118     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   119     12  PGM-NAME            PIC X(8).
   120     12  TIME-IN             PIC S9(7).
   121     12  TIME-OUT-R  REDEFINES TIME-IN.
   122         16  FILLER          PIC X.
   123         16  TIME-OUT        PIC 99V99.
   124         16  FILLER          PIC XX.
   125     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   126     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   127     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   128     12  XCTL-1273           PIC X(8)    VALUE 'EL1273'.
   129     12  XCTL-EM1273         PIC X(8)    VALUE 'EM1273'.
   130     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   131     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   132     12  XCTL-EM131          PIC X(8)    VALUE 'EM131'.
   133     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   134     12  XCTL-142            PIC X(8)    VALUE 'EL142'.
   135     12  XCTL-1501           PIC X(8)    VALUE 'EL1501'.
   136     12  XCTL-1502           PIC X(8)    VALUE 'EL1502'.
   137     12  XCTL-151            PIC X(8)    VALUE 'EL151'.
   138     12  XCTL-152            PIC X(8)    VALUE 'EL152'.
   139     12  XCTL-153            PIC X(8)    VALUE 'EL153'.
   140     12  XCTL-154            PIC X(8)    VALUE 'EL154'.
   141     12  XCTL-156            PIC X(8)    VALUE 'EL156'.
   142     12  XCTL-EM156          PIC X(8)    VALUE 'EM156'.
   143     12  XCTL-EM1561         PIC X(8)    VALUE 'EM1561'.
   144     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   145     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   146     12  XCTL-158            PIC X(8)    VALUE 'EL158'.
   147     12  XCTL-162            PIC X(8)    VALUE 'EL162'.
   148     12  XCTL-1276           PIC X(8)    VALUE 'EL1276'.
   149     12  XCTL-EM1276         PIC X(8)    VALUE 'EM1276'.
   150     12  XCTL-1279           PIC X(8)    VALUE 'EL1279'.
   151     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   152     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   153     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   154     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   155     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   156     12  FILE-ID             PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL150.cbl
   157     12  EMPHST-FILE-ID      PIC X(8)    VALUE 'MPPHST'.
   158     12  SC-ITEM             PIC S9(4)   VALUE +0001   COMP.
   159
   160 01  WS-HISTORY-AREA                 PIC X(50).
   161 01  WS-FLD1            REDEFINES WS-HISTORY-AREA.
   162     12  FILLER                 PIC X(38).
   163     12  WS-NUMERIC-FLD1        PIC S9(10)V99.
   164 01  WS-FLD2            REDEFINES WS-HISTORY-AREA.
   165     12  FILLER                 PIC X(45).
   166     12  WS-NUMERIC-FLD2        PIC S99V999.
   167 01  WS-FLD3            REDEFINES WS-HISTORY-AREA.
   168     12  FILLER                 PIC X(35).
   169     12  WS-NUMERIC-FLD3        PIC S9(15).
   170 01  WS-FLD4            REDEFINES WS-HISTORY-AREA.
   171     12  FILLER                 PIC X(36).
   172     12  WS-NUMERIC-FLD4        PIC S9(10)V9999.
   173
   174 01  MISC-WORK-AREAS.
   175     12  QID.
   176         16  QID-TERM        PIC X(4).
   177         16  FILLER          PIC X(4)    VALUE '150A'.
   178     12  MAP-LENGTH          PIC S9(4)   VALUE +1920   COMP.
   179     12  PASS-SWITCH         PIC X       VALUE 'A'.
   180     12  SV-LAST-BY          PIC X(4)    VALUE SPACES.
   181     12  SV-LAST-HHMMSS      PIC S9(6)   VALUE +0      COMP-3.
   182     12  SUB-1               PIC S9(4)   VALUE +0    COMP.
   183     12  DISPLAY-CNT         PIC S9(4)   VALUE +1    COMP.
   184     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   185     12  WS-SUB              PIC 9       VALUE 0.
   186     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   187     12  DIRECTION-SWITCH    PIC X       VALUE 'N'.
   188     12  WS-STATUS           PIC X.
   189     12  WS-LF-COVERAGE-TYPE PIC X       VALUE SPACE.
   190     12  WS-REMAINING-AMT    PIC S9(9)V99 VALUE +0.
   191     12  W-REMAINDER         PIC S9(3)    VALUE +0.
   192     12  WS-TERMS.
   193         16  WST-ORIG        PIC ZZ9.
   194         16  WST-ORIG-DAYS-GRP.
   195             20  WST-SLASH1  PIC X       VALUE '/'.
   196             20  WST-EXT-DAYS
   197                             PIC Z9.
   198         16  FILLER          PIC X       VALUE '/'.
   199         16  WST-REM         PIC ZZ9.
   200         16  WST-REM-DAYS-GRP.
   201             20  WST-SLASH2  PIC X       VALUE '/'.
   202             20  WST-REM-DAYS
   203                             PIC Z9.
   204     12  W-DAYS-PAID-X       PIC ZZZZ9.
   205     12  W-TOTAL-PAID-AMT-X  PIC ZZZZ,ZZZ.99.
   206     12  W-PAID-MONTHS       PIC S9(03)  COMP-3.
   207     12  W-PAID-DAYS         PIC S9(03)  COMP-3.
   208
   209     12  W-REM               PIC S999    COMP-3.
   210     12  W-REM-DAYS          PIC S999    COMP-3.
   211     12  W-TERM-IN-DAYS      PIC S9(4)   COMP-3.
   212     12  W-REM-TERM-IN-DAYS  PIC S9(4)   COMP-3.
   213
   214     12  W-PAYMENTS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL150.cbl
   215         16  W-PYMTS         PIC ZZ9.
   216         16  FILLER          PIC X       VALUE '/'.
   217         16  W-ADD-DAYS      PIC ZZ9.
   218     12  WS-ACCESS.
   219         16  FILLER          PIC XX      VALUE SPACES.
   220         16  WS-BEN-CD       PIC XX.
   221     12  WS-STATE-ACCESS.
   222         16  WS-ST-ACCESS    PIC XX.
   223         16  FILLER          PIC XX      VALUE SPACES.
   224     12  WS-CLAIM-SEQUENCE.
   225         16  FILLER          PIC X       VALUE '('.
   226         16  WS-CUR-SEQU     PIC Z9      VALUE ZEROS.
   227         16  FILLER          PIC X(04)   VALUE ' OF '.
   228         16  WS-OF-SEQU      PIC Z9      VALUE ZEROS.
   229         16  FILLER          PIC X       VALUE ')'.
   230
   231     12  WS-PURGED-MESSAGE.
   232         16  WS-PURGED-MSG       PIC X(18)    VALUE SPACES.
   233         16  WS-PURGED-DATE      PIC X(08)    VALUE SPACES.
   234
   235     12  SAVE-CONTROL        PIC X(39).
   236     12  WS-ERACCT-SAVE-KEY      PIC X(20) VALUE SPACES.
   237     12  WS-ERACCT-HOLD-RECORD   PIC X(2000) VALUE SPACES.
   238
   239     12  SUB                 PIC 99      VALUE ZEROS.
   240
   241     12  WS-ACTIVITY-CODE    PIC 99      VALUE ZEROS.
   242         88  VALID-ACTIVITY-CODE         VALUE 00, 10 THRU 17.
   243
   244     12  WS-ACT-REC-FOUND-SW PIC X       VALUE 'N'.
   245     12  WS-LETTER-SW        PIC X       VALUE 'N'.
   246     12  WS-BROWSE-SW        PIC X       VALUE 'N'.
   247     12  WS-BROWSE-START-SW  PIC X       VALUE ' '.
   248     12  WS-UPDATE-SW        PIC X       VALUE 'N'.
   249
   250     12  WS-ACT-USER-DESC.
   251         16  WS-DESC-1-3     PIC X(03)   VALUE SPACES.
   252         16  FILLER          PIC X(17)   VALUE SPACES.
   253
   254     12  WS-CERT-READ-SW     PIC X       VALUE 'N'.
   255     12  WS-LOAN-EXPIRE-DT   PIC X(08)   VALUE SPACES.
   256     12  W-CLAIM-MASTER-SAVE PIC X(350)  VALUE SPACES.
   257
   258     12  WS-PMT-AMTD.
   259         16  WS-PMT-AMT      PIC Z(4).99-.
   260
   261     12  WS-RESPONSE         PIC S9(8)   COMP.
   262         88  WS-RESP-NORMAL              VALUE +00.
   263         88  WS-RESP-NOTFND              VALUE +13.
   264
   265 01  ACCESS-KEYS.
   266     12  ERACCT-KEY.
   267         16  ERACCT-PARTIAL-KEY.
   268             20  ACCT-COMP-CD    PIC X.
   269             20  ACCT-CARRIER    PIC X.
   270             20  ACCT-GROUPING   PIC X(6).
   271             20  ACCT-STATE      PIC XX.
   272             20  ACCT-ACCOUNT    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL150.cbl
   273         16  ACCT-EXP-DT         PIC XX.
   274         16  FILLER              PIC X(04).
   275     12  ELMSTR-KEY.
   276         16  MSTR-COMP-CD    PIC X.
   277         16  MSTR-CARRIER    PIC X.
   278         16  MSTR-CLAIM-NO   PIC X(7).
   279         16  MSTR-CERT-NO.
   280             20  MSTR-CERT-NO-PRIME  PIC X(10).
   281             20  MSTR-CERT-NO-SUFX   PIC X.
   282     12  W-ELRETR-KEY.
   283         16  W-RET-COMP-CD       PIC  X.
   284         16  W-RET-CARRIER       PIC  X.
   285         16  W-RET-CLAIM-NO      PIC  X(07).
   286         16  W-RET-CERT-NO.
   287             20  W-RET-CERT-PRIME
   288                                 PIC  X(10).
   289             20  W-RET-CERT-SUFX PIC  X.
   290     12  ELCNTL-KEY.
   291         16  CNTL-COMP-ID    PIC X(3).
   292         16  CNTL-REC-TYPE   PIC X.
   293         16  CNTL-ACCESS.
   294             20  FILLER      PIC XX.
   295             20  CNTL-BEN-NO PIC XX.
   296         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   297     12  ELCERT-KEY.
   298         16  CERT-COMP-CD    PIC X.
   299         16  CERT-CARRIER    PIC X.
   300         16  CERT-GROUPING   PIC X(6).
   301         16  CERT-STATE      PIC XX.
   302         16  CERT-ACCOUNT    PIC X(10).
   303         16  CERT-EFF-DT     PIC XX.
   304         16  CERT-CERT-NO.
   305             20  CERT-CERT-NO-PRIME PIC X(10).
   306             20  CERT-CERT-NO-SUFX  PIC X.
   307     12  ELTRLR-KEY.
   308         16  TRLR-COMP-CD    PIC X.
   309         16  TRLR-CARRIER    PIC X.
   310         16  TRLR-CLAIM-NO   PIC X(7).
   311         16  TRLR-CERT-NO.
   312             20  TRLR-CERT-NO-PRIME PIC X(10).
   313             20  TRLR-CERT-NO-SUFX  PIC X.
   314         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   315     12  ws-ELTRLR-KEY.
   316         16  ws-TRLR-COMP-CD    PIC X.
   317         16  ws-TRLR-CARRIER    PIC X.
   318         16  ws-TRLR-CLAIM-NO   PIC X(7).
   319         16  ws-TRLR-CERT-NO.
   320             20  ws-TRLR-CERT-NO-PRIME PIC X(10).
   321             20  ws-TRLR-CERT-NO-SUFX  PIC X.
   322         16  ws-TRLR-SEQ-NO     PIC S9(4)   COMP.
   323     12  ELACTQ-KEY.
   324         16  ACTQ-COMP-CD    PIC X.
   325         16  ACTQ-CARRIER    PIC X.
   326         16  ACTQ-CLAIM-NO   PIC X(7).
   327         16  ACTQ-CERT-NO.
   328             20  ACTQ-CERT-NO-PRIME PIC X(10).
   329             20  ACTQ-CERT-NO-SUFX  PIC X.
   330     12  ELARCH-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL150.cbl
   331         16  ARCH-COMP-CD        PIC X.
   332         16  ARCH-ARCHIVE-NO     PIC S9(08)  COMP.
   333         16  ARCH-RECORD-TYPE    PIC X.
   334         16  ARCH-SEQ-NO         PIC S9(04)  COMP.
   335
   336     12  EMPLCY-KEY.
   337         16  PLCY-COMP-CD            PIC X.
   338         16  PLCY-CARRIER            PIC X.
   339         16  PLCY-GROUPING           PIC X(06).
   340         16  PLCY-STATE              PIC XX.
   341         16  PLCY-PRODUCER           PIC X(10).
   342         16  PLCY-EFF-DT             PIC XX.
   343         16  PLCY-REFERENCE-NO.
   344             20  PLCY-REFNO-PRIME    PIC X(18).
   345             20  PLCY-REFNO-SFX      PIC XX.
   346
   347     12  EMPHST-KEY.
   348         16  EMPHST-COMPANY-CD       PIC X.
   349         16  EMPHST-CARRIER          PIC X.
   350         16  EMPHST-GROUPING         PIC X(06).
   351         16  EMPHST-STATE            PIC XX.
   352         16  EMPHST-PRODUCER         PIC X(10).
   353         16  EMPHST-POLICY-EFF-DT    PIC XX.
   354         16  EMPHST-REFERENCE-NUMBER.
   355             20  EMPHST-REFNO-PRIME  PIC X(18).
   356             20  EMPHST-REFNO-SFX    PIC XX.
   357         16  EMPHST-RECORD-TYPE      PIC XX.
   358         16  EMPHST-FIELD-TYPE       PIC XX.
   359         16  EMPHST-SEQUENCE-NO      PIC S9(04) COMP.
   360
   361     12  EMPLAN-KEY.
   362         16  PLAN-COMP-CD            PIC X.
   363         16  PLAN-CARRIER            PIC X.
   364         16  PLAN-GROUPING           PIC X(06).
   365         16  PLAN-STATE              PIC XX.
   366         16  PLAN-PRODUCER           PIC X(10).
   367         16  PLAN-PLAN-CODE          PIC XX.
   368         16  PLAN-REV-NO             PIC 9(03).
   369
   370     12  EMPROD-KEY.
   371         16  EMPROD-PARTIAL-KEY.
   372             20  PROD-COMP-CD        PIC X.
   373             20  PROD-CARRIER        PIC X.
   374             20  PROD-GROUPING       PIC X(06).
   375             20  PROD-STATE          PIC XX.
   376             20  PROD-PRODUCER       PIC X(10).
   377         16  PROD-EXP-DT             PIC XX.
   378
   379 01  TRAILER-DISPLAY-WORK-AREA.
   380     12  DISPLAY-ACTION.
   381         16  DISP-ACT-A      PIC X(10).
   382         16  DISP-ACT-B      PIC X(4).
   383     12  FILLER              PIC X.
   384     12  DISPLAY-BY          PIC X(4).
   385     12  FILLER              PIC X.
   386     12  DISPLAY-DATE        PIC X(8).
   387     12  FILLER              PIC X.
   388     12  DISPLAY-SEQ         PIC Z(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL150.cbl
   389     12  FILLER              PIC X.
   390     12  DISPLAY-TEXT        PIC X(45).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL150.cbl
   392 01  ERROR-MESSAGES.
   393     05  ER-0000                 PIC X(4) VALUE '0000'.
   394     05  ER-0004                 PIC X(4) VALUE '0004'.
   395     05  ER-0008                 PIC X(4) VALUE '0008'.
   396     05  ER-0029                 PIC X(4) VALUE '0029'.
   397     05  ER-0033                 PIC X(4) VALUE '0033'.
   398     05  ER-0042                 PIC X(4) VALUE '0042'.
   399     05  ER-0068                 PIC X(4) VALUE '0068'.
   400     05  ER-0070                 PIC X(4) VALUE '0070'.
   401     05  ER-0130                 PIC X(4) VALUE '0130'.
   402     05  ER-0154                 PIC X(4) VALUE '0154'.
   403     05  ER-0168                 PIC X(4) VALUE '0168'.
   404     05  ER-0169                 PIC X(4) VALUE '0169'.
   405     05  ER-0172                 PIC X(4) VALUE '0172'.
   406     05  ER-0190                 PIC X(4) VALUE '0190'.
   407     05  ER-0204                 PIC X(4) VALUE '0204'.
   408     05  ER-0206                 PIC X(4) VALUE '0206'.
   409     05  ER-0303                 PIC X(4) VALUE '0303'.
   410     05  ER-0334                 PIC X(4) VALUE '0334'.
   411     05  ER-0335                 PIC X(4) VALUE '0335'.
   412     05  ER-0336                 PIC X(4) VALUE '0336'.
   413     05  ER-0337                 PIC X(4) VALUE '0337'.
   414     05  ER-0338                 PIC X(4) VALUE '0338'.
   415     05  ER-0376                 PIC X(4) VALUE '0376'.
   416     05  ER-0412                 PIC X(4) VALUE '0412'.
   417     05  ER-0413                 PIC X(4) VALUE '0413'.
   418     05  ER-0433                 PIC X(4) VALUE '0433'.
   419     05  ER-0500                 PIC X(4) VALUE '0500'.
   420     05  ER-0802                 PIC X(4) VALUE '0802'.
   421     05  ER-0803                 PIC X(4) VALUE '0803'.
   422     05  ER-0804                 PIC X(4) VALUE '0804'.
   423     05  ER-0926                 PIC X(4) VALUE '0926'.
   424     05  ER-0927                 PIC X(4) VALUE '0927'.
   425     05  ER-0928                 PIC X(4) VALUE '0928'.
   426     05  ER-0929                 PIC X(4) VALUE '0929'.
   427     05  ER-0931                 PIC X(4) VALUE '0931'.
   428     05  ER-0932                 PIC X(4) VALUE '0932'.
   429     05  ER-0933                 PIC X(4) VALUE '0933'.
   430     05  ER-0934                 PIC X(4) VALUE '0934'.
   431     05  ER-0935                 PIC X(4) VALUE '0935'.
   432     05  ER-0936                 PIC X(4) VALUE '0936'.
   433     05  ER-0937                 PIC X(4) VALUE '0937'.
   434     05  ER-2378                 PIC X(4) VALUE '2378'.
   435     05  ER-2379                 PIC X(4) VALUE '2379'.
   436     05  ER-2848                 PIC X(4) VALUE '2848'.
   437     05  ER-3516                 PIC X(4) VALUE '3516'.
   438     05  ER-3526                 PIC X(4) VALUE '3526'.
   439     05  ER-3545                 PIC X(4) VALUE '3545'.
   440     05  ER-3550                 PIC X(4) VALUE '3550'.
   441     05  ER-9483                 PIC X(4) VALUE '9483'.
   442     05  ER-9808                 PIC X(4) VALUE '9808'.
   443     05  ER-9883                 PIC X(4) VALUE '9883'.
   444     05  ER-9886                 PIC X(4) VALUE '9886'.
   445
   446 01  TEXT-WORK-AREAS.
   447     12  PAYMENT-TEXT.
   448         16  PMT-VAR         PIC X(8).
   449         16  PMT-PD-THRU     PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL150.cbl
   450         16  FILLER          PIC X(7)    VALUE ' CHECK='.
   451         16  PMT-CHECK-NO    PIC X(7).
   452         16  FILLER          PIC X(5)    VALUE ' AMT='.
   453         16  PMT-AMOUNT      PIC Z(6).99-.
   454
   455     12  AUTO-PMT-TEXT.
   456         16  FILLER          PIC X(6)    VALUE 'START='.
   457         16  AUTO-START      PIC X(8).
   458         16  FILLER          PIC X(5)    VALUE ' END='.
   459         16  AUTO-END        PIC X(8).
   460         16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
   461         16  AUTO-AMOUNT     PIC Z(6).99-.
   462
   463     12  AUTO-TERM-TEXT.
   464         16  FILLER          PIC X(11)   VALUE 'TERMINATED='.
   465         16  AUTO-TERMINATED PIC X(8).
   466         16  FILLER          PIC X(8)    VALUE SPACES.
   467         16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
   468         16  AUTO-TERM-AMT   PIC Z(6).99-.
   469
   470     12  CORRESPONDENCE-TEXT.
   471         16  FILLER          PIC X(3)    VALUE 'TO='.
   472         16  CORR-TO         PIC X(8).
   473         16  CORR-RECVD-LIT  PIC X(8)    VALUE '  RECVD='.
   474         16  CORR-RECVD      PIC X(8).
   475         16  CORR-VAR        PIC X(9).
   476         16  CORR-RESENT     PIC X(8).
   477         16  CORR-ARCH-NO REDEFINES CORR-RESENT PIC 9(8).
   478
   479     12  PROMPT-TEXT.
   480         16  FILLER          PIC X(4)    VALUE 'END='.
   481         16  PROMPT-END      PIC X(8).
   482         16  FILLER          PIC XX      VALUE SPACES.
   483         16  PROMPT-MSG      PIC X(31).
   484
   485     12  DENIAL-TEXT.
   486         16  FILLER          PIC X(5)    VALUE 'DATE='.
   487         16  DENIAL-DATE     PIC X(8).
   488         16  FILLER          PIC X(6)    VALUE ' CODE='.
   489         16  DENIAL-CODE     PIC X(4).
   490         16  FILLER          PIC XX      VALUE SPACES.
   491         16  DENIAL-MSG      PIC X(20).
   492
   493     12  RECONSIDERED-TEXT.
   494         16  FILLER          PIC X(7)    VALUE 'DENIED '.
   495         16  DENIED-DATE     PIC X(8).
   496         16  FILLER          PIC X(15)   VALUE '  RECONSIDERED '.
   497         16  RECONSIDERED-DATE  PIC X(8).
   498
   499     12  INCUR-TEXT.
   500         16  FILLER          PIC X(6)    VALUE 'INCUR='.
   501         16  INCUR-DT        PIC X(8).
   502         16  PDTHRU-HEAD     PIC X(9)    VALUE ' PD THRU='.
   503         16  INCUR-PDTHRU    PIC X(8).
   504         16  FILLER          PIC X(4)    VALUE ' PD='.
   505         16  INCUR-PAID      PIC Z(6).99-.
   506
   507     12  LOAN-TEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL150.cbl
   508         16  FILLER          PIC X(5)    VALUE 'LOAN='.
   509         16  LOAN-NUMBER     PIC X(8).
   510         16  FILLER          PIC X(5)    VALUE ' BAL='.
   511         16  LOAN-BALANCE    PIC Z(7).99-.
   512         16  FILLER          PIC X(4)    VALUE ' ME='.
   513         16  LOAN-MEMBER     PIC X(12).
   514
   515     12  ASSOC-LOAN-TEXT.
   516         16  FILLER          PIC X(11)   VALUE
   517                 'ORIG/CUR : '.
   518         16  ASSOC-ORIG-LOAN PIC X(08)   VALUE SPACES.
   519         16  FILLER          PIC X       VALUE SPACES.
   520         16  ASSOC-CUR-LOAN  PIC X(12)   VALUE SPACES.
   521         16  FILLER          PIC XX      VALUE SPACES.
   522         16  ASSOC-LOAN-TYPE PIC XX      VALUE SPACES.
   523         16  FILLER          PIC X(09)   VALUE SPACES.
   524
   525     12  ASSOC-CV-LOAN-TEXT.
   526         16  FILLER          PIC X(11)   VALUE
   527                 'LOAN NO. : '.
   528         16  ASSOC-CV-LOAN   PIC X(20)   VALUE SPACES.
   529         16  FILLER          PIC X(14)   VALUE SPACES.
   530
   531 01  PAYMENT-DESCRIPTION-TABLE.
   532     12  FILLER              PIC X(14)   VALUE 'PARTIAL PMT   '.
   533     12  FILLER              PIC X(14)   VALUE 'FINAL PMT     '.
   534     12  FILLER              PIC X(14)   VALUE 'LUMP SUM PMT  '.
   535     12  FILLER              PIC X(14)   VALUE 'ADDITIONAL PMT'.
   536     12  FILLER              PIC X(14)   VALUE 'CHARGEABLE EXP'.
   537     12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
   538     12  FILLER              PIC X(14)   VALUE 'LIFE PRM RFND '.
   539     12  FILLER              PIC X(14)   VALUE 'A/H PRM RFND  '.
   540     12  FILLER              PIC X(14)   VALUE 'ENTRY CORRECT '.
   541 01  PAYMENT-DESC-R   REDEFINES PAYMENT-DESCRIPTION-TABLE.
   542     12  PAY-DESC            PIC X(14)   OCCURS 9.
   543
   544 01  CV-PAYMENT-DESCRIPTION-TABLE.
   545     12  FILLER              PIC X(14)   VALUE 'FULL DEATH    '.
   546     12  FILLER              PIC X(14)   VALUE 'HALF DEATH    '.
   547     12  FILLER              PIC X(14)   VALUE 'FULL AD&D     '.
   548     12  FILLER              PIC X(14)   VALUE 'HALF AD&D     '.
   549     12  FILLER              PIC X(14)   VALUE 'FULL RIDER    '.
   550     12  FILLER              PIC X(14)   VALUE 'HALF RIDER    '.
   551     12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
   552     12  FILLER              PIC X(14)   VALUE 'ADDITIONAL    '.
   553 01  CV-PAYMENT-DESC-R REDEFINES CV-PAYMENT-DESCRIPTION-TABLE.
   554     12  CV-PAY-DESC         PIC X(14)   OCCURS 2.
   555
   556 01  CORRESPONDENCE-TO-DESCRIPTIONS.
   557     12  FILLER              PIC X(8)    VALUE 'INSURED '.
   558     12  FILLER              PIC X(8)    VALUE 'BENEF   '.
   559     12  FILLER              PIC X(8)    VALUE 'ACCOUNT '.
   560     12  FILLER              PIC X(8)    VALUE 'DOCTOR  '.
   561     12  FILLER              PIC X(8)    VALUE 'EMPLOYER'.
   562     12  FILLER              PIC X(8)    VALUE 'OTHER1  '.
   563     12  FILLER              PIC X(8)    VALUE 'OTHER2  '.
   564 01  CORR-TO-DESC   REDEFINES CORRESPONDENCE-TO-DESCRIPTIONS.
   565     12  CORR-DESC           PIC X(8)    OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL150.cbl
   566
   567 01  W-CONFIDENTIAL-TEXT.
   568     12  W-CONF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   569     12  W-CONF-TEXT.
   570         16  FILLER.
   571             20  W-CONF-PGM  PIC X(8)    VALUE 'EL150'.
   572             20  FILLER      PIC X       VALUE SPACES.
   573             20  FILLER      PIC X(71)   VALUE
   574     '******THIS IS A CONFIDENTIAL CLAIM!!!!!*****'.
   575         16  FILLER          PIC X(8)    VALUE SPACES.
   576         16  FILLER          PIC X(71)   VALUE
   577      '******PRESS ENTER TO RETURN TO SCREEN.******'.
   578         16  FILLER          PIC X(26)   VALUE SPACES.
   579*        16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   580*        16  FILLER          PIC X       VALUE QUOTE.
   581*        16  W-CONF-SYS-MSG  PIC X(17)
   582*          VALUE 'S CLAS-IC SYSTEM '.
   583
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL150.cbl
   585*                            COPY ELCNWA.
   586*****************************************************************
   587*                                                               *
   588*                                                               *
   589*                            ELCNWA.                            *
   590*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   591*                            VMOD=2.003                         *
   592*                                                               *
   593*            M O V E   N A M E   W O R K   A R E A.             *
   594*                                                               *
   595*****************************************************************.
   596
   597 01  WS-NAME-WORK-AREA.
   598     05  WS-INSURED-LAST-NAME        PIC X(15).
   599     05  WS-INSURED-1ST-NAME         PIC X(12).
   600     05  WS-INSURED-MID-INIT         PIC X.
   601
   602     05  WS-NAME-WORK.
   603         10  WS-NW                   PIC X
   604             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   605
   606     05  WS-NAME-WORK2.
   607         10  WS-NW2                  PIC X
   608             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   609                                        NWA-INDEX0.
   610
   611     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   612                                     COMP-3.
   613
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL150.cbl
   615*                            COPY ELCDATE.
   616******************************************************************
   617*                                                                *
   618*                                                                *
   619*                            ELCDATE.                            *
   620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   621*                            VMOD=2.003
   622*                                                                *
   623*                                                                *
   624*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   625*                 LENGTH = 200                                   *
   626******************************************************************
   627
   628 01  DATE-CONVERSION-DATA.
   629     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   630     12  DC-OPTION-CODE                PIC X.
   631         88  BIN-TO-GREG                VALUE ' '.
   632         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   633         88  EDIT-GREG-TO-BIN           VALUE '2'.
   634         88  YMD-GREG-TO-BIN            VALUE '3'.
   635         88  MDY-GREG-TO-BIN            VALUE '4'.
   636         88  JULIAN-TO-BIN              VALUE '5'.
   637         88  BIN-PLUS-ELAPSED           VALUE '6'.
   638         88  FIND-CENTURY               VALUE '7'.
   639         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   640         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   641         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   642         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   643         88  JULIAN-TO-BIN-3            VALUE 'C'.
   644         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   645         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   646         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   647         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   648         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   649         88  CHECK-LEAP-YEAR            VALUE 'H'.
   650         88  BIN-3-TO-GREG              VALUE 'I'.
   651         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   652         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   653         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   654         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   655         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   656         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   657         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   658         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   659         88  THREE-CHARACTER-BIN
   660                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   661         88  GREGORIAN-TO-BIN
   662                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   663         88  BIN-TO-GREGORIAN
   664                  VALUES ' ' '1' 'I' '8' 'G'.
   665         88  JULIAN-TO-BINARY
   666                  VALUES '5' 'C' 'E' 'F'.
   667     12  DC-ERROR-CODE                 PIC X.
   668         88  NO-CONVERSION-ERROR        VALUE ' '.
   669         88  DATE-CONVERSION-ERROR
   670                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   671         88  DATE-IS-ZERO               VALUE '1'.
   672         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL150.cbl
   673         88  DATE-IS-INVALID            VALUE '3'.
   674         88  DATE1-GREATER-DATE2        VALUE '4'.
   675         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   676         88  DATE-INVALID-OPTION        VALUE '9'.
   677         88  INVALID-CENTURY            VALUE 'A'.
   678         88  ONLY-CENTURY               VALUE 'B'.
   679         88  ONLY-LEAP-YEAR             VALUE 'C'.
   680         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   681     12  DC-END-OF-MONTH               PIC X.
   682         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   683     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   684         88  USE-NORMAL-PROCESS         VALUE ' '.
   685         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   686         88  ADJUST-UP-100-YRS          VALUE '2'.
   687     12  FILLER                        PIC X.
   688     12  DC-CONVERSION-DATES.
   689         16  DC-BIN-DATE-1             PIC XX.
   690         16  DC-BIN-DATE-2             PIC XX.
   691         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   692         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   693                       DC-GREG-DATE-1-EDIT.
   694             20  DC-EDIT1-MONTH        PIC 99.
   695             20  SLASH1-1              PIC X.
   696             20  DC-EDIT1-DAY          PIC 99.
   697             20  SLASH1-2              PIC X.
   698             20  DC-EDIT1-YEAR         PIC 99.
   699         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   700         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   701                     DC-GREG-DATE-2-EDIT.
   702             20  DC-EDIT2-MONTH        PIC 99.
   703             20  SLASH2-1              PIC X.
   704             20  DC-EDIT2-DAY          PIC 99.
   705             20  SLASH2-2              PIC X.
   706             20  DC-EDIT2-YEAR         PIC 99.
   707         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   708         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   709                     DC-GREG-DATE-1-YMD.
   710             20  DC-YMD-YEAR           PIC 99.
   711             20  DC-YMD-MONTH          PIC 99.
   712             20  DC-YMD-DAY            PIC 99.
   713         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   714         16  DC-GREG-DATE-1-MDY-R REDEFINES
   715                      DC-GREG-DATE-1-MDY.
   716             20  DC-MDY-MONTH          PIC 99.
   717             20  DC-MDY-DAY            PIC 99.
   718             20  DC-MDY-YEAR           PIC 99.
   719         16  DC-GREG-DATE-1-ALPHA.
   720             20  DC-ALPHA-MONTH        PIC X(10).
   721             20  DC-ALPHA-DAY          PIC 99.
   722             20  FILLER                PIC XX.
   723             20  DC-ALPHA-CENTURY.
   724                 24 DC-ALPHA-CEN-N     PIC 99.
   725             20  DC-ALPHA-YEAR         PIC 99.
   726         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   727         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   728         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   729         16  DC-JULIAN-DATE            PIC 9(05).
   730         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL150.cbl
   731                                       PIC 9(05).
   732         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   733             20  DC-JULIAN-YEAR        PIC 99.
   734             20  DC-JULIAN-DAYS        PIC 999.
   735         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   736         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   737         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   738     12  DATE-CONVERSION-VARIBLES.
   739         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   740         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   741             20  FILLER                PIC 9(3).
   742             20  HOLD-CEN-1-CCYY.
   743                 24  HOLD-CEN-1-CC     PIC 99.
   744                 24  HOLD-CEN-1-YY     PIC 99.
   745             20  HOLD-CEN-1-MO         PIC 99.
   746             20  HOLD-CEN-1-DA         PIC 99.
   747         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   748             20  HOLD-CEN-1-R-MO       PIC 99.
   749             20  HOLD-CEN-1-R-DA       PIC 99.
   750             20  HOLD-CEN-1-R-CCYY.
   751                 24  HOLD-CEN-1-R-CC   PIC 99.
   752                 24  HOLD-CEN-1-R-YY   PIC 99.
   753             20  FILLER                PIC 9(3).
   754         16  HOLD-CENTURY-1-X.
   755             20  FILLER                PIC X(3)  VALUE SPACES.
   756             20  HOLD-CEN-1-X-CCYY.
   757                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   758                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   759             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   760             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   761         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   762             20  HOLD-CEN-1-R-X-MO     PIC XX.
   763             20  HOLD-CEN-1-R-X-DA     PIC XX.
   764             20  HOLD-CEN-1-R-X-CCYY.
   765                 24  HOLD-CEN-1-R-X-CC PIC XX.
   766                 24  HOLD-CEN-1-R-X-YY PIC XX.
   767             20  FILLER                PIC XXX.
   768         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   769         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   770         16  DC-JULIAN-DATE-1          PIC 9(07).
   771         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   772             20  DC-JULIAN-1-CCYY.
   773                 24  DC-JULIAN-1-CC    PIC 99.
   774                 24  DC-JULIAN-1-YR    PIC 99.
   775             20  DC-JULIAN-DA-1        PIC 999.
   776         16  DC-JULIAN-DATE-2          PIC 9(07).
   777         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   778             20  DC-JULIAN-2-CCYY.
   779                 24  DC-JULIAN-2-CC    PIC 99.
   780                 24  DC-JULIAN-2-YR    PIC 99.
   781             20  DC-JULIAN-DA-2        PIC 999.
   782         16  DC-GREG-DATE-A-EDIT.
   783             20  DC-EDITA-MONTH        PIC 99.
   784             20  SLASHA-1              PIC X VALUE '/'.
   785             20  DC-EDITA-DAY          PIC 99.
   786             20  SLASHA-2              PIC X VALUE '/'.
   787             20  DC-EDITA-CCYY.
   788                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL150.cbl
   789                 24  DC-EDITA-YEAR     PIC 99.
   790         16  DC-GREG-DATE-B-EDIT.
   791             20  DC-EDITB-MONTH        PIC 99.
   792             20  SLASHB-1              PIC X VALUE '/'.
   793             20  DC-EDITB-DAY          PIC 99.
   794             20  SLASHB-2              PIC X VALUE '/'.
   795             20  DC-EDITB-CCYY.
   796                 24  DC-EDITB-CENT     PIC 99.
   797                 24  DC-EDITB-YEAR     PIC 99.
   798         16  DC-GREG-DATE-CYMD         PIC 9(08).
   799         16  DC-GREG-DATE-CYMD-R REDEFINES
   800                              DC-GREG-DATE-CYMD.
   801             20  DC-CYMD-CEN           PIC 99.
   802             20  DC-CYMD-YEAR          PIC 99.
   803             20  DC-CYMD-MONTH         PIC 99.
   804             20  DC-CYMD-DAY           PIC 99.
   805         16  DC-GREG-DATE-MDCY         PIC 9(08).
   806         16  DC-GREG-DATE-MDCY-R REDEFINES
   807                              DC-GREG-DATE-MDCY.
   808             20  DC-MDCY-MONTH         PIC 99.
   809             20  DC-MDCY-DAY           PIC 99.
   810             20  DC-MDCY-CEN           PIC 99.
   811             20  DC-MDCY-YEAR          PIC 99.
   812    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   813        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   814    12  DC-EL310-DATE                  PIC X(21).
   815    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL150.cbl
   817*                            COPY ELCCALC.
   818******************************************************************
   819*                                                                *
   820*                           ELCCALC.                            *
   821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   822*                            VMOD=2.025                          *
   823*                                                                *
   824*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   825*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   826*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   827*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   828*                                                                *
   829*  PASSED TO ELRTRM                                              *
   830*  -----------------                                             *
   831*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   832*  ORIGINAL TERM                                                 *
   833*  BEGINNING DATE                                                *
   834*  ENDING DATE                                                   *
   835*  COMPANY I.D.                                                  *
   836*  ACCOUNT MASTER USER FIELD                                     *
   837*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   838*  FREE LOOK DAYS                                                *
   839*                                                                *
   840*  RETURNED FROM ELRTRM                                          *
   841*  ---------------------                                         *
   842*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   843*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   844*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   845*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   846*----------------------------------------------------------------*
   847*  PASSED TO ELRAMT                                              *
   848*  ----------------                                              *
   849*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   850*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   851*  ORIGINAL AMOUNT                                               *
   852*  ALTERNATE BENEFIT (BALLON)                                    *
   853*  A.P.R. - NET PAY ONLY                                         *
   854*  METHOD
   855*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   856*  COMPANY I.D.                                                  *
   857*  BENEFIT TYPE                                                  *
   858*                                                                *
   859*  RETURNED FROM ELRAMT                                          *
   860*  --------------------                                          *
   861*  REMAINING AMOUNT 1 - CURRENT                                  *
   862*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   863*  REMAINING AMOUNT FACTOR
   864*----------------------------------------------------------------*
   865*  PASSED TO ELRESV                                              *
   866*  -----------------                                             *
   867*  CERTIFICATE EFFECTIVE DATE                                    *
   868*  VALUATION DATE                                                *
   869*  PAID THRU DATE                                                *
   870*  BENEFIT                                                       *
   871*  INCURRED DATE                                                 *
   872*  REPORTED DATE                                                 *
   873*  ISSUE AGE                                                     *
   874*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL150.cbl
   875*  CDT PERCENT                                                   *
   876*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   877* *CLAIM TYPE (LIFE, A/H)                                        *
   878* *REMAINING BENEFIT (FROM ELRAMT)                               *
   879* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   880*                                                                *
   881*  RETURNED FROM ELRESV                                          *
   882*  --------------------                                          *
   883*  CDT TABLE USED                                                *
   884*  CDT FACTOR USED                                               *
   885*  PAY TO CURRENT RESERVE                                        *
   886*  I.B.N.R. - A/H ONLY                                           *
   887*  FUTURE (ACCRUED) AH ONLY                                      *
   888*----------------------------------------------------------------*
   889*  PASSED TO ELRATE                                              *
   890*  ----------------                                              *
   891*  CERT ISSUE DATE                                               *
   892*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   893*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   894*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   895*  STATE CODE (CLIENT DEFINED)                                   *
   896*  STATE CODE (STANDARD P.O. ABBRV)                              *
   897*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   898*  DEVIATION CODE                                                *
   899*  ISSUE AGE                                                     *
   900*  ORIGINAL BENEFIT AMOUNT                                       *
   901*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   902*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   903*  BENEFIT KIND (LIFE OR A/H)                                    *
   904*  A.P.R.                                                        *
   905*  METHOD
   906*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   907*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   908*  COMPANY I.D. (3 CHARACTER)                                    *
   909*  BENEFIT CODE                                                  *
   910*  BENEFIT OVERRIDE CODE                                         *
   911*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   912*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   913*  JOINT INDICATOR (CSL ONLY)                                    *
   914*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   915*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   916*                                                                *
   917*  RETURNED FROM ELRATE                                          *
   918*  --------------------                                          *
   919*  CALCULATED PREMIUM                                            *
   920*  PREMIUM RATE                                                  *
   921*  MORTALITY CODE                                                *
   922*  MAX ATTAINED AGE                                              *
   923*  MAX AGE                                                       *
   924*  MAX TERM                                                      *
   925*  MAX MONTHLY BENEFIT                                           *
   926*  MAX TOTAL BENIFIT                                             *
   927*  COMPOSITE RATE (OPEN-END ONLY)                                *
   928*----------------------------------------------------------------*
   929*  PASSED TO ELRFND                                              *
   930*  ----------------                                              *
   931*  CERT ISSUE DATE                                               *
   932*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL150.cbl
   933*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   934*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   935*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   936*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   937*  STATE CODE (CLIENT DEFINED)                                   *
   938*  STATE CODE (STANDARD P.O. ABBRV)                              *
   939*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   940*  DEVIATION CODE                                                *
   941*  ISSUE AGE                                                     *
   942*  ORIGINAL BENEFIT AMOUNT                                       *
   943*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   944*  PROCESS TYPE (CANCEL)                                         *
   945*  BENEFIT KIND (LIFE OR A/H)                                    *
   946*  A.P.R.                                                        *
   947*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   948*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   949*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   950*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   951*  COMPANY I.D. (3 CHARACTER)                                    *
   952*  BENEFIT CODE                                                  *
   953*  BENEFIT OVERRIDE CODE                                         *
   954*                                                                *
   955*  RETURNED FROM ELRFND                                          *
   956*  --------------------                                          *
   957*  CALCULATED REFUND                                             *
   958*----------------------------------------------------------------*
   959*  PASSED TO ELEARN                                              *
   960*  ----------------                                              *
   961*  CERT ISSUE DATE                                               *
   962*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   963*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   964*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   965*  STATE CODE (CLIENT DEFINED)                                   *
   966*  STATE CODE (STANDARD P.O. ABBRV)                              *
   967*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   968*  DEVIATION CODE                                                *
   969*  ISSUE AGE                                                     *
   970*  ORIGINAL BENEFIT AMOUNT                                       *
   971*  BENEFIT KIND (LIFE OR A/H)                                    *
   972*  A.P.R.                                                        *
   973*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   974*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   975*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   976*  COMPANY I.D. (3 CHARACTER)                                    *
   977*  BENEFIT CODE                                                  *
   978*  BENEFIT OVERRIDE CODE                                         *
   979*                                                                *
   980*  RETURNED FROM ELEARN                                          *
   981*  --------------------                                          *
   982*  INDICATED  EARNINGS                                           *
   983*----------------------------------------------------------------*
   984*                 LENGTH = 450                                   *
   985*                                                                *
   986******************************************************************
   987******************************************************************
   988*                   C H A N G E   L O G
   989*
   990* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL150.cbl
   991*-----------------------------------------------------------------
   992*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   993* EFFECTIVE    NUMBER
   994*-----------------------------------------------------------------
   995* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   996* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   997* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   998* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   999* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1000* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1001* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1002* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1003* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1004******************************************************************
  1005
  1006 01  CALCULATION-PASS-AREA.
  1007     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1008                                     COMP.
  1009
  1010     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1011       88  NO-CP-ERROR                             VALUE ZERO.
  1012       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1013                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1014       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1015       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1016       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1017       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1018       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1019       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1020       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1021       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1022       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1023       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1024       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1025       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1026       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1027       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1028       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1029       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1030       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1031
  1032     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1033       88  NO-CP-ERROR-2                           VALUE ZERO.
  1034***********************  INPUT AREAS ****************************
  1035
  1036     12  CP-CALCULATION-AREA.
  1037         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1038         16  CP-CERT-EFF-DT        PIC XX.
  1039         16  CP-VALUATION-DT       PIC XX.
  1040         16  CP-PAID-THRU-DT       PIC XX.
  1041         16  CP-BENEFIT-TYPE       PIC X.
  1042           88  CP-AH                               VALUE 'A' 'D'
  1043                                                   'I' 'U'.
  1044           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1045           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1046         16  CP-INCURRED-DT        PIC XX.
  1047         16  CP-REPORTED-DT        PIC XX.
  1048         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL150.cbl
  1049         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1050         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1051                                     COMP-3.
  1052         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1053                                     COMP-3.
  1054         16  CP-CDT-METHOD         PIC X.
  1055           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1056           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1057           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1058         16  CP-CLAIM-TYPE         PIC X.
  1059           88  CP-AH-CLAIM                         VALUE 'A'.
  1060           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1061         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1062                                     COMP-3.
  1063         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1064                                     COMP-3.
  1065         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1066                                     COMP-3.
  1067         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1070                                     COMP-3.
  1071         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1072                                     COMP-3.
  1073         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1074                                     COMP-3.
  1075         16  CP-REM-TERM-METHOD    PIC X.
  1076           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1077           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1078           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1079           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1080           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1081           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1082           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1083         16  CP-EARNING-METHOD     PIC X.
  1084           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1085           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1086           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1087           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1088           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1089           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1090           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1091           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1092           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1093           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1094           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1095           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1096           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1097           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1098         16  CP-PROCESS-TYPE       PIC X.
  1099           88  CP-CLAIM                            VALUE '1'.
  1100           88  CP-CANCEL                           VALUE '2'.
  1101           88  CP-ISSUE                            VALUE '3'.
  1102         16  CP-SPECIAL-CALC-CD    PIC X.
  1103           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1104           88  CP-1-MTH-INTEREST               VALUE ' '.
  1105           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1106           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL150.cbl
  1107           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1108           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1109           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1110           88  CP-FARM-PLAN                    VALUE 'F'.
  1111           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1112           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1113           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1114           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1115           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1116           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1117           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1118           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1119           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1120           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1121                                                     'W' 'X'.
  1122           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1123           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1124           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1125           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1126           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1127           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1128           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1129           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1130           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1131           88  CP-CSL-METH-1                   VALUE '5'.
  1132           88  CP-CSL-METH-2                   VALUE '6'.
  1133           88  CP-CSL-METH-3                   VALUE '7'.
  1134           88  CP-CSL-METH-4                   VALUE '8'.
  1135
  1136         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1137                                     COMP-3.
  1138         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1139         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1140         16  CP-STATE              PIC XX          VALUE SPACE.
  1141         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1142         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1143           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1144               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1145         16  CP-R78-OPTION         PIC X.
  1146           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1147           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1148
  1149         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1150         16  CP-IBNR-RESERVE-SW    PIC X.
  1151         16  CP-CLAIM-STATUS       PIC X.
  1152         16  CP-RATE-FILE          PIC X.
  1153         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1154                                     COMP-3.
  1155
  1156         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1157         16  CP-AH-OVERRIDE-CODE   PIC X.
  1158
  1159         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1160                                     COMP-3.
  1161         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1162                                   PIC S9(5)V99 COMP-3.
  1163         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1164                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL150.cbl
  1165         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1166                                     COMP-3.
  1167         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1168                                     COMP-3.
  1169         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1170                                  PIC S9(7)V99 COMP-3.
  1171
  1172         16  CP-PAID-FROM-DATE     PIC X(02).
  1173         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1174         16  CP-EXT-DAYS-CALC      PIC X.
  1175           88  CP-EXT-NO-CHG                   VALUE ' '.
  1176           88  CP-EXT-CHG-LF                   VALUE '1'.
  1177           88  CP-EXT-CHG-AH                   VALUE '2'.
  1178           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1179         16  CP-DOMICILE-STATE     PIC XX.
  1180         16  CP-CARRIER            PIC X.
  1181         16  CP-REIN-FLAG          PIC X.
  1182         16  CP-REM-TRM-CALC-OPTION PIC X.
  1183           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1184                      '2' '3' '4' '5'.
  1185           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1186           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1187           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1188           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1189           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1190           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1191           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1192           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1193         16  CP-SIG-SWITCH         PIC X.
  1194         16  CP-RATING-METHOD      PIC X.
  1195           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1196           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1197           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1198           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1199           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1200           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1201           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1202           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1203           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1204         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1205                                     COMP-3.
  1206         16  CP-BEN-CATEGORY       PIC X.
  1207         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1208         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1209                                   PIC S99V9(5) COMP-3.
  1210         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1211         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1212                                   PIC S99V9(5) COMP-3.
  1213         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1214         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1215         16  CP-EXPIRE-DT          PIC XX.
  1216         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1217         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1218         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1219         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1220         16  CP-DDF-SPEC-CALC      PIC X.
  1221             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1222             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL150.cbl
  1223         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1224         16  CP-CANCEL-REASON      PIC X.
  1225         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1226         16  CP-PMT-MODE           PIC X.
  1227         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1228         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1229         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1230         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1231         16  FILLER                PIC X.
  1232
  1233***************    OUTPUT FROM ELRESV   ************************
  1234
  1235         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1236
  1237         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1238                                     COMP-3.
  1239         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1240                                     COMP-3.
  1241         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1242                                     COMP-3.
  1243         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1244                                     COMP-3.
  1245         16  FILLER                PIC X(09).
  1246***************    OUTPUT FROM ELRTRM   *************************
  1247
  1248         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1249                                     COMP-3.
  1250         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1251                                     COMP-3.
  1252         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1253                                     COMP-3.
  1254         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1255                                     COMP-3.
  1256         16  FILLER                PIC X(12).
  1257
  1258***************    OUTPUT FROM ELRAMT   *************************
  1259
  1260         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1261                                     COMP-3.
  1262         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1263                                     COMP-3.
  1264         16  FILLER                PIC X(12).
  1265
  1266***************    OUTPUT FROM ELRATE   *************************
  1267
  1268         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1269                                     COMP-3.
  1270         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1271                                     COMP-3.
  1272         16  CP-MORTALITY-CODE     PIC X(4).
  1273         16  CP-RATE-EDIT-FLAG     PIC X.
  1274             88  CP-RATES-NEED-APR                  VALUE '1'.
  1275         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1276                                     COMP-3.
  1277         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1278         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1279         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1280                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL150.cbl
  1281         16  FILLER                PIC X(07).
  1282
  1283***************    OUTPUT FROM ELRFND   *************************
  1284
  1285         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1286                                     COMP-3.
  1287         16  CP-REFUND-TYPE-USED   PIC X.
  1288           88  CP-R-AS-R78                         VALUE '1'.
  1289           88  CP-R-AS-PRORATA                     VALUE '2'.
  1290           88  CP-R-AS-CALIF                       VALUE '3'.
  1291           88  CP-R-AS-TEXAS                       VALUE '4'.
  1292           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1293           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1294           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1295           88  CP-R-AS-MEAN                        VALUE '8'.
  1296           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1297           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1298           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1299           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1300           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1301           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1302         16  FILLER                PIC X(12).
  1303
  1304***************    OUTPUT FROM ELEARN   *************************
  1305
  1306         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1307                                     COMP-3.
  1308         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1309                                     COMP-3.
  1310         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1311                                     COMP-3.
  1312         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1313                                     COMP-3.
  1314         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1315                                     COMP-3.
  1316         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1317                                     COMP-3.
  1318         16  CP-EARNING-TYPE-USED  PIC X.
  1319           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1320           88  CP-E-AS-R78                         VALUE '1'.
  1321           88  CP-E-AS-PRORATA                     VALUE '2'.
  1322           88  CP-E-AS-TEXAS                       VALUE '4'.
  1323           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1324           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1325           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1326           88  CP-E-AS-MEAN                        VALUE '8'.
  1327           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1328         16  FILLER                PIC X(12).
  1329
  1330***************    OUTPUT FROM ELPMNT   *************************
  1331
  1332         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1333                                     COMP-3.
  1334         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1335                                     COMP-3.
  1336         16  FILLER                PIC X(12).
  1337
  1338***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL150.cbl
  1339         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1340                                     COMP-3.
  1341         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1342                                     COMP-3.
  1343         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1344                                     COMP-3.
  1345         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1346                                     COMP-3.
  1347         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1348                                     COMP-3.
  1349         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1350                                     COMP-3.
  1351         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1352             88  OPEN-RATE-FILE                   VALUE 'O'.
  1353             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1354             88  IO-ERROR                         VALUE 'E'.
  1355
  1356         16  CP-FIRST-PAY-DATE     PIC XX.
  1357
  1358         16  CP-JOINT-INDICATOR    PIC X.
  1359
  1360         16  CP-RESERVE-REMAINING-TERM
  1361                                   PIC S9(4)V9    VALUE ZERO
  1362                                     COMP-3.
  1363
  1364         16  CP-INSURED-BIRTH-DT   PIC XX.
  1365
  1366         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1367                                     COMP-3.
  1368
  1369         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1370                                     COMP-3.
  1371
  1372         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1373                                     COMP-3.
  1374
  1375         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1376                                     COMP-3.
  1377
  1378         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1379                                     COMP-3.
  1380
  1381         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1382                                     COMP-3.
  1383
  1384         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1385                                     COMP-3.
  1386
  1387         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1388             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1389
  1390         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1391                                     COMP-3.
  1392         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1393                                     COMP-3.
  1394         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1395         16  FILLER                PIC X(15).
  1396******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL150.cbl
  1398*                            COPY ELCLOGOF.
  1399******************************************************************
  1400*                                                                *
  1401*                                                                *
  1402*                            ELCLOGOF.                           *
  1403*                            VMOD=2.001                          *
  1404*                                                                *
  1405*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1406*                                                                *
  1407******************************************************************
  1408 01  CLASIC-LOGOFF.
  1409     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1410     12  LOGOFF-TEXT.
  1411         16  FILLER          PIC X(5)    VALUE SPACES.
  1412         16  LOGOFF-MSG.
  1413             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1414             20  FILLER      PIC X       VALUE SPACES.
  1415             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1416         16  FILLER          PIC X(80)
  1417           VALUE '* YOU ARE NOW LOGGED OFF'.
  1418         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1419         16  FILLER          PIC X       VALUE QUOTE.
  1420         16  LOGOFF-SYS-MSG  PIC X(17)
  1421           VALUE 'S CLAS-IC SYSTEM '.
  1422     12  TEXT-MESSAGES.
  1423         16  UNACCESS-MSG    PIC X(29)
  1424             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1425         16  PGMIDERR-MSG    PIC X(17)
  1426             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL150.cbl
  1428*                            COPY ELCATTR.
  1429******************************************************************
  1430*                                                                *
  1431*                            ELCATTR.                            *
  1432*                            VMOD=2.001                          *
  1433*                                                                *
  1434*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1435*                                                                *
  1436*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1437*                                                                *
  1438*                   POS 1   P=PROTECTED                          *
  1439*                           U=UNPROTECTED                        *
  1440*                           S=ASKIP                              *
  1441*                   POS 2   A=ALPHA/NUMERIC                      *
  1442*                           N=NUMERIC                            *
  1443*                   POS 3   N=NORMAL                             *
  1444*                           B=BRIGHT                             *
  1445*                           D=DARK                               *
  1446*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1447*                           OF=MODIFIED DATA TAG OFF             *
  1448*                                                                *
  1449*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1450******************************************************************
  1451 01  ATTRIBUTE-LIST.
  1452     12  AL-PABOF            PIC X       VALUE 'Y'.
  1453     12  AL-PABON            PIC X       VALUE 'Z'.
  1454     12  AL-PADOF            PIC X       VALUE '%'.
  1455     12  AL-PADON            PIC X       VALUE '_'.
  1456     12  AL-PANOF            PIC X       VALUE '-'.
  1457     12  AL-PANON            PIC X       VALUE '/'.
  1458     12  AL-SABOF            PIC X       VALUE '8'.
  1459     12  AL-SABON            PIC X       VALUE '9'.
  1460     12  AL-SADOF            PIC X       VALUE '@'.
  1461     12  AL-SADON            PIC X       VALUE QUOTE.
  1462     12  AL-SANOF            PIC X       VALUE '0'.
  1463     12  AL-SANON            PIC X       VALUE '1'.
  1464     12  AL-UABOF            PIC X       VALUE 'H'.
  1465     12  AL-UABON            PIC X       VALUE 'I'.
  1466     12  AL-UADOF            PIC X       VALUE '<'.
  1467     12  AL-UADON            PIC X       VALUE '('.
  1468     12  AL-UANOF            PIC X       VALUE ' '.
  1469     12  AL-UANON            PIC X       VALUE 'A'.
  1470     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1471     12  AL-UNBON            PIC X       VALUE 'R'.
  1472     12  AL-UNDOF            PIC X       VALUE '*'.
  1473     12  AL-UNDON            PIC X       VALUE ')'.
  1474     12  AL-UNNOF            PIC X       VALUE '&'.
  1475     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL150.cbl
  1477*                            COPY ELCMSTR.
  1478******************************************************************
  1479*                                                                *
  1480*                            ELCMSTR.                            *
  1481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1482*                            VMOD=2.012                          *
  1483*                                                                *
  1484*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1485*                                                                *
  1486*   FILE TYPE = VSAM,KSDS                                        *
  1487*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1488*                                                                *
  1489*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1490*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1491*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1492*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1493*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1494*                                                 RKP=75,LEN=21  *
  1495*                                                                *
  1496*   **** NOTE ****                                               *
  1497*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1498*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1499*                                                                *
  1500*   LOG = YES                                                    *
  1501*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1502******************************************************************
  1503*                   C H A N G E   L O G
  1504*
  1505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1506*-----------------------------------------------------------------
  1507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1508* EFFECTIVE    NUMBER
  1509*-----------------------------------------------------------------
  1510* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1511* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1512******************************************************************
  1513 01  CLAIM-MASTER.
  1514     12  CL-RECORD-ID                PIC XX.
  1515         88  VALID-CL-ID         VALUE 'CL'.
  1516
  1517     12  CL-CONTROL-PRIMARY.
  1518         16  CL-COMPANY-CD           PIC X.
  1519         16  CL-CARRIER              PIC X.
  1520         16  CL-CLAIM-NO             PIC X(7).
  1521         16  CL-CERT-NO.
  1522             20  CL-CERT-PRIME       PIC X(10).
  1523             20  CL-CERT-SFX         PIC X.
  1524
  1525     12  CL-CONTROL-BY-NAME.
  1526         16  CL-COMPANY-CD-A1        PIC X.
  1527         16  CL-INSURED-LAST-NAME    PIC X(15).
  1528         16  CL-INSURED-NAME.
  1529             20  CL-INSURED-1ST-NAME PIC X(12).
  1530             20  CL-INSURED-MID-INIT PIC X.
  1531
  1532     12  CL-CONTROL-BY-SSN.
  1533         16  CL-COMPANY-CD-A2        PIC X.
  1534         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL150.cbl
  1535             20  CL-SSN-STATE        PIC XX.
  1536             20  CL-SSN-ACCOUNT      PIC X(6).
  1537             20  CL-SSN-LN3          PIC X(3).
  1538
  1539     12  CL-CONTROL-BY-CERT-NO.
  1540         16  CL-COMPANY-CD-A4        PIC X.
  1541         16  CL-CERT-NO-A4.
  1542             20  CL-CERT-A4-PRIME    PIC X(10).
  1543             20  CL-CERT-A4-SFX      PIC X.
  1544
  1545     12  CL-CONTROL-BY-CCN.
  1546         16  CL-COMPANY-CD-A5        PIC X.
  1547         16  CL-CCN-A5.
  1548             20  CL-CCN.
  1549                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1550                 24  CL-CCN-PRIME-A5 PIC X(12).
  1551             20  CL-CCN-FILLER-A5    PIC X(4).
  1552
  1553     12  CL-INSURED-PROFILE-DATA.
  1554         16  CL-INSURED-BIRTH-DT     PIC XX.
  1555         16  CL-INSURED-SEX-CD       PIC X.
  1556             88  INSURED-IS-MALE        VALUE 'M'.
  1557             88  INSURED-IS-FEMALE      VALUE 'F'.
  1558             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1559         16  CL-INSURED-OCC-CD       PIC X(6).
  1560         16  FILLER                  PIC X(5).
  1561
  1562     12  CL-PROCESSING-INFO.
  1563         16  CL-PROCESSOR-ID         PIC X(4).
  1564         16  CL-CLAIM-STATUS         PIC X.
  1565             88  CLAIM-IS-OPEN          VALUE 'O'.
  1566             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1567         16  CL-CLAIM-TYPE           PIC X.
  1568*            88  AH-CLAIM               VALUE 'A'.
  1569*            88  LIFE-CLAIM             VALUE 'L'.
  1570*            88  PROPERTY-CLAIM         VALUE 'P'.
  1571*            88  IUI-CLAIM              VALUE 'I'.
  1572*            88  GAP-CLAIM              VALUE 'G'.
  1573         16  CL-CLAIM-PREM-TYPE      PIC X.
  1574             88  SINGLE-PREMIUM         VALUE '1'.
  1575             88  O-B-COVERAGE           VALUE '2'.
  1576             88  OPEN-END-COVERAGE      VALUE '3'.
  1577         16  CL-INCURRED-DT          PIC XX.
  1578         16  CL-REPORTED-DT          PIC XX.
  1579         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1580         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1581         16  CL-LAST-PMT-DT          PIC XX.
  1582         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1583         16  CL-PAID-THRU-DT         PIC XX.
  1584         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1585         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1586         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1587         16  CL-PMT-CALC-METHOD      PIC X.
  1588             88  CL-360-DAY-YR          VALUE '1'.
  1589             88  CL-365-DAY-YR          VALUE '2'.
  1590             88  CL-FULL-MONTHS         VALUE '3'.
  1591         16  CL-CAUSE-CD             PIC X(6).
  1592
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL150.cbl
  1593         16  CL-PRIME-CERT-NO.
  1594             20  CL-PRIME-CERT-PRIME PIC X(10).
  1595             20  CL-PRIME-CERT-SFX   PIC X.
  1596
  1597         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1598             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1599             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1600
  1601         16  CL-MICROFILM-NO         PIC X(10).
  1602         16  CL-PROG-FORM-TYPE       PIC X.
  1603         16  CL-LAST-ADD-ON-DT       PIC XX.
  1604
  1605         16  CL-LAST-REOPEN-DT       PIC XX.
  1606         16  CL-LAST-CLOSE-DT        PIC XX.
  1607         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1608             88  FINAL-PAID             VALUE '1'.
  1609             88  CLAIM-DENIED           VALUE '2'.
  1610             88  AUTO-CLOSE             VALUE '3'.
  1611             88  MANUAL-CLOSE           VALUE '4'.
  1612             88  BENEFITS-CHANGED       VALUE 'C'.
  1613             88  SETUP-ERRORS           VALUE 'E'.
  1614         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1615         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1616         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1617             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1618         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1619         16  FILLER                  PIC X.
  1620
  1621     12  CL-CERTIFICATE-DATA.
  1622         16  CL-CERT-ORIGIN          PIC X.
  1623             88  CERT-WAS-ONLINE        VALUE '1'.
  1624             88  CERT-WAS-CREATED       VALUE '2'.
  1625             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1626         16  CL-CERT-KEY-DATA.
  1627             20  CL-CERT-CARRIER     PIC X.
  1628             20  CL-CERT-GROUPING    PIC X(6).
  1629             20  CL-CERT-STATE       PIC XX.
  1630             20  CL-CERT-ACCOUNT.
  1631                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1632                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1633             20  CL-CERT-EFF-DT      PIC XX.
  1634
  1635     12  CL-STATUS-CONTROLS.
  1636         16  CL-PRIORITY-CD          PIC X.
  1637             88  CONFIDENTIAL-DATA      VALUE '8'.
  1638             88  HIGHEST-PRIORITY       VALUE '9'.
  1639         16  CL-SUPV-ATTN-CD         PIC X.
  1640             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1641             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1642         16  CL-PURGED-DT            PIC XX.
  1643         16  CL-RESTORED-DT          PIC XX.
  1644         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1645         16  CL-NEXT-RESEND-DT       PIC XX.
  1646         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1647         16  FILLER                  PIC XX.
  1648         16  CL-LAST-MAINT-DT        PIC XX.
  1649         16  CL-LAST-MAINT-USER      PIC X(4).
  1650         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL150.cbl
  1651         16  CL-LAST-MAINT-TYPE      PIC X.
  1652             88  CLAIM-SET-UP           VALUE ' '.
  1653             88  PAYMENT-MADE           VALUE '1'.
  1654             88  LETTER-SENT            VALUE '2'.
  1655             88  MASTER-WAS-ALTERED     VALUE '3'.
  1656             88  MASTER-WAS-RESTORED    VALUE '4'.
  1657             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1658             88  FILE-CONVERTED         VALUE '6'.
  1659             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1660             88  ERROR-CORRECTION       VALUE 'E'.
  1661         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1662         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1663         16  CL-BENEFICIARY          PIC X(10).
  1664         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1665         16  CL-DENIAL-TYPE          PIC X.
  1666             88  CL-TYPE-DENIAL          VALUE '1'.
  1667             88  CL-TYPE-RESCISSION      VALUE '2'.
  1668             88  CL-TYPE-REFORMATION     VALUE '3'.
  1669             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1670             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1671         16  FILLER                  PIC X(5).
  1672
  1673     12  CL-TRAILER-CONTROLS.
  1674         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1675             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1676             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1677             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1678         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1679         16  FILLER                  PIC XX.
  1680         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1681         16  CL-ADDRESS-TRAILER-CNT.
  1682             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1683                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1684             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1685                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1686             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1687                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1688             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1689                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1690             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1691                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1692             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1693                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1694             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1695                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1696
  1697     12  CL-CV-REFERENCE-NO.
  1698         16  CL-CV-REFNO-PRIME       PIC X(18).
  1699         16  CL-CV-REFNO-SFX         PIC XX.
  1700
  1701     12  CL-FILE-LOCATION            PIC X(4).
  1702
  1703     12  CL-PROCESS-ERRORS.
  1704         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1705             88  NO-FATAL-ERRORS        VALUE ZERO.
  1706         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1707             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1708
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL150.cbl
  1709     12  CL-PRODUCT-CD               PIC X.
  1710
  1711     12  CL-CURRENT-KEY-DATA.
  1712         16  CL-CURRENT-CARRIER      PIC X.
  1713         16  CL-CURRENT-GROUPING     PIC X(6).
  1714         16  CL-CURRENT-STATE        PIC XX.
  1715         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1716
  1717     12  CL-ASSOCIATES               PIC X.
  1718         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1719         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1720         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1721         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1722
  1723     12  CL-ACTIVITY-CODE            PIC 99.
  1724     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1725     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1726
  1727     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1728     12  CL-LAG-REPORT-CODE          PIC 9.
  1729     12  CL-LOAN-TYPE                PIC XX.
  1730     12  CL-LEGAL-STATE              PIC XX.
  1731
  1732*    12  FILLER                      PIC X(5).
  1733     12  CL-YESNOSW                  PIC X.
  1734     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL150.cbl
  1736*                            COPY ELCEMIB.
  1737******************************************************************
  1738*                                                                *
  1739*                                                                *
  1740*                            ELCEMIB.                            *
  1741*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1742*                            VMOD=2.005                          *
  1743*                                                                *
  1744*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1745*                                                                *
  1746******************************************************************
  1747 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1748     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1749     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1750     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1751     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1752     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1753     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1754     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1755     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1756     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1757         88  EMI-NO-ERRORS                    VALUE '1'.
  1758         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1759         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1760     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1761         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1762     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1763         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1764         88  EMI-AREA1-FULL                   VALUE '2'.
  1765     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1766         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1767         88  EMI-AREA2-FULL                   VALUE '2'.
  1768     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1769         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1770         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1771         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1772         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1773         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1774     12  EMI-ERROR-LINES.
  1775         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1776         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1777         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1778         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1779             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1780                 24  EMI-ERR-NUM         PIC X(4).
  1781                 24  EMI-FILLER          PIC X.
  1782                 24  EMI-SEV             PIC X.
  1783                 24  FILLER              PIC X.
  1784             20  FILLER                  PIC X(02).
  1785     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1786         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1787             20  EMI-ERROR-NUMBER    PIC X(4).
  1788             20  EMI-FILL            PIC X.
  1789             20  EMI-SEVERITY        PIC X.
  1790             20  FILLER              PIC X.
  1791             20  EMI-ERROR-TEXT.
  1792                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1793                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL150.cbl
  1794     12  EMI-SEVERITY-SAVE           PIC X.
  1795         88  EMI-NOTE                    VALUE 'N'.
  1796         88  EMI-WARNING                 VALUE 'W'.
  1797         88  EMI-FORCABLE                VALUE 'F'.
  1798         88  EMI-FATAL                   VALUE 'X'.
  1799     12  EMI-MESSAGE-FLAG            PIC X.
  1800         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1801         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1802     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1803     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1804         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1805         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1806         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1807     12  FILLER                      PIC X(137)  VALUE SPACES.
  1808     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1809     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1810     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1811     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL150.cbl
  1813*                            COPY ELCLNKLT.
  1814******************************************************************
  1815*                                                                *
  1816*                                                                *
  1817*                           ELCLNKLT                             *
  1818*                            VMOD=2.003                          *
  1819*                                                                *
  1820*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1821*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1822*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1823*                                                                *
  1824*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1825*   COMPLETING THE REQUIRED FIELDS.                              *
  1826*                                                                *
  1827*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1828*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1829*                              9999 INDICATES AN UNKNOWN ABEND   *
  1830*                                   WAS DETECTED.                *
  1831*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1832*                              CODES FOUND IN THE ERROR FILE.    *
  1833******************************************************************
  1834 01  W-1523-LINKDATA.
  1835     12  W-1523-COMMON-PI-DATA.
  1836         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1837         16  FILLER              PIC  X(67).
  1838         16  W-1523-COMPANY-CD   PIC  X(01).
  1839         16  FILLER              PIC  X(10).
  1840         16  W-1523-CONTROL-IN-PROGRESS.
  1841             20  W-1523-CARRIER  PIC  X(01).
  1842             20  W-1523-GROUPING PIC  X(06).
  1843             20  W-1523-STATE    PIC  X(02).
  1844             20  W-1523-ACCOUNT  PIC  X(10).
  1845             20  W-1523-CLAIM-CERT-GRP.
  1846                 24  W-1523-CLAIM-NO
  1847                                 PIC  X(07).
  1848                 24  W-1523-CERT-NO.
  1849                     28  W-1523-CERT-PRIME
  1850                                 PIC  X(10).
  1851                     28  W-1523-CERT-SFX
  1852                                 PIC  X(01).
  1853                 24  W-1523-CERT-EFF-DT
  1854                                 PIC  X(02).
  1855         16  FILLER              PIC X(265).
  1856
  1857     12  W-1523-WORK-AREA.
  1858         16  W-1523-FORM-NUMBER  PIC  X(04).
  1859         16  W-1523-NUMBER-COPIES
  1860                                 PIC  9(01).
  1861         16  W-1523-ADDR-TYPE    PIC  X(02).
  1862         16  W-1523-FOLLOW-UP-DATE
  1863                                 PIC  X(02).
  1864         16  W-1523-RESEND-DATE  PIC  X(02).
  1865         16  W-1523-ERROR-CODE   PIC  9(04).
  1866             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1867             88  W-1523-FATAL-ERROR
  1868                                    VALUES  0006 0013 0042
  1869                                            0154 0168 0169
  1870                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL150.cbl
  1871                                            0179 0186 0281
  1872                                            0332 2055 3697
  1873                                            3698 3699 3770
  1874                                            3771 3772 7675
  1875                                            9106 9808 9883
  1876                                            9887.
  1877             88  W-1523-STOP-ERRORS
  1878                                    VALUES  0013 0042 0154
  1879                                            0168 0169 0172
  1880                                            0281 0332 2055
  1881                                            3698 3699 7675
  1882                                            9106 9808 9883
  1883                                            9999.
  1884         16  W-1523-REASON       PIC  X(70).
  1885         16  W-1523-ARCHIVE-NUMBER
  1886                                 PIC  9(08).
  1887     12  W-1523-POINTER-AREA.
  1888         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1889         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1890         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1891         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1892         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL150.cbl
  1894*                            COPY ELCINTF.
  1895******************************************************************
  1896*                                                                *
  1897*                                                                *
  1898*                            ELCINTF.                            *
  1899*                            VMOD=2.017                          *
  1900*                                                                *
  1901*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1902*                                                                *
  1903*       LENGTH = 1024                                            *
  1904*                                                                *
  1905******************************************************************
  1906 01  PROGRAM-INTERFACE-BLOCK.
  1907     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1908     12  PI-CALLING-PROGRAM              PIC X(8).
  1909     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1910     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1911     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1912     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1913     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1914     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1915     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1916     12  PI-COMPANY-ID                   PIC XXX.
  1917     12  PI-COMPANY-CD                   PIC X.
  1918
  1919     12  PI-COMPANY-PASSWORD             PIC X(8).
  1920
  1921     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1922
  1923     12  PI-CONTROL-IN-PROGRESS.
  1924         16  PI-CARRIER                  PIC X.
  1925         16  PI-GROUPING                 PIC X(6).
  1926         16  PI-STATE                    PIC XX.
  1927         16  PI-ACCOUNT                  PIC X(10).
  1928         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1929                                         PIC X(10).
  1930         16  PI-CLAIM-CERT-GRP.
  1931             20  PI-CLAIM-NO             PIC X(7).
  1932             20  PI-CERT-NO.
  1933                 25  PI-CERT-PRIME       PIC X(10).
  1934                 25  PI-CERT-SFX         PIC X.
  1935             20  PI-CERT-EFF-DT          PIC XX.
  1936         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1937             20  PI-PLAN-CODE            PIC X(2).
  1938             20  PI-REVISION-NUMBER      PIC X(3).
  1939             20  PI-PLAN-EFF-DT          PIC X(2).
  1940             20  PI-PLAN-EXP-DT          PIC X(2).
  1941             20  FILLER                  PIC X(11).
  1942         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1943             20  PI-OE-REFERENCE-1.
  1944                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1945                 25  PI-OE-REF-1-SUFF    PIC XX.
  1946
  1947     12  PI-SESSION-IN-PROGRESS          PIC X.
  1948         88  CLAIM-SESSION                   VALUE '1'.
  1949         88  CREDIT-SESSION                  VALUE '2'.
  1950         88  WARRANTY-SESSION                VALUE '3'.
  1951         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL150.cbl
  1952         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1953
  1954
  1955*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1956
  1957     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1958     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1959
  1960     12  PI-CREDIT-USER                  PIC X.
  1961         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1962         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1963
  1964     12  PI-CLAIM-USER                   PIC X.
  1965         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1966         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1967
  1968     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1969         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1970         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1971         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1972         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1973         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1974
  1975     12  PI-PROCESSOR-ID                 PIC X(4).
  1976
  1977     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1978
  1979     12  PI-MEMBER-CAPTION               PIC X(10).
  1980
  1981     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1982         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1983
  1984     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1985     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1986     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1987     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1988
  1989     12  PI-AH-OVERRIDE-L1               PIC X.
  1990     12  PI-AH-OVERRIDE-L2               PIC XX.
  1991     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1992     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1993
  1994     12  PI-NEW-SYSTEM                   PIC X(2).
  1995
  1996     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1997     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1998         88  PI-USES-PAID-TO                 VALUE '1'.
  1999     12  PI-CRDTCRD-SYSTEM.
  2000         16  PI-CRDTCRD-USER             PIC X.
  2001             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2002             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2003         16  PI-CC-MONTH-END-DT          PIC XX.
  2004     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2005
  2006     12  PI-OE-REFERENCE-2.
  2007         16  PI-OE-REF-2-PRIME           PIC X(10).
  2008         16  PI-OE-REF-2-SUFF            PIC X.
  2009
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL150.cbl
  2010     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2011
  2012     12  PI-LANGUAGE-TYPE                PIC X.
  2013             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2014             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2015             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2016
  2017     12  PI-POLICY-LINKAGE-IND           PIC X.
  2018         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2019         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2020                                                   LOW-VALUES.
  2021
  2022     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2023     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2024         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2025         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2026     12  FILLER                          PIC X(4).
  2027
  2028     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2029
  2030     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2031         PI-SYSTEM-LEVEL.
  2032
  2033         16  PI-ENTRY-CODES.
  2034             20  PI-ENTRY-CD-1           PIC X.
  2035             20  PI-ENTRY-CD-2           PIC X.
  2036
  2037         16  PI-RETURN-CODES.
  2038             20  PI-RETURN-CD-1          PIC X.
  2039             20  PI-RETURN-CD-2          PIC X.
  2040
  2041         16  PI-UPDATE-STATUS-SAVE.
  2042             20  PI-UPDATE-BY            PIC X(4).
  2043             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2044
  2045         16  PI-LOWER-CASE-LETTERS       PIC X.
  2046             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2047
  2048*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2049*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2050*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2051
  2052         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2053             88  ST-ACCNT-CNTL               VALUE ' '.
  2054             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2055             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2056             88  ACCNT-CNTL                  VALUE '3'.
  2057             88  CARR-ACCNT-CNTL             VALUE '4'.
  2058
  2059         16  PI-PROCESSOR-CAP-LIST.
  2060             20  PI-SYSTEM-CONTROLS.
  2061                24 PI-SYSTEM-DISPLAY     PIC X.
  2062                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2063                24 PI-SYSTEM-MODIFY      PIC X.
  2064                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2065             20  FILLER                  PIC XX.
  2066             20  PI-DISPLAY-CAP          PIC X.
  2067                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL150.cbl
  2068             20  PI-MODIFY-CAP           PIC X.
  2069                 88  MODIFY-CAP              VALUE 'Y'.
  2070             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2071                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2072             20  PI-FORCE-CAP            PIC X.
  2073                 88  FORCE-CAP               VALUE 'Y'.
  2074
  2075         16  PI-PROGRAM-CONTROLS.
  2076             20  PI-PGM-PRINT-OPT        PIC X.
  2077             20  PI-PGM-FORMAT-OPT       PIC X.
  2078             20  PI-PGM-PROCESS-OPT      PIC X.
  2079             20  PI-PGM-TOTALS-OPT       PIC X.
  2080
  2081         16  PI-HELP-INTERFACE.
  2082             20  PI-LAST-ERROR-NO        PIC X(4).
  2083             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2084
  2085         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2086             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2087
  2088         16  PI-CR-CONTROL-IN-PROGRESS.
  2089             20  PI-CR-CARRIER           PIC X.
  2090             20  PI-CR-GROUPING          PIC X(6).
  2091             20  PI-CR-STATE             PIC XX.
  2092             20  PI-CR-ACCOUNT           PIC X(10).
  2093             20  PI-CR-FIN-RESP          PIC X(10).
  2094             20  PI-CR-TYPE              PIC X.
  2095
  2096         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2097
  2098         16  PI-CR-MONTH-END-DT          PIC XX.
  2099
  2100         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2101             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2102             88  PI-ZERO-CARRIER             VALUE '1'.
  2103             88  PI-ZERO-GROUPING            VALUE '2'.
  2104             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2105
  2106         16  PI-CARRIER-SECURITY         PIC X.
  2107             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2108
  2109         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2110             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2111             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  2112
  2113         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2114             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2115                                         INDEXED BY PI-ACCESS-NDX
  2116                                         PIC X.
  2117
  2118         16  PI-GA-BILLING-CONTROL       PIC X.
  2119             88  PI-GA-BILLING               VALUE '1'.
  2120
  2121         16  PI-MAIL-PROCESSING          PIC X.
  2122             88  PI-MAIL-YES                 VALUE 'Y'.
  2123
  2124         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2125
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL150.cbl
  2126         16  PI-AR-SYSTEM.
  2127             20  PI-AR-PROCESSING-CNTL   PIC X.
  2128                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2129             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2130             20  PI-AR-MONTH-END-DT      PIC XX.
  2131
  2132         16  PI-MP-SYSTEM.
  2133             20  PI-MORTGAGE-USER            PIC X.
  2134                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2135                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2136             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2137                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2138                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2139                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2140                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2141                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2142             20  PI-MP-MONTH-END-DT          PIC XX.
  2143             20  PI-MP-REFERENCE-NO.
  2144                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2145                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2146
  2147         16  PI-LABEL-CONTROL            PIC X(01).
  2148             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2149             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2150
  2151         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2152             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2153
  2154         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2155             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2156             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2157
  2158         16  FILLER                      PIC X(14).
  2159
  2160     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2161******************************************************************
  2162     12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
  2163         16  PI-PASS-AREA        PIC  S9(4) COMP.
  2164         16  PI-EL142-PRIORITY   PIC  X.
  2165         16  FILLER              PIC  X(211).
  2166         16  PI-CURRENT-FILE     PIC  X(08).
  2167         16  PI-ORIGINAL-ASS-CERT
  2168                                 PIC  X(20).
  2169         16  PI-TOTAL-PAID       PIC S9(07)V99 COMP-3.
  2170         16  PI-DAYS-PAID        PIC S9(05) COMP-3.
  2171         16  PI-LAST-SEQ-NO      PIC S9(03) COMP-3.
  2172         16  PI-LAST-PF-KEY-IND  PIC  X.
  2173             88  PI-PF15-LAST            VALUE 'F'.
  2174             88  PI-PF16-LAST            VALUE 'S'.
  2175         16  PI-ASSOCIATED-PROCESS-IND
  2176                                 PIC  X.
  2177             88  PI-ASS-PROCESSING       VALUE 'Y'.
  2178             88  PI-NOT-ASS-PROCESSING   VALUE SPACES LOW-VALUES.
  2179         16  PI-ASS-NDX          PIC S9(04) COMP.
  2180         16  PI-ASSOCIATED-CERTS-TABLE.
  2181             20  PI-ASS-CERTS OCCURS 24 TIMES
  2182                                 PIC  X(11).
  2183*00545          16  FILLER              PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL150.cbl
  2184         16  FILLER              PIC  X(05).
  2185         16  PI-FORCE-COUNT      PIC  99.
  2186         16  PI-PFKEY-USED       PIC  X.
  2187         16  PI-JOINT-COV-IND    PIC  X.
  2188             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2189             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2190         16  PI-JOINT-INSURED-IND PIC X.
  2191             88  PI-JOINT-INSURED        VALUE 'Y'.
  2192             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2193         16  PI-PRIORITY-CD      PIC  X.
  2194             88  PI-PRIORITY-9           VALUE '9'.
  2195         16  PI-STATUS-IND       PIC  X.
  2196             88  PI-CLOSED               VALUE 'C'.
  2197             88  PI-OPEN                 VALUE 'O'.
  2198         16  PI-LAST-CLOSE-REASON-IND
  2199                                 PIC  X.
  2200             88  PI-BENEFIT-CHANGE       VALUE 'C'.
  2201             88  PI-ERROR-CORRECTION     VALUE 'E'.
  2202         16  PI-PRIORITY-IND     PIC  X.
  2203             88  PI-SUPERVISOR-ONLY      VALUE 'S'.
  2204             88  PI-CONFIDENTIAL-UP      VALUE 'C'.
  2205         16  PI-RETRIEVED-DATA-IND
  2206                                 PIC  X.
  2207             88  PI-RETRIEVED-DATA       VALUE 'Y'.
  2208*        16  PI-SAVE             PIC  X(227).
  2209         16  PI-SAVE-TYPE        PIC  X.
  2210         16  PI-SAVE-FILETO      PIC  X(4).
  2211         16  PI-SAVE-PRTOPT      PIC  X.
  2212         16  PI-SAVE-FORMAT      PIC  X.
  2213         16  PI-SAVE-FORM        PIC  X(12).
  2214         16  PI-PREV-DISP        PIC  X.
  2215         16  PI-PREV-DIR         PIC  X.
  2216         16  PI-SAVE-CURSOR      PIC S9(04) COMP.
  2217         16  PI-SAVE-CNT         PIC S9(04) COMP.
  2218         16  PI-SAVE-LOW         PIC S9(04) COMP.
  2219         16  PI-SAVE-HIGH        PIC S9(04) COMP.
  2220         16  PI-PREV-CLAIM.
  2221             20  PI-PREV-COMP-CD PIC X.
  2222             20  PI-PREV-CARRIER PIC X.
  2223             20  PI-PREV-CLAIM-NO PIC X(7).
  2224             20  PI-PREV-CERT-NO.
  2225                 24  PI-PREV-CERT-NO-PRIME
  2226                                 PIC X(10).
  2227                 24  PI-CERT-NO-SUFX   PIC X.
  2228         16  PI-PREV-PRIME-CERT-NO
  2229                                 PIC X(11).
  2230         16  PI-PURGED-SW        PIC  X.
  2231             88  CLAIM-IS-PURGED         VALUE 'Y'.
  2232         16  PI-PREV-CLMNO       PIC  X(07).
  2233         16  PI-SAVE-MCRFLM      PIC  X(10).
  2234         16  PI-PREV-TRLR-KEY    PIC  X(22).
  2235         16  PI-SAVE-ACT-CD      PIC  XX.
  2236         16  PI-SAVE-ASSOC       PIC  X.
  2237         16  PI-SAVE-SYS-ID      PIC  XX.
  2238*        16  PI-SAVE-CLOAN       PIC  X(25).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL150.cbl
  2240*                            COPY ELCJPFX.
  2241******************************************************************
  2242*                                                                *
  2243*                                                                *
  2244*                            ELCJPFX.                            *
  2245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2246*                            VMOD=2.002                          *
  2247*                                                                *
  2248*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2249*                                                                *
  2250*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2251*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2252*        ELCNTL - CONTROL FILE                                   *
  2253*        ELMSTR - CLAIM MASTERS                                  *
  2254*        ELTRLR - ACTIVITY TRAILERS                              *
  2255*        ELCHKQ - CHECK QUE                                      *
  2256******************************************************************
  2257 01  JOURNAL-RECORD.
  2258     12  JP-USER-ID                  PIC X(4).
  2259     12  JP-FILE-ID                  PIC X(8).
  2260     12  JP-PROGRAM-ID               PIC X(8).
  2261     12  JP-RECORD-TYPE              PIC X.
  2262         88 JP-ADD              VALUE 'A'.
  2263         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2264         88 JP-AFTER-CHANGE     VALUE 'C'.
  2265         88 JP-DELETE           VALUE 'D'.
  2266         88 JP-GENERIC-DELETE   VALUE 'G'.
  2267         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2268         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2269     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2270     12  JP-RECORD-AREA
  2271
  2272
  2273                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL150.cbl
  2275*                            COPY ELCAID.
  2276******************************************************************
  2277*                                                                *
  2278*                            ELCAID.                             *
  2279*                            VMOD=2.001                          *
  2280*                                                                *
  2281*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2282*                                                                *
  2283*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2284*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2285******************************************************************
  2286
  2287 01  DFHAID.
  2288   02  DFHNULL   PIC  X  VALUE  ' '.
  2289   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2290   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2291   02  DFHPEN    PIC  X  VALUE  '='.
  2292   02  DFHOPID   PIC  X  VALUE  'W'.
  2293   02  DFHPA1    PIC  X  VALUE  '%'.
  2294   02  DFHPA2    PIC  X  VALUE  '>'.
  2295   02  DFHPA3    PIC  X  VALUE  ','.
  2296   02  DFHPF1    PIC  X  VALUE  '1'.
  2297   02  DFHPF2    PIC  X  VALUE  '2'.
  2298   02  DFHPF3    PIC  X  VALUE  '3'.
  2299   02  DFHPF4    PIC  X  VALUE  '4'.
  2300   02  DFHPF5    PIC  X  VALUE  '5'.
  2301   02  DFHPF6    PIC  X  VALUE  '6'.
  2302   02  DFHPF7    PIC  X  VALUE  '7'.
  2303   02  DFHPF8    PIC  X  VALUE  '8'.
  2304   02  DFHPF9    PIC  X  VALUE  '9'.
  2305   02  DFHPF10   PIC  X  VALUE  ':'.
  2306   02  DFHPF11   PIC  X  VALUE  '#'.
  2307   02  DFHPF12   PIC  X  VALUE  '@'.
  2308   02  DFHPF13   PIC  X  VALUE  'A'.
  2309   02  DFHPF14   PIC  X  VALUE  'B'.
  2310   02  DFHPF15   PIC  X  VALUE  'C'.
  2311   02  DFHPF16   PIC  X  VALUE  'D'.
  2312   02  DFHPF17   PIC  X  VALUE  'E'.
  2313   02  DFHPF18   PIC  X  VALUE  'F'.
  2314   02  DFHPF19   PIC  X  VALUE  'G'.
  2315   02  DFHPF20   PIC  X  VALUE  'H'.
  2316   02  DFHPF21   PIC  X  VALUE  'I'.
  2317*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2318   02  DFHPF22   PIC  X  VALUE  '['.
  2319   02  DFHPF23   PIC  X  VALUE  '.'.
  2320   02  DFHPF24   PIC  X  VALUE  '<'.
  2321   02  DFHMSRE   PIC  X  VALUE  'X'.
  2322   02  DFHSTRF   PIC  X  VALUE  'h'.
  2323   02  DFHTRIG   PIC  X  VALUE  '"'.
  2324 01  FILLER    REDEFINES DFHAID.
  2325     12  FILLER              PIC X(8).
  2326     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL150.cbl
  2328*                            COPY EL150S.
  2329 01  EL150AI.
  2330     05  FILLER            PIC  X(0012).
  2331*    -------------------------------
  2332     05  RUNDTEL PIC S9(0004) COMP.
  2333     05  RUNDTEF PIC  X(0001).
  2334     05  FILLER REDEFINES RUNDTEF.
  2335         10  RUNDTEA PIC  X(0001).
  2336     05  RUNDTEI PIC  X(0008).
  2337*    -------------------------------
  2338     05  RUNTIMEL PIC S9(0004) COMP.
  2339     05  RUNTIMEF PIC  X(0001).
  2340     05  FILLER REDEFINES RUNTIMEF.
  2341         10  RUNTIMEA PIC  X(0001).
  2342     05  RUNTIMEI PIC  X(0005).
  2343*    -------------------------------
  2344     05  SEQUL PIC S9(0004) COMP.
  2345     05  SEQUF PIC  X(0001).
  2346     05  FILLER REDEFINES SEQUF.
  2347         10  SEQUA PIC  X(0001).
  2348     05  SEQUI PIC  X(0010).
  2349*    -------------------------------
  2350     05  CMPNYIDL PIC S9(0004) COMP.
  2351     05  CMPNYIDF PIC  X(0001).
  2352     05  FILLER REDEFINES CMPNYIDF.
  2353         10  CMPNYIDA PIC  X(0001).
  2354     05  CMPNYIDI PIC  X(0003).
  2355*    -------------------------------
  2356     05  USERIDL PIC S9(0004) COMP.
  2357     05  USERIDF PIC  X(0001).
  2358     05  FILLER REDEFINES USERIDF.
  2359         10  USERIDA PIC  X(0001).
  2360     05  USERIDI PIC  X(0004).
  2361*    -------------------------------
  2362     05  RETMSTL PIC S9(0004) COMP.
  2363     05  RETMSTF PIC  X(0001).
  2364     05  FILLER REDEFINES RETMSTF.
  2365         10  RETMSTA PIC  X(0001).
  2366     05  RETMSTI PIC  X(0015).
  2367*    -------------------------------
  2368     05  CRDCARDL PIC S9(0004) COMP.
  2369     05  CRDCARDF PIC  X(0001).
  2370     05  FILLER REDEFINES CRDCARDF.
  2371         10  CRDCARDA PIC  X(0001).
  2372     05  CRDCARDI PIC  X(0016).
  2373*    -------------------------------
  2374     05  CLMNOL PIC S9(0004) COMP.
  2375     05  CLMNOF PIC  X(0001).
  2376     05  FILLER REDEFINES CLMNOF.
  2377         10  CLMNOA PIC  X(0001).
  2378     05  CLMNOI PIC  X(0007).
  2379*    -------------------------------
  2380     05  CARRL PIC S9(0004) COMP.
  2381     05  CARRF PIC  X(0001).
  2382     05  FILLER REDEFINES CARRF.
  2383         10  CARRA PIC  X(0001).
  2384     05  CARRI PIC  X(0001).
  2385*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL150.cbl
  2386     05  CERTNOL PIC S9(0004) COMP.
  2387     05  CERTNOF PIC  X(0001).
  2388     05  FILLER REDEFINES CERTNOF.
  2389         10  CERTNOA PIC  X(0001).
  2390     05  CERTNOI PIC  X(0010).
  2391*    -------------------------------
  2392     05  SUFXL PIC S9(0004) COMP.
  2393     05  SUFXF PIC  X(0001).
  2394     05  FILLER REDEFINES SUFXF.
  2395         10  SUFXA PIC  X(0001).
  2396     05  SUFXI PIC  X(0001).
  2397*    -------------------------------
  2398     05  CLMTYPL PIC S9(0004) COMP.
  2399     05  CLMTYPF PIC  X(0001).
  2400     05  FILLER REDEFINES CLMTYPF.
  2401         10  CLMTYPA PIC  X(0001).
  2402     05  CLMTYPI PIC  X(0006).
  2403*    -------------------------------
  2404     05  CLMSTATL PIC S9(0004) COMP.
  2405     05  CLMSTATF PIC  X(0001).
  2406     05  FILLER REDEFINES CLMSTATF.
  2407         10  CLMSTATA PIC  X(0001).
  2408     05  CLMSTATI PIC  X(0006).
  2409*    -------------------------------
  2410     05  LSTNMEL PIC S9(0004) COMP.
  2411     05  LSTNMEF PIC  X(0001).
  2412     05  FILLER REDEFINES LSTNMEF.
  2413         10  LSTNMEA PIC  X(0001).
  2414     05  LSTNMEI PIC  X(0015).
  2415*    -------------------------------
  2416     05  FSTNMEL PIC S9(0004) COMP.
  2417     05  FSTNMEF PIC  X(0001).
  2418     05  FILLER REDEFINES FSTNMEF.
  2419         10  FSTNMEA PIC  X(0001).
  2420     05  FSTNMEI PIC  X(0012).
  2421*    -------------------------------
  2422     05  MINITL PIC S9(0004) COMP.
  2423     05  MINITF PIC  X(0001).
  2424     05  FILLER REDEFINES MINITF.
  2425         10  MINITA PIC  X(0001).
  2426     05  MINITI PIC  X(0001).
  2427*    -------------------------------
  2428     05  PRIMHDGL PIC S9(0004) COMP.
  2429     05  PRIMHDGF PIC  X(0001).
  2430     05  FILLER REDEFINES PRIMHDGF.
  2431         10  PRIMHDGA PIC  X(0001).
  2432     05  PRIMHDGI PIC  X(0012).
  2433*    -------------------------------
  2434     05  PRIMCRTL PIC S9(0004) COMP.
  2435     05  PRIMCRTF PIC  X(0001).
  2436     05  FILLER REDEFINES PRIMCRTF.
  2437         10  PRIMCRTA PIC  X(0001).
  2438     05  PRIMCRTI PIC  X(0010).
  2439*    -------------------------------
  2440     05  PRIMSFXL PIC S9(0004) COMP.
  2441     05  PRIMSFXF PIC  X(0001).
  2442     05  FILLER REDEFINES PRIMSFXF.
  2443         10  PRIMSFXA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL150.cbl
  2444     05  PRIMSFXI PIC  X(0001).
  2445*    -------------------------------
  2446     05  NOTIFYL PIC S9(0004) COMP.
  2447     05  NOTIFYF PIC  X(0001).
  2448     05  FILLER REDEFINES NOTIFYF.
  2449         10  NOTIFYA PIC  X(0001).
  2450     05  NOTIFYI PIC  X(0013).
  2451*    -------------------------------
  2452     05  CLMTOTHL PIC S9(0004) COMP.
  2453     05  CLMTOTHF PIC  X(0001).
  2454     05  FILLER REDEFINES CLMTOTHF.
  2455         10  CLMTOTHA PIC  X(0001).
  2456     05  CLMTOTHI PIC  X(0027).
  2457*    -------------------------------
  2458     05  AMTPDL PIC S9(0004) COMP.
  2459     05  AMTPDF PIC  X(0001).
  2460     05  FILLER REDEFINES AMTPDF.
  2461         10  AMTPDA PIC  X(0001).
  2462     05  AMTPDI PIC  X(0011).
  2463*    -------------------------------
  2464     05  DAYSPDHL PIC S9(0004) COMP.
  2465     05  DAYSPDHF PIC  X(0001).
  2466     05  FILLER REDEFINES DAYSPDHF.
  2467         10  DAYSPDHA PIC  X(0001).
  2468     05  DAYSPDHI PIC  X(0010).
  2469*    -------------------------------
  2470     05  DAYSPDL PIC S9(0004) COMP.
  2471     05  DAYSPDF PIC  X(0001).
  2472     05  FILLER REDEFINES DAYSPDF.
  2473         10  DAYSPDA PIC  X(0001).
  2474     05  DAYSPDI PIC  X(0005).
  2475*    -------------------------------
  2476     05  YESNOSWL PIC S9(0004) COMP.
  2477     05  YESNOSWF PIC  X(0001).
  2478     05  FILLER REDEFINES YESNOSWF.
  2479         10  YESNOSWA PIC  X(0001).
  2480     05  YESNOSWI PIC  X(0001).
  2481*    -------------------------------
  2482     05  PDTHRHDL PIC S9(0004) COMP.
  2483     05  PDTHRHDF PIC  X(0001).
  2484     05  FILLER REDEFINES PDTHRHDF.
  2485         10  PDTHRHDA PIC  X(0001).
  2486     05  PDTHRHDI PIC  X(0014).
  2487*    -------------------------------
  2488     05  PDTHRUL PIC S9(0004) COMP.
  2489     05  PDTHRUF PIC  X(0001).
  2490     05  FILLER REDEFINES PDTHRUF.
  2491         10  PDTHRUA PIC  X(0001).
  2492     05  PDTHRUI PIC  X(0008).
  2493*    -------------------------------
  2494     05  TOTPAIDL PIC S9(0004) COMP.
  2495     05  TOTPAIDF PIC  X(0001).
  2496     05  FILLER REDEFINES TOTPAIDF.
  2497         10  TOTPAIDA PIC  X(0001).
  2498     05  TOTPAIDI PIC  X(0010).
  2499*    -------------------------------
  2500     05  COVERDL PIC S9(0004) COMP.
  2501     05  COVERDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL150.cbl
  2502     05  FILLER REDEFINES COVERDF.
  2503         10  COVERDA PIC  X(0001).
  2504     05  COVERDI PIC  X(0012).
  2505*    -------------------------------
  2506     05  COVERL PIC S9(0004) COMP.
  2507     05  COVERF PIC  X(0001).
  2508     05  FILLER REDEFINES COVERF.
  2509         10  COVERA PIC  X(0001).
  2510     05  COVERI PIC  X(0010).
  2511*    -------------------------------
  2512     05  INCURL PIC S9(0004) COMP.
  2513     05  INCURF PIC  X(0001).
  2514     05  FILLER REDEFINES INCURF.
  2515         10  INCURA PIC  X(0001).
  2516     05  INCURI PIC  X(0008).
  2517*    -------------------------------
  2518     05  NOPMTSL PIC S9(0004) COMP.
  2519     05  NOPMTSF PIC  X(0001).
  2520     05  FILLER REDEFINES NOPMTSF.
  2521         10  NOPMTSA PIC  X(0001).
  2522     05  NOPMTSI PIC  X(0007).
  2523*    -------------------------------
  2524     05  PRMTYPDL PIC S9(0004) COMP.
  2525     05  PRMTYPDF PIC  X(0001).
  2526     05  FILLER REDEFINES PRMTYPDF.
  2527         10  PRMTYPDA PIC  X(0001).
  2528     05  PRMTYPDI PIC  X(0012).
  2529*    -------------------------------
  2530     05  PRMTYPEL PIC S9(0004) COMP.
  2531     05  PRMTYPEF PIC  X(0001).
  2532     05  FILLER REDEFINES PRMTYPEF.
  2533         10  PRMTYPEA PIC  X(0001).
  2534     05  PRMTYPEI PIC  X(0008).
  2535*    -------------------------------
  2536     05  NXTAUTOL PIC S9(0004) COMP.
  2537     05  NXTAUTOF PIC  X(0001).
  2538     05  FILLER REDEFINES NXTAUTOF.
  2539         10  NXTAUTOA PIC  X(0001).
  2540     05  NXTAUTOI PIC  X(0008).
  2541*    -------------------------------
  2542     05  ESTABDTL PIC S9(0004) COMP.
  2543     05  ESTABDTF PIC  X(0001).
  2544     05  FILLER REDEFINES ESTABDTF.
  2545         10  ESTABDTA PIC  X(0001).
  2546     05  ESTABDTI PIC  X(0008).
  2547*    -------------------------------
  2548     05  CRTSTADL PIC S9(0004) COMP.
  2549     05  CRTSTADF PIC  X(0001).
  2550     05  FILLER REDEFINES CRTSTADF.
  2551         10  CRTSTADA PIC  X(0001).
  2552     05  CRTSTADI PIC  X(0012).
  2553*    -------------------------------
  2554     05  CRTSTATL PIC S9(0004) COMP.
  2555     05  CRTSTATF PIC  X(0001).
  2556     05  FILLER REDEFINES CRTSTATF.
  2557         10  CRTSTATA PIC  X(0001).
  2558     05  CRTSTATI PIC  X(0010).
  2559*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL150.cbl
  2560     05  EFFECTL PIC S9(0004) COMP.
  2561     05  EFFECTF PIC  X(0001).
  2562     05  FILLER REDEFINES EFFECTF.
  2563         10  EFFECTA PIC  X(0001).
  2564     05  EFFECTI PIC  X(0008).
  2565*    -------------------------------
  2566     05  TOTINTL PIC S9(0004) COMP.
  2567     05  TOTINTF PIC  X(0001).
  2568     05  FILLER REDEFINES TOTINTF.
  2569         10  TOTINTA PIC  X(0001).
  2570     05  TOTINTI PIC  X(0010).
  2571*    -------------------------------
  2572     05  STATEL PIC S9(0004) COMP.
  2573     05  STATEF PIC  X(0001).
  2574     05  FILLER REDEFINES STATEF.
  2575         10  STATEA PIC  X(0001).
  2576     05  STATEI PIC  X(0003).
  2577*    -------------------------------
  2578     05  ACCTL PIC S9(0004) COMP.
  2579     05  ACCTF PIC  X(0001).
  2580     05  FILLER REDEFINES ACCTF.
  2581         10  ACCTA PIC  X(0001).
  2582     05  ACCTI PIC  X(0010).
  2583*    -------------------------------
  2584     05  EXPIREL PIC S9(0004) COMP.
  2585     05  EXPIREF PIC  X(0001).
  2586     05  FILLER REDEFINES EXPIREF.
  2587         10  EXPIREA PIC  X(0001).
  2588     05  EXPIREI PIC  X(0008).
  2589*    -------------------------------
  2590     05  BENECAPL PIC S9(0004) COMP.
  2591     05  BENECAPF PIC  X(0001).
  2592     05  FILLER REDEFINES BENECAPF.
  2593         10  BENECAPA PIC  X(0001).
  2594     05  BENECAPI PIC  X(0013).
  2595*    -------------------------------
  2596     05  BENEL PIC S9(0004) COMP.
  2597     05  BENEF PIC  X(0001).
  2598     05  FILLER REDEFINES BENEF.
  2599         10  BENEA PIC  X(0001).
  2600     05  BENEI PIC  X(0009).
  2601*    -------------------------------
  2602     05  TERMSL PIC S9(0004) COMP.
  2603     05  TERMSF PIC  X(0001).
  2604     05  FILLER REDEFINES TERMSF.
  2605         10  TERMSA PIC  X(0001).
  2606     05  TERMSI PIC  X(0013).
  2607*    -------------------------------
  2608     05  DIAGL PIC S9(0004) COMP.
  2609     05  DIAGF PIC  X(0001).
  2610     05  FILLER REDEFINES DIAGF.
  2611         10  DIAGA PIC  X(0001).
  2612     05  DIAGI PIC  X(0056).
  2613*    -------------------------------
  2614     05  FILETOL PIC S9(0004) COMP.
  2615     05  FILETOF PIC  X(0001).
  2616     05  FILLER REDEFINES FILETOF.
  2617         10  FILETOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL150.cbl
  2618     05  FILETOI PIC  X(0004).
  2619*    -------------------------------
  2620     05  PRTOPTL PIC S9(0004) COMP.
  2621     05  PRTOPTF PIC  X(0001).
  2622     05  FILLER REDEFINES PRTOPTF.
  2623         10  PRTOPTA PIC  X(0001).
  2624     05  PRTOPTI PIC  X(0001).
  2625*    -------------------------------
  2626     05  FORMATL PIC S9(0004) COMP.
  2627     05  FORMATF PIC  X(0001).
  2628     05  FILLER REDEFINES FORMATF.
  2629         10  FORMATA PIC  X(0001).
  2630     05  FORMATI PIC  X(0001).
  2631*    -------------------------------
  2632     05  ALTPRTL PIC S9(0004) COMP.
  2633     05  ALTPRTF PIC  X(0001).
  2634     05  FILLER REDEFINES ALTPRTF.
  2635         10  ALTPRTA PIC  X(0001).
  2636     05  ALTPRTI PIC  X(0004).
  2637*    -------------------------------
  2638     05  CLOANL PIC S9(0004) COMP.
  2639     05  CLOANF PIC  X(0001).
  2640     05  FILLER REDEFINES CLOANF.
  2641         10  CLOANA PIC  X(0001).
  2642     05  CLOANI PIC  X(0025).
  2643*    -------------------------------
  2644     05  DENTYPL PIC S9(0004) COMP.
  2645     05  DENTYPF PIC  X(0001).
  2646     05  FILLER REDEFINES DENTYPF.
  2647         10  DENTYPA PIC  X(0001).
  2648     05  DENTYPI PIC  X(0029).
  2649*    -------------------------------
  2650     05  ACTCDL PIC S9(0004) COMP.
  2651     05  ACTCDF PIC  X(0001).
  2652     05  FILLER REDEFINES ACTCDF.
  2653         10  ACTCDA PIC  X(0001).
  2654     05  ACTCDI PIC  99.
  2655*    -------------------------------
  2656     05  ACTDTL PIC S9(0004) COMP.
  2657     05  ACTDTF PIC  X(0001).
  2658     05  FILLER REDEFINES ACTDTF.
  2659         10  ACTDTA PIC  X(0001).
  2660     05  ACTDTI PIC  X(0008).
  2661*    -------------------------------
  2662     05  ACTTYPL PIC S9(0004) COMP.
  2663     05  ACTTYPF PIC  X(0001).
  2664     05  FILLER REDEFINES ACTTYPF.
  2665         10  ACTTYPA PIC  X(0001).
  2666     05  ACTTYPI PIC  X(0004).
  2667*    -------------------------------
  2668     05  ASSHDGL PIC S9(0004) COMP.
  2669     05  ASSHDGF PIC  X(0001).
  2670     05  FILLER REDEFINES ASSHDGF.
  2671         10  ASSHDGA PIC  X(0001).
  2672     05  ASSHDGI PIC  X(0006).
  2673*    -------------------------------
  2674     05  ASSOCL PIC S9(0004) COMP.
  2675     05  ASSOCF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL150.cbl
  2676     05  FILLER REDEFINES ASSOCF.
  2677         10  ASSOCA PIC  X(0001).
  2678     05  ASSOCI PIC  X(0001).
  2679*    -------------------------------
  2680     05  TRLR1L PIC S9(0004) COMP.
  2681     05  TRLR1F PIC  X(0001).
  2682     05  FILLER REDEFINES TRLR1F.
  2683         10  TRLR1A PIC  X(0001).
  2684     05  TRLR1I PIC  X(0079).
  2685*    -------------------------------
  2686     05  TRLR2L PIC S9(0004) COMP.
  2687     05  TRLR2F PIC  X(0001).
  2688     05  FILLER REDEFINES TRLR2F.
  2689         10  TRLR2A PIC  X(0001).
  2690     05  TRLR2I PIC  X(0079).
  2691*    -------------------------------
  2692     05  TRLR3L PIC S9(0004) COMP.
  2693     05  TRLR3F PIC  X(0001).
  2694     05  FILLER REDEFINES TRLR3F.
  2695         10  TRLR3A PIC  X(0001).
  2696     05  TRLR3I PIC  X(0079).
  2697*    -------------------------------
  2698     05  TRLR4L PIC S9(0004) COMP.
  2699     05  TRLR4F PIC  X(0001).
  2700     05  FILLER REDEFINES TRLR4F.
  2701         10  TRLR4A PIC  X(0001).
  2702     05  TRLR4I PIC  X(0079).
  2703*    -------------------------------
  2704     05  ERRMSG1L PIC S9(0004) COMP.
  2705     05  ERRMSG1F PIC  X(0001).
  2706     05  FILLER REDEFINES ERRMSG1F.
  2707         10  ERRMSG1A PIC  X(0001).
  2708     05  ERRMSG1I PIC  X(0079).
  2709*    -------------------------------
  2710     05  ENTERPFL PIC S9(0004) COMP.
  2711     05  ENTERPFF PIC  X(0001).
  2712     05  FILLER REDEFINES ENTERPFF.
  2713         10  ENTERPFA PIC  X(0001).
  2714     05  ENTERPFI PIC  99.
  2715*    -------------------------------
  2716     05  PFKEY11L PIC S9(0004) COMP.
  2717     05  PFKEY11F PIC  X(0001).
  2718     05  FILLER REDEFINES PFKEY11F.
  2719         10  PFKEY11A PIC  X(0001).
  2720     05  PFKEY11I PIC  X(0017).
  2721 01  EL150AO REDEFINES EL150AI.
  2722     05  FILLER            PIC  X(0012).
  2723*    -------------------------------
  2724     05  FILLER            PIC  X(0003).
  2725     05  RUNDTEO PIC  X(0008).
  2726*    -------------------------------
  2727     05  FILLER            PIC  X(0003).
  2728     05  RUNTIMEO PIC  99.99.
  2729*    -------------------------------
  2730     05  FILLER            PIC  X(0003).
  2731     05  SEQUO PIC  X(0010).
  2732*    -------------------------------
  2733     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL150.cbl
  2734     05  CMPNYIDO PIC  X(0003).
  2735*    -------------------------------
  2736     05  FILLER            PIC  X(0003).
  2737     05  USERIDO PIC  X(0004).
  2738*    -------------------------------
  2739     05  FILLER            PIC  X(0003).
  2740     05  RETMSTO PIC  X(0015).
  2741*    -------------------------------
  2742     05  FILLER            PIC  X(0003).
  2743     05  CRDCARDO PIC  X(0016).
  2744*    -------------------------------
  2745     05  FILLER            PIC  X(0003).
  2746     05  CLMNOO PIC  X(0007).
  2747*    -------------------------------
  2748     05  FILLER            PIC  X(0003).
  2749     05  CARRO PIC  X(0001).
  2750*    -------------------------------
  2751     05  FILLER            PIC  X(0003).
  2752     05  CERTNOO PIC  X(0010).
  2753*    -------------------------------
  2754     05  FILLER            PIC  X(0003).
  2755     05  SUFXO PIC  X(0001).
  2756*    -------------------------------
  2757     05  FILLER            PIC  X(0003).
  2758     05  CLMTYPO PIC  X(0006).
  2759*    -------------------------------
  2760     05  FILLER            PIC  X(0003).
  2761     05  CLMSTATO PIC  X(0006).
  2762*    -------------------------------
  2763     05  FILLER            PIC  X(0003).
  2764     05  LSTNMEO PIC  X(0015).
  2765*    -------------------------------
  2766     05  FILLER            PIC  X(0003).
  2767     05  FSTNMEO PIC  X(0012).
  2768*    -------------------------------
  2769     05  FILLER            PIC  X(0003).
  2770     05  MINITO PIC  X(0001).
  2771*    -------------------------------
  2772     05  FILLER            PIC  X(0003).
  2773     05  PRIMHDGO PIC  X(0012).
  2774*    -------------------------------
  2775     05  FILLER            PIC  X(0003).
  2776     05  PRIMCRTO PIC  X(0010).
  2777*    -------------------------------
  2778     05  FILLER            PIC  X(0003).
  2779     05  PRIMSFXO PIC  X(0001).
  2780*    -------------------------------
  2781     05  FILLER            PIC  X(0003).
  2782     05  NOTIFYO PIC  X(0013).
  2783*    -------------------------------
  2784     05  FILLER            PIC  X(0003).
  2785     05  CLMTOTHO PIC  X(0027).
  2786*    -------------------------------
  2787     05  FILLER            PIC  X(0003).
  2788     05  AMTPDO PIC  X(0011).
  2789*    -------------------------------
  2790     05  FILLER            PIC  X(0003).
  2791     05  DAYSPDHO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL150.cbl
  2792*    -------------------------------
  2793     05  FILLER            PIC  X(0003).
  2794     05  DAYSPDO PIC  X(0005).
  2795*    -------------------------------
  2796     05  FILLER            PIC  X(0003).
  2797     05  YESNOSWO PIC  X(0001).
  2798*    -------------------------------
  2799     05  FILLER            PIC  X(0003).
  2800     05  PDTHRHDO PIC  X(0014).
  2801*    -------------------------------
  2802     05  FILLER            PIC  X(0003).
  2803     05  PDTHRUO PIC  X(0008).
  2804*    -------------------------------
  2805     05  FILLER            PIC  X(0003).
  2806     05  TOTPAIDO PIC  Z(6).99-.
  2807*    -------------------------------
  2808     05  FILLER            PIC  X(0003).
  2809     05  COVERDO PIC  X(0012).
  2810*    -------------------------------
  2811     05  FILLER            PIC  X(0003).
  2812     05  COVERO PIC  X(0010).
  2813*    -------------------------------
  2814     05  FILLER            PIC  X(0003).
  2815     05  INCURO PIC  X(0008).
  2816*    -------------------------------
  2817     05  FILLER            PIC  X(0003).
  2818     05  NOPMTSO PIC  X(0007).
  2819*    -------------------------------
  2820     05  FILLER            PIC  X(0003).
  2821     05  PRMTYPDO PIC  X(0012).
  2822*    -------------------------------
  2823     05  FILLER            PIC  X(0003).
  2824     05  PRMTYPEO PIC  X(0008).
  2825*    -------------------------------
  2826     05  FILLER            PIC  X(0003).
  2827     05  NXTAUTOO PIC  X(0008).
  2828*    -------------------------------
  2829     05  FILLER            PIC  X(0003).
  2830     05  ESTABDTO PIC  X(0008).
  2831*    -------------------------------
  2832     05  FILLER            PIC  X(0003).
  2833     05  CRTSTADO PIC  X(0012).
  2834*    -------------------------------
  2835     05  FILLER            PIC  X(0003).
  2836     05  CRTSTATO PIC  X(0010).
  2837*    -------------------------------
  2838     05  FILLER            PIC  X(0003).
  2839     05  EFFECTO PIC  X(0008).
  2840*    -------------------------------
  2841     05  FILLER            PIC  X(0003).
  2842     05  TOTINTO PIC  Z(6).99-.
  2843*    -------------------------------
  2844     05  FILLER            PIC  X(0003).
  2845     05  STATEO PIC  X(0003).
  2846*    -------------------------------
  2847     05  FILLER            PIC  X(0003).
  2848     05  ACCTO PIC  X(0010).
  2849*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL150.cbl
  2850     05  FILLER            PIC  X(0003).
  2851     05  EXPIREO PIC  X(0008).
  2852*    -------------------------------
  2853     05  FILLER            PIC  X(0003).
  2854     05  BENECAPO PIC  X(0013).
  2855*    -------------------------------
  2856     05  FILLER            PIC  X(0003).
  2857     05  BENEO PIC  Z(6).99.
  2858*    -------------------------------
  2859     05  FILLER            PIC  X(0003).
  2860     05  TERMSO PIC  X(0013).
  2861*    -------------------------------
  2862     05  FILLER            PIC  X(0003).
  2863     05  DIAGO PIC  X(0056).
  2864*    -------------------------------
  2865     05  FILLER            PIC  X(0003).
  2866     05  FILETOO PIC  X(0004).
  2867*    -------------------------------
  2868     05  FILLER            PIC  X(0003).
  2869     05  PRTOPTO PIC  X(0001).
  2870*    -------------------------------
  2871     05  FILLER            PIC  X(0003).
  2872     05  FORMATO PIC  X(0001).
  2873*    -------------------------------
  2874     05  FILLER            PIC  X(0003).
  2875     05  ALTPRTO PIC  X(0004).
  2876*    -------------------------------
  2877     05  FILLER            PIC  X(0003).
  2878     05  CLOANO PIC  X(0025).
  2879*    -------------------------------
  2880     05  FILLER            PIC  X(0003).
  2881     05  DENTYPO PIC  X(0029).
  2882*    -------------------------------
  2883     05  FILLER            PIC  X(0003).
  2884     05  ACTCDO PIC  X(0002).
  2885*    -------------------------------
  2886     05  FILLER            PIC  X(0003).
  2887     05  ACTDTO PIC  X(0008).
  2888*    -------------------------------
  2889     05  FILLER            PIC  X(0003).
  2890     05  ACTTYPO PIC  X(0004).
  2891*    -------------------------------
  2892     05  FILLER            PIC  X(0003).
  2893     05  ASSHDGO PIC  X(0006).
  2894*    -------------------------------
  2895     05  FILLER            PIC  X(0003).
  2896     05  ASSOCO PIC  X(0001).
  2897*    -------------------------------
  2898     05  FILLER            PIC  X(0003).
  2899     05  TRLR1O PIC  X(0079).
  2900*    -------------------------------
  2901     05  FILLER            PIC  X(0003).
  2902     05  TRLR2O PIC  X(0079).
  2903*    -------------------------------
  2904     05  FILLER            PIC  X(0003).
  2905     05  TRLR3O PIC  X(0079).
  2906*    -------------------------------
  2907     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL150.cbl
  2908     05  TRLR4O PIC  X(0079).
  2909*    -------------------------------
  2910     05  FILLER            PIC  X(0003).
  2911     05  ERRMSG1O PIC  X(0079).
  2912*    -------------------------------
  2913     05  FILLER            PIC  X(0003).
  2914     05  ENTERPFO PIC  X(0002).
  2915*    -------------------------------
  2916     05  FILLER            PIC  X(0003).
  2917     05  PFKEY11O PIC  X(0017).
  2918*    -------------------------------
  2919 01  EL150AI-R REDEFINES EL150AI.
  2920*    12  FILLER              PIC X(665).
  2921*    12  FILLER              PIC X(706).
  2922     12  FILLER              PIC X(738).
  2923     12  EL150AI-OCCURS         OCCURS 4 TIMES.
  2924         16  FILLER          PIC X(3).
  2925         16  MAP-DISPLAY     PIC X(79).
  2926     12  FILLER              PIC X(40).
  2927
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL150.cbl
  2929****************************************************************
  2930*
  2931* Copyright (c) 2007 by Clerity Solutions, Inc.
  2932* All rights reserved.
  2933*
  2934****************************************************************
  2935 01  DFHEIV.
  2936   02  DFHEIV0               PIC X(35).
  2937   02  DFHEIV1               PIC X(08).
  2938   02  DFHEIV2               PIC X(08).
  2939   02  DFHEIV3               PIC X(08).
  2940   02  DFHEIV4               PIC X(06).
  2941   02  DFHEIV5               PIC X(04).
  2942   02  DFHEIV6               PIC X(04).
  2943   02  DFHEIV7               PIC X(02).
  2944   02  DFHEIV8               PIC X(02).
  2945   02  DFHEIV9               PIC X(01).
  2946   02  DFHEIV10              PIC S9(7) COMP-3.
  2947   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2948   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2949   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2950   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2951   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2952   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2953   02  DFHEIV17              PIC X(04).
  2954   02  DFHEIV18              PIC X(04).
  2955   02  DFHEIV19              PIC X(04).
  2956   02  DFHEIV20              USAGE IS POINTER.
  2957   02  DFHEIV21              USAGE IS POINTER.
  2958   02  DFHEIV22              USAGE IS POINTER.
  2959   02  DFHEIV23              USAGE IS POINTER.
  2960   02  DFHEIV24              USAGE IS POINTER.
  2961   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2962   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2963   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2964   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2965   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2966   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2967   02  FILLER                PIC X(02).
  2968   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2969   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2970   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2971   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2972   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2973 LINKAGE  SECTION.
  2974*****************************************************************
  2975*                                                               *
  2976* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2977* All rights reserved.                                          *
  2978*                                                               *
  2979*****************************************************************
  2980 01  dfheiblk.
  2981     02  eibtime          pic s9(7) comp-3.
  2982     02  eibdate          pic s9(7) comp-3.
  2983     02  eibtrnid         pic x(4).
  2984     02  eibtaskn         pic s9(7) comp-3.
  2985     02  eibtrmid         pic x(4).
  2986     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL150.cbl
  2987     02  eibcposn         pic s9(4) comp.
  2988     02  eibcalen         pic s9(4) comp.
  2989     02  eibaid           pic x(1).
  2990     02  eibfiller1       pic x(1).
  2991     02  eibfn            pic x(2).
  2992     02  eibfiller2       pic x(2).
  2993     02  eibrcode         pic x(6).
  2994     02  eibfiller3       pic x(2).
  2995     02  eibds            pic x(8).
  2996     02  eibreqid         pic x(8).
  2997     02  eibrsrce         pic x(8).
  2998     02  eibsync          pic x(1).
  2999     02  eibfree          pic x(1).
  3000     02  eibrecv          pic x(1).
  3001     02  eibsend          pic x(1).
  3002     02  eibatt           pic x(1).
  3003     02  eibeoc           pic x(1).
  3004     02  eibfmh           pic x(1).
  3005     02  eibcompl         pic x(1).
  3006     02  eibsig           pic x(1).
  3007     02  eibconf          pic x(1).
  3008     02  eiberr           pic x(1).
  3009     02  eibrldbk         pic x(1).
  3010     02  eiberrcd         pic x(4).
  3011     02  eibsynrb         pic x(1).
  3012     02  eibnodat         pic x(1).
  3013     02  eibfiller5       pic x(2).
  3014     02  eibresp          pic 9(09) comp.
  3015     02  eibresp2         pic 9(09) comp.
  3016     02  dfheigdj         pic s9(4) comp.
  3017     02  dfheigdk         pic s9(4) comp.
  3018 01  DFHCOMMAREA             PIC X(1024).
  3019
  3020 01  CLAIM-MASTER-L          PIC X(350).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL150.cbl
  3022*                            COPY ELCCNTL.
  3023******************************************************************
  3024*                                                                *
  3025*                                                                *
  3026*                            ELCCNTL.                            *
  3027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3028*                            VMOD=2.059                          *
  3029*                                                                *
  3030*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3031*                                                                *
  3032*   FILE TYPE = VSAM,KSDS                                        *
  3033*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3034*                                                                *
  3035*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3036*       ALTERNATE INDEX = NONE                                   *
  3037*                                                                *
  3038*   LOG = YES                                                    *
  3039*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3040******************************************************************
  3041*                   C H A N G E   L O G
  3042*
  3043* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3044*-----------------------------------------------------------------
  3045*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3046* EFFECTIVE    NUMBER
  3047*-----------------------------------------------------------------
  3048* 082503                   PEMA  ADD BENEFIT GROUP
  3049* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3050* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3051* 092705    2005050300006  PEMA  ADD SPP LEASES
  3052* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3053* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3054* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3055* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3056* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3057******************************************************************
  3058*
  3059 01  CONTROL-FILE.
  3060     12  CF-RECORD-ID                       PIC XX.
  3061         88  VALID-CF-ID                        VALUE 'CF'.
  3062
  3063     12  CF-CONTROL-PRIMARY.
  3064         16  CF-COMPANY-ID                  PIC XXX.
  3065         16  CF-RECORD-TYPE                 PIC X.
  3066             88  CF-COMPANY-MASTER              VALUE '1'.
  3067             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3068             88  CF-STATE-MASTER                VALUE '3'.
  3069             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3070             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3071             88  CF-CARRIER-MASTER              VALUE '6'.
  3072             88  CF-MORTALITY-MASTER            VALUE '7'.
  3073             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3074             88  CF-TERMINAL-MASTER             VALUE '9'.
  3075             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3076             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3077             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3078             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3079             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL150.cbl
  3080             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3081             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3082             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3083             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3084         16  CF-ACCESS-CD-GENL              PIC X(4).
  3085         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3086             20  CF-PROCESSOR               PIC X(4).
  3087         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3088             20  CF-STATE-CODE              PIC XX.
  3089             20  FILLER                     PIC XX.
  3090         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3091             20  FILLER                     PIC XX.
  3092             20  CF-HI-BEN-IN-REC           PIC XX.
  3093         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3094             20  FILLER                     PIC XXX.
  3095             20  CF-CARRIER-CNTL            PIC X.
  3096         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3097             20  FILLER                     PIC XX.
  3098             20  CF-HI-TYPE-IN-REC          PIC 99.
  3099         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3100             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3101                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3102             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3103             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3104         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3105             20  FILLER                     PIC X.
  3106             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3107         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3108             20  FILLER                     PIC XX.
  3109             20  CF-MORTGAGE-PLAN           PIC XX.
  3110         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3111
  3112     12  CF-LAST-MAINT-DT                   PIC XX.
  3113     12  CF-LAST-MAINT-BY                   PIC X(4).
  3114     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3115
  3116     12  CF-RECORD-BODY                     PIC X(728).
  3117
  3118
  3119****************************************************************
  3120*             COMPANY MASTER RECORD                            *
  3121****************************************************************
  3122
  3123     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3124         16  CF-COMPANY-ADDRESS.
  3125             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3126             20  CF-CL-IN-CARE-OF           PIC X(30).
  3127             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3128             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3129             20  CF-CL-CITY-STATE           PIC X(30).
  3130             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3131             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3132         16  CF-COMPANY-CD                  PIC X.
  3133         16  CF-COMPANY-PASSWORD            PIC X(8).
  3134         16  CF-SECURITY-OPTION             PIC X.
  3135             88  ALL-SECURITY                   VALUE '1'.
  3136             88  COMPANY-VERIFY                 VALUE '2'.
  3137             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL150.cbl
  3138             88  NO-SECURITY                    VALUE '4'.
  3139             88  ALL-BUT-TERM                   VALUE '5'.
  3140         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3141             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3142         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3143             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3144         16  CF-INFORCE-LOCATION            PIC X.
  3145             88  CERTS-ARE-ONLINE               VALUE '1'.
  3146             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3147             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3148         16  CF-LOWER-CASE-LETTERS          PIC X.
  3149         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3150             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3151             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3152             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3153             88  CF-ACCNT-CNTL                  VALUE '3'.
  3154             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3155
  3156         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3157         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3158
  3159         16  CF-LGX-CREDIT-USER             PIC X.
  3160             88  CO-IS-NOT-USER                 VALUE 'N'.
  3161             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3162
  3163         16 CF-CREDIT-CALC-CODES.
  3164             20  CF-CR-REM-TERM-CALC PIC X.
  3165               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3166               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3167               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3168               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3169               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3170               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3171               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3172             20  CF-CR-R78-METHOD           PIC X.
  3173               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3174               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3175
  3176         16  CF-CLAIM-CONTROL-COUNTS.
  3177             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3178                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3179
  3180             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3181                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3182
  3183             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3184                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3185
  3186             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3187                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3188
  3189         16  CF-CURRENT-MONTH-END           PIC XX.
  3190
  3191         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3192             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3193             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3194             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3195             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL150.cbl
  3196                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3197                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3198             20  CF-CO-PREM-REJECT-SW       PIC X.
  3199                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3200                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3201             20  CF-CO-REF-REJECT-SW        PIC X.
  3202                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3203                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3204
  3205         16  CF-CO-REPORTING-DT             PIC XX.
  3206         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3207         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3208           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3209           88  CF-CO-MONTH-END                  VALUE '1'.
  3210
  3211         16  CF-LGX-CLAIM-USER              PIC X.
  3212             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3213             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3214
  3215         16  CF-CREDIT-EDIT-CONTROLS.
  3216             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3217             20  CF-MIN-AGE                 PIC 99.
  3218             20  CF-DEFAULT-AGE             PIC 99.
  3219             20  CF-MIN-TERM                PIC S999      COMP-3.
  3220             20  CF-MAX-TERM                PIC S999      COMP-3.
  3221             20  CF-DEFAULT-SEX             PIC X.
  3222             20  CF-JOINT-AGE-INPUT         PIC X.
  3223                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3224             20  CF-BIRTH-DATE-INPUT        PIC X.
  3225                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3226             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3227                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3228                 88  CF-ZERO-CARRIER            VALUE '1'.
  3229                 88  CF-ZERO-GROUPING           VALUE '2'.
  3230                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3231             20  CF-EDIT-SW                 PIC X.
  3232                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3233             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3234             20  CF-CR-PR-METHOD            PIC X.
  3235               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3236               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3237             20  FILLER                     PIC X.
  3238
  3239         16  CF-CREDIT-MISC-CONTROLS.
  3240             20  CF-REIN-TABLE-SW           PIC X.
  3241                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3242             20  CF-COMP-TABLE-SW           PIC X.
  3243                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3244             20  CF-EXPERIENCE-RETENTION-AGE
  3245                                            PIC S9        COMP-3.
  3246             20  CF-CONVERSION-DT           PIC XX.
  3247             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3248             20  CF-RUN-FREQUENCY-SW        PIC X.
  3249                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3250                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3251
  3252             20  CF-CR-CHECK-NO-CONTROL.
  3253                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL150.cbl
  3254                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3255                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3256                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3257                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3258                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3259
  3260                 24  CF-CR-CHECK-COUNT       REDEFINES
  3261                     CF-CR-CHECK-COUNTER      PIC X(4).
  3262
  3263                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3264                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3265
  3266                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3267                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3268                 24  CF-MAIL-PROCESSING       PIC X.
  3269                     88  MAIL-PROCESSING          VALUE 'Y'.
  3270
  3271         16  CF-MISC-SYSTEM-CONTROL.
  3272             20  CF-SYSTEM-C                 PIC X.
  3273                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3274             20  CF-SYSTEM-D                 PIC X.
  3275                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3276             20  CF-SOC-SEC-NO-SW            PIC X.
  3277                 88  SOC-SEC-NO-USED             VALUE '1'.
  3278             20  CF-MEMBER-NO-SW             PIC X.
  3279                 88  MEMBER-NO-USED              VALUE '1'.
  3280             20  CF-TAX-ID-NUMBER            PIC X(11).
  3281             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3282             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3283                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3284                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3285                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3286                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3287             20  CF-SYSTEM-E                 PIC X.
  3288                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3289
  3290         16  CF-LGX-LIFE-USER               PIC X.
  3291             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3292             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3293
  3294         16  CF-CR-MONTH-END-DT             PIC XX.
  3295
  3296         16  CF-FILE-MAINT-DATES.
  3297             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3298                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3299             20  CF-LAST-BATCH       REDEFINES
  3300                 CF-LAST-BATCH-NO               PIC X(4).
  3301             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3302             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3303             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3304             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3305             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3306             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3307             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3308             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3309             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3310             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3311
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL150.cbl
  3312         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3313         16  FILLER                         PIC X.
  3314
  3315         16  CF-ALT-MORT-CODE               PIC X(4).
  3316         16  CF-MEMBER-CAPTION              PIC X(10).
  3317
  3318         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3319             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3320             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3321             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3322             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3323             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3324
  3325         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3326
  3327         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3328         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3329         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3330         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3331
  3332         16  CF-AH-OVERRIDE-L1              PIC X.
  3333         16  CF-AH-OVERRIDE-L2              PIC XX.
  3334         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3335         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3336
  3337         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3338         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3339
  3340         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3341         16  CF-AR-LAST-EL860-DT            PIC XX.
  3342         16  CF-MP-MONTH-END-DT             PIC XX.
  3343
  3344         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3345         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3346             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3347
  3348         16  CF-AR-MONTH-END-DT             PIC XX.
  3349
  3350         16  CF-CRDTCRD-USER                PIC X.
  3351             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3352             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3353
  3354         16  CF-CC-MONTH-END-DT             PIC XX.
  3355
  3356         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3357
  3358         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3359             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3360             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3361             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3362         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3363         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3364         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3365         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3366             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3367             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3368         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3369         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL150.cbl
  3370         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3371             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3372         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3373
  3374         16  CF-CL-ZIP-CODE.
  3375             20  CF-CL-ZIP-PRIME.
  3376                 24  CF-CL-ZIP-1ST          PIC X.
  3377                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3378                 24  FILLER                 PIC X(4).
  3379             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3380         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3381             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3382             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3383             20  FILLER                     PIC XXX.
  3384
  3385         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3386         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3387         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3388         16  CF-CO-OPTION-START-DATE        PIC XX.
  3389         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3390           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3391                                                      '3' '4'.
  3392           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3393           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3394           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3395           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3396           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3397           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3398
  3399         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3400
  3401         16  CF-PAYMENT-APPROVAL-LEVELS.
  3402             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3403             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3404             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3405             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3406             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3407             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3408
  3409         16  CF-END-USER-REPORTING-USER     PIC X.
  3410             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3411             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3412
  3413         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3414             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3415             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3416
  3417         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3418
  3419         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3420         16  FILLER                         PIC X.
  3421
  3422         16  CF-CREDIT-ARCHIVE-CNTL.
  3423             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3424             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3425             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3426
  3427         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL150.cbl
  3428
  3429         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3430             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3431             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3432
  3433         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3434             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3435             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3436
  3437         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3438
  3439         16  CF-CO-ACH-ID-CODE              PIC  X.
  3440             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3441             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3442             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3443         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3444         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3445         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3446         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3447         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3448         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3449         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3450         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3451         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3452                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3453         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3454                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3455
  3456         16  CF-CO-OVER-SHORT.
  3457             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3458             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3459
  3460*         16  FILLER                         PIC X(102).
  3461         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3462             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3463             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3464
  3465         16  CF-AH-APPROVAL-DAYS.
  3466             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3467             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3468             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3469             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3470
  3471         16  FILLER                         PIC X(82).
  3472****************************************************************
  3473*             PROCESSOR/USER RECORD                            *
  3474****************************************************************
  3475
  3476     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3477         16  CF-PROCESSOR-NAME              PIC X(30).
  3478         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3479         16  CF-PROCESSOR-TITLE             PIC X(26).
  3480         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3481                 88  MESSAGE-YES                VALUE 'Y'.
  3482                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3483
  3484*****************************************************
  3485****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL150.cbl
  3486****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3487****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3488****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3489*****************************************************
  3490
  3491         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3492             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3493             20  CF-APPLICATION-FORCE       PIC X.
  3494             20  CF-INDIVIDUAL-APP.
  3495                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3496                     28  CF-BROWSE-APP      PIC X.
  3497                     28  CF-UPDATE-APP      PIC X.
  3498
  3499         16  CF-CURRENT-TERM-ON             PIC X(4).
  3500         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3501             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3502             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3503             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3504             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3505             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3506             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3507             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3508         16  CF-PROCESSOR-CARRIER           PIC X.
  3509             88  NO-CARRIER-SECURITY            VALUE ' '.
  3510         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3511             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3512         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3513             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3514         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3515             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3516
  3517         16  CF-PROC-SYS-ACCESS-SW.
  3518             20  CF-PROC-CREDIT-CLAIMS-SW.
  3519                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3520                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3521                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3522                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3523             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3524                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3525                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3526             20  CF-PROC-LIFE-GNRLDGR-SW.
  3527                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3528                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3529                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3530                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3531             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3532                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3533                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3534         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3535             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3536             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3537         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3538
  3539         16  CF-APPROVAL-LEVEL                  PIC X.
  3540             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3541             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3542             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3543             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL150.cbl
  3544
  3545         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3546
  3547         16  CF-LANGUAGE-TYPE                   PIC X.
  3548             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3549             88  CF-LANG-IS-FR                      VALUE 'F'.
  3550         16  FILLER                             PIC  X(240).
  3551
  3552****************************************************************
  3553*             PROCESSOR/REMINDERS RECORD                       *
  3554****************************************************************
  3555
  3556     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3557         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3558             20  CF-START-REMIND-DT         PIC XX.
  3559             20  CF-END-REMIND-DT           PIC XX.
  3560             20  CF-REMINDER-TEXT           PIC X(50).
  3561         16  FILLER                         PIC X(296).
  3562
  3563
  3564****************************************************************
  3565*             STATE MASTER RECORD                              *
  3566****************************************************************
  3567
  3568     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3569         16  CF-STATE-ABBREVIATION          PIC XX.
  3570         16  CF-STATE-NAME                  PIC X(25).
  3571         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3572         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3573             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3574             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3575             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3576             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3577                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3578                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3579             20  CF-ST-PREM-REJECT-SW       PIC X.
  3580                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3581                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3582             20  CF-ST-REF-REJECT-SW        PIC X.
  3583                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3584                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3585         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3586         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3587         16  CF-ST-REFUND-RULES.
  3588             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3589             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3590             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3591         16  CF-ST-FST-PMT-EXTENSION.
  3592             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3593             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3594                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3595                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3596                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3597                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3598         16  CF-ST-STATE-CALL.
  3599             20  CF-ST-CALL-UNEARNED        PIC X.
  3600             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3601             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL150.cbl
  3602         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3603             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3604             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3605         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3606         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3607         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3608         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3609         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3610         16  FILLER                         PIC X.
  3611         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3612             20  CF-ST-BENEFIT-CD           PIC XX.
  3613             20  CF-ST-BENEFIT-KIND         PIC X.
  3614                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3615                 88  CF-ST-AH-KIND              VALUE 'A'.
  3616             20  CF-ST-REM-TERM-CALC        PIC X.
  3617                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3618                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3619                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3620                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3621                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3622                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3623                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3624                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3625
  3626             20  CF-ST-REFUND-CALC          PIC X.
  3627                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3628                 88  ST-REFD-BY-R78             VALUE '1'.
  3629                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3630                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3631                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3632                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3633                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3634                 88  ST-REFD-UTAH               VALUE '7'.
  3635                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3636                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3637                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3638
  3639             20  CF-ST-EARNING-CALC         PIC X.
  3640                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3641                 88  ST-EARN-BY-R78             VALUE '1'.
  3642                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3643                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3644                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3645                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3646                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3647                 88  ST-EARN-MEAN               VALUE '8'.
  3648                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3649
  3650             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3651                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3652                 88  ST-OVRD-BY-R78             VALUE '1'.
  3653                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3654                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3655                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3656                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3657                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3658                 88  ST-OVRD-MEAN               VALUE '8'.
  3659                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL150.cbl
  3660             20  FILLER                     PIC X.
  3661
  3662         16  CF-ST-COMMISSION-CAPS.
  3663             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3664             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3665             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3666             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3667         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3668                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3669
  3670         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3671
  3672         16  CF-ST-STATUTORY-INTEREST.
  3673             20  CF-ST-STAT-DATE-FROM       PIC X.
  3674                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3675                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3676             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3677             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3678             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3679             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3680             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3681
  3682         16  CF-ST-OVER-SHORT.
  3683             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3684             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3685
  3686         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3687
  3688         16  CF-ST-RT-CALC                  PIC X.
  3689
  3690         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3691         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3692         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3693         16  CF-ST-RF-LR-CALC               PIC X.
  3694         16  CF-ST-RF-LL-CALC               PIC X.
  3695         16  CF-ST-RF-LN-CALC               PIC X.
  3696         16  CF-ST-RF-AH-CALC               PIC X.
  3697         16  CF-ST-RF-CP-CALC               PIC X.
  3698*        16  FILLER                         PIC X(206).
  3699*CIDMOD         16  FILLER                         PIC X(192).
  3700         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3701             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3702         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3703         16  CF-ST-VFY-2ND-BENE             PIC X.
  3704         16  FILLER                         PIC X(186).
  3705
  3706****************************************************************
  3707*             BENEFIT MASTER RECORD                            *
  3708****************************************************************
  3709
  3710     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3711         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3712             20  CF-BENEFIT-CODE            PIC XX.
  3713             20  CF-BENEFIT-NUMERIC  REDEFINES
  3714                 CF-BENEFIT-CODE            PIC XX.
  3715             20  CF-BENEFIT-ALPHA           PIC XXX.
  3716             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3717             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL150.cbl
  3718
  3719             20  CF-LF-COVERAGE-TYPE        PIC X.
  3720                 88  CF-REDUCING                VALUE 'R'.
  3721                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3722
  3723             20  CF-SPECIAL-CALC-CD         PIC X.
  3724                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3725                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3726                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3727                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3728                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3729                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3730                 88  CF-FARM-PLAN               VALUE 'F'.
  3731                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3732                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3733                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3734                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3735                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3736                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3737                 88  CF-PRUDENTIAL              VALUE 'P'.
  3738                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3739                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3740                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3741                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3742                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3743                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3744
  3745             20  CF-JOINT-INDICATOR         PIC X.
  3746                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3747
  3748*            20  FILLER                     PIC X(12).
  3749             20  FILLER                     PIC X(11).
  3750             20  CF-BENEFIT-CATEGORY        PIC X.
  3751             20  CF-LOAN-TYPE               PIC X(8).
  3752
  3753             20  CF-CO-REM-TERM-CALC        PIC X.
  3754                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3755                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3756                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3757                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3758                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3759
  3760             20  CF-CO-EARNINGS-CALC        PIC X.
  3761                 88  CO-EARN-BY-R78             VALUE '1'.
  3762                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3763                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3764                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3765                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3766                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3767                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3768                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3769
  3770             20  CF-CO-REFUND-CALC          PIC X.
  3771                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3772                 88  CO-REFD-BY-R78             VALUE '1'.
  3773                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3774                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3775                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL150.cbl
  3776                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3777                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3778                 88  CO-REFD-MEAN               VALUE '8'.
  3779                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3780                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3781                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3782
  3783             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3784                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3785                 88  CO-OVRD-BY-R78             VALUE '1'.
  3786                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3787                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3788                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3789                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3790                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3791                 88  CO-OVRD-MEAN               VALUE '8'.
  3792                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3793
  3794             20  CF-CO-BEN-I-G-CD           PIC X.
  3795                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3796                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3797                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3798
  3799         16  FILLER                         PIC X(304).
  3800
  3801
  3802****************************************************************
  3803*             CARRIER MASTER RECORD                            *
  3804****************************************************************
  3805
  3806     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3807         16  CF-ADDRESS-DATA.
  3808             20  CF-MAIL-TO-NAME            PIC X(30).
  3809             20  CF-IN-CARE-OF              PIC X(30).
  3810             20  CF-ADDRESS-LINE-1          PIC X(30).
  3811             20  CF-ADDRESS-LINE-2          PIC X(30).
  3812             20  CF-CITY-STATE              PIC X(30).
  3813             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3814             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3815
  3816         16  CF-CLAIM-NO-CONTROL.
  3817             20  CF-CLAIM-NO-METHOD         PIC X.
  3818                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3819                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3820                 88  CLAIM-NO-SEQ               VALUE '3'.
  3821                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3822             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3823                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3824                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3825                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3826
  3827         16  CF-CHECK-NO-CONTROL.
  3828             20  CF-CHECK-NO-METHOD         PIC X.
  3829                 88  CHECK-NO-MANUAL            VALUE '1'.
  3830                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3831                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3832                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3833             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL150.cbl
  3834                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3835
  3836         16  CF-DOMICILE-STATE              PIC XX.
  3837
  3838         16  CF-EXPENSE-CONTROLS.
  3839             20  CF-EXPENSE-METHOD          PIC X.
  3840                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3841                 88  DOLLARS-PER-PMT            VALUE '2'.
  3842                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3843                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3844             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3845             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3846
  3847         16  CF-CORRESPONDENCE-CONTROL.
  3848             20  CF-LETTER-RESEND-OPT       PIC X.
  3849                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3850                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3851             20  FILLER                     PIC X(4).
  3852
  3853         16  CF-RESERVE-CONTROLS.
  3854             20  CF-MANUAL-SW               PIC X.
  3855                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3856             20  CF-FUTURE-SW               PIC X.
  3857                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3858             20  CF-PTC-SW                  PIC X.
  3859                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3860             20  CF-IBNR-SW                 PIC X.
  3861                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3862             20  CF-PTC-LF-SW               PIC X.
  3863                 88  CF-LF-PTC-USED             VALUE '1'.
  3864             20  CF-CDT-ACCESS-METHOD       PIC X.
  3865                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3866                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3867                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3868             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3869
  3870         16  CF-CLAIM-CALC-METHOD           PIC X.
  3871             88  360-PLUS-MONTHS                VALUE '1'.
  3872             88  365-PLUS-MONTHS                VALUE '2'.
  3873             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3874             88  360-DAILY                      VALUE '4'.
  3875             88  365-DAILY                      VALUE '5'.
  3876
  3877         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3878         16  FILLER                         PIC X(11).
  3879
  3880         16  CF-LIMIT-AMOUNTS.
  3881             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3882             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3883             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3884             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3885             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3886             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3887             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3888             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3889             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3890             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3891
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL150.cbl
  3892         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3893         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3894         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3895
  3896         16  CF-ZIP-CODE.
  3897             20  CF-ZIP-PRIME.
  3898                 24  CF-ZIP-1ST             PIC X.
  3899                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3900                 24  FILLER                 PIC X(4).
  3901             20  CF-ZIP-PLUS4               PIC X(4).
  3902         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3903             20  CF-CAN-POSTAL-1            PIC XXX.
  3904             20  CF-CAN-POSTAL-2            PIC XXX.
  3905             20  FILLER                     PIC XXX.
  3906
  3907         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3908         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3909         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3910
  3911         16  CF-RATING-SWITCH               PIC X.
  3912             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3913             88  CF-NO-RATING                   VALUE 'N'.
  3914
  3915         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3916
  3917         16  CF-CARRIER-OVER-SHORT.
  3918             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3919             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3920
  3921         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3922         16  CF-SECPAY-SWITCH               PIC X.
  3923             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3924             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3925         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3926         16  FILLER                         PIC X(448).
  3927*        16  FILLER                         PIC X(452).
  3928
  3929
  3930****************************************************************
  3931*             MORTALITY MASTER RECORD                          *
  3932****************************************************************
  3933
  3934     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3935         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3936                                INDEXED BY CF-MORT-NDX.
  3937             20  CF-MORT-TABLE              PIC X(5).
  3938             20  CF-MORT-TABLE-TYPE         PIC X.
  3939                 88  CF-MORT-JOINT              VALUE 'J'.
  3940                 88  CF-MORT-SINGLE             VALUE 'S'.
  3941                 88  CF-MORT-COMBINED           VALUE 'C'.
  3942                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3943                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3944             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3945             20  CF-MORT-AGE-METHOD         PIC XX.
  3946                 88  CF-AGE-LAST                VALUE 'AL'.
  3947                 88  CF-AGE-NEAR                VALUE 'AN'.
  3948             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3949             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL150.cbl
  3950                                            PIC X.
  3951                 88  CF-MINUS                   VALUE '-'.
  3952                 88  CF-PLUS                    VALUE '+'.
  3953             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3954             20  CF-MORT-JOINT-CODE         PIC X.
  3955                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3956             20  CF-MORT-PC-Q               PIC X.
  3957                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3958             20  CF-MORT-TABLE-CODE         PIC X(4).
  3959             20  CF-MORT-COMMENTS           PIC X(15).
  3960             20  FILLER                     PIC X(14).
  3961
  3962         16  FILLER                         PIC X(251).
  3963
  3964
  3965****************************************************************
  3966*             BUSSINESS TYPE MASTER RECORD                     *
  3967****************************************************************
  3968
  3969     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3970* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3971* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3972* AND RECORD 05 IS TYPES 81-99
  3973         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3974             20  CF-BUSINESS-TITLE          PIC  X(19).
  3975             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3976                                            PIC S9V9(4) COMP-3.
  3977             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3978             20  FILLER                     PIC  X.
  3979         16  FILLER                         PIC  X(248).
  3980
  3981
  3982****************************************************************
  3983*             TERMINAL MASTER RECORD                           *
  3984****************************************************************
  3985
  3986     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3987
  3988         16  CF-COMPANY-TERMINALS.
  3989             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3990                                  PIC X(4).
  3991         16  FILLER               PIC X(248).
  3992
  3993
  3994****************************************************************
  3995*             LIFE EDIT MASTER RECORD                          *
  3996****************************************************************
  3997
  3998     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3999         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4000             20  CF-LIFE-CODE-IN            PIC XX.
  4001             20  CF-LIFE-CODE-OUT           PIC XX.
  4002         16  FILLER                         PIC X(248).
  4003
  4004
  4005****************************************************************
  4006*             AH EDIT MASTER RECORD                            *
  4007****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL150.cbl
  4008
  4009     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4010         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4011             20  CF-AH-CODE-IN              PIC XXX.
  4012             20  CF-AH-CODE-OUT             PIC XX.
  4013         16  FILLER                         PIC X(248).
  4014
  4015
  4016****************************************************************
  4017*             CREDIBILITY TABLES                               *
  4018****************************************************************
  4019
  4020     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4021         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4022                             INDEXED BY CF-CRDB-NDX.
  4023             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4024             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4025             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4026         16  FILLER                         PIC  X(332).
  4027
  4028
  4029****************************************************************
  4030*             REPORT CUSTOMIZATION RECORD                      *
  4031****************************************************************
  4032
  4033     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4034         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4035             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4036             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4037             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4038**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4039****       A T-TRANSFER.                                   ****
  4040             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4041
  4042         16  FILLER                         PIC XX.
  4043
  4044         16  CF-CARRIER-CNTL-OPT.
  4045             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4046                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4047                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4048             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4049                                            PIC X.
  4050         16  CF-GROUP-CNTL-OPT.
  4051             20  CF-GROUP-OPT-SEQ           PIC 9.
  4052                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4053                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4054             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4055                                            PIC X(6).
  4056         16  CF-STATE-CNTL-OPT.
  4057             20  CF-STATE-OPT-SEQ           PIC 9.
  4058                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4059                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4060             20  CF-STATE-SELECT OCCURS 3 TIMES
  4061                                            PIC XX.
  4062         16  CF-ACCOUNT-CNTL-OPT.
  4063             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4064                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4065                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL150.cbl
  4066             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4067                                            PIC X(10).
  4068         16  CF-BUS-TYP-CNTL-OPT.
  4069             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4070                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4071                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4072             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4073                                            PIC XX.
  4074         16  CF-LF-TYP-CNTL-OPT.
  4075             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4076                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4077                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4078             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4079                                            PIC XX.
  4080         16  CF-AH-TYP-CNTL-OPT.
  4081             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4082                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4083                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4084             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4085                                            PIC XX.
  4086         16  CF-REPTCD1-CNTL-OPT.
  4087             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4088                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4089                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4090             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4091                                            PIC X(10).
  4092         16  CF-REPTCD2-CNTL-OPT.
  4093             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4094                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4095                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4096             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4097                                            PIC X(10).
  4098         16  CF-USER1-CNTL-OPT.
  4099             20  CF-USER1-OPT-SEQ           PIC 9.
  4100                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4101                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4102             20  CF-USER1-SELECT OCCURS 3 TIMES
  4103                                            PIC X(10).
  4104         16  CF-USER2-CNTL-OPT.
  4105             20  CF-USER2-OPT-SEQ           PIC 9.
  4106                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4107                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4108             20  CF-USER2-SELECT OCCURS 3 TIMES
  4109                                            PIC X(10).
  4110         16  CF-USER3-CNTL-OPT.
  4111             20  CF-USER3-OPT-SEQ           PIC 9.
  4112                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4113                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4114             20  CF-USER3-SELECT OCCURS 3 TIMES
  4115                                            PIC X(10).
  4116         16  CF-USER4-CNTL-OPT.
  4117             20  CF-USER4-OPT-SEQ           PIC 9.
  4118                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4119                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4120             20  CF-USER4-SELECT OCCURS 3 TIMES
  4121                                            PIC X(10).
  4122         16  CF-USER5-CNTL-OPT.
  4123             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL150.cbl
  4124                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4125                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4126             20  CF-USER5-SELECT OCCURS 3 TIMES
  4127                                            PIC X(10).
  4128         16  CF-REINS-CNTL-OPT.
  4129             20  CF-REINS-OPT-SEQ           PIC 9.
  4130                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4131                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4132             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4133                 24  CF-REINS-PRIME         PIC XXX.
  4134                 24  CF-REINS-SUB           PIC XXX.
  4135
  4136         16  CF-AGENT-CNTL-OPT.
  4137             20  CF-AGENT-OPT-SEQ           PIC 9.
  4138                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4139                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4140             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4141                                            PIC X(10).
  4142
  4143         16  FILLER                         PIC X(43).
  4144
  4145         16  CF-LOSS-RATIO-SELECT.
  4146             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4147             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4148         16  CF-ENTRY-DATE-SELECT.
  4149             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4150             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4151         16  CF-EFFECTIVE-DATE-SELECT.
  4152             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4153             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4154
  4155         16  CF-EXCEPTION-LIST-IND          PIC X.
  4156             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4157
  4158         16  FILLER                         PIC X(318).
  4159
  4160****************************************************************
  4161*                  EXCEPTION REPORTING RECORD                  *
  4162****************************************************************
  4163
  4164     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4165         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4166             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4167
  4168         16  CF-COMBINED-LIFE-AH-OPT.
  4169             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4170             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4171             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4172             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4173
  4174         16  CF-LIFE-OPT.
  4175             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4176             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4177             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4178             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4179             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4180             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4181             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL150.cbl
  4182             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4183             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4184             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4185
  4186         16  CF-AH-OPT.
  4187             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4188             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4189             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4190             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4191             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4192             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4193             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4194             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4195             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4196             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4197
  4198         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4199             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4200             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4201             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4202
  4203         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4204
  4205         16  FILLER                         PIC X(673).
  4206
  4207
  4208****************************************************************
  4209*             MORTGAGE SYSTEM PLAN RECORD                      *
  4210****************************************************************
  4211
  4212     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4213         16  CF-PLAN-TYPE                   PIC X.
  4214             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4215             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4216             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4217         16  CF-PLAN-ABBREV                 PIC XXX.
  4218         16  CF-PLAN-DESCRIPT               PIC X(10).
  4219         16  CF-PLAN-NOTES                  PIC X(20).
  4220         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4221         16  CF-PLAN-UNDERWRITING.
  4222             20  CF-PLAN-TERM-DATA.
  4223                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4224                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4225             20  CF-PLAN-AGE-DATA.
  4226                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4227                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4228                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4229             20  CF-PLAN-BENEFIT-DATA.
  4230                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4231                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4232                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4233                                            PIC S9(7)V99  COMP-3.
  4234         16  CF-PLAN-POLICY-FORMS.
  4235             20  CF-POLICY-FORM             PIC X(12).
  4236             20  CF-MASTER-APPLICATION      PIC X(12).
  4237             20  CF-MASTER-POLICY           PIC X(12).
  4238         16  CF-PLAN-RATING.
  4239             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL150.cbl
  4240             20  CF-SEX-RATING              PIC X.
  4241                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4242                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4243             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4244             20  CF-SUB-STD-TYPE            PIC X.
  4245                 88  CF-PCT-OF-PREM            VALUE '1'.
  4246                 88  CF-PCT-OF-BENE            VALUE '2'.
  4247         16  CF-PLAN-PREM-TOLERANCES.
  4248             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4249             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4250         16  CF-PLAN-PYMT-TOLERANCES.
  4251             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4252             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4253         16  CF-PLAN-MISC-DATA.
  4254             20  FILLER                     PIC X.
  4255             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4256             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4257         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4258         16  CF-PLAN-IND-GRP                PIC X.
  4259             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4260                                                     '1'.
  4261             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4262                                                     '2'.
  4263         16  CF-MIB-SEARCH-SW               PIC X.
  4264             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4265             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4266             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4267             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4268         16  CF-ALPHA-SEARCH-SW             PIC X.
  4269             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4270             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4271             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4272             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4273             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4274             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4275             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4276             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4277             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4278             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4279                                                     'A' 'B' 'C'
  4280                                                     'X' 'Y' 'Z'.
  4281         16  CF-EFF-DT-RULE-SW              PIC X.
  4282             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4283             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4284             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4285             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4286             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4287         16  FILLER                         PIC X(4).
  4288         16  CF-HEALTH-QUESTIONS            PIC X.
  4289             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4290         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4291         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4292         16  CF-PLAN-SNGL-JNT               PIC X.
  4293             88  CF-COMBINED-PLAN              VALUE 'C'.
  4294             88  CF-JNT-PLAN                   VALUE 'J'.
  4295             88  CF-SNGL-PLAN                  VALUE 'S'.
  4296         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4297         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL150.cbl
  4298         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4299         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4300         16  CF-RERATE-CNTL                 PIC  X.
  4301             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4302             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4303             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4304             88  CF-AUTO-RECALC                 VALUE '4'.
  4305         16  CF-BENEFIT-TYPE                PIC  X.
  4306             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4307             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4308         16  CF-POLICY-FEE                  PIC S999V99
  4309                                                    COMP-3.
  4310         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4311         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4312         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4313         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4314         16  FILLER                         PIC  X(32).
  4315         16  CF-TERMINATION-FORM            PIC  X(04).
  4316         16  FILLER                         PIC  X(08).
  4317         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4318                                                       COMP-3.
  4319         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4320         16  CF-ISSUE-LETTER                PIC  X(4).
  4321         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4322         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4323             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4324             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4325         16  CF-MP-REFUND-CALC              PIC X.
  4326             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4327             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4328             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4329             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4330             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4331             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4332             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4333             88  CF-MP-REFD-MEAN                VALUE '8'.
  4334         16  CF-ALT-RATE-CODE               PIC  X(5).
  4335
  4336
  4337         16  FILLER                         PIC X(498).
  4338****************************************************************
  4339*             MORTGAGE COMPANY MASTER RECORD                   *
  4340****************************************************************
  4341
  4342     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4343         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4344         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4345             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4346             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4347             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4348             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4349             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4350
  4351         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4352         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4353         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4354         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4355         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL150.cbl
  4356
  4357         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4358             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4359         16  CF-MP-RECON-USE-IND            PIC X(1).
  4360             88  CF-MP-USE-RECON             VALUE 'Y'.
  4361         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4362             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4363         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4364             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4365             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4366         16  FILLER                         PIC X(1).
  4367         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4368             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4369         16  CF-MORTG-MIB-VERSION           PIC X.
  4370             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4371             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4372             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4373         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4374             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4375                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4376             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4377                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4378             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4379                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4380             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4381                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4382             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4383                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4384             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4385                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4386         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4387         16  FILLER                         PIC X(7).
  4388         16  CF-MORTG-DESTINATION-SYMBOL.
  4389             20  CF-MORTG-MIB-COMM          PIC X(5).
  4390             20  CF-MORTG-MIB-TERM          PIC X(5).
  4391         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4392             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4393         16  FILLER                         PIC X(03).
  4394         16  CF-MP-CHECK-NO-CONTROL.
  4395             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4396                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4397                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4398                                                ' ' LOW-VALUES.
  4399                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4400                                               VALUE '3'.
  4401         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4402         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4403         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4404             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4405                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4406             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4407                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4408             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4409                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4410             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4411                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4412             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4413                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL150.cbl
  4414             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4415                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4416         16  CF-MORTG-BILLING-AREA.
  4417             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4418                                            PIC X.
  4419         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4420         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4421         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4422         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4423             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4424             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4425         16  FILLER                         PIC X.
  4426         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4427             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4428             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4429         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4430         16  FILLER                         PIC X(8).
  4431         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4432         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4433         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4434         16  CF-ACH-COMPANY-ID.
  4435             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4436                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4437                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4438                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4439             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4440         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4441             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4442         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4443             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4444             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4445         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4446         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4447         16  FILLER                         PIC X(536).
  4448
  4449****************************************************************
  4450*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4451****************************************************************
  4452
  4453     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4454         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4455             20  CF-FEMALE-HEIGHT.
  4456                 24  CF-FEMALE-FT           PIC 99.
  4457                 24  CF-FEMALE-IN           PIC 99.
  4458             20  CF-FEMALE-MIN-WT           PIC 999.
  4459             20  CF-FEMALE-MAX-WT           PIC 999.
  4460         16  FILLER                         PIC X(428).
  4461
  4462     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4463         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4464             20  CF-MALE-HEIGHT.
  4465                 24  CF-MALE-FT             PIC 99.
  4466                 24  CF-MALE-IN             PIC 99.
  4467             20  CF-MALE-MIN-WT             PIC 999.
  4468             20  CF-MALE-MAX-WT             PIC 999.
  4469         16  FILLER                         PIC X(428).
  4470******************************************************************
  4471*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL150.cbl
  4472******************************************************************
  4473     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4474         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4475             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4476             20  CF-SYS-LETTER-ID           PIC X(04).
  4477             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4478             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4479             20  CF-SYS-RESET-SW            PIC X(01).
  4480             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4481             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4482
  4483         16  FILLER                         PIC X(50).
  4484
  4485         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4486             20  CF-USER-ACTIVE-SW          PIC X(01).
  4487             20  CF-USER-LETTER-ID          PIC X(04).
  4488             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4489             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4490             20  CF-USER-RESET-SW           PIC X(01).
  4491             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4492             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4493             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4494
  4495         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL150.cbl
  4497*                            COPY ELCCERT.
  4498******************************************************************
  4499*                                                                *
  4500*                            ELCCERT.                            *
  4501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4502*                            VMOD=2.013                          *
  4503*                                                                *
  4504*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4505*                                                                *
  4506*   FILE TYPE = VSAM,KSDS                                        *
  4507*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4508*                                                                *
  4509*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4510*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4511*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4512*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4513*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4514*                                                                *
  4515*   LOG = YES                                                    *
  4516*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4517******************************************************************
  4518*                   C H A N G E   L O G
  4519*
  4520* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4521*-----------------------------------------------------------------
  4522*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4523* EFFECTIVE    NUMBER
  4524*-----------------------------------------------------------------
  4525* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4526* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4527* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4528* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4529* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4530* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4531* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4532* 032612  CR2011110200001  PEMA  AHL CHANGES
  4533******************************************************************
  4534
  4535 01  CERTIFICATE-MASTER.
  4536     12  CM-RECORD-ID                      PIC XX.
  4537         88  VALID-CM-ID                      VALUE 'CM'.
  4538
  4539     12  CM-CONTROL-PRIMARY.
  4540         16  CM-COMPANY-CD                 PIC X.
  4541         16  CM-CARRIER                    PIC X.
  4542         16  CM-GROUPING.
  4543             20  CM-GROUPING-PREFIX        PIC X(3).
  4544             20  CM-GROUPING-PRIME         PIC X(3).
  4545         16  CM-STATE                      PIC XX.
  4546         16  CM-ACCOUNT.
  4547             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4548             20  CM-ACCOUNT-PRIME          PIC X(6).
  4549         16  CM-CERT-EFF-DT                PIC XX.
  4550         16  CM-CERT-NO.
  4551             20  CM-CERT-PRIME             PIC X(10).
  4552             20  CM-CERT-SFX               PIC X.
  4553
  4554     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL150.cbl
  4555         16  CM-COMPANY-CD-A1              PIC X.
  4556         16  CM-INSURED-LAST-NAME          PIC X(15).
  4557         16  CM-INSURED-INITIALS.
  4558             20  CM-INSURED-INITIAL1       PIC X.
  4559             20  CM-INSURED-INITIAL2       PIC X.
  4560
  4561     12  CM-CONTROL-BY-SSN.
  4562         16  CM-COMPANY-CD-A2              PIC X.
  4563         16  CM-SOC-SEC-NO.
  4564             20  CM-SSN-STATE              PIC XX.
  4565             20  CM-SSN-ACCOUNT            PIC X(6).
  4566             20  CM-SSN-LN3.
  4567                 25  CM-INSURED-INITIALS-A2.
  4568                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4569                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4570                 25 CM-PART-LAST-NAME-A2         PIC X.
  4571
  4572     12  CM-CONTROL-BY-CERT-NO.
  4573         16  CM-COMPANY-CD-A4              PIC X.
  4574         16  CM-CERT-NO-A4                 PIC X(11).
  4575
  4576     12  CM-CONTROL-BY-MEMB.
  4577         16  CM-COMPANY-CD-A5              PIC X.
  4578         16  CM-MEMBER-NO.
  4579             20  CM-MEMB-STATE             PIC XX.
  4580             20  CM-MEMB-ACCOUNT           PIC X(6).
  4581             20  CM-MEMB-LN4.
  4582                 25  CM-INSURED-INITIALS-A5.
  4583                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4584                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4585                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4586
  4587     12  CM-INSURED-PROFILE-DATA.
  4588         16  CM-INSURED-FIRST-NAME.
  4589             20  CM-INSURED-1ST-INIT       PIC X.
  4590             20  FILLER                    PIC X(9).
  4591         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4592         16  CM-INSURED-SEX                PIC X.
  4593             88  CM-SEX-MALE                  VALUE 'M'.
  4594             88  CM-SEX-FEMAL                 VALUE 'F'.
  4595         16  CM-INSURED-JOINT-AGE          PIC 99.
  4596         16  CM-JOINT-INSURED-NAME.
  4597             20  CM-JT-LAST-NAME           PIC X(15).
  4598             20  CM-JT-FIRST-NAME.
  4599                 24  CM-JT-1ST-INIT        PIC X.
  4600                 24  FILLER                PIC X(9).
  4601             20  CM-JT-INITIAL             PIC X.
  4602
  4603     12  CM-LIFE-DATA.
  4604         16  CM-LF-BENEFIT-CD              PIC XX.
  4605         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4606         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4607         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4608         16  CM-LF-DEV-CODE                PIC XXX.
  4609         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4610         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4611         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4612         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL150.cbl
  4613         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4614         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4615         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4616         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4617         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4618         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4619         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4620         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4621         16  FILLER                        PIC XX.
  4622
  4623     12  CM-AH-DATA.
  4624         16  CM-AH-BENEFIT-CD              PIC XX.
  4625         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4626         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4627         16  CM-AH-DEV-CODE                PIC XXX.
  4628         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4629         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4630         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4631         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4632         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4633         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4634         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4635         16  CM-AH-PAID-THRU-DT            PIC XX.
  4636             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4637         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4638         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4639         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4640         16  FILLER                        PIC X.
  4641
  4642     12  CM-LOAN-INFORMATION.
  4643         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4644         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4645                                           PIC S9(5)V99  COMP-3.
  4646         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4647         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4648         16  CM-PAY-FREQUENCY              PIC S99.
  4649         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4650         16  CM-RATE-CLASS                 PIC XX.
  4651         16  CM-BENEFICIARY                PIC X(25).
  4652         16  CM-POLICY-FORM-NO             PIC X(12).
  4653         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4654         16  CM-LAST-ADD-ON-DT             PIC XX.
  4655         16  CM-DEDUCTIBLE-AMOUNTS.
  4656             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4657             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4658         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4659             20  CM-RESIDENT-STATE         PIC XX.
  4660             20  CM-RATE-CODE              PIC X(4).
  4661             20  FILLER                    PIC XX.
  4662         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4663             20  CM-LOAN-OFFICER           PIC X(5).
  4664             20  FILLER                    PIC XXX.
  4665         16  CM-CSR-CODE                   PIC XXX.
  4666         16  CM-UNDERWRITING-CODE          PIC X.
  4667             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4668         16  CM-POST-CARD-IND              PIC X.
  4669         16  CM-NH-INTERFACE-SW            PIC X.
  4670         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL150.cbl
  4671             88  CM-SING-PRM                  VALUE '1'.
  4672             88  CM-O-B-COVERAGE              VALUE '2'.
  4673             88  CM-OPEN-END                  VALUE '3'.
  4674         16  CM-IND-GRP-TYPE               PIC X.
  4675             88  CM-INDIVIDUAL                VALUE 'I'.
  4676             88  CM-GROUP                     VALUE 'G'.
  4677         16  CM-SKIP-CODE                  PIC X.
  4678             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4679             88  SKIP-JULY                    VALUE '1'.
  4680             88  SKIP-AUGUST                  VALUE '2'.
  4681             88  SKIP-SEPTEMBER               VALUE '3'.
  4682             88  SKIP-JULY-AUG                VALUE '4'.
  4683             88  SKIP-AUG-SEPT                VALUE '5'.
  4684             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4685             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4686             88  SKIP-JUNE                    VALUE '8'.
  4687             88  SKIP-JUNE-JULY               VALUE '9'.
  4688             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4689             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4690         16  CM-PAYMENT-MODE               PIC X.
  4691             88  PAY-MONTHLY                  VALUE SPACE.
  4692             88  PAY-WEEKLY                   VALUE '1'.
  4693             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4694             88  PAY-BI-WEEKLY                VALUE '3'.
  4695             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4696         16  CM-LOAN-NUMBER                PIC X(8).
  4697         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4698         16  CM-OLD-LOF                    PIC XXX.
  4699*        16  CM-LOAN-OFFICER               PIC XXX.
  4700         16  CM-REIN-TABLE                 PIC XXX.
  4701         16  CM-SPECIAL-REIN-CODE          PIC X.
  4702         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4703         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4704         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4705
  4706     12  CM-STATUS-DATA.
  4707         16  CM-ENTRY-STATUS               PIC X.
  4708         16  CM-ENTRY-DT                   PIC XX.
  4709
  4710         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4711         16  CM-LF-CANCEL-DT               PIC XX.
  4712         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4713
  4714         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4715         16  CM-LF-DEATH-DT                PIC XX.
  4716         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4717
  4718         16  CM-LF-CURRENT-STATUS          PIC X.
  4719             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4720                                                'M' '4' '5' '9'.
  4721             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4722             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4723             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4724             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4725             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4726             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4727             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4728             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL150.cbl
  4729             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4730             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4731             88  CM-LF-DECLINED               VALUE 'D'.
  4732             88  CM-LF-VOIDED                 VALUE 'V'.
  4733
  4734         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4735         16  CM-AH-CANCEL-DT               PIC XX.
  4736         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4737
  4738         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4739         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4740         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4741
  4742         16  CM-AH-CURRENT-STATUS          PIC X.
  4743             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4744                                                'M' '4' '5' '9'.
  4745             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4746             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4747             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4748             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4749             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4750             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4751             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4752             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4753             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4754             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4755             88  CM-AH-DECLINED               VALUE 'D'.
  4756             88  CM-AH-VOIDED                 VALUE 'V'.
  4757
  4758         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4759             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4760             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4761             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4762         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4763
  4764         16  CM-ENTRY-BATCH                PIC X(6).
  4765         16  CM-LF-EXIT-BATCH              PIC X(6).
  4766         16  CM-AH-EXIT-BATCH              PIC X(6).
  4767         16  CM-LAST-MONTH-END             PIC XX.
  4768
  4769     12  CM-NOTE-SW                        PIC X.
  4770         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4771         88  CERT-NOTES-PRESENT               VALUE '1'.
  4772         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4773         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4774         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4775         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4776         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4777         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4778     12  CM-COMP-EXCP-SW                   PIC X.
  4779         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4780         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4781     12  CM-INSURED-ADDRESS-SW             PIC X.
  4782         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4783         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4784
  4785*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4786     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL150.cbl
  4787     12  FILLER                            PIC X.
  4788
  4789*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4790     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4791     12  FILLER                            PIC X.
  4792*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4793     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4794
  4795     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4796         88  CERT-ADDED-BATCH                 VALUE ' '.
  4797         88  CERT-ADDED-ONLINE                VALUE '1'.
  4798         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4799         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4800         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4801     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4802         88  CERT-AS-LOADED                   VALUE ' '.
  4803         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4804         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4805         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4806         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4807         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4808         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4809         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4810
  4811     12  CM-ACCOUNT-COMM-PCTS.
  4812         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4813         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4814
  4815     12  CM-USER-FIELD                     PIC X.
  4816     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4817     12  CM-CLP-STATE                      PIC XX.
  4818     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4819     12  CM-USER-RESERVED                  PIC XXX.
  4820     12  FILLER REDEFINES CM-USER-RESERVED.
  4821         16  CM-AH-CLASS-CD                PIC XX.
  4822         16  F                             PIC X.
  4823******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL150.cbl
  4825*                            COPY ELCTRLR.
  4826******************************************************************
  4827*                                                                *
  4828*                            ELCTRLR.                            *
  4829*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4830*                            VMOD=2.014                          *
  4831*                                                                *
  4832*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4833*                                                                *
  4834*   FILE TYPE = VSAM,KSDS                                        *
  4835*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4836*                                                                *
  4837*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4838*       ALTERNATE INDEX = NONE                                   *
  4839*                                                                *
  4840*   LOG = YES                                                    *
  4841*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4842******************************************************************
  4843*                   C H A N G E   L O G
  4844*
  4845* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4846*-----------------------------------------------------------------
  4847*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4848* EFFECTIVE    NUMBER
  4849*-----------------------------------------------------------------
  4850* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4851* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4852* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4853* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4854* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4855* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4856* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4857* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4858* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4859* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4860* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4861* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4862* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4863******************************************************************
  4864 01  ACTIVITY-TRAILERS.
  4865     12  AT-RECORD-ID                    PIC XX.
  4866         88  VALID-AT-ID                       VALUE 'AT'.
  4867
  4868     12  AT-CONTROL-PRIMARY.
  4869         16  AT-COMPANY-CD               PIC X.
  4870         16  AT-CARRIER                  PIC X.
  4871         16  AT-CLAIM-NO                 PIC X(7).
  4872         16  AT-CERT-NO.
  4873             20  AT-CERT-PRIME           PIC X(10).
  4874             20  AT-CERT-SFX             PIC X.
  4875         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4876             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4877             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4878             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4879             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4880             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4881             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4882             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL150.cbl
  4883             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4884             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4885             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4886             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4887             88  AT-BENEFICIARY-TRL           VALUE +91.
  4888             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4889             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4890
  4891     12  AT-TRAILER-TYPE                 PIC X.
  4892         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4893         88  PAYMENT-TR                       VALUE '2'.
  4894         88  AUTO-PAY-TR                      VALUE '3'.
  4895         88  CORRESPONDENCE-TR                VALUE '4'.
  4896         88  ADDRESS-TR                       VALUE '5'.
  4897         88  GENERAL-INFO-TR                  VALUE '6'.
  4898         88  AUTO-PROMPT-TR                   VALUE '7'.
  4899         88  DENIAL-TR                        VALUE '8'.
  4900         88  INCURRED-CHG-TR                  VALUE '9'.
  4901         88  FORM-CONTROL-TR                  VALUE 'A'.
  4902
  4903     12  AT-RECORDED-DT                  PIC XX.
  4904     12  AT-RECORDED-BY                  PIC X(4).
  4905     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4906
  4907     12  AT-TRAILER-BODY                 PIC X(165).
  4908
  4909     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4910         16  AT-RESERVE-CONTROLS.
  4911             20  AT-MANUAL-SW            PIC X.
  4912                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4913             20  AT-FUTURE-SW            PIC X.
  4914                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4915             20  AT-PTC-SW               PIC X.
  4916                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4917             20  AT-IBNR-SW              PIC X.
  4918                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4919             20  AT-PTC-LF-SW            PIC X.
  4920                 88  AT-LF-PTC-USED          VALUE '1'.
  4921             20  AT-CDT-ACCESS-METHOD    PIC X.
  4922                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4923                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4924                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4925             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4926         16  AT-LAST-COMPUTED-DT         PIC XX.
  4927         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4928         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4929         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4930         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4931         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4932         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4933         16  AT-EXPENSE-CONTROLS.
  4934             20  AT-EXPENSE-METHOD       PIC X.
  4935                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4936                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4937                 88  PERCENT-OF-PMT           VALUE '3'.
  4938                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4939             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4940             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL150.cbl
  4941         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4942         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4943
  4944         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4945         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4946
  4947*        16  FILLER                      PIC X(53).
  4948         16  FILLER                      PIC X(47).
  4949
  4950         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4951         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4952
  4953         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4954             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4955             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4956*                    C = CLOSED
  4957*                    O = OPEN
  4958             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4959*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4960
  4961     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4962         16  AT-PAYMENT-TYPE             PIC X.
  4963             88  PARTIAL-PAYMENT                VALUE '1'.
  4964             88  FINAL-PAYMENT                  VALUE '2'.
  4965             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4966             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4967             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4968             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4969             88  VOIDED-PAYMENT                 VALUE '9'.
  4970             88  TRANSFER                       VALUE 'T'.
  4971             88  LIFE-INTEREST                  VALUE 'I'.
  4972
  4973         16  AT-CLAIM-TYPE               PIC X.
  4974             88  PAID-FOR-AH                    VALUE 'A'.
  4975             88  PAID-FOR-LIFE                  VALUE 'L'.
  4976             88  PAID-FOR-IUI                   VALUE 'I'.
  4977             88  PAID-FOR-GAP                   VALUE 'G'.
  4978         16  AT-CLAIM-PREM-TYPE          PIC X.
  4979             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4980             88  AT-O-B-COVERAGE                VALUE '2'.
  4981             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4982         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4983         16  AT-CHECK-NO                 PIC X(7).
  4984         16  AT-PAID-FROM-DT             PIC XX.
  4985         16  AT-PAID-THRU-DT             PIC XX.
  4986         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4987         16  FILLER                      PIC X.
  4988         16  AT-PAYEES-NAME              PIC X(30).
  4989         16  AT-PAYMENT-ORIGIN           PIC X.
  4990             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4991             88  ONLINE-AUTO-PMT                VALUE '2'.
  4992             88  OFFLINE-PMT                    VALUE '3'.
  4993         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4994         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4995         16  AT-VOID-DATA.
  4996             20  AT-VOID-DT              PIC XX.
  4997*00144       20  AT-VOID-REASON          PIC X(30).
  4998             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL150.cbl
  4999         16  AT-PMT-APPROVED-BY          PIC X(04).
  5000         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5001         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5002         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5003                                         PIC S99V9(5)  COMP-3.
  5004         16  AT-CREDIT-INTERFACE.
  5005             20  AT-PMT-SELECT-DT        PIC XX.
  5006                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5007             20  AT-PMT-ACCEPT-DT        PIC XX.
  5008                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5009             20  AT-VOID-SELECT-DT       PIC XX.
  5010                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5011             20  AT-VOID-ACCEPT-DT       PIC XX.
  5012                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5013
  5014         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5015                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5016                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5017         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5018
  5019         16  AT-FORCE-CONTROL            PIC X.
  5020             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5021         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5022         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5023         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5024         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5025         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5026         16  AT-BENEFIT-TYPE             PIC X.
  5027
  5028         16  AT-EXPENSE-TYPE             PIC X.
  5029         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5030
  5031         16  AT-PAYEE-TYPE-CD.
  5032             20  AT-PAYEE-TYPE           PIC X.
  5033                 88  INSURED-PAID           VALUE 'I'.
  5034                 88  BENEFICIARY-PAID       VALUE 'B'.
  5035                 88  ACCOUNT-PAID           VALUE 'A'.
  5036                 88  OTHER-1-PAID           VALUE 'O'.
  5037                 88  OTHER-2-PAID           VALUE 'Q'.
  5038                 88  DOCTOR-PAID            VALUE 'P'.
  5039                 88  EMPLOYER-PAID          VALUE 'E'.
  5040             20  AT-PAYEE-SEQ            PIC X.
  5041
  5042         16  AT-CASH-PAYMENT             PIC X.
  5043         16  AT-GROUPED-PAYMENT          PIC X.
  5044         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5045         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5046         16  AT-APPROVED-LEVEL           PIC X.
  5047         16  AT-VOID-TYPE                PIC X.
  5048             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5049             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5050         16  AT-AIG-UNEMP-IND            PIC X.
  5051             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5052         16  AT-ASSOCIATES               PIC X.
  5053             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5054             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5055
  5056         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL150.cbl
  5057         16  AT-CV-PMT-CODE              PIC X.
  5058             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5059             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5060             88  FULL-ADD-PAYMENT           VALUE '3'.
  5061             88  HALF-ADD-PAYMENT           VALUE '4'.
  5062             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5063             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5064             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5065             88  ADDL-PAYMENT               VALUE '8'.
  5066
  5067         16  AT-EOB-CODE1                PIC XXX.
  5068         16  AT-EOB-CODE2                PIC XXX.
  5069         16  AT-EOB-CODE3                PIC XXX.
  5070         16  AT-EOB-CODE4                PIC XXX.
  5071         16  FILLER REDEFINES AT-EOB-CODE4.
  5072             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5073             20  FILLER                  PIC X.
  5074         16  AT-EOB-CODE5                PIC XXX.
  5075         16  FILLER REDEFINES AT-EOB-CODE5.
  5076             20  AT-PMT-PROOF-DT         PIC XX.
  5077             20  FILLER                  PIC X.
  5078
  5079         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5080             88  AT-PRINT-EOB            VALUE 'Y'.
  5081
  5082         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5083         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5084
  5085     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5086         16  AT-SCHEDULE-START-DT        PIC XX.
  5087         16  AT-SCHEDULE-END-DT          PIC XX.
  5088         16  AT-TERMINATED-DT            PIC XX.
  5089         16  AT-LAST-PMT-TYPE            PIC X.
  5090             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5091             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5092         16  AT-FIRST-PMT-DATA.
  5093             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5094             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5095             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5096         16  AT-REGULAR-PMT-DATA.
  5097             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5098             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5099             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5100         16  AT-AUTO-PAYEE-CD.
  5101             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5102                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5103                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5104                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5105                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5106                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5107             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5108         16  AT-AUTO-PAY-DAY             PIC 99.
  5109         16  AT-AUTO-CASH                PIC X.
  5110             88  AT-CASH                      VALUE 'Y'.
  5111             88  AT-NON-CASH                  VALUE 'N'.
  5112*        16  FILLER                      PIC X(129).
  5113         16  AT-AUTO-END-LETTER          PIC X(4).
  5114         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL150.cbl
  5115
  5116         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5117         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5118
  5119     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5120         16  AT-LETTER-SENT-DT           PIC XX.
  5121         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5122         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5123         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5124         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5125         16  AT-LETTER-ORIGIN            PIC X.
  5126             88  ONLINE-CREATION              VALUE '1' '3'.
  5127             88  OFFLINE-CREATION             VALUE '2' '4'.
  5128             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5129             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5130         16  AT-STD-LETTER-FORM          PIC X(4).
  5131         16  AT-REASON-TEXT              PIC X(70).
  5132         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5133         16  AT-ADDRESEE-TYPE            PIC X.
  5134              88  INSURED-ADDRESEE            VALUE 'I'.
  5135              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5136              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5137              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5138              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5139              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5140              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5141         16  AT-ADDRESSEE-NAME           PIC X(30).
  5142         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5143         16  AT-RESEND-PRINT-DATE        PIC XX.
  5144         16  AT-CORR-SOL-UNSOL           PIC X.
  5145         16  AT-LETTER-PURGED-DT         PIC XX.
  5146*
  5147*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5148*
  5149         16  AT-CSO-REDEFINITION.
  5150             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5151             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5152             20  AT-LETTER-TO-BENE       PIC X(1).
  5153             20  AT-STOP-LETTER-DT       PIC X(2).
  5154             20  FILLER                  PIC X(19).
  5155*             20  FILLER                  PIC X(27).
  5156             20  AT-CSO-LETTER-STATUS    PIC X.
  5157                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5158                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5159                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5160             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5161             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5162*
  5163*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5164*
  5165*        16  FILLER                      PIC X(26).
  5166*
  5167*        16  AT-DMD-BSR-CODE             PIC X.
  5168*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5169*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5170*
  5171*        16  AT-DMD-LETTER-STATUS        PIC X.
  5172*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL150.cbl
  5173*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5174*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  5175*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5176*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5177
  5178         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5179         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5180
  5181     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5182         16  AT-ADDRESS-TYPE             PIC X.
  5183             88  INSURED-ADDRESS               VALUE 'I'.
  5184             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5185             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5186             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5187             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5188             88  OTHER-ADDRESS-1               VALUE 'O'.
  5189             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5190         16  AT-MAIL-TO-NAME             PIC X(30).
  5191         16  AT-ADDRESS-LINE-1           PIC X(30).
  5192         16  AT-ADDRESS-LINE-2           PIC X(30).
  5193         16  AT-CITY-STATE.
  5194             20  AT-CITY                 PIC X(28).
  5195             20  AT-STATE                PIC XX.
  5196         16  AT-ZIP.
  5197             20  AT-ZIP-CODE.
  5198                 24  AT-ZIP-1ST          PIC X.
  5199                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5200                 24  FILLER              PIC X(4).
  5201             20  AT-ZIP-PLUS4            PIC X(4).
  5202         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  5203             20  AT-CAN-POSTAL-1         PIC XXX.
  5204             20  AT-CAN-POSTAL-2         PIC XXX.
  5205             20  FILLER                  PIC XXX.
  5206         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  5207*         16  FILLER                      PIC X(23).
  5208         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  5209         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  5210         16  FILLER                      PIC X(13).
  5211         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  5212         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  5213
  5214     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5215         16  AT-INFO-LINE-1              PIC X(60).
  5216         16  AT-INFO-LINE-2              PIC X(60).
  5217         16  AT-INFO-TRAILER-TYPE        PIC X.
  5218             88  AT-PAYMENT-NOTE         VALUE 'P'.
  5219             88  AT-CALL-NOTE            VALUE 'C'.
  5220             88  AT-MAINT-NOTE           VALUE 'M'.
  5221             88  AT-CERT-CHANGE          VALUE 'X'.
  5222             88  AT-APPROVAL-NOTE        VALUE 'R'.
  5223             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  5224         16  AT-CALL-TYPE                PIC X.
  5225             88  AT-PHONE-CALL-IN        VALUE 'I'.
  5226             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  5227         16  AT-NOTE-CONTINUATION        PIC X.
  5228             88  AT-CONTINUED-NOTE       VALUE 'X'.
  5229         16  AT-EOB-CODES-EXIST          PIC X.
  5230             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL150.cbl
  5231         16  FILLER                      PIC X(35).
  5232         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  5233         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  5234
  5235     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  5236         16  AT-PROMPT-LINE-1            PIC X(60).
  5237         16  AT-PROMPT-LINE-2            PIC X(60).
  5238         16  AT-PROMPT-START-DT          PIC XX.
  5239         16  AT-PROMPT-END-DT            PIC XX.
  5240         16  FILLER                      PIC X(35).
  5241         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  5242         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  5243
  5244     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5245         16  AT-DENIAL-INFO-1            PIC X(60).
  5246         16  AT-DENIAL-INFO-2            PIC X(60).
  5247         16  AT-DENIAL-DT                PIC XX.
  5248         16  AT-RETRACTION-DT            PIC XX.
  5249         16  AT-DENIAL-REASON-CODE       PIC X(4).
  5250*         16  FILLER                      PIC X(31).
  5251         16  AT-DENIAL-PROOF-DT          PIC XX.
  5252         16  FILLER                      PIC X(29).
  5253         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  5254         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  5255
  5256     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  5257         16  AT-OLD-INCURRED-DT          PIC XX.
  5258         16  AT-OLD-REPORTED-DT          PIC XX.
  5259         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  5260         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  5261         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  5262         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  5263         16  AT-OLD-PAID-THRU-DT         PIC XX.
  5264         16  AT-LAST-PMT-MADE-DT         PIC XX.
  5265         16  FILLER                      PIC X(26).
  5266         16  AT-OLD-DIAG-CODE            PIC X(6).
  5267         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  5268         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  5269         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  5270         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  5271         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  5272         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  5273         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  5274         16  FILLER                      PIC X(25).
  5275         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  5276
  5277     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  5278         16  AT-FORM-SEND-ON-DT          PIC XX.
  5279         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  5280         16  AT-FORM-RE-SEND-DT          PIC XX.
  5281         16  AT-FORM-ANSWERED-DT         PIC XX.
  5282         16  AT-FORM-PRINTED-DT          PIC XX.
  5283         16  AT-FORM-REPRINT-DT          PIC XX.
  5284         16  AT-FORM-TYPE                PIC X.
  5285             88  INITIAL-FORM                  VALUE '1'.
  5286             88  PROGRESS-FORM                 VALUE '2'.
  5287         16  AT-INSTRUCT-LN-1            PIC X(28).
  5288         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL150.cbl
  5289         16  AT-INSTRUCT-LN-3            PIC X(28).
  5290         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  5291         16  AT-FORM-ADDRESS             PIC X.
  5292             88  FORM-TO-INSURED              VALUE 'I'.
  5293             88  FORM-TO-ACCOUNT              VALUE 'A'.
  5294             88  FORM-TO-OTHER-1              VALUE 'O'.
  5295             88  FORM-TO-OTHER-2              VALUE 'Q'.
  5296         16  AT-RELATED-1.
  5297             20 AT-REL-CARR-1            PIC X.
  5298             20 AT-REL-CLAIM-1           PIC X(7).
  5299             20 AT-REL-CERT-1            PIC X(11).
  5300         16  AT-RELATED-2.
  5301             20 AT-REL-CARR-2            PIC X.
  5302             20 AT-REL-CLAIM-2           PIC X(7).
  5303             20 AT-REL-CERT-2            PIC X(11).
  5304         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  5305         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  5306         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  5307         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  5308         16  AT-FORM-REM-PRINT-DT        PIC XX.
  5309         16  AT-STOP-FORM-DT             PIC X(2).
  5310
  5311         16  FILLER                      PIC X(09).
  5312         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  5313         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  5314******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL150.cbl
  5316*                            COPY ELCACTQ.
  5317******************************************************************
  5318*                                                                *
  5319*                            ELCACTQ.                            *
  5320*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5321*                            VMOD=2.004                          *
  5322*                                                                *
  5323*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5324*                                                                *
  5325*   FILE TYPE = VSAM,KSDS                                        *
  5326*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5327*                                                                *
  5328*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5329*       ALTERNATE INDEX = NONE                                   *
  5330*                                                                *
  5331*   LOG = YES                                                    *
  5332*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5333*                                                                *
  5334*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5335******************************************************************
  5336
  5337 01  ACTIVITY-QUE.
  5338     12  AQ-RECORD-ID                PIC XX.
  5339         88  VALID-AQ-ID                VALUE 'AQ'.
  5340
  5341     12  AQ-CONTROL-PRIMARY.
  5342         16  AQ-COMPANY-CD           PIC X.
  5343         16  AQ-CARRIER              PIC X.
  5344         16  AQ-CLAIM-NO             PIC X(7).
  5345         16  AQ-CERT-NO.
  5346             20  AQ-CERT-PRIME       PIC X(10).
  5347             20  AQ-CERT-SFX         PIC X.
  5348
  5349     12  AQ-PENDING-ACTIVITY-FLAGS.
  5350         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5351         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  5352             88  PENDING-PAYMENTS       VALUE '1'.
  5353         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5354             88  PENDING-FULL-PRINT     VALUE '1'.
  5355             88  PENDING-PART-PRINT     VALUE '2'.
  5356         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5357             88  PENDING-LETTERS        VALUE '1'.
  5358         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5359             88  PENDING-RESTORE        VALUE 'C'.
  5360             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5361
  5362     12  FILLER                      PIC X(20).
  5363
  5364     12  AQ-RESEND-DATE              PIC XX.
  5365     12  AQ-FOLLOWUP-DATE            PIC XX.
  5366     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5367     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  5368     12  AQ-AUTO-LETTER              PIC X(4).
  5369     12  FILLER                      PIC XX.
  5370     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5371*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL150.cbl
  5373*                            COPY ERCACCT.
  5374******************************************************************
  5375*                                                                *
  5376*                                                                *
  5377*                            ERCACCT                             *
  5378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5379*                            VMOD=2.031                          *
  5380*                                                                *
  5381*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5382*                                                                *
  5383*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5384*   VSAM ACCOUNT MASTER FILES.                                   *
  5385*                                                                *
  5386*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5387*                                                                *
  5388*   FILE TYPE = VSAM,KSDS                                        *
  5389*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5390*                                                                *
  5391*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5392*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5393*                                                                *
  5394*   LOG = NO                                                     *
  5395*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5396*                                                                *
  5397*                                                                *
  5398******************************************************************
  5399*                   C H A N G E   L O G
  5400*
  5401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5402*-----------------------------------------------------------------
  5403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5404* EFFECTIVE    NUMBER
  5405*-----------------------------------------------------------------
  5406* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5407* 092705    2005050300006  PEMA  ADD SPP LEASES
  5408* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5409* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5410* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5411* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5412* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5413******************************************************************
  5414
  5415 01  ACCOUNT-MASTER.
  5416     12  AM-RECORD-ID                      PIC XX.
  5417         88  VALID-AM-ID                      VALUE 'AM'.
  5418
  5419     12  AM-CONTROL-PRIMARY.
  5420         16  AM-COMPANY-CD                 PIC X.
  5421         16  AM-MSTR-CNTRL.
  5422             20  AM-CONTROL-A.
  5423                 24  AM-CARRIER            PIC X.
  5424                 24  AM-GROUPING.
  5425                     28 AM-GROUPING-PREFIX PIC XXX.
  5426                     28 AM-GROUPING-PRIME  PIC XXX.
  5427                 24  AM-STATE              PIC XX.
  5428                 24  AM-ACCOUNT.
  5429                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5430                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL150.cbl
  5431             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5432                                           PIC X(19).
  5433             20  AM-CNTRL-B.
  5434                 24  AM-EXPIRATION-DT      PIC XX.
  5435                 24  FILLER                PIC X(4).
  5436             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5437                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5438
  5439     12  AM-CONTROL-BY-VAR-GRP.
  5440         16  AM-COMPANY-CD-A1              PIC X.
  5441         16  AM-VG-CARRIER                 PIC X.
  5442         16  AM-VG-GROUPING                PIC X(6).
  5443         16  AM-VG-STATE                   PIC XX.
  5444         16  AM-VG-ACCOUNT                 PIC X(10).
  5445         16  AM-VG-DATE.
  5446             20  AM-VG-EXPIRATION-DT       PIC XX.
  5447             20  FILLER                    PIC X(4).
  5448         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5449                                           PIC 9(11)      COMP-3.
  5450     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5451         16  FILLER                        PIC X(10).
  5452         16  AM-VG-KEY3.
  5453             20  AM-VG3-ACCOUNT            PIC X(10).
  5454             20  AM-VG3-EXP-DT             PIC XX.
  5455         16  FILLER                        PIC X(4).
  5456     12  AM-MAINT-INFORMATION.
  5457         16  AM-LAST-MAINT-DT              PIC XX.
  5458         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5459         16  AM-LAST-MAINT-USER            PIC X(4).
  5460         16  FILLER                        PIC XX.
  5461
  5462     12  AM-EFFECTIVE-DT                   PIC XX.
  5463     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5464
  5465     12  AM-PREV-DATES  COMP-3.
  5466         16  AM-PREV-EXP-DT                PIC 9(11).
  5467         16  AM-PREV-EFF-DT                PIC 9(11).
  5468
  5469     12  AM-REPORT-CODE-1                  PIC X(10).
  5470     12  AM-REPORT-CODE-2                  PIC X(10).
  5471
  5472     12  AM-CITY-CODE                      PIC X(4).
  5473     12  AM-COUNTY-PARISH                  PIC X(6).
  5474
  5475     12  AM-NAME                           PIC X(30).
  5476     12  AM-PERSON                         PIC X(30).
  5477     12  AM-ADDRS                          PIC X(30).
  5478     12  AM-CITY.
  5479         16  AM-ADDR-CITY                  PIC X(28).
  5480         16  AM-ADDR-STATE                 PIC XX.
  5481     12  AM-ZIP.
  5482         16  AM-ZIP-PRIME.
  5483             20  AM-ZIP-PRI-1ST            PIC X.
  5484                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5485             20  FILLER                    PIC X(4).
  5486         16  AM-ZIP-PLUS4                  PIC X(4).
  5487     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5488         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL150.cbl
  5489         16  AM-CAN-POSTAL-2               PIC XXX.
  5490         16  FILLER                        PIC XXX.
  5491     12  AM-TEL-NO.
  5492         16  AM-AREA-CODE                  PIC 999.
  5493         16  AM-TEL-PRE                    PIC 999.
  5494         16  AM-TEL-NBR                    PIC 9(4).
  5495     12  AM-TEL-LOC                        PIC X.
  5496         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5497         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5498
  5499     12  AM-COMM-STRUCTURE.
  5500         16  AM-DEFN-1.
  5501             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5502                 24  AM-AGT.
  5503                     28  AM-AGT-PREFIX     PIC X(4).
  5504                     28  AM-AGT-PRIME      PIC X(6).
  5505                 24  AM-COM-TYP            PIC X.
  5506                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5507                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5508                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5509                 24  AM-RECALC-LV-INDIC    PIC X.
  5510                 24  AM-RETRO-LV-INDIC     PIC X.
  5511                 24  AM-GL-CODES           PIC X.
  5512                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5513                 24  FILLER                PIC X(01).
  5514         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5515             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5516                 24  FILLER                PIC X(11).
  5517                 24  AM-L-COMA             PIC XXX.
  5518                 24  AM-J-COMA             PIC XXX.
  5519                 24  AM-A-COMA             PIC XXX.
  5520                 24  FILLER                PIC X(6).
  5521
  5522     12  AM-COMM-CHANGE-STATUS             PIC X.
  5523         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5524
  5525     12  AM-CSR-CODE                       PIC X(4).
  5526
  5527     12  AM-BILLING-STATUS                 PIC X.
  5528         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5529         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5530     12  AM-AUTO-REFUND-SW                 PIC X.
  5531         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5532         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5533     12  AM-GPCD                           PIC 99.
  5534     12  AM-IG                             PIC X.
  5535         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5536         88  AM-HAS-GROUP                     VALUE '2'.
  5537     12  AM-STATUS                         PIC X.
  5538         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5539         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5540         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5541         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5542         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5543         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5544     12  AM-REMIT-TO                       PIC 99.
  5545     12  AM-ID-NO                          PIC X(11).
  5546
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL150.cbl
  5547     12  AM-CAL-TABLE                      PIC XX.
  5548     12  AM-LF-DEVIATION                   PIC XXX.
  5549     12  AM-AH-DEVIATION                   PIC XXX.
  5550     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5551     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5552     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5553     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5554     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5555     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5556
  5557     12  AM-USER-FIELDS.
  5558         16  AM-FLD-1                      PIC XX.
  5559         16  AM-FLD-2                      PIC XX.
  5560         16  AM-FLD-3                      PIC XX.
  5561         16  AM-FLD-4                      PIC XX.
  5562         16  AM-FLD-5                      PIC XX.
  5563
  5564     12  AM-1ST-PROD-DATE.
  5565         16  AM-1ST-PROD-YR                PIC XX.
  5566         16  AM-1ST-PROD-MO                PIC XX.
  5567         16  AM-1ST-PROD-DA                PIC XX.
  5568     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5569     12  AM-CERTS-PURGED-DATE.
  5570         16  AM-PUR-YR                     PIC XX.
  5571         16  AM-PUR-MO                     PIC XX.
  5572         16  AM-PUR-DA                     PIC XX.
  5573     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5574     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5575     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5576     12  AM-INACTIVE-DATE.
  5577         16  AM-INA-MO                     PIC 99.
  5578         16  AM-INA-DA                     PIC 99.
  5579         16  AM-INA-YR                     PIC 99.
  5580     12  AM-AR-HI-CERT-DATE                PIC XX.
  5581
  5582     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5583     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5584
  5585     12  AM-OB-PAYMENT-MODE                PIC X.
  5586         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5587         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5588         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5589         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5590
  5591     12  AM-AH-ONLY-INDICATOR              PIC X.
  5592         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5593         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5594
  5595     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5596
  5597     12  AM-OVER-SHORT.
  5598         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5599         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5600
  5601     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5602     12  AM-DCC-CLP-STATE                  PIC XX.
  5603
  5604     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL150.cbl
  5605     12  AM-RECALC-REIN                    PIC X.
  5606
  5607     12  AM-REI-TABLE                      PIC XXX.
  5608     12  AM-REI-ET-LF                      PIC X.
  5609     12  AM-REI-ET-AH                      PIC X.
  5610     12  AM-REI-PE-LF                      PIC X.
  5611     12  AM-REI-PE-AH                      PIC X.
  5612     12  AM-REI-PRT-ST                     PIC X.
  5613     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5614     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5615     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5616     12  AM-REI-GROUP-A                    PIC X(6).
  5617     12  AM-REI-MORT                       PIC X(4).
  5618     12  AM-REI-PRT-OW                     PIC X.
  5619     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5620     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5621     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5622     12  AM-REI-GROUP-B                    PIC X(6).
  5623
  5624     12  AM-TRUST-TYPE                     PIC X(2).
  5625
  5626     12  AM-EMPLOYER-STMT-USED             PIC X.
  5627     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5628
  5629     12  AM-STD-AH-TYPE                    PIC XX.
  5630     12  AM-EARN-METHODS.
  5631         16  AM-EARN-METHOD-R              PIC X.
  5632             88 AM-REF-RL-R78                 VALUE 'R'.
  5633             88 AM-REF-RL-PR                  VALUE 'P'.
  5634             88 AM-REF-RL-MEAN                VALUE 'M'.
  5635             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5636         16  AM-EARN-METHOD-L              PIC X.
  5637             88 AM-REF-LL-R78                 VALUE 'R'.
  5638             88 AM-REF-LL-PR                  VALUE 'P'.
  5639             88 AM-REF-LL-MEAN                VALUE 'M'.
  5640             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5641         16  AM-EARN-METHOD-A              PIC X.
  5642             88 AM-REF-AH-R78                 VALUE 'R'.
  5643             88 AM-REF-AH-PR                  VALUE 'P'.
  5644             88 AM-REF-AH-MEAN                VALUE 'M'.
  5645             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5646             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5647             88 AM-REF-AH-NET                 VALUE 'N'.
  5648
  5649     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5650     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5651     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5652
  5653     12  AM-RET-Y-N                        PIC X.
  5654     12  AM-RET-P-E                        PIC X.
  5655     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5656     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5657     12  AM-RET-GRP                        PIC X(6).
  5658     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5659         16  AM-POOL-PRIME                 PIC XXX.
  5660         16  AM-POOL-SUB                   PIC XXX.
  5661     12  AM-RETRO-EARNINGS.
  5662         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL150.cbl
  5663         16  AM-RET-EARN-L                 PIC X.
  5664         16  AM-RET-EARN-A                 PIC X.
  5665     12  AM-RET-ST-TAX-USE                 PIC X.
  5666         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5667         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5668     12  AM-RETRO-BEG-EARNINGS.
  5669         16  AM-RET-BEG-EARN-R             PIC X.
  5670         16  AM-RET-BEG-EARN-L             PIC X.
  5671         16  AM-RET-BEG-EARN-A             PIC X.
  5672     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5673     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5674
  5675     12  AM-USER-SELECT-OPTIONS.
  5676         16  AM-USER-SELECT-1              PIC X(10).
  5677         16  AM-USER-SELECT-2              PIC X(10).
  5678         16  AM-USER-SELECT-3              PIC X(10).
  5679         16  AM-USER-SELECT-4              PIC X(10).
  5680         16  AM-USER-SELECT-5              PIC X(10).
  5681
  5682     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5683
  5684     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5685
  5686     12  AM-RPT045A-SWITCH                 PIC X.
  5687         88  RPT045A-OFF                   VALUE 'N'.
  5688
  5689     12  AM-INSURANCE-LIMITS.
  5690         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5691         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5692
  5693     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5694         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5695
  5696     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5697         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5698         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5699
  5700     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5701
  5702     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5703     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5704     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5705     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5706     12  AM-DCC-UEF-STATE                  PIC XX.
  5707     12  FILLER                            PIC XXX.
  5708     12  AM-REPORT-CODE-3                  PIC X(10).
  5709*    12  FILLER                            PIC X(22).
  5710
  5711     12  AM-RESERVE-DATE.
  5712         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5713         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5714         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5715
  5716     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5717     12  AM-NOTIFICATION-TYPES.
  5718         16  AM-NOTIF-OF-LETTERS           PIC X.
  5719         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5720         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL150.cbl
  5721         16  AM-NOTIF-OF-STATUS            PIC X.
  5722
  5723     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5724         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5725         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5726         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5727         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5728
  5729     12  AM-BENEFIT-CONTROLS.
  5730         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5731             20  AM-BENEFIT-CODE           PIC XX.
  5732             20  AM-BENEFIT-TYPE           PIC X.
  5733             20  AM-BENEFIT-REVISION       PIC XXX.
  5734             20  AM-BENEFIT-REM-TERM       PIC X.
  5735             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5736             20  FILLER                    PIC XX.
  5737         16  FILLER                        PIC X(80).
  5738
  5739     12  AM-TRANSFER-DATA.
  5740         16  AM-TRANSFERRED-FROM.
  5741             20  AM-TRNFROM-CARRIER        PIC X.
  5742             20  AM-TRNFROM-GROUPING.
  5743                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5744                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5745             20  AM-TRNFROM-STATE          PIC XX.
  5746             20  AM-TRNFROM-ACCOUNT.
  5747                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5748                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5749             20  AM-TRNFROM-DTE            PIC XX.
  5750         16  AM-TRANSFERRED-TO.
  5751             20  AM-TRNTO-CARRIER          PIC X.
  5752             20  AM-TRNTO-GROUPING.
  5753                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5754                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5755             20  AM-TRNTO-STATE            PIC XX.
  5756             20  AM-TRNTO-ACCOUNT.
  5757                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5758                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5759             20  AM-TRNTO-DTE              PIC XX.
  5760         16  FILLER                        PIC X(10).
  5761
  5762     12  AM-SAVED-REMIT-TO                 PIC 99.
  5763
  5764     12  AM-COMM-STRUCTURE-SAVED.
  5765         16  AM-DEFN-1-SAVED.
  5766             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5767                 24  AM-AGT-SV             PIC X(10).
  5768                 24  AM-COM-TYP-SV         PIC X.
  5769                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5770                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5771                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5772                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5773                 24  FILLER                PIC X.
  5774                 24  AM-GL-CODES-SV        PIC X.
  5775                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5776                 24  FILLER                PIC X.
  5777         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5778             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL150.cbl
  5779                 24  FILLER                PIC X(11).
  5780                 24  AM-L-COMA-SV          PIC XXX.
  5781                 24  AM-J-COMA-SV          PIC XXX.
  5782                 24  AM-A-COMA-SV          PIC XXX.
  5783                 24  FILLER                PIC X(6).
  5784
  5785     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5786         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5787            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5788            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5789            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5790
  5791     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5792     12  FILLER                            PIC X(120).
  5793
  5794     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5795         16  AM-CONTROL-NAME               PIC X(30).
  5796         16  AM-EXECUTIVE-ONE.
  5797             20  AM-EXEC1-NAME             PIC X(15).
  5798             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5799                                                          COMP-3.
  5800             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5801                                                          COMP-3.
  5802         16  AM-EXECUTIVE-TWO.
  5803             20  AM-EXEC2-NAME             PIC X(15).
  5804             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5805                                                          COMP-3.
  5806             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5807                                                          COMP-3.
  5808
  5809     12  AM-RETRO-ADDITIONAL-DATA.
  5810         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5811         16  AM-RETRO-PREM-P-E             PIC X.
  5812         16  AM-RETRO-CLMS-P-I             PIC X.
  5813         16  AM-RETRO-RET-BRACKET-LF.
  5814             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5815                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5816                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5817             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5818                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5819                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5820             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5821                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5822                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5823         16  AM-RETRO-RET-BRACKET-AH.
  5824             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5825                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5826                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5827                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5828             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5829                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5830                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5831             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5832                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5833                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5834
  5835     12  AM-COMMENTS.
  5836         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL150.cbl
  5837
  5838     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5839         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5840         16  AM-FLI-BILLING-CODE           PIC X.
  5841         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5842         16  AM-FLI-UNITED-IDENT           PIC X.
  5843         16  AM-FLI-INTEREST-LOST-DATA.
  5844             20  AM-FLI-BANK-NO            PIC X(5).
  5845             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5846             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5847             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5848         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5849             20  AM-FLI-AGT                PIC X(9).
  5850             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5851             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5852         16  FILLER                        PIC X(102).
  5853
  5854     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5855         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5856             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5857             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5858             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5859             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5860             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5861         16  FILLER                          PIC X(10).
  5862******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL150.cbl
  5864*                            COPY ELCARCH.
  5865******************************************************************
  5866*                                                                *
  5867*                            ELCARCH.                            *
  5868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5869*                            VMOD=2.007                          *
  5870*                                                                *
  5871*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5872*                                                                *
  5873*   FILE TYPE = VSAM,KSDS                                        *
  5874*   RECORD SIZE = 090  RECFORM = FIXED                           *
  5875*                                                                *
  5876*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  5877*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  5878*                                                                *
  5879*   LOG = NO                                                     *
  5880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5881*                                                                *
  5882*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  5883******************************************************************
  5884 01  LETTER-ARCHIVE.
  5885     12  LA-RECORD-ID                PIC XX.
  5886         88  VALID-LA-ID                VALUE 'LA'.
  5887
  5888     12  LA-CONTROL-PRIMARY.
  5889         16  LA-COMPANY-CD           PIC X.
  5890         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  5891         16  LA-RECORD-TYPE          PIC X.
  5892             88  LA-HEADER-DATA         VALUE '1'.
  5893             88  LA-ADDRESS-DATA        VALUE '2'.
  5894             88  LA-TEXT-DATA           VALUE '3'.
  5895             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  5896         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  5897
  5898     12  LA-CONTROL-BY-TYPE.
  5899         16  LA-COMPANY-CD-A1        PIC X.
  5900         16  LA-RECORD-TYPE-A1       PIC X.
  5901         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  5902         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  5903
  5904     12  LA-TEXT-RECORD.
  5905         16  LA-SKIP-CONTROL         PIC XX.
  5906             88  NO-LINES-SKIPPED       VALUE SPACES.
  5907             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  5908         16  LA-TEXT-LINE            PIC X(70).
  5909
  5910     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  5911         16  FILLER                  PIC XX.
  5912         16  LA-ADDRESS-LINE         PIC X(30).
  5913         16  FILLER                  PIC X(40).
  5914
  5915     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  5916         16  FILLER                  PIC XX.
  5917         16  LA-CARRIER              PIC X.
  5918         16  LA-CLAIM-NO             PIC X(7).
  5919         16  LA-CERT-NO.
  5920             20  LA-CERT-PRIME       PIC X(10).
  5921             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL150.cbl
  5922         16  LA-NO-OF-COPIES         PIC S9.
  5923         16  LA-RESEND-DATE          PIC XX.
  5924         16  LA-PROCESSOR-CD         PIC X(4).
  5925         16  LA-CREATION-DT          PIC XX.
  5926         16  LA-INITIAL-PRINT-DATE   PIC XX.
  5927         16  LA-RESEND-PRINT-DATE    PIC XX.
  5928         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  5929         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  5930*
  5931* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  5932*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  5933*   I        20  LA-DMD-PROD-CODE        PIC XX.
  5934*   I        20  LA-DMD-RES-ST           PIC XX.
  5935*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  5936*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  5937*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  5938*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  5939*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  5940*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  5941*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  5942*   I        20  LA-DMD-UND-CODE         PIC XX.
  5943*   I        20  LA-DMD-BEN-CODE         PIC XX.
  5944*   V    16  FILLER                  PIC X(15).
  5945* -----
  5946*
  5947* REINSERTED  CSO  MODS
  5948*
  5949         16  FILLER.
  5950             20  FILLER                  PIC X(29).
  5951             20  LA-CSO-LETTER-STATUS    PIC X.
  5952                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  5953                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  5954                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  5955             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  5956             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  5957*
  5958
  5959     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  5960         16  FILLER                  PIC XX.
  5961         16  LA4-CARRIER             PIC X.
  5962         16  LA4-CLAIM-NO            PIC X(7).
  5963         16  LA4-CERT-NO.
  5964             20  LA4-CERT-PRIME      PIC X(10).
  5965             20  LA4-CERT-SFX        PIC X.
  5966         16  LA4-NO-OF-COPIES        PIC S9.
  5967         16  LA4-RESEND-DATE         PIC XX.
  5968         16  LA4-PROCESSOR-CD        PIC X(4).
  5969         16  LA4-CREATION-DT         PIC XX.
  5970         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  5971         16  LA4-RESEND-PRINT-DATE   PIC XX.
  5972         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  5973         16  LA4-FORM-TYPE           PIC X.
  5974             88  LA4-INITIAL-FORM    VALUE '1'.
  5975             88  LA4-PROGRESS-FORM   VALUE '2'.
  5976         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  5977         16  LA4-STATE               PIC X(02).
  5978         16  FILLER                  PIC X(31).
  5979******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL150.cbl
  5981*                COPY MTCPLCY REPLACING ==:TAG:== BY ==PM==.
  5982******************************************************************
  5983*                                                                *
  5984*                           MTCPLCY                              *
  5985*                            VMOD=1.003                          *
  5986*                                                                *
  5987*   FILE DESCRIPTION = POLICY MASTER                             *
  5988*                                                                *
  5989*   FILE TYPE = VSAM,KSDS                                        *
  5990*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5991*                                                                *
  5992*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5993*       ALTERNATE PATH2 = ** NOT USED **                         *
  5994*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5995*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5996*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5997*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5998*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5999*                                                                *
  6000*   LOG = YES                                                    *
  6001*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6002******************************************************************
  6003**WARNING*********************************************************
  6004**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  6005**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  6006**                             MPCPHSTD                          *
  6007**                             MPCPHSTC                          *
  6008**                             MPCPHSTT                          *
  6009**                                                               *
  6010******************************************************************
  6011
  6012 01  POLICY-MASTER.
  6013     12  PM-RECORD-ID                   PIC XX.
  6014         88  VALID-PM-ID                      VALUE 'PM'.
  6015
  6016******************************************************************
  6017*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  6018******************************************************************
  6019
  6020     12  PM-CONTROL-PRIMARY.
  6021         16  PM-PRODUCER-PRIMARY.
  6022             20  PM-PROD-PRIMARY.
  6023                 24  PM-COMPANY-CD      PIC X.
  6024                 24  PM-CGSP-KEY.
  6025                     28  PM-CARRIER     PIC X.
  6026                     28  PM-GROUPING.
  6027                         32  PM-GROUPING-PREFIX
  6028                                           PIC X(3).
  6029                         32  PM-GROUPING-PRIME
  6030                                           PIC X(3).
  6031                     28  PM-STATE       PIC XX.
  6032                     28  PM-PRODUCER.
  6033                         32  PM-PRODUCER-PREFIX
  6034                                           PIC X(4).
  6035                         32  PM-PRODUCER-PRIME
  6036                                           PIC X(6).
  6037             20  PM-POLICY-EFF-DT       PIC XX.
  6038         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL150.cbl
  6039             20  PM-REFNO-PRIME         PIC X(18).
  6040             20  PM-REFNO-SFX           PIC XX.
  6041
  6042******************************************************************
  6043*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  6044******************************************************************
  6045
  6046     12  PM-CONTROL-BY-SSN.
  6047         16  PM-COMPANY-CD-A3           PIC X.
  6048         16  PM-SOC-SEC-NO.
  6049             20  PM-SSN-STATE           PIC XX.
  6050             20  PM-SSN-PRODUCER        PIC X(6).
  6051             20  PM-SSN-LN3.
  6052                 25  PM-INSURED-INITIALS-A3.
  6053                     30 PM-INSURED-INITIAL1-A3 PIC X.
  6054                     30 PM-INSURED-INITIAL2-A3 PIC X.
  6055                 25 PM-PART-LAST-NAME-A3      PIC X.
  6056         16  PM-DATE-A3                  PIC XX.
  6057         16  PM-TIME-A3                  PIC S9(04)   COMP.
  6058
  6059******************************************************************
  6060*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  6061******************************************************************
  6062
  6063     12  PM-CONTROL-BY-POLICY-NO.
  6064         16  PM-COMPANY-CD-A4           PIC X.
  6065         16  PM-POLICY-NO-A4.
  6066             20  PM-POLICY-PRIME-A4     PIC X(18).
  6067             20  PM-POLICY-SFX-A4       PIC XX.
  6068         16  PM-DATE-A4                 PIC XX.
  6069         16  PM-TIME-A4                 PIC S9(04)   COMP.
  6070
  6071******************************************************************
  6072*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  6073******************************************************************
  6074
  6075     12  PM-CONTROL-BY-ACCOUNT.
  6076         16  PM-COMPANY-CD-A5           PIC X.
  6077         16  PM-BANK-ACCOUNT-NUMBER     PIC X(20).
  6078         16  PM-DATE-A5                 PIC XX.
  6079         16  PM-TIME-A5                 PIC S9(07)   COMP.
  6080
  6081******************************************************************
  6082*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  6083******************************************************************
  6084
  6085     12  PM-CONTROL-BY-TRANSIT.
  6086         16  PM-COMPANY-CD-A6           PIC X.
  6087         16  PM-BANK-TRANSIT-NUMBER.
  6088             20  PM-FEDERAL-NUMBER      PIC X(4).
  6089             20  PM-BANK-NUMBER         PIC X(4).
  6090         16  PM-DATE-A6                 PIC XX.
  6091         16  PM-TIME-A6                 PIC S9(07)   COMP.
  6092
  6093******************************************************************
  6094*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  6095******************************************************************
  6096
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL150.cbl
  6097     12  PM-CONTROL-BY-LOAN-NO.
  6098         16  PM-COMPANY-CD-A7           PIC X.
  6099         16  PM-LOAN-NUMBER             PIC X(20).
  6100         16  PM-DATE-A7                 PIC XX.
  6101         16  PM-TIME-A7                 PIC S9(07)   COMP.
  6102
  6103******************************************************************
  6104*                 FILE SYNCHRONIZATION DATA                      *
  6105******************************************************************
  6106
  6107     12  FILLER                            PIC X(05).
  6108     12  PM-FILE-SYNCH-DATA.
  6109         16  PM-LAST-CHANGE-DT          PIC XX.
  6110         16  PM-LAST-CHANGE-TIME        PIC S9(7)    COMP.
  6111         16  PM-LAST-CHANGE-PROCESSOR   PIC X(4).
  6112     12  FILLER                            PIC X(05).
  6113
  6114******************************************************************
  6115*                    INSUREDS PROFILE DATA                       *
  6116******************************************************************
  6117
  6118     12  PM-INSURED-PROFILE-DATA.
  6119         16  PM-INSURED-NAME.
  6120             20  PM-INSURED-LAST-NAME  PIC X(15).
  6121             20  PM-INSURED-FIRST-NAME.
  6122                 24  PM-INSURED-1ST-INIT PIC X.
  6123                 24  FILLER               PIC X(9).
  6124             20  PM-INSURED-MIDDLE-INIT PIC X.
  6125         16  PM-INSURED-ADDRESS.
  6126             20  PM-ADDRESS-LINE-1      PIC X(30).
  6127             20  PM-ADDRESS-LINE-2      PIC X(30).
  6128             20  PM-CITY                PIC X(25).
  6129             20  PM-RESIDENT-STATE      PIC XX.
  6130             20  PM-ZIP-CD.
  6131                 24  PM-ZIP-FIRST-FIVE  PIC X(5).
  6132                 24  PM-ZIP-PLUS-FOUR   PIC X(4).
  6133         16  PM-INSURED-PERSONAL.
  6134             20  PM-INSURED-OCC-CLASS   PIC X.
  6135                 88  PM-PREFERRED         VALUE '1'.
  6136                 88  PM-STANDARD          VALUE '2'.
  6137                 88  PM-HAZARDOUS         VALUE '3'.
  6138                 88  PM-VERY-HAZARDOUS    VALUE '4'.
  6139                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  6140                 88  PM-NOT-OCC           VALUE '6'.
  6141                 88  PM-OCC-UNKNOWN       VALUE '9'.
  6142             20  PM-INSURED-OCC-CD      PIC X(3).
  6143             20  PM-INSURED-OCC-CD-NUM REDEFINES
  6144                 PM-INSURED-OCC-CD      PIC 9(3).
  6145             20  PM-INSURED-SEX         PIC X.
  6146                 88  PM-INSURED-SEX-MALE   VALUE 'M'.
  6147                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  6148             20  PM-INSURED-BIRTH-DT    PIC XX.
  6149             20  PM-INSURED-ISSUE-AGE   PIC S9(3)     COMP-3.
  6150             20  PM-INSURED-HEIGHT-FT   PIC S9(3)     COMP-3.
  6151             20  PM-INSURED-HEIGHT-IN   PIC S9(3)     COMP-3.
  6152             20  PM-INSURED-WEIGHT      PIC S9(3)     COMP-3.
  6153             20  PM-INSURED-BIRTH-STATE PIC XX.
  6154             20  PM-INSURED-PHONE-NO    PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL150.cbl
  6155             20  PM-INSURED-RATED-AGE   PIC S9(3)     COMP-3.
  6156         16  PM-INS-LANGUAGE-IND        PIC X(01).
  6157             88  PM-ENGLISH                        VALUE 'E'.
  6158             88  PM-FRENCH                         VALUE 'F'.
  6159             88  PM-SPANISH                        VALUE 'S'.
  6160         16  PM-INSURED-TOT-BENEFIT     PIC S9(7)V99  COMP-3.
  6161
  6162         16  PM-INSURED-AGE-IND         PIC X(01).
  6163             88  PM-INSURED-AGE-75-REACHED         VALUE 'Y'.
  6164     12  FILLER                            PIC X(13).
  6165
  6166******************************************************************
  6167*                JOINT INSUREDS PROFILE DATA                     *
  6168******************************************************************
  6169
  6170     12  PM-JOINT-PROFILE-DATA.
  6171         16  PM-JOINT-NAME.
  6172             20  PM-JOINT-LAST-NAME     PIC X(15).
  6173             20  PM-JOINT-FIRST-NAME.
  6174                 24  PM-JOINT-1ST-INIT  PIC X.
  6175                 24  FILLER                PIC X(9).
  6176             20  PM-JOINT-MIDDLE-INIT   PIC X.
  6177         16  PM-JOINT-SOC-SEC-NO.
  6178             20  PM-JT-SSN-STATE        PIC XX.
  6179             20  PM-JT-SSN-PRODUCER     PIC X(6).
  6180             20  PM-JT-SSN-LN3.
  6181                 25  PM-JT-INSURED-INITIALS-A3.
  6182                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  6183                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  6184                 25 PM-JT-PART-LAST-NAME-A3     PIC X.
  6185         16  PM-JOINT-PERSONAL.
  6186             20  PM-JOINT-OCC-CLASS     PIC X.
  6187                 88 PM-JNT-PREFERRED       VALUE '1'.
  6188                 88 PM-JNT-STANDARD        VALUE '2'.
  6189                 88 PM-JNT-HAZARDOUS       VALUE '3'.
  6190                 88 PM-JNT-VERY-HAZARDOUS  VALUE '4'.
  6191                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  6192                 88 PM-JNT-NOT-OCC         VALUE '6'.
  6193                 88 PM-JNT-OCC-UNKNOWN     VALUE '9'.
  6194             20  PM-JOINT-OCC-CD        PIC X(3).
  6195             20  PM-JOINT-SEX           PIC X.
  6196                 88  PM-JOINT-SEX-MALE     VALUE 'M'.
  6197                 88  PM-JOINT-SEX-FEMALE   VALUE 'F'.
  6198             20  PM-JOINT-BIRTH-DT      PIC XX.
  6199             20  PM-JOINT-ISSUE-AGE     PIC S9(3)     COMP-3.
  6200             20  PM-JOINT-HEIGHT-FT     PIC S9(3)     COMP-3.
  6201             20  PM-JOINT-HEIGHT-IN     PIC S9(3)     COMP-3.
  6202             20  PM-JOINT-WEIGHT        PIC S9(3)     COMP-3.
  6203             20  PM-JOINT-BIRTH-STATE   PIC XX.
  6204             20  PM-JOINT-RATED-AGE     PIC S9(3)     COMP-3.
  6205         16  PM-JOINT-TOT-BENEFIT       PIC S9(7)V99  COMP-3.
  6206         16  PM-JOINT-AGE-IND           PIC X(01).
  6207             88  PM-JOINT-AGE-75-REACHED           VALUE 'Y'.
  6208
  6209     12  FILLER                            PIC X(12).
  6210
  6211******************************************************************
  6212*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL150.cbl
  6213******************************************************************
  6214
  6215     12  PM-INS-COVERAGE-DATA.
  6216         16  PM-FREE-PERIOD             PIC S9(03)    COMP-3.
  6217         16  PM-LOAN-TERM               PIC S9(3)     COMP-3.
  6218         16  PM-LOAN-APR                PIC S9V9999   COMP-3.
  6219         16  PM-LOAN-DT                 PIC XX.
  6220         16  PM-LOAN-PYMT               PIC S9(5)V99  COMP-3.
  6221         16  PM-LOAN-BALC               PIC S9(7)V99  COMP-3.
  6222         16  PM-INS-BENEFIT-MONTHS      PIC S9(3)     COMP-3.
  6223         16  PM-INS-MONTH-BENEFIT       PIC S9(7)V99  COMP-3.
  6224         16  PM-INS-TOTAL-BENEFIT       PIC S9(7)V99  COMP-3.
  6225         16  PM-INS-PLAN-TYPE           PIC X.
  6226             88  PM-AH-MORT-PLAN           VALUE 'A'.
  6227             88  PM-AD-D-MORT-PLAN         VALUE 'E'.
  6228             88  PM-DISMEM-MORT-PLAN       VALUE 'D'.
  6229             88  PM-LIFE-MORT-PLAN         VALUE 'L'.
  6230         16  PM-INS-PLAN-CD             PIC XX.
  6231         16  PM-INS-PLAN-REVISION       PIC X(3).
  6232         16  PM-INS-POLICY-FORM         PIC X(12).
  6233         16  PM-INS-MSTR-POLICY.
  6234             20  PM-FREE-TYPE           PIC X(04).
  6235             20  FILLER                    PIC X(08).
  6236         16  PM-INS-MSTR-APP.
  6237             20  FILLER                    PIC X(11).
  6238             20  PM-INS-B-C-TYPE        PIC X(01).
  6239         16  PM-INS-RATE-CD             PIC X(5).
  6240         16  PM-INS-SEX-RATING          PIC X.
  6241             88  PM-NOT-SEX-RATED           VALUE '1'.
  6242             88  PM-SEX-RATED               VALUE '2'.
  6243         16  PM-INS-SUBSTANDARD-PCT     PIC S9V9999   COMP-3.
  6244         16  PM-INS-SUBSTANDARD-TYPE    PIC X.
  6245         16  PM-INS-TERMINATION-DT      PIC XX.
  6246         16  PM-INS-MONTH-PREMIUM   PIC S9(5)V999999  COMP-3.
  6247         16  PM-INS-CALC-MO-PREM    PIC S9(5)V999999  COMP-3.
  6248         16  PM-REINSURANCE-TABLE       PIC X(3).
  6249         16  PM-MORTALITY-CD            PIC X(4).
  6250         16  PM-INS-TYPE                PIC X.
  6251             88  PM-INDIVIDUAL             VALUES ARE '1' 'I'.
  6252             88  PM-GROUP                  VALUES ARE '2' 'G'.
  6253         16  PM-LOAN-OFFICER            PIC X(5).
  6254         16  PM-POLICY-FEE              PIC S9(3)V99 COMP-3.
  6255         16  PM-DEPENDENT-COUNT         PIC S99      COMP-3.
  6256         16  PM-CWA-AMOUNT              PIC S9(5)V99  COMP-3.
  6257         16  PM-LAST-AUTO-RERATE-DT     PIC XX.
  6258         16  PM-PREM-FINANCED-SW        PIC X.
  6259             88  PM-PREM-FINANCED           VALUE 'Y'.
  6260             88  PM-PREM-NOT-FINANCED       VALUE 'N'.
  6261
  6262         16  PM-INS-TERM-LETTER-IND     PIC X.
  6263             88  PM-TERM-INITIALIZED        VALUE 'Y'.
  6264         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99  COMP-3.
  6265     12  FILLER                            PIC X(11).
  6266
  6267******************************************************************
  6268*                    POLICY BILLING DATA                         *
  6269******************************************************************
  6270
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL150.cbl
  6271     12  PM-BILLING-DATA.
  6272         16  PM-BILLING-MODE            PIC X(1).
  6273             88  PM-ANNUAL                 VALUE '1'.
  6274             88  PM-SEMI-ANNUAL            VALUE '2'.
  6275             88  PM-QUARTERLY              VALUE '3'.
  6276             88  PM-MONTHLY                VALUE '4'.
  6277             88  PM-BI-MONTHLY             VALUE '5'.
  6278             88  PM-SINGLE-PREM            VALUE '6'.
  6279         16  PM-BILLING-SCHEDULE        PIC X(1).
  6280         16  PM-BILLING-SW              PIC X(1).
  6281             88  PM-FIRST-BILLING          VALUE 'Y'.
  6282             88  PM-PAID-IN-ADVANCE        VALUE 'A'.
  6283             88  PM-POLICY-FEE-REFUNDED    VALUE 'F'.
  6284         16  PM-BILLING-TYPE            PIC X(1).
  6285             88  PM-LIST-BILL              VALUE '1'.
  6286             88  PM-TAPE-BILL              VALUE '2'.
  6287             88  PM-TAPE-LIST-BILL         VALUE '3'.
  6288             88  PM-GROUP-BILL       VALUE ARE '1' '2' '3'.
  6289             88  PM-DIRECT-BILL            VALUE '4'.
  6290             88  PM-PAC-BILL         VALUE ARE '5' 'C' 'S'.
  6291             88  PM-CHARGE-CARD-BILL       VALUE '6'.
  6292             88  PM-INDIV-BILL
  6293                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  6294             88  PM-GRP-PLCY-BILL          VALUE '7'.
  6295             88  PM-GRP-PLCY-PAC           VALUE '8'.
  6296             88  PM-GRP-PLCY-CR-CRD        VALUE '9'.
  6297             88  PM-GRP-PLCY         VALUE ARE '7' '8' '9'.
  6298             88  PM-GRP-PROD               VALUE 'A'.
  6299             88  PM-EFT-CHECKING           VALUE 'C'.
  6300             88  PM-EFT-SAVINGS            VALUE 'S'.
  6301         16  PM-PAYMENT-AMT             PIC S9(5)V99  COMP-3.
  6302         16  PM-OVER-SHORT-AMT          PIC S9(5)V99  COMP-3.
  6303         16  PM-LAST-BILL-DT            PIC XX.
  6304         16  PM-LAST-BILL-AMT           PIC S9(5)V99  COMP-3.
  6305         16  PM-BILL-TO-DT              PIC XX.
  6306         16  PM-LAST-PYMT-DT            PIC XX.
  6307         16  PM-PAID-TO-DT              PIC XX.
  6308         16  PM-PYMT-INVOICE-NUMBER     PIC X(6).
  6309         16  PM-MONTHS-PAID             PIC S9(3)     COMP-3.
  6310         16  PM-TOTAL-PREM-RECVD        PIC S9(7)V99  COMP-3.
  6311         16  PM-BILLING-GROUPING-CODE   PIC X(6).
  6312         16  PM-CHARGE-CARD-EXP-DT      PIC X(2).
  6313         16  PM-CHARGE-CARD-TYPE        PIC X(2).
  6314             88  PM-VISA                   VALUE 'VI'.
  6315             88  PM-MSTR-CARD              VALUE 'MC'.
  6316             88  PM-DINERS-CLUB            VALUE 'DN'.
  6317             88  PM-DISCOVER               VALUE 'DS'.
  6318             88  PM-CARTE-BLANCHE          VALUE 'CB'.
  6319             88  PM-AMERICAN-EXPRESS       VALUE 'AE'.
  6320         16  PM-BILL-INVOICE-NUMBER     PIC X(6).
  6321         16  PM-BILL-DAY                PIC S99       COMP-3.
  6322         16  PM-RES-PREM-TAX        PIC S9(3)V999999  COMP-3.
  6323     12  FILLER                            PIC X(15).
  6324
  6325******************************************************************
  6326*                     CLAIM PAYMENT DATA                         *
  6327******************************************************************
  6328
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL150.cbl
  6329     12  PM-CLAIM-PAYMENT-DATA.
  6330         16  PM-CLAIM-BENEFICIARY-NAME  PIC X(25).
  6331         16  PM-CLAIM-INTERFACE-SW      PIC X.
  6332             88  PM-NO-CLAIM-ATTACHED      VALUE SPACE.
  6333             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  6334             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  6335             88  PM-CLAIM-CLOSED           VALUE '3'.
  6336             88  PM-ACTIVE-CLAIM           VALUE '1' '2'.
  6337             88  PM-CLAIM-ATTACHED         VALUE '1' '2' '3'.
  6338         16  PM-CLAIM-INCURRED-DT       PIC XX.
  6339         16  PM-CLAIM-PAID-TO-DT        PIC XX.
  6340         16  PM-CLAIM-PAYMENT-CNT       PIC S9(3)     COMP-3.
  6341         16  PM-CLAIM-LAST-PAYMENT-AMT  PIC S9(7)V99  COMP-3.
  6342         16  PM-CLAIM-EXPENSES-ITD      PIC S9(7)V99  COMP-3.
  6343         16  PM-CLAIM-PAYMENTS-ITD      PIC S9(7)V99  COMP-3.
  6344         16  PM-CLAIM-ACCUMULATOR       PIC S9(7)V99  COMP-3.
  6345         16  PM-CLAIM-ATTACH-CNT        PIC S9(3)     COMP-3.
  6346         16  PM-CLAIM-LIFE-ITD          PIC S9(7)V99  COMP-3.
  6347         16  PM-CLAIM-AH-ITD            PIC S9(7)V99  COMP-3.
  6348         16  PM-CLAIM-RIDER-ITD         PIC S9(7)V99  COMP-3.
  6349
  6350     12  FILLER                            PIC X(03).
  6351
  6352******************************************************************
  6353*                POLICY STATUS AND DISPOSITION                   *
  6354******************************************************************
  6355
  6356     12  PM-STATUS-DISPOSITION-DATA.
  6357         16  PM-ISSUE-EOM-DT            PIC XX.
  6358         16  PM-REPLACEMENT-SWITCH      PIC X.
  6359         16  PM-APPL-SIGN-DT            PIC XX.
  6360         16  PM-UNDERWRITER             PIC X(3).
  6361         16  PM-ENTRY-PROCESSOR         PIC X(4).
  6362         16  PM-ENTRY-STATUS            PIC X.
  6363             88  PM-NORMAL                 VALUE '1'.
  6364             88  PM-TAKE-OVER              VALUE '2'.
  6365             88  PM-CONVERSION             VALUE '4'.
  6366             88  PM-RE-ISSUE               VALUE '5'.
  6367             88  PM-REINSURANCE-ONLY       VALUE '9'.
  6368         16  PM-ENTRY-DT                PIC XX.
  6369         16  PM-ENTRY-TIME              PIC S9(7) COMP-3.
  6370         16  PM-EXIT-DT                 PIC XX.
  6371         16  PM-CURRENT-STATUS          PIC X.
  6372             88  PM-LAPSE                  VALUE '0'.
  6373             88  PM-ACTIVE                 VALUE '1'.
  6374             88  PM-PENDING-ISSUE          VALUE '2'.
  6375             88  PM-DECLINED               VALUE '3'.
  6376             88  PM-PENDING-CANCEL         VALUE '4'.
  6377             88  PM-PENDING-ISSUE-ERROR    VALUE '5'.
  6378             88  PM-CLAIM-APPLIED          VALUE '6'.
  6379             88  PM-CANCEL                 VALUE '7'.
  6380             88  PM-PENDING-UNWTR-REVW     VALUE '8'.
  6381             88  PM-PENDING-CANCEL-ERROR   VALUE '9'.
  6382             88  PM-CANCEL-TRANSFER        VALUE 'C'.
  6383             88  PM-CLAIM-SETTLEMENT       VALUE 'F'.
  6384             88  PM-TERMINATE              VALUE 'T'.
  6385** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  6386** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL150.cbl
  6387** THESE GROUPS.
  6388             88  PM-TYPE-STAT-1
  6389                     VALUES ARE '0' '1' '4' '6' '7' '9'
  6390                                'C' 'F' 'T'.
  6391             88  PM-TYPE-STAT-2
  6392                     VALUES ARE '2' '3' '5' '8'.
  6393             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  6394             88  PM-PENDING-STATUS
  6395                                VALUES ARE '2' '4' '5' '8' '9'.
  6396             88  PM-PENDING-ISSUE-STATUS
  6397                                VALUES ARE '2' '5' '8'.
  6398             88  PM-CANCEL-STATUS
  6399                                VALUES ARE '4' '7' '9' 'C'.
  6400         16  PM-CANCEL-CAUSE-CD         PIC X(3).
  6401         16  PM-CANCEL-DT               PIC XX.
  6402         16  PM-REFUND-AMT              PIC S9(5)V99  COMP-3.
  6403         16  PM-CALC-REFUND-AMT         PIC S9(5)V99  COMP-3.
  6404         16  PM-DECLINE-CD              PIC X(3).
  6405         16  PM-DECLINE-DT              PIC XX.
  6406         16  PM-LAST-LAPSE-DT           PIC XX.
  6407         16  PM-LAST-REINSTATE-DT       PIC XX.
  6408         16  PM-SECURITY-ACCESS-CODE    PIC X.
  6409         16  PM-PREV-CONTROL-PRIMARY.
  6410             20  PM-PREV-COMPANY-CD          PIC X.
  6411             20  PM-PREV-CARRIER             PIC X.
  6412             20  PM-PREV-GROUPING.
  6413                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  6414                 24  PM-PREV-GROUPING-PRIME  PIC X(3).
  6415             20  PM-PREV-STATE               PIC XX.
  6416             20  PM-PREV-PRODUCER.
  6417                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6418                 24  PM-PREV-PRODUCER-PRIME  PIC X(6).
  6419             20  PM-PREV-POLICY-EFF-DT       PIC XX.
  6420             20  PM-PREV-REFERENCE-NUMBER.
  6421                 24  PM-PREV-REFNO-PRIME     PIC X(18).
  6422                 24  PM-PREV-REFNO-SFX       PIC XX.
  6423         16  PM-ACTION-DT               PIC XX.
  6424         16  PM-ACTION-CODE             PIC X(3).
  6425         16  PM-ACTION-DT-2             PIC XX.
  6426         16  PM-ACTION-CODE-2           PIC X(3).
  6427         16  PM-ACTION-DT-3             PIC XX.
  6428         16  PM-ACTION-CODE-3           PIC X(3).
  6429         16  PM-ACTION-DT-4             PIC XX.
  6430         16  PM-ACTION-CODE-4           PIC X(3).
  6431         16  PM-ACTION-DT-5             PIC XX.
  6432         16  PM-ACTION-CODE-5           PIC X(3).
  6433
  6434         16  PM-KEY-CHANGE              PIC X.
  6435                 88  PM-NO-KEY-CHG   VALUES ARE ' ' 'N'.
  6436                 88  PM-KEY-CHG           VALUE 'Y'.
  6437         16  PM-KEY-CHANGE-DT           PIC XX.
  6438
  6439         16  PM-RTI-INDICATOR           PIC X.
  6440         16  PM-REASON-CODE             PIC X(3).
  6441         16  PM-IN-OUT-PROCESSING-IND   PIC X(1).
  6442             88  PM-IN-OUT-PROCESSING   VALUE 'Y'.
  6443             88  PM-NOT-IN-OUT-PROCESSING
  6444                                           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL150.cbl
  6445
  6446     12  FILLER                            PIC X(12).
  6447
  6448******************************************************************
  6449*                 AGENT AND COMMISSION DATA                      *
  6450******************************************************************
  6451
  6452     12  PM-COMMISSION-DATA.
  6453         16  PM-REMIT-TO                PIC S9(3) COMP-3.
  6454         16  PM-COMM-CHANGE-SW          PIC X.
  6455                 88  PM-COMMISSION-CHANGE  VALUE 'Y'.
  6456         16  PM-AGENT-INFORMATION OCCURS  5 TIMES.
  6457             20  PM-AGENT-NUMBER        PIC X(10).
  6458             20  PM-AGENT-TYPE          PIC X.
  6459                 88  PM-PRODUCER-LEVEL-AGENT
  6460                                              VALUES ARE 'C' 'D'.
  6461                 88  PM-AGENT-GROSS        VALUE 'C'.
  6462                 88  PM-AGENT-REINS        VALUE 'R'.
  6463                 88  PM-AGENT-GROSS-REINS  VALUE 'D'.
  6464                 88  PM-OVERWRITE-GROSS    VALUE 'O'.
  6465                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6466                 88  PM-OVERWRITE-REINS    VALUE 'T'.
  6467                 88  PM-REINS-ONLY         VALUE 'W'.
  6468             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6469                 88  PM-GENERATE-BILL      VALUE 'B'.
  6470                 88  PM-GENERATE-PAID      VALUE 'P'.
  6471             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6472             20  PM-COMP-1ST-YEAR-TYPE  PIC X(1).
  6473                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6474                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6475                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6476             20  PM-RENEWAL-DATA.
  6477                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6478                     28  PM-RENEW-MONTHS  PIC S999    COMP-3.
  6479                     28  PM-RENEW-COMMISSION
  6480                                             PIC S99V999 COMP-3.
  6481                     28  PM-RENEW-TYPE    PIC X(1).
  6482                         88  PM-COMP-RENEW-PERCENT   VALUE '1'.
  6483                         88  PM-COMP-RENEW-DOLLARS   VALUE '2'.
  6484                         88  PM-COMP-RENEW-NOT-USED  VALUE '3'.
  6485             20  PM-COMP-RECALC-FLAG    PIC X(1).
  6486                 88  PM-BYPASS-RECALC      VALUE 'N'.
  6487     12  FILLER                            PIC X(20).
  6488******************************************************************
  6489*             CUSTOMER DATA                                      *
  6490******************************************************************
  6491     12  PM-CUSTOMER-ID                 PIC X(20).
  6492******************************************************************
  6493     12  FILLER                            PIC X(43).
  6494******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL150.cbl
  6496*                COPY MTCPLAN REPLACING ==:TAG:== BY ==PP==.
  6497******************************************************************
  6498*                                                                *
  6499*                            MTCPLAN                             *
  6500*                            VMOD=1.001                          *
  6501*                                                                *
  6502*   MORTGAGE SYSTEM PRODUCER PLAN MASTER FILE.                   *
  6503*                                                                *
  6504*   THIS COPYBOOK IS USED FOR THE ONLINE                         *
  6505*   PLAN CODE MASTER FILE.                                       *
  6506*                                                                *
  6507*   FILE DESCRIPTION = PRODUCER PLAN MASTER                      *
  6508*                                                                *
  6509*   FILE TYPE = VSAM,KSDS                                        *
  6510*   RECORD SIZE = 450  RECFORM = FIX                             *
  6511*                                                                *
  6512*   BASE CLUSTER NAME = MPPLAN                    RKP=2,LEN=25   *
  6513*       ALTERNATE PATH1 = MPPLAN2 (ALT GROUPING) RKP=47,LEN=25   *
  6514*                                                                *
  6515*   LOG = NO                                                     *
  6516*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6517*                                                                *
  6518*                                                                *
  6519******************************************************************
  6520
  6521 01  PRODUCER-PLANS.
  6522     12  PP-RECORD-ID                   PIC  X(02).
  6523         88  VALID-PP-ID                      VALUE 'PP'.
  6524
  6525******************************************************************
  6526*   BASE CLUSTER NAME = MPPLAN                    RKP=2,LEN=25   *
  6527******************************************************************
  6528
  6529     12  PP-CONTROL-PRIMARY.
  6530         16  PP-PROD-PRIMARY.
  6531             20  PP-COMPANY-CD          PIC  X(01).
  6532             20  PP-CONTROL-A.
  6533                 24  PP-CARRIER         PIC  X(01).
  6534                 24  PP-GROUPING.
  6535                     28  PP-GROUPING-PREFIX
  6536                                           PIC  X(03).
  6537                     28  PP-GROUPING-PRIME PIC X(03).
  6538                 24  PP-STATE           PIC  X(02).
  6539                 24  PP-PRODUCER.
  6540                     28  PP-PRODUCER-PREFIX
  6541                                           PIC  X(04).
  6542                     28  PP-PRODUCER-PRIME PIC X(06).
  6543         16  PP-PRODUCER-PLAN.
  6544             20  PP-PLAN-CODE           PIC  X(02).
  6545             20  PP-PLAN-REVISION       PIC  9(03).
  6546     12  FILLER                            PIC  X(20).
  6547
  6548******************************************************************
  6549*      ALTERNATE PATH1 = MPPLAN2 (ALT GROUPING) RKP=47,LEN=25    *
  6550******************************************************************
  6551
  6552     12  PP-CONTROL-BY-VAR-GRP.
  6553         16  PP-COMPANY-CD-A1           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL150.cbl
  6554         16  PP-VG-CARRIER              PIC  X(01).
  6555         16  PP-VG-GROUPING             PIC  X(06).
  6556         16  PP-VG-STATE                PIC  X(02).
  6557         16  PP-VG-PRODUCER             PIC  X(10).
  6558         16  PP-VG-PLAN-CODE            PIC  X(02).
  6559         16  PP-VG-PLAN-REVISION        PIC  X(03).
  6560     12  FILLER                            PIC  X(20).
  6561
  6562******************************************************************
  6563*                PRODUCER SECURITY DATA                          *
  6564******************************************************************
  6565
  6566     12  PP-SECURITY-ACCESS-CODE        PIC  X(01).
  6567     12  PP-POLICY-CNT                  PIC S9(07)    COMP-3.
  6568
  6569******************************************************************
  6570*                FILE SYNCHRONIZATION DATA                       *
  6571******************************************************************
  6572
  6573     12  PP-MAINT-INFORMATION.
  6574         16  PP-LAST-MAINT-DATE         PIC  X(02).
  6575         16  PP-LAST-MAINT-HHMMSS       PIC S9(07)    COMP-3.
  6576         16  PP-LAST-MAINT-USER         PIC  X(04).
  6577     12  FILLER                            PIC  X(10).
  6578
  6579******************************************************************
  6580*                   CRITICAL FILE DATES                          *
  6581******************************************************************
  6582
  6583     12  PP-PLAN-DATES.
  6584         16  PP-PLAN-EFFECT-DATE        PIC  X(02).
  6585         16  PP-PLAN-EXPIRE-DATE        PIC  X(02).
  6586
  6587     12  FILLER                            PIC  X(10).
  6588
  6589******************************************************************
  6590*                GENERAL INFORMATION                             *
  6591******************************************************************
  6592
  6593     12  PP-GENERAL-INFORMATION.
  6594         16  PP-ALPHA-SEARCH-SW         PIC  X(01).
  6595             88  PP-MIB-ALPHA-ALL           VALUE '1'.
  6596             88  PP-MIB-ALPHA-NONE          VALUE '2'.
  6597             88  PP-MIB-ALPHA-EXCEEDED      VALUE '3'.
  6598             88  PP-CLIENT-ALPHA-ALL        VALUE 'A'.
  6599             88  PP-CLIENT-ALPHA-NONE       VALUE 'B'.
  6600             88  PP-CLIENT-ALPHA-EXCEEDED   VALUE 'C'.
  6601             88  PP-BOTH-ALPHA-ALL          VALUE 'X'.
  6602             88  PP-BOTH-ALPHA-NONE         VALUE 'Y'.
  6603             88  PP-BOTH-ALPHA-EXCEEDED     VALUE 'Z'.
  6604             88  PP-ALPHA-SEARCH-VALID VALUES ARE '1' '2' '3'
  6605                                                     'A' 'B' 'C'
  6606                                                     'X' 'Y' 'Z'.
  6607         16  PP-BENEFIT-TYPE            PIC  X(01).
  6608             88  PP-BENEFIT-IS-LEVEL         VALUE '1'.
  6609             88  PP-BENEFIT-REDUCES          VALUE '2'.
  6610         16  PP-DAYS-TO-1ST-NOTICE      PIC  9(02).
  6611         16  PP-DAYS-TO-2ND-NOTICE      PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL150.cbl
  6612         16  PP-DAYS-TO-3RD-NOTICE      PIC  9(02).
  6613         16  PP-DAYS-TO-4TH-NOTICE      PIC  9(02).
  6614         16  PP-EFF-DT-RULE-SW          PIC  X(01).
  6615             88  PP-EFF-DT-ENTER            VALUE 'E'.
  6616             88  PP-EFF-DT-MONTH            VALUE 'M'.
  6617             88  PP-EFF-DT-QTR              VALUE 'Q'.
  6618             88  PP-EFF-DT-SEMI             VALUE 'S'.
  6619             88  PP-EFF-DT-ANN              VALUE 'A'.
  6620         16  PP-FREE-EXAM-DAYS          PIC S9(03)   COMP-3.
  6621         16  PP-GRACE-PERIOD            PIC S9(03)   COMP-3.
  6622         16  PP-HEALTH-QUESTIONS        PIC  9(01).
  6623         16  PP-NUMBER-LAPSE-NOTICES    PIC S9(03)   COMP-3.
  6624         16  PP-MIB-SEARCH-SW           PIC  X(01).
  6625             88  PP-MIB-SEARCH-ALL          VALUE '1'.
  6626             88  PP-MIB-SEARCH-NONE         VALUE '2'.
  6627             88  PP-MIB-SEARCH-EXCEEDED     VALUE '3'.
  6628             88  PP-MIB-SEARCH-VALID   VALUES ARE '1' '2' '3'.
  6629         16  PP-PLAN-ABBREV             PIC  X(03).
  6630         16  PP-PLAN-AGES.
  6631             20  PP-MINIMUM-AGE         PIC S9(03)   COMP-3.
  6632             20  PP-MAXIMUM-AGE         PIC S9(03)   COMP-3.
  6633             20  PP-MAXIMUM-ATTAIN-AGE  PIC S9(03)   COMP-3.
  6634         16  PP-PLAN-BENEFITS.
  6635             20  PP-CLAIM-CAP           PIC S9(07)V99 COMP-3.
  6636             20  PP-MINIMUM-BENEFIT     PIC S9(07)V99 COMP-3.
  6637             20  PP-MAXIMUM-BENEFIT     PIC S9(07)V99 COMP-3.
  6638             20  PP-MAXIMUM-MONTHLY-BENEFIT
  6639                                           PIC S9(07)V99 COMP-3.
  6640         16  PP-PLAN-DESCRIPTION        PIC  X(10).
  6641         16  PP-POLICY-FEE              PIC S9(03)V9(02)
  6642                                                        COMP-3.
  6643         16  PP-PLAN-IND-GRP            PIC  X(01).
  6644         16  PP-PLAN-SNGL-JNT           PIC  X(01).
  6645             88  PP-COMBINED-PLAN          VALUE 'C'.
  6646             88  PP-JNT-PLAN               VALUE 'J'.
  6647             88  PP-SNGL-PLAN              VALUE 'S'.
  6648         16  PP-PLAN-TERMS.
  6649             20  PP-MINIMUM-TERM        PIC S9(03)   COMP-3.
  6650             20  PP-MAXIMUM-TERM        PIC S9(03)   COMP-3.
  6651         16  PP-PLAN-TYPE               PIC  X(01).
  6652             88  PP-AH-MORT-PLAN           VALUE 'A'.
  6653             88  PP-AD-D-MORT-PLAN         VALUE 'E'.
  6654             88  PP-DISMEM-MORT-PLAN       VALUE 'D'.
  6655             88  PP-LIFE-MORT-PLAN         VALUE 'L'.
  6656         16  PP-PREMIUM-TOLERANCES.
  6657             20  PP-PREM-TOLERANCE      PIC S9(03)   COMP-3.
  6658             20  PP-PREM-TOLERANCE-PCT  PIC SV9(03)  COMP-3.
  6659         16  PP-RATE-CODE               PIC  X(05).
  6660         16  PP-REOCCURRING-DISABILITY-PRD PIC S9(03) COMP-3.
  6661         16  PP-REPLACEMENT-LAW-SW      PIC  X(01).
  6662             88  PP-NO-REPLACE             VALUE '1'.
  6663             88  PP-REPLACE-APPLIES        VALUE '2'.
  6664             88  PP-VALID-REPLACEMENT-LAW  VALUE '1' '2'.
  6665         16  PP-RETRO-RETENTION         PIC S9V9(04) COMP-3.
  6666         16  PP-RERATE-CNTL             PIC  X(01).
  6667             88  PP-RERATE-WITH-ISSUE-AGE    VALUE '1'.
  6668             88  PP-RERATE-WITH-CURRENT-AGE  VALUE '2'.
  6669             88  PP-DO-NOT-RERATE            VALUE '3' ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL150.cbl
  6670             88  PP-AUTO-RECALC              VALUE '4'.
  6671         16  PP-SEX-RATING              PIC  X(01).
  6672             88  PP-NOT-SEX-RATED          VALUE '1'.
  6673             88  PP-SEX-RATED              VALUE '2'.
  6674         16  PP-SUBSTANDARD-DATA.
  6675             20  PP-SUBSTANDARD-PERCENT PIC S9(01)V9(04).
  6676             20  PP-SUBSTANDARD-TYPE    PIC  X(01).
  6677                 88  PP-PCT-OF-BENEFIT     VALUE '1'.
  6678                 88  PP-PCT-OF-PREMIUM     VALUE '2'.
  6679                 88  PP-NOT-APPLICABLE     VALUE '3'.
  6680         16  PP-YEARS-TO-NEXT-RERATE    PIC  9(02).
  6681         16  PP-DEPENDANT-COVERAGE      PIC  X(01).
  6682             88  PP-DEP-COVERED            VALUE 'Y'.
  6683             88  PP-DEP-NOT-COVERED        VALUE 'N' ' '.
  6684         16  PP-REFUND-CALC             PIC  X(01).
  6685             88  PP-RFND-MP-REFUND  VALUES ARE ' ' LOW-VALUES.
  6686             88  PP-RFND-BY-R78            VALUE '1'.
  6687             88  PP-RFND-BY-PRO-RATA       VALUE '2'.
  6688             88  PP-RFND-AS-CALIF          VALUE '3'.
  6689             88  PP-RFND-AS-TEXAS          VALUE '4'.
  6690             88  PP-RFND-IS-NET-PAY        VALUE '5'.
  6691             88  PP-RFND-ANTICIPATION      VALUE '6'.
  6692             88  PP-RFND-MEAN              VALUE '8'.
  6693             88  PP-VALID-REFUND    VALUES ARE ' ' '1' '2' '3'
  6694                                                  '4' '5' '6' '8'
  6695                                                  LOW-VALUES.
  6696         16  PP-ALT-RATE-CODE           PIC  X(05).
  6697
  6698     12  FILLER                            PIC  X(39).
  6699
  6700******************************************************************
  6701*                     PLAN FORMS AND LETTERS                     *
  6702******************************************************************
  6703
  6704     12  PP-PLAN-MASTER-FORMS.
  6705         16  PP-POLICY-FORM             PIC  X(12).
  6706         16  PP-MASTER-APPLICATION      PIC  X(12).
  6707         16  PP-MASTER-POLICY           PIC  X(12).
  6708     12  PP-DELINQUENCY-NOTICE-FORMS.
  6709         16  PP-1ST-NOTICE-FORM         PIC  X(04).
  6710         16  PP-2ND-NOTICE-FORM         PIC  X(04).
  6711         16  PP-3RD-NOTICE-FORM         PIC  X(04).
  6712         16  PP-4TH-NOTICE-FORM         PIC  X(04).
  6713     12  FILLER                            PIC  X(32).
  6714     12  PP-TERMINATION-FORM            PIC  X(04).
  6715     12  FILLER                            PIC  X(08).
  6716     12  PP-ISSUE-LETTER                PIC  X(04).
  6717
  6718     12  FILLER                            PIC  X(80).
  6719******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL150.cbl
  6721*                COPY MTCPROD REPLACING ==:TAG:== BY ==PD==.
  6722******************************************************************
  6723*                                                                *
  6724*                            MTCPROD                             *
  6725*                            VMOD=1.001                          *
  6726*                                                                *
  6727*   MORTGAGE SYSTEM PRODUCER MASTER FILE                         *
  6728*                                                                *
  6729*   THIS COPYBOOK IS USED FOR THE ONLINE                         *
  6730*   VSAM PRODUCER MASTER FILE.                                   *
  6731*                                                                *
  6732*   FILE DESCRIPTION = PRODUCER MASTER FILE                      *
  6733*                                                                *
  6734*   FILE TYPE = VSAM,KSDS                                        *
  6735*   RECORD SIZE = 2000 RECFORM = FIXED                           *
  6736*                                                                *
  6737*   BASE CLUSTER NAME = MPPROD                    RKP=02,LEN=22  *
  6738*       ALTERNATE PATH1 = MPPROD2 (ALT GROUPING)  RKP=48,LEN=22  *
  6739*       ALTERNATE PATH2 = MPPROD3 (PRODUCER NAME) RKP=90,LEN=56  *
  6740*                                                                *
  6741*   LOG = NO                                                     *
  6742*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6743*                                                                *
  6744*                                                                *
  6745******************************************************************
  6746
  6747 01  PRODUCER-MASTER.
  6748     12  PD-RECORD-ID              PIC  X(02).
  6749         88  PD-VALID-ID                VALUE 'PD'.
  6750
  6751******************************************************************
  6752*   BASE CLUSTER NAME = MPPROD                    RKP=2,LEN=22   *
  6753******************************************************************
  6754
  6755     12  PD-CONTROL-PRIMARY-BATCH.
  6756         16  FILLER                   PIC  X(20).
  6757         16  PD-EXPIRE-DT.
  6758             20  PD-EXPIRE-DT-YY   PIC  9(02).
  6759             20  PD-EXPIRE-DT-MM   PIC  9(02).
  6760             20  PD-EXPIRE-DT-DD   PIC  9(02).
  6761     12  FILLER REDEFINES PD-CONTROL-PRIMARY-BATCH.
  6762         16  PD-CONTROL-PRIMARY.
  6763             20  PD-COMPANY-CD     PIC  X(01).
  6764             20  PD-MSTR-CNTRL.
  6765                 24  PD-CONTROL-A.
  6766                     28  PD-CARRIER PIC X(01).
  6767                     28  PD-GROUPING.
  6768                         32 PD-GROUPING-PREFIX
  6769                                      PIC  X(03).
  6770                         32 PD-GROUPING-PRIME
  6771                                      PIC  X(03).
  6772                     28  PD-STATE  PIC  X(02).
  6773                     28  PD-PRODUCER.
  6774                         32  PD-PRODUCER-PREFIX
  6775                                      PIC  X(04).
  6776                         32  PD-PRODUCER-PRIME
  6777                                      PIC  X(06).
  6778                 24  PD-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL150.cbl
  6779                     28  PD-EXPIRE-DATE
  6780                                      PIC  X(02).
  6781         16  FILLER REDEFINES PD-CONTROL-PRIMARY.
  6782             20  FILLER               PIC  X(01).
  6783             20  PD-CGSPE-KEY      PIC  X(21).
  6784         16  FILLER                   PIC  X(04).
  6785     12  FILLER                       PIC  X(20).
  6786
  6787******************************************************************
  6788*      ALTERNATE PATH1 = MPPROD2 (ALT GROUPING) RKP=48,LEN=22    *
  6789******************************************************************
  6790
  6791     12  PD-CONTROL-BY-VAR-GRP.
  6792         16  PD-VG-CCGSP-KEYLET.
  6793             20  PD-COMPANY-CD-A1  PIC  X(01).
  6794             20  PD-VG-CARRIER     PIC  X(01).
  6795             20  PD-VG-GROUPING    PIC  X(06).
  6796             20  PD-VG-STATE       PIC  X(02).
  6797             20  PD-VG-PRODUCER    PIC  X(10).
  6798         16  PD-VG-DATE.
  6799             24  PD-VG-EXPIRE-DATE PIC  X(02).
  6800     12  FILLER                       PIC  X(20).
  6801
  6802
  6803******************************************************************
  6804*      ALTERNATE PATH2 = MPPROD3 (NAME)         RKP=90,LEN=56    *
  6805******************************************************************
  6806
  6807     12  PD-CONTROL-BY-NAME.
  6808         16  PD-COMPANY-CD-A2      PIC  X(01).
  6809         16  PD-NAME-A2            PIC  X(30).
  6810         16  PD-CGSPE-KEY-A2.
  6811             20  PD-CARRIER-A2     PIC  X(01).
  6812             20  PD-GROUPING-A2    PIC  X(06).
  6813             20  PD-STATE-A2       PIC  X(02).
  6814             20  PD-PRODUCER-A2    PIC  X(10).
  6815             20  PD-EXPIRE-DATE-A2 PIC  X(02).
  6816         16  PD-CURRENT-DATE-BIN-A2 PIC X(02).
  6817         16  PD-CURRENT-TIME-BIN-A2 PIC S9(04) COMP.
  6818     12  FILLER                       PIC  X(20).
  6819
  6820******************************************************************
  6821*                FILE SYNCHRONIZATION DATA                       *
  6822******************************************************************
  6823
  6824     12  PD-MAINT-INFORMATION.
  6825         16  PD-LAST-MAINT-DATE    PIC  X(02).
  6826         16  PD-LAST-MAINT-HHMMSS  PIC S9(07) COMP-3.
  6827         16  PD-LAST-MAINT-USER    PIC  X(04).
  6828
  6829******************************************************************
  6830*                PRODUCER SECURITY DATA                          *
  6831******************************************************************
  6832
  6833     12  PD-SECURITY-ACCESS-CODE   PIC  X(01).
  6834
  6835******************************************************************
  6836*                DATES                                           *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL150.cbl
  6837******************************************************************
  6838
  6839     12  PD-ANNIVERSARY-DATE       PIC  X(02).
  6840
  6841     12  PD-AR-HI-DATE.
  6842         16  PD-AR-HI-POLICY-DATE  PIC  X(02).
  6843         16  FILLER                   PIC  X(04).
  6844     12  PD-AR-HI-POLICY-DT REDEFINES PD-AR-HI-DATE.
  6845         16  PD-AR-HI-POLICY-DT-YY PIC  9(02).
  6846         16  PD-AR-HI-POLICY-DT-MM PIC  9(02).
  6847         16  PD-AR-HI-POLICY-DT-DD PIC  9(02).
  6848
  6849     12  PD-ENTRY-DATE             PIC  X(02).
  6850
  6851     12  PD-EFFECT-DTE.
  6852         16  PD-EFFECT-DATE        PIC  X(02).
  6853         16  FILLER                   PIC  X(04).
  6854     12  PD-EFFECT-DT REDEFINES PD-EFFECT-DTE.
  6855         16  PD-EFFECT-DT-YY       PIC  9(02).
  6856         16  PD-EFFECT-DT-MM       PIC  9(02).
  6857         16  PD-EFFECT-DT-DD       PIC  9(02).
  6858
  6859     12  PD-HI-DATE.
  6860         16  PD-HI-POLICY-DATE     PIC  X(02).
  6861         16  FILLER                   PIC  X(04).
  6862     12  PD-HI-POLICY-DT REDEFINES PD-HI-DATE.
  6863         16  PD-HI-POLICY-DT-YY    PIC  9(02).
  6864         16  PD-HI-POLICY-DT-MM    PIC  9(02).
  6865         16  PD-HI-POLICY-DT-DD    PIC  9(02).
  6866
  6867     12  PD-INACTIVE-DATE          PIC  X(02).
  6868
  6869     12  PD-LO-DATE.
  6870         16  PD-LO-POLICY-DATE     PIC  X(02).
  6871         16  FILLER                   PIC  X(04).
  6872     12  PD-LO-POLICY-DT REDEFINES PD-LO-DATE.
  6873         16  PD-LO-POLICY-DT-YY    PIC  9(02).
  6874         16  PD-LO-POLICY-DT-MM    PIC  9(02).
  6875         16  PD-LO-POLICY-DT-DD    PIC  9(02).
  6876
  6877     12  PD-POLICIES-PURGED-DATE   PIC  X(02).
  6878
  6879     12  PD-PREV-DATES.
  6880         16  PD-PREV-EFF-DATE      PIC  X(02).
  6881         16  FILLER                   PIC  X(04).
  6882         16  PD-PREV-EXP-DATE      PIC  X(02).
  6883         16  FILLER                   PIC  X(04).
  6884     12  PD-PREV-DTS REDEFINES PD-PREV-DATES.
  6885         16  PD-PREV-EFF-DT.
  6886             20  PD-PREV-EFF-DT-YY PIC  9(02).
  6887             20  PD-PREV-EFF-DT-MM PIC  9(02).
  6888             20  PD-PREV-EFF-DT-DD PIC  9(02).
  6889         16  PD-PREV-EXP-DT.
  6890             20  PD-PREV-EXP-DT-YY PIC  9(02).
  6891             20  PD-PREV-EXP-DT-MM PIC  9(02).
  6892             20  PD-PREV-EXP-DT-DD PIC  9(02).
  6893
  6894     12  PD-1ST-PROD-DATE          PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL150.cbl
  6895
  6896     12  FILLER                       PIC  X(20).
  6897
  6898******************************************************************
  6899*                MORTGAGE BILLING DATA                           *
  6900******************************************************************
  6901
  6902     12  PD-CONTACT                PIC  X(30).
  6903     12  PD-BILLING-MONTHS.
  6904         16  PD-BILLING-MONTH-ANNUAL PIC 9(02).
  6905         16  PD-BILLING-MONTH-SEMIANN PIC 9(02).
  6906     12  PD-BILLING-ADVANCE-ARREARS PIC X(01).
  6907         88  PD-BILL-ADVANCE           VALUE '1'.
  6908         88  PD-BILL-ARREARS           VALUE '2'.
  6909     12  PD-BILLING-MODE           PIC  X(01).
  6910         88  PD-ANNUAL-BILL            VALUE '1'.
  6911         88  PD-SEMI-ANNUAL-BILL       VALUE '2'.
  6912         88  PD-QUARTERLY-BILL         VALUE '3'.
  6913         88  PD-MONTHLY-BILL           VALUE '4'.
  6914         88  PD-BI-MONTHLY-BILL        VALUE '5'.
  6915         88  PD-SINGLE-PREM-BILL       VALUE '6'.
  6916     12  PD-BILLING-GROUPING-CODE  PIC  X(06).
  6917     12  PD-BILLING-SCHEDULE       PIC  X(01).
  6918         88  PD-BILL-1ST-WEEK          VALUE '1'.
  6919         88  PD-BILL-2ND-WEEK          VALUE '2'.
  6920         88  PD-BILL-3RD-WEEK          VALUE '3'.
  6921         88  PD-BILL-4TH-WEEK          VALUE '4'.
  6922         88  PD-BILL-5TH-WEEK          VALUE '5'.
  6923         88  PD-HOLD-BILL              VALUE '6'.
  6924         88  PD-NO-BILL                VALUE '7'.
  6925     12  PD-BILLING-SEQUENCE       PIC  X(01).
  6926         88  PD-BILL-NAME-SEQU         VALUE '1'.
  6927         88  PD-BILL-LOAN-SEQU         VALUE '2'.
  6928         88  PD-BILL-PLCY-SEQU         VALUE '3'.
  6929     12  PD-BILLING-TYPE           PIC  X(01).
  6930         88  PD-LIST-BILL              VALUE '1'.
  6931         88  PD-TAPE-BILL              VALUE '2'.
  6932         88  PD-TAPE-LIST-BILL         VALUE '3'.
  6933         88  PD-GROUP-BILL         VALUES ARE '1' '2' '3'.
  6934         88  PD-DIRECT-BILL            VALUE '4'.
  6935         88  PD-PAC                VALUES ARE '5' 'C' 'S'.
  6936         88  PD-CREDIT-CARD            VALUE '6'.
  6937         88  PD-INDIV-BILL
  6938                              VALUES ARE '4' '5' '6' 'C' 'S'.
  6939         88  PD-GROUP-BY-POLICY        VALUE '7'.
  6940         88  PD-GROUP-BY-POLICY-PAC    VALUE '8'.
  6941         88  PD-GROUP-BY-POLICY-CRDC   VALUE '9'.
  6942         88  PD-GROUP-BY-BILL          VALUE '7' '8' '9'.
  6943         88  PD-GROUP-BY-PROD          VALUE 'A'.
  6944         88  PD-EFT-CHECKING           VALUE 'C'.
  6945         88  PD-EFT-SAVINGS            VALUE 'S'.
  6946     12  PD-DATE-PAID              PIC  X(02).
  6947     12  PD-LAST-BILLING-DATE      PIC  X(02).
  6948     12  PD-LAST-BILL-TO-DATE      PIC  X(02).
  6949     12  PD-MAX-MONTHS-BILL        PIC S9(03)  COMP-3.
  6950     12  PD-PAID-TO-DATE           PIC  X(02).
  6951     12  PD-PREV-BILLING-DATE      PIC  X(02).
  6952     12  PD-PREV-BILL-TO-DATE      PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL150.cbl
  6953
  6954     12  FILLER                       PIC  X(20).
  6955
  6956******************************************************************
  6957*                PERSONAL DATA                                   *
  6958******************************************************************
  6959
  6960     12  PD-ADDRS                  PIC  X(30).
  6961     12  PD-CITY                   PIC  X(30).
  6962     12  PD-CITY-CODE              PIC  X(04).
  6963     12  PD-COUNTY-CODE            PIC  X(03).
  6964     12  PD-NAME                   PIC  X(30).
  6965     12  PD-PARRISH-CODE           PIC  X(03).
  6966     12  PD-PERSON                 PIC  X(30).
  6967     12  PD-TEL-NO.
  6968         16  PD-AREA-CODE          PIC  9(03).
  6969         16  PD-TEL-PRE            PIC  9(03).
  6970         16  PD-TEL-NBR            PIC  9(04).
  6971     12  PD-ZIP.
  6972         16  PD-ZIP-PRIME          PIC  X(05).
  6973         16  PD-ZIP-PLUS4          PIC  X(04).
  6974     12  PD-LANGUAGE-IND           PIC  X(01).
  6975         88  PD-ENGLISH                       VALUE 'E'.
  6976         88  PD-FRENCH                        VALUE 'F'.
  6977         88  PD-SPANISH                       VALUE 'S'.
  6978
  6979     12  FILLER                       PIC  X(19).
  6980
  6981******************************************************************
  6982*                REINSURANCE DATA                                *
  6983******************************************************************
  6984
  6985     12  PD-REINS-TBL-CODE         PIC  X(03).
  6986     12  PD-REIN-RECALC            PIC  X(01).
  6987
  6988     12  PD-REI-AH-FEE             PIC S9(01)V9(04) COMP-3.
  6989     12  PD-REI-AH-PE              PIC  X(01).
  6990     12  PD-REI-AH-TAX             PIC S9(01)V9(04) COMP-3.
  6991
  6992     12  PD-REI-GROUP-A            PIC  X(06).
  6993     12  PD-REI-GROUP-B            PIC  X(06).
  6994
  6995     12  PD-REI-LF-FEE             PIC S9(01)V9(04) COMP-3.
  6996     12  PD-REI-LF-PE              PIC  X(01).
  6997     12  PD-REI-LF-TAX             PIC S9(01)V9(04) COMP-3.
  6998
  6999     12  PD-REI-MORT               PIC  X(04).
  7000     12  PD-REI-PRT-OW             PIC  X(01).
  7001     12  PD-REI-PRT-ST             PIC  X(01).
  7002
  7003     12  PD-REI-ADD-FEE            PIC S9(01)V9(04) COMP-3.
  7004     12  PD-REI-ADD-PE             PIC  X(01).
  7005     12  PD-REI-ADD-TAX            PIC S9(01)V9(04) COMP-3.
  7006
  7007     12  PD-REI-DIS-FEE            PIC S9(01)V9(04) COMP-3.
  7008     12  PD-REI-DIS-PE             PIC  X(01).
  7009     12  PD-REI-DIS-TAX            PIC S9(01)V9(04) COMP-3.
  7010
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL150.cbl
  7011     12  FILLER                       PIC  X(10).
  7012******************************************************************
  7013*                RETRO DATA                                      *
  7014******************************************************************
  7015
  7016     12  PD-RET-AH                 PIC S9(01)V9(04) COMP-3.
  7017     12  PD-RET-GRP                PIC  X(06).
  7018     12  PD-RET-LF                 PIC S9(01)V9(04) COMP-3.
  7019     12  PD-RET-MIN-LOSS-A         PIC SV9(03)      COMP-3.
  7020     12  PD-RET-MIN-LOSS-L         PIC SV9(03)      COMP-3.
  7021     12  PD-RET-P-E                PIC  X(01).
  7022     12  PD-RET-ST-TAX-USE         PIC  X(01).
  7023         88  PD-CHARGE-ST-TAXES-ON-RETRO   VALUE 'Y' 'E' 'P'.
  7024         88  PD-TAXES-NOT-IN-RETRO         VALUE 'N' ' '.
  7025     12  PD-RET-Y-N                PIC  X(01).
  7026     12  PD-RET-ADD                PIC S9(01)V9(04) COMP-3.
  7027     12  PD-RET-MIN-LOSS-ADD       PIC SV9(03)      COMP-3.
  7028     12  PD-RET-DIS                PIC S9(01)V9(04) COMP-3.
  7029     12  PD-RET-MIN-LOSS-DIS       PIC SV9(03)      COMP-3.
  7030
  7031     12  FILLER                       PIC  X(10).
  7032
  7033******************************************************************
  7034*                     MANAGEMENT OPTIONS                         *
  7035******************************************************************
  7036
  7037     12  PD-DEFAULT-UNWTR-CODE     PIC  X(03).
  7038     12  PD-LAPSE-NOTICE-CNTL      PIC  X(01).
  7039     12  PD-CORRESPONDENCE-CNTL    PIC  X(01).
  7040     12  PD-RETAIN-BILLING-DATA-MTHS PIC S9(03) COMP-3.
  7041     12  PD-RETAIN-CLAIM-DATA-MTHS PIC S9(03)  COMP-3.
  7042     12  PD-RETAIN-COMMISSION-MTHS PIC S9(03)  COMP-3.
  7043     12  PD-RETAIN-DELINQUENCY-MTHS PIC S9(03) COMP-3.
  7044     12  PD-RETAIN-INSD-PROFILE-MTHS PIC S9(03) COMP-3.
  7045     12  PD-RETAIN-INS-COVERAGE-MTHS PIC S9(03) COMP-3.
  7046     12  PD-RETAIN-STATUS-DISP-MTHS PIC S9(03) COMP-3.
  7047     12  PD-NUM-BILLING-CYCLES-RETAINED
  7048                                      PIC S9(03)  COMP-3.
  7049     12  PD-RETAIN-UNDERWRITER-HST-MTHS
  7050                                      PIC S9(03)  COMP-3.
  7051
  7052     12  FILLER                       PIC X(098).
  7053
  7054
  7055******************************************************************
  7056*                MISCELLANEOUS DATA                              *
  7057******************************************************************
  7058
  7059     12  PD-AH-RPT021-EXP-PCT      PIC S9(03)V9(04) COMP-3.
  7060     12  PD-AUTO-REFUND-SW         PIC  X(01).
  7061         88  PD-AUTO-REFUNDS-USED          VALUE 'Y'.
  7062         88  PD-AUTO-REFUNDS-NOT-USED      VALUE 'N' ' '.
  7063     12  PD-BUSINESS-TYPE          PIC  9(02).
  7064     12  PD-CAL-TABLE              PIC  X(02).
  7065     12  PD-COMMENTS.
  7066         16  PD-COMMENT-LINE       PIC  X(50)
  7067                                           OCCURS 5 TIMES.
  7068     12  PD-EMPLOYER-STMT-USED     PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL150.cbl
  7069     12  PD-GROUPED-CHECKS-Y-N     PIC  X(01).
  7070     12  PD-IG                     PIC  X(01).
  7071         88  PD-HAS-INDIVIDUAL             VALUE 'I'
  7072                                                    '1'.
  7073         88  PD-HAS-GROUP                  VALUE 'G'
  7074                                                    '2'.
  7075     12  PD-LF-RPT021-EXP-PCT      PIC S9(03)V9(04) COMP-3.
  7076     12  PD-REPORT-CODE-1          PIC  X(10).
  7077     12  PD-REPORT-CODE-2          PIC  X(10).
  7078     12  PD-RPT045A-SWITCH         PIC  X(01).
  7079         88  PD-RPT045A-OFF             VALUE 'N'.
  7080     12  PD-SPECIAL-BILLING-FREQ   PIC  X(01).
  7081         88  PD-HAS-SPECIAL-BILL-FREQ      VALUE 'Y'.
  7082         88  PD-NO-SPECIAL-BILL-FREQ       VALUE 'N' ' '.
  7083     12  PD-STATUS                 PIC  X(01).
  7084         88  PD-STATUS-ACTIVE              VALUE '0'.
  7085         88  PD-STATUS-INACTIVE            VALUE '1'.
  7086     12  PD-STD-AH-TYPE            PIC  X(02).
  7087     12  PD-TAX-NUMBER             PIC  X(11).
  7088     12  PD-TOL-CLM                PIC S9(03)V9(02) COMP-3.
  7089     12  PD-USER-FIELDS.
  7090         16  PD-USER-FLD-1         PIC  X(02).
  7091         16  PD-USER-FLD-2         PIC  X(02).
  7092         16  PD-USER-FLD-3         PIC  X(02).
  7093         16  PD-USER-FLD-4         PIC  X(02).
  7094         16  PD-USER-FLD-5         PIC  X(02).
  7095     12  PD-USER-SELECT-OPTIONS.
  7096         16  PD-USER-SELECT-1      PIC  X(10).
  7097         16  PD-USER-SELECT-2      PIC  X(10).
  7098         16  PD-USER-SELECT-3      PIC  X(10).
  7099         16  PD-USER-SELECT-4      PIC  X(10).
  7100         16  PD-USER-SELECT-5      PIC  X(10).
  7101     12  PD-DIS-RPT021-EXP-PCT     PIC S9(03)V9(04) COMP-3.
  7102     12  PD-ADD-RPT021-EXP-PCT     PIC S9(03)V9(04) COMP-3.
  7103     12  FILLER                       PIC  X(20).
  7104
  7105******************************************************************
  7106*                CLIENT USE AREAS                                *
  7107******************************************************************
  7108
  7109     12  PD-CLIENT-USE-AREA-1      PIC  X(30).
  7110     12  PD-CLIENT-USE-AREA-2      PIC  X(30).
  7111     12  PD-CLIENT-USE-AREA-3      PIC  X(11).
  7112     12  PD-CLIENT-USE-AREA-4      PIC  X(30).
  7113     12  PD-CLIENT-USE-AREA-5      PIC  X(30).
  7114     12  PD-CLIENT-USE-AREA-6      PIC  X(11).
  7115     12  PD-CLIENT-USE-AREA-7      PIC  X(30).
  7116     12  PD-CLIENT-USE-AREA-8      PIC  X(30).
  7117     12  PD-CLIENT-USE-AREA-9      PIC  X(11).
  7118
  7119******************************************************************
  7120*                TRANSFER DATA                                   *
  7121******************************************************************
  7122     12  PD-TRANSFERRED-FROM.
  7123         16  PD-TRNFROM-CARRIER    PIC  X(01).
  7124         16  PD-TRNFROM-GROUPING.
  7125             20  PD-TRNFROM-GRP-PREFIX
  7126                                      PIC  X(03).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL150.cbl
  7127             20  PD-TRNFROM-GRP-PRIME PIC X(03).
  7128         16  PD-TRNFROM-STATE      PIC  X(02).
  7129         16  PD-TRNFROM-PRODUCER.
  7130             20  PD-TRNFROM-PROD-PREFIX
  7131                                      PIC  X(04).
  7132             20  PD-TRNFROM-PROD-PRIME
  7133                                      PIC  X(06).
  7134         16  PD-TRNFROM-DATE       PIC  X(02).
  7135     12  PD-TRANSFERRED-TO.
  7136         16  PD-TRNTO-CARRIER      PIC  X(01).
  7137         16  PD-TRNTO-GROUPING.
  7138             20  PD-TRNTO-GRP-PREFIX PIC X(03).
  7139             20  PD-TRNTO-GRP-PRIME PIC X(03).
  7140         16  PD-TRNTO-STATE        PIC  X(02).
  7141         16  PD-TRNTO-PRODUCER.
  7142             20  PD-TRNTO-PROD-PREFIX PIC X(04).
  7143             20  PD-TRNTO-PROD-PRIME PIC X(06).
  7144         16  PD-TRNTO-DATE         PIC  X(02).
  7145     12  FILLER                       PIC  X(20).
  7146
  7147******************************************************************
  7148*                MORTGAGE PLANS SOLD                             *
  7149******************************************************************
  7150
  7151     12  PD-PLANS-SOLD.
  7152         16  PD-PRODUCER-PLANS OCCURS 40 TIMES
  7153                                INDEXED BY PD-PLAN-NDX
  7154                                           PD-PLAN-NDX2.
  7155             20  PD-INDIVIDUAL-PLAN.
  7156                 24  PD-PLAN-CODE  PIC  X(02).
  7157                 24  PD-PLAN-REVISION PIC X(03).
  7158             20  PD-IBNR-PERCENT   PIC S9(01)V9(04) COMP-3.
  7159     12  FILLER                       PIC  X(54).
  7160
  7161******************************************************************
  7162*                 AGENT AND COMMISSION DATA                      *
  7163******************************************************************
  7164
  7165     12  PD-COMMISSION-INFORMATION.
  7166         16  PD-REMIT-TO           PIC S9(03)   COMP-3.
  7167         16  PD-RECALCULATION-SW   PIC  X(01).
  7168             88  PD-RECALC-DETAIL          VALUE 'Y'.
  7169             88  PD-RECALC-NO-DETAIL       VALUE 'I'.
  7170             88  PD-IGNORE-RECALC          VALUE 'N'.
  7171             88  PD-VALID-RECALCULATION-SW VALUE 'Y' 'I' 'N'.
  7172         16  PD-AGENT-DATA.
  7173             20  PD-AGENT-ENTRY    OCCURS 5 TIMES
  7174                                    INDEXED BY PD-AGENT-NDX
  7175                                               PD-AGENT-NDX2.
  7176                 24  PD-AGENT-NUMBER PIC X(10).
  7177                 24  PD-AGENT-TYPE PIC  X(01).
  7178                     88  PD-AGENT-TYPE-A   VALUE 'C' 'D'.
  7179                     88  PD-AGENT-TYPE-G   VALUE 'O' 'R'
  7180                                                    'P' 'T'
  7181                                                    'W'.
  7182                     88  PD-AGENT-GROSS    VALUE 'C'.
  7183                     88  PD-AGENT-REINS    VALUE 'R'.
  7184                     88  PD-AGENT-GROSS-REINS VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL150.cbl
  7185                     88  PD-OVERWRITE-GROSS VALUE 'O'.
  7186                     88  PD-OVERWRITE-GROSS-REINS
  7187                                          VALUE 'P'.
  7188                     88  PD-OVERWRITE-REINS VALUE 'T'.
  7189                     88  PD-REINS-ONLY     VALUE 'W'.
  7190                     88  PD-VALID-AGENT-TYPE VALUE 'C' 'R'
  7191                                                'D' 'O' 'P'
  7192                                                'T' 'W'.
  7193                 24  PD-COMMISSION-BILLED-PAID
  7194                                      PIC  X(01).
  7195                     88  PD-AGENT-BILLED   VALUE 'B'.
  7196                     88  PD-AGENT-PAID     VALUE 'P'.
  7197                 24  PD-COMP-RECALC-FLAG
  7198                                      PIC  X(01).
  7199                     88  PD-BYPASS-RECALC  VALUE 'N'.
  7200                     88  PD-VALID-RECALC-FLAG VALUE ' ' 'N'.
  7201     12  FILLER                       PIC  X(55).
  7202
  7203******************************************************************
  7204*                BANK DATA                                       *
  7205******************************************************************
  7206
  7207     12  PD-BANK-ACCOUNT-NUMBER    PIC  X(20).
  7208     12  PD-BANK-TRANSIT-NUMBER.
  7209         16  PD-FEDERAL-NUMBER     PIC  X(04).
  7210         16  PD-BANK-NUMBER        PIC  X(04).
  7211     12  PD-CHARGE-CARD-EXP-DT     PIC  X(02).
  7212     12  PD-CHARGE-CARD-TYPE       PIC  X(02).
  7213         88  PD-AMERICAN-EXPRESS              VALUE 'AE'.
  7214         88  PD-CARTE-BLANCHE                 VALUE 'CB'.
  7215         88  PD-DINERS-CLUB                   VALUE 'DN'.
  7216         88  PD-DISCOVER                      VALUE 'DS'.
  7217         88  PD-MASTER-CARD                   VALUE 'MC'.
  7218         88  PD-VISA                          VALUE 'VI'.
  7219     12  PD-SIGNATURE-NAME         PIC  X(25).
  7220     12  PD-AUTHORIZATION-SW       PIC  X(01).
  7221******************************************************************
  7222*                GENERIC FILLER                                  *
  7223******************************************************************
  7224
  7225     12  FILLER                       PIC  X(66).
  7226
  7227******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL150.cbl
  7229*                            COPY ELCRETR.
  7230******************************************************************
  7231*                                                                *
  7232*                                                                *
  7233*                            ELCRETR.                            *
  7234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7235*                            VMOD=2.002                          *
  7236*                                                                *
  7237*   FILE DESCRIPTION = CLAIM MASTER RETRIEVE FILE                *
  7238*                                                                *
  7239*   **** NOTE -- THIS FILE IS IDENTICAL TO CLAIM MASTER (ELMSTR) *
  7240*   ****      ANY CHANGES TO THIS COPYBOOK OR ELCMSTR MUST BE    *
  7241*   ****      DUPLICATED IN THE OTHER.                           *
  7242*                                                                *
  7243*   FILE TYPE = VSAM,KSDS                                        *
  7244*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7245*                                                                *
  7246*   BASE CLUSTER = ELRETR                         RKP=2,LEN=20   *
  7247*       ALTERNATE PATH1 = ELRETR2 (BY NAME)       RKP=22,LEN=29  *
  7248*       ALTERNATE PATH2 = ELRETR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7249*       ALTERNATE PATH3 = ELRETR5 (BY CERT NO)    RKP=63,LEN=12  *
  7250*       ALTERNATE PATH4 = ELRETR6 (BY CREDIT CARD NO)
  7251*                                                 RKP=75,LEN=21  *
  7252*                                                                *
  7253*   LOG = YES                                                    *
  7254*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7255******************************************************************
  7256 01  RETRIEVE-MASTER.
  7257     12  RL-RECORD-ID                PIC XX.
  7258         88  VALID-RL-ID         VALUE 'RL'.
  7259
  7260     12  RL-CONTROL-PRIMARY.
  7261         16  RL-COMPANY-CD           PIC X.
  7262         16  RL-CARRIER              PIC X.
  7263         16  RL-CLAIM-NO             PIC X(7).
  7264         16  RL-CERT-NO.
  7265             20  RL-CERT-PRIME       PIC X(10).
  7266             20  RL-CERT-SFX         PIC X.
  7267
  7268     12  RL-CONTROL-BY-NAME.
  7269         16  RL-COMPANY-CD-A1        PIC X.
  7270         16  RL-INSURED-LAST-NAME    PIC X(15).
  7271         16  RL-INSURED-NAME.
  7272             20  RL-INSURED-1ST-NAME PIC X(12).
  7273             20  RL-INSURED-MID-INIT PIC X.
  7274
  7275     12  RL-CONTROL-BY-SSN.
  7276         16  RL-COMPANY-CD-A2        PIC X.
  7277         16  RL-SOC-SEC-NO.
  7278             20  RL-SSN-STATE        PIC XX.
  7279             20  RL-SSN-ACCOUNT      PIC X(6).
  7280             20  RL-SSN-LN3          PIC X(3).
  7281
  7282     12  RL-CONTROL-BY-CERT-NO.
  7283         16  RL-COMPANY-CD-A4        PIC X.
  7284         16  RL-CERT-NO-A4.
  7285             20  RL-CERT-A4-PRIME    PIC X(10).
  7286             20  RL-CERT-A4-SFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL150.cbl
  7287
  7288     12  RL-CONTROL-BY-CCN.
  7289         16  RL-COMPANY-CD-A5        PIC X.
  7290         16  RL-CCN-A5.
  7291             20  RL-CCN-NO.
  7292                 24  RL-CCN-PREFIX-A5 PIC X(4).
  7293                 24  RL-CCN-PRIME-A5 PIC X(12).
  7294             20  RL-CCN-FILLER-A5    PIC X(4).
  7295
  7296     12  RL-INSURED-PROFILE-DATA.
  7297         16  RL-INSURED-BIRTH-DT     PIC XX.
  7298         16  RL-INSURED-SEX-CD       PIC X.
  7299             88  RL-INSURED-IS-MALE     VALUE 'M'.
  7300             88  RL-INSURED-IS-FEMALE   VALUE 'F'.
  7301             88  RL-INSURED-SEX-UNKNOWN VALUE ' '.
  7302         16  RL-INSURED-OCC-CD       PIC X(6).
  7303         16  FILLER                  PIC X(5).
  7304
  7305     12  RL-PROCESSING-INFO.
  7306         16  RL-PROCESSOR-ID         PIC X(4).
  7307         16  RL-CLAIM-STATUS         PIC X.
  7308             88  RL-CLAIM-IS-OPEN       VALUE 'O'.
  7309             88  RL-CLAIM-IS-CLOSED     VALUE 'C'.
  7310         16  RL-CLAIM-TYPE           PIC X.
  7311*            88  RL-AH-CLAIM            VALUE 'A'.
  7312*            88  RL-LIFE-CLAIM          VALUE 'L'.
  7313*            88  RL-PROPERTY-CLAIM      VALUE 'P'.
  7314*            88  RL-UNEMPLOYMENT-CLAIM  VALUE 'U'.
  7315         16  RL-CLAIM-PREM-TYPE      PIC X.
  7316             88  RL-SINGLE-PREMIUM         VALUE '1'.
  7317             88  RL-O-B-COVERAGE           VALUE '2'.
  7318             88  RL-OPEN-END-COVERAGE      VALUE '3'.
  7319         16  RL-INCURRED-DT          PIC XX.
  7320         16  RL-REPORTED-DT          PIC XX.
  7321         16  RL-FILE-ESTABLISH-DT    PIC XX.
  7322         16  RL-EST-END-OF-DISAB-DT  PIC XX.
  7323         16  RL-LAST-PMT-DT          PIC XX.
  7324         16  RL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7325         16  RL-PAID-THRU-DT         PIC XX.
  7326         16  RL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7327         16  RL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7328         16  RL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7329         16  RL-PMT-CALC-METHOD      PIC X.
  7330             88  RL-360-DAY-YR          VALUE '1'.
  7331             88  RL-365-DAY-YR          VALUE '2'.
  7332             88  RL-FULL-MONTHS         VALUE '3'.
  7333         16  RL-CAUSE-CD             PIC X(6).
  7334
  7335         16  RL-PRIME-CERT-NO.
  7336             20  RL-PRIME-CERT-PRIME PIC X(10).
  7337             20  RL-PRIME-CERT-SFX   PIC X.
  7338
  7339         16  RL-SYSTEM-IDENTIFIER    PIC XX.
  7340             88  RL-CREDIT-CLAIM        VALUE 'CR'.
  7341             88  RL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7342
  7343         16  RL-MICROFILM-NO         PIC X(10).
  7344         16  RL-PROG-FORM-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL150.cbl
  7345         16  RL-LAST-ADD-ON-DT       PIC XX.
  7346
  7347         16  RL-LAST-REOPEN-DT       PIC XX.
  7348         16  RL-LAST-CLOSE-DT        PIC XX.
  7349         16  RL-LAST-CLOSE-REASON    PIC X.
  7350             88  RL-FINAL-PAID          VALUE '1'.
  7351             88  RL-CLAIM-DENIED        VALUE '2'.
  7352             88  RL-AUTO-CLOSE          VALUE '3'.
  7353             88  RL-MANUAL-CLOSE        VALUE '4'.
  7354         16  RL-ASSOC-CERT-SEQU      PIC S99.
  7355         16  RL-ASSOC-CERT-TOTAL     PIC S99.
  7356         16  RL-CLAIM-PAYMENT-STATUS PIC 9.
  7357             88  RL-PAYMENT-IN-PREP     VALUE 1 THRU 9.
  7358         16  FILLER                  PIC X(5).
  7359
  7360     12  RL-CERTIFICATE-DATA.
  7361         16  RL-CERT-ORIGIN          PIC X.
  7362             88  RL-CERT-WAS-ONLINE     VALUE '1'.
  7363             88  RL-CERT-WAS-CREATED    VALUE '2'.
  7364             88  RL-COVERAGE-WAS-ADDED  VALUE '3'.
  7365         16  RL-CERT-KEY-DATA.
  7366             20  RL-CERT-CARRIER     PIC X.
  7367             20  RL-CERT-GROUPING    PIC X(6).
  7368             20  RL-CERT-STATE       PIC XX.
  7369             20  RL-CERT-ACCOUNT.
  7370                 24  RL-CERT-ACCOUNT-PREFIX PIC X(4).
  7371                 24  RL-CERT-ACCOUNT-PRIME  PIC X(6).
  7372             20  RL-CERT-EFF-DT      PIC XX.
  7373
  7374     12  RL-STATUS-CONTROLS.
  7375         16  RL-PRIORITY-CD          PIC X.
  7376             88  RL-HIGHEST-PRIORITY    VALUE '9'.
  7377         16  RL-SUPV-ATTN-CD         PIC X.
  7378             88  RL-SUPV-NOT-REQUIRED   VALUE ' ' 'N'.
  7379             88  RL-SUPV-IS-REQUIRED    VALUE 'Y'.
  7380         16  RL-PURGED-DT            PIC XX.
  7381         16  RL-RESTORED-DT          PIC XX.
  7382         16  RL-NEXT-AUTO-PAY-DT     PIC XX.
  7383         16  RL-NEXT-RESEND-DT       PIC XX.
  7384         16  RL-NEXT-FOLLOWUP-DT     PIC XX.
  7385         16  FILLER                  PIC XX.
  7386         16  RL-LAST-MAINT-DT        PIC XX.
  7387         16  RL-LAST-MAINT-USER      PIC X(4).
  7388         16  RL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7389         16  RL-LAST-MAINT-TYPE      PIC X.
  7390             88  RL-CLAIM-SET-UP           VALUE ' '.
  7391             88  RL-PAYMENT-MADE           VALUE '1'.
  7392             88  RL-LETTER-SENT            VALUE '2'.
  7393             88  RL-MASTER-WAS-ALTERED     VALUE '3'.
  7394             88  RL-MASTER-WAS-RESTORED    VALUE '4'.
  7395             88  RL-INCURRED-DATE-CHANGED  VALUE '5'.
  7396             88  RL-FILE-CONVERTED         VALUE '6'.
  7397         16  RL-RELATED-CLAIM-NO     PIC X(7).
  7398         16  RL-HISTORY-ARCHIVE-DT   PIC XX.
  7399         16  RL-BENEFICIARY          PIC X(10).
  7400         16  RL-FILE-ESTABLISHED-BY  PIC X(4).
  7401         16  FILLER                  PIC X(6).
  7402
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL150.cbl
  7403     12  RL-TRAILER-CONTROLS.
  7404         16  RL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7405             88  RL-1ST-TRL-AVAIL       VALUE +4095.
  7406             88  RL-LAST-TRL-AVAIL      VALUE +100.
  7407             88  RL-RESV-EXP-HIST-TRLR  VALUE +0.
  7408         16  RL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7409         16  FILLER                  PIC XX.
  7410         16  RL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7411         16  RL-ADDRESS-TRAILER-CNT.
  7412             20  RL-INSURED-ADDR-CNT  PIC S9.
  7413                 88  RL-NO-INSURED-AVAILABLE VALUE ZERO.
  7414             20  RL-ACCOUNT-ADDR-CNT  PIC S9.
  7415                 88  RL-ACCOUNT-IS-ONLINE    VALUE ZERO.
  7416             20  RL-BENIF-ADDR-CNT    PIC S9.
  7417                 88  RL-BENEFICIARY-IS-ONLINE VALUE ZERO.
  7418             20  RL-EMPLOYER-ADDR-CNT PIC S9.
  7419                 88  RL-NO-EMPLOY-AVAILABLE   VALUE ZERO.
  7420             20  RL-DOCTOR-ADDR-CNT   PIC S9.
  7421                 88  RL-NO-DOCTOR-AVAILABLE   VALUE ZERO.
  7422             20  RL-OTHER-1-ADDR-CNT  PIC S9.
  7423                 88  RL-NO-OTHER-1-ADDRESSES  VALUE ZERO.
  7424             20  RL-OTHER-2-ADDR-CNT  PIC S9.
  7425                 88  RL-NO-OTHER-2-ADDRESSES  VALUE ZERO.
  7426
  7427     12  RL-CV-REFERENCE-NO.
  7428         16  RL-CV-REFNO-PRIME       PIC X(18).
  7429         16  RL-CV-REFNO-SFX         PIC XX.
  7430
  7431     12  RL-FILE-LOCATION            PIC X(4).
  7432
  7433     12  RL-PROCESS-ERRORS.
  7434         16  RL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7435             88  RL-NO-FATAL-ERRORS     VALUE ZERO.
  7436         16  RL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7437             88  RL-NO-FORCABLE-ERRORS  VALUE ZERO.
  7438
  7439     12  RL-PRODUCT-CD               PIC X.
  7440
  7441     12  RL-CURRENT-KEY-DATA.
  7442         16  RL-CURRENT-CARRIER      PIC X.
  7443         16  RL-CURRENT-GROUPING     PIC X(6).
  7444         16  RL-CURRENT-STATE        PIC XX.
  7445         16  RL-CURRENT-ACCOUNT      PIC X(10).
  7446
  7447     12  RL-ASSOCIATES               PIC X.
  7448         88  RL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7449         88  RL-ASSOC-INTERFACE         VALUE 'I'.
  7450         88  RL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7451         88  RL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7452
  7453     12  RL-ACTIVITY-CODE            PIC 99.
  7454     12  RL-ACTIVITY-MAINT-DT        PIC XX.
  7455     12  RL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7456
  7457     12  RL-LAPSE-REPORT-CODE        PIC 9.
  7458     12  RL-LAG-REPORT-CODE          PIC 9.
  7459     12  RL-LOAN-TYPE                PIC XX.
  7460     12  RL-LEGAL-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL150.cbl
  7461
  7462     12  FILLER                      PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL150.cbl
  7464*                COPY MTCPHST REPLACING ==:TAG:== BY ==PH==.
  7465******************************************************************
  7466*                                                                *
  7467*                           MTCPHST                              *
  7468*                            VMOD=1.001                          *
  7469*                                                                *
  7470*   FILE DESCRIPTION = POLICY HISTORY FILE                       *
  7471*                                                                *
  7472*   FILE TYPE = VSAM,KSDS                                        *
  7473*   RECORD SIZE = 132  RECFORM = FIXED                           *
  7474*                                                                *
  7475*   BASE CLUSTER = MPPHST                         RKP=2,LEN=46   *
  7476*       ALTERNATE (NONE)                                         *
  7477*                                                                *
  7478*   LOG = YES                                                    *
  7479*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7480******************************************************************
  7481
  7482 01  POLICY-HISTORY.
  7483     12 PH-RECORD-ID                    PIC XX.
  7484         88  VALID-PH-ID                      VALUE 'PH'.
  7485
  7486******************************************************************
  7487*   BASE CLUSTER = MPPHST         (BASE KEY)      RKP=2,LEN=46   *
  7488******************************************************************
  7489
  7490     12 PH-CONTROL-PRIMARY.
  7491         16 PH-COMPANY-CD               PIC X.
  7492         16 PH-CARRIER                  PIC X.
  7493         16 PH-GROUPING.
  7494             20 PH-GROUPING-PREFIX      PIC X(3).
  7495             20 PH-GROUPING-PRIME       PIC X(3).
  7496         16 PH-STATE                    PIC XX.
  7497         16 PH-PRODUCER.
  7498             20 PH-PRODUCER-PREFIX      PIC X(4).
  7499             20 PH-PRODUCER-PRIME       PIC X(6).
  7500         16 PH-POLICY-EFF-DT            PIC XX.
  7501         16 PH-POLICY-NO.
  7502             20 PH-POLICY-PRIME         PIC X(18).
  7503             20 PH-POLICY-SFX           PIC XX.
  7504         16 PH-RECORD-TYPE              PIC X(2).
  7505         16 PH-FIELD-TYPE               PIC X(2).
  7506         16 PH-SEQUENCE-NO              PIC S9(4)    COMP.
  7507             88 PH-1ST-HISTORY-REC         VALUE +4095.
  7508     12  FILLER                            PIC X(16).
  7509
  7510******************************************************************
  7511*                 FILE SYNCHRONIZATION DATA                      *
  7512******************************************************************
  7513
  7514     12 PH-FILE-SYNCH-DATA.
  7515         16 PH-TRANSACTION-ID           PIC X(4).
  7516         16 PH-CHANGE-DT                PIC XX.
  7517         16 PH-CHANGE-TIME              PIC S9(7)  COMP-3.
  7518         16 PH-CHANGE-PROCESSOR         PIC X(4).
  7519         16 PH-MONTH-END-DT             PIC XX.
  7520
  7521******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL150.cbl
  7522*                 POLICY HISTORY RECORD BODY                     *
  7523******************************************************************
  7524
  7525     12 PH-RECORD-BODY                  PIC X(50).
  7526
  7527******************************************************************
  7528*                       NUMERIC DATA                             *
  7529******************************************************************
  7530     12  FILLER           REDEFINES PH-RECORD-BODY.
  7531         20 PH-NUMERIC-FLD1             PIC S9(10)V99.
  7532         20  FILLER                        PIC X(38).
  7533
  7534     12  FILLER           REDEFINES PH-RECORD-BODY.
  7535         20 PH-NUMERIC-FLD2             PIC S9(2)V999.
  7536         20  FILLER                        PIC X(45).
  7537
  7538     12  FILLER           REDEFINES PH-RECORD-BODY.
  7539         20 PH-NUMERIC-FLD3             PIC S9(15).
  7540         20  FILLER                        PIC X(35).
  7541
  7542******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL150.cbl
  7544 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER-L
  7545                          CONTROL-FILE CERTIFICATE-MASTER
  7546                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7547                          ACCOUNT-MASTER LETTER-ARCHIVE
  7548                          POLICY-MASTER PRODUCER-PLANS
  7549                          PRODUCER-MASTER RETRIEVE-MASTER
  7550                          POLICY-HISTORY.
  7551 0000-DFHEXIT SECTION.
  7552     MOVE '9#                    $   ' TO DFHEIV0.
  7553     MOVE 'EL150' TO DFHEIV1.
  7554     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7555
  7556     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7557     MOVE '5'                    TO DC-OPTION-CODE.
  7558     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7559     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7560     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7561
  7562     IF EIBCALEN = 0
  7563         GO TO 8800-UNAUTHORIZED-ACCESS.
  7564
  7565     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7566
  7567     IF PI-COMPANY-ID NOT = 'DMD'
  7568         MOVE SPACES             TO WST-REM-DAYS-GRP
  7569                                    WST-ORIG-DAYS-GRP.
  7570
  7571     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7572     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7573
  7574     MOVE EIBTRMID               TO QID-TERM.
  7575
  7576
  7577* EXEC CICS HANDLE CONDITION
  7578*        QIDERR   (1000-SHOW-CLAIM)
  7579*        MAPFAIL  (0100-FIRST-TIME-IN)
  7580*        NOTOPEN  (8500-FILE-NOTOPEN)
  7581*        PGMIDERR (9600-PGMID-ERROR)
  7582*        ERROR    (9990-ABEND)
  7583*    END-EXEC.
  7584*    MOVE '"$N?JL.               ! " #00007572' TO DFHEIV0
  7585     MOVE X'22244E3F4A4C2E2020202020' TO DFHEIV0(1:12)
  7586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7587     MOVE X'2220233030303037353732' TO DFHEIV0(25:11)
  7588     CALL 'kxdfhei1' USING DFHEIV0
  7589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7590
  7591
  7592     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7593         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7594
  7595     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7596         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7597             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7598             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7599             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7600             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7601             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL150.cbl
  7602             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7603             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7604             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7605         ELSE
  7606             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7607             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7608             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7609             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7610             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7611             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7612             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7613             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7614
  7615     IF RETURNED-FROM NOT = SPACES
  7616         GO TO 0600-RECOVER-TEMP-STORAGE.
  7617
  7618     IF EIBAID = DFHCLEAR
  7619         GO TO 9400-CLEAR.
  7620
  7621     IF PI-PROCESSOR-ID = 'LGXX'
  7622         NEXT SENTENCE
  7623     ELSE
  7624
  7625* EXEC CICS READQ TS
  7626*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7627*            INTO    (SECURITY-CONTROL)
  7628*            LENGTH  (SC-COMM-LENGTH)
  7629*            ITEM    (SC-ITEM)
  7630*        END-EXEC
  7631*    MOVE '*$II   L              ''   #00007612' TO DFHEIV0
  7632     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7633     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7634     MOVE X'2020233030303037363132' TO DFHEIV0(25:11)
  7635     CALL 'kxdfhei1' USING DFHEIV0,
  7636           PI-SECURITY-TEMP-STORE-ID,
  7637           SECURITY-CONTROL,
  7638           SC-COMM-LENGTH,
  7639           SC-ITEM,
  7640           DFHEIV99,
  7641           DFHEIV99
  7642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7643         MOVE SC-CLAIMS-DISPLAY (16)  TO  PI-DISPLAY-CAP
  7644         MOVE SC-CLAIMS-UPDATE  (16)  TO  PI-MODIFY-CAP
  7645         IF NOT DISPLAY-CAP
  7646             MOVE 'READ'              TO  SM-READ
  7647             PERFORM 9995-SECURITY-VIOLATION
  7648             MOVE ER-0070             TO  EMI-ERROR
  7649             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7650             GO TO 8100-SEND-INITIAL-MAP.
  7651
  7652     IF EIBTRNID = TRANS-ID
  7653         GO TO 0200-RECEIVE.
  7654
  7655 0100-FIRST-TIME-IN.
  7656
  7657     MOVE LOW-VALUES             TO EL150AO.
  7658
  7659     IF NOT PI-CONFIDENTIAL-UP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL150.cbl
  7660         MOVE LOW-VALUES         TO PI-REDEF.
  7661
  7662     MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
  7663     MOVE ZEROS                  TO PI-TOTAL-PAID
  7664                                    PI-DAYS-PAID
  7665                                    PI-LAST-SEQ-NO.
  7666
  7667     MOVE 0                      TO PI-FORCE-COUNT.
  7668
  7669
  7670* EXEC CICS DELETEQ TS
  7671*        QUEUE(QID)
  7672*    END-EXEC.
  7673*    MOVE '*&                    #   #00007644' TO DFHEIV0
  7674     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7675     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7676     MOVE X'2020233030303037363434' TO DFHEIV0(25:11)
  7677     CALL 'kxdfhei1' USING DFHEIV0,
  7678           QID,
  7679           DFHEIV99
  7680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7681
  7682
  7683     GO TO 1000-SHOW-CLAIM.
  7684
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL150.cbl
  7686 0200-RECEIVE.
  7687     MOVE 'B'                    TO PASS-SWITCH.
  7688
  7689     MOVE LOW-VALUES             TO EL150AI.
  7690
  7691     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7692         MOVE ER-0008            TO EMI-ERROR
  7693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7694         MOVE -1                 TO FILETOL
  7695         GO TO 8200-SEND-DATAONLY.
  7696
  7697
  7698* EXEC CICS RECEIVE
  7699*        MAP      (MAP-NAME)
  7700*        MAPSET   (MAPSET-NAME)
  7701*        INTO     (EL150AI)
  7702*    END-EXEC.
  7703     MOVE LENGTH OF
  7704      EL150AI
  7705       TO DFHEIV11
  7706*    MOVE '8"T I  L              ''   #00007662' TO DFHEIV0
  7707     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7708     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7709     MOVE X'2020233030303037363632' TO DFHEIV0(25:11)
  7710     CALL 'kxdfhei1' USING DFHEIV0,
  7711           MAP-NAME,
  7712           EL150AI,
  7713           DFHEIV11,
  7714           MAPSET-NAME,
  7715           DFHEIV99,
  7716           DFHEIV99
  7717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7718
  7719
  7720     IF ENTERPFL = 0
  7721         GO TO 0300-CHECK-PFKEYS.
  7722
  7723     IF EIBAID NOT = DFHENTER
  7724         MOVE ER-0004            TO EMI-ERROR
  7725         GO TO 0320-INPUT-ERROR.
  7726
  7727     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7728         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7729     ELSE
  7730         MOVE ER-0029            TO EMI-ERROR
  7731         GO TO 0320-INPUT-ERROR.
  7732
  7733 0300-CHECK-PFKEYS.
  7734     IF EIBAID = DFHPF23
  7735         GO TO 8810-PF23.
  7736
  7737     IF EIBAID = DFHPF24
  7738         GO TO 9200-RETURN-MAIN-MENU.
  7739
  7740     IF EIBAID = DFHPF12
  7741         GO TO 9500-PF12.
  7742
  7743     IF (EIBAID = DFHPF22) AND (NOT FORCE-CAP)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL150.cbl
  7744         MOVE ER-0433            TO EMI-ERROR
  7745         GO TO 0320-INPUT-ERROR.
  7746
  7747     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF22)
  7748         MOVE ER-0500            TO EMI-ERROR
  7749         GO TO 0320-INPUT-ERROR.
  7750
  7751     IF PI-RETRIEVED-DATA
  7752         IF EIBAID = DFHPF1  OR DFHPF2 OR DFHPF15 OR
  7753                     DFHPF16 OR DFHPF21
  7754             NEXT SENTENCE
  7755         ELSE
  7756             MOVE ER-0926        TO EMI-ERROR
  7757             GO TO 0320-INPUT-ERROR.
  7758
  7759     IF EIBAID = DFHPF21
  7760         IF NOT PI-RETRIEVED-DATA
  7761             PERFORM 7650-CREATE-ACTQ THRU 7650-EXIT
  7762             MOVE ER-0927        TO EMI-ERROR
  7763             GO TO 0320-INPUT-ERROR
  7764         ELSE
  7765             GO TO 7700-CREATE-CLAIM.
  7766
  7767     IF CLAIM-IS-PURGED
  7768         IF EIBAID = DFHPF1  OR DFHPF2  OR DFHPF3  OR DFHPF4  OR
  7769                     DFHPF6  OR DFHPF7  OR DFHPF8  OR DFHPF9  OR
  7770                     DFHPF10 OR DFHPF11 OR DFHPF13 OR DFHPF14 OR
  7771                     DFHPF17 OR DFHPF18 OR DFHPF20
  7772                       MOVE -1            TO  ENTERPFL
  7773                       MOVE 'CLAIM IS PURGED, PFKEYS ARE INVALID'
  7774                                          TO  MAP-DISPLAY (1)
  7775                         GO TO 8200-SEND-DATAONLY.
  7776
  7777     IF (PI-SUPERVISOR-ONLY)
  7778        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  7779             AND 'AMWA')
  7780*       NOT SYSTEM-MODIFY-CAP
  7781*        IF EIBAID = DFHPF3  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
  7782         IF EIBAID = DFHPF4  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
  7783                     DFHPF9  or
  7784                     DFHPF11 OR DFHPF13 OR DFHPF14 OR DFHPF17 OR
  7785                     DFHPF21 OR DFHENTER
  7786             MOVE -1             TO ENTERPFL
  7787             MOVE ER-0931        TO EMI-ERROR
  7788             GO TO 0320-INPUT-ERROR.
  7789
  7790     IF EIBAID = DFHPF13 OR DFHPF19 OR DFHPF20
  7791         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7792             MOVE ER-0029            TO  EMI-ERROR
  7793             GO TO 0320-INPUT-ERROR.
  7794
  7795     IF EIBAID = DFHPF5 OR DFHPF18 OR DFHPF19 OR DFHPF20
  7796         IF PI-COMPANY-ID = 'DMD'
  7797             AND
  7798            NOT SYSTEM-MODIFY-CAP
  7799            IF PI-PRIORITY-9
  7800               MOVE ER-0931            TO  EMI-ERROR
  7801               GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL150.cbl
  7802
  7803     IF EIBAID = DFHPF7 OR DFHPF6
  7804         IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
  7805            AND PI-TOTAL-PAID NOT GREATER THAN +0
  7806             MOVE EIBAID             TO PI-PFKEY-USED
  7807             MOVE ER-3550            TO  EMI-ERROR
  7808             GO TO 0320-INPUT-ERROR.
  7809
  7810     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7
  7811                 GO TO 0500-CREATE-TEMP-STORAGE.
  7812     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6
  7813         IF PI-SAVE-TYPE = 'L'
  7814             MOVE ER-0376        TO EMI-ERROR
  7815             GO TO 0320-INPUT-ERROR
  7816         ELSE
  7817             GO TO 0500-CREATE-TEMP-STORAGE.
  7818
  7819     IF EIBAID = DFHPF3  OR DFHPF4  OR DFHPF5  OR DFHPF7  OR
  7820                 DFHPF8  OR DFHPF9  OR DFHPF10 OR DFHPF13 OR
  7821                 DFHPF14 OR DFHPF17 OR DFHPF18 OR DFHPF19 OR
  7822                 DFHPF20
  7823                 GO TO 0500-CREATE-TEMP-STORAGE.
  7824
  7825     IF EIBAID = DFHPF6 OR DFHPF11
  7826         IF PI-SAVE-TYPE = 'L'
  7827             MOVE ER-0376        TO EMI-ERROR
  7828             GO TO 0320-INPUT-ERROR
  7829         ELSE
  7830             GO TO 0500-CREATE-TEMP-STORAGE.
  7831
  7832     MOVE SPACES                 TO ERRMSG1O.
  7833
  7834     IF EIBAID = DFHPF15
  7835         GO TO 7000-START-BROWSE.
  7836
  7837     IF EIBAID = DFHPF16
  7838         GO TO 7500-START-BROWSE.
  7839
  7840     IF EIBAID = DFHPF1
  7841         MOVE 'F'                TO DIRECTION-SWITCH
  7842         GO TO 1600-ROLL-TRAILERS.
  7843
  7844     IF EIBAID = DFHPF2
  7845         MOVE 'B'                TO DIRECTION-SWITCH
  7846         GO TO 1600-ROLL-TRAILERS.
  7847
  7848     IF EIBAID = DFHENTER
  7849         GO TO 0330-EDIT-DATA.
  7850
  7851*      string "EIBAID = " eibaid into map-display (1)
  7852*      GO TO 8200-SEND-DATAONLY.
  7853     MOVE ER-0029                TO EMI-ERROR.
  7854
  7855 0320-INPUT-ERROR.
  7856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7857
  7858     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT.
  7859
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL150.cbl
  7860     IF ENTERPFL = 0
  7861         MOVE -1                 TO FILETOL
  7862     ELSE
  7863         MOVE AL-UNBON           TO ENTERPFA
  7864         MOVE -1                 TO ENTERPFL.
  7865
  7866     GO TO 8200-SEND-DATAONLY.
  7867
  7868 0330-EDIT-DATA.
  7869
  7870     MOVE 0                      TO PI-FORCE-COUNT.
  7871
  7872     IF NOT MODIFY-CAP
  7873         MOVE 'UPDATE'           TO  SM-READ
  7874         PERFORM 9995-SECURITY-VIOLATION
  7875         MOVE ER-0070            TO  EMI-ERROR
  7876         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7877         GO TO 8100-SEND-INITIAL-MAP.
  7878
  7879     IF CLMNOL  > 0 OR
  7880        CARRL   > 0 OR
  7881        CERTNOL > 0 OR
  7882        SUFXL   > 0
  7883            GO TO 1000-SHOW-CLAIM.
  7884
  7885     IF YESNOSWL > 0
  7886         MOVE AL-UANON           TO YESNOSWA.
  7887
  7888*    IF MCRFLML > 0
  7889*        MOVE AL-UANON           TO MCRFLMA.
  7890
  7891     IF FILETOL > 0
  7892         MOVE AL-UANON           TO FILETOA.
  7893
  7894     IF CLOANL > 0
  7895        MOVE AL-UANON            TO CLOANA
  7896     END-IF
  7897
  7898     IF PRTOPTL > 0
  7899        IF PRTOPTI NOT = 'N' AND 'L'
  7900           MOVE AL-UABON         TO PRTOPTA
  7901           MOVE -1               TO PRTOPTL
  7902           MOVE ER-0334 TO EMI-ERROR
  7903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7904        ELSE
  7905           MOVE AL-UANON         TO PRTOPTA.
  7906
  7907     IF PRTOPTL > 0
  7908         IF (NOT PI-NO-CARRIER-SECURITY OR
  7909             NOT PI-NO-ACCOUNT-SECURITY)
  7910             IF PRTOPTI NOT = 'N'
  7911                 MOVE AL-UABON   TO PRTOPTA
  7912                 MOVE -1         TO PRTOPTL
  7913                 MOVE ER-2378    TO EMI-ERROR
  7914                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7915
  7916     IF FORMATL > 0
  7917         IF FORMATI NOT = 'F' AND 'P'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL150.cbl
  7918             MOVE AL-UABON       TO FORMATA
  7919             MOVE -1             TO FORMATL
  7920             MOVE ER-0335        TO EMI-ERROR
  7921             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7922         ELSE
  7923             MOVE AL-UANON       TO FORMATA.
  7924
  7925     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7926         IF ASSOCL > +0
  7927             IF ASSOCI = 'A' OR 'I' OR 'N' OR 'M'
  7928                 MOVE AL-UANON   TO  ASSOCA
  7929             ELSE
  7930                 MOVE AL-UABON   TO  ASSOCA
  7931                 MOVE -1         TO  ASSOCL
  7932                 MOVE ER-0804    TO  EMI-ERROR
  7933                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7934
  7935 0335-EDIT-ACTIVITY-CODE.
  7936******************************************************************
  7937*    THIS PARAGRAPH DETERMINES IF THE COMPANY IS CURRENTLY USING *
  7938*    THE AUTOMATIC ACTIVITY FUNCTIONS OF THE SYSTEM AND, IF SO,  *
  7939*    WHAT FUNCTIONS ARE TO BE PERFORMED BASED ON THE CODES SET   *
  7940*    IN THE AUTOMATIC ACTIVITY RECORD.                           *
  7941******************************************************************
  7942
  7943     IF ACTCDL = +0
  7944         GO TO 0340-EDIT-DATA.
  7945
  7946     IF ACTCDI IS NOT NUMERIC
  7947         MOVE ZEROS              TO  ACTCDI
  7948         MOVE AL-UABON           TO  ACTCDA
  7949         MOVE -1                 TO  ACTCDL
  7950         MOVE ER-3526            TO  EMI-ERROR
  7951         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7952         GO TO 0340-EDIT-DATA.
  7953
  7954     MOVE ACTCDI                 TO  WS-ACTIVITY-CODE.
  7955     IF NOT VALID-ACTIVITY-CODE
  7956         MOVE AL-UABON           TO  ACTCDA
  7957         MOVE -1                 TO  ACTCDL
  7958         MOVE ER-3526            TO  EMI-ERROR
  7959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7960         GO TO 0340-EDIT-DATA.
  7961
  7962     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7963     PERFORM 6000-CHECK-AUTO-ACTIVITY THRU 6000-EXIT.
  7964
  7965     IF WS-ACT-REC-FOUND-SW = 'N'
  7966          MOVE +0                TO  ACTCDL
  7967          GO TO 0340-EDIT-DATA.
  7968
  7969     IF ACTCDI = ZEROS
  7970         NEXT SENTENCE
  7971     ELSE
  7972         MOVE ACTCDI             TO  SUB
  7973         SUBTRACT +9 FROM SUB
  7974         IF CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N'
  7975             MOVE AL-UABON       TO  ACTCDA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL150.cbl
  7976             MOVE -1             TO  ACTCDL
  7977             MOVE ER-3545        TO  EMI-ERROR
  7978             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7979             GO TO 0340-EDIT-DATA.
  7980
  7981     IF ACTCDI = ZEROS
  7982         IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  7983             PERFORM 6100-RESET-AUTO-ACTIVITY THRU 6100-EXIT
  7984             MOVE AL-UANOF       TO  ACTCDA
  7985             GO TO 0340-EDIT-DATA.
  7986
  7987     MOVE 'Y'                    TO  WS-LETTER-SW.
  7988     MOVE AL-UANOF               TO  ACTCDA.
  7989
  7990 0340-EDIT-DATA.
  7991
  7992     IF EMI-NO-ERRORS
  7993         IF PRTOPTL NOT = FORMATL
  7994             MOVE AL-UABON       TO PRTOPTA  FORMATA
  7995             MOVE -1             TO PRTOPTL
  7996             MOVE ER-0336 TO EMI-ERROR
  7997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7998
  7999     IF PRTOPTL > 0
  8000        IF (NOT PI-NO-CARRIER-SECURITY OR
  8001            NOT PI-NO-ACCOUNT-SECURITY)
  8002           IF ALTPRTL NOT > 0
  8003              MOVE AL-UABON      TO ALTPRTA
  8004              MOVE -1            TO ALTPRTL
  8005              MOVE ER-2379       TO EMI-ERROR
  8006              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8007
  8008     IF NOT EMI-NO-ERRORS
  8009         IF EMI-FORCABLE-CTR = ZEROS AND
  8010            EMI-FATAL-CTR = ZEROS
  8011             NEXT SENTENCE
  8012         ELSE
  8013             GO TO 8200-SEND-DATAONLY.
  8014
  8015     IF FILETOL NOT > 0        AND
  8016*       MCRFLML NOT > 0        AND
  8017        ACTCDL  NOT > 0        AND
  8018        ASSOCL  NOT > 0        AND
  8019        CLOANL  NOT > 0        AND
  8020        YESNOSWL NOT > 0
  8021         GO TO 0350-PROCESS-OPTIONS.
  8022
  8023
  8024* EXEC CICS HANDLE CONDITION
  8025*        NOTFND   (0450-NOT-FOUND)
  8026*    END-EXEC.
  8027*    MOVE '"$I                   ! # #00007971' TO DFHEIV0
  8028     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8030     MOVE X'2320233030303037393731' TO DFHEIV0(25:11)
  8031     CALL 'kxdfhei1' USING DFHEIV0
  8032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8033
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL150.cbl
  8034
  8035     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8036     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8037     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  8038     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8039     MOVE 'MSTR'                 TO FILE-SWITCH.
  8040
  8041
  8042* EXEC CICS READ
  8043*        UPDATE
  8044*        DATASET   ('ELMSTR')
  8045*        RIDFLD    (ELMSTR-KEY)
  8046*        INTO      (CLAIM-MASTER)
  8047*    END-EXEC.
  8048     MOVE LENGTH OF
  8049      CLAIM-MASTER
  8050       TO DFHEIV11
  8051     MOVE 'ELMSTR' TO DFHEIV1
  8052*    MOVE '&"IL       EU         (   #00007981' TO DFHEIV0
  8053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8054     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8055     MOVE X'2020233030303037393831' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           DFHEIV1,
  8058           CLAIM-MASTER,
  8059           DFHEIV11,
  8060           ELMSTR-KEY,
  8061           DFHEIV99,
  8062           DFHEIV99,
  8063           DFHEIV99
  8064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8065
  8066
  8067     IF ACTCDL > +0
  8068         IF CL-LAST-MAINT-USER NOT = PI-UPDATE-BY
  8069             MOVE ER-0068        TO  EMI-ERROR
  8070             MOVE -1             TO  ACTCDL
  8071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8072             GO TO 8200-SEND-DATAONLY
  8073         ELSE
  8074             NEXT SENTENCE
  8075     ELSE
  8076         IF (CL-LAST-MAINT-USER NOT = PI-UPDATE-BY) OR
  8077            (CL-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS)
  8078               MOVE ER-0068      TO EMI-ERROR
  8079               MOVE -1           TO FILETOL
  8080               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8081               GO TO 8200-SEND-DATAONLY.
  8082
  8083     MOVE 'ELMSTR  '             TO FILE-ID.
  8084
  8085*    IF MCRFLML > 0
  8086*        MOVE MCRFLMI            TO CL-MICROFILM-NO.
  8087
  8088     IF FILETOL > 0
  8089         IF FILETOI  = CL-FILE-LOCATION
  8090             MOVE ZEROS          TO FILETOL
  8091         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL150.cbl
  8092             MOVE FILETOI        TO CL-FILE-LOCATION.
  8093
  8094     IF CLOANL > 0
  8095        IF CLOANI NOT = SPACES
  8096           MOVE CL-CONTROL-PRIMARY
  8097                                 TO ELTRLR-KEY
  8098           MOVE +91              TO TRLR-SEQ-NO
  8099           MOVE 'TRLR'           TO FILE-SWITCH
  8100
  8101* EXEC CICS READ
  8102*             UPDATE
  8103*             DATASET   ('ELTRLR')
  8104*             RIDFLD    (ELTRLR-KEY)
  8105*             SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8106*             RESP      (WS-RESPONSE)
  8107*          END-EXEC
  8108     MOVE 'ELTRLR' TO DFHEIV1
  8109*    MOVE '&"S        EU         (  N#00008021' TO DFHEIV0
  8110     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8111     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8112     MOVE X'204E233030303038303231' TO DFHEIV0(25:11)
  8113     CALL 'kxdfhei1' USING DFHEIV0,
  8114           DFHEIV1,
  8115           DFHEIV20,
  8116           DFHEIV99,
  8117           ELTRLR-KEY,
  8118           DFHEIV99,
  8119           DFHEIV99,
  8120           DFHEIV99
  8121     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8122         DFHEIV20
  8123     MOVE EIBRESP  TO WS-RESPONSE
  8124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8125           IF WS-RESP-NORMAL
  8126              MOVE CLOANI        TO AT-INFO-LINE-1
  8127              MOVE PI-PROCESSOR-ID
  8128                                 TO AT-GEN-INFO-LAST-UPDATED-BY
  8129              MOVE SAVE-BIN-DATE TO AT-GEN-INFO-LAST-MAINT-DT
  8130              MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
  8131
  8132* EXEC CICS REWRITE
  8133*                DATASET   ('ELTRLR')
  8134*                FROM      (ACTIVITY-TRAILERS)
  8135*             END-EXEC
  8136     MOVE LENGTH OF
  8137      ACTIVITY-TRAILERS
  8138       TO DFHEIV11
  8139     MOVE 'ELTRLR' TO DFHEIV1
  8140*    MOVE '&& L                  %   #00008034' TO DFHEIV0
  8141     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8142     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8143     MOVE X'2020233030303038303334' TO DFHEIV0(25:11)
  8144     CALL 'kxdfhei1' USING DFHEIV0,
  8145           DFHEIV1,
  8146           ACTIVITY-TRAILERS,
  8147           DFHEIV11,
  8148           DFHEIV99
  8149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL150.cbl
  8150           ELSE
  8151              IF WS-RESP-NOTFND
  8152
  8153* EXEC CICS GETMAIN
  8154*                   SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8155*                   LENGTH    (200)
  8156*                   INITIMG   (GETMAIN-SPACE)
  8157*                END-EXEC
  8158     MOVE 200
  8159       TO DFHEIV11
  8160*    MOVE ',"IL                  $   #00008040' TO DFHEIV0
  8161     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8162     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8163     MOVE X'2020233030303038303430' TO DFHEIV0(25:11)
  8164     CALL 'kxdfhei1' USING DFHEIV0,
  8165           DFHEIV20,
  8166           DFHEIV11,
  8167           GETMAIN-SPACE
  8168     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8169         DFHEIV20
  8170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8171                 MOVE 'AT'       TO AT-RECORD-ID
  8172                 MOVE CL-CONTROL-PRIMARY
  8173                                 TO AT-CONTROL-PRIMARY
  8174                 MOVE +91        TO AT-SEQUENCE-NO
  8175                 MOVE CLOANI     TO AT-INFO-LINE-1
  8176                 MOVE '6'        TO AT-TRAILER-TYPE
  8177                 MOVE PI-PROCESSOR-ID
  8178                                 TO AT-RECORDED-BY
  8179                                    AT-GEN-INFO-LAST-UPDATED-BY
  8180                 MOVE SAVE-BIN-DATE
  8181                                 TO AT-RECORDED-DT
  8182                                    AT-GEN-INFO-LAST-MAINT-DT
  8183                 MOVE EIBTIME    TO AT-LAST-MAINT-HHMMSS
  8184
  8185* EXEC CICS WRITE
  8186*                   DATASET   ('ELTRLR')
  8187*                   FROM      (ACTIVITY-TRAILERS)
  8188*                   RIDFLD    (AT-CONTROL-PRIMARY)
  8189*                END-EXEC
  8190     MOVE LENGTH OF
  8191      ACTIVITY-TRAILERS
  8192       TO DFHEIV11
  8193     MOVE 'ELTRLR' TO DFHEIV1
  8194*    MOVE '&$ L                  ''   #00008058' TO DFHEIV0
  8195     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8196     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8197     MOVE X'2020233030303038303538' TO DFHEIV0(25:11)
  8198     CALL 'kxdfhei1' USING DFHEIV0,
  8199           DFHEIV1,
  8200           ACTIVITY-TRAILERS,
  8201           DFHEIV11,
  8202           AT-CONTROL-PRIMARY,
  8203           DFHEIV99,
  8204           DFHEIV99
  8205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8206              END-IF
  8207           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL150.cbl
  8208        END-IF
  8209     END-IF
  8210
  8211     IF YESNOSWI EQUAL TO CL-YESNOSW
  8212         MOVE ZEROS    TO YESNOSWL
  8213     ELSE
  8214         MOVE YESNOSWI TO CL-YESNOSW
  8215     END-IF.
  8216
  8217     IF WS-ACT-REC-FOUND-SW = 'Y'
  8218         IF ACTCDL > +0
  8219             MOVE ACTCDI             TO  CL-ACTIVITY-CODE
  8220             MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
  8221                                         DC-BIN-DATE-1
  8222             MOVE ' '                TO  DC-OPTION-CODE
  8223             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8224             MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO.
  8225
  8226     IF WS-ACT-REC-FOUND-SW = 'Y'
  8227         IF ACTCDL > +0
  8228             IF ACTCDI = ZEROS
  8229                 MOVE SPACES         TO  CL-ACTIVITY-MAINT-TYPE
  8230                                         ACTTYPO
  8231             ELSE
  8232                 MOVE WS-ACTIVITY-CODE   TO  SUB
  8233                 SUBTRACT 9 FROM SUB
  8234                 MOVE CF-USER-ACTIVITY-DESC (SUB)
  8235                                     TO  WS-ACT-USER-DESC
  8236                 MOVE WS-DESC-1-3    TO  CL-ACTIVITY-MAINT-TYPE
  8237                                         ACTTYPO.
  8238
  8239     IF WS-ACT-REC-FOUND-SW = 'Y'
  8240         IF ACTCDL > +0
  8241             IF WS-UPDATE-SW = 'Y'
  8242                 MOVE LOW-VALUES     TO  CL-NEXT-RESEND-DT
  8243                                         CL-NEXT-FOLLOWUP-DT.
  8244
  8245     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8246         IF ASSOCL > +0
  8247             MOVE ASSOCI         TO  CL-ASSOCIATES.
  8248
  8249     IF PI-COMPANY-ID = 'FLA'
  8250         NEXT SENTENCE
  8251     ELSE
  8252         MOVE '3'                TO  CL-LAST-MAINT-TYPE
  8253         MOVE PI-PROCESSOR-ID    TO  CL-LAST-MAINT-USER
  8254                                     SV-LAST-BY
  8255         MOVE EIBTIME            TO  CL-LAST-MAINT-HHMMSS
  8256                                     SV-LAST-HHMMSS
  8257         MOVE SAVE-BIN-DATE      TO  CL-LAST-MAINT-DT.
  8258
  8259 0350-PROCESS-OPTIONS.
  8260     IF PRTOPTL NOT > 0
  8261         GO TO 0400-WRITE-CLAIM.
  8262
  8263     IF PRTOPTI = 'N'
  8264         GO TO 0380-START-PRINTER.
  8265
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL150.cbl
  8266
  8267* EXEC CICS HANDLE CONDITION
  8268*        NOTFND(0360-CREATE-NEW-ACTQ)
  8269*    END-EXEC.
  8270*    MOVE '"$I                   ! $ #00008123' TO DFHEIV0
  8271     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8272     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8273     MOVE X'2420233030303038313233' TO DFHEIV0(25:11)
  8274     CALL 'kxdfhei1' USING DFHEIV0
  8275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8276
  8277
  8278     MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
  8279     MOVE PI-CARRIER             TO ACTQ-CARRIER.
  8280     MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
  8281     MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
  8282
  8283     MOVE 'ACTQ'                 TO FILE-SWITCH.
  8284     MOVE 'ELACTQ  '             TO FILE-ID.
  8285
  8286
  8287* EXEC CICS READ
  8288*        UPDATE
  8289*        DATASET   ('ELACTQ')
  8290*        SET       (ADDRESS OF ACTIVITY-QUE)
  8291*        RIDFLD    (ELACTQ-KEY)
  8292*    END-EXEC.
  8293     MOVE 'ELACTQ' TO DFHEIV1
  8294*    MOVE '&"S        EU         (   #00008135' TO DFHEIV0
  8295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8297     MOVE X'2020233030303038313335' TO DFHEIV0(25:11)
  8298     CALL 'kxdfhei1' USING DFHEIV0,
  8299           DFHEIV1,
  8300           DFHEIV20,
  8301           DFHEIV99,
  8302           ELACTQ-KEY,
  8303           DFHEIV99,
  8304           DFHEIV99,
  8305           DFHEIV99
  8306     SET ADDRESS OF ACTIVITY-QUE TO
  8307         DFHEIV20
  8308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8309
  8310
  8311     IF FORMATI = 'F'
  8312         MOVE '1'                TO AQ-PENDING-STATUS-FLAG
  8313     ELSE
  8314         MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
  8315
  8316     MOVE +150                   TO AQ-LAST-UPDATED-BY.
  8317
  8318     MOVE 'ELACTQ  '             TO FILE-ID.
  8319
  8320
  8321* EXEC CICS REWRITE
  8322*        DATASET   ('ELACTQ')
  8323*        FROM      (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL150.cbl
  8324*    END-EXEC.
  8325     MOVE LENGTH OF
  8326      ACTIVITY-QUE
  8327       TO DFHEIV11
  8328     MOVE 'ELACTQ' TO DFHEIV1
  8329*    MOVE '&& L                  %   #00008151' TO DFHEIV0
  8330     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8331     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8332     MOVE X'2020233030303038313531' TO DFHEIV0(25:11)
  8333     CALL 'kxdfhei1' USING DFHEIV0,
  8334           DFHEIV1,
  8335           ACTIVITY-QUE,
  8336           DFHEIV11,
  8337           DFHEIV99
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8339
  8340
  8341     GO TO 0400-WRITE-CLAIM.
  8342
  8343 0360-CREATE-NEW-ACTQ.
  8344
  8345* EXEC CICS GETMAIN
  8346*        SET       (ADDRESS OF ACTIVITY-QUE)
  8347*        LENGTH    (60)
  8348*        INITIMG   (GETMAIN-SPACE)
  8349*    END-EXEC.
  8350     MOVE 60
  8351       TO DFHEIV11
  8352*    MOVE ',"IL                  $   #00008159' TO DFHEIV0
  8353     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8354     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8355     MOVE X'2020233030303038313539' TO DFHEIV0(25:11)
  8356     CALL 'kxdfhei1' USING DFHEIV0,
  8357           DFHEIV20,
  8358           DFHEIV11,
  8359           GETMAIN-SPACE
  8360     SET ADDRESS OF ACTIVITY-QUE TO
  8361         DFHEIV20
  8362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8363
  8364
  8365     MOVE 'AQ'                   TO AQ-RECORD-ID.
  8366     MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
  8367     MOVE PI-CARRIER             TO AQ-CARRIER.
  8368     MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
  8369     MOVE PI-CERT-NO             TO AQ-CERT-NO.
  8370
  8371     IF FORMATI = 'F'
  8372         MOVE '1'                TO AQ-PENDING-STATUS-FLAG
  8373     ELSE
  8374         MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
  8375
  8376     MOVE +0                     TO AQ-PAYMENT-COUNTER
  8377                                    AQ-PMT-UNAPPROVED-COUNT.
  8378
  8379     MOVE LOW-VALUES             TO AQ-RESEND-DATE
  8380                                    AQ-FOLLOWUP-DATE.
  8381
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL150.cbl
  8382     MOVE +150                   TO AQ-LAST-UPDATED-BY.
  8383
  8384     MOVE 'ACTQ'                 TO FILE-SWITCH.
  8385
  8386     MOVE 'ELACTQ  '             TO FILE-ID.
  8387
  8388
  8389* EXEC CICS WRITE
  8390*        DATASET   ('ELACTQ')
  8391*        FROM      (ACTIVITY-QUE)
  8392*        RIDFLD    (AQ-CONTROL-PRIMARY)
  8393*    END-EXEC.
  8394     MOVE LENGTH OF
  8395      ACTIVITY-QUE
  8396       TO DFHEIV11
  8397     MOVE 'ELACTQ' TO DFHEIV1
  8398*    MOVE '&$ L                  ''   #00008188' TO DFHEIV0
  8399     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8401     MOVE X'2020233030303038313838' TO DFHEIV0(25:11)
  8402     CALL 'kxdfhei1' USING DFHEIV0,
  8403           DFHEIV1,
  8404           ACTIVITY-QUE,
  8405           DFHEIV11,
  8406           AQ-CONTROL-PRIMARY,
  8407           DFHEIV99,
  8408           DFHEIV99
  8409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8410
  8411
  8412     GO TO 0400-WRITE-CLAIM.
  8413
  8414 0380-START-PRINTER.
  8415
  8416* EXEC CICS HANDLE CONDITION
  8417*         TERMIDERR    (0385-TERMID-ERROR)
  8418*         TRANSIDERR   (0390-TRANS-ERROR)
  8419*    END-EXEC.
  8420*    MOVE '"$[\                  ! % #00008197' TO DFHEIV0
  8421     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  8422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8423     MOVE X'2520233030303038313937' TO DFHEIV0(25:11)
  8424     CALL 'kxdfhei1' USING DFHEIV0
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8426
  8427
  8428     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  8429     MOVE '1'                    TO CNTL-REC-TYPE.
  8430     MOVE SPACES                 TO CNTL-ACCESS.
  8431     MOVE +0                     TO CNTL-SEQ-NO.
  8432     MOVE 'CNTL'                 TO FILE-SWITCH.
  8433
  8434
  8435* EXEC CICS READ
  8436*        DATASET   ('ELCNTL')
  8437*        SET       (ADDRESS OF CONTROL-FILE)
  8438*        RIDFLD    (ELCNTL-KEY)
  8439*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL150.cbl
  8440     MOVE 'ELCNTL' TO DFHEIV1
  8441*    MOVE '&"S        E          (   #00008208' TO DFHEIV0
  8442     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8444     MOVE X'2020233030303038323038' TO DFHEIV0(25:11)
  8445     CALL 'kxdfhei1' USING DFHEIV0,
  8446           DFHEIV1,
  8447           DFHEIV20,
  8448           DFHEIV99,
  8449           ELCNTL-KEY,
  8450           DFHEIV99,
  8451           DFHEIV99,
  8452           DFHEIV99
  8453     SET ADDRESS OF CONTROL-FILE TO
  8454         DFHEIV20
  8455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8456
  8457
  8458     IF CF-FORMS-PRINTER-ID = SPACES
  8459         MOVE ER-0337            TO EMI-ERROR
  8460         MOVE -1                 TO FILETOL
  8461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8462         GO TO 8200-SEND-DATAONLY.
  8463
  8464     IF FORMATI = 'F'
  8465         MOVE '2'                TO PI-ENTRY-CD-1
  8466     ELSE
  8467         MOVE '1'                TO PI-ENTRY-CD-1.
  8468
  8469     IF PI-PROCESSOR-PRINTER NOT = SPACES
  8470         MOVE PI-PROCESSOR-PRINTER  TO  CF-FORMS-PRINTER-ID.
  8471
  8472     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8473
  8474     IF ALTPRTL > 0
  8475        MOVE ALTPRTI             TO CF-FORMS-PRINTER-ID
  8476                                    PI-ALT-DMD-PRT-ID.
  8477
  8478     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  8479*       MOVE EIBTRMID            TO CF-FORMS-PRINTER-ID
  8480
  8481* EXEC CICS START
  8482*            TRANSID   (START-TRANS-ID)
  8483*            FROM      (PROGRAM-INTERFACE-BLOCK)
  8484*            LENGTH    (PI-COMM-LENGTH)
  8485*            TERMID    ('A155')
  8486*            TERMID    (CF-FORMS-PRINTER-ID)
  8487*        END-EXEC
  8488*    MOVE '0( LF                 0   #00008236' TO DFHEIV0
  8489     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  8490     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  8491     MOVE X'2020233030303038323336' TO DFHEIV0(25:11)
  8492     CALL 'kxdfhei1' USING DFHEIV0,
  8493           DFHEIV99,
  8494           START-TRANS-ID,
  8495           DFHEIV99,
  8496           PROGRAM-INTERFACE-BLOCK,
  8497           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL150.cbl
  8498           DFHEIV99,
  8499           DFHEIV99,
  8500           DFHEIV99,
  8501           DFHEIV99,
  8502           DFHEIV99,
  8503           DFHEIV99,
  8504           DFHEIV99,
  8505           DFHEIV99,
  8506           DFHEIV99,
  8507           DFHEIV99
  8508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8509     ELSE
  8510
  8511* EXEC CICS START
  8512*            TRANSID   (START-TRANS-ID)
  8513*            TERMID    (CF-FORMS-PRINTER-ID)
  8514*            TERMID    ('PRN1')
  8515*            FROM      (PROGRAM-INTERFACE-BLOCK)
  8516*            LENGTH    (PI-COMM-LENGTH)
  8517*        END-EXEC.
  8518*    MOVE '0( LFT                0   #00008244' TO DFHEIV0
  8519     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  8520     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  8521     MOVE X'2020233030303038323434' TO DFHEIV0(25:11)
  8522     CALL 'kxdfhei1' USING DFHEIV0,
  8523           DFHEIV99,
  8524           START-TRANS-ID,
  8525           DFHEIV99,
  8526           PROGRAM-INTERFACE-BLOCK,
  8527           PI-COMM-LENGTH,
  8528           CF-FORMS-PRINTER-ID,
  8529           DFHEIV99,
  8530           DFHEIV99,
  8531           DFHEIV99,
  8532           DFHEIV99,
  8533           DFHEIV99,
  8534           DFHEIV99,
  8535           DFHEIV99,
  8536           DFHEIV99,
  8537           DFHEIV99
  8538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8539
  8540
  8541      GO TO 0400-WRITE-CLAIM.
  8542
  8543 0385-TERMID-ERROR.
  8544     MOVE ER-0412                TO EMI-ERROR.
  8545     MOVE -1                     TO ALTPRTL.
  8546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8547     GO TO 8200-SEND-DATAONLY.
  8548
  8549 0390-TRANS-ERROR.
  8550     MOVE ER-0413                TO EMI-ERROR.
  8551     MOVE -1                     TO FILETOL.
  8552     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8553     GO TO 8200-SEND-DATAONLY.
  8554
  8555 0400-WRITE-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL150.cbl
  8556     IF FILETOL = 0  AND
  8557*       MCRFLML = 0  AND
  8558        ACTCDL  = 0  AND
  8559        ASSOCL  = 0  AND
  8560        CLOANL  = 0  AND
  8561        YESNOSWL = 0
  8562         GO TO 0440-UPDATE-DONE.
  8563
  8564
  8565* EXEC CICS HANDLE CONDITION
  8566*        NOTFND (0450-NOT-FOUND)
  8567*        DUPKEY (0440-UPDATE-DONE)
  8568*    END-EXEC.
  8569*    MOVE '"$I$                  ! & #00008275' TO DFHEIV0
  8570     MOVE X'222449242020202020202020' TO DFHEIV0(1:12)
  8571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8572     MOVE X'2620233030303038323735' TO DFHEIV0(25:11)
  8573     CALL 'kxdfhei1' USING DFHEIV0
  8574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8575
  8576
  8577     MOVE 'ELMSTR  '             TO FILE-ID.
  8578
  8579
  8580* EXEC CICS REWRITE
  8581*        DATASET   ('ELMSTR')
  8582*        FROM      (CLAIM-MASTER)
  8583*    END-EXEC.
  8584     MOVE LENGTH OF
  8585      CLAIM-MASTER
  8586       TO DFHEIV11
  8587     MOVE 'ELMSTR' TO DFHEIV1
  8588*    MOVE '&& L                  %   #00008282' TO DFHEIV0
  8589     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8590     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8591     MOVE X'2020233030303038323832' TO DFHEIV0(25:11)
  8592     CALL 'kxdfhei1' USING DFHEIV0,
  8593           DFHEIV1,
  8594           CLAIM-MASTER,
  8595           DFHEIV11,
  8596           DFHEIV99
  8597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8598
  8599
  8600 0440-UPDATE-DONE.
  8601     IF FILETOL  > 0 OR
  8602*       MCRFLML  > 0 OR
  8603        PRTOPTL  > 0 OR
  8604        FORMATL  > 0 OR
  8605        YESNOSWL > 0 OR
  8606        CLOANL   > 0 OR
  8607        ACTCDL   > 0
  8608            MOVE SV-LAST-BY             TO PI-UPDATE-BY
  8609            MOVE SV-LAST-HHMMSS         TO PI-UPDATE-HHMMSS.
  8610
  8611     PERFORM 6050-AUTO-LETTER-WRITER THRU 6050-EXIT.
  8612
  8613     MOVE ER-0000                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL150.cbl
  8614     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8615
  8616     IF CLAIM-IS-PURGED
  8617        CONTINUE
  8618*        MOVE -1                 TO  MCRFLML
  8619     ELSE
  8620         MOVE -1                 TO  FILETOL
  8621     END-IF
  8622
  8623     GO TO 8200-SEND-DATAONLY.
  8624
  8625 0450-NOT-FOUND.
  8626     IF FILE-SWITCH = 'MSTR'
  8627         MOVE ER-0204            TO EMI-ERROR
  8628     ELSE
  8629         MOVE ER-0190            TO EMI-ERROR.
  8630
  8631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8632
  8633     MOVE -1                     TO FILETOL.
  8634     GO TO 8200-SEND-DATAONLY.
  8635
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL150.cbl
  8637 0500-CREATE-TEMP-STORAGE.
  8638
  8639     IF PI-SAVE-SYS-ID = 'CR'
  8640        IF PI-CLOSED
  8641           IF PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION
  8642              IF EIBAID = DFHPF7
  8643                 MOVE ER-0934            TO EMI-ERROR
  8644                 MOVE -1                 TO FILETOL
  8645                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8646                 GO TO 8200-SEND-DATAONLY
  8647              ELSE
  8648              IF EIBAID = DFHPF8
  8649                 MOVE ER-0935            TO EMI-ERROR
  8650                 MOVE -1                 TO FILETOL
  8651                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8652                 GO TO 8200-SEND-DATAONLY.
  8653
  8654     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8655
  8656     MOVE LOW-VALUES TO PI-SAVE-FILETO  PI-SAVE-PRTOPT
  8657                        PI-SAVE-FORMAT  PI-SAVE-MCRFLM
  8658                        PI-SAVE-ACT-CD  PI-SAVE-ASSOC
  8659                        TS-PI-SAVE-CLOAN.
  8660
  8661     MOVE FILETOI                TO PI-SAVE-FILETO.
  8662*    MOVE MCRFLMI                TO PI-SAVE-MCRFLM.
  8663     MOVE PRTOPTI                TO PI-SAVE-PRTOPT.
  8664     MOVE FORMATI                TO PI-SAVE-FORMAT.
  8665     MOVE ACTCDI                 TO PI-SAVE-ACT-CD.
  8666     MOVE CLOANI                 TO TS-PI-SAVE-CLOAN
  8667
  8668     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8669         MOVE ASSOCI             TO PI-SAVE-ASSOC.
  8670
  8671     MOVE PROGRAM-INTERFACE-BLOCK TO TS-PI-AREA
  8672
  8673
  8674* EXEC CICS WRITEQ TS
  8675*        QUEUE    (QID)
  8676*        FROM     (PROGRAM-INTERFACE-BLOCK)
  8677*        FROM     (TS-AREA)
  8678*        LENGTH   (PI-COMM-LENGTH)
  8679*        LENGTH   (TS-LENGTH)
  8680*    END-EXEC.
  8681*    MOVE '*"                    ''   #00008360' TO DFHEIV0
  8682     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8684     MOVE X'2020233030303038333630' TO DFHEIV0(25:11)
  8685     CALL 'kxdfhei1' USING DFHEIV0,
  8686           QID,
  8687           TS-AREA,
  8688           TS-LENGTH,
  8689           DFHEIV99,
  8690           DFHEIV99,
  8691           DFHEIV99
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8693
  8694
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL150.cbl
  8695 0500-PF-CHECKS.
  8696
  8697     IF EIBAID = DFHPF3
  8698         IF PI-SAVE-SYS-ID = 'CV'
  8699             MOVE XCTL-EM131     TO PGM-NAME
  8700             GO TO 9300-XCTL
  8701         ELSE
  8702             MOVE XCTL-131       TO PGM-NAME
  8703             GO TO 9300-XCTL.
  8704
  8705     IF EIBAID = DFHPF4
  8706         MOVE XCTL-153           TO PGM-NAME
  8707         GO TO 9300-XCTL.
  8708
  8709     IF EIBAID = DFHPF5
  8710         IF PI-SAVE-SYS-ID = 'CV'
  8711             MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
  8712             MOVE XCTL-EM1273    TO PGM-NAME
  8713             GO TO 9300-XCTL
  8714         ELSE
  8715             MOVE XCTL-1273      TO PGM-NAME
  8716             GO TO 9300-XCTL.
  8717
  8718     IF EIBAID = DFHPF6
  8719       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6)
  8720         MOVE XCTL-154           TO PGM-NAME
  8721         GO TO 9300-XCTL.
  8722
  8723     IF EIBAID = DFHPF7
  8724       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7)
  8725         IF PI-SAVE-SYS-ID = 'CV'
  8726             IF PI-SAVE-TYPE = PI-LIFE-OVERRIDE-L1
  8727                 MOVE XCTL-EM156    TO  PGM-NAME
  8728                 GO TO 9300-XCTL
  8729             ELSE
  8730                 MOVE XCTL-EM1561   TO  PGM-NAME
  8731                 GO TO 9300-XCTL
  8732         ELSE
  8733             MOVE XCTL-156          TO PGM-NAME
  8734             GO TO 9300-XCTL.
  8735
  8736     IF EIBAID = DFHPF8
  8737         MOVE XCTL-151           TO PGM-NAME
  8738         GO TO 9300-XCTL.
  8739
  8740     IF EIBAID = DFHPF9
  8741         MOVE XCTL-152           TO PGM-NAME
  8742         GO TO 9300-XCTL.
  8743
  8744     IF EIBAID = DFHPF10
  8745         MOVE PI-SAVE-LOW        TO PI-PASS-AREA
  8746         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  8747         MOVE XCTL-142           TO PGM-NAME
  8748         GO TO 9300-XCTL.
  8749
  8750     IF EIBAID = DFHPF11
  8751        IF PI-COMPANY-ID = 'DMD'
  8752           MOVE XCTL-155           TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL150.cbl
  8753           GO TO 9300-XCTL
  8754         ELSE
  8755           MOVE XCTL-157           TO PGM-NAME
  8756           GO TO 9300-XCTL.
  8757
  8758     IF EIBAID = DFHPF13
  8759         MOVE PI-SAVE-FORM       TO PI-PASS-AREA
  8760         MOVE XCTL-155           TO PGM-NAME
  8761         GO TO 9300-XCTL.
  8762
  8763     IF EIBAID = DFHPF14
  8764         MOVE XCTL-141           TO PGM-NAME
  8765         GO TO 9300-XCTL.
  8766
  8767     IF EIBAID = DFHPF17
  8768         MOVE XCTL-162           TO PGM-NAME
  8769         GO TO 9300-XCTL.
  8770
  8771     IF EIBAID = DFHPF18
  8772         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  8773         MOVE XCTL-1501          TO PGM-NAME
  8774         GO TO 9300-XCTL.
  8775
  8776     IF EIBAID = DFHPF19
  8777         IF PI-SAVE-SYS-ID = 'CV'
  8778             MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
  8779             MOVE XCTL-EM1276    TO PGM-NAME
  8780             GO TO 9300-XCTL
  8781         ELSE
  8782         IF PI-COMPANY-ID = 'DMD'
  8783             MOVE 'EL401DMD'     TO PGM-NAME
  8784             GO TO 9300-XCTL
  8785          ELSE
  8786             MOVE XCTL-1279      TO PGM-NAME
  8787             GO TO 9300-XCTL.
  8788
  8789     IF EIBAID = DFHPF20
  8790         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  8791         MOVE XCTL-1502          TO PGM-NAME
  8792         GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL150.cbl
  8794 0600-RECOVER-TEMP-STORAGE.
  8795     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  8796
  8797
  8798* EXEC CICS HANDLE CONDITION
  8799*        QIDERR   (0690-QIDERR)
  8800*    END-EXEC
  8801*    MOVE '"$N                   ! '' #00008470' TO DFHEIV0
  8802     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8804     MOVE X'2720233030303038343730' TO DFHEIV0(25:11)
  8805     CALL 'kxdfhei1' USING DFHEIV0
  8806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8807
  8808
  8809* EXEC CICS READQ TS
  8810*        QUEUE    (QID)
  8811*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8812*        INTO     (TS-AREA)
  8813*        LENGTH   (PI-COMM-LENGTH)
  8814*        LENGTH   (TS-LENGTH)
  8815*    END-EXEC
  8816*    MOVE '*$I    L              ''   #00008474' TO DFHEIV0
  8817     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8819     MOVE X'2020233030303038343734' TO DFHEIV0(25:11)
  8820     CALL 'kxdfhei1' USING DFHEIV0,
  8821           QID,
  8822           TS-AREA,
  8823           TS-LENGTH,
  8824           DFHEIV99,
  8825           DFHEIV99,
  8826           DFHEIV99
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8828
  8829     MOVE TS-PI-AREA        TO PROGRAM-INTERFACE-BLOCK
  8830
  8831
  8832* EXEC CICS DELETEQ TS
  8833*        QUEUE   (QID)
  8834*    END-EXEC.
  8835*    MOVE '*&                    #   #00008484' TO DFHEIV0
  8836     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8837     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8838     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  8839     CALL 'kxdfhei1' USING DFHEIV0,
  8840           QID,
  8841           DFHEIV99
  8842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8843
  8844
  8845     IF RETURNED-FROM NOT = XCTL-EM1273
  8846         MOVE SAVE-CONTROL       TO PI-CONTROL-IN-PROGRESS.
  8847
  8848     MOVE LOW-VALUES             TO EL150AO.
  8849
  8850*    IF PI-SAVE-MCRFLM NOT = LOW-VALUES
  8851*        MOVE PI-SAVE-MCRFLM     TO MCRFLMO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL150.cbl
  8852
  8853     IF PI-SAVE-FILETO NOT = LOW-VALUES
  8854         MOVE PI-SAVE-FILETO     TO FILETOO.
  8855
  8856     IF TS-PI-SAVE-CLOAN NOT = LOW-VALUES
  8857        MOVE TS-PI-SAVE-CLOAN   TO CLOANO
  8858     END-IF
  8859
  8860     IF PI-SAVE-PRTOPT NOT = LOW-VALUES
  8861         MOVE PI-SAVE-PRTOPT     TO PRTOPTO
  8862         MOVE AL-UANON           TO PRTOPTA.
  8863
  8864     IF PI-SAVE-FORMAT NOT = LOW-VALUES
  8865         MOVE PI-SAVE-FORMAT     TO FORMATO
  8866         MOVE AL-UANON           TO FORMATA.
  8867
  8868     IF PI-SAVE-ACT-CD NOT = LOW-VALUES
  8869         MOVE PI-SAVE-ACT-CD     TO ACTCDO.
  8870
  8871     IF PI-SAVE-ASSOC  NOT = LOW-VALUES
  8872         MOVE PI-SAVE-ASSOC      TO ASSOCO.
  8873
  8874     MOVE 'N'                    TO DIRECTION-SWITCH.
  8875
  8876     MOVE SPACES TO PI-PFKEY-USED.
  8877     MOVE 0      TO PI-FORCE-COUNT.
  8878
  8879     GO TO 1000-SHOW-CLAIM.
  8880
  8881 0690-QIDERR.
  8882     MOVE ER-0033                TO EMI-ERROR.
  8883     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8884     MOVE LOW-VALUES             TO EL150AO.
  8885     MOVE -1                     TO FILETOL.
  8886     GO TO 8100-SEND-INITIAL-MAP.
  8887
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL150.cbl
  8889 1000-SHOW-CLAIM.
  8890
  8891     IF CLMNOL > 0
  8892         MOVE CLMNOI             TO PI-CLAIM-NO.
  8893
  8894     IF CARRL > 0
  8895         MOVE CARRI              TO PI-CARRIER.
  8896
  8897     IF CERTNOL > 0
  8898         MOVE CERTNOI            TO PI-CERT-PRIME.
  8899
  8900     IF SUFXL > 0
  8901         MOVE SUFXI              TO PI-CERT-SFX.
  8902
  8903     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8904     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8905     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  8906     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8907     MOVE 'MSTR'                 TO FILE-SWITCH.
  8908
  8909 1000-READ-CLAIM.
  8910
  8911
  8912* EXEC CICS HANDLE CONDITION
  8913*        NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
  8914*    END-EXEC.
  8915*    MOVE '"$I                   ! ( #00008554' TO DFHEIV0
  8916     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8918     MOVE X'2820233030303038353534' TO DFHEIV0(25:11)
  8919     CALL 'kxdfhei1' USING DFHEIV0
  8920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8921
  8922
  8923
  8924* EXEC CICS READ
  8925*        DATASET   (PI-CURRENT-FILE)
  8926*        RIDFLD    (ELMSTR-KEY)
  8927*        INTO      (CLAIM-MASTER)
  8928*    END-EXEC.
  8929     MOVE LENGTH OF
  8930      CLAIM-MASTER
  8931       TO DFHEIV11
  8932*    MOVE '&"IL       E          (   #00008558' TO DFHEIV0
  8933     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8935     MOVE X'2020233030303038353538' TO DFHEIV0(25:11)
  8936     CALL 'kxdfhei1' USING DFHEIV0,
  8937           PI-CURRENT-FILE,
  8938           CLAIM-MASTER,
  8939           DFHEIV11,
  8940           ELMSTR-KEY,
  8941           DFHEIV99,
  8942           DFHEIV99,
  8943           DFHEIV99
  8944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8945
  8946
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL150.cbl
  8947 1000-CONTINUE-WITH-RETRIEVED.
  8948
  8949     if (pi-company-id = 'CID' OR 'DCC' OR 'AHL')
  8950        and (cl-priority-cd = '8')
  8951        move 'S'                 to pi-priority-ind
  8952     end-if
  8953
  8954     IF PI-COMPANY-ID = 'DMD'
  8955         IF HIGHEST-PRIORITY
  8956             MOVE 'S'            TO PI-PRIORITY-IND
  8957             MOVE ER-0933        TO EMI-ERROR
  8958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8959         ELSE
  8960             IF NOT CONFIDENTIAL-DATA
  8961                 MOVE LOW-VALUES TO PI-PRIORITY-IND.
  8962
  8963     IF PI-COMPANY-ID = 'DMD'
  8964             AND
  8965        PI-ASS-PROCESSING
  8966             AND
  8967        PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
  8968         NEXT SENTENCE
  8969     ELSE
  8970         MOVE ELMSTR-KEY         TO PI-PREV-CLAIM
  8971         MOVE CL-PRIME-CERT-NO   TO PI-PREV-PRIME-CERT-NO.
  8972
  8973     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
  8974     MOVE CL-PRIORITY-CD         TO PI-PRIORITY-CD.
  8975
  8976     IF CL-LAST-MAINT-HHMMSS IS NOT NUMERIC
  8977         MOVE EIBTIME            TO PI-UPDATE-HHMMSS
  8978     ELSE
  8979         MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  8980
  8981     MOVE CL-TRAILER-SEQ-CNT     TO PI-SAVE-CNT.
  8982
  8983     IF CL-YESNOSW = 'Y' OR 'N'
  8984         MOVE CL-YESNOSW         TO YESNOSWO
  8985     ELSE
  8986         MOVE 'Y'                TO YESNOSWO
  8987     END-IF.
  8988
  8989     MOVE CL-CLAIM-NO            TO CLMNOO
  8990                                    PI-CLAIM-NO.
  8991     MOVE CL-CARRIER             TO CARRO
  8992                                    PI-CARRIER.
  8993     MOVE CL-CERT-PRIME          TO CERTNOO
  8994                                    PI-CERT-PRIME.
  8995     MOVE CL-CERT-SFX            TO SUFXO
  8996                                    PI-CERT-SFX.
  8997     MOVE CL-CCN                 TO CRDCARDO
  8998
  8999     MOVE CL-SYSTEM-IDENTIFIER   TO PI-SAVE-SYS-ID.
  9000
  9001     IF CL-SYSTEM-IDENTIFIER = 'CV'
  9002         MOVE CL-CV-REFERENCE-NO TO PI-MP-REFERENCE-NO.
  9003
  9004     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL150.cbl
  9005         MOVE SPACES                 TO PRIMCRTO
  9006                                        PRIMSFXO
  9007                                        PRIMHDGO
  9008                                        SEQUO
  9009         MOVE AL-SADOF               TO PRIMCRTA
  9010                                        PRIMSFXA
  9011                                        PRIMHDGA
  9012                                        SEQUA
  9013     ELSE
  9014         MOVE CL-ASSOC-CERT-SEQU     TO WS-CUR-SEQU
  9015         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
  9016         MOVE WS-CLAIM-SEQUENCE      TO SEQUO
  9017         MOVE CL-PRIME-CERT-PRIME    TO PRIMCRTO
  9018         MOVE CL-PRIME-CERT-SFX      TO PRIMSFXO
  9019         MOVE 'PRIME CERT :'         TO PRIMHDGO
  9020         MOVE AL-SABON               TO PRIMCRTA
  9021                                        PRIMSFXA
  9022                                        PRIMHDGA
  9023                                        SEQUA.
  9024
  9025     MOVE CL-CLAIM-TYPE          TO PI-SAVE-TYPE.
  9026     MOVE CL-CERT-GROUPING       TO PI-GROUPING.
  9027     MOVE CL-CERT-STATE          TO PI-STATE.
  9028
  9029     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9030         MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
  9031         MOVE CL-CURRENT-ACCOUNT TO  ACCTO
  9032     ELSE
  9033         MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
  9034                                     ACCTO.
  9035
  9036     MOVE CL-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9037
  9038     EVALUATE TRUE
  9039        WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  9040           MOVE PI-AH-OVERRIDE-L6
  9041                                 TO CLMTYPO
  9042
  9043        WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9044           MOVE PI-LIFE-OVERRIDE-L6
  9045                                 TO CLMTYPO
  9046
  9047        WHEN CL-CLAIM-TYPE = 'I'
  9048           MOVE '  IU  '         TO CLMTYPO
  9049
  9050        WHEN CL-CLAIM-TYPE = 'G'
  9051           MOVE ' GAP  '         TO CLMTYPO
  9052
  9053     END-EVALUATE
  9054     IF CLAIM-IS-OPEN
  9055         MOVE ' OPEN'            TO CLMSTATO
  9056     ELSE
  9057         MOVE 'CLOSED'           TO CLMSTATO.
  9058
  9059*    IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  9060*        IF (CLAIM-IS-CLOSED)  AND
  9061*           (CL-LAST-CLOSE-REASON = '2')
  9062*            MOVE 'DENIED'       TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL150.cbl
  9063
  9064     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
  9065     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
  9066     MOVE CL-INSURED-MID-INIT    TO MINITO.
  9067
  9068     IF CL-NO-OF-PMTS-MADE = +0 AND
  9069        CL-TOTAL-PAID-AMT = +0
  9070         NEXT SENTENCE
  9071     ELSE
  9072         IF CL-PAID-THRU-DT NOT = LOW-VALUES
  9073             MOVE CL-PAID-THRU-DT        TO  DC-BIN-DATE-1
  9074             MOVE ' '                    TO  DC-OPTION-CODE
  9075             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9076             MOVE DC-GREG-DATE-1-EDIT    TO  PDTHRUO
  9077             IF PI-USES-PAID-TO
  9078                 MOVE CL-PAID-THRU-DT    TO  DC-BIN-DATE-1
  9079                 MOVE '6'                TO  DC-OPTION-CODE
  9080                 MOVE +1                 TO  DC-ELAPSED-DAYS
  9081                 MOVE +0                 TO  DC-ELAPSED-MONTHS
  9082                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9083                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
  9084
  9085     IF CL-INCURRED-DT NOT = LOW-VALUES
  9086         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9087         MOVE ' '                TO DC-OPTION-CODE
  9088         MOVE +0                 TO DC-ELAPSED-DAYS
  9089                                    DC-ELAPSED-MONTHS
  9090         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9091         MOVE DC-GREG-DATE-1-EDIT TO INCURO.
  9092
  9093     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
  9094        EVALUATE CL-DENIAL-TYPE
  9095           WHEN '1'
  9096              MOVE 'DENIAL STATUS - DENIAL       '
  9097                                 TO DENTYPO
  9098           WHEN '2'
  9099              MOVE 'DENIAL STATUS - RESCISSION   '
  9100                                 TO DENTYPO
  9101           WHEN '3'
  9102              MOVE 'DENIAL STATUS - REFORMATION  '
  9103                                 TO DENTYPO
  9104           WHEN '4'
  9105              MOVE 'DENIAL STATUS - REF TO RESC  '
  9106                                 TO DENTYPO
  9107           WHEN '5'
  9108              MOVE 'DENIAL STATUS - RECONSIDERED '
  9109                                 TO DENTYPO
  9110        END-EVALUATE
  9111        MOVE AL-SANOF            TO DENTYPA
  9112     END-IF
  9113     IF CL-NEXT-AUTO-PAY-DT NOT = LOW-VALUES
  9114         MOVE CL-NEXT-AUTO-PAY-DT TO DC-BIN-DATE-1
  9115         MOVE ' '                TO DC-OPTION-CODE
  9116         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9117         MOVE DC-GREG-DATE-1-EDIT TO NXTAUTOO
  9118         IF PI-USES-PAID-TO
  9119             MOVE CL-NEXT-AUTO-PAY-DT   TO  DC-BIN-DATE-1
  9120             MOVE '6'                   TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL150.cbl
  9121             MOVE +1                    TO  DC-ELAPSED-DAYS
  9122             MOVE +0                    TO  DC-ELAPSED-MONTHS
  9123             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9124             IF NO-CONVERSION-ERROR
  9125                 MOVE DC-GREG-DATE-1-EDIT   TO  NXTAUTOO
  9126             ELSE
  9127                 MOVE LOW-VALUES            TO  NXTAUTOO.
  9128
  9129     IF CL-FILE-ESTABLISH-DT NOT = LOW-VALUES
  9130         MOVE CL-FILE-ESTABLISH-DT      TO  DC-BIN-DATE-1
  9131         MOVE ' '                       TO  DC-OPTION-CODE
  9132         MOVE +0                        TO  DC-ELAPSED-DAYS
  9133                                            DC-ELAPSED-MONTHS
  9134         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9135         IF NO-CONVERSION-ERROR
  9136             MOVE DC-GREG-DATE-1-EDIT   TO  ESTABDTO
  9137         ELSE
  9138             MOVE SPACES                TO  ESTABDTO.
  9139
  9140*    MOVE CL-MICROFILM-NO        TO MCRFLMO.
  9141     MOVE CL-FILE-LOCATION       TO FILETOO.
  9142
  9143     IF CL-CERT-EFF-DT NOT = LOW-VALUES
  9144         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
  9145         MOVE ' '                TO DC-OPTION-CODE
  9146         MOVE +0                 TO DC-ELAPSED-DAYS
  9147                                    DC-ELAPSED-MONTHS
  9148         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9149         MOVE DC-GREG-DATE-1-EDIT TO EFFECTO.
  9150
  9151     IF CL-TOTAL-INT-PAID NOT NUMERIC
  9152        MOVE +0                  TO CL-TOTAL-INT-PAID
  9153     END-IF
  9154     MOVE CL-TOTAL-INT-PAID      TO TOTINTO
  9155     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
  9156     MOVE CL-TOTAL-PAID-AMT      TO PI-TOTAL-PAID.
  9157
  9158     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9159         MOVE CL-CURRENT-STATE   TO  STATEO
  9160     ELSE
  9161     IF PI-COMPANY-ID = 'DMD'
  9162         MOVE PI-COMPANY-CD          TO CERT-COMP-CD
  9163         MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9164         MOVE CL-CERT-GROUPING       TO CERT-GROUPING
  9165         MOVE CL-CERT-STATE          TO CERT-STATE
  9166         MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9167         MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
  9168         MOVE CL-CERT-NO             TO CERT-CERT-NO
  9169         MOVE 'CERT'                 TO FILE-SWITCH
  9170
  9171* EXEC CICS READ
  9172*            DATASET   ('ELCERT')
  9173*            SET       (ADDRESS OF CERTIFICATE-MASTER)
  9174*            RIDFLD    (ELCERT-KEY)
  9175*        END-EXEC
  9176     MOVE 'ELCERT' TO DFHEIV1
  9177*    MOVE '&"S        E          (   #00008787' TO DFHEIV0
  9178     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL150.cbl
  9179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9180     MOVE X'2020233030303038373837' TO DFHEIV0(25:11)
  9181     CALL 'kxdfhei1' USING DFHEIV0,
  9182           DFHEIV1,
  9183           DFHEIV20,
  9184           DFHEIV99,
  9185           ELCERT-KEY,
  9186           DFHEIV99,
  9187           DFHEIV99,
  9188           DFHEIV99
  9189     SET ADDRESS OF CERTIFICATE-MASTER TO
  9190         DFHEIV20
  9191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9192         MOVE CM-RESIDENT-STATE  TO  STATEO
  9193     ELSE
  9194         MOVE CL-CERT-STATE      TO  STATEO.
  9195
  9196     MOVE CL-ACTIVITY-CODE       TO  ACTCDO.
  9197     MOVE CL-ACTIVITY-MAINT-TYPE TO  ACTTYPO.
  9198
  9199     IF CL-ACTIVITY-MAINT-DT = SPACES OR LOW-VALUES
  9200         MOVE SPACES                     TO  ACTDTO
  9201     ELSE
  9202         MOVE CL-ACTIVITY-MAINT-DT       TO  DC-BIN-DATE-1
  9203         MOVE ' '                        TO  DC-OPTION-CODE
  9204         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9205         IF NO-CONVERSION-ERROR
  9206             MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO
  9207         ELSE
  9208             MOVE SPACES                 TO  ACTDTO.
  9209
  9210     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9211         MOVE 'ASSOC:'               TO  ASSHDGO
  9212         MOVE AL-SABON               TO  ASSHDGA
  9213         MOVE CL-ASSOCIATES          TO  ASSOCO
  9214     ELSE
  9215         MOVE SPACES                 TO  ASSHDGO
  9216         MOVE AL-SADOF               TO  ASSOCA.
  9217
  9218     MOVE CL-CLAIM-STATUS        TO PI-STATUS-IND.
  9219     MOVE CL-LAST-CLOSE-REASON   TO PI-LAST-CLOSE-REASON-IND.
  9220
  9221     IF PI-COMPANY-ID = 'DMD'
  9222             AND
  9223         ((PI-ASS-PROCESSING  AND
  9224           PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO)
  9225                 OR
  9226         ((PI-CLOSED AND
  9227          (PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION))
  9228                 OR
  9229           CL-CERT-NO NOT = CL-PRIME-CERT-NO))
  9230         PERFORM 1200-GET-ASS-TOTALS THRU 1200-EXIT
  9231     ELSE
  9232         MOVE LOW-VALUES             TO PI-LAST-PF-KEY-IND
  9233                                        PI-ASSOCIATED-CERTS-TABLE
  9234                                        PI-ASSOCIATED-PROCESS-IND
  9235         MOVE SPACES                 TO AMTPDO
  9236                                        DAYSPDO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL150.cbl
  9237                                        CLMTOTHO
  9238                                        DAYSPDHO
  9239*01745          MOVE ZEROS                  TO PI-TOTAL-PAID
  9240         MOVE ZEROS                  TO
  9241                                        PI-DAYS-PAID
  9242                                        PI-LAST-SEQ-NO
  9243                                        PI-ASS-NDX.
  9244
  9245
  9246* EXEC CICS HANDLE CONDITION
  9247*        NOTFND    (1005-END-BUILD-DIAGNOSIS)
  9248*    END-EXEC.
  9249*    MOVE '"$I                   ! ) #00008845' TO DFHEIV0
  9250     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9252     MOVE X'2920233030303038383435' TO DFHEIV0(25:11)
  9253     CALL 'kxdfhei1' USING DFHEIV0
  9254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9255
  9256
  9257     MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
  9258     MOVE +90                 TO TRLR-SEQ-NO.
  9259     MOVE 'TRLR'              TO FILE-SWITCH.
  9260
  9261
  9262* EXEC CICS READ
  9263*        DATASET   ('ELTRLR')
  9264*        RIDFLD    (ELTRLR-KEY)
  9265*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9266*    END-EXEC.
  9267     MOVE 'ELTRLR' TO DFHEIV1
  9268*    MOVE '&"S        E          (   #00008853' TO DFHEIV0
  9269     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9271     MOVE X'2020233030303038383533' TO DFHEIV0(25:11)
  9272     CALL 'kxdfhei1' USING DFHEIV0,
  9273           DFHEIV1,
  9274           DFHEIV20,
  9275           DFHEIV99,
  9276           ELTRLR-KEY,
  9277           DFHEIV99,
  9278           DFHEIV99,
  9279           DFHEIV99
  9280     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9281         DFHEIV20
  9282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9283
  9284
  9285     MOVE AT-INFO-LINE-1         TO DIAGO.
  9286
  9287 1005-END-BUILD-DIAGNOSIS.
  9288
  9289     MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
  9290     MOVE +91                 TO TRLR-SEQ-NO.
  9291     MOVE 'TRLR'              TO FILE-SWITCH.
  9292
  9293
  9294* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL150.cbl
  9295*        DATASET   ('ELTRLR')
  9296*        RIDFLD    (ELTRLR-KEY)
  9297*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9298*        RESP      (WS-RESPONSE)
  9299*    END-EXEC.
  9300     MOVE 'ELTRLR' TO DFHEIV1
  9301*    MOVE '&"S        E          (  N#00008867' TO DFHEIV0
  9302     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9304     MOVE X'204E233030303038383637' TO DFHEIV0(25:11)
  9305     CALL 'kxdfhei1' USING DFHEIV0,
  9306           DFHEIV1,
  9307           DFHEIV20,
  9308           DFHEIV99,
  9309           ELTRLR-KEY,
  9310           DFHEIV99,
  9311           DFHEIV99,
  9312           DFHEIV99
  9313     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9314         DFHEIV20
  9315     MOVE EIBRESP  TO WS-RESPONSE
  9316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9317
  9318
  9319     IF WS-RESP-NORMAL
  9320        MOVE AT-INFO-LINE-1      TO CLOANO
  9321     ELSE
  9322        MOVE SPACES              TO CLOANO
  9323     END-IF
  9324
  9325     IF CL-SYSTEM-IDENTIFIER = 'CV'
  9326         PERFORM 1500-READ-CONVENIENCE-FILES THRU 1500-EXIT
  9327         GO TO 1050-SHOW-CONTINUE.
  9328
  9329
  9330* EXEC CICS HANDLE CONDITION
  9331*        NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
  9332*    END-EXEC.
  9333*    MOVE '"$I                   ! * #00008884' TO DFHEIV0
  9334     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9336     MOVE X'2A20233030303038383834' TO DFHEIV0(25:11)
  9337     CALL 'kxdfhei1' USING DFHEIV0
  9338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9339
  9340
  9341     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9342     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9343     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9344     MOVE CL-CERT-STATE          TO CERT-STATE.
  9345     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9346     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9347     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9348     MOVE 'CERT'                 TO FILE-SWITCH.
  9349
  9350
  9351* EXEC CICS READ
  9352*        DATASET   ('ELCERT')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL150.cbl
  9353*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  9354*        RIDFLD    (ELCERT-KEY)
  9355*    END-EXEC.
  9356     MOVE 'ELCERT' TO DFHEIV1
  9357*    MOVE '&"S        E          (   #00008897' TO DFHEIV0
  9358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9360     MOVE X'2020233030303038383937' TO DFHEIV0(25:11)
  9361     CALL 'kxdfhei1' USING DFHEIV0,
  9362           DFHEIV1,
  9363           DFHEIV20,
  9364           DFHEIV99,
  9365           ELCERT-KEY,
  9366           DFHEIV99,
  9367           DFHEIV99,
  9368           DFHEIV99
  9369     SET ADDRESS OF CERTIFICATE-MASTER TO
  9370         DFHEIV20
  9371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9372
  9373
  9374     MOVE 'Y'                    TO WS-CERT-READ-SW.
  9375     MOVE LOW-VALUES             TO ERACCT-KEY.
  9376     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9377     MOVE CL-CERT-CARRIER        TO ACCT-CARRIER.
  9378     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9379     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9380     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9381     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT.
  9382     MOVE 'ACCT'                 TO FILE-SWITCH.
  9383
  9384     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9385     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9386
  9387
  9388* EXEC CICS HANDLE CONDITION
  9389*         NOTFND   (1005-NO-ERACCT)
  9390*         ENDFILE  (1005-NO-ERACCT)
  9391*    END-EXEC.
  9392*    MOVE '"$I''                  ! + #00008916' TO DFHEIV0
  9393     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9395     MOVE X'2B20233030303038393136' TO DFHEIV0(25:11)
  9396     CALL 'kxdfhei1' USING DFHEIV0
  9397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9398
  9399
  9400
  9401* EXEC CICS STARTBR
  9402*         DATASET   ('ERACCT')
  9403*         RIDFLD    (ERACCT-KEY)
  9404*         GTEQ
  9405*    END-EXEC.
  9406     MOVE 'ERACCT' TO DFHEIV1
  9407     MOVE 0
  9408       TO DFHEIV11
  9409*    MOVE '&,         G          &   #00008921' TO DFHEIV0
  9410     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL150.cbl
  9411     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9412     MOVE X'2020233030303038393231' TO DFHEIV0(25:11)
  9413     CALL 'kxdfhei1' USING DFHEIV0,
  9414           DFHEIV1,
  9415           ERACCT-KEY,
  9416           DFHEIV99,
  9417           DFHEIV11,
  9418           DFHEIV99
  9419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9420
  9421
  9422 1005-READ-NEXT-ACCOUNT.
  9423
  9424
  9425* EXEC CICS READNEXT
  9426*         DATASET   ('ERACCT')
  9427*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9428*         RIDFLD    (ERACCT-KEY)
  9429*    END-EXEC.
  9430     MOVE 'ERACCT' TO DFHEIV1
  9431     MOVE 0
  9432       TO DFHEIV11
  9433*    MOVE '&.S                   )   #00008929' TO DFHEIV0
  9434     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9435     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9436     MOVE X'2020233030303038393239' TO DFHEIV0(25:11)
  9437     CALL 'kxdfhei1' USING DFHEIV0,
  9438           DFHEIV1,
  9439           DFHEIV20,
  9440           DFHEIV99,
  9441           ERACCT-KEY,
  9442           DFHEIV99,
  9443           DFHEIV11,
  9444           DFHEIV99,
  9445           DFHEIV99
  9446     SET ADDRESS OF ACCOUNT-MASTER TO
  9447         DFHEIV20
  9448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9449
  9450
  9451     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9452        IF WS-ERACCT-HOLD-RECORD = SPACES
  9453           GO TO 1005-NO-ERACCT
  9454        ELSE
  9455           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9456           GO TO 1005-CONTINUE.
  9457
  9458     IF ACCT-EXP-DT = HIGH-VALUES
  9459        NEXT SENTENCE
  9460     ELSE
  9461        MOVE ACCOUNT-MASTER      TO WS-ERACCT-HOLD-RECORD
  9462        GO TO 1005-READ-NEXT-ACCOUNT.
  9463
  9464 1005-CONTINUE.
  9465
  9466     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9467        MOVE ZEROS               TO AM-3RD-PARTY-NOTIF-LEVEL.
  9468
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL150.cbl
  9469     IF AM-3RD-PARTY-NOTIF-LEVEL > ZERO
  9470        MOVE 'THIRD PARTY'       TO NOTIFYO.
  9471
  9472 1005-NO-ERACCT.
  9473
  9474     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
  9475        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
  9476        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
  9477            MOVE 'N' TO PI-JOINT-INSURED-IND
  9478     ELSE
  9479            MOVE 'Y' TO PI-JOINT-INSURED-IND
  9480     END-IF.
  9481
  9482     IF CM-SING-PRM
  9483         MOVE 'SING PRM'         TO PRMTYPEO
  9484     ELSE
  9485         IF CM-O-B-COVERAGE
  9486             MOVE 'OUT BAL'      TO PRMTYPEO
  9487         ELSE
  9488             MOVE 'OPEN END'     TO PRMTYPEO.
  9489
  9490     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9491        GO TO 1006-CALC-LIFE.
  9492
  9493     MOVE 'MO. BENEFIT :'       TO BENECAPO.
  9494     MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
  9495     MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
  9496
  9497     IF PI-COMPANY-ID = 'DMD'
  9498         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
  9499         MOVE W-PAYMENTS         TO NOPMTSO
  9500         GO TO 1005-RTRM-CONT
  9501     ELSE
  9502         MOVE SAVE-BIN-DATE      TO CP-VALUATION-DT
  9503         MOVE SPACES             TO W-PAYMENTS
  9504         MOVE CL-NO-OF-PMTS-MADE TO W-PYMTS
  9505         MOVE W-PAYMENTS         TO NOPMTSO.
  9506
  9507     IF CM-AH-ORIG-TERM = +0
  9508        MOVE +1                 TO CP-ORIGINAL-TERM
  9509     ELSE
  9510        MOVE CM-AH-ORIG-TERM    TO CP-ORIGINAL-TERM.
  9511
  9512     MOVE PI-REM-TRM-CALC-OPTION
  9513                                TO CP-REM-TRM-CALC-OPTION.
  9514     MOVE '4'                   TO CP-REM-TERM-METHOD.
  9515     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID
  9516     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
  9517     PERFORM 9800-LINK-REM-TERM.
  9518     MOVE CP-REMAINING-TERM-3   TO WST-REM.
  9519
  9520 1005-RTRM-CONT.
  9521
  9522     MOVE CM-AH-BENEFIT-AMT     TO BENEO.
  9523
  9524     MOVE CM-POLICY-FORM-NO     TO PI-SAVE-FORM.
  9525     MOVE CM-STATE              TO PI-CR-STATE.
  9526     MOVE WS-TERMS              TO TERMSO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL150.cbl
  9527     MOVE CM-AH-ORIG-TERM       TO WST-ORIG
  9528                                   DC-ELAPSED-MONTHS
  9529     MOVE WS-TERMS              TO TERMSO.
  9530     MOVE CM-AH-CURRENT-STATUS TO WS-STATUS.
  9531
  9532     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9533         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  9534         MOVE '6'                    TO  DC-OPTION-CODE
  9535         MOVE '1'                    TO  DC-END-OF-MONTH
  9536         MOVE +0                     TO  DC-ELAPSED-DAYS
  9537                                         DC-ODD-DAYS-OVER
  9538         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  9539         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9540         IF NO-CONVERSION-ERROR
  9541             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9542         ELSE
  9543             MOVE SPACES                 TO  EXPIREO
  9544     ELSE
  9545         MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  9546         MOVE ' '                    TO  DC-OPTION-CODE
  9547         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9548         IF NO-CONVERSION-ERROR
  9549             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9550         ELSE
  9551             MOVE SPACES                 TO  EXPIREO.
  9552
  9553     GO TO 1009-CONTINUE-BUILD.
  9554
  9555 1006-CALC-LIFE.
  9556
  9557     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9558     MOVE '4'                    TO CNTL-REC-TYPE.
  9559     MOVE SPACES                 TO CNTL-ACCESS.
  9560     MOVE CM-LF-BENEFIT-CD       TO CNTL-BEN-NO.
  9561     MOVE +0                     TO CNTL-SEQ-NO.
  9562     MOVE 'CNTL'                 TO FILE-SWITCH.
  9563
  9564
  9565* EXEC CICS HANDLE CONDITION
  9566*         NOTFND    (1008-NOTFND)
  9567*         ENDFILE   (1008-NOTFND)
  9568*    END-EXEC.
  9569*    MOVE '"$I''                  ! , #00009048' TO DFHEIV0
  9570     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9572     MOVE X'2C20233030303039303438' TO DFHEIV0(25:11)
  9573     CALL 'kxdfhei1' USING DFHEIV0
  9574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9575
  9576
  9577
  9578* EXEC CICS READ
  9579*        DATASET   ('ELCNTL')
  9580*        SET       (ADDRESS OF CONTROL-FILE)
  9581*        RIDFLD    (ELCNTL-KEY)
  9582*        GTEQ
  9583*    END-EXEC.
  9584     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL150.cbl
  9585*    MOVE '&"S        G          (   #00009053' TO DFHEIV0
  9586     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9587     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9588     MOVE X'2020233030303039303533' TO DFHEIV0(25:11)
  9589     CALL 'kxdfhei1' USING DFHEIV0,
  9590           DFHEIV1,
  9591           DFHEIV20,
  9592           DFHEIV99,
  9593           ELCNTL-KEY,
  9594           DFHEIV99,
  9595           DFHEIV99,
  9596           DFHEIV99
  9597     SET ADDRESS OF CONTROL-FILE TO
  9598         DFHEIV20
  9599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9600
  9601
  9602     IF PI-COMPANY-ID NOT = CF-COMPANY-ID OR
  9603        CF-RECORD-TYPE NOT = '4'
  9604          GO TO 1008-NOTFND.
  9605
  9606     MOVE +1 TO WS-INDEX.
  9607
  9608 1007-TABLE-LOOKUP.
  9609
  9610     IF CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (WS-INDEX)
  9611        MOVE CF-LF-COVERAGE-TYPE (WS-INDEX) TO CP-BENEFIT-TYPE
  9612                                               WS-LF-COVERAGE-TYPE
  9613        MOVE CF-CO-EARNINGS-CALC (WS-INDEX) TO WS-EARNING-METHOD
  9614        MOVE CF-SPECIAL-CALC-CD (WS-INDEX)  TO CP-SPECIAL-CALC-CD
  9615        GO TO 1008-CONTINUE.
  9616
  9617     IF CF-BENEFIT-CODE (WS-INDEX) NOT < CF-HI-BEN-IN-REC
  9618        GO TO 1008-NOTFND.
  9619
  9620     IF WS-INDEX < +8
  9621        ADD +1 TO WS-INDEX
  9622        GO TO 1007-TABLE-LOOKUP.
  9623
  9624 1008-NOTFND.
  9625
  9626     MOVE ZEROS TO BENEO.
  9627     GO TO 1009-CONTINUE-BUILD.
  9628
  9629 1008-CONTINUE.
  9630
  9631     MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
  9632     MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
  9633     MOVE CL-INCURRED-DT        TO CP-VALUATION-DT.
  9634
  9635     IF CM-LF-ORIG-TERM = +0
  9636        MOVE +1                TO CP-ORIGINAL-TERM
  9637     ELSE
  9638        MOVE CM-LF-ORIG-TERM   TO CP-ORIGINAL-TERM.
  9639
  9640     MOVE CM-LF-ORIG-TERM      TO WST-ORIG
  9641                                  DC-ELAPSED-MONTHS.
  9642     MOVE CM-LF-CURRENT-STATUS TO WS-STATUS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL150.cbl
  9643
  9644     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9645         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  9646         MOVE '6'                    TO  DC-OPTION-CODE
  9647         MOVE '1'                    TO  DC-END-OF-MONTH
  9648         MOVE +0                     TO  DC-ELAPSED-DAYS
  9649                                         DC-ODD-DAYS-OVER
  9650         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
  9651         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9652         IF NO-CONVERSION-ERROR
  9653             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9654         ELSE
  9655             MOVE SPACES                 TO  EXPIREO
  9656     ELSE
  9657         MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  9658         MOVE ' '                    TO  DC-OPTION-CODE
  9659         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9660         IF NO-CONVERSION-ERROR
  9661             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
  9662         ELSE
  9663             MOVE SPACES                 TO  EXPIREO.
  9664
  9665     MOVE PI-REM-TRM-CALC-OPTION
  9666                                TO CP-REM-TRM-CALC-OPTION.
  9667     MOVE '4'                   TO CP-REM-TERM-METHOD.
  9668     MOVE WS-EARNING-METHOD     TO CP-EARNING-METHOD.
  9669     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  9670     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
  9671     PERFORM 9800-LINK-REM-TERM.
  9672
  9673     MOVE CP-REMAINING-TERM-3    TO WST-REM.
  9674     MOVE SPACES                 TO WST-REM-DAYS-GRP
  9675                                    WST-ORIG-DAYS-GRP.
  9676     MOVE WS-TERMS               TO TERMSO.
  9677
  9678     MOVE SPACES                 TO W-PAYMENTS
  9679     MOVE CL-NO-OF-PMTS-MADE     TO W-PYMTS
  9680     MOVE W-PAYMENTS             TO NOPMTSO.
  9681
  9682 1009-CALC-REM-AMT.
  9683
  9684     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9685     MOVE PI-STATE               TO WS-ST-ACCESS.
  9686     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
  9687     MOVE '3'                    TO CNTL-REC-TYPE.
  9688     MOVE +0                     TO CNTL-SEQ-NO.
  9689     MOVE 'CNTL'                 TO  FILE-SWITCH.
  9690
  9691
  9692* EXEC CICS HANDLE CONDITION
  9693*        NOTFND   (1009-CONTINUE-BUILD)
  9694*        ENDFILE  (1009-CONTINUE-BUILD)
  9695*    END-EXEC.
  9696*    MOVE '"$I''                  ! - #00009149' TO DFHEIV0
  9697     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9698     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9699     MOVE X'2D20233030303039313439' TO DFHEIV0(25:11)
  9700     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL150.cbl
  9701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9702
  9703
  9704
  9705* EXEC CICS READ
  9706*        DATASET   ('ELCNTL')
  9707*        SET       (ADDRESS OF CONTROL-FILE)
  9708*        RIDFLD    (ELCNTL-KEY)
  9709*    END-EXEC.
  9710     MOVE 'ELCNTL' TO DFHEIV1
  9711*    MOVE '&"S        E          (   #00009154' TO DFHEIV0
  9712     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9714     MOVE X'2020233030303039313534' TO DFHEIV0(25:11)
  9715     CALL 'kxdfhei1' USING DFHEIV0,
  9716           DFHEIV1,
  9717           DFHEIV20,
  9718           DFHEIV99,
  9719           ELCNTL-KEY,
  9720           DFHEIV99,
  9721           DFHEIV99,
  9722           DFHEIV99
  9723     SET ADDRESS OF CONTROL-FILE TO
  9724         DFHEIV20
  9725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9726
  9727
  9728     MOVE CF-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
  9729     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
  9730
  9731     IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
  9732        MOVE ZEROS                 TO BENEO
  9733     ELSE
  9734        MOVE CP-REMAINING-TERM-3   TO CP-REMAINING-TERM
  9735        MOVE CM-LF-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  9736        MOVE CM-LF-ALT-BENEFIT-AMT TO CP-ALTERNATE-BENEFIT
  9737        MOVE CM-LOAN-APR           TO CP-LOAN-APR
  9738        MOVE CM-LOAN-TERM          TO CP-LOAN-TERM
  9739        MOVE CM-PAY-FREQUENCY      TO CP-PAY-FREQUENCY
  9740        PERFORM 9850-LINK-REM-AMT THRU 9850-EXIT
  9741        MOVE CP-REMAINING-AMT      TO BENEO.
  9742
  9743     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9744        WS-LF-COVERAGE-TYPE = 'P'
  9745         COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
  9746                                    CM-LF-ITD-DEATH-AMT
  9747         MOVE WS-REMAINING-AMT    TO  BENEO.
  9748
  9749 1009-CONTINUE-BUILD.
  9750
  9751     MOVE CM-POLICY-FORM-NO  TO PI-SAVE-FORM.
  9752
  9753     IF WS-STATUS = '6' OR '7' OR '8'
  9754        MOVE AL-SABOF              TO CRTSTATA.
  9755
  9756     IF WS-STATUS = '1' OR '4'
  9757        IF CP-REMAINING-TERM-3 = ZEROS
  9758           MOVE 'EXPIRED'        TO CRTSTATO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL150.cbl
  9759        ELSE
  9760           MOVE 'ACTIVE  '       TO CRTSTATO.
  9761
  9762     IF WS-STATUS = '2'
  9763         MOVE 'PEND    '         TO CRTSTATO.
  9764
  9765     IF WS-STATUS = '3'
  9766         MOVE 'RESTORE '         TO CRTSTATO.
  9767
  9768     IF WS-STATUS = '5'
  9769         MOVE 'REISSUE '         TO CRTSTATO.
  9770
  9771     IF WS-STATUS = '6'
  9772         MOVE 'LMP DIS'          TO CRTSTATO.
  9773
  9774     IF WS-STATUS = '7'
  9775         MOVE 'DEATH'            TO CRTSTATO.
  9776
  9777     IF WS-STATUS = '8'
  9778         MOVE 'CANCEL'           TO CRTSTATO.
  9779
  9780     IF WS-STATUS = '9'
  9781         MOVE 'RE-ONLY '         TO CRTSTATO.
  9782
  9783     IF WS-STATUS = 'D'
  9784         MOVE 'DECLINE'          TO CRTSTATO.
  9785
  9786     IF WS-STATUS = 'V'
  9787         MOVE 'VOID'             TO CRTSTATO.
  9788
  9789     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
  9790        MOVE CM-AH-BENEFIT-CD    TO WS-BEN-CD
  9791        MOVE '5'                 TO CNTL-REC-TYPE
  9792     END-IF
  9793
  9794     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9795         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
  9796         MOVE '4'                TO CNTL-REC-TYPE.
  9797
  9798     MOVE '** NONE **'           TO COVERO.
  9799
  9800     IF WS-BEN-CD = ZERO
  9801         MOVE AL-SABOF           TO COVERA
  9802         MOVE SPACES             TO CRTSTATO
  9803         GO TO 1050-SHOW-CONTINUE.
  9804
  9805 1010-SHOW-CONTINUE.
  9806     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9807     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9808     MOVE +0                     TO CNTL-SEQ-NO.
  9809     MOVE 'CNTL'                 TO FILE-SWITCH.
  9810
  9811
  9812* EXEC CICS HANDLE CONDITION
  9813*        ENDFILE   (1050-SHOW-CONTINUE)
  9814*        NOTFND    (1050-SHOW-CONTINUE)
  9815*    END-EXEC.
  9816*    MOVE '"$''I                  ! . #00009243' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL150.cbl
  9817     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9819     MOVE X'2E20233030303039323433' TO DFHEIV0(25:11)
  9820     CALL 'kxdfhei1' USING DFHEIV0
  9821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9822
  9823
  9824
  9825* EXEC CICS READ
  9826*        DATASET   ('ELCNTL')
  9827*        SET       (ADDRESS OF CONTROL-FILE)
  9828*        RIDFLD    (ELCNTL-KEY)
  9829*        GTEQ
  9830*    END-EXEC.
  9831     MOVE 'ELCNTL' TO DFHEIV1
  9832*    MOVE '&"S        G          (   #00009248' TO DFHEIV0
  9833     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9835     MOVE X'2020233030303039323438' TO DFHEIV0(25:11)
  9836     CALL 'kxdfhei1' USING DFHEIV0,
  9837           DFHEIV1,
  9838           DFHEIV20,
  9839           DFHEIV99,
  9840           ELCNTL-KEY,
  9841           DFHEIV99,
  9842           DFHEIV99,
  9843           DFHEIV99
  9844     SET ADDRESS OF CONTROL-FILE TO
  9845         DFHEIV20
  9846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9847
  9848
  9849     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID) OR
  9850        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9851           GO TO 1050-SHOW-CONTINUE.
  9852
  9853     PERFORM 1030-BENEFIT-DUMMY THRU 1030-EXIT
  9854         VARYING SUB-1 FROM 1 BY 1 UNTIL
  9855            ((SUB-1 > 8) OR
  9856            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  9857
  9858     IF SUB-1 NOT = 9
  9859         MOVE CF-BENEFIT-DESCRIP (SUB-1) TO COVERO
  9860         MOVE CF-JOINT-INDICATOR (SUB-1) TO PI-JOINT-COV-IND
  9861       ELSE
  9862         IF CRTSTATO = 'ACTIVE'
  9863             MOVE SPACES         TO  CRTSTATO.
  9864
  9865     GO TO 1050-SHOW-CONTINUE.
  9866
  9867 1030-BENEFIT-DUMMY.
  9868 1030-EXIT.
  9869     EXIT.
  9870
  9871 1050-SHOW-CONTINUE.
  9872
  9873     IF CL-PURGED-DT NOT = LOW-VALUES
  9874         MOVE 'Y'                        TO  PI-PURGED-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL150.cbl
  9875         MOVE AL-SANOF                   TO  FILETOA    PRTOPTA
  9876                                             FORMATA    ALTPRTA
  9877                                             ACTCDA     ASSOCA
  9878                                             CLOANA
  9879         MOVE 'CLAIM IS PURGED - '       TO  WS-PURGED-MSG
  9880         MOVE CL-PURGED-DT               TO  DC-BIN-DATE-1
  9881         MOVE ' '                        TO  DC-OPTION-CODE
  9882         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9883         IF NO-CONVERSION-ERROR
  9884             MOVE DC-GREG-DATE-1-EDIT    TO  WS-PURGED-DATE
  9885             MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
  9886         ELSE
  9887             MOVE SPACES                 TO  WS-PURGED-DATE
  9888             MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
  9889     ELSE
  9890         MOVE 'N'                        TO  PI-PURGED-SW
  9891         PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
  9892
  9893     IF PI-COMPANY-ID = 'DMD'
  9894        MOVE COVERO                  TO  CRTSTATO
  9895        IF CL-LAST-PMT-AMT NOT = ZERO
  9896           MOVE CL-LAST-PMT-DT       TO  DC-BIN-DATE-1
  9897           MOVE ' '                  TO  DC-OPTION-CODE
  9898           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9899           MOVE DC-GREG-DATE-1-EDIT  TO  PRMTYPEO
  9900           MOVE CL-LAST-PMT-AMT      TO  WS-PMT-AMT
  9901           MOVE WS-PMT-AMTD          TO  COVERO
  9902         ELSE
  9903           MOVE SPACES               TO  COVERO
  9904                                         PRMTYPEO.
  9905
  9906     IF RETURNED-FROM NOT = SPACES
  9907         GO TO 8250-SEND-WITH-CURSOR.
  9908
  9909     IF CLAIM-IS-PURGED
  9910        CONTINUE
  9911*        MOVE -1                 TO  MCRFLML
  9912     ELSE
  9913         MOVE -1                 TO  FILETOL
  9914     END-IF
  9915
  9916     IF PI-COMPANY-ID = 'DMD'
  9917         IF CONFIDENTIAL-DATA
  9918             IF PI-CONFIDENTIAL-UP
  9919                 MOVE LOW-VALUE  TO PI-PRIORITY-IND
  9920                 MOVE ER-0932    TO EMI-ERROR
  9921                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9922             ELSE
  9923                 MOVE 'C'        TO PI-PRIORITY-IND
  9924
  9925* EXEC CICS SEND TEXT
  9926*                    FROM     (W-CONF-TEXT)
  9927*                    LENGTH   (W-CONF-LENGTH)
  9928*                    ERASE
  9929*                    FREEKB
  9930*                END-EXEC
  9931*    MOVE '8&      T  E F  H   F -   #00009330' TO DFHEIV0
  9932     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL150.cbl
  9933     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9934     MOVE X'2020233030303039333330' TO DFHEIV0(25:11)
  9935     CALL 'kxdfhei1' USING DFHEIV0,
  9936           W-CONF-TEXT,
  9937           W-CONF-LENGTH,
  9938           DFHEIV99,
  9939           DFHEIV99,
  9940           DFHEIV99,
  9941           DFHEIV99,
  9942           DFHEIV99,
  9943           DFHEIV99,
  9944           DFHEIV99,
  9945           DFHEIV99,
  9946           DFHEIV99,
  9947           DFHEIV99
  9948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9949                 GO TO 9100-RETURN-TRAN.
  9950
  9951     GO TO 8100-SEND-INITIAL-MAP.
  9952
  9953 1100-SHOW-RECORD-NOT-FOUND.
  9954
  9955     IF FILE-SWITCH = 'MSTR'
  9956         IF PI-CURRENT-FILE = 'ELRETR'
  9957             MOVE ER-0204        TO EMI-ERROR
  9958         ELSE
  9959             MOVE 'Y'            TO PI-RETRIEVED-DATA-IND
  9960             MOVE 'ELRETR'       TO PI-CURRENT-FILE
  9961             GO TO 1000-READ-CLAIM
  9962     ELSE
  9963         MOVE ER-0206            TO EMI-ERROR.
  9964
  9965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9966
  9967     IF FILE-SWITCH = 'CERT' AND
  9968      (PI-COMPANY-ID = 'CID' OR 'AHL')
  9969        GO TO 1050-SHOW-CONTINUE.
  9970
  9971     MOVE -1                     TO CLMNOL.
  9972
  9973     MOVE PI-CARRIER             TO CARRO.
  9974     MOVE PI-CLAIM-NO            TO CLMNOO.
  9975     MOVE PI-CERT-PRIME          TO CERTNOO.
  9976     MOVE PI-CERT-SFX            TO SUFXO.
  9977
  9978     MOVE AL-UABON               TO CLMNOA   CARRA
  9979                                    YESNOSWA
  9980                                    CERTNOA  SUFXA.
  9981
  9982     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL150.cbl
  9984 1200-GET-ASS-TOTALS.
  9985
  9986     MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
  9987
  9988     IF RETURNED-FROM NOT = 'EL156' AND 'EL1501' AND 'EL1502'
  9989         IF PI-ASS-PROCESSING
  9990                 AND
  9991            PI-ASS-CERTS (PI-ASS-NDX) = CL-CERT-NO
  9992                 AND
  9993            PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
  9994             GO TO 1200-SET-UP-FIELDS.
  9995
  9996     MOVE CL-ASSOC-CERT-SEQU      TO PI-LAST-SEQ-NO.
  9997
  9998     IF EIBAID = DFHPF15 OR DFHPF16
  9999
 10000* EXEC CICS ENDBR
 10001*            DATASET   (PI-CURRENT-FILE)
 10002*        END-EXEC.
 10003     MOVE 0
 10004       TO DFHEIV11
 10005*    MOVE '&2                    $   #00009386' TO DFHEIV0
 10006     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10007     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10008     MOVE X'2020233030303039333836' TO DFHEIV0(25:11)
 10009     CALL 'kxdfhei1' USING DFHEIV0,
 10010           PI-CURRENT-FILE,
 10011           DFHEIV11,
 10012           DFHEIV99
 10013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10014
 10015
 10016     MOVE CLAIM-MASTER           TO W-CLAIM-MASTER-SAVE.
 10017     MOVE ZEROS                  TO PI-DAYS-PAID
 10018                                    PI-TOTAL-PAID.
 10019     MOVE LOW-VALUES             TO PI-ASSOCIATED-CERTS-TABLE
 10020                                    PI-LAST-PF-KEY-IND
 10021                                    PI-ASSOCIATED-PROCESS-IND
 10022     MOVE SPACES                 TO MSTR-CERT-NO.
 10023
 10024     IF RETURNED-FROM = 'EL156'
 10025             AND
 10026        PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
 10027         MOVE SPACES             TO RETURNED-FROM
 10028     ELSE
 10029         MOVE SPACES             TO RETURNED-FROM
 10030         MOVE CL-CONTROL-PRIMARY TO PI-ORIGINAL-ASS-CERT.
 10031
 10032
 10033* EXEC CICS HANDLE CONDITION
 10034*        NOTFND   (1220-NO-CLAIM-RECORD-FND)
 10035*        ENDFILE  (1200-ENDBR)
 10036*    END-EXEC.
 10037*    MOVE '"$I''                  ! / #00009406' TO DFHEIV0
 10038     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10040     MOVE X'2F20233030303039343036' TO DFHEIV0(25:11)
 10041     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL150.cbl
 10042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10043
 10044
 10045
 10046* EXEC CICS STARTBR
 10047*         DATASET   (PI-CURRENT-FILE)
 10048*         RIDFLD    (ELMSTR-KEY)
 10049*    END-EXEC.
 10050     MOVE 0
 10051       TO DFHEIV11
 10052*    MOVE '&,         G          &   #00009411' TO DFHEIV0
 10053     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10054     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10055     MOVE X'2020233030303039343131' TO DFHEIV0(25:11)
 10056     CALL 'kxdfhei1' USING DFHEIV0,
 10057           PI-CURRENT-FILE,
 10058           ELMSTR-KEY,
 10059           DFHEIV99,
 10060           DFHEIV11,
 10061           DFHEIV99
 10062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10063
 10064
 10065 1200-GET-NEXT-RECORD.
 10066
 10067
 10068* EXEC CICS READNEXT
 10069*         DATASET   (PI-CURRENT-FILE)
 10070*         RIDFLD    (ELMSTR-KEY)
 10071*         INTO      (CLAIM-MASTER)
 10072*    END-EXEC.
 10073     MOVE LENGTH OF
 10074      CLAIM-MASTER
 10075       TO DFHEIV12
 10076     MOVE 0
 10077       TO DFHEIV11
 10078*    MOVE '&.IL                  )   #00009418' TO DFHEIV0
 10079     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10080     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10081     MOVE X'2020233030303039343138' TO DFHEIV0(25:11)
 10082     CALL 'kxdfhei1' USING DFHEIV0,
 10083           PI-CURRENT-FILE,
 10084           CLAIM-MASTER,
 10085           DFHEIV12,
 10086           ELMSTR-KEY,
 10087           DFHEIV99,
 10088           DFHEIV11,
 10089           DFHEIV99,
 10090           DFHEIV99
 10091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10092
 10093
 10094     IF PI-PREV-COMP-CD  NOT = CL-COMPANY-CD  OR
 10095        PI-PREV-CARRIER  NOT = CL-CARRIER     OR
 10096        PI-PREV-CLAIM-NO NOT = CL-CLAIM-NO
 10097         GO TO 1200-ENDBR.
 10098
 10099     IF CL-PRIME-CERT-NO NOT = PI-PREV-PRIME-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL150.cbl
 10100         GO TO 1200-GET-NEXT-RECORD.
 10101
 10102     ADD CL-TOTAL-PAID-AMT       TO PI-TOTAL-PAID.
 10103     ADD CL-NO-OF-DAYS-PAID      TO PI-DAYS-PAID.
 10104
 10105     MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
 10106     MOVE CL-CERT-NO             TO PI-ASS-CERTS (PI-ASS-NDX).
 10107
 10108     GO TO 1200-GET-NEXT-RECORD.
 10109
 10110 1200-ENDBR.
 10111
 10112
 10113* EXEC CICS ENDBR
 10114*        DATASET   (PI-CURRENT-FILE)
 10115*    END-EXEC.
 10116     MOVE 0
 10117       TO DFHEIV11
 10118*    MOVE '&2                    $   #00009442' TO DFHEIV0
 10119     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10120     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10121     MOVE X'2020233030303039343432' TO DFHEIV0(25:11)
 10122     CALL 'kxdfhei1' USING DFHEIV0,
 10123           PI-CURRENT-FILE,
 10124           DFHEIV11,
 10125           DFHEIV99
 10126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10127
 10128
 10129     MOVE W-CLAIM-MASTER-SAVE    TO CLAIM-MASTER.
 10130     MOVE PI-LAST-SEQ-NO         TO PI-ASS-NDX.
 10131
 10132 1200-SET-UP-FIELDS.
 10133
 10134     MOVE 'Y'                    TO PI-ASSOCIATED-PROCESS-IND.
 10135     MOVE PI-DAYS-PAID           TO W-DAYS-PAID-X.
 10136     MOVE PI-TOTAL-PAID          TO W-TOTAL-PAID-AMT-X.
 10137     MOVE W-TOTAL-PAID-AMT-X     TO AMTPDO.
 10138     MOVE W-DAYS-PAID-X          TO DAYSPDO.
 10139     MOVE 'CLAIM TOTALS...AMOUNT PD:'
 10140                                 TO CLMTOTHO.
 10141     MOVE 'DAYS PAID:'           TO DAYSPDHO.
 10142
 10143 1200-EXIT.
 10144     EXIT.
 10145
 10146 1220-NO-CLAIM-RECORD-FND.
 10147
 10148     MOVE ER-0204                TO EMI-ERROR.
 10149
 10150     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10151
 10152     IF FILE-SWITCH = 'CERT' AND
 10153       (PI-COMPANY-ID = 'CID' OR 'AHL')
 10154         GO TO 1050-SHOW-CONTINUE.
 10155
 10156     MOVE -1                     TO CLMNOL.
 10157
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL150.cbl
 10158     MOVE PI-CARRIER             TO CARRO.
 10159     MOVE PI-CLAIM-NO            TO CLMNOO.
 10160     MOVE PI-CERT-PRIME          TO CERTNOO.
 10161     MOVE PI-CERT-SFX            TO SUFXO.
 10162
 10163     MOVE AL-UABON               TO CLMNOA   CARRA
 10164                                    CERTNOA  SUFXA.
 10165
 10166     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL150.cbl
 10168 1500-READ-CONVENIENCE-FILES.
 10169
 10170
 10171* EXEC CICS HANDLE CONDITION
 10172*        NOTFND   (1500-SHOW-RECORD-NOT-FOUND)
 10173*    END-EXEC.
 10174*    MOVE '"$I                   ! 0 #00009487' TO DFHEIV0
 10175     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10177     MOVE X'3020233030303039343837' TO DFHEIV0(25:11)
 10178     CALL 'kxdfhei1' USING DFHEIV0
 10179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10180
 10181
 10182     MOVE PI-COMPANY-CD              TO  PLCY-COMP-CD.
 10183     MOVE CL-CERT-CARRIER            TO  PLCY-CARRIER.
 10184     MOVE CL-CERT-GROUPING           TO  PLCY-GROUPING.
 10185     MOVE CL-CERT-STATE              TO  PLCY-STATE.
 10186     MOVE CL-CERT-ACCOUNT            TO  PLCY-PRODUCER.
 10187     MOVE CL-CERT-EFF-DT             TO  PLCY-EFF-DT.
 10188     MOVE CL-CV-REFERENCE-NO         TO  PLCY-REFERENCE-NO.
 10189     MOVE 'PLCY'                     TO  FILE-SWITCH.
 10190
 10191
 10192* EXEC CICS READ
 10193*        DATASET   ('MPPLCY')
 10194*        SET       (ADDRESS OF POLICY-MASTER)
 10195*        RIDFLD    (EMPLCY-KEY)
 10196*    END-EXEC.
 10197     MOVE 'MPPLCY' TO DFHEIV1
 10198*    MOVE '&"S        E          (   #00009500' TO DFHEIV0
 10199     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10201     MOVE X'2020233030303039353030' TO DFHEIV0(25:11)
 10202     CALL 'kxdfhei1' USING DFHEIV0,
 10203           DFHEIV1,
 10204           DFHEIV20,
 10205           DFHEIV99,
 10206           EMPLCY-KEY,
 10207           DFHEIV99,
 10208           DFHEIV99,
 10209           DFHEIV99
 10210     SET ADDRESS OF POLICY-MASTER TO
 10211         DFHEIV20
 10212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10213
 10214
 10215     MOVE 'Y'                        TO  WS-CERT-READ-SW.
 10216
 10217     PERFORM 1700-READ-EMPHST THRU 1700-EXIT.
 10218
 10219 1500-READ-EMPLAN.
 10220
 10221     MOVE PM-COMPANY-CD              TO  PLAN-COMP-CD.
 10222     MOVE PM-CARRIER                 TO  PLAN-CARRIER.
 10223     MOVE PM-GROUPING                TO  PLAN-GROUPING.
 10224     MOVE PM-STATE                   TO  PLAN-STATE.
 10225     MOVE PM-PRODUCER                TO  PLAN-PRODUCER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL150.cbl
 10226     MOVE PM-INS-PLAN-CD             TO  PLAN-PLAN-CODE.
 10227     MOVE PM-INS-PLAN-REVISION       TO  PLAN-REV-NO.
 10228     MOVE 'PLAN'                     TO  FILE-SWITCH.
 10229
 10230
 10231* EXEC CICS HANDLE CONDITION
 10232*        NOTFND   (1500-NO-PLAN-RECORD)
 10233*    END-EXEC.
 10234*    MOVE '"$I                   ! 1 #00009521' TO DFHEIV0
 10235     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10237     MOVE X'3120233030303039353231' TO DFHEIV0(25:11)
 10238     CALL 'kxdfhei1' USING DFHEIV0
 10239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10240
 10241
 10242
 10243* EXEC CICS READ
 10244*        DATASET   ('MPPLAN')
 10245*        RIDFLD    (EMPLAN-KEY)
 10246*        SET       (ADDRESS OF PRODUCER-PLANS)
 10247*    END-EXEC.
 10248     MOVE 'MPPLAN' TO DFHEIV1
 10249*    MOVE '&"S        E          (   #00009525' TO DFHEIV0
 10250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10252     MOVE X'2020233030303039353235' TO DFHEIV0(25:11)
 10253     CALL 'kxdfhei1' USING DFHEIV0,
 10254           DFHEIV1,
 10255           DFHEIV20,
 10256           DFHEIV99,
 10257           EMPLAN-KEY,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99
 10261     SET ADDRESS OF PRODUCER-PLANS TO
 10262         DFHEIV20
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10264
 10265
 10266     MOVE PP-PLAN-ABBREV             TO  COVERO.
 10267     MOVE PP-REFUND-CALC             TO  CP-EARNING-METHOD
 10268                                         CP-RATING-METHOD.
 10269     IF PP-BENEFIT-IS-LEVEL
 10270         MOVE 'L'                    TO  CP-BENEFIT-TYPE
 10271     ELSE
 10272         MOVE 'R'                    TO  CP-BENEFIT-TYPE.
 10273
 10274     MOVE PM-LOAN-TERM               TO  CP-ORIGINAL-TERM
 10275                                         CP-LOAN-TERM.
 10276     MOVE SAVE-BIN-DATE              TO  CP-VALUATION-DT.
 10277     MOVE PM-POLICY-EFF-DT           TO  CP-CERT-EFF-DT.
 10278     MOVE PM-STATE                   TO  CP-STATE.
 10279     MOVE 'A'                        TO  CP-SPECIAL-CALC-CD.
 10280     MOVE '2'                        TO  CP-PROCESS-TYPE.
 10281     MOVE PI-COMPANY-ID              TO  CP-COMPANY-ID.
 10282     MOVE PI-COMPANY-CD              TO  CP-COMPANY-CD.
 10283     MOVE '1'                        TO  CP-REM-TRM-CALC-OPTION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL150.cbl
 10284
 10285     IF PM-AH-MORT-PLAN
 10286         MOVE '3'                    TO  CP-REM-TERM-METHOD
 10287         MOVE PM-LOAN-DT             TO  CP-FIRST-PAY-DATE
 10288     ELSE
 10289         MOVE '2'                    TO  CP-REM-TERM-METHOD
 10290         MOVE PM-POLICY-EFF-DT       TO  CP-FIRST-PAY-DATE.
 10291
 10292     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
 10293     PERFORM 9800-LINK-REM-TERM.
 10294
 10295     IF PM-AH-MORT-PLAN
 10296       MOVE CP-REMAINING-TERM-1    TO  WST-REM
 10297     ELSE
 10298       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 10299         COMPUTE CP-REMAINING-TERM-3 = CP-REMAINING-TERM-3 + 1
 10300         MOVE CP-REMAINING-TERM-3    TO  WST-REM
 10301       ELSE
 10302         MOVE CP-REMAINING-TERM-3    TO  WST-REM.
 10303
 10304     GO TO 1500-SHOW-CONTINUE.
 10305
 10306 1500-NO-PLAN-RECORD.
 10307
 10308     MOVE ZEROS                      TO  WST-REM.
 10309     MOVE '** NONE **'               TO  COVERO.
 10310
 10311 1500-SHOW-CONTINUE.
 10312
 10313     MOVE PM-LOAN-TERM               TO  WST-ORIG.
 10314     MOVE WS-TERMS                   TO  TERMSO.
 10315
 10316     IF PM-AH-MORT-PLAN
 10317         MOVE 'MO. BENEFIT :'        TO  BENECAPO
 10318         MOVE PM-INS-MONTH-BENEFIT   TO  BENEO
 10319     ELSE
 10320         MOVE PM-INS-TOTAL-BENEFIT   TO  BENEO.
 10321
 10322     IF PM-ANNUAL
 10323         MOVE 'ANNUAL'              TO  PRMTYPEO
 10324       ELSE
 10325     IF PM-SEMI-ANNUAL
 10326         MOVE 'SEMI ANL'            TO  PRMTYPEO
 10327       ELSE
 10328     IF PM-QUARTERLY
 10329         MOVE 'QTRLY'               TO  PRMTYPEO
 10330       ELSE
 10331     IF PM-BI-MONTHLY
 10332         MOVE 'BI MONTH'            TO  PRMTYPEO
 10333       ELSE
 10334     IF PM-SINGLE-PREM
 10335         MOVE 'SING PRM'            TO  PRMTYPEO.
 10336
 10337     MOVE PM-POLICY-EFF-DT           TO  DC-BIN-DATE-1.
 10338     MOVE '6'                        TO  DC-OPTION-CODE.
 10339     MOVE PM-LOAN-TERM               TO  DC-ELAPSED-MONTHS.
 10340     MOVE +0                         TO  DC-ELAPSED-DAYS.
 10341     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL150.cbl
 10342     IF NO-CONVERSION-ERROR
 10343         MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
 10344     ELSE
 10345         MOVE SPACES                 TO  EXPIREO.
 10346
 10347     IF PM-CURRENT-STATUS = '0'
 10348         MOVE 'LAPSED'               TO  CRTSTATO.
 10349     IF PM-CURRENT-STATUS = '1'
 10350         MOVE 'ACTIVE'               TO  CRTSTATO.
 10351     IF PM-CURRENT-STATUS = '2'
 10352         MOVE 'PENDING'              TO  CRTSTATO.
 10353     IF PM-CURRENT-STATUS = '3'
 10354         MOVE 'DECLINE'              TO  CRTSTATO.
 10355     IF PM-CURRENT-STATUS = '4' OR '9'
 10356         MOVE 'PND CANC'             TO  CRTSTATO.
 10357     IF PM-CURRENT-STATUS = '5'
 10358         MOVE 'PND ISS'              TO  CRTSTATO.
 10359     IF PM-CURRENT-STATUS = '6'
 10360         MOVE 'CLAIM'                TO  CRTSTATO.
 10361     IF PM-CURRENT-STATUS = '7'
 10362         MOVE 'CANCEL'               TO  CRTSTATO.
 10363     IF PM-CURRENT-STATUS = '8'
 10364         MOVE 'PND UNDW'             TO  CRTSTATO.
 10365     IF PM-CURRENT-STATUS = 'C'
 10366         MOVE 'TRANSFER'             TO  CRTSTATO.
 10367     IF PM-CURRENT-STATUS = 'F'
 10368         MOVE 'SETTLE'               TO  CRTSTATO.
 10369     IF PM-CURRENT-STATUS = 'T'
 10370         MOVE 'TRMNAT'               TO  CRTSTATO.
 10371
 10372     GO TO 1500-EXIT.
 10373
 10374 1500-SHOW-RECORD-NOT-FOUND.
 10375
 10376     IF FILE-SWITCH = 'PLCY'
 10377         MOVE ER-9483            TO  EMI-ERROR.
 10378
 10379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10380     MOVE -1                     TO  CLMNOL.
 10381     MOVE PI-CARRIER             TO  CARRO.
 10382     MOVE PI-CLAIM-NO            TO  CLMNOL.
 10383     MOVE PI-CERT-PRIME          TO  CERTNOO.
 10384     MOVE PI-CERT-SFX            TO  SUFXO.
 10385
 10386     MOVE AL-UABON               TO  CLMNOA    CARRA
 10387                                     CERTNOA   SUFXA.
 10388     GO TO 8100-SEND-INITIAL-MAP.
 10389
 10390 1500-EXIT.
 10391     EXIT.
 10392
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL150.cbl
 10394 1600-ROLL-TRAILERS.
 10395     MOVE SPACES                 TO MAP-DISPLAY (1)
 10396                                    MAP-DISPLAY (2)
 10397                                    MAP-DISPLAY (3)
 10398                                    MAP-DISPLAY (4).
 10399
 10400     PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
 10401
 10402     MOVE -1                     TO FILETOL.
 10403     GO TO 8200-SEND-DATAONLY.
 10404
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL150.cbl
 10406***************************************************************
 10407*    I/O REQUESTS AGAINST THE CONVENIENCE POLICY HISTORY FILE *
 10408***************************************************************
 10409 1700-READ-EMPHST.
 10410
 10411
 10412* EXEC CICS HANDLE CONDITION
 10413*        ENDFILE  (1700-ENDBROWSE)
 10414*        NOTFND   (1700-ENDBROWSE)
 10415*    END-EXEC.
 10416*    MOVE '"$''I                  ! 2 #00009676' TO DFHEIV0
 10417     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10419     MOVE X'3220233030303039363736' TO DFHEIV0(25:11)
 10420     CALL 'kxdfhei1' USING DFHEIV0
 10421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10422
 10423
 10424     MOVE PM-COMPANY-CD          TO  EMPHST-COMPANY-CD.
 10425     MOVE PM-CARRIER             TO  EMPHST-CARRIER.
 10426     MOVE PM-GROUPING            TO  EMPHST-GROUPING.
 10427     MOVE PM-STATE               TO  EMPHST-STATE.
 10428     MOVE PM-PRODUCER            TO  EMPHST-PRODUCER.
 10429     MOVE PM-POLICY-EFF-DT       TO  EMPHST-POLICY-EFF-DT.
 10430     MOVE PM-REFERENCE-NUMBER    TO  EMPHST-REFERENCE-NUMBER.
 10431     MOVE ZEROS                  TO  EMPHST-SEQUENCE-NO.
 10432
 10433     IF PM-LIFE-MORT-PLAN
 10434         MOVE '02'                   TO  EMPHST-RECORD-TYPE
 10435         MOVE '21'                   TO  EMPHST-FIELD-TYPE
 10436     ELSE
 10437         MOVE '04'                   TO  EMPHST-RECORD-TYPE
 10438         MOVE '07'                   TO  EMPHST-FIELD-TYPE.
 10439
 10440
 10441* EXEC CICS STARTBR
 10442*        DATASET   (EMPHST-FILE-ID)
 10443*        RIDFLD    (EMPHST-KEY)
 10444*        GTEQ
 10445*    END-EXEC.
 10446     MOVE 0
 10447       TO DFHEIV11
 10448*    MOVE '&,         G          &   #00009697' TO DFHEIV0
 10449     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10450     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10451     MOVE X'2020233030303039363937' TO DFHEIV0(25:11)
 10452     CALL 'kxdfhei1' USING DFHEIV0,
 10453           EMPHST-FILE-ID,
 10454           EMPHST-KEY,
 10455           DFHEIV99,
 10456           DFHEIV11,
 10457           DFHEIV99
 10458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10459
 10460
 10461     MOVE 'Y'                    TO  WS-BROWSE-START-SW.
 10462
 10463 1700-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL150.cbl
 10464
 10465
 10466* EXEC CICS READNEXT
 10467*        DATASET   (EMPHST-FILE-ID)
 10468*        SET       (ADDRESS OF POLICY-HISTORY)
 10469*        RIDFLD    (EMPHST-KEY)
 10470*    END-EXEC.
 10471     MOVE 0
 10472       TO DFHEIV11
 10473*    MOVE '&.S                   )   #00009707' TO DFHEIV0
 10474     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10475     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10476     MOVE X'2020233030303039373037' TO DFHEIV0(25:11)
 10477     CALL 'kxdfhei1' USING DFHEIV0,
 10478           EMPHST-FILE-ID,
 10479           DFHEIV20,
 10480           DFHEIV99,
 10481           EMPHST-KEY,
 10482           DFHEIV99,
 10483           DFHEIV11,
 10484           DFHEIV99,
 10485           DFHEIV99
 10486     SET ADDRESS OF POLICY-HISTORY TO
 10487         DFHEIV20
 10488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10489
 10490
 10491     IF PM-COMPANY-CD       = PH-COMPANY-CD         AND
 10492        PM-CARRIER          = PH-CARRIER            AND
 10493        PM-GROUPING         = EMPHST-GROUPING       AND
 10494        PM-STATE            = EMPHST-STATE          AND
 10495        PM-PRODUCER         = EMPHST-PRODUCER       AND
 10496        PM-POLICY-EFF-DT    = EMPHST-POLICY-EFF-DT  AND
 10497        PM-REFERENCE-NUMBER = EMPHST-REFERENCE-NUMBER
 10498         NEXT SENTENCE
 10499     ELSE
 10500         GO TO 1700-ENDBROWSE.
 10501
 10502     IF PM-LIFE-MORT-PLAN
 10503         IF PH-RECORD-TYPE = '02' AND
 10504            PH-FIELD-TYPE  = '21'
 10505             NEXT SENTENCE
 10506         ELSE
 10507             GO TO 1700-ENDBROWSE.
 10508
 10509     IF NOT PM-LIFE-MORT-PLAN
 10510         IF PH-RECORD-TYPE = '04' AND
 10511            PH-FIELD-TYPE  = '07'
 10512             NEXT SENTENCE
 10513         ELSE
 10514             GO TO 1700-ENDBROWSE.
 10515
 10516     IF PH-CHANGE-DT > CL-INCURRED-DT
 10517         GO TO 1700-READ-NEXT.
 10518
 10519     MOVE PH-RECORD-BODY         TO  WS-HISTORY-AREA.
 10520
 10521
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL150.cbl
 10522* EXEC CICS BIF
 10523*        DEEDIT
 10524*        FIELD (WS-HISTORY-AREA)
 10525*        LENGTH ('50')
 10526*    END-EXEC.
 10527     MOVE '50'
 10528       TO DFHEIV11
 10529*    MOVE '@"L                   #   #00009743' TO DFHEIV0
 10530     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10531     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10532     MOVE X'2020233030303039373433' TO DFHEIV0(25:11)
 10533     CALL 'kxdfhei1' USING DFHEIV0,
 10534           WS-HISTORY-AREA,
 10535           DFHEIV11
 10536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10537
 10538
 10539     IF PM-LIFE-MORT-PLAN
 10540         MOVE WS-NUMERIC-FLD1    TO  PM-INSURED-TOT-BENEFIT
 10541     ELSE
 10542         MOVE WS-NUMERIC-FLD1    TO  PM-INS-MONTH-BENEFIT.
 10543
 10544 1700-ENDBROWSE.
 10545
 10546
 10547* EXEC CICS ENDBR
 10548*        DATASET   (EMPHST-FILE-ID)
 10549*    END-EXEC.
 10550     MOVE 0
 10551       TO DFHEIV11
 10552*    MOVE '&2                    $   #00009756' TO DFHEIV0
 10553     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10555     MOVE X'2020233030303039373536' TO DFHEIV0(25:11)
 10556     CALL 'kxdfhei1' USING DFHEIV0,
 10557           EMPHST-FILE-ID,
 10558           DFHEIV11,
 10559           DFHEIV99
 10560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10561
 10562
 10563 1700-EXIT.
 10564      EXIT.
 10565
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL150.cbl
 10567 2000-BUILD-TRAILER-DISPLAY.
 10568
 10569     IF DIRECTION-SWITCH = 'F'
 10570        IF PI-PREV-DIR = 'B' AND PI-PREV-DISP = 'N'
 10571           MOVE PI-SAVE-LOW    TO TRLR-SEQ-NO
 10572        ELSE
 10573           MOVE PI-SAVE-HIGH   TO TRLR-SEQ-NO
 10574           ADD +1              TO TRLR-SEQ-NO
 10575     ELSE
 10576        IF DIRECTION-SWITCH = 'B'
 10577           IF PI-PREV-DIR = 'F' AND PI-PREV-DISP = 'N'
 10578              MOVE PI-SAVE-HIGH TO TRLR-SEQ-NO
 10579           ELSE
 10580              MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
 10581        ELSE
 10582           IF DIRECTION-SWITCH = 'R'
 10583              MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
 10584              MOVE 'F'        TO DIRECTION-SWITCH
 10585           ELSE
 10586              IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10587                  MOVE +95     TO  TRLR-SEQ-NO
 10588                  MOVE +0      TO  PI-SAVE-LOW
 10589                                   PI-SAVE-HIGH
 10590                  MOVE 'N'     TO  PI-PREV-DISP
 10591                  MOVE 'F'     TO  DIRECTION-SWITCH
 10592              ELSE
 10593                  MOVE +93     TO  TRLR-SEQ-NO
 10594                  MOVE +0      TO  PI-SAVE-LOW
 10595                                   PI-SAVE-HIGH
 10596                  MOVE 'N'     TO  PI-PREV-DISP
 10597                  MOVE 'F'     TO  DIRECTION-SWITCH.
 10598
 10599     IF DIRECTION-SWITCH = 'F'
 10600         MOVE +1                 TO DISPLAY-CNT
 10601     ELSE
 10602         MOVE +4                 TO DISPLAY-CNT.
 10603
 10604     MOVE PI-COMPANY-CD          TO TRLR-COMP-CD.
 10605     MOVE PI-CARRIER             TO TRLR-CARRIER.
 10606     MOVE PI-CLAIM-NO            TO TRLR-CLAIM-NO.
 10607     MOVE PI-CERT-NO             TO TRLR-CERT-NO.
 10608     MOVE 'TRLR'                 TO FILE-SWITCH.
 10609
 10610     IF PI-SAVE-SYS-ID = 'CV'
 10611         NEXT SENTENCE
 10612     ELSE
 10613         GO TO 2005-BUILD-CR-LOAN-DATA.
 10614
 10615     IF WS-CERT-READ-SW = 'Y'
 10616       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 10617         IF CL-SYSTEM-IDENTIFIER = 'CV'
 10618           MOVE PM-INS-TERMINATION-DT    TO  DC-BIN-DATE-1
 10619           MOVE ' '                      TO  DC-OPTION-CODE
 10620           MOVE +0                       TO  DC-ELAPSED-MONTHS
 10621                                             DC-ELAPSED-DAYS
 10622           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10623           IF NO-CONVERSION-ERROR
 10624               MOVE DC-GREG-DATE-1-EDIT  TO  WS-LOAN-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL150.cbl
 10625           ELSE
 10626               MOVE SPACES               TO  WS-LOAN-EXPIRE-DT.
 10627
 10628     IF WS-CERT-READ-SW = 'Y'
 10629       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 10630         MOVE SPACES                 TO  TRAILER-DISPLAY-WORK-AREA
 10631         MOVE 'LOAN INFO'            TO  DISPLAY-ACTION
 10632         MOVE ZEROS                  TO  DISPLAY-SEQ
 10633         MOVE WS-LOAN-EXPIRE-DT      TO  DISPLAY-DATE
 10634         MOVE PM-LOAN-NUMBER         TO  ASSOC-CV-LOAN
 10635         MOVE ASSOC-CV-LOAN-TEXT     TO  DISPLAY-TEXT
 10636         MOVE TRAILER-DISPLAY-WORK-AREA
 10637                                     TO  MAP-DISPLAY (DISPLAY-CNT)
 10638         ADD +1                      TO  DISPLAY-CNT.
 10639
 10640     GO TO 2010-CONTINUE-TRAILER-DISPLAY.
 10641
 10642 2005-BUILD-CR-LOAN-DATA.
 10643
 10644     IF WS-CERT-READ-SW = 'Y'
 10645        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10646          IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10647            MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10648            MOVE ' '                     TO  DC-OPTION-CODE
 10649            MOVE +0                      TO  DC-ELAPSED-MONTHS
 10650                                             DC-ELAPSED-DAYS
 10651            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10652            IF NO-CONVERSION-ERROR
 10653              MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
 10654            ELSE
 10655              MOVE SPACES                TO  WS-LOAN-EXPIRE-DT
 10656          ELSE
 10657            MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10658            MOVE ' '                     TO  DC-OPTION-CODE
 10659            MOVE +0                      TO  DC-ELAPSED-MONTHS
 10660                                             DC-ELAPSED-DAYS
 10661            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10662            IF NO-CONVERSION-ERROR
 10663              MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
 10664            ELSE
 10665              MOVE SPACES                TO  WS-LOAN-EXPIRE-DT.
 10666
 10667     IF WS-CERT-READ-SW = 'Y'
 10668       IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10669         MOVE SPACES             TO  TRAILER-DISPLAY-WORK-AREA
 10670         MOVE ZEROS              TO  DISPLAY-SEQ
 10671         MOVE 'LOAN DATA'        TO  DISPLAY-ACTION
 10672         MOVE WS-LOAN-EXPIRE-DT  TO  DISPLAY-DATE
 10673         MOVE CM-LOAN-NUMBER     TO  ASSOC-ORIG-LOAN
 10674         MOVE CM-MEMBER-NO       TO  ASSOC-CUR-LOAN
 10675         MOVE CL-LOAN-TYPE       TO  ASSOC-LOAN-TYPE
 10676         MOVE ASSOC-LOAN-TEXT    TO  DISPLAY-TEXT
 10677         MOVE TRAILER-DISPLAY-WORK-AREA
 10678                                 TO  MAP-DISPLAY (DISPLAY-CNT)
 10679         ADD +1                  TO  DISPLAY-CNT
 10680       ELSE
 10681         IF CM-OPEN-END
 10682           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL150.cbl
 10683           MOVE 'LOAN INFO'      TO DISPLAY-ACTION
 10684           MOVE CM-LOAN-NUMBER   TO LOAN-NUMBER
 10685           MOVE CM-LOAN-BALANCE  TO LOAN-BALANCE
 10686           MOVE CM-MEMBER-NO     TO LOAN-MEMBER
 10687           MOVE LOAN-TEXT        TO DISPLAY-TEXT
 10688           MOVE TRAILER-DISPLAY-WORK-AREA
 10689                                 TO MAP-DISPLAY (DISPLAY-CNT)
 10690           ADD +1                TO DISPLAY-CNT.
 10691
 10692     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 10693        PERFORM 6150-READ-TRLR92 THRU 6150-EXIT
 10694        if ws-resp-normal
 10695           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
 10696           MOVE 'SPECIAL REVIEW' TO DISPLAY-ACTION
 10697           move at-recorded-by   to display-by
 10698           move at-recorded-dt   to dc-bin-date-1
 10699           MOVE ' '              TO DC-OPTION-CODE
 10700           PERFORM 9700-LINK-DATE-CONVERT
 10701                                 THRU 9700-EXIT
 10702           MOVE DC-GREG-DATE-1-EDIT
 10703                                 TO DISPLAY-DATE
 10704           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
 10705           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
 10706           MOVE TRAILER-DISPLAY-WORK-AREA
 10707                                 TO MAP-DISPLAY (1)
 10708           if direction-switch = 'F'
 10709              ADD +1             TO  DISPLAY-CNT
 10710           end-if
 10711        end-if
 10712        PERFORM 6160-READ-TRLR93 THRU 6160-EXIT
 10713        if ws-resp-normal
 10714           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
 10715           MOVE 'VERIFY SSN    ' TO DISPLAY-ACTION
 10716           move at-recorded-by   to display-by
 10717           move at-recorded-dt   to dc-bin-date-1
 10718           MOVE ' '              TO DC-OPTION-CODE
 10719           PERFORM 9700-LINK-DATE-CONVERT
 10720                                 THRU 9700-EXIT
 10721           MOVE DC-GREG-DATE-1-EDIT
 10722                                 TO DISPLAY-DATE
 10723           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
 10724           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
 10725           IF MAP-DISPLAY (1) (1:14) = 'SPECIAL REVIEW'
 10726               MOVE TRAILER-DISPLAY-WORK-AREA
 10727                                 TO MAP-DISPLAY (2)
 10728           ELSE
 10729               MOVE TRAILER-DISPLAY-WORK-AREA
 10730                                 TO MAP-DISPLAY (1)
 10731           END-IF
 10732           if direction-switch = 'F'
 10733              ADD +1             TO  DISPLAY-CNT
 10734           end-if
 10735        end-if
 10736     end-if
 10737     .
 10738 2010-CONTINUE-TRAILER-DISPLAY.
 10739
 10740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL150.cbl
 10741* EXEC CICS HANDLE CONDITION
 10742*        ENDFILE   (2950-NO-MORE-TRAILERS)
 10743*        NOTFND    (2950-NO-MORE-TRAILERS)
 10744*    END-EXEC.
 10745*    MOVE '"$''I                  ! 3 #00009937' TO DFHEIV0
 10746     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10748     MOVE X'3320233030303039393337' TO DFHEIV0(25:11)
 10749     CALL 'kxdfhei1' USING DFHEIV0
 10750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10751
 10752
 10753
 10754* EXEC CICS STARTBR
 10755*        DATASET   ('ELTRLR')
 10756*        GTEQ
 10757*        RIDFLD    (ELTRLR-KEY)
 10758*    END-EXEC.
 10759     MOVE 'ELTRLR' TO DFHEIV1
 10760     MOVE 0
 10761       TO DFHEIV11
 10762*    MOVE '&,         G          &   #00009942' TO DFHEIV0
 10763     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10764     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10765     MOVE X'2020233030303039393432' TO DFHEIV0(25:11)
 10766     CALL 'kxdfhei1' USING DFHEIV0,
 10767           DFHEIV1,
 10768           ELTRLR-KEY,
 10769           DFHEIV99,
 10770           DFHEIV11,
 10771           DFHEIV99
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10773
 10774
 10775     IF DIRECTION-SWITCH = 'B'
 10776         IF (PI-PREV-DISP = 'Y') OR (PI-PREV-DIR = 'B')
 10777
 10778* EXEC CICS READPREV
 10779*                DATASET ('ELTRLR')
 10780*                RIDFLD  (ELTRLR-KEY)
 10781*                SET     (ADDRESS OF ACTIVITY-TRAILERS)
 10782*            END-EXEC.
 10783     MOVE 'ELTRLR' TO DFHEIV1
 10784     MOVE 0
 10785       TO DFHEIV11
 10786*    MOVE '&0S                   )   #00009950' TO DFHEIV0
 10787     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 10788     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10789     MOVE X'2020233030303039393530' TO DFHEIV0(25:11)
 10790     CALL 'kxdfhei1' USING DFHEIV0,
 10791           DFHEIV1,
 10792           DFHEIV20,
 10793           DFHEIV99,
 10794           ELTRLR-KEY,
 10795           DFHEIV99,
 10796           DFHEIV11,
 10797           DFHEIV99,
 10798           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL150.cbl
 10799     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10800         DFHEIV20
 10801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10802
 10803
 10804     MOVE 'N'                    TO PI-PREV-DISP.
 10805
 10806     MOVE DIRECTION-SWITCH       TO PI-PREV-DIR.
 10807
 10808 2020-READ-TRAILER-LOOP.
 10809     IF DIRECTION-SWITCH = 'F'
 10810
 10811* EXEC CICS READNEXT
 10812*            DATASET   ('ELTRLR')
 10813*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10814*            RIDFLD    (ELTRLR-KEY)
 10815*        END-EXEC
 10816     MOVE 'ELTRLR' TO DFHEIV1
 10817     MOVE 0
 10818       TO DFHEIV11
 10819*    MOVE '&.S                   )   #00009962' TO DFHEIV0
 10820     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10821     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10822     MOVE X'2020233030303039393632' TO DFHEIV0(25:11)
 10823     CALL 'kxdfhei1' USING DFHEIV0,
 10824           DFHEIV1,
 10825           DFHEIV20,
 10826           DFHEIV99,
 10827           ELTRLR-KEY,
 10828           DFHEIV99,
 10829           DFHEIV11,
 10830           DFHEIV99,
 10831           DFHEIV99
 10832     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10833         DFHEIV20
 10834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10835     ELSE
 10836
 10837* EXEC CICS READPREV
 10838*            DATASET   ('ELTRLR')
 10839*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10840*            RIDFLD    (ELTRLR-KEY)
 10841*        END-EXEC.
 10842     MOVE 'ELTRLR' TO DFHEIV1
 10843     MOVE 0
 10844       TO DFHEIV11
 10845*    MOVE '&0S                   )   #00009968' TO DFHEIV0
 10846     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 10847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10848     MOVE X'2020233030303039393638' TO DFHEIV0(25:11)
 10849     CALL 'kxdfhei1' USING DFHEIV0,
 10850           DFHEIV1,
 10851           DFHEIV20,
 10852           DFHEIV99,
 10853           ELTRLR-KEY,
 10854           DFHEIV99,
 10855           DFHEIV11,
 10856           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL150.cbl
 10857           DFHEIV99
 10858     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10859         DFHEIV20
 10860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10861
 10862
 10863     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
 10864        (PI-CARRIER    NOT = TRLR-CARRIER)  OR
 10865        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
 10866        (PI-CERT-NO    NOT = TRLR-CERT-NO)
 10867            GO TO 2950-NO-MORE-TRAILERS.
 10868
 10869*    IF TRLR-SEQ-NO = 90
 10870     IF TRLR-SEQ-NO = 90 or 91 or 92 or 93
 10871         GO TO 2020-READ-TRAILER-LOOP.
 10872
 10873     IF PI-COMPANY-ID = 'LAP'
 10874         IF TRLR-SEQ-NO > +100 AND < +301
 10875             GO TO 2020-READ-TRAILER-LOOP.
 10876
 10877     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
 10878         GO TO 2020-READ-TRAILER-LOOP.
 10879
 10880     IF PAYMENT-TR
 10881         GO TO 2100-PAYMENT-TRAILER.
 10882
 10883     IF AUTO-PAY-TR
 10884        GO TO 2200-AUTO-PAYMENT-TRAILER.
 10885
 10886     IF CORRESPONDENCE-TR
 10887         GO TO 2300-CORRESPONDENCE-TRAILER.
 10888
 10889     IF GENERAL-INFO-TR
 10890         GO TO 2400-GENERAL-INFO-TRAILER.
 10891
 10892     IF AUTO-PROMPT-TR
 10893         GO TO 2500-AUTO-PROMPT-TRAILER.
 10894
 10895     IF DENIAL-TR
 10896         GO TO 2600-DENIAL-TRAILER.
 10897
 10898     IF INCURRED-CHG-TR
 10899         GO TO 2700-INCURRED-CHANGE-TRAILER.
 10900
 10901     IF FORM-CONTROL-TR
 10902         GO TO 2710-FORM-CONTROL-TRAILER.
 10903
 10904     GO TO 2020-READ-TRAILER-LOOP.
 10905
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL150.cbl
 10907 2100-PAYMENT-TRAILER.
 10908
 10909     IF AT-PAYMENT-NOTE
 10910         GO TO 2020-READ-TRAILER-LOOP.
 10911
 10912     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 10913
 10914     IF AT-PAYMENT-TYPE = 'T'
 10915         MOVE 'TRANSFER PMT'     TO DISPLAY-ACTION
 10916         GO TO 2100-CONT.
 10917
 10918     IF PI-SAVE-SYS-ID = 'CV'
 10919         IF AT-CLAIM-TYPE = 'L'
 10920             MOVE AT-CV-PMT-CODE             TO  WS-SUB
 10921             IF WS-SUB < 1 OR > 8
 10922                 MOVE 1                      TO  WS-SUB
 10923                 MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION
 10924             ELSE
 10925                 MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION.
 10926
 10927     IF AT-PAYMENT-TYPE = 'I'
 10928        MOVE 'INTEREST PMT'      TO DISPLAY-ACTION
 10929     ELSE
 10930     IF (PI-SAVE-SYS-ID = 'CV' AND AT-CLAIM-TYPE = 'A')
 10931                  OR
 10932         PI-SAVE-SYS-ID NOT = 'CV'
 10933         MOVE AT-PAYMENT-TYPE           TO  WS-SUB
 10934         IF WS-SUB < 1 OR > 6
 10935             MOVE 2                     TO  WS-SUB
 10936             MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION
 10937         ELSE
 10938             MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION.
 10939
 10940 2100-CONT.
 10941
 10942     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 10943     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 10944     MOVE ' '                    TO DC-OPTION-CODE.
 10945     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10946     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 10947     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 10948
 10949     IF AT-VOID-DT NOT = LOW-VALUES
 10950        MOVE AT-VOID-DT         TO DC-BIN-DATE-1
 10951        MOVE ' '                TO DC-OPTION-CODE
 10952        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10953        MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 10954        IF AT-VOID-TYPE = 'S'
 10955            MOVE 'STOP DT='     TO PMT-VAR
 10956        ELSE
 10957            MOVE 'VOIDED ='     TO PMT-VAR
 10958     ELSE
 10959        IF AT-PAID-THRU-DT NOT = LOW-VALUES
 10960           MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
 10961           MOVE ' '             TO DC-OPTION-CODE
 10962           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10963           MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 10964           MOVE 'PD THRU='     TO PMT-VAR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL150.cbl
 10965           IF PI-USES-PAID-TO
 10966              MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
 10967              MOVE '6'             TO DC-OPTION-CODE
 10968              MOVE +1              TO DC-ELAPSED-DAYS
 10969              MOVE +0              TO DC-ELAPSED-MONTHS
 10970              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10971              MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 10972              MOVE 'PAID TO='      TO PMT-VAR
 10973           ELSE
 10974              NEXT SENTENCE
 10975        ELSE
 10976           IF CHARGEABLE-EXPENSE OR NON-CHARGEABLE-EXPENSE
 10977              MOVE 'EXP TYP='       TO PMT-VAR
 10978              MOVE AT-EXPENSE-TYPE  TO PMT-PD-THRU
 10979           ELSE
 10980              MOVE SPACES      TO PMT-VAR  PMT-PD-THRU.
 10981
 10982     MOVE AT-CHECK-NO               TO PMT-CHECK-NO.
 10983     MOVE AT-AMOUNT-PAID            TO PMT-AMOUNT.
 10984     MOVE PAYMENT-TEXT              TO DISPLAY-TEXT.
 10985     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 10986
 10987     GO TO 2800-INCR-DISPLAY-CNT.
 10988
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL150.cbl
 10990 2200-AUTO-PAYMENT-TRAILER.
 10991     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 10992     MOVE 'AUTO PMT SETUP'       TO DISPLAY-ACTION.
 10993     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 10994
 10995     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 10996     MOVE ' '                    TO DC-OPTION-CODE.
 10997     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10998     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 10999
 11000     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11001
 11002     IF PI-COMPANY-ID = 'DMD'
 11003        IF AT-TERMINATED-DT NOT = SPACES AND ZEROS
 11004                                         AND LOW-VALUES
 11005           MOVE AT-TERMINATED-DT          TO DC-BIN-DATE-1
 11006           MOVE ' '                       TO DC-OPTION-CODE
 11007           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11008           MOVE DC-GREG-DATE-1-EDIT       TO AUTO-TERMINATED
 11009           MOVE AT-REGULAR-PMT-AMT        TO AUTO-TERM-AMT
 11010           MOVE AUTO-TERM-TEXT            TO DISPLAY-TEXT
 11011           MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY
 11012                                            (DISPLAY-CNT)
 11013           GO TO 2800-INCR-DISPLAY-CNT.
 11014
 11015     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
 11016     MOVE ' '                    TO DC-OPTION-CODE.
 11017     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11018     MOVE DC-GREG-DATE-1-EDIT    TO AUTO-START.
 11019
 11020     IF PI-USES-PAID-TO
 11021         MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
 11022         MOVE '6'                       TO  DC-OPTION-CODE
 11023         MOVE +1                        TO  DC-ELAPSED-DAYS
 11024         MOVE +0                        TO  DC-ELAPSED-MONTHS
 11025         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11026         IF NO-CONVERSION-ERROR
 11027             MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
 11028         ELSE
 11029             MOVE SPACES                TO  AUTO-END
 11030     ELSE
 11031         MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
 11032         MOVE ' '                       TO  DC-OPTION-CODE
 11033         MOVE +0                        TO  DC-ELAPSED-DAYS
 11034                                            DC-ELAPSED-MONTHS
 11035         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11036         IF NO-CONVERSION-ERROR
 11037             MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
 11038         ELSE
 11039             MOVE SPACES                TO  AUTO-END.
 11040
 11041     MOVE AT-REGULAR-PMT-AMT        TO AUTO-AMOUNT.
 11042     MOVE AUTO-PMT-TEXT             TO DISPLAY-TEXT.
 11043     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11044
 11045     GO TO 2800-INCR-DISPLAY-CNT.
 11046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL150.cbl
 11048 2300-CORRESPONDENCE-TRAILER.
 11049     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11050     MOVE 'LETTER'               TO DISP-ACT-A.
 11051     MOVE AT-STD-LETTER-FORM     TO DISP-ACT-B.
 11052     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11053
 11054     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11055     MOVE ' '                    TO DC-OPTION-CODE.
 11056     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11057     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11058
 11059     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11060
 11061     IF AT-ADDRESEE-TYPE = 'I'
 11062         MOVE 1                  TO WS-SUB
 11063      ELSE
 11064     IF AT-ADDRESEE-TYPE = 'B'
 11065         MOVE 2                  TO WS-SUB
 11066      ELSE
 11067     IF AT-ADDRESEE-TYPE = 'A'
 11068         MOVE 3                  TO WS-SUB
 11069      ELSE
 11070     IF AT-ADDRESEE-TYPE = 'P'
 11071         MOVE 4                  TO WS-SUB
 11072      ELSE
 11073     IF AT-ADDRESEE-TYPE = 'E'
 11074         MOVE 5                  TO WS-SUB
 11075      ELSE
 11076     IF AT-ADDRESEE-TYPE = 'O'
 11077         MOVE 6                  TO WS-SUB
 11078      ELSE
 11079     IF AT-ADDRESEE-TYPE = 'Q'
 11080         MOVE 7                  TO WS-SUB
 11081      ELSE
 11082         MOVE 0                  TO WS-SUB.
 11083
 11084     IF WS-SUB = 0
 11085         MOVE SPACES             TO  CORR-TO
 11086     ELSE
 11087         MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
 11088
 11089     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
 11090        AND (AT-LETTER-ANSWERED-DT = LOW-VALUES  OR
 11091             AT-LETTER-ANSWERED-DT > AT-STOP-LETTER-DT)
 11092          MOVE '   STOP='         TO CORR-RECVD-LIT
 11093          MOVE AT-STOP-LETTER-DT  TO DC-BIN-DATE-1
 11094          MOVE ' '                TO DC-OPTION-CODE
 11095          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11096          MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11097     ELSE
 11098        MOVE '  RECVD='         TO CORR-RECVD-LIT
 11099        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
 11100            MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
 11101            MOVE ' '                TO DC-OPTION-CODE
 11102            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11103            MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11104        ELSE
 11105            MOVE SPACES             TO CORR-RECVD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL150.cbl
 11106        END-IF
 11107     END-IF.
 11108
 11109     IF AT-RESEND-PRINT-DATE NOT = LOW-VALUES
 11110         MOVE '  RESENT='          TO CORR-VAR
 11111         MOVE AT-RESEND-PRINT-DATE TO DC-BIN-DATE-1
 11112         MOVE ' '                  TO DC-OPTION-CODE
 11113         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11114         MOVE DC-GREG-DATE-1-EDIT  TO CORR-RESENT
 11115     ELSE
 11116         IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
 11117             MOVE '  RESEND='         TO CORR-VAR
 11118             MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
 11119             MOVE ' '                 TO DC-OPTION-CODE
 11120             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11121             MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 11122         ELSE
 11123            IF AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11124               MOVE 'ARCH. NO='          TO CORR-VAR
 11125               MOVE AT-LETTER-ARCHIVE-NO TO CORR-ARCH-NO
 11126            ELSE
 11127               MOVE SPACES       TO CORR-RESENT  CORR-VAR.
 11128
 11129*    IF PI-COMPANY-ID = 'DMD'
 11130*        IF AT-DMD-LETTER-PURGE-DT NOT = SPACES AND LOW-VALUES
 11131*            MOVE '  PURGED='             TO CORR-VAR
 11132*            MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
 11133*            MOVE ' '                     TO DC-OPTION-CODE
 11134*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11135*            MOVE DC-GREG-DATE-1-EDIT     TO CORR-RESENT.
 11136
 11137     MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
 11138     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11139
 11140     GO TO 2800-INCR-DISPLAY-CNT.
 11141
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL150.cbl
 11143 2400-GENERAL-INFO-TRAILER.
 11144
 11145     IF AT-PAYMENT-NOTE
 11146         GO TO 2020-READ-TRAILER-LOOP.
 11147
 11148     IF AT-CONTINUED-NOTE
 11149         GO TO 2020-READ-TRAILER-LOOP.
 11150
 11151     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11152
 11153     IF AT-MAINT-NOTE
 11154         MOVE 'MAINT NOTES'      TO DISPLAY-ACTION
 11155     ELSE
 11156         IF AT-CALL-NOTE
 11157             MOVE 'CALL'         TO DISP-ACT-A
 11158             IF AT-PHONE-CALL-IN
 11159                 MOVE 'IN'       TO DISP-ACT-B
 11160             ELSE
 11161                 MOVE 'OUT'      TO DISP-ACT-B
 11162         ELSE
 11163             IF AT-CERT-CHANGE
 11164                 MOVE 'CERT CHANGE'
 11165                                 TO DISPLAY-ACTION
 11166             ELSE IF AT-APPROVAL-NOTE
 11167                 MOVE 'APPROVL REVIEW' TO DISPLAY-ACTION
 11168             ELSE IF AT-NOTE-FILE-NOTE
 11169                 MOVE 'NOTE & FILE' TO DISPLAY-ACTION
 11170             ELSE
 11171                 MOVE 'NOTE'     TO DISPLAY-ACTION.
 11172
 11173     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11174     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11175     MOVE ' '                    TO DC-OPTION-CODE.
 11176     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11177     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11178
 11179     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11180     MOVE AT-INFO-LINE-1         TO DISPLAY-TEXT.
 11181     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11182     GO TO 2800-INCR-DISPLAY-CNT.
 11183
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL150.cbl
 11185 2500-AUTO-PROMPT-TRAILER.
 11186     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11187     MOVE '5'                    TO DC-OPTION-CODE.
 11188     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11189
 11190     IF DC-BIN-DATE-1 > AT-PROMPT-END-DT
 11191         GO TO 2020-READ-TRAILER-LOOP.
 11192
 11193     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11194     MOVE 'REMINDER'             TO DISPLAY-ACTION.
 11195     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11196
 11197     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11198     MOVE ' '                    TO DC-OPTION-CODE.
 11199     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11200     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11201
 11202     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11203
 11204     MOVE AT-PROMPT-END-DT       TO DC-BIN-DATE-1.
 11205     MOVE ' '                    TO DC-OPTION-CODE.
 11206     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11207     MOVE DC-GREG-DATE-1-EDIT    TO PROMPT-END.
 11208
 11209     MOVE AT-PROMPT-LINE-1       TO PROMPT-MSG.
 11210     MOVE PROMPT-TEXT            TO DISPLAY-TEXT.
 11211     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11212     GO TO 2800-INCR-DISPLAY-CNT.
 11213
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL150.cbl
 11215 2600-DENIAL-TRAILER.
 11216     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11217     MOVE 'DENIAL'               TO DISPLAY-ACTION.
 11218     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11219
 11220     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11221     MOVE ' '                    TO DC-OPTION-CODE.
 11222     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11223     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11224
 11225     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11226
 11227     IF AT-RETRACTION-DT NOT = LOW-VALUES
 11228         MOVE AT-DENIAL-DT       TO DC-BIN-DATE-1
 11229         MOVE ' '                TO DC-OPTION-CODE
 11230         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11231         MOVE DC-GREG-DATE-1-EDIT TO DENIED-DATE
 11232         MOVE AT-RETRACTION-DT   TO DC-BIN-DATE-1
 11233         MOVE ' '                TO DC-OPTION-CODE
 11234         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11235         MOVE DC-GREG-DATE-1-EDIT TO RECONSIDERED-DATE
 11236         MOVE RECONSIDERED-TEXT   TO DISPLAY-TEXT
 11237         MOVE TRAILER-DISPLAY-WORK-AREA
 11238                                 TO MAP-DISPLAY (DISPLAY-CNT)
 11239         GO TO 2800-INCR-DISPLAY-CNT.
 11240
 11241     MOVE AT-DENIAL-DT           TO DC-BIN-DATE-1.
 11242     MOVE ' '                    TO DC-OPTION-CODE.
 11243     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11244     MOVE DC-GREG-DATE-1-EDIT    TO DENIAL-DATE.
 11245
 11246     MOVE AT-DENIAL-REASON-CODE  TO DENIAL-CODE.
 11247     MOVE AT-DENIAL-INFO-1       TO DENIAL-MSG.
 11248     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
 11249        EVALUATE CL-DENIAL-TYPE
 11250           WHEN '1'
 11251              MOVE 'DENIAL STATUS - DENIAL       '
 11252                                 TO DENTYPO
 11253           WHEN '2'
 11254              MOVE 'DENIAL STATUS - RESCISSION   '
 11255                                 TO DENTYPO
 11256           WHEN '3'
 11257              MOVE 'DENIAL STATUS - REFORMATION  '
 11258                                 TO DENTYPO
 11259           WHEN '4'
 11260              MOVE 'DENIAL STATUS - REF TO RESC  '
 11261                                 TO DENTYPO
 11262           WHEN '5'
 11263              MOVE 'DENIAL STATUS - RECONSIDERED '
 11264                                 TO DENTYPO
 11265        END-EVALUATE
 11266        MOVE AL-SANOF            TO DENTYPA
 11267     END-IF
 11268     MOVE DENIAL-TEXT            TO DISPLAY-TEXT.
 11269     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11270     GO TO 2800-INCR-DISPLAY-CNT.
 11271
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL150.cbl
 11273 2700-INCURRED-CHANGE-TRAILER.
 11274     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11275     MOVE 'INCUR DATE CHG'       TO DISPLAY-ACTION.
 11276     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11277
 11278     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11279     MOVE ' '                    TO DC-OPTION-CODE.
 11280     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11281     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11282
 11283     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11284
 11285     IF AT-OLD-INCURRED-DT NOT = LOW-VALUES
 11286        MOVE AT-OLD-INCURRED-DT  TO DC-BIN-DATE-1
 11287        MOVE ' '                 TO DC-OPTION-CODE
 11288        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11289        IF DATE-CONVERSION-ERROR
 11290           MOVE SPACES           TO INCUR-DT
 11291        ELSE
 11292           MOVE DC-GREG-DATE-1-EDIT  TO INCUR-DT
 11293     ELSE
 11294        MOVE SPACES              TO INCUR-DT.
 11295
 11296     IF PI-USES-PAID-TO
 11297        MOVE ' PD  TO ='         TO PDTHRU-HEAD.
 11298
 11299     IF AT-OLD-PAID-THRU-DT NOT = LOW-VALUES
 11300        MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
 11301        MOVE ' '                 TO DC-OPTION-CODE
 11302        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11303        IF DATE-CONVERSION-ERROR
 11304           MOVE SPACES           TO INCUR-PDTHRU
 11305        ELSE
 11306           MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
 11307           IF PI-USES-PAID-TO
 11308              MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
 11309              MOVE '6'                 TO DC-OPTION-CODE
 11310              MOVE +1                  TO DC-ELAPSED-DAYS
 11311              MOVE +0                  TO DC-ELAPSED-MONTHS
 11312              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11313              IF NO-CONVERSION-ERROR
 11314                 MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
 11315              ELSE
 11316                 NEXT SENTENCE
 11317           ELSE
 11318              NEXT SENTENCE
 11319     ELSE
 11320        MOVE SPACES              TO INCUR-PDTHRU.
 11321
 11322     MOVE AT-OLD-TOTAL-PAID      TO INCUR-PAID.
 11323     MOVE INCUR-TEXT             TO DISPLAY-TEXT.
 11324     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11325     GO TO 2800-INCR-DISPLAY-CNT.
 11326
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL150.cbl
 11328 2710-FORM-CONTROL-TRAILER.
 11329     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11330     MOVE 'FORM CTL'             TO DISP-ACT-A.
 11331     IF INITIAL-FORM
 11332        MOVE 'INIT'              TO DISP-ACT-B
 11333     ELSE
 11334        MOVE 'PROG'              TO DISP-ACT-B.
 11335
 11336     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11337
 11338     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11339     MOVE ' '                    TO DC-OPTION-CODE.
 11340     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11341     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11342
 11343     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11344
 11345     IF AT-FORM-ADDRESS = 'I'
 11346         MOVE 1                  TO WS-SUB
 11347      ELSE
 11348     IF AT-FORM-ADDRESS = 'A'
 11349         MOVE 3                  TO WS-SUB
 11350      ELSE
 11351     IF AT-FORM-ADDRESS = 'O'
 11352         MOVE 6                  TO WS-SUB
 11353      ELSE
 11354     IF AT-FORM-ADDRESS = 'Q'
 11355         MOVE 7                  TO WS-SUB
 11356      ELSE
 11357         MOVE 0                  TO WS-SUB.
 11358
 11359     IF WS-SUB = 0
 11360         MOVE SPACES             TO  CORR-TO
 11361     ELSE
 11362         MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
 11363
 11364     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
 11365         MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
 11366         MOVE ' '                 TO DC-OPTION-CODE
 11367         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11368         MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11369     ELSE
 11370         MOVE SPACES              TO CORR-RECVD.
 11371
 11372     IF AT-FORM-PRINTED-DT  = LOW-VALUES
 11373         MOVE '    SEND='         TO CORR-VAR
 11374         MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
 11375         MOVE ' '                 TO DC-OPTION-CODE
 11376         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11377         MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 11378     ELSE
 11379         MOVE '    SENT='        TO CORR-VAR
 11380         IF AT-FORM-REPRINT-DT  = LOW-VALUES
 11381            MOVE AT-FORM-PRINTED-DT TO DC-BIN-DATE-1
 11382            MOVE ' '                TO DC-OPTION-CODE
 11383            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11384            MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 11385         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL150.cbl
 11386            MOVE AT-FORM-REPRINT-DT TO DC-BIN-DATE-1
 11387            MOVE ' '                TO DC-OPTION-CODE
 11388            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11389            MOVE DC-GREG-DATE-1-EDIT    TO CORR-RESENT.
 11390
 11391     MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
 11392     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11393
 11394     GO TO 2800-INCR-DISPLAY-CNT.
 11395
 11396 2800-INCR-DISPLAY-CNT.
 11397     IF LCP-ONCTR-01 =  0
 11398         ADD 1 TO LCP-ONCTR-01
 11399         MOVE 'Y'                TO PI-PREV-DISP
 11400         MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW  PI-SAVE-HIGH.
 11401
 11402     IF DIRECTION-SWITCH = 'F'
 11403         MOVE TRLR-SEQ-NO        TO PI-SAVE-HIGH
 11404         ADD +1                  TO DISPLAY-CNT
 11405         IF DISPLAY-CNT > +4
 11406             GO TO 2999-EXIT
 11407         ELSE
 11408             NEXT SENTENCE
 11409     ELSE
 11410         MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW
 11411         SUBTRACT +1 FROM DISPLAY-CNT
 11412         if map-display (1) (1:14) = 'SPECIAL REVIEW'
 11413           OR MAP-DISPLAY (1) (1:14) = 'VERIFY SSN    '
 11414            IF MAP-DISPLAY (2) (1:14) = 'VERIFY SSN    '
 11415               IF DISPLAY-CNT < +3
 11416                   GO TO 2999-EXIT
 11417               END-IF
 11418            END-IF
 11419            IF DISPLAY-CNT < +2
 11420               GO TO 2999-EXIT
 11421            END-IF
 11422         ELSE
 11423            IF DISPLAY-CNT < +1
 11424               GO TO 2999-EXIT.
 11425
 11426     GO TO 2020-READ-TRAILER-LOOP.
 11427
 11428 2950-NO-MORE-TRAILERS.
 11429     MOVE ER-0303                TO EMI-ERROR.
 11430     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11431
 11432 2999-EXIT.
 11433     EXIT.
 11434
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL150.cbl
 11436 6000-CHECK-AUTO-ACTIVITY.
 11437******************************************************************
 11438*    READ THE CONTROL FILE TO VERIFY THAT AN AUTOMATIC           *
 11439*    ACTIVITY RECORD EXISTS.                                     *
 11440******************************************************************
 11441
 11442
 11443* EXEC CICS HANDLE CONDITION
 11444*        NOTFND   (6000-NOT-FOUND)
 11445*    END-EXEC.
 11446*    MOVE '"$I                   ! 4 #00010553' TO DFHEIV0
 11447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11449     MOVE X'3420233030303130353533' TO DFHEIV0(25:11)
 11450     CALL 'kxdfhei1' USING DFHEIV0
 11451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11452
 11453
 11454     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
 11455     MOVE 'T'                    TO  CNTL-REC-TYPE
 11456     MOVE SPACES                 TO  CNTL-ACCESS
 11457     MOVE +0                     TO  CNTL-SEQ-NO
 11458     MOVE 'CNTL'                 TO  FILE-SWITCH.
 11459
 11460
 11461* EXEC CICS READ
 11462*        DATASET   ('ELCNTL')
 11463*        RIDFLD    (ELCNTL-KEY)
 11464*        SET       (ADDRESS OF CONTROL-FILE)
 11465*    END-EXEC.
 11466     MOVE 'ELCNTL' TO DFHEIV1
 11467*    MOVE '&"S        E          (   #00010563' TO DFHEIV0
 11468     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11470     MOVE X'2020233030303130353633' TO DFHEIV0(25:11)
 11471     CALL 'kxdfhei1' USING DFHEIV0,
 11472           DFHEIV1,
 11473           DFHEIV20,
 11474           DFHEIV99,
 11475           ELCNTL-KEY,
 11476           DFHEIV99,
 11477           DFHEIV99,
 11478           DFHEIV99
 11479     SET ADDRESS OF CONTROL-FILE TO
 11480         DFHEIV20
 11481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11482
 11483
 11484     MOVE 'Y'                    TO  WS-ACT-REC-FOUND-SW.
 11485     GO TO 6000-EXIT.
 11486
 11487 6000-NOT-FOUND.
 11488     MOVE 'N'                    TO  WS-ACT-REC-FOUND-SW.
 11489     MOVE AL-UABON               TO  ACTCDA.
 11490     MOVE -1                     TO  ACTCDL.
 11491     MOVE ER-3516                TO  EMI-ERROR
 11492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11493
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL150.cbl
 11494 6000-EXIT.
 11495     EXIT.
 11496
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL150.cbl
 11498 6050-AUTO-LETTER-WRITER.
 11499******************************************************************
 11500*    THE FOLLOWING ACTIVITIES WILL BE PERFORMED BASED ON THE     *
 11501*    CODES ENTERED IN THE AUTOMATIC ACTIVITY RECORD.             *
 11502*       1.  IF SPECIFIED, THE AUTOMATIC LETTER WRITER PROGRAM    *
 11503*           WILL BE LINKED TO AND A LETTER WILL BE GENERATED.    *
 11504*           A.  ANY RESEND OR FOLLOW UP DATES SPECIFIED IN THE   *
 11505*               ACTIVITY RECORD WILL BE STORED IN THE LETTER     *
 11506******************************************************************
 11507
 11508     IF WS-ACTIVITY-CODE = ZERO
 11509         GO TO 6050-EXIT.
 11510
 11511     MOVE WS-ACTIVITY-CODE       TO  SUB.
 11512     SUBTRACT 9 FROM SUB.
 11513
 11514 6050-EDIT-USER-ACTIVITY-LOOP.
 11515
 11516     IF (CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N') OR
 11517        (CF-USER-LETTER-ID (SUB) = SPACES OR LOW-VALUES)
 11518             GO TO 6050-EXIT.
 11519
 11520 6050-START-AUTO-LETTER-WRITER.
 11521
 11522     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 11523     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 11524
 11525     MOVE CF-USER-LETTER-ID (SUB)    TO W-1523-FORM-NUMBER.
 11526
 11527     IF CF-USER-RESEND-DAYS (SUB) NOT = ZEROS
 11528         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 11529         MOVE '6'                    TO  DC-OPTION-CODE
 11530         MOVE CF-USER-RESEND-DAYS (SUB)  TO  DC-ELAPSED-DAYS
 11531         MOVE +0                     TO  DC-ELAPSED-MONTHS
 11532         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11533         IF NO-CONVERSION-ERROR
 11534             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 11535         ELSE
 11536             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
 11537
 11538     IF CF-USER-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 11539         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 11540         MOVE '6'                    TO  DC-OPTION-CODE
 11541         MOVE CF-USER-FOLLOW-UP-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 11542         MOVE +0                     TO  DC-ELAPSED-MONTHS
 11543         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11544         IF NO-CONVERSION-ERROR
 11545             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 11546         ELSE
 11547             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
 11548
 11549******************************************************************
 11550*    LINK TO THE AUTOMATIC LETTER WRITER PROGRAM.                *
 11551******************************************************************
 11552
 11553
 11554* EXEC CICS LINK
 11555*        PROGRAM    (LINK-1523)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL150.cbl
 11556*        COMMAREA   (W-1523-LINKDATA)
 11557*        LENGTH     (W-1523-COMM-LENGTH)
 11558*    END-EXEC.
 11559*    MOVE '."C                   ''   #00010638' TO DFHEIV0
 11560     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11561     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11562     MOVE X'2020233030303130363338' TO DFHEIV0(25:11)
 11563     CALL 'kxdfhei1' USING DFHEIV0,
 11564           LINK-1523,
 11565           W-1523-LINKDATA,
 11566           W-1523-COMM-LENGTH,
 11567           DFHEIV99,
 11568           DFHEIV99,
 11569           DFHEIV99
 11570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11571
 11572
 11573******************************************************************
 11574*    CHECK THE ERROR CODES FROM THE AUTOMATIC LETTER WRITER      *
 11575*    PROGRAM.                                                    *
 11576*        1.  IF FATAL ERRORS ARE DETECTED BY THE AUTO LETTER     *
 11577*            WRITER PROGRAM, THE LETTER IS NOT CREATED AND AN    *
 11578*            ERROR MESSAGE (#0802) IS DISPLAYED INDICATING THAT  *
 11579*            THE LETTER WAS NOT CREATED.                         *
 11580*        2.  IF THE AUTO LETTER WRITER PROGRAM IS UNABLE TO      *
 11581*            RESOLVE A VARIABLE, THE LETTER IS CREATED AND AN    *
 11582*            ERROR MESSAGE (#0803) INDICATING THAT THE LETTER    *
 11583*            WAS CREATED WITH ERRORS IS DISPLAYED.               *
 11584******************************************************************
 11585
 11586     IF W-1523-ERROR-CODE = ZEROS
 11587         GO TO 6050-EXIT.
 11588
 11589     IF W-1523-FATAL-ERROR
 11590         MOVE ER-0802                TO  EMI-ERROR
 11591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11592
 11593     IF W-1523-ERROR-CODE = 0191
 11594         MOVE ER-0803                TO  EMI-ERROR
 11595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11596
 11597 6050-EXIT.
 11598     EXIT.
 11599
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL150.cbl
 11601 6100-RESET-AUTO-ACTIVITY.
 11602******************************************************************
 11603*    RESET ALL LETTER ACTIVITY AWAITING FURTHER ACTION (RESEND,  *
 11604*    FOLLOW-UP, ETC) IF THE AUTOMATIC ACTIVITY CODE IS SET       *
 11605*    TO ZEROS.                                                   *
 11606******************************************************************
 11607
 11608     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 11609     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 11610     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 11611     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 11612     MOVE +100                   TO  TRLR-SEQ-NO.
 11613     MOVE 'TRLR'                 TO  FILE-SWITCH.
 11614
 11615 6100-STARTBR-TRLR.
 11616
 11617
 11618* EXEC CICS HANDLE CONDITION
 11619*        ENDFILE  (6100-END-RESET)
 11620*        NOTFND   (6100-END-RESET)
 11621*    END-EXEC.
 11622*    MOVE '"$''I                  ! 5 #00010688' TO DFHEIV0
 11623     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11625     MOVE X'3520233030303130363838' TO DFHEIV0(25:11)
 11626     CALL 'kxdfhei1' USING DFHEIV0
 11627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11628
 11629
 11630
 11631* EXEC CICS STARTBR
 11632*        DATASET   ('ELTRLR')
 11633*        RIDFLD    (ELTRLR-KEY)
 11634*        GTEQ
 11635*    END-EXEC.
 11636     MOVE 'ELTRLR' TO DFHEIV1
 11637     MOVE 0
 11638       TO DFHEIV11
 11639*    MOVE '&,         G          &   #00010693' TO DFHEIV0
 11640     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11641     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11642     MOVE X'2020233030303130363933' TO DFHEIV0(25:11)
 11643     CALL 'kxdfhei1' USING DFHEIV0,
 11644           DFHEIV1,
 11645           ELTRLR-KEY,
 11646           DFHEIV99,
 11647           DFHEIV11,
 11648           DFHEIV99
 11649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11650
 11651
 11652     MOVE 'Y'                        TO  WS-BROWSE-SW.
 11653
 11654 6100-READ-NEXT.
 11655
 11656
 11657* EXEC CICS READNEXT
 11658*        DATASET   ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL150.cbl
 11659*        RIDFLD    (ELTRLR-KEY)
 11660*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11661*    END-EXEC.
 11662     MOVE 'ELTRLR' TO DFHEIV1
 11663     MOVE 0
 11664       TO DFHEIV11
 11665*    MOVE '&.S                   )   #00010703' TO DFHEIV0
 11666     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11667     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11668     MOVE X'2020233030303130373033' TO DFHEIV0(25:11)
 11669     CALL 'kxdfhei1' USING DFHEIV0,
 11670           DFHEIV1,
 11671           DFHEIV20,
 11672           DFHEIV99,
 11673           ELTRLR-KEY,
 11674           DFHEIV99,
 11675           DFHEIV11,
 11676           DFHEIV99,
 11677           DFHEIV99
 11678     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11679         DFHEIV20
 11680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11681
 11682
 11683     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)   OR
 11684        (PI-CARRIER    NOT = TRLR-CARRIER)   OR
 11685        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO)  OR
 11686        (PI-CERT-NO    NOT = TRLR-CERT-NO)
 11687         GO TO 6100-END-RESET.
 11688
 11689     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 11690         GO TO 6100-READ-NEXT.
 11691
 11692     IF AT-TRAILER-TYPE NOT = '4'
 11693         GO TO 6100-READ-NEXT.
 11694
 11695     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 11696         GO TO 6100-READ-NEXT.
 11697
 11698     IF (AT-AUTO-RE-SEND-DT = LOW-VALUES OR SPACES)
 11699       AND
 11700        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 11701         GO TO 6100-READ-NEXT.
 11702
 11703     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 11704        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 11705        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 11706         GO TO 6100-READ-NEXT.
 11707
 11708     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 11709       AND
 11710        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 11711       AND
 11712        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 11713         GO TO 6100-READ-NEXT.
 11714
 11715 6100-END-BROWSE.
 11716
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL150.cbl
 11717     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 11718
 11719
 11720* EXEC CICS ENDBR
 11721*        DATASET   ('ELTRLR')
 11722*    END-EXEC.
 11723     MOVE 'ELTRLR' TO DFHEIV1
 11724     MOVE 0
 11725       TO DFHEIV11
 11726*    MOVE '&2                    $   #00010745' TO DFHEIV0
 11727     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11728     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11729     MOVE X'2020233030303130373435' TO DFHEIV0(25:11)
 11730     CALL 'kxdfhei1' USING DFHEIV0,
 11731           DFHEIV1,
 11732           DFHEIV11,
 11733           DFHEIV99
 11734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11735
 11736
 11737     MOVE 'N'                        TO  WS-BROWSE-SW.
 11738
 11739 6100-READ-TRLR-UPDATE.
 11740
 11741
 11742* EXEC CICS READ
 11743*        DATASET   ('ELTRLR')
 11744*        RIDFLD    (ELTRLR-KEY)
 11745*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11746*        UPDATE
 11747*    END-EXEC.
 11748     MOVE 'ELTRLR' TO DFHEIV1
 11749*    MOVE '&"S        EU         (   #00010753' TO DFHEIV0
 11750     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11751     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11752     MOVE X'2020233030303130373533' TO DFHEIV0(25:11)
 11753     CALL 'kxdfhei1' USING DFHEIV0,
 11754           DFHEIV1,
 11755           DFHEIV20,
 11756           DFHEIV99,
 11757           ELTRLR-KEY,
 11758           DFHEIV99,
 11759           DFHEIV99,
 11760           DFHEIV99
 11761     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11762         DFHEIV20
 11763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11764
 11765
 11766     MOVE 'Y'                        TO  WS-UPDATE-SW.
 11767
 11768     IF AT-AUTO-RE-SEND-DT IS NOT < SAVE-BIN-DATE
 11769         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 11770         MOVE PI-COMPANY-CD          TO  ARCH-COMP-CD
 11771         MOVE AT-LETTER-ARCHIVE-NO   TO  ARCH-ARCHIVE-NO
 11772         MOVE '1'                    TO  ARCH-RECORD-TYPE
 11773         MOVE +0                     TO  ARCH-SEQ-NO
 11774         PERFORM 6200-READ-ARCH-UPDATE THRU 6200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL150.cbl
 11775
 11776     IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 11777         MOVE LOW-VALUES             TO  AT-RECEIPT-FOLLOW-UP.
 11778
 11779 6100-REWRITE-TRLR.
 11780
 11781
 11782* EXEC CICS REWRITE
 11783*        DATASET   ('ELTRLR')
 11784*        FROM      (ACTIVITY-TRAILERS)
 11785*    END-EXEC.
 11786     MOVE LENGTH OF
 11787      ACTIVITY-TRAILERS
 11788       TO DFHEIV11
 11789     MOVE 'ELTRLR' TO DFHEIV1
 11790*    MOVE '&& L                  %   #00010775' TO DFHEIV0
 11791     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11792     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11793     MOVE X'2020233030303130373735' TO DFHEIV0(25:11)
 11794     CALL 'kxdfhei1' USING DFHEIV0,
 11795           DFHEIV1,
 11796           ACTIVITY-TRAILERS,
 11797           DFHEIV11,
 11798           DFHEIV99
 11799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11800
 11801
 11802     GO TO 6100-STARTBR-TRLR.
 11803
 11804 6100-END-RESET.
 11805
 11806     IF WS-BROWSE-SW = 'Y'
 11807         MOVE 'N'                    TO  WS-BROWSE-SW
 11808
 11809* EXEC CICS ENDBR
 11810*            DATASET   ('ELTRLR')
 11811*        END-EXEC.
 11812     MOVE 'ELTRLR' TO DFHEIV1
 11813     MOVE 0
 11814       TO DFHEIV11
 11815*    MOVE '&2                    $   #00010786' TO DFHEIV0
 11816     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11817     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11818     MOVE X'2020233030303130373836' TO DFHEIV0(25:11)
 11819     CALL 'kxdfhei1' USING DFHEIV0,
 11820           DFHEIV1,
 11821           DFHEIV11,
 11822           DFHEIV99
 11823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11824
 11825
 11826 6100-EXIT.
 11827     EXIT.
 11828
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL150.cbl
 11830 6150-READ-TRLR92.
 11831
 11832     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
 11833     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
 11834     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
 11835     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
 11836     MOVE +092                   TO  WS-TRLR-SEQ-NO.
 11837     MOVE 'TRLR'                 TO  FILE-SWITCH.
 11838
 11839
 11840* EXEC CICS READ
 11841*        DATASET   ('ELTRLR')
 11842*        RIDFLD    (WS-ELTRLR-KEY)
 11843*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11844*        RESP      (WS-RESPONSE)
 11845*    END-EXEC.
 11846     MOVE 'ELTRLR' TO DFHEIV1
 11847*    MOVE '&"S        E          (  N#00010803' TO DFHEIV0
 11848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11850     MOVE X'204E233030303130383033' TO DFHEIV0(25:11)
 11851     CALL 'kxdfhei1' USING DFHEIV0,
 11852           DFHEIV1,
 11853           DFHEIV20,
 11854           DFHEIV99,
 11855           WS-ELTRLR-KEY,
 11856           DFHEIV99,
 11857           DFHEIV99,
 11858           DFHEIV99
 11859     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11860         DFHEIV20
 11861     MOVE EIBRESP  TO WS-RESPONSE
 11862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11863
 11864
 11865     .
 11866 6150-EXIT.
 11867     EXIT.
 11868
 11869 6160-READ-TRLR93.
 11870
 11871     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
 11872     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
 11873     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
 11874     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
 11875     MOVE +093                   TO  WS-TRLR-SEQ-NO.
 11876     MOVE 'TRLR'                 TO  FILE-SWITCH.
 11877
 11878
 11879* EXEC CICS READ
 11880*        DATASET   ('ELTRLR')
 11881*        RIDFLD    (WS-ELTRLR-KEY)
 11882*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11883*        RESP      (WS-RESPONSE)
 11884*    END-EXEC.
 11885     MOVE 'ELTRLR' TO DFHEIV1
 11886*    MOVE '&"S        E          (  N#00010823' TO DFHEIV0
 11887     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL150.cbl
 11888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11889     MOVE X'204E233030303130383233' TO DFHEIV0(25:11)
 11890     CALL 'kxdfhei1' USING DFHEIV0,
 11891           DFHEIV1,
 11892           DFHEIV20,
 11893           DFHEIV99,
 11894           WS-ELTRLR-KEY,
 11895           DFHEIV99,
 11896           DFHEIV99,
 11897           DFHEIV99
 11898     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11899         DFHEIV20
 11900     MOVE EIBRESP  TO WS-RESPONSE
 11901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11902
 11903
 11904     .
 11905 6160-EXIT.
 11906     EXIT.
 11907
 11908 6200-READ-ARCH-UPDATE.
 11909******************************************************************
 11910*  READ AND UPDATE THE RESEND DATE ON THE LETTER ARCHIVE RECORD  *
 11911******************************************************************
 11912
 11913
 11914* EXEC CICS HANDLE CONDITION
 11915*        NOTFND   (6200-EXIT)
 11916*    END-EXEC.
 11917*    MOVE '"$I                   ! 6 #00010839' TO DFHEIV0
 11918     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11920     MOVE X'3620233030303130383339' TO DFHEIV0(25:11)
 11921     CALL 'kxdfhei1' USING DFHEIV0
 11922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11923
 11924
 11925
 11926* EXEC CICS READ
 11927*        DATASET   ('ELARCH')
 11928*        RIDFLD    (ELARCH-KEY)
 11929*        SET       (ADDRESS OF LETTER-ARCHIVE)
 11930*        UPDATE
 11931*    END-EXEC.
 11932     MOVE 'ELARCH' TO DFHEIV1
 11933*    MOVE '&"S        EU         (   #00010843' TO DFHEIV0
 11934     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11935     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11936     MOVE X'2020233030303130383433' TO DFHEIV0(25:11)
 11937     CALL 'kxdfhei1' USING DFHEIV0,
 11938           DFHEIV1,
 11939           DFHEIV20,
 11940           DFHEIV99,
 11941           ELARCH-KEY,
 11942           DFHEIV99,
 11943           DFHEIV99,
 11944           DFHEIV99
 11945     SET ADDRESS OF LETTER-ARCHIVE TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL150.cbl
 11946         DFHEIV20
 11947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11948
 11949
 11950     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 11951
 11952 6200-REWRITE-ARCH.
 11953
 11954* EXEC CICS REWRITE
 11955*        DATASET   ('ELARCH')
 11956*        FROM      (LETTER-ARCHIVE)
 11957*    END-EXEC.
 11958     MOVE LENGTH OF
 11959      LETTER-ARCHIVE
 11960       TO DFHEIV11
 11961     MOVE 'ELARCH' TO DFHEIV1
 11962*    MOVE '&& L                  %   #00010853' TO DFHEIV0
 11963     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11964     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11965     MOVE X'2020233030303130383533' TO DFHEIV0(25:11)
 11966     CALL 'kxdfhei1' USING DFHEIV0,
 11967           DFHEIV1,
 11968           LETTER-ARCHIVE,
 11969           DFHEIV11,
 11970           DFHEIV99
 11971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11972
 11973
 11974 6200-EXIT.
 11975     EXIT.
 11976
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL150.cbl
 11978 7000-START-BROWSE.
 11979
 11980     IF PI-COMPANY-ID = 'DMD'
 11981             AND
 11982        PI-ASS-PROCESSING
 11983         GO TO 7200-BROWSING-ASS-FWRD.
 11984
 11985     MOVE LOW-VALUES             TO  ELMSTR-KEY.
 11986     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
 11987
 11988     IF CLMNOL > 0
 11989         MOVE CLMNOI             TO  MSTR-CLAIM-NO.
 11990     IF CARRL > 0
 11991         MOVE CARRI              TO  MSTR-CARRIER.
 11992     IF CERTNOL > 0
 11993         MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
 11994     IF SUFXL > 0
 11995         MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
 11996
 11997     IF PI-PREV-CLAIM = LOW-VALUES
 11998         NEXT SENTENCE
 11999     ELSE
 12000         IF CLMNOL  = 0 AND
 12001            CARRL   = 0 AND
 12002            CERTNOL = 0 AND
 12003            SUFXL   = 0
 12004                 MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
 12005
 12006 7000-START-READING.
 12007
 12008
 12009* EXEC CICS HANDLE CONDITION
 12010*        ENDFILE  (8700-END-FILE)
 12011*        NOTFND   (8600-NOT-FOUND)
 12012*    END-EXEC.
 12013*    MOVE '"$''I                  ! 7 #00010892' TO DFHEIV0
 12014     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 12015     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12016     MOVE X'3720233030303130383932' TO DFHEIV0(25:11)
 12017     CALL 'kxdfhei1' USING DFHEIV0
 12018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12019
 12020
 12021     IF YESNOSWL > 0
 12022         MOVE YESNOSWI TO CL-YESNOSW
 12023     END-IF.
 12024
 12025     MOVE 'MSTR'                 TO FILE-SWITCH.
 12026
 12027
 12028* EXEC CICS STARTBR
 12029*        DATASET   (PI-CURRENT-FILE)
 12030*        RIDFLD    (ELMSTR-KEY)
 12031*    END-EXEC.
 12032     MOVE 0
 12033       TO DFHEIV11
 12034*    MOVE '&,         G          &   #00010903' TO DFHEIV0
 12035     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL150.cbl
 12036     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12037     MOVE X'2020233030303130393033' TO DFHEIV0(25:11)
 12038     CALL 'kxdfhei1' USING DFHEIV0,
 12039           PI-CURRENT-FILE,
 12040           ELMSTR-KEY,
 12041           DFHEIV99,
 12042           DFHEIV11,
 12043           DFHEIV99
 12044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12045
 12046
 12047 7000-READ-NEXT.
 12048
 12049
 12050* EXEC CICS READNEXT
 12051*        DATASET   (PI-CURRENT-FILE)
 12052*        RIDFLD    (ELMSTR-KEY)
 12053*        INTO      (CLAIM-MASTER)
 12054*    END-EXEC.
 12055     MOVE LENGTH OF
 12056      CLAIM-MASTER
 12057       TO DFHEIV12
 12058     MOVE 0
 12059       TO DFHEIV11
 12060*    MOVE '&.IL                  )   #00010910' TO DFHEIV0
 12061     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12062     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12063     MOVE X'2020233030303130393130' TO DFHEIV0(25:11)
 12064     CALL 'kxdfhei1' USING DFHEIV0,
 12065           PI-CURRENT-FILE,
 12066           CLAIM-MASTER,
 12067           DFHEIV12,
 12068           ELMSTR-KEY,
 12069           DFHEIV99,
 12070           DFHEIV11,
 12071           DFHEIV99,
 12072           DFHEIV99
 12073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12074
 12075
 12076     IF ELMSTR-KEY = PI-PREV-CLAIM
 12077         MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
 12078         GO TO 7000-READ-NEXT.
 12079
 12080     IF PI-COMPANY-CD NOT = CL-COMPANY-CD
 12081         GO TO 8700-END-FILE.
 12082
 12083 7000-PICK-UP-LOGIC.
 12084
 12085     IF PI-COMPANY-ID  =  'CRI'
 12086         IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
 12087             GO TO 8700-END-FILE.
 12088
 12089     IF PI-CARRIER-SECURITY > SPACES
 12090         IF CL-CARRIER = PI-CARRIER-SECURITY
 12091             NEXT SENTENCE
 12092         ELSE
 12093             GO TO 7000-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL150.cbl
 12094
 12095     IF PI-ACCOUNT-SECURITY > SPACES
 12096         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
 12097             NEXT SENTENCE
 12098         ELSE
 12099             GO TO 7000-READ-NEXT.
 12100
 12101     GO TO 1000-READ-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL150.cbl
 12103 7200-BROWSING-ASS-FWRD.
 12104
 12105     COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1.
 12106
 12107     IF PI-ASS-NDX > +24
 12108             OR
 12109        PI-ASS-CERTS (PI-ASS-NDX) NOT > LOW-VALUE
 12110         IF PI-PF15-LAST
 12111             MOVE PI-ORIGINAL-ASS-CERT
 12112                                 TO ELMSTR-KEY
 12113             MOVE ZEROS          TO PI-DAYS-PAID
 12114                                    PI-TOTAL-PAID
 12115             MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
 12116                                    PI-LAST-PF-KEY-IND
 12117                                    PI-ASSOCIATED-PROCESS-IND
 12118             GO TO 7000-START-READING
 12119         ELSE
 12120             COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1
 12121             MOVE 'F'            TO PI-LAST-PF-KEY-IND
 12122             MOVE -1             TO ENTERPFL
 12123             MOVE ER-0936        TO EMI-ERROR
 12124             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12125             GO TO 8200-SEND-DATAONLY.
 12126
 12127     MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
 12128     MOVE PI-ASS-CERTS (PI-ASS-NDX)
 12129                                 TO MSTR-CERT-NO.
 12130     MOVE 'MSTR'                 TO FILE-SWITCH.
 12131
 12132
 12133* EXEC CICS HANDLE CONDITION
 12134*        NOTFND   (0450-NOT-FOUND)
 12135*    END-EXEC.
 12136*    MOVE '"$I                   ! 8 #00010972' TO DFHEIV0
 12137     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12139     MOVE X'3820233030303130393732' TO DFHEIV0(25:11)
 12140     CALL 'kxdfhei1' USING DFHEIV0
 12141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12142
 12143
 12144
 12145* EXEC CICS READ
 12146*        DATASET   (PI-CURRENT-FILE)
 12147*        RIDFLD    (ELMSTR-KEY)
 12148*        INTO      (CLAIM-MASTER)
 12149*    END-EXEC.
 12150     MOVE LENGTH OF
 12151      CLAIM-MASTER
 12152       TO DFHEIV11
 12153*    MOVE '&"IL       E          (   #00010976' TO DFHEIV0
 12154     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12156     MOVE X'2020233030303130393736' TO DFHEIV0(25:11)
 12157     CALL 'kxdfhei1' USING DFHEIV0,
 12158           PI-CURRENT-FILE,
 12159           CLAIM-MASTER,
 12160           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL150.cbl
 12161           ELMSTR-KEY,
 12162           DFHEIV99,
 12163           DFHEIV99,
 12164           DFHEIV99
 12165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12166
 12167
 12168     GO TO 7000-PICK-UP-LOGIC.
 12169
 12170 7200-EXIT.
 12171     EXIT.
 12172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL150.cbl
 12174 7500-START-BROWSE.
 12175
 12176     IF PI-COMPANY-ID = 'DMD'
 12177             AND
 12178        PI-ASS-PROCESSING
 12179         GO TO 7600-BROWSING-ASS-BWRD.
 12180
 12181     MOVE LOW-VALUES             TO  ELMSTR-KEY.
 12182     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
 12183
 12184     IF CLMNOL > 0
 12185         MOVE CLMNOI             TO  MSTR-CLAIM-NO.
 12186     IF CARRL > 0
 12187         MOVE CARRI              TO  MSTR-CARRIER.
 12188     IF CERTNOL > 0
 12189         MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
 12190     IF SUFXL > 0
 12191         MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
 12192
 12193     IF PI-PREV-CLAIM = LOW-VALUES
 12194         NEXT SENTENCE
 12195     ELSE
 12196         IF CLMNOL  = 0 AND
 12197            CARRL   = 0 AND
 12198            CERTNOL = 0 AND
 12199            SUFXL   = 0
 12200                 MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
 12201
 12202 7500-START-READING.
 12203
 12204
 12205* EXEC CICS HANDLE CONDITION
 12206*        ENDFILE  (8700-END-FILE)
 12207*        NOTFND   (8600-NOT-FOUND)
 12208*    END-EXEC.
 12209*    MOVE '"$''I                  ! 9 #00011018' TO DFHEIV0
 12210     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 12211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12212     MOVE X'3920233030303131303138' TO DFHEIV0(25:11)
 12213     CALL 'kxdfhei1' USING DFHEIV0
 12214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12215
 12216
 12217     MOVE 'MSTR'                 TO  FILE-SWITCH.
 12218
 12219
 12220* EXEC CICS STARTBR
 12221*        DATASET   (PI-CURRENT-FILE)
 12222*        RIDFLD    (ELMSTR-KEY)
 12223*    END-EXEC.
 12224     MOVE 0
 12225       TO DFHEIV11
 12226*    MOVE '&,         G          &   #00011025' TO DFHEIV0
 12227     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12228     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12229     MOVE X'2020233030303131303235' TO DFHEIV0(25:11)
 12230     CALL 'kxdfhei1' USING DFHEIV0,
 12231           PI-CURRENT-FILE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL150.cbl
 12232           ELMSTR-KEY,
 12233           DFHEIV99,
 12234           DFHEIV11,
 12235           DFHEIV99
 12236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12237
 12238
 12239 7500-READ-PREV.
 12240
 12241
 12242* EXEC CICS READPREV
 12243*        DATASET   (PI-CURRENT-FILE)
 12244*        RIDFLD    (ELMSTR-KEY)
 12245*        INTO      (CLAIM-MASTER)
 12246*    END-EXEC.
 12247     MOVE LENGTH OF
 12248      CLAIM-MASTER
 12249       TO DFHEIV12
 12250     MOVE 0
 12251       TO DFHEIV11
 12252*    MOVE '&0IL                  )   #00011032' TO DFHEIV0
 12253     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
 12254     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12255     MOVE X'2020233030303131303332' TO DFHEIV0(25:11)
 12256     CALL 'kxdfhei1' USING DFHEIV0,
 12257           PI-CURRENT-FILE,
 12258           CLAIM-MASTER,
 12259           DFHEIV12,
 12260           ELMSTR-KEY,
 12261           DFHEIV99,
 12262           DFHEIV11,
 12263           DFHEIV99,
 12264           DFHEIV99
 12265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12266
 12267
 12268     IF ELMSTR-KEY = PI-PREV-CLAIM
 12269         MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
 12270         GO TO 7500-READ-PREV.
 12271
 12272     IF PI-COMPANY-CD NOT = CL-COMPANY-CD
 12273         GO TO 8700-END-FILE.
 12274
 12275 7500-PICK-UP-LOGIC.
 12276
 12277     IF PI-COMPANY-ID  =  'CRI'
 12278         IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
 12279             GO TO 8700-END-FILE.
 12280
 12281     IF PI-CARRIER-SECURITY > SPACES
 12282         IF CL-CARRIER = PI-CARRIER-SECURITY
 12283             NEXT SENTENCE
 12284         ELSE
 12285             GO TO 7500-READ-PREV.
 12286
 12287     IF PI-ACCOUNT-SECURITY > SPACES
 12288         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
 12289             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL150.cbl
 12290         ELSE
 12291             GO TO 7500-READ-PREV.
 12292
 12293     GO TO 1000-READ-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL150.cbl
 12295 7600-BROWSING-ASS-BWRD.
 12296
 12297     COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1.
 12298
 12299     IF PI-ASS-NDX < +1
 12300         IF PI-PF16-LAST
 12301             MOVE PI-ORIGINAL-ASS-CERT
 12302                                 TO ELMSTR-KEY
 12303             MOVE ZEROS          TO PI-DAYS-PAID
 12304                                    PI-TOTAL-PAID
 12305             MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
 12306                                    PI-LAST-PF-KEY-IND
 12307                                    PI-ASSOCIATED-PROCESS-IND
 12308             GO TO 7500-START-READING
 12309         ELSE
 12310             COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1
 12311             MOVE 'S'            TO PI-LAST-PF-KEY-IND
 12312             MOVE -1             TO ENTERPFL
 12313             MOVE ER-0937        TO EMI-ERROR
 12314             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12315             GO TO 8200-SEND-DATAONLY.
 12316
 12317     MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
 12318     MOVE PI-ASS-CERTS (PI-ASS-NDX)
 12319                                 TO MSTR-CERT-NO.
 12320     MOVE 'MSTR'                 TO FILE-SWITCH.
 12321
 12322
 12323* EXEC CICS HANDLE CONDITION
 12324*        NOTFND   (0450-NOT-FOUND)
 12325*    END-EXEC.
 12326*    MOVE '"$I                   ! : #00011092' TO DFHEIV0
 12327     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12329     MOVE X'3A20233030303131303932' TO DFHEIV0(25:11)
 12330     CALL 'kxdfhei1' USING DFHEIV0
 12331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12332
 12333
 12334
 12335* EXEC CICS READ
 12336*        DATASET   (PI-CURRENT-FILE)
 12337*        RIDFLD    (ELMSTR-KEY)
 12338*        INTO      (CLAIM-MASTER)
 12339*    END-EXEC.
 12340     MOVE LENGTH OF
 12341      CLAIM-MASTER
 12342       TO DFHEIV11
 12343*    MOVE '&"IL       E          (   #00011096' TO DFHEIV0
 12344     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12346     MOVE X'2020233030303131303936' TO DFHEIV0(25:11)
 12347     CALL 'kxdfhei1' USING DFHEIV0,
 12348           PI-CURRENT-FILE,
 12349           CLAIM-MASTER,
 12350           DFHEIV11,
 12351           ELMSTR-KEY,
 12352           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL150.cbl
 12353           DFHEIV99,
 12354           DFHEIV99
 12355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12356
 12357
 12358     GO TO 7500-PICK-UP-LOGIC.
 12359
 12360 7600-EXIT.
 12361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL150.cbl
 12363 7650-CREATE-ACTQ.
 12364
 12365
 12366* EXEC CICS HANDLE CONDITION
 12367*        NOTFND(7650-CREATE-NEW-ACTQ)
 12368*    END-EXEC.
 12369*    MOVE '"$I                   ! ; #00011109' TO DFHEIV0
 12370     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12372     MOVE X'3B20233030303131313039' TO DFHEIV0(25:11)
 12373     CALL 'kxdfhei1' USING DFHEIV0
 12374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12375
 12376
 12377     MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
 12378     MOVE PI-CARRIER             TO ACTQ-CARRIER.
 12379     MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
 12380     MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
 12381
 12382     MOVE 'ACTQ'                 TO FILE-SWITCH.
 12383     MOVE 'ELACTQ  '             TO FILE-ID.
 12384
 12385
 12386* EXEC CICS READ
 12387*        UPDATE
 12388*        DATASET   ('ELACTQ')
 12389*        SET       (ADDRESS OF ACTIVITY-QUE)
 12390*        RIDFLD    (ELACTQ-KEY)
 12391*    END-EXEC.
 12392     MOVE 'ELACTQ' TO DFHEIV1
 12393*    MOVE '&"S        EU         (   #00011121' TO DFHEIV0
 12394     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12395     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12396     MOVE X'2020233030303131313231' TO DFHEIV0(25:11)
 12397     CALL 'kxdfhei1' USING DFHEIV0,
 12398           DFHEIV1,
 12399           DFHEIV20,
 12400           DFHEIV99,
 12401           ELACTQ-KEY,
 12402           DFHEIV99,
 12403           DFHEIV99,
 12404           DFHEIV99
 12405     SET ADDRESS OF ACTIVITY-QUE TO
 12406         DFHEIV20
 12407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12408
 12409
 12410     MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
 12411
 12412     MOVE +150                   TO AQ-LAST-UPDATED-BY.
 12413
 12414     MOVE 'ELACTQ  '             TO FILE-ID.
 12415
 12416
 12417* EXEC CICS REWRITE
 12418*        DATASET   ('ELACTQ')
 12419*        FROM      (ACTIVITY-QUE)
 12420*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL150.cbl
 12421     MOVE LENGTH OF
 12422      ACTIVITY-QUE
 12423       TO DFHEIV11
 12424     MOVE 'ELACTQ' TO DFHEIV1
 12425*    MOVE '&& L                  %   #00011134' TO DFHEIV0
 12426     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12427     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12428     MOVE X'2020233030303131313334' TO DFHEIV0(25:11)
 12429     CALL 'kxdfhei1' USING DFHEIV0,
 12430           DFHEIV1,
 12431           ACTIVITY-QUE,
 12432           DFHEIV11,
 12433           DFHEIV99
 12434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12435
 12436
 12437     GO TO 7650-EXIT.
 12438
 12439 7650-CREATE-NEW-ACTQ.
 12440
 12441
 12442* EXEC CICS GETMAIN
 12443*        SET       (ADDRESS OF ACTIVITY-QUE)
 12444*        LENGTH    (60)
 12445*        INITIMG   (GETMAIN-SPACE)
 12446*    END-EXEC.
 12447     MOVE 60
 12448       TO DFHEIV11
 12449*    MOVE ',"IL                  $   #00011143' TO DFHEIV0
 12450     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12451     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12452     MOVE X'2020233030303131313433' TO DFHEIV0(25:11)
 12453     CALL 'kxdfhei1' USING DFHEIV0,
 12454           DFHEIV20,
 12455           DFHEIV11,
 12456           GETMAIN-SPACE
 12457     SET ADDRESS OF ACTIVITY-QUE TO
 12458         DFHEIV20
 12459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12460
 12461
 12462     MOVE 'AQ'                   TO AQ-RECORD-ID.
 12463     MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
 12464     MOVE PI-CARRIER             TO AQ-CARRIER.
 12465     MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
 12466     MOVE PI-CERT-NO             TO AQ-CERT-NO.
 12467
 12468     MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
 12469
 12470     MOVE +0                     TO AQ-PAYMENT-COUNTER
 12471                                    AQ-PMT-UNAPPROVED-COUNT.
 12472
 12473     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 12474                                    AQ-FOLLOWUP-DATE.
 12475
 12476     MOVE +150                   TO AQ-LAST-UPDATED-BY.
 12477
 12478     MOVE 'ACTQ'                 TO FILE-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL150.cbl
 12479
 12480     MOVE 'ELACTQ  '             TO FILE-ID.
 12481
 12482
 12483* EXEC CICS WRITE
 12484*        DATASET   ('ELACTQ')
 12485*        FROM      (ACTIVITY-QUE)
 12486*        RIDFLD    (AQ-CONTROL-PRIMARY)
 12487*    END-EXEC.
 12488     MOVE LENGTH OF
 12489      ACTIVITY-QUE
 12490       TO DFHEIV11
 12491     MOVE 'ELACTQ' TO DFHEIV1
 12492*    MOVE '&$ L                  ''   #00011169' TO DFHEIV0
 12493     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12495     MOVE X'2020233030303131313639' TO DFHEIV0(25:11)
 12496     CALL 'kxdfhei1' USING DFHEIV0,
 12497           DFHEIV1,
 12498           ACTIVITY-QUE,
 12499           DFHEIV11,
 12500           AQ-CONTROL-PRIMARY,
 12501           DFHEIV99,
 12502           DFHEIV99
 12503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12504
 12505
 12506 7650-EXIT.
 12507     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL150.cbl
 12509 7700-CREATE-CLAIM.
 12510
 12511
 12512* EXEC CICS HANDLE CONDITION
 12513*        NOTFND   (7700-RETR-RECORD-NOT-FOUND)
 12514*        DUPREC   (7700-DUPLICATE-CLAIM)
 12515*    END-EXEC.
 12516*    MOVE '"$I%                  ! < #00011180' TO DFHEIV0
 12517     MOVE X'222449252020202020202020' TO DFHEIV0(1:12)
 12518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12519     MOVE X'3C20233030303131313830' TO DFHEIV0(25:11)
 12520     CALL 'kxdfhei1' USING DFHEIV0
 12521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12522
 12523
 12524     IF CLMNOL > 0
 12525         MOVE CLMNOI             TO PI-CLAIM-NO.
 12526
 12527     IF CARRL > 0
 12528         MOVE CARRI              TO PI-CARRIER.
 12529
 12530     IF CERTNOL > 0
 12531         MOVE CERTNOI            TO PI-CERT-PRIME.
 12532
 12533     IF SUFXL > 0
 12534         MOVE SUFXI              TO PI-CERT-SFX.
 12535
 12536     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12537     MOVE PI-CARRIER             TO MSTR-CARRIER.
 12538     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 12539     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 12540     MOVE +1                     TO PI-ASS-NDX.
 12541
 12542 7700-CONT-MOVE.
 12543
 12544     IF PI-ASS-PROCESSING
 12545         MOVE PI-ASS-CERTS (PI-ASS-NDX)
 12546                                 TO MSTR-CERT-NO.
 12547
 12548     MOVE ELMSTR-KEY             TO W-ELRETR-KEY.
 12549
 12550
 12551* EXEC CICS READ
 12552*        DATASET   ('ELRETR')
 12553*        SET       (ADDRESS OF RETRIEVE-MASTER)
 12554*        RIDFLD    (W-ELRETR-KEY)
 12555*    END-EXEC.
 12556     MOVE 'ELRETR' TO DFHEIV1
 12557*    MOVE '&"S        E          (   #00011211' TO DFHEIV0
 12558     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12560     MOVE X'2020233030303131323131' TO DFHEIV0(25:11)
 12561     CALL 'kxdfhei1' USING DFHEIV0,
 12562           DFHEIV1,
 12563           DFHEIV20,
 12564           DFHEIV99,
 12565           W-ELRETR-KEY,
 12566           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL150.cbl
 12567           DFHEIV99,
 12568           DFHEIV99
 12569     SET ADDRESS OF RETRIEVE-MASTER TO
 12570         DFHEIV20
 12571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12572
 12573
 12574
 12575* EXEC CICS GETMAIN
 12576*        SET       (ADDRESS OF CLAIM-MASTER-L)
 12577*        LENGTH    (350)
 12578*        INITIMG   (GETMAIN-SPACE)
 12579*    END-EXEC.
 12580     MOVE 350
 12581       TO DFHEIV11
 12582*    MOVE ',"IL                  $   #00011217' TO DFHEIV0
 12583     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12584     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12585     MOVE X'2020233030303131323137' TO DFHEIV0(25:11)
 12586     CALL 'kxdfhei1' USING DFHEIV0,
 12587           DFHEIV20,
 12588           DFHEIV11,
 12589           GETMAIN-SPACE
 12590     SET ADDRESS OF CLAIM-MASTER-L TO
 12591         DFHEIV20
 12592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12593
 12594
 12595     MOVE RETRIEVE-MASTER        TO CLAIM-MASTER.
 12596     MOVE 'CL'                   TO CL-RECORD-ID.
 12597     MOVE SAVE-BIN-DATE          TO CL-RESTORED-DT.
 12598
 12599
 12600* EXEC CICS WRITE
 12601*        DATASET   ('ELMSTR')
 12602*        FROM      (CLAIM-MASTER)
 12603*        RIDFLD    (CL-CONTROL-PRIMARY)
 12604*    END-EXEC.
 12605     MOVE LENGTH OF
 12606      CLAIM-MASTER
 12607       TO DFHEIV11
 12608     MOVE 'ELMSTR' TO DFHEIV1
 12609*    MOVE '&$ L                  ''   #00011227' TO DFHEIV0
 12610     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12611     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12612     MOVE X'2020233030303131323237' TO DFHEIV0(25:11)
 12613     CALL 'kxdfhei1' USING DFHEIV0,
 12614           DFHEIV1,
 12615           CLAIM-MASTER,
 12616           DFHEIV11,
 12617           CL-CONTROL-PRIMARY,
 12618           DFHEIV99,
 12619           DFHEIV99
 12620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12621
 12622
 12623
 12624* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL150.cbl
 12625*        FILE      ('ELRETR')
 12626*        RIDFLD    (RL-CONTROL-PRIMARY)
 12627*    END-EXEC.
 12628     MOVE 'ELRETR' TO DFHEIV1
 12629*    MOVE '&(  R                 &   #00011233' TO DFHEIV0
 12630     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12632     MOVE X'2020233030303131323333' TO DFHEIV0(25:11)
 12633     CALL 'kxdfhei1' USING DFHEIV0,
 12634           DFHEIV1,
 12635           RL-CONTROL-PRIMARY,
 12636           DFHEIV99,
 12637           DFHEIV99,
 12638           DFHEIV99
 12639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12640
 12641
 12642     IF PI-ASS-PROCESSING
 12643         ADD +1                  TO PI-ASS-NDX
 12644         IF PI-ASS-NDX < +25
 12645                 AND
 12646            PI-ASS-CERTS (PI-ASS-NDX) > SPACES
 12647             GO TO 7700-CONT-MOVE.
 12648
 12649     MOVE 'MSTR'                 TO FILE-SWITCH.
 12650     MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
 12651     MOVE LOW-VALUES             TO PI-RETRIEVED-DATA-IND.
 12652     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 12653     MOVE XCTL-132               TO PGM-NAME.
 12654     GO TO 9300-XCTL.
 12655
 12656 7700-RETR-RECORD-NOT-FOUND.
 12657
 12658     MOVE ER-0929                TO EMI-ERROR.
 12659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12660     MOVE -1                     TO CLMNOL.
 12661     MOVE PI-CARRIER             TO CARRO.
 12662     MOVE PI-CLAIM-NO            TO CLMNOO.
 12663     MOVE PI-CERT-PRIME          TO CERTNOO.
 12664     MOVE PI-CERT-SFX            TO SUFXO.
 12665     MOVE AL-UABON               TO CLMNOA   CARRA
 12666                                    CERTNOA  SUFXA.
 12667     GO TO 8100-SEND-INITIAL-MAP.
 12668
 12669 7700-DUPLICATE-CLAIM.
 12670
 12671     MOVE ER-0928                TO EMI-ERROR.
 12672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12673     MOVE -1                     TO CLMNOL.
 12674     MOVE PI-CARRIER             TO CARRO.
 12675     MOVE PI-CLAIM-NO            TO CLMNOO.
 12676     MOVE PI-CERT-PRIME          TO CERTNOO.
 12677     MOVE PI-CERT-SFX            TO SUFXO.
 12678     MOVE AL-UABON               TO CLMNOA   CARRA
 12679                                    CERTNOA  SUFXA.
 12680     GO TO 8100-SEND-INITIAL-MAP.
 12681
 12682 7700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL150.cbl
 12683     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL150.cbl
 12685 8000-LOAD-ERROR-MESSAGES.
 12686     IF EMI-NO-ERRORS
 12687         GO TO 8000-EXIT.
 12688
 12689     IF EMI-NUMBER-OF-LINES = 1
 12690         MOVE EMI-LINE1          TO ERRMSG1O
 12691         GO TO 8000-EXIT.
 12692
 12693     MOVE EMI-LINE1              TO ERRMSG1O.
 12694
 12695 8000-EXIT.
 12696     EXIT.
 12697
 12698 8100-SEND-INITIAL-MAP.
 12699
 12700     MOVE SAVE-DATE              TO RUNDTEO.
 12701     MOVE EIBTIME                TO TIME-IN.
 12702     MOVE TIME-OUT               TO RUNTIMEO.
 12703     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 12704     MOVE PI-PROCESSOR-ID        TO USERIDO.
 12705     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 12706
 12707     IF PI-USES-PAID-TO
 12708        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 12709
 12710     IF PI-RETRIEVED-DATA
 12711         MOVE 'RETRIEVE MASTER'  TO RETMSTO.
 12712
 12713     IF PI-COMPANY-ID = 'DMD'
 12714         MOVE 'PF11=FORM REF'    TO PFKEY11O
 12715         MOVE 'LST PMT AMT:'     TO COVERDO
 12716         MOVE 'LST PMT DT :'     TO PRMTYPDO
 12717         MOVE 'COVERAGE   :'     TO CRTSTADO.
 12718
 12719
 12720* EXEC CICS SEND
 12721*        MAP      (MAP-NAME)
 12722*        MAPSET   (MAPSET-NAME)
 12723*        FROM     (EL150AO)
 12724*        ERASE
 12725*        CURSOR
 12726*    END-EXEC.
 12727     MOVE LENGTH OF
 12728      EL150AO
 12729       TO DFHEIV12
 12730     MOVE -1
 12731       TO DFHEIV11
 12732*    MOVE '8$     CT  E    H L F ,   #00011315' TO DFHEIV0
 12733     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 12734     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12735     MOVE X'2020233030303131333135' TO DFHEIV0(25:11)
 12736     CALL 'kxdfhei1' USING DFHEIV0,
 12737           MAP-NAME,
 12738           EL150AO,
 12739           DFHEIV12,
 12740           MAPSET-NAME,
 12741           DFHEIV99,
 12742           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL150.cbl
 12743           DFHEIV99,
 12744           DFHEIV11,
 12745           DFHEIV99,
 12746           DFHEIV99,
 12747           DFHEIV99
 12748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12749
 12750
 12751     GO TO 9100-RETURN-TRAN.
 12752
 12753 8200-SEND-DATAONLY.
 12754     MOVE SAVE-DATE              TO RUNDTEO.
 12755     MOVE EIBTIME                TO TIME-IN.
 12756     MOVE TIME-OUT               TO RUNTIMEO.
 12757     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 12758     MOVE PI-PROCESSOR-ID        TO USERIDO.
 12759     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 12760
 12761     MOVE PI-CARRIER             TO CARRO.
 12762     MOVE PI-CLAIM-NO            TO CLMNOO.
 12763     MOVE PI-CERT-PRIME          TO CERTNOO.
 12764     MOVE PI-CERT-SFX            TO SUFXO.
 12765
 12766     IF PI-USES-PAID-TO
 12767        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 12768
 12769     IF PI-RETRIEVED-DATA
 12770         MOVE 'RETRIEVE MASTER'  TO RETMSTO.
 12771
 12772     IF PI-COMPANY-ID = 'DMD'
 12773         MOVE 'PF11=FORM REF'    TO PFKEY11O
 12774         MOVE 'LST PMT AMT:'     TO COVERDO
 12775         MOVE 'LST PMT DT :'     TO PRMTYPDO
 12776         MOVE 'COVERAGE   :'     TO CRTSTADO.
 12777
 12778
 12779* EXEC CICS SEND
 12780*        MAP      (MAP-NAME)
 12781*        MAPSET   (MAPSET-NAME)
 12782*        FROM     (EL150AO)
 12783*        DATAONLY
 12784*        CURSOR
 12785*    END-EXEC.
 12786     MOVE LENGTH OF
 12787      EL150AO
 12788       TO DFHEIV12
 12789     MOVE -1
 12790       TO DFHEIV11
 12791*    MOVE '8$D    CT       H L F ,   #00011350' TO DFHEIV0
 12792     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 12793     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12794     MOVE X'2020233030303131333530' TO DFHEIV0(25:11)
 12795     CALL 'kxdfhei1' USING DFHEIV0,
 12796           MAP-NAME,
 12797           EL150AO,
 12798           DFHEIV12,
 12799           MAPSET-NAME,
 12800           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL150.cbl
 12801           DFHEIV99,
 12802           DFHEIV99,
 12803           DFHEIV11,
 12804           DFHEIV99,
 12805           DFHEIV99,
 12806           DFHEIV99
 12807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12808
 12809
 12810     GO TO 9100-RETURN-TRAN.
 12811
 12812 8250-SEND-WITH-CURSOR.
 12813     MOVE SAVE-DATE              TO RUNDTEO.
 12814     MOVE EIBTIME                TO TIME-IN.
 12815     MOVE TIME-OUT               TO RUNTIMEO.
 12816     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 12817     MOVE PI-PROCESSOR-ID        TO USERIDO.
 12818     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 12819
 12820     IF PI-USES-PAID-TO
 12821        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 12822
 12823     IF PI-COMPANY-ID = 'DMD'
 12824         MOVE 'PF11=FORM REF'    TO PFKEY11O
 12825         MOVE 'LST PMT AMT:'     TO COVERDO
 12826         MOVE 'LST PMT DT :'     TO PRMTYPDO
 12827         MOVE 'COVERAGE   :'     TO CRTSTADO.
 12828
 12829
 12830* EXEC CICS SEND
 12831*        MAP      (MAP-NAME)
 12832*        MAPSET   (MAPSET-NAME)
 12833*        FROM     (EL150AO)
 12834*        ERASE
 12835*        CURSOR   (PI-SAVE-CURSOR)
 12836*    END-EXEC.
 12837     MOVE LENGTH OF
 12838      EL150AO
 12839       TO DFHEIV11
 12840*    MOVE '8$     CT  E    H L F ,   #00011377' TO DFHEIV0
 12841     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 12842     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12843     MOVE X'2020233030303131333737' TO DFHEIV0(25:11)
 12844     CALL 'kxdfhei1' USING DFHEIV0,
 12845           MAP-NAME,
 12846           EL150AO,
 12847           DFHEIV11,
 12848           MAPSET-NAME,
 12849           DFHEIV99,
 12850           DFHEIV99,
 12851           DFHEIV99,
 12852           PI-SAVE-CURSOR,
 12853           DFHEIV99,
 12854           DFHEIV99,
 12855           DFHEIV99
 12856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12857
 12858
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL150.cbl
 12859     GO TO 9100-RETURN-TRAN.
 12860
 12861 8300-SEND-TEXT.
 12862
 12863* EXEC CICS SEND TEXT
 12864*        FROM     (LOGOFF-TEXT)
 12865*        LENGTH   (LOGOFF-LENGTH)
 12866*        ERASE
 12867*        FREEKB
 12868*    END-EXEC.
 12869*    MOVE '8&      T  E F  H   F -   #00011388' TO DFHEIV0
 12870     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 12871     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 12872     MOVE X'2020233030303131333838' TO DFHEIV0(25:11)
 12873     CALL 'kxdfhei1' USING DFHEIV0,
 12874           LOGOFF-TEXT,
 12875           LOGOFF-LENGTH,
 12876           DFHEIV99,
 12877           DFHEIV99,
 12878           DFHEIV99,
 12879           DFHEIV99,
 12880           DFHEIV99,
 12881           DFHEIV99,
 12882           DFHEIV99,
 12883           DFHEIV99,
 12884           DFHEIV99,
 12885           DFHEIV99
 12886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12887
 12888
 12889
 12890* EXEC CICS RETURN
 12891*    END-EXEC.
 12892*    MOVE '.(                    &   #00011395' TO DFHEIV0
 12893     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 12894     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12895     MOVE X'2020233030303131333935' TO DFHEIV0(25:11)
 12896     CALL 'kxdfhei1' USING DFHEIV0,
 12897           DFHEIV99,
 12898           DFHEIV99,
 12899           DFHEIV99,
 12900           DFHEIV99,
 12901           DFHEIV99
 12902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12903
 12904
 12905 8500-FILE-NOTOPEN.
 12906     IF FILE-SWITCH = 'MSTR'
 12907         MOVE ER-0154            TO EMI-ERROR.
 12908
 12909     IF FILE-SWITCH = 'TRLR'
 12910         MOVE ER-0172            TO EMI-ERROR.
 12911
 12912     IF FILE-SWITCH = 'CERT'
 12913         MOVE ER-0169            TO EMI-ERROR.
 12914
 12915     IF FILE-SWITCH = 'CNTL'
 12916         MOVE ER-0042            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL150.cbl
 12917
 12918     IF FILE-SWITCH = 'ACTQ'
 12919         MOVE ER-0338            TO EMI-ERROR.
 12920
 12921     IF FILE-SWITCH = 'ACCT'
 12922         MOVE ER-0168            TO EMI-ERROR.
 12923
 12924     IF FILE-SWITCH = 'PLCY'
 12925         MOVE ER-9883            TO EMI-ERROR.
 12926
 12927     IF FILE-SWITCH = 'PLAN'
 12928         MOVE ER-9808            TO EMI-ERROR.
 12929
 12930     IF FILE-SWITCH = 'PROD'
 12931         MOVE ER-9886            TO EMI-ERROR.
 12932
 12933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12934
 12935     IF FILE-SWITCH = 'CERT' AND
 12936       (PI-COMPANY-ID = 'CID' OR 'AHL')
 12937        GO TO 1050-SHOW-CONTINUE.
 12938
 12939     MOVE -1                     TO FILETOL.
 12940
 12941     IF PASS-SWITCH = 'A'
 12942         GO TO 8100-SEND-INITIAL-MAP
 12943     ELSE
 12944         GO TO 8200-SEND-DATAONLY.
 12945
 12946 8600-NOT-FOUND.
 12947     MOVE AL-UABON               TO CLMNOA    CARRA
 12948                                    CERTNOA   SUFXA.
 12949     MOVE -1                     TO ENTERPFL.
 12950     MOVE ER-0204                TO EMI-ERROR.
 12951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12952     GO TO 8200-SEND-DATAONLY.
 12953
 12954 8700-END-FILE.
 12955
 12956     MOVE -1                     TO ENTERPFL.
 12957     MOVE ER-0130                TO EMI-ERROR.
 12958     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12959     GO TO 8200-SEND-DATAONLY.
 12960
 12961 8800-UNAUTHORIZED-ACCESS.
 12962     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 12963     GO TO 8300-SEND-TEXT.
 12964
 12965 8810-PF23.
 12966     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 12967     MOVE XCTL-005               TO PGM-NAME.
 12968     GO TO 9300-XCTL.
 12969
 12970 8900-GET-FREE-LOOK.
 12971     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12972     MOVE SPACES                 TO CNTL-ACCESS.
 12973     MOVE PI-STATE               TO CNTL-ACCESS.
 12974     MOVE '3'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL150.cbl
 12975     MOVE +0                     TO CNTL-SEQ-NO.
 12976
 12977
 12978* EXEC CICS READ
 12979*        DATASET   ('ELCNTL')
 12980*        SET       (ADDRESS OF CONTROL-FILE)
 12981*        RIDFLD    (ELCNTL-KEY)
 12982*        RESP      (WS-RESPONSE)
 12983*    END-EXEC.
 12984     MOVE 'ELCNTL' TO DFHEIV1
 12985*    MOVE '&"S        E          (  N#00011470' TO DFHEIV0
 12986     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12987     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12988     MOVE X'204E233030303131343730' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           DFHEIV1,
 12991           DFHEIV20,
 12992           DFHEIV99,
 12993           ELCNTL-KEY,
 12994           DFHEIV99,
 12995           DFHEIV99,
 12996           DFHEIV99
 12997     SET ADDRESS OF CONTROL-FILE TO
 12998         DFHEIV20
 12999     MOVE EIBRESP  TO WS-RESPONSE
 13000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13001
 13002
 13003     IF WS-RESP-NOTFND
 13004        MOVE ER-2848             TO EMI-ERROR
 13005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13006        GO TO 8100-SEND-INITIAL-MAP
 13007     ELSE
 13008        MOVE CF-ST-FREE-LOOK-PERIOD
 13009                                 TO CP-FREE-LOOK.
 13010
 13011 8900-EXIT.
 13012     EXIT.
 13013
 13014 9100-RETURN-TRAN.
 13015     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 13016     MOVE '150A'                 TO PI-CURRENT-SCREEN-NO.
 13017
 13018
 13019* EXEC CICS RETURN
 13020*        TRANSID    (TRANS-ID)
 13021*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13022*        LENGTH     (PI-COMM-LENGTH)
 13023*    END-EXEC.
 13024*    MOVE '.(CT                  &   #00011492' TO DFHEIV0
 13025     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13027     MOVE X'2020233030303131343932' TO DFHEIV0(25:11)
 13028     CALL 'kxdfhei1' USING DFHEIV0,
 13029           TRANS-ID,
 13030           PROGRAM-INTERFACE-BLOCK,
 13031           PI-COMM-LENGTH,
 13032           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL150.cbl
 13033           DFHEIV99
 13034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13035
 13036
 13037 9200-RETURN-MAIN-MENU.
 13038     MOVE XCTL-126               TO PGM-NAME.
 13039     GO TO 9300-XCTL.
 13040
 13041 9300-XCTL.
 13042
 13043* EXEC CICS XCTL
 13044*        PROGRAM    (PGM-NAME)
 13045*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13046*        LENGTH     (PI-COMM-LENGTH)
 13047*    END-EXEC.
 13048*    MOVE '.$C                   $   #00011503' TO DFHEIV0
 13049     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13050     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13051     MOVE X'2020233030303131353033' TO DFHEIV0(25:11)
 13052     CALL 'kxdfhei1' USING DFHEIV0,
 13053           PGM-NAME,
 13054           PROGRAM-INTERFACE-BLOCK,
 13055           PI-COMM-LENGTH
 13056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13057
 13058
 13059 9400-CLEAR.
 13060     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 13061     GO TO 9300-XCTL.
 13062
 13063 9500-PF12.
 13064     MOVE XCTL-010               TO PGM-NAME.
 13065     GO TO 9300-XCTL.
 13066
 13067 9600-PGMID-ERROR.
 13068
 13069* EXEC CICS HANDLE CONDITION
 13070*        PGMIDERR   (8300-SEND-TEXT)
 13071*    END-EXEC.
 13072*    MOVE '"$L                   ! = #00011518' TO DFHEIV0
 13073     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13075     MOVE X'3D20233030303131353138' TO DFHEIV0(25:11)
 13076     CALL 'kxdfhei1' USING DFHEIV0
 13077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13078
 13079
 13080     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 13081     MOVE ' '                    TO PI-ENTRY-CD-1.
 13082     MOVE XCTL-005               TO PGM-NAME.
 13083     MOVE PGM-NAME               TO LOGOFF-PGM.
 13084     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13085     GO TO 9300-XCTL.
 13086
 13087 9700-LINK-DATE-CONVERT.
 13088     MOVE LINK-ELDATCV           TO PGM-NAME.
 13089
 13090
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL150.cbl
 13091* EXEC CICS LINK
 13092*        PROGRAM    (PGM-NAME)
 13093*        COMMAREA   (DATE-CONVERSION-DATA)
 13094*        LENGTH     (DC-COMM-LENGTH)
 13095*    END-EXEC.
 13096*    MOVE '."C                   ''   #00011532' TO DFHEIV0
 13097     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13098     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13099     MOVE X'2020233030303131353332' TO DFHEIV0(25:11)
 13100     CALL 'kxdfhei1' USING DFHEIV0,
 13101           PGM-NAME,
 13102           DATE-CONVERSION-DATA,
 13103           DC-COMM-LENGTH,
 13104           DFHEIV99,
 13105           DFHEIV99,
 13106           DFHEIV99
 13107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13108
 13109
 13110 9700-EXIT.
 13111     EXIT.
 13112
 13113 9800-LINK-REM-TERM.
 13114     MOVE LINK-ELRTRM            TO PGM-NAME.
 13115
 13116
 13117* EXEC CICS LINK
 13118*        PROGRAM    (PGM-NAME)
 13119*        COMMAREA   (CALCULATION-PASS-AREA)
 13120*        LENGTH     (CP-COMM-LENGTH)
 13121*    END-EXEC.
 13122*    MOVE '."C                   ''   #00011544' TO DFHEIV0
 13123     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13124     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13125     MOVE X'2020233030303131353434' TO DFHEIV0(25:11)
 13126     CALL 'kxdfhei1' USING DFHEIV0,
 13127           PGM-NAME,
 13128           CALCULATION-PASS-AREA,
 13129           CP-COMM-LENGTH,
 13130           DFHEIV99,
 13131           DFHEIV99,
 13132           DFHEIV99
 13133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13134
 13135
 13136 9800-EXIT.
 13137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL150.cbl
 13139 9830-DMD-REMAINING-TERM.
 13140
 13141     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 13142         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 13143
 13144     MOVE W-PAID-MONTHS          TO W-PYMTS.
 13145     MOVE W-PAID-DAYS            TO W-ADD-DAYS.
 13146
 13147     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30
 13148                            + CM-PMT-EXTENSION-DAYS.
 13149
 13150     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS
 13151                                - CL-NO-OF-DAYS-PAID.
 13152
 13153     DIVIDE W-REM-TERM-IN-DAYS BY +30
 13154         GIVING W-REM REMAINDER W-REM-DAYS.
 13155
 13156     MOVE W-REM                  TO WST-REM.
 13157
 13158     IF CM-PMT-EXTENSION-DAYS > ZEROS
 13159         MOVE '/'                TO WST-SLASH1
 13160         MOVE CM-PMT-EXTENSION-DAYS TO WST-EXT-DAYS
 13161     ELSE
 13162         MOVE SPACES             TO WST-ORIG-DAYS-GRP.
 13163
 13164     IF W-REM-DAYS > ZEROS
 13165         MOVE '/'                TO WST-SLASH2
 13166         MOVE W-REM-DAYS         TO WST-REM-DAYS
 13167     ELSE
 13168         MOVE SPACES             TO WST-REM-DAYS-GRP.
 13169
 13170 9830-EXIT.
 13171     EXIT.
 13172
 13173 9850-LINK-REM-AMT.
 13174     MOVE 'ELRAMT  '             TO PGM-NAME.
 13175
 13176
 13177* EXEC CICS LINK
 13178*        PROGRAM    (PGM-NAME)
 13179*        COMMAREA   (CALCULATION-PASS-AREA)
 13180*        LENGTH     (CP-COMM-LENGTH)
 13181*    END-EXEC.
 13182*    MOVE '."C                   ''   #00011590' TO DFHEIV0
 13183     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13185     MOVE X'2020233030303131353930' TO DFHEIV0(25:11)
 13186     CALL 'kxdfhei1' USING DFHEIV0,
 13187           PGM-NAME,
 13188           CALCULATION-PASS-AREA,
 13189           CP-COMM-LENGTH,
 13190           DFHEIV99,
 13191           DFHEIV99,
 13192           DFHEIV99
 13193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13194
 13195
 13196 9850-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL150.cbl
 13197     EXIT.
 13198
 13199 9900-ERROR-FORMAT.
 13200     IF NOT EMI-ERRORS-COMPLETE
 13201         MOVE LINK-001           TO PGM-NAME
 13202
 13203* EXEC CICS LINK
 13204*            PROGRAM    (PGM-NAME)
 13205*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 13206*            LENGTH     (EMI-COMM-LENGTH)
 13207*        END-EXEC.
 13208*    MOVE '."C                   ''   #00011602' TO DFHEIV0
 13209     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13210     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13211     MOVE X'2020233030303131363032' TO DFHEIV0(25:11)
 13212     CALL 'kxdfhei1' USING DFHEIV0,
 13213           PGM-NAME,
 13214           ERROR-MESSAGE-INTERFACE-BLOCK,
 13215           EMI-COMM-LENGTH,
 13216           DFHEIV99,
 13217           DFHEIV99,
 13218           DFHEIV99
 13219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13220
 13221
 13222 9900-EXIT.
 13223     EXIT.
 13224
 13225 9990-ABEND.
 13226     MOVE -1 TO FILETOL.
 13227     MOVE LINK-004 TO PGM-NAME.
 13228
 13229     MOVE DFHEIBLK               TO EMI-LINE1
 13230
 13231* EXEC CICS LINK
 13232*        PROGRAM   (PGM-NAME)
 13233*        COMMAREA  (EMI-LINE1)
 13234*        LENGTH    (72)
 13235*    END-EXEC.
 13236     MOVE 72
 13237       TO DFHEIV11
 13238*    MOVE '."C                   ''   #00011616' TO DFHEIV0
 13239     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13240     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13241     MOVE X'2020233030303131363136' TO DFHEIV0(25:11)
 13242     CALL 'kxdfhei1' USING DFHEIV0,
 13243           PGM-NAME,
 13244           EMI-LINE1,
 13245           DFHEIV11,
 13246           DFHEIV99,
 13247           DFHEIV99,
 13248           DFHEIV99
 13249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13250
 13251
 13252     MOVE EMI-LINE1              TO ERRMSG1O.
 13253     GO TO 8200-SEND-DATAONLY.
 13254
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL150.cbl
 13256 9995-SECURITY-VIOLATION.
 13257*                            COPY ELCSCTP.
 13258******************************************************************
 13259*                                                                *
 13260*                            ELCSCTP                             *
 13261*                            VMOD=2.001                          *
 13262*                                                                *
 13263*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13264******************************************************************
 13265
 13266
 13267     MOVE EIBDATE          TO SM-JUL-DATE.
 13268     MOVE EIBTRMID         TO SM-TERMID.
 13269     MOVE THIS-PGM         TO SM-PGM.
 13270     MOVE EIBTIME          TO TIME-IN.
 13271     MOVE TIME-OUT         TO SM-TIME.
 13272     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13273
 13274
 13275* EXEC CICS LINK
 13276*         PROGRAM  ('EL003')
 13277*         COMMAREA (SECURITY-MESSAGE)
 13278*         LENGTH   (80)
 13279*    END-EXEC.
 13280     MOVE 'EL003' TO DFHEIV1
 13281     MOVE 80
 13282       TO DFHEIV11
 13283*    MOVE '."C                   ''   #00011644' TO DFHEIV0
 13284     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13286     MOVE X'2020233030303131363434' TO DFHEIV0(25:11)
 13287     CALL 'kxdfhei1' USING DFHEIV0,
 13288           DFHEIV1,
 13289           SECURITY-MESSAGE,
 13290           DFHEIV11,
 13291           DFHEIV99,
 13292           DFHEIV99,
 13293           DFHEIV99
 13294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13295
 13296
 13297******************************************************************
 13298
 13299
 13300
 13301 9999-DFHBACK SECTION.
 13302     MOVE '9%                    "   ' TO DFHEIV0
 13303     MOVE 'EL150' TO DFHEIV1
 13304     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13305     GOBACK.
 13306 9999-DFHEXIT.
 13307     IF DFHEIGDJ EQUAL 0001
 13308         NEXT SENTENCE
 13309     ELSE IF DFHEIGDJ EQUAL 2
 13310         GO TO 1000-SHOW-CLAIM,
 13311               0100-FIRST-TIME-IN,
 13312               8500-FILE-NOTOPEN,
 13313               9600-PGMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL150.cbl
 13314               9990-ABEND
 13315         DEPENDING ON DFHEIGDI
 13316     ELSE IF DFHEIGDJ EQUAL 3
 13317         GO TO 0450-NOT-FOUND
 13318         DEPENDING ON DFHEIGDI
 13319     ELSE IF DFHEIGDJ EQUAL 4
 13320         GO TO 0360-CREATE-NEW-ACTQ
 13321         DEPENDING ON DFHEIGDI
 13322     ELSE IF DFHEIGDJ EQUAL 5
 13323         GO TO 0385-TERMID-ERROR,
 13324               0390-TRANS-ERROR
 13325         DEPENDING ON DFHEIGDI
 13326     ELSE IF DFHEIGDJ EQUAL 6
 13327         GO TO 0450-NOT-FOUND,
 13328               0440-UPDATE-DONE
 13329         DEPENDING ON DFHEIGDI
 13330     ELSE IF DFHEIGDJ EQUAL 7
 13331         GO TO 0690-QIDERR
 13332         DEPENDING ON DFHEIGDI
 13333     ELSE IF DFHEIGDJ EQUAL 8
 13334         GO TO 1100-SHOW-RECORD-NOT-FOUND
 13335         DEPENDING ON DFHEIGDI
 13336     ELSE IF DFHEIGDJ EQUAL 9
 13337         GO TO 1005-END-BUILD-DIAGNOSIS
 13338         DEPENDING ON DFHEIGDI
 13339     ELSE IF DFHEIGDJ EQUAL 10
 13340         GO TO 1100-SHOW-RECORD-NOT-FOUND
 13341         DEPENDING ON DFHEIGDI
 13342     ELSE IF DFHEIGDJ EQUAL 11
 13343         GO TO 1005-NO-ERACCT,
 13344               1005-NO-ERACCT
 13345         DEPENDING ON DFHEIGDI
 13346     ELSE IF DFHEIGDJ EQUAL 12
 13347         GO TO 1008-NOTFND,
 13348               1008-NOTFND
 13349         DEPENDING ON DFHEIGDI
 13350     ELSE IF DFHEIGDJ EQUAL 13
 13351         GO TO 1009-CONTINUE-BUILD,
 13352               1009-CONTINUE-BUILD
 13353         DEPENDING ON DFHEIGDI
 13354     ELSE IF DFHEIGDJ EQUAL 14
 13355         GO TO 1050-SHOW-CONTINUE,
 13356               1050-SHOW-CONTINUE
 13357         DEPENDING ON DFHEIGDI
 13358     ELSE IF DFHEIGDJ EQUAL 15
 13359         GO TO 1220-NO-CLAIM-RECORD-FND,
 13360               1200-ENDBR
 13361         DEPENDING ON DFHEIGDI
 13362     ELSE IF DFHEIGDJ EQUAL 16
 13363         GO TO 1500-SHOW-RECORD-NOT-FOUND
 13364         DEPENDING ON DFHEIGDI
 13365     ELSE IF DFHEIGDJ EQUAL 17
 13366         GO TO 1500-NO-PLAN-RECORD
 13367         DEPENDING ON DFHEIGDI
 13368     ELSE IF DFHEIGDJ EQUAL 18
 13369         GO TO 1700-ENDBROWSE,
 13370               1700-ENDBROWSE
 13371         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL150.cbl
 13372     ELSE IF DFHEIGDJ EQUAL 19
 13373         GO TO 2950-NO-MORE-TRAILERS,
 13374               2950-NO-MORE-TRAILERS
 13375         DEPENDING ON DFHEIGDI
 13376     ELSE IF DFHEIGDJ EQUAL 20
 13377         GO TO 6000-NOT-FOUND
 13378         DEPENDING ON DFHEIGDI
 13379     ELSE IF DFHEIGDJ EQUAL 21
 13380         GO TO 6100-END-RESET,
 13381               6100-END-RESET
 13382         DEPENDING ON DFHEIGDI
 13383     ELSE IF DFHEIGDJ EQUAL 22
 13384         GO TO 6200-EXIT
 13385         DEPENDING ON DFHEIGDI
 13386     ELSE IF DFHEIGDJ EQUAL 23
 13387         GO TO 8700-END-FILE,
 13388               8600-NOT-FOUND
 13389         DEPENDING ON DFHEIGDI
 13390     ELSE IF DFHEIGDJ EQUAL 24
 13391         GO TO 0450-NOT-FOUND
 13392         DEPENDING ON DFHEIGDI
 13393     ELSE IF DFHEIGDJ EQUAL 25
 13394         GO TO 8700-END-FILE,
 13395               8600-NOT-FOUND
 13396         DEPENDING ON DFHEIGDI
 13397     ELSE IF DFHEIGDJ EQUAL 26
 13398         GO TO 0450-NOT-FOUND
 13399         DEPENDING ON DFHEIGDI
 13400     ELSE IF DFHEIGDJ EQUAL 27
 13401         GO TO 7650-CREATE-NEW-ACTQ
 13402         DEPENDING ON DFHEIGDI
 13403     ELSE IF DFHEIGDJ EQUAL 28
 13404         GO TO 7700-RETR-RECORD-NOT-FOUND,
 13405               7700-DUPLICATE-CLAIM
 13406         DEPENDING ON DFHEIGDI
 13407     ELSE IF DFHEIGDJ EQUAL 29
 13408         GO TO 8300-SEND-TEXT
 13409         DEPENDING ON DFHEIGDI.
 13410     MOVE '9%                    "   ' TO DFHEIV0
 13411     MOVE 'EL150' TO DFHEIV1
 13412     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13413     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12332     Code:       35858
