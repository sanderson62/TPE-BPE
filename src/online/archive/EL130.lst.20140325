* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38******************************************************************
    39
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   3
* EL130.cbl
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    48 77  A1                          PIC S999 COMP-3 VALUE +0.
    49 77  E1                          PIC S999 COMP-3 VALUE +0.
    50 77  s1                          pic s999 comp-3 value +0.
    51 77  s2                          pic s999 comp-3 value +0.
    52 77  P1                          PIC S999 COMP-3 VALUE +0.
    53 77  P2                          PIC S999 COMP-3 VALUE +0.
    54 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    55 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    56 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    57 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    58 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    59 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    60 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    61 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    62     88  ERPDEF-FOUND                 VALUE 'Y'.
    63 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    64 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    65 77  ws-dcc-product-code         pic xxx value spaces.
    66
    67*    COPY ELCSCTM.
    68******************************************************************
    69*                                                                *
    70*                                                                *
    71*                            ELCSCTM                             *
    72*                            VMOD=2.001                          *
    73*                                                                *
    74*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    75*                                                                *
    76******************************************************************
    77 01  SECURITY-MESSAGE.
    78     12  FILLER                          PIC X(30)
    79            VALUE '** LOGIC SECURITY VIOLATION -'.
    80     12  SM-READ                         PIC X(6).
    81     12  FILLER                          PIC X(5)
    82            VALUE ' PGM='.
    83     12  SM-PGM                          PIC X(6).
    84     12  FILLER                          PIC X(5)
    85            VALUE ' OPR='.
    86     12  SM-PROCESSOR-ID                 PIC X(4).
    87     12  FILLER                          PIC X(6)
    88            VALUE ' TERM='.
    89     12  SM-TERMID                       PIC X(4).
    90     12  FILLER                          PIC XX   VALUE SPACE.
    91     12  SM-JUL-DATE                     PIC 9(5).
    92     12  FILLER                          PIC X    VALUE SPACE.
    93     12  SM-TIME                         PIC 99.99.
    94
    95
    96*    COPY ELCSCRTY.
    97******************************************************************
    98*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   4
* EL130.cbl
    99*                                                                *
   100*                            ELCSCRTY                            *
   101*                            VMOD=2.001                          *
   102*                                                                *
   103*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   104*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   105*        SAVED IN PI-SECURITY-ADDRESS.                           *
   106*                                                                *
   107******************************************************************
   108 01  SECURITY-CONTROL.
   109     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   110     12  FILLER                       PIC XX    VALUE 'SC'.
   111     12  SC-CREDIT-CODES.
   112         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   113             20  SC-CREDIT-DISPLAY    PIC X.
   114             20  SC-CREDIT-UPDATE     PIC X.
   115     12  SC-CLAIMS-CODES.
   116         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   117             20  SC-CLAIMS-DISPLAY    PIC X.
   118             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   5
* EL130.cbl
   120 01  WS-DATE-AREA.
   121     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   122     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   123     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   124
   125 01  ws-dcc-error-line.
   126     05  filler occurs 15.
   127         10  ws-error-no        pic x(4).
   128 01  WS-CRI-SSN-WORK-AREA.
   129     05  WS-CRI-SOC-SEC-NO.
   130         10  WS-SS-REPT-CD       PIC X(5).
   131         10  WS-SS-LAST-NAME     PIC X(5).
   132         10  WS-SS-INITIAL       PIC X.
   133
   134     05  WS-CRI-REPORT-CODE.
   135         10  FILLER              PIC X(5).
   136         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   137
   138     05  WS-CRI-LAST-NAME.
   139         10  WS-CRI-NAME-MOVE    PIC X(5).
   140         10  FILLER              PIC X(10).
   141
   142 01  STANDARD-AREAS.
   143     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   144     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   145     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   146     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   147     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   148     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   149     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   150     12  PGM-NAME            PIC X(8).
   151     12  TIME-IN             PIC S9(7).
   152     12  TIME-OUT-R  REDEFINES TIME-IN.
   153         16  FILLER          PIC X.
   154         16  TIME-OUT        PIC 99V99.
   155         16  FILLER          PIC X(2).
   156     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   157     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   158     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   159     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   160     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   161     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   162     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   163     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   164     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   165     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   166     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   167     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   168     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   169     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   170     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   171     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   172     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   173     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   174     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   175     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   176     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   177     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   6
* EL130.cbl
   178     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   179     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   180     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   181     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   182     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   183     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   184     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   185     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   186     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   187     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   188     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   189     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   190     12  FILE-ID             PIC X(8).
   191     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   192     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   193     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   194     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   195     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   196     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   197     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   198     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   199     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   200
   201 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   202     12  M                   PIC S9(7)V99           VALUE ZEROS.
   203     12  L                   PIC S9(7)V99           VALUE ZEROS.
   204     12  N                   PIC S9(3)              VALUE ZEROS.
   205     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   206     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   207     12  I                   PIC S99V9(5)           VALUE ZEROS.
   208     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   209     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   210     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   211     12  R                   PIC S9(3)              VALUE ZEROS.
   212     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   213     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   214     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   215     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   216     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   217     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   218     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   219     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   220     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   221
   222 01  TERM-CALC-WORK-AREA.
   223     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   224     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   225     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   226     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   227     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   228     12  V-EXPONENTS.
   229        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   230     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   231
   232 01  MISC-WORK-AREAS.
   233     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   234     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   235     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   7
* EL130.cbl
   236     12  QID.
   237         16  QID-TERM        PIC X(4).
   238         16  FILLER          PIC X(4)    VALUE '130A'.
   239     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   240     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   241     12  WS-GROUP-NO.
   242         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   243         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   244
   245     12  WS-RESPONSE         PIC S9(8)   COMP.
   246         88  WS-RESP-NORMAL              VALUE +00.
   247         88  WS-RESP-ERROR               VALUE +01.
   248         88  WS-RESP-NOTFND              VALUE +13.
   249         88  WS-RESP-DUPKEY              VALUE +15.
   250         88  WS-RESP-NOTOPEN             VALUE +19.
   251         88  WS-RESP-ENDFILE             VALUE +20.
   252
   253***************************************************************
   254*                                                             *
   255*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   256*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   257*    CHANGES WITH IN MAP EL130A.                              *
   258*                                                             *
   259***************************************************************
   260
   261     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   262     12  WS-SAVE-CLAIM-MASTER.
   263         16  FILLER                    PIC XX.
   264         16  WS-SAVE-CLAIM-KEY.
   265             20  WS-SAVE-COMPANY-CD    PIC X.
   266             20  WS-SAVE-CARRIER       PIC X.
   267             20  WS-SAVE-CLAIM-NO      PIC X(7).
   268             20  WS-SAVE-CERT-NO       PIC X(11).
   269         16  FILLER                    PIC X(328).
   270     12  SAVE-CURRENT-DATE         PIC XX.
   271     12  SAVE-CONTROL              PIC X(39).
   272     12  SAVE-ERACCT-KEY           PIC X(26).
   273     12  SAVE-COUNTER              PIC S9(8)   COMP.
   274     12  SAVE-METHOD               PIC X.
   275     12  SAVE-COMPANY-ID           PIC XXX.
   276     12  SAVE-COMPANY-CD           PIC X.
   277     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   278     12  SAVE-CREDIT-USER          PIC X.
   279     12  SAVE-CLAIM-USER           PIC X.
   280     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   281     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   282     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   283     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   284     12  SAVE-AH-OVERRIDE-L1       PIC X.
   285     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   286     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   287     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   288     12  FILLER                    PIC X.
   289*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   290     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   291     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   292     12  SAVE-EL127-TO-EL130-CNTRL.
   293         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   8
* EL130.cbl
   294         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   295         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   296             20  SAVE-EL127-CARRIER  PIC X.
   297             20  SAVE-EL127-GROUPING PIC X(6).
   298             20  SAVE-EL127-STATE    PIC X(2).
   299             20  SAVE-EL127-ACCOUNT  PIC X(10).
   300             20  SAVE-EL127-CERT-NO  PIC X(11).
   301             20  SAVE-EL127-EFF-DT   PIC XX.
   302     12  SAVE-EL659-TO-EL130-CNTRL.
   303         16  SAVE-EL659-CARRIER    PIC X.
   304         16  SAVE-EL659-GROUPING   PIC X(6).
   305         16  SAVE-EL659-STATE      PIC XX.
   306         16  SAVE-EL659-ACCOUNT    PIC X(10).
   307     12  DIVIDE-QUOT               PIC 999.
   308     12  DIVIDE-REM                PIC 999.
   309     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   310     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   311     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   312     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   313     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   314     12  WS-RESERVE-CONTROLS       PIC X(9).
   315     12  WS-EXPENSE-CONTROLS       PIC X(7).
   316     12  WS-REIN-TABLE.
   317         16  WS-REIN-1             PIC X            VALUE SPACE.
   318         16  WS-REIN-2             PIC X            VALUE SPACE.
   319         16  WS-REIN-3             PIC X            VALUE SPACE.
   320     12  WS-BENE-CALC-METHOD       PIC X.
   321     12  WS-EARNINGS-CALC          PIC X.
   322     12  WS-LF-EARNINGS-CALC       PIC X.
   323         88 TEX-REG                VALUE '4'.
   324         88 NET-PAY                VALUE '5'.
   325     12  WS-AH-EARNINGS-CALC       PIC X.
   326     12  WS-SPECIAL-CALC-CD        PIC X(01).
   327     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   328     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   329     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   330     12  WS-CLAIM-NUMBER.
   331         16  WS-CN-PREFIX.
   332             20  WS-CN-PRF-A PIC X.
   333             20  WS-CN-PRF-B PIC X.
   334         16  WS-CN-NUMBER    PIC 9(5).
   335     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   336     12  WS-CLAIM-SEQU.
   337         16  FILLER          PIC X    VALUE '('.
   338         16  WS-CURRENT-SEQU PIC Z9.
   339         16  FILLER          PIC X(4) VALUE ' OF '.
   340         16  WS-OF-SEQU      PIC Z9.
   341         16  FILLER          PIC X    VALUE ')'.
   342     12  DATE-WORK.
   343       14  FILLER                PIC XX.
   344       14  DATE-MM               PIC XX.
   345       14  DATE-DD               PIC XX.
   346       14  DATE-YY               PIC XX.
   347     12  CURR-DATE REDEFINES DATE-WORK.
   348         16  CURR-MM.
   349           18  CURR-M1           PIC 9.
   350           18  CURR-M2           PIC 9.
   351         16  FILLER              PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page   9
* EL130.cbl
   352         16  CURR-YEAR           PIC 9.
   353     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   354     12  SUB                     PIC 99.
   355     12  MY-DATE.
   356         16  MY-MM               PIC XX.
   357         16  FILLER              PIC X VALUE '/'.
   358         16  MY-YY               PIC XX.
   359
   360     12  WS-EDIT-BEN-CODE        PIC XX.
   361         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   362                                          '90' THRU '99'.
   363
   364     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   365     12  WS-BEN-HOLD             PIC XX.
   366     12  WS-BEN-ALPHA-HOLD.
   367         15  WS-BEN-ALPHA-2      PIC XX.
   368         15  WS-BEN-ALPHA-1      PIC X.
   369     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   370     12  WS-REC-TYPE             PIC X.
   371     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   372     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   373     12  ARCH-NUMBER             PIC S9(8)   COMP.
   374     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   375         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   376         88  REIN-REC-FOUND                  VALUE 'Y'.
   377
   378     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   379     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   380
   381
   382 01  CSO-WORK-FIELDS.
   383     12  WS-BLANK            PIC X       VALUE ' '.
   384
   385     12  WS-MA-CONTROL-PRIMARY.
   386         16  WS-MA-COMPANY-CD        PIC  X.
   387         16  WS-MA-CARRIER           PIC  X.
   388         16  WS-MA-GROUPING          PIC  X(6).
   389         16  WS-MA-STATE             PIC  XX.
   390         16  WS-MA-ACCOUNT           PIC  X(10).
   391         16  WS-MA-CERT-EFF-DT       PIC  XX.
   392         16  WS-MA-CERT-NO.
   393             20  WS-MA-CERT-PRIME    PIC  X(10).
   394             20  WS-MA-CERT-SFX      PIC  X.
   395
   396     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   397     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   398     12  WS-SOC-SEC-NUMBER.
   399         16  WS-SOC-SEC-NO       PIC 9(9).
   400         16  WS-SOC-SEC-BLANK    PIC X(2).
   401     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   402         16  WS-SSN-1-3          PIC 9(3).
   403         16  WS-SSN-DASH1        PIC X(1).
   404         16  WS-SSN-4-5          PIC 9(2).
   405         16  WS-SSN-DASH2        PIC X(1).
   406         16  WS-SSN-6-9          PIC 9(4).
   407
   408     12  WS-DIAG-VIN-MSG.
   409         16  FILLER          PIC X(11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  10
* EL130.cbl
   410             VALUE 'VIN NUMBER '.
   411         16  WS-DIAG-VIN     PIC X(17).
   412
   413     12  WS-VERIFY-NOTE      PIC X(34)
   414         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   415
   416     12  WS-CAUSAL-NOTE      PIC X(40)
   417         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   418
   419 01  MAP-DATE-AREAS.
   420     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   421     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   422     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   423     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   424     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   425     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   426     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   427     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   428     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   429     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   430     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   431     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   432     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   433     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   434     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   435     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   436     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   437     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   438     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   439         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   440     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   441     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   442     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   443     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   444
   445 01  ACCESS-KEYS.
   446     12  ELACTQ-KEY.
   447         16  ELACTQ-COMPANY-CD       PIC X.
   448         16  ELACTQ-CARRIER          PIC X.
   449         16  ELACTQ-CLAIM-NO         PIC X(7).
   450         16  ELACTQ-CERT-NO          PIC X(11).
   451     12  ELMSTR-KEY.
   452         16  MSTR-COMP-CD            PIC X.
   453         16  MSTR-CARRIER            PIC X.
   454         16  MSTR-CLAIM-NO           PIC X(7).
   455         16  MSTR-CERT-NO.
   456             20  MSTR-CERT-NO-PRIME  PIC X(10).
   457             20  MSTR-CERT-NO-SUFX   PIC X.
   458     12  SAVE-ELMSTR-KEY.
   459         16  SAVE-COMP-CD            PIC X.
   460         16  SAVE-CARRIER            PIC X.
   461         16  SAVE-CLAIM-NO           PIC X(7).
   462         16  SAVE-CERT-NO.
   463             20  SAVE-CERT-NO-PRIME  PIC X(10).
   464             20  SAVE-CERT-NO-SUFX   PIC X.
   465     12  ELMSTR5-KEY.
   466         16  MSTR5-COMP-CD           PIC X.
   467         16  MSTR5-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  11
* EL130.cbl
   468             20  MSTR5-CERT-NO-PRIME PIC X(10).
   469             20  MSTR5-CERT-NO-SUFX  PIC X.
   470     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   471         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   472         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   473         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   474     12  ELCNTL-KEY.
   475         16  CNTL-COMP-ID    PIC X(3).
   476         16  CNTL-REC-TYPE   PIC X.
   477         16  CNTL-ACCESS.
   478             20  FILLER      PIC XX.
   479             20  CNTL-BENEFIT.
   480                 24  FILLER  PIC X.
   481                 24  CNTL-CARRIER PIC X.
   482         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   483     12  ELCERT-KEY.
   484         16  CERT-COMP-CD    PIC X.
   485         16  CERT-CARRIER    PIC X.
   486         16  CERT-GROUPING   PIC X(6).
   487         16  CERT-STATE      PIC X(2).
   488         16  CERT-ACCOUNT.
   489             20  CERT-ACCOUNT-PREFIX PIC X(4).
   490             20  CERT-ACCOUNT-PRIME  PIC X(6).
   491         16  CERT-EFF-DT     PIC XX.
   492         16  CERT-CERT-NO.
   493             20  CERT-CERT-NO-PRIME  PIC X(10).
   494             20  CERT-CERT-NO-SUFX   PIC X.
   495     12  ELCERT-KEY-5.
   496         16  CERT-COMP-CD-5      PIC X.
   497         16  CERT-CERT-5.
   498             20  CERT-CERT-5-PRIME   PIC X(10).
   499             20  CERT-CERT-5-SUFX    PIC X.
   500     12  ERACCT-KEY.
   501         16  ACCT-COMP-CD    PIC X.
   502         16  ACCT-CARRIER    PIC X.
   503         16  ACCT-GROUPING   PIC X(6).
   504         16  ACCT-STATE      PIC X(2).
   505         16  ACCT-ACCOUNT    PIC X(10).
   506         16  ACCT-EXP-DT     PIC XX.
   507     12  ELTRLR-KEY.
   508         16  TRLR-COMP-CD    PIC X.
   509         16  TRLR-CARRIER    PIC X.
   510         16  TRLR-CLAIM-NO   PIC X(7).
   511         16  TRLR-CERT-NO.
   512             20  TRLR-CERT-NO-PRIME  PIC X(10).
   513             20  TRLR-CERT-NO-SUFX   PIC X.
   514         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   515         16  TRLR-TYPE       PIC X.
   516     12  ELBENE-KEY.
   517         16  BENE-COMP-CD    PIC X.
   518         16  BENE-RCD-TYPE   PIC X.
   519         16  BENE-CODE       PIC X(10).
   520     12  ERREIN-KEY.
   521         16  REIN-COMP-CD        PIC X(01).
   522         16  REIN-TYPE           PIC X(01).
   523         16  REIN-TABLE-CO.
   524             20  REIN-CODE-1     PIC X(01).
   525             20  REIN-CODE-2     PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  12
* EL130.cbl
   526             20  REIN-CODE-3     PIC X(01).
   527         16  FILLER              PIC X(03).
   528     12  ELCRTT-KEY.
   529         16  CTRLR-COMP-CD       PIC X.
   530         16  CTRLR-CARRIER       PIC X.
   531         16  CTRLR-GROUPING      PIC X(6).
   532         16  CTRLR-STATE         PIC X(2).
   533         16  CTRLR-ACCOUNT       PIC X(10).
   534         16  CTRLR-EFF-DT        PIC XX.
   535         16  CTRLR-CERT-NO       PIC X(11).
   536         16  CTRLR-REC-TYPE      PIC X.
   537 01  ERPDEF-KEY-SAVE             PIC X(18).
   538 01  ERPDEF-KEY.
   539     12  ERPDEF-COMPANY-CD       PIC X.
   540     12  ERPDEF-STATE            PIC XX.
   541     12  ERPDEF-PROD-CD          PIC XXX.
   542     12  F                       PIC X(7).
   543     12  ERPDEF-BEN-TYPE         PIC X.
   544     12  ERPDEF-BEN-CODE         PIC XX.
   545     12  ERPDEF-EXP-DT           PIC XX.
   546 01  ERROR-MESSAGES.
   547     12  ER-0000                 PIC X(4)  VALUE '0000'.
   548     12  ER-0004                 PIC X(4)  VALUE '0004'.
   549     12  ER-0019                 PIC X(4)  VALUE '0019'.
   550     12  ER-0023                 PIC X(4)  VALUE '0023'.
   551     12  ER-0029                 PIC X(4)  VALUE '0029'.
   552     12  ER-0033                 PIC X(4)  VALUE '0033'.
   553     12  ER-0068                 PIC X(4)  VALUE '0068'.
   554     12  ER-0070                 PIC X(4)  VALUE '0070'.
   555     12  ER-0194                 PIC X(4)  VALUE '0194'.
   556     12  ER-0202                 PIC X(4)  VALUE '0202'.
   557     12  ER-0203                 PIC X(4)  VALUE '0203'.
   558     12  ER-0204                 PIC X(4)  VALUE '0204'.
   559     12  ER-0205                 PIC X(4)  VALUE '0205'.
   560     12  ER-0206                 PIC X(4)  VALUE '0206'.
   561     12  ER-0207                 PIC X(4)  VALUE '0207'.
   562     12  ER-0213                 PIC X(4)  VALUE '0213'.
   563     12  ER-0214                 PIC X(4)  VALUE '0214'.
   564     12  ER-0217                 PIC X(4)  VALUE '0217'.
   565     12  ER-0219                 PIC X(4)  VALUE '0219'.
   566     12  ER-0220                 PIC X(4)  VALUE '0220'.
   567     12  ER-0221                 PIC X(4)  VALUE '0221'.
   568     12  ER-0222                 PIC X(4)  VALUE '0222'.
   569     12  ER-0223                 PIC X(4)  VALUE '0223'.
   570     12  ER-0224                 PIC X(4)  VALUE '0224'.
   571     12  ER-0225                 PIC X(4)  VALUE '0225'.
   572     12  ER-0226                 PIC X(4)  VALUE '0226'.
   573     12  ER-0227                 PIC X(4)  VALUE '0227'.
   574     12  ER-0229                 PIC X(4)  VALUE '0229'.
   575     12  ER-0230                 PIC X(4)  VALUE '0230'.
   576     12  ER-0231                 PIC X(4)  VALUE '0231'.
   577     12  ER-0232                 PIC X(4)  VALUE '0232'.
   578     12  ER-0233                 PIC X(4)  VALUE '0233'.
   579     12  ER-0234                 PIC X(4)  VALUE '0234'.
   580     12  ER-0235                 PIC X(4)  VALUE '0235'.
   581     12  ER-0236                 PIC X(4)  VALUE '0236'.
   582     12  ER-0237                 PIC X(4)  VALUE '0237'.
   583     12  ER-0238                 PIC X(4)  VALUE '0238'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  13
* EL130.cbl
   584     12  ER-0239                 PIC X(4)  VALUE '0239'.
   585     12  ER-0240                 PIC X(4)  VALUE '0240'.
   586     12  ER-0241                 PIC X(4)  VALUE '0241'.
   587     12  ER-0243                 PIC X(4)  VALUE '0243'.
   588     12  ER-0244                 PIC X(4)  VALUE '0244'.
   589     12  ER-0245                 PIC X(4)  VALUE '0245'.
   590     12  ER-0246                 PIC X(4)  VALUE '0246'.
   591     12  ER-0247                 PIC X(4)  VALUE '0247'.
   592     12  ER-0248                 PIC X(4)  VALUE '0248'.
   593     12  ER-0250                 PIC X(4)  VALUE '0250'.
   594     12  ER-0251                 PIC X(4)  VALUE '0251'.
   595     12  ER-0252                 PIC X(4)  VALUE '0252'.
   596     12  ER-0253                 PIC X(4)  VALUE '0253'.
   597     12  ER-0254                 PIC X(4)  VALUE '0254'.
   598     12  ER-0257                 PIC X(4)  VALUE '0257'.
   599     12  ER-0258                 PIC X(4)  VALUE '0258'.
   600     12  ER-0260                 PIC X(4)  VALUE '0260'.
   601     12  ER-0261                 PIC X(4)  VALUE '0261'.
   602     12  ER-0263                 PIC X(4)  VALUE '0263'.
   603     12  ER-0264                 PIC X(4)  VALUE '0264'.
   604     12  ER-0265                 PIC X(4)  VALUE '0265'.
   605     12  ER-0266                 PIC X(4)  VALUE '0266'.
   606     12  ER-0267                 PIC X(4)  VALUE '0267'.
   607     12  ER-0334                 PIC X(4)  VALUE '0334'.
   608     12  ER-0337                 PIC X(4)  VALUE '0337'.
   609     12  ER-0412                 PIC X(4)  VALUE '0412'.
   610     12  ER-0413                 PIC X(4)  VALUE '0413'.
   611     12  ER-0428                 PIC X(4)  VALUE '0428'.
   612     12  ER-0429                 PIC X(4)  VALUE '0429'.
   613     12  ER-0430                 PIC X(4)  VALUE '0430'.
   614     12  ER-0433                 PIC X(4)  VALUE '0433'.
   615     12  ER-0434                 PIC X(4)  VALUE '0434'.
   616     12  ER-0458                 PIC X(4)  VALUE '0458'.
   617     12  ER-0489                 PIC X(4)  VALUE '0489'.
   618     12  ER-0509                 PIC X(4)  VALUE '0509'.
   619     12  ER-0510                 PIC X(4)  VALUE '0510'.
   620     12  ER-0511                 PIC X(4)  VALUE '0511'.
   621     12  ER-0512                 PIC X(4)  VALUE '0512'.
   622     12  ER-0516                 PIC X(4)  VALUE '0516'.
   623     12  ER-0517                 PIC X(4)  VALUE '0517'.
   624     12  ER-0518                 PIC X(4)  VALUE '0518'.
   625     12  ER-0519                 PIC X(4)  VALUE '0519'.
   626     12  ER-0520                 PIC X(4)  VALUE '0520'.
   627     12  ER-0521                 PIC X(4)  VALUE '0521'.
   628     12  ER-0522                 PIC X(4)  VALUE '0522'.
   629     12  ER-0523                 PIC X(4)  VALUE '0523'.
   630     12  ER-0544                 PIC X(4)  VALUE '0544'.
   631     12  ER-0546                 PIC X(4)  VALUE '0546'.
   632     12  ER-0558                 PIC X(4)  VALUE '0558'.
   633     12  ER-0560                 PIC X(4)  VALUE '0560'.
   634     12  ER-0562                 PIC X(4)  VALUE '0562'.
   635     12  ER-0565                 PIC X(4)  VALUE '0565'.
   636     12  ER-0569                 PIC X(4)  VALUE '0569'.
   637     12  ER-0693                 PIC X(4)  VALUE '0693'.
   638     12  ER-0715                 PIC X(4)  VALUE '0715'.
   639     12  ER-0840                 PIC X(4)  VALUE '0840'.
   640     12  ER-0841                 PIC X(4)  VALUE '0841'.
   641     12  ER-0842                 PIC X(4)  VALUE '0842'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  14
* EL130.cbl
   642     12  ER-0843                 PIC X(4)  VALUE '0843'.
   643     12  ER-0878                 PIC X(4)  VALUE '0878'.
   644     12  ER-0887                 PIC X(4)  VALUE '0887'.
   645     12  ER-1651                 PIC X(4)  VALUE '1651'.
   646     12  ER-1652                 PIC X(4)  VALUE '1652'.
   647     12  ER-1653                 PIC X(4)  VALUE '1653'.
   648     12  ER-1654                 PIC X(4)  VALUE '1654'.
   649     12  ER-1655                 PIC X(4)  VALUE '1655'.
   650     12  er-1659                 pic x(4)  value '1659'.
   651     12  er-1660                 pic x(4)  value '1660'.
   652     12  er-1661                 pic x(4)  value '1661'.
   653     12  ER-2280                 PIC X(4)  VALUE '2280'.
   654     12  ER-2370                 PIC X(4)  VALUE '2370'.
   655     12  ER-2371                 PIC X(4)  VALUE '2371'.
   656     12  ER-2378                 PIC X(4)  VALUE '2378'.
   657     12  ER-2380                 PIC X(4)  VALUE '2380'.
   658     12  ER-2566                 PIC X(4)  VALUE '2566'.
   659     12  ER-2848                 PIC X(4)  VALUE '2848'.
   660     12  ER-3548                 PIC X(4)  VALUE '3548'.
   661     12  ER-7008                 PIC X(4)  VALUE '7008'.
   662     12  ER-7319                 PIC X(4)  VALUE '7319'.
   663     12  ER-7321                 PIC X(4)  VALUE '7321'.
   664     12  ER-7352                 PIC X(4)  VALUE '7352'.
   665     12  ER-7353                 PIC X(4)  VALUE '7353'.
   666     12  ER-7575                 PIC X(4)  VALUE '7575'.
   667     12  ER-7577                 PIC X(4)  VALUE '7577'.
   668     12  ER-7634                 PIC X(4)  VALUE '7634'.
   669     12  ER-7635                 PIC X(4)  VALUE '7635'.
   670     12  ER-7636                 PIC X(4)  VALUE '7636'.
   671     12  ER-7637                 PIC X(4)  VALUE '7637'.
   672     12  ER-7638                 PIC X(4)  VALUE '7638'.
   673     12  ER-7639                 PIC X(4)  VALUE '7639'.
   674     12  ER-7640                 PIC X(4)  VALUE '7640'.
   675     12  ER-7641                 PIC X(4)  VALUE '7641'.
   676     12  ER-7642                 PIC X(4)  VALUE '7642'.
   677     12  ER-7643                 PIC X(4)  VALUE '7643'.
   678     12  ER-7646                 PIC X(4)  VALUE '7646'.
   679     12  ER-7647                 PIC X(4)  VALUE '7647'.
   680     12  ER-7648                 PIC X(4)  VALUE '7648'.
   681     12  ER-7649                 PIC X(4)  VALUE '7649'.
   682     12  ER-7651                 PIC X(4)  VALUE '7651'.
   683     12  ER-7670                 PIC X(4)  VALUE '7670'.
   684     12  ER-7671                 PIC X(4)  VALUE '7671'.
   685     12  ER-7686                 PIC X(4)  VALUE '7686'.
   686     12  ER-7688                 PIC X(4)  VALUE '7688'.
   687     12  ER-7689                 PIC X(4)  VALUE '7689'.
   688     12  ER-7691                 PIC X(4)  VALUE '7691'.
   689*    COPY ERCPDEF.
   690******************************************************************
   691*                                                                *
   692*                                                                *
   693*                            ERCPDEF.                            *
   694*                                                                *
   695*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   696*                                                                *
   697*    FILE TYPE = VSAM,KSDS                                       *
   698*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   699*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  15
* EL130.cbl
   700*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   701*                                                                *
   702*    LOG = YES                                                   *
   703*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   704******************************************************************
   705 01  PRODUCT-MASTER.
   706    12  PD-RECORD-ID                 PIC X(02).
   707        88  VALID-PD-ID                  VALUE 'PD'.
   708    12  PD-CONTROL-PRIMARY.
   709        16  PD-COMPANY-CD            PIC X.
   710        16  PD-STATE                 PIC XX.
   711        16  PD-PRODUCT-CD            PIC XXX.
   712        16  PD-FILLER                PIC X(7).
   713        16  PD-BEN-TYPE              PIC X.
   714        16  PD-BEN-CODE              PIC XX.
   715        16  PD-PROD-EXP-DT           PIC XX.
   716    12  FILLER                       PIC X(50).
   717    12  PD-PRODUCT-DATA OCCURS 8.
   718        16  PD-PROD-CODE             PIC X.
   719            88  PD-PROD-LIFE           VALUE 'L'.
   720            88  PD-PROD-PROP           VALUE 'P'.
   721            88  PD-PROD-AH             VALUE 'A'.
   722            88  PD-PROD-IU             VALUE 'I'.
   723            88  PD-PROD-GAP            VALUE 'G'.
   724        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   725        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   726        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   727        16  PD-MAX-TERM              PIC S999        COMP-3.
   728        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   729        16  FILLER                   PIC X.
   730        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   731        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   732        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   733        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   734        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   735        16  PD-REC-CRIT-PERIOD       PIC X.
   736        16  PD-RTW-MOS               PIC 99.
   737        16  FILLER                   PIC X(5).
   738    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   739    12  PD-TERM-LIMITS OCCURS 15.
   740        16  PD-LOW-TERM              PIC S999        COMP-3.
   741        16  PD-HI-TERM               PIC S999        COMP-3.
   742*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   743    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   744        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   745        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   746    12  PD-EARN-FACTORS.
   747        16  FILLER OCCURS 15.
   748            20  FILLER OCCURS 15.
   749                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   750    12  PD-PRODUCT-DESC              PIC X(80).
   751    12  PD-TRUNCATED                 PIC X.
   752    12  FILLER                       PIC X(59).
   753    12  PD-MAINT-INFORMATION.
   754        16  PD-LAST-MAINT-DT         PIC X(02).
   755        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   756        16  PD-LAST-MAINT-BY         PIC X(04).
   757*    COPY ELCLNKLT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  16
* EL130.cbl
   758******************************************************************
   759*                                                                *
   760*                                                                *
   761*                           ELCLNKLT                             *
   762*                            VMOD=2.003                          *
   763*                                                                *
   764*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   765*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   766*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   767*                                                                *
   768*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   769*   COMPLETING THE REQUIRED FIELDS.                              *
   770*                                                                *
   771*   THE CALLING PROGRAM SHOULD CHECK:                            *
   772*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   773*                              9999 INDICATES AN UNKNOWN ABEND   *
   774*                                   WAS DETECTED.                *
   775*                              ALL OTHER VALUES ARE NORMAL ERROR *
   776*                              CODES FOUND IN THE ERROR FILE.    *
   777******************************************************************
   778 01  W-1523-LINKDATA.
   779     12  W-1523-COMMON-PI-DATA.
   780         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   781         16  FILLER              PIC  X(67).
   782         16  W-1523-COMPANY-CD   PIC  X(01).
   783         16  FILLER              PIC  X(10).
   784         16  W-1523-CONTROL-IN-PROGRESS.
   785             20  W-1523-CARRIER  PIC  X(01).
   786             20  W-1523-GROUPING PIC  X(06).
   787             20  W-1523-STATE    PIC  X(02).
   788             20  W-1523-ACCOUNT  PIC  X(10).
   789             20  W-1523-CLAIM-CERT-GRP.
   790                 24  W-1523-CLAIM-NO
   791                                 PIC  X(07).
   792                 24  W-1523-CERT-NO.
   793                     28  W-1523-CERT-PRIME
   794                                 PIC  X(10).
   795                     28  W-1523-CERT-SFX
   796                                 PIC  X(01).
   797                 24  W-1523-CERT-EFF-DT
   798                                 PIC  X(02).
   799         16  FILLER              PIC X(265).
   800
   801     12  W-1523-WORK-AREA.
   802         16  W-1523-FORM-NUMBER  PIC  X(04).
   803         16  W-1523-NUMBER-COPIES
   804                                 PIC  9(01).
   805         16  W-1523-ADDR-TYPE    PIC  X(02).
   806         16  W-1523-FOLLOW-UP-DATE
   807                                 PIC  X(02).
   808         16  W-1523-RESEND-DATE  PIC  X(02).
   809         16  W-1523-ERROR-CODE   PIC  9(04).
   810             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   811             88  W-1523-FATAL-ERROR
   812                                    VALUES  0006 0013 0042
   813                                            0154 0168 0169
   814                                            0176 9999 0172
   815                                            0179 0186 0281
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  17
* EL130.cbl
   816                                            0332 2055 3697
   817                                            3698 3699 3770
   818                                            3771 3772 7675
   819                                            9106 9808 9883
   820                                            9887.
   821             88  W-1523-STOP-ERRORS
   822                                    VALUES  0013 0042 0154
   823                                            0168 0169 0172
   824                                            0281 0332 2055
   825                                            3698 3699 7675
   826                                            9106 9808 9883
   827                                            9999.
   828         16  W-1523-REASON       PIC  X(70).
   829         16  W-1523-ARCHIVE-NUMBER
   830                                 PIC  9(08).
   831     12  W-1523-POINTER-AREA.
   832         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   833         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   834         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   835         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   836         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  18
* EL130.cbl
   838*    COPY ELCINTF.
   839******************************************************************
   840*                                                                *
   841*                                                                *
   842*                            ELCINTF.                            *
   843*                            VMOD=2.017                          *
   844*                                                                *
   845*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   846*                                                                *
   847*       LENGTH = 1024                                            *
   848*                                                                *
   849******************************************************************
   850*                   C H A N G E   L O G
   851*
   852* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   853*-----------------------------------------------------------------
   854*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   855* EFFECTIVE    NUMBER
   856*-----------------------------------------------------------------
   857* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   858******************************************************************
   859 01  PROGRAM-INTERFACE-BLOCK.
   860     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   861     12  PI-CALLING-PROGRAM              PIC X(8).
   862     12  PI-SAVED-PROGRAM-1              PIC X(8).
   863     12  PI-SAVED-PROGRAM-2              PIC X(8).
   864     12  PI-SAVED-PROGRAM-3              PIC X(8).
   865     12  PI-SAVED-PROGRAM-4              PIC X(8).
   866     12  PI-SAVED-PROGRAM-5              PIC X(8).
   867     12  PI-SAVED-PROGRAM-6              PIC X(8).
   868     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   869     12  PI-COMPANY-ID                   PIC XXX.
   870     12  PI-COMPANY-CD                   PIC X.
   871
   872     12  PI-COMPANY-PASSWORD             PIC X(8).
   873
   874     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   875
   876     12  PI-CONTROL-IN-PROGRESS.
   877         16  PI-CARRIER                  PIC X.
   878         16  PI-GROUPING                 PIC X(6).
   879         16  PI-STATE                    PIC XX.
   880         16  PI-ACCOUNT                  PIC X(10).
   881         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   882                                         PIC X(10).
   883         16  PI-CLAIM-CERT-GRP.
   884             20  PI-CLAIM-NO             PIC X(7).
   885             20  PI-CERT-NO.
   886                 25  PI-CERT-PRIME       PIC X(10).
   887                 25  PI-CERT-SFX         PIC X.
   888             20  PI-CERT-EFF-DT          PIC XX.
   889         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   890             20  PI-PLAN-CODE            PIC X(2).
   891             20  PI-REVISION-NUMBER      PIC X(3).
   892             20  PI-PLAN-EFF-DT          PIC X(2).
   893             20  PI-PLAN-EXP-DT          PIC X(2).
   894             20  FILLER                  PIC X(11).
   895         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  19
* EL130.cbl
   896             20  PI-OE-REFERENCE-1.
   897                 25  PI-OE-REF-1-PRIME   PIC X(18).
   898                 25  PI-OE-REF-1-SUFF    PIC XX.
   899
   900     12  PI-SESSION-IN-PROGRESS          PIC X.
   901         88  CLAIM-SESSION                   VALUE '1'.
   902         88  CREDIT-SESSION                  VALUE '2'.
   903         88  WARRANTY-SESSION                VALUE '3'.
   904         88  MORTGAGE-SESSION                VALUE '4'.
   905         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   906
   907
   908*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   909
   910     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   911     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   912
   913     12  PI-CREDIT-USER                  PIC X.
   914         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   915         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   916
   917     12  PI-CLAIM-USER                   PIC X.
   918         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   919         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   920
   921     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   922         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   923         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   924         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   925         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   926         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   927
   928     12  PI-PROCESSOR-ID                 PIC X(4).
   929
   930     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   931
   932     12  PI-MEMBER-CAPTION               PIC X(10).
   933
   934     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   935         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   936
   937     12  PI-LIFE-OVERRIDE-L1             PIC X.
   938     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   939     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   940     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   941
   942     12  PI-AH-OVERRIDE-L1               PIC X.
   943     12  PI-AH-OVERRIDE-L2               PIC XX.
   944     12  PI-AH-OVERRIDE-L6               PIC X(6).
   945     12  PI-AH-OVERRIDE-L12              PIC X(12).
   946
   947     12  PI-NEW-SYSTEM                   PIC X(2).
   948
   949     12  PI-PRIMARY-CERT-NO              PIC X(11).
   950     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   951         88  PI-USES-PAID-TO                 VALUE '1'.
   952     12  PI-CRDTCRD-SYSTEM.
   953         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  20
* EL130.cbl
   954             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   955             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   956         16  PI-CC-MONTH-END-DT          PIC XX.
   957     12  PI-PROCESSOR-PRINTER            PIC X(4).
   958
   959     12  PI-OE-REFERENCE-2.
   960         16  PI-OE-REF-2-PRIME           PIC X(10).
   961         16  PI-OE-REF-2-SUFF            PIC X.
   962
   963     12  PI-REM-TRM-CALC-OPTION          PIC X.
   964
   965     12  PI-LANGUAGE-TYPE                PIC X.
   966             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   967             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   968             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   969
   970     12  PI-POLICY-LINKAGE-IND           PIC X.
   971         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   972         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   973                                                   LOW-VALUES.
   974
   975     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   976     12  PI-CLAIM-PW-SESSION             PIC X(1).
   977         88  PI-CLAIM-CREDIT                 VALUE '1'.
   978         88  PI-CLAIM-CONVEN                 VALUE '2'.
   979
   980     12  PI-PROCESSOR-CSR-IND            PIC X.
   981         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   982         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   983
   984     12  FILLER                          PIC X(3).
   985
   986     12  PI-SYSTEM-LEVEL                 PIC X(145).
   987
   988     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   989         PI-SYSTEM-LEVEL.
   990
   991         16  PI-ENTRY-CODES.
   992             20  PI-ENTRY-CD-1           PIC X.
   993             20  PI-ENTRY-CD-2           PIC X.
   994
   995         16  PI-RETURN-CODES.
   996             20  PI-RETURN-CD-1          PIC X.
   997             20  PI-RETURN-CD-2          PIC X.
   998
   999         16  PI-UPDATE-STATUS-SAVE.
  1000             20  PI-UPDATE-BY            PIC X(4).
  1001             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1002
  1003         16  PI-LOWER-CASE-LETTERS       PIC X.
  1004             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1005
  1006*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1007*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1008*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1009
  1010         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1011             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  21
* EL130.cbl
  1012             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1013             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1014             88  ACCNT-CNTL                  VALUE '3'.
  1015             88  CARR-ACCNT-CNTL             VALUE '4'.
  1016
  1017         16  PI-PROCESSOR-CAP-LIST.
  1018             20  PI-SYSTEM-CONTROLS.
  1019                24 PI-SYSTEM-DISPLAY     PIC X.
  1020                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1021                24 PI-SYSTEM-MODIFY      PIC X.
  1022                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1023             20  FILLER                  PIC XX.
  1024             20  PI-DISPLAY-CAP          PIC X.
  1025                 88  DISPLAY-CAP             VALUE 'Y'.
  1026             20  PI-MODIFY-CAP           PIC X.
  1027                 88  MODIFY-CAP              VALUE 'Y'.
  1028             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1029                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1030             20  PI-FORCE-CAP            PIC X.
  1031                 88  FORCE-CAP               VALUE 'Y'.
  1032
  1033         16  PI-PROGRAM-CONTROLS.
  1034             20  PI-PGM-PRINT-OPT        PIC X.
  1035             20  PI-PGM-FORMAT-OPT       PIC X.
  1036             20  PI-PGM-PROCESS-OPT      PIC X.
  1037             20  PI-PGM-TOTALS-OPT       PIC X.
  1038
  1039         16  PI-HELP-INTERFACE.
  1040             20  PI-LAST-ERROR-NO        PIC X(4).
  1041             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1042
  1043         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1044             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1045
  1046         16  PI-CR-CONTROL-IN-PROGRESS.
  1047             20  PI-CR-CARRIER           PIC X.
  1048             20  PI-CR-GROUPING          PIC X(6).
  1049             20  PI-CR-STATE             PIC XX.
  1050             20  PI-CR-ACCOUNT           PIC X(10).
  1051             20  PI-CR-FIN-RESP          PIC X(10).
  1052             20  PI-CR-TYPE              PIC X.
  1053
  1054         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1055
  1056         16  PI-CR-MONTH-END-DT          PIC XX.
  1057
  1058         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1059             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1060             88  PI-ZERO-CARRIER             VALUE '1'.
  1061             88  PI-ZERO-GROUPING            VALUE '2'.
  1062             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1063
  1064         16  PI-CARRIER-SECURITY         PIC X.
  1065             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1066
  1067         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1068             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1069             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  22
* EL130.cbl
  1070
  1071         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1072             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1073                                         INDEXED BY PI-ACCESS-NDX
  1074                                         PIC X.
  1075
  1076         16  PI-GA-BILLING-CONTROL       PIC X.
  1077             88  PI-GA-BILLING               VALUE '1'.
  1078
  1079         16  PI-MAIL-PROCESSING          PIC X.
  1080             88  PI-MAIL-YES                 VALUE 'Y'.
  1081
  1082         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1083
  1084         16  PI-AR-SYSTEM.
  1085             20  PI-AR-PROCESSING-CNTL   PIC X.
  1086                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1087             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1088             20  PI-AR-MONTH-END-DT      PIC XX.
  1089
  1090         16  PI-MP-SYSTEM.
  1091             20  PI-MORTGAGE-USER            PIC X.
  1092                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1093                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1094             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1095                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1096                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1097                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1098                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1099                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1100             20  PI-MP-MONTH-END-DT          PIC XX.
  1101             20  PI-MP-REFERENCE-NO.
  1102                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1103                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1104
  1105         16  PI-LABEL-CONTROL            PIC X(01).
  1106             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1107             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1108
  1109         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1110             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1111
  1112         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1113             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1114             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1115
  1116         16  FILLER                      PIC X(14).
  1117
  1118     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1119******************************************************************
  1120     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1121         16  PI-MSTR-DT               PIC XX.
  1122         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1123         16  PI-TRLR-DT               PIC XX.
  1124         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1125         16  PI-LAST-CLAIM            PIC X(7).
  1126         16  PI-LAST-CARR             PIC X.
  1127         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  23
* EL130.cbl
  1128             20  PI-LAST-CERT-PRIME   PIC X(10).
  1129             20  PI-LAST-CERT-SUFX    PIC X.
  1130         16  PI-LAST-CLAIM-TYPE       PIC X.
  1131         16  PI-CURSOR                PIC S9(4)   COMP.
  1132         16  PI-SAVE-CERT.
  1133             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1134             20  PI-SAVE-CERT-SUFX    PIC X.
  1135         16  PI-SAVE-EFFDT            PIC X(2).
  1136         16  PI-SAVE-ACCOUNT          PIC X(10).
  1137         16  PI-INCURR-SW             PIC X.
  1138         16  PI-PRT-OPT               PIC X.
  1139         16  PI-ALT-PRT               PIC X(4).
  1140         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1141             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1142         16  FILLER                   PIC X(272).
  1143         16  PI-EL127-TO-EL130-CNTRL.
  1144             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1145             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1146             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1147                 24  PI-EL127-CARRIER        PIC X.
  1148                 24  PI-EL127-GROUPING       PIC X(6).
  1149                 24  PI-EL127-STATE          PIC X(2).
  1150                 24  PI-EL127-ACCOUNT        PIC X(10).
  1151                 24  PI-EL127-CERT-NO.
  1152                     28  PI-EL127-CERT-PRIME PIC X(10).
  1153                     28  PI-EL127-CERT-SUFX  PIC X.
  1154                 24  PI-EL127-EFF-DT         PIC XX.
  1155*        16  FILLER                          PIC X(50).
  1156         16  FILLER                          PIC X(31).
  1157         16  PI-EL659-TO-EL130-CNTRL.
  1158             20  PI-EL659-CARRIER            PIC X.
  1159             20  PI-EL659-GROUPING           PIC X(6).
  1160             20  PI-EL659-STATE              PIC XX.
  1161             20  PI-EL659-ACCOUNT            PIC X(10).
  1162
  1163         16  FILLER                          PIC X(19).
  1164
  1165         16  PI-SAVE-INCUR-DT                PIC X(02).
  1166         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1167*         16  FILLER                          PIC X(65).
  1168         16  PI-ST-VFY-2ND-BENE              PIC X.
  1169         16  PI-ST-CAUSAL-STATE              PIC X.
  1170         16  pi-dcc-max-benefits             pic s999 comp-3.
  1171         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1172         16  pi-emi-sub                      pic 99.
  1173         16  FILLER                          PIC X(53).
  1174
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  24
* EL130.cbl
  1176*    COPY EL130S.
  1177 01  EL130AI.
  1178     05  FILLER            PIC  X(0012).
  1179*    -------------------------------
  1180     05  RUNDTEL PIC S9(0004) COMP.
  1181     05  RUNDTEF PIC  X(0001).
  1182     05  FILLER REDEFINES RUNDTEF.
  1183         10  RUNDTEA PIC  X(0001).
  1184     05  RUNDTEI PIC  X(0008).
  1185*    -------------------------------
  1186     05  RUNTIMEL PIC S9(0004) COMP.
  1187     05  RUNTIMEF PIC  X(0001).
  1188     05  FILLER REDEFINES RUNTIMEF.
  1189         10  RUNTIMEA PIC  X(0001).
  1190     05  RUNTIMEI PIC  X(0005).
  1191*    -------------------------------
  1192     05  COMPL PIC S9(0004) COMP.
  1193     05  COMPF PIC  X(0001).
  1194     05  FILLER REDEFINES COMPF.
  1195         10  COMPA PIC  X(0001).
  1196     05  COMPI PIC  X(0003).
  1197*    -------------------------------
  1198     05  SEQUL PIC S9(0004) COMP.
  1199     05  SEQUF PIC  X(0001).
  1200     05  FILLER REDEFINES SEQUF.
  1201         10  SEQUA PIC  X(0001).
  1202     05  SEQUI PIC  X(0010).
  1203*    -------------------------------
  1204     05  MAINTL PIC S9(0004) COMP.
  1205     05  MAINTF PIC  X(0001).
  1206     05  FILLER REDEFINES MAINTF.
  1207         10  MAINTA PIC  X(0001).
  1208     05  MAINTI PIC  X(0001).
  1209*    -------------------------------
  1210     05  CLMNOL PIC S9(0004) COMP.
  1211     05  CLMNOF PIC  X(0001).
  1212     05  FILLER REDEFINES CLMNOF.
  1213         10  CLMNOA PIC  X(0001).
  1214     05  CLMNOI PIC  X(0007).
  1215*    -------------------------------
  1216     05  CLMCARRL PIC S9(0004) COMP.
  1217     05  CLMCARRF PIC  X(0001).
  1218     05  FILLER REDEFINES CLMCARRF.
  1219         10  CLMCARRA PIC  X(0001).
  1220     05  CLMCARRI PIC  X(0001).
  1221*    -------------------------------
  1222     05  CLMTYPEL PIC S9(0004) COMP.
  1223     05  CLMTYPEF PIC  X(0001).
  1224     05  FILLER REDEFINES CLMTYPEF.
  1225         10  CLMTYPEA PIC  X(0001).
  1226     05  CLMTYPEI PIC  X(0001).
  1227*    -------------------------------
  1228     05  INSTYPEL PIC S9(0004) COMP.
  1229     05  INSTYPEF PIC  X(0001).
  1230     05  FILLER REDEFINES INSTYPEF.
  1231         10  INSTYPEA PIC  X(0001).
  1232     05  INSTYPEI PIC  X(0001).
  1233*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  25
* EL130.cbl
  1234     05  CERTNOL PIC S9(0004) COMP.
  1235     05  CERTNOF PIC  X(0001).
  1236     05  FILLER REDEFINES CERTNOF.
  1237         10  CERTNOA PIC  X(0001).
  1238     05  CERTNOI PIC  X(0010).
  1239*    -------------------------------
  1240     05  SUFXL PIC S9(0004) COMP.
  1241     05  SUFXF PIC  X(0001).
  1242     05  FILLER REDEFINES SUFXF.
  1243         10  SUFXA PIC  X(0001).
  1244     05  SUFXI PIC  X(0001).
  1245*    -------------------------------
  1246     05  PCERTNOL PIC S9(0004) COMP.
  1247     05  PCERTNOF PIC  X(0001).
  1248     05  FILLER REDEFINES PCERTNOF.
  1249         10  PCERTNOA PIC  X(0001).
  1250     05  PCERTNOI PIC  X(0010).
  1251*    -------------------------------
  1252     05  PSUFXL PIC S9(0004) COMP.
  1253     05  PSUFXF PIC  X(0001).
  1254     05  FILLER REDEFINES PSUFXF.
  1255         10  PSUFXA PIC  X(0001).
  1256     05  PSUFXI PIC  X(0001).
  1257*    -------------------------------
  1258     05  INCURL PIC S9(0004) COMP.
  1259     05  INCURF PIC  X(0001).
  1260     05  FILLER REDEFINES INCURF.
  1261         10  INCURA PIC  X(0001).
  1262     05  INCURI PIC  X(0008).
  1263*    -------------------------------
  1264     05  REPORTL PIC S9(0004) COMP.
  1265     05  REPORTF PIC  X(0001).
  1266     05  FILLER REDEFINES REPORTF.
  1267         10  REPORTA PIC  X(0001).
  1268     05  REPORTI PIC  X(0008).
  1269*    -------------------------------
  1270     05  CAUSEL PIC S9(0004) COMP.
  1271     05  CAUSEF PIC  X(0001).
  1272     05  FILLER REDEFINES CAUSEF.
  1273         10  CAUSEA PIC  X(0001).
  1274     05  CAUSEI PIC  X(0006).
  1275*    -------------------------------
  1276     05  ESTENDL PIC S9(0004) COMP.
  1277     05  ESTENDF PIC  X(0001).
  1278     05  FILLER REDEFINES ESTENDF.
  1279         10  ESTENDA PIC  X(0001).
  1280     05  ESTENDI PIC  X(0008).
  1281*    -------------------------------
  1282     05  DIAGL PIC S9(0004) COMP.
  1283     05  DIAGF PIC  X(0001).
  1284     05  FILLER REDEFINES DIAGF.
  1285         10  DIAGA PIC  X(0001).
  1286     05  DIAGI PIC  X(0060).
  1287*    -------------------------------
  1288     05  BENECDL PIC S9(0004) COMP.
  1289     05  BENECDF PIC  X(0001).
  1290     05  FILLER REDEFINES BENECDF.
  1291         10  BENECDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  26
* EL130.cbl
  1292     05  BENECDI PIC  X(0010).
  1293*    -------------------------------
  1294     05  BIRTHDTL PIC S9(0004) COMP.
  1295     05  BIRTHDTF PIC  X(0001).
  1296     05  FILLER REDEFINES BIRTHDTF.
  1297         10  BIRTHDTA PIC  X(0001).
  1298     05  BIRTHDTI PIC  X(0008).
  1299*    -------------------------------
  1300     05  SSNL PIC S9(0004) COMP.
  1301     05  SSNF PIC  X(0001).
  1302     05  FILLER REDEFINES SSNF.
  1303         10  SSNA PIC  X(0001).
  1304     05  SSNI PIC  X(0011).
  1305*    -------------------------------
  1306     05  SEXL PIC S9(0004) COMP.
  1307     05  SEXF PIC  X(0001).
  1308     05  FILLER REDEFINES SEXF.
  1309         10  SEXA PIC  X(0001).
  1310     05  SEXI PIC  X(0001).
  1311*    -------------------------------
  1312     05  OCCCDL PIC S9(0004) COMP.
  1313     05  OCCCDF PIC  X(0001).
  1314     05  FILLER REDEFINES OCCCDF.
  1315         10  OCCCDA PIC  X(0001).
  1316     05  OCCCDI PIC  X(0006).
  1317*    -------------------------------
  1318     05  LSTNMEL PIC S9(0004) COMP.
  1319     05  LSTNMEF PIC  X(0001).
  1320     05  FILLER REDEFINES LSTNMEF.
  1321         10  LSTNMEA PIC  X(0001).
  1322     05  LSTNMEI PIC  X(0015).
  1323*    -------------------------------
  1324     05  FSTNMEL PIC S9(0004) COMP.
  1325     05  FSTNMEF PIC  X(0001).
  1326     05  FILLER REDEFINES FSTNMEF.
  1327         10  FSTNMEA PIC  X(0001).
  1328     05  FSTNMEI PIC  X(0012).
  1329*    -------------------------------
  1330     05  INITL PIC S9(0004) COMP.
  1331     05  INITF PIC  X(0001).
  1332     05  FILLER REDEFINES INITF.
  1333         10  INITA PIC  X(0001).
  1334     05  INITI PIC  X(0001).
  1335*    -------------------------------
  1336     05  LOANNOL PIC S9(0004) COMP.
  1337     05  LOANNOF PIC  X(0001).
  1338     05  FILLER REDEFINES LOANNOF.
  1339         10  LOANNOA PIC  X(0001).
  1340     05  LOANNOI PIC  X(0008).
  1341*    -------------------------------
  1342     05  CRTLNMEL PIC S9(0004) COMP.
  1343     05  CRTLNMEF PIC  X(0001).
  1344     05  FILLER REDEFINES CRTLNMEF.
  1345         10  CRTLNMEA PIC  X(0001).
  1346     05  CRTLNMEI PIC  X(0015).
  1347*    -------------------------------
  1348     05  CRTFNMEL PIC S9(0004) COMP.
  1349     05  CRTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  27
* EL130.cbl
  1350     05  FILLER REDEFINES CRTFNMEF.
  1351         10  CRTFNMEA PIC  X(0001).
  1352     05  CRTFNMEI PIC  X(0012).
  1353*    -------------------------------
  1354     05  CRTINITL PIC S9(0004) COMP.
  1355     05  CRTINITF PIC  X(0001).
  1356     05  FILLER REDEFINES CRTINITF.
  1357         10  CRTINITA PIC  X(0001).
  1358     05  CRTINITI PIC  X(0001).
  1359*    -------------------------------
  1360     05  LOANBALL PIC S9(0004) COMP.
  1361     05  LOANBALF PIC  X(0001).
  1362     05  FILLER REDEFINES LOANBALF.
  1363         10  LOANBALA PIC  X(0001).
  1364     05  LOANBALI PIC  9(7)V99.
  1365*    -------------------------------
  1366     05  MANRSVL PIC S9(0004) COMP.
  1367     05  MANRSVF PIC  X(0001).
  1368     05  FILLER REDEFINES MANRSVF.
  1369         10  MANRSVA PIC  X(0001).
  1370     05  MANRSVI PIC  9(7)V99.
  1371*    -------------------------------
  1372     05  SUPVL PIC S9(0004) COMP.
  1373     05  SUPVF PIC  X(0001).
  1374     05  FILLER REDEFINES SUPVF.
  1375         10  SUPVA PIC  X(0001).
  1376     05  SUPVI PIC  X(0001).
  1377*    -------------------------------
  1378     05  PRICDL PIC S9(0004) COMP.
  1379     05  PRICDF PIC  X(0001).
  1380     05  FILLER REDEFINES PRICDF.
  1381         10  PRICDA PIC  X(0001).
  1382     05  PRICDI PIC  X(0001).
  1383*    -------------------------------
  1384     05  PRODL PIC S9(0004) COMP.
  1385     05  PRODF PIC  X(0001).
  1386     05  FILLER REDEFINES PRODF.
  1387         10  PRODA PIC  X(0001).
  1388     05  PRODI PIC  X(0008).
  1389*    -------------------------------
  1390     05  PRODCDL PIC S9(0004) COMP.
  1391     05  PRODCDF PIC  X(0001).
  1392     05  FILLER REDEFINES PRODCDF.
  1393         10  PRODCDA PIC  X(0001).
  1394     05  PRODCDI PIC  X(0001).
  1395*    -------------------------------
  1396     05  FILETOL PIC S9(0004) COMP.
  1397     05  FILETOF PIC  X(0001).
  1398     05  FILLER REDEFINES FILETOF.
  1399         10  FILETOA PIC  X(0001).
  1400     05  FILETOI PIC  X(0004).
  1401*    -------------------------------
  1402     05  PROCCDL PIC S9(0004) COMP.
  1403     05  PROCCDF PIC  X(0001).
  1404     05  FILLER REDEFINES PROCCDF.
  1405         10  PROCCDA PIC  X(0001).
  1406     05  PROCCDI PIC  X(0004).
  1407*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  28
* EL130.cbl
  1408     05  RELCLML PIC S9(0004) COMP.
  1409     05  RELCLMF PIC  X(0001).
  1410     05  FILLER REDEFINES RELCLMF.
  1411         10  RELCLMA PIC  X(0001).
  1412     05  RELCLMI PIC  X(0007).
  1413*    -------------------------------
  1414     05  PRTOPTL PIC S9(0004) COMP.
  1415     05  PRTOPTF PIC  X(0001).
  1416     05  FILLER REDEFINES PRTOPTF.
  1417         10  PRTOPTA PIC  X(0001).
  1418     05  PRTOPTI PIC  X(0001).
  1419*    -------------------------------
  1420     05  ALTPRTL PIC S9(0004) COMP.
  1421     05  ALTPRTF PIC  X(0001).
  1422     05  FILLER REDEFINES ALTPRTF.
  1423         10  ALTPRTA PIC  X(0001).
  1424     05  ALTPRTI PIC  X(0004).
  1425*    -------------------------------
  1426     05  CERTMTL PIC S9(0004) COMP.
  1427     05  CERTMTF PIC  X(0001).
  1428     05  FILLER REDEFINES CERTMTF.
  1429         10  CERTMTA PIC  X(0001).
  1430     05  CERTMTI PIC  X(0001).
  1431*    -------------------------------
  1432     05  CRTCARRL PIC S9(0004) COMP.
  1433     05  CRTCARRF PIC  X(0001).
  1434     05  FILLER REDEFINES CRTCARRF.
  1435         10  CRTCARRA PIC  X(0001).
  1436     05  CRTCARRI PIC  X(0001).
  1437*    -------------------------------
  1438     05  GROUPL PIC S9(0004) COMP.
  1439     05  GROUPF PIC  X(0001).
  1440     05  FILLER REDEFINES GROUPF.
  1441         10  GROUPA PIC  X(0001).
  1442     05  GROUPI PIC  X(0006).
  1443*    -------------------------------
  1444     05  STATEL PIC S9(0004) COMP.
  1445     05  STATEF PIC  X(0001).
  1446     05  FILLER REDEFINES STATEF.
  1447         10  STATEA PIC  X(0001).
  1448     05  STATEI PIC  X(0002).
  1449*    -------------------------------
  1450     05  ACCOUNTL PIC S9(0004) COMP.
  1451     05  ACCOUNTF PIC  X(0001).
  1452     05  FILLER REDEFINES ACCOUNTF.
  1453         10  ACCOUNTA PIC  X(0001).
  1454     05  ACCOUNTI PIC  X(0010).
  1455*    -------------------------------
  1456     05  EFFDTL PIC S9(0004) COMP.
  1457     05  EFFDTF PIC  X(0001).
  1458     05  FILLER REDEFINES EFFDTF.
  1459         10  EFFDTA PIC  X(0001).
  1460     05  EFFDTI PIC  X(0008).
  1461*    -------------------------------
  1462     05  CRTSSNL PIC S9(0004) COMP.
  1463     05  CRTSSNF PIC  X(0001).
  1464     05  FILLER REDEFINES CRTSSNF.
  1465         10  CRTSSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  29
* EL130.cbl
  1466     05  CRTSSNI PIC  X(0011).
  1467*    -------------------------------
  1468     05  MEMCAPL PIC S9(0004) COMP.
  1469     05  MEMCAPF PIC  X(0001).
  1470     05  FILLER REDEFINES MEMCAPF.
  1471         10  MEMCAPA PIC  X(0001).
  1472     05  MEMCAPI PIC  X(0010).
  1473*    -------------------------------
  1474     05  MEMBERL PIC S9(0004) COMP.
  1475     05  MEMBERF PIC  X(0001).
  1476     05  FILLER REDEFINES MEMBERF.
  1477         10  MEMBERA PIC  X(0001).
  1478     05  MEMBERI PIC  X(0012).
  1479*    -------------------------------
  1480     05  REINCDL PIC S9(0004) COMP.
  1481     05  REINCDF PIC  X(0001).
  1482     05  FILLER REDEFINES REINCDF.
  1483         10  REINCDA PIC  X(0001).
  1484     05  REINCDI PIC  X(0001).
  1485*    -------------------------------
  1486     05  ISSAGEL PIC S9(0004) COMP.
  1487     05  ISSAGEF PIC  X(0001).
  1488     05  FILLER REDEFINES ISSAGEF.
  1489         10  ISSAGEA PIC  X(0001).
  1490     05  ISSAGEI PIC  X(0002).
  1491*    -------------------------------
  1492     05  APRL PIC S9(0004) COMP.
  1493     05  APRF PIC  X(0001).
  1494     05  FILLER REDEFINES APRF.
  1495         10  APRA PIC  X(0001).
  1496     05  APRI PIC  9(4)V9(4).
  1497*    -------------------------------
  1498     05  PMTFREQL PIC S9(0004) COMP.
  1499     05  PMTFREQF PIC  X(0001).
  1500     05  FILLER REDEFINES PMTFREQF.
  1501         10  PMTFREQA PIC  X(0001).
  1502     05  PMTFREQI PIC  99.
  1503*    -------------------------------
  1504     05  INDGRPL PIC S9(0004) COMP.
  1505     05  INDGRPF PIC  X(0001).
  1506     05  FILLER REDEFINES INDGRPF.
  1507         10  INDGRPA PIC  X(0001).
  1508     05  INDGRPI PIC  X(0001).
  1509*    -------------------------------
  1510     05  PREMTYPL PIC S9(0004) COMP.
  1511     05  PREMTYPF PIC  X(0001).
  1512     05  FILLER REDEFINES PREMTYPF.
  1513         10  PREMTYPA PIC  X(0001).
  1514     05  PREMTYPI PIC  X(0001).
  1515*    -------------------------------
  1516     05  ADDONDTL PIC S9(0004) COMP.
  1517     05  ADDONDTF PIC  X(0001).
  1518     05  FILLER REDEFINES ADDONDTF.
  1519         10  ADDONDTA PIC  X(0001).
  1520     05  ADDONDTI PIC  X(0008).
  1521*    -------------------------------
  1522     05  JNTLNMEL PIC S9(0004) COMP.
  1523     05  JNTLNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  30
* EL130.cbl
  1524     05  FILLER REDEFINES JNTLNMEF.
  1525         10  JNTLNMEA PIC  X(0001).
  1526     05  JNTLNMEI PIC  X(0015).
  1527*    -------------------------------
  1528     05  JNTFNMEL PIC S9(0004) COMP.
  1529     05  JNTFNMEF PIC  X(0001).
  1530     05  FILLER REDEFINES JNTFNMEF.
  1531         10  JNTFNMEA PIC  X(0001).
  1532     05  JNTFNMEI PIC  X(0002).
  1533*    -------------------------------
  1534     05  JNTINITL PIC S9(0004) COMP.
  1535     05  JNTINITF PIC  X(0001).
  1536     05  FILLER REDEFINES JNTINITF.
  1537         10  JNTINITA PIC  X(0001).
  1538     05  JNTINITI PIC  X(0001).
  1539*    -------------------------------
  1540     05  JNTAGEL PIC S9(0004) COMP.
  1541     05  JNTAGEF PIC  X(0001).
  1542     05  FILLER REDEFINES JNTAGEF.
  1543         10  JNTAGEA PIC  X(0001).
  1544     05  JNTAGEI PIC  X(0002).
  1545*    -------------------------------
  1546     05  LCVDSCRL PIC S9(0004) COMP.
  1547     05  LCVDSCRF PIC  X(0001).
  1548     05  FILLER REDEFINES LCVDSCRF.
  1549         10  LCVDSCRA PIC  X(0001).
  1550     05  LCVDSCRI PIC  X(0006).
  1551*    -------------------------------
  1552     05  LCVKINDL PIC S9(0004) COMP.
  1553     05  LCVKINDF PIC  X(0001).
  1554     05  FILLER REDEFINES LCVKINDF.
  1555         10  LCVKINDA PIC  X(0001).
  1556     05  LCVKINDI PIC  X(0003).
  1557*    -------------------------------
  1558     05  LCVCDL PIC S9(0004) COMP.
  1559     05  LCVCDF PIC  X(0001).
  1560     05  FILLER REDEFINES LCVCDF.
  1561         10  LCVCDA PIC  X(0001).
  1562     05  LCVCDI PIC  X(0002).
  1563*    -------------------------------
  1564     05  LCVOTRML PIC S9(0004) COMP.
  1565     05  LCVOTRMF PIC  X(0001).
  1566     05  FILLER REDEFINES LCVOTRMF.
  1567         10  LCVOTRMA PIC  X(0001).
  1568     05  LCVOTRMI PIC  999.
  1569*    -------------------------------
  1570     05  LCVRTRML PIC S9(0004) COMP.
  1571     05  LCVRTRMF PIC  X(0001).
  1572     05  FILLER REDEFINES LCVRTRMF.
  1573         10  LCVRTRMA PIC  X(0001).
  1574     05  LCVRTRMI PIC  X(0003).
  1575*    -------------------------------
  1576     05  LCVRATEL PIC S9(0004) COMP.
  1577     05  LCVRATEF PIC  X(0001).
  1578     05  FILLER REDEFINES LCVRATEF.
  1579         10  LCVRATEA PIC  X(0001).
  1580     05  LCVRATEI PIC  9999V99.
  1581*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  31
* EL130.cbl
  1582     05  LCVBENEL PIC S9(0004) COMP.
  1583     05  LCVBENEF PIC  X(0001).
  1584     05  FILLER REDEFINES LCVBENEF.
  1585         10  LCVBENEA PIC  X(0001).
  1586     05  LCVBENEI PIC  9(9)V99.
  1587*    -------------------------------
  1588     05  LCVFORML PIC S9(0004) COMP.
  1589     05  LCVFORMF PIC  X(0001).
  1590     05  FILLER REDEFINES LCVFORMF.
  1591         10  LCVFORMA PIC  X(0001).
  1592     05  LCVFORMI PIC  X(0012).
  1593*    -------------------------------
  1594     05  LCVCNDTL PIC S9(0004) COMP.
  1595     05  LCVCNDTF PIC  X(0001).
  1596     05  FILLER REDEFINES LCVCNDTF.
  1597         10  LCVCNDTA PIC  X(0001).
  1598     05  LCVCNDTI PIC  X(0008).
  1599*    -------------------------------
  1600     05  LCVEXITL PIC S9(0004) COMP.
  1601     05  LCVEXITF PIC  X(0001).
  1602     05  FILLER REDEFINES LCVEXITF.
  1603         10  LCVEXITA PIC  X(0001).
  1604     05  LCVEXITI PIC  X(0008).
  1605*    -------------------------------
  1606     05  LCVSTATL PIC S9(0004) COMP.
  1607     05  LCVSTATF PIC  X(0001).
  1608     05  FILLER REDEFINES LCVSTATF.
  1609         10  LCVSTATA PIC  X(0001).
  1610     05  LCVSTATI PIC  X(0006).
  1611*    -------------------------------
  1612     05  ACVDSCRL PIC S9(0004) COMP.
  1613     05  ACVDSCRF PIC  X(0001).
  1614     05  FILLER REDEFINES ACVDSCRF.
  1615         10  ACVDSCRA PIC  X(0001).
  1616     05  ACVDSCRI PIC  X(0006).
  1617*    -------------------------------
  1618     05  ACVKINDL PIC S9(0004) COMP.
  1619     05  ACVKINDF PIC  X(0001).
  1620     05  FILLER REDEFINES ACVKINDF.
  1621         10  ACVKINDA PIC  X(0001).
  1622     05  ACVKINDI PIC  X(0003).
  1623*    -------------------------------
  1624     05  ACVCDL PIC S9(0004) COMP.
  1625     05  ACVCDF PIC  X(0001).
  1626     05  FILLER REDEFINES ACVCDF.
  1627         10  ACVCDA PIC  X(0001).
  1628     05  ACVCDI PIC  X(0002).
  1629*    -------------------------------
  1630     05  ACVOTRML PIC S9(0004) COMP.
  1631     05  ACVOTRMF PIC  X(0001).
  1632     05  FILLER REDEFINES ACVOTRMF.
  1633         10  ACVOTRMA PIC  X(0001).
  1634     05  ACVOTRMI PIC  999.
  1635*    -------------------------------
  1636     05  ACVRTRML PIC S9(0004) COMP.
  1637     05  ACVRTRMF PIC  X(0001).
  1638     05  FILLER REDEFINES ACVRTRMF.
  1639         10  ACVRTRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  32
* EL130.cbl
  1640     05  ACVRTRMI PIC  X(0003).
  1641*    -------------------------------
  1642     05  ACVRATEL PIC S9(0004) COMP.
  1643     05  ACVRATEF PIC  X(0001).
  1644     05  FILLER REDEFINES ACVRATEF.
  1645         10  ACVRATEA PIC  X(0001).
  1646     05  ACVRATEI PIC  9999V99.
  1647*    -------------------------------
  1648     05  ACVBENEL PIC S9(0004) COMP.
  1649     05  ACVBENEF PIC  X(0001).
  1650     05  FILLER REDEFINES ACVBENEF.
  1651         10  ACVBENEA PIC  X(0001).
  1652     05  ACVBENEI PIC  9(9)V99.
  1653*    -------------------------------
  1654     05  ACVFORML PIC S9(0004) COMP.
  1655     05  ACVFORMF PIC  X(0001).
  1656     05  FILLER REDEFINES ACVFORMF.
  1657         10  ACVFORMA PIC  X(0001).
  1658     05  ACVFORMI PIC  X(0012).
  1659*    -------------------------------
  1660     05  ACVCNDTL PIC S9(0004) COMP.
  1661     05  ACVCNDTF PIC  X(0001).
  1662     05  FILLER REDEFINES ACVCNDTF.
  1663         10  ACVCNDTA PIC  X(0001).
  1664     05  ACVCNDTI PIC  X(0008).
  1665*    -------------------------------
  1666     05  ACVEXITL PIC S9(0004) COMP.
  1667     05  ACVEXITF PIC  X(0001).
  1668     05  FILLER REDEFINES ACVEXITF.
  1669         10  ACVEXITA PIC  X(0001).
  1670     05  ACVEXITI PIC  X(0008).
  1671*    -------------------------------
  1672     05  ACVSTATL PIC S9(0004) COMP.
  1673     05  ACVSTATF PIC  X(0001).
  1674     05  FILLER REDEFINES ACVSTATF.
  1675         10  ACVSTATA PIC  X(0001).
  1676     05  ACVSTATI PIC  X(0006).
  1677*    -------------------------------
  1678     05  ERRMSG1L PIC S9(0004) COMP.
  1679     05  ERRMSG1F PIC  X(0001).
  1680     05  FILLER REDEFINES ERRMSG1F.
  1681         10  ERRMSG1A PIC  X(0001).
  1682     05  ERRMSG1I PIC  X(0072).
  1683*    -------------------------------
  1684     05  ERRMSG2L PIC S9(0004) COMP.
  1685     05  ERRMSG2F PIC  X(0001).
  1686     05  FILLER REDEFINES ERRMSG2F.
  1687         10  ERRMSG2A PIC  X(0001).
  1688     05  ERRMSG2I PIC  X(0072).
  1689*    -------------------------------
  1690     05  BCERT1L PIC S9(0004) COMP.
  1691     05  BCERT1F PIC  X(0001).
  1692     05  FILLER REDEFINES BCERT1F.
  1693         10  BCERT1A PIC  X(0001).
  1694     05  BCERT1I PIC  X(0010).
  1695*    -------------------------------
  1696     05  BSUFX1L PIC S9(0004) COMP.
  1697     05  BSUFX1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  33
* EL130.cbl
  1698     05  FILLER REDEFINES BSUFX1F.
  1699         10  BSUFX1A PIC  X(0001).
  1700     05  BSUFX1I PIC  X(0001).
  1701*    -------------------------------
  1702     05  BCERT2L PIC S9(0004) COMP.
  1703     05  BCERT2F PIC  X(0001).
  1704     05  FILLER REDEFINES BCERT2F.
  1705         10  BCERT2A PIC  X(0001).
  1706     05  BCERT2I PIC  X(0010).
  1707*    -------------------------------
  1708     05  BSUFX2L PIC S9(0004) COMP.
  1709     05  BSUFX2F PIC  X(0001).
  1710     05  FILLER REDEFINES BSUFX2F.
  1711         10  BSUFX2A PIC  X(0001).
  1712     05  BSUFX2I PIC  X(0001).
  1713*    -------------------------------
  1714     05  BCERT3L PIC S9(0004) COMP.
  1715     05  BCERT3F PIC  X(0001).
  1716     05  FILLER REDEFINES BCERT3F.
  1717         10  BCERT3A PIC  X(0001).
  1718     05  BCERT3I PIC  X(0010).
  1719*    -------------------------------
  1720     05  BSUFX3L PIC S9(0004) COMP.
  1721     05  BSUFX3F PIC  X(0001).
  1722     05  FILLER REDEFINES BSUFX3F.
  1723         10  BSUFX3A PIC  X(0001).
  1724     05  BSUFX3I PIC  X(0001).
  1725*    -------------------------------
  1726     05  BCERT4L PIC S9(0004) COMP.
  1727     05  BCERT4F PIC  X(0001).
  1728     05  FILLER REDEFINES BCERT4F.
  1729         10  BCERT4A PIC  X(0001).
  1730     05  BCERT4I PIC  X(0010).
  1731*    -------------------------------
  1732     05  BSUFX4L PIC S9(0004) COMP.
  1733     05  BSUFX4F PIC  X(0001).
  1734     05  FILLER REDEFINES BSUFX4F.
  1735         10  BSUFX4A PIC  X(0001).
  1736     05  BSUFX4I PIC  X(0001).
  1737*    -------------------------------
  1738     05  BCERT5L PIC S9(0004) COMP.
  1739     05  BCERT5F PIC  X(0001).
  1740     05  FILLER REDEFINES BCERT5F.
  1741         10  BCERT5A PIC  X(0001).
  1742     05  BCERT5I PIC  X(0010).
  1743*    -------------------------------
  1744     05  BSUFX5L PIC S9(0004) COMP.
  1745     05  BSUFX5F PIC  X(0001).
  1746     05  FILLER REDEFINES BSUFX5F.
  1747         10  BSUFX5A PIC  X(0001).
  1748     05  BSUFX5I PIC  X(0001).
  1749*    -------------------------------
  1750     05  ENTERPFL PIC S9(0004) COMP.
  1751     05  ENTERPFF PIC  X(0001).
  1752     05  FILLER REDEFINES ENTERPFF.
  1753         10  ENTERPFA PIC  X(0001).
  1754     05  ENTERPFI PIC  99.
  1755*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  34
* EL130.cbl
  1756     05  PF5L PIC S9(0004) COMP.
  1757     05  PF5F PIC  X(0001).
  1758     05  FILLER REDEFINES PF5F.
  1759         10  PF5A PIC  X(0001).
  1760     05  PF5I PIC  X(0013).
  1761 01  EL130AO REDEFINES EL130AI.
  1762     05  FILLER            PIC  X(0012).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  RUNDTEO PIC  X(0008).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  RUNTIMEO PIC  99.99.
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  COMPO PIC  X(0003).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  SEQUO PIC  X(0010).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  MAINTO PIC  X(0001).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  CLMNOO PIC  X(0007).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  CLMCARRO PIC  X(0001).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  CLMTYPEO PIC  X(0001).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  INSTYPEO PIC  X(0001).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  CERTNOO PIC  X(0010).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  SUFXO PIC  X(0001).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  PCERTNOO PIC  X(0010).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  PSUFXO PIC  X(0001).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  INCURO PIC  X(0008).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  REPORTO PIC  X(0008).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  CAUSEO PIC  X(0006).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  ESTENDO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  35
* EL130.cbl
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  DIAGO PIC  X(0060).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  BENECDO PIC  X(0010).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  BIRTHDTO PIC  X(0008).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  SSNO PIC  X(0011).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  SEXO PIC  X(0001).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  OCCCDO PIC  X(0006).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  LSTNMEO PIC  X(0015).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  FSTNMEO PIC  X(0012).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  INITO PIC  X(0001).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  LOANNOO PIC  X(0008).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  CRTLNMEO PIC  X(0015).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  CRTFNMEO PIC  X(0012).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  CRTINITO PIC  X(0001).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  LOANBALO PIC  ZZZZZ9.99.
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  MANRSVO PIC  Z(5)9.99.
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  SUPVO PIC  X(0001).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  PRICDO PIC  X(0001).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  PRODO PIC  X(0008).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  PRODCDO PIC  X(0001).
  1871*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  36
* EL130.cbl
  1872     05  FILLER            PIC  X(0003).
  1873     05  FILETOO PIC  X(0004).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  PROCCDO PIC  X(0004).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  RELCLMO PIC  X(0007).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  PRTOPTO PIC  X(0001).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  ALTPRTO PIC  X(0004).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  CERTMTO PIC  X(0001).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  CRTCARRO PIC  X(0001).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  GROUPO PIC  X(0006).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  STATEO PIC  X(0002).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  ACCOUNTO PIC  X(0010).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  EFFDTO PIC  X(0008).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  CRTSSNO PIC  X(0011).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  MEMCAPO PIC  X(0010).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  MEMBERO PIC  X(0012).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  REINCDO PIC  X(0001).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  ISSAGEO PIC  X(0002).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  APRO PIC  9(3).9(4).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  PMTFREQO PIC  99.
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  INDGRPO PIC  X(0001).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  37
* EL130.cbl
  1930     05  PREMTYPO PIC  X(0001).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  ADDONDTO PIC  X(0008).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  JNTLNMEO PIC  X(0015).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  JNTFNMEO PIC  X(0002).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  JNTINITO PIC  X(0001).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  JNTAGEO PIC  X(0002).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  LCVDSCRO PIC  X(0006).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  LCVKINDO PIC  X(0003).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  LCVCDO PIC  X(0002).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  LCVOTRMO PIC  999.
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  LCVRTRMO PIC  ZZZ.
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  LCVRATEO PIC  ZZZ.ZZ.
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  LCVFORMO PIC  X(0012).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  LCVCNDTO PIC  X(0008).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  LCVEXITO PIC  X(0008).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  LCVSTATO PIC  X(0006).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  ACVDSCRO PIC  X(0006).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  ACVKINDO PIC  X(0003).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  ACVCDO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  38
* EL130.cbl
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  ACVOTRMO PIC  999.
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  ACVRTRMO PIC  ZZZ.
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  ACVRATEO PIC  ZZZ.ZZ.
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  ACVFORMO PIC  X(0012).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  ACVCNDTO PIC  X(0008).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  ACVEXITO PIC  X(0008).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  ACVSTATO PIC  X(0006).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  ERRMSG1O PIC  X(0072).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  ERRMSG2O PIC  X(0072).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  BCERT1O PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  BSUFX1O PIC  X(0001).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  BCERT2O PIC  X(0010).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  BSUFX2O PIC  X(0001).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  BCERT3O PIC  X(0010).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  BSUFX3O PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  BCERT4O PIC  X(0010).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  BSUFX4O PIC  X(0001).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  BCERT5O PIC  X(0010).
  2045*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  39
* EL130.cbl
  2046     05  FILLER            PIC  X(0003).
  2047     05  BSUFX5O PIC  X(0001).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  ENTERPFO PIC  X(0002).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  PF5O PIC  X(0013).
  2054*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  40
* EL130.cbl
  2056*    COPY ELCDATE.
  2057******************************************************************
  2058*                                                                *
  2059*                                                                *
  2060*                            ELCDATE.                            *
  2061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2062*                            VMOD=2.003
  2063*                                                                *
  2064*                                                                *
  2065*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2066*                 LENGTH = 200                                   *
  2067******************************************************************
  2068
  2069 01  DATE-CONVERSION-DATA.
  2070     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2071     12  DC-OPTION-CODE                PIC X.
  2072         88  BIN-TO-GREG                VALUE ' '.
  2073         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2074         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2075         88  YMD-GREG-TO-BIN            VALUE '3'.
  2076         88  MDY-GREG-TO-BIN            VALUE '4'.
  2077         88  JULIAN-TO-BIN              VALUE '5'.
  2078         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2079         88  FIND-CENTURY               VALUE '7'.
  2080         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2081         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2082         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2083         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2084         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2085         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2086         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2087         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2088         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2089         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2090         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2091         88  BIN-3-TO-GREG              VALUE 'I'.
  2092         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2093         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2094         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2095         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2096         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2097         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2098         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2099         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2100         88  THREE-CHARACTER-BIN
  2101                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2102         88  GREGORIAN-TO-BIN
  2103                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2104         88  BIN-TO-GREGORIAN
  2105                  VALUES ' ' '1' 'I' '8' 'G'.
  2106         88  JULIAN-TO-BINARY
  2107                  VALUES '5' 'C' 'E' 'F'.
  2108     12  DC-ERROR-CODE                 PIC X.
  2109         88  NO-CONVERSION-ERROR        VALUE ' '.
  2110         88  DATE-CONVERSION-ERROR
  2111                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2112         88  DATE-IS-ZERO               VALUE '1'.
  2113         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  41
* EL130.cbl
  2114         88  DATE-IS-INVALID            VALUE '3'.
  2115         88  DATE1-GREATER-DATE2        VALUE '4'.
  2116         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2117         88  DATE-INVALID-OPTION        VALUE '9'.
  2118         88  INVALID-CENTURY            VALUE 'A'.
  2119         88  ONLY-CENTURY               VALUE 'B'.
  2120         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2121         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2122     12  DC-END-OF-MONTH               PIC X.
  2123         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2124     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2125         88  USE-NORMAL-PROCESS         VALUE ' '.
  2126         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2127         88  ADJUST-UP-100-YRS          VALUE '2'.
  2128     12  FILLER                        PIC X.
  2129     12  DC-CONVERSION-DATES.
  2130         16  DC-BIN-DATE-1             PIC XX.
  2131         16  DC-BIN-DATE-2             PIC XX.
  2132         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2133         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2134                       DC-GREG-DATE-1-EDIT.
  2135             20  DC-EDIT1-MONTH        PIC 99.
  2136             20  SLASH1-1              PIC X.
  2137             20  DC-EDIT1-DAY          PIC 99.
  2138             20  SLASH1-2              PIC X.
  2139             20  DC-EDIT1-YEAR         PIC 99.
  2140         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2141         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2142                     DC-GREG-DATE-2-EDIT.
  2143             20  DC-EDIT2-MONTH        PIC 99.
  2144             20  SLASH2-1              PIC X.
  2145             20  DC-EDIT2-DAY          PIC 99.
  2146             20  SLASH2-2              PIC X.
  2147             20  DC-EDIT2-YEAR         PIC 99.
  2148         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2149         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2150                     DC-GREG-DATE-1-YMD.
  2151             20  DC-YMD-YEAR           PIC 99.
  2152             20  DC-YMD-MONTH          PIC 99.
  2153             20  DC-YMD-DAY            PIC 99.
  2154         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2155         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2156                      DC-GREG-DATE-1-MDY.
  2157             20  DC-MDY-MONTH          PIC 99.
  2158             20  DC-MDY-DAY            PIC 99.
  2159             20  DC-MDY-YEAR           PIC 99.
  2160         16  DC-GREG-DATE-1-ALPHA.
  2161             20  DC-ALPHA-MONTH        PIC X(10).
  2162             20  DC-ALPHA-DAY          PIC 99.
  2163             20  FILLER                PIC XX.
  2164             20  DC-ALPHA-CENTURY.
  2165                 24 DC-ALPHA-CEN-N     PIC 99.
  2166             20  DC-ALPHA-YEAR         PIC 99.
  2167         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2168         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2169         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2170         16  DC-JULIAN-DATE            PIC 9(05).
  2171         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  42
* EL130.cbl
  2172                                       PIC 9(05).
  2173         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2174             20  DC-JULIAN-YEAR        PIC 99.
  2175             20  DC-JULIAN-DAYS        PIC 999.
  2176         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2177         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2178         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2179     12  DATE-CONVERSION-VARIBLES.
  2180         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2181         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2182             20  FILLER                PIC 9(3).
  2183             20  HOLD-CEN-1-CCYY.
  2184                 24  HOLD-CEN-1-CC     PIC 99.
  2185                 24  HOLD-CEN-1-YY     PIC 99.
  2186             20  HOLD-CEN-1-MO         PIC 99.
  2187             20  HOLD-CEN-1-DA         PIC 99.
  2188         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2189             20  HOLD-CEN-1-R-MO       PIC 99.
  2190             20  HOLD-CEN-1-R-DA       PIC 99.
  2191             20  HOLD-CEN-1-R-CCYY.
  2192                 24  HOLD-CEN-1-R-CC   PIC 99.
  2193                 24  HOLD-CEN-1-R-YY   PIC 99.
  2194             20  FILLER                PIC 9(3).
  2195         16  HOLD-CENTURY-1-X.
  2196             20  FILLER                PIC X(3)  VALUE SPACES.
  2197             20  HOLD-CEN-1-X-CCYY.
  2198                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2199                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2200             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2201             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2202         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2203             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2204             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2205             20  HOLD-CEN-1-R-X-CCYY.
  2206                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2207                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2208             20  FILLER                PIC XXX.
  2209         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2210         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2211         16  DC-JULIAN-DATE-1          PIC 9(07).
  2212         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2213             20  DC-JULIAN-1-CCYY.
  2214                 24  DC-JULIAN-1-CC    PIC 99.
  2215                 24  DC-JULIAN-1-YR    PIC 99.
  2216             20  DC-JULIAN-DA-1        PIC 999.
  2217         16  DC-JULIAN-DATE-2          PIC 9(07).
  2218         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2219             20  DC-JULIAN-2-CCYY.
  2220                 24  DC-JULIAN-2-CC    PIC 99.
  2221                 24  DC-JULIAN-2-YR    PIC 99.
  2222             20  DC-JULIAN-DA-2        PIC 999.
  2223         16  DC-GREG-DATE-A-EDIT.
  2224             20  DC-EDITA-MONTH        PIC 99.
  2225             20  SLASHA-1              PIC X VALUE '/'.
  2226             20  DC-EDITA-DAY          PIC 99.
  2227             20  SLASHA-2              PIC X VALUE '/'.
  2228             20  DC-EDITA-CCYY.
  2229                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  43
* EL130.cbl
  2230                 24  DC-EDITA-YEAR     PIC 99.
  2231         16  DC-GREG-DATE-B-EDIT.
  2232             20  DC-EDITB-MONTH        PIC 99.
  2233             20  SLASHB-1              PIC X VALUE '/'.
  2234             20  DC-EDITB-DAY          PIC 99.
  2235             20  SLASHB-2              PIC X VALUE '/'.
  2236             20  DC-EDITB-CCYY.
  2237                 24  DC-EDITB-CENT     PIC 99.
  2238                 24  DC-EDITB-YEAR     PIC 99.
  2239         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2240         16  DC-GREG-DATE-CYMD-R REDEFINES
  2241                              DC-GREG-DATE-CYMD.
  2242             20  DC-CYMD-CEN           PIC 99.
  2243             20  DC-CYMD-YEAR          PIC 99.
  2244             20  DC-CYMD-MONTH         PIC 99.
  2245             20  DC-CYMD-DAY           PIC 99.
  2246         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2247         16  DC-GREG-DATE-MDCY-R REDEFINES
  2248                              DC-GREG-DATE-MDCY.
  2249             20  DC-MDCY-MONTH         PIC 99.
  2250             20  DC-MDCY-DAY           PIC 99.
  2251             20  DC-MDCY-CEN           PIC 99.
  2252             20  DC-MDCY-YEAR          PIC 99.
  2253    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2254        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2255    12  DC-EL310-DATE                  PIC X(21).
  2256    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  44
* EL130.cbl
  2258*    COPY ELCCALC.
  2259******************************************************************
  2260*                                                                *
  2261*                           ELCCALC.                            *
  2262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2263*                            VMOD=2.025                          *
  2264*                                                                *
  2265*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2266*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2267*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2268*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2269*                                                                *
  2270*  PASSED TO ELRTRM                                              *
  2271*  -----------------                                             *
  2272*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2273*  ORIGINAL TERM                                                 *
  2274*  BEGINNING DATE                                                *
  2275*  ENDING DATE                                                   *
  2276*  COMPANY I.D.                                                  *
  2277*  ACCOUNT MASTER USER FIELD                                     *
  2278*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2279*  FREE LOOK DAYS                                                *
  2280*                                                                *
  2281*  RETURNED FROM ELRTRM                                          *
  2282*  ---------------------                                         *
  2283*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2284*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2285*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2286*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2287*----------------------------------------------------------------*
  2288*  PASSED TO ELRAMT                                              *
  2289*  ----------------                                              *
  2290*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2291*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2292*  ORIGINAL AMOUNT                                               *
  2293*  ALTERNATE BENEFIT (BALLON)                                    *
  2294*  A.P.R. - NET PAY ONLY                                         *
  2295*  METHOD
  2296*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2297*  COMPANY I.D.                                                  *
  2298*  BENEFIT TYPE                                                  *
  2299*                                                                *
  2300*  RETURNED FROM ELRAMT                                          *
  2301*  --------------------                                          *
  2302*  REMAINING AMOUNT 1 - CURRENT                                  *
  2303*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2304*  REMAINING AMOUNT FACTOR
  2305*----------------------------------------------------------------*
  2306*  PASSED TO ELRESV                                              *
  2307*  -----------------                                             *
  2308*  CERTIFICATE EFFECTIVE DATE                                    *
  2309*  VALUATION DATE                                                *
  2310*  PAID THRU DATE                                                *
  2311*  BENEFIT                                                       *
  2312*  INCURRED DATE                                                 *
  2313*  REPORTED DATE                                                 *
  2314*  ISSUE AGE                                                     *
  2315*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  45
* EL130.cbl
  2316*  CDT PERCENT                                                   *
  2317*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2318* *CLAIM TYPE (LIFE, A/H)                                        *
  2319* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2320* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2321*                                                                *
  2322*  RETURNED FROM ELRESV                                          *
  2323*  --------------------                                          *
  2324*  CDT TABLE USED                                                *
  2325*  CDT FACTOR USED                                               *
  2326*  PAY TO CURRENT RESERVE                                        *
  2327*  I.B.N.R. - A/H ONLY                                           *
  2328*  FUTURE (ACCRUED) AH ONLY                                      *
  2329*----------------------------------------------------------------*
  2330*  PASSED TO ELRATE                                              *
  2331*  ----------------                                              *
  2332*  CERT ISSUE DATE                                               *
  2333*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2334*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2335*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2336*  STATE CODE (CLIENT DEFINED)                                   *
  2337*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2338*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2339*  DEVIATION CODE                                                *
  2340*  ISSUE AGE                                                     *
  2341*  ORIGINAL BENEFIT AMOUNT                                       *
  2342*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2343*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2344*  BENEFIT KIND (LIFE OR A/H)                                    *
  2345*  A.P.R.                                                        *
  2346*  METHOD
  2347*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2348*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2349*  COMPANY I.D. (3 CHARACTER)                                    *
  2350*  BENEFIT CODE                                                  *
  2351*  BENEFIT OVERRIDE CODE                                         *
  2352*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2353*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2354*  JOINT INDICATOR (CSL ONLY)                                    *
  2355*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2356*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2357*                                                                *
  2358*  RETURNED FROM ELRATE                                          *
  2359*  --------------------                                          *
  2360*  CALCULATED PREMIUM                                            *
  2361*  PREMIUM RATE                                                  *
  2362*  MORTALITY CODE                                                *
  2363*  MAX ATTAINED AGE                                              *
  2364*  MAX AGE                                                       *
  2365*  MAX TERM                                                      *
  2366*  MAX MONTHLY BENEFIT                                           *
  2367*  MAX TOTAL BENIFIT                                             *
  2368*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2369*----------------------------------------------------------------*
  2370*  PASSED TO ELRFND                                              *
  2371*  ----------------                                              *
  2372*  CERT ISSUE DATE                                               *
  2373*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  46
* EL130.cbl
  2374*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2375*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2376*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2377*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2378*  STATE CODE (CLIENT DEFINED)                                   *
  2379*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2380*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2381*  DEVIATION CODE                                                *
  2382*  ISSUE AGE                                                     *
  2383*  ORIGINAL BENEFIT AMOUNT                                       *
  2384*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2385*  PROCESS TYPE (CANCEL)                                         *
  2386*  BENEFIT KIND (LIFE OR A/H)                                    *
  2387*  A.P.R.                                                        *
  2388*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2389*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2390*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2391*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2392*  COMPANY I.D. (3 CHARACTER)                                    *
  2393*  BENEFIT CODE                                                  *
  2394*  BENEFIT OVERRIDE CODE                                         *
  2395*                                                                *
  2396*  RETURNED FROM ELRFND                                          *
  2397*  --------------------                                          *
  2398*  CALCULATED REFUND                                             *
  2399*----------------------------------------------------------------*
  2400*  PASSED TO ELEARN                                              *
  2401*  ----------------                                              *
  2402*  CERT ISSUE DATE                                               *
  2403*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2404*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2405*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2406*  STATE CODE (CLIENT DEFINED)                                   *
  2407*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2408*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2409*  DEVIATION CODE                                                *
  2410*  ISSUE AGE                                                     *
  2411*  ORIGINAL BENEFIT AMOUNT                                       *
  2412*  BENEFIT KIND (LIFE OR A/H)                                    *
  2413*  A.P.R.                                                        *
  2414*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2415*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2416*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2417*  COMPANY I.D. (3 CHARACTER)                                    *
  2418*  BENEFIT CODE                                                  *
  2419*  BENEFIT OVERRIDE CODE                                         *
  2420*                                                                *
  2421*  RETURNED FROM ELEARN                                          *
  2422*  --------------------                                          *
  2423*  INDICATED  EARNINGS                                           *
  2424*----------------------------------------------------------------*
  2425*                 LENGTH = 450                                   *
  2426*                                                                *
  2427******************************************************************
  2428******************************************************************
  2429*                   C H A N G E   L O G
  2430*
  2431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  47
* EL130.cbl
  2432*-----------------------------------------------------------------
  2433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2434* EFFECTIVE    NUMBER
  2435*-----------------------------------------------------------------
  2436* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2437* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2438* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2439* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2440* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2441* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2442* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2443* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2444* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2445******************************************************************
  2446
  2447 01  CALCULATION-PASS-AREA.
  2448     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2449                                     COMP.
  2450
  2451     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2452       88  NO-CP-ERROR                             VALUE ZERO.
  2453       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2454                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2455       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2456       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2457       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2458       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2459       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2460       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2461       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2462       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2463       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2464       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2465       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2466       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2467       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2468       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2469       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2470       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2471       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2472
  2473     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2474       88  NO-CP-ERROR-2                           VALUE ZERO.
  2475***********************  INPUT AREAS ****************************
  2476
  2477     12  CP-CALCULATION-AREA.
  2478         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2479         16  CP-CERT-EFF-DT        PIC XX.
  2480         16  CP-VALUATION-DT       PIC XX.
  2481         16  CP-PAID-THRU-DT       PIC XX.
  2482         16  CP-BENEFIT-TYPE       PIC X.
  2483           88  CP-AH                               VALUE 'A' 'D'
  2484                                                   'I' 'U'.
  2485           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2486           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2487         16  CP-INCURRED-DT        PIC XX.
  2488         16  CP-REPORTED-DT        PIC XX.
  2489         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  48
* EL130.cbl
  2490         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2491         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2492                                     COMP-3.
  2493         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2494                                     COMP-3.
  2495         16  CP-CDT-METHOD         PIC X.
  2496           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2497           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2498           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2499         16  CP-CLAIM-TYPE         PIC X.
  2500           88  CP-AH-CLAIM                         VALUE 'A'.
  2501           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2502         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2503                                     COMP-3.
  2504         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2505                                     COMP-3.
  2506         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2507                                     COMP-3.
  2508         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2509                                     COMP-3.
  2510         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2511                                     COMP-3.
  2512         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2513                                     COMP-3.
  2514         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2515                                     COMP-3.
  2516         16  CP-REM-TERM-METHOD    PIC X.
  2517           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2518           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2519           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2520           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2521           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2522           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2523           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2524         16  CP-EARNING-METHOD     PIC X.
  2525           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2526           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2527           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2528           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2529           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2530           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2531           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2532           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2533           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2534           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2535           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2536           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2537           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2538           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2539         16  CP-PROCESS-TYPE       PIC X.
  2540           88  CP-CLAIM                            VALUE '1'.
  2541           88  CP-CANCEL                           VALUE '2'.
  2542           88  CP-ISSUE                            VALUE '3'.
  2543         16  CP-SPECIAL-CALC-CD    PIC X.
  2544           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2545           88  CP-1-MTH-INTEREST               VALUE ' '.
  2546           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2547           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  49
* EL130.cbl
  2548           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2549           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2550           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2551           88  CP-FARM-PLAN                    VALUE 'F'.
  2552           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2553           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2554           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2555           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2556           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2557           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2558           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2559           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2560           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2561           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2562                                                     'W' 'X'.
  2563           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2564           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2565           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2566           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2567           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2568           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2569           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2570           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2571           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2572           88  CP-CSL-METH-1                   VALUE '5'.
  2573           88  CP-CSL-METH-2                   VALUE '6'.
  2574           88  CP-CSL-METH-3                   VALUE '7'.
  2575           88  CP-CSL-METH-4                   VALUE '8'.
  2576
  2577         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2578                                     COMP-3.
  2579         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2580         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2581         16  CP-STATE              PIC XX          VALUE SPACE.
  2582         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2583         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2584           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2585               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2586         16  CP-R78-OPTION         PIC X.
  2587           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2588           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2589
  2590         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2591         16  CP-IBNR-RESERVE-SW    PIC X.
  2592         16  CP-CLAIM-STATUS       PIC X.
  2593         16  CP-RATE-FILE          PIC X.
  2594         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2595                                     COMP-3.
  2596
  2597         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2598         16  CP-AH-OVERRIDE-CODE   PIC X.
  2599
  2600         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2601                                     COMP-3.
  2602         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2603                                   PIC S9(5)V99 COMP-3.
  2604         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2605                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  50
* EL130.cbl
  2606         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2607                                     COMP-3.
  2608         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2609                                     COMP-3.
  2610         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2611                                  PIC S9(7)V99 COMP-3.
  2612
  2613         16  CP-PAID-FROM-DATE     PIC X(02).
  2614         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2615         16  CP-EXT-DAYS-CALC      PIC X.
  2616           88  CP-EXT-NO-CHG                   VALUE ' '.
  2617           88  CP-EXT-CHG-LF                   VALUE '1'.
  2618           88  CP-EXT-CHG-AH                   VALUE '2'.
  2619           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2620         16  CP-DOMICILE-STATE     PIC XX.
  2621         16  CP-CARRIER            PIC X.
  2622         16  CP-REIN-FLAG          PIC X.
  2623         16  CP-REM-TRM-CALC-OPTION PIC X.
  2624           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2625                      '2' '3' '4' '5'.
  2626           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2627           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2628           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2629           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2630           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2631           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2632           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2633           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2634         16  CP-SIG-SWITCH         PIC X.
  2635         16  CP-RATING-METHOD      PIC X.
  2636           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2637           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2638           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2639           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2640           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2641           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2642           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2643           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2644           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2645         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2646                                     COMP-3.
  2647         16  CP-BEN-CATEGORY       PIC X.
  2648         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2649         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2650                                   PIC S99V9(5) COMP-3.
  2651         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2652         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2653                                   PIC S99V9(5) COMP-3.
  2654         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2655         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2656         16  CP-EXPIRE-DT          PIC XX.
  2657         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2658         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2659         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2660         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2661         16  CP-DDF-SPEC-CALC      PIC X.
  2662             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2663             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  51
* EL130.cbl
  2664         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2665         16  CP-CANCEL-REASON      PIC X.
  2666         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2667         16  CP-PMT-MODE           PIC X.
  2668         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2669         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2670         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2671         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2672         16  FILLER                PIC X.
  2673
  2674***************    OUTPUT FROM ELRESV   ************************
  2675
  2676         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2677
  2678         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2679                                     COMP-3.
  2680         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2681                                     COMP-3.
  2682         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2683                                     COMP-3.
  2684         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2685                                     COMP-3.
  2686         16  FILLER                PIC X(09).
  2687***************    OUTPUT FROM ELRTRM   *************************
  2688
  2689         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2690                                     COMP-3.
  2691         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2692                                     COMP-3.
  2693         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2694                                     COMP-3.
  2695         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2696                                     COMP-3.
  2697         16  FILLER                PIC X(12).
  2698
  2699***************    OUTPUT FROM ELRAMT   *************************
  2700
  2701         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2702                                     COMP-3.
  2703         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2704                                     COMP-3.
  2705         16  FILLER                PIC X(12).
  2706
  2707***************    OUTPUT FROM ELRATE   *************************
  2708
  2709         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-MORTALITY-CODE     PIC X(4).
  2714         16  CP-RATE-EDIT-FLAG     PIC X.
  2715             88  CP-RATES-NEED-APR                  VALUE '1'.
  2716         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2717                                     COMP-3.
  2718         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2719         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2720         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2721                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  52
* EL130.cbl
  2722         16  FILLER                PIC X(07).
  2723
  2724***************    OUTPUT FROM ELRFND   *************************
  2725
  2726         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2727                                     COMP-3.
  2728         16  CP-REFUND-TYPE-USED   PIC X.
  2729           88  CP-R-AS-R78                         VALUE '1'.
  2730           88  CP-R-AS-PRORATA                     VALUE '2'.
  2731           88  CP-R-AS-CALIF                       VALUE '3'.
  2732           88  CP-R-AS-TEXAS                       VALUE '4'.
  2733           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2734           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2735           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2736           88  CP-R-AS-MEAN                        VALUE '8'.
  2737           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2738           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2739           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2740           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2741           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2742           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2743         16  FILLER                PIC X(12).
  2744
  2745***************    OUTPUT FROM ELEARN   *************************
  2746
  2747         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2748                                     COMP-3.
  2749         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2750                                     COMP-3.
  2751         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2752                                     COMP-3.
  2753         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2754                                     COMP-3.
  2755         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2756                                     COMP-3.
  2757         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2758                                     COMP-3.
  2759         16  CP-EARNING-TYPE-USED  PIC X.
  2760           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2761           88  CP-E-AS-R78                         VALUE '1'.
  2762           88  CP-E-AS-PRORATA                     VALUE '2'.
  2763           88  CP-E-AS-TEXAS                       VALUE '4'.
  2764           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2765           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2766           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2767           88  CP-E-AS-MEAN                        VALUE '8'.
  2768           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2769         16  FILLER                PIC X(12).
  2770
  2771***************    OUTPUT FROM ELPMNT   *************************
  2772
  2773         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2774                                     COMP-3.
  2775         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2776                                     COMP-3.
  2777         16  FILLER                PIC X(12).
  2778
  2779***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  53
* EL130.cbl
  2780         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2781                                     COMP-3.
  2782         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2783                                     COMP-3.
  2784         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2785                                     COMP-3.
  2786         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2787                                     COMP-3.
  2788         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2789                                     COMP-3.
  2790         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2791                                     COMP-3.
  2792         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2793             88  OPEN-RATE-FILE                   VALUE 'O'.
  2794             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2795             88  IO-ERROR                         VALUE 'E'.
  2796
  2797         16  CP-FIRST-PAY-DATE     PIC XX.
  2798
  2799         16  CP-JOINT-INDICATOR    PIC X.
  2800
  2801         16  CP-RESERVE-REMAINING-TERM
  2802                                   PIC S9(4)V9    VALUE ZERO
  2803                                     COMP-3.
  2804
  2805         16  CP-INSURED-BIRTH-DT   PIC XX.
  2806
  2807         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2808                                     COMP-3.
  2809
  2810         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2811                                     COMP-3.
  2812
  2813         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2814                                     COMP-3.
  2815
  2816         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2817                                     COMP-3.
  2818
  2819         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2820                                     COMP-3.
  2821
  2822         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2823                                     COMP-3.
  2824
  2825         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2826                                     COMP-3.
  2827
  2828         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2829             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2830
  2831         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2832                                     COMP-3.
  2833         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2834                                     COMP-3.
  2835         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2836         16  FILLER                PIC X(15).
  2837******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  54
* EL130.cbl
  2839*    COPY ELCLOGOF.
  2840******************************************************************
  2841*                                                                *
  2842*                                                                *
  2843*                            ELCLOGOF.                           *
  2844*                            VMOD=2.001                          *
  2845*                                                                *
  2846*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2847*                                                                *
  2848******************************************************************
  2849 01  CLASIC-LOGOFF.
  2850     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2851     12  LOGOFF-TEXT.
  2852         16  FILLER          PIC X(5)    VALUE SPACES.
  2853         16  LOGOFF-MSG.
  2854             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2855             20  FILLER      PIC X       VALUE SPACES.
  2856             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2857         16  FILLER          PIC X(80)
  2858           VALUE '* YOU ARE NOW LOGGED OFF'.
  2859         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2860         16  FILLER          PIC X       VALUE QUOTE.
  2861         16  LOGOFF-SYS-MSG  PIC X(17)
  2862           VALUE 'S CLAS-IC SYSTEM '.
  2863     12  TEXT-MESSAGES.
  2864         16  UNACCESS-MSG    PIC X(29)
  2865             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2866         16  PGMIDERR-MSG    PIC X(17)
  2867             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  55
* EL130.cbl
  2869*    COPY ELCATTR.
  2870******************************************************************
  2871*                                                                *
  2872*                            ELCATTR.                            *
  2873*                            VMOD=2.001                          *
  2874*                                                                *
  2875*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2876*                                                                *
  2877*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2878*                                                                *
  2879*                   POS 1   P=PROTECTED                          *
  2880*                           U=UNPROTECTED                        *
  2881*                           S=ASKIP                              *
  2882*                   POS 2   A=ALPHA/NUMERIC                      *
  2883*                           N=NUMERIC                            *
  2884*                   POS 3   N=NORMAL                             *
  2885*                           B=BRIGHT                             *
  2886*                           D=DARK                               *
  2887*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2888*                           OF=MODIFIED DATA TAG OFF             *
  2889*                                                                *
  2890*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2891******************************************************************
  2892 01  ATTRIBUTE-LIST.
  2893     12  AL-PABOF            PIC X       VALUE 'Y'.
  2894     12  AL-PABON            PIC X       VALUE 'Z'.
  2895     12  AL-PADOF            PIC X       VALUE '%'.
  2896     12  AL-PADON            PIC X       VALUE '_'.
  2897     12  AL-PANOF            PIC X       VALUE '-'.
  2898     12  AL-PANON            PIC X       VALUE '/'.
  2899     12  AL-SABOF            PIC X       VALUE '8'.
  2900     12  AL-SABON            PIC X       VALUE '9'.
  2901     12  AL-SADOF            PIC X       VALUE '@'.
  2902     12  AL-SADON            PIC X       VALUE QUOTE.
  2903     12  AL-SANOF            PIC X       VALUE '0'.
  2904     12  AL-SANON            PIC X       VALUE '1'.
  2905     12  AL-UABOF            PIC X       VALUE 'H'.
  2906     12  AL-UABON            PIC X       VALUE 'I'.
  2907     12  AL-UADOF            PIC X       VALUE '<'.
  2908     12  AL-UADON            PIC X       VALUE '('.
  2909     12  AL-UANOF            PIC X       VALUE ' '.
  2910     12  AL-UANON            PIC X       VALUE 'A'.
  2911     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2912     12  AL-UNBON            PIC X       VALUE 'R'.
  2913     12  AL-UNDOF            PIC X       VALUE '*'.
  2914     12  AL-UNDON            PIC X       VALUE ')'.
  2915     12  AL-UNNOF            PIC X       VALUE '&'.
  2916     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  56
* EL130.cbl
  2918*    COPY ELCEMIB.
  2919******************************************************************
  2920*                                                                *
  2921*                                                                *
  2922*                            ELCEMIB.                            *
  2923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2924*                            VMOD=2.005                          *
  2925*                                                                *
  2926*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2927*                                                                *
  2928******************************************************************
  2929 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2930     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2931     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2932     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2933     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2934     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2935     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2936     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2937     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2938     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2939         88  EMI-NO-ERRORS                    VALUE '1'.
  2940         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2941         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2942     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2943         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2944     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2945         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2946         88  EMI-AREA1-FULL                   VALUE '2'.
  2947     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2948         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2949         88  EMI-AREA2-FULL                   VALUE '2'.
  2950     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2951         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2952         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2953         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2954         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2955         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2956     12  EMI-ERROR-LINES.
  2957         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2958         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2959         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2960         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2961             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2962                 24  EMI-ERR-NUM         PIC X(4).
  2963                 24  EMI-FILLER          PIC X.
  2964                 24  EMI-SEV             PIC X.
  2965                 24  FILLER              PIC X.
  2966             20  FILLER                  PIC X(02).
  2967     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2968         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2969             20  EMI-ERROR-NUMBER    PIC X(4).
  2970             20  EMI-FILL            PIC X.
  2971             20  EMI-SEVERITY        PIC X.
  2972             20  FILLER              PIC X.
  2973             20  EMI-ERROR-TEXT.
  2974                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2975                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  57
* EL130.cbl
  2976     12  EMI-SEVERITY-SAVE           PIC X.
  2977         88  EMI-NOTE                    VALUE 'N'.
  2978         88  EMI-WARNING                 VALUE 'W'.
  2979         88  EMI-FORCABLE                VALUE 'F'.
  2980         88  EMI-FATAL                   VALUE 'X'.
  2981     12  EMI-MESSAGE-FLAG            PIC X.
  2982         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2983         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2984     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2985     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2986         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2987         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2988         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2989     12  emi-claim-no                pic x(7).
  2990     12  emi-claim-type              pic x(6).
  2991     12  FILLER                      PIC X(124)  VALUE SPACES.
  2992     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2993     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2994     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2995     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  58
* EL130.cbl
  2997*    COPY ELCJPFX.
  2998******************************************************************
  2999*                                                                *
  3000*                                                                *
  3001*                            ELCJPFX.                            *
  3002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3003*                            VMOD=2.002                          *
  3004*                                                                *
  3005*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3006*                                                                *
  3007*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3008*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3009*        ELCNTL - CONTROL FILE                                   *
  3010*        ELMSTR - CLAIM MASTERS                                  *
  3011*        ELTRLR - ACTIVITY TRAILERS                              *
  3012*        ELCHKQ - CHECK QUE                                      *
  3013******************************************************************
  3014 01  JOURNAL-RECORD.
  3015     12  JP-USER-ID                  PIC X(4).
  3016     12  JP-FILE-ID                  PIC X(8).
  3017     12  JP-PROGRAM-ID               PIC X(8).
  3018     12  JP-RECORD-TYPE              PIC X.
  3019         88 JP-ADD              VALUE 'A'.
  3020         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3021         88 JP-AFTER-CHANGE     VALUE 'C'.
  3022         88 JP-DELETE           VALUE 'D'.
  3023         88 JP-GENERIC-DELETE   VALUE 'G'.
  3024         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3025         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3026     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3027     12  JP-RECORD-AREA
  3028
  3029
  3030         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  59
* EL130.cbl
  3032*    COPY ELCAID.
  3033******************************************************************
  3034*                                                                *
  3035*                            ELCAID.                             *
  3036*                            VMOD=2.001                          *
  3037*                                                                *
  3038*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3039*                                                                *
  3040*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3041*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3042******************************************************************
  3043
  3044 01  DFHAID.
  3045   02  DFHNULL   PIC  X  VALUE  ' '.
  3046   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3047   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3048   02  DFHPEN    PIC  X  VALUE  '='.
  3049   02  DFHOPID   PIC  X  VALUE  'W'.
  3050   02  DFHPA1    PIC  X  VALUE  '%'.
  3051   02  DFHPA2    PIC  X  VALUE  '>'.
  3052   02  DFHPA3    PIC  X  VALUE  ','.
  3053   02  DFHPF1    PIC  X  VALUE  '1'.
  3054   02  DFHPF2    PIC  X  VALUE  '2'.
  3055   02  DFHPF3    PIC  X  VALUE  '3'.
  3056   02  DFHPF4    PIC  X  VALUE  '4'.
  3057   02  DFHPF5    PIC  X  VALUE  '5'.
  3058   02  DFHPF6    PIC  X  VALUE  '6'.
  3059   02  DFHPF7    PIC  X  VALUE  '7'.
  3060   02  DFHPF8    PIC  X  VALUE  '8'.
  3061   02  DFHPF9    PIC  X  VALUE  '9'.
  3062   02  DFHPF10   PIC  X  VALUE  ':'.
  3063   02  DFHPF11   PIC  X  VALUE  '#'.
  3064   02  DFHPF12   PIC  X  VALUE  '@'.
  3065   02  DFHPF13   PIC  X  VALUE  'A'.
  3066   02  DFHPF14   PIC  X  VALUE  'B'.
  3067   02  DFHPF15   PIC  X  VALUE  'C'.
  3068   02  DFHPF16   PIC  X  VALUE  'D'.
  3069   02  DFHPF17   PIC  X  VALUE  'E'.
  3070   02  DFHPF18   PIC  X  VALUE  'F'.
  3071   02  DFHPF19   PIC  X  VALUE  'G'.
  3072   02  DFHPF20   PIC  X  VALUE  'H'.
  3073   02  DFHPF21   PIC  X  VALUE  'I'.
  3074*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3075   02  DFHPF22   PIC  X  VALUE  '['.
  3076   02  DFHPF23   PIC  X  VALUE  '.'.
  3077   02  DFHPF24   PIC  X  VALUE  '<'.
  3078   02  DFHMSRE   PIC  X  VALUE  'X'.
  3079   02  DFHSTRF   PIC  X  VALUE  'h'.
  3080   02  DFHTRIG   PIC  X  VALUE  '"'.
  3081
  3082 01  FILLER    REDEFINES DFHAID.
  3083     12  FILLER              PIC X(8).
  3084     12  PF-VALUES           PIC X       OCCURS 12.
  3085
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  60
* EL130.cbl
  3087****************************************************************
  3088*
  3089* Copyright (c) 2007 by Clerity Solutions, Inc.
  3090* All rights reserved.
  3091*
  3092****************************************************************
  3093 01  DFHEIV.
  3094   02  DFHEIV0               PIC X(35).
  3095   02  DFHEIV1               PIC X(08).
  3096   02  DFHEIV2               PIC X(08).
  3097   02  DFHEIV3               PIC X(08).
  3098   02  DFHEIV4               PIC X(06).
  3099   02  DFHEIV5               PIC X(04).
  3100   02  DFHEIV6               PIC X(04).
  3101   02  DFHEIV7               PIC X(02).
  3102   02  DFHEIV8               PIC X(02).
  3103   02  DFHEIV9               PIC X(01).
  3104   02  DFHEIV10              PIC S9(7) COMP-3.
  3105   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3106   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3107   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3108   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3109   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3110   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3111   02  DFHEIV17              PIC X(04).
  3112   02  DFHEIV18              PIC X(04).
  3113   02  DFHEIV19              PIC X(04).
  3114   02  DFHEIV20              USAGE IS POINTER.
  3115   02  DFHEIV21              USAGE IS POINTER.
  3116   02  DFHEIV22              USAGE IS POINTER.
  3117   02  DFHEIV23              USAGE IS POINTER.
  3118   02  DFHEIV24              USAGE IS POINTER.
  3119   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3120   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3121   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3122   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3123   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3124   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3125   02  FILLER                PIC X(02).
  3126   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3127   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3128   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3129   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3130   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3131 LINKAGE  SECTION.
  3132*****************************************************************
  3133*                                                               *
  3134* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3135* All rights reserved.                                          *
  3136*                                                               *
  3137*****************************************************************
  3138 01  dfheiblk.
  3139     02  eibtime          pic s9(7) comp-3.
  3140     02  eibdate          pic s9(7) comp-3.
  3141     02  eibtrnid         pic x(4).
  3142     02  eibtaskn         pic s9(7) comp-3.
  3143     02  eibtrmid         pic x(4).
  3144     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  61
* EL130.cbl
  3145     02  eibcposn         pic s9(4) comp.
  3146     02  eibcalen         pic s9(4) comp.
  3147     02  eibaid           pic x(1).
  3148     02  eibfiller1       pic x(1).
  3149     02  eibfn            pic x(2).
  3150     02  eibfiller2       pic x(2).
  3151     02  eibrcode         pic x(6).
  3152     02  eibfiller3       pic x(2).
  3153     02  eibds            pic x(8).
  3154     02  eibreqid         pic x(8).
  3155     02  eibrsrce         pic x(8).
  3156     02  eibsync          pic x(1).
  3157     02  eibfree          pic x(1).
  3158     02  eibrecv          pic x(1).
  3159     02  eibsend          pic x(1).
  3160     02  eibatt           pic x(1).
  3161     02  eibeoc           pic x(1).
  3162     02  eibfmh           pic x(1).
  3163     02  eibcompl         pic x(1).
  3164     02  eibsig           pic x(1).
  3165     02  eibconf          pic x(1).
  3166     02  eiberr           pic x(1).
  3167     02  eibrldbk         pic x(1).
  3168     02  eiberrcd         pic x(4).
  3169     02  eibsynrb         pic x(1).
  3170     02  eibnodat         pic x(1).
  3171     02  eibfiller5       pic x(2).
  3172     02  eibresp          pic 9(09) comp.
  3173     02  eibresp2         pic 9(09) comp.
  3174     02  dfheigdj         pic s9(4) comp.
  3175     02  dfheigdk         pic s9(4) comp.
  3176
  3177 01  DFHCOMMAREA             PIC X(1024).
  3178
  3179*01 PARMLIST .
  3180*    02  FILLER              PIC S9(8)   COMP.
  3181*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3182*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3183*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3184*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3185*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3186*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3187*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3188*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3189*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  62
* EL130.cbl
  3191*    COPY ELCMSTR.
  3192******************************************************************
  3193*                                                                *
  3194*                            ELCMSTR.                            *
  3195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3196*                            VMOD=2.012                          *
  3197*                                                                *
  3198*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3199*                                                                *
  3200*   FILE TYPE = VSAM,KSDS                                        *
  3201*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3202*                                                                *
  3203*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3204*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3205*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3206*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3207*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3208*                                                 RKP=75,LEN=21  *
  3209*                                                                *
  3210*   **** NOTE ****                                               *
  3211*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3212*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3213*                                                                *
  3214*   LOG = YES                                                    *
  3215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3216******************************************************************
  3217*                   C H A N G E   L O G
  3218*
  3219* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3220*-----------------------------------------------------------------
  3221*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3222* EFFECTIVE    NUMBER
  3223*-----------------------------------------------------------------
  3224* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3225* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3226* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3227******************************************************************
  3228 01  CLAIM-MASTER.
  3229     12  CL-RECORD-ID                PIC XX.
  3230         88  VALID-CL-ID         VALUE 'CL'.
  3231
  3232     12  CL-CONTROL-PRIMARY.
  3233         16  CL-COMPANY-CD           PIC X.
  3234         16  CL-CARRIER              PIC X.
  3235         16  CL-CLAIM-NO             PIC X(7).
  3236         16  CL-CERT-NO.
  3237             20  CL-CERT-PRIME       PIC X(10).
  3238             20  CL-CERT-SFX         PIC X.
  3239
  3240     12  CL-CONTROL-BY-NAME.
  3241         16  CL-COMPANY-CD-A1        PIC X.
  3242         16  CL-INSURED-LAST-NAME    PIC X(15).
  3243         16  CL-INSURED-NAME.
  3244             20  CL-INSURED-1ST-NAME PIC X(12).
  3245             20  CL-INSURED-MID-INIT PIC X.
  3246
  3247     12  CL-CONTROL-BY-SSN.
  3248         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  63
* EL130.cbl
  3249         16  CL-SOC-SEC-NO.
  3250             20  CL-SSN-STATE        PIC XX.
  3251             20  CL-SSN-ACCOUNT      PIC X(6).
  3252             20  CL-SSN-LN3          PIC X(3).
  3253
  3254     12  CL-CONTROL-BY-CERT-NO.
  3255         16  CL-COMPANY-CD-A4        PIC X.
  3256         16  CL-CERT-NO-A4.
  3257             20  CL-CERT-A4-PRIME    PIC X(10).
  3258             20  CL-CERT-A4-SFX      PIC X.
  3259
  3260     12  CL-CONTROL-BY-CCN.
  3261         16  CL-COMPANY-CD-A5        PIC X.
  3262         16  CL-CCN-A5.
  3263             20  CL-CCN.
  3264                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3265                 24  CL-CCN-PRIME-A5 PIC X(12).
  3266             20  CL-CCN-FILLER-A5    PIC X(4).
  3267
  3268     12  CL-INSURED-PROFILE-DATA.
  3269         16  CL-INSURED-BIRTH-DT     PIC XX.
  3270         16  CL-INSURED-SEX-CD       PIC X.
  3271             88  INSURED-IS-MALE        VALUE 'M'.
  3272             88  INSURED-IS-FEMALE      VALUE 'F'.
  3273             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3274         16  CL-INSURED-OCC-CD       PIC X(6).
  3275         16  FILLER                  PIC X(5).
  3276
  3277     12  CL-PROCESSING-INFO.
  3278         16  CL-PROCESSOR-ID         PIC X(4).
  3279         16  CL-CLAIM-STATUS         PIC X.
  3280             88  CLAIM-IS-OPEN          VALUE 'O'.
  3281             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3282         16  CL-CLAIM-TYPE           PIC X.
  3283*            88  AH-CLAIM               VALUE 'A'.
  3284*            88  LIFE-CLAIM             VALUE 'L'.
  3285*            88  PROPERTY-CLAIM         VALUE 'P'.
  3286*            88  IUI-CLAIM              VALUE 'I'.
  3287*            88  GAP-CLAIM              VALUE 'G'.
  3288         16  CL-CLAIM-PREM-TYPE      PIC X.
  3289             88  SINGLE-PREMIUM         VALUE '1'.
  3290             88  O-B-COVERAGE           VALUE '2'.
  3291             88  OPEN-END-COVERAGE      VALUE '3'.
  3292         16  CL-INCURRED-DT          PIC XX.
  3293         16  CL-REPORTED-DT          PIC XX.
  3294         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3295         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3296         16  CL-LAST-PMT-DT          PIC XX.
  3297         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3298         16  CL-PAID-THRU-DT         PIC XX.
  3299         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3300         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3301         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3302         16  CL-PMT-CALC-METHOD      PIC X.
  3303             88  CL-360-DAY-YR          VALUE '1'.
  3304             88  CL-365-DAY-YR          VALUE '2'.
  3305             88  CL-FULL-MONTHS         VALUE '3'.
  3306         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  64
* EL130.cbl
  3307
  3308         16  CL-PRIME-CERT-NO.
  3309             20  CL-PRIME-CERT-PRIME PIC X(10).
  3310             20  CL-PRIME-CERT-SFX   PIC X.
  3311
  3312         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3313             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3314             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3315
  3316         16  CL-MICROFILM-NO         PIC X(10).
  3317         16  CL-PROG-FORM-TYPE       PIC X.
  3318         16  CL-LAST-ADD-ON-DT       PIC XX.
  3319
  3320         16  CL-LAST-REOPEN-DT       PIC XX.
  3321         16  CL-LAST-CLOSE-DT        PIC XX.
  3322         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3323             88  FINAL-PAID             VALUE '1'.
  3324             88  CLAIM-DENIED           VALUE '2'.
  3325             88  AUTO-CLOSE             VALUE '3'.
  3326             88  MANUAL-CLOSE           VALUE '4'.
  3327             88  BENEFITS-CHANGED       VALUE 'C'.
  3328             88  SETUP-ERRORS           VALUE 'E'.
  3329         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3330         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3331         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3332             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3333         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3334         16  FILLER                  PIC X.
  3335
  3336     12  CL-CERTIFICATE-DATA.
  3337         16  CL-CERT-ORIGIN          PIC X.
  3338             88  CERT-WAS-ONLINE        VALUE '1'.
  3339             88  CERT-WAS-CREATED       VALUE '2'.
  3340             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3341         16  CL-CERT-KEY-DATA.
  3342             20  CL-CERT-CARRIER     PIC X.
  3343             20  CL-CERT-GROUPING    PIC X(6).
  3344             20  CL-CERT-STATE       PIC XX.
  3345             20  CL-CERT-ACCOUNT.
  3346                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3347                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3348             20  CL-CERT-EFF-DT      PIC XX.
  3349
  3350     12  CL-STATUS-CONTROLS.
  3351         16  CL-PRIORITY-CD          PIC X.
  3352             88  CONFIDENTIAL-DATA      VALUE '8'.
  3353             88  HIGHEST-PRIORITY       VALUE '9'.
  3354         16  CL-SUPV-ATTN-CD         PIC X.
  3355             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3356             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3357         16  CL-PURGED-DT            PIC XX.
  3358         16  CL-RESTORED-DT          PIC XX.
  3359         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3360         16  CL-NEXT-RESEND-DT       PIC XX.
  3361         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3362         16  CL-CRITICAL-PERIOD      PIC 99.
  3363*        16  FILLER                  PIC XX.
  3364         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  65
* EL130.cbl
  3365         16  CL-LAST-MAINT-USER      PIC X(4).
  3366         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3367         16  CL-LAST-MAINT-TYPE      PIC X.
  3368             88  CLAIM-SET-UP           VALUE ' '.
  3369             88  PAYMENT-MADE           VALUE '1'.
  3370             88  LETTER-SENT            VALUE '2'.
  3371             88  MASTER-WAS-ALTERED     VALUE '3'.
  3372             88  MASTER-WAS-RESTORED    VALUE '4'.
  3373             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3374             88  FILE-CONVERTED         VALUE '6'.
  3375             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3376             88  ERROR-CORRECTION       VALUE 'E'.
  3377         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3378         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3379         16  CL-BENEFICIARY          PIC X(10).
  3380         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3381         16  CL-DENIAL-TYPE          PIC X.
  3382             88  CL-TYPE-DENIAL          VALUE '1'.
  3383             88  CL-TYPE-RESCISSION      VALUE '2'.
  3384             88  CL-TYPE-REFORMATION     VALUE '3'.
  3385             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3386             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3387         16  CL-CRIT-PER-RECURRENT   PIC X.
  3388         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3389         16  CL-RTW-DT               PIC XX.
  3390
  3391     12  CL-TRAILER-CONTROLS.
  3392         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3393             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3394             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3395             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3396         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3397         16  FILLER                  PIC XX.
  3398         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3399         16  CL-ADDRESS-TRAILER-CNT.
  3400             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3401                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3402             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3403                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3404             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3405                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3406             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3407                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3408             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3409                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3410             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3411                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3412             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3413                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3414
  3415     12  CL-CV-REFERENCE-NO.
  3416         16  CL-CV-REFNO-PRIME       PIC X(18).
  3417         16  CL-CV-REFNO-SFX         PIC XX.
  3418
  3419     12  CL-FILE-LOCATION            PIC X(4).
  3420
  3421     12  CL-PROCESS-ERRORS.
  3422         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  66
* EL130.cbl
  3423             88  NO-FATAL-ERRORS        VALUE ZERO.
  3424         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3425             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3426
  3427     12  CL-PRODUCT-CD               PIC X.
  3428
  3429     12  CL-CURRENT-KEY-DATA.
  3430         16  CL-CURRENT-CARRIER      PIC X.
  3431         16  CL-CURRENT-GROUPING     PIC X(6).
  3432         16  CL-CURRENT-STATE        PIC XX.
  3433         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3434
  3435     12  CL-ASSOCIATES               PIC X.
  3436         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3437         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3438         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3439         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3440
  3441     12  CL-ACTIVITY-CODE            PIC 99.
  3442     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3443     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3444
  3445     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3446     12  CL-LAG-REPORT-CODE          PIC 9.
  3447     12  CL-LOAN-TYPE                PIC XX.
  3448     12  CL-LEGAL-STATE              PIC XX.
  3449
  3450     12  CL-YESNOSW                  PIC X.
  3451     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3452         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3453         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3454         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3455     12  cl-insured-claim            pic x.
  3456         88  cl-claim-on-primary         value 'P'.
  3457         88  cl-claim-on-secondary       value 'S'.
  3458     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  67
* EL130.cbl
  3460*    COPY ELCCNTL.
  3461******************************************************************
  3462*                                                                *
  3463*                                                                *
  3464*                            ELCCNTL.                            *
  3465*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3466*                            VMOD=2.059                          *
  3467*                                                                *
  3468*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3469*                                                                *
  3470*   FILE TYPE = VSAM,KSDS                                        *
  3471*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3472*                                                                *
  3473*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3474*       ALTERNATE INDEX = NONE                                   *
  3475*                                                                *
  3476*   LOG = YES                                                    *
  3477*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3478******************************************************************
  3479*                   C H A N G E   L O G
  3480*
  3481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3482*-----------------------------------------------------------------
  3483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3484* EFFECTIVE    NUMBER
  3485*-----------------------------------------------------------------
  3486* 082503                   PEMA  ADD BENEFIT GROUP
  3487* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3488* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3489* 092705    2005050300006  PEMA  ADD SPP LEASES
  3490* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3491* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3492* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3493* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3494* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3495* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3496* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3497* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3498******************************************************************
  3499*
  3500 01  CONTROL-FILE.
  3501     12  CF-RECORD-ID                       PIC XX.
  3502         88  VALID-CF-ID                        VALUE 'CF'.
  3503
  3504     12  CF-CONTROL-PRIMARY.
  3505         16  CF-COMPANY-ID                  PIC XXX.
  3506         16  CF-RECORD-TYPE                 PIC X.
  3507             88  CF-COMPANY-MASTER              VALUE '1'.
  3508             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3509             88  CF-STATE-MASTER                VALUE '3'.
  3510             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3511             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3512             88  CF-CARRIER-MASTER              VALUE '6'.
  3513             88  CF-MORTALITY-MASTER            VALUE '7'.
  3514             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3515             88  CF-TERMINAL-MASTER             VALUE '9'.
  3516             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3517             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  68
* EL130.cbl
  3518             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3519             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3520             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3521             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3522             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3523             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3524             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3525         16  CF-ACCESS-CD-GENL              PIC X(4).
  3526         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3527             20  CF-PROCESSOR               PIC X(4).
  3528         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3529             20  CF-STATE-CODE              PIC XX.
  3530             20  FILLER                     PIC XX.
  3531         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3532             20  FILLER                     PIC XX.
  3533             20  CF-HI-BEN-IN-REC           PIC XX.
  3534         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3535             20  FILLER                     PIC XXX.
  3536             20  CF-CARRIER-CNTL            PIC X.
  3537         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3538             20  FILLER                     PIC XX.
  3539             20  CF-HI-TYPE-IN-REC          PIC 99.
  3540         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3541             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3542                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3543             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3544             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3545         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3546             20  FILLER                     PIC X.
  3547             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3548         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3549             20  FILLER                     PIC XX.
  3550             20  CF-MORTGAGE-PLAN           PIC XX.
  3551         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3552
  3553     12  CF-LAST-MAINT-DT                   PIC XX.
  3554     12  CF-LAST-MAINT-BY                   PIC X(4).
  3555     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3556
  3557     12  CF-RECORD-BODY                     PIC X(728).
  3558
  3559
  3560****************************************************************
  3561*             COMPANY MASTER RECORD                            *
  3562****************************************************************
  3563
  3564     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3565         16  CF-COMPANY-ADDRESS.
  3566             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3567             20  CF-CL-IN-CARE-OF           PIC X(30).
  3568             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3569             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3570             20  CF-CL-CITY-STATE           PIC X(30).
  3571             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3572             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3573         16  CF-COMPANY-CD                  PIC X.
  3574         16  CF-COMPANY-PASSWORD            PIC X(8).
  3575         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  69
* EL130.cbl
  3576             88  ALL-SECURITY                   VALUE '1'.
  3577             88  COMPANY-VERIFY                 VALUE '2'.
  3578             88  PROCESSOR-VERIFY               VALUE '3'.
  3579             88  NO-SECURITY                    VALUE '4'.
  3580             88  ALL-BUT-TERM                   VALUE '5'.
  3581         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3582             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3583         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3584             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3585         16  CF-INFORCE-LOCATION            PIC X.
  3586             88  CERTS-ARE-ONLINE               VALUE '1'.
  3587             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3588             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3589         16  CF-LOWER-CASE-LETTERS          PIC X.
  3590         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3591             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3592             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3593             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3594             88  CF-ACCNT-CNTL                  VALUE '3'.
  3595             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3596
  3597         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3598         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3599
  3600         16  CF-LGX-CREDIT-USER             PIC X.
  3601             88  CO-IS-NOT-USER                 VALUE 'N'.
  3602             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3603
  3604         16 CF-CREDIT-CALC-CODES.
  3605             20  CF-CR-REM-TERM-CALC PIC X.
  3606               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3607               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3608               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3609               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3610               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3611               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3612               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3613             20  CF-CR-R78-METHOD           PIC X.
  3614               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3615               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3616
  3617         16  CF-CLAIM-CONTROL-COUNTS.
  3618             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3619                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3620
  3621             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3622                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3623
  3624             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3625                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3626
  3627             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3628                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3629
  3630         16  CF-CURRENT-MONTH-END           PIC XX.
  3631
  3632         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3633             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  70
* EL130.cbl
  3634             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3635             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3636             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3637                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3638                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3639             20  CF-CO-PREM-REJECT-SW       PIC X.
  3640                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3641                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3642             20  CF-CO-REF-REJECT-SW        PIC X.
  3643                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3644                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3645
  3646         16  CF-CO-REPORTING-DT             PIC XX.
  3647         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3648         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3649           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3650           88  CF-CO-MONTH-END                  VALUE '1'.
  3651
  3652         16  CF-LGX-CLAIM-USER              PIC X.
  3653             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3654             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3655
  3656         16  CF-CREDIT-EDIT-CONTROLS.
  3657             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3658             20  CF-MIN-AGE                 PIC 99.
  3659             20  CF-DEFAULT-AGE             PIC 99.
  3660             20  CF-MIN-TERM                PIC S999      COMP-3.
  3661             20  CF-MAX-TERM                PIC S999      COMP-3.
  3662             20  CF-DEFAULT-SEX             PIC X.
  3663             20  CF-JOINT-AGE-INPUT         PIC X.
  3664                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3665             20  CF-BIRTH-DATE-INPUT        PIC X.
  3666                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3667             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3668                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3669                 88  CF-ZERO-CARRIER            VALUE '1'.
  3670                 88  CF-ZERO-GROUPING           VALUE '2'.
  3671                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3672             20  CF-EDIT-SW                 PIC X.
  3673                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3674             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3675             20  CF-CR-PR-METHOD            PIC X.
  3676               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3677               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3678             20  FILLER                     PIC X.
  3679
  3680         16  CF-CREDIT-MISC-CONTROLS.
  3681             20  CF-REIN-TABLE-SW           PIC X.
  3682                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3683             20  CF-COMP-TABLE-SW           PIC X.
  3684                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3685             20  CF-EXPERIENCE-RETENTION-AGE
  3686                                            PIC S9        COMP-3.
  3687             20  CF-CONVERSION-DT           PIC XX.
  3688             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3689             20  CF-RUN-FREQUENCY-SW        PIC X.
  3690                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3691                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  71
* EL130.cbl
  3692
  3693             20  CF-CR-CHECK-NO-CONTROL.
  3694                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3695                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3696                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3697                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3698                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3699                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3700
  3701                 24  CF-CR-CHECK-COUNT       REDEFINES
  3702                     CF-CR-CHECK-COUNTER      PIC X(4).
  3703
  3704                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3705                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3706
  3707                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3708                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3709                 24  CF-MAIL-PROCESSING       PIC X.
  3710                     88  MAIL-PROCESSING          VALUE 'Y'.
  3711
  3712         16  CF-MISC-SYSTEM-CONTROL.
  3713             20  CF-SYSTEM-C                 PIC X.
  3714                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3715             20  CF-SYSTEM-D                 PIC X.
  3716                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3717             20  CF-SOC-SEC-NO-SW            PIC X.
  3718                 88  SOC-SEC-NO-USED             VALUE '1'.
  3719             20  CF-MEMBER-NO-SW             PIC X.
  3720                 88  MEMBER-NO-USED              VALUE '1'.
  3721             20  CF-TAX-ID-NUMBER            PIC X(11).
  3722             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3723             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3724                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3725                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3726                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3727                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3728             20  CF-SYSTEM-E                 PIC X.
  3729                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3730
  3731         16  CF-LGX-LIFE-USER               PIC X.
  3732             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3733             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3734
  3735         16  CF-CR-MONTH-END-DT             PIC XX.
  3736
  3737         16  CF-FILE-MAINT-DATES.
  3738             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3739                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3740             20  CF-LAST-BATCH       REDEFINES
  3741                 CF-LAST-BATCH-NO               PIC X(4).
  3742             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3743             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3744             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3745             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3746             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3747             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3748             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3749             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  72
* EL130.cbl
  3750             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3751             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3752
  3753         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3754         16  FILLER                         PIC X.
  3755
  3756         16  CF-ALT-MORT-CODE               PIC X(4).
  3757         16  CF-MEMBER-CAPTION              PIC X(10).
  3758
  3759         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3760             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3761             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3762             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3763             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3764             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3765
  3766         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3767
  3768         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3769         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3770         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3771         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3772
  3773         16  CF-AH-OVERRIDE-L1              PIC X.
  3774         16  CF-AH-OVERRIDE-L2              PIC XX.
  3775         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3776         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3777
  3778         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3779         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3780
  3781         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3782         16  CF-AR-LAST-EL860-DT            PIC XX.
  3783         16  CF-MP-MONTH-END-DT             PIC XX.
  3784
  3785         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3786         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3787             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3788
  3789         16  CF-AR-MONTH-END-DT             PIC XX.
  3790
  3791         16  CF-CRDTCRD-USER                PIC X.
  3792             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3793             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3794
  3795         16  CF-CC-MONTH-END-DT             PIC XX.
  3796
  3797         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3798
  3799         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3800             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3801             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3802             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3803         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3804         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3805         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3806         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3807             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  73
* EL130.cbl
  3808             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3809         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3810         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3811         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3812             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3813         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3814
  3815         16  CF-CL-ZIP-CODE.
  3816             20  CF-CL-ZIP-PRIME.
  3817                 24  CF-CL-ZIP-1ST          PIC X.
  3818                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3819                 24  FILLER                 PIC X(4).
  3820             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3821         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3822             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3823             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3824             20  FILLER                     PIC XXX.
  3825
  3826         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3827         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3828         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3829         16  CF-CO-OPTION-START-DATE        PIC XX.
  3830         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3831           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3832                                                      '3' '4'.
  3833           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3834           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3835           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3836           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3837           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3838           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3839
  3840         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3841
  3842         16  CF-PAYMENT-APPROVAL-LEVELS.
  3843             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3844             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3845             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3846             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3847             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3848             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3849
  3850         16  CF-END-USER-REPORTING-USER     PIC X.
  3851             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3852             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3853
  3854         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3855             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3856             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3857
  3858         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3859
  3860         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3861         16  FILLER                         PIC X.
  3862
  3863         16  CF-CREDIT-ARCHIVE-CNTL.
  3864             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3865             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  74
* EL130.cbl
  3866             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3867
  3868         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3869
  3870         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3871             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3872             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3873
  3874         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3875             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3876             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3877
  3878         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3879
  3880         16  CF-CO-ACH-ID-CODE              PIC  X.
  3881             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3882             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3883             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3884         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3885         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3886         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3887         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3888         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3889         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3890         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3891         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3892         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3893                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3894         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3895                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3896
  3897         16  CF-CO-OVER-SHORT.
  3898             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3899             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3900
  3901*         16  FILLER                         PIC X(102).
  3902         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3903             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3904             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3905
  3906         16  CF-AH-APPROVAL-DAYS.
  3907             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3908             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3909             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3910             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3911
  3912         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3913
  3914         16  FILLER                         PIC X(79).
  3915****************************************************************
  3916*             PROCESSOR/USER RECORD                            *
  3917****************************************************************
  3918
  3919     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3920         16  CF-PROCESSOR-NAME              PIC X(30).
  3921         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3922         16  CF-PROCESSOR-TITLE             PIC X(26).
  3923         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  75
* EL130.cbl
  3924                 88  MESSAGE-YES                VALUE 'Y'.
  3925                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3926
  3927*****************************************************
  3928****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3929****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3930****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3931****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3932*****************************************************
  3933
  3934         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3935             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3936             20  CF-APPLICATION-FORCE       PIC X.
  3937             20  CF-INDIVIDUAL-APP.
  3938                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3939                     28  CF-BROWSE-APP      PIC X.
  3940                     28  CF-UPDATE-APP      PIC X.
  3941
  3942         16  CF-CURRENT-TERM-ON             PIC X(4).
  3943         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3944             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3945             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3946             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3947             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3948             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3949             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3950             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3951         16  CF-PROCESSOR-CARRIER           PIC X.
  3952             88  NO-CARRIER-SECURITY            VALUE ' '.
  3953         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3954             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3955         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3956             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3957         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3958             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3959
  3960         16  CF-PROC-SYS-ACCESS-SW.
  3961             20  CF-PROC-CREDIT-CLAIMS-SW.
  3962                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3963                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3964                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3965                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3966             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3967                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3968                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3969             20  CF-PROC-LIFE-GNRLDGR-SW.
  3970                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3971                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3972                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3973                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3974             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3975                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3976                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3977         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3978             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3979             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3980         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3981
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  76
* EL130.cbl
  3982         16  CF-APPROVAL-LEVEL                  PIC X.
  3983             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3984             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3985             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3986             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3987
  3988         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3989
  3990         16  CF-LANGUAGE-TYPE                   PIC X.
  3991             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3992             88  CF-LANG-IS-FR                      VALUE 'F'.
  3993
  3994         16  CF-CSR-IND                         PIC X.
  3995         16  FILLER                             PIC X(239).
  3996
  3997****************************************************************
  3998*             PROCESSOR/REMINDERS RECORD                       *
  3999****************************************************************
  4000
  4001     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4002         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4003             20  CF-START-REMIND-DT         PIC XX.
  4004             20  CF-END-REMIND-DT           PIC XX.
  4005             20  CF-REMINDER-TEXT           PIC X(50).
  4006         16  FILLER                         PIC X(296).
  4007
  4008
  4009****************************************************************
  4010*             STATE MASTER RECORD                              *
  4011****************************************************************
  4012
  4013     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4014         16  CF-STATE-ABBREVIATION          PIC XX.
  4015         16  CF-STATE-NAME                  PIC X(25).
  4016         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4017         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4018             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4019             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4020             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4021             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4022                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4023                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4024             20  CF-ST-PREM-REJECT-SW       PIC X.
  4025                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4026                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4027             20  CF-ST-REF-REJECT-SW        PIC X.
  4028                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4029                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4030         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4031         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4032         16  CF-ST-REFUND-RULES.
  4033             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4034             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4035             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4036         16  CF-ST-FST-PMT-EXTENSION.
  4037             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4038             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4039                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  77
* EL130.cbl
  4040                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4041                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4042                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4043         16  CF-ST-STATE-CALL.
  4044             20  CF-ST-CALL-UNEARNED        PIC X.
  4045             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4046             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4047         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4048             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4049             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4050         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4051         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4052         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4053         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4054         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4055         16  FILLER                         PIC X.
  4056         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4057             20  CF-ST-BENEFIT-CD           PIC XX.
  4058             20  CF-ST-BENEFIT-KIND         PIC X.
  4059                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4060                 88  CF-ST-AH-KIND              VALUE 'A'.
  4061             20  CF-ST-REM-TERM-CALC        PIC X.
  4062                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4063                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4064                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4065                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4066                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4067                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4068                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4069                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4070
  4071             20  CF-ST-REFUND-CALC          PIC X.
  4072                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4073                 88  ST-REFD-BY-R78             VALUE '1'.
  4074                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4075                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4076                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4077                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4078                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4079                 88  ST-REFD-UTAH               VALUE '7'.
  4080                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4081                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4082                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4083
  4084             20  CF-ST-EARNING-CALC         PIC X.
  4085                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4086                 88  ST-EARN-BY-R78             VALUE '1'.
  4087                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4088                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4089                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4090                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4091                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4092                 88  ST-EARN-MEAN               VALUE '8'.
  4093                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4094
  4095             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4096                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4097                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  78
* EL130.cbl
  4098                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4099                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4100                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4101                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4102                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4103                 88  ST-OVRD-MEAN               VALUE '8'.
  4104                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4105             20  FILLER                     PIC X.
  4106
  4107         16  CF-ST-COMMISSION-CAPS.
  4108             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4109             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4110             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4111             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4112         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4113                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4114
  4115         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4116
  4117         16  CF-ST-STATUTORY-INTEREST.
  4118             20  CF-ST-STAT-DATE-FROM       PIC X.
  4119                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4120                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4121             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4122             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4123             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4124             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4125             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4126
  4127         16  CF-ST-OVER-SHORT.
  4128             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4129             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4130
  4131         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4132
  4133         16  CF-ST-RT-CALC                  PIC X.
  4134
  4135         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4136         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4137         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4138         16  CF-ST-RF-LR-CALC               PIC X.
  4139         16  CF-ST-RF-LL-CALC               PIC X.
  4140         16  CF-ST-RF-LN-CALC               PIC X.
  4141         16  CF-ST-RF-AH-CALC               PIC X.
  4142         16  CF-ST-RF-CP-CALC               PIC X.
  4143*        16  FILLER                         PIC X(206).
  4144*CIDMOD         16  FILLER                         PIC X(192).
  4145         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4146             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4147         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4148         16  CF-ST-VFY-2ND-BENE             PIC X.
  4149         16  CF-ST-CAUSAL-STATE             PIC X.
  4150         16  FILLER                         PIC X(185).
  4151
  4152****************************************************************
  4153*             BENEFIT MASTER RECORD                            *
  4154****************************************************************
  4155
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  79
* EL130.cbl
  4156     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4157         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4158             20  CF-BENEFIT-CODE            PIC XX.
  4159             20  CF-BENEFIT-NUMERIC  REDEFINES
  4160                 CF-BENEFIT-CODE            PIC XX.
  4161             20  CF-BENEFIT-ALPHA           PIC XXX.
  4162             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4163             20  CF-BENEFIT-COMMENT         PIC X(10).
  4164
  4165             20  CF-LF-COVERAGE-TYPE        PIC X.
  4166                 88  CF-REDUCING                VALUE 'R'.
  4167                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4168
  4169             20  CF-SPECIAL-CALC-CD         PIC X.
  4170                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4171                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4172                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4173                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4174                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4175                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4176                 88  CF-FARM-PLAN               VALUE 'F'.
  4177                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4178                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4179                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4180                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4181                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4182                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4183                 88  CF-PRUDENTIAL              VALUE 'P'.
  4184                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4185                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4186                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4187                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4188                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4189                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4190
  4191             20  CF-JOINT-INDICATOR         PIC X.
  4192                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4193
  4194*            20  FILLER                     PIC X(12).
  4195             20  FILLER                     PIC X(11).
  4196             20  CF-BENEFIT-CATEGORY        PIC X.
  4197             20  CF-LOAN-TYPE               PIC X(8).
  4198
  4199             20  CF-CO-REM-TERM-CALC        PIC X.
  4200                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4201                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4202                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4203                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4204                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4205
  4206             20  CF-CO-EARNINGS-CALC        PIC X.
  4207                 88  CO-EARN-BY-R78             VALUE '1'.
  4208                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4209                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4210                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4211                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4212                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4213                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  80
* EL130.cbl
  4214                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4215
  4216             20  CF-CO-REFUND-CALC          PIC X.
  4217                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4218                 88  CO-REFD-BY-R78             VALUE '1'.
  4219                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4220                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4221                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4222                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4223                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4224                 88  CO-REFD-MEAN               VALUE '8'.
  4225                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4226                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4227                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4228
  4229             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4230                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4231                 88  CO-OVRD-BY-R78             VALUE '1'.
  4232                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4233                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4234                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4235                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4236                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4237                 88  CO-OVRD-MEAN               VALUE '8'.
  4238                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4239
  4240             20  CF-CO-BEN-I-G-CD           PIC X.
  4241                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4242                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4243                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4244
  4245         16  FILLER                         PIC X(304).
  4246
  4247
  4248****************************************************************
  4249*             CARRIER MASTER RECORD                            *
  4250****************************************************************
  4251
  4252     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4253         16  CF-ADDRESS-DATA.
  4254             20  CF-MAIL-TO-NAME            PIC X(30).
  4255             20  CF-IN-CARE-OF              PIC X(30).
  4256             20  CF-ADDRESS-LINE-1          PIC X(30).
  4257             20  CF-ADDRESS-LINE-2          PIC X(30).
  4258             20  CF-CITY-STATE              PIC X(30).
  4259             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4260             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4261
  4262         16  CF-CLAIM-NO-CONTROL.
  4263             20  CF-CLAIM-NO-METHOD         PIC X.
  4264                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4265                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4266                 88  CLAIM-NO-SEQ               VALUE '3'.
  4267                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4268             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4269                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4270                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4271                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  81
* EL130.cbl
  4272
  4273         16  CF-CHECK-NO-CONTROL.
  4274             20  CF-CHECK-NO-METHOD         PIC X.
  4275                 88  CHECK-NO-MANUAL            VALUE '1'.
  4276                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4277                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4278                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4279             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4280                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4281
  4282         16  CF-DOMICILE-STATE              PIC XX.
  4283
  4284         16  CF-EXPENSE-CONTROLS.
  4285             20  CF-EXPENSE-METHOD          PIC X.
  4286                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4287                 88  DOLLARS-PER-PMT            VALUE '2'.
  4288                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4289                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4290             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4291             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4292
  4293         16  CF-CORRESPONDENCE-CONTROL.
  4294             20  CF-LETTER-RESEND-OPT       PIC X.
  4295                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4296                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4297             20  FILLER                     PIC X(4).
  4298
  4299         16  CF-RESERVE-CONTROLS.
  4300             20  CF-MANUAL-SW               PIC X.
  4301                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4302             20  CF-FUTURE-SW               PIC X.
  4303                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4304             20  CF-PTC-SW                  PIC X.
  4305                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4306             20  CF-IBNR-SW                 PIC X.
  4307                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4308             20  CF-PTC-LF-SW               PIC X.
  4309                 88  CF-LF-PTC-USED             VALUE '1'.
  4310             20  CF-CDT-ACCESS-METHOD       PIC X.
  4311                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4312                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4313                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4314             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4315
  4316         16  CF-CLAIM-CALC-METHOD           PIC X.
  4317             88  360-PLUS-MONTHS                VALUE '1'.
  4318             88  365-PLUS-MONTHS                VALUE '2'.
  4319             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4320             88  360-DAILY                      VALUE '4'.
  4321             88  365-DAILY                      VALUE '5'.
  4322
  4323         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4324         16  FILLER                         PIC X(11).
  4325
  4326         16  CF-LIMIT-AMOUNTS.
  4327             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4328             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4329             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  82
* EL130.cbl
  4330             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4331             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4332             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4333             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4334             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4335             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4336             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4337
  4338         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4339         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4340         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4341
  4342         16  CF-ZIP-CODE.
  4343             20  CF-ZIP-PRIME.
  4344                 24  CF-ZIP-1ST             PIC X.
  4345                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4346                 24  FILLER                 PIC X(4).
  4347             20  CF-ZIP-PLUS4               PIC X(4).
  4348         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4349             20  CF-CAN-POSTAL-1            PIC XXX.
  4350             20  CF-CAN-POSTAL-2            PIC XXX.
  4351             20  FILLER                     PIC XXX.
  4352
  4353         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4354         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4355         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4356
  4357         16  CF-RATING-SWITCH               PIC X.
  4358             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4359             88  CF-NO-RATING                   VALUE 'N'.
  4360
  4361         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4362
  4363         16  CF-CARRIER-OVER-SHORT.
  4364             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4365             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4366
  4367         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4368         16  CF-SECPAY-SWITCH               PIC X.
  4369             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4370             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4371         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4372         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4373         16  FILLER                         PIC X(444).
  4374*        16  FILLER                         PIC X(452).
  4375
  4376
  4377****************************************************************
  4378*             MORTALITY MASTER RECORD                          *
  4379****************************************************************
  4380
  4381     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4382         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4383                                INDEXED BY CF-MORT-NDX.
  4384             20  CF-MORT-TABLE              PIC X(5).
  4385             20  CF-MORT-TABLE-TYPE         PIC X.
  4386                 88  CF-MORT-JOINT              VALUE 'J'.
  4387                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  83
* EL130.cbl
  4388                 88  CF-MORT-COMBINED           VALUE 'C'.
  4389                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4390                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4391             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4392             20  CF-MORT-AGE-METHOD         PIC XX.
  4393                 88  CF-AGE-LAST                VALUE 'AL'.
  4394                 88  CF-AGE-NEAR                VALUE 'AN'.
  4395             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4396             20  CF-MORT-ADJUSTMENT-DIRECTION
  4397                                            PIC X.
  4398                 88  CF-MINUS                   VALUE '-'.
  4399                 88  CF-PLUS                    VALUE '+'.
  4400             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4401             20  CF-MORT-JOINT-CODE         PIC X.
  4402                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4403             20  CF-MORT-PC-Q               PIC X.
  4404                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4405             20  CF-MORT-TABLE-CODE         PIC X(4).
  4406             20  CF-MORT-COMMENTS           PIC X(15).
  4407             20  FILLER                     PIC X(14).
  4408
  4409         16  FILLER                         PIC X(251).
  4410
  4411
  4412****************************************************************
  4413*             BUSSINESS TYPE MASTER RECORD                     *
  4414****************************************************************
  4415
  4416     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4417* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4418* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4419* AND RECORD 05 IS TYPES 81-99
  4420         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4421             20  CF-BUSINESS-TITLE          PIC  X(19).
  4422             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4423                                            PIC S9V9(4) COMP-3.
  4424             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4425             20  FILLER                     PIC  X.
  4426         16  FILLER                         PIC  X(248).
  4427
  4428
  4429****************************************************************
  4430*             TERMINAL MASTER RECORD                           *
  4431****************************************************************
  4432
  4433     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4434
  4435         16  CF-COMPANY-TERMINALS.
  4436             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4437                                  PIC X(4).
  4438         16  FILLER               PIC X(248).
  4439
  4440
  4441****************************************************************
  4442*             LIFE EDIT MASTER RECORD                          *
  4443****************************************************************
  4444
  4445     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  84
* EL130.cbl
  4446         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4447             20  CF-LIFE-CODE-IN            PIC XX.
  4448             20  CF-LIFE-CODE-OUT           PIC XX.
  4449         16  FILLER                         PIC X(248).
  4450
  4451
  4452****************************************************************
  4453*             AH EDIT MASTER RECORD                            *
  4454****************************************************************
  4455
  4456     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4457         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4458             20  CF-AH-CODE-IN              PIC XXX.
  4459             20  CF-AH-CODE-OUT             PIC XX.
  4460         16  FILLER                         PIC X(248).
  4461
  4462
  4463****************************************************************
  4464*             CREDIBILITY TABLES                               *
  4465****************************************************************
  4466
  4467     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4468         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4469                             INDEXED BY CF-CRDB-NDX.
  4470             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4471             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4472             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4473         16  FILLER                         PIC  X(332).
  4474
  4475
  4476****************************************************************
  4477*             REPORT CUSTOMIZATION RECORD                      *
  4478****************************************************************
  4479
  4480     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4481         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4482             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4483             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4484             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4485**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4486****       A T-TRANSFER.                                   ****
  4487             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4488
  4489         16  FILLER                         PIC XX.
  4490
  4491         16  CF-CARRIER-CNTL-OPT.
  4492             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4493                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4494                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4495             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4496                                            PIC X.
  4497         16  CF-GROUP-CNTL-OPT.
  4498             20  CF-GROUP-OPT-SEQ           PIC 9.
  4499                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4500                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4501             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4502                                            PIC X(6).
  4503         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  85
* EL130.cbl
  4504             20  CF-STATE-OPT-SEQ           PIC 9.
  4505                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4506                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4507             20  CF-STATE-SELECT OCCURS 3 TIMES
  4508                                            PIC XX.
  4509         16  CF-ACCOUNT-CNTL-OPT.
  4510             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4511                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4512                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4513             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4514                                            PIC X(10).
  4515         16  CF-BUS-TYP-CNTL-OPT.
  4516             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4517                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4518                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4519             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4520                                            PIC XX.
  4521         16  CF-LF-TYP-CNTL-OPT.
  4522             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4523                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4524                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4525             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4526                                            PIC XX.
  4527         16  CF-AH-TYP-CNTL-OPT.
  4528             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4529                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4530                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4531             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4532                                            PIC XX.
  4533         16  CF-REPTCD1-CNTL-OPT.
  4534             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4535                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4536                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4537             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4538                                            PIC X(10).
  4539         16  CF-REPTCD2-CNTL-OPT.
  4540             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4541                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4542                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4543             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4544                                            PIC X(10).
  4545         16  CF-USER1-CNTL-OPT.
  4546             20  CF-USER1-OPT-SEQ           PIC 9.
  4547                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4548                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4549             20  CF-USER1-SELECT OCCURS 3 TIMES
  4550                                            PIC X(10).
  4551         16  CF-USER2-CNTL-OPT.
  4552             20  CF-USER2-OPT-SEQ           PIC 9.
  4553                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4554                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4555             20  CF-USER2-SELECT OCCURS 3 TIMES
  4556                                            PIC X(10).
  4557         16  CF-USER3-CNTL-OPT.
  4558             20  CF-USER3-OPT-SEQ           PIC 9.
  4559                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4560                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4561             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  86
* EL130.cbl
  4562                                            PIC X(10).
  4563         16  CF-USER4-CNTL-OPT.
  4564             20  CF-USER4-OPT-SEQ           PIC 9.
  4565                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4566                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4567             20  CF-USER4-SELECT OCCURS 3 TIMES
  4568                                            PIC X(10).
  4569         16  CF-USER5-CNTL-OPT.
  4570             20  CF-USER5-OPT-SEQ           PIC 9.
  4571                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4572                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4573             20  CF-USER5-SELECT OCCURS 3 TIMES
  4574                                            PIC X(10).
  4575         16  CF-REINS-CNTL-OPT.
  4576             20  CF-REINS-OPT-SEQ           PIC 9.
  4577                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4578                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4579             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4580                 24  CF-REINS-PRIME         PIC XXX.
  4581                 24  CF-REINS-SUB           PIC XXX.
  4582
  4583         16  CF-AGENT-CNTL-OPT.
  4584             20  CF-AGENT-OPT-SEQ           PIC 9.
  4585                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4586                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4587             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4588                                            PIC X(10).
  4589
  4590         16  FILLER                         PIC X(43).
  4591
  4592         16  CF-LOSS-RATIO-SELECT.
  4593             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4594             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4595         16  CF-ENTRY-DATE-SELECT.
  4596             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4597             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4598         16  CF-EFFECTIVE-DATE-SELECT.
  4599             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4600             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4601
  4602         16  CF-EXCEPTION-LIST-IND          PIC X.
  4603             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4604
  4605         16  FILLER                         PIC X(318).
  4606
  4607****************************************************************
  4608*                  EXCEPTION REPORTING RECORD                  *
  4609****************************************************************
  4610
  4611     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4612         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4613             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4614
  4615         16  CF-COMBINED-LIFE-AH-OPT.
  4616             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4617             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4618             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4619             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  87
* EL130.cbl
  4620
  4621         16  CF-LIFE-OPT.
  4622             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4623             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4624             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4625             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4626             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4627             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4628             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4629             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4630             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4631             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4632
  4633         16  CF-AH-OPT.
  4634             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4635             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4636             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4637             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4638             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4639             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4640             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4641             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4642             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4643             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4644
  4645         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4646             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4647             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4648             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4649
  4650         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4651
  4652         16  FILLER                         PIC X(673).
  4653
  4654
  4655****************************************************************
  4656*             MORTGAGE SYSTEM PLAN RECORD                      *
  4657****************************************************************
  4658
  4659     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4660         16  CF-PLAN-TYPE                   PIC X.
  4661             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4662             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4663             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4664         16  CF-PLAN-ABBREV                 PIC XXX.
  4665         16  CF-PLAN-DESCRIPT               PIC X(10).
  4666         16  CF-PLAN-NOTES                  PIC X(20).
  4667         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4668         16  CF-PLAN-UNDERWRITING.
  4669             20  CF-PLAN-TERM-DATA.
  4670                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4671                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4672             20  CF-PLAN-AGE-DATA.
  4673                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4674                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4675                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4676             20  CF-PLAN-BENEFIT-DATA.
  4677                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  88
* EL130.cbl
  4678                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4679                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4680                                            PIC S9(7)V99  COMP-3.
  4681         16  CF-PLAN-POLICY-FORMS.
  4682             20  CF-POLICY-FORM             PIC X(12).
  4683             20  CF-MASTER-APPLICATION      PIC X(12).
  4684             20  CF-MASTER-POLICY           PIC X(12).
  4685         16  CF-PLAN-RATING.
  4686             20  CF-RATE-CODE               PIC X(5).
  4687             20  CF-SEX-RATING              PIC X.
  4688                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4689                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4690             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4691             20  CF-SUB-STD-TYPE            PIC X.
  4692                 88  CF-PCT-OF-PREM            VALUE '1'.
  4693                 88  CF-PCT-OF-BENE            VALUE '2'.
  4694         16  CF-PLAN-PREM-TOLERANCES.
  4695             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4696             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4697         16  CF-PLAN-PYMT-TOLERANCES.
  4698             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4699             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4700         16  CF-PLAN-MISC-DATA.
  4701             20  FILLER                     PIC X.
  4702             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4703             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4704         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4705         16  CF-PLAN-IND-GRP                PIC X.
  4706             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4707                                                     '1'.
  4708             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4709                                                     '2'.
  4710         16  CF-MIB-SEARCH-SW               PIC X.
  4711             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4712             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4713             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4714             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4715         16  CF-ALPHA-SEARCH-SW             PIC X.
  4716             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4717             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4718             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4719             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4720             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4721             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4722             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4723             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4724             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4725             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4726                                                     'A' 'B' 'C'
  4727                                                     'X' 'Y' 'Z'.
  4728         16  CF-EFF-DT-RULE-SW              PIC X.
  4729             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4730             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4731             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4732             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4733             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4734         16  FILLER                         PIC X(4).
  4735         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  89
* EL130.cbl
  4736             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4737         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4738         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4739         16  CF-PLAN-SNGL-JNT               PIC X.
  4740             88  CF-COMBINED-PLAN              VALUE 'C'.
  4741             88  CF-JNT-PLAN                   VALUE 'J'.
  4742             88  CF-SNGL-PLAN                  VALUE 'S'.
  4743         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4744         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4745         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4746         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4747         16  CF-RERATE-CNTL                 PIC  X.
  4748             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4749             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4750             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4751             88  CF-AUTO-RECALC                 VALUE '4'.
  4752         16  CF-BENEFIT-TYPE                PIC  X.
  4753             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4754             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4755         16  CF-POLICY-FEE                  PIC S999V99
  4756                                                    COMP-3.
  4757         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4758         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4759         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4760         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4761         16  FILLER                         PIC  X(32).
  4762         16  CF-TERMINATION-FORM            PIC  X(04).
  4763         16  FILLER                         PIC  X(08).
  4764         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4765                                                       COMP-3.
  4766         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4767         16  CF-ISSUE-LETTER                PIC  X(4).
  4768         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4769         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4770             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4771             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4772         16  CF-MP-REFUND-CALC              PIC X.
  4773             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4774             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4775             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4776             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4777             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4778             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4779             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4780             88  CF-MP-REFD-MEAN                VALUE '8'.
  4781         16  CF-ALT-RATE-CODE               PIC  X(5).
  4782
  4783
  4784         16  FILLER                         PIC X(498).
  4785****************************************************************
  4786*             MORTGAGE COMPANY MASTER RECORD                   *
  4787****************************************************************
  4788
  4789     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4790         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4791         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4792             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4793             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  90
* EL130.cbl
  4794             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4795             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4796             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4797
  4798         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4799         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4800         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4801         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4802         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4803
  4804         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4805             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4806         16  CF-MP-RECON-USE-IND            PIC X(1).
  4807             88  CF-MP-USE-RECON             VALUE 'Y'.
  4808         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4809             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4810         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4811             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4812             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4813         16  FILLER                         PIC X(1).
  4814         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4815             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4816         16  CF-MORTG-MIB-VERSION           PIC X.
  4817             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4818             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4819             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4820         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4821             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4822                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4823             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4824                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4825             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4826                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4827             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4828                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4829             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4830                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4831             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4832                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4833         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4834         16  FILLER                         PIC X(7).
  4835         16  CF-MORTG-DESTINATION-SYMBOL.
  4836             20  CF-MORTG-MIB-COMM          PIC X(5).
  4837             20  CF-MORTG-MIB-TERM          PIC X(5).
  4838         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4839             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4840         16  FILLER                         PIC X(03).
  4841         16  CF-MP-CHECK-NO-CONTROL.
  4842             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4843                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4844                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4845                                                ' ' LOW-VALUES.
  4846                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4847                                               VALUE '3'.
  4848         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4849         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4850         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4851             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  91
* EL130.cbl
  4852                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4853             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4854                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4855             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4856                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4857             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4858                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4859             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4860                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4861             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4862                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4863         16  CF-MORTG-BILLING-AREA.
  4864             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4865                                            PIC X.
  4866         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4867         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4868         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4869         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4870             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4871             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4872         16  FILLER                         PIC X.
  4873         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4874             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4875             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4876         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4877         16  FILLER                         PIC X(8).
  4878         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4879         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4880         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4881         16  CF-ACH-COMPANY-ID.
  4882             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4883                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4884                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4885                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4886             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4887         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4888             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4889         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4890             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4891             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4892         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4893         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4894         16  FILLER                         PIC X(536).
  4895
  4896****************************************************************
  4897*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4898****************************************************************
  4899
  4900     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4901         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4902             20  CF-FEMALE-HEIGHT.
  4903                 24  CF-FEMALE-FT           PIC 99.
  4904                 24  CF-FEMALE-IN           PIC 99.
  4905             20  CF-FEMALE-MIN-WT           PIC 999.
  4906             20  CF-FEMALE-MAX-WT           PIC 999.
  4907         16  FILLER                         PIC X(428).
  4908
  4909     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  92
* EL130.cbl
  4910         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4911             20  CF-MALE-HEIGHT.
  4912                 24  CF-MALE-FT             PIC 99.
  4913                 24  CF-MALE-IN             PIC 99.
  4914             20  CF-MALE-MIN-WT             PIC 999.
  4915             20  CF-MALE-MAX-WT             PIC 999.
  4916         16  FILLER                         PIC X(428).
  4917******************************************************************
  4918*             AUTOMATIC ACTIVITY RECORD                          *
  4919******************************************************************
  4920     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4921         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4922             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4923             20  CF-SYS-LETTER-ID           PIC X(04).
  4924             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4925             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4926             20  CF-SYS-RESET-SW            PIC X(01).
  4927             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4928             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4929
  4930         16  FILLER                         PIC X(50).
  4931
  4932         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4933             20  CF-USER-ACTIVE-SW          PIC X(01).
  4934             20  CF-USER-LETTER-ID          PIC X(04).
  4935             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4936             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4937             20  CF-USER-RESET-SW           PIC X(01).
  4938             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4939             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4940             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4941
  4942         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  93
* EL130.cbl
  4944*    COPY ELCCERT.
  4945******************************************************************
  4946*                                                                *
  4947*                            ELCCERT.                            *
  4948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4949*                            VMOD=2.013                          *
  4950*                                                                *
  4951*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4952*                                                                *
  4953*   FILE TYPE = VSAM,KSDS                                        *
  4954*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4955*                                                                *
  4956*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4957*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4958*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4959*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4960*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4961*                                                                *
  4962*   LOG = YES                                                    *
  4963*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4964******************************************************************
  4965*                   C H A N G E   L O G
  4966*
  4967* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4968*-----------------------------------------------------------------
  4969*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4970* EFFECTIVE    NUMBER
  4971*-----------------------------------------------------------------
  4972* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4973* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4974* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4975* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4976* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4977* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4978* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4979* 032612  CR2011110200001  PEMA  AHL CHANGES
  4980******************************************************************
  4981
  4982 01  CERTIFICATE-MASTER.
  4983     12  CM-RECORD-ID                      PIC XX.
  4984         88  VALID-CM-ID                      VALUE 'CM'.
  4985
  4986     12  CM-CONTROL-PRIMARY.
  4987         16  CM-COMPANY-CD                 PIC X.
  4988         16  CM-CARRIER                    PIC X.
  4989         16  CM-GROUPING.
  4990             20  CM-GROUPING-PREFIX        PIC X(3).
  4991             20  CM-GROUPING-PRIME         PIC X(3).
  4992         16  CM-STATE                      PIC XX.
  4993         16  CM-ACCOUNT.
  4994             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4995             20  CM-ACCOUNT-PRIME          PIC X(6).
  4996         16  CM-CERT-EFF-DT                PIC XX.
  4997         16  CM-CERT-NO.
  4998             20  CM-CERT-PRIME             PIC X(10).
  4999             20  CM-CERT-SFX               PIC X.
  5000
  5001     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  94
* EL130.cbl
  5002         16  CM-COMPANY-CD-A1              PIC X.
  5003         16  CM-INSURED-LAST-NAME          PIC X(15).
  5004         16  CM-INSURED-INITIALS.
  5005             20  CM-INSURED-INITIAL1       PIC X.
  5006             20  CM-INSURED-INITIAL2       PIC X.
  5007
  5008     12  CM-CONTROL-BY-SSN.
  5009         16  CM-COMPANY-CD-A2              PIC X.
  5010         16  CM-SOC-SEC-NO.
  5011             20  CM-SSN-STATE              PIC XX.
  5012             20  CM-SSN-ACCOUNT            PIC X(6).
  5013             20  CM-SSN-LN3.
  5014                 25  CM-INSURED-INITIALS-A2.
  5015                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5016                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5017                 25 CM-PART-LAST-NAME-A2         PIC X.
  5018
  5019     12  CM-CONTROL-BY-CERT-NO.
  5020         16  CM-COMPANY-CD-A4              PIC X.
  5021         16  CM-CERT-NO-A4                 PIC X(11).
  5022
  5023     12  CM-CONTROL-BY-MEMB.
  5024         16  CM-COMPANY-CD-A5              PIC X.
  5025         16  CM-MEMBER-NO.
  5026             20  CM-MEMB-STATE             PIC XX.
  5027             20  CM-MEMB-ACCOUNT           PIC X(6).
  5028             20  CM-MEMB-LN4.
  5029                 25  CM-INSURED-INITIALS-A5.
  5030                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5031                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5032                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5033
  5034     12  CM-INSURED-PROFILE-DATA.
  5035         16  CM-INSURED-FIRST-NAME.
  5036             20  CM-INSURED-1ST-INIT       PIC X.
  5037             20  FILLER                    PIC X(9).
  5038         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5039         16  CM-INSURED-SEX                PIC X.
  5040             88  CM-SEX-MALE                  VALUE 'M'.
  5041             88  CM-SEX-FEMAL                 VALUE 'F'.
  5042         16  CM-INSURED-JOINT-AGE          PIC 99.
  5043         16  CM-JOINT-INSURED-NAME.
  5044             20  CM-JT-LAST-NAME           PIC X(15).
  5045             20  CM-JT-FIRST-NAME.
  5046                 24  CM-JT-1ST-INIT        PIC X.
  5047                 24  FILLER                PIC X(9).
  5048             20  CM-JT-INITIAL             PIC X.
  5049
  5050     12  CM-LIFE-DATA.
  5051         16  CM-LF-BENEFIT-CD              PIC XX.
  5052         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5053         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5054         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5055         16  CM-LF-DEV-CODE                PIC XXX.
  5056         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5057         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5058         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5059         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  95
* EL130.cbl
  5060         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5061         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5062         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5063         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5064         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5065         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5066         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5067         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5068         16  FILLER                        PIC XX.
  5069
  5070     12  CM-AH-DATA.
  5071         16  CM-AH-BENEFIT-CD              PIC XX.
  5072         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5073         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5074         16  CM-AH-DEV-CODE                PIC XXX.
  5075         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5076         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5077         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5078         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5079         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5080         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5081         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5082         16  CM-AH-PAID-THRU-DT            PIC XX.
  5083             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5084         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5085         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5086         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5087         16  FILLER                        PIC X.
  5088
  5089     12  CM-LOAN-INFORMATION.
  5090         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5091         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5092                                           PIC S9(5)V99  COMP-3.
  5093         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5094         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5095         16  CM-PAY-FREQUENCY              PIC S99.
  5096         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5097         16  CM-RATE-CLASS                 PIC XX.
  5098         16  CM-BENEFICIARY                PIC X(25).
  5099         16  CM-POLICY-FORM-NO             PIC X(12).
  5100         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5101         16  CM-LAST-ADD-ON-DT             PIC XX.
  5102         16  CM-DEDUCTIBLE-AMOUNTS.
  5103             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5104             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5105         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5106             20  CM-RESIDENT-STATE         PIC XX.
  5107             20  CM-RATE-CODE              PIC X(4).
  5108             20  FILLER                    PIC XX.
  5109         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5110             20  CM-LOAN-OFFICER           PIC X(5).
  5111             20  FILLER                    PIC XXX.
  5112         16  CM-CSR-CODE                   PIC XXX.
  5113         16  CM-UNDERWRITING-CODE          PIC X.
  5114             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5115         16  CM-POST-CARD-IND              PIC X.
  5116         16  CM-NH-INTERFACE-SW            PIC X.
  5117         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  96
* EL130.cbl
  5118             88  CM-SING-PRM                  VALUE '1'.
  5119             88  CM-O-B-COVERAGE              VALUE '2'.
  5120             88  CM-OPEN-END                  VALUE '3'.
  5121         16  CM-IND-GRP-TYPE               PIC X.
  5122             88  CM-INDIVIDUAL                VALUE 'I'.
  5123             88  CM-GROUP                     VALUE 'G'.
  5124         16  CM-SKIP-CODE                  PIC X.
  5125             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5126             88  SKIP-JULY                    VALUE '1'.
  5127             88  SKIP-AUGUST                  VALUE '2'.
  5128             88  SKIP-SEPTEMBER               VALUE '3'.
  5129             88  SKIP-JULY-AUG                VALUE '4'.
  5130             88  SKIP-AUG-SEPT                VALUE '5'.
  5131             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5132             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5133             88  SKIP-JUNE                    VALUE '8'.
  5134             88  SKIP-JUNE-JULY               VALUE '9'.
  5135             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5136             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5137         16  CM-PAYMENT-MODE               PIC X.
  5138             88  PAY-MONTHLY                  VALUE SPACE.
  5139             88  PAY-WEEKLY                   VALUE '1'.
  5140             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5141             88  PAY-BI-WEEKLY                VALUE '3'.
  5142             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5143         16  CM-LOAN-NUMBER                PIC X(8).
  5144         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5145         16  CM-OLD-LOF                    PIC XXX.
  5146*        16  CM-LOAN-OFFICER               PIC XXX.
  5147         16  CM-REIN-TABLE                 PIC XXX.
  5148         16  CM-SPECIAL-REIN-CODE          PIC X.
  5149         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5150         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5151         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5152
  5153     12  CM-STATUS-DATA.
  5154         16  CM-ENTRY-STATUS               PIC X.
  5155         16  CM-ENTRY-DT                   PIC XX.
  5156
  5157         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5158         16  CM-LF-CANCEL-DT               PIC XX.
  5159         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5160
  5161         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5162         16  CM-LF-DEATH-DT                PIC XX.
  5163         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5164
  5165         16  CM-LF-CURRENT-STATUS          PIC X.
  5166             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5167                                                'M' '4' '5' '9'.
  5168             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5169             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5170             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5171             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5172             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5173             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5174             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5175             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  97
* EL130.cbl
  5176             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5177             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5178             88  CM-LF-DECLINED               VALUE 'D'.
  5179             88  CM-LF-VOIDED                 VALUE 'V'.
  5180
  5181         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5182         16  CM-AH-CANCEL-DT               PIC XX.
  5183         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5184
  5185         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5186         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5187         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5188
  5189         16  CM-AH-CURRENT-STATUS          PIC X.
  5190             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5191                                                'M' '4' '5' '9'.
  5192             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5193             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5194             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5195             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5196             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5197             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5198             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5199             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5200             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5201             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5202             88  CM-AH-DECLINED               VALUE 'D'.
  5203             88  CM-AH-VOIDED                 VALUE 'V'.
  5204
  5205         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5206             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5207             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5208             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5209         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5210
  5211         16  CM-ENTRY-BATCH                PIC X(6).
  5212         16  CM-LF-EXIT-BATCH              PIC X(6).
  5213         16  CM-AH-EXIT-BATCH              PIC X(6).
  5214         16  CM-LAST-MONTH-END             PIC XX.
  5215
  5216     12  CM-NOTE-SW                        PIC X.
  5217         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5218         88  CERT-NOTES-PRESENT               VALUE '1'.
  5219         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5220         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5221         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5222         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5223         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5224         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5225     12  CM-COMP-EXCP-SW                   PIC X.
  5226         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5227         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5228     12  CM-INSURED-ADDRESS-SW             PIC X.
  5229         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5230         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5231
  5232*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5233     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  98
* EL130.cbl
  5234     12  FILLER                            PIC X.
  5235
  5236*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5237     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5238     12  FILLER                            PIC X.
  5239*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5240     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5241
  5242     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5243         88  CERT-ADDED-BATCH                 VALUE ' '.
  5244         88  CERT-ADDED-ONLINE                VALUE '1'.
  5245         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5246         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5247         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5248     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5249         88  CERT-AS-LOADED                   VALUE ' '.
  5250         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5251         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5252         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5253         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5254         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5255         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5256         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5257
  5258     12  CM-ACCOUNT-COMM-PCTS.
  5259         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5260         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5261
  5262     12  CM-USER-FIELD                     PIC X.
  5263     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5264     12  CM-CLP-STATE                      PIC XX.
  5265     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5266     12  CM-USER-RESERVED                  PIC XXX.
  5267     12  FILLER REDEFINES CM-USER-RESERVED.
  5268         16  CM-AH-CLASS-CD                PIC XX.
  5269         16  F                             PIC X.
  5270******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page  99
* EL130.cbl
  5272*    COPY ERCACCT.
  5273******************************************************************
  5274*                                                                *
  5275*                                                                *
  5276*                            ERCACCT                             *
  5277*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5278*                            VMOD=2.031                          *
  5279*                                                                *
  5280*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5281*                                                                *
  5282*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5283*   VSAM ACCOUNT MASTER FILES.                                   *
  5284*                                                                *
  5285*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5286*                                                                *
  5287*   FILE TYPE = VSAM,KSDS                                        *
  5288*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5289*                                                                *
  5290*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5291*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5292*                                                                *
  5293*   LOG = NO                                                     *
  5294*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5295*                                                                *
  5296*                                                                *
  5297******************************************************************
  5298*                   C H A N G E   L O G
  5299*
  5300* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5301*-----------------------------------------------------------------
  5302*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5303* EFFECTIVE    NUMBER
  5304*-----------------------------------------------------------------
  5305* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5306* 092705    2005050300006  PEMA  ADD SPP LEASES
  5307* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5308* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5309* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5310* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5311* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5312******************************************************************
  5313
  5314 01  ACCOUNT-MASTER.
  5315     12  AM-RECORD-ID                      PIC XX.
  5316         88  VALID-AM-ID                      VALUE 'AM'.
  5317
  5318     12  AM-CONTROL-PRIMARY.
  5319         16  AM-COMPANY-CD                 PIC X.
  5320         16  AM-MSTR-CNTRL.
  5321             20  AM-CONTROL-A.
  5322                 24  AM-CARRIER            PIC X.
  5323                 24  AM-GROUPING.
  5324                     28 AM-GROUPING-PREFIX PIC XXX.
  5325                     28 AM-GROUPING-PRIME  PIC XXX.
  5326                 24  AM-STATE              PIC XX.
  5327                 24  AM-ACCOUNT.
  5328                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5329                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 100
* EL130.cbl
  5330             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5331                                           PIC X(19).
  5332             20  AM-CNTRL-B.
  5333                 24  AM-EXPIRATION-DT      PIC XX.
  5334                 24  FILLER                PIC X(4).
  5335             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5336                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5337
  5338     12  AM-CONTROL-BY-VAR-GRP.
  5339         16  AM-COMPANY-CD-A1              PIC X.
  5340         16  AM-VG-CARRIER                 PIC X.
  5341         16  AM-VG-GROUPING                PIC X(6).
  5342         16  AM-VG-STATE                   PIC XX.
  5343         16  AM-VG-ACCOUNT                 PIC X(10).
  5344         16  AM-VG-DATE.
  5345             20  AM-VG-EXPIRATION-DT       PIC XX.
  5346             20  FILLER                    PIC X(4).
  5347         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5348                                           PIC 9(11)      COMP-3.
  5349     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5350         16  FILLER                        PIC X(10).
  5351         16  AM-VG-KEY3.
  5352             20  AM-VG3-ACCOUNT            PIC X(10).
  5353             20  AM-VG3-EXP-DT             PIC XX.
  5354         16  FILLER                        PIC X(4).
  5355     12  AM-MAINT-INFORMATION.
  5356         16  AM-LAST-MAINT-DT              PIC XX.
  5357         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5358         16  AM-LAST-MAINT-USER            PIC X(4).
  5359         16  FILLER                        PIC XX.
  5360
  5361     12  AM-EFFECTIVE-DT                   PIC XX.
  5362     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5363
  5364     12  AM-PREV-DATES  COMP-3.
  5365         16  AM-PREV-EXP-DT                PIC 9(11).
  5366         16  AM-PREV-EFF-DT                PIC 9(11).
  5367
  5368     12  AM-REPORT-CODE-1                  PIC X(10).
  5369     12  AM-REPORT-CODE-2                  PIC X(10).
  5370
  5371     12  AM-CITY-CODE                      PIC X(4).
  5372     12  AM-COUNTY-PARISH                  PIC X(6).
  5373
  5374     12  AM-NAME                           PIC X(30).
  5375     12  AM-PERSON                         PIC X(30).
  5376     12  AM-ADDRS                          PIC X(30).
  5377     12  AM-CITY.
  5378         16  AM-ADDR-CITY                  PIC X(28).
  5379         16  AM-ADDR-STATE                 PIC XX.
  5380     12  AM-ZIP.
  5381         16  AM-ZIP-PRIME.
  5382             20  AM-ZIP-PRI-1ST            PIC X.
  5383                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5384             20  FILLER                    PIC X(4).
  5385         16  AM-ZIP-PLUS4                  PIC X(4).
  5386     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5387         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 101
* EL130.cbl
  5388         16  AM-CAN-POSTAL-2               PIC XXX.
  5389         16  FILLER                        PIC XXX.
  5390     12  AM-TEL-NO.
  5391         16  AM-AREA-CODE                  PIC 999.
  5392         16  AM-TEL-PRE                    PIC 999.
  5393         16  AM-TEL-NBR                    PIC 9(4).
  5394     12  AM-TEL-LOC                        PIC X.
  5395         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5396         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5397
  5398     12  AM-COMM-STRUCTURE.
  5399         16  AM-DEFN-1.
  5400             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5401                 24  AM-AGT.
  5402                     28  AM-AGT-PREFIX     PIC X(4).
  5403                     28  AM-AGT-PRIME      PIC X(6).
  5404                 24  AM-COM-TYP            PIC X.
  5405                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5406                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5407                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5408                 24  AM-RECALC-LV-INDIC    PIC X.
  5409                 24  AM-RETRO-LV-INDIC     PIC X.
  5410                 24  AM-GL-CODES           PIC X.
  5411                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5412                 24  FILLER                PIC X(01).
  5413         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5414             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5415                 24  FILLER                PIC X(11).
  5416                 24  AM-L-COMA             PIC XXX.
  5417                 24  AM-J-COMA             PIC XXX.
  5418                 24  AM-A-COMA             PIC XXX.
  5419                 24  FILLER                PIC X(6).
  5420
  5421     12  AM-COMM-CHANGE-STATUS             PIC X.
  5422         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5423
  5424     12  AM-CSR-CODE                       PIC X(4).
  5425
  5426     12  AM-BILLING-STATUS                 PIC X.
  5427         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5428         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5429     12  AM-AUTO-REFUND-SW                 PIC X.
  5430         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5431         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5432     12  AM-GPCD                           PIC 99.
  5433     12  AM-IG                             PIC X.
  5434         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5435         88  AM-HAS-GROUP                     VALUE '2'.
  5436     12  AM-STATUS                         PIC X.
  5437         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5438         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5439         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5440         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5441         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5442         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5443     12  AM-REMIT-TO                       PIC 99.
  5444     12  AM-ID-NO                          PIC X(11).
  5445
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 102
* EL130.cbl
  5446     12  AM-CAL-TABLE                      PIC XX.
  5447     12  AM-LF-DEVIATION                   PIC XXX.
  5448     12  AM-AH-DEVIATION                   PIC XXX.
  5449     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5450     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5451     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5452     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5453     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5454     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5455
  5456     12  AM-USER-FIELDS.
  5457         16  AM-FLD-1                      PIC XX.
  5458         16  AM-FLD-2                      PIC XX.
  5459         16  AM-FLD-3                      PIC XX.
  5460         16  AM-FLD-4                      PIC XX.
  5461         16  AM-FLD-5                      PIC XX.
  5462
  5463     12  AM-1ST-PROD-DATE.
  5464         16  AM-1ST-PROD-YR                PIC XX.
  5465         16  AM-1ST-PROD-MO                PIC XX.
  5466         16  AM-1ST-PROD-DA                PIC XX.
  5467     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5468     12  AM-CERTS-PURGED-DATE.
  5469         16  AM-PUR-YR                     PIC XX.
  5470         16  AM-PUR-MO                     PIC XX.
  5471         16  AM-PUR-DA                     PIC XX.
  5472     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5473     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5474     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5475     12  AM-INACTIVE-DATE.
  5476         16  AM-INA-MO                     PIC 99.
  5477         16  AM-INA-DA                     PIC 99.
  5478         16  AM-INA-YR                     PIC 99.
  5479     12  AM-AR-HI-CERT-DATE                PIC XX.
  5480
  5481     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5482     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5483
  5484     12  AM-OB-PAYMENT-MODE                PIC X.
  5485         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5486         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5487         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5488         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5489
  5490     12  AM-AH-ONLY-INDICATOR              PIC X.
  5491         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5492         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5493
  5494     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5495
  5496     12  AM-OVER-SHORT.
  5497         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5498         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5499
  5500     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5501     12  AM-DCC-CLP-STATE                  PIC XX.
  5502
  5503     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 103
* EL130.cbl
  5504     12  AM-RECALC-REIN                    PIC X.
  5505
  5506     12  AM-REI-TABLE                      PIC XXX.
  5507     12  AM-REI-ET-LF                      PIC X.
  5508     12  AM-REI-ET-AH                      PIC X.
  5509     12  AM-REI-PE-LF                      PIC X.
  5510     12  AM-REI-PE-AH                      PIC X.
  5511     12  AM-REI-PRT-ST                     PIC X.
  5512     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5513     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5514     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5515     12  AM-REI-GROUP-A                    PIC X(6).
  5516     12  AM-REI-MORT                       PIC X(4).
  5517     12  AM-REI-PRT-OW                     PIC X.
  5518     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5519     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5520     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5521     12  AM-REI-GROUP-B                    PIC X(6).
  5522
  5523     12  AM-TRUST-TYPE                     PIC X(2).
  5524
  5525     12  AM-EMPLOYER-STMT-USED             PIC X.
  5526     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5527
  5528     12  AM-STD-AH-TYPE                    PIC XX.
  5529     12  AM-EARN-METHODS.
  5530         16  AM-EARN-METHOD-R              PIC X.
  5531             88 AM-REF-RL-R78                 VALUE 'R'.
  5532             88 AM-REF-RL-PR                  VALUE 'P'.
  5533             88 AM-REF-RL-MEAN                VALUE 'M'.
  5534             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5535         16  AM-EARN-METHOD-L              PIC X.
  5536             88 AM-REF-LL-R78                 VALUE 'R'.
  5537             88 AM-REF-LL-PR                  VALUE 'P'.
  5538             88 AM-REF-LL-MEAN                VALUE 'M'.
  5539             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5540         16  AM-EARN-METHOD-A              PIC X.
  5541             88 AM-REF-AH-R78                 VALUE 'R'.
  5542             88 AM-REF-AH-PR                  VALUE 'P'.
  5543             88 AM-REF-AH-MEAN                VALUE 'M'.
  5544             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5545             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5546             88 AM-REF-AH-NET                 VALUE 'N'.
  5547
  5548     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5549     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5550     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5551
  5552     12  AM-RET-Y-N                        PIC X.
  5553     12  AM-RET-P-E                        PIC X.
  5554     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5555     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5556     12  AM-RET-GRP                        PIC X(6).
  5557     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5558         16  AM-POOL-PRIME                 PIC XXX.
  5559         16  AM-POOL-SUB                   PIC XXX.
  5560     12  AM-RETRO-EARNINGS.
  5561         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 104
* EL130.cbl
  5562         16  AM-RET-EARN-L                 PIC X.
  5563         16  AM-RET-EARN-A                 PIC X.
  5564     12  AM-RET-ST-TAX-USE                 PIC X.
  5565         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5566         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5567     12  AM-RETRO-BEG-EARNINGS.
  5568         16  AM-RET-BEG-EARN-R             PIC X.
  5569         16  AM-RET-BEG-EARN-L             PIC X.
  5570         16  AM-RET-BEG-EARN-A             PIC X.
  5571     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5572     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5573
  5574     12  AM-USER-SELECT-OPTIONS.
  5575         16  AM-USER-SELECT-1              PIC X(10).
  5576         16  AM-USER-SELECT-2              PIC X(10).
  5577         16  AM-USER-SELECT-3              PIC X(10).
  5578         16  AM-USER-SELECT-4              PIC X(10).
  5579         16  AM-USER-SELECT-5              PIC X(10).
  5580
  5581     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5582
  5583     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5584
  5585     12  AM-RPT045A-SWITCH                 PIC X.
  5586         88  RPT045A-OFF                   VALUE 'N'.
  5587
  5588     12  AM-INSURANCE-LIMITS.
  5589         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5590         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5591
  5592     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5593         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5594
  5595     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5596         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5597         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5598
  5599     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5600
  5601     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5602     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5603     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5604     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5605     12  AM-DCC-UEF-STATE                  PIC XX.
  5606     12  FILLER                            PIC XXX.
  5607     12  AM-REPORT-CODE-3                  PIC X(10).
  5608*    12  FILLER                            PIC X(22).
  5609
  5610     12  AM-RESERVE-DATE.
  5611         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5612         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5613         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5614
  5615     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5616     12  AM-NOTIFICATION-TYPES.
  5617         16  AM-NOTIF-OF-LETTERS           PIC X.
  5618         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5619         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 105
* EL130.cbl
  5620         16  AM-NOTIF-OF-STATUS            PIC X.
  5621
  5622     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5623         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5624         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5625         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5626         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5627
  5628     12  AM-BENEFIT-CONTROLS.
  5629         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5630             20  AM-BENEFIT-CODE           PIC XX.
  5631             20  AM-BENEFIT-TYPE           PIC X.
  5632             20  AM-BENEFIT-REVISION       PIC XXX.
  5633             20  AM-BENEFIT-REM-TERM       PIC X.
  5634             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5635             20  FILLER                    PIC XX.
  5636         16  FILLER                        PIC X(80).
  5637
  5638     12  AM-TRANSFER-DATA.
  5639         16  AM-TRANSFERRED-FROM.
  5640             20  AM-TRNFROM-CARRIER        PIC X.
  5641             20  AM-TRNFROM-GROUPING.
  5642                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5643                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5644             20  AM-TRNFROM-STATE          PIC XX.
  5645             20  AM-TRNFROM-ACCOUNT.
  5646                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5647                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5648             20  AM-TRNFROM-DTE            PIC XX.
  5649         16  AM-TRANSFERRED-TO.
  5650             20  AM-TRNTO-CARRIER          PIC X.
  5651             20  AM-TRNTO-GROUPING.
  5652                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5653                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5654             20  AM-TRNTO-STATE            PIC XX.
  5655             20  AM-TRNTO-ACCOUNT.
  5656                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5657                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5658             20  AM-TRNTO-DTE              PIC XX.
  5659         16  FILLER                        PIC X(10).
  5660
  5661     12  AM-SAVED-REMIT-TO                 PIC 99.
  5662
  5663     12  AM-COMM-STRUCTURE-SAVED.
  5664         16  AM-DEFN-1-SAVED.
  5665             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5666                 24  AM-AGT-SV             PIC X(10).
  5667                 24  AM-COM-TYP-SV         PIC X.
  5668                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5669                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5670                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5671                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5672                 24  FILLER                PIC X.
  5673                 24  AM-GL-CODES-SV        PIC X.
  5674                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5675                 24  FILLER                PIC X.
  5676         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5677             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 106
* EL130.cbl
  5678                 24  FILLER                PIC X(11).
  5679                 24  AM-L-COMA-SV          PIC XXX.
  5680                 24  AM-J-COMA-SV          PIC XXX.
  5681                 24  AM-A-COMA-SV          PIC XXX.
  5682                 24  FILLER                PIC X(6).
  5683
  5684     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5685         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5686            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5687            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5688            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5689
  5690     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5691     12  FILLER                            PIC X(120).
  5692
  5693     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5694         16  AM-CONTROL-NAME               PIC X(30).
  5695         16  AM-EXECUTIVE-ONE.
  5696             20  AM-EXEC1-NAME             PIC X(15).
  5697             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5698                                                          COMP-3.
  5699             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5700                                                          COMP-3.
  5701         16  AM-EXECUTIVE-TWO.
  5702             20  AM-EXEC2-NAME             PIC X(15).
  5703             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5704                                                          COMP-3.
  5705             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5706                                                          COMP-3.
  5707
  5708     12  AM-RETRO-ADDITIONAL-DATA.
  5709         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5710         16  AM-RETRO-PREM-P-E             PIC X.
  5711         16  AM-RETRO-CLMS-P-I             PIC X.
  5712         16  AM-RETRO-RET-BRACKET-LF.
  5713             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5714                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5715                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5716             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5717                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5718                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5719             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5720                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5721                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5722         16  AM-RETRO-RET-BRACKET-AH.
  5723             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5724                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5725                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5726                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5727             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5728                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5729                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5730             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5731                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5732                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5733
  5734     12  AM-COMMENTS.
  5735         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 107
* EL130.cbl
  5736
  5737     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5738         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5739         16  AM-FLI-BILLING-CODE           PIC X.
  5740         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5741         16  AM-FLI-UNITED-IDENT           PIC X.
  5742         16  AM-FLI-INTEREST-LOST-DATA.
  5743             20  AM-FLI-BANK-NO            PIC X(5).
  5744             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5745             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5746             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5747         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5748             20  AM-FLI-AGT                PIC X(9).
  5749             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5750             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5751         16  FILLER                        PIC X(102).
  5752
  5753     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5754         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5755             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5756             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5757             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5758             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5759             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5760         16  FILLER                          PIC X(10).
  5761******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 108
* EL130.cbl
  5763*    COPY ELCTRLR.
  5764******************************************************************
  5765*                                                                *
  5766*                            ELCTRLR.                            *
  5767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5768*                            VMOD=2.014                          *
  5769*                                                                *
  5770*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5771*                                                                *
  5772*   FILE TYPE = VSAM,KSDS                                        *
  5773*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5774*                                                                *
  5775*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5776*       ALTERNATE INDEX = NONE                                   *
  5777*                                                                *
  5778*   LOG = YES                                                    *
  5779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5780******************************************************************
  5781*                   C H A N G E   L O G
  5782*
  5783* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5784*-----------------------------------------------------------------
  5785*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5786* EFFECTIVE    NUMBER
  5787*-----------------------------------------------------------------
  5788* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5789* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5790* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5791* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5792* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5793* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5794* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5795* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5796* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5797* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5798* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5799* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5800* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5801* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5802* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5803* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5804******************************************************************
  5805 01  ACTIVITY-TRAILERS.
  5806     12  AT-RECORD-ID                    PIC XX.
  5807         88  VALID-AT-ID                       VALUE 'AT'.
  5808
  5809     12  AT-CONTROL-PRIMARY.
  5810         16  AT-COMPANY-CD               PIC X.
  5811         16  AT-CARRIER                  PIC X.
  5812         16  AT-CLAIM-NO                 PIC X(7).
  5813         16  AT-CERT-NO.
  5814             20  AT-CERT-PRIME           PIC X(10).
  5815             20  AT-CERT-SFX             PIC X.
  5816         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5817             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5818             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5819             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5820             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 109
* EL130.cbl
  5821             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5822             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5823             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5824             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5825             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5826             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5827             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5828             88  AT-BENEFICIARY-TRL           VALUE +91.
  5829             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5830             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5831             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5832             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5833
  5834     12  AT-TRAILER-TYPE                 PIC X.
  5835         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5836         88  PAYMENT-TR                       VALUE '2'.
  5837         88  AUTO-PAY-TR                      VALUE '3'.
  5838         88  CORRESPONDENCE-TR                VALUE '4'.
  5839         88  ADDRESS-TR                       VALUE '5'.
  5840         88  GENERAL-INFO-TR                  VALUE '6'.
  5841         88  AUTO-PROMPT-TR                   VALUE '7'.
  5842         88  DENIAL-TR                        VALUE '8'.
  5843         88  INCURRED-CHG-TR                  VALUE '9'.
  5844         88  FORM-CONTROL-TR                  VALUE 'A'.
  5845
  5846     12  AT-RECORDED-DT                  PIC XX.
  5847     12  AT-RECORDED-BY                  PIC X(4).
  5848     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5849
  5850     12  AT-TRAILER-BODY                 PIC X(165).
  5851
  5852     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5853         16  AT-RESERVE-CONTROLS.
  5854             20  AT-MANUAL-SW            PIC X.
  5855                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5856             20  AT-FUTURE-SW            PIC X.
  5857                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5858             20  AT-PTC-SW               PIC X.
  5859                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5860             20  AT-IBNR-SW              PIC X.
  5861                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5862             20  AT-PTC-LF-SW            PIC X.
  5863                 88  AT-LF-PTC-USED          VALUE '1'.
  5864             20  AT-CDT-ACCESS-METHOD    PIC X.
  5865                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5866                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5867                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5868             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5869         16  AT-LAST-COMPUTED-DT         PIC XX.
  5870         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5871         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5872         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5873         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5874         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5875         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5876         16  AT-EXPENSE-CONTROLS.
  5877             20  AT-EXPENSE-METHOD       PIC X.
  5878                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 110
* EL130.cbl
  5879                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5880                 88  PERCENT-OF-PMT           VALUE '3'.
  5881                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5882             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5883             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5884         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5885         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5886
  5887         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5888         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5889
  5890*        16  FILLER                      PIC X(53).
  5891         16  FILLER                      PIC X(47).
  5892
  5893         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5894         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5895
  5896         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5897             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5898             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5899*                    C = CLOSED
  5900*                    O = OPEN
  5901             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5902*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5903
  5904     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5905         16  AT-PAYMENT-TYPE             PIC X.
  5906             88  PARTIAL-PAYMENT                VALUE '1'.
  5907             88  FINAL-PAYMENT                  VALUE '2'.
  5908             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5909             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5910             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5911             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5912             88  VOIDED-PAYMENT                 VALUE '9'.
  5913             88  TRANSFER                       VALUE 'T'.
  5914             88  LIFE-INTEREST                  VALUE 'I'.
  5915
  5916         16  AT-CLAIM-TYPE               PIC X.
  5917             88  PAID-FOR-AH                    VALUE 'A'.
  5918             88  PAID-FOR-LIFE                  VALUE 'L'.
  5919             88  PAID-FOR-IUI                   VALUE 'I'.
  5920             88  PAID-FOR-GAP                   VALUE 'G'.
  5921         16  AT-CLAIM-PREM-TYPE          PIC X.
  5922             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5923             88  AT-O-B-COVERAGE                VALUE '2'.
  5924             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5925         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5926         16  AT-CHECK-NO                 PIC X(7).
  5927         16  AT-PAID-FROM-DT             PIC XX.
  5928         16  AT-PAID-THRU-DT             PIC XX.
  5929         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5930         16  FILLER                      PIC X.
  5931         16  AT-PAYEES-NAME              PIC X(30).
  5932         16  AT-PAYMENT-ORIGIN           PIC X.
  5933             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5934             88  ONLINE-AUTO-PMT                VALUE '2'.
  5935             88  OFFLINE-PMT                    VALUE '3'.
  5936         16  AT-CHECK-WRITTEN-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 111
* EL130.cbl
  5937         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5938         16  AT-VOID-DATA.
  5939             20  AT-VOID-DT              PIC XX.
  5940*00144       20  AT-VOID-REASON          PIC X(30).
  5941             20  AT-VOID-REASON          PIC X(26).
  5942         16  AT-PMT-APPROVED-BY          PIC X(04).
  5943         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5944         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5945         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5946                                         PIC S99V9(5)  COMP-3.
  5947         16  AT-CREDIT-INTERFACE.
  5948             20  AT-PMT-SELECT-DT        PIC XX.
  5949                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5950             20  AT-PMT-ACCEPT-DT        PIC XX.
  5951                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5952             20  AT-VOID-SELECT-DT       PIC XX.
  5953                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5954             20  AT-VOID-ACCEPT-DT       PIC XX.
  5955                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5956
  5957         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5958                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5959                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5960         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5961
  5962         16  AT-FORCE-CONTROL            PIC X.
  5963             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5964         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5965         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5966         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5967         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5968         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5969         16  AT-BENEFIT-TYPE             PIC X.
  5970
  5971         16  AT-EXPENSE-TYPE             PIC X.
  5972         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5973
  5974         16  AT-PAYEE-TYPE-CD.
  5975             20  AT-PAYEE-TYPE           PIC X.
  5976                 88  INSURED-PAID           VALUE 'I'.
  5977                 88  BENEFICIARY-PAID       VALUE 'B'.
  5978                 88  ACCOUNT-PAID           VALUE 'A'.
  5979                 88  OTHER-1-PAID           VALUE 'O'.
  5980                 88  OTHER-2-PAID           VALUE 'Q'.
  5981                 88  DOCTOR-PAID            VALUE 'P'.
  5982                 88  EMPLOYER-PAID          VALUE 'E'.
  5983             20  AT-PAYEE-SEQ            PIC X.
  5984
  5985         16  AT-CASH-PAYMENT             PIC X.
  5986         16  AT-GROUPED-PAYMENT          PIC X.
  5987         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5988         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5989         16  AT-APPROVED-LEVEL           PIC X.
  5990         16  AT-VOID-TYPE                PIC X.
  5991             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5992             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5993         16  AT-AIG-UNEMP-IND            PIC X.
  5994             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 112
* EL130.cbl
  5995         16  AT-ASSOCIATES               PIC X.
  5996             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5997             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5998
  5999         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6000         16  AT-CV-PMT-CODE              PIC X.
  6001             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6002             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6003             88  FULL-ADD-PAYMENT           VALUE '3'.
  6004             88  HALF-ADD-PAYMENT           VALUE '4'.
  6005             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6006             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6007             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6008             88  ADDL-PAYMENT               VALUE '8'.
  6009
  6010         16  AT-EOB-CODE1                PIC XXX.
  6011         16  AT-EOB-CODE2                PIC XXX.
  6012         16  AT-EOB-CODE3                PIC XXX.
  6013         16  FILLER REDEFINES AT-EOB-CODE3.
  6014             20  AT-PRINT-CLM-FORM       PIC X.
  6015             20  AT-PRINT-SURVEY         PIC X.
  6016             20  FILLER                  PIC X.
  6017         16  AT-EOB-CODE4                PIC XXX.
  6018         16  FILLER REDEFINES AT-EOB-CODE4.
  6019             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6020             20  FILLER                  PIC X.
  6021         16  AT-EOB-CODE5                PIC XXX.
  6022         16  FILLER REDEFINES AT-EOB-CODE5.
  6023             20  AT-PMT-PROOF-DT         PIC XX.
  6024             20  FILLER                  PIC X.
  6025
  6026         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6027             88  AT-PRINT-EOB            VALUE 'Y'.
  6028
  6029         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6030         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6031
  6032     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6033         16  AT-SCHEDULE-START-DT        PIC XX.
  6034         16  AT-SCHEDULE-END-DT          PIC XX.
  6035         16  AT-TERMINATED-DT            PIC XX.
  6036         16  AT-LAST-PMT-TYPE            PIC X.
  6037             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6038             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6039         16  AT-FIRST-PMT-DATA.
  6040             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6041             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6042             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6043         16  AT-REGULAR-PMT-DATA.
  6044             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6045             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6046             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6047         16  AT-AUTO-PAYEE-CD.
  6048             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6049                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6050                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6051                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6052                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 113
* EL130.cbl
  6053                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6054             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6055         16  AT-AUTO-PAY-DAY             PIC 99.
  6056         16  AT-AUTO-CASH                PIC X.
  6057             88  AT-CASH                      VALUE 'Y'.
  6058             88  AT-NON-CASH                  VALUE 'N'.
  6059*        16  FILLER                      PIC X(129).
  6060         16  AT-AUTO-END-LETTER          PIC X(4).
  6061         16  FILLER                      PIC X(125).
  6062
  6063         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6064         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6065
  6066     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6067         16  AT-LETTER-SENT-DT           PIC XX.
  6068         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6069         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6070         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6071         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6072         16  AT-LETTER-ORIGIN            PIC X.
  6073             88  ONLINE-CREATION              VALUE '1' '3'.
  6074             88  OFFLINE-CREATION             VALUE '2' '4'.
  6075             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6076             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6077         16  AT-STD-LETTER-FORM          PIC X(4).
  6078         16  AT-REASON-TEXT              PIC X(70).
  6079         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6080         16  AT-ADDRESEE-TYPE            PIC X.
  6081              88  INSURED-ADDRESEE            VALUE 'I'.
  6082              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6083              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6084              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6085              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6086              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6087              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6088         16  AT-ADDRESSEE-NAME           PIC X(30).
  6089         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6090         16  AT-RESEND-PRINT-DATE        PIC XX.
  6091         16  AT-CORR-SOL-UNSOL           PIC X.
  6092         16  AT-LETTER-PURGED-DT         PIC XX.
  6093*
  6094*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6095*
  6096         16  AT-CSO-REDEFINITION.
  6097             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6098             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6099             20  AT-LETTER-TO-BENE       PIC X(1).
  6100             20  AT-STOP-LETTER-DT       PIC X(2).
  6101             20  FILLER                  PIC X(19).
  6102*             20  FILLER                  PIC X(27).
  6103             20  AT-CSO-LETTER-STATUS    PIC X.
  6104                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6105                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6106                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6107             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6108             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6109*
  6110*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 114
* EL130.cbl
  6111*
  6112*        16  FILLER                      PIC X(26).
  6113*
  6114*        16  AT-DMD-BSR-CODE             PIC X.
  6115*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6116*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6117*
  6118*        16  AT-DMD-LETTER-STATUS        PIC X.
  6119*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6120*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6121*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6122*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6123*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6124
  6125         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6126         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6127
  6128     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6129         16  AT-ADDRESS-TYPE             PIC X.
  6130             88  INSURED-ADDRESS               VALUE 'I'.
  6131             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6132             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6133             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6134             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6135             88  OTHER-ADDRESS-1               VALUE 'O'.
  6136             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6137         16  AT-MAIL-TO-NAME             PIC X(30).
  6138         16  AT-ADDRESS-LINE-1           PIC X(30).
  6139         16  AT-ADDRESS-LINE-2           PIC X(30).
  6140         16  AT-CITY-STATE.
  6141             20  AT-CITY                 PIC X(28).
  6142             20  AT-STATE                PIC XX.
  6143         16  AT-ZIP.
  6144             20  AT-ZIP-CODE.
  6145                 24  AT-ZIP-1ST          PIC X.
  6146                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6147                 24  FILLER              PIC X(4).
  6148             20  AT-ZIP-PLUS4            PIC X(4).
  6149         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6150             20  AT-CAN-POSTAL-1         PIC XXX.
  6151             20  AT-CAN-POSTAL-2         PIC XXX.
  6152             20  FILLER                  PIC XXX.
  6153         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6154*         16  FILLER                      PIC X(23).
  6155         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6156         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6157         16  FILLER                      PIC X(13).
  6158         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6159         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6160
  6161     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6162         16  AT-INFO-LINE-1              PIC X(60).
  6163         16  FILLER REDEFINES AT-INFO-LINE-1.
  6164             20  AT-NOTE-ERROR-NO OCCURS 15
  6165                                         PIC X(4).
  6166         16  AT-INFO-LINE-2              PIC X(60).
  6167         16  AT-INFO-TRAILER-TYPE        PIC X.
  6168             88  AT-ERRORS-NOTE          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 115
* EL130.cbl
  6169             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6170             88  AT-CALL-NOTE            VALUE 'C'.
  6171             88  AT-MAINT-NOTE           VALUE 'M'.
  6172             88  AT-CERT-CHANGE          VALUE 'X'.
  6173             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6174             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6175         16  AT-CALL-TYPE                PIC X.
  6176             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6177             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6178         16  AT-NOTE-CONTINUATION        PIC X.
  6179             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6180         16  AT-EOB-CODES-EXIST          PIC X.
  6181             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6182         16  FILLER                      PIC X(35).
  6183         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6184         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6185
  6186     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6187         16  AT-PROMPT-LINE-1            PIC X(60).
  6188         16  AT-PROMPT-LINE-2            PIC X(60).
  6189         16  AT-PROMPT-START-DT          PIC XX.
  6190         16  AT-PROMPT-END-DT            PIC XX.
  6191         16  FILLER                      PIC X(35).
  6192         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6193         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6194
  6195     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6196         16  AT-DENIAL-INFO-1            PIC X(60).
  6197         16  AT-DENIAL-INFO-2            PIC X(60).
  6198         16  AT-DENIAL-DT                PIC XX.
  6199         16  AT-RETRACTION-DT            PIC XX.
  6200         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6201*         16  FILLER                      PIC X(31).
  6202         16  AT-DENIAL-PROOF-DT          PIC XX.
  6203         16  FILLER                      PIC X(29).
  6204         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6205         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6206
  6207     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6208         16  AT-OLD-INCURRED-DT          PIC XX.
  6209         16  AT-OLD-REPORTED-DT          PIC XX.
  6210         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6211         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6212         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6213         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6214         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6215         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6216         16  FILLER                      PIC X(26).
  6217         16  AT-OLD-DIAG-CODE            PIC X(6).
  6218         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6219         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6220         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6221         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6222         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6223         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6224         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6225         16  FILLER                      PIC X(25).
  6226         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 116
* EL130.cbl
  6227
  6228     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6229         16  AT-FORM-SEND-ON-DT          PIC XX.
  6230         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6231         16  AT-FORM-RE-SEND-DT          PIC XX.
  6232         16  AT-FORM-ANSWERED-DT         PIC XX.
  6233         16  AT-FORM-PRINTED-DT          PIC XX.
  6234         16  AT-FORM-REPRINT-DT          PIC XX.
  6235         16  AT-FORM-TYPE                PIC X.
  6236             88  INITIAL-FORM                  VALUE '1'.
  6237             88  PROGRESS-FORM                 VALUE '2'.
  6238         16  AT-INSTRUCT-LN-1            PIC X(28).
  6239         16  AT-INSTRUCT-LN-2            PIC X(28).
  6240         16  AT-INSTRUCT-LN-3            PIC X(28).
  6241         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6242         16  AT-FORM-ADDRESS             PIC X.
  6243             88  FORM-TO-INSURED              VALUE 'I'.
  6244             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6245             88  FORM-TO-OTHER-1              VALUE 'O'.
  6246             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6247         16  AT-RELATED-1.
  6248             20 AT-REL-CARR-1            PIC X.
  6249             20 AT-REL-CLAIM-1           PIC X(7).
  6250             20 AT-REL-CERT-1            PIC X(11).
  6251         16  AT-RELATED-2.
  6252             20 AT-REL-CARR-2            PIC X.
  6253             20 AT-REL-CLAIM-2           PIC X(7).
  6254             20 AT-REL-CERT-2            PIC X(11).
  6255         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6256         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6257         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6258         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6259         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6260         16  AT-STOP-FORM-DT             PIC X(2).
  6261
  6262         16  FILLER                      PIC X(09).
  6263         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6264         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6265******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 117
* EL130.cbl
  6267*    COPY ELCBENE.
  6268******************************************************************
  6269*                                                                *
  6270*                            ELCBENE.                            *
  6271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6272*                            VMOD=2.006                          *
  6273*                                                                *
  6274*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6275*                                                                *
  6276*   FILE TYPE = VSAM,KSDS                                        *
  6277*   RECORD SIZE = 500   RECFORM = FIX                            *
  6278*                                                                *
  6279*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6280*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6281*                                                                *
  6282*   LOG = YES                                                    *
  6283*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6284*                                                                *
  6285*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6286******************************************************************
  6287
  6288 01  BENEFICIARY-MASTER.
  6289     12  BE-RECORD-ID                PIC XX.
  6290         88  VALID-BE-ID                VALUE 'BE'.
  6291
  6292     12  BE-CONTROL-PRIMARY.
  6293         16  BE-COMPANY-CD           PIC X.
  6294         16  BE-RECORD-TYPE          PIC X.
  6295             88  BENEFICIARY-RECORD  VALUE 'B'.
  6296             88  ADJUSTOR-RECORD     VALUE 'A'.
  6297         16  BE-BENEFICIARY          PIC X(10).
  6298     12  BE-CONTROL-BY-NAME.
  6299         16  BE-COMPANY-CD-A1        PIC X.
  6300         16  BE-RECORD-TYPE-A1       PIC X.
  6301         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6302         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6303
  6304     12  BE-LAST-MAINT-DT            PIC XX.
  6305     12  BE-LAST-MAINT-BY            PIC X(4).
  6306     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6307
  6308     12  BE-ADDRESS-DATA.
  6309         16  BE-MAIL-TO-NAME         PIC X(30).
  6310         16  BE-ADDRESS-LINE-1       PIC X(30).
  6311         16  BE-ADDRESS-LINE-2       PIC X(30).
  6312         16  BE-ADDRESS-LINE-3       PIC X(30).
  6313         16  BE-CITY-STATE.
  6314             20  BE-CITY             PIC X(28).
  6315             20  BE-STATE            PIC XX.
  6316         16  BE-ZIP-CODE.
  6317             20  BE-ZIP-PRIME.
  6318                 24  BE-ZIP-1ST      PIC X.
  6319                     88  BE-CANADIAN-POST-CODE
  6320                                         VALUE 'A' THRU 'Z'.
  6321                 24  FILLER          PIC X(4).
  6322             20  BE-ZIP-PLUS4        PIC X(4).
  6323         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6324             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 118
* EL130.cbl
  6325             20  BE-CAN-POSTAL-2     PIC XXX.
  6326             20  FILLER              PIC XXX.
  6327         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6328         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6329
  6330******************************************************************
  6331*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6332*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6333******************************************************************
  6334     12  BE-CARRIER                  PIC X.
  6335
  6336     12  BE-ADDRESS-DATA2.
  6337         16  BE-MAIL-TO-NAME2        PIC X(30).
  6338         16  BE-ADDRESS-LINE-12      PIC X(30).
  6339         16  BE-ADDRESS-LINE-22      PIC X(30).
  6340         16  BE-ADDRESS-LINE-32      PIC X(30).
  6341         16  BE-CITY-STATE2.
  6342             20  BE-CITY2            PIC X(28).
  6343             20  BE-STATE2           PIC XX.
  6344         16  BE-ZIP-CODE2.
  6345             20  BE-ZIP-PRIME2.
  6346                 24  BE-ZIP-1ST2     PIC X.
  6347                     88  BE-CANADIAN-POST-CODE2
  6348                                         VALUE 'A' THRU 'Z'.
  6349                 24  FILLER          PIC X(4).
  6350             20  BE-ZIP-PLUS42       PIC X(4).
  6351         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6352             20  BE-CAN-POSTAL-12    PIC XXX.
  6353             20  BE-CAN-POSTAL-22    PIC XXX.
  6354             20  FILLER              PIC XXX.
  6355         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6356         16  BE-BILLING-STMT-DATA.
  6357             20  BE-BSR              PIC X.
  6358                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6359                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6360             20  BE-BSR-FROM         PIC X(30).
  6361             20  BE-BSR-DEPT         PIC X(30).
  6362             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6363             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6364             20  BE-OUTPUT-TYPE      PIC X.
  6365                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6366                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6367
  6368     12  FILLER                      PIC X(28).
  6369******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 119
* EL130.cbl
  6371*    COPY ELCDAR.
  6372******************************************************************
  6373*                                                                *
  6374*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6375*   FILE TYPE = VSAM,KSDS                                        *
  6376*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6377*   BASE CLUSTER = DLYACTV                                       *
  6378*   LOG = YES                                                    *
  6379*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6380*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6381*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6382*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6383*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6384*               BY PROGRAM "LGINFCE".                            *
  6385*                                                                *
  6386******************************************************************
  6387 01  DAILY-ACTIVITY-RECORD.
  6388     05  DA-KEY.
  6389         10  DA-COMP-CD          PIC X.
  6390         10  DA-CARRIER          PIC X.
  6391         10  DA-CLAIM-NO         PIC X(7).
  6392         10  DA-CERT-NO.
  6393             15  DA-CERT-PRIME   PIC X(10).
  6394             15  DA-CERT-SFX     PIC X.
  6395     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6396     05  DA-RECORD-TYPE          PIC X.
  6397     05  FILLER                  PIC X(2).
  6398******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 120
* EL130.cbl
  6400*    COPY ELCACTQ.
  6401******************************************************************
  6402*                                                                *
  6403*                            ELCACTQ.                            *
  6404*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6405*                            VMOD=2.004                          *
  6406*                                                                *
  6407*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6408*                                                                *
  6409*   FILE TYPE = VSAM,KSDS                                        *
  6410*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6411*                                                                *
  6412*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6413*       ALTERNATE INDEX = NONE                                   *
  6414*                                                                *
  6415*   LOG = YES                                                    *
  6416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6417*                                                                *
  6418*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6419******************************************************************
  6420
  6421 01  ACTIVITY-QUE.
  6422     12  AQ-RECORD-ID                PIC XX.
  6423         88  VALID-AQ-ID                VALUE 'AQ'.
  6424
  6425     12  AQ-CONTROL-PRIMARY.
  6426         16  AQ-COMPANY-CD           PIC X.
  6427         16  AQ-CARRIER              PIC X.
  6428         16  AQ-CLAIM-NO             PIC X(7).
  6429         16  AQ-CERT-NO.
  6430             20  AQ-CERT-PRIME       PIC X(10).
  6431             20  AQ-CERT-SFX         PIC X.
  6432
  6433     12  AQ-PENDING-ACTIVITY-FLAGS.
  6434         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6435         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6436             88  PENDING-PAYMENTS       VALUE '1'.
  6437         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6438             88  PENDING-FULL-PRINT     VALUE '1'.
  6439             88  PENDING-PART-PRINT     VALUE '2'.
  6440         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6441             88  PENDING-LETTERS        VALUE '1'.
  6442         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6443             88  PENDING-RESTORE        VALUE 'C'.
  6444             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6445
  6446     12  FILLER                      PIC X(20).
  6447
  6448     12  AQ-RESEND-DATE              PIC XX.
  6449     12  AQ-FOLLOWUP-DATE            PIC XX.
  6450     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6451     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6452     12  AQ-AUTO-LETTER              PIC X(4).
  6453     12  FILLER                      PIC XX.
  6454     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6455*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 121
* EL130.cbl
  6457*    COPY ELCARCH.
  6458******************************************************************
  6459*                                                                *
  6460*                            ELCARCH.                            *
  6461*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6462*                            VMOD=2.007                          *
  6463*                                                                *
  6464*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6465*                                                                *
  6466*   FILE TYPE = VSAM,KSDS                                        *
  6467*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6468*                                                                *
  6469*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6470*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6471*                                                                *
  6472*   LOG = NO                                                     *
  6473*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6474*                                                                *
  6475*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6476******************************************************************
  6477 01  LETTER-ARCHIVE.
  6478     12  LA-RECORD-ID                PIC XX.
  6479         88  VALID-LA-ID                VALUE 'LA'.
  6480
  6481     12  LA-CONTROL-PRIMARY.
  6482         16  LA-COMPANY-CD           PIC X.
  6483         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6484         16  LA-RECORD-TYPE          PIC X.
  6485             88  LA-HEADER-DATA         VALUE '1'.
  6486             88  LA-ADDRESS-DATA        VALUE '2'.
  6487             88  LA-TEXT-DATA           VALUE '3'.
  6488             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6489         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6490
  6491     12  LA-CONTROL-BY-TYPE.
  6492         16  LA-COMPANY-CD-A1        PIC X.
  6493         16  LA-RECORD-TYPE-A1       PIC X.
  6494         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6495         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6496
  6497     12  LA-TEXT-RECORD.
  6498         16  LA-SKIP-CONTROL         PIC XX.
  6499             88  NO-LINES-SKIPPED       VALUE SPACES.
  6500             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6501         16  LA-TEXT-LINE            PIC X(70).
  6502
  6503     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6504         16  FILLER                  PIC XX.
  6505         16  LA-ADDRESS-LINE         PIC X(30).
  6506         16  FILLER                  PIC X(40).
  6507
  6508     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6509         16  FILLER                  PIC XX.
  6510         16  LA-CARRIER              PIC X.
  6511         16  LA-CLAIM-NO             PIC X(7).
  6512         16  LA-CERT-NO.
  6513             20  LA-CERT-PRIME       PIC X(10).
  6514             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 122
* EL130.cbl
  6515         16  LA-NO-OF-COPIES         PIC S9.
  6516         16  LA-RESEND-DATE          PIC XX.
  6517         16  LA-PROCESSOR-CD         PIC X(4).
  6518         16  LA-CREATION-DT          PIC XX.
  6519         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6520         16  LA-RESEND-PRINT-DATE    PIC XX.
  6521         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6522         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6523*
  6524* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6525*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6526*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6527*   I        20  LA-DMD-RES-ST           PIC XX.
  6528*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6529*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6530*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6531*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6532*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6533*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6534*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6535*   I        20  LA-DMD-UND-CODE         PIC XX.
  6536*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6537*   V    16  FILLER                  PIC X(15).
  6538* -----
  6539*
  6540* REINSERTED  CSO  MODS
  6541*
  6542         16  FILLER.
  6543             20  FILLER                  PIC X(29).
  6544             20  LA-CSO-LETTER-STATUS    PIC X.
  6545                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6546                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6547                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6548             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6549             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6550*
  6551
  6552     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6553         16  FILLER                  PIC XX.
  6554         16  LA4-CARRIER             PIC X.
  6555         16  LA4-CLAIM-NO            PIC X(7).
  6556         16  LA4-CERT-NO.
  6557             20  LA4-CERT-PRIME      PIC X(10).
  6558             20  LA4-CERT-SFX        PIC X.
  6559         16  LA4-NO-OF-COPIES        PIC S9.
  6560         16  LA4-RESEND-DATE         PIC XX.
  6561         16  LA4-PROCESSOR-CD        PIC X(4).
  6562         16  LA4-CREATION-DT         PIC XX.
  6563         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6564         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6565         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6566         16  LA4-FORM-TYPE           PIC X.
  6567             88  LA4-INITIAL-FORM    VALUE '1'.
  6568             88  LA4-PROGRESS-FORM   VALUE '2'.
  6569         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6570         16  LA4-STATE               PIC X(02).
  6571         16  FILLER                  PIC X(31).
  6572******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 123
* EL130.cbl
  6574*    COPY ERCREIN.
  6575******************************************************************
  6576*                                                                *
  6577*                            ERCREIN                             *
  6578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6579*                            VMOD=2.010                          *
  6580*                                                                *
  6581*   ONLINE CREDIT SYSTEM                                         *
  6582*                                                                *
  6583*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6584*                                                                *
  6585*   FILE TYPE = VSAM,KSDS                                        *
  6586*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6587*                                                                *
  6588*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6589*       ALTERNATE PATH = NONE                                    *
  6590*                                                                *
  6591*   LOG = NO                                                     *
  6592*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6593*                                                                *
  6594******************************************************************
  6595*                   C H A N G E   L O G
  6596*
  6597* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6598*-----------------------------------------------------------------
  6599*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6600* EFFECTIVE    NUMBER
  6601*-----------------------------------------------------------------
  6602* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6603* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6604******************************************************************
  6605 01  REINSURANCE-RECORD.
  6606     12  RE-RECORD-ID                      PIC XX.
  6607         88  VALID-RE-ID                      VALUE 'RE'.
  6608
  6609     12  RE-CONTROL-PRIMARY.
  6610         16  RE-COMPANY-CD                 PIC X.
  6611         16  RE-KEY.
  6612             20  RE-CODE                   PIC X.
  6613                 88  RE-TABLE-RECORD          VALUE 'A'.
  6614                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6615             20  RE-TABLE                  PIC XXX.
  6616             20  FILLER                    PIC XXX.
  6617         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6618             20  FILLER                    PIC X.
  6619             20  RE-COMPANY.
  6620                 24  RE-COMP-PRIME         PIC XXX.
  6621                 24  RE-COMP-SUB           PIC XXX.
  6622
  6623     12  RE-MAINT-INFORMATION.
  6624         16  RE-LAST-MAINT-DT              PIC XX.
  6625         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6626         16  RE-LAST-MAINT-USER            PIC X(4).
  6627         16  FILLER                        PIC X(10).
  6628
  6629     12  RE-TABLE-DATA.
  6630         16  RE-100-COMP                   PIC 99.
  6631
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 124
* EL130.cbl
  6632         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6633             20  RE-REI-COMP-NO.
  6634                 24  RE-REI-COMP           PIC XXX.
  6635                 24  RE-REI-COMP-SUB       PIC XXX.
  6636             20  RE-LF-QC                  PIC X.
  6637             20  RE-AH-QC                  PIC X.
  6638             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6639             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6640             20  RE-LFAGE-LO               PIC 99.
  6641             20  RE-LFAGE-HI               PIC 99.
  6642             20  RE-AHAGE-LO               PIC 99.
  6643             20  RE-AHAGE-HI               PIC 99.
  6644             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6645             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6646             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6647             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6648             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6649             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6650             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6651             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6652             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6653             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6654             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6655             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6656             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6657             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6658             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6659             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6660             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6661             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6662             20  RE-LF-BEN-CODE            PIC X.
  6663             20  RE-AH-BEN-CODE            PIC X.
  6664             20  RE-INTERACTIVE            PIC X.
  6665             20  RE-REMAINING              PIC X.
  6666             20  RE-LF-RUNOFF-SW           PIC X.
  6667             20  RE-AH-RUNOFF-SW           PIC X.
  6668             20  FILLER                    PIC X(19).
  6669
  6670         16  RE-COMP-INFO-END              PIC X(6).
  6671         16  RE-NSP-ST-CD-LF               PIC XX.
  6672         16  RE-NSP-ST-CD-AH               PIC XX.
  6673         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6674             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6675
  6676         16  FILLER                        PIC X(27).
  6677
  6678     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6679         16  RE-NAME                       PIC X(30).
  6680         16  RE-LF-PE                      PIC X.
  6681         16  RE-AH-PE                      PIC X.
  6682         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6683         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6684         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6685         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6686         16  RE-PRT-ST                     PIC X.
  6687         16  RE-PRT-OW                     PIC X.
  6688         16  RE-MORT-CODE                  PIC X(4).
  6689         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 125
* EL130.cbl
  6690         16  RE-ZERO-LF-FEE                PIC X.
  6691         16  RE-ZERO-AH-FEE                PIC X.
  6692         16  RE-CEDE-NAME                  PIC X(30).
  6693         16  RE-LF-COMM                    PIC X.
  6694         16  RE-AH-COMM                    PIC X.
  6695         16  RE-LF-TAX                     PIC X.
  6696         16  RE-AH-TAX                     PIC X.
  6697         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6698         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6699         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6700
  6701         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6702             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6703
  6704         16  RE-LF-CEDING-FEE-BRACKETS.
  6705             20  RE-LF-FEE-METHOD          PIC X.
  6706                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6707                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6708                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6709                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6710             20  RE-LF-FEE-BASIS           PIC X.
  6711                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6712                 88  RE-LF-NET-CEDED               VALUE '2'.
  6713                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6714                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6715                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6716                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6717                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6718                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6719             20  FILLER                    PIC XXX.
  6720             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6721                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6722                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6723
  6724         16  RE-AH-CEDING-FEE-BRACKETS.
  6725             20  RE-AH-FEE-METHOD          PIC X.
  6726                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6727                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6728                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6729                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6730             20  RE-AH-FEE-BASIS           PIC X.
  6731                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6732                 88  RE-AH-NET-CEDED               VALUE '2'.
  6733                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6734                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6735                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6736                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6737                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6738                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6739             20  FILLER                    PIC XXX.
  6740             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6741                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6742                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6743
  6744         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6745
  6746         16  RE-OLD-CEDING-STMT            PIC X.
  6747
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 126
* EL130.cbl
  6748         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6749         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6750         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6751         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6752         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6753         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6754         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6755         16  RE-MORT-SW                    PIC X.
  6756         16  RE-CEDING-TYPE-FLAG           PIC X.
  6757             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6758             88  RE-CEDED                          VALUE 'C'.
  6759             88  RE-ASSUMED                        VALUE 'A'.
  6760             88  RE-PHANTOM                        VALUE 'P'.
  6761
  6762         16  RE-CEDING-STMT-OPT-A          PIC X.
  6763             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6764         16  RE-CEDING-STMT-OPT-B          PIC X.
  6765             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6766         16  RE-CEDING-STMT-OPT-C          PIC X.
  6767             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6768         16  RE-CEDING-STMT-OPT-D          PIC X.
  6769             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6770         16  RE-CEDING-STMT-OPT-E          PIC X.
  6771             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6772
  6773         16  RE-PRT-CRSV                   PIC X.
  6774
  6775         16  RE-GL-CENTER                  PIC X(4).
  6776
  6777         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6778
  6779         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6780
  6781         16  RE-EARN-STOP-CODE             PIC X.
  6782             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6783             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6784
  6785         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6786             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6787
  6788         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6789         16  FILLER                        PIC X(2281).
  6790
  6791         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6792
  6793******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 127
* EL130.cbl
  6795*    COPY ERCMAIL.
  6796******************************************************************
  6797*                                                                *
  6798*                                                                *
  6799*                            ERCMAIL                             *
  6800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6801*                            VMOD=2.003                          *
  6802*                                                                *
  6803*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6804*                                                                *
  6805*   FILE TYPE = VSAM,KSDS                                        *
  6806*   RECORD SIZE = 374   RECFORM = FIX                            *
  6807*                                                                *
  6808*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6809*   ALTERNATE PATH    = NOT USED                                 *
  6810*                                                                *
  6811*   LOG = YES                                                    *
  6812*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6813******************************************************************
  6814*                   C H A N G E   L O G
  6815*
  6816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6817*-----------------------------------------------------------------
  6818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6819* EFFECTIVE    NUMBER
  6820*-----------------------------------------------------------------
  6821* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6822* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6823* 111108                   PEMA  ADD CRED BENE ADDR2
  6824******************************************************************
  6825
  6826 01  MAILING-DATA.
  6827     12  MA-RECORD-ID                      PIC XX.
  6828         88  VALID-MA-ID                       VALUE 'MA'.
  6829
  6830     12  MA-CONTROL-PRIMARY.
  6831         16  MA-COMPANY-CD                 PIC X.
  6832         16  MA-CARRIER                    PIC X.
  6833         16  MA-GROUPING.
  6834             20  MA-GROUPING-PREFIX        PIC XXX.
  6835             20  MA-GROUPING-PRIME         PIC XXX.
  6836         16  MA-STATE                      PIC XX.
  6837         16  MA-ACCOUNT.
  6838             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6839             20  MA-ACCOUNT-PRIME          PIC X(6).
  6840         16  MA-CERT-EFF-DT                PIC XX.
  6841         16  MA-CERT-NO.
  6842             20  MA-CERT-PRIME             PIC X(10).
  6843             20  MA-CERT-SFX               PIC X.
  6844
  6845     12  FILLER                            PIC XX.
  6846
  6847     12  MA-ACCESS-CONTROL.
  6848         16  MA-SOURCE-SYSTEM              PIC XX.
  6849             88  MA-FROM-CREDIT                VALUE 'CR'.
  6850             88  MA-FROM-VSI                   VALUE 'VS'.
  6851             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6852             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 128
* EL130.cbl
  6853         16  MA-RECORD-ADD-DT              PIC XX.
  6854         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6855         16  MA-LAST-MAINT-DT              PIC XX.
  6856         16  MA-LAST-MAINT-BY              PIC XXXX.
  6857         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6858
  6859     12  MA-PROFILE-INFO.
  6860         16  MA-QUALIFY-CODE-1             PIC XX.
  6861         16  MA-QUALIFY-CODE-2             PIC XX.
  6862         16  MA-QUALIFY-CODE-3             PIC XX.
  6863         16  MA-QUALIFY-CODE-4             PIC XX.
  6864         16  MA-QUALIFY-CODE-5             PIC XX.
  6865
  6866         16  MA-INSURED-LAST-NAME          PIC X(15).
  6867         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6868         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6869         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6870         16  MA-INSURED-BIRTH-DT           PIC XX.
  6871         16  MA-INSURED-SEX                PIC X.
  6872             88  MA-SEX-MALE                   VALUE 'M'.
  6873             88  MA-SEX-FEMALE                 VALUE 'F'.
  6874         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6875
  6876         16  MA-ADDRESS-CORRECTED          PIC X.
  6877         16  MA-JOINT-BIRTH-DT             PIC XX.
  6878*        16  FILLER                        PIC X(12).
  6879
  6880         16  MA-ADDRESS-LINE-1             PIC X(30).
  6881         16  MA-ADDRESS-LINE-2             PIC X(30).
  6882         16  MA-CITY-STATE.
  6883             20  MA-CITY                   PIC X(28).
  6884             20  MA-ADDR-STATE             PIC XX.
  6885         16  MA-ZIP.
  6886             20  MA-ZIP-CODE.
  6887                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6888                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6889                 24  FILLER                PIC X(4).
  6890             20  MA-ZIP-PLUS4              PIC X(4).
  6891         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6892             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6893             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6894             20  FILLER                    PIC X(3).
  6895
  6896         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6897
  6898         16  FILLER                        PIC XXX.
  6899*        16  FILLER                        PIC X(10).
  6900
  6901     12  MA-CRED-BENE-INFO.
  6902         16  MA-CRED-BENE-NAME                 PIC X(25).
  6903         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6904         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6905         16  MA-CRED-BENE-CTYST.
  6906             20  MA-CRED-BENE-CITY             PIC X(28).
  6907             20  MA-CRED-BENE-STATE            PIC XX.
  6908         16  MA-CRED-BENE-ZIP.
  6909             20  MA-CB-ZIP-CODE.
  6910                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 129
* EL130.cbl
  6911                     88  MA-CB-CANADIAN-POST-CODE
  6912                                           VALUE 'A' THRU 'Z'.
  6913                 24  FILLER                    PIC X(4).
  6914             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6915         16  MA-CB-CANADIAN-POSTAL-CODE
  6916                            REDEFINES MA-CRED-BENE-ZIP.
  6917             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6918             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6919             20  FILLER                        PIC X(3).
  6920     12  MA-POST-CARD-MAIL-DATA.
  6921         16  MA-MAIL-DATA OCCURS 7.
  6922             20  MA-MAIL-TYPE              PIC X.
  6923                 88  MA-12MO-MAILING           VALUE '1'.
  6924                 88  MA-EXP-MAILING            VALUE '2'.
  6925             20  MA-MAIL-STATUS            PIC X.
  6926                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6927                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6928                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6929             20  MA-MAIL-DATE              PIC XX.
  6930     12  FILLER                            PIC XX.
  6931     12  FILLER                            PIC XX.
  6932*    12  FILLER                            PIC X(30).
  6933******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 130
* EL130.cbl
  6935*    COPY ELCCRTT.
  6936******************************************************************
  6937*                                                                *
  6938*                            ELCCRTT.                            *
  6939*                                                                *
  6940*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6941*                                                                *
  6942*   FILE TYPE = VSAM,KSDS                                        *
  6943*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6944*                                                                *
  6945*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6946*                                                                *
  6947*   LOG = YES                                                    *
  6948*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6949******************************************************************
  6950*                   C H A N G E   L O G
  6951*
  6952* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6953*-----------------------------------------------------------------
  6954*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6955* EFFECTIVE    NUMBER
  6956*-----------------------------------------------------------------
  6957* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6958* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6959* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6960* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  6961* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6962******************************************************************
  6963
  6964 01  CERTIFICATE-TRAILERS.
  6965     12  CS-RECORD-ID                      PIC XX.
  6966         88  VALID-CS-ID                      VALUE 'CS'.
  6967
  6968     12  CS-CONTROL-PRIMARY.
  6969         16  CS-COMPANY-CD                 PIC X.
  6970         16  CS-CARRIER                    PIC X.
  6971         16  CS-GROUPING                   PIC X(6).
  6972         16  CS-STATE                      PIC XX.
  6973         16  CS-ACCOUNT                    PIC X(10).
  6974         16  CS-CERT-EFF-DT                PIC XX.
  6975         16  CS-CERT-NO.
  6976             20  CS-CERT-PRIME             PIC X(10).
  6977             20  CS-CERT-SFX               PIC X.
  6978         16  CS-TRAILER-TYPE               PIC X.
  6979             88  COMM-TRLR           VALUE 'A'.
  6980             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  6981             88  CERT-DATA-TRLR      VALUE 'C'.
  6982
  6983     12  CS-DATA-AREA                      PIC X(516).
  6984
  6985     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6986         16  CS-BANK-COMMISSION-AREA.
  6987             20  CS-BANK-COMMS       OCCURS 10.
  6988                 24  CS-AGT                PIC X(10).
  6989                 24  CS-COM-TYP            PIC X.
  6990                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  6991                 24  CS-RECALC-LV-INDIC    PIC X.
  6992                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 131
* EL130.cbl
  6993         16  FILLER                        PIC X(256).
  6994
  6995     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  6996****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  6997****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  6998         16  CS-MB-CLAIM-DATA OCCURS 2.
  6999             20  FILLER OCCURS 10.
  7000                 24  CS-CLAIM-TYPE         PIC X.
  7001                     88  CS-AH-CLM           VALUE 'A'.
  7002                     88  CS-IU-CLM           VALUE 'I'.
  7003                     88  CS-GP-CLM           VALUE 'G'.
  7004                     88  CS-LF-CLM           VALUE 'L'.
  7005                     88  CS-PR-CLM           VALUE 'P'.
  7006                 24  CS-BANK               PIC S999 COMP-3.
  7007                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7008                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7009                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7010         16  FILLER                        PIC X(216).
  7011     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7012         16  CS-VIN-NUMBER                 PIC X(17).
  7013         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7014         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7015         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7016         16  FILLER                        PIC X(496).
  7017******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 132
* EL130.cbl
  7019
  7020 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7021                          CONTROL-FILE CERTIFICATE-MASTER
  7022                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7023                          BENEFICIARY-MASTER
  7024                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7025                          LETTER-ARCHIVE REINSURANCE-RECORD
  7026                          MAILING-DATA CERTIFICATE-TRAILERS.
  7027 0000-DFHEXIT SECTION.
  7028     MOVE '9#                    $   ' TO DFHEIV0.
  7029     MOVE 'EL130' TO DFHEIV1.
  7030     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7031     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7032     MOVE '5'                    TO DC-OPTION-CODE.
  7033     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7034     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7035     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7036
  7037     IF EIBCALEN = ZERO
  7038         GO TO 8800-UNAUTHORIZED-ACCESS
  7039     END-IF.
  7040
  7041     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7042     MOVE EIBTRMID               TO QID-TERM.
  7043     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7044     move spaces                 to emi-error-lines
  7045     MOVE '2'                    TO EMI-SWITCH2.
  7046     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7047     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7048
  7049
  7050* EXEC CICS HANDLE CONDITION
  7051*        QIDERR     (0100-TEST-ENTRY)
  7052*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7053*        PGMIDERR   (9600-PGMID-ERROR)
  7054*        TERMIDERR  (8820-TERM-ERROR)
  7055*        TRANSIDERR (8830-TRAN-ERROR)
  7056*        ERROR      (9990-ABEND)
  7057*    END-EXEC.
  7058*    MOVE '"$N?L[\.              ! " #00007045' TO DFHEIV0
  7059     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7061     MOVE X'2220233030303037303435' TO DFHEIV0(25:11)
  7062     CALL 'kxdfhei1' USING DFHEIV0
  7063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7064
  7065
  7066     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7067        PI-CALLING-PROGRAM   = XCTL-6592
  7068         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7069     ELSE
  7070         MOVE SPACES             TO RETURNED-FROM
  7071     END-IF.
  7072
  7073     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7074         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7075             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7076             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 133
* EL130.cbl
  7077             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7078             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7079             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7080             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7081             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7082             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7083         ELSE
  7084             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7085             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7086             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7087             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7088             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7089             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7090             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7091             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7092         END-IF
  7093     END-IF.
  7094
  7095     IF EIBTRNID = TRANS-ID
  7096         IF EIBAID = DFHCLEAR
  7097             GO TO 9400-CLEAR
  7098         ELSE
  7099             GO TO 0200-RECEIVE
  7100         END-IF
  7101     END-IF.
  7102
  7103     IF RETURNED-FROM NOT = SPACES
  7104         GO TO 0600-RECOVER-TEMP-STORAGE
  7105     END-IF.
  7106
  7107     MOVE LOW-VALUES TO EL130AO.
  7108     move zeros to pi-dcc-max-amt
  7109                   pi-dcc-max-benefits
  7110
  7111
  7112
  7113* EXEC CICS DELETEQ TS
  7114*         QUEUE   (QID)
  7115*    END-EXEC.
  7116*    MOVE '*&                    #   #00007100' TO DFHEIV0
  7117     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7118     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7119     MOVE X'2020233030303037313030' TO DFHEIV0(25:11)
  7120     CALL 'kxdfhei1' USING DFHEIV0,
  7121           QID,
  7122           DFHEIV99
  7123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7124
  7125
  7126 0100-TEST-ENTRY.
  7127     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7128         GO TO 0650-FROM-EL127
  7129     ELSE
  7130         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7131                                    PI-CERT-PROCESSED
  7132                                    PI-LETTER-ERROR-CODE
  7133     END-IF.
  7134
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 134
* EL130.cbl
  7135     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7136         GO TO 0640-FROM-EL132
  7137     END-IF.
  7138
  7139     GO TO 8100-SEND-INITIAL-MAP.
  7140
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 135
* EL130.cbl
  7142 0200-RECEIVE.
  7143     MOVE LOW-VALUES             TO EL130AI.
  7144
  7145     IF PI-PROCESSOR-ID = 'LGXX'
  7146*        NEXT SENTENCE
  7147         CONTINUE
  7148     ELSE
  7149
  7150* EXEC CICS READQ TS
  7151*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7152*            INTO    (SECURITY-CONTROL)
  7153*            LENGTH  (SC-COMM-LENGTH)
  7154*            ITEM    (SC-ITEM)
  7155*        END-EXEC
  7156*    MOVE '*$II   L              ''   #00007127' TO DFHEIV0
  7157     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7158     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7159     MOVE X'2020233030303037313237' TO DFHEIV0(25:11)
  7160     CALL 'kxdfhei1' USING DFHEIV0,
  7161           PI-SECURITY-TEMP-STORE-ID,
  7162           SECURITY-CONTROL,
  7163           SC-COMM-LENGTH,
  7164           SC-ITEM,
  7165           DFHEIV99,
  7166           DFHEIV99
  7167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7168         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7169         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7170         IF NOT DISPLAY-CAP
  7171             MOVE 'READ'              TO  SM-READ
  7172             PERFORM 9995-SECURITY-VIOLATION
  7173             MOVE ER-0070             TO  EMI-ERROR
  7174             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7175             GO TO 8100-SEND-INITIAL-MAP
  7176         END-IF
  7177     END-IF.
  7178
  7179     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7180         MOVE ER-7008 TO EMI-ERROR
  7181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7182         MOVE -1 TO MAINTL
  7183         GO TO 8200-SEND-DATAONLY
  7184     END-IF.
  7185
  7186
  7187
  7188* EXEC CICS RECEIVE
  7189*         MAP     (MAP-NAME)
  7190*         MAPSET  (MAPSET-NAME)
  7191*         INTO    (EL130AI)
  7192*    END-EXEC.
  7193     MOVE LENGTH OF
  7194      EL130AI
  7195       TO DFHEIV11
  7196*    MOVE '8"T I  L              ''   #00007152' TO DFHEIV0
  7197     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7199     MOVE X'2020233030303037313532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 136
* EL130.cbl
  7200     CALL 'kxdfhei1' USING DFHEIV0,
  7201           MAP-NAME,
  7202           EL130AI,
  7203           DFHEIV11,
  7204           MAPSET-NAME,
  7205           DFHEIV99,
  7206           DFHEIV99
  7207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7208
  7209
  7210     IF NOT PI-NO-CARRIER-SECURITY
  7211        MOVE +1                  TO CLMCARRL
  7212        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7213     END-IF.
  7214
  7215     IF ENTERPFL = ZERO
  7216         GO TO 0300-CHECK-PFKEYS
  7217     END-IF.
  7218
  7219     IF EIBAID NOT = DFHENTER
  7220         MOVE ER-0004            TO EMI-ERROR
  7221         GO TO 0320-INPUT-ERROR
  7222     END-IF.
  7223
  7224     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7225         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7226     ELSE
  7227         MOVE ER-0029            TO EMI-ERROR
  7228         GO TO 0320-INPUT-ERROR
  7229     END-IF.
  7230
  7231 0300-CHECK-PFKEYS.
  7232     IF EIBAID = DFHPF23
  7233         GO TO 8810-PF23
  7234     END-IF.
  7235
  7236     IF EIBAID = DFHPF24
  7237         GO TO 9200-RETURN-MAIN-MENU
  7238     END-IF.
  7239
  7240     IF EIBAID = DFHPF12
  7241         GO TO 9500-PF12
  7242     END-IF.
  7243
  7244     IF EIBAID = DFHPF3
  7245         MOVE SPACES              TO MAINTI
  7246         MOVE ZEROS               TO MAINTL
  7247         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7248         MOVE XCTL-127            TO PGM-NAME
  7249         GO TO 9300-XCTL
  7250     END-IF.
  7251
  7252     IF EIBAID = DFHPF4
  7253         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7254         MOVE XCTL-132            TO PGM-NAME
  7255         GO TO 9300-XCTL
  7256     END-IF.
  7257
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 137
* EL130.cbl
  7258     IF EIBAID = DFHPF13
  7259         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7260             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7261             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7262             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7263             MOVE PI-STATE            TO  PI-CR-STATE
  7264             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7265             MOVE XCTL-650            TO  PGM-NAME
  7266             GO TO 9300-XCTL
  7267         ELSE
  7268             MOVE -1                  TO  ENTERPFL
  7269             MOVE ER-2566             TO  EMI-ERROR
  7270             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7271             GO TO 8100-SEND-INITIAL-MAP
  7272         END-IF
  7273     END-IF.
  7274
  7275     IF EIBAID = DFHPF5
  7276         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7277             ADD +1 TO PI-CERT-PROCESSED
  7278             GO TO 0650-FROM-EL127
  7279         ELSE
  7280             MOVE ER-7686         TO EMI-ERROR
  7281             GO TO 0320-INPUT-ERROR
  7282         END-IF
  7283     END-IF.
  7284
  7285     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7286         GO TO 0800-TEST-PREVIOUS-CONTROL
  7287     END-IF.
  7288
  7289     IF PI-HAS-CLAS-IC-CRDTCRD
  7290         IF EIBAID = DFHPF10
  7291             MOVE XCTL-725          TO PGM-NAME
  7292             GO TO 9300-XCTL
  7293         END-IF
  7294     END-IF.
  7295
  7296     IF EIBAID = DFHPF14
  7297         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7298         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7299         MOVE XCTL-659            TO PGM-NAME
  7300         GO TO 9300-XCTL
  7301     END-IF.
  7302
  7303     IF EIBAID = DFHPF15
  7304         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7305         MOVE XCTL-114            TO PGM-NAME
  7306         GO TO 9300-XCTL
  7307     END-IF.
  7308
  7309     IF EIBAID = DFHPF11
  7310        GO TO 0600-RECOVER-TEMP-STORAGE
  7311     END-IF
  7312     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7313         GO TO 0330-EDIT-DATA
  7314     END-IF.
  7315
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 138
* EL130.cbl
  7316     MOVE ER-0029                TO EMI-ERROR.
  7317
  7318 0320-INPUT-ERROR.
  7319     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7320
  7321     MOVE AL-UNBON               TO ENTERPFA.
  7322
  7323     IF ENTERPFL = ZERO
  7324         MOVE -1                 TO MAINTL
  7325     ELSE
  7326         MOVE -1                 TO ENTERPFL
  7327     END-IF.
  7328
  7329     GO TO 8200-SEND-DATAONLY.
  7330
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 139
* EL130.cbl
  7332 0330-EDIT-DATA.
  7333
  7334     IF MAINTI = 'S'
  7335         IF PRTOPTL GREATER THAN 0
  7336             IF PRTOPTI NOT = 'N' AND 'L'
  7337                 MOVE AL-UABON   TO  PRTOPTA
  7338                 MOVE -1         TO  PRTOPTL
  7339                 MOVE ER-0334    TO  EMI-ERROR
  7340                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7341                 GO TO 8200-SEND-DATAONLY
  7342             ELSE
  7343                 IF PRTOPTI = 'L'
  7344                     GO TO 0400-CREATE-ELACTQ
  7345                 ELSE
  7346                     GO TO 0480-PRINT-NOW
  7347                 END-IF
  7348             END-IF
  7349         ELSE
  7350             GO TO 1000-SHOW-CLAIM
  7351         END-IF
  7352     END-IF.
  7353
  7354     IF NOT MODIFY-CAP
  7355         MOVE 'UPDATE'       TO  SM-READ
  7356         PERFORM 9995-SECURITY-VIOLATION
  7357         MOVE ER-0070        TO  EMI-ERROR
  7358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7359         GO TO 8100-SEND-INITIAL-MAP
  7360     END-IF.
  7361
  7362     IF MAINTI = 'D'
  7363         GO TO 2000-DELETE-CLAIM
  7364     END-IF.
  7365
  7366     IF MAINTI = 'A'
  7367         GO TO 3000-ADD-CLAIM
  7368     END-IF.
  7369
  7370     IF MAINTI = 'I'
  7371         GO TO 5000-INCURRED-CHANGE
  7372     END-IF.
  7373
  7374     MOVE ER-0023                TO EMI-ERROR.
  7375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7376     MOVE -1                     TO MAINTL.
  7377     MOVE AL-UABON               TO MAINTA.
  7378
  7379     GO TO 8200-SEND-DATAONLY.
  7380
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 140
* EL130.cbl
  7382 0400-CREATE-ELACTQ.
  7383     IF CLMNOI   = PI-LAST-CLAIM      AND
  7384        CLMCARRI = PI-LAST-CARR       AND
  7385        CERTNOI  = PI-LAST-CERT-PRIME AND
  7386        SUFXI    = PI-LAST-CERT-SUFX
  7387         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7388         MOVE PI-LAST-CARR       TO PI-CARRIER
  7389         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7390     ELSE
  7391         MOVE ER-0207            TO EMI-ERROR
  7392         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7393         MOVE -1                 TO MAINTL
  7394         GO TO 8200-SEND-DATAONLY
  7395     END-IF.
  7396
  7397     IF (NOT PI-NO-CARRIER-SECURITY OR
  7398         NOT PI-NO-ACCOUNT-SECURITY)
  7399         MOVE AL-UABON      TO  PRTOPTA
  7400         MOVE -1            TO  PRTOPTL
  7401         MOVE ER-2378       TO  EMI-ERROR
  7402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7403         GO TO 8200-SEND-DATAONLY
  7404     END-IF.
  7405
  7406     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7407     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7408     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7409     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7410
  7411
  7412
  7413* EXEC CICS HANDLE CONDITION
  7414*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7415*    END-EXEC.
  7416*    MOVE '"$I                   ! # #00007360' TO DFHEIV0
  7417     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7419     MOVE X'2320233030303037333630' TO DFHEIV0(25:11)
  7420     CALL 'kxdfhei1' USING DFHEIV0
  7421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7422
  7423
  7424
  7425
  7426* EXEC CICS READ
  7427*         UPDATE
  7428*         DATASET    (ELACTQ-DSID)
  7429*         SET        (ADDRESS OF ACTIVITY-QUE)
  7430*         RIDFLD     (ELACTQ-KEY)
  7431*    END-EXEC.
  7432*    MOVE '&"S        EU         (   #00007365' TO DFHEIV0
  7433     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7434     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7435     MOVE X'2020233030303037333635' TO DFHEIV0(25:11)
  7436     CALL 'kxdfhei1' USING DFHEIV0,
  7437           ELACTQ-DSID,
  7438           DFHEIV20,
  7439           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 141
* EL130.cbl
  7440           ELACTQ-KEY,
  7441           DFHEIV99,
  7442           DFHEIV99,
  7443           DFHEIV99
  7444     SET ADDRESS OF ACTIVITY-QUE TO
  7445         DFHEIV20
  7446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7447
  7448
  7449     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7450     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7451
  7452
  7453
  7454* EXEC CICS REWRITE
  7455*         DATASET     (ELACTQ-DSID)
  7456*         FROM        (ACTIVITY-QUE)
  7457*    END-EXEC.
  7458     MOVE LENGTH OF
  7459      ACTIVITY-QUE
  7460       TO DFHEIV11
  7461*    MOVE '&& L                  %   #00007376' TO DFHEIV0
  7462     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7463     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7464     MOVE X'2020233030303037333736' TO DFHEIV0(25:11)
  7465     CALL 'kxdfhei1' USING DFHEIV0,
  7466           ELACTQ-DSID,
  7467           ACTIVITY-QUE,
  7468           DFHEIV11,
  7469           DFHEIV99
  7470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7471
  7472
  7473     GO TO 0470-STATUS-FINISH.
  7474
  7475 0450-ADD-ELACTQ-RECORD.
  7476
  7477
  7478* EXEC CICS GETMAIN
  7479*        SET     (ADDRESS OF ACTIVITY-QUE)
  7480*        LENGTH  (ELACTQ-LENGTH)
  7481*        INITIMG (GETMAIN-SPACE)
  7482*    END-EXEC.
  7483*    MOVE ',"IL                  $   #00007385' TO DFHEIV0
  7484     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7485     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7486     MOVE X'2020233030303037333835' TO DFHEIV0(25:11)
  7487     CALL 'kxdfhei1' USING DFHEIV0,
  7488           DFHEIV20,
  7489           ELACTQ-LENGTH,
  7490           GETMAIN-SPACE
  7491     SET ADDRESS OF ACTIVITY-QUE TO
  7492         DFHEIV20
  7493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7494
  7495
  7496     MOVE 'AQ'              TO AQ-RECORD-ID.
  7497     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 142
* EL130.cbl
  7498     MOVE +0                TO AQ-PAYMENT-COUNTER
  7499                               AQ-PMT-UNAPPROVED-COUNT.
  7500     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7501                               AQ-FOLLOWUP-DATE.
  7502     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7503     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7504
  7505
  7506
  7507* EXEC CICS WRITE
  7508*         DATASET     (ELACTQ-DSID)
  7509*         FROM        (ACTIVITY-QUE)
  7510*         RIDFLD      (ELACTQ-KEY)
  7511*    END-EXEC.
  7512     MOVE LENGTH OF
  7513      ACTIVITY-QUE
  7514       TO DFHEIV11
  7515*    MOVE '&$ L                  ''   #00007401' TO DFHEIV0
  7516     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7517     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7518     MOVE X'2020233030303037343031' TO DFHEIV0(25:11)
  7519     CALL 'kxdfhei1' USING DFHEIV0,
  7520           ELACTQ-DSID,
  7521           ACTIVITY-QUE,
  7522           DFHEIV11,
  7523           ELACTQ-KEY,
  7524           DFHEIV99,
  7525           DFHEIV99
  7526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7527
  7528
  7529 0470-STATUS-FINISH.
  7530     MOVE AL-UANOF               TO  PRTOPTA
  7531                                     ALTPRTA.
  7532
  7533     MOVE SPACES                 TO  PRTOPTO
  7534                                     ALTPRTO.
  7535
  7536     MOVE ER-0000                TO EMI-ERROR.
  7537     MOVE -1                     TO MAINTL.
  7538     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7539     GO TO 8100-SEND-INITIAL-MAP.
  7540
  7541 0480-PRINT-NOW.
  7542
  7543
  7544* EXEC CICS HANDLE CONDITION
  7545*        TERMIDERR   (8820-TERM-ERROR)
  7546*        TRANSIDERR  (8830-TRAN-ERROR)
  7547*    END-EXEC.
  7548*    MOVE '"$[\                  ! $ #00007421' TO DFHEIV0
  7549     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7551     MOVE X'2420233030303037343231' TO DFHEIV0(25:11)
  7552     CALL 'kxdfhei1' USING DFHEIV0
  7553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7554
  7555
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 143
* EL130.cbl
  7556     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7557     MOVE '1'                    TO  CNTL-REC-TYPE.
  7558     MOVE SPACES                 TO  CNTL-ACCESS.
  7559     MOVE +0                     TO  CNTL-SEQ-NO.
  7560     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7561
  7562     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7563
  7564     IF CF-FORMS-PRINTER-ID = SPACES
  7565         IF ALTPRTL NOT GREATER THAN 0
  7566             MOVE ER-0337        TO  EMI-ERROR
  7567             MOVE -1             TO  ALTPRTL
  7568             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7569             GO TO 8200-SEND-DATAONLY
  7570         END-IF
  7571     END-IF.
  7572
  7573     IF ALTPRTL GREATER THAN 0
  7574         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7575     END-IF.
  7576
  7577     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7578     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7579     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7580
  7581
  7582
  7583* EXEC CICS START
  7584*        TRANSID   (START-TRANS-ID)
  7585*        TERMID    (CF-FORMS-PRINTER-ID)
  7586*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7587*        LENGTH    (PI-COMM-LENGTH)
  7588*    END-EXEC.
  7589*    MOVE '0( LFT                1   #00007452' TO DFHEIV0
  7590     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7591     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7592     MOVE X'2020233030303037343532' TO DFHEIV0(25:11)
  7593     CALL 'kxdfhei1' USING DFHEIV0,
  7594           DFHEIV99,
  7595           START-TRANS-ID,
  7596           DFHEIV99,
  7597           PROGRAM-INTERFACE-BLOCK,
  7598           PI-COMM-LENGTH,
  7599           CF-FORMS-PRINTER-ID,
  7600           DFHEIV99,
  7601           DFHEIV99,
  7602           DFHEIV99,
  7603           DFHEIV99,
  7604           DFHEIV99,
  7605           DFHEIV99,
  7606           DFHEIV99,
  7607           DFHEIV99,
  7608           DFHEIV99,
  7609           DFHEIV99
  7610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7611
  7612
  7613     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 144
* EL130.cbl
  7614                                     ALTPRTA.
  7615
  7616     MOVE SPACES                 TO  PRTOPTO
  7617                                     ALTPRTO.
  7618
  7619     MOVE ER-0000                TO  EMI-ERROR.
  7620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7621     MOVE -1                     TO  MAINTL.
  7622     GO TO 8100-SEND-INITIAL-MAP.
  7623
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 145
* EL130.cbl
  7625 0500-CREATE-TEMP-STORAGE.
  7626     MOVE EIBCPOSN               TO PI-CURSOR.
  7627
  7628    move emi-line1               to errmsg1o
  7629    move emi-line2               to errmsg2o
  7630    move emi-sub                 to pi-emi-sub
  7631
  7632
  7633* EXEC CICS WRITEQ TS
  7634*        QUEUE   (QID)
  7635*        FROM    (EL130AI)
  7636*        LENGTH  (QID-MAP-LENGTH)
  7637*    END-EXEC.
  7638*    MOVE '*"                    ''   #00007478' TO DFHEIV0
  7639     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7640     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7641     MOVE X'2020233030303037343738' TO DFHEIV0(25:11)
  7642     CALL 'kxdfhei1' USING DFHEIV0,
  7643           QID,
  7644           EL130AI,
  7645           QID-MAP-LENGTH,
  7646           DFHEIV99,
  7647           DFHEIV99,
  7648           DFHEIV99
  7649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7650
  7651
  7652
  7653
  7654* EXEC CICS WRITEQ TS
  7655*        QUEUE    (QID)
  7656*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7657*        LENGTH   (PI-COMM-LENGTH)
  7658*    END-EXEC.
  7659*    MOVE '*"                    ''   #00007485' TO DFHEIV0
  7660     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7661     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7662     MOVE X'2020233030303037343835' TO DFHEIV0(25:11)
  7663     CALL 'kxdfhei1' USING DFHEIV0,
  7664           QID,
  7665           PROGRAM-INTERFACE-BLOCK,
  7666           PI-COMM-LENGTH,
  7667           DFHEIV99,
  7668           DFHEIV99,
  7669           DFHEIV99
  7670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7671
  7672
  7673 0599-EXIT.
  7674      EXIT.
  7675
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 146
* EL130.cbl
  7677 0600-RECOVER-TEMP-STORAGE.
  7678     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7679     MOVE PI-EL127-TO-EL130-CNTRL
  7680                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7681     MOVE PI-EL659-TO-EL130-CNTRL
  7682                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7683     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7684     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7685     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7686     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7687     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7688     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7689     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7690     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7691     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7692     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7693     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7694     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7695     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7696     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7697     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7698     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7699                                 TO SAVE-BENEFICIARY
  7700
  7701
  7702
  7703* EXEC CICS HANDLE CONDITION
  7704*        NOTFND  (0660-NOT-FOUND)
  7705*        QIDERR  (0670-QIDERR)
  7706*    END-EXEC.
  7707*    MOVE '"$IN                  ! % #00007520' TO DFHEIV0
  7708     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7710     MOVE X'2520233030303037353230' TO DFHEIV0(25:11)
  7711     CALL 'kxdfhei1' USING DFHEIV0
  7712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7713
  7714
  7715
  7716
  7717* EXEC CICS READQ TS
  7718*        QUEUE    (QID)
  7719*        INTO     (EL130AI)
  7720*        LENGTH   (QID-MAP-LENGTH)
  7721*    END-EXEC.
  7722*    MOVE '*$I    L              ''   #00007526' TO DFHEIV0
  7723     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7724     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7725     MOVE X'2020233030303037353236' TO DFHEIV0(25:11)
  7726     CALL 'kxdfhei1' USING DFHEIV0,
  7727           QID,
  7728           EL130AI,
  7729           QID-MAP-LENGTH,
  7730           DFHEIV99,
  7731           DFHEIV99,
  7732           DFHEIV99
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7734
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 147
* EL130.cbl
  7735
  7736     IF RETURNED-FROM = XCTL-131
  7737        IF CLAIM-DELETED-BY-EL131
  7738            MOVE LOW-VALUES      TO CERTNOI
  7739                                    SUFXI
  7740            MOVE ZEROS           TO CERTNOL
  7741                                    SUFXL
  7742         END-IF
  7743     END-IF.
  7744
  7745     IF RETURNED-FROM = XCTL-131
  7746         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7747         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7748                                    PI-CERT-PROCESSED
  7749     ELSE
  7750
  7751
  7752* EXEC CICS READQ TS
  7753*             QUEUE   (QID)
  7754*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7755*             LENGTH  (PI-COMM-LENGTH)
  7756*        END-EXEC
  7757*    MOVE '*$I    L              ''   #00007547' TO DFHEIV0
  7758     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7760     MOVE X'2020233030303037353437' TO DFHEIV0(25:11)
  7761     CALL 'kxdfhei1' USING DFHEIV0,
  7762           QID,
  7763           PROGRAM-INTERFACE-BLOCK,
  7764           PI-COMM-LENGTH,
  7765           DFHEIV99,
  7766           DFHEIV99,
  7767           DFHEIV99
  7768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7769     END-IF.
  7770
  7771
  7772* EXEC CICS DELETEQ TS
  7773*        QUEUE   (QID)
  7774*    END-EXEC.
  7775*    MOVE '*&                    #   #00007554' TO DFHEIV0
  7776     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7777     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7778     MOVE X'2020233030303037353534' TO DFHEIV0(25:11)
  7779     CALL 'kxdfhei1' USING DFHEIV0,
  7780           QID,
  7781           DFHEIV99
  7782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7783
  7784
  7785     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7786
  7787     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7788         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7789         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7790         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7791         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7792         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 148
* EL130.cbl
  7793         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7794         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7795         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7796         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7797         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7798         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7799         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7800         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7801         MOVE SAVE-CERT-ACCESS-CONTROL
  7802                                    TO PI-CERT-ACCESS-CONTROL
  7803         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7804                                    TO PI-CARRIER-CONTROL-LEVEL
  7805     END-IF.
  7806
  7807     IF EIBAID = DFHPF11
  7808        move errmsg1i            to emi-line1
  7809        move errmsg2i            to emi-line2
  7810        move pi-emi-sub          to emi-sub
  7811        go to 8200-SEND-DATAONLY
  7812     end-if
  7813     IF RETURNED-FROM = XCTL-127
  7814         MOVE SAVE-EL127-TO-EL130-CNTRL
  7815                                 TO PI-EL127-TO-EL130-CNTRL
  7816     END-IF.
  7817
  7818     IF RETURNED-FROM = XCTL-6592
  7819        MOVE SAVE-EL659-TO-EL130-CNTRL
  7820                                 TO PI-EL659-TO-EL130-CNTRL
  7821     END-IF.
  7822
  7823     IF RETURNED-FROM = XCTL-114
  7824        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7825           MOVE SAVE-BENEFICIARY TO BENECDI
  7826           MOVE +10              TO BENECDL
  7827           MOVE -1               TO BIRTHDTL
  7828        END-IF
  7829     END-IF.
  7830     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7831
  7832     IF MAINTL NOT = ZERO
  7833         MOVE AL-UANON           TO MAINTA
  7834     END-IF.
  7835
  7836     IF ENTERPFL NOT = ZERO
  7837         MOVE AL-UNNON           TO ENTERPFA
  7838     END-IF.
  7839
  7840     IF RETURNED-FROM = XCTL-127
  7841         GO TO 0650-FROM-EL127
  7842     END-IF.
  7843
  7844     IF RETURNED-FROM = XCTL-132
  7845         GO TO 0640-FROM-EL132
  7846     END-IF.
  7847
  7848     IF RETURNED-FROM = XCTL-650
  7849         MOVE AL-SABON           TO PF5A
  7850         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 149
* EL130.cbl
  7851     END-IF.
  7852
  7853     IF RETURNED-FROM = XCTL-6592
  7854         GO TO 0630-FROM-EL6592
  7855     END-IF.
  7856
  7857     IF MAINTI = 'S' OR 'I'
  7858        GO TO 1000-SHOW-CLAIM
  7859     END-IF.
  7860
  7861     GO TO 8100-SEND-INITIAL-MAP.
  7862
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 150
* EL130.cbl
  7864 0630-FROM-EL6592.
  7865     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7866     MOVE PI-EL659-GROUPING      TO GROUPO.
  7867     MOVE PI-EL659-STATE         TO STATEO.
  7868     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7869
  7870     MOVE AL-UANON               TO CRTCARRA
  7871                                    GROUPA
  7872                                    STATEA
  7873                                    ACCOUNTA.
  7874     GO TO 8100-SEND-INITIAL-MAP.
  7875
  7876 0640-FROM-EL132.
  7877     IF PI-CLAIM-NO = SPACES
  7878         GO TO 0645-NO-CLAIM-SELECTED
  7879     END-IF.
  7880
  7881     MOVE LOW-VALUES             TO EL130AI.
  7882     MOVE 'MSTR'                 TO FILE-SWITCH.
  7883     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7884     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7885     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7886                                    CLMNOO.
  7887     MOVE AL-UANON               TO CLMNOA.
  7888     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7889
  7890
  7891
  7892* EXEC CICS HANDLE CONDITION
  7893*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7894*    END-EXEC.
  7895*    MOVE '"$I                   ! & #00007664' TO DFHEIV0
  7896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7898     MOVE X'2620233030303037363634' TO DFHEIV0(25:11)
  7899     CALL 'kxdfhei1' USING DFHEIV0
  7900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7901
  7902
  7903     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7904     MOVE 'X'                    TO CLAIM-SWITCH.
  7905     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7906     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7907     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7908     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7909
  7910     MOVE ER-0213                TO EMI-ERROR.
  7911     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7912     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7913     GO TO 8100-SEND-INITIAL-MAP.
  7914
  7915 0645-NO-CLAIM-SELECTED.
  7916
  7917     IF MAINTI = 'S' OR 'I'
  7918        GO TO 1000-SHOW-CLAIM
  7919     END-IF.
  7920
  7921     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 151
* EL130.cbl
  7922
  7923 0650-FROM-EL127.
  7924
  7925     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7926         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7927                                    PI-CERT-PROCESSED
  7928     END-IF.
  7929
  7930     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7931         MOVE +1                 TO PI-CERT-SELECT-CNT
  7932                                    PI-CERT-PROCESSED
  7933         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7934         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7935         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7936         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7937         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7938         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7939     END-IF.
  7940
  7941     IF PI-CERT-SELECT-CNT = ZERO
  7942         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7943             MOVE CERTNOI        TO PI-CERT-NO
  7944             MOVE SUFXI          TO PI-CERT-SFX
  7945             GO TO 3000-READ-CERT
  7946         ELSE
  7947             GO TO 8100-SEND-INITIAL-MAP
  7948         END-IF
  7949     END-IF.
  7950
  7951     MOVE AL-SABON               TO PF5A.
  7952
  7953     IF PI-CERT-PROCESSED = 1
  7954         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7955     END-IF.
  7956
  7957     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7958     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7959
  7960     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7961     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7962                                 TO CERT-CARRIER
  7963                                    PI-CARRIER.
  7964     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7965                                 TO CERT-GROUPING
  7966                                    PI-GROUPING.
  7967     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7968                                 TO CERT-STATE
  7969                                    PI-STATE.
  7970     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7971                                 TO CERT-ACCOUNT
  7972                                    PI-ACCOUNT.
  7973     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7974                                 TO CERT-EFF-DT
  7975                                    PI-CERT-EFF-DT.
  7976     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7977                                 TO CERT-CERT-NO
  7978                                    PI-CERT-NO.
  7979
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 152
* EL130.cbl
  7980     MOVE 'CERT'                 TO FILE-SWITCH.
  7981     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7982
  7983     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  7984     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  7985     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  7986
  7987     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  7988         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  7989         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  7990         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  7991         IF INCURRED-DATE-MATCH
  7992             MOVE ER-7352        TO EMI-ERROR
  7993             MOVE -1             TO CERTNOL
  7994             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7995         ELSE
  7996             IF NO-CLAIMS-FOR-CERT
  7997                 MOVE ER-7353    TO EMI-ERROR
  7998                 MOVE -1         TO CERTNOL
  7999                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8000             ELSE
  8001                 MOVE ER-0558    TO EMI-ERROR
  8002                 MOVE -1         TO CERTNOL
  8003                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8004             END-IF
  8005         END-IF
  8006     END-IF.
  8007
  8008     MOVE SPACES                 TO PI-PRT-OPT
  8009                                    PI-ALT-PRT.
  8010
  8011     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8012
  8013     IF LSTNMEL NOT GREATER ZERO
  8014        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8015         MOVE CRTLNMEI           TO  LSTNMEO
  8016         MOVE CRTFNMEI           TO  FSTNMEO
  8017         MOVE CRTINITI           TO  INITO
  8018         MOVE AL-UANON           TO  LSTNMEA
  8019                                     FSTNMEA
  8020                                     INITA
  8021     END-IF.
  8022
  8023     IF SSNL GREATER ZERO
  8024         GO TO 0655-SKIP-SOCIAL-SECURITY
  8025     END-IF.
  8026
  8027     IF CRTSSNI = SPACES OR LOW-VALUES
  8028         GO TO 0655-SKIP-SOCIAL-SECURITY
  8029     END-IF.
  8030
  8031     IF CM-SSN-STATE   = CM-STATE AND
  8032        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8033            GO TO 0655-SKIP-SOCIAL-SECURITY
  8034     END-IF.
  8035
  8036     MOVE CRTSSNI                TO SSNO
  8037     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 153
* EL130.cbl
  8038
  8039 0655-SKIP-SOCIAL-SECURITY.
  8040
  8041     IF CLMCARRL NOT = ZERO  AND
  8042        CLMCARRI NOT = CRTCARRI
  8043        MOVE ER-0562             TO EMI-ERROR
  8044        MOVE AL-UABON            TO CLMCARRA
  8045        MOVE -1                  TO CLMCARRL
  8046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8047     END-IF.
  8048
  8049     IF CLMCARRL = ZERO
  8050        MOVE AL-UANON            TO CLMCARRA
  8051        MOVE CRTCARRI            TO CLMCARRI
  8052     END-IF.
  8053
  8054     MOVE 'A'                    TO MAINTO.
  8055     MOVE AL-UANON               TO MAINTA.
  8056
  8057     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8058        GO TO 8100-SEND-INITIAL-MAP
  8059     ELSE
  8060        GO TO 8150-SEND-MAP-CURSOR
  8061     END-IF.
  8062
  8063 0660-NOT-FOUND.
  8064     MOVE ER-0214                TO EMI-ERROR.
  8065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8066     GO TO 8100-SEND-INITIAL-MAP.
  8067
  8068 0670-QIDERR.
  8069     MOVE ER-0033                TO EMI-ERROR.
  8070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8071     GO TO 8100-SEND-INITIAL-MAP.
  8072
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 154
* EL130.cbl
  8074 0680-PLUG-SELECTED-CERTS.
  8075
  8076     MOVE AL-SANON               TO BCERT1A
  8077                                    BSUFX1A
  8078                                    BCERT2A
  8079                                    BSUFX2A
  8080                                    BCERT3A
  8081                                    BSUFX3A
  8082                                    BCERT4A
  8083                                    BSUFX4A
  8084                                    BCERT5A
  8085                                    BSUFX5A.
  8086
  8087     IF PCERTNOO = SPACES OR LOW-VALUES
  8088         MOVE PI-EL127-CERT-PRIME (1)
  8089                                 TO PCERTNOO
  8090         MOVE PI-EL127-CERT-SUFX  (1)
  8091                                 TO PSUFXO
  8092     END-IF.
  8093
  8094     MOVE PI-EL127-CERT-PRIME (1)
  8095                                 TO BCERT1O.
  8096     MOVE PI-EL127-CERT-SUFX  (1)
  8097                                 TO BSUFX1O.
  8098
  8099     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8100         MOVE PI-EL127-CERT-PRIME (2)
  8101                                 TO BCERT2O
  8102         MOVE PI-EL127-CERT-SUFX  (2)
  8103                                 TO BSUFX2O
  8104     ELSE
  8105         MOVE LOW-VALUES         TO BCERT2O
  8106                                    BSUFX2O
  8107     END-IF.
  8108
  8109     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8110         MOVE PI-EL127-CERT-PRIME (3)
  8111                                 TO BCERT3O
  8112         MOVE PI-EL127-CERT-SUFX  (3)
  8113                                 TO BSUFX3O
  8114     ELSE
  8115         MOVE LOW-VALUES         TO BCERT3O
  8116                                    BSUFX3O
  8117     END-IF.
  8118
  8119     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8120         MOVE PI-EL127-CERT-PRIME (4)
  8121                                 TO BCERT4O
  8122         MOVE PI-EL127-CERT-SUFX  (4)
  8123                                 TO BSUFX4O
  8124     ELSE
  8125         MOVE LOW-VALUES         TO BCERT4O
  8126                                    BSUFX4O
  8127     END-IF.
  8128
  8129     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8130         MOVE PI-EL127-CERT-PRIME (5)
  8131                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 155
* EL130.cbl
  8132         MOVE PI-EL127-CERT-SUFX  (5)
  8133                                 TO BSUFX5O
  8134     ELSE
  8135         MOVE LOW-VALUES         TO BCERT5O
  8136                                    BSUFX5O
  8137     END-IF.
  8138
  8139 0680-EXIT.
  8140     EXIT.
  8141
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 156
* EL130.cbl
  8143 0690-HIGHLIGHT-CERTS.
  8144
  8145     MOVE AL-UANON               TO PCERTNOA
  8146                                    PSUFXA.
  8147
  8148     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8149        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8150            MOVE AL-SABON        TO BCERT1A
  8151                                    BSUFX1A
  8152     ELSE
  8153         MOVE AL-SANON           TO BCERT1A
  8154                                    BSUFX1A
  8155     END-IF.
  8156
  8157     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8158        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8159            MOVE AL-SABON        TO BCERT2A
  8160                                    BSUFX2A
  8161     ELSE
  8162         MOVE AL-SANON           TO BCERT2A
  8163                                    BSUFX2A
  8164     END-IF.
  8165
  8166     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8167        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8168            MOVE AL-SABON        TO BCERT3A
  8169                                    BSUFX3A
  8170     ELSE
  8171         MOVE AL-SANON           TO BCERT3A
  8172                                    BSUFX3A
  8173     END-IF.
  8174
  8175     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8176        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8177            MOVE AL-SABON        TO BCERT4A
  8178                                    BSUFX4A
  8179     ELSE
  8180         MOVE AL-SANON           TO BCERT4A
  8181                                    BSUFX4A
  8182     END-IF.
  8183
  8184     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8185        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8186            MOVE AL-SABON        TO BCERT5A
  8187                                    BSUFX5A
  8188     ELSE
  8189         MOVE AL-SANON           TO BCERT5A
  8190                                    BSUFX5A
  8191     END-IF.
  8192
  8193 0690-EXIT.
  8194     EXIT.
  8195
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 157
* EL130.cbl
  8197 0800-TEST-PREVIOUS-CONTROL.
  8198     IF CLMNOI   = PI-LAST-CLAIM       AND
  8199        CLMCARRI = PI-LAST-CARR        AND
  8200        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8201        SUFXI    = PI-LAST-CERT-SUFX
  8202*        NEXT SENTENCE
  8203         CONTINUE
  8204     ELSE
  8205         MOVE ER-0207            TO EMI-ERROR
  8206         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8207         MOVE -1                 TO MAINTL
  8208         GO TO 8200-SEND-DATAONLY
  8209     END-IF.
  8210
  8211     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8212
  8213     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8214     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8215     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8216
  8217     IF EIBAID = DFHPF7
  8218         MOVE XCTL-157           TO PGM-NAME
  8219     END-IF.
  8220
  8221     IF EIBAID = DFHPF8
  8222         MOVE XCTL-141           TO PGM-NAME
  8223     END-IF.
  8224
  8225     IF EIBAID = DFHPF9
  8226        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8227                                    PI-SAVED-PROGRAM-2
  8228                                    PI-SAVED-PROGRAM-3
  8229                                    PI-SAVED-PROGRAM-4
  8230                                    PI-SAVED-PROGRAM-5
  8231                                    PI-SAVED-PROGRAM-6
  8232        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8233        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8234        MOVE XCTL-150            TO PGM-NAME
  8235     END-IF.
  8236
  8237     GO TO 9300-XCTL.
  8238
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 158
* EL130.cbl
  8240 1000-SHOW-CLAIM.
  8241
  8242     IF CLMNOL = ZERO
  8243         MOVE -1                 TO CLMNOL
  8244         MOVE AL-UABON           TO CLMNOA
  8245         MOVE ER-0202            TO EMI-ERROR
  8246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8247     ELSE
  8248         MOVE AL-UANON           TO CLMNOA
  8249     END-IF.
  8250
  8251     IF PI-NO-CARRIER-SECURITY
  8252        IF CLMCARRL = ZERO
  8253             MOVE -1             TO CLMCARRL
  8254             MOVE AL-UABON       TO CLMCARRA
  8255             MOVE ER-0194        TO EMI-ERROR
  8256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257         ELSE
  8258             MOVE AL-UANON       TO CLMCARRA
  8259         END-IF
  8260     END-IF.
  8261
  8262     IF SUFXL = ZERO
  8263         MOVE SPACES             TO SUFXI
  8264         MOVE AL-UANON           TO SUFXA
  8265     ELSE
  8266         MOVE AL-UANON           TO SUFXA
  8267     END-IF.
  8268
  8269     IF NOT EMI-NO-ERRORS
  8270         GO TO 1050-SEND-CHECK
  8271     END-IF.
  8272
  8273
  8274
  8275* EXEC CICS HANDLE CONDITION
  8276*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8277*    END-EXEC.
  8278*    MOVE '"$I                   ! '' #00008039' TO DFHEIV0
  8279     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8281     MOVE X'2720233030303038303339' TO DFHEIV0(25:11)
  8282     CALL 'kxdfhei1' USING DFHEIV0
  8283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8284
  8285
  8286     MOVE 'MSTR'                 TO FILE-SWITCH
  8287     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8288
  8289     MOVE CLMCARRI               TO MSTR-CARRIER.
  8290     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8291
  8292     IF CERTNOL = ZERO     OR
  8293        CERTNOI = SPACES   OR
  8294        CERTNOI = LOW-VALUES
  8295         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8296         MOVE AL-SANON        TO CERTNOA
  8297                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 159
* EL130.cbl
  8298     ELSE
  8299         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8300     END-IF.
  8301
  8302     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8303     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8304
  8305
  8306
  8307* EXEC CICS HANDLE CONDITION
  8308*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8309*    END-EXEC.
  8310*    MOVE '"$I                   ! ( #00008063' TO DFHEIV0
  8311     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8313     MOVE X'2820233030303038303633' TO DFHEIV0(25:11)
  8314     CALL 'kxdfhei1' USING DFHEIV0
  8315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8316
  8317
  8318     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8319
  8320     IF NOT PI-NO-ACCOUNT-SECURITY
  8321         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8322           MOVE ER-2371          TO EMI-ERROR
  8323           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8324           MOVE -1               TO MAINTL
  8325           GO TO 8200-SEND-DATAONLY
  8326         END-IF
  8327     END-IF.
  8328
  8329
  8330
  8331* EXEC CICS HANDLE CONDITION
  8332*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8333*    END-EXEC.
  8334*    MOVE '"$I                   ! ) #00008079' TO DFHEIV0
  8335     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8337     MOVE X'2920233030303038303739' TO DFHEIV0(25:11)
  8338     CALL 'kxdfhei1' USING DFHEIV0
  8339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8340
  8341
  8342     MOVE 'Y'                    TO CLAIM-SWITCH.
  8343     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8344     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8345     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8346
  8347 1000-SHOW-END-OF-PERFORM.
  8348
  8349     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8350     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8351     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8352     MOVE CL-CERT-STATE          TO CERT-STATE.
  8353     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8354     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8355     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 160
* EL130.cbl
  8356
  8357     MOVE 'CERT'                 TO FILE-SWITCH.
  8358
  8359     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8360
  8361     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8362     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8363     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8364     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8365     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8366     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8367     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8368     MOVE CLMCARRI               TO PI-LAST-CARR.
  8369
  8370     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8371
  8372     IF MAINTI = 'I'
  8373         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8374                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8375                 LOANNOA   LOANBALA  BENECDA
  8376         MOVE AL-SANON TO  SSNA
  8377         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8378         MOVE 'Y'      TO PI-INCURR-SW
  8379         MOVE ER-0522  TO EMI-ERROR
  8380         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8381     ELSE
  8382         MOVE ' '      TO PI-INCURR-SW
  8383     END-IF.
  8384
  8385     MOVE -1                     TO MAINTL.
  8386     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8387     MOVE CERT-GROUPING          TO PI-GROUPING.
  8388     MOVE CERT-STATE             TO PI-STATE.
  8389     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8390     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8391     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8392     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8393
  8394     IF RETURNED-FROM NOT = SPACES
  8395         GO TO 8100-SEND-INITIAL-MAP
  8396     ELSE
  8397         GO TO 8200-SEND-DATAONLY
  8398     END-IF.
  8399
  8400 1025-SHOW-RECORD-NOT-FOUND.
  8401
  8402     IF FILE-SWITCH = 'MSTR'
  8403         MOVE ER-0204            TO EMI-ERROR
  8404     ELSE
  8405         IF FILE-SWITCH = 'TRLR'
  8406             MOVE ER-0205        TO EMI-ERROR
  8407         ELSE
  8408             MOVE ER-0206        TO EMI-ERROR
  8409         END-IF
  8410     END-IF.
  8411
  8412     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8413
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 161
* EL130.cbl
  8414 1050-SEND-CHECK.
  8415
  8416     IF RETURNED-FROM NOT = SPACES
  8417         GO TO 8100-SEND-INITIAL-MAP
  8418     ELSE
  8419         MOVE -1                 TO MAINTL
  8420         GO TO 8200-SEND-DATAONLY
  8421     END-IF.
  8422
  8423 2000-DELETE-CLAIM.
  8424     IF NOT MODIFY-CAP
  8425         MOVE ER-0070            TO EMI-ERROR
  8426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8427         MOVE -1                 TO MAINTL
  8428         GO TO 8200-SEND-DATAONLY
  8429     END-IF.
  8430
  8431     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8432        CLMCARRI NOT = PI-LAST-CARR        OR
  8433        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8434        SUFXI    NOT = PI-LAST-CERT-SUFX
  8435         MOVE ER-0207            TO EMI-ERROR
  8436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8437         MOVE -1                 TO MAINTL
  8438         GO TO 8200-SEND-DATAONLY
  8439     END-IF.
  8440
  8441
  8442
  8443* EXEC CICS HANDLE CONDITION
  8444*        NOTFND   (2050-DELETE-NOT-FOUND)
  8445*    END-EXEC.
  8446*    MOVE '"$I                   ! * #00008183' TO DFHEIV0
  8447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8449     MOVE X'2A20233030303038313833' TO DFHEIV0(25:11)
  8450     CALL 'kxdfhei1' USING DFHEIV0
  8451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8452
  8453
  8454     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8455
  8456     MOVE CLMCARRI               TO MSTR-CARRIER.
  8457     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8458     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8459     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8460
  8461     MOVE 'MSTR'                 TO FILE-SWITCH.
  8462     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8463
  8464     MOVE 'Y'                    TO CLAIM-SWITCH.
  8465
  8466     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8467        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8468         MOVE ER-0068        TO EMI-ERROR
  8469         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8470         MOVE -1             TO MAINTL
  8471         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 162
* EL130.cbl
  8472     END-IF.
  8473
  8474     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8475         MOVE ER-0569            TO EMI-ERROR
  8476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8477         MOVE -1                 TO MAINTL
  8478         GO TO 8200-SEND-DATAONLY
  8479     END-IF.
  8480
  8481     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8482         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8483     END-IF.
  8484
  8485     IF CL-PURGED-DT NOT = LOW-VALUES
  8486         MOVE ER-7691            TO EMI-ERROR
  8487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8488         MOVE -1                 TO MAINTL
  8489         GO TO 8200-SEND-DATAONLY
  8490     END-IF.
  8491
  8492     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8493     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8494     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8495     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8496     MOVE +0                     TO TRLR-SEQ-NO.
  8497     MOVE '1'                    TO TRLR-TYPE.
  8498
  8499     MOVE 'TRLR'                 TO FILE-SWITCH.
  8500
  8501
  8502
  8503* EXEC CICS READ
  8504*        UPDATE
  8505*        DATASET  (ELTRLR-DSID)
  8506*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8507*        RIDFLD   (ELTRLR-KEY)
  8508*    END-EXEC.
  8509*    MOVE '&"S        EU         (   #00008235' TO DFHEIV0
  8510     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8512     MOVE X'2020233030303038323335' TO DFHEIV0(25:11)
  8513     CALL 'kxdfhei1' USING DFHEIV0,
  8514           ELTRLR-DSID,
  8515           DFHEIV20,
  8516           DFHEIV99,
  8517           ELTRLR-KEY,
  8518           DFHEIV99,
  8519           DFHEIV99,
  8520           DFHEIV99
  8521     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8522         DFHEIV20
  8523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8524
  8525
  8526     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8527        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8528         MOVE ER-0068        TO EMI-ERROR
  8529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 163
* EL130.cbl
  8530         MOVE -1             TO MAINTL
  8531         GO TO 8200-SEND-DATAONLY
  8532     END-IF.
  8533
  8534
  8535
  8536* EXEC CICS DELETE
  8537*        DATASET   (ELTRLR-DSID)
  8538*    END-EXEC.
  8539*    MOVE '&(                    &   #00008251' TO DFHEIV0
  8540     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8542     MOVE X'2020233030303038323531' TO DFHEIV0(25:11)
  8543     CALL 'kxdfhei1' USING DFHEIV0,
  8544           ELTRLR-DSID,
  8545           DFHEIV99,
  8546           DFHEIV99,
  8547           DFHEIV99,
  8548           DFHEIV99
  8549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8550
  8551
  8552     MOVE +90                    TO TRLR-SEQ-NO.
  8553     MOVE '6'                    TO TRLR-TYPE.
  8554
  8555
  8556
  8557* EXEC CICS READ
  8558*        UPDATE
  8559*        DATASET  (ELTRLR-DSID)
  8560*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8561*        RIDFLD   (ELTRLR-KEY)
  8562*    END-EXEC.
  8563*    MOVE '&"S        EU         (   #00008259' TO DFHEIV0
  8564     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8565     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8566     MOVE X'2020233030303038323539' TO DFHEIV0(25:11)
  8567     CALL 'kxdfhei1' USING DFHEIV0,
  8568           ELTRLR-DSID,
  8569           DFHEIV20,
  8570           DFHEIV99,
  8571           ELTRLR-KEY,
  8572           DFHEIV99,
  8573           DFHEIV99,
  8574           DFHEIV99
  8575     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8576         DFHEIV20
  8577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8578
  8579
  8580
  8581
  8582* EXEC CICS DELETE
  8583*        DATASET   (ELTRLR-DSID)
  8584*    END-EXEC.
  8585*    MOVE '&(                    &   #00008267' TO DFHEIV0
  8586     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8587     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 164
* EL130.cbl
  8588     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  8589     CALL 'kxdfhei1' USING DFHEIV0,
  8590           ELTRLR-DSID,
  8591           DFHEIV99,
  8592           DFHEIV99,
  8593           DFHEIV99,
  8594           DFHEIV99
  8595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8596
  8597
  8598     MOVE +91                    TO TRLR-SEQ-NO.
  8599     MOVE '6'                    TO TRLR-TYPE.
  8600
  8601
  8602
  8603* EXEC CICS READ
  8604*        UPDATE
  8605*        DATASET  (ELTRLR-DSID)
  8606*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8607*        RIDFLD   (ELTRLR-KEY)
  8608*        RESP     (WS-RESPONSE)
  8609*    END-EXEC
  8610*    MOVE '&"S        EU         (  N#00008275' TO DFHEIV0
  8611     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8612     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8613     MOVE X'204E233030303038323735' TO DFHEIV0(25:11)
  8614     CALL 'kxdfhei1' USING DFHEIV0,
  8615           ELTRLR-DSID,
  8616           DFHEIV20,
  8617           DFHEIV99,
  8618           ELTRLR-KEY,
  8619           DFHEIV99,
  8620           DFHEIV99,
  8621           DFHEIV99
  8622     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8623         DFHEIV20
  8624     MOVE EIBRESP  TO WS-RESPONSE
  8625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8626
  8627     IF WS-RESP-NORMAL
  8628
  8629* EXEC CICS DELETE
  8630*          DATASET   (ELTRLR-DSID)
  8631*       END-EXEC
  8632*    MOVE '&(                    &   #00008284' TO DFHEIV0
  8633     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8634     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8635     MOVE X'2020233030303038323834' TO DFHEIV0(25:11)
  8636     CALL 'kxdfhei1' USING DFHEIV0,
  8637           ELTRLR-DSID,
  8638           DFHEIV99,
  8639           DFHEIV99,
  8640           DFHEIV99,
  8641           DFHEIV99
  8642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8643     END-IF.
  8644
  8645     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 165
* EL130.cbl
  8646     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8647     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8648     MOVE CL-CERT-STATE          TO CERT-STATE.
  8649     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8650     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8651     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8652
  8653     MOVE 'CERT'                 TO FILE-SWITCH.
  8654
  8655     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8656
  8657     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8658
  8659     IF WS-NUM-HOLD NOT = +0
  8660         GO TO 2005-REWRITE-CERT
  8661     END-IF.
  8662
  8663     IF NOT CERT-WAS-CREATED
  8664         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8665         GO TO 2005-REWRITE-CERT
  8666     END-IF.
  8667
  8668
  8669
  8670* EXEC CICS DELETE
  8671*        DATASET   (ELCERT-DSID)
  8672*    END-EXEC.
  8673*    MOVE '&(                    &   #00008313' TO DFHEIV0
  8674     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8675     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8676     MOVE X'2020233030303038333133' TO DFHEIV0(25:11)
  8677     CALL 'kxdfhei1' USING DFHEIV0,
  8678           ELCERT-DSID,
  8679           DFHEIV99,
  8680           DFHEIV99,
  8681           DFHEIV99,
  8682           DFHEIV99
  8683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8684
  8685
  8686     GO TO 2010-DELETE-CL.
  8687
  8688 2005-REWRITE-CERT.
  8689
  8690     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8691
  8692
  8693
  8694* EXEC CICS HANDLE CONDITION
  8695*         DUPKEY   (2010-DELETE-CL)
  8696*    END-EXEC.
  8697*    MOVE '"$$                   ! + #00008324' TO DFHEIV0
  8698     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8700     MOVE X'2B20233030303038333234' TO DFHEIV0(25:11)
  8701     CALL 'kxdfhei1' USING DFHEIV0
  8702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8703
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 166
* EL130.cbl
  8704
  8705
  8706
  8707* EXEC CICS REWRITE
  8708*        DATASET  (ELCERT-DSID)
  8709*        FROM     (CERTIFICATE-MASTER)
  8710*    END-EXEC.
  8711     MOVE LENGTH OF
  8712      CERTIFICATE-MASTER
  8713       TO DFHEIV11
  8714*    MOVE '&& L                  %   #00008329' TO DFHEIV0
  8715     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8716     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8717     MOVE X'2020233030303038333239' TO DFHEIV0(25:11)
  8718     CALL 'kxdfhei1' USING DFHEIV0,
  8719           ELCERT-DSID,
  8720           CERTIFICATE-MASTER,
  8721           DFHEIV11,
  8722           DFHEIV99
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8724
  8725
  8726 2010-DELETE-CL.
  8727
  8728
  8729
  8730* EXEC CICS DELETE
  8731*        DATASET  (ELMSTR-DSID)
  8732*    END-EXEC.
  8733*    MOVE '&(                    &   #00008337' TO DFHEIV0
  8734     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8735     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8736     MOVE X'2020233030303038333337' TO DFHEIV0(25:11)
  8737     CALL 'kxdfhei1' USING DFHEIV0,
  8738           ELMSTR-DSID,
  8739           DFHEIV99,
  8740           DFHEIV99,
  8741           DFHEIV99,
  8742           DFHEIV99
  8743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8744
  8745
  8746     MOVE -1                     TO ONE-OR-MIN1.
  8747     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8748
  8749     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8750         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8751                                    WS-SAVE-CLAIM-KEY
  8752         MOVE +1                 TO ONE-OR-MIN1
  8753         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8754     END-IF.
  8755
  8756     MOVE ER-0000                TO EMI-ERROR.
  8757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8758     MOVE LOW-VALUES             TO EL130AO.
  8759     MOVE -1                     TO MAINTL.
  8760     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8761     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 167
* EL130.cbl
  8762                                    PI-CERT-PROCESSED
  8763                                    PI-LETTER-ERROR-CODE.
  8764     GO TO 8100-SEND-INITIAL-MAP.
  8765
  8766 2050-DELETE-NOT-FOUND.
  8767     IF FILE-SWITCH = 'MSTR'
  8768         MOVE -1                 TO CLMNOL
  8769         MOVE ER-0204            TO EMI-ERROR
  8770     ELSE
  8771         IF FILE-SWITCH = 'TRLR'
  8772             MOVE -1             TO MAINTL
  8773             MOVE ER-0205        TO EMI-ERROR
  8774         ELSE
  8775             MOVE -1             TO CERTNOL
  8776             MOVE ER-0206        TO EMI-ERROR
  8777         END-IF
  8778     END-IF.
  8779
  8780     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8781     GO TO 8200-SEND-DATAONLY.
  8782
  8783 3000-ADD-CLAIM.
  8784     IF NOT MODIFY-CAP
  8785         MOVE ER-0070            TO EMI-ERROR
  8786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8787         MOVE -1                 TO MAINTL
  8788         GO TO 8200-SEND-DATAONLY
  8789     END-IF.
  8790
  8791     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8792
  8793     IF CERTMTI = 'S'
  8794         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8795            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8796            WS-EFFDT = PI-SAVE-EFFDT       AND
  8797            ACCOUNTI = PI-SAVE-ACCOUNT
  8798             IF EMI-ERROR = 0
  8799                 GO TO 3010-TEST-FOR-ERRORS
  8800             ELSE
  8801                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8802                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8803                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8804                 MOVE PI-STATE         TO  CERT-STATE
  8805                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8806                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8807                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8808
  8809
  8810* EXEC CICS HANDLE CONDITION
  8811*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8812*                END-EXEC
  8813*    MOVE '"$I                   ! , #00008404' TO DFHEIV0
  8814     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8816     MOVE X'2C20233030303038343034' TO DFHEIV0(25:11)
  8817     CALL 'kxdfhei1' USING DFHEIV0
  8818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8819                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 168
* EL130.cbl
  8820                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8821                 GO TO 3010-TEST-FOR-ERRORS
  8822             END-IF
  8823         END-IF
  8824     END-IF.
  8825
  8826     IF CERTMTI = 'A'
  8827         IF NOT PI-NO-CARRIER-SECURITY OR
  8828             NOT PI-NO-ACCOUNT-SECURITY
  8829             MOVE ER-2370          TO EMI-ERROR
  8830             MOVE -1               TO MAINTL
  8831             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8832             GO TO 8200-SEND-DATAONLY
  8833         ELSE
  8834             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8835             GO TO 3010-TEST-FOR-ERRORS
  8836         END-IF
  8837     END-IF.
  8838
  8839     IF CERTNOL = ZEROS
  8840        GO TO 3010-TEST-FOR-ERRORS
  8841     END-IF.
  8842
  8843 3000-READ-CERT.
  8844
  8845     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8846                                    MSTR5-COMP-CD.
  8847     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8848                                    MSTR5-CERT-NO-PRIME.
  8849     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8850                                    MSTR5-CERT-NO-SUFX.
  8851
  8852
  8853
  8854* EXEC CICS HANDLE CONDITION
  8855*         DUPKEY   (3008-DUP-ERROR)
  8856*         NOTFND   (3009-NOT-FOUND)
  8857*    END-EXEC
  8858*    MOVE '"$$I                  ! - #00008441' TO DFHEIV0
  8859     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8861     MOVE X'2D20233030303038343431' TO DFHEIV0(25:11)
  8862     CALL 'kxdfhei1' USING DFHEIV0
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8864
  8865     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8866
  8867     IF NOT PI-NO-ACCOUNT-SECURITY
  8868         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8869             MOVE ER-2371          TO EMI-ERROR
  8870             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8871             MOVE -1               TO MAINTL
  8872             GO TO 8200-SEND-DATAONLY
  8873         END-IF
  8874     END-IF.
  8875
  8876     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8877     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 169
* EL130.cbl
  8878     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8879     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8880     MOVE CM-CARRIER             TO PI-CARRIER.
  8881     MOVE CM-GROUPING            TO PI-GROUPING.
  8882     MOVE CM-STATE               TO PI-STATE.
  8883     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8884     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8885     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8886     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8887
  8888     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8889         IF LSTNMEO = SPACES OR LOW-VALUES
  8890             MOVE CRTLNMEI       TO  LSTNMEO
  8891             MOVE AL-UANON       TO  LSTNMEA
  8892         END-IF
  8893     END-IF.
  8894
  8895     MOVE 'S'                    TO CERTMTO.
  8896*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8897     MOVE AL-SANON               TO CERTNOA.
  8898     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8899                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8900     IF EMI-NO-ERRORS
  8901         MOVE -1                  TO MAINTL
  8902     END-IF.
  8903
  8904     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8905         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8906         IF INCURRED-DATE-MATCH
  8907             MOVE ER-7352         TO EMI-ERROR
  8908             MOVE -1              TO CERTNOL
  8909             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8910         ELSE
  8911             IF NO-CLAIMS-FOR-CERT
  8912                 MOVE ER-7353     TO EMI-ERROR
  8913                 MOVE -1          TO CERTNOL
  8914                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8915             ELSE
  8916                 MOVE ER-0558     TO EMI-ERROR
  8917                 MOVE -1          TO CERTNOL
  8918                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8919                 GO TO 3010-TEST-FOR-ERRORS
  8920             END-IF
  8921         END-IF
  8922     END-IF.
  8923
  8924 3007-SEND-SCREEN.
  8925     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8926         GO TO 8150-SEND-MAP-CURSOR
  8927     ELSE
  8928         GO TO 8200-SEND-DATAONLY
  8929     END-IF.
  8930
  8931 3008-DUP-ERROR.
  8932     MOVE ER-0560                TO EMI-ERROR.
  8933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8934     MOVE -1                     TO CERTNOL.
  8935     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 170
* EL130.cbl
  8936
  8937 3009-NOT-FOUND.
  8938     MOVE ER-0214                TO EMI-ERROR.
  8939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8940     MOVE -1                     TO CERTNOL.
  8941     GO TO 3007-SEND-SCREEN.
  8942
  8943 3010-TEST-FOR-ERRORS.
  8944
  8945     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8946     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8947     if pi-company-id = 'DCC'
  8948        perform 6500-get-acct    thru 6500-exit
  8949     end-if
  8950
  8951     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  8952     move +0                     to e1
  8953     move spaces                 to ws-dcc-error-line
  8954
  8955     IF PI-COMPANY-ID = 'DCC'
  8956        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  8957        IF ERPDEF-FOUND
  8958           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8959           MOVE WS-INCUR         TO DC-BIN-DATE-2
  8960           MOVE '1'              TO DC-OPTION-CODE
  8961           MOVE +0               TO DC-ELAPSED-MONTHS
  8962                                    DC-ELAPSED-DAYS
  8963           PERFORM 9700-LINK-DATE-CONVERT
  8964                                 THRU 9700-EXIT
  8965           IF NO-CONVERSION-ERROR
  8966              MOVE DC-ELAPSED-MONTHS
  8967                                 TO WS-MONTHS-BETWEEN
  8968              IF DC-ELAPSED-DAYS > 1
  8969                 ADD 1 TO WS-MONTHS-BETWEEN
  8970              END-IF
  8971           ELSE
  8972              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  8973           END-IF
  8974
  8975           evaluate true
  8976              when (ws-excl-period not = zeros)
  8977                 and (ws-months-between <= ws-excl-period)
  8978                 MOVE -1         TO MAINTL
  8979                 add +1          to e1
  8980                 MOVE ER-1651    TO EMI-ERROR
  8981                                    ws-error-no (e1)
  8982                 PERFORM 9900-ERROR-FORMAT
  8983                                 THRU 9900-EXIT
  8984              when (ws-cov-ends not = zeros)
  8985                 and (ws-months-between > ws-cov-ends)
  8986                 MOVE -1         TO MAINTL
  8987                 add +1          to e1
  8988                 MOVE ER-1653    TO EMI-ERROR
  8989                                    ws-error-no (e1)
  8990                 evaluate true
  8991                    when clmtypei = 'L'
  8992                       move '  LF  ' to emi-claim-type
  8993                    when clmtypei = 'I'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 171
* EL130.cbl
  8994                       move '  IU  ' to emi-claim-type
  8995                    when other
  8996                       move '  AH  ' to emi-claim-type
  8997                 end-evaluate
  8998                 PERFORM 9900-ERROR-FORMAT
  8999                                 THRU 9900-EXIT
  9000              when (ws-acc-period not = zeros)
  9001                 and (ws-months-between <= ws-acc-period)
  9002                 MOVE -1         TO MAINTL
  9003                 add +1          to e1
  9004                 MOVE ER-1652    TO EMI-ERROR
  9005                                    ws-error-no (e1)
  9006                 PERFORM 9900-ERROR-FORMAT
  9007                                 THRU 9900-EXIT
  9008                 add +1          to e1
  9009                 move er-1655    to emi-error
  9010                                    ws-error-no (e1)
  9011                 PERFORM 9900-ERROR-FORMAT
  9012                                 THRU 9900-EXIT
  9013              when clmtypei = 'I'
  9014                 add +1          to e1
  9015                 move er-1661    to emi-error
  9016                                    ws-error-no (e1)
  9017                 PERFORM 9900-ERROR-FORMAT
  9018                                 THRU 9900-EXIT
  9019           end-evaluate
  9020        END-IF
  9021        perform 3996-read-cert-claim-trailer
  9022                                 thru 3996-exit
  9023     END-IF
  9024     IF CERTMTI NOT = 'A'
  9025         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9026             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9027             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9028             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9029             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9030             IF INCURRED-DATE-MATCH
  9031                 MOVE ER-7352         TO EMI-ERROR
  9032                 MOVE -1              TO CERTNOL
  9033                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9034             ELSE
  9035                 IF NO-CLAIMS-FOR-CERT
  9036                     MOVE ER-7353     TO EMI-ERROR
  9037                     MOVE -1          TO CERTNOL
  9038                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9039                 ELSE
  9040                     MOVE ER-0558     TO EMI-ERROR
  9041                     MOVE -1          TO CERTNOL
  9042                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9043                 END-IF
  9044             END-IF
  9045         END-IF
  9046     END-IF.
  9047
  9048     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9049         MOVE ER-0433             TO EMI-ERROR
  9050         MOVE -1                  TO MAINTL
  9051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 172
* EL130.cbl
  9052         GO TO 8200-SEND-DATAONLY
  9053     END-IF.
  9054
  9055     IF (EMI-NO-ERRORS)
  9056        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9057         GO TO 3015-TRY-TO-BUILD
  9058     END-IF.
  9059
  9060     IF EIBAID = DFHPF6
  9061         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9062             MOVE ER-0434         TO EMI-ERROR
  9063             MOVE -1              TO MAINTL
  9064             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9065             GO TO 8200-SEND-DATAONLY
  9066         ELSE
  9067             MOVE +1              TO INCURL
  9068             GO TO 3015-TRY-TO-BUILD
  9069         END-IF
  9070     END-IF.
  9071
  9072     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9073         GO TO 8150-SEND-MAP-CURSOR
  9074     ELSE
  9075         GO TO 8200-SEND-DATAONLY
  9076     END-IF.
  9077
  9078 3015-TRY-TO-BUILD.
  9079     IF CLMNOL EQUAL ZERO
  9080         GO TO 3030-BUILD-CONT
  9081     END-IF.
  9082
  9083
  9084
  9085* EXEC CICS HANDLE CONDITION
  9086*        NOTFND   (3030-BUILD-CONT)
  9087*    END-EXEC.
  9088*    MOVE '"$I                   ! . #00008665' TO DFHEIV0
  9089     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9090     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9091     MOVE X'2E20233030303038363635' TO DFHEIV0(25:11)
  9092     CALL 'kxdfhei1' USING DFHEIV0
  9093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9094
  9095
  9096     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9097
  9098     MOVE CLMCARRI               TO MSTR-CARRIER.
  9099     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9100     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9101     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9102
  9103     MOVE 'MSTR'                 TO FILE-SWITCH.
  9104
  9105     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9106
  9107     MOVE ER-0221                TO EMI-ERROR.
  9108
  9109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 173
* EL130.cbl
  9110     MOVE -1                     TO MAINTL.
  9111     GO TO 8200-SEND-DATAONLY.
  9112
  9113 3030-BUILD-CONT.
  9114     IF (CERTMTI NOT = 'A')
  9115        and (pi-company-id not = 'DCC')
  9116         GO TO 3060-BUILD-CONT
  9117     END-IF.
  9118
  9119
  9120
  9121* EXEC CICS HANDLE CONDITION
  9122*        NOTFND   (3033-ACCT-NOT-FOUND)
  9123*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9124*    END-EXEC.
  9125*    MOVE '"$I''                  ! / #00008693' TO DFHEIV0
  9126     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9127     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9128     MOVE X'2F20233030303038363933' TO DFHEIV0(25:11)
  9129     CALL 'kxdfhei1' USING DFHEIV0
  9130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9131
  9132
  9133     MOVE SPACES                 TO ERACCT-KEY.
  9134
  9135     IF CARR-GROUP-ST-ACCNT-CNTL
  9136         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9137         MOVE CRTCARRI           TO ACCT-CARRIER
  9138         MOVE GROUPI             TO ACCT-GROUPING
  9139         MOVE STATEI             TO ACCT-STATE
  9140         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9141         GO TO 3031-MOVE-ACCT-KEY
  9142     END-IF.
  9143
  9144     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9145     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9146
  9147     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9148         MOVE STATEI             TO ACCT-STATE
  9149     END-IF.
  9150
  9151     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9152         MOVE CRTCARRI           TO ACCT-CARRIER
  9153     END-IF.
  9154
  9155 3031-MOVE-ACCT-KEY.
  9156     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9157
  9158
  9159
  9160* EXEC CICS STARTBR
  9161*        DATASET     (ERACCT2-DSID)
  9162*        RIDFLD      (SAVE-ERACCT-KEY)
  9163*        GENERIC
  9164*        KEYLENGTH   (20)
  9165*    END-EXEC.
  9166     MOVE 20
  9167       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 174
* EL130.cbl
  9168     MOVE 0
  9169       TO DFHEIV12
  9170*    MOVE '&,   KG    G          &   #00008724' TO DFHEIV0
  9171     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9172     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9173     MOVE X'2020233030303038373234' TO DFHEIV0(25:11)
  9174     CALL 'kxdfhei1' USING DFHEIV0,
  9175           ERACCT2-DSID,
  9176           SAVE-ERACCT-KEY,
  9177           DFHEIV11,
  9178           DFHEIV12,
  9179           DFHEIV99
  9180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9181
  9182
  9183
  9184
  9185* EXEC CICS HANDLE CONDITION
  9186*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9187*    END-EXEC.
  9188*    MOVE '"$''                   ! 0 #00008732' TO DFHEIV0
  9189     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9191     MOVE X'3020233030303038373332' TO DFHEIV0(25:11)
  9192     CALL 'kxdfhei1' USING DFHEIV0
  9193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9194
  9195
  9196 3031-READ-ACCT-LOOP.
  9197
  9198
  9199* EXEC CICS READNEXT
  9200*        DATASET   (ERACCT2-DSID)
  9201*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9202*        RIDFLD    (SAVE-ERACCT-KEY)
  9203*    END-EXEC.
  9204     MOVE 0
  9205       TO DFHEIV11
  9206*    MOVE '&.S                   )   #00008738' TO DFHEIV0
  9207     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9209     MOVE X'2020233030303038373338' TO DFHEIV0(25:11)
  9210     CALL 'kxdfhei1' USING DFHEIV0,
  9211           ERACCT2-DSID,
  9212           DFHEIV20,
  9213           DFHEIV99,
  9214           SAVE-ERACCT-KEY,
  9215           DFHEIV99,
  9216           DFHEIV11,
  9217           DFHEIV99,
  9218           DFHEIV99
  9219     SET ADDRESS OF ACCOUNT-MASTER TO
  9220         DFHEIV20
  9221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9222
  9223
  9224     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9225        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 175
* EL130.cbl
  9226        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9227        ACCT-STATE    NOT = AM-VG-STATE       OR
  9228        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9229         GO TO 3033-ACCT-NOT-FOUND
  9230     END-IF.
  9231
  9232     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9233        WS-EFFDT LESS AM-EXPIRATION-DT
  9234         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9235         MOVE AM-CARRIER       TO CERT-CARRIER
  9236         MOVE AM-GROUPING      TO CERT-GROUPING
  9237         MOVE AM-STATE         TO CERT-STATE
  9238         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9239         MOVE WS-EFFDT         TO CERT-EFF-DT
  9240         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9241         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9242         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9243         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9244     END-IF.
  9245
  9246     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9247         GO TO 3031-READ-ACCT-LOOP
  9248     END-IF.
  9249
  9250 3032-NOT-IN-DT-RANGE.
  9251     MOVE ER-0226                TO EMI-ERROR.
  9252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9253     MOVE -1                     TO EFFDTL.
  9254     GO TO 8200-SEND-DATAONLY.
  9255
  9256 3033-ACCT-NOT-FOUND.
  9257     MOVE ER-0226 TO EMI-ERROR.
  9258     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9259     MOVE -1                     TO ACCOUNTL.
  9260     GO TO 8200-SEND-DATAONLY.
  9261
  9262 3034-CHECK-EMPLOYER-STATEMENT.
  9263
  9264     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9265*        NEXT SENTENCE
  9266         CONTINUE
  9267     ELSE
  9268         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9269     END-IF.
  9270
  9271     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9272     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9273     MOVE '1'                    TO  DC-OPTION-CODE.
  9274     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9275                                     DC-ELAPSED-DAYS.
  9276     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9277
  9278     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9279         DC-ELAPSED-DAYS LESS THAN +31)
  9280                      OR
  9281        (AM-EMPLOYER-STMT-USED = '2' AND
  9282         DC-ELAPSED-DAYS LESS THAN +61)
  9283                      OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 176
* EL130.cbl
  9284        (AM-EMPLOYER-STMT-USED = '3' AND
  9285         DC-ELAPSED-DAYS LESS THAN +91)
  9286            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9287     END-IF.
  9288
  9289 3034-CHECK-ACCOUNT-LIMITS.
  9290
  9291     IF CERTMTI NOT = 'A'
  9292         GO TO 3060-BUILD-CONT
  9293     END-IF.
  9294
  9295     IF AM-STATUS NOT = '0'
  9296         MOVE ER-0225                TO EMI-ERROR
  9297         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9298         MOVE -1                     TO ACCOUNTL
  9299     END-IF.
  9300
  9301     IF EIBAID = DFHPF6
  9302         IF EMI-FATAL-CTR NOT = ZERO
  9303             MOVE ER-0434         TO EMI-ERROR
  9304             MOVE -1              TO MAINTL
  9305             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9306             GO TO 8200-SEND-DATAONLY
  9307         END-IF
  9308     END-IF.
  9309
  9310*    IF PI-COMPANY-ID NOT = 'CRI'
  9311*        GO TO 3035-END-BROWSE
  9312*    END-IF.
  9313
  9314 3035-END-BROWSE.
  9315
  9316
  9317* EXEC CICS ENDBR
  9318*        DATASET    (ERACCT2-DSID)
  9319*    END-EXEC.
  9320     MOVE 0
  9321       TO DFHEIV11
  9322*    MOVE '&2                    $   #00008836' TO DFHEIV0
  9323     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9324     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9325     MOVE X'2020233030303038383336' TO DFHEIV0(25:11)
  9326     CALL 'kxdfhei1' USING DFHEIV0,
  9327           ERACCT2-DSID,
  9328           DFHEIV11,
  9329           DFHEIV99
  9330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9331
  9332
  9333 3040-CHECK-CERT-ALREADY-ON.
  9334
  9335
  9336* EXEC CICS HANDLE CONDITION
  9337*        NOTFND   (3070-BUILD-CONT)
  9338*    END-EXEC.
  9339*    MOVE '"$I                   ! 1 #00008842' TO DFHEIV0
  9340     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 177
* EL130.cbl
  9342     MOVE X'3120233030303038383432' TO DFHEIV0(25:11)
  9343     CALL 'kxdfhei1' USING DFHEIV0
  9344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9345
  9346
  9347     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9348
  9349     MOVE ER-0229                TO EMI-ERROR.
  9350     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9351     MOVE -1                     TO MAINTL.
  9352     GO TO 8200-SEND-DATAONLY.
  9353
  9354 3060-BUILD-CONT.
  9355     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9356     MOVE CRTCARRI               TO CERT-CARRIER.
  9357     MOVE GROUPI                 TO CERT-GROUPING.
  9358     MOVE STATEI                 TO CERT-STATE.
  9359     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9360     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9361     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9362     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9363
  9364
  9365
  9366* EXEC CICS HANDLE CONDITION
  9367*        NOTFND  (3065-CERT-NOT-FOUND)
  9368*    END-EXEC.
  9369*    MOVE '"$I                   ! 2 #00008864' TO DFHEIV0
  9370     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9372     MOVE X'3220233030303038383634' TO DFHEIV0(25:11)
  9373     CALL 'kxdfhei1' USING DFHEIV0
  9374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9375
  9376
  9377     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9378
  9379     GO TO 3070-BUILD-CONT.
  9380
  9381 3065-CERT-NOT-FOUND.
  9382     MOVE ER-0244                TO EMI-ERROR.
  9383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9384     MOVE -1                     TO CERTNOL.
  9385     GO TO 8200-SEND-DATAONLY.
  9386
  9387 3070-BUILD-CONT.
  9388     IF CLMNOL NOT = ZERO
  9389         GO TO 3200-BUILD-ZERO-TRAILER
  9390     END-IF.
  9391
  9392     MOVE SPACES                 TO ELCNTL-KEY.
  9393
  9394     IF CONTROL-IS-ACTUAL-CARRIER
  9395         MOVE PI-CARRIER         TO CNTL-CARRIER
  9396     ELSE
  9397         MOVE PI-CARRIER-CONTROL-LEVEL
  9398                                 TO CNTL-CARRIER
  9399     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 178
* EL130.cbl
  9400
  9401     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9402     MOVE '6'                    TO CNTL-REC-TYPE.
  9403     MOVE +0                     TO CNTL-SEQ-NO.
  9404
  9405
  9406
  9407* EXEC CICS HANDLE CONDITION
  9408*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9409*    END-EXEC.
  9410*    MOVE '"$I                   ! 3 #00008897' TO DFHEIV0
  9411     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9413     MOVE X'3320233030303038383937' TO DFHEIV0(25:11)
  9414     CALL 'kxdfhei1' USING DFHEIV0
  9415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9416
  9417
  9418
  9419
  9420* EXEC CICS READ
  9421*        UPDATE
  9422*        DATASET   (ELCNTL-DSID)
  9423*        SET       (ADDRESS OF CONTROL-FILE)
  9424*        RIDFLD    (ELCNTL-KEY)
  9425*    END-EXEC.
  9426*    MOVE '&"S        EU         (   #00008902' TO DFHEIV0
  9427     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9428     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9429     MOVE X'2020233030303038393032' TO DFHEIV0(25:11)
  9430     CALL 'kxdfhei1' USING DFHEIV0,
  9431           ELCNTL-DSID,
  9432           DFHEIV20,
  9433           DFHEIV99,
  9434           ELCNTL-KEY,
  9435           DFHEIV99,
  9436           DFHEIV99,
  9437           DFHEIV99
  9438     SET ADDRESS OF CONTROL-FILE TO
  9439         DFHEIV20
  9440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9441
  9442
  9443     IF CLAIM-NO-MANUAL
  9444         GO TO 3120-CLAIM-MUST-BE-INPUT
  9445     END-IF.
  9446
  9447     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9448     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9449
  9450     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9451         CONTINUE
  9452     ELSE
  9453         GO TO 3080-ASSIGN-LOOP
  9454     END-IF.
  9455
  9456
  9457
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 179
* EL130.cbl
  9458* EXEC CICS UNLOCK
  9459*        DATASET   (ELCNTL-DSID)
  9460*    END-EXEC.
  9461*    MOVE '&*                    #   #00008923' TO DFHEIV0
  9462     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9463     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9464     MOVE X'2020233030303038393233' TO DFHEIV0(25:11)
  9465     CALL 'kxdfhei1' USING DFHEIV0,
  9466           ELCNTL-DSID,
  9467           DFHEIV99
  9468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9469
  9470
  9471     MOVE '1'                    TO CNTL-REC-TYPE.
  9472     MOVE SPACES                 TO CNTL-ACCESS.
  9473
  9474     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9475
  9476
  9477
  9478* EXEC CICS HANDLE CONDITION
  9479*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9480*    END-EXEC.
  9481*    MOVE '"$I                   ! 4 #00008933' TO DFHEIV0
  9482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9484     MOVE X'3420233030303038393333' TO DFHEIV0(25:11)
  9485     CALL 'kxdfhei1' USING DFHEIV0
  9486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9487
  9488
  9489     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9490
  9491     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9492
  9493 3080-ASSIGN-LOOP.
  9494     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9495        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9496         MOVE +0                 TO SAVE-COUNTER
  9497     END-IF.
  9498
  9499     ADD +1 TO SAVE-COUNTER.
  9500
  9501     IF SAVE-METHOD  = '3'
  9502         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9503         GO TO 3090-SET-COMP
  9504     END-IF.
  9505
  9506     IF SAVE-METHOD  = '4'
  9507         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9508         MOVE CLMCARRI           TO WS-CN-PRF-A
  9509         GO TO 3090-SET-COMP
  9510     END-IF.
  9511
  9512     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9513     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9514     MOVE SAVE-DATE              TO CURR-DATE.
  9515
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 180
* EL130.cbl
  9516     IF CURR-MM LESS '10'
  9517         MOVE CURR-M2             TO WS-CN-PRF-B
  9518     END-IF.
  9519
  9520     IF CURR-MM = '10'
  9521        MOVE 'A'                 TO WS-CN-PRF-B
  9522     END-IF.
  9523     IF CURR-MM = '11'
  9524        MOVE 'B'                 TO WS-CN-PRF-B
  9525     END-IF.
  9526     IF CURR-MM = '12'
  9527        MOVE 'C'                 TO WS-CN-PRF-B
  9528     END-IF.
  9529
  9530     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9531
  9532 3090-SET-COMP.
  9533
  9534     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9535     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9536                                    CLMNOO.
  9537     MOVE AL-UANON               TO CLMNOA.
  9538     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9539     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9540     MOVE CLMCARRI               TO MSTR-CARRIER.
  9541
  9542
  9543
  9544* EXEC CICS HANDLE CONDITION
  9545*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9546*    END-EXEC.
  9547*    MOVE '"$I                   ! 5 #00008991' TO DFHEIV0
  9548     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9550     MOVE X'3520233030303038393931' TO DFHEIV0(25:11)
  9551     CALL 'kxdfhei1' USING DFHEIV0
  9552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9553
  9554
  9555     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9556
  9557     GO TO 3080-ASSIGN-LOOP.
  9558
  9559 3100-CARRIER-NOT-FOUND.
  9560     MOVE ER-0252                TO EMI-ERROR.
  9561     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9562     MOVE -1                     TO CLMCARRL.
  9563     GO TO 8200-SEND-DATAONLY.
  9564
  9565 3110-COMPANY-NOT-FOUND.
  9566     MOVE ER-0254                TO EMI-ERROR.
  9567     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9568     MOVE -1                     TO MAINTL.
  9569     GO TO 8200-SEND-DATAONLY.
  9570
  9571 3120-CLAIM-MUST-BE-INPUT.
  9572     MOVE ER-0264                TO EMI-ERROR.
  9573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 181
* EL130.cbl
  9574     MOVE -1                     TO CLMNOL.
  9575     GO TO 8200-SEND-DATAONLY.
  9576
  9577 3200-BUILD-ZERO-TRAILER.
  9578
  9579
  9580* EXEC CICS HANDLE CONDITION
  9581*        NOTFND
  9582*    END-EXEC.
  9583*    MOVE '"$                   ! 6 #00009019' TO DFHEIV0
  9584     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9586     MOVE X'3620233030303039303139' TO DFHEIV0(25:11)
  9587     CALL 'kxdfhei1' USING DFHEIV0
  9588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9589
  9590
  9591
  9592
  9593* EXEC CICS GETMAIN
  9594*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9595*        LENGTH  (ELTRLR-LENGTH)
  9596*    END-EXEC.
  9597*    MOVE '," L                  $   #00009024' TO DFHEIV0
  9598     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9599     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9600     MOVE X'2020233030303039303234' TO DFHEIV0(25:11)
  9601     CALL 'kxdfhei1' USING DFHEIV0,
  9602           DFHEIV20,
  9603           ELTRLR-LENGTH,
  9604           DFHEIV99
  9605     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9606         DFHEIV20
  9607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9608
  9609
  9610     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9611     MOVE 'AT'                   TO AT-RECORD-ID.
  9612
  9613     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9614     MOVE CLMCARRI               TO AT-CARRIER.
  9615     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9616     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9617     MOVE +0                     TO AT-SEQUENCE-NO.
  9618     MOVE '1'                    TO AT-TRAILER-TYPE.
  9619
  9620     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9621     MOVE '5'                    TO DC-OPTION-CODE.
  9622     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9623     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9624                                    AT-RESERVES-LAST-MAINT-DT.
  9625
  9626     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9627                                    AT-RESERVES-LAST-UPDATED-BY.
  9628
  9629     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9630
  9631     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 182
* EL130.cbl
  9632
  9633     MOVE +0                     TO AT-FUTURE-RESERVE
  9634                                    AT-IBNR-RESERVE
  9635                                    AT-PAY-CURRENT-RESERVE
  9636                                    AT-INITIAL-MANUAL-RESERVE
  9637                                    AT-CURRENT-MANUAL-RESERVE
  9638                                    AT-ITD-LIFE-REFUNDS
  9639                                    AT-ITD-AH-REFUNDS
  9640                                    AT-ITD-ADDITIONAL-RESERVE.
  9641
  9642     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9643
  9644     IF MANRSVL NOT = ZERO
  9645         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9646                                    AT-CURRENT-MANUAL-RESERVE
  9647     END-IF.
  9648
  9649     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9650
  9651     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9652                                    AT-ITD-CHARGEABLE-EXPENSE.
  9653
  9654     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9655     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9656     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9657
  9658
  9659
  9660* EXEC CICS WRITE
  9661*        DATASET   (ELTRLR-DSID)
  9662*        FROM      (ACTIVITY-TRAILERS)
  9663*        RIDFLD    (AT-CONTROL-PRIMARY)
  9664*    END-EXEC.
  9665     MOVE LENGTH OF
  9666      ACTIVITY-TRAILERS
  9667       TO DFHEIV11
  9668*    MOVE '&$ L                  ''   #00009078' TO DFHEIV0
  9669     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9670     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9671     MOVE X'2020233030303039303738' TO DFHEIV0(25:11)
  9672     CALL 'kxdfhei1' USING DFHEIV0,
  9673           ELTRLR-DSID,
  9674           ACTIVITY-TRAILERS,
  9675           DFHEIV11,
  9676           AT-CONTROL-PRIMARY,
  9677           DFHEIV99,
  9678           DFHEIV99
  9679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9680
  9681
  9682     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9683
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 183
* EL130.cbl
  9685
  9686 3250-BUILD-I1-ADDRESS-TRAILER.
  9687
  9688     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9689     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9690     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9691     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9692     MOVE GROUPI                 TO WS-MA-GROUPING.
  9693     MOVE STATEI                 TO WS-MA-STATE.
  9694     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9695     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9696     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9697     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9698
  9699
  9700* EXEC CICS HANDLE CONDITION
  9701*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9702*    END-EXEC.
  9703*    MOVE '"$I                   ! 7 #00009101' TO DFHEIV0
  9704     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9706     MOVE X'3720233030303039313031' TO DFHEIV0(25:11)
  9707     CALL 'kxdfhei1' USING DFHEIV0
  9708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9709
  9710
  9711
  9712* EXEC CICS READ
  9713*        EQUAL
  9714*        DATASET   (ERMAIL-DSID)
  9715*        SET       (ADDRESS OF MAILING-DATA)
  9716*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9717*    END-EXEC.
  9718*    MOVE '&"S        E          (   #00009105' TO DFHEIV0
  9719     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9721     MOVE X'2020233030303039313035' TO DFHEIV0(25:11)
  9722     CALL 'kxdfhei1' USING DFHEIV0,
  9723           ERMAIL-DSID,
  9724           DFHEIV20,
  9725           DFHEIV99,
  9726           WS-MA-CONTROL-PRIMARY,
  9727           DFHEIV99,
  9728           DFHEIV99,
  9729           DFHEIV99
  9730     SET ADDRESS OF MAILING-DATA TO
  9731         DFHEIV20
  9732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9733
  9734
  9735     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9736         GO TO 3290-NO-INSURED-ADDRESS
  9737     END-IF.
  9738
  9739     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9740     MOVE 'AT'                   TO AT-RECORD-ID.
  9741
  9742     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 184
* EL130.cbl
  9743     MOVE CLMCARRI               TO AT-CARRIER.
  9744     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9745     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9746     MOVE +1                     TO AT-SEQUENCE-NO.
  9747     MOVE '5'                    TO AT-TRAILER-TYPE.
  9748
  9749     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9750     IF MA-INSURED-MIDDLE-INIT > SPACES
  9751        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9752               ' ' DELIMITED BY SIZE
  9753               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9754               ' ' DELIMITED BY SIZE
  9755               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9756        INTO AT-MAIL-TO-NAME
  9757     ELSE
  9758        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9759               ' ' DELIMITED BY SIZE
  9760               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9761        INTO AT-MAIL-TO-NAME
  9762     END-IF.
  9763     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9764     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9765*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9766     MOVE MA-CITY                TO AT-CITY
  9767     MOVE MA-ADDR-STATE          TO AT-STATE
  9768     MOVE MA-ZIP                 TO AT-ZIP
  9769     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9770
  9771     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9772                                    AT-ADDRESS-LAST-MAINT-DT.
  9773
  9774     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9775                                    AT-ADDRESS-LAST-UPDATED-BY.
  9776
  9777     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9778
  9779
  9780* EXEC CICS WRITE
  9781*        DATASET   (ELTRLR-DSID)
  9782*        FROM      (ACTIVITY-TRAILERS)
  9783*        RIDFLD    (AT-CONTROL-PRIMARY)
  9784*    END-EXEC.
  9785     MOVE LENGTH OF
  9786      ACTIVITY-TRAILERS
  9787       TO DFHEIV11
  9788*    MOVE '&$ L                  ''   #00009156' TO DFHEIV0
  9789     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9791     MOVE X'2020233030303039313536' TO DFHEIV0(25:11)
  9792     CALL 'kxdfhei1' USING DFHEIV0,
  9793           ELTRLR-DSID,
  9794           ACTIVITY-TRAILERS,
  9795           DFHEIV11,
  9796           AT-CONTROL-PRIMARY,
  9797           DFHEIV99,
  9798           DFHEIV99
  9799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9800
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 185
* EL130.cbl
  9801
  9802     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9803     GO TO 3300-BUILD-NINETY-TRAILER.
  9804
  9805 3290-NO-INSURED-ADDRESS.
  9806      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9807
  9808 3300-BUILD-NINETY-TRAILER.
  9809
  9810     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9811     MOVE 'AT'                   TO AT-RECORD-ID.
  9812
  9813     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9814     MOVE CLMCARRI               TO AT-CARRIER.
  9815
  9816     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9817     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9818     MOVE +90                    TO AT-SEQUENCE-NO.
  9819     MOVE '6'                    TO AT-TRAILER-TYPE.
  9820
  9821     IF DIAGL NOT = ZERO
  9822         MOVE DIAGI              TO AT-INFO-LINE-1
  9823     END-IF.
  9824
  9825     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9826                                    AT-GEN-INFO-LAST-MAINT-DT.
  9827
  9828     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9829                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9830     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9831
  9832
  9833
  9834* EXEC CICS WRITE
  9835*        DATASET   (ELTRLR-DSID)
  9836*        FROM      (ACTIVITY-TRAILERS)
  9837*        RIDFLD    (AT-CONTROL-PRIMARY)
  9838*    END-EXEC.
  9839     MOVE LENGTH OF
  9840      ACTIVITY-TRAILERS
  9841       TO DFHEIV11
  9842*    MOVE '&$ L                  ''   #00009193' TO DFHEIV0
  9843     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9845     MOVE X'2020233030303039313933' TO DFHEIV0(25:11)
  9846     CALL 'kxdfhei1' USING DFHEIV0,
  9847           ELTRLR-DSID,
  9848           ACTIVITY-TRAILERS,
  9849           DFHEIV11,
  9850           AT-CONTROL-PRIMARY,
  9851           DFHEIV99,
  9852           DFHEIV99
  9853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9854
  9855
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 186
* EL130.cbl
  9857 3400-CHECK-CERT-MAINT.
  9858
  9859     IF CERTMTI = 'A'
  9860         GO TO 3600-BUILD-NEW-CERT
  9861     END-IF.
  9862
  9863     IF NO-CLAIM-ATTACHED
  9864         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9865     END-IF.
  9866
  9867     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9868
  9869     IF CM-LF-CURRENT-STATUS = '2' OR
  9870        CM-AH-CURRENT-STATUS = '2'
  9871         GO TO 3400-REWRITE-CERT
  9872     END-IF.
  9873
  9874     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9875
  9876 3400-REWRITE-CERT.
  9877
  9878
  9879
  9880* EXEC CICS HANDLE CONDITION
  9881*        DUPKEY (3410-DUP-KEY)
  9882*    END-EXEC.
  9883*    MOVE '"$$                   ! 8 #00009222' TO DFHEIV0
  9884     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9886     MOVE X'3820233030303039323232' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0
  9888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9889
  9890
  9891
  9892
  9893* EXEC CICS REWRITE
  9894*        DATASET   (ELCERT-DSID)
  9895*        FROM      (CERTIFICATE-MASTER)
  9896*    END-EXEC.
  9897     MOVE LENGTH OF
  9898      CERTIFICATE-MASTER
  9899       TO DFHEIV11
  9900*    MOVE '&& L                  %   #00009227' TO DFHEIV0
  9901     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9902     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9903     MOVE X'2020233030303039323237' TO DFHEIV0(25:11)
  9904     CALL 'kxdfhei1' USING DFHEIV0,
  9905           ELCERT-DSID,
  9906           CERTIFICATE-MASTER,
  9907           DFHEIV11,
  9908           DFHEIV99
  9909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9910
  9911
  9912 3410-DUP-KEY.
  9913     GO TO 3800-BUILD-NEW-CLAIM.
  9914
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 187
* EL130.cbl
  9915 3600-BUILD-NEW-CERT.
  9916
  9917
  9918* EXEC CICS GETMAIN
  9919*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9920*        LENGTH   (ELCERT-LENGTH)
  9921*    END-EXEC.
  9922*    MOVE '," L                  $   #00009237' TO DFHEIV0
  9923     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9925     MOVE X'2020233030303039323337' TO DFHEIV0(25:11)
  9926     CALL 'kxdfhei1' USING DFHEIV0,
  9927           DFHEIV20,
  9928           ELCERT-LENGTH,
  9929           DFHEIV99
  9930     SET ADDRESS OF CERTIFICATE-MASTER TO
  9931         DFHEIV20
  9932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9933
  9934
  9935     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9936
  9937     MOVE 'CM'                   TO CM-RECORD-ID.
  9938
  9939     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9940                                    CM-COMPANY-CD-A1
  9941                                    CM-COMPANY-CD-A2
  9942                                    CM-COMPANY-CD-A4
  9943                                    CM-COMPANY-CD-A5.
  9944
  9945     MOVE CERT-CARRIER           TO CM-CARRIER.
  9946     MOVE CERT-GROUPING          TO CM-GROUPING.
  9947     MOVE CERT-STATE             TO CM-STATE.
  9948     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9949     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9950     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9951
  9952     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9953                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9954                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9955                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9956                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9957                       CM-LIVES              CM-LOAN-TERM
  9958                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9959                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9960                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9961                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9962                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9963                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9964                       CM-LF-ALT-PREMIUM-RATE
  9965                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9966                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9967                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9968                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9969                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9970
  9971     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9972                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 188
* EL130.cbl
  9973                                    CM-AH-SETTLEMENT-DT
  9974                                    CM-AH-CANCEL-EXIT-DT
  9975                                    CM-AH-SETTLEMENT-EXIT-DT
  9976                                    CM-LF-LOAN-EXPIRE-DT
  9977                                    CM-LF-CANCEL-DT
  9978                                    CM-LF-DEATH-DT
  9979                                    CM-LF-CANCEL-EXIT-DT
  9980                                    CM-LF-DEATH-EXIT-DT
  9981                                    CM-LAST-ADD-ON-DT
  9982                                    CM-ENTRY-DT.
  9983
  9984     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
  9985     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
  9986     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
  9987
  9988     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
  9989                                    CM-PART-LAST-NAME-A2
  9990                                    CM-PART-LAST-NAME-A5.
  9991
  9992     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
  9993                                    CM-INSURED-INITIAL1-A2
  9994                                    CM-INSURED-INITIAL1-A5
  9995                                    CM-INSURED-FIRST-NAME.
  9996
  9997     IF CRTINITL GREATER ZERO
  9998         MOVE CRTINITI           TO CM-INSURED-INITIAL2
  9999                                    CM-INSURED-INITIAL2-A2
 10000                                    CM-INSURED-INITIAL2-A5
 10001     ELSE
 10002         MOVE SPACES             TO CM-INSURED-INITIAL2
 10003                                    CM-INSURED-INITIAL2-A2
 10004                                    CM-INSURED-INITIAL2-A5
 10005     END-IF.
 10006
 10007     IF CM-INSURED-INITIALS = SPACES
 10008         MOVE '**'               TO CM-INSURED-INITIALS
 10009     END-IF.
 10010
 10011     IF MEMBERL GREATER ZERO
 10012         MOVE MEMBERI              TO CM-MEMBER-NO
 10013     ELSE
 10014         MOVE CERT-STATE           TO CM-MEMB-STATE
 10015         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10016         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10017         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10018     END-IF.
 10019
 10020     IF JNTLNMEL GREATER ZERO
 10021         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10022     END-IF.
 10023
 10024     IF JNTFNMEL GREATER ZERO
 10025         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10026     END-IF.
 10027
 10028     IF JNTINITL GREATER ZERO
 10029         MOVE JNTINITI           TO CM-JT-INITIAL
 10030     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 189
* EL130.cbl
 10031
 10032     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10033
 10034
 10035
 10036* EXEC CICS HANDLE CONDITION
 10037*        DUPKEY   (3690-CERT-WRITTEN)
 10038*    END-EXEC.
 10039*    MOVE '"$$                   ! 9 #00009342' TO DFHEIV0
 10040     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10042     MOVE X'3920233030303039333432' TO DFHEIV0(25:11)
 10043     CALL 'kxdfhei1' USING DFHEIV0
 10044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10045
 10046
 10047
 10048
 10049* EXEC CICS WRITE
 10050*        DATASET   (ELCERT-DSID)
 10051*        FROM      (CERTIFICATE-MASTER)
 10052*        RIDFLD    (CM-CONTROL-PRIMARY)
 10053*    END-EXEC.
 10054     MOVE LENGTH OF
 10055      CERTIFICATE-MASTER
 10056       TO DFHEIV11
 10057*    MOVE '&$ L                  ''   #00009347' TO DFHEIV0
 10058     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10060     MOVE X'2020233030303039333437' TO DFHEIV0(25:11)
 10061     CALL 'kxdfhei1' USING DFHEIV0,
 10062           ELCERT-DSID,
 10063           CERTIFICATE-MASTER,
 10064           DFHEIV11,
 10065           CM-CONTROL-PRIMARY,
 10066           DFHEIV99,
 10067           DFHEIV99
 10068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10069
 10070
 10071 3690-CERT-WRITTEN.
 10072
 10073     GO TO 3800-BUILD-NEW-CLAIM.
 10074
 10075 3690-EXIT.
 10076      EXIT.
 10077
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 190
* EL130.cbl
 10079 3700-BUILD-CERT.
 10080
 10081     IF CERTMTI NOT = 'A'
 10082         GO TO 3700-FINISH-CERT-BUILD
 10083     END-IF.
 10084
 10085     IF CERTMTI = 'A'
 10086         IF LCVCDL = ZEROS
 10087             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10088                                    CM-LF-ORIG-TERM
 10089                                    CM-LF-BENEFIT-AMT
 10090                                    CM-LF-PREMIUM-RATE
 10091             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10092         END-IF
 10093     END-IF.
 10094
 10095     IF LCVCDL GREATER ZERO
 10096         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10097     END-IF.
 10098
 10099     IF LCVOTRML GREATER ZERO
 10100         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10101     END-IF.
 10102
 10103     IF LCVBENEL GREATER ZERO
 10104         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10105     END-IF.
 10106
 10107     IF LCVRATEL GREATER ZERO
 10108         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10109     END-IF.
 10110
 10111     IF WS-EXPIRE NOT = LOW-VALUES
 10112         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10113     END-IF.
 10114
 10115     IF LCVFORML GREATER ZERO
 10116         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10117     END-IF.
 10118
 10119     IF LCVCNDTL = ZERO
 10120        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10121     END-IF.
 10122
 10123     IF WS-LCVCNDT NOT = LOW-VALUES
 10124        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10125        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10126        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10127     END-IF.
 10128
 10129     IF CM-LF-CURRENT-STATUS = '7'
 10130        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10131        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10132        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10133                                    CM-LF-DEATH-DT
 10134        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10135     END-IF.
 10136
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 191
* EL130.cbl
 10137     IF CM-LF-CURRENT-STATUS = '8'
 10138        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10139        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10140     END-IF.
 10141
 10142 3700-BUILD-AH-COVERAGE-SIDE.
 10143
 10144     IF CERTMTI = 'A'
 10145         IF ACVCDL = ZEROS
 10146             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10147                                    CM-AH-ORIG-TERM
 10148                                    CM-AH-BENEFIT-AMT
 10149                                    CM-AH-PREMIUM-RATE
 10150             GO TO 3700-COVERAGE-BUILT
 10151         END-IF
 10152     END-IF.
 10153
 10154     IF ACVCDL GREATER ZERO
 10155         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10156     END-IF.
 10157
 10158     IF ACVOTRML GREATER ZERO
 10159         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10160     END-IF.
 10161
 10162     IF ACVBENEL GREATER ZERO
 10163         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10164     END-IF.
 10165
 10166     IF ACVRATEL GREATER ZERO
 10167         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10168     END-IF.
 10169
 10170     IF WS-EXPIRE NOT = LOW-VALUES
 10171         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10172     END-IF.
 10173
 10174     IF ACVFORML GREATER ZERO
 10175         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10176     END-IF.
 10177
 10178     IF ACVCNDTL = ZERO
 10179        GO TO 3700-COVERAGE-BUILT
 10180     END-IF.
 10181
 10182     IF WS-ACVCNDT NOT = LOW-VALUES
 10183        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10184        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10185        GO TO 3700-COVERAGE-BUILT
 10186     END-IF.
 10187
 10188     IF CM-AH-CURRENT-STATUS = '6'
 10189        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10190        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10191        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10192        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10193        GO TO 3700-COVERAGE-BUILT
 10194     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 192
* EL130.cbl
 10195
 10196     IF CM-AH-CURRENT-STATUS = '8'
 10197        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10198        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10199     END-IF.
 10200
 10201 3700-COVERAGE-BUILT.
 10202     IF ISSAGEL GREATER ZERO
 10203         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10204     END-IF.
 10205
 10206     IF JNTAGEL GREATER ZERO
 10207         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10208     END-IF.
 10209
 10210     IF SEXL GREATER ZERO
 10211         MOVE SEXI               TO CM-INSURED-SEX
 10212     END-IF.
 10213
 10214     IF APRL GREATER ZERO
 10215         MOVE WS-APR             TO CM-LOAN-APR
 10216     END-IF.
 10217
 10218     IF PMTFREQL GREATER ZERO
 10219         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10220     END-IF.
 10221
 10222     IF INDGRPL GREATER ZERO
 10223         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10224     END-IF.
 10225
 10226     IF CERTMTI = 'A'
 10227         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10228     END-IF.
 10229
 10230     IF REINCDL GREATER ZERO
 10231         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10232                                    WS-REIN-1
 10233                                    WS-REIN-2
 10234                                    WS-REIN-3
 10235         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10236     END-IF.
 10237
 10238     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10239         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10240     END-IF.
 10241
 10242     IF CRTSSNL GREATER ZERO
 10243         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10244     ELSE
 10245         IF SSNL GREATER ZERO
 10246             MOVE SSNI           TO CM-SOC-SEC-NO
 10247         END-IF
 10248     END-IF.
 10249
 10250     IF CRTSSNL = ZERO AND
 10251        SSNL    = ZERO
 10252         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 193
* EL130.cbl
 10253         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10254         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10255         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10256     END-IF.
 10257
 10258     IF CM-LF-CURRENT-STATUS = SPACES
 10259         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10260     END-IF.
 10261
 10262     IF CM-AH-CURRENT-STATUS = SPACES
 10263         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10264     END-IF.
 10265
 10266     IF CERTMTI = 'A'
 10267         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10268     END-IF.
 10269
 10270 3700-FINISH-CERT-BUILD.
 10271
 10272     IF LOANNOL GREATER ZERO
 10273         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10274     END-IF.
 10275
 10276     IF LOANBALL GREATER ZERO
 10277         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10278     END-IF.
 10279
 10280     IF PREMTYPL GREATER ZERO
 10281         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10282     END-IF.
 10283
 10284 3700-EXIT.
 10285      EXIT.
 10286
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 194
* EL130.cbl
 10288 3800-BUILD-NEW-CLAIM.
 10289
 10290*************************************************************
 10291*****           START OF ACTIVITY FILE PROCESSING          **
 10292*************************************************************
 10293     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10294         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10295                 6700-EXIT
 10296     END-IF.
 10297*************************************************************
 10298*****            END OF ACTIVITY FILE PROCESSING           **
 10299*************************************************************
 10300
 10301
 10302
 10303
 10304* EXEC CICS GETMAIN
 10305*        SET     (ADDRESS OF CLAIM-MASTER)
 10306*        LENGTH  (ELMSTR-LENGTH)
 10307*    END-EXEC.
 10308*    MOVE '," L                  $   #00009585' TO DFHEIV0
 10309     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10311     MOVE X'2020233030303039353835' TO DFHEIV0(25:11)
 10312     CALL 'kxdfhei1' USING DFHEIV0,
 10313           DFHEIV20,
 10314           ELMSTR-LENGTH,
 10315           DFHEIV99
 10316     SET ADDRESS OF CLAIM-MASTER TO
 10317         DFHEIV20
 10318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10319
 10320
 10321     MOVE SPACES TO CLAIM-MASTER.
 10322
 10323     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10324         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10325         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10326         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10327         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10328         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10329         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10330         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10331         cl-rtw-dt
 10332
 10333     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10334             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10335             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10336             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10337             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10338             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10339             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10340             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10341             CL-FORCEABLE-ERROR-CNT.
 10342
 10343     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10344
 10345     MOVE ZEROS                  TO CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 195
* EL130.cbl
 10346                                    CL-LAPSE-REPORT-CODE
 10347                                    CL-LAG-REPORT-CODE
 10348                                    CL-CRITICAL-PERIOD
 10349                                    CL-CRIT-PER-RTW-MOS
 10350
 10351     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10352     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10353
 10354     IF BENECDL NOT = ZEROS
 10355        MOVE BENECDI             TO CL-BENEFICIARY
 10356     END-IF.
 10357
 10358     MOVE 'CL'                   TO CL-RECORD-ID.
 10359     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10360
 10361     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10362                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10363                             CL-COMPANY-CD-A5.
 10364
 10365     MOVE CLMCARRI               TO CL-CARRIER.
 10366
 10367     IF CLMNOL = ZERO
 10368         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10369     ELSE
 10370         MOVE CLMNOI             TO CL-CLAIM-NO
 10371     END-IF.
 10372
 10373     MOVE CERTNOI                TO CL-CERT-PRIME
 10374                                    CL-CERT-A4-PRIME.
 10375
 10376     MOVE SUFXI                  TO CL-CERT-SFX
 10377                                    CL-CERT-A4-SFX.
 10378
 10379     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10380
 10381     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10382
 10383     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10384
 10385     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10386
 10387     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10388     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10389
 10390     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10391
 10392     IF CERTMTI = 'A'
 10393         MOVE '2'                TO CL-CERT-ORIGIN
 10394     ELSE
 10395         MOVE '1'                TO CL-CERT-ORIGIN
 10396     END-IF.
 10397
 10398     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10399     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10400     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10401     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10402     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10403
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 196
* EL130.cbl
 10404 3820-REWRITE-CONTROL-FILE.
 10405
 10406     IF CLMNOL GREATER ZERO
 10407         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10408     END-IF.
 10409
 10410     IF CF-RECORD-TYPE = '6'
 10411         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10412     ELSE
 10413         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10414     END-IF.
 10415
 10416
 10417
 10418* EXEC CICS REWRITE
 10419*        DATASET   (ELCNTL-DSID)
 10420*        FROM      (CONTROL-FILE)
 10421*    END-EXEC.
 10422     MOVE LENGTH OF
 10423      CONTROL-FILE
 10424       TO DFHEIV11
 10425*    MOVE '&& L                  %   #00009686' TO DFHEIV0
 10426     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10427     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10428     MOVE X'2020233030303039363836' TO DFHEIV0(25:11)
 10429     CALL 'kxdfhei1' USING DFHEIV0,
 10430           ELCNTL-DSID,
 10431           CONTROL-FILE,
 10432           DFHEIV11,
 10433           DFHEIV99
 10434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10435
 10436
 10437 3830-SEQUENCE-CLAIM-RECORDS.
 10438
 10439     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10440     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10441     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10442
 10443     IF WS-ASSOC-CERT-TOTAL = ZERO
 10444         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10445                                    CL-ASSOC-CERT-TOTAL
 10446         GO TO 3840-WRITE-CLAIM-MASTER
 10447     END-IF.
 10448
 10449     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10450         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10451     ELSE
 10452         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10453     END-IF.
 10454
 10455     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10456     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10457     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10458
 10459 3840-WRITE-CLAIM-MASTER.
 10460
 10461     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 197
* EL130.cbl
 10462     IF WS-REC-FOUND-SW = 'Y'
 10463         MOVE 01                 TO  CL-ACTIVITY-CODE
 10464         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10465         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10466     END-IF.
 10467
 10468
 10469
 10470* EXEC CICS HANDLE CONDITION
 10471*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10472*    END-EXEC.
 10473*    MOVE '"$$                   ! : #00009723' TO DFHEIV0
 10474     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10476     MOVE X'3A20233030303039373233' TO DFHEIV0(25:11)
 10477     CALL 'kxdfhei1' USING DFHEIV0
 10478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10479
 10480
 10481** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10482     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10483
 10484
 10485*    DISPLAY ' ABOUT TO WRITE ELMSTR '
 10486*    DISPLAY ' KEY ' CL-CARRIER ' ' CL-CLAIM-NO ' '
 10487*       CL-CERT-NO
 10488*    IF CL-COMPANY-CD = X'04'
 10489*       DISPLAY ' CID COMP CD '
 10490*    ELSE
 10491*       IF CL-COMPANY-CD = X'05'
 10492*          DISPLAY ' DCC COMP CD '
 10493*       ELSE
 10494*          DISPLAY ' UNKNOWN COMP CD '
 10495*       END-IF
 10496*    END-IF
 10497
 10498* EXEC CICS WRITE
 10499*        DATASET   (ELMSTR-DSID)
 10500*        FROM      (CLAIM-MASTER)
 10501*        RIDFLD    (CL-CONTROL-PRIMARY)
 10502*    END-EXEC.
 10503     MOVE LENGTH OF
 10504      CLAIM-MASTER
 10505       TO DFHEIV11
 10506*    MOVE '&$ L                  ''   #00009743' TO DFHEIV0
 10507     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10508     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10509     MOVE X'2020233030303039373433' TO DFHEIV0(25:11)
 10510     CALL 'kxdfhei1' USING DFHEIV0,
 10511           ELMSTR-DSID,
 10512           CLAIM-MASTER,
 10513           DFHEIV11,
 10514           CL-CONTROL-PRIMARY,
 10515           DFHEIV99,
 10516           DFHEIV99
 10517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10518
 10519
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 198
* EL130.cbl
 10520 3850-CLAIM-MSTR-WRITTEN.
 10521
 10522     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10523         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10524     END-IF.
 10525
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 199
* EL130.cbl
 10527 3990-ADD-DONE.
 10528*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10529*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10530*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10531*                                  EMI-ERROR-LINES.
 10532
 10533     IF CLMNOL = ZERO
 10534         move spaces             to emi-claim-no
 10535         MOVE ER-0265            TO EMI-ERROR
 10536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10537         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10538                                    PI-LAST-CLAIM
 10539     ELSE
 10540         MOVE CLMNOI             TO PI-LAST-CLAIM
 10541                                    MSTR-CLAIM-NO
 10542         MOVE ER-0000            TO EMI-ERROR
 10543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10544     END-IF.
 10545
 10546     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10547       AND PI-ST-VFY-2ND-BENE = 'Y'
 10548         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10549         MOVE ER-7575            TO EMI-ERROR
 10550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10551     END-IF.
 10552
 10553     IF WS-NO-INSURED-ADDRESS = 'Y'
 10554         MOVE ER-3548            TO EMI-ERROR
 10555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10556     END-IF.
 10557
 10558     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10559       (PI-ST-CAUSAL-STATE = 'L' AND
 10560              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10561       (PI-ST-CAUSAL-STATE = 'A' AND
 10562              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10563         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10564         MOVE ER-7577            TO EMI-ERROR
 10565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10566     END-IF.
 10567     if pi-company-id = 'DCC'
 10568        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10569                                 THRU 3994C-EXIT
 10570     end-if
 10571     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10572     MOVE CLMCARRI                   TO  PI-CARRIER.
 10573     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10574     MOVE SUFXI                      TO  PI-CERT-SFX.
 10575
 10576     IF WS-LETTER-SW = 'Y'
 10577         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10578         IF W-1523-ERROR-CODE NOT = ZEROS
 10579             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10580             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10581         END-IF
 10582     END-IF.
 10583
 10584     perform 3998-update-cert-claim-trailer
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 200
* EL130.cbl
 10585                                 thru 3998-exit
 10586     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10587     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10588     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10589     MOVE CLMCARRI               TO PI-LAST-CARR.
 10590
 10591     IF PRTOPTL GREATER THAN 0
 10592         MOVE PRTOPTI            TO PI-PRT-OPT
 10593     END-IF.
 10594     IF ALTPRTL GREATER THAN 0
 10595         MOVE ALTPRTI            TO PI-ALT-PRT
 10596     END-IF.
 10597
 10598     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10599         MOVE LOW-VALUES         TO EL130AI
 10600         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10601         MOVE AL-SANON           TO CERTNOA
 10602         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10603         MOVE AL-SANON           TO SUFXA
 10604         MOVE PI-LAST-CARR       TO CLMCARRO
 10605         MOVE AL-UANON           TO CLMCARRA
 10606         MOVE PI-LAST-CLAIM      TO CLMNOO
 10607         MOVE AL-UANON           TO CLMNOA
 10608         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10609         MOVE AL-UANON           TO CLMTYPEA
 10610     ELSE
 10611         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10612         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10613     END-IF.
 10614
 10615     IF PI-PRT-OPT = 'N' OR 'L'
 10616         MOVE PI-PRT-OPT         TO PRTOPTO
 10617         MOVE 1                  TO PRTOPTL
 10618     END-IF.
 10619
 10620     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10621         MOVE PI-ALT-PRT         TO ALTPRTO
 10622         MOVE 4                  TO ALTPRTL
 10623     END-IF.
 10624
 10625     IF PRTOPTL GREATER THAN 0
 10626         IF PRTOPTI = 'L'
 10627             GO TO 0400-CREATE-ELACTQ
 10628         ELSE
 10629             GO TO 0480-PRINT-NOW
 10630         END-IF
 10631     END-IF.
 10632     move 'S'                    to mainti
 10633     PERFORM 0500-CREATE-TEMP-STORAGE
 10634                                 THRU 0599-EXIT
 10635     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10636         GO TO 8100-SEND-INITIAL-MAP
 10637     ELSE
 10638         MOVE LOW-VALUES         TO MAINTO
 10639         MOVE -1                 TO MAINTL
 10640         GO TO 8200-SEND-DATAONLY
 10641     END-IF.
 10642
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 201
* EL130.cbl
 10644 3993-MODIFY-SCREEN-ATTRB.
 10645
 10646     IF CERTMTL GREATER ZERO
 10647         MOVE AL-UANON           TO CERTMTA
 10648     END-IF.
 10649
 10650     IF EFFDTL GREATER ZERO
 10651         MOVE AL-UANON           TO EFFDTA
 10652     END-IF.
 10653
 10654     IF ACCOUNTL GREATER ZERO
 10655         MOVE AL-UANON           TO ACCOUNTA
 10656     END-IF.
 10657
 10658     IF STATEL GREATER ZERO
 10659         MOVE AL-UANON           TO STATEA
 10660     END-IF.
 10661
 10662     IF CRTCARRL GREATER ZERO
 10663         MOVE AL-UANON           TO CRTCARRA
 10664     END-IF.
 10665
 10666     IF GROUPL GREATER ZERO
 10667         MOVE AL-UANON           TO GROUPA
 10668     END-IF.
 10669
 10670     IF CRTLNMEL GREATER ZERO
 10671         MOVE AL-UANON           TO CRTLNMEA
 10672     END-IF.
 10673
 10674     IF CRTFNMEL GREATER ZERO
 10675         MOVE AL-UANON           TO CRTFNMEA
 10676     END-IF.
 10677
 10678     IF CRTINITL GREATER ZERO
 10679         MOVE AL-UANON           TO CRTINITA
 10680     END-IF.
 10681
 10682     IF ISSAGEL GREATER ZERO
 10683         MOVE AL-UNNON           TO ISSAGEA
 10684     END-IF.
 10685
 10686     IF JNTLNMEL GREATER ZERO
 10687         MOVE AL-UANON           TO JNTLNMEA
 10688     END-IF.
 10689
 10690     IF JNTFNMEL GREATER ZERO
 10691         MOVE AL-UANON           TO JNTFNMEA
 10692     END-IF.
 10693
 10694     IF JNTINITL GREATER ZERO
 10695         MOVE AL-UANON           TO JNTINITA
 10696     END-IF.
 10697
 10698     IF JNTAGEL GREATER ZERO
 10699         MOVE AL-UNNON           TO JNTAGEA
 10700     END-IF.
 10701
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 202
* EL130.cbl
 10702     IF CRTSSNL GREATER ZERO
 10703         MOVE AL-UANON           TO CRTSSNA
 10704     END-IF.
 10705
 10706     IF ACVDSCRL GREATER ZERO
 10707         MOVE AL-SANON           TO ACVDSCRA
 10708     END-IF.
 10709
 10710     IF ACVKINDL GREATER ZERO
 10711         MOVE AL-SANON           TO ACVKINDA
 10712     END-IF.
 10713
 10714     IF ACVCDL GREATER ZERO
 10715         MOVE AL-UANON           TO ACVCDA
 10716     END-IF.
 10717
 10718     IF ACVOTRML GREATER ZERO
 10719         MOVE AL-UNNON           TO ACVOTRMA
 10720     END-IF.
 10721
 10722     IF ACVRTRML GREATER ZERO
 10723         MOVE AL-UNNON           TO ACVRTRMA
 10724     END-IF.
 10725
 10726     IF ACVRATEL GREATER ZERO
 10727         MOVE AL-UNNON           TO ACVRATEA
 10728     END-IF.
 10729
 10730     IF ACVBENEL GREATER ZERO
 10731         MOVE AL-UNNON           TO ACVBENEA
 10732     END-IF.
 10733
 10734     IF ACVFORML GREATER ZERO
 10735         MOVE AL-UANON           TO ACVFORMA
 10736     END-IF.
 10737
 10738     IF ACVCNDTL GREATER ZERO
 10739         MOVE AL-UANON           TO ACVCNDTA
 10740     END-IF.
 10741
 10742     IF ACVEXITL GREATER ZERO
 10743         MOVE AL-UANON           TO ACVEXITA
 10744     END-IF.
 10745
 10746     IF ACVSTATL GREATER ZERO
 10747         MOVE AL-UANON           TO ACVSTATA
 10748     END-IF.
 10749
 10750     IF LCVDSCRL GREATER ZERO
 10751         MOVE AL-SANON           TO LCVDSCRA
 10752     END-IF.
 10753
 10754     IF LCVKINDL GREATER ZERO
 10755         MOVE AL-SANON           TO LCVKINDA
 10756     END-IF.
 10757
 10758     IF LCVCDL GREATER ZERO
 10759         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 203
* EL130.cbl
 10760     END-IF.
 10761
 10762     IF LCVOTRML GREATER ZERO
 10763         MOVE AL-UNNON           TO LCVOTRMA
 10764     END-IF.
 10765
 10766     IF LCVRTRML GREATER ZERO
 10767         MOVE AL-UNNON           TO LCVRTRMA
 10768     END-IF.
 10769
 10770     IF LCVRATEL GREATER ZERO
 10771         MOVE AL-UNNON           TO LCVRATEA
 10772     END-IF.
 10773
 10774     IF LCVBENEL GREATER ZERO
 10775         MOVE AL-UNNON           TO LCVBENEA
 10776     END-IF.
 10777
 10778     IF LCVFORML GREATER ZERO
 10779         MOVE AL-UANON           TO LCVFORMA
 10780     END-IF.
 10781
 10782     IF LCVCNDTL GREATER ZERO
 10783         MOVE AL-UANON           TO LCVCNDTA
 10784     END-IF.
 10785
 10786     IF LCVEXITL GREATER ZERO
 10787         MOVE AL-UANON           TO LCVEXITA
 10788     END-IF.
 10789
 10790     IF LCVSTATL GREATER ZERO
 10791         MOVE AL-UANON           TO LCVSTATA
 10792     END-IF.
 10793
 10794     IF MEMCAPL GREATER ZERO
 10795         MOVE AL-UANON           TO MEMCAPA
 10796     END-IF.
 10797
 10798     IF APRL GREATER ZERO
 10799         MOVE AL-UNNON           TO APRA
 10800     END-IF.
 10801
 10802     IF PMTFREQL GREATER ZERO
 10803         MOVE AL-UNNON           TO PMTFREQA
 10804     END-IF.
 10805
 10806     IF INDGRPL GREATER ZERO
 10807         MOVE AL-UANON           TO INDGRPA
 10808     END-IF.
 10809
 10810     IF PREMTYPL GREATER ZERO
 10811         MOVE AL-UANON           TO PREMTYPA
 10812     END-IF.
 10813
 10814     IF REINCDL GREATER ZERO
 10815         MOVE AL-UANON           TO REINCDA
 10816     END-IF.
 10817
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 204
* EL130.cbl
 10818     IF ADDONDTL GREATER ZERO
 10819         MOVE AL-UANON           TO ADDONDTA
 10820     END-IF.
 10821
 10822     IF MEMBERL GREATER ZERO
 10823         MOVE AL-UANON           TO MEMBERA
 10824     END-IF.
 10825
 10826     IF BCERT1L GREATER ZERO
 10827         MOVE AL-SANON           TO BCERT1A
 10828                                    BSUFX1A
 10829     END-IF.
 10830
 10831     IF BCERT2L GREATER ZERO
 10832         MOVE AL-SANON           TO BCERT2A
 10833                                    BSUFX2A
 10834     END-IF.
 10835
 10836     IF BCERT3L GREATER ZERO
 10837         MOVE AL-SANON           TO BCERT3A
 10838                                    BSUFX3A
 10839     END-IF.
 10840
 10841     IF BCERT4L GREATER ZERO
 10842         MOVE AL-SANON           TO BCERT4A
 10843                                    BSUFX4A
 10844     END-IF.
 10845
 10846     IF BCERT5L GREATER ZERO
 10847         MOVE AL-SANON           TO BCERT5A
 10848                                    BSUFX5A
 10849     END-IF.
 10850
 10851 3993-MODIFY-CLAIM-ATTRB.
 10852
 10853     IF PCERTNOL GREATER ZERO
 10854         MOVE AL-UANON           TO PCERTNOA
 10855     END-IF.
 10856
 10857     IF PSUFXL GREATER ZERO
 10858         MOVE AL-UANON           TO PSUFXA
 10859     END-IF.
 10860
 10861     IF LSTNMEL GREATER ZERO
 10862         MOVE AL-UANON           TO LSTNMEA
 10863     END-IF.
 10864
 10865     IF FSTNMEL GREATER ZERO
 10866         MOVE AL-UANON           TO FSTNMEA
 10867     END-IF.
 10868
 10869     IF INITL GREATER ZERO
 10870         MOVE AL-UANON           TO INITA
 10871     END-IF.
 10872
 10873     IF SEXL GREATER ZERO
 10874         MOVE AL-UANON           TO SEXA
 10875     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 205
* EL130.cbl
 10876
 10877     IF OCCCDL GREATER ZERO
 10878         MOVE AL-UANON           TO OCCCDA
 10879     END-IF.
 10880
 10881     IF BIRTHDTL GREATER ZERO
 10882         MOVE AL-UANON           TO BIRTHDTA
 10883     END-IF.
 10884
 10885     IF SSNL GREATER ZERO
 10886         MOVE AL-UANON           TO SSNA
 10887     END-IF.
 10888
 10889     IF INCURL GREATER ZERO
 10890         MOVE AL-UANON           TO INCURA
 10891     END-IF.
 10892
 10893     IF REPORTL GREATER ZERO
 10894         MOVE AL-UANON           TO REPORTA
 10895     END-IF.
 10896
 10897     IF ESTENDL GREATER ZERO
 10898         MOVE AL-UANON           TO ESTENDA
 10899     END-IF.
 10900
 10901     IF DIAGL GREATER ZERO
 10902         MOVE AL-UANON           TO DIAGA
 10903     END-IF.
 10904
 10905     IF CAUSEL GREATER ZERO
 10906         MOVE AL-UANON           TO CAUSEA
 10907     END-IF.
 10908
 10909     IF MANRSVL GREATER ZERO
 10910         MOVE AL-UNNON           TO MANRSVA
 10911     END-IF.
 10912
 10913     IF RELCLML GREATER ZERO
 10914         MOVE AL-UANON           TO RELCLMA
 10915     END-IF.
 10916
 10917     IF LOANNOL GREATER ZERO
 10918         MOVE AL-UANON           TO LOANNOA
 10919     END-IF.
 10920
 10921     IF LOANBALL GREATER ZERO
 10922         MOVE AL-UNNON           TO LOANBALA
 10923     END-IF.
 10924
 10925     IF PROCCDL GREATER ZERO
 10926         MOVE AL-UANON           TO PROCCDA
 10927     END-IF.
 10928
 10929     IF BENECDL GREATER THAN ZERO
 10930         MOVE AL-UANON           TO  BENECDA
 10931     END-IF.
 10932
 10933     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 206
* EL130.cbl
 10934         MOVE AL-UANON           TO PRICDA
 10935     END-IF.
 10936
 10937     IF SUPVL GREATER ZERO
 10938         MOVE AL-UANON           TO SUPVA
 10939     END-IF.
 10940
 10941     IF FILETOL GREATER ZERO
 10942         MOVE AL-UANON           TO FILETOA
 10943     END-IF.
 10944
 10945
 10946 3993-MODIFY-CLAIM-KEY-ATTRB.
 10947
 10948     IF CLMNOL GREATER ZERO
 10949         MOVE AL-UANON           TO CLMNOA
 10950     END-IF.
 10951
 10952     IF CLMCARRL GREATER ZERO
 10953         MOVE AL-UANON           TO CLMCARRA
 10954     END-IF.
 10955
 10956     IF CLMTYPEL GREATER ZERO
 10957         MOVE AL-UANON           TO CLMTYPEA
 10958     END-IF.
 10959
 10960     IF CERTNOL GREATER ZERO
 10961         MOVE AL-SANON           TO CERTNOA
 10962     END-IF.
 10963
 10964     IF SUFXL GREATER ZERO
 10965         MOVE AL-SANON           TO SUFXA
 10966     END-IF.
 10967
 10968 3993-EXIT.
 10969     EXIT.
 10970
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 207
* EL130.cbl
 10972 3994-BUILD-NINETY-THREE-TRAILER.
 10973
 10974     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10975     MOVE 'AT'                   TO AT-RECORD-ID.
 10976
 10977     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10978     MOVE CLMCARRI               TO AT-CARRIER.
 10979
 10980     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10981     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10982     MOVE +93                    TO AT-SEQUENCE-NO.
 10983     MOVE '6'                    TO AT-TRAILER-TYPE.
 10984     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10985
 10986     MOVE WS-VERIFY-NOTE         TO AT-INFO-LINE-1.
 10987
 10988     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10989                                    AT-GEN-INFO-LAST-MAINT-DT.
 10990
 10991     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10992                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10993     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10994
 10995
 10996
 10997* EXEC CICS WRITE
 10998*        DATASET   (ELTRLR-DSID)
 10999*        FROM      (ACTIVITY-TRAILERS)
 11000*        RIDFLD    (AT-CONTROL-PRIMARY)
 11001*    END-EXEC.
 11002     MOVE LENGTH OF
 11003      ACTIVITY-TRAILERS
 11004       TO DFHEIV11
 11005*    MOVE '&$ L                  ''   #00010225' TO DFHEIV0
 11006     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11007     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11008     MOVE X'2020233030303130323235' TO DFHEIV0(25:11)
 11009     CALL 'kxdfhei1' USING DFHEIV0,
 11010           ELTRLR-DSID,
 11011           ACTIVITY-TRAILERS,
 11012           DFHEIV11,
 11013           AT-CONTROL-PRIMARY,
 11014           DFHEIV99,
 11015           DFHEIV99
 11016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11017
 11018
 11019 3994-EXIT.
 11020     EXIT.
 11021
 11022 3994B-BUILD-NINETY-FOUR-TRAILER.
 11023
 11024     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11025     MOVE 'AT'                   TO AT-RECORD-ID.
 11026
 11027     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11028     MOVE CLMCARRI               TO AT-CARRIER.
 11029
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 208
* EL130.cbl
 11030     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11031     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11032     MOVE +94                    TO AT-SEQUENCE-NO.
 11033     MOVE '6'                    TO AT-TRAILER-TYPE.
 11034     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11035
 11036     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11037
 11038     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11039                                    AT-GEN-INFO-LAST-MAINT-DT.
 11040
 11041     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11042                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11043     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11044
 11045
 11046
 11047* EXEC CICS WRITE
 11048*        DATASET   (ELTRLR-DSID)
 11049*        FROM      (ACTIVITY-TRAILERS)
 11050*        RIDFLD    (AT-CONTROL-PRIMARY)
 11051*    END-EXEC.
 11052     MOVE LENGTH OF
 11053      ACTIVITY-TRAILERS
 11054       TO DFHEIV11
 11055*    MOVE '&$ L                  ''   #00010258' TO DFHEIV0
 11056     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11057     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11058     MOVE X'2020233030303130323538' TO DFHEIV0(25:11)
 11059     CALL 'kxdfhei1' USING DFHEIV0,
 11060           ELTRLR-DSID,
 11061           ACTIVITY-TRAILERS,
 11062           DFHEIV11,
 11063           AT-CONTROL-PRIMARY,
 11064           DFHEIV99,
 11065           DFHEIV99
 11066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11067
 11068
 11069 3994B-EXIT.
 11070     EXIT.
 11071 3994C-BUILD-NINETY-FIVE-TRAILER.
 11072
 11073     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11074     MOVE 'AT'                   TO AT-RECORD-ID
 11075
 11076     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11077     MOVE CLMCARRI               TO AT-CARRIER
 11078
 11079     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11080     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11081     MOVE +95                    TO AT-SEQUENCE-NO
 11082     MOVE '6'                    TO AT-TRAILER-TYPE
 11083     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
 11084
 11085     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11086                                    AT-GEN-INFO-LAST-MAINT-DT
 11087
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 209
* EL130.cbl
 11088     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11089                                    AT-GEN-INFO-LAST-UPDATED-BY
 11090     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11091
 11092     perform varying e1 from +1 by +1 until
 11093        ws-error-no (e1) = spaces
 11094        move ws-error-no (e1)    to at-note-error-no (e1)
 11095     end-perform
 11096
 11097     if at-info-line-1 not = spaces
 11098
 11099* EXEC CICS WRITE
 11100*          DATASET  (ELTRLR-DSID)
 11101*          FROM     (ACTIVITY-TRAILERS)
 11102*          RIDFLD   (AT-CONTROL-PRIMARY)
 11103*       END-EXEC
 11104     MOVE LENGTH OF
 11105      ACTIVITY-TRAILERS
 11106       TO DFHEIV11
 11107*    MOVE '&$ L                  ''   #00010293' TO DFHEIV0
 11108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11110     MOVE X'2020233030303130323933' TO DFHEIV0(25:11)
 11111     CALL 'kxdfhei1' USING DFHEIV0,
 11112           ELTRLR-DSID,
 11113           ACTIVITY-TRAILERS,
 11114           DFHEIV11,
 11115           AT-CONTROL-PRIMARY,
 11116           DFHEIV99,
 11117           DFHEIV99
 11118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11119     end-if
 11120
 11121     .
 11122 3994C-EXIT.
 11123     EXIT.
 11124 3995-BUILD-CLAIM-RECORD.
 11125     IF PROCCDL GREATER ZERO
 11126         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11127     ELSE
 11128         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11129     END-IF.
 11130
 11131     IF FSTNMEL GREATER ZERO
 11132         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11133     END-IF.
 11134
 11135     IF INITL GREATER ZERO
 11136         MOVE INITI              TO CL-INSURED-MID-INIT
 11137     END-IF.
 11138
 11139     IF BIRTHDTL GREATER ZERO
 11140         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11141     END-IF.
 11142
 11143     IF SEXL GREATER ZERO
 11144         MOVE SEXI               TO CL-INSURED-SEX-CD
 11145     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 210
* EL130.cbl
 11146
 11147     IF OCCCDL GREATER ZERO
 11148         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 11149     END-IF.
 11150
 11151     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11152
 11153*    IF CLMTYPEL GREATER ZERO
 11154     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11155*    END-IF.
 11156
 11157     IF PREMTYPL GREATER ZERO
 11158         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11159     END-IF.
 11160
 11161     IF INCURL GREATER ZERO
 11162         MOVE WS-INCUR           TO CL-INCURRED-DT
 11163     END-IF.
 11164
 11165     IF (PI-COMPANY-ID = 'DCC')
 11166        AND (ERPDEF-FOUND)
 11167        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11168*       MOVE WS-CRIT-PER-RECURRENT
 11169*                                TO CL-CRIT-PER-RECURRENT
 11170*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11171     ELSE
 11172        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11173           MOVE CM-LF-CRITICAL-PERIOD
 11174                                 TO CL-CRITICAL-PERIOD
 11175        ELSE
 11176           MOVE CM-AH-CRITICAL-PERIOD
 11177                                 TO CL-CRITICAL-PERIOD
 11178        END-IF
 11179     END-IF
 11180
 11181     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11182        COMPUTE DC-ELAPSED-MONTHS =
 11183           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11184        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11185        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11186        MOVE '6'                 TO DC-OPTION-CODE
 11187        PERFORM 9700-LINK-DATE-CONVERT
 11188                                 THRU 9700-EXIT
 11189        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11190     END-IF
 11191
 11192     if instypel > zero
 11193        move instypei            to cl-insured-claim
 11194     end-if
 11195     IF REPORTL GREATER ZERO
 11196         MOVE WS-REPORT          TO CL-REPORTED-DT
 11197     END-IF.
 11198
 11199     IF EIBAID = DFHPF6
 11200         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 11201             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11202                 IF EMI-FORCABLE-CTR = +1
 11203                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 211
* EL130.cbl
 11204                 END-IF
 11205         END-IF
 11206     END-IF.
 11207
 11208     IF ESTENDL GREATER ZERO
 11209        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11210     END-IF.
 11211
 11212     IF ADDONDTL GREATER ZERO
 11213         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11214     END-IF.
 11215
 11216     IF CAUSEL GREATER ZERO
 11217         MOVE CAUSEI             TO CL-CAUSE-CD
 11218     END-IF.
 11219
 11220     IF SSNL GREATER ZERO
 11221         MOVE SSNI               TO CL-SOC-SEC-NO
 11222     ELSE
 11223         MOVE CERT-STATE         TO CL-SSN-STATE
 11224         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11225         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11226     END-IF.
 11227
 11228     IF PRICDL GREATER ZERO
 11229         MOVE PRICDI             TO CL-PRIORITY-CD
 11230     END-IF.
 11231
 11232     IF SUPVL GREATER ZERO
 11233         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11234     END-IF.
 11235
 11236     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11237     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11238     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11239
 11240     IF RELCLML GREATER ZERO
 11241         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11242     END-IF.
 11243
 11244     IF FILETOL GREATER ZERO
 11245         MOVE FILETOI            TO CL-FILE-LOCATION
 11246     END-IF.
 11247
 11248 3995-EXIT.
 11249      EXIT.
 11250 3996-read-cert-claim-trailer.
 11251
 11252     move cm-ah-benefit-amt      to ws-monthly-benefit
 11253     if pi-dcc-max-amt < ws-monthly-benefit
 11254        move pi-dcc-max-amt      to ws-monthly-benefit
 11255     end-if
 11256
 11257     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
 11258     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11259     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11260     MOVE CM-STATE               TO CTRLR-STATE
 11261     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 212
* EL130.cbl
 11262     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11263     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11264     MOVE 'B'                    TO CTRLR-REC-TYPE
 11265
 11266* EXEC CICS READ
 11267*       DATASET  (ELCRTT-DSID)
 11268*       set     (address of CERTIFICATE-TRAILERS)
 11269*       RIDFLD   (ELCRTT-KEY)
 11270*       RESP     (WS-RESPONSE)
 11271*    END-EXEC
 11272*    MOVE '&"S        E          (  N#00010444' TO DFHEIV0
 11273     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11275     MOVE X'204E233030303130343434' TO DFHEIV0(25:11)
 11276     CALL 'kxdfhei1' USING DFHEIV0,
 11277           ELCRTT-DSID,
 11278           DFHEIV20,
 11279           DFHEIV99,
 11280           ELCRTT-KEY,
 11281           DFHEIV99,
 11282           DFHEIV99,
 11283           DFHEIV99
 11284     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11285         DFHEIV20
 11286     MOVE EIBRESP  TO WS-RESPONSE
 11287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11288     IF WS-RESP-NORMAL
 11289*       if instypei = 'P'
 11290*          move +1 to s1
 11291*       else
 11292*          MOVE +2 to s1
 11293*       end-if
 11294
 11295        move +1 to s1
 11296        evaluate clmtypei
 11297           when 'A'
 11298              move +1 to s2
 11299           when 'I'
 11300              move +2 to s2
 11301           when 'G'
 11302              move +3 to s2
 11303           when 'L'
 11304              move +4 to s2
 11305           when 'P'
 11306              move +5 to s2
 11307        end-evaluate
 11308        if cs-claim-type (s1 s2) = clmtypei
 11309           if cs-no-of-claims (s1 s2) > zeros
 11310              move er-1659       to ws-error-no (e1)
 11311           end-if
 11312           compute WS-BENEFITS-PREV-PAID =
 11313              cs-total-paid (s1 s2) / ws-monthly-benefit
 11314           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11315              and (pi-dcc-max-benefits not = zeros)
 11316              add +1             to e1
 11317              MOVE ER-1660       TO EMI-ERROR
 11318                                    ws-error-no (e1)
 11319              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 213
* EL130.cbl
 11320                                 THRU 9900-EXIT
 11321           end-if
 11322        end-if
 11323     end-if
 11324
 11325     .
 11326 3996-exit.
 11327     exit.
 11328
 11329 3997-GET-ERPDEF.
 11330
 11331     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 11332                                    WS-ERPDEF-SW
 11333     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11334                                    WS-CRIT-PER-RTW-MOS
 11335
 11336     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11337     MOVE CM-STATE            TO ERPDEF-STATE
 11338     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11339     MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11340     MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11341     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11342     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11343
 11344
 11345* EXEC CICS STARTBR
 11346*        DATASET  ('ERPDEF')
 11347*        RIDFLD   (ERPDEF-KEY)
 11348*        GTEQ
 11349*        RESP     (WS-RESPONSE)
 11350*    END-EXEC
 11351     MOVE 'ERPDEF' TO DFHEIV1
 11352     MOVE 0
 11353       TO DFHEIV11
 11354*    MOVE '&,         G          &  N#00010506' TO DFHEIV0
 11355     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11356     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11357     MOVE X'204E233030303130353036' TO DFHEIV0(25:11)
 11358     CALL 'kxdfhei1' USING DFHEIV0,
 11359           DFHEIV1,
 11360           ERPDEF-KEY,
 11361           DFHEIV99,
 11362           DFHEIV11,
 11363           DFHEIV99
 11364     MOVE EIBRESP  TO WS-RESPONSE
 11365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11366
 11367     IF WS-RESP-NORMAL
 11368
 11369* EXEC CICS READNEXT
 11370*          DATASET  ('ERPDEF')
 11371*          INTO     (PRODUCT-MASTER)
 11372*          RIDFLD   (ERPDEF-KEY)
 11373*          RESP     (WS-RESPONSE)
 11374*       END-EXEC
 11375     MOVE LENGTH OF
 11376      PRODUCT-MASTER
 11377       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 214
* EL130.cbl
 11378     MOVE 'ERPDEF' TO DFHEIV1
 11379     MOVE 0
 11380       TO DFHEIV11
 11381*    MOVE '&.IL                  )  N#00010514' TO DFHEIV0
 11382     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11383     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11384     MOVE X'204E233030303130353134' TO DFHEIV0(25:11)
 11385     CALL 'kxdfhei1' USING DFHEIV0,
 11386           DFHEIV1,
 11387           PRODUCT-MASTER,
 11388           DFHEIV12,
 11389           ERPDEF-KEY,
 11390           DFHEIV99,
 11391           DFHEIV11,
 11392           DFHEIV99,
 11393           DFHEIV99
 11394     MOVE EIBRESP  TO WS-RESPONSE
 11395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11396
 11397        IF WS-RESP-NORMAL
 11398           IF (ERPDEF-KEY-SAVE (1:16) =
 11399              PD-CONTROL-PRIMARY (1:16))
 11400              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11401
 11402              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11403                 (A1 > +8)
 11404                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11405              END-PERFORM
 11406              IF A1 < +9
 11407
 11408                 SET ERPDEF-FOUND TO TRUE
 11409                 move pd-max-amt (a1)
 11410                              to pi-dcc-max-amt
 11411                 MOVE PD-CRIT-PERIOD (A1)
 11412                              TO WS-MAX-BENEFITS
 11413                                 pi-dcc-max-benefits
 11414                 MOVE PD-REC-CRIT-PERIOD (A1)
 11415                              TO WS-CRIT-PER-RECURRENT
 11416                 IF PD-RTW-MOS (A1) NUMERIC
 11417                    MOVE PD-RTW-MOS (A1)
 11418                              TO WS-CRIT-PER-RTW-MOS
 11419                 ELSE
 11420                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11421                 END-IF
 11422                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11423                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11424                                 TO WS-EXCL-PERIOD
 11425                 END-IF
 11426                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 11427                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11428                                 TO WS-COV-ENDS
 11429                 END-IF
 11430                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11431                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11432                                 TO WS-ACC-PERIOD
 11433                 END-IF
 11434              END-IF
 11435           END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 215
* EL130.cbl
 11436        END-IF
 11437     END-IF
 11438
 11439     .
 11440 3997-EXIT.
 11441     EXIT.
 11442
 11443 3998-update-cert-claim-trailer.
 11444
 11445
 11446* EXEC CICS GETMAIN
 11447*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11448*       LENGTH   (ELCRTT-LENGTH)
 11449*       INITIMG  (GETMAIN-SPACE)
 11450*    END-EXEC
 11451*    MOVE ',"IL                  $   #00010569' TO DFHEIV0
 11452     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11453     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11454     MOVE X'2020233030303130353639' TO DFHEIV0(25:11)
 11455     CALL 'kxdfhei1' USING DFHEIV0,
 11456           DFHEIV20,
 11457           ELCRTT-LENGTH,
 11458           GETMAIN-SPACE
 11459     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11460         DFHEIV20
 11461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11462
 11463     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11464     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11465     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11466     MOVE CM-STATE         TO CTRLR-STATE
 11467     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11468     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11469     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11470     MOVE 'B'              TO CTRLR-REC-TYPE
 11471
 11472* EXEC CICS READ
 11473*       UPDATE
 11474*       DATASET  (ELCRTT-DSID)
 11475*       into     (CERTIFICATE-TRAILERS)
 11476*       RIDFLD   (ELCRTT-KEY)
 11477*       RESP     (WS-RESPONSE)
 11478*    END-EXEC
 11479     MOVE LENGTH OF
 11480      CERTIFICATE-TRAILERS
 11481       TO DFHEIV11
 11482*    MOVE '&"IL       EU         (  N#00010583' TO DFHEIV0
 11483     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11484     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11485     MOVE X'204E233030303130353833' TO DFHEIV0(25:11)
 11486     CALL 'kxdfhei1' USING DFHEIV0,
 11487           ELCRTT-DSID,
 11488           CERTIFICATE-TRAILERS,
 11489           DFHEIV11,
 11490           ELCRTT-KEY,
 11491           DFHEIV99,
 11492           DFHEIV99,
 11493           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 216
* EL130.cbl
 11494     MOVE EIBRESP  TO WS-RESPONSE
 11495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11496     IF WS-RESP-NORMAL
 11497        perform 3999-upd-crt-trlr thru 3999-exit
 11498
 11499* EXEC CICS REWRITE
 11500*          DATASET  (ELCRTT-DSID)
 11501*          from     (CERTIFICATE-TRAILERS)
 11502*          RESP     (WS-RESPONSE)
 11503*       END-EXEC
 11504     MOVE LENGTH OF
 11505      CERTIFICATE-TRAILERS
 11506       TO DFHEIV11
 11507*    MOVE '&& L                  %  N#00010592' TO DFHEIV0
 11508     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11509     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11510     MOVE X'204E233030303130353932' TO DFHEIV0(25:11)
 11511     CALL 'kxdfhei1' USING DFHEIV0,
 11512           ELCRTT-DSID,
 11513           CERTIFICATE-TRAILERS,
 11514           DFHEIV11,
 11515           DFHEIV99
 11516     MOVE EIBRESP  TO WS-RESPONSE
 11517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11518     else
 11519        if ws-resp-notfnd
 11520           move 'CS'             to certificate-trailers
 11521           move cm-control-primary to cs-control-primary
 11522           move 'B'              to cs-trailer-type
 11523           perform varying s1 from +1 by +1 until s1 > +2
 11524              perform varying s2 from +1 by +1 until s2 > +10
 11525                 move zeros      to cs-bank (s1 s2)
 11526                                    cs-no-of-claims (s1 s2)
 11527                                    cs-days-paid (s1 s2)
 11528                                    cs-total-paid (s1 s2)
 11529              end-perform
 11530           end-perform
 11531           perform 3999-upd-crt-trlr
 11532                                 thru 3999-exit
 11533
 11534* EXEC CICS WRITE
 11535*             DATASET  (ELCRTT-DSID)
 11536*             from     (CERTIFICATE-TRAILERS)
 11537*             RIDFLD   (cs-control-primary)
 11538*             RESP     (WS-RESPONSE)
 11539*          END-EXEC
 11540     MOVE LENGTH OF
 11541      CERTIFICATE-TRAILERS
 11542       TO DFHEIV11
 11543*    MOVE '&$ L                  ''  N#00010612' TO DFHEIV0
 11544     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11545     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11546     MOVE X'204E233030303130363132' TO DFHEIV0(25:11)
 11547     CALL 'kxdfhei1' USING DFHEIV0,
 11548           ELCRTT-DSID,
 11549           CERTIFICATE-TRAILERS,
 11550           DFHEIV11,
 11551           cs-control-primary,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 217
* EL130.cbl
 11552           DFHEIV99,
 11553           DFHEIV99
 11554     MOVE EIBRESP  TO WS-RESPONSE
 11555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11556        end-if
 11557     END-IF
 11558
 11559     .
 11560 3998-exit.
 11561     exit.
 11562
 11563 3999-upd-crt-trlr.
 11564
 11565*    if instypei = 'P'
 11566*       move +1 to s1
 11567*    else
 11568*       MOVE +2 to s1
 11569*    end-if
 11570
 11571     move +1 to s1
 11572     evaluate clmtypei
 11573        when 'A'
 11574           move +1 to s2
 11575        when 'I'
 11576           move +2 to s2
 11577        when 'G'
 11578           move +3 to s2
 11579        when 'L'
 11580           move +4 to s2
 11581        when 'P'
 11582           move +5 to s2
 11583     end-evaluate
 11584
 11585     move clmtypei         to cs-claim-type (s1 s2)
 11586     add +1                to cs-no-of-claims (s1 s2)
 11587
 11588     .
 11589 3999-exit.
 11590     exit.
 11591 4000-CALCULATE-CERT-TERM.
 11592
 11593     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11594
 11595     MOVE N                      TO WS-TERM.
 11596
 11597     IF WS-TERM GREATER 120
 11598         MOVE 120                TO WS-TERM
 11599     END-IF.
 11600
 11601 4000-CALC-TERM-EXIT.
 11602      EXIT.
 11603
 11604 4100-CALC-GROSS-TERM.
 11605     MOVE HOLD-LOAN-BAL           TO L.
 11606     MOVE WS-ACVBENE              TO M.
 11607     COMPUTE N = L / M.
 11608     IF N LESS 1
 11609         MOVE 1  TO N
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 218
* EL130.cbl
 11610     END-IF.
 11611
 11612     IF LCVCDL GREATER ZERO
 11613         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11614     ELSE
 11615         MOVE ZEROS               TO WS-LF-RATE
 11616     END-IF.
 11617
 11618     IF ACVCDL GREATER ZERO
 11619         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11620     ELSE
 11621         MOVE ZEROS               TO WS-AH-RATE
 11622     END-IF.
 11623
 11624     COMPUTE I = WS-APR / +1200.
 11625
 11626 4105-LOOP.
 11627     IF N GREATER 240
 11628         GO TO 4200-EXIT
 11629     END-IF.
 11630
 11631     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11632
 11633     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11634         ADD 1 TO N
 11635         GO TO 4105-LOOP
 11636     END-IF.
 11637
 11638 4200-EXIT.
 11639      EXIT.
 11640
 11641 4210-CALC-LEFT-RIGHTONE.
 11642      MOVE L         TO LEFT-TOT-1.
 11643      SUBTRACT 1 FROM N.
 11644      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11645      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11646      ADD 1 TO N.
 11647
 11648 4211-CALC-TERM1.
 11649      MOVE N         TO TERM1.
 11650      MULTIPLY M BY TERM1.
 11651
 11652 4212-LOOP.
 11653      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11654      ADD 1 TO A-N.
 11655      MULTIPLY A-N BY TERM1.
 11656      SUBTRACT 1 FROM A-N.
 11657      ADD TERM1 TO LEFT-TOT-1.
 11658
 11659 4213-CALC-TERM2.
 11660      MOVE M         TO TERM2.
 11661      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 11662      MULTIPLY IA-N BY TERM2.
 11663      SUBTRACT TERM2 FROM LEFT-TOT-1.
 11664
 11665 4215-CALC-RIGHTONE.
 11666      MOVE M         TO RIGHT-TOT-1.
 11667      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 219
* EL130.cbl
 11668      MULTIPLY A-N BY RIGHT-TOT-1.
 11669
 11670 4220-EXIT.
 11671      EXIT.
 11672
 11673 4300-CALC-A-N.
 11674     IF N LESS 1
 11675         MOVE 0     TO A-N
 11676         GO TO 4300-EXIT
 11677     END-IF.
 11678
 11679     IF I = 0
 11680         MOVE .00001 TO I
 11681     END-IF.
 11682
 11683     ADD 1 TO I.
 11684     DIVIDE I INTO 1 GIVING V.
 11685     SUBTRACT 1 FROM I.
 11686     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11687     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11688     DIVIDE I INTO TERM3 GIVING A-N.
 11689
 11690 4300-EXIT.
 11691      EXIT.
 11692
 11693 4350-CALC-IA-N.
 11694     IF N LESS 1
 11695         MOVE 0      TO IA-N
 11696         GO TO 4400-EXIT
 11697     END-IF.
 11698
 11699     ADD 1 TO N.
 11700     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11701     SUBTRACT 1 FROM N.
 11702     MULTIPLY N BY V-EX-N GIVING TERM3.
 11703     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11704     SUBTRACT V FROM 1 GIVING TERM4.
 11705     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11706
 11707 4400-EXIT.
 11708      EXIT.
 11709
 11710 4450-CALC-V-EX-N.
 11711     IF N LESS 1
 11712         MOVE 1    TO V-EX-N
 11713         GO TO 4490-EXIT
 11714     END-IF.
 11715
 11716     MOVE N        TO NV-STORE.
 11717
 11718     IF V-EX-ONETIME = 1  OR
 11719        V NOT = V-EXPONENT (1)
 11720          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11721     END-IF.
 11722
 11723 4460-LOOP.
 11724     IF N GREATER 248
 11725         MOVE 248 TO N
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 220
* EL130.cbl
 11726     END-IF.
 11727
 11728     IF N = 1
 11729         MOVE V               TO V-EX-N
 11730     ELSE
 11731         MOVE V-EXPONENT (N)  TO V-EX-N
 11732     END-IF.
 11733
 11734     GO TO 4490-EXIT.
 11735
 11736 4470-BUILD-V-EX-TABLE.
 11737     MOVE 2      TO N.
 11738     MOVE V      TO V-EXPONENT (1)
 11739                    V-EX-N.
 11740
 11741 4471-LOOP.
 11742     MULTIPLY V BY V-EX-N.
 11743     MOVE V-EX-N   TO V-EXPONENT (N).
 11744
 11745     ADD 1 TO N.
 11746     IF N LESS 248
 11747         GO TO 4471-LOOP
 11748     END-IF.
 11749
 11750     MOVE NV-STORE     TO N.
 11751     MOVE ZERO         TO V-EX-ONETIME.
 11752
 11753 4480-EXIT.
 11754      EXIT.
 11755
 11756 4490-EXIT.
 11757      EXIT.
 11758
 11759 4500-CALC-NET-TERM.
 11760     MOVE HOLD-LOAN-BAL           TO L.
 11761     MOVE WS-ACVBENE              TO M.
 11762     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11763
 11764     IF WS-REMAIN GREATER ZERO
 11765         ADD 1 TO N
 11766     END-IF.
 11767
 11768     IF N = 0
 11769         MOVE 1 TO N
 11770     END-IF.
 11771
 11772 4700-EXIT.
 11773      EXIT.
 11774
 11775 4999-CALC-TERM-EXIT.
 11776     EXIT.
 11777
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 221
* EL130.cbl
 11779 5000-INCURRED-CHANGE.
 11780     IF NOT MODIFY-CAP
 11781         MOVE ER-0070            TO EMI-ERROR
 11782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11783         MOVE -1                 TO MAINTL
 11784         GO TO 8200-SEND-DATAONLY
 11785     END-IF.
 11786
 11787     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11788        CLMCARRI     NOT = PI-LAST-CARR        OR
 11789        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11790        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11791        PI-INCURR-SW NOT = 'Y'
 11792          GO TO 1000-SHOW-CLAIM
 11793     END-IF.
 11794
 11795     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11796     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11797     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11798
 11799     IF EMI-NO-ERRORS
 11800         GO TO 5000-TRY-TO-BUILD
 11801     END-IF.
 11802
 11803     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11804        MOVE ER-0433             TO EMI-ERROR
 11805        MOVE -1                  TO MAINTL
 11806        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11807        GO TO 8200-SEND-DATAONLY
 11808     END-IF.
 11809
 11810     IF EIBAID = DFHPF6
 11811         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11812            MOVE ER-0434         TO EMI-ERROR
 11813            MOVE -1              TO MAINTL
 11814            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11815            GO TO 8200-SEND-DATAONLY
 11816         ELSE
 11817            MOVE +1              TO INCURL
 11818            GO TO 5000-TRY-TO-BUILD
 11819         END-IF
 11820     END-IF.
 11821
 11822     GO TO 8200-SEND-DATAONLY.
 11823
 11824 5000-TRY-TO-BUILD.
 11825
 11826     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11827
 11828     MOVE CLMCARRI               TO MSTR-CARRIER.
 11829
 11830     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11831     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11832     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11833
 11834     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11835
 11836     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 222
* EL130.cbl
 11837         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11838     END-IF.
 11839
 11840     IF CL-PURGED-DT NOT = LOW-VALUES
 11841
 11842
 11843* EXEC CICS UNLOCK
 11844*            DATASET   (ELMSTR-DSID)
 11845*        END-EXEC
 11846*    MOVE '&*                    #   #00010904' TO DFHEIV0
 11847     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11848     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11849     MOVE X'2020233030303130393034' TO DFHEIV0(25:11)
 11850     CALL 'kxdfhei1' USING DFHEIV0,
 11851           ELMSTR-DSID,
 11852           DFHEIV99
 11853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11854         MOVE ER-7691            TO EMI-ERROR
 11855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11856         MOVE -1                 TO MAINTL
 11857         GO TO 8200-SEND-DATAONLY
 11858     END-IF.
 11859
 11860     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11861
 11862
 11863* EXEC CICS UNLOCK
 11864*            DATASET   (ELMSTR-DSID)
 11865*       END-EXEC
 11866*    MOVE '&*                    #   #00010915' TO DFHEIV0
 11867     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11868     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11869     MOVE X'2020233030303130393135' TO DFHEIV0(25:11)
 11870     CALL 'kxdfhei1' USING DFHEIV0,
 11871           ELMSTR-DSID,
 11872           DFHEIV99
 11873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11874         MOVE ER-0523             TO EMI-ERROR
 11875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11876         MOVE -1                  TO MAINTL
 11877         GO TO 8200-SEND-DATAONLY
 11878     END-IF.
 11879
 11880     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11881
 11882     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11883     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11884     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11885     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11886     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11887
 11888     IF MANRSVL GREATER ZERO
 11889        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11890                                    AT-CURRENT-MANUAL-RESERVE
 11891     END-IF.
 11892     MOVE 1                      TO SUB.
 11893
 11894 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 223
* EL130.cbl
 11895     IF SUB = 1
 11896        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11897        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11898        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11899     ELSE
 11900        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11901        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11902                                    AT-OPEN-CLOSE-REASON (SUB)
 11903     END-IF.
 11904
 11905     IF SUB NOT = 6
 11906        ADD 1                    TO SUB
 11907        GO TO 5010-LOOP
 11908     END-IF.
 11909
 11910 5020-UPDATE.
 11911
 11912     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11913
 11914     IF DIAGL = ZERO
 11915         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11916         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11917         GO TO 5025-BYPASS-UPDATE
 11918     END-IF.
 11919
 11920     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11921
 11922     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11923     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11924
 11925     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11926
 11927 5025-BYPASS-UPDATE.
 11928
 11929
 11930
 11931* EXEC CICS GETMAIN
 11932*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11933*        LENGTH   (ELTRLR-LENGTH)
 11934*    END-EXEC.
 11935*    MOVE '," L                  $   #00010974' TO DFHEIV0
 11936     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11937     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11938     MOVE X'2020233030303130393734' TO DFHEIV0(25:11)
 11939     CALL 'kxdfhei1' USING DFHEIV0,
 11940           DFHEIV20,
 11941           ELTRLR-LENGTH,
 11942           DFHEIV99
 11943     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11944         DFHEIV20
 11945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11946
 11947
 11948     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11949     MOVE 'AT'                   TO AT-RECORD-ID.
 11950
 11951     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11952     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 224
* EL130.cbl
 11953     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11954     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11955     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11956     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11957     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11958     MOVE '9'                    TO AT-TRAILER-TYPE.
 11959     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11960     MOVE '5'                    TO DC-OPTION-CODE.
 11961     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11962     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11963
 11964     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11965     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11966
 11967     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11968     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11969     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11970     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11971     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 11972     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 11973     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 11974     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 11975     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 11976     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 11977
 11978     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 11979     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 11980     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 11981     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 11982     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 11983
 11984
 11985
 11986* EXEC CICS WRITE
 11987*        DATASET   (ELTRLR-DSID)
 11988*        FROM      (ACTIVITY-TRAILERS)
 11989*        RIDFLD    (AT-CONTROL-PRIMARY)
 11990*    END-EXEC.
 11991     MOVE LENGTH OF
 11992      ACTIVITY-TRAILERS
 11993       TO DFHEIV11
 11994*    MOVE '&$ L                  ''   #00011016' TO DFHEIV0
 11995     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11997     MOVE X'2020233030303131303136' TO DFHEIV0(25:11)
 11998     CALL 'kxdfhei1' USING DFHEIV0,
 11999           ELTRLR-DSID,
 12000           ACTIVITY-TRAILERS,
 12001           DFHEIV11,
 12002           AT-CONTROL-PRIMARY,
 12003           DFHEIV99,
 12004           DFHEIV99
 12005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12006
 12007
 12008     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12009     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12010     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 225
* EL130.cbl
 12011     MOVE CL-CERT-STATE          TO CERT-STATE.
 12012     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12013     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12014     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12015
 12016
 12017
 12018* EXEC CICS HANDLE CONDITION
 12019*        NOTFND   (5050-CERT-NOT-FOUND)
 12020*    END-EXEC.
 12021*    MOVE '"$I                   ! ; #00011031' TO DFHEIV0
 12022     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12024     MOVE X'3B20233030303131303331' TO DFHEIV0(25:11)
 12025     CALL 'kxdfhei1' USING DFHEIV0
 12026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12027
 12028
 12029     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12030
 12031     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12032
 12033
 12034
 12035* EXEC CICS HANDLE CONDITION
 12036*         DUPKEY   (5030-CERT-WRITTEN)
 12037*    END-EXEC.
 12038*    MOVE '"$$                   ! < #00011040' TO DFHEIV0
 12039     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12041     MOVE X'3C20233030303131303430' TO DFHEIV0(25:11)
 12042     CALL 'kxdfhei1' USING DFHEIV0
 12043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12044
 12045
 12046
 12047
 12048* EXEC CICS REWRITE
 12049*        DATASET  (ELCERT-DSID)
 12050*        FROM     (CERTIFICATE-MASTER)
 12051*    END-EXEC.
 12052     MOVE LENGTH OF
 12053      CERTIFICATE-MASTER
 12054       TO DFHEIV11
 12055*    MOVE '&& L                  %   #00011045' TO DFHEIV0
 12056     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12057     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12058     MOVE X'2020233030303131303435' TO DFHEIV0(25:11)
 12059     CALL 'kxdfhei1' USING DFHEIV0,
 12060           ELCERT-DSID,
 12061           CERTIFICATE-MASTER,
 12062           DFHEIV11,
 12063           DFHEIV99
 12064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12065
 12066
 12067 5030-CERT-WRITTEN.
 12068
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 226
* EL130.cbl
 12069     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12070                                    CL-INCURRED-DT
 12071                                    CL-REPORTED-DT
 12072                                    CL-EST-END-OF-DISAB-DT
 12073                                    CL-PAID-THRU-DT.
 12074
 12075     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12076                                    CL-NO-OF-PMTS-MADE
 12077                                    CL-NO-OF-DAYS-PAID.
 12078
 12079     IF CLAIM-IS-CLOSED
 12080        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12081        MOVE 'O'                 TO CL-CLAIM-STATUS
 12082     END-IF.
 12083
 12084     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12085     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12086     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12087
 12088
 12089
 12090* EXEC CICS HANDLE CONDITION
 12091*         DUPKEY   (5035-CLAIM-WRITTEN)
 12092*    END-EXEC.
 12093*    MOVE '"$$                   ! = #00011072' TO DFHEIV0
 12094     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12096     MOVE X'3D20233030303131303732' TO DFHEIV0(25:11)
 12097     CALL 'kxdfhei1' USING DFHEIV0
 12098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12099
 12100
 12101
 12102
 12103* EXEC CICS REWRITE
 12104*        DATASET   (ELMSTR-DSID)
 12105*        FROM      (CLAIM-MASTER)
 12106*    END-EXEC.
 12107     MOVE LENGTH OF
 12108      CLAIM-MASTER
 12109       TO DFHEIV11
 12110*    MOVE '&& L                  %   #00011077' TO DFHEIV0
 12111     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12112     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12113     MOVE X'2020233030303131303737' TO DFHEIV0(25:11)
 12114     CALL 'kxdfhei1' USING DFHEIV0,
 12115           ELMSTR-DSID,
 12116           CLAIM-MASTER,
 12117           DFHEIV11,
 12118           DFHEIV99
 12119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12120
 12121
 12122 5035-CLAIM-WRITTEN.
 12123
 12124     MOVE ER-0000                TO EMI-ERROR.
 12125     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12126
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 227
* EL130.cbl
 12127     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12128     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12129     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12130     MOVE CLMCARRI               TO PI-LAST-CARR.
 12131
 12132     IF PRTOPTL GREATER ZERO
 12133         MOVE PRTOPTI            TO PI-PRT-OPT
 12134     END-IF.
 12135
 12136     IF ALTPRTL GREATER ZERO
 12137         MOVE ALTPRTI            TO PI-ALT-PRT
 12138     END-IF.
 12139
 12140     MOVE LOW-VALUES             TO EL130AI.
 12141
 12142     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12143     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12144     MOVE PI-LAST-CARR           TO CLMCARRO.
 12145     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12146
 12147     IF PI-PRT-OPT = 'N' OR 'L'
 12148         MOVE PI-PRT-OPT         TO PRTOPTO
 12149         MOVE 1                  TO PRTOPTL
 12150     END-IF.
 12151
 12152     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12153         MOVE PI-ALT-PRT         TO ALTPRTO
 12154         MOVE 4                  TO ALTPRTL
 12155     END-IF.
 12156
 12157     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12158     MOVE AL-SANON               TO CERTNOA SUFXA.
 12159
 12160     MOVE SPACES                 TO PI-INCURR-SW.
 12161
 12162     IF PRTOPTL GREATER ZERO
 12163         IF PRTOPTI = 'L'
 12164             GO TO 0400-CREATE-ELACTQ
 12165         ELSE
 12166             GO TO 0480-PRINT-NOW
 12167         END-IF
 12168     END-IF.
 12169
 12170     GO TO 8100-SEND-INITIAL-MAP.
 12171
 12172 5050-CERT-NOT-FOUND.
 12173
 12174     MOVE ER-0244                TO EMI-ERROR.
 12175     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12176     MOVE -1                     TO CERTNOL.
 12177     GO TO 8200-SEND-DATAONLY.
 12178
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 228
* EL130.cbl
 12180 5500-BUILD-FORM-TRAILER.
 12181*************************************************************
 12182*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12183*************************************************************
 12184
 12185     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12186
 12187     IF  WS-BEN-ALPHA-2 = '30'
 12188         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12189         MOVE '6'                TO DC-OPTION-CODE
 12190         IF CL-CARRIER = 'C'
 12191             MOVE +14            TO DC-ELAPSED-DAYS
 12192             MOVE +0             TO DC-ELAPSED-MONTHS
 12193             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12194             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12195         ELSE
 12196             MOVE +21            TO DC-ELAPSED-DAYS
 12197             MOVE +0             TO DC-ELAPSED-MONTHS
 12198             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12199             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12200         END-IF
 12201     END-IF.
 12202
 12203
 12204
 12205* EXEC CICS GETMAIN
 12206*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12207*         LENGTH   (ELTRLR-LENGTH)
 12208*         INITIMG  (GETMAIN-SPACE)
 12209*    END-EXEC.
 12210*    MOVE ',"IL                  $   #00011164' TO DFHEIV0
 12211     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12212     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12213     MOVE X'2020233030303131313634' TO DFHEIV0(25:11)
 12214     CALL 'kxdfhei1' USING DFHEIV0,
 12215           DFHEIV20,
 12216           ELTRLR-LENGTH,
 12217           GETMAIN-SPACE
 12218     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12219         DFHEIV20
 12220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12221
 12222
 12223     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12224     MOVE 'AT'                   TO AT-RECORD-ID.
 12225
 12226     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12227     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12228     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12229     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12230                                    AT-FORM-LAST-MAINT-DT.
 12231     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12232                                    AT-FORM-LAST-UPDATED-BY.
 12233     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12234     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12235     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12236                                    AT-FORM-RE-SEND-DT
 12237                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 229
* EL130.cbl
 12238                                    AT-EMP-FORM-ANSWERED-DT
 12239                                    AT-PHY-FORM-ANSWERED-DT
 12240                                    AT-EMP-FORM-SEND-ON-DT
 12241                                    AT-FORM-PRINTED-DT
 12242                                    AT-FORM-REPRINT-DT.
 12243     MOVE '1'                    TO AT-FORM-TYPE.
 12244
 12245     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12246                                    AT-INSTRUCT-LN-2
 12247                                    AT-INSTRUCT-LN-3.
 12248
 12249     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12250     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12251
 12252     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12253
 12254     IF AM-EMPLOYER-STMT-USED = 'Y'
 12255        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12256     END-IF.
 12257
 12258
 12259
 12260* EXEC CICS WRITE
 12261*         DATASET  (ELTRLR-DSID)
 12262*         FROM     (ACTIVITY-TRAILERS)
 12263*         RIDFLD   (AT-CONTROL-PRIMARY)
 12264*    END-EXEC.
 12265     MOVE LENGTH OF
 12266      ACTIVITY-TRAILERS
 12267       TO DFHEIV11
 12268*    MOVE '&$ L                  ''   #00011206' TO DFHEIV0
 12269     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12270     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12271     MOVE X'2020233030303131323036' TO DFHEIV0(25:11)
 12272     CALL 'kxdfhei1' USING DFHEIV0,
 12273           ELTRLR-DSID,
 12274           ACTIVITY-TRAILERS,
 12275           DFHEIV11,
 12276           AT-CONTROL-PRIMARY,
 12277           DFHEIV99,
 12278           DFHEIV99
 12279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12280
 12281
 12282 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 230
* EL130.cbl
 12284*************************************************************
 12285*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12286*************************************************************
 12287
 12288 5700-BUILD-ARCHIVE-HEADER.
 12289
 12290     MOVE '1'                    TO CNTL-REC-TYPE.
 12291     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12292     MOVE SPACES                 TO CNTL-ACCESS.
 12293
 12294
 12295
 12296* EXEC CICS READ
 12297*         DATASET  (ELCNTL-DSID)
 12298*         SET      (ADDRESS OF CONTROL-FILE)
 12299*         RIDFLD   (ELCNTL-KEY)
 12300*         UPDATE
 12301*    END-EXEC.
 12302*    MOVE '&"S        EU         (   #00011225' TO DFHEIV0
 12303     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12304     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12305     MOVE X'2020233030303131323235' TO DFHEIV0(25:11)
 12306     CALL 'kxdfhei1' USING DFHEIV0,
 12307           ELCNTL-DSID,
 12308           DFHEIV20,
 12309           DFHEIV99,
 12310           ELCNTL-KEY,
 12311           DFHEIV99,
 12312           DFHEIV99,
 12313           DFHEIV99
 12314     SET ADDRESS OF CONTROL-FILE TO
 12315         DFHEIV20
 12316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12317
 12318
 12319     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12320
 12321     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12322
 12323
 12324
 12325* EXEC CICS REWRITE
 12326*         FROM     (CONTROL-FILE)
 12327*         DATASET  (ELCNTL-DSID)
 12328*    END-EXEC.
 12329     MOVE LENGTH OF
 12330      CONTROL-FILE
 12331       TO DFHEIV11
 12332*    MOVE '&& L                  %   #00011237' TO DFHEIV0
 12333     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12334     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12335     MOVE X'2020233030303131323337' TO DFHEIV0(25:11)
 12336     CALL 'kxdfhei1' USING DFHEIV0,
 12337           ELCNTL-DSID,
 12338           CONTROL-FILE,
 12339           DFHEIV11,
 12340           DFHEIV99
 12341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 231
* EL130.cbl
 12342
 12343
 12344
 12345
 12346* EXEC CICS HANDLE CONDITION
 12347*         NOTOPEN  (9990-ABEND)
 12348*         DUPKEY   (5799-EXIT)
 12349*    END-EXEC.
 12350*    MOVE '"$J$                  ! > #00011243' TO DFHEIV0
 12351     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12353     MOVE X'3E20233030303131323433' TO DFHEIV0(25:11)
 12354     CALL 'kxdfhei1' USING DFHEIV0
 12355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12356
 12357
 12358
 12359
 12360* EXEC CICS GETMAIN
 12361*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12362*         LENGTH  (ELARCH-LENGTH)
 12363*    END-EXEC.
 12364*    MOVE '," L                  $   #00011249' TO DFHEIV0
 12365     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12367     MOVE X'2020233030303131323439' TO DFHEIV0(25:11)
 12368     CALL 'kxdfhei1' USING DFHEIV0,
 12369           DFHEIV20,
 12370           ELARCH-LENGTH,
 12371           DFHEIV99
 12372     SET ADDRESS OF LETTER-ARCHIVE TO
 12373         DFHEIV20
 12374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12375
 12376
 12377     MOVE SPACES                 TO LETTER-ARCHIVE.
 12378     MOVE 'LA'                   TO LA-RECORD-ID.
 12379     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12380                                    LA-ARCHIVE-NO-A1.
 12381     MOVE '4'                    TO LA-RECORD-TYPE
 12382                                    LA-RECORD-TYPE-A1.
 12383     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12384                                    LA-LINE-SEQ-NO-A1.
 12385     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12386                                    LA-COMPANY-CD-A1.
 12387     MOVE CL-CARRIER             TO LA4-CARRIER.
 12388     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12389     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12390     MOVE CL-CERT-STATE          TO LA4-STATE.
 12391     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12392     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12393     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12394     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12395                                    LA4-RESEND-PRINT-DATE
 12396                                    LA4-FORM-REM-PRINT-DT
 12397                                    LA4-RESEND-DATE.
 12398     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12399     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 232
* EL130.cbl
 12400
 12401
 12402
 12403* EXEC CICS WRITE
 12404*         DATASET  (ELARCH-DSID)
 12405*         FROM     (LETTER-ARCHIVE)
 12406*         RIDFLD   (LA-CONTROL-PRIMARY)
 12407*    END-EXEC.
 12408     MOVE LENGTH OF
 12409      LETTER-ARCHIVE
 12410       TO DFHEIV11
 12411*    MOVE '&$ L                  ''   #00011279' TO DFHEIV0
 12412     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12413     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12414     MOVE X'2020233030303131323739' TO DFHEIV0(25:11)
 12415     CALL 'kxdfhei1' USING DFHEIV0,
 12416           ELARCH-DSID,
 12417           LETTER-ARCHIVE,
 12418           DFHEIV11,
 12419           LA-CONTROL-PRIMARY,
 12420           DFHEIV99,
 12421           DFHEIV99
 12422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12423
 12424
 12425 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 233
* EL130.cbl
 12427 6000-EDIT-CLAIM-DATA.
 12428
 12429     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12430     MOVE '2'                    TO DC-OPTION-CODE.
 12431     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12432     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12433
 12434     IF CLMNOL GREATER ZERO
 12435         IF CLMNOI = SPACES OR LOW-VALUES
 12436             MOVE -1             TO CLMNOL
 12437             MOVE AL-UABON       TO CLMNOA
 12438             MOVE ER-7688        TO EMI-ERROR
 12439             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12440         ELSE
 12441             MOVE AL-UANON       TO CLMNOA
 12442         END-IF
 12443     END-IF.
 12444
 12445     IF CERTNOL = ZERO
 12446         MOVE -1                 TO CERTNOL
 12447         MOVE AL-SABON           TO CERTNOA
 12448         MOVE ER-0203            TO EMI-ERROR
 12449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12450     ELSE
 12451         MOVE AL-SANON           TO CERTNOA
 12452     END-IF.
 12453
 12454     IF SUFXL = ZERO
 12455         MOVE SPACES             TO SUFXI
 12456         MOVE AL-SANON           TO SUFXA
 12457     ELSE
 12458         MOVE AL-SANON           TO SUFXA
 12459     END-IF.
 12460
 12461     IF CLMCARRL = ZERO
 12462         MOVE -1                 TO CLMCARRL
 12463         MOVE ER-0194            TO EMI-ERROR
 12464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12465     ELSE
 12466         MOVE CLMCARRI           TO PI-CARRIER
 12467         IF PI-NO-CARRIER-SECURITY
 12468             MOVE AL-UANON       TO CLMCARRA
 12469         END-IF
 12470     END-IF.
 12471
 12472     IF CLMTYPEL > ZERO
 12473        IF ((PI-COMPANY-ID = 'DCC')
 12474           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12475              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 12476                        OR
 12477           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12478           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12479              AND PI-AH-OVERRIDE-L1))
 12480              MOVE -1             TO CLMTYPEL
 12481              MOVE AL-UABON       TO CLMTYPEA
 12482              MOVE ER-7634        TO EMI-ERROR
 12483              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12484        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 234
* EL130.cbl
 12485           MOVE AL-UANON       TO CLMTYPEA
 12486        END-IF
 12487     ELSE
 12488        IF MAINTI = 'A'
 12489           MOVE -1             TO CLMTYPEL
 12490           MOVE AL-UABON       TO CLMTYPEA
 12491           MOVE ER-0546        TO EMI-ERROR
 12492           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12493        END-IF
 12494     END-IF
 12495*    if instypel > ZERO
 12496*       if instypei = 'P' OR 'S'
 12497*          move al-uanon         to instypea
 12498*       else
 12499*          MOVE -1               TO INSTYPEL
 12500*          MOVE AL-UABON         TO INSTYPEA
 12501*          MOVE ER-1654          TO EMI-ERROR
 12502*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12503*       END-IF
 12504*    ELSE
 12505*       IF MAINTI = 'A'
 12506*          MOVE -1               TO INSTYPEL
 12507*          MOVE AL-UABON         TO INSTYPEA
 12508*          MOVE ER-1654          TO EMI-ERROR
 12509*          PERFORM 9900-ERROR-FORMAT
 12510*                                THRU 9900-EXIT
 12511*       END-IF
 12512*    END-IF
 12513     IF PCERTNOL = ZERO
 12514        MOVE CERTNOI             TO PCERTNOI
 12515        MOVE CERTNOL             TO PCERTNOL
 12516        MOVE AL-UANON            TO PCERTNOA
 12517     ELSE
 12518        MOVE AL-UANON            TO PCERTNOA
 12519     END-IF.
 12520
 12521     IF PSUFXL = ZERO
 12522        MOVE SUFXI               TO PSUFXI
 12523        MOVE SUFXL               TO PSUFXL
 12524        MOVE AL-UANON            TO PSUFXA
 12525     ELSE
 12526        MOVE AL-UANON            TO PSUFXA
 12527     END-IF.
 12528
 12529     IF MAINTI = 'I'
 12530         GO TO 6020-EDIT
 12531     END-IF.
 12532
 12533     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12534         MOVE -1                 TO LSTNMEL
 12535         MOVE ER-0236            TO EMI-ERROR
 12536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12537     ELSE
 12538         MOVE AL-UANON           TO LSTNMEA
 12539     END-IF.
 12540     IF SEXL > ZEROS
 12541        IF SEXI = 'M' OR 'F'
 12542           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 235
* EL130.cbl
 12543        ELSE
 12544           MOVE -1               TO SEXL
 12545           MOVE AL-UABON         TO SEXA
 12546           MOVE ER-0219          TO EMI-ERROR
 12547           PERFORM 9900-ERROR-FORMAT
 12548                                 THRU 9900-EXIT
 12549        END-IF
 12550     ELSE
 12551        IF MAINTI = 'A'
 12552           MOVE -1               TO SEXL
 12553           MOVE AL-UABON         TO SEXA
 12554           MOVE ER-0219          TO EMI-ERROR
 12555           PERFORM 9900-ERROR-FORMAT
 12556                                 THRU 9900-EXIT
 12557        END-IF
 12558     END-IF
 12559     IF SSNL GREATER THAN ZERO
 12560         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12561         IF WS-SOC-SEC-NO NUMERIC AND
 12562           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12563             NEXT SENTENCE
 12564         ELSE
 12565            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12566               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12567               WS-SSN-DASH2 = '-'
 12568                 NEXT SENTENCE
 12569            ELSE
 12570                 MOVE ER-0887        TO  EMI-ERROR
 12571                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12572                 MOVE AL-UABON       TO  SSNA
 12573                 MOVE -1             TO  SSNL
 12574            END-IF
 12575        END-IF
 12576     END-IF.
 12577
 12578     IF BIRTHDTL = ZERO
 12579         GO TO 6020-EDIT
 12580     END-IF.
 12581
 12582     IF BIRTHDTL GREATER ZERO
 12583         MOVE BIRTHDTI           TO DATE-WORK
 12584         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12585         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12586         MOVE '4'                TO DC-OPTION-CODE
 12587         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12588         IF DATE-CONVERSION-ERROR
 12589             MOVE AL-UABON       TO BIRTHDTA
 12590             MOVE -1             TO BIRTHDTL
 12591             MOVE ER-0220        TO EMI-ERROR
 12592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593             GO TO 6020-EDIT
 12594         END-IF
 12595     END-IF.
 12596
 12597******************************************************************
 12598**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12599**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12600**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 236
* EL130.cbl
 12601******************************************************************
 12602
 12603     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12604         MOVE BIRTHDTI           TO  DATE-WORK
 12605         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12606         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12607         MOVE '4'                TO  DC-OPTION-CODE
 12608         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12609         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12610                                     DC-ELAPSED-DAYS
 12611         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12612         IF DATE-CONVERSION-ERROR
 12613             MOVE AL-UABON       TO  BIRTHDTA
 12614             MOVE -1             TO  BIRTHDTL
 12615             MOVE ER-0220        TO  EMI-ERROR
 12616             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12617             GO TO 6020-EDIT
 12618         END-IF
 12619     END-IF.
 12620
 12621     MOVE AL-UANON               TO  BIRTHDTA.
 12622     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 12623     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 12624     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 12625
 12626 6020-EDIT.
 12627     IF INCURL GREATER ZERO
 12628         MOVE INCURI             TO DATE-WORK
 12629         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12630         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12631         MOVE '4'                TO DC-OPTION-CODE
 12632         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12633         IF DATE-CONVERSION-ERROR
 12634             MOVE AL-UABON       TO INCURA
 12635             MOVE -1             TO INCURL
 12636             MOVE ER-0222        TO EMI-ERROR
 12637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12638         ELSE
 12639             MOVE AL-UANON       TO INCURA
 12640             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 12641             MOVE DC-BIN-DATE-1  TO WS-INCUR
 12642                                    PI-SAVE-INCUR-DT
 12643             IF WS-INCUR GREATER THAN WS-TODAY-DT
 12644                 MOVE ER-0511     TO EMI-ERROR
 12645                 MOVE -1          TO INCURL
 12646                 MOVE AL-UABON    TO INCURA
 12647                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12648             ELSE
 12649*                NEXT SENTENCE
 12650                 CONTINUE
 12651             END-IF
 12652         END-IF
 12653     ELSE
 12654         MOVE ER-0516         TO EMI-ERROR
 12655         MOVE AL-UABON        TO INCURA
 12656         MOVE -1              TO INCURL
 12657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12658     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 237
* EL130.cbl
 12659
 12660     IF REPORTL GREATER ZERO
 12661         MOVE REPORTI            TO DATE-WORK
 12662         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12663         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12664         MOVE '4'                TO DC-OPTION-CODE
 12665         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12666         IF DATE-CONVERSION-ERROR
 12667             MOVE AL-UABON       TO REPORTA
 12668             MOVE -1             TO REPORTL
 12669             MOVE ER-0223        TO EMI-ERROR
 12670             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12671         ELSE
 12672             MOVE AL-UANON       TO REPORTA
 12673             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 12674             MOVE DC-BIN-DATE-1  TO WS-REPORT
 12675             IF WS-REPORT GREATER THAN WS-TODAY-DT
 12676                 MOVE ER-0512     TO EMI-ERROR
 12677                 MOVE -1          TO REPORTL
 12678                 MOVE AL-UABON    TO REPORTA
 12679                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12680             ELSE
 12681*                NEXT SENTENCE
 12682                 CONTINUE
 12683             END-IF
 12684         END-IF
 12685     ELSE
 12686         MOVE ER-0517         TO EMI-ERROR
 12687         MOVE -1              TO REPORTL
 12688         MOVE AL-UABON        TO REPORTA
 12689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12690     END-IF.
 12691
 12692     IF WS-REPORT NOT = LOW-VALUES
 12693         IF WS-INCUR GREATER THAN WS-REPORT
 12694             MOVE AL-UABON       TO REPORTA
 12695             MOVE -1             TO REPORTL
 12696             MOVE ER-0509        TO EMI-ERROR
 12697             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12698         END-IF
 12699     END-IF.
 12700
 12701     IF ESTENDL GREATER ZERO
 12702         MOVE ESTENDI            TO DATE-WORK
 12703         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12704         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12705         MOVE '4'                TO DC-OPTION-CODE
 12706         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12707         IF DATE-CONVERSION-ERROR
 12708             MOVE AL-UABON       TO ESTENDA
 12709             MOVE -1             TO ESTENDL
 12710             MOVE ER-0224        TO EMI-ERROR
 12711             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12712         ELSE
 12713             MOVE AL-UANON       TO ESTENDA
 12714             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12715             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12716             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 238
* EL130.cbl
 12717                MOVE AL-UABON    TO ESTENDA
 12718                MOVE -1          TO ESTENDL
 12719                MOVE ER-0544     TO EMI-ERROR
 12720                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12721             END-IF
 12722         END-IF
 12723     END-IF.
 12724
 12725     IF WS-ESTEND NOT = LOW-VALUES
 12726         IF WS-INCUR GREATER THAN WS-ESTEND
 12727             MOVE AL-UABON       TO ESTENDA
 12728             MOVE -1             TO ESTENDL
 12729             MOVE ER-0510        TO EMI-ERROR
 12730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12731         END-IF
 12732     END-IF.
 12733
 12734     IF PRTOPTL GREATER ZERO
 12735         IF PRTOPTI NOT = 'N' AND 'L'
 12736             MOVE AL-UABON       TO PRTOPTA
 12737             MOVE -1             TO PRTOPTL
 12738             MOVE ER-0334        TO EMI-ERROR
 12739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12740         END-IF
 12741     END-IF.
 12742
 12743     IF MANRSVL GREATER ZERO
 12744
 12745* EXEC CICS BIF DEEDIT
 12746*            FIELD   (MANRSVI)
 12747*            LENGTH  (9)
 12748*        END-EXEC
 12749     MOVE 9
 12750       TO DFHEIV11
 12751*    MOVE '@"L                   #   #00011604' TO DFHEIV0
 12752     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12753     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12754     MOVE X'2020233030303131363034' TO DFHEIV0(25:11)
 12755     CALL 'kxdfhei1' USING DFHEIV0,
 12756           MANRSVI,
 12757           DFHEIV11
 12758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12759         IF MANRSVI NOT NUMERIC
 12760             MOVE AL-UNBON       TO MANRSVA
 12761             MOVE -1             TO MANRSVL
 12762             MOVE ER-0489        TO EMI-ERROR
 12763             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12764         ELSE
 12765             MOVE AL-UNNON       TO MANRSVA
 12766             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 12767         END-IF
 12768     END-IF.
 12769
 12770     MOVE SPACES                 TO ELCNTL-KEY.
 12771
 12772     IF CONTROL-IS-ACTUAL-CARRIER
 12773         MOVE PI-CARRIER         TO CNTL-CARRIER
 12774     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 239
* EL130.cbl
 12775         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 12776     END-IF.
 12777
 12778     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12779     MOVE '6'                    TO CNTL-REC-TYPE.
 12780     MOVE +0                     TO CNTL-SEQ-NO.
 12781
 12782
 12783
 12784* EXEC CICS HANDLE CONDITION
 12785*        NOTFND   (3100-CARRIER-NOT-FOUND)
 12786*    END-EXEC.
 12787*    MOVE '"$I                   ! ? #00011632' TO DFHEIV0
 12788     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12790     MOVE X'3F20233030303131363332' TO DFHEIV0(25:11)
 12791     CALL 'kxdfhei1' USING DFHEIV0
 12792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12793
 12794
 12795     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12796
 12797     IF NOT CF-MANUAL-RESERVES-USED AND
 12798           WS-MANRSV GREATER ZERO
 12799         MOVE ER-0518             TO EMI-ERROR
 12800         MOVE -1                  TO MANRSVL
 12801         MOVE AL-UNBON            TO MANRSVA
 12802         MOVE ZEROS               TO WS-MANRSV
 12803         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12804     END-IF.
 12805
 12806     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 12807     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 12808
 12809     IF SUPVL GREATER ZERO
 12810         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 12811             MOVE -1             TO SUPVL
 12812             MOVE AL-UABON       TO SUPVA
 12813             MOVE ER-0230        TO EMI-ERROR
 12814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12815         ELSE
 12816             MOVE AL-UANON       TO SUPVA
 12817         END-IF
 12818     END-IF.
 12819
 12820     IF PROCCDL = ZERO
 12821        GO TO 6050-CONTINUE-EDITS
 12822     END-IF.
 12823
 12824     MOVE SPACES                 TO ELCNTL-KEY.
 12825     MOVE PROCCDI                TO CNTL-ACCESS.
 12826
 12827     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12828     MOVE '2'                    TO CNTL-REC-TYPE.
 12829     MOVE +0                     TO CNTL-SEQ-NO.
 12830
 12831
 12832
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 240
* EL130.cbl
 12833* EXEC CICS HANDLE CONDITION
 12834*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12835*    END-EXEC.
 12836*    MOVE '"$I                   ! @ #00011673' TO DFHEIV0
 12837     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12839     MOVE X'4020233030303131363733' TO DFHEIV0(25:11)
 12840     CALL 'kxdfhei1' USING DFHEIV0
 12841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12842
 12843
 12844     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12845
 12846     GO TO 6050-CONTINUE-EDITS.
 12847
 12848 6040-NO-PROCESSOR-RECORD.
 12849     MOVE ER-0019                TO EMI-ERROR.
 12850     MOVE -1                     TO PROCCDL.
 12851     MOVE AL-UABON               TO PROCCDA.
 12852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12853
 12854 6050-CONTINUE-EDITS.
 12855     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12856           GO TO 6070-CONTINUE-EDITS
 12857     END-IF.
 12858
 12859     MOVE BENECDI                TO BENE-CODE.
 12860     MOVE 'B'                    TO BENE-RCD-TYPE.
 12861     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12862
 12863
 12864
 12865* EXEC CICS HANDLE CONDITION
 12866*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12867*    END-EXEC.
 12868*    MOVE '"$I                   ! A #00011697' TO DFHEIV0
 12869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12871     MOVE X'4120233030303131363937' TO DFHEIV0(25:11)
 12872     CALL 'kxdfhei1' USING DFHEIV0
 12873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12874
 12875
 12876
 12877* EXEC CICS READ
 12878*         DATASET   (ELBENE-DSID)
 12879*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 12880*         RIDFLD    (ELBENE-KEY)
 12881*    END-EXEC.
 12882*    MOVE '&"S        E          (   #00011701' TO DFHEIV0
 12883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12885     MOVE X'2020233030303131373031' TO DFHEIV0(25:11)
 12886     CALL 'kxdfhei1' USING DFHEIV0,
 12887           ELBENE-DSID,
 12888           DFHEIV20,
 12889           DFHEIV99,
 12890           ELBENE-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 241
* EL130.cbl
 12891           DFHEIV99,
 12892           DFHEIV99,
 12893           DFHEIV99
 12894     SET ADDRESS OF BENEFICIARY-MASTER TO
 12895         DFHEIV20
 12896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12897
 12898
 12899     GO TO 6070-CONTINUE-EDITS.
 12900
 12901 6060-NO-BENEFICIARY-RECORD.
 12902     MOVE ER-0565                TO EMI-ERROR.
 12903     MOVE -1                     TO BENECDL.
 12904     MOVE AL-UABON               TO BENECDA.
 12905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12906
 12907
 12908 6070-CONTINUE-EDITS.
 12909     IF CERTMTL GREATER ZERO
 12910         IF CERTMTI NOT = 'A' AND 'S'
 12911             MOVE -1             TO CERTMTL
 12912             MOVE AL-UABON       TO CERTMTA
 12913             MOVE ER-0267        TO EMI-ERROR
 12914             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12915         ELSE
 12916             MOVE AL-UANON       TO CERTMTA
 12917         END-IF
 12918     ELSE
 12919         GO TO 6000-EXIT
 12920     END-IF.
 12921
 12922     IF EFFDTL GREATER ZERO
 12923         MOVE EFFDTI             TO DATE-WORK
 12924         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12925         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12926         MOVE '4'                TO DC-OPTION-CODE
 12927         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12928         IF DATE-CONVERSION-ERROR
 12929             MOVE AL-UABON       TO EFFDTA
 12930             MOVE -1             TO EFFDTL
 12931             MOVE ER-0231        TO EMI-ERROR
 12932             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933         ELSE
 12934             MOVE AL-UANON       TO EFFDTA
 12935             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12936             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12937         END-IF
 12938     ELSE
 12939         MOVE ER-0231            TO EMI-ERROR
 12940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12941         MOVE -1                 TO EFFDTL
 12942         MOVE AL-UABON           TO EFFDTA
 12943     END-IF.
 12944
 12945     IF ACCOUNTL = ZERO
 12946         MOVE ER-0232            TO EMI-ERROR
 12947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12948         MOVE AL-UABON           TO ACCOUNTA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 242
* EL130.cbl
 12949         MOVE -1                 TO ACCOUNTL
 12950     ELSE
 12951         MOVE AL-UANON           TO ACCOUNTA
 12952     END-IF.
 12953
 12954     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12955        (STATEL = ZERO)
 12956         MOVE ER-0233        TO EMI-ERROR
 12957         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12958         MOVE AL-UABON       TO STATEA
 12959         MOVE -1             TO STATEL
 12960     ELSE
 12961         MOVE AL-UANON       TO STATEA
 12962     END-IF.
 12963
 12964     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12965        (CRTCARRL = ZERO)
 12966         MOVE ER-0234        TO EMI-ERROR
 12967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12968         MOVE AL-UABON       TO CRTCARRA
 12969         MOVE -1             TO CRTCARRL
 12970     ELSE
 12971         MOVE AL-UANON       TO CRTCARRA
 12972     END-IF.
 12973
 12974     IF PI-CERT-ACCESS-CONTROL = '1' AND
 12975        GROUPL = ZERO
 12976         MOVE ER-0235            TO EMI-ERROR
 12977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12978         MOVE AL-UABON           TO GROUPA
 12979         MOVE -1                 TO GROUPL
 12980     ELSE
 12981         MOVE AL-UANON           TO GROUPA
 12982     END-IF.
 12983
 12984     IF CRTLNMEL = ZERO
 12985         IF LSTNMEI = SPACES OR LOW-VALUES
 12986             MOVE ER-0236            TO  EMI-ERROR
 12987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12988             MOVE AL-UABON           TO  CRTLNMEA
 12989             MOVE -1                 TO  CRTLNMEL
 12990         ELSE
 12991             MOVE LSTNMEI            TO  CRTLNMEI
 12992             MOVE AL-UANON           TO  CRTLNMEA
 12993         END-IF
 12994     ELSE
 12995         MOVE AL-UANON               TO  CRTLNMEA
 12996     END-IF.
 12997
 12998     IF CRTFNMEL = ZERO
 12999         IF FSTNMEI = SPACES OR LOW-VALUES
 13000*            NEXT SENTENCE
 13001             CONTINUE
 13002         ELSE
 13003             MOVE FSTNMEI            TO  CRTFNMEI
 13004             MOVE AL-UANON           TO  CRTFNMEA
 13005         END-IF
 13006     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 243
* EL130.cbl
 13007
 13008     IF CRTINITL = ZERO
 13009         IF INITI = SPACES OR LOW-VALUES
 13010*            NEXT SENTENCE
 13011             CONTINUE
 13012         ELSE
 13013             MOVE INITI              TO  CRTINITI
 13014             MOVE AL-UANON           TO  CRTINITA
 13015         END-IF
 13016     END-IF.
 13017
 13018 6000-EXIT.
 13019     EXIT.
 13020
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 244
* EL130.cbl
 13022 6200-EDIT-CERT-DATA.
 13023     IF ISSAGEL GREATER ZERO
 13024         IF ISSAGEI NOT NUMERIC
 13025             MOVE ER-0237        TO EMI-ERROR
 13026             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13027             MOVE -1             TO ISSAGEL
 13028             MOVE AL-UNBON       TO ISSAGEA
 13029         ELSE
 13030             MOVE AL-UNNON       TO ISSAGEA
 13031         END-IF
 13032     END-IF.
 13033
 13034     IF JNTAGEL GREATER ZERO
 13035         IF JNTAGEI NOT NUMERIC
 13036             MOVE ER-0238        TO EMI-ERROR
 13037             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13038             MOVE -1             TO JNTAGEL
 13039             MOVE AL-UNBON       TO JNTAGEA
 13040         ELSE
 13041             MOVE AL-UNNON       TO JNTAGEA
 13042         END-IF
 13043     END-IF.
 13044
 13045     IF LCVCDL GREATER ZERO
 13046         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13047         IF INVALID-BENEFIT-CODE
 13048             MOVE ER-7635        TO EMI-ERROR
 13049             MOVE -1             TO LCVCDL
 13050             MOVE AL-UABON       TO LCVCDA
 13051             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13052         ELSE
 13053             MOVE LCVCDI         TO WS-BEN-HOLD
 13054             MOVE '4'            TO WS-REC-TYPE
 13055             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13056             IF WS-BEN-ALPHA-HOLD = SPACES
 13057                MOVE ER-7635     TO EMI-ERROR
 13058                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13059                MOVE -1          TO LCVCDL
 13060                MOVE AL-UABON    TO LCVCDA
 13061             ELSE
 13062                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13063                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13064                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13065                MOVE AL-UANON           TO LCVCDA
 13066             END-IF
 13067         END-IF
 13068     END-IF.
 13069
 13070     IF ACVCDL GREATER ZERO
 13071         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13072         IF INVALID-BENEFIT-CODE
 13073             MOVE ER-7635        TO EMI-ERROR
 13074             MOVE -1             TO ACVCDL
 13075             MOVE AL-UABON       TO ACVCDA
 13076             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13077         ELSE
 13078             MOVE ACVCDI         TO WS-BEN-HOLD
 13079             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 245
* EL130.cbl
 13080             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13081             IF WS-BEN-ALPHA-HOLD = SPACES
 13082                MOVE ER-7635     TO EMI-ERROR
 13083                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13084                MOVE -1          TO ACVCDL
 13085                MOVE AL-UABON    TO ACVCDA
 13086             ELSE
 13087                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13088                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13089                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13090                MOVE AL-UANON           TO ACVCDA
 13091             END-IF
 13092         END-IF
 13093     END-IF.
 13094
 13095     IF LCVOTRML GREATER ZERO
 13096         IF LCVOTRMI NOT NUMERIC
 13097             MOVE ER-7636        TO EMI-ERROR
 13098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13099             MOVE -1             TO LCVOTRML
 13100             MOVE AL-UNBON       TO LCVOTRMA
 13101         ELSE
 13102             MOVE AL-UNNON       TO LCVOTRMA
 13103         END-IF
 13104     END-IF.
 13105
 13106     IF ACVOTRML GREATER ZERO
 13107         IF ACVOTRMI NOT NUMERIC
 13108             MOVE ER-7636        TO EMI-ERROR
 13109             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13110             MOVE -1             TO ACVOTRML
 13111             MOVE AL-UNBON       TO ACVOTRMA
 13112         ELSE
 13113             MOVE AL-UNNON       TO ACVOTRMA
 13114         END-IF
 13115     END-IF.
 13116
 13117     IF LCVRATEL GREATER ZERO
 13118
 13119* EXEC CICS BIF DEEDIT
 13120*            FIELD    (LCVRATEI)
 13121*            LENGTH   (06)
 13122*        END-EXEC
 13123     MOVE 06
 13124       TO DFHEIV11
 13125*    MOVE '@"L                   #   #00011926' TO DFHEIV0
 13126     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13127     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13128     MOVE X'2020233030303131393236' TO DFHEIV0(25:11)
 13129     CALL 'kxdfhei1' USING DFHEIV0,
 13130           LCVRATEI,
 13131           DFHEIV11
 13132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13133         IF LCVRATEI NOT NUMERIC
 13134             MOVE AL-UNBON       TO LCVRATEA
 13135             MOVE -1             TO LCVRATEL
 13136             MOVE ER-2280        TO EMI-ERROR
 13137             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 246
* EL130.cbl
 13138         ELSE
 13139             MOVE AL-UNNON       TO LCVRATEA
 13140             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13141         END-IF
 13142     END-IF.
 13143
 13144     IF ACVRATEL GREATER ZERO
 13145
 13146* EXEC CICS BIF DEEDIT
 13147*            FIELD    (ACVRATEI)
 13148*            LENGTH   (06)
 13149*        END-EXEC
 13150     MOVE 06
 13151       TO DFHEIV11
 13152*    MOVE '@"L                   #   #00011942' TO DFHEIV0
 13153     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13155     MOVE X'2020233030303131393432' TO DFHEIV0(25:11)
 13156     CALL 'kxdfhei1' USING DFHEIV0,
 13157           ACVRATEI,
 13158           DFHEIV11
 13159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13160         IF ACVRATEI NOT NUMERIC
 13161             MOVE AL-UNBON       TO ACVRATEA
 13162             MOVE -1             TO ACVRATEL
 13163             MOVE ER-2280        TO EMI-ERROR
 13164             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165         ELSE
 13166             MOVE AL-UNNON       TO ACVRATEA
 13167             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13168         END-IF
 13169     END-IF.
 13170
 13171     IF LCVBENEL GREATER ZERO
 13172
 13173* EXEC CICS BIF DEEDIT
 13174*            FIELD    (LCVBENEI)
 13175*            LENGTH   (11)
 13176*        END-EXEC
 13177     MOVE 11
 13178       TO DFHEIV11
 13179*    MOVE '@"L                   #   #00011958' TO DFHEIV0
 13180     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13181     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13182     MOVE X'2020233030303131393538' TO DFHEIV0(25:11)
 13183     CALL 'kxdfhei1' USING DFHEIV0,
 13184           LCVBENEI,
 13185           DFHEIV11
 13186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13187         IF LCVBENEI NOT NUMERIC
 13188             MOVE AL-UNBON       TO LCVBENEA
 13189             MOVE -1             TO LCVBENEL
 13190             MOVE ER-7637        TO EMI-ERROR
 13191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13192         ELSE
 13193             MOVE AL-UNNON       TO LCVBENEA
 13194             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13195         END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 247
* EL130.cbl
 13196     END-IF.
 13197
 13198     IF ACVBENEL GREATER ZERO
 13199
 13200* EXEC CICS BIF DEEDIT
 13201*            FIELD    (ACVBENEI)
 13202*            LENGTH   (11)
 13203*        END-EXEC
 13204     MOVE 11
 13205       TO DFHEIV11
 13206*    MOVE '@"L                   #   #00011974' TO DFHEIV0
 13207     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13208     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13209     MOVE X'2020233030303131393734' TO DFHEIV0(25:11)
 13210     CALL 'kxdfhei1' USING DFHEIV0,
 13211           ACVBENEI,
 13212           DFHEIV11
 13213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13214         IF ACVBENEI NOT NUMERIC
 13215             MOVE AL-UNBON       TO ACVBENEA
 13216             MOVE -1             TO ACVBENEL
 13217             MOVE ER-7637        TO EMI-ERROR
 13218             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13219         ELSE
 13220             MOVE AL-UNNON       TO ACVBENEA
 13221             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13222         END-IF
 13223     END-IF.
 13224
 13225     IF LCVCNDTL GREATER ZERO
 13226         IF LCVCNDTI NOT = SPACES
 13227             MOVE LCVCNDTI        TO DATE-WORK
 13228             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13229             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13230             MOVE '4'             TO DC-OPTION-CODE
 13231             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13232             IF DATE-CONVERSION-ERROR
 13233                 MOVE AL-UABON    TO LCVCNDTA
 13234                 MOVE -1          TO LCVCNDTL
 13235                 MOVE ER-7638     TO EMI-ERROR
 13236                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13237             ELSE
 13238                 MOVE AL-UANON    TO LCVCNDTA
 13239                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13240                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13241             END-IF
 13242         END-IF
 13243     END-IF.
 13244
 13245     IF ACVCNDTL GREATER ZERO
 13246         IF ACVCNDTI NOT = SPACES
 13247             MOVE ACVCNDTI        TO DATE-WORK
 13248             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13249             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13250             MOVE '4'             TO DC-OPTION-CODE
 13251             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13252             IF DATE-CONVERSION-ERROR
 13253                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 248
* EL130.cbl
 13254                 MOVE -1          TO ACVCNDTL
 13255                 MOVE ER-7638     TO EMI-ERROR
 13256                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13257             ELSE
 13258                 MOVE AL-UANON    TO ACVCNDTA
 13259                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13260                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13261             END-IF
 13262         END-IF
 13263     END-IF.
 13264
 13265     IF ADDONDTL GREATER ZERO
 13266         MOVE ADDONDTI        TO DATE-WORK
 13267         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13268         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13269         MOVE '4'             TO DC-OPTION-CODE
 13270         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13271         IF DATE-CONVERSION-ERROR
 13272             MOVE AL-UABON    TO ADDONDTA
 13273             MOVE -1          TO ADDONDTL
 13274             MOVE ER-7651     TO EMI-ERROR
 13275             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13276         ELSE
 13277             MOVE AL-UANON    TO ADDONDTA
 13278             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13279             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13280         END-IF
 13281     END-IF.
 13282
 13283     IF APRL GREATER ZERO
 13284
 13285* EXEC CICS BIF DEEDIT
 13286*            FIELD    (APRI)
 13287*            LENGTH   (8)
 13288*        END-EXEC
 13289     MOVE 8
 13290       TO DFHEIV11
 13291*    MOVE '@"L                   #   #00012048' TO DFHEIV0
 13292     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13293     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13294     MOVE X'2020233030303132303438' TO DFHEIV0(25:11)
 13295     CALL 'kxdfhei1' USING DFHEIV0,
 13296           APRI,
 13297           DFHEIV11
 13298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13299         IF APRI NOT NUMERIC
 13300             MOVE AL-UNBON       TO APRA
 13301             MOVE -1             TO APRL
 13302             MOVE ER-0248        TO EMI-ERROR
 13303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13304         ELSE
 13305             MOVE AL-UNNON       TO APRA
 13306             MOVE APRI           TO WS-APR APRO
 13307         END-IF
 13308     END-IF.
 13309
 13310     IF PMTFREQL GREATER ZERO
 13311
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 249
* EL130.cbl
 13312* EXEC CICS BIF DEEDIT
 13313*            FIELD   (PMTFREQI)
 13314*            LENGTH  (2)
 13315*        END-EXEC
 13316     MOVE 2
 13317       TO DFHEIV11
 13318*    MOVE '@"L                   #   #00012064' TO DFHEIV0
 13319     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13321     MOVE X'2020233030303132303634' TO DFHEIV0(25:11)
 13322     CALL 'kxdfhei1' USING DFHEIV0,
 13323           PMTFREQI,
 13324           DFHEIV11
 13325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13326         IF PMTFREQI NOT NUMERIC
 13327             MOVE -1             TO PMTFREQL
 13328             MOVE AL-UNBON       TO PMTFREQA
 13329             MOVE ER-0258        TO EMI-ERROR
 13330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13331         ELSE
 13332             MOVE AL-UNNON       TO PMTFREQA
 13333             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13334         END-IF
 13335     END-IF.
 13336
 13337     IF INDGRPL GREATER ZERO
 13338         IF INDGRPI = 'I' OR 'G'
 13339             MOVE AL-UANON       TO INDGRPA
 13340         ELSE
 13341             MOVE -1 TO INDGRPL
 13342             MOVE AL-UABON       TO INDGRPA
 13343             MOVE ER-0260        TO EMI-ERROR
 13344             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13345         END-IF
 13346     END-IF.
 13347
 13348     IF LOANBALL GREATER ZERO
 13349         MOVE LOANBALI           TO DEEDIT-FIELD
 13350
 13351* EXEC CICS BIF DEEDIT
 13352*            FIELD   (DEEDIT-FIELD)
 13353*            LENGTH  (12)
 13354*        END-EXEC
 13355     MOVE 12
 13356       TO DFHEIV11
 13357*    MOVE '@"L                   #   #00012092' TO DFHEIV0
 13358     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13359     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13360     MOVE X'2020233030303132303932' TO DFHEIV0(25:11)
 13361     CALL 'kxdfhei1' USING DFHEIV0,
 13362           DEEDIT-FIELD,
 13363           DFHEIV11
 13364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13365         IF DEEDIT-FIELD NOT NUMERIC
 13366             MOVE AL-UNBON       TO LOANBALA
 13367             MOVE -1             TO LOANBALL
 13368             MOVE ER-0247        TO EMI-ERROR
 13369             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 250
* EL130.cbl
 13370         ELSE
 13371             MOVE AL-UNNON       TO LOANBALA
 13372             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13373         END-IF
 13374     END-IF.
 13375
 13376     IF PREMTYPL GREATER ZERO
 13377         IF (PREMTYPI = '1' OR '2' OR '3')
 13378             MOVE AL-UANON       TO PREMTYPA
 13379         ELSE
 13380             MOVE -1             TO PREMTYPL
 13381             MOVE AL-UABON       TO PREMTYPA
 13382             MOVE ER-0227        TO EMI-ERROR
 13383             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13384         END-IF
 13385     END-IF.
 13386
 13387     IF REINCDL GREATER ZERO
 13388         MOVE LOW-VALUES         TO  ERREIN-KEY
 13389         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13390         MOVE REINCDI            TO  REIN-CODE-1
 13391                                     REIN-CODE-2
 13392                                     REIN-CODE-3
 13393         MOVE 'A'                TO  REIN-TYPE
 13394         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13395         IF REIN-REC-NOT-FOUND
 13396             MOVE ER-0266        TO  EMI-ERROR
 13397             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13398             MOVE -1             TO  REINCDL
 13399             MOVE AL-UABON       TO  REINCDA
 13400         ELSE
 13401             MOVE AL-UANON       TO  REINCDA
 13402         END-IF
 13403     END-IF.
 13404
 13405     IF CERTMTI NOT = 'A'
 13406        GO TO 6200-EXIT
 13407     END-IF.
 13408
 13409     IF PREMTYPI = '1'
 13410         IF LCVCDL GREATER ZERO
 13411             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13412                 MOVE ER-0841        TO  EMI-ERROR
 13413                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13414                 MOVE -1             TO  PREMTYPL
 13415                 MOVE AL-UABON       TO  PREMTYPA
 13416             END-IF
 13417         END-IF
 13418     END-IF.
 13419
 13420     IF PREMTYPI = '1'
 13421         IF ACVCDL GREATER ZERO
 13422             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13423                 MOVE ER-0841        TO  EMI-ERROR
 13424                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13425                 MOVE -1             TO  PREMTYPL
 13426                 MOVE AL-UABON       TO  PREMTYPA
 13427             END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 251
* EL130.cbl
 13428         END-IF
 13429     END-IF.
 13430
 13431     IF PREMTYPI = '2'
 13432         IF LCVCDL GREATER ZERO
 13433             IF (PI-COMPANY-ID = 'HAN') AND
 13434                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13435                        OR
 13436                 WS-LF-SPECIAL-CALC-CD = 'O'
 13437*                NEXT SENTENCE
 13438                 CONTINUE
 13439             ELSE
 13440                 MOVE ER-0840        TO  EMI-ERROR
 13441                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13442                 MOVE -1             TO  PREMTYPL
 13443                 MOVE AL-UABON       TO  PREMTYPA
 13444             END-IF
 13445         END-IF
 13446     END-IF.
 13447
 13448     IF PREMTYPI = '2'
 13449         IF ACVCDL GREATER ZERO
 13450             IF (PI-COMPANY-ID = 'HAN')  AND
 13451                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13452                        OR
 13453                 WS-AH-SPECIAL-CALC-CD = 'O'
 13454*                NEXT SENTENCE
 13455                 CONTINUE
 13456             ELSE
 13457                 MOVE ER-0840        TO  EMI-ERROR
 13458                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13459                 MOVE -1             TO  PREMTYPL
 13460                 MOVE AL-UABON       TO  PREMTYPA
 13461             END-IF
 13462         END-IF
 13463     END-IF.
 13464
 13465     IF LCVCDL = ZEROS
 13466        GO TO 6200-EXIT
 13467     END-IF.
 13468
 13469     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13470         IF PMTFREQI NOT = ZEROS
 13471             MOVE ER-0428        TO EMI-ERROR
 13472             MOVE -1             TO PMTFREQL
 13473             MOVE AL-UNBON       TO PMTFREQA
 13474             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13475             GO TO 6200-CHECK-APR
 13476         END-IF
 13477     END-IF.
 13478
 13479     IF PMTFREQL = ZEROS AND TEX-REG
 13480         MOVE ER-0429            TO EMI-ERROR
 13481         MOVE -1                 TO PMTFREQL
 13482         MOVE AL-UNBON           TO PMTFREQA
 13483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13484         GO TO 6200-CHECK-APR
 13485     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 252
* EL130.cbl
 13486
 13487     IF LCVOTRMI NOT NUMERIC
 13488         GO TO 6200-CHECK-APR
 13489     END-IF.
 13490
 13491     IF WS-PMTFREQ NOT = ZERO
 13492         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13493         GIVING DIVIDE-QUOT
 13494         REMAINDER DIVIDE-REM
 13495         IF DIVIDE-REM GREATER ZERO
 13496             MOVE ER-0430            TO EMI-ERROR
 13497             MOVE -1                 TO PMTFREQL
 13498             MOVE AL-UNBON           TO PMTFREQA
 13499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13500         END-IF
 13501     END-IF.
 13502
 13503 6200-CHECK-APR.
 13504     IF NET-PAY AND APRL = ZEROS
 13505        MOVE ER-0257             TO EMI-ERROR
 13506        MOVE -1                  TO APRL
 13507        MOVE AL-UABON            TO APRA
 13508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13509     END-IF.
 13510
 13511 6200-EXIT.
 13512     EXIT.
 13513
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 253
* EL130.cbl
 13515 6300-REQUIRED-CERT-EDIT.
 13516
 13517     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13518        GO TO 6300-REQUIRED-AH-EDIT
 13519     END-IF
 13520
 13521     IF LCVCDL = ZERO
 13522        MOVE ER-7639             TO EMI-ERROR
 13523        MOVE -1                  TO LCVCDL
 13524        MOVE AL-UABON            TO LCVCDA
 13525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13526     END-IF.
 13527
 13528     IF LCVOTRML = ZERO
 13529        MOVE ER-7670             TO EMI-ERROR
 13530        MOVE -1                  TO LCVOTRML
 13531        MOVE AL-UNBON            TO LCVOTRMA
 13532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13533     END-IF.
 13534
 13535     IF LCVBENEL = ZERO
 13536        MOVE ER-7671             TO EMI-ERROR
 13537        MOVE -1                  TO LCVBENEL
 13538        MOVE AL-UNBON            TO LCVBENEA
 13539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13540     END-IF.
 13541
 13542     GO TO 6399-EXIT.
 13543
 13544 6300-REQUIRED-AH-EDIT.
 13545
 13546     IF ACVCDL = ZERO
 13547        MOVE ER-7639             TO EMI-ERROR
 13548        MOVE -1                  TO ACVCDL
 13549        MOVE AL-UABON            TO ACVCDA
 13550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13551     END-IF.
 13552
 13553     IF ACVOTRML = ZERO
 13554         MOVE ER-7670             TO EMI-ERROR
 13555         MOVE -1                  TO ACVOTRML
 13556         MOVE AL-UNBON            TO ACVOTRMA
 13557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13558     END-IF.
 13559
 13560     IF ACVBENEL = ZERO
 13561        MOVE ER-7671             TO EMI-ERROR
 13562        MOVE -1                  TO ACVBENEL
 13563        MOVE AL-UNBON            TO ACVBENEA
 13564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13565     END-IF.
 13566
 13567 6399-EXIT.
 13568      EXIT.
 13569
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 254
* EL130.cbl
 13571 6400-TEST-CLAIM-REASONABILITY.
 13572
 13573     IF WS-INCUR = LOW-VALUES
 13574        GO TO 6499-EXIT
 13575     END-IF.
 13576
 13577     IF WS-EFFDT NOT = LOW-VALUES
 13578         IF WS-INCUR LESS WS-EFFDT
 13579             MOVE ER-0458          TO EMI-ERROR
 13580             MOVE -1               TO INCURL
 13581             MOVE AL-UABON         TO INCURA
 13582             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13583         END-IF
 13584     END-IF.
 13585
 13586     IF CERTMTI = 'A'
 13587        GO TO 6460-TEST-NEW-CERT
 13588     END-IF.
 13589
 13590     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 13591     MOVE CRTCARRI               TO CERT-CARRIER.
 13592     MOVE GROUPI                 TO CERT-GROUPING.
 13593     MOVE STATEI                 TO CERT-STATE.
 13594     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 13595     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 13596     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 13597
 13598
 13599
 13600* EXEC CICS HANDLE CONDITION
 13601*         DUPKEY   (6499-EXIT)
 13602*         NOTFND   (6499-EXIT)
 13603*    END-EXEC.
 13604*    MOVE '"$$I                  ! B #00012330' TO DFHEIV0
 13605     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 13606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13607     MOVE X'4220233030303132333330' TO DFHEIV0(25:11)
 13608     CALL 'kxdfhei1' USING DFHEIV0
 13609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13610
 13611
 13612     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 13613
 13614     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 13615        'I' OR 'G')
 13616        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13617     ELSE
 13618        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13619     END-IF.
 13620
 13621     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13622     MOVE '6'                    TO DC-OPTION-CODE.
 13623     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13624
 13625     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 13626        MOVE ER-0519             TO EMI-ERROR
 13627        MOVE -1                  TO INCURL
 13628        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 255
* EL130.cbl
 13629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13630     END-IF.
 13631
 13632     IF CLMCARRI NOT = CRTCARRI
 13633        MOVE ER-0562             TO EMI-ERROR
 13634        MOVE AL-UABON            TO CLMCARRA
 13635        MOVE -1                  TO CLMCARRL
 13636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13637     END-IF.
 13638
 13639     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13640        CM-AH-BENEFIT-CD = '00')
 13641                  OR
 13642        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13643        CM-LF-BENEFIT-CD = '00')
 13644         MOVE ER-0521         TO EMI-ERROR
 13645         MOVE AL-UABON        TO CLMTYPEA
 13646         MOVE -1              TO CLMTYPEL
 13647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13648     END-IF.
 13649*    IF CLMTYPEI = 'I' AND
 13650*       CM-AH-CRITICAL-PERIOD = +0
 13651*        MOVE ER-0521         TO EMI-ERROR
 13652*        MOVE AL-UABON        TO CLMTYPEA
 13653*        MOVE -1              TO CLMTYPEL
 13654*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13655*    END-IF
 13656
 13657*    IF PI-COMPANY-ID = 'CRI'
 13658*        IF MAINTI = 'A'
 13659*            IF CERT-PEND-ISSUE-ERROR  OR
 13660*               CERT-PEND-ISSUE-RETURNED
 13661*                MOVE -1                 TO CERTNOL
 13662*                MOVE AL-UABON           TO CERTNOA
 13663*                MOVE ER-7640            TO EMI-ERROR
 13664*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13665*            END-IF
 13666*        END-IF
 13667*    END-IF.
 13668
 13669     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 13670         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13671         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 13672             GO TO 6450-DATE-ERROR
 13673         END-IF
 13674     END-IF.
 13675
 13676     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 13677         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 13678         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 13679             GO TO 6450-DATE-ERROR
 13680         END-IF
 13681     END-IF.
 13682
 13683     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13684         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 13685             GO TO 6450-DATE-ERROR
 13686         END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 256
* EL130.cbl
 13687     END-IF.
 13688
 13689     GO TO 6499-EXIT.
 13690
 13691 6450-DATE-ERROR.
 13692     MOVE ER-0520                TO EMI-ERROR.
 13693     MOVE -1                     TO INCURL.
 13694     MOVE AL-UABON               TO INCURA.
 13695     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13696
 13697*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 13698*       (EMI-SEVERITY-SAVE = 'X')
 13699*        ADD 1                TO EMI-FORCABLE-CTR
 13700*        SUBTRACT 1 FROM EMI-FATAL-CTR
 13701*    END-IF.
 13702
 13703     GO TO 6499-EXIT.
 13704
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 257
* EL130.cbl
 13706 6460-TEST-NEW-CERT.
 13707
 13708     IF NOT EMI-NO-ERRORS
 13709        GO TO 6499-EXIT
 13710     END-IF.
 13711
 13712     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13713
 13714     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13715         ACVOTRML GREATER ZERO)
 13716        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13717     END-IF.
 13718
 13719     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13720         LCVOTRML GREATER ZERO
 13721        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13722     END-IF.
 13723
 13724     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 13725
 13726*    IF PI-COMPANY-ID = 'HAN'
 13727*        IF ADDONDTL GREATER ZERO
 13728*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 13729*            IF CLMTYPEI = 'A'
 13730*                IF ACVOTRMI NOT = ZEROS
 13731*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 13732*                ELSE
 13733*                    NEXT SENTENCE
 13734*                    CONTINUE
 13735*                END-IF
 13736*            ELSE
 13737*                IF LCVOTRMI NOT = ZEROS
 13738*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 13739*                END-IF
 13740*            END-IF
 13741*        END-IF
 13742*    END-IF.
 13743
 13744     MOVE '6'                    TO DC-OPTION-CODE.
 13745     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13746
 13747     IF NO-CONVERSION-ERROR
 13748         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 13749     END-IF.
 13750
 13751     IF WS-INCUR GREATER THAN WS-EXPIRE
 13752        MOVE ER-0519             TO EMI-ERROR
 13753        MOVE -1                  TO INCURL
 13754        MOVE AL-UABON            TO INCURA
 13755        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13756     END-IF.
 13757
 13758     IF CLMCARRI NOT = CRTCARRI
 13759        MOVE ER-0562             TO EMI-ERROR
 13760        MOVE AL-UABON            TO CLMCARRA
 13761        MOVE -1                  TO CLMCARRL
 13762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13763     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 258
* EL130.cbl
 13764
 13765     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13766         ACVCDL = ZEROS)
 13767             MOVE ER-0521        TO EMI-ERROR
 13768             MOVE AL-UABON       TO CLMTYPEA
 13769             MOVE -1             TO CLMTYPEL
 13770             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13771     END-IF.
 13772
 13773     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13774         LCVCDL = ZEROS
 13775             MOVE ER-0521        TO EMI-ERROR
 13776             MOVE AL-UABON       TO CLMTYPEA
 13777             MOVE -1             TO CLMTYPEL
 13778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13779     END-IF.
 13780
 13781     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13782         IF LCVCNDTL GREATER ZERO
 13783             IF WS-INCUR GREATER THAN WS-LCVCNDT
 13784                 GO TO 6450-DATE-ERROR
 13785             END-IF
 13786         END-IF
 13787     END-IF.
 13788
 13789     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13790         IF ACVCNDTL GREATER ZERO
 13791             IF WS-INCUR GREATER THAN WS-ACVCNDT
 13792                 GO TO 6450-DATE-ERROR
 13793             END-IF
 13794         END-IF
 13795     END-IF.
 13796
 13797 6499-EXIT.
 13798     EXIT.
 13799 6500-get-acct.
 13800
 13801     MOVE SPACES                 TO ERACCT-KEY
 13802                                    ws-dcc-product-code
 13803
 13804     IF CARR-GROUP-ST-ACCNT-CNTL
 13805        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 13806        MOVE CRTCARRI            TO ACCT-CARRIER
 13807        MOVE GROUPI              TO ACCT-GROUPING
 13808        MOVE STATEI              TO ACCT-STATE
 13809        MOVE ACCOUNTI            TO ACCT-ACCOUNT
 13810        GO TO 6500-startbr
 13811     END-IF
 13812
 13813     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 13814     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 13815
 13816     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 13817        MOVE STATEI             TO ACCT-STATE
 13818     END-IF
 13819
 13820     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 13821        MOVE CRTCARRI           TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 259
* EL130.cbl
 13822     END-IF
 13823
 13824     .
 13825 6500-startbr.
 13826
 13827     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 13828
 13829
 13830* EXEC CICS STARTBR
 13831*       DATASET     (ERACCT2-DSID)
 13832*       RIDFLD      (SAVE-ERACCT-KEY)
 13833*       GENERIC
 13834*       KEYLENGTH   (20)
 13835*       resp        (ws-response)
 13836*    END-EXEC
 13837     MOVE 20
 13838       TO DFHEIV11
 13839     MOVE 0
 13840       TO DFHEIV12
 13841*    MOVE '&,   KG    G          &  N#00012552' TO DFHEIV0
 13842     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13843     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13844     MOVE X'204E233030303132353532' TO DFHEIV0(25:11)
 13845     CALL 'kxdfhei1' USING DFHEIV0,
 13846           ERACCT2-DSID,
 13847           SAVE-ERACCT-KEY,
 13848           DFHEIV11,
 13849           DFHEIV12,
 13850           DFHEIV99
 13851     MOVE EIBRESP  TO ws-response
 13852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13853
 13854     if not ws-resp-normal
 13855        go to 6500-exit
 13856     end-if
 13857
 13858     .
 13859 6500-readnext.
 13860
 13861
 13862* EXEC CICS READNEXT
 13863*       DATASET   (ERACCT2-DSID)
 13864*       SET       (ADDRESS OF ACCOUNT-MASTER)
 13865*       RIDFLD    (SAVE-ERACCT-KEY)
 13866*    END-EXEC
 13867     MOVE 0
 13868       TO DFHEIV11
 13869*    MOVE '&.S                   )   #00012567' TO DFHEIV0
 13870     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13872     MOVE X'2020233030303132353637' TO DFHEIV0(25:11)
 13873     CALL 'kxdfhei1' USING DFHEIV0,
 13874           ERACCT2-DSID,
 13875           DFHEIV20,
 13876           DFHEIV99,
 13877           SAVE-ERACCT-KEY,
 13878           DFHEIV99,
 13879           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 260
* EL130.cbl
 13880           DFHEIV99,
 13881           DFHEIV99
 13882     SET ADDRESS OF ACCOUNT-MASTER TO
 13883         DFHEIV20
 13884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13885
 13886     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 13887        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 13888        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 13889        or (ACCT-STATE    NOT = AM-VG-STATE   )
 13890        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 13891        go to 6500-endbr
 13892     END-IF
 13893
 13894     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 13895        and (WS-EFFDT < AM-EXPIRATION-DT)
 13896        MOVE AM-dcc-product-code to ws-dcc-product-code
 13897        GO TO 6500-endbr
 13898     END-IF
 13899
 13900     IF WS-EFFDT >= AM-EXPIRATION-DT
 13901         GO TO 6500-readnext
 13902     END-IF
 13903
 13904     .
 13905 6500-endbr.
 13906
 13907
 13908* EXEC CICS ENDBR
 13909*        DATASET    (ERACCT2-DSID)
 13910*    END-EXEC
 13911     MOVE 0
 13912       TO DFHEIV11
 13913*    MOVE '&2                    $   #00012594' TO DFHEIV0
 13914     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13915     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13916     MOVE X'2020233030303132353934' TO DFHEIV0(25:11)
 13917     CALL 'kxdfhei1' USING DFHEIV0,
 13918           ERACCT2-DSID,
 13919           DFHEIV11,
 13920           DFHEIV99
 13921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13922
 13923     .
 13924 6500-exit.
 13925     exit.
 13926 6600-CHECK-AUTO-ACTIVITY.
 13927
 13928
 13929* EXEC CICS HANDLE CONDITION
 13930*        NOTFND   (6600-NOT-FOUND)
 13931*    END-EXEC.
 13932*    MOVE '"$I                   ! C #00012603' TO DFHEIV0
 13933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13935     MOVE X'4320233030303132363033' TO DFHEIV0(25:11)
 13936     CALL 'kxdfhei1' USING DFHEIV0
 13937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 261
* EL130.cbl
 13938
 13939
 13940     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 13941     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13942     MOVE SPACES                     TO  CNTL-ACCESS.
 13943     MOVE +0                         TO  CNTL-SEQ-NO.
 13944
 13945     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13946
 13947     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 13948         MOVE 'N'                    TO  WS-REC-FOUND-SW
 13949                                         WS-LETTER-SW
 13950         GO TO 6600-EXIT
 13951     END-IF.
 13952
 13953     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 13954         MOVE 'N'                     TO  WS-LETTER-SW
 13955     ELSE
 13956         MOVE 'Y'                     TO  WS-LETTER-SW
 13957     END-IF.
 13958
 13959     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 13960     GO TO 6600-EXIT.
 13961
 13962 6600-START-AUTO-LETTER-WRITER.
 13963
 13964     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 13965     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 13966
 13967     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 13968
 13969     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 13970         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13971         MOVE '6'                     TO  DC-OPTION-CODE
 13972         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 13973         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13974         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13975         IF NO-CONVERSION-ERROR
 13976             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 13977         ELSE
 13978             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 13979         END-IF
 13980     END-IF.
 13981
 13982     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 13983         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13984         MOVE '6'                     TO  DC-OPTION-CODE
 13985         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 13986         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13987         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13988         IF NO-CONVERSION-ERROR
 13989             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 13990         ELSE
 13991             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 13992         END-IF
 13993     END-IF.
 13994
 13995
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 262
* EL130.cbl
 13996
 13997* EXEC CICS LINK
 13998*        PROGRAM    (LINK-1523)
 13999*        COMMAREA   (W-1523-LINKDATA)
 14000*        LENGTH     (W-1523-COMM-LENGTH)
 14001*    END-EXEC.
 14002*    MOVE '."C                   (   #00012663' TO DFHEIV0
 14003     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14005     MOVE X'2020233030303132363633' TO DFHEIV0(25:11)
 14006     CALL 'kxdfhei1' USING DFHEIV0,
 14007           LINK-1523,
 14008           W-1523-LINKDATA,
 14009           W-1523-COMM-LENGTH,
 14010           DFHEIV99,
 14011           DFHEIV99,
 14012           DFHEIV99,
 14013           DFHEIV99
 14014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14015
 14016
 14017     GO TO 6600-EXIT.
 14018
 14019 6600-NOT-FOUND.
 14020     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14021
 14022 6600-EXIT.
 14023     EXIT.
 14024
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 263
* EL130.cbl
 14025/
 14026*************************************************************
 14027*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14028*************************************************************
 14029
 14030 6700-OUTPUT-ACTIVITY-RECORD.
 14031
 14032
 14033
 14034* EXEC CICS GETMAIN
 14035*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14036*        LENGTH (DLYACTV-LENGTH)
 14037*        INITIMG (WS-BLANK)
 14038*    END-EXEC.
 14039*    MOVE ',"IL                  $   #00012685' TO DFHEIV0
 14040     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14041     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14042     MOVE X'2020233030303132363835' TO DFHEIV0(25:11)
 14043     CALL 'kxdfhei1' USING DFHEIV0,
 14044           DFHEIV20,
 14045           DLYACTV-LENGTH,
 14046           WS-BLANK
 14047     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14048         DFHEIV20
 14049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14050
 14051
 14052     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14053     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14054     MOVE CLMCARRI               TO DA-CARRIER.
 14055     IF CLMNOL EQUAL ZERO
 14056         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14057     ELSE
 14058         MOVE CLMNOI             TO DA-CLAIM-NO
 14059     END-IF.
 14060     MOVE CERTNOI                TO DA-CERT-PRIME.
 14061     MOVE SUFXI                  TO DA-CERT-SFX.
 14062     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14063     MOVE 'A'                    TO DA-RECORD-TYPE.
 14064
 14065
 14066* EXEC CICS HANDLE CONDITION
 14067*        NOTOPEN (6700-NOTOPEN-ERROR)
 14068*        DUPREC (6700-EXIT)
 14069*    END-EXEC.
 14070*    MOVE '"$J%                  ! D #00012704' TO DFHEIV0
 14071     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14073     MOVE X'4420233030303132373034' TO DFHEIV0(25:11)
 14074     CALL 'kxdfhei1' USING DFHEIV0
 14075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14076
 14077
 14078
 14079* EXEC CICS WRITE
 14080*        DATASET (DLYACTV-DSID)
 14081*        RIDFLD (DA-KEY)
 14082*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 264
* EL130.cbl
 14083*        LENGTH (DLYACTV-LENGTH)
 14084*    END-EXEC.
 14085*    MOVE '&$ L                  ''   #00012709' TO DFHEIV0
 14086     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14087     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14088     MOVE X'2020233030303132373039' TO DFHEIV0(25:11)
 14089     CALL 'kxdfhei1' USING DFHEIV0,
 14090           DLYACTV-DSID,
 14091           DAILY-ACTIVITY-RECORD,
 14092           DLYACTV-LENGTH,
 14093           DA-KEY,
 14094           DFHEIV99,
 14095           DFHEIV99
 14096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14097
 14098     GO TO 6700-EXIT.
 14099
 14100 6700-NOTOPEN-ERROR.
 14101     MOVE '2955'                 TO EMI-ERROR.
 14102     MOVE -1                     TO MAINTL.
 14103     MOVE AL-UANON               TO MAINTA.
 14104     PERFORM 9900-ERROR-FORMAT THRU
 14105             9900-EXIT.
 14106     GO TO 8200-SEND-DATAONLY.
 14107
 14108 6700-EXIT.
 14109     EXIT.
 14110
 14111*************************************************************
 14112*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14113*************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 265
* EL130.cbl
 14114/
 14115 6990-DEEDIT-DATE.
 14116
 14117
 14118* EXEC CICS BIF DEEDIT
 14119*        FIELD   (DATE-WORK)
 14120*        LENGTH  (8)
 14121*    END-EXEC.
 14122     MOVE 8
 14123       TO DFHEIV11
 14124*    MOVE '@"L                   #   #00012734' TO DFHEIV0
 14125     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14126     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14127     MOVE X'2020233030303132373334' TO DFHEIV0(25:11)
 14128     CALL 'kxdfhei1' USING DFHEIV0,
 14129           DATE-WORK,
 14130           DFHEIV11
 14131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14132
 14133 6990-EXIT.
 14134     EXIT.
 14135
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 266
* EL130.cbl
 14137 7000-BUILD-OUTPUT-MAP.
 14138
 14139     IF CLAIM-SWITCH = 'N'
 14140         GO TO 7050-BUILD-MAP-CERT-DATA
 14141     END-IF.
 14142
 14143     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14144         MOVE SPACES                 TO SEQUO
 14145         MOVE AL-SABOF               TO SEQUA
 14146     ELSE
 14147         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14148         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14149         MOVE WS-CLAIM-SEQU          TO SEQUO
 14150         MOVE AL-SABON               TO SEQUA
 14151     END-IF.
 14152
 14153     MOVE CL-CARRIER             TO CLMCARRO.
 14154     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14155     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14156     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14157     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14158     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14159     MOVE CL-INSURED-MID-INIT    TO INITO.
 14160     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14161     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14162
 14163     MOVE AL-UANON               TO CLMCARRA
 14164                                    CLMTYPEA
 14165                                    PCERTNOA
 14166                                    PSUFXA
 14167                                    LSTNMEA
 14168                                    FSTNMEA
 14169                                    INITA
 14170                                    SEXA
 14171                                    OCCCDA.
 14172
 14173     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14174
 14175     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14176         MOVE ' '                 TO DC-OPTION-CODE
 14177         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14178         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14179         IF NOT DATE-CONVERSION-ERROR
 14180             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14181             MOVE AL-UANON            TO BIRTHDTA
 14182         END-IF
 14183     END-IF.
 14184
 14185     MOVE CL-SOC-SEC-NO          TO SSNO.
 14186     MOVE AL-UANON               TO SSNA.
 14187
 14188     IF CL-INCURRED-DT NOT = LOW-VALUES
 14189         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14190         MOVE ' '                TO DC-OPTION-CODE
 14191         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14192         IF NOT DATE-CONVERSION-ERROR
 14193             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14194             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 267
* EL130.cbl
 14195         END-IF
 14196     END-IF.
 14197
 14198     IF CL-REPORTED-DT NOT = LOW-VALUES
 14199         MOVE ' '                TO DC-OPTION-CODE
 14200         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14201         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14202         IF NOT DATE-CONVERSION-ERROR
 14203             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14204             MOVE AL-UANON            TO REPORTA
 14205         END-IF
 14206     END-IF.
 14207
 14208     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14209         MOVE ' '                 TO DC-OPTION-CODE
 14210         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14211         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14212         IF NOT DATE-CONVERSION-ERROR
 14213             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14214             MOVE AL-UANON            TO ESTENDA
 14215         END-IF
 14216     END-IF.
 14217
 14218     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14219     MOVE CL-CAUSE-CD            TO CAUSEO.
 14220     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14221     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14222     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14223     MOVE CL-PRIORITY-CD         TO PRICDO.
 14224     MOVE AL-UANON               TO DIAGA
 14225                                    CAUSEA
 14226                                    RELCLMA
 14227                                    PROCCDA
 14228                                    PRICDA.
 14229     MOVE AL-UNNON               TO MANRSVA.
 14230
 14231*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14232*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14233*        MOVE AL-UANON               TO PRODCDA
 14234*    END-IF.
 14235
 14236     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14237     MOVE CL-FILE-LOCATION       TO FILETOO.
 14238     MOVE CL-BENEFICIARY         TO BENECDO.
 14239     MOVE AL-UANON               TO SUPVA
 14240                                    FILETOA
 14241                                    BENECDA.
 14242
 14243     IF CLAIM-SWITCH = 'X'
 14244         GO TO 7099-EXIT
 14245     END-IF.
 14246
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 268
* EL130.cbl
 14248 7050-BUILD-MAP-CERT-DATA.
 14249     MOVE CM-CERT-PRIME          TO CERTNOO.
 14250     MOVE CM-CERT-SFX            TO SUFXO.
 14251     MOVE AL-SANON               TO CERTNOA
 14252                                    SUFXA.
 14253
 14254     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14255         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14256         MOVE ' '                TO DC-OPTION-CODE
 14257         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14258         IF NOT DATE-CONVERSION-ERROR
 14259             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14260         END-IF
 14261     END-IF.
 14262
 14263     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14264     MOVE CM-STATE               TO STATEO.
 14265     MOVE CM-CARRIER             TO CRTCARRO.
 14266     MOVE CM-GROUPING            TO GROUPO.
 14267     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14268     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14269     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14270     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14271     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14272     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14273     MOVE CM-JT-INITIAL          TO JNTINITO.
 14274     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14275     MOVE AL-UANON               TO ACCOUNTA
 14276                                    STATEA
 14277                                    CRTCARRA
 14278                                    GROUPA
 14279                                    CRTLNMEA
 14280                                    CRTFNMEA
 14281                                    CRTINITA
 14282                                    JNTLNMEA
 14283                                    JNTFNMEA
 14284                                    JNTINITA.
 14285     MOVE AL-UNNON               TO ISSAGEA
 14286                                    JNTAGEA.
 14287
 14288     IF CM-SSN-STATE   = CM-STATE AND
 14289        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14290*        NEXT SENTENCE
 14291         CONTINUE
 14292     ELSE
 14293         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14294     END-IF.
 14295
 14296     MOVE AL-UANON               TO CRTSSNA.
 14297
 14298     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14299     MOVE '2'                    TO DC-OPTION-CODE.
 14300     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14301     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14302
 14303*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14304     MOVE SPACES                 TO ELCNTL-KEY.
 14305     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 269
* EL130.cbl
 14306     MOVE '3'                    TO CNTL-REC-TYPE.
 14307     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14308     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14309
 14310
 14311
 14312* EXEC CICS READ
 14313*        DATASET  (ELCNTL-DSID)
 14314*        SET      (ADDRESS OF CONTROL-FILE)
 14315*        RIDFLD   (ELCNTL-KEY)
 14316*        RESP     (WS-RESPONSE)
 14317*    END-EXEC.
 14318*    MOVE '&"S        E          (  N#00012916' TO DFHEIV0
 14319     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14321     MOVE X'204E233030303132393136' TO DFHEIV0(25:11)
 14322     CALL 'kxdfhei1' USING DFHEIV0,
 14323           ELCNTL-DSID,
 14324           DFHEIV20,
 14325           DFHEIV99,
 14326           ELCNTL-KEY,
 14327           DFHEIV99,
 14328           DFHEIV99,
 14329           DFHEIV99
 14330     SET ADDRESS OF CONTROL-FILE TO
 14331         DFHEIV20
 14332     MOVE EIBRESP  TO WS-RESPONSE
 14333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14334
 14335
 14336     IF WS-RESP-NOTFND
 14337          MOVE ER-2848           TO EMI-ERROR
 14338          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14339          GO TO 8100-SEND-INITIAL-MAP
 14340     END-IF.
 14341
 14342     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14343     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14344     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 270
* EL130.cbl
 14346     IF CM-LF-BENEFIT-CD = '00'
 14347         MOVE ZEROS              TO LCVOTRMO
 14348                                    LCVRTRMO
 14349                                    LCVRATEO
 14350                                    LCVBENEO
 14351         MOVE SPACES             TO LCVDSCRO
 14352                                    LCVCDO
 14353                                    LCVKINDO
 14354                                    LCVFORMO
 14355                                    LCVCNDTO
 14356                                    LCVEXITO
 14357                                    LCVSTATO
 14358         IF CLMTYPEL GREATER THAN ZERO AND
 14359            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14360                MOVE ER-0521     TO EMI-ERROR
 14361                MOVE AL-UABON    TO CLMTYPEA
 14362                MOVE -1          TO CLMTYPEL
 14363                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14364                GO TO 7060-FILL-AH-COVERAGE
 14365         ELSE
 14366             GO TO 7060-FILL-AH-COVERAGE
 14367         END-IF
 14368     END-IF.
 14369
 14370     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14371     MOVE AL-UANON               TO LCVDSCRA.
 14372     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14373     MOVE '4'                    TO WS-REC-TYPE.
 14374     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14375     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14376     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14377     MOVE AL-UANON               TO LCVCDA.
 14378     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14379                                    CP-ORIGINAL-TERM.
 14380     MOVE AL-UNNON               TO LCVOTRMA.
 14381     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14382     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14383     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14384     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14385     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14386     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14387
 14388     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14389     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14390
 14391     IF CM-LF-PREMIUM-RATE NUMERIC
 14392         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14393     ELSE
 14394         MOVE ZEROS              TO LCVRATEO
 14395     END-IF.
 14396
 14397     MOVE AL-UNNON               TO LCVRATEA.
 14398
 14399     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14400         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14401     END-IF.
 14402
 14403     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 271
* EL130.cbl
 14404
 14405     MOVE AL-UNNON               TO LCVBENEA.
 14406
 14407     IF CM-POLICY-FORM-NO NOT = SPACES
 14408         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14409     ELSE
 14410         MOVE WS-FORM-HOLD       TO LCVFORMO
 14411     END-IF.
 14412
 14413     MOVE SPACES                 TO WS-FORM-HOLD.
 14414     MOVE 'L'                    TO WS-REC-TYPE.
 14415     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14416
 14417     IF WS-FORM-HOLD NOT = SPACES
 14418         MOVE WS-FORM-HOLD       TO LCVFORMO
 14419         MOVE AL-UANON           TO LCVFORMA
 14420     END-IF.
 14421
 14422     IF CM-LF-CURRENT-STATUS = '8'
 14423         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14424             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14425             MOVE ' '             TO DC-OPTION-CODE
 14426             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14427             IF NOT DATE-CONVERSION-ERROR
 14428                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14429                 MOVE AL-UANON            TO LCVCNDTA
 14430             END-IF
 14431         END-IF
 14432     END-IF.
 14433
 14434     IF CM-LF-CURRENT-STATUS = '7'
 14435         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14436             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14437             MOVE ' '            TO DC-OPTION-CODE
 14438             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14439             IF NOT DATE-CONVERSION-ERROR
 14440                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14441                 MOVE AL-UANON   TO LCVCNDTA
 14442             END-IF
 14443         END-IF
 14444     END-IF.
 14445
 14446     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14447         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14448             MOVE ' '            TO DC-OPTION-CODE
 14449             MOVE CM-LF-DEATH-EXIT-DT
 14450                                 TO DC-BIN-DATE-1
 14451             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14452             IF NOT DATE-CONVERSION-ERROR
 14453                 MOVE DC-GREG-DATE-1-EDIT
 14454                                 TO LCVEXITO
 14455             END-IF
 14456         END-IF
 14457     END-IF.
 14458
 14459     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14460         IF CP-REMAINING-TERM-3 = ZEROS
 14461             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 272
* EL130.cbl
 14462         ELSE
 14463             MOVE 'ACTIVE'       TO LCVSTATO
 14464         END-IF
 14465     END-IF.
 14466
 14467     IF CM-LF-CURRENT-STATUS = '2'
 14468        MOVE 'PEND  '            TO LCVSTATO
 14469     END-IF.
 14470     IF CM-LF-CURRENT-STATUS = '3'
 14471        MOVE 'RESTORE'           TO LCVSTATO
 14472     END-IF.
 14473     IF CM-LF-CURRENT-STATUS = '5'
 14474        MOVE 'REISSUE'           TO LCVSTATO
 14475     END-IF.
 14476     IF CM-LF-CURRENT-STATUS = '6'
 14477        MOVE 'LMP DIS'           TO LCVSTATO
 14478     END-IF.
 14479     IF CM-LF-CURRENT-STATUS = '7'
 14480        MOVE 'DEATH  '           TO LCVSTATO
 14481     END-IF.
 14482     IF CM-LF-CURRENT-STATUS = '8'
 14483        MOVE 'CANCEL '           TO LCVSTATO
 14484     END-IF.
 14485     IF CM-LF-CURRENT-STATUS = '9'
 14486        MOVE 'RE-ONLY'           TO LCVSTATO
 14487     END-IF.
 14488     IF CM-LF-CURRENT-STATUS = 'V'
 14489        MOVE 'VOID   '           TO LCVSTATO
 14490     END-IF.
 14491     IF CM-LF-CURRENT-STATUS = 'D'
 14492        MOVE 'DECLINE'           TO LCVSTATO
 14493     END-IF.
 14494
 14495     IF PI-COMPANY-ID = 'CID'
 14496         IF CM-LF-BENEFIT-CD >= '2O' AND
 14497            CM-LF-BENEFIT-CD <= '2V'
 14498             MOVE ER-0878       TO EMI-ERROR
 14499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14500         END-IF
 14501     END-IF.
 14502
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 273
* EL130.cbl
 14504 7060-FILL-AH-COVERAGE.
 14505
 14506     IF CM-AH-BENEFIT-CD = '00'
 14507         MOVE ZEROS              TO ACVOTRMO
 14508                                    ACVRTRMO
 14509                                    ACVRATEO
 14510                                    ACVBENEO
 14511         MOVE SPACES             TO ACVDSCRO
 14512                                    ACVCDO
 14513                                    ACVKINDO
 14514                                    ACVFORMO
 14515                                    ACVCNDTO
 14516                                    ACVEXITO
 14517                                    ACVSTATO
 14518         IF (CLMTYPEL GREATER THAN ZERO AND
 14519             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 14520             MOVE ER-0521     TO EMI-ERROR
 14521             MOVE AL-UABON    TO CLMTYPEA
 14522             MOVE -1          TO CLMTYPEL
 14523             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14524             GO TO 7070-BUILD-MAP-FINISH
 14525         ELSE
 14526             GO TO 7070-BUILD-MAP-FINISH
 14527         END-IF
 14528     END-IF.
 14529
 14530     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14531     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14532     MOVE AL-UANON               TO ACVDSCRA
 14533                                    ACVCDA.
 14534     MOVE '5'                    TO WS-REC-TYPE.
 14535     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14536     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14537
 14538     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 14539                                    CP-ORIGINAL-TERM.
 14540     MOVE AL-UNNON               TO ACVOTRMA.
 14541
 14542     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14543     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14544     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14545     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14546     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14547     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14548
 14549     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14550     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14551
 14552     IF CM-AH-PREMIUM-RATE NUMERIC
 14553         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14554     ELSE
 14555         MOVE ZEROS              TO ACVRATEO
 14556     END-IF.
 14557
 14558     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 14559     MOVE AL-UNNON               TO ACVRATEA
 14560                                    ACVBENEA.
 14561
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 274
* EL130.cbl
 14562     IF CM-POLICY-FORM-NO NOT = SPACES
 14563         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 14564     ELSE
 14565         MOVE WS-FORM-HOLD       TO ACVFORMO
 14566         MOVE SPACES TO WS-FORM-HOLD
 14567         MOVE 'A'                TO WS-REC-TYPE
 14568         PERFORM 7400-READ-STATE THRU 7499-EXIT
 14569         IF WS-FORM-HOLD NOT = SPACES
 14570             MOVE WS-FORM-HOLD   TO ACVFORMO
 14571         END-IF
 14572     END-IF.
 14573
 14574     MOVE AL-UANON               TO ACVFORMA.
 14575
 14576     IF CM-AH-CURRENT-STATUS = '8'
 14577         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 14578             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14579             MOVE ' '             TO DC-OPTION-CODE
 14580             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14581             IF NOT DATE-CONVERSION-ERROR
 14582                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14583                MOVE AL-UANON    TO ACVCNDTA
 14584             END-IF
 14585         END-IF
 14586     END-IF.
 14587
 14588     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14589         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14590             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 14591             MOVE ' '             TO DC-OPTION-CODE
 14592             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14593             IF NOT DATE-CONVERSION-ERROR
 14594                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14595                MOVE AL-UANON            TO ACVCNDTA
 14596             END-IF
 14597         END-IF
 14598     END-IF.
 14599
 14600     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14601         MOVE ' '                TO DC-OPTION-CODE
 14602         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14603         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14604         IF NOT DATE-CONVERSION-ERROR
 14605             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 14606         END-IF
 14607     END-IF.
 14608
 14609     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14610         IF CP-REMAINING-TERM-3 = ZEROS
 14611             MOVE 'EXPIRED'      TO ACVSTATO
 14612         ELSE
 14613             MOVE 'ACTIVE'       TO ACVSTATO
 14614         END-IF
 14615     END-IF.
 14616
 14617     IF CM-AH-CURRENT-STATUS = '2'
 14618         MOVE 'PEND  '           TO ACVSTATO
 14619     END-IF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 275
* EL130.cbl
 14620     IF CM-AH-CURRENT-STATUS = '3'
 14621         MOVE 'RESTORE'          TO ACVSTATO
 14622     END-IF.
 14623     IF CM-AH-CURRENT-STATUS = '5'
 14624         MOVE 'REISSUE'          TO ACVSTATO
 14625     END-IF.
 14626     IF CM-AH-CURRENT-STATUS = '6'
 14627         MOVE 'LMP DIS'          TO ACVSTATO
 14628     END-IF.
 14629     IF CM-AH-CURRENT-STATUS = '7'
 14630         MOVE 'DEATH  '          TO ACVSTATO
 14631     END-IF.
 14632     IF CM-AH-CURRENT-STATUS = '8'
 14633         MOVE 'CANCEL '          TO ACVSTATO
 14634     END-IF.
 14635     IF CM-AH-CURRENT-STATUS = '9'
 14636         MOVE 'RE-ONLY'          TO ACVSTATO
 14637     END-IF.
 14638     IF CM-AH-CURRENT-STATUS = 'V'
 14639         MOVE 'VOID   '          TO ACVSTATO
 14640     END-IF.
 14641     IF CM-AH-CURRENT-STATUS = 'D'
 14642         MOVE 'DECLINE'          TO ACVSTATO
 14643     END-IF.
 14644
 14645     IF PI-COMPANY-ID = 'DCC'
 14646        IF CM-ACCOUNT (9:2) = 'BI'
 14647           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 14648           MOVE CM-CARRIER       TO CTRLR-CARRIER
 14649           MOVE CM-GROUPING      TO CTRLR-GROUPING
 14650           MOVE CM-STATE         TO CTRLR-STATE
 14651           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 14652           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 14653           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 14654           MOVE 'C'              TO CTRLR-REC-TYPE
 14655
 14656* EXEC CICS READ
 14657*            DATASET  (ELCRTT-DSID)
 14658*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 14659*            RIDFLD   (ELCRTT-KEY)
 14660*            RESP     (WS-RESPONSE)
 14661*          END-EXEC
 14662*    MOVE '&"S        E          (  N#00013242' TO DFHEIV0
 14663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14665     MOVE X'204E233030303133323432' TO DFHEIV0(25:11)
 14666     CALL 'kxdfhei1' USING DFHEIV0,
 14667           ELCRTT-DSID,
 14668           DFHEIV20,
 14669           DFHEIV99,
 14670           ELCRTT-KEY,
 14671           DFHEIV99,
 14672           DFHEIV99,
 14673           DFHEIV99
 14674     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 14675         DFHEIV20
 14676     MOVE EIBRESP  TO WS-RESPONSE
 14677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 276
* EL130.cbl
 14678           IF WS-RESP-NORMAL
 14679               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 14680               MOVE WS-DIAG-VIN-MSG TO DIAGO
 14681               MOVE AL-UANON        TO DIAGA
 14682           END-IF
 14683        END-IF
 14684     END-IF.
 14685
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 277
* EL130.cbl
 14687 7070-BUILD-MAP-FINISH.
 14688     MOVE CM-LOAN-APR            TO APRO.
 14689     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14690     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14691     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 14692     MOVE AL-UNNON               TO APRA
 14693                                    PMTFREQA.
 14694     MOVE AL-UANON               TO INDGRPA
 14695                                    PREMTYPA.
 14696
 14697     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 14698         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 14699         MOVE AL-UANON               TO REINCDA
 14700     END-IF.
 14701
 14702     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 14703*        NEXT SENTENCE
 14704         CONTINUE
 14705     ELSE
 14706         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14707         MOVE ' '                TO DC-OPTION-CODE
 14708         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14709         IF NOT DATE-CONVERSION-ERROR
 14710             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 14711             MOVE AL-UANON            TO ADDONDTA
 14712         END-IF
 14713     END-IF.
 14714
 14715     IF CLAIM-SWITCH = 'N'
 14716         IF SEXL = ZEROS
 14717             MOVE CM-INSURED-SEX TO SEXO
 14718*            MOVE AL-UANON       TO SEXA
 14719         END-IF
 14720     END-IF.
 14721
 14722     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 14723         MOVE CM-MEMBER-NO       TO MEMBERO
 14724         MOVE AL-UANON           TO MEMBERA
 14725     END-IF.
 14726
 14727     IF MAINTI = 'A'
 14728         IF (LOANNOL = ZEROS OR
 14729             EIBAID = DFHPF5)
 14730             MOVE CM-LOAN-NUMBER TO LOANNOO
 14731             MOVE AL-UANON       TO LOANNOA
 14732         ELSE
 14733*            NEXT SENTENCE
 14734             CONTINUE
 14735         END-IF
 14736     ELSE
 14737         MOVE CM-LOAN-NUMBER     TO LOANNOO
 14738         MOVE AL-UANON           TO LOANNOA
 14739     END-IF.
 14740
 14741     IF MAINTI = 'A'
 14742         IF (LOANBALL = ZEROS OR
 14743             EIBAID = DFHPF5)
 14744             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 278
* EL130.cbl
 14745             MOVE AL-UNNON       TO LOANBALA
 14746         ELSE
 14747*            NEXT SENTENCE
 14748             CONTINUE
 14749         END-IF
 14750     ELSE
 14751         MOVE CM-LOAN-BALANCE    TO LOANBALO
 14752         MOVE AL-UNNON           TO LOANBALA
 14753     END-IF.
 14754
 14755     IF CM-PREMIUM-TYPE NOT = '3'
 14756         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14757             PERFORM 7200-PROTECT-CERT-FIELDS
 14758         ELSE
 14759             PERFORM 7300-RESET-KEY-ATTRBS
 14760         END-IF
 14761     ELSE
 14762         PERFORM 7300-RESET-KEY-ATTRBS
 14763     END-IF.
 14764
 14765*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 14766*        NEXT SENTENCE
 14767*        CONTINUE
 14768*    ELSE
 14769         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14770*    END-IF.
 14771
 14772 7099-EXIT.
 14773     EXIT.
 14774
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 279
* EL130.cbl
 14776 7100-READ-BENEFIT.
 14777
 14778
 14779* EXEC CICS HANDLE CONDITION
 14780*         NOTFND   (7120-NOT-FOUND)
 14781*    END-EXEC.
 14782*    MOVE '"$I                   ! E #00013348' TO DFHEIV0
 14783     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14785     MOVE X'4520233030303133333438' TO DFHEIV0(25:11)
 14786     CALL 'kxdfhei1' USING DFHEIV0
 14787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14788
 14789
 14790     MOVE SPACES                 TO ELCNTL-KEY.
 14791     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 14792     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 14793     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14794     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14795
 14796 7105-READ-FILE.
 14797     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 14798
 14799     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 14800        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 14801          GO TO 7120-NOT-FOUND
 14802     END-IF.
 14803
 14804     MOVE 1                      TO SUB.
 14805 7110-LOOP.
 14806     IF SUB = 9
 14807         GO TO 7120-NOT-FOUND
 14808     END-IF.
 14809
 14810     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 14811         ADD 1                   TO SUB
 14812         GO TO 7110-LOOP
 14813     END-IF.
 14814
 14815     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 14816     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 14817     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 14818
 14819     GO TO 7199-EXIT.
 14820
 14821 7120-NOT-FOUND.
 14822     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 14823                                    WS-FORM-HOLD.
 14824
 14825 7199-EXIT.
 14826      EXIT.
 14827
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 280
* EL130.cbl
 14829 7200-PROTECT-CERT-FIELDS.
 14830     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14831                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14832                                LCVFORMA ACVFORMA JNTLNMEA
 14833                                JNTFNMEA JNTINITA.
 14834
 14835     IF CM-LF-CURRENT-STATUS = '2' OR
 14836        CM-AH-CURRENT-STATUS = '2'
 14837         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 14838     END-IF.
 14839
 14840     MOVE AL-SANOF TO
 14841            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 14842            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 14843            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 14844            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 14845            LCVRATEA   ACVRATEA.
 14846
 14847     MOVE 'S'                    TO CERTMTI.
 14848
 14849 7300-RESET-KEY-ATTRBS.
 14850     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14851                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14852                                LCVFORMA ACVFORMA JNTLNMEA
 14853                                JNTFNMEA JNTINITA.
 14854
 14855     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14856         MOVE AL-SANOF           TO REINCDA
 14857     END-IF.
 14858
 14859     MOVE 'S'                    TO CERTMTI.
 14860
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 281
* EL130.cbl
 14862 7400-READ-STATE.
 14863
 14864
 14865* EXEC CICS HANDLE CONDITION
 14866*         NOTFND   (7499-EXIT)
 14867*    END-EXEC.
 14868*    MOVE '"$I                   ! F #00013426' TO DFHEIV0
 14869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14871     MOVE X'4620233030303133343236' TO DFHEIV0(25:11)
 14872     CALL 'kxdfhei1' USING DFHEIV0
 14873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14874
 14875
 14876     MOVE SPACES                 TO ELCNTL-KEY.
 14877     MOVE CM-STATE               TO CNTL-ACCESS.
 14878     MOVE '3'                    TO CNTL-REC-TYPE.
 14879     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14880     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14881
 14882     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14883
 14884     MOVE 1                      TO SUB.
 14885
 14886 7410-LOOP.
 14887     IF SUB = 21
 14888        GO TO 7499-EXIT
 14889     END-IF.
 14890
 14891*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 14892*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 14893*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 14894*        GO TO 7499-EXIT.
 14895
 14896     ADD 1                       TO SUB.
 14897     GO TO 7410-LOOP.
 14898
 14899 7499-EXIT.
 14900      EXIT.
 14901
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 282
* EL130.cbl
 14903 7500-BROWSE-FOR-DUPLICATE.
 14904
 14905     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 14906
 14907
 14908
 14909* EXEC CICS HANDLE CONDITION
 14910*        NOTFND   (7500-EXIT)
 14911*        DUPKEY   (7500-DUPLICATE-KEY)
 14912*        ENDFILE  (7500-EXIT)
 14913*    END-EXEC.
 14914*    MOVE '"$I$''                 ! G #00013462' TO DFHEIV0
 14915     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 14916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14917     MOVE X'4720233030303133343632' TO DFHEIV0(25:11)
 14918     CALL 'kxdfhei1' USING DFHEIV0
 14919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14920
 14921
 14922
 14923
 14924* EXEC CICS STARTBR
 14925*        DATASET    (ELMSTR5-DSID)
 14926*        RIDFLD     (ELMSTR5-KEY)
 14927*    END-EXEC.
 14928     MOVE 0
 14929       TO DFHEIV11
 14930*    MOVE '&,         G          &   #00013469' TO DFHEIV0
 14931     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14932     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14933     MOVE X'2020233030303133343639' TO DFHEIV0(25:11)
 14934     CALL 'kxdfhei1' USING DFHEIV0,
 14935           ELMSTR5-DSID,
 14936           ELMSTR5-KEY,
 14937           DFHEIV99,
 14938           DFHEIV11,
 14939           DFHEIV99
 14940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14941
 14942
 14943
 14944
 14945* EXEC CICS HANDLE CONDITION
 14946*        ENDFILE  (7500-END-BROWSE)
 14947*    END-EXEC.
 14948*    MOVE '"$''                   ! H #00013475' TO DFHEIV0
 14949     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14951     MOVE X'4820233030303133343735' TO DFHEIV0(25:11)
 14952     CALL 'kxdfhei1' USING DFHEIV0
 14953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14954
 14955
 14956 7500-READ-CLAIM-LOOP.
 14957
 14958
 14959
 14960* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 283
* EL130.cbl
 14961*        DATASET   (ELMSTR5-DSID)
 14962*        SET       (ADDRESS OF CLAIM-MASTER)
 14963*        RIDFLD    (ELMSTR5-KEY)
 14964*    END-EXEC.
 14965     MOVE 0
 14966       TO DFHEIV11
 14967*    MOVE '&.S                   )   #00013482' TO DFHEIV0
 14968     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14969     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14970     MOVE X'2020233030303133343832' TO DFHEIV0(25:11)
 14971     CALL 'kxdfhei1' USING DFHEIV0,
 14972           ELMSTR5-DSID,
 14973           DFHEIV20,
 14974           DFHEIV99,
 14975           ELMSTR5-KEY,
 14976           DFHEIV99,
 14977           DFHEIV11,
 14978           DFHEIV99,
 14979           DFHEIV99
 14980     SET ADDRESS OF CLAIM-MASTER TO
 14981         DFHEIV20
 14982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14983
 14984
 14985 7500-DUPLICATE-KEY.
 14986
 14987     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 14988        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 14989        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 14990        CL-CERT-STATE     NOT = CM-STATE       OR
 14991        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 14992        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 14993        CL-CERT-NO        NOT = CM-CERT-NO
 14994           GO TO 7500-CHECK-MATCH-COUNT
 14995     END-IF.
 14996
 14997     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 14998
 14999     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15000        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15001        GO TO 7500-END-BROWSE
 15002     ELSE
 15003        GO TO 7500-READ-CLAIM-LOOP
 15004     END-IF.
 15005
 15006 7500-CHECK-MATCH-COUNT.
 15007
 15008     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15009        CL-CERT-NO    = CM-CERT-NO
 15010          GO TO 7500-READ-CLAIM-LOOP
 15011     END-IF.
 15012
 15013 7500-END-BROWSE.
 15014
 15015
 15016
 15017* EXEC CICS ENDBR
 15018*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 284
* EL130.cbl
 15019*    END-EXEC.
 15020     MOVE 0
 15021       TO DFHEIV11
 15022*    MOVE '&2                    $   #00013519' TO DFHEIV0
 15023     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15025     MOVE X'2020233030303133353139' TO DFHEIV0(25:11)
 15026     CALL 'kxdfhei1' USING DFHEIV0,
 15027           ELMSTR5-DSID,
 15028           DFHEIV11,
 15029           DFHEIV99
 15030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15031
 15032
 15033 7500-EXIT.
 15034     EXIT.
 15035
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 285
* EL130.cbl
 15037 7550-FALL-THRU-PARA.
 15038
 15039
 15040
 15041* EXEC CICS DUMP
 15042*         DUMPCODE ('E130')
 15043*         TASK
 15044*    END-EXEC.
 15045     MOVE 'E130' TO DFHEIV5
 15046*    MOVE '<"   T                $   #00013530' TO DFHEIV0
 15047     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15048     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15049     MOVE X'2020233030303133353330' TO DFHEIV0(25:11)
 15050     CALL 'kxdfhei1' USING DFHEIV0,
 15051           DFHEIV5,
 15052           DFHEIV99,
 15053           DFHEIV99
 15054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15055
 15056
 15057
 15058
 15059* EXEC CICS RETURN
 15060*    END-EXEC.
 15061*    MOVE '.(                    ''   #00013536' TO DFHEIV0
 15062     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15064     MOVE X'2020233030303133353336' TO DFHEIV0(25:11)
 15065     CALL 'kxdfhei1' USING DFHEIV0,
 15066           DFHEIV99,
 15067           DFHEIV99,
 15068           DFHEIV99,
 15069           DFHEIV99,
 15070           DFHEIV99,
 15071           DFHEIV99
 15072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15073
 15074
 15075 7600-BROWSE-CLAIM.
 15076
 15077
 15078
 15079* EXEC CICS READ
 15080*        DATASET(ELMSTR-DSID)
 15081*        SET    (ADDRESS OF CLAIM-MASTER)
 15082*        RIDFLD (ELMSTR-KEY)
 15083*        GENERIC
 15084*        EQUAL
 15085*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15086*    END-EXEC.
 15087*    MOVE '&"S  KG    E          (   #00013542' TO DFHEIV0
 15088     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15090     MOVE X'2020233030303133353432' TO DFHEIV0(25:11)
 15091     CALL 'kxdfhei1' USING DFHEIV0,
 15092           ELMSTR-DSID,
 15093           DFHEIV20,
 15094           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 286
* EL130.cbl
 15095           ELMSTR-KEY,
 15096           ELMSTR-GENERIC-LENGTH,
 15097           DFHEIV99,
 15098           DFHEIV99
 15099     SET ADDRESS OF CLAIM-MASTER TO
 15100         DFHEIV20
 15101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15102
 15103
 15104     MOVE CL-CERT-PRIME          TO CERTNOI.
 15105     MOVE CL-CERT-SFX            TO SUFXI.
 15106
 15107 7610-BROWSE-CLAIM-LOOP.
 15108
 15109     MOVE LOW-VALUES             TO BCERT1O
 15110                                    BSUFX1O
 15111                                    BCERT2O
 15112                                    BSUFX2O
 15113                                    BCERT3O
 15114                                    BSUFX3O
 15115                                    BCERT4O
 15116                                    BSUFX4O
 15117                                    BCERT5O
 15118                                    BSUFX5O.
 15119
 15120     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15121
 15122
 15123
 15124* EXEC CICS HANDLE CONDITION
 15125*        ENDFILE  (7630-END-BROWSE)
 15126*    END-EXEC.
 15127*    MOVE '"$''                   ! I #00013570' TO DFHEIV0
 15128     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15130     MOVE X'4920233030303133353730' TO DFHEIV0(25:11)
 15131     CALL 'kxdfhei1' USING DFHEIV0
 15132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15133
 15134
 15135
 15136
 15137* EXEC CICS STARTBR
 15138*        DATASET    (ELMSTR-DSID)
 15139*        RIDFLD     (ELMSTR-KEY)
 15140*    END-EXEC.
 15141     MOVE 0
 15142       TO DFHEIV11
 15143*    MOVE '&,         G          &   #00013575' TO DFHEIV0
 15144     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15145     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15146     MOVE X'2020233030303133353735' TO DFHEIV0(25:11)
 15147     CALL 'kxdfhei1' USING DFHEIV0,
 15148           ELMSTR-DSID,
 15149           ELMSTR-KEY,
 15150           DFHEIV99,
 15151           DFHEIV11,
 15152           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 287
* EL130.cbl
 15153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15154
 15155
 15156     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15157
 15158 7620-READ-CLAIM-LOOP.
 15159
 15160
 15161
 15162* EXEC CICS READNEXT
 15163*        DATASET   (ELMSTR-DSID)
 15164*        SET       (ADDRESS OF CLAIM-MASTER)
 15165*        RIDFLD    (ELMSTR-KEY)
 15166*    END-EXEC.
 15167     MOVE 0
 15168       TO DFHEIV11
 15169*    MOVE '&.S                   )   #00013585' TO DFHEIV0
 15170     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15171     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15172     MOVE X'2020233030303133353835' TO DFHEIV0(25:11)
 15173     CALL 'kxdfhei1' USING DFHEIV0,
 15174           ELMSTR-DSID,
 15175           DFHEIV20,
 15176           DFHEIV99,
 15177           ELMSTR-KEY,
 15178           DFHEIV99,
 15179           DFHEIV11,
 15180           DFHEIV99,
 15181           DFHEIV99
 15182     SET ADDRESS OF CLAIM-MASTER TO
 15183         DFHEIV20
 15184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15185
 15186
 15187     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15188        CL-CARRIER     NOT = CLMCARRI       OR
 15189        CL-CLAIM-NO    NOT = CLMNOI
 15190          GO TO 7630-END-BROWSE
 15191     END-IF.
 15192
 15193     IF WS-ASSOCIATED-CERTS = 1
 15194         MOVE CL-CERT-PRIME      TO BCERT1O
 15195         MOVE CL-CERT-SFX        TO BSUFX1O
 15196     END-IF.
 15197
 15198     IF WS-ASSOCIATED-CERTS = 2
 15199         MOVE CL-CERT-PRIME      TO BCERT2O
 15200         MOVE CL-CERT-SFX        TO BSUFX2O
 15201     END-IF.
 15202
 15203     IF WS-ASSOCIATED-CERTS = 3
 15204         MOVE CL-CERT-PRIME      TO BCERT3O
 15205         MOVE CL-CERT-SFX        TO BSUFX3O
 15206     END-IF.
 15207
 15208     IF WS-ASSOCIATED-CERTS = 4
 15209         MOVE CL-CERT-PRIME      TO BCERT4O
 15210         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 288
* EL130.cbl
 15211     END-IF.
 15212
 15213     IF WS-ASSOCIATED-CERTS = 5
 15214         MOVE CL-CERT-PRIME      TO BCERT5O
 15215         MOVE CL-CERT-SFX        TO BSUFX5O
 15216     ELSE
 15217         ADD +1                  TO WS-ASSOCIATED-CERTS
 15218         GO TO 7620-READ-CLAIM-LOOP
 15219     END-IF.
 15220
 15221 7630-END-BROWSE.
 15222
 15223
 15224
 15225* EXEC CICS ENDBR
 15226*        DATASET   (ELMSTR-DSID)
 15227*    END-EXEC.
 15228     MOVE 0
 15229       TO DFHEIV11
 15230*    MOVE '&2                    $   #00013628' TO DFHEIV0
 15231     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15232     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15233     MOVE X'2020233030303133363238' TO DFHEIV0(25:11)
 15234     CALL 'kxdfhei1' USING DFHEIV0,
 15235           ELMSTR-DSID,
 15236           DFHEIV11,
 15237           DFHEIV99
 15238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15239
 15240
 15241 7640-HIGHLIGHT-CERT-DISPLAYED.
 15242
 15243     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15244     MOVE AL-SANON               TO BCERT1A
 15245                                    BSUFX1A
 15246                                    BCERT2A
 15247                                    BSUFX2A
 15248                                    BCERT3A
 15249                                    BSUFX3A
 15250                                    BCERT4A
 15251                                    BSUFX4A
 15252                                    BCERT5A
 15253                                    BSUFX5A.
 15254
 15255     IF BCERT1O = CERTNOI AND
 15256        BSUFX1O = SUFXI
 15257            MOVE AL-SABON        TO BCERT1A
 15258                                    BSUFX1A
 15259     END-IF.
 15260
 15261     IF BCERT2O = CERTNOI AND
 15262        BSUFX2O = SUFXI
 15263            MOVE AL-SABON        TO BCERT2A
 15264                                    BSUFX2A
 15265     END-IF.
 15266
 15267     IF BCERT3O = CERTNOI AND
 15268        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 289
* EL130.cbl
 15269            MOVE AL-SABON        TO BCERT3A
 15270                                    BSUFX3A
 15271     END-IF.
 15272
 15273     IF BCERT4O = CERTNOI AND
 15274        BSUFX4O = SUFXI
 15275            MOVE AL-SABON        TO BCERT4A
 15276                                    BSUFX4A
 15277     END-IF.
 15278
 15279     IF BCERT5O = CERTNOI AND
 15280        BSUFX5O = SUFXI
 15281            MOVE AL-SABON        TO BCERT5A
 15282                                    BSUFX5A
 15283     END-IF.
 15284
 15285 7699-EXIT.
 15286     EXIT.
 15287
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 290
* EL130.cbl
 15289 7700-CHECK-SEQUENCE.
 15290
 15291
 15292
 15293* EXEC CICS HANDLE CONDITION
 15294*        ENDFILE  (7799-EXIT)
 15295*        NOTFND   (7799-EXIT)
 15296*    END-EXEC.
 15297*    MOVE '"$''I                  ! J #00013683' TO DFHEIV0
 15298     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15300     MOVE X'4A20233030303133363833' TO DFHEIV0(25:11)
 15301     CALL 'kxdfhei1' USING DFHEIV0
 15302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15303
 15304
 15305
 15306
 15307* EXEC CICS READ
 15308*        DATASET(ELMSTR-DSID)
 15309*        SET    (ADDRESS OF CLAIM-MASTER)
 15310*        RIDFLD (ELMSTR-KEY)
 15311*        GENERIC
 15312*        EQUAL
 15313*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15314*    END-EXEC.
 15315*    MOVE '&"S  KG    E          (   #00013689' TO DFHEIV0
 15316     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15318     MOVE X'2020233030303133363839' TO DFHEIV0(25:11)
 15319     CALL 'kxdfhei1' USING DFHEIV0,
 15320           ELMSTR-DSID,
 15321           DFHEIV20,
 15322           DFHEIV99,
 15323           ELMSTR-KEY,
 15324           ELMSTR-GENERIC-LENGTH,
 15325           DFHEIV99,
 15326           DFHEIV99
 15327     SET ADDRESS OF CLAIM-MASTER TO
 15328         DFHEIV20
 15329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15330
 15331
 15332     COMPUTE WS-ASSOC-CERT-TOTAL =
 15333             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15334
 15335     GO TO 7799-EXIT.
 15336
 15337 7710-RESEQUENCE-CLAIMS.
 15338
 15339
 15340
 15341* EXEC CICS HANDLE CONDITION
 15342*        ENDFILE  (7790-END-BROWSE)
 15343*    END-EXEC.
 15344*    MOVE '"$''                   ! K #00013706' TO DFHEIV0
 15345     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 291
* EL130.cbl
 15347     MOVE X'4B20233030303133373036' TO DFHEIV0(25:11)
 15348     CALL 'kxdfhei1' USING DFHEIV0
 15349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15350
 15351
 15352
 15353
 15354* EXEC CICS STARTBR
 15355*        DATASET    (ELMSTR-DSID)
 15356*        RIDFLD     (ELMSTR-KEY)
 15357*    END-EXEC.
 15358     MOVE 0
 15359       TO DFHEIV11
 15360*    MOVE '&,         G          &   #00013711' TO DFHEIV0
 15361     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15363     MOVE X'2020233030303133373131' TO DFHEIV0(25:11)
 15364     CALL 'kxdfhei1' USING DFHEIV0,
 15365           ELMSTR-DSID,
 15366           ELMSTR-KEY,
 15367           DFHEIV99,
 15368           DFHEIV11,
 15369           DFHEIV99
 15370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15371
 15372
 15373     ADD +1 TO WS-ASSOC-CERT-SEQU
 15374               WS-READNEXT-SWITCH.
 15375
 15376 7720-READ-CLAIM-LOOP.
 15377
 15378
 15379
 15380* EXEC CICS READNEXT
 15381*        DATASET   (ELMSTR-DSID)
 15382*        SET       (ADDRESS OF CLAIM-MASTER)
 15383*        RIDFLD    (ELMSTR-KEY)
 15384*    END-EXEC.
 15385     MOVE 0
 15386       TO DFHEIV11
 15387*    MOVE '&.S                   )   #00013722' TO DFHEIV0
 15388     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15389     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15390     MOVE X'2020233030303133373232' TO DFHEIV0(25:11)
 15391     CALL 'kxdfhei1' USING DFHEIV0,
 15392           ELMSTR-DSID,
 15393           DFHEIV20,
 15394           DFHEIV99,
 15395           ELMSTR-KEY,
 15396           DFHEIV99,
 15397           DFHEIV11,
 15398           DFHEIV99,
 15399           DFHEIV99
 15400     SET ADDRESS OF CLAIM-MASTER TO
 15401         DFHEIV20
 15402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15403
 15404
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 292
* EL130.cbl
 15405     IF WS-READNEXT-SWITCH = 1
 15406         ADD 1 TO WS-READNEXT-SWITCH
 15407         GO TO 7720-READ-CLAIM-LOOP
 15408     END-IF.
 15409
 15410 7730-END-BROWSE.
 15411
 15412
 15413
 15414* EXEC CICS ENDBR
 15415*        DATASET   (ELMSTR-DSID)
 15416*    END-EXEC.
 15417     MOVE 0
 15418       TO DFHEIV11
 15419*    MOVE '&2                    $   #00013736' TO DFHEIV0
 15420     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15421     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15422     MOVE X'2020233030303133373336' TO DFHEIV0(25:11)
 15423     CALL 'kxdfhei1' USING DFHEIV0,
 15424           ELMSTR-DSID,
 15425           DFHEIV11,
 15426           DFHEIV99
 15427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15428
 15429
 15430 7740-READ-CLAIM-UPDATE.
 15431
 15432     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15433        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15434        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15435          GO TO 7799-EXIT
 15436     ELSE
 15437          MOVE ZERO              TO WS-READNEXT-SWITCH
 15438     END-IF.
 15439
 15440
 15441
 15442* EXEC CICS READ
 15443*        DATASET(ELMSTR-DSID)
 15444*        SET    (ADDRESS OF CLAIM-MASTER)
 15445*        RIDFLD (ELMSTR-KEY)
 15446*        UPDATE
 15447*    END-EXEC.
 15448*    MOVE '&"S        EU         (   #00013751' TO DFHEIV0
 15449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15450     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15451     MOVE X'2020233030303133373531' TO DFHEIV0(25:11)
 15452     CALL 'kxdfhei1' USING DFHEIV0,
 15453           ELMSTR-DSID,
 15454           DFHEIV20,
 15455           DFHEIV99,
 15456           ELMSTR-KEY,
 15457           DFHEIV99,
 15458           DFHEIV99,
 15459           DFHEIV99
 15460     SET ADDRESS OF CLAIM-MASTER TO
 15461         DFHEIV20
 15462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 293
* EL130.cbl
 15463
 15464
 15465     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15466     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15467
 15468
 15469
 15470* EXEC CICS REWRITE
 15471*         DATASET     (ELMSTR-DSID)
 15472*         FROM        (CLAIM-MASTER)
 15473*    END-EXEC.
 15474     MOVE LENGTH OF
 15475      CLAIM-MASTER
 15476       TO DFHEIV11
 15477*    MOVE '&& L                  %   #00013762' TO DFHEIV0
 15478     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15479     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15480     MOVE X'2020233030303133373632' TO DFHEIV0(25:11)
 15481     CALL 'kxdfhei1' USING DFHEIV0,
 15482           ELMSTR-DSID,
 15483           CLAIM-MASTER,
 15484           DFHEIV11,
 15485           DFHEIV99
 15486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15487
 15488
 15489     GO TO 7710-RESEQUENCE-CLAIMS.
 15490
 15491 7790-END-BROWSE.
 15492
 15493
 15494
 15495* EXEC CICS ENDBR
 15496*        DATASET   (ELMSTR-DSID)
 15497*    END-EXEC.
 15498     MOVE 0
 15499       TO DFHEIV11
 15500*    MOVE '&2                    $   #00013772' TO DFHEIV0
 15501     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15502     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15503     MOVE X'2020233030303133373732' TO DFHEIV0(25:11)
 15504     CALL 'kxdfhei1' USING DFHEIV0,
 15505           ELMSTR-DSID,
 15506           DFHEIV11,
 15507           DFHEIV99
 15508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15509
 15510
 15511 7799-EXIT.
 15512     EXIT.
 15513
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 294
* EL130.cbl
 15515************************************************
 15516*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15517************************************************
 15518
 15519 7900-READ-ACTV-UPDATE.
 15520     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15521     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15522     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15523     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15524     MOVE +0                     TO TRLR-SEQ-NO.
 15525     MOVE '1'                    TO TRLR-TYPE.
 15526     GO TO 7900-READ-TRAILER-UPDATE.
 15527
 15528 7900-READ-NINETY-UPDATE.
 15529     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15530     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15531     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15532     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15533     MOVE +90                    TO TRLR-SEQ-NO.
 15534     MOVE '6'                    TO TRLR-TYPE.
 15535
 15536 7900-READ-TRAILER-UPDATE.
 15537
 15538
 15539* EXEC CICS READ  UPDATE
 15540*        DATASET    (ELTRLR-DSID)
 15541*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 15542*        RIDFLD     (ELTRLR-KEY)
 15543*    END-EXEC.
 15544*    MOVE '&"S        EU         (   #00013803' TO DFHEIV0
 15545     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15546     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15547     MOVE X'2020233030303133383033' TO DFHEIV0(25:11)
 15548     CALL 'kxdfhei1' USING DFHEIV0,
 15549           ELTRLR-DSID,
 15550           DFHEIV20,
 15551           DFHEIV99,
 15552           ELTRLR-KEY,
 15553           DFHEIV99,
 15554           DFHEIV99,
 15555           DFHEIV99
 15556     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15557         DFHEIV20
 15558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15559
 15560
 15561 7900-EXIT.
 15562      EXIT.
 15563
 15564 7910-READ-ACTV.
 15565     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15566     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15567     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15568     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15569     MOVE +0                     TO TRLR-SEQ-NO.
 15570     MOVE '1'                    TO TRLR-TYPE.
 15571     GO TO 7910-READ-TRAILER.
 15572
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 295
* EL130.cbl
 15573 7910-READ-NINETY.
 15574     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15575     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15576     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15577     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15578     MOVE +90                    TO TRLR-SEQ-NO.
 15579     MOVE '6'                    TO TRLR-TYPE.
 15580
 15581 7910-READ-TRAILER.
 15582     MOVE 'TRLR'                 TO FILE-SWITCH.
 15583
 15584
 15585
 15586* EXEC CICS READ
 15587*        DATASET   (ELTRLR-DSID)
 15588*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15589*        RIDFLD    (ELTRLR-KEY)
 15590*    END-EXEC.
 15591*    MOVE '&"S        E          (   #00013833' TO DFHEIV0
 15592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15594     MOVE X'2020233030303133383333' TO DFHEIV0(25:11)
 15595     CALL 'kxdfhei1' USING DFHEIV0,
 15596           ELTRLR-DSID,
 15597           DFHEIV20,
 15598           DFHEIV99,
 15599           ELTRLR-KEY,
 15600           DFHEIV99,
 15601           DFHEIV99,
 15602           DFHEIV99
 15603     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15604         DFHEIV20
 15605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15606
 15607
 15608 7910-EXIT.
 15609      EXIT.
 15610
 15611 7915-REWRITE-TRAILER.
 15612
 15613
 15614* EXEC CICS REWRITE
 15615*        DATASET   (ELTRLR-DSID)
 15616*        FROM      (ACTIVITY-TRAILERS)
 15617*    END-EXEC.
 15618     MOVE LENGTH OF
 15619      ACTIVITY-TRAILERS
 15620       TO DFHEIV11
 15621*    MOVE '&& L                  %   #00013844' TO DFHEIV0
 15622     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15623     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15624     MOVE X'2020233030303133383434' TO DFHEIV0(25:11)
 15625     CALL 'kxdfhei1' USING DFHEIV0,
 15626           ELTRLR-DSID,
 15627           ACTIVITY-TRAILERS,
 15628           DFHEIV11,
 15629           DFHEIV99
 15630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 296
* EL130.cbl
 15631
 15632
 15633 7915-EXIT.
 15634      EXIT.
 15635
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 297
* EL130.cbl
 15637********************************************
 15638*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 15639********************************************
 15640
 15641 7920-READ-CLAIM-UPDATE.
 15642
 15643
 15644
 15645* EXEC CICS READ
 15646*        UPDATE
 15647*        DATASET   (ELMSTR-DSID)
 15648*        SET       (ADDRESS OF CLAIM-MASTER)
 15649*        RIDFLD    (ELMSTR-KEY)
 15650*    END-EXEC.
 15651*    MOVE '&"S        EU         (   #00013860' TO DFHEIV0
 15652     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15653     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15654     MOVE X'2020233030303133383630' TO DFHEIV0(25:11)
 15655     CALL 'kxdfhei1' USING DFHEIV0,
 15656           ELMSTR-DSID,
 15657           DFHEIV20,
 15658           DFHEIV99,
 15659           ELMSTR-KEY,
 15660           DFHEIV99,
 15661           DFHEIV99,
 15662           DFHEIV99
 15663     SET ADDRESS OF CLAIM-MASTER TO
 15664         DFHEIV20
 15665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15666
 15667
 15668 7920-EXIT.
 15669      EXIT.
 15670
 15671 7950-READ-CLAIM.
 15672
 15673
 15674* EXEC CICS READ
 15675*        DATASET   (ELMSTR-DSID)
 15676*        SET       (ADDRESS OF CLAIM-MASTER)
 15677*        RIDFLD    (ELMSTR-KEY)
 15678*    END-EXEC.
 15679*    MOVE '&"S        E          (   #00013872' TO DFHEIV0
 15680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15681     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15682     MOVE X'2020233030303133383732' TO DFHEIV0(25:11)
 15683     CALL 'kxdfhei1' USING DFHEIV0,
 15684           ELMSTR-DSID,
 15685           DFHEIV20,
 15686           DFHEIV99,
 15687           ELMSTR-KEY,
 15688           DFHEIV99,
 15689           DFHEIV99,
 15690           DFHEIV99
 15691     SET ADDRESS OF CLAIM-MASTER TO
 15692         DFHEIV20
 15693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15694
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 298
* EL130.cbl
 15695
 15696 7950-EXIT.
 15697      EXIT.
 15698
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 299
* EL130.cbl
 15700***************************************
 15701*  I/O REQUESTS AGAINST CONTROL FILE  *
 15702***************************************
 15703
 15704 7960-READ-CNTL-UPDATE.
 15705
 15706
 15707* EXEC CICS READ
 15708*        UPDATE
 15709*        DATASET  (ELCNTL-DSID)
 15710*        SET      (ADDRESS OF CONTROL-FILE)
 15711*        RIDFLD   (ELCNTL-KEY)
 15712*    END-EXEC.
 15713*    MOVE '&"S        EU         (   #00013888' TO DFHEIV0
 15714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15715     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15716     MOVE X'2020233030303133383838' TO DFHEIV0(25:11)
 15717     CALL 'kxdfhei1' USING DFHEIV0,
 15718           ELCNTL-DSID,
 15719           DFHEIV20,
 15720           DFHEIV99,
 15721           ELCNTL-KEY,
 15722           DFHEIV99,
 15723           DFHEIV99,
 15724           DFHEIV99
 15725     SET ADDRESS OF CONTROL-FILE TO
 15726         DFHEIV20
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15728
 15729
 15730 7960-EXIT.
 15731      EXIT.
 15732
 15733 7970-READ-CNTL.
 15734
 15735
 15736* EXEC CICS READ
 15737*        DATASET  (ELCNTL-DSID)
 15738*        SET      (ADDRESS OF CONTROL-FILE)
 15739*        RIDFLD   (ELCNTL-KEY)
 15740*    END-EXEC.
 15741*    MOVE '&"S        E          (   #00013900' TO DFHEIV0
 15742     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15744     MOVE X'2020233030303133393030' TO DFHEIV0(25:11)
 15745     CALL 'kxdfhei1' USING DFHEIV0,
 15746           ELCNTL-DSID,
 15747           DFHEIV20,
 15748           DFHEIV99,
 15749           ELCNTL-KEY,
 15750           DFHEIV99,
 15751           DFHEIV99,
 15752           DFHEIV99
 15753     SET ADDRESS OF CONTROL-FILE TO
 15754         DFHEIV20
 15755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15756
 15757
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 300
* EL130.cbl
 15758 7970-EXIT.
 15759      EXIT.
 15760
 15761 7975-READ-CNTL-GTEQ.
 15762
 15763
 15764* EXEC CICS READ
 15765*         DATASET   (ELCNTL-DSID)
 15766*         SET       (ADDRESS OF CONTROL-FILE)
 15767*         RIDFLD    (ELCNTL-KEY)
 15768*         GTEQ
 15769*     END-EXEC.
 15770*    MOVE '&"S        G          (   #00013911' TO DFHEIV0
 15771     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15773     MOVE X'2020233030303133393131' TO DFHEIV0(25:11)
 15774     CALL 'kxdfhei1' USING DFHEIV0,
 15775           ELCNTL-DSID,
 15776           DFHEIV20,
 15777           DFHEIV99,
 15778           ELCNTL-KEY,
 15779           DFHEIV99,
 15780           DFHEIV99,
 15781           DFHEIV99
 15782     SET ADDRESS OF CONTROL-FILE TO
 15783         DFHEIV20
 15784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15785
 15786
 15787 7975-EXIT.
 15788      EXIT.
 15789
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 301
* EL130.cbl
 15791**************************************************
 15792*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 15793**************************************************
 15794
 15795 7980-READ-CERT5.
 15796
 15797
 15798* EXEC CICS READ
 15799*         DATASET  (ELCERT5-DSID)
 15800*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15801*         RIDFLD   (ELCERT-KEY-5)
 15802*     END-EXEC.
 15803*    MOVE '&"S        E          (   #00013928' TO DFHEIV0
 15804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15806     MOVE X'2020233030303133393238' TO DFHEIV0(25:11)
 15807     CALL 'kxdfhei1' USING DFHEIV0,
 15808           ELCERT5-DSID,
 15809           DFHEIV20,
 15810           DFHEIV99,
 15811           ELCERT-KEY-5,
 15812           DFHEIV99,
 15813           DFHEIV99,
 15814           DFHEIV99
 15815     SET ADDRESS OF CERTIFICATE-MASTER TO
 15816         DFHEIV20
 15817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15818
 15819
 15820 7980-EXIT.
 15821      EXIT.
 15822
 15823 7930-READ-CERT-UPDATE.
 15824
 15825
 15826* EXEC CICS READ
 15827*        DATASET  (ELCERT-DSID)
 15828*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15829*        RIDFLD   (ELCERT-KEY)
 15830*        UPDATE
 15831*    END-EXEC.
 15832*    MOVE '&"S        EU         (   #00013939' TO DFHEIV0
 15833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15834     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15835     MOVE X'2020233030303133393339' TO DFHEIV0(25:11)
 15836     CALL 'kxdfhei1' USING DFHEIV0,
 15837           ELCERT-DSID,
 15838           DFHEIV20,
 15839           DFHEIV99,
 15840           ELCERT-KEY,
 15841           DFHEIV99,
 15842           DFHEIV99,
 15843           DFHEIV99
 15844     SET ADDRESS OF CERTIFICATE-MASTER TO
 15845         DFHEIV20
 15846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15847
 15848
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 302
* EL130.cbl
 15849 7930-EXIT.
 15850      EXIT.
 15851
 15852 7940-READ-CERT.
 15853
 15854
 15855* EXEC CICS READ
 15856*        DATASET  (ELCERT-DSID)
 15857*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15858*        RIDFLD   (ELCERT-KEY)
 15859*    END-EXEC.
 15860*    MOVE '&"S        E          (   #00013951' TO DFHEIV0
 15861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15863     MOVE X'2020233030303133393531' TO DFHEIV0(25:11)
 15864     CALL 'kxdfhei1' USING DFHEIV0,
 15865           ELCERT-DSID,
 15866           DFHEIV20,
 15867           DFHEIV99,
 15868           ELCERT-KEY,
 15869           DFHEIV99,
 15870           DFHEIV99,
 15871           DFHEIV99
 15872     SET ADDRESS OF CERTIFICATE-MASTER TO
 15873         DFHEIV20
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15875
 15876
 15877 7940-EXIT.
 15878      EXIT.
 15879
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 303
* EL130.cbl
 15881**************************************************
 15882*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 15883**************************************************
 15884
 15885 7991-READ-BENE.
 15886
 15887
 15888* EXEC CICS READ
 15889*         DATASET   (ELBENE-DSID)
 15890*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 15891*         RIDFLD    (ELBENE-KEY)
 15892*     END-EXEC.
 15893*    MOVE '&"S        E          (   #00013967' TO DFHEIV0
 15894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15896     MOVE X'2020233030303133393637' TO DFHEIV0(25:11)
 15897     CALL 'kxdfhei1' USING DFHEIV0,
 15898           ELBENE-DSID,
 15899           DFHEIV20,
 15900           DFHEIV99,
 15901           ELBENE-KEY,
 15902           DFHEIV99,
 15903           DFHEIV99,
 15904           DFHEIV99
 15905     SET ADDRESS OF BENEFICIARY-MASTER TO
 15906         DFHEIV20
 15907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15908
 15909
 15910 7991-EXIT.
 15911      EXIT.
 15912
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 304
* EL130.cbl
 15914**************************************************
 15915*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 15916**************************************************
 15917
 15918 7992-READ-REIN.
 15919
 15920
 15921
 15922* EXEC CICS HANDLE CONDITION
 15923*        NOTFND   (7992-NOT-FOUND)
 15924*    END-EXEC.
 15925*    MOVE '"$I                   ! L #00013984' TO DFHEIV0
 15926     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15928     MOVE X'4C20233030303133393834' TO DFHEIV0(25:11)
 15929     CALL 'kxdfhei1' USING DFHEIV0
 15930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15931
 15932
 15933
 15934
 15935* EXEC CICS READ
 15936*        DATASET   (ERREIN-DSID)
 15937*        SET       (ADDRESS OF REINSURANCE-RECORD)
 15938*        RIDFLD    (ERREIN-KEY)
 15939*    END-EXEC.
 15940*    MOVE '&"S        E          (   #00013989' TO DFHEIV0
 15941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15943     MOVE X'2020233030303133393839' TO DFHEIV0(25:11)
 15944     CALL 'kxdfhei1' USING DFHEIV0,
 15945           ERREIN-DSID,
 15946           DFHEIV20,
 15947           DFHEIV99,
 15948           ERREIN-KEY,
 15949           DFHEIV99,
 15950           DFHEIV99,
 15951           DFHEIV99
 15952     SET ADDRESS OF REINSURANCE-RECORD TO
 15953         DFHEIV20
 15954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15955
 15956
 15957     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 15958
 15959     GO TO 7992-EXIT.
 15960
 15961 7992-NOT-FOUND.
 15962     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 15963
 15964 7992-EXIT.
 15965     EXIT.
 15966
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 305
* EL130.cbl
 15968 8000-LOAD-ERROR-MESSAGES.
 15969     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 15970
 15971     IF EMI-NO-ERRORS
 15972         GO TO 8000-EXIT
 15973     END-IF.
 15974
 15975     perform varying e1 from +1 by +1 until e1 > +3
 15976        if emi-error-number (e1) = '1651' or '1652' or '1653'
 15977                                or '1655' or '1660'
 15978           move 'W'              to emi-severity (e1)
 15979        end-if
 15980     end-perform
 15981     IF EMI-NUMBER-OF-LINES = 1
 15982         MOVE EMI-LINE1          TO ERRMSG1O
 15983         GO TO 8000-EXIT
 15984     END-IF.
 15985
 15986     IF EMI-NUMBER-OF-LINES = 2
 15987          MOVE EMI-LINE1         TO ERRMSG1O
 15988          MOVE EMI-LINE2         TO ERRMSG2O
 15989          GO TO 8000-EXIT
 15990     END-IF.
 15991
 15992     MOVE EMI-LINE1              TO ERRMSG1O.
 15993
 15994 8000-EXIT.
 15995     EXIT.
 15996
 15997 8100-SEND-INITIAL-MAP.
 15998     MOVE SAVE-DATE              TO RUNDTEO.
 15999     MOVE EIBTIME                TO TIME-IN.
 16000     MOVE TIME-OUT               TO RUNTIMEO.
 16001     IF RETURNED-FROM = XCTL-114
 16002        CONTINUE
 16003     ELSE
 16004        MOVE -1                  TO MAINTL
 16005     END-IF.
 16006
 16007*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16008         MOVE SPACES             TO PRODO.
 16009         MOVE AL-SANOF           TO PRODCDA.
 16010*    END-IF.
 16011
 16012     MOVE PI-COMPANY-ID          TO COMPO.
 16013     MOVE AL-PABOF               TO COMPA.
 16014     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16015     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16016     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16017
 16018     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16019
 16020     IF NOT PI-NO-CARRIER-SECURITY
 16021        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16022        MOVE AL-SABOF            TO CLMCARRA
 16023     END-IF.
 16024
 16025     IF PI-PROCESSOR-ID = 'PEMA'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 306
* EL130.cbl
 16026        MOVE AL-UANON            TO CERTNOA
 16027                                    SUFXA
 16028     END-IF.
 16029*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16030*        NEXT SENTENCE
 16031*        CONTINUE
 16032*    ELSE
 16033         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16034*    END-IF.
 16035
 16036
 16037
 16038* EXEC CICS SEND
 16039*        MAP     (MAP-NAME)
 16040*        MAPSET  (MAPSET-NAME)
 16041*        FROM    (EL130AO)
 16042*        ERASE
 16043*        CURSOR
 16044*    END-EXEC.
 16045     MOVE LENGTH OF
 16046      EL130AO
 16047       TO DFHEIV12
 16048     MOVE -1
 16049       TO DFHEIV11
 16050*    MOVE '8$     CT  E    H L F ,   #00014075' TO DFHEIV0
 16051     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16052     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16053     MOVE X'2020233030303134303735' TO DFHEIV0(25:11)
 16054     CALL 'kxdfhei1' USING DFHEIV0,
 16055           MAP-NAME,
 16056           EL130AO,
 16057           DFHEIV12,
 16058           MAPSET-NAME,
 16059           DFHEIV99,
 16060           DFHEIV99,
 16061           DFHEIV99,
 16062           DFHEIV11,
 16063           DFHEIV99,
 16064           DFHEIV99,
 16065           DFHEIV99
 16066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16067
 16068
 16069     GO TO 9100-RETURN-TRAN.
 16070
 16071 8150-SEND-MAP-CURSOR.
 16072     MOVE SAVE-DATE              TO RUNDTEO.
 16073     MOVE EIBTIME                TO TIME-IN.
 16074     MOVE TIME-OUT               TO RUNTIMEO.
 16075     MOVE PI-COMPANY-ID          TO COMPO.
 16076     MOVE AL-PABOF               TO COMPA
 16077     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16078     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16079     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16080
 16081*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16082         MOVE SPACES             TO PRODO.
 16083         MOVE AL-SANOF           TO PRODCDA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 307
* EL130.cbl
 16084*    END-IF.
 16085
 16086     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16087
 16088     IF NOT PI-NO-CARRIER-SECURITY
 16089         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16090         MOVE AL-SABOF            TO CLMCARRA
 16091     END-IF.
 16092
 16093     IF PI-PROCESSOR-ID = 'PEMA'
 16094        MOVE AL-UANON            TO CERTNOA
 16095                                    SUFXA
 16096     END-IF.
 16097*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16098*        NEXT SENTENCE
 16099*        CONTINUE
 16100*    ELSE
 16101         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16102*    END-IF.
 16103
 16104
 16105
 16106* EXEC CICS SEND
 16107*        MAP      (MAP-NAME)
 16108*        MAPSET   (MAPSET-NAME)
 16109*        FROM     (EL130AO)
 16110*        CURSOR   (PI-CURSOR)
 16111*        ERASE
 16112*    END-EXEC.
 16113     MOVE LENGTH OF
 16114      EL130AO
 16115       TO DFHEIV11
 16116*    MOVE '8$     CT  E    H L F ,   #00014119' TO DFHEIV0
 16117     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16118     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16119     MOVE X'2020233030303134313139' TO DFHEIV0(25:11)
 16120     CALL 'kxdfhei1' USING DFHEIV0,
 16121           MAP-NAME,
 16122           EL130AO,
 16123           DFHEIV11,
 16124           MAPSET-NAME,
 16125           DFHEIV99,
 16126           DFHEIV99,
 16127           DFHEIV99,
 16128           PI-CURSOR,
 16129           DFHEIV99,
 16130           DFHEIV99,
 16131           DFHEIV99
 16132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16133
 16134
 16135     GO TO 9100-RETURN-TRAN.
 16136
 16137 8200-SEND-DATAONLY.
 16138     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16139
 16140     IF EIBAID = DFHPF11
 16141        MOVE 'Y'                 TO EMI-ROLL-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 308
* EL130.cbl
 16142        move pi-last-claim       to emi-claim-no
 16143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16144        go to 8100-send-initial-map
 16145     END-IF.
 16146
 16147 8200-BYPASS-ERROR.
 16148     MOVE SAVE-DATE              TO RUNDTEO.
 16149     MOVE EIBTIME                TO TIME-IN.
 16150     MOVE TIME-OUT               TO RUNTIMEO.
 16151     MOVE PI-COMPANY-ID          TO COMPO.
 16152     MOVE AL-PABOF               TO COMPA
 16153     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16154
 16155*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16156         MOVE SPACES             TO PRODO.
 16157         MOVE AL-SANOF           TO PRODCDA.
 16158*    END-IF.
 16159
 16160     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16161     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16162
 16163     IF PI-PROCESSOR-ID = 'PEMA'
 16164        MOVE AL-UANON            TO CERTNOA
 16165                                    SUFXA
 16166     END-IF.
 16167     IF NOT PI-NO-CARRIER-SECURITY
 16168        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16169        MOVE AL-SABOF            TO CLMCARRA
 16170     END-IF.
 16171
 16172*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16173*        NEXT SENTENCE
 16174*        CONTINUE
 16175*    ELSE
 16176         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16177*    END-IF.
 16178
 16179*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16180         MOVE AL-SANOF           TO PRODCDA.
 16181*    END-IF.
 16182
 16183
 16184
 16185* EXEC CICS SEND
 16186*        MAP      (MAP-NAME)
 16187*        MAPSET   (MAPSET-NAME)
 16188*        FROM     (EL130AO)
 16189*        DATAONLY
 16190*        CURSOR
 16191*    END-EXEC.
 16192     MOVE LENGTH OF
 16193      EL130AO
 16194       TO DFHEIV12
 16195     MOVE -1
 16196       TO DFHEIV11
 16197*    MOVE '8$D    CT       H L F ,   #00014176' TO DFHEIV0
 16198     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16199     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 309
* EL130.cbl
 16200     MOVE X'2020233030303134313736' TO DFHEIV0(25:11)
 16201     CALL 'kxdfhei1' USING DFHEIV0,
 16202           MAP-NAME,
 16203           EL130AO,
 16204           DFHEIV12,
 16205           MAPSET-NAME,
 16206           DFHEIV99,
 16207           DFHEIV99,
 16208           DFHEIV99,
 16209           DFHEIV11,
 16210           DFHEIV99,
 16211           DFHEIV99,
 16212           DFHEIV99
 16213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16214
 16215
 16216     GO TO 9100-RETURN-TRAN.
 16217
 16218 8300-SEND-TEXT.
 16219
 16220
 16221* EXEC CICS SEND TEXT
 16222*        FROM     (LOGOFF-TEXT)
 16223*        LENGTH   (LOGOFF-LENGTH)
 16224*        ERASE
 16225*        FREEKB
 16226*    END-EXEC.
 16227*    MOVE '8&      T  E F  H   F -   #00014188' TO DFHEIV0
 16228     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16229     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16230     MOVE X'2020233030303134313838' TO DFHEIV0(25:11)
 16231     CALL 'kxdfhei1' USING DFHEIV0,
 16232           LOGOFF-TEXT,
 16233           LOGOFF-LENGTH,
 16234           DFHEIV99,
 16235           DFHEIV99,
 16236           DFHEIV99,
 16237           DFHEIV99,
 16238           DFHEIV99,
 16239           DFHEIV99,
 16240           DFHEIV99,
 16241           DFHEIV99,
 16242           DFHEIV99,
 16243           DFHEIV99
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246
 16247
 16248
 16249* EXEC CICS RETURN
 16250*    END-EXEC.
 16251*    MOVE '.(                    ''   #00014196' TO DFHEIV0
 16252     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16254     MOVE X'2020233030303134313936' TO DFHEIV0(25:11)
 16255     CALL 'kxdfhei1' USING DFHEIV0,
 16256           DFHEIV99,
 16257           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 310
* EL130.cbl
 16258           DFHEIV99,
 16259           DFHEIV99,
 16260           DFHEIV99,
 16261           DFHEIV99
 16262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16263
 16264
 16265 8800-UNAUTHORIZED-ACCESS.
 16266     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16267     GO TO 8300-SEND-TEXT.
 16268
 16269 8810-PF23.
 16270     MOVE EIBAID TO PI-ENTRY-CD-1.
 16271     MOVE XCTL-005               TO PGM-NAME.
 16272     GO TO 9300-XCTL.
 16273
 16274 8820-TERM-ERROR.
 16275     MOVE ER-0412                TO EMI-ERROR.
 16276     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16277     MOVE -1                     TO MAINTL.
 16278     GO TO 8200-SEND-DATAONLY.
 16279
 16280 8830-TRAN-ERROR.
 16281     MOVE ER-0413                TO EMI-ERROR.
 16282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16283     MOVE -1                     TO MAINTL.
 16284     GO TO 8200-SEND-DATAONLY.
 16285
 16286 9000-RETURN-CICS.
 16287
 16288
 16289* EXEC CICS RETURN
 16290*    END-EXEC.
 16291*    MOVE '.(                    ''   #00014222' TO DFHEIV0
 16292     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16293     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16294     MOVE X'2020233030303134323232' TO DFHEIV0(25:11)
 16295     CALL 'kxdfhei1' USING DFHEIV0,
 16296           DFHEIV99,
 16297           DFHEIV99,
 16298           DFHEIV99,
 16299           DFHEIV99,
 16300           DFHEIV99,
 16301           DFHEIV99
 16302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16303
 16304
 16305 9100-RETURN-TRAN.
 16306     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16307     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16308
 16309
 16310
 16311* EXEC CICS RETURN
 16312*        TRANSID   (TRANS-ID)
 16313*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16314*        LENGTH    (PI-COMM-LENGTH)
 16315*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 311
* EL130.cbl
 16316*    MOVE '.(CT                  ''   #00014230' TO DFHEIV0
 16317     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16318     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16319     MOVE X'2020233030303134323330' TO DFHEIV0(25:11)
 16320     CALL 'kxdfhei1' USING DFHEIV0,
 16321           TRANS-ID,
 16322           PROGRAM-INTERFACE-BLOCK,
 16323           PI-COMM-LENGTH,
 16324           DFHEIV99,
 16325           DFHEIV99,
 16326           DFHEIV99
 16327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16328
 16329
 16330 9200-RETURN-MAIN-MENU.
 16331     MOVE XCTL-126               TO PGM-NAME.
 16332     GO TO 9300-XCTL.
 16333
 16334 9300-XCTL.
 16335
 16336
 16337* EXEC CICS XCTL
 16338*        PROGRAM   (PGM-NAME)
 16339*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16340*        LENGTH    (PI-COMM-LENGTH)
 16341*    END-EXEC.
 16342*    MOVE '.$C                   %   #00014242' TO DFHEIV0
 16343     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16344     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16345     MOVE X'2020233030303134323432' TO DFHEIV0(25:11)
 16346     CALL 'kxdfhei1' USING DFHEIV0,
 16347           PGM-NAME,
 16348           PROGRAM-INTERFACE-BLOCK,
 16349           PI-COMM-LENGTH,
 16350           DFHEIV99
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
 16354 9400-CLEAR.
 16355     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16356     GO TO 9300-XCTL.
 16357
 16358 9500-PF12.
 16359     MOVE XCTL-010               TO PGM-NAME.
 16360     GO TO 9300-XCTL.
 16361
 16362 9600-PGMID-ERROR.
 16363
 16364
 16365* EXEC CICS HANDLE CONDITION
 16366*        PGMIDERR  (8300-SEND-TEXT)
 16367*    END-EXEC.
 16368*    MOVE '"$L                   ! M #00014258' TO DFHEIV0
 16369     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16371     MOVE X'4D20233030303134323538' TO DFHEIV0(25:11)
 16372     CALL 'kxdfhei1' USING DFHEIV0
 16373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 312
* EL130.cbl
 16374
 16375
 16376     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16377     MOVE ' '                    TO PI-ENTRY-CD-1.
 16378     MOVE XCTL-005               TO PGM-NAME.
 16379     MOVE PGM-NAME               TO LOGOFF-PGM.
 16380     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16381     GO TO 9300-XCTL.
 16382
 16383 9700-LINK-DATE-CONVERT.
 16384     MOVE LINK-ELDATCV           TO PGM-NAME.
 16385
 16386
 16387* EXEC CICS LINK
 16388*        PROGRAM    (PGM-NAME)
 16389*        COMMAREA   (DATE-CONVERSION-DATA)
 16390*        LENGTH     (DC-COMM-LENGTH)
 16391*    END-EXEC.
 16392*    MOVE '."C                   (   #00014272' TO DFHEIV0
 16393     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16395     MOVE X'2020233030303134323732' TO DFHEIV0(25:11)
 16396     CALL 'kxdfhei1' USING DFHEIV0,
 16397           PGM-NAME,
 16398           DATE-CONVERSION-DATA,
 16399           DC-COMM-LENGTH,
 16400           DFHEIV99,
 16401           DFHEIV99,
 16402           DFHEIV99,
 16403           DFHEIV99
 16404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16405
 16406
 16407 9700-EXIT.
 16408     EXIT.
 16409
 16410 9800-LINK-REM-TERM.
 16411     MOVE LINK-ELRTRM            TO PGM-NAME.
 16412
 16413
 16414* EXEC CICS LINK
 16415*        PROGRAM    (PGM-NAME)
 16416*        COMMAREA   (CALCULATION-PASS-AREA)
 16417*        LENGTH     (CP-COMM-LENGTH)
 16418*    END-EXEC.
 16419*    MOVE '."C                   (   #00014284' TO DFHEIV0
 16420     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16421     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16422     MOVE X'2020233030303134323834' TO DFHEIV0(25:11)
 16423     CALL 'kxdfhei1' USING DFHEIV0,
 16424           PGM-NAME,
 16425           CALCULATION-PASS-AREA,
 16426           CP-COMM-LENGTH,
 16427           DFHEIV99,
 16428           DFHEIV99,
 16429           DFHEIV99,
 16430           DFHEIV99
 16431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 313
* EL130.cbl
 16432
 16433
 16434 9800-EXIT.
 16435     EXIT.
 16436
 16437 9900-ERROR-FORMAT.
 16438*    if emi-error = 1651 or 1652 or 1653 or 1655
 16439*       display ' 9900 error ' emi-error
 16440*       display emi-message-area (1)
 16441*       display emi-message-area (2)
 16442*       display emi-message-area (3)
 16443*    end-if
 16444     IF NOT EMI-ERRORS-COMPLETE
 16445         MOVE LINK-001           TO PGM-NAME
 16446
 16447* EXEC CICS LINK
 16448*            PROGRAM   (PGM-NAME)
 16449*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16450*            LENGTH    (EMI-COMM-LENGTH)
 16451*        END-EXEC
 16452*    MOVE '."C                   (   #00014302' TO DFHEIV0
 16453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16455     MOVE X'2020233030303134333032' TO DFHEIV0(25:11)
 16456     CALL 'kxdfhei1' USING DFHEIV0,
 16457           PGM-NAME,
 16458           ERROR-MESSAGE-INTERFACE-BLOCK,
 16459           EMI-COMM-LENGTH,
 16460           DFHEIV99,
 16461           DFHEIV99,
 16462           DFHEIV99,
 16463           DFHEIV99
 16464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16465         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16466            subtract 1 from emi-fatal-ctr
 16467         end-if
 16468     END-IF.
 16469
 16470     .
 16471 9900-EXIT.
 16472     EXIT.
 16473
 16474 9990-ABEND.
 16475     MOVE -1                     TO MAINTL.
 16476     MOVE LINK-004               TO PGM-NAME.
 16477     MOVE DFHEIBLK               TO EMI-LINE1.
 16478
 16479
 16480* EXEC CICS LINK
 16481*        PROGRAM   (PGM-NAME)
 16482*        COMMAREA  (EMI-LINE1)
 16483*        LENGTH    (72)
 16484*    END-EXEC.
 16485     MOVE 72
 16486       TO DFHEIV11
 16487*    MOVE '."C                   (   #00014321' TO DFHEIV0
 16488     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 314
* EL130.cbl
 16490     MOVE X'2020233030303134333231' TO DFHEIV0(25:11)
 16491     CALL 'kxdfhei1' USING DFHEIV0,
 16492           PGM-NAME,
 16493           EMI-LINE1,
 16494           DFHEIV11,
 16495           DFHEIV99,
 16496           DFHEIV99,
 16497           DFHEIV99,
 16498           DFHEIV99
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502     MOVE EMI-LINE1              TO ERRMSG2O.
 16503
 16504     GO TO 8200-BYPASS-ERROR.
 16505
 16506
 16507
 16508* GOBACK.
 16509     MOVE '9%                    "   ' TO DFHEIV0
 16510     MOVE 'EL130' TO DFHEIV1
 16511     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16512     GOBACK.
 16513
 16514 9995-SECURITY-VIOLATION.
 16515*             COPY ELCSCTP.
 16516******************************************************************
 16517*                                                                *
 16518*                            ELCSCTP                             *
 16519*                            VMOD=2.001                          *
 16520*                                                                *
 16521*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16522******************************************************************
 16523
 16524
 16525     MOVE EIBDATE          TO SM-JUL-DATE.
 16526     MOVE EIBTRMID         TO SM-TERMID.
 16527     MOVE THIS-PGM         TO SM-PGM.
 16528     MOVE EIBTIME          TO TIME-IN.
 16529     MOVE TIME-OUT         TO SM-TIME.
 16530     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16531
 16532
 16533* EXEC CICS LINK
 16534*         PROGRAM  ('EL003')
 16535*         COMMAREA (SECURITY-MESSAGE)
 16536*         LENGTH   (80)
 16537*    END-EXEC.
 16538     MOVE 'EL003' TO DFHEIV1
 16539     MOVE 80
 16540       TO DFHEIV11
 16541*    MOVE '."C                   (   #00014352' TO DFHEIV0
 16542     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16544     MOVE X'2020233030303134333532' TO DFHEIV0(25:11)
 16545     CALL 'kxdfhei1' USING DFHEIV0,
 16546           DFHEIV1,
 16547           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 315
* EL130.cbl
 16548           DFHEIV11,
 16549           DFHEIV99,
 16550           DFHEIV99,
 16551           DFHEIV99,
 16552           DFHEIV99
 16553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16554
 16555
 16556******************************************************************
 16557
 16558
 16559 9995-EXIT.
 16560     EXIT.
 16561
 16562
 16563 9999-DFHBACK SECTION.
 16564     MOVE '9%                    "   ' TO DFHEIV0
 16565     MOVE 'EL130' TO DFHEIV1
 16566     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16567     GOBACK.
 16568 9999-DFHEXIT.
 16569     IF DFHEIGDJ EQUAL 0001
 16570         NEXT SENTENCE
 16571     ELSE IF DFHEIGDJ EQUAL 2
 16572         GO TO 0100-TEST-ENTRY,
 16573               8100-SEND-INITIAL-MAP,
 16574               9600-PGMID-ERROR,
 16575               8820-TERM-ERROR,
 16576               8830-TRAN-ERROR,
 16577               9990-ABEND
 16578         DEPENDING ON DFHEIGDI
 16579     ELSE IF DFHEIGDJ EQUAL 3
 16580         GO TO 0450-ADD-ELACTQ-RECORD
 16581         DEPENDING ON DFHEIGDI
 16582     ELSE IF DFHEIGDJ EQUAL 4
 16583         GO TO 8820-TERM-ERROR,
 16584               8830-TRAN-ERROR
 16585         DEPENDING ON DFHEIGDI
 16586     ELSE IF DFHEIGDJ EQUAL 5
 16587         GO TO 0660-NOT-FOUND,
 16588               0670-QIDERR
 16589         DEPENDING ON DFHEIGDI
 16590     ELSE IF DFHEIGDJ EQUAL 6
 16591         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16592         DEPENDING ON DFHEIGDI
 16593     ELSE IF DFHEIGDJ EQUAL 7
 16594         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16595         DEPENDING ON DFHEIGDI
 16596     ELSE IF DFHEIGDJ EQUAL 8
 16597         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16598         DEPENDING ON DFHEIGDI
 16599     ELSE IF DFHEIGDJ EQUAL 9
 16600         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16601         DEPENDING ON DFHEIGDI
 16602     ELSE IF DFHEIGDJ EQUAL 10
 16603         GO TO 2050-DELETE-NOT-FOUND
 16604         DEPENDING ON DFHEIGDI
 16605     ELSE IF DFHEIGDJ EQUAL 11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 316
* EL130.cbl
 16606         GO TO 2010-DELETE-CL
 16607         DEPENDING ON DFHEIGDI
 16608     ELSE IF DFHEIGDJ EQUAL 12
 16609         GO TO 3010-TEST-FOR-ERRORS
 16610         DEPENDING ON DFHEIGDI
 16611     ELSE IF DFHEIGDJ EQUAL 13
 16612         GO TO 3008-DUP-ERROR,
 16613               3009-NOT-FOUND
 16614         DEPENDING ON DFHEIGDI
 16615     ELSE IF DFHEIGDJ EQUAL 14
 16616         GO TO 3030-BUILD-CONT
 16617         DEPENDING ON DFHEIGDI
 16618     ELSE IF DFHEIGDJ EQUAL 15
 16619         GO TO 3033-ACCT-NOT-FOUND,
 16620               3033-ACCT-NOT-FOUND
 16621         DEPENDING ON DFHEIGDI
 16622     ELSE IF DFHEIGDJ EQUAL 16
 16623         GO TO 3032-NOT-IN-DT-RANGE
 16624         DEPENDING ON DFHEIGDI
 16625     ELSE IF DFHEIGDJ EQUAL 17
 16626         GO TO 3070-BUILD-CONT
 16627         DEPENDING ON DFHEIGDI
 16628     ELSE IF DFHEIGDJ EQUAL 18
 16629         GO TO 3065-CERT-NOT-FOUND
 16630         DEPENDING ON DFHEIGDI
 16631     ELSE IF DFHEIGDJ EQUAL 19
 16632         GO TO 3100-CARRIER-NOT-FOUND
 16633         DEPENDING ON DFHEIGDI
 16634     ELSE IF DFHEIGDJ EQUAL 20
 16635         GO TO 3110-COMPANY-NOT-FOUND
 16636         DEPENDING ON DFHEIGDI
 16637     ELSE IF DFHEIGDJ EQUAL 21
 16638         GO TO 3200-BUILD-ZERO-TRAILER
 16639         DEPENDING ON DFHEIGDI
 16640     ELSE IF DFHEIGDJ EQUAL 22
 16641         GO TO 9999-DFHBACK
 16642         DEPENDING ON DFHEIGDI
 16643     ELSE IF DFHEIGDJ EQUAL 23
 16644         GO TO 3290-NO-INSURED-ADDRESS
 16645         DEPENDING ON DFHEIGDI
 16646     ELSE IF DFHEIGDJ EQUAL 24
 16647         GO TO 3410-DUP-KEY
 16648         DEPENDING ON DFHEIGDI
 16649     ELSE IF DFHEIGDJ EQUAL 25
 16650         GO TO 3690-CERT-WRITTEN
 16651         DEPENDING ON DFHEIGDI
 16652     ELSE IF DFHEIGDJ EQUAL 26
 16653         GO TO 3850-CLAIM-MSTR-WRITTEN
 16654         DEPENDING ON DFHEIGDI
 16655     ELSE IF DFHEIGDJ EQUAL 27
 16656         GO TO 5050-CERT-NOT-FOUND
 16657         DEPENDING ON DFHEIGDI
 16658     ELSE IF DFHEIGDJ EQUAL 28
 16659         GO TO 5030-CERT-WRITTEN
 16660         DEPENDING ON DFHEIGDI
 16661     ELSE IF DFHEIGDJ EQUAL 29
 16662         GO TO 5035-CLAIM-WRITTEN
 16663         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 317
* EL130.cbl
 16664     ELSE IF DFHEIGDJ EQUAL 30
 16665         GO TO 9990-ABEND,
 16666               5799-EXIT
 16667         DEPENDING ON DFHEIGDI
 16668     ELSE IF DFHEIGDJ EQUAL 31
 16669         GO TO 3100-CARRIER-NOT-FOUND
 16670         DEPENDING ON DFHEIGDI
 16671     ELSE IF DFHEIGDJ EQUAL 32
 16672         GO TO 6040-NO-PROCESSOR-RECORD
 16673         DEPENDING ON DFHEIGDI
 16674     ELSE IF DFHEIGDJ EQUAL 33
 16675         GO TO 6060-NO-BENEFICIARY-RECORD
 16676         DEPENDING ON DFHEIGDI
 16677     ELSE IF DFHEIGDJ EQUAL 34
 16678         GO TO 6499-EXIT,
 16679               6499-EXIT
 16680         DEPENDING ON DFHEIGDI
 16681     ELSE IF DFHEIGDJ EQUAL 35
 16682         GO TO 6600-NOT-FOUND
 16683         DEPENDING ON DFHEIGDI
 16684     ELSE IF DFHEIGDJ EQUAL 36
 16685         GO TO 6700-NOTOPEN-ERROR,
 16686               6700-EXIT
 16687         DEPENDING ON DFHEIGDI
 16688     ELSE IF DFHEIGDJ EQUAL 37
 16689         GO TO 7120-NOT-FOUND
 16690         DEPENDING ON DFHEIGDI
 16691     ELSE IF DFHEIGDJ EQUAL 38
 16692         GO TO 7499-EXIT
 16693         DEPENDING ON DFHEIGDI
 16694     ELSE IF DFHEIGDJ EQUAL 39
 16695         GO TO 7500-EXIT,
 16696               7500-DUPLICATE-KEY,
 16697               7500-EXIT
 16698         DEPENDING ON DFHEIGDI
 16699     ELSE IF DFHEIGDJ EQUAL 40
 16700         GO TO 7500-END-BROWSE
 16701         DEPENDING ON DFHEIGDI
 16702     ELSE IF DFHEIGDJ EQUAL 41
 16703         GO TO 7630-END-BROWSE
 16704         DEPENDING ON DFHEIGDI
 16705     ELSE IF DFHEIGDJ EQUAL 42
 16706         GO TO 7799-EXIT,
 16707               7799-EXIT
 16708         DEPENDING ON DFHEIGDI
 16709     ELSE IF DFHEIGDJ EQUAL 43
 16710         GO TO 7790-END-BROWSE
 16711         DEPENDING ON DFHEIGDI
 16712     ELSE IF DFHEIGDJ EQUAL 44
 16713         GO TO 7992-NOT-FOUND
 16714         DEPENDING ON DFHEIGDI
 16715     ELSE IF DFHEIGDJ EQUAL 45
 16716         GO TO 8300-SEND-TEXT
 16717         DEPENDING ON DFHEIGDI.
 16718     MOVE '9%                    "   ' TO DFHEIV0
 16719     MOVE 'EL130' TO DFHEIV1
 16720     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16721     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:04 Page 318
* EL130.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12152     Code:       53026
