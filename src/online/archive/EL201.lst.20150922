* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31 environment division.
    32 INPUT-OUTPUT SECTION.
    33 FILE-CONTROL.
    34 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    35    FILE STATUS IS WRITTEN-STATUS
    36                            ORGANIZATION IS LINE SEQUENTIAL.
    37 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    38    FILE STATUS IS WRITRPT-STATUS
    39                            ORGANIZATION IS LINE SEQUENTIAL.
    40 data division.
    41 FILE SECTION.
    42 FD  CPS-WRITTEN-IN
    43     BLOCK CONTAINS 0
    44     RECORDING MODE F.
    45 01  CPS-WRITTEN-IN-REC          pic x(200).
    46 FD  CPS-WRITTEN-RPT
    47     BLOCK CONTAINS 0
    48     RECORDING MODE F.
    49 01  CPS-WRITTEN-RPT-REC         pic x(132).
    50 working-storage section.
    51 01  DFH-START PIC X(04).
    52 77  ws-process-sw               pic x value ' '.
    53     88  process-cashed            value 'C'.
    54     88  process-written           value 'W'.
    55 77  ws-writ-cnt                 pic 9(5) value zeros.
    56 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    57 77  s1                          pic s999 comp-3 value +0.
    58 77  s2                          pic s999 comp-3 value +0.
    59 77  i1                          pic s999 comp-3 value +0.
    60 77  o1                          pic s999 comp-3 value +0.
    61 77  ws-bin-cashed-dt            pic xx  value low-values.
    62 77  ws-bin-check-dt             pic xx  value low-values.
    63 77  ws-page-cntr                pic 999  value zeros.
    64 77  ws-line-cntr                pic 999  value 070.
    65 77  ws-max-lines                pic 999  value 060.
    66 77  ws-erchek-sw                pic x    value spaces.
    67     88  erchek-found              value 'Y'.
    68 77  ws-table-sw                 pic x    value spaces.
    69     88  table-found               value 'Y'.
    70 77  ws-continue-sw              pic x  value 'Y'.
    71     88  ok-to-continue            value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   3
* EL201.cbl
    72     88  not-ok-to-continue        value 'N'.
    73 77  ws-in-recs                  pic 9(5) value zeros.
    74 77  ws-eof-sw                   pic x  value spaces.
    75     88  end-of-input                  value 'Y'.
    76 77  ws-sql-code                 pic s9(7) value zeros.
    77 77  ws-dis-sql-code             pic -9999999 value zeros.
    78 01  ws-written-in.
    79     05  ws-writ-in-dir          pic x(15)  value
    80         '/data/seqfiles/'.
    81*    05  ws-writ-in-dir          pic x(26)  value
    82*        '/data/test/mdoff/seqfiles/'.
    83     05  ws-writ-in-name         pic x(16) value
    84         'miscpymts.csv   '.
    85 01  ws-written-rpt.
    86     05  ws-writ-rpt-dir         pic x(15)  value
    87         '/data/seqfiles/'.
    88*    05  ws-writ-rpt-dir         pic x(26)  value
    89*        '/data/test/mdoff/seqfiles/'.
    90     05  ws-writ-rpt-comp-id     pic xxx  value spaces.
    91     05  ws-writ-rpt-name        pic x(13) value
    92         'miscpymts.rpt'.
*   93 EXEC SQL
*   94    INCLUDE SQLDA
*   95 END-EXEC
    96 01 SQLDA sync.
    97    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    98    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    99    05 SQLN                  PIC S9(4) COMP-5 value 0.
   100    05 SQLD                  PIC S9(4) COMP-5 value 0.
   101    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   102       10 SQLTYPE            PIC S9(4) COMP-5.
   103       10 SQLLEN             PIC S9(4) COMP-5.
   104$IF P64 SET
   105X      *> For 64-bit environments, ensure that SQLDATA is
   106X      *> aligned on an 8-byte boundary.
   107X      10 FILLER             PIC S9(9) COMP-5.
   108$END
   109       10 SQLDATA            USAGE POINTER.
   110       10 SQLIND             USAGE POINTER.
   111       10 SQLNAME.
   112          15 SQLNAMEL        PIC S9(4) COMP-5.
   113          15 SQLNAMEC        PIC X(30).
   114
   115* Values for SQLTYPE
   116
   117 78  ESQL-DATE-CHAR              VALUE 384.
   118 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   119 78  ESQL-DATE-REC               VALUE 386.
   120 78  ESQL-DATE-REC-NULL          VALUE 387.
   121 78  ESQL-TIME-CHAR              VALUE 388.
   122 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   123 78  ESQL-TIME-REC               VALUE 390.
   124 78  ESQL-TIME-REC-NULL          VALUE 391.
   125 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   126 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   127 78  ESQL-TIMESTAMP-REC          VALUE 394.
   128 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   129 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   131 78  ESQL-TS-OFFSET-REC          VALUE 398.
   132 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   133 78  ESQL-LONGVARBINARY          VALUE 404.
   134 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   135 78  ESQL-LONGVARCHAR            VALUE 408.
   136 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   137 78  ESQL-BINARY                 VALUE 444.
   138 78  ESQL-BINARY-NULL            VALUE 445.
   139 78  ESQL-VARBINARY              VALUE 446.
   140 78  ESQL-VARBINARY-NULL         VALUE 447.
   141 78  ESQL-VARCHAR                VALUE 448.
   142 78  ESQL-VARCHAR-NULL           VALUE 449.
   143
   144 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   145 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   146
   147 78  ESQL-CHAR                   VALUE 452.
   148 78  ESQL-CHAR-NULL              VALUE 453.
   149
   150 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   151 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   152
   153 78  ESQL-DOUBLE                 VALUE 480.
   154 78  ESQL-DOUBLE-NULL            VALUE 481.
   155 78  ESQL-REAL                   VALUE 482.
   156 78  ESQL-REAL-NULL              VALUE 483.
   157 78  ESQL-DECIMAL                VALUE 484.
   158 78  ESQL-DECIMAL-NULL           VALUE 485.
   159 78  ESQL-INTEGER                VALUE 496.
   160 78  ESQL-INTEGER-NULL           VALUE 497.
   161 78  ESQL-SMALLINT               VALUE 500.
   162 78  ESQL-SMALLINT-NULL          VALUE 501.
   163 78  ESQL-TINYINT                VALUE 502.
   164 78  ESQL-TINYINT-NULL           VALUE 503.
*  165 EXEC SQL
*  166    INCLUDE SQLCA
*  167 END-EXEC
   168 01 SQLCA.
   169     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   170     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   171     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   172     05  SQLERRM.
   173         49  SQLERRML    PIC S9(4) COMP-5.
   174         49  SQLERRMC    PIC X(70).
   175     05  SQLERRP         PIC X(8).
   176     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   177     05  SQLWARN.
   178         10  SQLWARN0    PIC X.
   179         10  SQLWARN1    PIC X.
   180         10  SQLWARN2    PIC X.
   181         10  SQLWARN3    PIC X.
   182         10  SQLWARN4    PIC X.
   183         10  SQLWARN5    PIC X.
   184         10  SQLWARN6    PIC X.
   185         10  SQLWARN7    PIC X.
   186     05  SQLEXT.
   187         10  SQLWARN8    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN9    PIC X.
   189         10  SQLWARN10   PIC X.
   190         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   191     05  SQLSTATE    PIC X(5).
   192 EXEC SQL
   193    BEGIN DECLARE SECTION
   194 END-EXEC
   195 01  ws-key-stuff.
   196     05  ws-check-key            pic 9(7).
   197     05  ws-check-no             pic x(7).
   198     05  ws-compid               pic xxx.
   199     05  ws-carrier              pic x.
   200     05  ws-grouping             pic x(6).
   201     05  ws-state                pic xx.
   202     05  ws-account              pic x(10).
   203     05  ws-eff-date             pic x(10).
   204     05  ws-certificate          pic x(10).
   205     05  ws-cert-sfx             pic x.
   206     05  ws-seq-no               pic 999.
   207     05  ws-type                 pic 999.
   208 01  sqlcmd                      pic x(1024).
   209 01  WS-MOE-DATE                 pic x(10).
   210 01  svr                         pic x(32).
   211 01  usr                         pic x(32).
   212 01  pass                        pic x(32).
   213 01  usr-pass                    pic x(64).
   214 01  ws-disp-code                pic s9(11).
   215***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   216***                                                            ***
   217***  These indicators are used to determine if a variable      ***
   218***  is passed nulls from sql. The indicator will be -1        ***
   219***  if the value on sql is nulls and +0 if the value is       ***
   220***  something other than nulls. Here is an example on how     ***
   221***  to use the indicator variables.                           ***
   222***                                                            ***
   223***     EXEC SQL                                               ***
   224***        fetch checkapp into                                 ***
   225***           :db-app-status :nu-app-status,                   ***
   226***           :db-app-by     :nu-app-by,                       ***
   227***           :db-app-date   :nu-app-date,                     ***
   228***           :db-app-batch  :nu-app-batch                     ***
   229***     END-EXEC                                               ***
   230***                                                            ***
   231***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   232 01  indicator-vaiables-for-nulls.
   233     05  nu-app-status           pic s9(4) comp value +0.
   234     05  nu-app-by               pic s9(4) comp value +0.
   235     05  nu-app-date             pic s9(4) comp value +0.
   236     05  nu-app-batch            pic s9(4) comp value +0.
   237     05  nu-fincar               pic s9(4) comp value +0.
   238     05  nu-checkno              pic s9(4) comp value +0.
   239 01  daily-check-request-rec.
   240     05  db-checkkey             pic x(7).
   241     05  db-compid               pic xxx.
   242     05  db-carrier              pic x.
   243     05  db-grouping             pic x(6).
   244     05  db-state                pic xx.
   245     05  db-account              pic x(10).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   6
* EL201.cbl
   246     05  db-effdate              pic x(24).
   247     05  db-certificate          pic x(10).
   248     05  db-cert-sfx             pic x.
   249     05  db-seq-no               pic x(7).
   250     05  db-type                 pic x(7).
   251     05  db-amount               pic x(10).
   252     05  db-amount-n redefines
   253         db-amount               pic 9(7).99.
   254     05  db-checkno              pic x(15).
   255     05  db-checkdate            pic x(10).
   256     05  db-checkstatus          pic 9(5).
   257     05  db-releasebatch         pic 9(5).
   258     05  db-releasedt            pic x(10).
   259     05  db-releaseby            pic x(4).
   260     05  db-payeename1           pic x(30).
   261     05  db-payeename2           pic x(30).
   262     05  db-payeeaddr1           pic x(30).
   263     05  db-payeeaddr2           pic x(30).
   264     05  db-payeecity            pic x(30).
   265     05  db-payeest              pic xx.
   266     05  db-payeezip             pic x(10).
   267     05  db-fincar               pic x.
   268     05  db-fingrp               pic x(6).
   269     05  db-finresp              pic x(10).
   270     05  db-finacct              pic x(10).
   271     05  db-preparer             pic x(4).
   272     05  db-app-status           pic x(9).
   273     05  dp-app-status-n redefines db-app-status
   274                                 pic 9(9).
   275     05  db-app-by               pic x(20).
   276     05  db-app-date             pic x(30).
   277     05  db-app-batch            pic x(10).
   278     05  db-return-to            pic x(30).
   279 EXEC SQL
   280    END DECLARE SECTION
   281 END-EXEC
   282 01  FILE-KEYS.
   283     12  ELCNTL-KEY.
   284         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   285         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   286         16 ELCNTL-ACCESS.
   287             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   288             20  FILLER              PIC X       VALUE SPACES.
   289             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   290         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   291 01  f.
   292     05  ws-connect-sw               pic x  value ' '.
   293         88  connected-to-db             value 'Y'.
   294     05  written-status          pic xx.
   295     05  writrpt-status          pic xx.
   296     05  ws-comp-id              pic xxx.
   297     05  ws-comp-cd              pic x.
   298 01  ws-raw-record.
   299     05  raw-check-no            pic x(20).
   300     05  raw-check-dt            pic x(20).
   301     05  raw-check-amt           pic x(15).
   302     05  raw-vendor-id           pic x(20).
   303     05  raw-user-defined        pic x(30).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   7
* EL201.cbl
   304     05  raw-voucher-ref         pic x(35).
   305 01  ws-written-rec.
   306     05  wsw-check-no            pic x(20).
   307     05  wsw-check-dt            pic x(20).
   308     05  wsw-check-amt           pic x(15).
   309     05  wsw-vendor-id           pic x(20).
   310     05  wsw-user-defined        pic x(30).
   311     05  wsw-voucher-ref         pic x(35).
   312 01  filler.
   313     05  wsw-check-key           pic x(7).
   314     05  wsw-check-key-num redefines wsw-check-key
   315                                 pic 9(7).
   316 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   317     88  RESP-NORMAL                    VALUE +0.
   318     88  resp-file-notfnd               value +12.
   319     88  RESP-NOTFND                    VALUE +13.
   320     88  resp-duprec                    value +14.
   321     88  resp-dupkey                    value +15.
   322     88  resp-invreq                    value +16.
   323     88  RESP-NOTOPEN                   VALUE +19.
   324     88  RESP-ENDFILE                   VALUE +20.
   325     88  resp-lengtherr                 value +22.
   326 01  ws-work-amt-alpha           pic x(10).
   327 01  ws-work-amt-num redefines ws-work-amt-alpha
   328                                 pic 9(8)v99.
   329 01  ws-qry-string               pic x(80) value spaces.
   330 01  ws-qrystr-len               pic s9(8) comp value +60.
   331 01  ws-seq-alpha                pic x(5).
   332 01  ws-seq-no-num redefines ws-seq-alpha
   333                                 pic 9(5).
   334*                                copy ERCCHEK.
   335******************************************************************
   336*                                                                *
   337*                                                                *
   338*                            ERCCHEK                             *
   339*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   340*                            VMOD=2.008                          *
   341*                                                                *
   342*   FILE DESCRIPTION = CHECK RECORDS                             *
   343*                                                                *
   344*   FILE TYPE = VSAM,KSDS                                        *
   345*   RECORD SIZE = 600    RECFORM = FIXED                         *
   346*                                                                *
   347*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   348*       ALTERNATE INDEX = NONE                                   *
   349*                                                                *
   350*   LOG = YES                                                    *
   351*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   352******************************************************************
   353*                   C H A N G E   L O G
   354*
   355* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   356*-----------------------------------------------------------------
   357*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   358* EFFECTIVE    NUMBER
   359*-----------------------------------------------------------------
   360* 021414    2003053000001  PEMA  changes for auto chk request
   361******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   8
* EL201.cbl
   362 01  CHECK-RECORDS.
   363     12  CH-RECORD-ID                      PIC XX.
   364         88  VALID-CH-ID                      VALUE 'CH'.
   365
   366     12  CH-CONTROL-PRIMARY.
   367         16  CH-COMPANY-CD                 PIC X.
   368         16  CH-CARRIER                    PIC X.
   369         16  CH-GROUPING                   PIC X(6).
   370         16  CH-STATE                      PIC XX.
   371         16  CH-ACCOUNT                    PIC X(10).
   372         16  CH-CERT-EFF-DT                PIC XX.
   373         16  CH-CERT-NO.
   374             20  CH-CERT-PRIME             PIC X(10).
   375             20  CH-CERT-SFX               PIC X.
   376         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   377
   378     12  CH-RECORDED-DT                    PIC XX.
   379     12  CH-RECORDED-BY                    PIC X(4).
   380     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   381
   382     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   383     12  CH-CHECK-NO                       PIC X(7).
   384     12  CH-REASON-FOR-CHECK               PIC X(25).
   385     12  CH-CHECK-WRITTEN-DT               PIC XX.
   386     12  FILLER                            PIC X.
   387
   388     12  CH-PAYEE-INFO.
   389         16  CH-PAYEE-NAME-1               PIC X(30).
   390         16  CH-PAYEE-NAME-2               PIC X(30).
   391         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   392         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   393         16  CH-PAYEE-CITY-ST.
   394             20  CH-PAYEE-CITY             PIC X(28).
   395             20  CH-PAYEE-STATE            PIC XX.
   396         16  CH-PAYEE-ZIP-CODE.
   397             20  CH-PAYEE-ZIP.
   398                 24  CH-ZIP-PRI-1ST        PIC X.
   399                     88  CH-CANADIAN-POST-CODE
   400                                           VALUES 'A' THRU 'Z'.
   401                 24  FILLER                PIC X(4).
   402             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   403         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   404             20  CH-CAN-POSTAL-1           PIC XXX.
   405             20  CH-CAN-POSTAL-2           PIC XXX.
   406             20  FILLER                    PIC XXX.
   407
   408     12  CH-CHECK-STUB-TEXT.
   409         16  CH-STUB-LINE-1                PIC X(30).
   410         16  CH-TEXT-LINE-1                PIC X(50).
   411         16  CH-TEXT-LINE-2                PIC X(50).
   412         16  CH-TEXT-LINE-3                PIC X(40).
   413     12  CH-RETURN-TO                      PIC X(30).
   414
   415     12  CH-COMPENSATION-CONTROL.
   416         16  CH-COMP-CARRIER               PIC X.
   417         16  CH-COMP-GROUPING              PIC X(6).
   418         16  CH-COMP-FIN-RESP              PIC X(10).
   419         16  CH-COMP-ACCOUNT               PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page   9
* EL201.cbl
   420
   421     12  CH-CREDIT-SELECT-DT               PIC XX.
   422     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   423     12  CH-PAYEE-CODE                     PIC X(6).
   424
   425     12  CH-VOID-DATA.
   426         20  CH-VOID-DT                    PIC XX.
   427         20  CH-VOID-BY                    PIC X(4).
   428         20  CH-VOID-REASON                PIC X(25).
   429
   430     12  CH-APPROVAL-DATA.
   431         20  CH-APPROVAL-DT                PIC XX.
   432         20  CH-APPROVAL-STATUS            PIC X.
   433             88  CH-IN-LIMBO                  VALUE ' '.
   434             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   435             88  CH-APPROVED                  VALUE 'A'.
   436             88  CH-DENIED                    VALUE 'D'.
   437         20  CH-APPROVED-BY                PIC XXXX.
   438     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   439             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   440     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   441
   442     12  ch-released-dt                    pic xx.
   443     12  ch-check-cashed-dt                pic xx.
   444     12  FILLER                            PIC X.
   445*    12  CH-CHECK-REFERENCE                PIC X(12).
   446     12  CH-CHECK-ORIGIN-SW                PIC X.
   447             88  CH-REFUND-CHECK              VALUE 'R'.
   448             88  CH-MAINT-CHECK               VALUE 'M'.
   449
   450     12  CH-CANC-DT                        PIC XX.
   451     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   452     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   453
   454     12  CH-INSURED-NAME                   PIC X(28).
   455
   456     12  ch-released-by                    pic x(4).
   457     12  ch-csr                            pic x(4).
   458     12  ch-deduct-commission              pic x.
   459         88  ch-deduct-comm                  value 'Y'.
   460         88  ch-do-not-deduct-comm           value 'N'.
   461
   462     12  FILLER                            PIC X(11).
   463*    12  CH-LETTER-TABLE.
   464*        16  CH-LETTERS OCCURS 3 TIMES
   465*                       INDEXED BY CH-LT-NDX
   466*                                          PIC X(04).
   467
   468     12  FILLER                            PIC X(07).
   469
   470*                                copy ELCFUNDT.
   471*****************************************************************
   472*                                                               *
   473*                            ELCFUNDT.                          *
   474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   475*                            VMOD=2.001                         *
   476*                                                               *
   477*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  10
* EL201.cbl
   478*                                                               *
   479*****************************************************************
   480
   481
   482 01  FUNCTION-DATE.
   483     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   484     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   485         10  WS-FN-CCYR            PIC 9(4).
   486         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   487             15  WS-FN-CC          PIC 99.
   488             15  WS-FN-YR          PIC 99.
   489         10  WS-FN-MO              PIC 99.
   490         10  WS-FN-DA              PIC 99.
   491     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   492     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   493     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   494     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   495     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   496         88  WS-BEHIND-GMT                     VALUE '-'.
   497         88  WS-AFTER-GMT                      VALUE '+'.
   498         88  WS-NO-GMT                         VALUE ZERO.
   499     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   500     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   501*                                COPY ELCDATE.
   502******************************************************************
   503*                                                                *
   504*                                                                *
   505*                            ELCDATE.                            *
   506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   507*                            VMOD=2.003
   508*                                                                *
   509*                                                                *
   510*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   511*                 LENGTH = 200                                   *
   512******************************************************************
   513
   514 01  DATE-CONVERSION-DATA.
   515     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   516     12  DC-OPTION-CODE                PIC X.
   517         88  BIN-TO-GREG                VALUE ' '.
   518         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   519         88  EDIT-GREG-TO-BIN           VALUE '2'.
   520         88  YMD-GREG-TO-BIN            VALUE '3'.
   521         88  MDY-GREG-TO-BIN            VALUE '4'.
   522         88  JULIAN-TO-BIN              VALUE '5'.
   523         88  BIN-PLUS-ELAPSED           VALUE '6'.
   524         88  FIND-CENTURY               VALUE '7'.
   525         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   526         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   527         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   528         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   529         88  JULIAN-TO-BIN-3            VALUE 'C'.
   530         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   531         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   532         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   533         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   534         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   535         88  CHECK-LEAP-YEAR            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  11
* EL201.cbl
   536         88  BIN-3-TO-GREG              VALUE 'I'.
   537         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   538         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   539         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   540         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   541         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   542         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   543         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   544         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   545         88  THREE-CHARACTER-BIN
   546                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   547         88  GREGORIAN-TO-BIN
   548                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   549         88  BIN-TO-GREGORIAN
   550                  VALUES ' ' '1' 'I' '8' 'G'.
   551         88  JULIAN-TO-BINARY
   552                  VALUES '5' 'C' 'E' 'F'.
   553     12  DC-ERROR-CODE                 PIC X.
   554         88  NO-CONVERSION-ERROR        VALUE ' '.
   555         88  DATE-CONVERSION-ERROR
   556                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   557         88  DATE-IS-ZERO               VALUE '1'.
   558         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   559         88  DATE-IS-INVALID            VALUE '3'.
   560         88  DATE1-GREATER-DATE2        VALUE '4'.
   561         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   562         88  DATE-INVALID-OPTION        VALUE '9'.
   563         88  INVALID-CENTURY            VALUE 'A'.
   564         88  ONLY-CENTURY               VALUE 'B'.
   565         88  ONLY-LEAP-YEAR             VALUE 'C'.
   566         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   567     12  DC-END-OF-MONTH               PIC X.
   568         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   569     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   570         88  USE-NORMAL-PROCESS         VALUE ' '.
   571         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   572         88  ADJUST-UP-100-YRS          VALUE '2'.
   573     12  FILLER                        PIC X.
   574     12  DC-CONVERSION-DATES.
   575         16  DC-BIN-DATE-1             PIC XX.
   576         16  DC-BIN-DATE-2             PIC XX.
   577         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   578         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   579                       DC-GREG-DATE-1-EDIT.
   580             20  DC-EDIT1-MONTH        PIC 99.
   581             20  SLASH1-1              PIC X.
   582             20  DC-EDIT1-DAY          PIC 99.
   583             20  SLASH1-2              PIC X.
   584             20  DC-EDIT1-YEAR         PIC 99.
   585         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   586         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   587                     DC-GREG-DATE-2-EDIT.
   588             20  DC-EDIT2-MONTH        PIC 99.
   589             20  SLASH2-1              PIC X.
   590             20  DC-EDIT2-DAY          PIC 99.
   591             20  SLASH2-2              PIC X.
   592             20  DC-EDIT2-YEAR         PIC 99.
   593         16  DC-GREG-DATE-1-YMD        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  12
* EL201.cbl
   594         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   595                     DC-GREG-DATE-1-YMD.
   596             20  DC-YMD-YEAR           PIC 99.
   597             20  DC-YMD-MONTH          PIC 99.
   598             20  DC-YMD-DAY            PIC 99.
   599         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   600         16  DC-GREG-DATE-1-MDY-R REDEFINES
   601                      DC-GREG-DATE-1-MDY.
   602             20  DC-MDY-MONTH          PIC 99.
   603             20  DC-MDY-DAY            PIC 99.
   604             20  DC-MDY-YEAR           PIC 99.
   605         16  DC-GREG-DATE-1-ALPHA.
   606             20  DC-ALPHA-MONTH        PIC X(10).
   607             20  DC-ALPHA-DAY          PIC 99.
   608             20  FILLER                PIC XX.
   609             20  DC-ALPHA-CENTURY.
   610                 24 DC-ALPHA-CEN-N     PIC 99.
   611             20  DC-ALPHA-YEAR         PIC 99.
   612         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   613         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   614         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   615         16  DC-JULIAN-DATE            PIC 9(05).
   616         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   617                                       PIC 9(05).
   618         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   619             20  DC-JULIAN-YEAR        PIC 99.
   620             20  DC-JULIAN-DAYS        PIC 999.
   621         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   622         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   623         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   624     12  DATE-CONVERSION-VARIBLES.
   625         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   626         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   627             20  FILLER                PIC 9(3).
   628             20  HOLD-CEN-1-CCYY.
   629                 24  HOLD-CEN-1-CC     PIC 99.
   630                 24  HOLD-CEN-1-YY     PIC 99.
   631             20  HOLD-CEN-1-MO         PIC 99.
   632             20  HOLD-CEN-1-DA         PIC 99.
   633         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   634             20  HOLD-CEN-1-R-MO       PIC 99.
   635             20  HOLD-CEN-1-R-DA       PIC 99.
   636             20  HOLD-CEN-1-R-CCYY.
   637                 24  HOLD-CEN-1-R-CC   PIC 99.
   638                 24  HOLD-CEN-1-R-YY   PIC 99.
   639             20  FILLER                PIC 9(3).
   640         16  HOLD-CENTURY-1-X.
   641             20  FILLER                PIC X(3)  VALUE SPACES.
   642             20  HOLD-CEN-1-X-CCYY.
   643                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   644                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   645             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   646             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   647         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   648             20  HOLD-CEN-1-R-X-MO     PIC XX.
   649             20  HOLD-CEN-1-R-X-DA     PIC XX.
   650             20  HOLD-CEN-1-R-X-CCYY.
   651                 24  HOLD-CEN-1-R-X-CC PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  13
* EL201.cbl
   652                 24  HOLD-CEN-1-R-X-YY PIC XX.
   653             20  FILLER                PIC XXX.
   654         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   655         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   656         16  DC-JULIAN-DATE-1          PIC 9(07).
   657         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   658             20  DC-JULIAN-1-CCYY.
   659                 24  DC-JULIAN-1-CC    PIC 99.
   660                 24  DC-JULIAN-1-YR    PIC 99.
   661             20  DC-JULIAN-DA-1        PIC 999.
   662         16  DC-JULIAN-DATE-2          PIC 9(07).
   663         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   664             20  DC-JULIAN-2-CCYY.
   665                 24  DC-JULIAN-2-CC    PIC 99.
   666                 24  DC-JULIAN-2-YR    PIC 99.
   667             20  DC-JULIAN-DA-2        PIC 999.
   668         16  DC-GREG-DATE-A-EDIT.
   669             20  DC-EDITA-MONTH        PIC 99.
   670             20  SLASHA-1              PIC X VALUE '/'.
   671             20  DC-EDITA-DAY          PIC 99.
   672             20  SLASHA-2              PIC X VALUE '/'.
   673             20  DC-EDITA-CCYY.
   674                 24  DC-EDITA-CENT     PIC 99.
   675                 24  DC-EDITA-YEAR     PIC 99.
   676         16  DC-GREG-DATE-B-EDIT.
   677             20  DC-EDITB-MONTH        PIC 99.
   678             20  SLASHB-1              PIC X VALUE '/'.
   679             20  DC-EDITB-DAY          PIC 99.
   680             20  SLASHB-2              PIC X VALUE '/'.
   681             20  DC-EDITB-CCYY.
   682                 24  DC-EDITB-CENT     PIC 99.
   683                 24  DC-EDITB-YEAR     PIC 99.
   684         16  DC-GREG-DATE-CYMD         PIC 9(08).
   685         16  DC-GREG-DATE-CYMD-R REDEFINES
   686                              DC-GREG-DATE-CYMD.
   687             20  DC-CYMD-CEN           PIC 99.
   688             20  DC-CYMD-YEAR          PIC 99.
   689             20  DC-CYMD-MONTH         PIC 99.
   690             20  DC-CYMD-DAY           PIC 99.
   691         16  DC-GREG-DATE-MDCY         PIC 9(08).
   692         16  DC-GREG-DATE-MDCY-R REDEFINES
   693                              DC-GREG-DATE-MDCY.
   694             20  DC-MDCY-MONTH         PIC 99.
   695             20  DC-MDCY-DAY           PIC 99.
   696             20  DC-MDCY-CEN           PIC 99.
   697             20  DC-MDCY-YEAR          PIC 99.
   698    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   699        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   700    12  DC-EL310-DATE                  PIC X(21).
   701    12  FILLER                         PIC X(28).
   702*                                COPY ELCCNTL.
   703******************************************************************
   704*                                                                *
   705*                                                                *
   706*                            ELCCNTL.                            *
   707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   708*                            VMOD=2.059                          *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  14
* EL201.cbl
   710*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   711*                                                                *
   712*   FILE TYPE = VSAM,KSDS                                        *
   713*   RECORD SIZE = 750  RECFORM = FIXED                           *
   714*                                                                *
   715*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   716*       ALTERNATE INDEX = NONE                                   *
   717*                                                                *
   718*   LOG = YES                                                    *
   719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   720******************************************************************
   721*                   C H A N G E   L O G
   722*
   723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   724*-----------------------------------------------------------------
   725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   726* EFFECTIVE    NUMBER
   727*-----------------------------------------------------------------
   728* 082503                   PEMA  ADD BENEFIT GROUP
   729* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   730* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   731* 092705    2005050300006  PEMA  ADD SPP LEASES
   732* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   733* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   734* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   735* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   736* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   737* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   738* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   739* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   740* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   741* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   742******************************************************************
   743*
   744 01  CONTROL-FILE.
   745     12  CF-RECORD-ID                       PIC XX.
   746         88  VALID-CF-ID                        VALUE 'CF'.
   747
   748     12  CF-CONTROL-PRIMARY.
   749         16  CF-COMPANY-ID                  PIC XXX.
   750         16  CF-RECORD-TYPE                 PIC X.
   751             88  CF-COMPANY-MASTER              VALUE '1'.
   752             88  CF-PROCESSOR-MASTER            VALUE '2'.
   753             88  CF-STATE-MASTER                VALUE '3'.
   754             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   755             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   756             88  CF-CARRIER-MASTER              VALUE '6'.
   757             88  CF-MORTALITY-MASTER            VALUE '7'.
   758             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   759             88  CF-TERMINAL-MASTER             VALUE '9'.
   760             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   761             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   762             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   763             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   764             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   765             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   766             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   767             88  CF-REMINDERS-MASTER            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  15
* EL201.cbl
   768             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   769         16  CF-ACCESS-CD-GENL              PIC X(4).
   770         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   771             20  CF-PROCESSOR               PIC X(4).
   772         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   773             20  CF-STATE-CODE              PIC XX.
   774             20  FILLER                     PIC XX.
   775         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   776             20  FILLER                     PIC XX.
   777             20  CF-HI-BEN-IN-REC           PIC XX.
   778         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   779             20  FILLER                     PIC XXX.
   780             20  CF-CARRIER-CNTL            PIC X.
   781         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   782             20  FILLER                     PIC XX.
   783             20  CF-HI-TYPE-IN-REC          PIC 99.
   784         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   785             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   786                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   787             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   788             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   789         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   790             20  FILLER                     PIC X.
   791             20  CF-CUSTOM-REPORT-NO        PIC 999.
   792         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   793             20  FILLER                     PIC XX.
   794             20  CF-MORTGAGE-PLAN           PIC XX.
   795         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   796
   797     12  CF-LAST-MAINT-DT                   PIC XX.
   798     12  CF-LAST-MAINT-BY                   PIC X(4).
   799     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   800
   801     12  CF-RECORD-BODY                     PIC X(728).
   802
   803
   804****************************************************************
   805*             COMPANY MASTER RECORD                            *
   806****************************************************************
   807
   808     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   809         16  CF-COMPANY-ADDRESS.
   810             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   811             20  CF-CL-IN-CARE-OF           PIC X(30).
   812             20  CF-CL-ADDR-LINE-1          PIC X(30).
   813             20  CF-CL-ADDR-LINE-2          PIC X(30).
   814             20  CF-CL-CITY-STATE           PIC X(30).
   815             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   816             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   817         16  CF-COMPANY-CD                  PIC X.
   818         16  CF-COMPANY-PASSWORD            PIC X(8).
   819         16  CF-SECURITY-OPTION             PIC X.
   820             88  ALL-SECURITY                   VALUE '1'.
   821             88  COMPANY-VERIFY                 VALUE '2'.
   822             88  PROCESSOR-VERIFY               VALUE '3'.
   823             88  NO-SECURITY                    VALUE '4'.
   824             88  ALL-BUT-TERM                   VALUE '5'.
   825         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  16
* EL201.cbl
   826             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   827         16  CF-LGX-INTERFACE-CNTL          PIC X.
   828             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   829         16  CF-INFORCE-LOCATION            PIC X.
   830             88  CERTS-ARE-ONLINE               VALUE '1'.
   831             88  CERTS-ARE-OFFLINE              VALUE '2'.
   832             88  NO-CERTS-AVAILABLE             VALUE '3'.
   833         16  CF-LOWER-CASE-LETTERS          PIC X.
   834         16  CF-CERT-ACCESS-CONTROL         PIC X.
   835             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   836             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   837             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   838             88  CF-ACCNT-CNTL                  VALUE '3'.
   839             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   840
   841         16  CF-FORMS-PRINTER-ID            PIC X(4).
   842         16  CF-CHECK-PRINTER-ID            PIC X(4).
   843
   844         16  CF-LGX-CREDIT-USER             PIC X.
   845             88  CO-IS-NOT-USER                 VALUE 'N'.
   846             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   847
   848         16 CF-CREDIT-CALC-CODES.
   849             20  CF-CR-REM-TERM-CALC PIC X.
   850               88  CR-EARN-AFTER-15TH           VALUE '1'.
   851               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   852               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   853               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   854               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   855               88  CR-EARN-AFTER-14TH           VALUE '6'.
   856               88  CR-EARN-AFTER-16TH           VALUE '7'.
   857             20  CF-CR-R78-METHOD           PIC X.
   858               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   859               88  DONT-USE-PLUS-ONE            VALUE '1'.
   860
   861         16  CF-CLAIM-CONTROL-COUNTS.
   862             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   863                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   864
   865             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   866                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   867
   868             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   869                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   870
   871             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   872                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   873
   874         16  CF-CURRENT-MONTH-END           PIC XX.
   875
   876         16  CF-CO-CALC-QUOTE-TOLERANCE.
   877             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   878             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   879             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   880             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   881                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   882                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   883             20  CF-CO-PREM-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  17
* EL201.cbl
   884                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   885                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   886             20  CF-CO-REF-REJECT-SW        PIC X.
   887                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   888                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   889
   890         16  CF-CO-REPORTING-DT             PIC XX.
   891         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   892         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   893           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   894           88  CF-CO-MONTH-END                  VALUE '1'.
   895
   896         16  CF-LGX-CLAIM-USER              PIC X.
   897             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   898             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   899
   900         16  CF-CREDIT-EDIT-CONTROLS.
   901             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   902             20  CF-MIN-AGE                 PIC 99.
   903             20  CF-DEFAULT-AGE             PIC 99.
   904             20  CF-MIN-TERM                PIC S999      COMP-3.
   905             20  CF-MAX-TERM                PIC S999      COMP-3.
   906             20  CF-DEFAULT-SEX             PIC X.
   907             20  CF-JOINT-AGE-INPUT         PIC X.
   908                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   909             20  CF-BIRTH-DATE-INPUT        PIC X.
   910                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   911             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   912                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   913                 88  CF-ZERO-CARRIER            VALUE '1'.
   914                 88  CF-ZERO-GROUPING           VALUE '2'.
   915                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   916             20  CF-EDIT-SW                 PIC X.
   917                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   918             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   919             20  CF-CR-PR-METHOD            PIC X.
   920               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   921               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   922             20  FILLER                     PIC X.
   923
   924         16  CF-CREDIT-MISC-CONTROLS.
   925             20  CF-REIN-TABLE-SW           PIC X.
   926                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   927             20  CF-COMP-TABLE-SW           PIC X.
   928                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   929             20  CF-EXPERIENCE-RETENTION-AGE
   930                                            PIC S9        COMP-3.
   931             20  CF-CONVERSION-DT           PIC XX.
   932             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   933             20  CF-RUN-FREQUENCY-SW        PIC X.
   934                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   935                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   936
   937             20  CF-CR-CHECK-NO-CONTROL.
   938                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   939                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   940                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   941                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  18
* EL201.cbl
   942                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   943                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   944
   945                 24  CF-CR-CHECK-COUNT       REDEFINES
   946                     CF-CR-CHECK-COUNTER      PIC X(4).
   947
   948                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   949                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   950
   951                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   952                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   953                 24  CF-MAIL-PROCESSING       PIC X.
   954                     88  MAIL-PROCESSING          VALUE 'Y'.
   955
   956         16  CF-MISC-SYSTEM-CONTROL.
   957             20  CF-SYSTEM-C                 PIC X.
   958                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   959             20  CF-SYSTEM-D                 PIC X.
   960                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   961             20  CF-SOC-SEC-NO-SW            PIC X.
   962                 88  SOC-SEC-NO-USED             VALUE '1'.
   963             20  CF-MEMBER-NO-SW             PIC X.
   964                 88  MEMBER-NO-USED              VALUE '1'.
   965             20  CF-TAX-ID-NUMBER            PIC X(11).
   966             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   967             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   968                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   969                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   970                 88  CF-ALL-APPROVED             VALUE 'Y'.
   971                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   972             20  CF-SYSTEM-E                 PIC X.
   973                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   974
   975         16  CF-LGX-LIFE-USER               PIC X.
   976             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   977             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   978
   979         16  CF-CR-MONTH-END-DT             PIC XX.
   980
   981         16  CF-FILE-MAINT-DATES.
   982             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   983                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   984             20  CF-LAST-BATCH       REDEFINES
   985                 CF-LAST-BATCH-NO               PIC X(4).
   986             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   987             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   988             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   989             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   990             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   991             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   992             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   993             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   994             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   995             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   996
   997         16  CF-NEXT-COMPANY-ID             PIC XXX.
   998         16  FILLER                         PIC X.
   999
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  19
* EL201.cbl
  1000         16  CF-ALT-MORT-CODE               PIC X(4).
  1001         16  CF-MEMBER-CAPTION              PIC X(10).
  1002
  1003         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1004             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1005             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1006             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1007             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1008             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1009
  1010         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1011
  1012         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1013         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1014         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1015         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1016
  1017         16  CF-AH-OVERRIDE-L1              PIC X.
  1018         16  CF-AH-OVERRIDE-L2              PIC XX.
  1019         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1020         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1021
  1022         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1023         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1024
  1025         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1026         16  CF-AR-LAST-EL860-DT            PIC XX.
  1027         16  CF-MP-MONTH-END-DT             PIC XX.
  1028
  1029         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1030         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1031             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1032
  1033         16  CF-AR-MONTH-END-DT             PIC XX.
  1034
  1035         16  CF-CRDTCRD-USER                PIC X.
  1036             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1037             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1038
  1039         16  CF-CC-MONTH-END-DT             PIC XX.
  1040
  1041         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1042
  1043         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1044             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1045             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1046             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1047         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1048         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1049         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1050         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1051             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1052             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1053         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1054         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1055         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1056             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1057         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  20
* EL201.cbl
  1058
  1059         16  CF-CL-ZIP-CODE.
  1060             20  CF-CL-ZIP-PRIME.
  1061                 24  CF-CL-ZIP-1ST          PIC X.
  1062                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1063                 24  FILLER                 PIC X(4).
  1064             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1065         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1066             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1067             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1068             20  FILLER                     PIC XXX.
  1069
  1070         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1071         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1072         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1073         16  CF-CO-OPTION-START-DATE        PIC XX.
  1074         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1075           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1076                                                      '3' '4'.
  1077           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1078           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1079           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1080           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1081           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1082           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1083
  1084         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1085
  1086         16  CF-PAYMENT-APPROVAL-LEVELS.
  1087             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1088             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1089             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1090             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1091             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1092             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1093
  1094         16  CF-END-USER-REPORTING-USER     PIC X.
  1095             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1096             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1097
  1098         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1099             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1100             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1101
  1102         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1103
  1104         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1105         16  FILLER                         PIC X.
  1106
  1107         16  CF-CREDIT-ARCHIVE-CNTL.
  1108             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1109             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1110             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1111
  1112         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1113
  1114         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1115             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  21
* EL201.cbl
  1116             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1117
  1118         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1119             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1120             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1121
  1122         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1123
  1124         16  CF-CO-ACH-ID-CODE              PIC  X.
  1125             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1126             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1127             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1128         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1129         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1130         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1131         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1132         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1133         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1134         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1135         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1136         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1137                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1138         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1139                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1140
  1141         16  CF-CO-OVER-SHORT.
  1142             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1143             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1144
  1145*         16  FILLER                         PIC X(102).
  1146         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1147             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1148             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1149
  1150         16  CF-AH-APPROVAL-DAYS.
  1151             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1152             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1153             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1154             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1155
  1156         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1157
  1158         16  CF-APPROV-LEV-5.
  1159             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1160             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1161             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1162
  1163         16  FILLER                         PIC X(68).
  1164****************************************************************
  1165*             PROCESSOR/USER RECORD                            *
  1166****************************************************************
  1167
  1168     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1169         16  CF-PROCESSOR-NAME              PIC X(30).
  1170         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1171         16  CF-PROCESSOR-TITLE             PIC X(26).
  1172         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1173                 88  MESSAGE-YES                VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  22
* EL201.cbl
  1174                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1175
  1176*****************************************************
  1177****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1178****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1179****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1180****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1181*****************************************************
  1182
  1183         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1184             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1185             20  CF-APPLICATION-FORCE       PIC X.
  1186             20  CF-INDIVIDUAL-APP.
  1187                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1188                     28  CF-BROWSE-APP      PIC X.
  1189                     28  CF-UPDATE-APP      PIC X.
  1190
  1191         16  CF-CURRENT-TERM-ON             PIC X(4).
  1192         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1193             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1194             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1195             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1196             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1197             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1198             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1199             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1200         16  CF-PROCESSOR-CARRIER           PIC X.
  1201             88  NO-CARRIER-SECURITY            VALUE ' '.
  1202         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1203             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1204         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1205             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1206         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1207             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1208
  1209         16  CF-PROC-SYS-ACCESS-SW.
  1210             20  CF-PROC-CREDIT-CLAIMS-SW.
  1211                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1212                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1213                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1214                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1215             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1216                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1217                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1218             20  CF-PROC-LIFE-GNRLDGR-SW.
  1219                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1220                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1221                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1222                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1223             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1224                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1225                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1226         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1227             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1228             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1229         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1230
  1231         16  CF-APPROVAL-LEVEL                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  23
* EL201.cbl
  1232             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1233             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1234             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1235             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1236             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1237
  1238         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1239
  1240         16  CF-LANGUAGE-TYPE                   PIC X.
  1241             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1242             88  CF-LANG-IS-FR                      VALUE 'F'.
  1243
  1244         16  CF-CSR-IND                         PIC X.
  1245         16  FILLER                             PIC X(239).
  1246
  1247****************************************************************
  1248*             PROCESSOR/REMINDERS RECORD                       *
  1249****************************************************************
  1250
  1251     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1252         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1253             20  CF-START-REMIND-DT         PIC XX.
  1254             20  CF-END-REMIND-DT           PIC XX.
  1255             20  CF-REMINDER-TEXT           PIC X(50).
  1256         16  FILLER                         PIC X(296).
  1257
  1258
  1259****************************************************************
  1260*             STATE MASTER RECORD                              *
  1261****************************************************************
  1262
  1263     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1264         16  CF-STATE-ABBREVIATION          PIC XX.
  1265         16  CF-STATE-NAME                  PIC X(25).
  1266         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1267         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1268             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1269             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1270             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1271             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1272                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1273                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1274             20  CF-ST-PREM-REJECT-SW       PIC X.
  1275                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1276                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1277             20  CF-ST-REF-REJECT-SW        PIC X.
  1278                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1279                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1280         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1281         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1282         16  CF-ST-REFUND-RULES.
  1283             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1284             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1285             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1286         16  CF-ST-FST-PMT-EXTENSION.
  1287             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1288             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1289                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  24
* EL201.cbl
  1290                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1291                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1292                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1293         16  CF-ST-STATE-CALL.
  1294             20  CF-ST-CALL-UNEARNED        PIC X.
  1295             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1296             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1297         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1298             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1299             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1300         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1301         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1302         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1303         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1304         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1305         16  FILLER                         PIC X.
  1306         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1307             20  CF-ST-BENEFIT-CD           PIC XX.
  1308             20  CF-ST-BENEFIT-KIND         PIC X.
  1309                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1310                 88  CF-ST-AH-KIND              VALUE 'A'.
  1311             20  CF-ST-REM-TERM-CALC        PIC X.
  1312                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1313                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1314                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1315                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1316                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1317                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1318                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1319                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1320
  1321             20  CF-ST-REFUND-CALC          PIC X.
  1322                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1323                 88  ST-REFD-BY-R78             VALUE '1'.
  1324                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1325                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1326                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1327                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1328                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1329                 88  ST-REFD-UTAH               VALUE '7'.
  1330                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1331                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1332                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1333
  1334             20  CF-ST-EARNING-CALC         PIC X.
  1335                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1336                 88  ST-EARN-BY-R78             VALUE '1'.
  1337                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1338                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1339                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1340                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1341                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1342                 88  ST-EARN-MEAN               VALUE '8'.
  1343                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1344
  1345             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1346                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1347                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  25
* EL201.cbl
  1348                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1349                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1350                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1351                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1352                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1353                 88  ST-OVRD-MEAN               VALUE '8'.
  1354                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1355             20  FILLER                     PIC X.
  1356
  1357         16  CF-ST-COMMISSION-CAPS.
  1358             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1359             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1360             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1361             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1362         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1363                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1364
  1365         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1366
  1367         16  CF-ST-STATUTORY-INTEREST.
  1368             20  CF-ST-STAT-DATE-FROM       PIC X.
  1369                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1370                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1371             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1372             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1373             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1374             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1375             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1376
  1377         16  CF-ST-OVER-SHORT.
  1378             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1379             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1380
  1381         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1382
  1383         16  CF-ST-RT-CALC                  PIC X.
  1384
  1385         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1386         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1387         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1388         16  CF-ST-RF-LR-CALC               PIC X.
  1389         16  CF-ST-RF-LL-CALC               PIC X.
  1390         16  CF-ST-RF-LN-CALC               PIC X.
  1391         16  CF-ST-RF-AH-CALC               PIC X.
  1392         16  CF-ST-RF-CP-CALC               PIC X.
  1393*        16  FILLER                         PIC X(206).
  1394*CIDMOD         16  FILLER                         PIC X(192).
  1395         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1396             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1397         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1398         16  CF-ST-VFY-2ND-BENE             PIC X.
  1399         16  CF-ST-CAUSAL-STATE             PIC X.
  1400         16  FILLER                         PIC X(185).
  1401
  1402****************************************************************
  1403*             BENEFIT MASTER RECORD                            *
  1404****************************************************************
  1405
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  26
* EL201.cbl
  1406     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1407         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1408             20  CF-BENEFIT-CODE            PIC XX.
  1409             20  CF-BENEFIT-NUMERIC  REDEFINES
  1410                 CF-BENEFIT-CODE            PIC XX.
  1411             20  CF-BENEFIT-ALPHA           PIC XXX.
  1412             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1413             20  CF-BENEFIT-COMMENT         PIC X(10).
  1414
  1415             20  CF-LF-COVERAGE-TYPE        PIC X.
  1416                 88  CF-REDUCING                VALUE 'R'.
  1417                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1418
  1419             20  CF-SPECIAL-CALC-CD         PIC X.
  1420                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1421                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1422                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1423                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1424                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1425                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1426                 88  CF-FARM-PLAN               VALUE 'F'.
  1427                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1428                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1429                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1430                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1431                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1432                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1433                 88  CF-PRUDENTIAL              VALUE 'P'.
  1434                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1435                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1436                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1437                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1438                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1439                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1440
  1441             20  CF-JOINT-INDICATOR         PIC X.
  1442                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1443
  1444*            20  FILLER                     PIC X(12).
  1445             20  cf-maximum-benefits        pic s999 comp-3.
  1446             20  FILLER                     PIC X(09).
  1447             20  CF-BENEFIT-CATEGORY        PIC X.
  1448             20  CF-LOAN-TYPE               PIC X(8).
  1449
  1450             20  CF-CO-REM-TERM-CALC        PIC X.
  1451                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1452                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1453                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1454                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1455                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1456
  1457             20  CF-CO-EARNINGS-CALC        PIC X.
  1458                 88  CO-EARN-BY-R78             VALUE '1'.
  1459                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1460                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1461                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1462                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1463                 88  CO-EARN-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  27
* EL201.cbl
  1464                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1465                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1466
  1467             20  CF-CO-REFUND-CALC          PIC X.
  1468                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1469                 88  CO-REFD-BY-R78             VALUE '1'.
  1470                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1471                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1472                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1473                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1474                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1475                 88  CO-REFD-MEAN               VALUE '8'.
  1476                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1477                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1478                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1479
  1480             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1481                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1482                 88  CO-OVRD-BY-R78             VALUE '1'.
  1483                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1484                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1485                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1486                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1487                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1488                 88  CO-OVRD-MEAN               VALUE '8'.
  1489                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1490
  1491             20  CF-CO-BEN-I-G-CD           PIC X.
  1492                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1493                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1494                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1495
  1496         16  FILLER                         PIC X(304).
  1497
  1498
  1499****************************************************************
  1500*             CARRIER MASTER RECORD                            *
  1501****************************************************************
  1502
  1503     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1504         16  CF-ADDRESS-DATA.
  1505             20  CF-MAIL-TO-NAME            PIC X(30).
  1506             20  CF-IN-CARE-OF              PIC X(30).
  1507             20  CF-ADDRESS-LINE-1          PIC X(30).
  1508             20  CF-ADDRESS-LINE-2          PIC X(30).
  1509             20  CF-CITY-STATE              PIC X(30).
  1510             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1511             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1512
  1513         16  CF-CLAIM-NO-CONTROL.
  1514             20  CF-CLAIM-NO-METHOD         PIC X.
  1515                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1516                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1517                 88  CLAIM-NO-SEQ               VALUE '3'.
  1518                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1519             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1520                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1521                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  28
* EL201.cbl
  1522                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1523
  1524         16  CF-CHECK-NO-CONTROL.
  1525             20  CF-CHECK-NO-METHOD         PIC X.
  1526                 88  CHECK-NO-MANUAL            VALUE '1'.
  1527                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1528                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1529                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1530             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1531                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1532
  1533         16  CF-DOMICILE-STATE              PIC XX.
  1534
  1535         16  CF-EXPENSE-CONTROLS.
  1536             20  CF-EXPENSE-METHOD          PIC X.
  1537                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1538                 88  DOLLARS-PER-PMT            VALUE '2'.
  1539                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1540                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1541             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1542             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1543
  1544         16  CF-CORRESPONDENCE-CONTROL.
  1545             20  CF-LETTER-RESEND-OPT       PIC X.
  1546                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1547                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1548             20  FILLER                     PIC X(4).
  1549
  1550         16  CF-RESERVE-CONTROLS.
  1551             20  CF-MANUAL-SW               PIC X.
  1552                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1553             20  CF-FUTURE-SW               PIC X.
  1554                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1555             20  CF-PTC-SW                  PIC X.
  1556                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1557             20  CF-IBNR-SW                 PIC X.
  1558                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1559             20  CF-PTC-LF-SW               PIC X.
  1560                 88  CF-LF-PTC-USED             VALUE '1'.
  1561             20  CF-CDT-ACCESS-METHOD       PIC X.
  1562                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1563                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1564                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1565             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1566
  1567         16  CF-CLAIM-CALC-METHOD           PIC X.
  1568             88  360-PLUS-MONTHS                VALUE '1'.
  1569             88  365-PLUS-MONTHS                VALUE '2'.
  1570             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1571             88  360-DAILY                      VALUE '4'.
  1572             88  365-DAILY                      VALUE '5'.
  1573
  1574         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1575         16  FILLER                         PIC X(11).
  1576
  1577         16  CF-LIMIT-AMOUNTS.
  1578             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1579             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  29
* EL201.cbl
  1580             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1581             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1582             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1583             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1584             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1585             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1586             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1587             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1588
  1589         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1590         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1591         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1592
  1593         16  CF-ZIP-CODE.
  1594             20  CF-ZIP-PRIME.
  1595                 24  CF-ZIP-1ST             PIC X.
  1596                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1597                 24  FILLER                 PIC X(4).
  1598             20  CF-ZIP-PLUS4               PIC X(4).
  1599         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1600             20  CF-CAN-POSTAL-1            PIC XXX.
  1601             20  CF-CAN-POSTAL-2            PIC XXX.
  1602             20  FILLER                     PIC XXX.
  1603
  1604         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1605         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1606         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1607
  1608         16  CF-RATING-SWITCH               PIC X.
  1609             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1610             88  CF-NO-RATING                   VALUE 'N'.
  1611
  1612         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1613
  1614         16  CF-CARRIER-OVER-SHORT.
  1615             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1616             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1617
  1618         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1619         16  CF-SECPAY-SWITCH               PIC X.
  1620             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1621             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1622         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1623         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1624         16  FILLER                         PIC X(444).
  1625*        16  FILLER                         PIC X(452).
  1626
  1627
  1628****************************************************************
  1629*             MORTALITY MASTER RECORD                          *
  1630****************************************************************
  1631
  1632     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1633         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1634                                INDEXED BY CF-MORT-NDX.
  1635             20  CF-MORT-TABLE              PIC X(5).
  1636             20  CF-MORT-TABLE-TYPE         PIC X.
  1637                 88  CF-MORT-JOINT              VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  30
* EL201.cbl
  1638                 88  CF-MORT-SINGLE             VALUE 'S'.
  1639                 88  CF-MORT-COMBINED           VALUE 'C'.
  1640                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1641                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1642             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1643             20  CF-MORT-AGE-METHOD         PIC XX.
  1644                 88  CF-AGE-LAST                VALUE 'AL'.
  1645                 88  CF-AGE-NEAR                VALUE 'AN'.
  1646             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1647             20  CF-MORT-ADJUSTMENT-DIRECTION
  1648                                            PIC X.
  1649                 88  CF-MINUS                   VALUE '-'.
  1650                 88  CF-PLUS                    VALUE '+'.
  1651             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1652             20  CF-MORT-JOINT-CODE         PIC X.
  1653                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1654             20  CF-MORT-PC-Q               PIC X.
  1655                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1656             20  CF-MORT-TABLE-CODE         PIC X(4).
  1657             20  CF-MORT-COMMENTS           PIC X(15).
  1658             20  FILLER                     PIC X(14).
  1659
  1660         16  FILLER                         PIC X(251).
  1661
  1662
  1663****************************************************************
  1664*             BUSSINESS TYPE MASTER RECORD                     *
  1665****************************************************************
  1666
  1667     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1668* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1669* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1670* AND RECORD 05 IS TYPES 81-99
  1671         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1672             20  CF-BUSINESS-TITLE          PIC  X(19).
  1673             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1674                                            PIC S9V9(4) COMP-3.
  1675             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1676             20  FILLER                     PIC  X.
  1677         16  FILLER                         PIC  X(248).
  1678
  1679
  1680****************************************************************
  1681*             TERMINAL MASTER RECORD                           *
  1682****************************************************************
  1683
  1684     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1685
  1686         16  CF-COMPANY-TERMINALS.
  1687             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1688                                  PIC X(4).
  1689         16  FILLER               PIC X(248).
  1690
  1691
  1692****************************************************************
  1693*             LIFE EDIT MASTER RECORD                          *
  1694****************************************************************
  1695
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  31
* EL201.cbl
  1696     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1697         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1698             20  CF-LIFE-CODE-IN            PIC XX.
  1699             20  CF-LIFE-CODE-OUT           PIC XX.
  1700         16  FILLER                         PIC X(248).
  1701
  1702
  1703****************************************************************
  1704*             AH EDIT MASTER RECORD                            *
  1705****************************************************************
  1706
  1707     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1708         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1709             20  CF-AH-CODE-IN              PIC XXX.
  1710             20  CF-AH-CODE-OUT             PIC XX.
  1711         16  FILLER                         PIC X(248).
  1712
  1713
  1714****************************************************************
  1715*             CREDIBILITY TABLES                               *
  1716****************************************************************
  1717
  1718     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1719         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1720                             INDEXED BY CF-CRDB-NDX.
  1721             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1722             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1723             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1724         16  FILLER                         PIC  X(332).
  1725
  1726
  1727****************************************************************
  1728*             REPORT CUSTOMIZATION RECORD                      *
  1729****************************************************************
  1730
  1731     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1732         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1733             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1734             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1735             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1736**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1737****       A T-TRANSFER.                                   ****
  1738             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1739
  1740         16  FILLER                         PIC XX.
  1741
  1742         16  CF-CARRIER-CNTL-OPT.
  1743             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1744                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1745                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1746             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1747                                            PIC X.
  1748         16  CF-GROUP-CNTL-OPT.
  1749             20  CF-GROUP-OPT-SEQ           PIC 9.
  1750                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1751                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1752             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1753                                            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  32
* EL201.cbl
  1754         16  CF-STATE-CNTL-OPT.
  1755             20  CF-STATE-OPT-SEQ           PIC 9.
  1756                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1757                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1758             20  CF-STATE-SELECT OCCURS 3 TIMES
  1759                                            PIC XX.
  1760         16  CF-ACCOUNT-CNTL-OPT.
  1761             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1762                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1763                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1764             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1765                                            PIC X(10).
  1766         16  CF-BUS-TYP-CNTL-OPT.
  1767             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1768                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1769                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1770             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1771                                            PIC XX.
  1772         16  CF-LF-TYP-CNTL-OPT.
  1773             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1774                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1775                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1776             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1777                                            PIC XX.
  1778         16  CF-AH-TYP-CNTL-OPT.
  1779             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1780                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1781                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1782             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1783                                            PIC XX.
  1784         16  CF-REPTCD1-CNTL-OPT.
  1785             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1786                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1787                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1788             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1789                                            PIC X(10).
  1790         16  CF-REPTCD2-CNTL-OPT.
  1791             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1792                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1793                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1794             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1795                                            PIC X(10).
  1796         16  CF-USER1-CNTL-OPT.
  1797             20  CF-USER1-OPT-SEQ           PIC 9.
  1798                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1799                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1800             20  CF-USER1-SELECT OCCURS 3 TIMES
  1801                                            PIC X(10).
  1802         16  CF-USER2-CNTL-OPT.
  1803             20  CF-USER2-OPT-SEQ           PIC 9.
  1804                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1805                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1806             20  CF-USER2-SELECT OCCURS 3 TIMES
  1807                                            PIC X(10).
  1808         16  CF-USER3-CNTL-OPT.
  1809             20  CF-USER3-OPT-SEQ           PIC 9.
  1810                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1811                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  33
* EL201.cbl
  1812             20  CF-USER3-SELECT OCCURS 3 TIMES
  1813                                            PIC X(10).
  1814         16  CF-USER4-CNTL-OPT.
  1815             20  CF-USER4-OPT-SEQ           PIC 9.
  1816                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1817                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1818             20  CF-USER4-SELECT OCCURS 3 TIMES
  1819                                            PIC X(10).
  1820         16  CF-USER5-CNTL-OPT.
  1821             20  CF-USER5-OPT-SEQ           PIC 9.
  1822                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1823                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1824             20  CF-USER5-SELECT OCCURS 3 TIMES
  1825                                            PIC X(10).
  1826         16  CF-REINS-CNTL-OPT.
  1827             20  CF-REINS-OPT-SEQ           PIC 9.
  1828                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1829                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1830             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1831                 24  CF-REINS-PRIME         PIC XXX.
  1832                 24  CF-REINS-SUB           PIC XXX.
  1833
  1834         16  CF-AGENT-CNTL-OPT.
  1835             20  CF-AGENT-OPT-SEQ           PIC 9.
  1836                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1837                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1838             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1839                                            PIC X(10).
  1840
  1841         16  FILLER                         PIC X(43).
  1842
  1843         16  CF-LOSS-RATIO-SELECT.
  1844             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1845             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1846         16  CF-ENTRY-DATE-SELECT.
  1847             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1848             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1849         16  CF-EFFECTIVE-DATE-SELECT.
  1850             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1851             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1852
  1853         16  CF-EXCEPTION-LIST-IND          PIC X.
  1854             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1855
  1856         16  FILLER                         PIC X(318).
  1857
  1858****************************************************************
  1859*                  EXCEPTION REPORTING RECORD                  *
  1860****************************************************************
  1861
  1862     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1863         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1864             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1865
  1866         16  CF-COMBINED-LIFE-AH-OPT.
  1867             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1868             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1869             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  34
* EL201.cbl
  1870             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1871
  1872         16  CF-LIFE-OPT.
  1873             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1874             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1875             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1876             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1877             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1878             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1879             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1880             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1881             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1882             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1883
  1884         16  CF-AH-OPT.
  1885             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1886             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1887             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1888             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1889             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1890             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1891             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1892             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1893             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1894             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1895
  1896         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1897             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1898             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1899             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1900
  1901         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1902
  1903         16  FILLER                         PIC X(673).
  1904
  1905
  1906****************************************************************
  1907*             MORTGAGE SYSTEM PLAN RECORD                      *
  1908****************************************************************
  1909
  1910     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1911         16  CF-PLAN-TYPE                   PIC X.
  1912             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1913             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1914             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1915         16  CF-PLAN-ABBREV                 PIC XXX.
  1916         16  CF-PLAN-DESCRIPT               PIC X(10).
  1917         16  CF-PLAN-NOTES                  PIC X(20).
  1918         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1919         16  CF-PLAN-UNDERWRITING.
  1920             20  CF-PLAN-TERM-DATA.
  1921                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1922                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1923             20  CF-PLAN-AGE-DATA.
  1924                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1925                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1926                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1927             20  CF-PLAN-BENEFIT-DATA.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  35
* EL201.cbl
  1928                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1929                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1930                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1931                                            PIC S9(7)V99  COMP-3.
  1932         16  CF-PLAN-POLICY-FORMS.
  1933             20  CF-POLICY-FORM             PIC X(12).
  1934             20  CF-MASTER-APPLICATION      PIC X(12).
  1935             20  CF-MASTER-POLICY           PIC X(12).
  1936         16  CF-PLAN-RATING.
  1937             20  CF-RATE-CODE               PIC X(5).
  1938             20  CF-SEX-RATING              PIC X.
  1939                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1940                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1941             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1942             20  CF-SUB-STD-TYPE            PIC X.
  1943                 88  CF-PCT-OF-PREM            VALUE '1'.
  1944                 88  CF-PCT-OF-BENE            VALUE '2'.
  1945         16  CF-PLAN-PREM-TOLERANCES.
  1946             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1947             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1948         16  CF-PLAN-PYMT-TOLERANCES.
  1949             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1950             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1951         16  CF-PLAN-MISC-DATA.
  1952             20  FILLER                     PIC X.
  1953             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1954             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1955         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1956         16  CF-PLAN-IND-GRP                PIC X.
  1957             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1958                                                     '1'.
  1959             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1960                                                     '2'.
  1961         16  CF-MIB-SEARCH-SW               PIC X.
  1962             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1963             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1964             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1965             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1966         16  CF-ALPHA-SEARCH-SW             PIC X.
  1967             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1968             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1969             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1970             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1971             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1972             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1973             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1974             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1975             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1976             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1977                                                     'A' 'B' 'C'
  1978                                                     'X' 'Y' 'Z'.
  1979         16  CF-EFF-DT-RULE-SW              PIC X.
  1980             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1981             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1982             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1983             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1984             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1985         16  FILLER                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  36
* EL201.cbl
  1986         16  CF-HEALTH-QUESTIONS            PIC X.
  1987             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1988         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1989         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1990         16  CF-PLAN-SNGL-JNT               PIC X.
  1991             88  CF-COMBINED-PLAN              VALUE 'C'.
  1992             88  CF-JNT-PLAN                   VALUE 'J'.
  1993             88  CF-SNGL-PLAN                  VALUE 'S'.
  1994         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1995         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1996         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1997         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1998         16  CF-RERATE-CNTL                 PIC  X.
  1999             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2000             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2001             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2002             88  CF-AUTO-RECALC                 VALUE '4'.
  2003         16  CF-BENEFIT-TYPE                PIC  X.
  2004             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2005             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2006         16  CF-POLICY-FEE                  PIC S999V99
  2007                                                    COMP-3.
  2008         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2009         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2010         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2011         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2012         16  FILLER                         PIC  X(32).
  2013         16  CF-TERMINATION-FORM            PIC  X(04).
  2014         16  FILLER                         PIC  X(08).
  2015         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2016                                                       COMP-3.
  2017         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2018         16  CF-ISSUE-LETTER                PIC  X(4).
  2019         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2020         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2021             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2022             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2023         16  CF-MP-REFUND-CALC              PIC X.
  2024             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2025             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2026             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2027             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2028             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2029             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2030             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2031             88  CF-MP-REFD-MEAN                VALUE '8'.
  2032         16  CF-ALT-RATE-CODE               PIC  X(5).
  2033
  2034
  2035         16  FILLER                         PIC X(498).
  2036****************************************************************
  2037*             MORTGAGE COMPANY MASTER RECORD                   *
  2038****************************************************************
  2039
  2040     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2041         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2042         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2043             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  37
* EL201.cbl
  2044             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2045             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2046             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2047             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2048
  2049         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2050         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2051         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2052         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2053         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2054
  2055         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2056             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2057         16  CF-MP-RECON-USE-IND            PIC X(1).
  2058             88  CF-MP-USE-RECON             VALUE 'Y'.
  2059         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2060             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2061         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2062             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2063             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2064         16  FILLER                         PIC X(1).
  2065         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2066             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2067         16  CF-MORTG-MIB-VERSION           PIC X.
  2068             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2069             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2070             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2071         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2072             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2073                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2074             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2075                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2076             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2077                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2078             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2079                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2080             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2081                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2082             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2083                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2084         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2085         16  FILLER                         PIC X(7).
  2086         16  CF-MORTG-DESTINATION-SYMBOL.
  2087             20  CF-MORTG-MIB-COMM          PIC X(5).
  2088             20  CF-MORTG-MIB-TERM          PIC X(5).
  2089         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2090             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2091         16  FILLER                         PIC X(03).
  2092         16  CF-MP-CHECK-NO-CONTROL.
  2093             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2094                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2095                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2096                                                ' ' LOW-VALUES.
  2097                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2098                                               VALUE '3'.
  2099         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2100         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2101         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  38
* EL201.cbl
  2102             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2103                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2104             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2105                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2106             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2107                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2108             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2109                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2110             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2111                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2112             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2113                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2114         16  CF-MORTG-BILLING-AREA.
  2115             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2116                                            PIC X.
  2117         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2118         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2119         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2120         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2121             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2122             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2123         16  FILLER                         PIC X.
  2124         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2125             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2126             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2127         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2128         16  FILLER                         PIC X(8).
  2129         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2130         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2131         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2132         16  CF-ACH-COMPANY-ID.
  2133             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2134                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2135                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2136                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2137             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2138         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2139             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2140         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2141             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2142             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2143         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2144         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2145         16  FILLER                         PIC X(536).
  2146
  2147****************************************************************
  2148*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2149****************************************************************
  2150
  2151     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2152         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2153             20  CF-FEMALE-HEIGHT.
  2154                 24  CF-FEMALE-FT           PIC 99.
  2155                 24  CF-FEMALE-IN           PIC 99.
  2156             20  CF-FEMALE-MIN-WT           PIC 999.
  2157             20  CF-FEMALE-MAX-WT           PIC 999.
  2158         16  FILLER                         PIC X(428).
  2159
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  39
* EL201.cbl
  2160     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2161         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2162             20  CF-MALE-HEIGHT.
  2163                 24  CF-MALE-FT             PIC 99.
  2164                 24  CF-MALE-IN             PIC 99.
  2165             20  CF-MALE-MIN-WT             PIC 999.
  2166             20  CF-MALE-MAX-WT             PIC 999.
  2167         16  FILLER                         PIC X(428).
  2168******************************************************************
  2169*             AUTOMATIC ACTIVITY RECORD                          *
  2170******************************************************************
  2171     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2172         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2173             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2174             20  CF-SYS-LETTER-ID           PIC X(04).
  2175             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2176             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2177             20  CF-SYS-RESET-SW            PIC X(01).
  2178             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2179             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2180
  2181         16  FILLER                         PIC X(50).
  2182
  2183         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2184             20  CF-USER-ACTIVE-SW          PIC X(01).
  2185             20  CF-USER-LETTER-ID          PIC X(04).
  2186             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2187             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2188             20  CF-USER-RESET-SW           PIC X(01).
  2189             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2190             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2191             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2192
  2193         16  FILLER                         PIC X(246).
  2194 01  ws-heading1.
  2195     05  ws-head1                pic x(120)  value '
  2196-     '                                   DAILY CHECK RECONCILIATI
  2197-     'ON                                            '.
  2198     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2199 01  ws-heading2.
  2200     05  filler                  pic x(51) value spaces.
  2201     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2202     05  WS-H2-DATE              PIC X(10).
  2203     05  ws-h2-time              pic x(8).
  2204 01  ws-heading3.
  2205     05  filler                  pic x(53) value spaces.
  2206     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2207     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2208     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2209 01  ws-heading4.
  2210     05  filler                  pic x(117)   value ' CAR  GROUP
  2211-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2212-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2213 01  ws-hd1-written.
  2214     05  filler                  pic x(120)  value '
  2215-     '                                   DAILY WRITTEN CHECKS REP
  2216-     'ORT                                           '.
  2217 01  ws-hd4-written.
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  40
* EL201.cbl
  2218     05  filler                  pic x(117)   value ' CAR  GROUP
  2219-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2220-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2221 01  ws-detail1.
  2222     05  filler                  pic xx value '  '.
  2223     05  ws-d1-carr              pic x(4) value spaces.
  2224     05  ws-d1-grp               pic x(7) value spaces.
  2225     05  ws-d1-state             pic x(4) value spaces.
  2226     05  ws-d1-account           pic x(12) value spaces.
  2227     05  ws-d1-eff-dt            pic x(12) value spaces.
  2228     05  ws-d1-cert-no           pic x(14) value spaces.
  2229     05  ws-d1-chk-type          pic x(5) value spaces.
  2230     05  ws-d1-chk-no            pic x(12) value spaces.
  2231     05  f                       pic xx value spaces.
  2232     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2233     05  ws-d1-preparer          pic x(8) value spaces.
  2234     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2235     05  ws-d1-chk-amt redefines
  2236         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2237     05  filler                  pic xx value spaces.
  2238     05  ws-d1-message           pic x(20) value spaces.
  2239 01  ws-detail2.
  2240     05  filler                  pic x(12) value '    PAYEE - '.
  2241     05  ws-d2-addr-line         pic x(120) value spaces.
  2242 01  ws-total1.
  2243     05  filler                  pic x(5) value '     '.
  2244     05  ws-t1-cnt               pic zzzz9  value zeros.
  2245     05  ws-t1-chks              pic x(24)  value spaces.
  2246     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2247 01  w-doctoken                  pic x(16).
  2248 01 output-data.
  2249    05  filler                   pic x(6) value "TITLE=".
  2250    05  output-title             pic x(26) value 'Check Posting'.
  2251    05  filler                   pic x(8) value "&COMPID=".
  2252    05  out-comp-id              pic xxx.
  2253    05  filler                   pic x(5) value "&MSG=".
  2254    05  output-msg               pic x(50).
  2255 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2256     'cd /apps/prod/cid1p/jcl'.
  2257*    'cd /apps/test/mdoff/jcl'.
  2258 01  TRAN-DATA-LINE2.
  2259     05  filler                  pic x(10) value 'unikixjob '.
  2260     05  tdl2-job                pic x(8) value 'cilg201b'.
  2261     05  filler                  pic x(9) value ' -k cid1p'.
  2262*    05  filler                  pic x(9) value ' -k mdoff'.
  2263     05  filler                  pic x(51) value spaces.
  2264****************************************************************
  2265*
  2266* Copyright (c) 2007 by Clerity Solutions, Inc.
  2267* All rights reserved.
  2268*
  2269****************************************************************
  2270 01  DFHEIV.
  2271   02  DFHEIV0               PIC X(35).
  2272   02  DFHEIV1               PIC X(08).
  2273   02  DFHEIV2               PIC X(08).
  2274   02  DFHEIV3               PIC X(08).
  2275   02  DFHEIV4               PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  41
* EL201.cbl
  2276   02  DFHEIV5               PIC X(04).
  2277   02  DFHEIV6               PIC X(04).
  2278   02  DFHEIV7               PIC X(02).
  2279   02  DFHEIV8               PIC X(02).
  2280   02  DFHEIV9               PIC X(01).
  2281   02  DFHEIV10              PIC S9(7) COMP-3.
  2282   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2283   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2284   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2285   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2286   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2287   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2288   02  DFHEIV17              PIC X(04).
  2289   02  DFHEIV18              PIC X(04).
  2290   02  DFHEIV19              PIC X(04).
  2291   02  DFHEIV20              USAGE IS POINTER.
  2292   02  DFHEIV21              USAGE IS POINTER.
  2293   02  DFHEIV22              USAGE IS POINTER.
  2294   02  DFHEIV23              USAGE IS POINTER.
  2295   02  DFHEIV24              USAGE IS POINTER.
  2296   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2297   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2298   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2299   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2300   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2301   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2302   02  FILLER                PIC X(02).
  2303   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2304   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2305   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2306   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2307   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2308 LINKAGE  SECTION.
  2309*****************************************************************
  2310*                                                               *
  2311* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2312* All rights reserved.                                          *
  2313*                                                               *
  2314*****************************************************************
  2315 01  dfheiblk.
  2316     02  eibtime          pic s9(7) comp-3.
  2317     02  eibdate          pic s9(7) comp-3.
  2318     02  eibtrnid         pic x(4).
  2319     02  eibtaskn         pic s9(7) comp-3.
  2320     02  eibtrmid         pic x(4).
  2321     02  dfheigdi         pic s9(4) comp.
  2322     02  eibcposn         pic s9(4) comp.
  2323     02  eibcalen         pic s9(4) comp.
  2324     02  eibaid           pic x(1).
  2325     02  eibfiller1       pic x(1).
  2326     02  eibfn            pic x(2).
  2327     02  eibfiller2       pic x(2).
  2328     02  eibrcode         pic x(6).
  2329     02  eibfiller3       pic x(2).
  2330     02  eibds            pic x(8).
  2331     02  eibreqid         pic x(8).
  2332     02  eibrsrce         pic x(8).
  2333     02  eibsync          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  42
* EL201.cbl
  2334     02  eibfree          pic x(1).
  2335     02  eibrecv          pic x(1).
  2336     02  eibsend          pic x(1).
  2337     02  eibatt           pic x(1).
  2338     02  eibeoc           pic x(1).
  2339     02  eibfmh           pic x(1).
  2340     02  eibcompl         pic x(1).
  2341     02  eibsig           pic x(1).
  2342     02  eibconf          pic x(1).
  2343     02  eiberr           pic x(1).
  2344     02  eibrldbk         pic x(1).
  2345     02  eiberrcd         pic x(4).
  2346     02  eibsynrb         pic x(1).
  2347     02  eibnodat         pic x(1).
  2348     02  eibfiller5       pic x(2).
  2349     02  eibresp          pic 9(09) comp.
  2350     02  eibresp2         pic 9(09) comp.
  2351     02  dfheigdj         pic s9(4) comp.
  2352     02  dfheigdk         pic s9(4) comp.
  2353 01  DFHCOMMAREA       PIC X(01).
  2354 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  2355 0000-DFHEXIT SECTION.
  2356     MOVE '9#                    $   ' TO DFHEIV0.
  2357     MOVE 'EL201' TO DFHEIV1.
  2358     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2359***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2360***                                                            ***
  2361***  Even though this program is using WEB Servies we don't    ***
  2362***  have any form fields to browse through, we are getting    ***
  2363***  the information we need through the variables that are    ***
  2364***  included in the URL. These variables are retrieved by     ***
  2365***  the           exec cics web extract                       ***
  2366***                   querystring  (data-value)                ***
  2367***                   querystrlen  (data-value)                ***
  2368***                end-exec                                    ***
  2369***  BTW, you must provide the length it isn't passed to you.  ***
  2370***  Allow for extra on the length or you will get a length    ***
  2371***  error instead of just truncation.                         ***
  2372***                                                            ***
  2373***  This program is expecting                                 ***
  2374*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2375*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2376***                                                            ***
  2377***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2378     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2379     move ws-fn-cymd             to dc-greg-date-cymd
  2380     move 'L'                    to dc-option-code
  2381     perform 9700-date-convert   thru 9700-exit
  2382     if no-conversion-error
  2383        move dc-greg-date-1-alpha to ws-h3-date
  2384        move dc-greg-date-1-edit to ws-h2-date
  2385     else
  2386        display ' error current dt invalid ' dc-error-code
  2387     end-if
  2388     string ws-fn-hours   ':'
  2389            ws-fn-minutes ':'
  2390            ws-fn-seconds
  2391        delimited by size into ws-h2-time
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  43
* EL201.cbl
  2392     end-string
  2393
  2394* exec cics web extract
  2395*       querystring  (ws-qry-string)
  2396*       querystrlen  (ws-qrystr-len)
  2397*    end-exec
  2398*    MOVE 'X0  QL                .   #00002296' TO DFHEIV0
  2399     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2400     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2401     MOVE X'2020233030303032323936' TO DFHEIV0(25:11)
  2402     CALL 'kxdfhei1' USING DFHEIV0,
  2403           DFHEIV99,
  2404           DFHEIV99,
  2405           ws-qry-string,
  2406           ws-qrystr-len,
  2407           DFHEIV99,
  2408           DFHEIV99,
  2409           DFHEIV99,
  2410           DFHEIV99,
  2411           DFHEIV99,
  2412           DFHEIV99,
  2413           DFHEIV99,
  2414           DFHEIV99,
  2415           DFHEIV99
  2416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2417     move ws-qry-string (6:3)    to ws-comp-id
  2418                                    out-comp-id
  2419     move 'Successful Run   '    to output-msg
  2420     move ws-comp-id             to elcntl-key
  2421     move '1'                    to elcntl-rec-type
  2422     move +0                     to elcntl-seq
  2423
  2424* exec cics read
  2425*       dataset  ('ELCNTL')
  2426*       into     (control-file)
  2427*       ridfld   (elcntl-key)
  2428*       resp     (ws-response)
  2429*    end-exec
  2430     MOVE LENGTH OF
  2431      control-file
  2432       TO DFHEIV11
  2433     MOVE 'ELCNTL' TO DFHEIV1
  2434*    MOVE '&"IL       E          (  N#00002306' TO DFHEIV0
  2435     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2437     MOVE X'204E233030303032333036' TO DFHEIV0(25:11)
  2438     CALL 'kxdfhei1' USING DFHEIV0,
  2439           DFHEIV1,
  2440           control-file,
  2441           DFHEIV11,
  2442           elcntl-key,
  2443           DFHEIV99,
  2444           DFHEIV99,
  2445           DFHEIV99
  2446     MOVE EIBRESP  TO ws-response
  2447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2448     if resp-normal
  2449        move cf-cl-mail-to-name  to ws-h2-client-name
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  44
* EL201.cbl
  2450        move cf-company-cd       to ws-comp-cd
  2451     else
  2452        move 'Company Rec not found ' to ws-h2-client-name
  2453                                         output-msg
  2454        display ' error elcntl read ' ws-response ' '
  2455           elcntl-key (1:8)
  2456        go to 0000-return
  2457     end-if
  2458     evaluate true
  2459        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2460           set process-written      to true
  2461           perform 2000-process-written
  2462                                 thru 2000-exit
  2463        when other
  2464           move 'Invalid File ' to output-msg
  2465     end-evaluate
  2466     if connected-to-db
  2467        EXEC SQL
  2468            commit work release
  2469        END-EXEC
  2470        if sqlcode not = 0
  2471           move ' Failed to Commit DB '
  2472                                 to output-msg
  2473           display "Error: commit release "
  2474           display ' sql return code ' sqlcode
  2475           display ' sql err mess    ' sqlerrmc
  2476        end-if
  2477     end-if
  2478     .
  2479 0000-return.
  2480     perform 1030-send-form      thru 1030-exit
  2481
  2482* exec cics
  2483*       return
  2484*    end-exec
  2485*    MOVE '.(                    ''   #00002345' TO DFHEIV0
  2486     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2487     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2488     MOVE X'2020233030303032333435' TO DFHEIV0(25:11)
  2489     CALL 'kxdfhei1' USING DFHEIV0,
  2490           DFHEIV99,
  2491           DFHEIV99,
  2492           DFHEIV99,
  2493           DFHEIV99,
  2494           DFHEIV99,
  2495           DFHEIV99
  2496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2497     .
  2498 1000-CONNECT-DB.
  2499     move 'NTCSO2_ChkApprv'      to svr
  2500     move 'sa'                   to usr
  2501     move 'ntcso2'               to pass
  2502*    move 'NTSQLTST2_ChkApprv'   to svr
  2503*    move 'sa'                   to usr
  2504*    move 'sql2008r2'            to pass
  2505     string
  2506         usr delimited space
  2507         "." delimited size
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  45
* EL201.cbl
  2508         pass delimited space into usr-pass
  2509     end-string
  2510     EXEC SQL
  2511        CONNECT TO :svr USER :usr-pass
  2512     END-EXEC
  2513     if sqlcode not = 0
  2514        display "Error: cannot connect "
  2515        display sqlcode
  2516        display sqlerrmc
  2517        move 'Failed to connect to DB'
  2518                                 to output-msg
  2519        go to 0000-return
  2520     else
  2521        set connected-to-db to true
  2522     end-if
  2523     .
  2524 1000-EXIT.
  2525     EXIT.
  2526 1020-read-erchek.
  2527     move ws-comp-cd             to ch-company-cd
  2528     move db-carrier             to ch-carrier
  2529     move db-grouping            to ch-grouping
  2530     move db-state               to ch-state
  2531     move db-account             to ch-account
  2532     move db-certificate         to ch-cert-prime
  2533     move db-cert-sfx            to ch-cert-sfx
  2534     string db-effdate (1:4)
  2535            db-effdate (6:2)
  2536            db-effdate (9:2)
  2537        delimited by size into dc-greg-date-cymd-r
  2538     end-string
  2539     move 'L'                    to dc-option-code
  2540     perform 9700-date-convert   thru 9700-exit
  2541     if no-conversion-error
  2542        move dc-bin-date-1       to ch-cert-eff-dt
  2543     else
  2544        display ' error cvtdte eff dt ' db-effdate ' '
  2545           dc-error-code
  2546     end-if
  2547     move zeros                  to ws-seq-alpha
  2548     move +5                     to s2
  2549     perform varying s1 from +5 by -1 until s1 < +1
  2550        if db-seq-no (s1:1) numeric
  2551           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2552           subtract +1 from s2
  2553        end-if
  2554     end-perform
  2555     move ws-seq-no-num          to ch-sequence-no
  2556*    display ' dte   **' db-effdate '**'
  2557*    display ' carrier ' ch-carrier
  2558*    display ' group   ' ch-grouping
  2559*    display ' state   ' ch-state
  2560*    display ' acct    ' ch-account
  2561*    display ' cert  **' ch-cert-no '**'
  2562*    display ' seq     ' ch-sequence-no
  2563
  2564* exec cics read
  2565*       update
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  46
* EL201.cbl
  2566*       dataset    ('ERCHEK')
  2567*       into       (check-records)
  2568*       ridfld     (ch-control-primary)
  2569*       resp       (ws-response)
  2570*    end-exec
  2571     MOVE LENGTH OF
  2572      check-records
  2573       TO DFHEIV11
  2574     MOVE 'ERCHEK' TO DFHEIV1
  2575*    MOVE '&"IL       EU         (  N#00002414' TO DFHEIV0
  2576     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2577     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2578     MOVE X'204E233030303032343134' TO DFHEIV0(25:11)
  2579     CALL 'kxdfhei1' USING DFHEIV0,
  2580           DFHEIV1,
  2581           check-records,
  2582           DFHEIV11,
  2583           ch-control-primary,
  2584           DFHEIV99,
  2585           DFHEIV99,
  2586           DFHEIV99
  2587     MOVE EIBRESP  TO ws-response
  2588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2589     .
  2590 1020-exit.
  2591     exit.
  2592 1030-send-form.
  2593
  2594* exec cics document create
  2595*       doctoken   (w-doctoken)
  2596*       template   ('WCHECKS')
  2597*       symbollist (output-data)
  2598*       listlength (length of output-data)
  2599*    end-exec
  2600     MOVE 'WCHECKS'
  2601      TO DFHEIVL0
  2602     MOVE LENGTH OF
  2603      output-data TO DFHEIV16
  2604*    MOVE '\"D tSL               )   #00002425' TO DFHEIV0
  2605     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2606     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2607     MOVE X'2020233030303032343235' TO DFHEIV0(25:11)
  2608     CALL 'kxdfhei1' USING DFHEIV0,
  2609           w-doctoken,
  2610           DFHEIV99,
  2611           DFHEIVL0,
  2612           output-data,
  2613           DFHEIV16,
  2614           DFHEIV99,
  2615           DFHEIV99,
  2616           DFHEIV99
  2617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2618
  2619* exec cics web send
  2620*       doctoken(w-doctoken)
  2621*    end-exec
  2622*    MOVE 'X$D                   *   #00002431' TO DFHEIV0
  2623     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  47
* EL201.cbl
  2624     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2625     MOVE X'2020233030303032343331' TO DFHEIV0(25:11)
  2626     CALL 'kxdfhei1' USING DFHEIV0,
  2627           w-doctoken,
  2628           DFHEIV99,
  2629           DFHEIV99,
  2630           DFHEIV99,
  2631           DFHEIV99,
  2632           DFHEIV99,
  2633           DFHEIV99,
  2634           DFHEIV99,
  2635           DFHEIV99
  2636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2637     .
  2638 1030-exit.
  2639     exit.
  2640 1050-disconnect.
  2641     if connected-to-db
  2642        EXEC SQL
  2643            disconnect all
  2644        END-EXEC
  2645        move ' ' to ws-connect-sw
  2646     end-if
  2647     .
  2648 1050-exit.
  2649     exit.
  2650 2000-process-written.
  2651     perform 2010-open-files     thru 2010-exit
  2652     perform 2020-init           thru 2020-exit
  2653     perform 2050-process-input  thru 2050-exit until
  2654        end-of-input
  2655     if ws-writ-cnt > zeros
  2656        move ws-writ-cnt         to ws-t1-cnt
  2657        move ' Written '         to ws-t1-chks
  2658        move ws-tot-writ-amt     to ws-t1-amount
  2659     else
  2660        perform 4010-write-headings
  2661                                 thru 4010-exit
  2662        move spaces              to ws-total1
  2663        string ' No checks for '
  2664           ws-writ-rpt-comp-id
  2665           ' today. ' delimited by size into ws-total1
  2666        end-string
  2667     end-if
  2668     move spaces                 to cps-written-rpt-rec
  2669     perform 4020-write-a-line   thru 4020-exit
  2670     move ws-total1              to cps-written-rpt-rec
  2671     perform 4020-write-a-line   thru 4020-exit
  2672     perform 2500-close-files    thru 2500-exit
  2673     perform 5000-submit-job     thru 5000-exit
  2674     .
  2675 2000-exit.
  2676     exit.
  2677 2010-open-files.
  2678     move function upper-case(ws-comp-id)
  2679                                 to ws-writ-rpt-comp-id
  2680     if ws-writ-rpt-comp-id = 'AHL'
  2681        move 'miscpymtsahl.csv'  to ws-writ-in-name
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  48
* EL201.cbl
  2682     end-if
  2683     open input CPS-WRITTEN-IN
  2684         output CPS-WRITTEN-RPT
  2685     if written-status not = '00'
  2686        display 'error written open ' written-status
  2687        move ' Invalid or missing file '
  2688                                 to output-msg
  2689        go to 0000-return
  2690     end-if
  2691     .
  2692 2010-exit.
  2693     exit.
  2694 2020-init.
  2695     move spaces                 to ws-detail1
  2696     move ws-hd1-written         to ws-head1
  2697     move 'EL201B'               to ws-h1-rpt-id
  2698     move ws-hd4-written         to ws-heading4
  2699     move 'Posting of Written Checks '
  2700                                 to output-title
  2701     if ws-comp-id = 'AHL'
  2702        move 'ahlg201b'          to tdl2-job
  2703     else
  2704        move 'cilg201b'          to tdl2-job
  2705     end-if
  2706     if not connected-to-db
  2707        perform 1000-connect-db  thru 1000-exit
  2708     end-if
  2709***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2710***                                                            ***
  2711**     I do 2 reads to bypass the header record                ***
  2712***                                                            ***
  2713***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2714     perform 2040-read-input     thru 2040-exit
  2715     perform 2040-read-input     thru 2040-exit
  2716     .
  2717 2020-exit.
  2718     exit.
  2719 2040-read-input.
  2720     read CPS-WRITTEN-IN at end
  2721        set end-of-input   to true
  2722     end-read
  2723     if not end-of-input
  2724        add 1 to ws-in-recs
  2725     end-if
  2726     .
  2727 2040-exit.
  2728     exit.
  2729 2050-process-input.
  2730     move spaces                 to ws-raw-record
  2731                                    ws-written-rec
  2732     unstring cps-written-in-rec
  2733        delimited by ',' into
  2734           raw-check-no
  2735           raw-check-dt
  2736           raw-check-amt
  2737           raw-vendor-id
  2738           raw-user-defined
  2739           raw-voucher-ref
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  49
* EL201.cbl
  2740     end-unstring
  2741*    display ' chk no    **' wsw-check-no '**'
  2742*    display ' chk dt    **' wsw-check-dt '**'
  2743*    display ' chk amt   **' wsw-check-amt '**'
  2744*    display ' vend id   **' wsw-vendor-id '**'
  2745*    display ' user def  **' wsw-user-defined '**'
  2746*    display ' vouch ref **' wsw-voucher-ref '**'
  2747***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2748***                                                            ***
  2749***    Every now and then I get bogus records with quotes      ***
  2750***  so I am just going to remove them.  These are normally    ***
  2751***  a result of a manual process that should not be included  ***
  2752***  in this file.                                             ***
  2753***                                                            ***
  2754***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2755
  2756     move +1                     to o1
  2757     perform varying i1 from +1 by +1 until i1 > +20
  2758        if raw-check-no (i1:1) <> '"'
  2759           move raw-check-no (i1:1)
  2760                                 to wsw-check-no (o1:1)
  2761           add +1 to o1
  2762        end-if
  2763     end-perform
  2764
  2765     move +1                     to o1
  2766     perform varying i1 from +1 by +1 until i1 > +20
  2767        if raw-check-dt (i1:1) <> '"'
  2768           move raw-check-dt (i1:1)
  2769                                 to wsw-check-dt (o1:1)
  2770           add +1 to o1
  2771        end-if
  2772     end-perform
  2773
  2774     move +1                     to o1
  2775     perform varying i1 from +1 by +1 until i1 > +15
  2776        if raw-check-amt (i1:1) <> '"'
  2777           move raw-check-amt (i1:1)
  2778                                 to wsw-check-amt (o1:1)
  2779           add +1 to o1
  2780        end-if
  2781     end-perform
  2782
  2783     move +1                     to o1
  2784     perform varying i1 from +1 by +1 until i1 > +20
  2785        if raw-vendor-id (i1:1) <> '"'
  2786           move raw-vendor-id (i1:1)
  2787                                 to wsw-vendor-id (o1:1)
  2788           add +1 to o1
  2789        end-if
  2790     end-perform
  2791
  2792     move +1                     to o1
  2793     perform varying i1 from +1 by +1 until i1 > +30
  2794        if raw-user-defined (i1:1) <> '"'
  2795           move raw-user-defined (i1:1)
  2796                                 to wsw-user-defined (o1:1)
  2797           add +1 to o1
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  50
* EL201.cbl
  2798        end-if
  2799     end-perform
  2800
  2801     move +1                     to o1
  2802     perform varying i1 from +1 by +1 until i1 > +35
  2803        if raw-voucher-ref (i1:1) <> '"'
  2804           move raw-voucher-ref (i1:1)
  2805                                 to wsw-voucher-ref (o1:1)
  2806           add +1 to o1
  2807        end-if
  2808     end-perform
  2809     if (wsw-check-no = spaces)
  2810        and (wsw-check-dt = spaces)
  2811        and (wsw-check-amt = spaces)
  2812        display ' empty record ' cps-written-in-rec
  2813        go to 2050-read
  2814     end-if
  2815     string wsw-check-dt (1:4)
  2816            wsw-check-dt (6:2)
  2817            wsw-check-dt (9:2)
  2818        delimited by size into dc-greg-date-cymd-r
  2819     end-string
  2820     move 'L'                    to dc-option-code
  2821     perform 9700-date-convert   thru 9700-exit
  2822     if no-conversion-error
  2823        move dc-bin-date-1       to ws-bin-check-dt
  2824     else
  2825        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2826           dc-error-code
  2827     end-if
  2828     perform varying s1 from +1 by +1 until
  2829        (s1 > +28)
  2830        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2831          'CANCEL')
  2832     end-perform
  2833     if s1 < +29
  2834        move 'Bypass- Manual Entry'    to ws-d1-message
  2835        move ' '                 to ws-table-sw
  2836        go to 2050-continue
  2837     end-if
  2838     if wsw-user-defined (1:3) not numeric
  2839        move 'Bypass- Manual Entry'
  2840                                 to ws-d1-message
  2841        move ' '                 to ws-table-sw
  2842        go to 2050-continue
  2843     end-if
  2844     move spaces                 to wsw-check-key
  2845     perform varying s1 from +30 by -1 until
  2846        (s1 < +1)
  2847        or (wsw-user-defined (s1:1) numeric)
  2848     end-perform
  2849     if s1 > +7
  2850        move wsw-user-defined (s1 - 6:7)
  2851                                 to wsw-check-key
  2852     else
  2853        move 'Invalid Input CK-KEY'    to ws-d1-message
  2854        go to 2050-continue
  2855     end-if
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  51
* EL201.cbl
  2856*    go to 2050-read
  2857     move ' '                    to ws-erchek-sw
  2858                                    ws-table-sw
  2859     perform 2200-get-tbl-row    thru 2200-exit
  2860     if sqlcode = 0
  2861        set table-found          to true
  2862        perform 1020-read-erchek thru 1020-exit
  2863        if resp-normal
  2864           set erchek-found to true
  2865           perform 2310-upd-erchek
  2866                                 thru 2310-exit
  2867           perform 2320-upd-table thru 2320-exit
  2868        else
  2869           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2870              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2871              ' ' ws-response
  2872           move ' chk rec not found ' to ws-d1-message
  2873        end-if
  2874     else
  2875        move ' tbl row not found ' to ws-d1-message
  2876     end-if
  2877     .
  2878 2050-continue.
  2879     perform 2400-build-print-line thru 2400-exit
  2880     .
  2881 2050-read.
  2882     perform 2040-read-input     thru 2040-exit
  2883     .
  2884 2050-exit.
  2885     exit.
  2886 2200-get-tbl-row.
  2887***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2888***                                                            ***
  2889***  I'm only expecting one row so no cursor is declared       ***
  2890***                                                            ***
  2891***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2892     move ws-comp-id             to ws-compid
  2893     move wsw-check-key-num      to ws-check-key
  2894     move 1                      to ws-type
  2895     exec sql
  2896        SELECT
  2897           CheckKey,
  2898           Company,
  2899           CertCarrier,
  2900           CertGroup,
  2901           CertState,
  2902           CertAccount,
  2903           CertEffDate,
  2904           CertNumber,
  2905           CertNumberSuf,
  2906           CheckSeqNbr,
  2907           CheckType,
  2908           CheckAmount,
  2909           Preparer
  2910        INTO
  2911           :db-checkkey,
  2912           :db-compid,
  2913           :db-carrier,
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  52
* EL201.cbl
  2914           :db-grouping,
  2915           :db-state,
  2916           :db-account,
  2917           :db-effdate,
  2918           :db-certificate,
  2919           :db-cert-sfx,
  2920           :db-seq-no,
  2921           :db-type,
  2922           :db-amount,
  2923           :db-preparer
  2924        FROM
  2925           ChkApp_Check
  2926        WHERE
  2927           (CheckKey    = :ws-check-key)
  2928           and (Company = :ws-compid)
  2929     end-exec
  2930     if sqlcode not = 0
  2931        move sqlcode to ws-sql-code
  2932        move ws-sql-code to ws-dis-sql-code
  2933        display ' dis sql code ' ws-dis-sql-code
  2934        display "Error: cannot read row "
  2935        display ' sql return code ' sqlcode
  2936        display ' sql err mess    ' sqlerrmc
  2937     end-if
  2938     .
  2939 2200-exit.
  2940     exit.
  2941 2310-upd-erchek.
  2942     move ws-bin-check-dt        to ch-check-written-dt
  2943     if wsw-check-no (1:1) = '"'
  2944        move wsw-check-no (5:7)  to ch-check-no
  2945     else
  2946        move wsw-check-no (4:7)  to ch-check-no
  2947     end-if
  2948*    move zeros                  to ws-response
  2949
  2950* exec cics rewrite
  2951*       dataset     ('ERCHEK')
  2952*       from        (check-records)
  2953*       resp        (ws-response)
  2954*    end-exec
  2955     MOVE LENGTH OF
  2956      check-records
  2957       TO DFHEIV11
  2958     MOVE 'ERCHEK' TO DFHEIV1
  2959*    MOVE '&& L                  %  N#00002746' TO DFHEIV0
  2960     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2961     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2962     MOVE X'204E233030303032373436' TO DFHEIV0(25:11)
  2963     CALL 'kxdfhei1' USING DFHEIV0,
  2964           DFHEIV1,
  2965           check-records,
  2966           DFHEIV11,
  2967           DFHEIV99
  2968     MOVE EIBRESP  TO ws-response
  2969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2970     if resp-normal
  2971        add 1 to ws-writ-cnt
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  53
* EL201.cbl
  2972        compute ws-tot-writ-amt =
  2973           ws-tot-writ-amt + ch-amount-paid
  2974        move 'Successful Post '  to ws-d1-message
  2975     else
  2976        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  2977     end-if
  2978     .
  2979 2310-exit.
  2980     exit.
  2981 2320-upd-table.
  2982     string wsw-check-dt (6:2) '/'
  2983            wsw-check-dt (9:2) '/'
  2984            wsw-check-dt (1:4)
  2985        delimited by size into db-checkdate
  2986     move ch-check-no            to db-checkno
  2987*    move zeros to sqlcode
  2988     EXEC SQL
  2989        UPDATE
  2990           ChkApp_Check
  2991        SET
  2992           CheckNumber = :db-checkno,
  2993           CheckDate = :db-checkdate
  2994        WHERE
  2995           CheckKey = :db-checkkey
  2996     END-EXEC
  2997     if sqlcode not = 0
  2998        move 'Table not updated ' to ws-d1-message
  2999        display "Error: cannot update table   "
  3000        display ' sql retrun code ' sqlcode
  3001        display ' sql err mess    ' sqlerrmc
  3002     end-if
  3003     .
  3004 2320-exit.
  3005     exit.
  3006 2400-build-print-line.
  3007     if table-found
  3008        move db-carrier          to ws-d1-carr
  3009        move db-grouping         to ws-d1-grp
  3010        move db-state            to ws-d1-state
  3011        move db-account          to ws-d1-account
  3012        string
  3013           db-effdate (6:2)   '/'
  3014           db-effdate (9:2)   '/'
  3015           db-effdate (1:4)
  3016           delimited by size into ws-d1-eff-dt
  3017        end-string
  3018        move db-certificate      to ws-d1-cert-no
  3019        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3020        move 'REF'               to ws-d1-chk-type
  3021        move +10                 to s2
  3022        move zeros               to ws-work-amt-alpha
  3023        perform varying s1 from +10 by -1 until s1 < +1
  3024           if db-amount (s1:1) numeric
  3025              move db-amount (s1:1)
  3026                                 to ws-work-amt-alpha (s2:1)
  3027              subtract +1 from s2
  3028           end-if
  3029        end-perform
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  54
* EL201.cbl
  3030        move ws-work-amt-num     to ws-d1-chk-amt
  3031        move db-preparer         to ws-d1-preparer
  3032        move db-checkno          to ws-d1-chk-no
  3033        move db-checkdate        to ws-d1-writ-cash-dt
  3034     else
  3035        move wsw-check-no        to ws-d1-chk-no
  3036     end-if
  3037     perform 4000-write-report   thru 4000-exit
  3038     move spaces                 to ws-detail1
  3039     .
  3040 2400-exit.
  3041     exit.
  3042 2500-close-files.
  3043     close cps-written-in cps-written-rpt
  3044     .
  3045 2500-exit.
  3046     exit.
  3047 4000-write-report.
  3048     if ws-line-cntr > ws-max-lines
  3049        move zeros               to ws-line-cntr
  3050        perform 4010-write-headings thru 4010-exit
  3051     end-if
  3052     move ws-detail1             to cps-written-rpt-rec
  3053     perform 4020-write-a-line   thru 4020-exit
  3054     .
  3055 4000-exit.
  3056     exit.
  3057 4010-write-headings.
  3058     add 1 to ws-page-cntr
  3059     move ws-page-cntr           to ws-h3-page
  3060     move ws-heading1            to cps-written-rpt-rec
  3061     perform 4020-write-a-line   thru 4020-exit
  3062     move ws-heading2            to cps-written-rpt-rec
  3063     perform 4020-write-a-line   thru 4020-exit
  3064     move ws-heading3            to cps-written-rpt-rec
  3065     perform 4020-write-a-line   thru 4020-exit
  3066     move spaces                 to cps-written-rpt-rec
  3067     perform 4020-write-a-line   thru 4020-exit
  3068     move spaces                 to cps-written-rpt-rec
  3069     perform 4020-write-a-line   thru 4020-exit
  3070     move ws-heading4            to cps-written-rpt-rec
  3071     perform 4020-write-a-line   thru 4020-exit
  3072     move spaces                 to cps-written-rpt-rec
  3073     perform 4020-write-a-line   thru 4020-exit
  3074     .
  3075 4010-exit.
  3076     exit.
  3077 4020-write-a-line.
  3078     write cps-written-rpt-rec
  3079     add 1 to ws-line-cntr
  3080     .
  3081 4020-exit.
  3082     exit.
  3083 5000-submit-job.
  3084
  3085* EXEC CICS WRITEQ TD
  3086*       QUEUE ('BTCH')
  3087*       FROM (TRAN-DATA-LINE1)
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  55
* EL201.cbl
  3088*       LENGTH (80)
  3089*    END-EXEC
  3090     MOVE 80
  3091       TO DFHEIV11
  3092     MOVE 'BTCH' TO DFHEIV5
  3093*    MOVE '(" L                  &   #00002865' TO DFHEIV0
  3094     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3096     MOVE X'2020233030303032383635' TO DFHEIV0(25:11)
  3097     CALL 'kxdfhei1' USING DFHEIV0,
  3098           DFHEIV5,
  3099           TRAN-DATA-LINE1,
  3100           DFHEIV11,
  3101           DFHEIV99,
  3102           DFHEIV99
  3103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3104
  3105* EXEC CICS WRITEQ TD
  3106*       QUEUE ('BTCH')
  3107*       FROM (TRAN-DATA-LINE2)
  3108*       LENGTH (80)
  3109*    END-EXEC
  3110     MOVE 80
  3111       TO DFHEIV11
  3112     MOVE 'BTCH' TO DFHEIV5
  3113*    MOVE '(" L                  &   #00002870' TO DFHEIV0
  3114     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3115     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3116     MOVE X'2020233030303032383730' TO DFHEIV0(25:11)
  3117     CALL 'kxdfhei1' USING DFHEIV0,
  3118           DFHEIV5,
  3119           TRAN-DATA-LINE2,
  3120           DFHEIV11,
  3121           DFHEIV99,
  3122           DFHEIV99
  3123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3124     .
  3125 5000-exit.
  3126     exit.
  3127 9700-DATE-CONVERT.
  3128
  3129* EXEC CICS LINK
  3130*         PROGRAM  ('ELDATCV')
  3131*         COMMAREA (DATE-CONVERSION-DATA)
  3132*         LENGTH   (DC-COMM-LENGTH)
  3133*    END-EXEC.
  3134     MOVE 'ELDATCV' TO DFHEIV1
  3135*    MOVE '."C                   (   #00002879' TO DFHEIV0
  3136     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3138     MOVE X'2020233030303032383739' TO DFHEIV0(25:11)
  3139     CALL 'kxdfhei1' USING DFHEIV0,
  3140           DFHEIV1,
  3141           DATE-CONVERSION-DATA,
  3142           DC-COMM-LENGTH,
  3143           DFHEIV99,
  3144           DFHEIV99,
  3145           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Aug-15 11:06 Page  56
* EL201.cbl
  3146           DFHEIV99
  3147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3148
  3149 9700-EXIT.
  3150      EXIT.
  3151
  3152 9999-DFHBACK SECTION.
  3153     MOVE '9%                    "   ' TO DFHEIV0
  3154     MOVE 'EL201' TO DFHEIV1
  3155     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3156     GOBACK.
  3157 9999-DFHEXIT.
  3158     IF DFHEIGDJ EQUAL 0001
  3159         NEXT SENTENCE.
  3160     MOVE '9%                    "   ' TO DFHEIV0
  3161     MOVE 'EL201' TO DFHEIV1
  3162     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3163     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      139428     Code:        9130
